import{aW as ot,e as ve,aX as pt,k as At,aY as It,aZ as Pt,a_ as at,a$ as xt,b0 as Et,b1 as He,b2 as ft,b3 as Mt,_ as We,a as H,ai as mt,b4 as Nt,b5 as Ot,ae as et,b as tt,b6 as Dt,aM as nt,af as _t,a4 as Ue,b7 as Gt,ao as jt,T as Ve,W as yt,b8 as Ft,aG as kt,ak as Bt,az as zt,b9 as $t,C as Me,a6 as Wt,ba as Ut,bb as Vt,n as qt,bc as rt,bd as Ht,be as Kt,bf as Jt,c as ct,d as ne,f as Qt,g as Xt,$ as Yt,h as Zt,bg as en,aU as tn,a3 as nn,bh as rn,bi as sn,bj as on}from"./editor.api.C1vQ_HcD.js";import{D as be,E as an,n as cn,p as un,q as ln,m as De,f as St,F as Le,U as hn,t as dn,r as Ke,s as ut,l as j,o as gn,u as pn,v as fn,I as bt,d as lt,w as mn,C as _n}from"./editor.DUpSOAQE.js";import{f as wt,e as Tt}from"./server.browser.D4hb9_uX.js";import{a as xe,g as yn,S as kn}from"./tokenClassificationRegistry.DDNqQCr5.js";function vt(D,i){for(var d=0;d<i.length;d++){const f=i[d];if(typeof f!="string"&&!Array.isArray(f)){for(const T in f)if(T!=="default"&&!(T in D)){const h=Object.getOwnPropertyDescriptor(f,T);h&&Object.defineProperty(D,T,h.get?h:{enumerable:!0,get:()=>f[T]})}}}return Object.freeze(Object.defineProperty(D,Symbol.toStringTag,{value:"Module"}))}class Sn extends be{constructor(i,d,f,T,h,t,a){super(),this._grammar=i,this._initialState=d,this._containsEmbeddedLanguages=f,this._createBackgroundTokenizer=T,this._backgroundTokenizerShouldOnlyVerifyTokens=h,this._reportTokenizationTime=t,this._reportSlowTokenization=a,this._seenLanguages=[],this._onDidEncounterLanguage=this._register(new an),this.onDidEncounterLanguage=this._onDidEncounterLanguage.event}get backgroundTokenizerShouldOnlyVerifyTokens(){return this._backgroundTokenizerShouldOnlyVerifyTokens()}getInitialState(){return this._initialState}tokenize(i,d,f){throw new Error("Not supported!")}createBackgroundTokenizer(i,d){if(this._createBackgroundTokenizer)return this._createBackgroundTokenizer(i,d)}tokenizeEncoded(i,d,f){const T=Math.random()*1e4<1,h=this._reportSlowTokenization||T,t=h?new cn(!0):void 0,a=this._grammar.tokenizeLine2(i,f,500);if(h){const n=t.elapsed();(T||n>32)&&this._reportTokenizationTime(n,i.length,T)}if(a.stoppedEarly)return console.warn(`Time limit reached when tokenizing line: ${i.substring(0,100)}`),new ot(a.tokens,f);if(this._containsEmbeddedLanguages){const n=this._seenLanguages,_=a.tokens;for(let v=0,p=_.length>>>1;v<p;v++){const C=_[(v<<1)+1],A=ve.getLanguageId(C);n[A]||(n[A]=!0,this._onDidEncounterLanguage.fire(A))}}let l;return f.equals(a.ruleStack)?l=f:l=a.ruleStack,new ot(a.tokens,l)}}class bn extends be{get backgroundTokenizerShouldOnlyVerifyTokens(){return this._actual.backgroundTokenizerShouldOnlyVerifyTokens}constructor(i,d,f){super(),this._encodedLanguageId=i,this._actual=d,this._maxTokenizationLineLength=f,this._register(pt(this._maxTokenizationLineLength))}getInitialState(){return this._actual.getInitialState()}tokenize(i,d,f){throw new Error("Not supported!")}tokenizeEncoded(i,d,f){return i.length>=this._maxTokenizationLineLength.get()?At(this._encodedLanguageId,f):this._actual.tokenizeEncoded(i,d,f)}createBackgroundTokenizer(i,d){if(this._actual.createBackgroundTokenizer)return this._actual.createBackgroundTokenizer(i,d)}}class wn{constructor(i){this.edits=i.slice().sort(un(d=>d.offset,ln))}applyToArray(i){for(let d=this.edits.length-1;d>=0;d--){const f=this.edits[d];i.splice(f.offset,f.length,...new Array(f.newLength))}}}class Tn{constructor(i,d,f){this.offset=i,this.length=d,this.newLength=f}toString(){return`[${this.offset}, +${this.length}) -> +${this.newLength}}`}}class Ge{static fromMany(i){const d=i.map(f=>new Ge(f));return new vn(d)}constructor(i){this.transformation=i,this.idx=0,this.offset=0}transform(i){let d=this.transformation.edits[this.idx];for(;d&&d.offset+d.length<=i;)this.offset+=d.newLength-d.length,this.idx++,d=this.transformation.edits[this.idx];if(!(d&&d.offset<=i))return i+this.offset}}class vn{constructor(i){this.transformers=i}transform(i){for(const d of this.transformers){const f=d.transform(i);if(f===void 0)return;i=f}return i}}var Ct={exports:{}};(function(D,i){var d={};(function(f,T){D.exports=T()})(wt,function(){return(()=>{var f={350:(h,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UseOnigurumaFindOptions=t.DebugFlags=void 0,t.DebugFlags={InDebugMode:typeof process<"u"&&!!d.VSCODE_TEXTMATE_DEBUG},t.UseOnigurumaFindOptions=!1},442:(h,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.applyStateStackDiff=t.diffStateStacksRefEq=void 0;const l=a(391);t.diffStateStacksRefEq=function(n,_){let v=0;const p=[];let C=n,A=_;for(;C!==A;)C&&(!A||C.depth>=A.depth)?(v++,C=C.parent):(p.push(A.toStateStackFrame()),A=A.parent);return{pops:v,newFrames:p.reverse()}},t.applyStateStackDiff=function(n,_){let v=n;for(let p=0;p<_.pops;p++)v=v.parent;for(const p of _.newFrames)v=l.StateStackImpl.pushFrame(v,p);return v}},36:(h,t)=>{var a;Object.defineProperty(t,"__esModule",{value:!0}),t.toOptionalTokenType=t.EncodedTokenAttributes=void 0,(a=t.EncodedTokenAttributes||(t.EncodedTokenAttributes={})).toBinaryStr=function(l){let n=l.toString(2);for(;n.length<32;)n="0"+n;return n},a.print=function(l){const n=a.getLanguageId(l),_=a.getTokenType(l),v=a.getFontStyle(l),p=a.getForeground(l),C=a.getBackground(l);console.log({languageId:n,tokenType:_,fontStyle:v,foreground:p,background:C})},a.getLanguageId=function(l){return(255&l)>>>0},a.getTokenType=function(l){return(768&l)>>>8},a.containsBalancedBrackets=function(l){return(1024&l)!=0},a.getFontStyle=function(l){return(30720&l)>>>11},a.getForeground=function(l){return(16744448&l)>>>15},a.getBackground=function(l){return(4278190080&l)>>>24},a.set=function(l,n,_,v,p,C,A){let w=a.getLanguageId(l),L=a.getTokenType(l),S=a.containsBalancedBrackets(l)?1:0,y=a.getFontStyle(l),g=a.getForeground(l),b=a.getBackground(l);return n!==0&&(w=n),_!==8&&(L=_),v!==null&&(S=v?1:0),p!==-1&&(y=p),C!==0&&(g=C),A!==0&&(b=A),(w<<0|L<<8|S<<10|y<<11|g<<15|b<<24)>>>0},t.toOptionalTokenType=function(l){return l}},996:(h,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BasicScopeAttributesProvider=t.BasicScopeAttributes=void 0;const l=a(878);class n{constructor(C,A){this.languageId=C,this.tokenType=A}}t.BasicScopeAttributes=n;class _{constructor(C,A){this._getBasicScopeAttributes=new l.CachedFn(w=>{const L=this._scopeToLanguage(w),S=this._toStandardTokenType(w);return new n(L,S)}),this._defaultAttributes=new n(C,8),this._embeddedLanguagesMatcher=new v(Object.entries(A||{}))}getDefaultAttributes(){return this._defaultAttributes}getBasicScopeAttributes(C){return C===null?_._NULL_SCOPE_METADATA:this._getBasicScopeAttributes.get(C)}_scopeToLanguage(C){return this._embeddedLanguagesMatcher.match(C)||0}_toStandardTokenType(C){const A=C.match(_.STANDARD_TOKEN_TYPE_REGEXP);if(!A)return 8;switch(A[1]){case"comment":return 1;case"string":return 2;case"regex":return 3;case"meta.embedded":return 0}throw new Error("Unexpected match for standard token type!")}}t.BasicScopeAttributesProvider=_,_._NULL_SCOPE_METADATA=new n(0,0),_.STANDARD_TOKEN_TYPE_REGEXP=/\b(comment|string|regex|meta\.embedded)\b/;class v{constructor(C){if(C.length===0)this.values=null,this.scopesRegExp=null;else{this.values=new Map(C);const A=C.map(([w,L])=>l.escapeRegExpCharacters(w));A.sort(),A.reverse(),this.scopesRegExp=new RegExp(`^((${A.join(")|(")}))($|\\.)`,"")}}match(C){if(!this.scopesRegExp)return;const A=C.match(this.scopesRegExp);return A?this.values.get(A[1]):void 0}}},947:(h,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LineTokens=t.BalancedBracketSelectors=t.StateStackImpl=t.AttributedScopeStack=t.Grammar=t.createGrammar=void 0;const l=a(350),n=a(36),_=a(736),v=a(44),p=a(792),C=a(583),A=a(878),w=a(996),L=a(47);function S(o,r,u,m,R){const I=_.createMatchers(r,y),x=p.RuleFactory.getCompiledRuleId(u,m,R.repository);for(const M of I)o.push({debugSelector:r,matcher:M.matcher,ruleId:x,grammar:R,priority:M.priority})}function y(o,r){if(r.length<o.length)return!1;let u=0;return o.every(m=>{for(let R=u;R<r.length;R++)if(g(r[R],m))return u=R+1,!0;return!1})}function g(o,r){if(!o)return!1;if(o===r)return!0;const u=r.length;return o.length>u&&o.substr(0,u)===r&&o[u]==="."}t.createGrammar=function(o,r,u,m,R,I,x,M){return new b(o,r,u,m,R,I,x,M)};class b{constructor(r,u,m,R,I,x,M,N){if(this._rootScopeName=r,this.balancedBracketSelectors=x,this._onigLib=N,this._basicScopeAttributesProvider=new w.BasicScopeAttributesProvider(m,R),this._rootId=-1,this._lastRuleId=0,this._ruleId2desc=[null],this._includedGrammars={},this._grammarRepository=M,this._grammar=k(u,null),this._injections=null,this._tokenTypeMatchers=[],I)for(const K of Object.keys(I)){const V=_.createMatchers(K,y);for(const F of V)this._tokenTypeMatchers.push({matcher:F.matcher,type:I[K]})}}get themeProvider(){return this._grammarRepository}dispose(){for(const r of this._ruleId2desc)r&&r.dispose()}createOnigScanner(r){return this._onigLib.createOnigScanner(r)}createOnigString(r){return this._onigLib.createOnigString(r)}getMetadataForScope(r){return this._basicScopeAttributesProvider.getBasicScopeAttributes(r)}_collectInjections(){const r=[],u=this._rootScopeName,m=(R=>R===this._rootScopeName?this._grammar:this.getExternalGrammar(R))(u);if(m){const R=m.injections;if(R)for(let x in R)S(r,x,R[x],this,m);const I=this._grammarRepository.injections(u);I&&I.forEach(x=>{const M=this.getExternalGrammar(x);if(M){const N=M.injectionSelector;N&&S(r,N,M,this,M)}})}return r.sort((R,I)=>R.priority-I.priority),r}getInjections(){if(this._injections===null&&(this._injections=this._collectInjections(),l.DebugFlags.InDebugMode&&this._injections.length>0)){console.log(`Grammar ${this._rootScopeName} contains the following injections:`);for(const r of this._injections)console.log(`  - ${r.debugSelector}`)}return this._injections}registerRule(r){const u=++this._lastRuleId,m=r(p.ruleIdFromNumber(u));return this._ruleId2desc[u]=m,m}getRule(r){return this._ruleId2desc[p.ruleIdToNumber(r)]}getExternalGrammar(r,u){if(this._includedGrammars[r])return this._includedGrammars[r];if(this._grammarRepository){const m=this._grammarRepository.lookup(r);if(m)return this._includedGrammars[r]=k(m,u&&u.$base),this._includedGrammars[r]}}tokenizeLine(r,u,m=0){const R=this._tokenize(r,u,!1,m);return{tokens:R.lineTokens.getResult(R.ruleStack,R.lineLength),ruleStack:R.ruleStack,stoppedEarly:R.stoppedEarly}}tokenizeLine2(r,u,m=0){const R=this._tokenize(r,u,!0,m);return{tokens:R.lineTokens.getBinaryResult(R.ruleStack,R.lineLength),ruleStack:R.ruleStack,stoppedEarly:R.stoppedEarly}}_tokenize(r,u,m,R){let I;if(this._rootId===-1&&(this._rootId=p.RuleFactory.getCompiledRuleId(this._grammar.repository.$self,this,this._grammar.repository),this.getInjections()),u&&u!==e.NULL)I=!1,u.reset();else{I=!0;const V=this._basicScopeAttributesProvider.getDefaultAttributes(),F=this.themeProvider.getDefaults(),$=n.EncodedTokenAttributes.set(0,V.languageId,V.tokenType,null,F.fontStyle,F.foregroundId,F.backgroundId),Z=this.getRule(this._rootId).getName(null,null);let Y;Y=Z?c.createRootAndLookUpScopeName(Z,$,this):c.createRoot("unknown",$),u=new e(null,this._rootId,-1,-1,!1,null,Y,Y)}r+=`
`;const x=this.createOnigString(r),M=x.content.length,N=new s(m,r,this._tokenTypeMatchers,this.balancedBracketSelectors),K=L._tokenizeString(this,x,I,0,u,N,!0,R);return v.disposeOnigString(x),{lineLength:M,lineTokens:N,ruleStack:K.stack,stoppedEarly:K.stoppedEarly}}}function k(o,r){return(o=A.clone(o)).repository=o.repository||{},o.repository.$self={$vscodeTextmateLocation:o.$vscodeTextmateLocation,patterns:o.patterns,name:o.scopeName},o.repository.$base=r||o.repository.$self,o}t.Grammar=b;class c{constructor(r,u,m){this.parent=r,this.scopePath=u,this.tokenAttributes=m}static fromExtension(r,u){let m=r,R=(r==null?void 0:r.scopePath)??null;for(const I of u)R=C.ScopeStack.push(R,I.scopeNames),m=new c(m,R,I.encodedTokenAttributes);return m}static createRoot(r,u){return new c(null,new C.ScopeStack(null,r),u)}static createRootAndLookUpScopeName(r,u,m){const R=m.getMetadataForScope(r),I=new C.ScopeStack(null,r),x=m.themeProvider.themeMatch(I),M=c.mergeAttributes(u,R,x);return new c(null,I,M)}get scopeName(){return this.scopePath.scopeName}toString(){return this.getScopeNames().join(" ")}equals(r){return c.equals(this,r)}static equals(r,u){for(;;){if(r===u||!r&&!u)return!0;if(!r||!u||r.scopeName!==u.scopeName||r.tokenAttributes!==u.tokenAttributes)return!1;r=r.parent,u=u.parent}}static mergeAttributes(r,u,m){let R=-1,I=0,x=0;return m!==null&&(R=m.fontStyle,I=m.foregroundId,x=m.backgroundId),n.EncodedTokenAttributes.set(r,u.languageId,u.tokenType,null,R,I,x)}pushAttributed(r,u){if(r===null)return this;if(r.indexOf(" ")===-1)return c._pushAttributed(this,r,u);const m=r.split(/ /g);let R=this;for(const I of m)R=c._pushAttributed(R,I,u);return R}static _pushAttributed(r,u,m){const R=m.getMetadataForScope(u),I=r.scopePath.push(u),x=m.themeProvider.themeMatch(I),M=c.mergeAttributes(r.tokenAttributes,R,x);return new c(r,I,M)}getScopeNames(){return this.scopePath.getSegments()}getExtensionIfDefined(r){var R;const u=[];let m=this;for(;m&&m!==r;)u.push({encodedTokenAttributes:m.tokenAttributes,scopeNames:m.scopePath.getExtensionIfDefined(((R=m.parent)==null?void 0:R.scopePath)??null)}),m=m.parent;return m===r?u.reverse():void 0}}t.AttributedScopeStack=c;class e{constructor(r,u,m,R,I,x,M,N){this.parent=r,this.ruleId=u,this.beginRuleCapturedEOL=I,this.endRule=x,this.nameScopesList=M,this.contentNameScopesList=N,this._stackElementBrand=void 0,this.depth=this.parent?this.parent.depth+1:1,this._enterPos=m,this._anchorPos=R}equals(r){return r!==null&&e._equals(this,r)}static _equals(r,u){return r===u||!!this._structuralEquals(r,u)&&c.equals(r.contentNameScopesList,u.contentNameScopesList)}static _structuralEquals(r,u){for(;;){if(r===u||!r&&!u)return!0;if(!r||!u||r.depth!==u.depth||r.ruleId!==u.ruleId||r.endRule!==u.endRule)return!1;r=r.parent,u=u.parent}}clone(){return this}static _reset(r){for(;r;)r._enterPos=-1,r._anchorPos=-1,r=r.parent}reset(){e._reset(this)}pop(){return this.parent}safePop(){return this.parent?this.parent:this}push(r,u,m,R,I,x,M){return new e(this,r,u,m,R,I,x,M)}getEnterPos(){return this._enterPos}getAnchorPos(){return this._anchorPos}getRule(r){return r.getRule(this.ruleId)}toString(){const r=[];return this._writeString(r,0),"["+r.join(",")+"]"}_writeString(r,u){var m,R;return this.parent&&(u=this.parent._writeString(r,u)),r[u++]=`(${this.ruleId}, ${(m=this.nameScopesList)==null?void 0:m.toString()}, ${(R=this.contentNameScopesList)==null?void 0:R.toString()})`,u}withContentNameScopesList(r){return this.contentNameScopesList===r?this:this.parent.push(this.ruleId,this._enterPos,this._anchorPos,this.beginRuleCapturedEOL,this.endRule,this.nameScopesList,r)}withEndRule(r){return this.endRule===r?this:new e(this.parent,this.ruleId,this._enterPos,this._anchorPos,this.beginRuleCapturedEOL,r,this.nameScopesList,this.contentNameScopesList)}hasSameRuleAs(r){let u=this;for(;u&&u._enterPos===r._enterPos;){if(u.ruleId===r.ruleId)return!0;u=u.parent}return!1}toStateStackFrame(){var r,u,m;return{ruleId:p.ruleIdToNumber(this.ruleId),beginRuleCapturedEOL:this.beginRuleCapturedEOL,endRule:this.endRule,nameScopesList:((u=this.nameScopesList)==null?void 0:u.getExtensionIfDefined(((r=this.parent)==null?void 0:r.nameScopesList)??null))??[],contentNameScopesList:((m=this.contentNameScopesList)==null?void 0:m.getExtensionIfDefined(this.nameScopesList))??[]}}static pushFrame(r,u){const m=c.fromExtension((r==null?void 0:r.nameScopesList)??null,u.nameScopesList);return new e(r,p.ruleIdFromNumber(u.ruleId),u.enterPos??-1,u.anchorPos??-1,u.beginRuleCapturedEOL,u.endRule,m,c.fromExtension(m,u.contentNameScopesList))}}t.StateStackImpl=e,e.NULL=new e(null,0,0,0,!1,null,null,null),t.BalancedBracketSelectors=class{constructor(o,r){this.allowAny=!1,this.balancedBracketScopes=o.flatMap(u=>u==="*"?(this.allowAny=!0,[]):_.createMatchers(u,y).map(m=>m.matcher)),this.unbalancedBracketScopes=r.flatMap(u=>_.createMatchers(u,y).map(m=>m.matcher))}get matchesAlways(){return this.allowAny&&this.unbalancedBracketScopes.length===0}get matchesNever(){return this.balancedBracketScopes.length===0&&!this.allowAny}match(o){for(const r of this.unbalancedBracketScopes)if(r(o))return!1;for(const r of this.balancedBracketScopes)if(r(o))return!0;return this.allowAny}};class s{constructor(r,u,m,R){this.balancedBracketSelectors=R,this._emitBinaryTokens=r,this._tokenTypeOverrides=m,l.DebugFlags.InDebugMode?this._lineText=u:this._lineText=null,this._tokens=[],this._binaryTokens=[],this._lastTokenEndIndex=0}produce(r,u){this.produceFromScopes(r.contentNameScopesList,u)}produceFromScopes(r,u){var R;if(this._lastTokenEndIndex>=u)return;if(this._emitBinaryTokens){let I=(r==null?void 0:r.tokenAttributes)??0,x=!1;if((R=this.balancedBracketSelectors)!=null&&R.matchesAlways&&(x=!0),this._tokenTypeOverrides.length>0||this.balancedBracketSelectors&&!this.balancedBracketSelectors.matchesAlways&&!this.balancedBracketSelectors.matchesNever){const M=(r==null?void 0:r.getScopeNames())??[];for(const N of this._tokenTypeOverrides)N.matcher(M)&&(I=n.EncodedTokenAttributes.set(I,0,n.toOptionalTokenType(N.type),null,-1,0,0));this.balancedBracketSelectors&&(x=this.balancedBracketSelectors.match(M))}if(x&&(I=n.EncodedTokenAttributes.set(I,0,8,x,-1,0,0)),this._binaryTokens.length>0&&this._binaryTokens[this._binaryTokens.length-1]===I)return void(this._lastTokenEndIndex=u);if(l.DebugFlags.InDebugMode){const M=(r==null?void 0:r.getScopeNames())??[];console.log("  token: |"+this._lineText.substring(this._lastTokenEndIndex,u).replace(/\n$/,"\\n")+"|");for(let N=0;N<M.length;N++)console.log("      * "+M[N])}return this._binaryTokens.push(this._lastTokenEndIndex),this._binaryTokens.push(I),void(this._lastTokenEndIndex=u)}const m=(r==null?void 0:r.getScopeNames())??[];if(l.DebugFlags.InDebugMode){console.log("  token: |"+this._lineText.substring(this._lastTokenEndIndex,u).replace(/\n$/,"\\n")+"|");for(let I=0;I<m.length;I++)console.log("      * "+m[I])}this._tokens.push({startIndex:this._lastTokenEndIndex,endIndex:u,scopes:m}),this._lastTokenEndIndex=u}getResult(r,u){return this._tokens.length>0&&this._tokens[this._tokens.length-1].startIndex===u-1&&this._tokens.pop(),this._tokens.length===0&&(this._lastTokenEndIndex=-1,this.produce(r,u),this._tokens[this._tokens.length-1].startIndex=0),this._tokens}getBinaryResult(r,u){this._binaryTokens.length>0&&this._binaryTokens[this._binaryTokens.length-2]===u-1&&(this._binaryTokens.pop(),this._binaryTokens.pop()),this._binaryTokens.length===0&&(this._lastTokenEndIndex=-1,this.produce(r,u),this._binaryTokens[this._binaryTokens.length-2]=0);const m=new Uint32Array(this._binaryTokens.length);for(let R=0,I=this._binaryTokens.length;R<I;R++)m[R]=this._binaryTokens[R];return m}}t.LineTokens=s},965:(h,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseInclude=t.TopLevelRepositoryReference=t.TopLevelReference=t.RelativeReference=t.SelfReference=t.BaseReference=t.ScopeDependencyProcessor=t.ExternalReferenceCollector=t.TopLevelRepositoryRuleReference=t.TopLevelRuleReference=void 0;const l=a(878);class n{constructor(e){this.scopeName=e}toKey(){return this.scopeName}}t.TopLevelRuleReference=n;class _{constructor(e,s){this.scopeName=e,this.ruleName=s}toKey(){return`${this.scopeName}#${this.ruleName}`}}t.TopLevelRepositoryRuleReference=_;class v{constructor(){this._references=[],this._seenReferenceKeys=new Set,this.visitedRule=new Set}get references(){return this._references}add(e){const s=e.toKey();this._seenReferenceKeys.has(s)||(this._seenReferenceKeys.add(s),this._references.push(e))}}function p(c,e,s,o){const r=s.lookup(c.scopeName);if(!r){if(c.scopeName===e)throw new Error(`No grammar provided for <${e}>`);return}const u=s.lookup(e);c instanceof n?A({baseGrammar:u,selfGrammar:r},o):C(c.ruleName,{baseGrammar:u,selfGrammar:r,repository:r.repository},o);const m=s.injections(c.scopeName);if(m)for(const R of m)o.add(new n(R))}function C(c,e,s){e.repository&&e.repository[c]&&w([e.repository[c]],e,s)}function A(c,e){c.selfGrammar.patterns&&Array.isArray(c.selfGrammar.patterns)&&w(c.selfGrammar.patterns,{...c,repository:c.selfGrammar.repository},e),c.selfGrammar.injections&&w(Object.values(c.selfGrammar.injections),{...c,repository:c.selfGrammar.repository},e)}function w(c,e,s){for(const o of c){if(s.visitedRule.has(o))continue;s.visitedRule.add(o);const r=o.repository?l.mergeObjects({},e.repository,o.repository):e.repository;Array.isArray(o.patterns)&&w(o.patterns,{...e,repository:r},s);const u=o.include;if(!u)continue;const m=k(u);switch(m.kind){case 0:A({...e,selfGrammar:e.baseGrammar},s);break;case 1:A(e,s);break;case 2:C(m.ruleName,{...e,repository:r},s);break;case 3:case 4:const R=m.scopeName===e.selfGrammar.scopeName?e.selfGrammar:m.scopeName===e.baseGrammar.scopeName?e.baseGrammar:void 0;if(R){const I={baseGrammar:e.baseGrammar,selfGrammar:R,repository:r};m.kind===4?C(m.ruleName,I,s):A(I,s)}else m.kind===4?s.add(new _(m.scopeName,m.ruleName)):s.add(new n(m.scopeName))}}}t.ExternalReferenceCollector=v,t.ScopeDependencyProcessor=class{constructor(c,e){this.repo=c,this.initialScopeName=e,this.seenFullScopeRequests=new Set,this.seenPartialScopeRequests=new Set,this.seenFullScopeRequests.add(this.initialScopeName),this.Q=[new n(this.initialScopeName)]}processQueue(){const c=this.Q;this.Q=[];const e=new v;for(const s of c)p(s,this.initialScopeName,this.repo,e);for(const s of e.references)if(s instanceof n){if(this.seenFullScopeRequests.has(s.scopeName))continue;this.seenFullScopeRequests.add(s.scopeName),this.Q.push(s)}else{if(this.seenFullScopeRequests.has(s.scopeName)||this.seenPartialScopeRequests.has(s.toKey()))continue;this.seenPartialScopeRequests.add(s.toKey()),this.Q.push(s)}}};class L{constructor(){this.kind=0}}t.BaseReference=L;class S{constructor(){this.kind=1}}t.SelfReference=S;class y{constructor(e){this.ruleName=e,this.kind=2}}t.RelativeReference=y;class g{constructor(e){this.scopeName=e,this.kind=3}}t.TopLevelReference=g;class b{constructor(e,s){this.scopeName=e,this.ruleName=s,this.kind=4}}function k(c){if(c==="$base")return new L;if(c==="$self")return new S;const e=c.indexOf("#");if(e===-1)return new g(c);if(e===0)return new y(c.substring(1));{const s=c.substring(0,e),o=c.substring(e+1);return new b(s,o)}}t.TopLevelRepositoryReference=b,t.parseInclude=k},391:function(h,t,a){var l=this&&this.__createBinding||(Object.create?function(_,v,p,C){C===void 0&&(C=p),Object.defineProperty(_,C,{enumerable:!0,get:function(){return v[p]}})}:function(_,v,p,C){C===void 0&&(C=p),_[C]=v[p]}),n=this&&this.__exportStar||function(_,v){for(var p in _)p==="default"||Object.prototype.hasOwnProperty.call(v,p)||l(v,_,p)};Object.defineProperty(t,"__esModule",{value:!0}),n(a(947),t)},47:(h,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LocalStackElement=t._tokenizeString=void 0;const l=a(350),n=a(44),_=a(792),v=a(878);class p{constructor(b,k){this.stack=b,this.stoppedEarly=k}}function C(g,b,k,c,e,s,o,r){const u=b.content.length;let m=!1,R=-1;if(o){const M=function(N,K,V,F,$,Z){let Y=$.beginRuleCapturedEOL?0:-1;const W=[];for(let z=$;z;z=z.pop()){const B=z.getRule(N);B instanceof _.BeginWhileRule&&W.push({rule:B,stack:z})}for(let z=W.pop();z;z=W.pop()){const{ruleScanner:B,findOptions:ce}=w(z.rule,N,z.stack.endRule,V,F===Y),P=B.findNextMatchSync(K,F,ce);if(l.DebugFlags.InDebugMode&&(console.log("  scanning for while rule"),console.log(B.toString())),!P){l.DebugFlags.InDebugMode&&console.log("  popping "+z.rule.debugName+" - "+z.rule.debugWhileRegExp),$=z.stack.pop();break}if(P.ruleId!==_.whileRuleId){$=z.stack.pop();break}P.captureIndices&&P.captureIndices.length&&(Z.produce(z.stack,P.captureIndices[0].start),S(N,K,V,z.stack,Z,z.rule.whileCaptures,P.captureIndices),Z.produce(z.stack,P.captureIndices[0].end),Y=P.captureIndices[0].end,P.captureIndices[0].end>F&&(F=P.captureIndices[0].end,V=!1))}return{stack:$,linePos:F,anchorPosition:Y,isFirstLine:V}}(g,b,k,c,e,s);e=M.stack,c=M.linePos,k=M.isFirstLine,R=M.anchorPosition}const I=Date.now();for(;!m;){if(r!==0&&Date.now()-I>r)return new p(e,!0);x()}return new p(e,!1);function x(){l.DebugFlags.InDebugMode&&(console.log(""),console.log(`@@scanNext ${c}: |${b.content.substr(c).replace(/\n$/,"\\n")}|`));const M=function(F,$,Z,Y,W,z){const B=function(se,pe,fe,me,he,we){const _e=he.getRule(se),{ruleScanner:ye,findOptions:ke}=A(_e,se,he.endRule,fe,me===we);let ie=0;l.DebugFlags.InDebugMode&&(ie=v.performanceNow());const re=ye.findNextMatchSync(pe,me,ke);if(l.DebugFlags.InDebugMode){const Se=v.performanceNow()-ie;Se>5&&console.warn(`Rule ${_e.debugName} (${_e.id}) matching took ${Se} against '${pe}'`),console.log(`  scanning for (linePos: ${me}, anchorPosition: ${we})`),console.log(ye.toString()),re&&console.log(`matched rule id: ${re.ruleId} from ${re.captureIndices[0].start} to ${re.captureIndices[0].end}`)}return re?{captureIndices:re.captureIndices,matchedRuleId:re.ruleId}:null}(F,$,Z,Y,W,z),ce=F.getInjections();if(ce.length===0)return B;const P=function(se,pe,fe,me,he,we,_e){let ye,ke=Number.MAX_VALUE,ie=null,re=0;const Se=we.contentNameScopesList.getScopeNames();for(let E=0,G=se.length;E<G;E++){const ee=se[E];if(!ee.matcher(Se))continue;const oe=pe.getRule(ee.ruleId),{ruleScanner:q,findOptions:J}=A(oe,pe,null,me,he===_e),te=q.findNextMatchSync(fe,he,J);if(!te)continue;l.DebugFlags.InDebugMode&&(console.log(`  matched injection: ${ee.debugSelector}`),console.log(q.toString()));const ue=te.captureIndices[0].start;if(!(ue>=ke)&&(ke=ue,ie=te.captureIndices,ye=te.ruleId,re=ee.priority,ke===he))break}return ie?{priorityMatch:re===-1,captureIndices:ie,matchedRuleId:ye}:null}(ce,F,$,Z,Y,W,z);if(!P)return B;if(!B)return P;const X=B.captureIndices[0].start,U=P.captureIndices[0].start;return U<X||P.priorityMatch&&U===X?P:B}(g,b,k,c,e,R);if(!M)return l.DebugFlags.InDebugMode&&console.log("  no more matches."),s.produce(e,u),void(m=!0);const N=M.captureIndices,K=M.matchedRuleId,V=!!(N&&N.length>0)&&N[0].end>c;if(K===_.endRuleId){const F=e.getRule(g);l.DebugFlags.InDebugMode&&console.log("  popping "+F.debugName+" - "+F.debugEndRegExp),s.produce(e,N[0].start),e=e.withContentNameScopesList(e.nameScopesList),S(g,b,k,e,s,F.endCaptures,N),s.produce(e,N[0].end);const $=e;if(e=e.parent,R=$.getAnchorPos(),!V&&$.getEnterPos()===c)return l.DebugFlags.InDebugMode&&console.error("[1] - Grammar is in an endless loop - Grammar pushed & popped a rule without advancing"),e=$,s.produce(e,u),void(m=!0)}else{const F=g.getRule(K);s.produce(e,N[0].start);const $=e,Z=F.getName(b.content,N),Y=e.contentNameScopesList.pushAttributed(Z,g);if(e=e.push(K,c,R,N[0].end===u,null,Y,Y),F instanceof _.BeginEndRule){const W=F;l.DebugFlags.InDebugMode&&console.log("  pushing "+W.debugName+" - "+W.debugBeginRegExp),S(g,b,k,e,s,W.beginCaptures,N),s.produce(e,N[0].end),R=N[0].end;const z=W.getContentName(b.content,N),B=Y.pushAttributed(z,g);if(e=e.withContentNameScopesList(B),W.endHasBackReferences&&(e=e.withEndRule(W.getEndWithResolvedBackReferences(b.content,N))),!V&&$.hasSameRuleAs(e))return l.DebugFlags.InDebugMode&&console.error("[2] - Grammar is in an endless loop - Grammar pushed the same rule without advancing"),e=e.pop(),s.produce(e,u),void(m=!0)}else if(F instanceof _.BeginWhileRule){const W=F;l.DebugFlags.InDebugMode&&console.log("  pushing "+W.debugName),S(g,b,k,e,s,W.beginCaptures,N),s.produce(e,N[0].end),R=N[0].end;const z=W.getContentName(b.content,N),B=Y.pushAttributed(z,g);if(e=e.withContentNameScopesList(B),W.whileHasBackReferences&&(e=e.withEndRule(W.getWhileWithResolvedBackReferences(b.content,N))),!V&&$.hasSameRuleAs(e))return l.DebugFlags.InDebugMode&&console.error("[3] - Grammar is in an endless loop - Grammar pushed the same rule without advancing"),e=e.pop(),s.produce(e,u),void(m=!0)}else{const W=F;if(l.DebugFlags.InDebugMode&&console.log("  matched "+W.debugName+" - "+W.debugMatchRegExp),S(g,b,k,e,s,W.captures,N),s.produce(e,N[0].end),e=e.pop(),!V)return l.DebugFlags.InDebugMode&&console.error("[4] - Grammar is in an endless loop - Grammar is not advancing, nor is it pushing/popping"),e=e.safePop(),s.produce(e,u),void(m=!0)}}N[0].end>c&&(c=N[0].end,k=!1)}}function A(g,b,k,c,e){return l.UseOnigurumaFindOptions?{ruleScanner:g.compile(b,k),findOptions:L(c,e)}:{ruleScanner:g.compileAG(b,k,c,e),findOptions:0}}function w(g,b,k,c,e){return l.UseOnigurumaFindOptions?{ruleScanner:g.compileWhile(b,k),findOptions:L(c,e)}:{ruleScanner:g.compileWhileAG(b,k,c,e),findOptions:0}}function L(g,b){let k=0;return g||(k|=1),b||(k|=4),k}function S(g,b,k,c,e,s,o){if(s.length===0)return;const r=b.content,u=Math.min(s.length,o.length),m=[],R=o[0].end;for(let I=0;I<u;I++){const x=s[I];if(x===null)continue;const M=o[I];if(M.length===0)continue;if(M.start>R)break;for(;m.length>0&&m[m.length-1].endPos<=M.start;)e.produceFromScopes(m[m.length-1].scopes,m[m.length-1].endPos),m.pop();if(m.length>0?e.produceFromScopes(m[m.length-1].scopes,M.start):e.produce(c,M.start),x.retokenizeCapturedWithRuleId){const K=x.getName(r,o),V=c.contentNameScopesList.pushAttributed(K,g),F=x.getContentName(r,o),$=V.pushAttributed(F,g),Z=c.push(x.retokenizeCapturedWithRuleId,M.start,-1,!1,null,V,$),Y=g.createOnigString(r.substring(0,M.end));C(g,Y,k&&M.start===0,M.start,Z,e,!1,0),n.disposeOnigString(Y);continue}const N=x.getName(r,o);if(N!==null){const K=(m.length>0?m[m.length-1].scopes:c.contentNameScopesList).pushAttributed(N,g);m.push(new y(K,M.end))}}for(;m.length>0;)e.produceFromScopes(m[m.length-1].scopes,m[m.length-1].endPos),m.pop()}t._tokenizeString=C;class y{constructor(b,k){this.scopes=b,this.endPos=k}}t.LocalStackElement=y},974:(h,t)=>{function a(v,p){throw new Error("Near offset "+v.pos+": "+p+" ~~~"+v.source.substr(v.pos,50)+"~~~")}Object.defineProperty(t,"__esModule",{value:!0}),t.parseJSON=void 0,t.parseJSON=function(v,p,C){let A=new l(v),w=new n,L=0,S=null,y=[],g=[];function b(){y.push(L),g.push(S)}function k(){L=y.pop(),S=g.pop()}function c(e){a(A,e)}for(;_(A,w);){if(L===0){if(S!==null&&c("too many constructs in root"),w.type===3){S={},C&&(S.$vscodeTextmateLocation=w.toLocation(p)),b(),L=1;continue}if(w.type===2){S=[],b(),L=4;continue}c("unexpected token in root")}if(L===2){if(w.type===5){k();continue}if(w.type===7){L=3;continue}c("expected , or }")}if(L===1||L===3){if(L===1&&w.type===5){k();continue}if(w.type===1){let e=w.value;if(_(A,w)&&w.type===6||c("expected colon"),_(A,w)||c("expected value"),L=2,w.type===1){S[e]=w.value;continue}if(w.type===8){S[e]=null;continue}if(w.type===9){S[e]=!0;continue}if(w.type===10){S[e]=!1;continue}if(w.type===11){S[e]=parseFloat(w.value);continue}if(w.type===2){let s=[];S[e]=s,b(),L=4,S=s;continue}if(w.type===3){let s={};C&&(s.$vscodeTextmateLocation=w.toLocation(p)),S[e]=s,b(),L=1,S=s;continue}}c("unexpected token in dict")}if(L===5){if(w.type===4){k();continue}if(w.type===7){L=6;continue}c("expected , or ]")}if(L===4||L===6){if(L===4&&w.type===4){k();continue}if(L=5,w.type===1){S.push(w.value);continue}if(w.type===8){S.push(null);continue}if(w.type===9){S.push(!0);continue}if(w.type===10){S.push(!1);continue}if(w.type===11){S.push(parseFloat(w.value));continue}if(w.type===2){let e=[];S.push(e),b(),L=4,S=e;continue}if(w.type===3){let e={};C&&(e.$vscodeTextmateLocation=w.toLocation(p)),S.push(e),b(),L=1,S=e;continue}c("unexpected token in array")}c("unknown state")}return g.length!==0&&c("unclosed constructs"),S};class l{constructor(p){this.source=p,this.pos=0,this.len=p.length,this.line=1,this.char=0}}class n{constructor(){this.value=null,this.type=0,this.offset=-1,this.len=-1,this.line=-1,this.char=-1}toLocation(p){return{filename:p,line:this.line,char:this.char}}}function _(v,p){p.value=null,p.type=0,p.offset=-1,p.len=-1,p.line=-1,p.char=-1;let C,A=v.source,w=v.pos,L=v.len,S=v.line,y=v.char;for(;;){if(w>=L)return!1;if(C=A.charCodeAt(w),C!==32&&C!==9&&C!==13){if(C!==10)break;w++,S++,y=0}else w++,y++}if(p.offset=w,p.line=S,p.char=y,C===34){for(p.type=1,w++,y++;;){if(w>=L)return!1;if(C=A.charCodeAt(w),w++,y++,C!==92){if(C===34)break}else w++,y++}p.value=A.substring(p.offset+1,w-1).replace(/\\u([0-9A-Fa-f]{4})/g,(g,b)=>String.fromCodePoint(parseInt(b,16))).replace(/\\(.)/g,(g,b)=>{switch(b){case'"':return'"';case"\\":return"\\";case"/":return"/";case"b":return"\b";case"f":return"\f";case"n":return`
`;case"r":return"\r";case"t":return"	";default:a(v,"invalid escape sequence")}throw new Error("unreachable")})}else if(C===91)p.type=2,w++,y++;else if(C===123)p.type=3,w++,y++;else if(C===93)p.type=4,w++,y++;else if(C===125)p.type=5,w++,y++;else if(C===58)p.type=6,w++,y++;else if(C===44)p.type=7,w++,y++;else if(C===110){if(p.type=8,w++,y++,C=A.charCodeAt(w),C!==117||(w++,y++,C=A.charCodeAt(w),C!==108)||(w++,y++,C=A.charCodeAt(w),C!==108))return!1;w++,y++}else if(C===116){if(p.type=9,w++,y++,C=A.charCodeAt(w),C!==114||(w++,y++,C=A.charCodeAt(w),C!==117)||(w++,y++,C=A.charCodeAt(w),C!==101))return!1;w++,y++}else if(C===102){if(p.type=10,w++,y++,C=A.charCodeAt(w),C!==97||(w++,y++,C=A.charCodeAt(w),C!==108)||(w++,y++,C=A.charCodeAt(w),C!==115)||(w++,y++,C=A.charCodeAt(w),C!==101))return!1;w++,y++}else for(p.type=11;;){if(w>=L)return!1;if(C=A.charCodeAt(w),!(C===46||C>=48&&C<=57||C===101||C===69||C===45||C===43))break;w++,y++}return p.len=w-p.offset,p.value===null&&(p.value=A.substr(p.offset,p.len)),v.pos=w,v.line=S,v.char=y,!0}},787:function(h,t,a){var l=this&&this.__createBinding||(Object.create?function(L,S,y,g){g===void 0&&(g=y),Object.defineProperty(L,g,{enumerable:!0,get:function(){return S[y]}})}:function(L,S,y,g){g===void 0&&(g=y),L[g]=S[y]}),n=this&&this.__exportStar||function(L,S){for(var y in L)y==="default"||Object.prototype.hasOwnProperty.call(S,y)||l(S,L,y)};Object.defineProperty(t,"__esModule",{value:!0}),t.applyStateStackDiff=t.diffStateStacksRefEq=t.parseRawGrammar=t.INITIAL=t.Registry=void 0;const _=a(391),v=a(50),p=a(652),C=a(583),A=a(965),w=a(442);Object.defineProperty(t,"applyStateStackDiff",{enumerable:!0,get:function(){return w.applyStateStackDiff}}),Object.defineProperty(t,"diffStateStacksRefEq",{enumerable:!0,get:function(){return w.diffStateStacksRefEq}}),n(a(44),t),t.Registry=class{constructor(L){this._options=L,this._syncRegistry=new p.SyncRegistry(C.Theme.createFromRawTheme(L.theme,L.colorMap),L.onigLib),this._ensureGrammarCache=new Map}dispose(){this._syncRegistry.dispose()}setTheme(L,S){this._syncRegistry.setTheme(C.Theme.createFromRawTheme(L,S))}getColorMap(){return this._syncRegistry.getColorMap()}loadGrammarWithEmbeddedLanguages(L,S,y){return this.loadGrammarWithConfiguration(L,S,{embeddedLanguages:y})}loadGrammarWithConfiguration(L,S,y){return this._loadGrammar(L,S,y.embeddedLanguages,y.tokenTypes,new _.BalancedBracketSelectors(y.balancedBracketSelectors||[],y.unbalancedBracketSelectors||[]))}loadGrammar(L){return this._loadGrammar(L,0,null,null,null)}async _loadGrammar(L,S,y,g,b){const k=new A.ScopeDependencyProcessor(this._syncRegistry,L);for(;k.Q.length>0;)await Promise.all(k.Q.map(c=>this._loadSingleGrammar(c.scopeName))),k.processQueue();return this._grammarForScopeName(L,S,y,g,b)}async _loadSingleGrammar(L){return this._ensureGrammarCache.has(L)||this._ensureGrammarCache.set(L,this._doLoadSingleGrammar(L)),this._ensureGrammarCache.get(L)}async _doLoadSingleGrammar(L){const S=await this._options.loadGrammar(L);if(S){const y=typeof this._options.getInjections=="function"?this._options.getInjections(L):void 0;this._syncRegistry.addGrammar(S,y)}}async addGrammar(L,S=[],y=0,g=null){return this._syncRegistry.addGrammar(L,S),await this._grammarForScopeName(L.scopeName,y,g)}_grammarForScopeName(L,S=0,y=null,g=null,b=null){return this._syncRegistry.grammarForScopeName(L,S,y,g,b)}},t.INITIAL=_.StateStackImpl.NULL,t.parseRawGrammar=v.parseRawGrammar},736:(h,t)=>{function a(l){return!!l&&!!l.match(/[\w\.:]+/)}Object.defineProperty(t,"__esModule",{value:!0}),t.createMatchers=void 0,t.createMatchers=function(l,n){const _=[],v=function(w){let L=/([LR]:|[\w\.:][\w\.:\-]*|[\,\|\-\(\)])/g,S=L.exec(w);return{next:()=>{if(!S)return null;const y=S[0];return S=L.exec(w),y}}}(l);let p=v.next();for(;p!==null;){let w=0;if(p.length===2&&p.charAt(1)===":"){switch(p.charAt(0)){case"R":w=1;break;case"L":w=-1;break;default:console.log(`Unknown priority ${p} in scope selector`)}p=v.next()}let L=A();if(_.push({matcher:L,priority:w}),p!==",")break;p=v.next()}return _;function C(){if(p==="-"){p=v.next();const w=C();return L=>!!w&&!w(L)}if(p==="("){p=v.next();const w=function(){const L=[];let S=A();for(;S&&(L.push(S),p==="|"||p===",");){do p=v.next();while(p==="|"||p===",");S=A()}return y=>L.some(g=>g(y))}();return p===")"&&(p=v.next()),w}if(a(p)){const w=[];do w.push(p),p=v.next();while(a(p));return L=>n(w,L)}return null}function A(){const w=[];let L=C();for(;L;)w.push(L),L=C();return S=>w.every(y=>y(S))}}},44:(h,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.disposeOnigString=void 0,t.disposeOnigString=function(a){typeof a.dispose=="function"&&a.dispose()}},50:(h,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseRawGrammar=void 0;const l=a(69),n=a(350),_=a(974);t.parseRawGrammar=function(v,p=null){return p!==null&&/\.json$/.test(p)?(C=v,A=p,n.DebugFlags.InDebugMode?_.parseJSON(C,A,!0):JSON.parse(C)):function(w,L){return n.DebugFlags.InDebugMode?l.parseWithLocation(w,L,"$vscodeTextmateLocation"):l.parsePLIST(w)}(v,p);var C,A}},69:(h,t)=>{function a(l,n,_){const v=l.length;let p=0,C=1,A=0;function w(P){if(_===null)p+=P;else for(;P>0;)l.charCodeAt(p)===10?(p++,C++,A=0):(p++,A++),P--}function L(P){_===null?p=P:w(P-p)}function S(){for(;p<v;){let P=l.charCodeAt(p);if(P!==32&&P!==9&&P!==13&&P!==10)break;w(1)}}function y(P){return l.substr(p,P.length)===P&&(w(P.length),!0)}function g(P){let X=l.indexOf(P,p);L(X!==-1?X+P.length:v)}function b(P){let X=l.indexOf(P,p);if(X!==-1){let U=l.substring(p,X);return L(X+P.length),U}{let U=l.substr(p);return L(v),U}}v>0&&l.charCodeAt(0)===65279&&(p=1);let k=0,c=null,e=[],s=[],o=null;function r(P,X){e.push(k),s.push(c),k=P,c=X}function u(){if(e.length===0)return m("illegal state stack");k=e.pop(),c=s.pop()}function m(P){throw new Error("Near offset "+p+": "+P+" ~~~"+l.substr(p,50)+"~~~")}const R=function(){if(o===null)return m("missing <key>");let P={};_!==null&&(P[_]={filename:n,line:C,char:A}),c[o]=P,o=null,r(1,P)},I=function(){if(o===null)return m("missing <key>");let P=[];c[o]=P,o=null,r(2,P)},x=function(){let P={};_!==null&&(P[_]={filename:n,line:C,char:A}),c.push(P),r(1,P)},M=function(){let P=[];c.push(P),r(2,P)};function N(){if(k!==1)return m("unexpected </dict>");u()}function K(){return k===1||k!==2?m("unexpected </array>"):void u()}function V(P){if(k===1){if(o===null)return m("missing <key>");c[o]=P,o=null}else k===2?c.push(P):c=P}function F(P){if(isNaN(P))return m("cannot parse float");if(k===1){if(o===null)return m("missing <key>");c[o]=P,o=null}else k===2?c.push(P):c=P}function $(P){if(isNaN(P))return m("cannot parse integer");if(k===1){if(o===null)return m("missing <key>");c[o]=P,o=null}else k===2?c.push(P):c=P}function Z(P){if(k===1){if(o===null)return m("missing <key>");c[o]=P,o=null}else k===2?c.push(P):c=P}function Y(P){if(k===1){if(o===null)return m("missing <key>");c[o]=P,o=null}else k===2?c.push(P):c=P}function W(P){if(k===1){if(o===null)return m("missing <key>");c[o]=P,o=null}else k===2?c.push(P):c=P}function z(){let P=b(">"),X=!1;return P.charCodeAt(P.length-1)===47&&(X=!0,P=P.substring(0,P.length-1)),{name:P.trim(),isClosed:X}}function B(P){if(P.isClosed)return"";let X=b("</");return g(">"),X.replace(/&#([0-9]+);/g,function(U,se){return String.fromCodePoint(parseInt(se,10))}).replace(/&#x([0-9a-f]+);/g,function(U,se){return String.fromCodePoint(parseInt(se,16))}).replace(/&amp;|&lt;|&gt;|&quot;|&apos;/g,function(U){switch(U){case"&amp;":return"&";case"&lt;":return"<";case"&gt;":return">";case"&quot;":return'"';case"&apos;":return"'"}return U})}for(;p<v&&(S(),!(p>=v));){const P=l.charCodeAt(p);if(w(1),P!==60)return m("expected <");if(p>=v)return m("unexpected end of input");const X=l.charCodeAt(p);if(X===63){w(1),g("?>");continue}if(X===33){if(w(1),y("--")){g("-->");continue}g(">");continue}if(X===47){if(w(1),S(),y("plist")){g(">");continue}if(y("dict")){g(">"),N();continue}if(y("array")){g(">"),K();continue}return m("unexpected closed tag")}let U=z();switch(U.name){case"dict":k===1?R():k===2?x():(c={},_!==null&&(c[_]={filename:n,line:C,char:A}),r(1,c)),U.isClosed&&N();continue;case"array":k===1?I():k===2?M():(c=[],r(2,c)),U.isClosed&&K();continue;case"key":ce=B(U),k!==1?m("unexpected <key>"):o!==null?m("too many <key>"):o=ce;continue;case"string":V(B(U));continue;case"real":F(parseFloat(B(U)));continue;case"integer":$(parseInt(B(U),10));continue;case"date":Z(new Date(B(U)));continue;case"data":Y(B(U));continue;case"true":B(U),W(!0);continue;case"false":B(U),W(!1);continue}if(!/^plist/.test(U.name))return m("unexpected opened tag "+U.name)}var ce;return c}Object.defineProperty(t,"__esModule",{value:!0}),t.parsePLIST=t.parseWithLocation=void 0,t.parseWithLocation=function(l,n,_){return a(l,n,_)},t.parsePLIST=function(l){return a(l,null,null)}},652:(h,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SyncRegistry=void 0;const l=a(391);t.SyncRegistry=class{constructor(n,_){this._onigLibPromise=_,this._grammars=new Map,this._rawGrammars=new Map,this._injectionGrammars=new Map,this._theme=n}dispose(){for(const n of this._grammars.values())n.dispose()}setTheme(n){this._theme=n}getColorMap(){return this._theme.getColorMap()}addGrammar(n,_){this._rawGrammars.set(n.scopeName,n),_&&this._injectionGrammars.set(n.scopeName,_)}lookup(n){return this._rawGrammars.get(n)}injections(n){return this._injectionGrammars.get(n)}getDefaults(){return this._theme.getDefaults()}themeMatch(n){return this._theme.match(n)}async grammarForScopeName(n,_,v,p,C){if(!this._grammars.has(n)){let A=this._rawGrammars.get(n);if(!A)return null;this._grammars.set(n,l.createGrammar(n,A,_,v,p,C,this,await this._onigLibPromise))}return this._grammars.get(n)}}},792:(h,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CompiledRule=t.RegExpSourceList=t.RegExpSource=t.RuleFactory=t.BeginWhileRule=t.BeginEndRule=t.IncludeOnlyRule=t.MatchRule=t.CaptureRule=t.Rule=t.ruleIdToNumber=t.ruleIdFromNumber=t.whileRuleId=t.endRuleId=void 0;const l=a(878),n=a(965),_=/\\(\d+)/,v=/\\(\d+)/g;t.endRuleId=-1,t.whileRuleId=-2,t.ruleIdFromNumber=function(c){return c},t.ruleIdToNumber=function(c){return c};class p{constructor(e,s,o,r){this.$location=e,this.id=s,this._name=o||null,this._nameIsCapturing=l.RegexSource.hasCaptures(this._name),this._contentName=r||null,this._contentNameIsCapturing=l.RegexSource.hasCaptures(this._contentName)}get debugName(){const e=this.$location?`${l.basename(this.$location.filename)}:${this.$location.line}`:"unknown";return`${this.constructor.name}#${this.id} @ ${e}`}getName(e,s){return this._nameIsCapturing&&this._name!==null&&e!==null&&s!==null?l.RegexSource.replaceCaptures(this._name,e,s):this._name}getContentName(e,s){return this._contentNameIsCapturing&&this._contentName!==null?l.RegexSource.replaceCaptures(this._contentName,e,s):this._contentName}}t.Rule=p;class C extends p{constructor(e,s,o,r,u){super(e,s,o,r),this.retokenizeCapturedWithRuleId=u}dispose(){}collectPatterns(e,s){throw new Error("Not supported!")}compile(e,s){throw new Error("Not supported!")}compileAG(e,s,o,r){throw new Error("Not supported!")}}t.CaptureRule=C;class A extends p{constructor(e,s,o,r,u){super(e,s,o,null),this._match=new g(r,this.id),this.captures=u,this._cachedCompiledPatterns=null}dispose(){this._cachedCompiledPatterns&&(this._cachedCompiledPatterns.dispose(),this._cachedCompiledPatterns=null)}get debugMatchRegExp(){return`${this._match.source}`}collectPatterns(e,s){s.push(this._match)}compile(e,s){return this._getCachedCompiledPatterns(e).compile(e)}compileAG(e,s,o,r){return this._getCachedCompiledPatterns(e).compileAG(e,o,r)}_getCachedCompiledPatterns(e){return this._cachedCompiledPatterns||(this._cachedCompiledPatterns=new b,this.collectPatterns(e,this._cachedCompiledPatterns)),this._cachedCompiledPatterns}}t.MatchRule=A;class w extends p{constructor(e,s,o,r,u){super(e,s,o,r),this.patterns=u.patterns,this.hasMissingPatterns=u.hasMissingPatterns,this._cachedCompiledPatterns=null}dispose(){this._cachedCompiledPatterns&&(this._cachedCompiledPatterns.dispose(),this._cachedCompiledPatterns=null)}collectPatterns(e,s){for(const o of this.patterns)e.getRule(o).collectPatterns(e,s)}compile(e,s){return this._getCachedCompiledPatterns(e).compile(e)}compileAG(e,s,o,r){return this._getCachedCompiledPatterns(e).compileAG(e,o,r)}_getCachedCompiledPatterns(e){return this._cachedCompiledPatterns||(this._cachedCompiledPatterns=new b,this.collectPatterns(e,this._cachedCompiledPatterns)),this._cachedCompiledPatterns}}t.IncludeOnlyRule=w;class L extends p{constructor(e,s,o,r,u,m,R,I,x,M){super(e,s,o,r),this._begin=new g(u,this.id),this.beginCaptures=m,this._end=new g(R||"￿",-1),this.endHasBackReferences=this._end.hasBackReferences,this.endCaptures=I,this.applyEndPatternLast=x||!1,this.patterns=M.patterns,this.hasMissingPatterns=M.hasMissingPatterns,this._cachedCompiledPatterns=null}dispose(){this._cachedCompiledPatterns&&(this._cachedCompiledPatterns.dispose(),this._cachedCompiledPatterns=null)}get debugBeginRegExp(){return`${this._begin.source}`}get debugEndRegExp(){return`${this._end.source}`}getEndWithResolvedBackReferences(e,s){return this._end.resolveBackReferences(e,s)}collectPatterns(e,s){s.push(this._begin)}compile(e,s){return this._getCachedCompiledPatterns(e,s).compile(e)}compileAG(e,s,o,r){return this._getCachedCompiledPatterns(e,s).compileAG(e,o,r)}_getCachedCompiledPatterns(e,s){if(!this._cachedCompiledPatterns){this._cachedCompiledPatterns=new b;for(const o of this.patterns)e.getRule(o).collectPatterns(e,this._cachedCompiledPatterns);this.applyEndPatternLast?this._cachedCompiledPatterns.push(this._end.hasBackReferences?this._end.clone():this._end):this._cachedCompiledPatterns.unshift(this._end.hasBackReferences?this._end.clone():this._end)}return this._end.hasBackReferences&&(this.applyEndPatternLast?this._cachedCompiledPatterns.setSource(this._cachedCompiledPatterns.length()-1,s):this._cachedCompiledPatterns.setSource(0,s)),this._cachedCompiledPatterns}}t.BeginEndRule=L;class S extends p{constructor(e,s,o,r,u,m,R,I,x){super(e,s,o,r),this._begin=new g(u,this.id),this.beginCaptures=m,this.whileCaptures=I,this._while=new g(R,t.whileRuleId),this.whileHasBackReferences=this._while.hasBackReferences,this.patterns=x.patterns,this.hasMissingPatterns=x.hasMissingPatterns,this._cachedCompiledPatterns=null,this._cachedCompiledWhilePatterns=null}dispose(){this._cachedCompiledPatterns&&(this._cachedCompiledPatterns.dispose(),this._cachedCompiledPatterns=null),this._cachedCompiledWhilePatterns&&(this._cachedCompiledWhilePatterns.dispose(),this._cachedCompiledWhilePatterns=null)}get debugBeginRegExp(){return`${this._begin.source}`}get debugWhileRegExp(){return`${this._while.source}`}getWhileWithResolvedBackReferences(e,s){return this._while.resolveBackReferences(e,s)}collectPatterns(e,s){s.push(this._begin)}compile(e,s){return this._getCachedCompiledPatterns(e).compile(e)}compileAG(e,s,o,r){return this._getCachedCompiledPatterns(e).compileAG(e,o,r)}_getCachedCompiledPatterns(e){if(!this._cachedCompiledPatterns){this._cachedCompiledPatterns=new b;for(const s of this.patterns)e.getRule(s).collectPatterns(e,this._cachedCompiledPatterns)}return this._cachedCompiledPatterns}compileWhile(e,s){return this._getCachedCompiledWhilePatterns(e,s).compile(e)}compileWhileAG(e,s,o,r){return this._getCachedCompiledWhilePatterns(e,s).compileAG(e,o,r)}_getCachedCompiledWhilePatterns(e,s){return this._cachedCompiledWhilePatterns||(this._cachedCompiledWhilePatterns=new b,this._cachedCompiledWhilePatterns.push(this._while.hasBackReferences?this._while.clone():this._while)),this._while.hasBackReferences&&this._cachedCompiledWhilePatterns.setSource(0,s||"￿"),this._cachedCompiledWhilePatterns}}t.BeginWhileRule=S;class y{static createCaptureRule(e,s,o,r,u){return e.registerRule(m=>new C(s,m,o,r,u))}static getCompiledRuleId(e,s,o){return e.id||s.registerRule(r=>{if(e.id=r,e.match)return new A(e.$vscodeTextmateLocation,e.id,e.name,e.match,y._compileCaptures(e.captures,s,o));if(e.begin===void 0){e.repository&&(o=l.mergeObjects({},o,e.repository));let u=e.patterns;return u===void 0&&e.include&&(u=[{include:e.include}]),new w(e.$vscodeTextmateLocation,e.id,e.name,e.contentName,y._compilePatterns(u,s,o))}return e.while?new S(e.$vscodeTextmateLocation,e.id,e.name,e.contentName,e.begin,y._compileCaptures(e.beginCaptures||e.captures,s,o),e.while,y._compileCaptures(e.whileCaptures||e.captures,s,o),y._compilePatterns(e.patterns,s,o)):new L(e.$vscodeTextmateLocation,e.id,e.name,e.contentName,e.begin,y._compileCaptures(e.beginCaptures||e.captures,s,o),e.end,y._compileCaptures(e.endCaptures||e.captures,s,o),e.applyEndPatternLast,y._compilePatterns(e.patterns,s,o))}),e.id}static _compileCaptures(e,s,o){let r=[];if(e){let u=0;for(const m in e){if(m==="$vscodeTextmateLocation")continue;const R=parseInt(m,10);R>u&&(u=R)}for(let m=0;m<=u;m++)r[m]=null;for(const m in e){if(m==="$vscodeTextmateLocation")continue;const R=parseInt(m,10);let I=0;e[m].patterns&&(I=y.getCompiledRuleId(e[m],s,o)),r[R]=y.createCaptureRule(s,e[m].$vscodeTextmateLocation,e[m].name,e[m].contentName,I)}}return r}static _compilePatterns(e,s,o){let r=[];if(e)for(let u=0,m=e.length;u<m;u++){const R=e[u];let I=-1;if(R.include){const x=n.parseInclude(R.include);switch(x.kind){case 0:case 1:I=y.getCompiledRuleId(o[R.include],s,o);break;case 2:let M=o[x.ruleName];M&&(I=y.getCompiledRuleId(M,s,o));break;case 3:case 4:const N=x.scopeName,K=x.kind===4?x.ruleName:null,V=s.getExternalGrammar(N,o);if(V)if(K){let F=V.repository[K];F&&(I=y.getCompiledRuleId(F,s,V.repository))}else I=y.getCompiledRuleId(V.repository.$self,s,V.repository)}}else I=y.getCompiledRuleId(R,s,o);if(I!==-1){const x=s.getRule(I);let M=!1;if((x instanceof w||x instanceof L||x instanceof S)&&x.hasMissingPatterns&&x.patterns.length===0&&(M=!0),M)continue;r.push(I)}}return{patterns:r,hasMissingPatterns:(e?e.length:0)!==r.length}}}t.RuleFactory=y;class g{constructor(e,s){if(e){const o=e.length;let r=0,u=[],m=!1;for(let R=0;R<o;R++)if(e.charAt(R)==="\\"&&R+1<o){const I=e.charAt(R+1);I==="z"?(u.push(e.substring(r,R)),u.push("$(?!\\n)(?<!\\n)"),r=R+2):I!=="A"&&I!=="G"||(m=!0),R++}this.hasAnchor=m,r===0?this.source=e:(u.push(e.substring(r,o)),this.source=u.join(""))}else this.hasAnchor=!1,this.source=e;this.hasAnchor?this._anchorCache=this._buildAnchorCache():this._anchorCache=null,this.ruleId=s,this.hasBackReferences=_.test(this.source)}clone(){return new g(this.source,this.ruleId)}setSource(e){this.source!==e&&(this.source=e,this.hasAnchor&&(this._anchorCache=this._buildAnchorCache()))}resolveBackReferences(e,s){let o=s.map(r=>e.substring(r.start,r.end));return v.lastIndex=0,this.source.replace(v,(r,u)=>l.escapeRegExpCharacters(o[parseInt(u,10)]||""))}_buildAnchorCache(){let e,s,o,r,u=[],m=[],R=[],I=[];for(e=0,s=this.source.length;e<s;e++)o=this.source.charAt(e),u[e]=o,m[e]=o,R[e]=o,I[e]=o,o==="\\"&&e+1<s&&(r=this.source.charAt(e+1),r==="A"?(u[e+1]="￿",m[e+1]="￿",R[e+1]="A",I[e+1]="A"):r==="G"?(u[e+1]="￿",m[e+1]="G",R[e+1]="￿",I[e+1]="G"):(u[e+1]=r,m[e+1]=r,R[e+1]=r,I[e+1]=r),e++);return{A0_G0:u.join(""),A0_G1:m.join(""),A1_G0:R.join(""),A1_G1:I.join("")}}resolveAnchors(e,s){return this.hasAnchor&&this._anchorCache?e?s?this._anchorCache.A1_G1:this._anchorCache.A1_G0:s?this._anchorCache.A0_G1:this._anchorCache.A0_G0:this.source}}t.RegExpSource=g;class b{constructor(){this._items=[],this._hasAnchors=!1,this._cached=null,this._anchorCache={A0_G0:null,A0_G1:null,A1_G0:null,A1_G1:null}}dispose(){this._disposeCaches()}_disposeCaches(){this._cached&&(this._cached.dispose(),this._cached=null),this._anchorCache.A0_G0&&(this._anchorCache.A0_G0.dispose(),this._anchorCache.A0_G0=null),this._anchorCache.A0_G1&&(this._anchorCache.A0_G1.dispose(),this._anchorCache.A0_G1=null),this._anchorCache.A1_G0&&(this._anchorCache.A1_G0.dispose(),this._anchorCache.A1_G0=null),this._anchorCache.A1_G1&&(this._anchorCache.A1_G1.dispose(),this._anchorCache.A1_G1=null)}push(e){this._items.push(e),this._hasAnchors=this._hasAnchors||e.hasAnchor}unshift(e){this._items.unshift(e),this._hasAnchors=this._hasAnchors||e.hasAnchor}length(){return this._items.length}setSource(e,s){this._items[e].source!==s&&(this._disposeCaches(),this._items[e].setSource(s))}compile(e){if(!this._cached){let s=this._items.map(o=>o.source);this._cached=new k(e,s,this._items.map(o=>o.ruleId))}return this._cached}compileAG(e,s,o){return this._hasAnchors?s?o?(this._anchorCache.A1_G1||(this._anchorCache.A1_G1=this._resolveAnchors(e,s,o)),this._anchorCache.A1_G1):(this._anchorCache.A1_G0||(this._anchorCache.A1_G0=this._resolveAnchors(e,s,o)),this._anchorCache.A1_G0):o?(this._anchorCache.A0_G1||(this._anchorCache.A0_G1=this._resolveAnchors(e,s,o)),this._anchorCache.A0_G1):(this._anchorCache.A0_G0||(this._anchorCache.A0_G0=this._resolveAnchors(e,s,o)),this._anchorCache.A0_G0):this.compile(e)}_resolveAnchors(e,s,o){let r=this._items.map(u=>u.resolveAnchors(s,o));return new k(e,r,this._items.map(u=>u.ruleId))}}t.RegExpSourceList=b;class k{constructor(e,s,o){this.regExps=s,this.rules=o,this.scanner=e.createOnigScanner(s)}dispose(){typeof this.scanner.dispose=="function"&&this.scanner.dispose()}toString(){const e=[];for(let s=0,o=this.rules.length;s<o;s++)e.push("   - "+this.rules[s]+": "+this.regExps[s]);return e.join(`
`)}findNextMatchSync(e,s,o){const r=this.scanner.findNextMatchSync(e,s,o);return r?{ruleId:this.rules[r.index],captureIndices:r.captureIndices}:null}}t.CompiledRule=k},583:(h,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ThemeTrieElement=t.ThemeTrieElementRule=t.ColorMap=t.fontStyleToString=t.ParsedThemeRule=t.parseTheme=t.StyleAttributes=t.ScopeStack=t.Theme=void 0;const l=a(878);class n{constructor(g,b,k){this._colorMap=g,this._defaults=b,this._root=k,this._cachedMatchRoot=new l.CachedFn(c=>this._root.match(c))}static createFromRawTheme(g,b){return this.createFromParsedTheme(C(g),b)}static createFromParsedTheme(g,b){return function(k,c){k.sort((R,I)=>{let x=l.strcmp(R.scope,I.scope);return x!==0?x:(x=l.strArrCmp(R.parentScopes,I.parentScopes),x!==0?x:R.index-I.index)});let e=0,s="#000000",o="#ffffff";for(;k.length>=1&&k[0].scope==="";){let R=k.shift();R.fontStyle!==-1&&(e=R.fontStyle),R.foreground!==null&&(s=R.foreground),R.background!==null&&(o=R.background)}let r=new w(c),u=new p(e,r.getId(s),r.getId(o)),m=new S(new L(0,null,-1,0,0),[]);for(let R=0,I=k.length;R<I;R++){let x=k[R];m.insert(0,x.scope,x.parentScopes,x.fontStyle,r.getId(x.foreground),r.getId(x.background))}return new n(r,u,m)}(g,b)}getColorMap(){return this._colorMap.getColorMap()}getDefaults(){return this._defaults}match(g){if(g===null)return this._defaults;const b=g.scopeName,k=this._cachedMatchRoot.get(b).find(c=>function(e,s){if(s===null)return!0;let o=0,r=s[o];for(;e;){if(v(e.scopeName,r)){if(o++,o===s.length)return!0;r=s[o]}e=e.parent}return!1}(g.parent,c.parentScopes));return k?new p(k.fontStyle,k.foreground,k.background):null}}t.Theme=n;class _{constructor(g,b){this.parent=g,this.scopeName=b}static push(g,b){for(const k of b)g=new _(g,k);return g}static from(...g){let b=null;for(let k=0;k<g.length;k++)b=new _(b,g[k]);return b}push(g){return new _(this,g)}getSegments(){let g=this;const b=[];for(;g;)b.push(g.scopeName),g=g.parent;return b.reverse(),b}toString(){return this.getSegments().join(" ")}extends(g){return this===g||this.parent!==null&&this.parent.extends(g)}getExtensionIfDefined(g){const b=[];let k=this;for(;k&&k!==g;)b.push(k.scopeName),k=k.parent;return k===g?b.reverse():void 0}}function v(y,g){return g===y||y.startsWith(g)&&y[g.length]==="."}t.ScopeStack=_;class p{constructor(g,b,k){this.fontStyle=g,this.foregroundId=b,this.backgroundId=k}}function C(y){if(!y)return[];if(!y.settings||!Array.isArray(y.settings))return[];let g=y.settings,b=[],k=0;for(let c=0,e=g.length;c<e;c++){let s,o=g[c];if(!o.settings)continue;if(typeof o.scope=="string"){let R=o.scope;R=R.replace(/^[,]+/,""),R=R.replace(/[,]+$/,""),s=R.split(",")}else s=Array.isArray(o.scope)?o.scope:[""];let r=-1;if(typeof o.settings.fontStyle=="string"){r=0;let R=o.settings.fontStyle.split(" ");for(let I=0,x=R.length;I<x;I++)switch(R[I]){case"italic":r|=1;break;case"bold":r|=2;break;case"underline":r|=4;break;case"strikethrough":r|=8}}let u=null;typeof o.settings.foreground=="string"&&l.isValidHexColor(o.settings.foreground)&&(u=o.settings.foreground);let m=null;typeof o.settings.background=="string"&&l.isValidHexColor(o.settings.background)&&(m=o.settings.background);for(let R=0,I=s.length;R<I;R++){let x=s[R].trim().split(" "),M=x[x.length-1],N=null;x.length>1&&(N=x.slice(0,x.length-1),N.reverse()),b[k++]=new A(M,N,c,r,u,m)}}return b}t.StyleAttributes=p,t.parseTheme=C;class A{constructor(g,b,k,c,e,s){this.scope=g,this.parentScopes=b,this.index=k,this.fontStyle=c,this.foreground=e,this.background=s}}t.ParsedThemeRule=A,t.fontStyleToString=function(y){if(y===-1)return"not set";let g="";return 1&y&&(g+="italic "),2&y&&(g+="bold "),4&y&&(g+="underline "),8&y&&(g+="strikethrough "),g===""&&(g="none"),g.trim()};class w{constructor(g){if(this._lastColorId=0,this._id2color=[],this._color2id=Object.create(null),Array.isArray(g)){this._isFrozen=!0;for(let b=0,k=g.length;b<k;b++)this._color2id[g[b]]=b,this._id2color[b]=g[b]}else this._isFrozen=!1}getId(g){if(g===null)return 0;g=g.toUpperCase();let b=this._color2id[g];if(b)return b;if(this._isFrozen)throw new Error(`Missing color in color map - ${g}`);return b=++this._lastColorId,this._color2id[g]=b,this._id2color[b]=g,b}getColorMap(){return this._id2color.slice(0)}}t.ColorMap=w;class L{constructor(g,b,k,c,e){this.scopeDepth=g,this.parentScopes=b,this.fontStyle=k,this.foreground=c,this.background=e}clone(){return new L(this.scopeDepth,this.parentScopes,this.fontStyle,this.foreground,this.background)}static cloneArr(g){let b=[];for(let k=0,c=g.length;k<c;k++)b[k]=g[k].clone();return b}acceptOverwrite(g,b,k,c){this.scopeDepth>g?console.log("how did this happen?"):this.scopeDepth=g,b!==-1&&(this.fontStyle=b),k!==0&&(this.foreground=k),c!==0&&(this.background=c)}}t.ThemeTrieElementRule=L;class S{constructor(g,b=[],k={}){this._mainRule=g,this._children=k,this._rulesWithParentScopes=b}static _sortBySpecificity(g){return g.length===1||g.sort(this._cmpBySpecificity),g}static _cmpBySpecificity(g,b){if(g.scopeDepth===b.scopeDepth){const k=g.parentScopes,c=b.parentScopes;let e=k===null?0:k.length,s=c===null?0:c.length;if(e===s)for(let o=0;o<e;o++){const r=k[o].length,u=c[o].length;if(r!==u)return u-r}return s-e}return b.scopeDepth-g.scopeDepth}match(g){if(g==="")return S._sortBySpecificity([].concat(this._mainRule).concat(this._rulesWithParentScopes));let b,k,c=g.indexOf(".");return c===-1?(b=g,k=""):(b=g.substring(0,c),k=g.substring(c+1)),this._children.hasOwnProperty(b)?this._children[b].match(k):S._sortBySpecificity([].concat(this._mainRule).concat(this._rulesWithParentScopes))}insert(g,b,k,c,e,s){if(b==="")return void this._doInsertHere(g,k,c,e,s);let o,r,u,m=b.indexOf(".");m===-1?(o=b,r=""):(o=b.substring(0,m),r=b.substring(m+1)),this._children.hasOwnProperty(o)?u=this._children[o]:(u=new S(this._mainRule.clone(),L.cloneArr(this._rulesWithParentScopes)),this._children[o]=u),u.insert(g+1,r,k,c,e,s)}_doInsertHere(g,b,k,c,e){if(b!==null){for(let s=0,o=this._rulesWithParentScopes.length;s<o;s++){let r=this._rulesWithParentScopes[s];if(l.strArrCmp(r.parentScopes,b)===0)return void r.acceptOverwrite(g,k,c,e)}k===-1&&(k=this._mainRule.fontStyle),c===0&&(c=this._mainRule.foreground),e===0&&(e=this._mainRule.background),this._rulesWithParentScopes.push(new L(g,b,k,c,e))}else this._mainRule.acceptOverwrite(g,k,c,e)}}t.ThemeTrieElement=S},878:(h,t)=>{function a(_){return Array.isArray(_)?function(v){let p=[];for(let C=0,A=v.length;C<A;C++)p[C]=a(v[C]);return p}(_):typeof _=="object"?function(v){let p={};for(let C in v)p[C]=a(v[C]);return p}(_):_}Object.defineProperty(t,"__esModule",{value:!0}),t.performanceNow=t.CachedFn=t.escapeRegExpCharacters=t.isValidHexColor=t.strArrCmp=t.strcmp=t.RegexSource=t.basename=t.mergeObjects=t.clone=void 0,t.clone=function(_){return a(_)},t.mergeObjects=function(_,...v){return v.forEach(p=>{for(let C in p)_[C]=p[C]}),_},t.basename=function _(v){const p=~v.lastIndexOf("/")||~v.lastIndexOf("\\");return p===0?v:~p==v.length-1?_(v.substring(0,v.length-1)):v.substr(1+~p)};let l=/\$(\d+)|\${(\d+):\/(downcase|upcase)}/g;function n(_,v){return _<v?-1:_>v?1:0}t.RegexSource=class{static hasCaptures(_){return _!==null&&(l.lastIndex=0,l.test(_))}static replaceCaptures(_,v,p){return _.replace(l,(C,A,w,L)=>{let S=p[parseInt(A||w,10)];if(!S)return C;{let y=v.substring(S.start,S.end);for(;y[0]===".";)y=y.substring(1);switch(L){case"downcase":return y.toLowerCase();case"upcase":return y.toUpperCase();default:return y}}})}},t.strcmp=n,t.strArrCmp=function(_,v){if(_===null&&v===null)return 0;if(!_)return-1;if(!v)return 1;let p=_.length,C=v.length;if(p===C){for(let A=0;A<p;A++){let w=n(_[A],v[A]);if(w!==0)return w}return 0}return p-C},t.isValidHexColor=function(_){return!!(/^#[0-9a-f]{6}$/i.test(_)||/^#[0-9a-f]{8}$/i.test(_)||/^#[0-9a-f]{3}$/i.test(_)||/^#[0-9a-f]{4}$/i.test(_))},t.escapeRegExpCharacters=function(_){return _.replace(/[\-\\\{\}\*\+\?\|\^\$\.\,\[\]\(\)\#\s]/g,"\\$&")},t.CachedFn=class{constructor(_){this.fn=_,this.cache=new Map}get(_){if(this.cache.has(_))return this.cache.get(_);const v=this.fn(_);return this.cache.set(_,v),v}},t.performanceNow=typeof performance>"u"?function(){return Date.now()}:function(){return performance.now()}}},T={};return function h(t){var a=T[t];if(a!==void 0)return a.exports;var l=T[t]={exports:{}};return f[t].call(l.exports,l,l.exports,h),l.exports}(787)})()})})(Ct);var je=Ct.exports;const Cn=Tt(je),Ln=vt({__proto__:null,default:Cn},[je]),ze=class ze extends be{constructor(i,d,f,T,h,t){super(),this._model=i,this._worker=d,this._languageIdCodec=f,this._backgroundTokenizationStore=T,this._configurationService=h,this._maxTokenizationLineLength=t,this.controllerId=ze._id++,this._pendingChanges=[],this._states=new It,this._loggingEnabled=Rn("editor.experimental.asyncTokenizationLogging",!1,this._configurationService),this._register(pt(this._loggingEnabled)),this._register(this._model.onDidChangeContent(n=>{this._shouldLog&&console.log("model change",{fileName:this._model.uri.fsPath.split("\\").pop(),changes:qe(n.changes)}),this._worker.acceptModelChanged(this.controllerId,n),this._pendingChanges.push(n)})),this._register(this._model.onDidChangeLanguage(n=>{const _=this._model.getLanguageId(),v=this._languageIdCodec.encodeLanguageId(_);this._worker.acceptModelLanguageChanged(this.controllerId,_,v)}));const a=this._model.getLanguageId(),l=this._languageIdCodec.encodeLanguageId(a);this._worker.acceptNewModel({uri:this._model.uri,versionId:this._model.getVersionId(),lines:this._model.getLinesContent(),EOL:this._model.getEOL(),languageId:a,encodedLanguageId:l,maxTokenizationLineLength:this._maxTokenizationLineLength.get(),controllerId:this.controllerId}),this._register(Pt(n=>{const _=this._maxTokenizationLineLength.read(n);this._worker.acceptMaxTokenizationLineLength(this.controllerId,_)}))}dispose(){super.dispose(),this._worker.acceptRemovedModel(this.controllerId)}requestTokens(i,d){this._worker.retokenize(this.controllerId,i,d)}async setTokensAndStates(i,d,f,T){if(this.controllerId!==i)return;let h=at.deserialize(new Uint8Array(f));if(this._shouldLog&&console.log("received background tokenization result",{fileName:this._model.uri.fsPath.split("\\").pop(),updatedTokenLines:h.map(a=>a.getLineRange()).join(" & "),updatedStateLines:T.map(a=>new xt(a.startLineNumber,a.startLineNumber+a.stateDeltas.length).toString()).join(" & ")}),this._shouldLog){const a=this._pendingChanges.filter(l=>l.versionId<=d).map(l=>l.changes).map(l=>qe(l)).join(" then ");console.log("Applying changes to local states",a)}for(;this._pendingChanges.length>0&&this._pendingChanges[0].versionId<=d;){const a=this._pendingChanges.shift();this._states.acceptChanges(a.changes)}if(this._pendingChanges.length>0){if(this._shouldLog){const n=this._pendingChanges.map(_=>_.changes).map(_=>qe(_)).join(" then ");console.log("Considering non-processed changes",n)}const a=Ge.fromMany(this._pendingChanges.map(n=>ht(n.changes))),l=new at;for(const n of h)for(let _=n.startLineNumber;_<=n.endLineNumber;_++)a.transform(_-1)!==void 0&&l.add(_,n.getLineTokens(_));h=l.finalize();for(const n of this._pendingChanges)for(const _ of n.changes)for(let v=0;v<h.length;v++)h[v].applyEdit(_.range,_.text)}const t=Ge.fromMany(this._pendingChanges.map(a=>ht(a.changes)));(!this._applyStateStackDiffFn||!this._initialState)&&(this._applyStateStackDiffFn=je.applyStateStackDiff,this._initialState=je.INITIAL);for(const a of T){let l=a.startLineNumber<=1?this._initialState:this._states.getEndState(a.startLineNumber-1);for(let n=0;n<a.stateDeltas.length;n++){const _=a.stateDeltas[n];let v;_?(v=this._applyStateStackDiffFn(l,_),this._states.setEndState(a.startLineNumber+n,v)):v=this._states.getEndState(a.startLineNumber+n);const p=t.transform(a.startLineNumber+n-1);p!==void 0&&this._backgroundTokenizationStore.setEndState(p+1,v),a.startLineNumber+n>=this._model.getLineCount()-1&&this._backgroundTokenizationStore.backgroundTokenizationFinished(),l=v}}this._backgroundTokenizationStore.setTokens(h)}get _shouldLog(){return this._loggingEnabled.get()}};ze._id=0;let Je=ze;function ht(D){return new wn(D.map(i=>new Tn(i.range.startLineNumber-1,i.range.endLineNumber-i.range.startLineNumber+1,Et(i.text)[0]+1)))}function qe(D){return D.map(i=>He.lift(i.range).toString()+" => "+i.text).join(" & ")}function Rn(D,i,d){return ft(f=>d.onDidChangeConfiguration(T=>{T.affectsConfiguration(D)&&f(T)}),()=>d.getValue(D)??i)}var Ne,Ae;let Qe=(Ae=class{constructor(i,d,f,T,h,t,a,l,n,_){this._reportTokenizationTime=i,this._shouldTokenizeAsync=d,this._extensionResourceLoaderService=f,this._modelService=T,this._languageConfigurationService=h,this._configurationService=t,this._languageService=a,this._environmentService=l,this._notificationService=n,this._telemetryService=_,this._workerProxyPromise=null,this._worker=null,this._workerProxy=null,this._workerTokenizerControllers=new Map,this._currentTheme=null,this._currentTokenColorMap=null,this._grammarDefinitions=[]}dispose(){this._disposeWorker()}createBackgroundTokenizer(i,d,f){if(!this._shouldTokenizeAsync()||i.isTooLargeForSyncing())return;const T=new De,h=this._getWorkerProxy().then(t=>{if(T.isDisposed||!t)return;const a={controller:void 0,worker:this._worker};return T.add(An(i,()=>{const l=new Je(i,t,this._languageService.languageIdCodec,d,this._configurationService,f);return a.controller=l,this._workerTokenizerControllers.set(l.controllerId,l),dn(()=>{a.controller=void 0,this._workerTokenizerControllers.delete(l.controllerId),l.dispose()})})),a});return{dispose(){T.dispose()},requestTokens:async(t,a)=>{const l=await h;l!=null&&l.controller&&l.worker===this._worker&&l.controller.requestTokens(t,a)},reportMismatchingTokens:t=>{Ne._reportedMismatchingTokens||(Ne._reportedMismatchingTokens=!0,this._notificationService.error({message:"Async Tokenization Token Mismatch in line "+t,name:"Async Tokenization Token Mismatch"}),this._telemetryService.publicLog2("asyncTokenizationMismatchingTokens",{}))}}}setGrammarDefinitions(i){this._grammarDefinitions=i,this._disposeWorker()}acceptTheme(i,d){this._currentTheme=i,this._currentTokenColorMap=d,this._currentTheme&&this._currentTokenColorMap&&this._workerProxy&&this._workerProxy.acceptTheme(this._currentTheme,this._currentTokenColorMap)}_getWorkerProxy(){return this._workerProxyPromise||(this._workerProxyPromise=this._createWorkerProxy()),this._workerProxyPromise}async _createWorkerProxy(){const i=`${Ke}/vscode-textmate`,d=`${ut}/vscode-textmate`,f=`${Ke}/vscode-oniguruma`,T=`${ut}/vscode-oniguruma`,h=this._environmentService.isBuilt&&!St,t=h?d:i,a=h?T:f,l=`${t}/release/main.js`,n=`${a}/release/main.js`,_=`${a}/release/onig.wasm`,v=Le.asBrowserUri(l).toString(!0),p={grammarDefinitions:this._grammarDefinitions,textmateMainUri:v,onigurumaMainUri:Le.asBrowserUri(n).toString(!0),onigurumaWASMUri:Le.asBrowserUri(_).toString(!0)},C={readFile:async L=>{const S=hn.revive(L);return this._extensionResourceLoaderService.readExtensionResource(S)},setTokensAndStates:async(L,S,y,g)=>{const b=this._workerTokenizerControllers.get(L);b&&b.setTokensAndStates(L,S,y,g)},reportTokenizationTime:(L,S,y,g,b)=>{this._reportTokenizationTime(L,S,y,g,b)}},A=this._worker=Mt(this._modelService,this._languageConfigurationService,{createData:p,label:"textMateWorker",moduleId:"vs/workbench/services/textMate/browser/backgroundTokenization/worker/textMateTokenizationWorker.worker",host:C}),w=await A.getProxy();return this._worker!==A?null:(this._workerProxy=w,this._currentTheme&&this._currentTokenColorMap&&this._workerProxy.acceptTheme(this._currentTheme,this._currentTokenColorMap),w)}_disposeWorker(){for(const i of this._workerTokenizerControllers.values())i.dispose();this._workerTokenizerControllers.clear(),this._worker&&(this._worker.dispose(),this._worker=null),this._workerProxy=null,this._workerProxyPromise=null}},Ne=Ae,Ae._reportedMismatchingTokens=!1,Ae);Qe=Ne=We([H(2,mt),H(3,Nt),H(4,Ot),H(5,et),H(6,tt),H(7,Dt),H(8,nt),H(9,_t)],Qe);function An(D,i){const d=new De,f=d.add(new De);function T(){D.isAttachedToEditor()?f.add(i()):f.clear()}return T(),d.add(D.onDidChangeAttached(()=>{T()})),d}class In{constructor(){this._scopeNameToLanguageRegistration=Object.create(null)}reset(){this._scopeNameToLanguageRegistration=Object.create(null)}register(i){this._scopeNameToLanguageRegistration[i.scopeName]=i}getGrammarDefinition(i){return this._scopeNameToLanguageRegistration[i]||null}}const Oe="No TM Grammar registered for this language.";class Pn extends be{constructor(i,d,f,T){super(),this._host=i,this._initialState=f.INITIAL,this._scopeRegistry=new In,this._injections={},this._injectedEmbeddedLanguages={},this._languageToScope=new Map,this._grammarRegistry=this._register(new f.Registry({onigLib:T,loadGrammar:async h=>{const t=this._scopeRegistry.getGrammarDefinition(h);if(!t)return this._host.logTrace(`No grammar found for scope ${h}`),null;const a=t.location;try{const l=await this._host.readFile(a);return f.parseRawGrammar(l,a.path)}catch(l){return this._host.logError(`Unable to load and parse grammar for scope ${h} from ${a}`,l),null}},getInjections:h=>{const t=h.split(".");let a=[];for(let l=1;l<=t.length;l++){const n=t.slice(0,l).join(".");a=[...a,...this._injections[n]||[]]}return a}}));for(const h of d){if(this._scopeRegistry.register(h),h.injectTo){for(const t of h.injectTo){let a=this._injections[t];a||(this._injections[t]=a=[]),a.push(h.scopeName)}if(h.embeddedLanguages)for(const t of h.injectTo){let a=this._injectedEmbeddedLanguages[t];a||(this._injectedEmbeddedLanguages[t]=a=[]),a.push(h.embeddedLanguages)}}h.language&&this._languageToScope.set(h.language,h.scopeName)}}has(i){return this._languageToScope.has(i)}setTheme(i,d){this._grammarRegistry.setTheme(i,d)}getColorMap(){return this._grammarRegistry.getColorMap()}async createGrammar(i,d){const f=this._languageToScope.get(i);if(typeof f!="string")throw new Error(Oe);const T=this._scopeRegistry.getGrammarDefinition(f);if(!T)throw new Error(Oe);const h=T.embeddedLanguages;if(this._injectedEmbeddedLanguages[f]){const l=this._injectedEmbeddedLanguages[f];for(const n of l)for(const _ of Object.keys(n))h[_]=n[_]}const t=Object.keys(h).length>0;let a;try{a=await this._grammarRegistry.loadGrammarWithConfiguration(f,d,{embeddedLanguages:h,tokenTypes:T.tokenTypes,balancedBracketSelectors:T.balancedBracketSelectors,unbalancedBracketSelectors:T.unbalancedBracketSelectors})}catch(l){throw l.message&&l.message.startsWith("No grammar provided for")?new Error(Oe):l}return{languageId:i,grammar:a,initialState:this._initialState,containsEmbeddedLanguages:t,sourceExtensionId:T.sourceExtensionId}}}const le="vs/workbench/services/textMate/common/TMGrammars",ge=Ue.registerExtensionPoint({extensionPoint:"grammars",deps:[Gt],jsonSchema:{description:j(le,0,"Contributes textmate tokenizers."),type:"array",defaultSnippets:[{body:[{language:"${1:id}",scopeName:"source.${2:id}",path:"./syntaxes/${3:id}.tmLanguage."}]}],items:{type:"object",defaultSnippets:[{body:{language:"${1:id}",scopeName:"source.${2:id}",path:"./syntaxes/${3:id}.tmLanguage."}}],properties:{language:{description:j(le,1,"Language identifier for which this syntax is contributed to."),type:"string"},scopeName:{description:j(le,2,"Textmate scope name used by the tmLanguage file."),type:"string"},path:{description:j(le,3,"Path of the tmLanguage file. The path is relative to the extension folder and typically starts with './syntaxes/'."),type:"string"},embeddedLanguages:{description:j(le,4,"A map of scope name to language id if this grammar contains embedded languages."),type:"object"},tokenTypes:{description:j(le,5,"A map of scope name to token types."),type:"object",additionalProperties:{enum:["string","comment","other"]}},injectTo:{description:j(le,6,"List of language scope names to which this grammar is injected to."),type:"array",items:{type:"string"}},balancedBracketScopes:{description:j(le,7,"Defines which scope names contain balanced brackets."),type:"array",items:{type:"string"},default:["*"]},unbalancedBracketScopes:{description:j(le,8,"Defines which scope names do not contain balanced brackets."),type:"array",items:{type:"string"},default:[]}},required:["scopeName","path"]}}});var Lt={exports:{}};(function(D,i){(function(d,f){D.exports=f()})(wt,()=>{return d={770:function(T,h,t){var a=this&&this.__importDefault||function(L){return L&&L.__esModule?L:{default:L}};Object.defineProperty(h,"__esModule",{value:!0}),h.setDefaultDebugCall=h.createOnigScanner=h.createOnigString=h.loadWASM=h.OnigScanner=h.OnigString=void 0;const l=a(t(418));let n=null,_=!1;class v{static _utf8ByteLength(S){let y=0;for(let g=0,b=S.length;g<b;g++){const k=S.charCodeAt(g);let c=k,e=!1;if(k>=55296&&k<=56319&&g+1<b){const s=S.charCodeAt(g+1);s>=56320&&s<=57343&&(c=65536+(k-55296<<10)|s-56320,e=!0)}y+=c<=127?1:c<=2047?2:c<=65535?3:4,e&&g++}return y}constructor(S){const y=S.length,g=v._utf8ByteLength(S),b=g!==y,k=b?new Uint32Array(y+1):null;b&&(k[y]=g);const c=b?new Uint32Array(g+1):null;b&&(c[g]=y);const e=new Uint8Array(g);let s=0;for(let o=0;o<y;o++){const r=S.charCodeAt(o);let u=r,m=!1;if(r>=55296&&r<=56319&&o+1<y){const R=S.charCodeAt(o+1);R>=56320&&R<=57343&&(u=65536+(r-55296<<10)|R-56320,m=!0)}b&&(k[o]=s,m&&(k[o+1]=s),u<=127?c[s+0]=o:u<=2047?(c[s+0]=o,c[s+1]=o):u<=65535?(c[s+0]=o,c[s+1]=o,c[s+2]=o):(c[s+0]=o,c[s+1]=o,c[s+2]=o,c[s+3]=o)),u<=127?e[s++]=u:u<=2047?(e[s++]=192|(1984&u)>>>6,e[s++]=128|(63&u)>>>0):u<=65535?(e[s++]=224|(61440&u)>>>12,e[s++]=128|(4032&u)>>>6,e[s++]=128|(63&u)>>>0):(e[s++]=240|(1835008&u)>>>18,e[s++]=128|(258048&u)>>>12,e[s++]=128|(4032&u)>>>6,e[s++]=128|(63&u)>>>0),m&&o++}this.utf16Length=y,this.utf8Length=g,this.utf16Value=S,this.utf8Value=e,this.utf16OffsetToUtf8=k,this.utf8OffsetToUtf16=c}createString(S){const y=S._omalloc(this.utf8Length);return S.HEAPU8.set(this.utf8Value,y),y}}class p{constructor(S){if(this.id=++p.LAST_ID,!n)throw new Error("Must invoke loadWASM first.");this._onigBinding=n,this.content=S;const y=new v(S);this.utf16Length=y.utf16Length,this.utf8Length=y.utf8Length,this.utf16OffsetToUtf8=y.utf16OffsetToUtf8,this.utf8OffsetToUtf16=y.utf8OffsetToUtf16,this.utf8Length<1e4&&!p._sharedPtrInUse?(p._sharedPtr||(p._sharedPtr=n._omalloc(1e4)),p._sharedPtrInUse=!0,n.HEAPU8.set(y.utf8Value,p._sharedPtr),this.ptr=p._sharedPtr):this.ptr=y.createString(n)}convertUtf8OffsetToUtf16(S){return this.utf8OffsetToUtf16?S<0?0:S>this.utf8Length?this.utf16Length:this.utf8OffsetToUtf16[S]:S}convertUtf16OffsetToUtf8(S){return this.utf16OffsetToUtf8?S<0?0:S>this.utf16Length?this.utf8Length:this.utf16OffsetToUtf8[S]:S}dispose(){this.ptr===p._sharedPtr?p._sharedPtrInUse=!1:this._onigBinding._ofree(this.ptr)}}h.OnigString=p,p.LAST_ID=0,p._sharedPtr=0,p._sharedPtrInUse=!1;class C{constructor(S){if(!n)throw new Error("Must invoke loadWASM first.");const y=[],g=[];for(let e=0,s=S.length;e<s;e++){const o=new v(S[e]);y[e]=o.createString(n),g[e]=o.utf8Length}const b=n._omalloc(4*S.length);n.HEAPU32.set(y,b/4);const k=n._omalloc(4*S.length);n.HEAPU32.set(g,k/4);const c=n._createOnigScanner(b,k,S.length);for(let e=0,s=S.length;e<s;e++)n._ofree(y[e]);n._ofree(k),n._ofree(b),c===0&&function(e){throw new Error(e.UTF8ToString(e._getLastOnigError()))}(n),this._onigBinding=n,this._ptr=c}dispose(){this._onigBinding._freeOnigScanner(this._ptr)}findNextMatchSync(S,y,g){let b=_,k=0;if(typeof g=="number"?(8&g&&(b=!0),k=g):typeof g=="boolean"&&(b=g),typeof S=="string"){S=new p(S);const c=this._findNextMatchSync(S,y,b,k);return S.dispose(),c}return this._findNextMatchSync(S,y,b,k)}_findNextMatchSync(S,y,g,b){const k=this._onigBinding;let c;if(c=g?k._findNextOnigScannerMatchDbg(this._ptr,S.id,S.ptr,S.utf8Length,S.convertUtf16OffsetToUtf8(y),b):k._findNextOnigScannerMatch(this._ptr,S.id,S.ptr,S.utf8Length,S.convertUtf16OffsetToUtf8(y),b),c===0)return null;const e=k.HEAPU32;let s=c/4;const o=e[s++],r=e[s++];let u=[];for(let m=0;m<r;m++){const R=S.convertUtf8OffsetToUtf16(e[s++]),I=S.convertUtf8OffsetToUtf16(e[s++]);u[m]={start:R,end:I,length:I-R}}return{index:o,captureIndices:u}}}h.OnigScanner=C;let A=!1,w=null;h.loadWASM=function(L){if(A)return w;let S,y,g,b;if(A=!0,function(k){return typeof k.instantiator=="function"}(L))S=L.instantiator,y=L.print;else{let k;(function(c){return c.data!==void 0})(L)?(k=L.data,y=L.print):k=L,S=function(c){return typeof Response<"u"&&c instanceof Response}(k)?typeof WebAssembly.instantiateStreaming=="function"?function(c){return e=>WebAssembly.instantiateStreaming(c,e)}(k):function(c){return async e=>{const s=await c.arrayBuffer();return WebAssembly.instantiate(s,e)}}(k):function(c){return e=>WebAssembly.instantiate(c,e)}(k)}return w=new Promise((k,c)=>{g=k,b=c}),function(k,c,e,s){(0,l.default)({print:c,instantiateWasm:(o,r)=>{if(typeof performance>"u"){const u=()=>Date.now();o.env.emscripten_get_now=u,o.wasi_snapshot_preview1.emscripten_get_now=u}return k(o).then(u=>r(u.instance),s),{}}}).then(o=>{n=o,e()})}(S,y,g,b),w},h.createOnigString=function(L){return new p(L)},h.createOnigScanner=function(L){return new C(L)},h.setDefaultDebugCall=function(L){_=L}},418:T=>{var h=(typeof document<"u"&&document.currentScript&&document.currentScript.src,function(t){var a,l,n=(t=t||{})!==void 0?t:{};n.ready=new Promise(function(E,G){a=E,l=G});var _,v=Object.assign({},n),p=!1,C="";function A(E){return n.locateFile?n.locateFile(E,C):C+E}_=function(E){let G;return typeof readbuffer=="function"?new Uint8Array(readbuffer(E)):(G=read(E,"binary"),b(typeof G=="object"),G)},typeof scriptArgs<"u"&&scriptArgs,typeof onig_print<"u"&&(typeof console>"u"&&(console={}),console.log=onig_print,console.warn=console.error=typeof printErr<"u"?printErr:onig_print);var w,L,S=n.print||console.log.bind(console),y=n.printErr||console.warn.bind(console);Object.assign(n,v),v=null,n.arguments&&n.arguments,n.thisProgram&&n.thisProgram,n.quit&&n.quit,n.wasmBinary&&(w=n.wasmBinary),n.noExitRuntime,typeof WebAssembly!="object"&&z("no native wasm support detected");var g=!1;function b(E,G){E||z(G)}var k,c,e,s=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function o(E,G,ee){for(var oe=G+ee,q=G;E[q]&&!(q>=oe);)++q;if(q-G>16&&E.buffer&&s)return s.decode(E.subarray(G,q));for(var J="";G<q;){var te=E[G++];if(128&te){var ue=63&E[G++];if((224&te)!=192){var Te=63&E[G++];if((te=(240&te)==224?(15&te)<<12|ue<<6|Te:(7&te)<<18|ue<<12|Te<<6|63&E[G++])<65536)J+=String.fromCharCode(te);else{var it=te-65536;J+=String.fromCharCode(55296|it>>10,56320|1023&it)}}else J+=String.fromCharCode((31&te)<<6|ue)}else J+=String.fromCharCode(te)}return J}function r(E,G){return E?o(c,E,G):""}function u(E){k=E,n.HEAP8=new Int8Array(E),n.HEAP16=new Int16Array(E),n.HEAP32=new Int32Array(E),n.HEAPU8=c=new Uint8Array(E),n.HEAPU16=new Uint16Array(E),n.HEAPU32=e=new Uint32Array(E),n.HEAPF32=new Float32Array(E),n.HEAPF64=new Float64Array(E)}n.INITIAL_MEMORY;var m=[],R=[],I=[];function x(){if(n.preRun)for(typeof n.preRun=="function"&&(n.preRun=[n.preRun]);n.preRun.length;)K(n.preRun.shift());fe(m)}function M(){fe(R)}function N(){if(n.postRun)for(typeof n.postRun=="function"&&(n.postRun=[n.postRun]);n.postRun.length;)F(n.postRun.shift());fe(I)}function K(E){m.unshift(E)}function V(E){R.unshift(E)}function F(E){I.unshift(E)}var $=0,Z=null;function Y(E){$++,n.monitorRunDependencies&&n.monitorRunDependencies($)}function W(E){if($--,n.monitorRunDependencies&&n.monitorRunDependencies($),$==0&&Z){var G=Z;Z=null,G()}}function z(E){n.onAbort&&n.onAbort(E),y(E="Aborted("+E+")"),g=!0,E+=". Build with -sASSERTIONS for more info.";var G=new WebAssembly.RuntimeError(E);throw l(G),G}var B,ce,P="data:application/octet-stream;base64,";function X(E){return E.startsWith(P)}function U(E){try{if(E==B&&w)return new Uint8Array(w);if(_)return _(E);throw"both async and sync fetching of the wasm failed"}catch(G){z(G)}}function se(){return w||!p||typeof fetch!="function"?Promise.resolve().then(function(){return U(B)}):fetch(B,{credentials:"same-origin"}).then(function(E){if(!E.ok)throw"failed to load wasm binary file at '"+B+"'";return E.arrayBuffer()}).catch(function(){return U(B)})}function pe(){var E={env:re,wasi_snapshot_preview1:re};function G(q,J){var te=q.exports;n.asm=te,u((L=n.asm.memory).buffer),n.asm.__indirect_function_table,V(n.asm.__wasm_call_ctors),W()}function ee(q){G(q.instance)}function oe(q){return se().then(function(J){return WebAssembly.instantiate(J,E)}).then(function(J){return J}).then(q,function(J){y("failed to asynchronously prepare wasm: "+J),z(J)})}if(Y(),n.instantiateWasm)try{return n.instantiateWasm(E,G)}catch(q){y("Module.instantiateWasm callback failed with error: "+q),l(q)}return(w||typeof WebAssembly.instantiateStreaming!="function"||X(B)||typeof fetch!="function"?oe(ee):fetch(B,{credentials:"same-origin"}).then(function(q){return WebAssembly.instantiateStreaming(q,E).then(ee,function(J){return y("wasm streaming compile failed: "+J),y("falling back to ArrayBuffer instantiation"),oe(ee)})})).catch(l),{}}function fe(E){for(;E.length>0;)E.shift()(n)}function me(E,G,ee){c.copyWithin(E,G,G+ee)}function he(E){try{return L.grow(E-k.byteLength+65535>>>16),u(L.buffer),1}catch{}}function we(E){var G,ee=c.length,oe=2147483648;if((E>>>=0)>oe)return!1;for(var q=1;q<=4;q*=2){var J=ee*(1+.2/q);if(J=Math.min(J,E+100663296),he(Math.min(oe,(G=Math.max(E,J))+(65536-G%65536)%65536)))return!0}return!1}X(B="onig.wasm")||(B=A(B)),ce=typeof dateNow<"u"?dateNow:()=>performance.now();var _e=[null,[],[]];function ye(E,G){var ee=_e[E];G===0||G===10?((E===1?S:y)(o(ee,0)),ee.length=0):ee.push(G)}function ke(E,G,ee,oe){for(var q=0,J=0;J<ee;J++){var te=e[G>>2],ue=e[G+4>>2];G+=8;for(var Te=0;Te<ue;Te++)ye(E,c[te+Te]);q+=ue}return e[oe>>2]=q,0}var ie,re={emscripten_get_now:ce,emscripten_memcpy_big:me,emscripten_resize_heap:we,fd_write:ke};function Se(E){function G(){ie||(ie=!0,n.calledRun=!0,g||(M(),a(n),n.onRuntimeInitialized&&n.onRuntimeInitialized(),N()))}$>0||(x(),$>0||(n.setStatus?(n.setStatus("Running..."),setTimeout(function(){setTimeout(function(){n.setStatus("")},1),G()},1)):G()))}if(pe(),n.___wasm_call_ctors=function(){return(n.___wasm_call_ctors=n.asm.__wasm_call_ctors).apply(null,arguments)},n.___errno_location=function(){return(n.___errno_location=n.asm.__errno_location).apply(null,arguments)},n._omalloc=function(){return(n._omalloc=n.asm.omalloc).apply(null,arguments)},n._ofree=function(){return(n._ofree=n.asm.ofree).apply(null,arguments)},n._getLastOnigError=function(){return(n._getLastOnigError=n.asm.getLastOnigError).apply(null,arguments)},n._createOnigScanner=function(){return(n._createOnigScanner=n.asm.createOnigScanner).apply(null,arguments)},n._freeOnigScanner=function(){return(n._freeOnigScanner=n.asm.freeOnigScanner).apply(null,arguments)},n._findNextOnigScannerMatch=function(){return(n._findNextOnigScannerMatch=n.asm.findNextOnigScannerMatch).apply(null,arguments)},n._findNextOnigScannerMatchDbg=function(){return(n._findNextOnigScannerMatchDbg=n.asm.findNextOnigScannerMatchDbg).apply(null,arguments)},n.stackSave=function(){return(n.stackSave=n.asm.stackSave).apply(null,arguments)},n.stackRestore=function(){return(n.stackRestore=n.asm.stackRestore).apply(null,arguments)},n.stackAlloc=function(){return(n.stackAlloc=n.asm.stackAlloc).apply(null,arguments)},n.dynCall_jiji=function(){return(n.dynCall_jiji=n.asm.dynCall_jiji).apply(null,arguments)},n.UTF8ToString=r,Z=function E(){ie||Se(),ie||(Z=E)},n.preInit)for(typeof n.preInit=="function"&&(n.preInit=[n.preInit]);n.preInit.length>0;)n.preInit.pop()();return Se(),t.ready});T.exports=h}},f={},function T(h){var t=f[h];if(t!==void 0)return t.exports;var a=f[h]={exports:{}};return d[h].call(a.exports,a,a.exports,T),a.exports}(770);var d,f})})(Lt);var st=Lt.exports;const xn=Tt(st),En=vt({__proto__:null,default:xn},[st]);var Ce;const ae="vs/workbench/services/textMate/browser/textMateTokenizationFeatureImpl";var Ie;let Xe=(Ie=class extends be{constructor(i,d,f,T,h,t,a,l,n,_){super(),this._languageService=i,this._themeService=d,this._extensionResourceLoaderService=f,this._notificationService=T,this._logService=h,this._configurationService=t,this._progressService=a,this._environmentService=l,this._instantiationService=n,this._telemetryService=_,this._createdModes=[],this._encounteredLanguages=[],this._debugMode=!1,this._debugModePrintFunc=()=>{},this._grammarDefinitions=null,this._grammarFactory=null,this._tokenizersRegistrations=new De,this._currentTheme=null,this._currentTokenColorMap=null,this._threadedBackgroundTokenizerFactory=this._instantiationService.createInstance(Qe,(v,p,C,A,w)=>this._reportTokenizationTime(v,p,C,A,!0,w),()=>this.getAsyncTokenizationEnabled()),this._vscodeOniguruma=null,this._styleElement=jt(),this._styleElement.className="vscode-tokens-styles",ge.setHandler(v=>this._handleGrammarsExtPoint(v)),this._updateTheme(this._themeService.getColorTheme(),!0),this._register(this._themeService.onDidColorThemeChange(()=>{this._updateTheme(this._themeService.getColorTheme(),!1)})),this._languageService.onDidRequestRichLanguageFeatures(v=>{this._createdModes.push(v)})}getAsyncTokenizationEnabled(){return!!this._configurationService.getValue("editor.experimental.asyncTokenization")}getAsyncTokenizationVerification(){return!!this._configurationService.getValue("editor.experimental.asyncTokenizationVerification")}_handleGrammarsExtPoint(i){this._grammarDefinitions=null,this._grammarFactory&&(this._grammarFactory.dispose(),this._grammarFactory=null),this._tokenizersRegistrations.clear(),this._grammarDefinitions=[];for(const d of i){const f=d.value;for(const T of f){const h=this._validateGrammarDefinition(d,T);if(h&&(this._grammarDefinitions.push(h),h.language)){const t=new Ut(()=>this._createTokenizationSupport(h.language));this._tokenizersRegistrations.add(t),this._tokenizersRegistrations.add(Ve.registerFactory(h.language,t))}}}this._threadedBackgroundTokenizerFactory.setGrammarDefinitions(this._grammarDefinitions);for(const d of this._createdModes)Ve.getOrCreate(d)}_validateGrammarDefinition(i,d){if(!On(i.description.extensionLocation,d,i.collector,this._languageService))return null;const f=yt(i.description.extensionLocation,d.path),T=Object.create(null);if(d.embeddedLanguages){const l=Object.keys(d.embeddedLanguages);for(let n=0,_=l.length;n<_;n++){const v=l[n],p=d.embeddedLanguages[v];typeof p=="string"&&this._languageService.isRegisteredLanguageId(p)&&(T[v]=this._languageService.languageIdCodec.encodeLanguageId(p))}}const h=Object.create(null);if(d.tokenTypes){const l=Object.keys(d.tokenTypes);for(const n of l)switch(d.tokenTypes[n]){case"string":h[n]=2;break;case"other":h[n]=0;break;case"comment":h[n]=1;break}}const t=d.language&&this._languageService.isRegisteredLanguageId(d.language)?d.language:null;function a(l,n){return!Array.isArray(l)||!l.every(_=>typeof _=="string")?n:l}return{location:f,language:t||void 0,scopeName:d.scopeName,embeddedLanguages:T,tokenTypes:h,injectTo:d.injectTo,balancedBracketSelectors:a(d.balancedBracketScopes,["*"]),unbalancedBracketSelectors:a(d.unbalancedBracketScopes,[]),sourceExtensionId:i.description.id}}startDebugMode(i,d){if(this._debugMode){this._notificationService.error(j(ae,0,"Already Logging."));return}this._debugModePrintFunc=i,this._debugMode=!0,this._debugMode&&this._progressService.withProgress({location:15,buttons:[j(ae,1,"Stop")]},f=>(f.report({message:j(ae,2,"Preparing to log TM Grammar parsing. Press Stop when finished.")}),this._getVSCodeOniguruma().then(T=>(T.setDefaultDebugCall(!0),f.report({message:j(ae,3,"Now logging TM Grammar parsing. Press Stop when finished.")}),new Promise((h,t)=>{})))),f=>{this._getVSCodeOniguruma().then(T=>{this._debugModePrintFunc=()=>{},this._debugMode=!1,T.setDefaultDebugCall(!1),d()})})}_canCreateGrammarFactory(){return!!this._grammarDefinitions}async _getOrCreateGrammarFactory(){if(this._grammarFactory)return this._grammarFactory;const i=await this._getVSCodeOniguruma(),d=Promise.resolve({createOnigScanner:f=>i.createOnigScanner(f),createOnigString:f=>i.createOnigString(f)});return this._grammarFactory?this._grammarFactory:(this._grammarFactory=new Pn({logTrace:f=>this._logService.trace(f),logError:(f,T)=>this._logService.error(f,T),readFile:f=>this._extensionResourceLoaderService.readExtensionResource(f)},this._grammarDefinitions||[],Ln,d),this._updateTheme(this._themeService.getColorTheme(),!0),this._grammarFactory)}async _createTokenizationSupport(i){if(!this._languageService.isRegisteredLanguageId(i)||!this._canCreateGrammarFactory())return null;try{const d=await this._getOrCreateGrammarFactory();if(!d.has(i))return null;const f=this._languageService.languageIdCodec.encodeLanguageId(i),T=await d.createGrammar(i,f);if(!T.grammar)return null;const h=Dn("editor.maxTokenizationLineLength",i,-1,this._configurationService),t=new Sn(T.grammar,T.initialState,T.containsEmbeddedLanguages,(a,l)=>this._threadedBackgroundTokenizerFactory.createBackgroundTokenizer(a,l,h),()=>this.getAsyncTokenizationVerification(),(a,l,n)=>{this._reportTokenizationTime(a,i,T.sourceExtensionId,l,!1,n)},!0);return t.onDidEncounterLanguage(a=>{if(!this._encounteredLanguages[a]){const l=this._languageService.languageIdCodec.decodeLanguageId(a);this._encounteredLanguages[a]=!0,this._languageService.requestBasicLanguageFeatures(l)}}),new bn(f,t,h)}catch(d){return d.message&&d.message===Oe||gn(d),null}}_updateTheme(i,d){var h;if(!d&&this._currentTheme&&this._currentTokenColorMap&&Nn(this._currentTheme.settings,i.tokenColors)&&pn(this._currentTokenColorMap,i.tokenColorMap))return;this._currentTheme={name:i.label,settings:i.tokenColors},this._currentTokenColorMap=i.tokenColorMap,(h=this._grammarFactory)==null||h.setTheme(this._currentTheme,this._currentTokenColorMap);const f=Mn(this._currentTokenColorMap),T=Ft(f);this._styleElement.textContent=T,Ve.setColorMap(f),this._currentTheme&&this._currentTokenColorMap&&this._threadedBackgroundTokenizerFactory.acceptTheme(this._currentTheme,this._currentTokenColorMap)}async createTokenizer(i){if(!this._languageService.isRegisteredLanguageId(i))return null;const d=await this._getOrCreateGrammarFactory();if(!d.has(i))return null;const f=this._languageService.languageIdCodec.encodeLanguageId(i),{grammar:T}=await d.createGrammar(i,f);return T}_getVSCodeOniguruma(){return this._vscodeOniguruma||(this._vscodeOniguruma=(async()=>{const i=await this._loadVSCodeOnigurumaWASM();return await st.loadWASM({data:i,print:d=>{this._debugModePrintFunc(d)}}),En})()),this._vscodeOniguruma}async _loadVSCodeOnigurumaWASM(){return St?await(await fetch(Le.asBrowserUri("vscode-oniguruma/../onig.wasm").toString(!0))).arrayBuffer():await fetch(this._environmentService.isBuilt?Le.asBrowserUri(`${fn}/vscode-oniguruma/release/onig.wasm`).toString(!0):Le.asBrowserUri(`${Ke}/vscode-oniguruma/release/onig.wasm`).toString(!0))}_reportTokenizationTime(i,d,f,T,h,t){const a=h?"async":"sync";Ce.reportTokenizationTimeCounter[a]>50||(Ce.reportTokenizationTimeCounter[a]===0&&setTimeout(()=>{Ce.reportTokenizationTimeCounter[a]=0},1e3*60*60),Ce.reportTokenizationTimeCounter[a]++,this._telemetryService.publicLog2("editor.tokenizedLine",{timeMs:i,languageId:d,lineLength:T,fromWorker:h,sourceExtensionId:f,isRandomSample:t,tokenizationSetting:this.getAsyncTokenizationEnabled()?this.getAsyncTokenizationVerification()?2:1:0}))}},Ce=Ie,Ie.reportTokenizationTimeCounter={sync:0,async:0},Ie);Xe=Ce=We([H(0,tt),H(1,kt),H(2,mt),H(3,nt),H(4,Bt),H(5,et),H(6,zt),H(7,$t),H(8,bt),H(9,_t)],Xe);function Mn(D){const i=[null];for(let d=1,f=D.length;d<f;d++)i[d]=Me.fromHex(D[d]);return i}function Nn(D,i){if(!i||!D||i.length!==D.length)return!1;for(let d=i.length-1;d>=0;d--){const f=i[d],T=D[d];if(f.scope!==T.scope)return!1;const h=f.settings,t=T.settings;if(h&&t){if(h.fontStyle!==t.fontStyle||h.foreground!==t.foreground||h.background!==t.background)return!1}else if(!h||!t)return!1}return!0}function On(D,i,d,f){if(i.language&&(typeof i.language!="string"||!f.isRegisteredLanguageId(i.language)))return d.error(j(ae,4,"Unknown language in `contributes.{0}.language`. Provided value: {1}",ge.name,String(i.language))),!1;if(!i.scopeName||typeof i.scopeName!="string")return d.error(j(ae,5,"Expected string in `contributes.{0}.scopeName`. Provided value: {1}",ge.name,String(i.scopeName))),!1;if(!i.path||typeof i.path!="string")return d.error(j(ae,6,"Expected string in `contributes.{0}.path`. Provided value: {1}",ge.name,String(i.path))),!1;if(i.injectTo&&(!Array.isArray(i.injectTo)||i.injectTo.some(h=>typeof h!="string")))return d.error(j(ae,7,"Invalid value in `contributes.{0}.injectTo`. Must be an array of language scope names. Provided value: {1}",ge.name,JSON.stringify(i.injectTo))),!1;if(i.embeddedLanguages&&!lt(i.embeddedLanguages))return d.error(j(ae,8,"Invalid value in `contributes.{0}.embeddedLanguages`. Must be an object map from scope name to language. Provided value: {1}",ge.name,JSON.stringify(i.embeddedLanguages))),!1;if(i.tokenTypes&&!lt(i.tokenTypes))return d.error(j(ae,9,"Invalid value in `contributes.{0}.tokenTypes`. Must be an object map from scope name to token type. Provided value: {1}",ge.name,JSON.stringify(i.tokenTypes))),!1;const T=yt(D,i.path);return Wt(T,D)||d.warn(j(ae,10,"Expected `contributes.{0}.path` ({1}) to be included inside extension's folder ({2}). This might make the extension non-portable.",ge.name,T.path,D.path)),!0}function Dn(D,i,d,f){return ft(T=>f.onDidChangeConfiguration(h=>{h.affectsConfiguration(D,{overrideIdentifier:i})&&T(h)}),()=>f.getValue(D,{overrideIdentifier:i})??d)}const Q="vs/workbench/services/themes/common/tokenClassificationExtensionPoint",de=yn(),Gn=Ue.registerExtensionPoint({extensionPoint:"semanticTokenTypes",jsonSchema:{description:j(Q,0,"Contributes semantic token types."),type:"array",items:{type:"object",properties:{id:{type:"string",description:j(Q,1,"The identifier of the semantic token type"),pattern:xe,patternErrorMessage:j(Q,2,"Identifiers should be in the form letterOrDigit[_-letterOrDigit]*")},superType:{type:"string",description:j(Q,3,"The super type of the semantic token type"),pattern:xe,patternErrorMessage:j(Q,4,"Super types should be in the form letterOrDigit[_-letterOrDigit]*")},description:{type:"string",description:j(Q,5,"The description of the semantic token type")}}}}}),jn=Ue.registerExtensionPoint({extensionPoint:"semanticTokenModifiers",jsonSchema:{description:j(Q,6,"Contributes semantic token modifiers."),type:"array",items:{type:"object",properties:{id:{type:"string",description:j(Q,7,"The identifier of the semantic token modifier"),pattern:xe,patternErrorMessage:j(Q,8,"Identifiers should be in the form letterOrDigit[_-letterOrDigit]*")},description:{type:"string",description:j(Q,9,"The description of the semantic token modifier")}}}}}),Fn=Ue.registerExtensionPoint({extensionPoint:"semanticTokenScopes",jsonSchema:{description:j(Q,10,"Contributes semantic token scope maps."),type:"array",items:{type:"object",properties:{language:{description:j(Q,11,"Lists the languge for which the defaults are."),type:"string"},scopes:{description:j(Q,12,"Maps a semantic token (described by semantic token selector) to one or more textMate scopes used to represent that token."),type:"object",additionalProperties:{type:"array",items:{type:"string"}}}}}}});class Bn{constructor(){function i(d,f,T){if(typeof d.id!="string"||d.id.length===0)return T.error(j(Q,13,"'configuration.{0}.id' must be defined and can not be empty",f)),!1;if(!d.id.match(xe))return T.error(j(Q,14,"'configuration.{0}.id' must follow the pattern letterOrDigit[-_letterOrDigit]*",f)),!1;const h=d.superType;return h&&!h.match(xe)?(T.error(j(Q,15,"'configuration.{0}.superType' must follow the pattern letterOrDigit[-_letterOrDigit]*",f)),!1):typeof d.description!="string"||d.id.length===0?(T.error(j(Q,16,"'configuration.{0}.description' must be defined and can not be empty",f)),!1):!0}Gn.setHandler((d,f)=>{for(const T of f.added){const h=T.value,t=T.collector;if(!h||!Array.isArray(h)){t.error(j(Q,17,"'configuration.semanticTokenType' must be an array"));return}for(const a of h)i(a,"semanticTokenType",t)&&de.registerTokenType(a.id,a.description,a.superType)}for(const T of f.removed){const h=T.value;for(const t of h)de.deregisterTokenType(t.id)}}),jn.setHandler((d,f)=>{for(const T of f.added){const h=T.value,t=T.collector;if(!h||!Array.isArray(h)){t.error(j(Q,18,"'configuration.semanticTokenModifier' must be an array"));return}for(const a of h)i(a,"semanticTokenModifier",t)&&de.registerTokenModifier(a.id,a.description)}for(const T of f.removed){const h=T.value;for(const t of h)de.deregisterTokenModifier(t.id)}}),Fn.setHandler((d,f)=>{for(const T of f.added){const h=T.value,t=T.collector;if(!h||!Array.isArray(h)){t.error(j(Q,19,"'configuration.semanticTokenScopes' must be an array"));return}for(const a of h){if(a.language&&typeof a.language!="string"){t.error(j(Q,20,"'configuration.semanticTokenScopes.language' must be a string"));continue}if(!a.scopes||typeof a.scopes!="object"){t.error(j(Q,21,"'configuration.semanticTokenScopes.scopes' must be defined as an object"));continue}for(const l in a.scopes){const n=a.scopes[l];if(!Array.isArray(n)||n.some(_=>typeof _!="string")){t.error(j(Q,22,"'configuration.semanticTokenScopes.scopes' values must be an array of strings"));continue}try{const _=de.parseTokenSelector(l,a.language);de.registerTokenStyleDefault(_,{scopesToProbe:n.map(v=>v.split(" "))})}catch{t.error(j(Q,23,"configuration.semanticTokenScopes.scopes': Problems parsing selector {0}.",l))}}}}for(const T of f.removed){const h=T.value;for(const t of h)for(const a in t.scopes){const l=t.scopes[a];try{const n=de.parseTokenSelector(a,t.language);de.registerTokenStyleDefault(n,{scopesToProbe:l.map(_=>_.split(" "))})}catch{}}}})}}var Ee;let Fe=(Ee=class{constructor(i){this.instantiationService=i,this.instantiationService.createInstance(Bn)}},Ee.ID="workbench.contrib.tokenClassificationExtensionPoint",Ee);Fe=We([H(0,bt)],Fe);Vt(Fe.ID,Fe,1);var zn=".token-inspect-widget{border:1px solid var(--vscode-editorHoverWidget-border);padding:10px;user-select:text;-webkit-user-select:text;z-index:50}.hc-black .tokens-inspect-widget,.hc-light .tokens-inspect-widget{border-width:2px}.monaco-editor .token-inspect-widget{background-color:var(--vscode-editorHoverWidget-background)}.monaco-editor .token-inspect-widget .tiw-metadata-separator{background-color:var(--vscode-editorHoverWidget-border)}.tiw-token{font-family:var(--monaco-monospace-font)}.tiw-metadata-separator{border:0;height:1px}.tiw-token-length{float:right;font-size:60%;font-weight:400}.tiw-metadata-table{width:100%}.tiw-metadata-value{font-family:var(--monaco-monospace-font);word-break:break-word}.tiw-metadata-values{list-style:none;margin-right:-10px;max-height:300px;overflow-y:auto;padding-left:0}.tiw-metadata-values>.tiw-metadata-value{margin-right:10px}.tiw-metadata-key{min-width:150px;padding-right:10px;vertical-align:top;white-space:nowrap;width:1px}.tiw-metadata-semantic{font-style:italic}.tiw-metadata-scopes{line-height:normal}.tiw-theme-selector{font-family:var(--monaco-monospace-font)}";qt(zn,{});function $n(D,i,d=!0){for(let f=i.length-1;f>=0;f--){const T=i.slice(0,f),h=i[f],t=Wn(D,h,T,d);if(t)return t}return null}function Wn(D,i,d,f){let T=null;for(let h=D.tokenColors.length-1;h>=0;h--){const t=D.tokenColors[h];if(f&&!t.settings.foreground)continue;let a;if(typeof t.scope=="string")a=t.scope.split(/,/).map(l=>l.trim());else if(Array.isArray(t.scope))a=t.scope;else continue;for(let l=0,n=a.length;l<n;l++){const _=a[l],v=new Be(_,t.settings);v.matches(i,d)&&v.isMoreSpecific(T)&&(T=v)}}return T}class Be{constructor(i,d){this.rawSelector=i,this.settings=d;const f=this.rawSelector.split(/ /);this.scope=f[f.length-1],this.parentScopes=f.slice(0,f.length-1)}matches(i,d){return Be._matches(this.scope,this.parentScopes,i,d)}static _cmp(i,d){if(i===null&&d===null)return 0;if(i===null)return-1;if(d===null)return 1;if(i.scope.length!==d.scope.length)return i.scope.length-d.scope.length;const f=i.parentScopes.length,T=d.parentScopes.length;if(f!==T)return f-T;for(let h=0;h<f;h++){const t=i.parentScopes[h].length,a=d.parentScopes[h].length;if(t!==a)return t-a}return 0}isMoreSpecific(i){return Be._cmp(this,i)>0}static _matchesOne(i,d){const f=i+".";return i===d||d.substring(0,f.length)===f}static _matches(i,d,f,T){if(!this._matchesOne(i,f))return!1;let h=d.length-1,t=T.length-1;for(;h>=0&&t>=0;)this._matchesOne(d[h],T[t])&&h--,t--;return h===-1}}var Ye;const Rt="vs/workbench/contrib/codeEditor/browser/inspectEditorTokens/inspectEditorTokens",O=Yt;var Pe;let Re=(Pe=class extends be{static get(i){return i.getContribution(Ye.ID)}constructor(i,d,f,T,h,t,a){super(),this._editor=i,this._textMateService=d,this._themeService=T,this._languageService=f,this._notificationService=h,this._configurationService=t,this._languageFeaturesService=a,this._widget=null,this._register(this._editor.onDidChangeModel(l=>this.stop())),this._register(this._editor.onDidChangeModelLanguage(l=>this.stop())),this._register(this._editor.onKeyUp(l=>l.keyCode===9&&this.stop()))}dispose(){this.stop(),super.dispose()}launch(){this._widget||this._editor.hasModel()&&this._editor.getModel().uri.scheme!==mn.vscodeNotebookCell&&(this._widget=new Ze(this._editor,this._textMateService,this._languageService,this._themeService,this._notificationService,this._configurationService,this._languageFeaturesService))}stop(){this._widget&&(this._widget.dispose(),this._widget=null)}toggle(){this._widget?this.stop():this.launch()}},Ye=Pe,Pe.ID="editor.contrib.inspectEditorTokens",Pe);Re=Ye=We([H(1,rt),H(2,tt),H(3,kt),H(4,nt),H(5,et),H(6,Ht)],Re);class Un extends Zt{constructor(){super({id:"editor.action.inspectTMScopes",label:j(Rt,0,"Developer: Inspect Editor Tokens and Scopes"),alias:"Developer: Inspect Editor Tokens and Scopes",precondition:void 0})}run(i,d){const f=Re.get(d);f==null||f.toggle()}}function dt(D){D.length>40&&(D=D.substr(0,20)+"…"+D.substr(D.length-20));let i="";for(let d=0,f=D.length;d<f;d++){const T=D.charCodeAt(d);switch(T){case 9:i+="→";break;case 32:i+="·";break;default:i+=String.fromCharCode(T)}}return i}const $e=class $e extends be{constructor(i,d,f,T,h,t,a){super(),this.allowEditorOverflow=!0,this._isDisposed=!1,this._editor=i,this._languageService=f,this._themeService=T,this._textMateService=d,this._notificationService=h,this._configurationService=t,this._languageFeaturesService=a,this._model=this._editor.getModel(),this._domNode=document.createElement("div"),this._domNode.className="token-inspect-widget",this._currentRequestCancellationTokenSource=new _n,this._beginCompute(this._editor.getPosition()),this._register(this._editor.onDidChangeCursorPosition(l=>this._beginCompute(this._editor.getPosition()))),this._register(T.onDidColorThemeChange(l=>this._beginCompute(this._editor.getPosition()))),this._register(t.onDidChangeConfiguration(l=>l.affectsConfiguration("editor.semanticHighlighting.enabled")&&this._beginCompute(this._editor.getPosition()))),this._editor.addContentWidget(this)}dispose(){this._isDisposed=!0,this._editor.removeContentWidget(this),this._currentRequestCancellationTokenSource.cancel(),super.dispose()}getId(){return $e._ID}_beginCompute(i){const d=this._textMateService.createTokenizer(this._model.getLanguageId()),f=this._computeSemanticTokens(i);Kt(this._domNode),this._domNode.appendChild(document.createTextNode(j(Rt,1,"Loading..."))),Promise.all([d,f]).then(([T,h])=>{this._isDisposed||(this._compute(T,h,i),this._domNode.style.maxWidth=`${Math.max(this._editor.getLayoutInfo().width*.66,500)}px`,this._editor.layoutContentWidget(this))},T=>{this._notificationService.warn(T),setTimeout(()=>{var h;(h=Re.get(this._editor))==null||h.stop()})})}_isSemanticColoringEnabled(){var d;const i=(d=this._configurationService.getValue(Jt,{overrideIdentifier:this._model.getLanguageId(),resource:this._model.uri}))==null?void 0:d.enabled;return typeof i=="boolean"?i:this._themeService.getColorTheme().semanticHighlighting}_compute(i,d,f){var v;const T=i&&this._getTokensAtPosition(i,f),h=d&&this._getSemanticTokenAtPosition(d,f);if(!T&&!h){ct(this._domNode,"No grammar or semantic tokens available.");return}const t=T==null?void 0:T.metadata,a=h==null?void 0:h.metadata,l=h&&dt(this._model.getValueInRange(h.range)),n=T&&dt(this._model.getLineContent(f.lineNumber).substring(T.token.startIndex,T.token.endIndex)),_=l||n||"";if(ct(this._domNode,O("h2.tiw-token",void 0,_,O("span.tiw-token-length",void 0,`${_.length} ${_.length===1?"char":"chars"}`))),ne(this._domNode,O("hr.tiw-metadata-separator",{style:"clear:both"})),ne(this._domNode,O("table.tiw-metadata-table",void 0,O("tbody",void 0,O("tr",void 0,O("td.tiw-metadata-key",void 0,"language"),O("td.tiw-metadata-value",void 0,(t==null?void 0:t.languageId)||"")),O("tr",void 0,O("td.tiw-metadata-key",void 0,"standard token type"),O("td.tiw-metadata-value",void 0,this._tokenTypeToString((t==null?void 0:t.tokenType)||0))),...this._formatMetadata(a,t)))),h){ne(this._domNode,O("hr.tiw-metadata-separator"));const p=ne(this._domNode,O("table.tiw-metadata-table",void 0)),C=ne(p,O("tbody",void 0,O("tr",void 0,O("td.tiw-metadata-key",void 0,"semantic token type"),O("td.tiw-metadata-value",void 0,h.type))));if(h.modifiers.length&&ne(C,O("tr",void 0,O("td.tiw-metadata-key",void 0,"modifiers"),O("td.tiw-metadata-value",void 0,h.modifiers.join(" ")))),h.metadata){const A=["foreground","bold","italic","underline","strikethrough"],w={},L=new Array;for(const S of A)if(h.metadata[S]!==void 0){const y=h.definitions[S],g=this._renderTokenStyleDefinition(y,S),b=g.map(c=>c instanceof HTMLElement?c.outerHTML:c).join();let k=w[b];k||(w[b]=k=[],L.push([g,b])),k.push(S)}for(const[S,y]of L)ne(C,O("tr",void 0,O("td.tiw-metadata-key",void 0,w[y].join(", ")),O("td.tiw-metadata-value",void 0,...S)))}}if(T){const p=this._themeService.getColorTheme();ne(this._domNode,O("hr.tiw-metadata-separator"));const C=ne(this._domNode,O("table.tiw-metadata-table")),A=ne(C,O("tbody"));n&&n!==_&&ne(A,O("tr",void 0,O("td.tiw-metadata-key",void 0,"textmate token"),O("td.tiw-metadata-value",void 0,`${n} (${n.length})`)));const w=new Array;for(let y=T.token.scopes.length-1;y>=0;y--)w.push(T.token.scopes[y]),y>0&&w.push(O("br"));ne(A,O("tr",void 0,O("td.tiw-metadata-key",void 0,"textmate scopes"),O("td.tiw-metadata-value.tiw-metadata-scopes",void 0,...w)));const L=$n(p,T.token.scopes,!1),S=(v=h==null?void 0:h.metadata)==null?void 0:v.foreground;if(L){if(S!==T.metadata.foreground){let y=O("code.tiw-theme-selector",void 0,L.rawSelector,O("br"),JSON.stringify(L.settings,null,"	"));S&&(y=O("s",void 0,y)),ne(A,O("tr",void 0,O("td.tiw-metadata-key",void 0,"foreground"),O("td.tiw-metadata-value",void 0,y)))}}else S||ne(A,O("tr",void 0,O("td.tiw-metadata-key",void 0,"foreground"),O("td.tiw-metadata-value",void 0,"No theme selector")))}}_formatMetadata(i,d){const f=new Array;function T(n){const _=(i==null?void 0:i[n])||(d==null?void 0:d[n]);if(_!==void 0){const v=i!=null&&i[n]?"tiw-metadata-semantic":"";f.push(O("tr",void 0,O("td.tiw-metadata-key",void 0,n),O(`td.tiw-metadata-value.${v}`,void 0,_)))}return _}const h=T("foreground"),t=T("background");if(h&&t){const n=Me.fromHex(t),_=Me.fromHex(h);n.isOpaque()?f.push(O("tr",void 0,O("td.tiw-metadata-key",void 0,"contrast ratio"),O("td.tiw-metadata-value",void 0,n.getContrastRatio(_.makeOpaque(n)).toFixed(2)))):f.push(O("tr",void 0,O("td.tiw-metadata-key",void 0,"Contrast ratio cannot be precise for background colors that use transparency"),O("td.tiw-metadata-value")))}const a=new Array;function l(n){let _;i&&i[n]?_=O("span.tiw-metadata-semantic",void 0,n):d&&d[n]&&(_=n),_&&(a.length&&a.push(" "),a.push(_))}return l("bold"),l("italic"),l("underline"),l("strikethrough"),a.length&&f.push(O("tr",void 0,O("td.tiw-metadata-key",void 0,"font style"),O("td.tiw-metadata-value",void 0,...a))),f}_decodeMetadata(i){const d=this._themeService.getColorTheme().tokenColorMap,f=ve.getLanguageId(i),T=ve.getTokenType(i),h=ve.getFontStyle(i),t=ve.getForeground(i),a=ve.getBackground(i);return{languageId:this._languageService.languageIdCodec.decodeLanguageId(f),tokenType:T,bold:h&2?!0:void 0,italic:h&1?!0:void 0,underline:h&4?!0:void 0,strikethrough:h&8?!0:void 0,foreground:d[t],background:d[a]}}_tokenTypeToString(i){switch(i){case 0:return"Other";case 1:return"Comment";case 2:return"String";case 3:return"RegEx";default:return"??"}}_getTokensAtPosition(i,d){const f=d.lineNumber,T=this._getStateBeforeLine(i,f),h=i.tokenizeLine(this._model.getLineContent(f),T),t=i.tokenizeLine2(this._model.getLineContent(f),T);let a=0;for(let n=h.tokens.length-1;n>=0;n--){const _=h.tokens[n];if(d.column-1>=_.startIndex){a=n;break}}let l=0;for(let n=t.tokens.length>>>1;n>=0;n--)if(d.column-1>=t.tokens[n<<1]){l=n;break}return{token:h.tokens[a],metadata:this._decodeMetadata(t.tokens[(l<<1)+1])}}_getStateBeforeLine(i,d){let f=null;for(let T=1;T<d;T++)f=i.tokenizeLine(this._model.getLineContent(T),f).ruleStack;return f}isSemanticTokens(i){return i&&i.data}async _computeSemanticTokens(i){if(!this._isSemanticColoringEnabled())return null;const d=this._languageFeaturesService.documentSemanticTokensProvider.ordered(this._model);if(d.length){const T=d[0],h=await Promise.resolve(T.provideDocumentSemanticTokens(this._model,null,this._currentRequestCancellationTokenSource.token));if(this.isSemanticTokens(h))return{tokens:h,legend:T.getLegend()}}const f=this._languageFeaturesService.documentRangeSemanticTokensProvider.ordered(this._model);if(f.length){const T=f[0],h=i.lineNumber,t=new He(h,1,h,this._model.getLineMaxColumn(h)),a=await Promise.resolve(T.provideDocumentRangeSemanticTokens(this._model,t,this._currentRequestCancellationTokenSource.token));if(this.isSemanticTokens(a))return{tokens:a,legend:T.getLegend()}}return null}_getSemanticTokenAtPosition(i,d){const f=i.tokens.data,T=this._model.getLanguageId();let h=0,t=0;const a=d.lineNumber-1,l=d.column-1;for(let n=0;n<f.length;n+=5){const _=f[n],v=f[n+1],p=f[n+2],C=f[n+3],A=f[n+4],w=h+_,L=_===0?t+v:v;if(a===w&&L<=l&&l<L+p){const S=i.legend.tokenTypes[C]||"not in legend (ignored)",y=[];let g=A;for(let r=0;g>0&&r<i.legend.tokenModifiers.length;r++)g&1&&y.push(i.legend.tokenModifiers[r]),g=g>>1;g>0&&y.push("not in legend (ignored)");const b=new He(w+1,L+1,w+1,L+1+p),k={},c=this._themeService.getColorTheme().tokenColorMap,s=this._themeService.getColorTheme().getTokenStyleMetadata(S,y,T,!0,k);let o;return s&&(o={languageId:void 0,tokenType:0,bold:s==null?void 0:s.bold,italic:s==null?void 0:s.italic,underline:s==null?void 0:s.underline,strikethrough:s==null?void 0:s.strikethrough,foreground:c[(s==null?void 0:s.foreground)||0],background:void 0}),{type:S,modifiers:y,range:b,metadata:o,definitions:k}}h=w,t=L}return null}_renderTokenStyleDefinition(i,d){const f=new Array;if(i===void 0)return f;const T=this._themeService.getColorTheme();if(Array.isArray(i)){const h={};T.resolveScopes(i,h);const t=h[d];if(t&&h.scope){const a=O("ul.tiw-metadata-values"),l=Array.isArray(t.scope)?t.scope:[String(t.scope)];for(const n of l)a.appendChild(O("li.tiw-metadata-value.tiw-metadata-scopes",void 0,n));return f.push(h.scope.join(" "),a,O("code.tiw-theme-selector",void 0,JSON.stringify(t.settings,null,"	"))),f}return f}else if(kn.is(i)){const h=T.getTokenStylingRuleScope(i);return h==="setting"?(f.push(`User settings: ${i.selector.id} - ${this._renderStyleProperty(i.style,d)}`),f):(h==="theme"&&f.push(`Color theme: ${i.selector.id} - ${this._renderStyleProperty(i.style,d)}`),f)}else{const h=T.resolveTokenStyleValue(i);return f.push(`Default: ${h?this._renderStyleProperty(h,d):""}`),f}}_renderStyleProperty(i,d){switch(d){case"foreground":return i.foreground?Me.Format.CSS.formatHexA(i.foreground,!0):"";default:return i[d]!==void 0?String(i[d]):""}}getDomNode(){return this._domNode}getPosition(){return{position:this._editor.getPosition(),preference:[2,1]}}};$e._ID="editor.contrib.inspectEditorTokensWidget";let Ze=$e;Qt(Re.ID,Re,4);Xt(Un);const gt=new URL(""+new URL("../assets/onig.Du5pRr7Y.wasm",import.meta.url).href,import.meta.url).href;en({"vscode-oniguruma/../onig.wasm":gt,"vs/../../node_modules/vscode-oniguruma/release/onig.wasm":gt});rn(async D=>{D.get(sn).when(2).then(()=>{on.get(rt)})});function Jn(){return{...tn(),[rt.toString()]:new nn(Xe,[],!1)}}export{rt as ITextMateTokenizationService,Jn as default};
//# sourceMappingURL=index.BpWhFMvC.js.map

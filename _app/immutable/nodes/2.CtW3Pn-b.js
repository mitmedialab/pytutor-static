const __vite__fileDeps=["../chunks/index.BbTkrgG2.js","../chunks/__vite-browser-external.IEDOrHhg.js","../chunks/server.browser.D4hb9_uX.js","../chunks/index.BXiy_4TU.js","../chunks/scheduler.B_HausrX.js","../chunks/index.BGGFpMsM.js","../assets/server.Cra59WlT.css","../chunks/index.CuAq3Z7v.js","../chunks/editor.api.C1vQ_HcD.js","../chunks/editor.DUpSOAQE.js","../chunks/Layout.BqCPlncL.js","../chunks/reactify.BUBICLCa.js","../assets/Layout._gFU55Mq.css","../assets/editor.CxLaKWXP.css","../chunks/preload-helper.D6kgxu3v.js","../chunks/index.BpWhFMvC.js","../chunks/tokenClassificationRegistry.DDNqQCr5.js","../chunks/index.yjtX7sLc.js","../chunks/index.CObYoXy1.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
var uGe=Object.defineProperty;var dGe=(n,e,t)=>e in n?uGe(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var $=(n,e,t)=>(dGe(n,typeof e!="symbol"?e+"":e,t),t),xj=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)};var Qe=(n,e,t)=>(xj(n,e,"read from private field"),t?t.call(n):e.get(n)),Tn=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)},gn=(n,e,t,r)=>(xj(n,e,"write to private field"),r?r.call(n,t):e.set(n,t),t);var Yg=(n,e,t)=>(xj(n,e,"access private method"),t);import{b as hGe,a as Ra,z as v1,c as fGe,p as pGe,t as qV,s as gGe,u as mGe}from"../chunks/index.DMvHr_e9.js";import{s as Hi,e as Ne,b as Kt,c as Fe,h as tt,d as Ee,f as Gt,w as Re,i as Ft,k as we,y as _r,n as Dt,p as HT,r as na,a8 as Kr,B as Fn,a7 as Kf,A as aee,g as Fr,m as Ji,t as Jr,j as Qr,l as yl,am as zL,an as vGe,ao as VL,_ as w2e,C as S2,X as J1,Y as Q1,x as iv,z as qh,o as WL,ad as $ce,q as yGe,ap as bGe,a as KV,J as ov,a9 as _2,af as SGe,ae as Lce,D as _Ge,ag as GV,E as wGe,F as CGe,G as xGe,aq as EGe,ar as IGe}from"../chunks/scheduler.B_HausrX.js";import{e as Fs,a as C2e,d as ZV,h as sv,u as qx,m as XV,g as w2,i as PGe,j as C2,c as kGe,L as TGe}from"../chunks/Layout.BqCPlncL.js";import{S as fo,i as po,g as ja,b as Sn,e as Ba,t as cn,c as Bo,a as Ho,m as Uo,d as zo,f as yy,j as cee,k as DGe,h as YV}from"../chunks/index.BGGFpMsM.js";import{D as Dr,E as ft,R as Gc,l as Ve,d as xd,c as x2e,S as $s,h as RGe,aq as fM,b as AGe,J as DP,w as hr,U as Te,dk as OGe,K as Pp,B as lee,A as E2e,cg as MGe,dp as JV,c2 as $Ge,a_ as zp,ah as QV,Y as ns,t as ho,m as ei,d$ as I2e,g as _S,ch as LGe,bu as Wl,e0 as Hb,bt as UT,u as qL,N as P2e,ag as pM,bp as k2e,cm as Ej,I as Kx,a8 as go,du as gM,cE as RP,dt as eW,cD as Bl,cF as NGe,i as Hm,d_ as AP,bO as Xl,dO as mM,Q as x2,bA as T2e,e1 as FGe,cn as jGe,T as OP,ce as vM,e2 as BGe,n as E2,aQ as KL,e3 as kf,bB as D2e,e4 as y1,H as yM,$ as MP,z as uee,C as Uc,bc as tW,e5 as HGe,bb as bM,bQ as UGe,k as SM,Z as R2e,e6 as zGe,dS as Nce,dQ as gb,am as nW,o as dee,e7 as _M,e8 as rW,dT as Fce,a0 as VGe,V as iW,e9 as WGe,e as Ef,bv as jce,W as Bce,ea as A2e,x as Pw,c5 as Hce,cB as qGe,af as oW,db as KGe,c0 as hee,bN as GGe,_ as ZGe,bq as Qp,ak as O2e,cf as fee,bY as XGe,au as YGe,L as JGe,aa as QGe,aY as eZe,eb as tZe,cJ as Uce,dv as zce,cl as nZe,dy as rZe,d6 as iZe,O as oZe,b8 as XI,b9 as sZe,bs as Vce,ap as aZe,dh as Wce,f as qce,cC as cZe,ec as lZe,ed as uZe,a as dZe}from"../chunks/editor.DUpSOAQE.js";import{e as Fy,h as pee,f as Ir,R as Ke,i as sW,d as y,j as zT,b as Wu,k as hZe,g as aW,a as cW,s as lW,r as uW,c as dW,l as fZe}from"../chunks/server.browser.D4hb9_uX.js";import{i as pZe,C as gZe,j as M2e,_ as gee,R as $2e,k as mZe,h as vZe}from"../chunks/Room.Dup0VRTS.js";import{_ as bd}from"../chunks/preload-helper.D6kgxu3v.js";import{j as x}from"../chunks/jsx-runtime.QxmL55Mq.js";import{bk as yZe,bl as hW,bm as bZe,r as L2e,_ as An,a as Be,bn as N2e,ae as VT,b4 as GL,b as mee,E as vee,a7 as lg,a4 as yee,bo as F2e,bp as zl,bq as CC,a2 as SZe,a3 as wd,br as jy,bs as _Ze,a5 as Ij,bt as wZe,aR as bee,aC as CZe,bu as xZe,bv as j2e,bw as EZe,W as jh,bx as Kce,aD as IZe,aN as PZe,by as kZe,bz as TZe,bA as DZe,bB as RZe,bC as AZe,bD as OZe,aQ as See,bE as kg,aM as ZL,at as _ee,ah as Tg,ay as MZe,ad as XL,bF as fW,bG as wS,bH as Js,bI as B2e,bJ as by,bK as kw,bL as $Ze,bM as LZe,bN as H2e,bO as Gce,bP as NZe,as as FZe,bQ as jZe,Q as wee,bR as U2e,bS as Cee,b1 as Sy,bT as Zce,bU as z2e,bV as V2e,bW as xee,bX as Gx,bY as Eee,bZ as Iee,aH as BZe,aL as HZe,b_ as WT,b$ as UZe,c0 as W2e,R as Zx,c1 as YL,bb as q2e,c2 as zZe,c3 as VZe,c4 as WZe,c5 as WE,c6 as $_,c7 as rf,c8 as Xce,c9 as qE,ca as qZe,cb as KZe,b9 as Xx,cc as K2e,ac as JL,bi as G2e,cd as GZe,ce as Mf,cf as ZZe,cg as XZe,ch as YZe,ci as Dk,cj as wM,ck as Z2e,cl as Pj,cm as JZe,cn as pW,co as QZe,cp as Rc,cq as eXe,cr as tXe,a0 as nXe,cs as Yce,ct as rXe,cu as X2e,cv as Y2e,cw as ac,cx as Oa,cy as Pee,cz as iXe,cA as oXe,cB as sXe,cC as gW,cD as aXe,cE as J2e,cF as mW,cG as r4,cH as I2,cI as xC,X as QL,cJ as cXe,cK as lXe,cL as kee,cM as uXe,cN as dXe,cO as hXe,cP as Jce,aP as fXe,cQ as Q2e,cR as pXe,aB as gXe,cS as mXe,ak as Li,cT as vXe,aU as exe,cU as yXe,cV as bXe,cW as SXe,cX as CM,cY as _Xe,cZ as Yx,c_ as wXe,c$ as Rk,d0 as xM,d1 as CXe,d2 as WR,d3 as xXe,d4 as txe,d5 as EXe,d6 as dn,d7 as Pa,d8 as Qce,d9 as IXe,da as Ii,db as PXe,dc as jc,dd as kXe,de as Cl,df as s_,dg as nxe,dh as kj,di as TXe,dj as DXe,dk as rxe,dl as i4,dm as EM,dn as RXe,dp as _s,dq as pi,dr as vW,ds as vt,dt as IM,du as o4,dv as AXe,dw as OXe,dx as Tee,dy as Ak,dz as MXe,dA as qT,dB as Rn,dC as $a,dD as Mo,dE as $Xe,dF as LXe,dG as NXe,dH as ixe,dI as Ok,dJ as oxe,dK as FXe,dL as ele,dM as Ah,dN as io,dO as P2,dP as eg,dQ as sxe,dR as Dee,dS as axe,dT as $P,dU as tle,dV as _y,dW as cxe,dX as CS,dY as k2,dZ as e7,d_ as J0,d$ as jXe,e0 as Mk,e1 as BXe,e2 as HXe,e3 as UXe,e4 as zXe,e5 as lxe,e6 as Ma,e7 as uxe,e8 as s4,e9 as Ree,ea as VXe,eb as WXe,ec as nle,ed as qXe,ee as KXe,ef as a4,eg as yW,eh as Aee,ei as PM,ej as dxe,ek as bW,el as hxe,em as SW,en as Lc,eo as fxe,ep as kM,eq as pxe,er as gxe,es as mxe,et as Oee,eu as Mee,ev as vxe,ew as $ee,ex as yxe,ey as Lee,ez as rle,eA as LP,eB as Nee,eC as bxe,eD as Tj,eE as KT,eF as YI,eG as _W,eH as Sxe,eI as _xe,eJ as NP,eK as c4,eL as FP,eM as GXe,eN as ZXe,eO as wxe,eP as Tw,eQ as qR,eR as l4,eS as XXe,eT as YXe,eU as ile,eV as Fee,eW as JXe,eX as QXe,eY as eYe,eZ as tYe,e_ as JI,e$ as QI,f0 as ole,f1 as Cxe,f2 as nYe,f3 as rYe,f4 as iYe,f5 as xxe,f6 as Exe,f7 as Ixe,f8 as wW,f9 as Pxe,fa as kxe,a9 as t7,fb as Q0,fc as oYe,fd as CW,fe as Txe,ff as TM,fg as sYe,fh as aYe,fi as cYe,fj as lYe,fk as Dxe,fl as Rxe,fm as mo,fn as uYe,fo as dYe,fp as hYe,fq as fYe,fr as pYe,fs as gYe,ft as Axe,fu as Hf,fv as Oxe,fw as Mxe,fx as xW,fy as mYe,fz as vYe,fA as Jl,fB as jP,fC as EW,fD as sle,fE as DM,fF as RM,fG as yYe,fH as IW,fI as $xe,fJ as AM,fK as Lxe,fL as Nxe,fM as bYe,fN as Fxe,fO as jxe,fP as Bxe,fQ as Dj,fR as ale,fS as SYe,fT as PW,fU as Hxe,fV as Uxe,fW as zxe,fX as Vxe,fY as jee,fZ as Wxe,f_ as _Ye,f$ as wYe,g0 as kW,g1 as Rj,g2 as qxe,g3 as CYe,g4 as Kxe,g5 as Gxe,g6 as cle,g7 as lle,g8 as TW,g9 as xYe,ga as EYe,gb as ule,gc as Zxe,gd as IYe,ge as DW,gf as PYe,gg as kYe,gh as TYe,gi as DYe,gj as RW,gk as OM,gl as RYe,gm as AYe,gn as AW,go as OW,gp as EC,gq as Xxe,gr as Yxe,gs as Jxe,gt as MM,gu as dle,gv as T2,gw as KR,gx as OYe,gy as MW,gz as $W,gA as Aj,gB as LW,gC as Oj,gD as MYe,gE as $Ye,gF as Qxe,gG as eEe,gH as $M,gI as eP,gJ as LYe,gK as tEe,gL as nEe,gM as NW,gN as NYe,gO as rEe,gP as u4,gQ as FYe,gR as jYe,gS as n7,gT as BYe,gU as HYe,gV as UYe,gW as zYe,gX as hle,gY as FW,gZ as r7,g_ as VYe,g$ as iEe,h0 as oEe,h1 as WYe,h2 as qYe,h3 as KYe,h4 as GYe,h5 as ZYe,h6 as IC,h7 as XYe,h8 as sEe,h9 as d4,ha as aEe,hb as jW,hc as YYe,hd as JYe,he as QYe,hf as cEe,hg as fle,hh as BW,hi as eJe,hj as ple,hk as HW,hl as tJe,hm as nJe,hn as lEe,ho as rJe,hp as h4,hq as iJe,hr as Jg,hs as LM,ht as gle,hu as oJe,hv as uEe,hw as sJe,hx as aJe,hy as dEe,hz as mle,hA as vle,hB as cJe,hC as L_,hD as lJe,hE as uJe,hF as yle,hG as hEe,hH as dJe,hI as UW,hJ as GR,hK as ble,hL as fEe,hM as hJe,hN as zW,hO as fJe,hP as pEe,hQ as pJe,hR as gJe,hS as VW,hT as f4,hU as WW,hV as gEe,hW as p4,hX as qW,hY as mJe,hZ as Uw,h_ as g4,h$ as KW,i0 as Sle,i1 as mEe,i2 as vJe,i3 as GW,i4 as yJe,i5 as bJe,i6 as SJe,i7 as vEe,i8 as _le,i9 as Dw,ia as yEe,ib as Rw,ic as bEe,id as SEe,ie as _Je,ig as Qg,ih as _Ee,ii as wJe,ij as Pn,ik as CJe,il as xJe,im as EJe,io as IJe,ip as PJe,iq as kJe,ir as TJe,is as DJe,it as RJe,iu as AJe,iv as OJe,iw as MJe,ix as $Je,iy as LJe,iz as NJe,iA as wle,iB as FJe,iC as jJe,iD as BJe,iE as HJe,iF as UJe,iG as zJe,iH as VJe,iI as WJe,iJ as qJe,iK as KJe,iL as GJe,iM as ZJe,iN as XJe,iO as YJe,iP as JJe,iQ as QJe,iR as eQe,iS as tQe,iT as nQe,iU as rQe,iV as iQe,iW as tP,iX as oQe,iY as sQe,iZ as aQe,i_ as Cle,i$ as cQe,j0 as lQe,j1 as uQe,j2 as dQe,j3 as hQe,j4 as fQe,j5 as pQe,j6 as gQe,j7 as mQe,j8 as vQe,j9 as yQe,ja as bQe,jb as SQe,jc as _Qe,jd as wQe,je as CQe,jf as xQe,jg as EQe,jh as IQe,ji as PQe,jj as kQe,jk as TQe,jl as DQe,jm as RQe,jn as AQe,jo as OQe,jp as MQe,jq as $Qe,jr as LQe,js as wEe,jt as NQe,ju as FQe,jv as jQe,jw as BQe,jx as HQe,jy as UQe,jz as zQe,jA as VQe,jB as WQe,jC as qQe,jD as KQe,jE as GQe,jF as ZQe,jG as XQe,jH as YQe,jI as JQe,jJ as QQe,jK as eet,jL as tet,jM as net,jN as ret,jO as iet,jP as oet,jQ as set,jR as aet,jS as cet,jT as uet,jU as det,jV as het,jW as fet,jX as pet,jY as get,jZ as xle,j_ as Ele,j$ as Ile,k0 as met,k1 as vet,k2 as yet,k3 as bet,k4 as _et,k5 as wet,k6 as CEe,k7 as Cet,k8 as xet,af as Eet,ag as Iet,k9 as Pet,ka as ket,kb as Ple,kc as Tet,kd as Det,ke as Ret,kf as Aet,kg as Oet,S as Met,U as $et,ai as Let,b5 as Net,kh as Fet,ki as jet,kj as kle,kk as xEe,kl as Tle,km as Bet,kn as Het,ko as Uet,kp as zet,bj as Vet,kq as Wet,kr as qet,ks as Ket,kt as Get,ku as Zet}from"../chunks/editor.api.C1vQ_HcD.js";import{g as Dle}from"../chunks/entry.DuanofX2.js";const Mj={workspace:"last-workspace"},NM={get workspace(){return localStorage.getItem(Mj.workspace)},set workspace(n){n?localStorage.setItem(Mj.workspace,n):localStorage.removeItem(Mj.workspace)}},Xet=!0,Yet=!1;async function Jet(n){await hGe(n);let e=n.url.searchParams.get("workspace");return e??(e=NM.workspace),{workspace:e}}const Pcn=Object.freeze(Object.defineProperty({__proto__:null,load:Jet,prerender:Xet,ssr:Yet},Symbol.toStringTag,{value:"Module"}));let EEe;const Qet=n=>EEe=n;let IEe,PEe;const ett=n=>IEe=n,ttt=n=>PEe=n;let FM;const ntt=()=>{const n=FM;return FM=void 0,n},ey=({Component:n,props:e,onClose:t})=>{FM={component:new n({target:EEe,props:e}),close:t},IEe()},i7=()=>{FM&&PEe()};function rtt(n){let e,t,r,i,o,s,a;return{c(){e=Ne("dialog"),t=Ne("div"),r=Kt(),i=Ne("form"),o=Ne("button"),this.h()},l(c){e=Fe(c,"DIALOG",{id:!0,class:!0});var l=tt(e);t=Fe(l,"DIV",{class:!0}),tt(t).forEach(Ee),r=Gt(l),i=Fe(l,"FORM",{method:!0,class:!0});var u=tt(i);o=Fe(u,"BUTTON",{}),tt(o).forEach(Ee),u.forEach(Ee),l.forEach(Ee),this.h()},h(){Re(t,"class","modal-box h-4/5 w-4/5 max-w-full"),Re(i,"method","dialog"),Re(i,"class","modal-backdrop"),Re(e,"id","global-modal"),Re(e,"class","modal py-0")},m(c,l){Ft(c,e,l),we(e,t),n[4](t),we(e,r),we(e,i),we(i,o),n[5](o),n[6](i),n[8](e),s||(a=_r(i,"submit",n[7]),s=!0)},p:Dt,i:Dt,o:Dt,d(c){c&&Ee(e),n[4](null),n[5](null),n[6](null),n[8](null),s=!1,a()}}}function itt(n,e,t){let r,i;ett(()=>{window[r.id].showModal()}),HT(()=>{Qet(i),ttt(()=>a.click())});let s,a;function c(f){na[f?"unshift":"push"](()=>{i=f,t(1,i)})}function l(f){na[f?"unshift":"push"](()=>{a=f,t(3,a)})}function u(f){na[f?"unshift":"push"](()=>{s=f,t(2,s)})}const d=async()=>{const f=ntt();if(!f)return;const{component:p,close:g}=f;g==null||g(p),p==null||p.$destroy()};function h(f){na[f?"unshift":"push"](()=>{r=f,t(0,r)})}return[r,i,s,a,c,l,u,d,h]}class ott extends fo{constructor(e){super(),po(this,e,itt,rtt,Hi,{})}}function Rle(n,e,t){const r=n.slice();return r[13]=e[t].content,r[14]=e[t].type,r}function Ale(n){let e,t,r=`Program Output will appear here...
                    `;return{c(){e=Ne("pre"),t=Ne("code"),t.textContent=r,this.h()},l(i){e=Fe(i,"PRE",{"data-prefix":!0});var o=tt(e);t=Fe(o,"CODE",{class:!0,"data-svelte-h":!0}),Fr(t)!=="svelte-1pm25n2"&&(t.textContent=r),o.forEach(Ee),this.h()},h(){Re(t,"class","italic"),Fn(t,"color","var(--neutral-light)"),Re(e,"data-prefix",">>>")},m(i,o){Ft(i,e,o),we(e,t)},d(i){i&&Ee(e)}}}function stt(n){let e,t,r=n[13]+"",i;return{c(){e=Ne("pre"),t=Ne("code"),i=Jr(r),this.h()},l(o){e=Fe(o,"PRE",{"data-prefix":!0});var s=tt(e);t=Fe(s,"CODE",{});var a=tt(t);i=Qr(a,r),a.forEach(Ee),s.forEach(Ee),this.h()},h(){Re(e,"data-prefix",">>>"),Kr(e,"text-error-content",n[14]==="error"),Kr(e,"bg-error",n[14]==="error")},m(o,s){Ft(o,e,s),we(e,t),we(t,i)},p(o,s){s&1&&r!==(r=o[13]+"")&&yl(i,r),s&1&&Kr(e,"text-error-content",o[14]==="error"),s&1&&Kr(e,"bg-error",o[14]==="error")},d(o){o&&Ee(e)}}}function att(n){let e,t,r=n[13]+"",i,o;return{c(){e=Ne("div"),t=Ne("div"),i=Jr(r),o=Kt(),this.h()},l(s){e=Fe(s,"DIV",{class:!0,style:!0});var a=tt(e);t=Fe(a,"DIV",{class:!0});var c=tt(t);i=Qr(c,r),c.forEach(Ee),o=Gt(a),a.forEach(Ee),this.h()},h(){Re(t,"class","divider my-1 svelte-g62wyf"),Re(e,"class","flex w-full flex-col px-6 text-xs"),Fn(e,"--fallback-bc","var(--neutral-light)"),Fn(e,"color","var(--neutral-light)")},m(s,a){Ft(s,e,a),we(e,t),we(t,i),we(e,o)},p(s,a){a&1&&r!==(r=s[13]+"")&&yl(i,r)},d(s){s&&Ee(e)}}}function Ole(n){let e;function t(o,s){return o[14]==="divider"?att:stt}let r=t(n),i=r(n);return{c(){i.c(),e=Ji()},l(o){i.l(o),e=Ji()},m(o,s){i.m(o,s),Ft(o,e,s)},p(o,s){r===(r=t(o))&&i?i.p(o,s):(i.d(1),i=r(o),i&&(i.c(),i.m(e.parentNode,e)))},d(o){o&&Ee(e),i.d(o)}}}function Mle(n){let e,t,r="Clear",i,o;return{c(){e=Ne("div"),t=Ne("button"),t.textContent=r,this.h()},l(s){e=Fe(s,"DIV",{class:!0});var a=tt(e);t=Fe(a,"BUTTON",{class:!0,"data-svelte-h":!0}),Fr(t)!=="svelte-1y2redj"&&(t.textContent=r),a.forEach(Ee),this.h()},h(){Re(t,"class","flex-grow btn btn-base btn-xs rounded-none rounded-bl-lg"),Re(e,"class","flex flex-row"),Fn(e,"gap","0.1rem")},m(s,a){Ft(s,e,a),we(e,t),i||(o=_r(t,"click",n[11]),i=!0)},p:Dt,d(s){s&&Ee(e),i=!1,o()}}}function ctt(n){let e,t,r,i,o=n[0].length===0&&Ale(),s=Fs(n[0]),a=[];for(let l=0;l<s.length;l+=1)a[l]=Ole(Rle(n,s,l));let c=n[1]&&Mle(n);return{c(){e=Ne("div"),t=Ne("div"),o&&o.c(),r=Kt();for(let l=0;l<a.length;l+=1)a[l].c();i=Kt(),c&&c.c(),this.h()},l(l){e=Fe(l,"DIV",{class:!0});var u=tt(e);t=Fe(u,"DIV",{class:!0});var d=tt(t);o&&o.l(d),r=Gt(d);for(let h=0;h<a.length;h+=1)a[h].l(d);d.forEach(Ee),i=Gt(u),c&&c.l(u),u.forEach(Ee),this.h()},h(){Re(t,"class","mockup-code pt-0 overflow-y-scroll flex-grow bg-neutral-medium text-white svelte-g62wyf"),Kr(t,"rounded-none",!n[2]),Kr(t,"rounded-md",n[2]),Re(e,"class","h-full flex flex-col min-w-0"),Fn(e,"opacity",n[3]),Fn(e,"transition","opacity 0.2s")},m(l,u){Ft(l,e,u),we(e,t),o&&o.m(t,null),we(t,r);for(let d=0;d<a.length;d+=1)a[d]&&a[d].m(t,null);n[10](t),we(e,i),c&&c.m(e,null)},p(l,[u]){if(l[0].length===0?o||(o=Ale(),o.c(),o.m(t,r)):o&&(o.d(1),o=null),u&1){s=Fs(l[0]);let d;for(d=0;d<s.length;d+=1){const h=Rle(l,s,d);a[d]?a[d].p(h,u):(a[d]=Ole(h),a[d].c(),a[d].m(t,null))}for(;d<a.length;d+=1)a[d].d(1);a.length=s.length}u&4&&Kr(t,"rounded-none",!l[2]),u&4&&Kr(t,"rounded-md",l[2]),l[1]?c?c.p(l,u):(c=Mle(l),c.c(),c.m(e,null)):c&&(c.d(1),c=null),u&8&&Fn(e,"opacity",l[3])},i:Dt,o:Dt,d(l){l&&Ee(e),o&&o.d(),Kf(a,l),n[10](null),c&&c.d()}}}function ltt(n,e,t){let{clearCallback:r}=e,{doRegister:i=!0}=e,{rounded:o=!1}=e,{opacity:s=1}=e,{items:a=[]}=e,c;const l=()=>{t(0,a=[]),console.log(r),r==null||r()},u=(g,m="default")=>{a.push({content:g,type:m}),t(0,a),ZV(c)},d=g=>{a.length===0?u(g):(t(0,a[a.length-1].content+=g,a),t(0,a))},h=()=>a;i&&C2e.register(),aee(()=>ZV(c));function f(g){na[g?"unshift":"push"](()=>{c=g,t(5,c)})}const p=()=>l();return n.$$set=g=>{"clearCallback"in g&&t(1,r=g.clearCallback),"doRegister"in g&&t(6,i=g.doRegister),"rounded"in g&&t(2,o=g.rounded),"opacity"in g&&t(3,s=g.opacity),"items"in g&&t(0,a=g.items)},[a,r,o,s,l,c,i,u,d,h,f,p]}class ZW extends fo{constructor(e){super(),po(this,e,ltt,ctt,Hi,{clearCallback:1,doRegister:6,rounded:2,opacity:3,items:0,clear:4,append:7,appendToLast:8,getItems:9})}get clear(){return this.$$.ctx[4]}get append(){return this.$$.ctx[7]}get appendToLast(){return this.$$.ctx[8]}get getItems(){return this.$$.ctx[9]}}const $le={};function utt(n){let e=$le[n];if(e)return e;e=$le[n]=[];for(let t=0;t<128;t++){const r=String.fromCharCode(t);e.push(r)}for(let t=0;t<n.length;t++){const r=n.charCodeAt(t);e[r]="%"+("0"+r.toString(16).toUpperCase()).slice(-2)}return e}function D2(n,e){typeof e!="string"&&(e=D2.defaultChars);const t=utt(e);return n.replace(/(%[a-f0-9]{2})+/gi,function(r){let i="";for(let o=0,s=r.length;o<s;o+=3){const a=parseInt(r.slice(o+1,o+3),16);if(a<128){i+=t[a];continue}if((a&224)===192&&o+3<s){const c=parseInt(r.slice(o+4,o+6),16);if((c&192)===128){const l=a<<6&1984|c&63;l<128?i+="��":i+=String.fromCharCode(l),o+=3;continue}}if((a&240)===224&&o+6<s){const c=parseInt(r.slice(o+4,o+6),16),l=parseInt(r.slice(o+7,o+9),16);if((c&192)===128&&(l&192)===128){const u=a<<12&61440|c<<6&4032|l&63;u<2048||u>=55296&&u<=57343?i+="���":i+=String.fromCharCode(u),o+=6;continue}}if((a&248)===240&&o+9<s){const c=parseInt(r.slice(o+4,o+6),16),l=parseInt(r.slice(o+7,o+9),16),u=parseInt(r.slice(o+10,o+12),16);if((c&192)===128&&(l&192)===128&&(u&192)===128){let d=a<<18&1835008|c<<12&258048|l<<6&4032|u&63;d<65536||d>1114111?i+="����":(d-=65536,i+=String.fromCharCode(55296+(d>>10),56320+(d&1023))),o+=9;continue}}i+="�"}return i})}D2.defaultChars=";/?:@&=+$,#";D2.componentChars="";const Lle={};function dtt(n){let e=Lle[n];if(e)return e;e=Lle[n]=[];for(let t=0;t<128;t++){const r=String.fromCharCode(t);/^[0-9a-z]$/i.test(r)?e.push(r):e.push("%"+("0"+t.toString(16).toUpperCase()).slice(-2))}for(let t=0;t<n.length;t++)e[n.charCodeAt(t)]=n[t];return e}function GT(n,e,t){typeof e!="string"&&(t=e,e=GT.defaultChars),typeof t>"u"&&(t=!0);const r=dtt(e);let i="";for(let o=0,s=n.length;o<s;o++){const a=n.charCodeAt(o);if(t&&a===37&&o+2<s&&/^[0-9a-f]{2}$/i.test(n.slice(o+1,o+3))){i+=n.slice(o,o+3),o+=2;continue}if(a<128){i+=r[a];continue}if(a>=55296&&a<=57343){if(a>=55296&&a<=56319&&o+1<s){const c=n.charCodeAt(o+1);if(c>=56320&&c<=57343){i+=encodeURIComponent(n[o]+n[o+1]),o++;continue}}i+="%EF%BF%BD";continue}i+=encodeURIComponent(n[o])}return i}GT.defaultChars=";/?:@&=+$,-_.!~*'()#";GT.componentChars="-_.!~*'()";function Bee(n){let e="";return e+=n.protocol||"",e+=n.slashes?"//":"",e+=n.auth?n.auth+"@":"",n.hostname&&n.hostname.indexOf(":")!==-1?e+="["+n.hostname+"]":e+=n.hostname||"",e+=n.port?":"+n.port:"",e+=n.pathname||"",e+=n.search||"",e+=n.hash||"",e}function jM(){this.protocol=null,this.slashes=null,this.auth=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.pathname=null}const htt=/^([a-z0-9.+-]+:)/i,ftt=/:[0-9]*$/,ptt=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,gtt=["<",">",'"',"`"," ","\r",`
`,"	"],mtt=["{","}","|","\\","^","`"].concat(gtt),vtt=["'"].concat(mtt),Nle=["%","/","?",";","#"].concat(vtt),Fle=["/","?","#"],ytt=255,jle=/^[+a-z0-9A-Z_-]{0,63}$/,btt=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,Ble={javascript:!0,"javascript:":!0},Hle={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function Hee(n,e){if(n&&n instanceof jM)return n;const t=new jM;return t.parse(n,e),t}jM.prototype.parse=function(n,e){let t,r,i,o=n;if(o=o.trim(),!e&&n.split("#").length===1){const l=ptt.exec(o);if(l)return this.pathname=l[1],l[2]&&(this.search=l[2]),this}let s=htt.exec(o);if(s&&(s=s[0],t=s.toLowerCase(),this.protocol=s,o=o.substr(s.length)),(e||s||o.match(/^\/\/[^@\/]+@[^@\/]+/))&&(i=o.substr(0,2)==="//",i&&!(s&&Ble[s])&&(o=o.substr(2),this.slashes=!0)),!Ble[s]&&(i||s&&!Hle[s])){let l=-1;for(let p=0;p<Fle.length;p++)r=o.indexOf(Fle[p]),r!==-1&&(l===-1||r<l)&&(l=r);let u,d;l===-1?d=o.lastIndexOf("@"):d=o.lastIndexOf("@",l),d!==-1&&(u=o.slice(0,d),o=o.slice(d+1),this.auth=u),l=-1;for(let p=0;p<Nle.length;p++)r=o.indexOf(Nle[p]),r!==-1&&(l===-1||r<l)&&(l=r);l===-1&&(l=o.length),o[l-1]===":"&&l--;const h=o.slice(0,l);o=o.slice(l),this.parseHost(h),this.hostname=this.hostname||"";const f=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!f){const p=this.hostname.split(/\./);for(let g=0,m=p.length;g<m;g++){const v=p[g];if(v&&!v.match(jle)){let b="";for(let S=0,E=v.length;S<E;S++)v.charCodeAt(S)>127?b+="x":b+=v[S];if(!b.match(jle)){const S=p.slice(0,g),E=p.slice(g+1),w=v.match(btt);w&&(S.push(w[1]),E.unshift(w[2])),E.length&&(o=E.join(".")+o),this.hostname=S.join(".");break}}}}this.hostname.length>ytt&&(this.hostname=""),f&&(this.hostname=this.hostname.substr(1,this.hostname.length-2))}const a=o.indexOf("#");a!==-1&&(this.hash=o.substr(a),o=o.slice(0,a));const c=o.indexOf("?");return c!==-1&&(this.search=o.substr(c),o=o.slice(0,c)),o&&(this.pathname=o),Hle[t]&&this.hostname&&!this.pathname&&(this.pathname=""),this};jM.prototype.parseHost=function(n){let e=ftt.exec(n);e&&(e=e[0],e!==":"&&(this.port=e.substr(1)),n=n.substr(0,n.length-e.length)),n&&(this.hostname=n)};const Stt=Object.freeze(Object.defineProperty({__proto__:null,decode:D2,encode:GT,format:Bee,parse:Hee},Symbol.toStringTag,{value:"Module"})),kEe=/[\0-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,TEe=/[\0-\x1F\x7F-\x9F]/,_tt=/[\xAD\u0600-\u0605\u061C\u06DD\u070F\u0890\u0891\u08E2\u180E\u200B-\u200F\u202A-\u202E\u2060-\u2064\u2066-\u206F\uFEFF\uFFF9-\uFFFB]|\uD804[\uDCBD\uDCCD]|\uD80D[\uDC30-\uDC3F]|\uD82F[\uDCA0-\uDCA3]|\uD834[\uDD73-\uDD7A]|\uDB40[\uDC01\uDC20-\uDC7F]/,Uee=/[!-#%-\*,-\/:;\?@\[-\]_\{\}\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061D-\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1B7D\u1B7E\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52-\u2E5D\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDEAD\uDF55-\uDF59\uDF86-\uDF89]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5A\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDEB9\uDF3C-\uDF3E]|\uD806[\uDC3B\uDD44-\uDD46\uDDE2\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2\uDF00-\uDF09]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8\uDF43-\uDF4F\uDFFF]|\uD809[\uDC70-\uDC74]|\uD80B[\uDFF1\uDFF2]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD81B[\uDE97-\uDE9A\uDFE2]|\uD82F\uDC9F|\uD836[\uDE87-\uDE8B]|\uD83A[\uDD5E\uDD5F]/,DEe=/[\$\+<->\^`\|~\xA2-\xA6\xA8\xA9\xAC\xAE-\xB1\xB4\xB8\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u02FF\u0375\u0384\u0385\u03F6\u0482\u058D-\u058F\u0606-\u0608\u060B\u060E\u060F\u06DE\u06E9\u06FD\u06FE\u07F6\u07FE\u07FF\u0888\u09F2\u09F3\u09FA\u09FB\u0AF1\u0B70\u0BF3-\u0BFA\u0C7F\u0D4F\u0D79\u0E3F\u0F01-\u0F03\u0F13\u0F15-\u0F17\u0F1A-\u0F1F\u0F34\u0F36\u0F38\u0FBE-\u0FC5\u0FC7-\u0FCC\u0FCE\u0FCF\u0FD5-\u0FD8\u109E\u109F\u1390-\u1399\u166D\u17DB\u1940\u19DE-\u19FF\u1B61-\u1B6A\u1B74-\u1B7C\u1FBD\u1FBF-\u1FC1\u1FCD-\u1FCF\u1FDD-\u1FDF\u1FED-\u1FEF\u1FFD\u1FFE\u2044\u2052\u207A-\u207C\u208A-\u208C\u20A0-\u20C0\u2100\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F\u218A\u218B\u2190-\u2307\u230C-\u2328\u232B-\u2426\u2440-\u244A\u249C-\u24E9\u2500-\u2767\u2794-\u27C4\u27C7-\u27E5\u27F0-\u2982\u2999-\u29D7\u29DC-\u29FB\u29FE-\u2B73\u2B76-\u2B95\u2B97-\u2BFF\u2CE5-\u2CEA\u2E50\u2E51\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFF\u3004\u3012\u3013\u3020\u3036\u3037\u303E\u303F\u309B\u309C\u3190\u3191\u3196-\u319F\u31C0-\u31E3\u31EF\u3200-\u321E\u322A-\u3247\u3250\u3260-\u327F\u328A-\u32B0\u32C0-\u33FF\u4DC0-\u4DFF\uA490-\uA4C6\uA700-\uA716\uA720\uA721\uA789\uA78A\uA828-\uA82B\uA836-\uA839\uAA77-\uAA79\uAB5B\uAB6A\uAB6B\uFB29\uFBB2-\uFBC2\uFD40-\uFD4F\uFDCF\uFDFC-\uFDFF\uFE62\uFE64-\uFE66\uFE69\uFF04\uFF0B\uFF1C-\uFF1E\uFF3E\uFF40\uFF5C\uFF5E\uFFE0-\uFFE6\uFFE8-\uFFEE\uFFFC\uFFFD]|\uD800[\uDD37-\uDD3F\uDD79-\uDD89\uDD8C-\uDD8E\uDD90-\uDD9C\uDDA0\uDDD0-\uDDFC]|\uD802[\uDC77\uDC78\uDEC8]|\uD805\uDF3F|\uD807[\uDFD5-\uDFF1]|\uD81A[\uDF3C-\uDF3F\uDF45]|\uD82F\uDC9C|\uD833[\uDF50-\uDFC3]|\uD834[\uDC00-\uDCF5\uDD00-\uDD26\uDD29-\uDD64\uDD6A-\uDD6C\uDD83\uDD84\uDD8C-\uDDA9\uDDAE-\uDDEA\uDE00-\uDE41\uDE45\uDF00-\uDF56]|\uD835[\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3]|\uD836[\uDC00-\uDDFF\uDE37-\uDE3A\uDE6D-\uDE74\uDE76-\uDE83\uDE85\uDE86]|\uD838[\uDD4F\uDEFF]|\uD83B[\uDCAC\uDCB0\uDD2E\uDEF0\uDEF1]|\uD83C[\uDC00-\uDC2B\uDC30-\uDC93\uDCA0-\uDCAE\uDCB1-\uDCBF\uDCC1-\uDCCF\uDCD1-\uDCF5\uDD0D-\uDDAD\uDDE6-\uDE02\uDE10-\uDE3B\uDE40-\uDE48\uDE50\uDE51\uDE60-\uDE65\uDF00-\uDFFF]|\uD83D[\uDC00-\uDED7\uDEDC-\uDEEC\uDEF0-\uDEFC\uDF00-\uDF76\uDF7B-\uDFD9\uDFE0-\uDFEB\uDFF0]|\uD83E[\uDC00-\uDC0B\uDC10-\uDC47\uDC50-\uDC59\uDC60-\uDC87\uDC90-\uDCAD\uDCB0\uDCB1\uDD00-\uDE53\uDE60-\uDE6D\uDE70-\uDE7C\uDE80-\uDE88\uDE90-\uDEBD\uDEBF-\uDEC5\uDECE-\uDEDB\uDEE0-\uDEE8\uDEF0-\uDEF8\uDF00-\uDF92\uDF94-\uDFCA]/,REe=/[ \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000]/,wtt=Object.freeze(Object.defineProperty({__proto__:null,Any:kEe,Cc:TEe,Cf:_tt,P:Uee,S:DEe,Z:REe},Symbol.toStringTag,{value:"Module"})),Ctt=new Uint16Array('ᵁ<Õıʊҝջאٵ۞ޢߖࠏ੊ઑඡ๭༉༦჊ረዡᐕᒝᓃᓟᔥ\0\0\0\0\0\0ᕫᛍᦍᰒᷝ὾⁠↰⊍⏀⏻⑂⠤⤒ⴈ⹈⿎〖㊺㘹㞬㣾㨨㩱㫠㬮ࠀEMabcfglmnoprstu\\bfms¦³¹ÈÏlig耻Æ䃆P耻&䀦cute耻Á䃁reve;䄂Āiyx}rc耻Â䃂;䐐r;쀀𝔄rave耻À䃀pha;䎑acr;䄀d;橓Āgp¡on;䄄f;쀀𝔸plyFunction;恡ing耻Å䃅Ācs¾Ãr;쀀𝒜ign;扔ilde耻Ã䃃ml耻Ä䃄ЀaceforsuåûþėĜĢħĪĀcrêòkslash;或Ŷöø;櫧ed;挆y;䐑ƀcrtąċĔause;戵noullis;愬a;䎒r;쀀𝔅pf;쀀𝔹eve;䋘còēmpeq;扎܀HOacdefhilorsuōőŖƀƞƢƵƷƺǜȕɳɸɾcy;䐧PY耻©䂩ƀcpyŝŢźute;䄆Ā;iŧŨ拒talDifferentialD;慅leys;愭ȀaeioƉƎƔƘron;䄌dil耻Ç䃇rc;䄈nint;戰ot;䄊ĀdnƧƭilla;䂸terDot;䂷òſi;䎧rcleȀDMPTǇǋǑǖot;抙inus;抖lus;投imes;抗oĀcsǢǸkwiseContourIntegral;戲eCurlyĀDQȃȏoubleQuote;思uote;怙ȀlnpuȞȨɇɕonĀ;eȥȦ户;橴ƀgitȯȶȺruent;扡nt;戯ourIntegral;戮ĀfrɌɎ;愂oduct;成nterClockwiseContourIntegral;戳oss;樯cr;쀀𝒞pĀ;Cʄʅ拓ap;才րDJSZacefiosʠʬʰʴʸˋ˗ˡ˦̳ҍĀ;oŹʥtrahd;椑cy;䐂cy;䐅cy;䐏ƀgrsʿ˄ˇger;怡r;憡hv;櫤Āayː˕ron;䄎;䐔lĀ;t˝˞戇a;䎔r;쀀𝔇Āaf˫̧Ācm˰̢riticalȀADGT̖̜̀̆cute;䂴oŴ̋̍;䋙bleAcute;䋝rave;䁠ilde;䋜ond;拄ferentialD;慆Ѱ̽\0\0\0͔͂\0Ѕf;쀀𝔻ƀ;DE͈͉͍䂨ot;惜qual;扐blèCDLRUVͣͲ΂ϏϢϸontourIntegraìȹoɴ͹\0\0ͻ»͉nArrow;懓Āeo·ΤftƀARTΐΖΡrrow;懐ightArrow;懔eåˊngĀLRΫτeftĀARγιrrow;柸ightArrow;柺ightArrow;柹ightĀATϘϞrrow;懒ee;抨pɁϩ\0\0ϯrrow;懑ownArrow;懕erticalBar;戥ǹABLRTaВЪаўѿͼrrowƀ;BUНОТ憓ar;椓pArrow;懵reve;䌑eft˒к\0ц\0ѐightVector;楐eeVector;楞ectorĀ;Bљњ憽ar;楖ightǔѧ\0ѱeeVector;楟ectorĀ;BѺѻ懁ar;楗eeĀ;A҆҇护rrow;憧ĀctҒҗr;쀀𝒟rok;䄐ࠀNTacdfglmopqstuxҽӀӄӋӞӢӧӮӵԡԯԶՒ՝ՠեG;䅊H耻Ð䃐cute耻É䃉ƀaiyӒӗӜron;䄚rc耻Ê䃊;䐭ot;䄖r;쀀𝔈rave耻È䃈ement;戈ĀapӺӾcr;䄒tyɓԆ\0\0ԒmallSquare;旻erySmallSquare;斫ĀgpԦԪon;䄘f;쀀𝔼silon;䎕uĀaiԼՉlĀ;TՂՃ橵ilde;扂librium;懌Āci՗՚r;愰m;橳a;䎗ml耻Ë䃋Āipժկsts;戃onentialE;慇ʀcfiosօֈ֍ֲ׌y;䐤r;쀀𝔉lledɓ֗\0\0֣mallSquare;旼erySmallSquare;斪Ͱֺ\0ֿ\0\0ׄf;쀀𝔽All;戀riertrf;愱cò׋؀JTabcdfgorstר׬ׯ׺؀ؒؖ؛؝أ٬ٲcy;䐃耻>䀾mmaĀ;d׷׸䎓;䏜reve;䄞ƀeiy؇،ؐdil;䄢rc;䄜;䐓ot;䄠r;쀀𝔊;拙pf;쀀𝔾eater̀EFGLSTصلَٖٛ٦qualĀ;Lؾؿ扥ess;招ullEqual;执reater;檢ess;扷lantEqual;橾ilde;扳cr;쀀𝒢;扫ЀAacfiosuڅڋږڛڞڪھۊRDcy;䐪Āctڐڔek;䋇;䁞irc;䄤r;愌lbertSpace;愋ǰگ\0ڲf;愍izontalLine;攀Āctۃۅòکrok;䄦mpńېۘownHumðįqual;扏܀EJOacdfgmnostuۺ۾܃܇܎ܚܞܡܨ݄ݸދޏޕcy;䐕lig;䄲cy;䐁cute耻Í䃍Āiyܓܘrc耻Î䃎;䐘ot;䄰r;愑rave耻Ì䃌ƀ;apܠܯܿĀcgܴܷr;䄪inaryI;慈lieóϝǴ݉\0ݢĀ;eݍݎ戬Āgrݓݘral;戫section;拂isibleĀCTݬݲomma;恣imes;恢ƀgptݿރވon;䄮f;쀀𝕀a;䎙cr;愐ilde;䄨ǫޚ\0ޞcy;䐆l耻Ï䃏ʀcfosuެ޷޼߂ߐĀiyޱ޵rc;䄴;䐙r;쀀𝔍pf;쀀𝕁ǣ߇\0ߌr;쀀𝒥rcy;䐈kcy;䐄΀HJacfosߤߨ߽߬߱ࠂࠈcy;䐥cy;䐌ppa;䎚Āey߶߻dil;䄶;䐚r;쀀𝔎pf;쀀𝕂cr;쀀𝒦րJTaceflmostࠥࠩࠬࡐࡣ঳সে্਷ੇcy;䐉耻<䀼ʀcmnpr࠷࠼ࡁࡄࡍute;䄹bda;䎛g;柪lacetrf;愒r;憞ƀaeyࡗ࡜ࡡron;䄽dil;䄻;䐛Āfsࡨ॰tԀACDFRTUVarࡾࢩࢱࣦ࣠ࣼयज़ΐ४Ānrࢃ࢏gleBracket;柨rowƀ;BR࢙࢚࢞憐ar;懤ightArrow;懆eiling;挈oǵࢷ\0ࣃbleBracket;柦nǔࣈ\0࣒eeVector;楡ectorĀ;Bࣛࣜ懃ar;楙loor;挊ightĀAV࣯ࣵrrow;憔ector;楎Āerँगeƀ;AVउऊऐ抣rrow;憤ector;楚iangleƀ;BEतथऩ抲ar;槏qual;抴pƀDTVषूौownVector;楑eeVector;楠ectorĀ;Bॖॗ憿ar;楘ectorĀ;B॥०憼ar;楒ightáΜs̀EFGLSTॾঋকঝঢভqualGreater;拚ullEqual;扦reater;扶ess;檡lantEqual;橽ilde;扲r;쀀𝔏Ā;eঽা拘ftarrow;懚idot;䄿ƀnpw৔ਖਛgȀLRlr৞৷ਂਐeftĀAR০৬rrow;柵ightArrow;柷ightArrow;柶eftĀarγਊightáοightáϊf;쀀𝕃erĀLRਢਬeftArrow;憙ightArrow;憘ƀchtਾੀੂòࡌ;憰rok;䅁;扪Ѐacefiosuਗ਼੝੠੷੼અઋ઎p;椅y;䐜Ādl੥੯iumSpace;恟lintrf;愳r;쀀𝔐nusPlus;戓pf;쀀𝕄cò੶;䎜ҀJacefostuણધભીଔଙඑ඗ඞcy;䐊cute;䅃ƀaey઴હાron;䅇dil;䅅;䐝ƀgswે૰଎ativeƀMTV૓૟૨ediumSpace;怋hiĀcn૦૘ë૙eryThiî૙tedĀGL૸ଆreaterGreateòٳessLesóੈLine;䀊r;쀀𝔑ȀBnptଢନଷ଺reak;恠BreakingSpace;䂠f;愕ڀ;CDEGHLNPRSTV୕ୖ୪୼஡௫ఄ౞಄ದ೘ൡඅ櫬Āou୛୤ngruent;扢pCap;扭oubleVerticalBar;戦ƀlqxஃஊ஛ement;戉ualĀ;Tஒஓ扠ilde;쀀≂̸ists;戄reater΀;EFGLSTஶஷ஽௉௓௘௥扯qual;扱ullEqual;쀀≧̸reater;쀀≫̸ess;批lantEqual;쀀⩾̸ilde;扵umpń௲௽ownHump;쀀≎̸qual;쀀≏̸eĀfsఊధtTriangleƀ;BEచఛడ拪ar;쀀⧏̸qual;括s̀;EGLSTవశ఼ౄోౘ扮qual;扰reater;扸ess;쀀≪̸lantEqual;쀀⩽̸ilde;扴estedĀGL౨౹reaterGreater;쀀⪢̸essLess;쀀⪡̸recedesƀ;ESಒಓಛ技qual;쀀⪯̸lantEqual;拠ĀeiಫಹverseElement;戌ghtTriangleƀ;BEೋೌ೒拫ar;쀀⧐̸qual;拭ĀquೝഌuareSuĀbp೨೹setĀ;E೰ೳ쀀⊏̸qual;拢ersetĀ;Eഃആ쀀⊐̸qual;拣ƀbcpഓതൎsetĀ;Eഛഞ쀀⊂⃒qual;抈ceedsȀ;ESTലള഻െ抁qual;쀀⪰̸lantEqual;拡ilde;쀀≿̸ersetĀ;E൘൛쀀⊃⃒qual;抉ildeȀ;EFT൮൯൵ൿ扁qual;扄ullEqual;扇ilde;扉erticalBar;戤cr;쀀𝒩ilde耻Ñ䃑;䎝܀Eacdfgmoprstuvලෂ෉෕ෛ෠෧෼ขภยา฿ไlig;䅒cute耻Ó䃓Āiy෎ීrc耻Ô䃔;䐞blac;䅐r;쀀𝔒rave耻Ò䃒ƀaei෮ෲ෶cr;䅌ga;䎩cron;䎟pf;쀀𝕆enCurlyĀDQฎบoubleQuote;怜uote;怘;橔Āclวฬr;쀀𝒪ash耻Ø䃘iŬื฼de耻Õ䃕es;樷ml耻Ö䃖erĀBP๋๠Āar๐๓r;怾acĀek๚๜;揞et;掴arenthesis;揜Ҁacfhilors๿ງຊຏຒດຝະ໼rtialD;戂y;䐟r;쀀𝔓i;䎦;䎠usMinus;䂱Āipຢອncareplanåڝf;愙Ȁ;eio຺ູ໠໤檻cedesȀ;EST່້໏໚扺qual;檯lantEqual;扼ilde;找me;怳Ādp໩໮uct;戏ortionĀ;aȥ໹l;戝Āci༁༆r;쀀𝒫;䎨ȀUfos༑༖༛༟OT耻"䀢r;쀀𝔔pf;愚cr;쀀𝒬؀BEacefhiorsu༾གྷཇའཱིྦྷྪྭ႖ႩႴႾarr;椐G耻®䂮ƀcnrཎནབute;䅔g;柫rĀ;tཛྷཝ憠l;椖ƀaeyཧཬཱron;䅘dil;䅖;䐠Ā;vླྀཹ愜erseĀEUྂྙĀlq྇ྎement;戋uilibrium;懋pEquilibrium;楯r»ཹo;䎡ghtЀACDFTUVa࿁࿫࿳ဢဨၛႇϘĀnr࿆࿒gleBracket;柩rowƀ;BL࿜࿝࿡憒ar;懥eftArrow;懄eiling;按oǵ࿹\0စbleBracket;柧nǔည\0နeeVector;楝ectorĀ;Bဝသ懂ar;楕loor;挋Āerိ၃eƀ;AVဵံြ抢rrow;憦ector;楛iangleƀ;BEၐၑၕ抳ar;槐qual;抵pƀDTVၣၮၸownVector;楏eeVector;楜ectorĀ;Bႂႃ憾ar;楔ectorĀ;B႑႒懀ar;楓Āpuႛ႞f;愝ndImplies;楰ightarrow;懛ĀchႹႼr;愛;憱leDelayed;槴ڀHOacfhimoqstuფჱჷჽᄙᄞᅑᅖᅡᅧᆵᆻᆿĀCcჩხHcy;䐩y;䐨FTcy;䐬cute;䅚ʀ;aeiyᄈᄉᄎᄓᄗ檼ron;䅠dil;䅞rc;䅜;䐡r;쀀𝔖ortȀDLRUᄪᄴᄾᅉownArrow»ОeftArrow»࢚ightArrow»࿝pArrow;憑gma;䎣allCircle;战pf;쀀𝕊ɲᅭ\0\0ᅰt;戚areȀ;ISUᅻᅼᆉᆯ斡ntersection;抓uĀbpᆏᆞsetĀ;Eᆗᆘ抏qual;抑ersetĀ;Eᆨᆩ抐qual;抒nion;抔cr;쀀𝒮ar;拆ȀbcmpᇈᇛሉላĀ;sᇍᇎ拐etĀ;Eᇍᇕqual;抆ĀchᇠህeedsȀ;ESTᇭᇮᇴᇿ扻qual;檰lantEqual;扽ilde;承Tháྌ;我ƀ;esሒሓሣ拑rsetĀ;Eሜም抃qual;抇et»ሓրHRSacfhiorsሾቄ቉ቕ቞ቱቶኟዂወዑORN耻Þ䃞ADE;愢ĀHc቎ቒcy;䐋y;䐦Ābuቚቜ;䀉;䎤ƀaeyብቪቯron;䅤dil;䅢;䐢r;쀀𝔗Āeiቻ኉ǲኀ\0ኇefore;戴a;䎘Ācn኎ኘkSpace;쀀  Space;怉ldeȀ;EFTካኬኲኼ戼qual;扃ullEqual;扅ilde;扈pf;쀀𝕋ipleDot;惛Āctዖዛr;쀀𝒯rok;䅦ૡዷጎጚጦ\0ጬጱ\0\0\0\0\0ጸጽ፷ᎅ\0᏿ᐄᐊᐐĀcrዻጁute耻Ú䃚rĀ;oጇገ憟cir;楉rǣጓ\0጖y;䐎ve;䅬Āiyጞጣrc耻Û䃛;䐣blac;䅰r;쀀𝔘rave耻Ù䃙acr;䅪Ādiፁ፩erĀBPፈ፝Āarፍፐr;䁟acĀekፗፙ;揟et;掵arenthesis;揝onĀ;P፰፱拃lus;抎Āgp፻፿on;䅲f;쀀𝕌ЀADETadps᎕ᎮᎸᏄϨᏒᏗᏳrrowƀ;BDᅐᎠᎤar;椒ownArrow;懅ownArrow;憕quilibrium;楮eeĀ;AᏋᏌ报rrow;憥ownáϳerĀLRᏞᏨeftArrow;憖ightArrow;憗iĀ;lᏹᏺ䏒on;䎥ing;䅮cr;쀀𝒰ilde;䅨ml耻Ü䃜ҀDbcdefosvᐧᐬᐰᐳᐾᒅᒊᒐᒖash;披ar;櫫y;䐒ashĀ;lᐻᐼ抩;櫦Āerᑃᑅ;拁ƀbtyᑌᑐᑺar;怖Ā;iᑏᑕcalȀBLSTᑡᑥᑪᑴar;戣ine;䁼eparator;杘ilde;所ThinSpace;怊r;쀀𝔙pf;쀀𝕍cr;쀀𝒱dash;抪ʀcefosᒧᒬᒱᒶᒼirc;䅴dge;拀r;쀀𝔚pf;쀀𝕎cr;쀀𝒲Ȁfiosᓋᓐᓒᓘr;쀀𝔛;䎞pf;쀀𝕏cr;쀀𝒳ҀAIUacfosuᓱᓵᓹᓽᔄᔏᔔᔚᔠcy;䐯cy;䐇cy;䐮cute耻Ý䃝Āiyᔉᔍrc;䅶;䐫r;쀀𝔜pf;쀀𝕐cr;쀀𝒴ml;䅸ЀHacdefosᔵᔹᔿᕋᕏᕝᕠᕤcy;䐖cute;䅹Āayᕄᕉron;䅽;䐗ot;䅻ǲᕔ\0ᕛoWidtè૙a;䎖r;愨pf;愤cr;쀀𝒵௡ᖃᖊᖐ\0ᖰᖶᖿ\0\0\0\0ᗆᗛᗫᙟ᙭\0ᚕ᚛ᚲᚹ\0ᚾcute耻á䃡reve;䄃̀;Ediuyᖜᖝᖡᖣᖨᖭ戾;쀀∾̳;房rc耻â䃢te肻´̆;䐰lig耻æ䃦Ā;r²ᖺ;쀀𝔞rave耻à䃠ĀepᗊᗖĀfpᗏᗔsym;愵èᗓha;䎱ĀapᗟcĀclᗤᗧr;䄁g;樿ɤᗰ\0\0ᘊʀ;adsvᗺᗻᗿᘁᘇ戧nd;橕;橜lope;橘;橚΀;elmrszᘘᘙᘛᘞᘿᙏᙙ戠;榤e»ᘙsdĀ;aᘥᘦ戡ѡᘰᘲᘴᘶᘸᘺᘼᘾ;榨;榩;榪;榫;榬;榭;榮;榯tĀ;vᙅᙆ戟bĀ;dᙌᙍ抾;榝Āptᙔᙗh;戢»¹arr;捼Āgpᙣᙧon;䄅f;쀀𝕒΀;Eaeiop዁ᙻᙽᚂᚄᚇᚊ;橰cir;橯;扊d;手s;䀧roxĀ;e዁ᚒñᚃing耻å䃥ƀctyᚡᚦᚨr;쀀𝒶;䀪mpĀ;e዁ᚯñʈilde耻ã䃣ml耻ä䃤Āciᛂᛈoninôɲnt;樑ࠀNabcdefiklnoprsu᛭ᛱᜰ᜼ᝃᝈ᝸᝽០៦ᠹᡐᜍ᤽᥈ᥰot;櫭Ācrᛶ᜞kȀcepsᜀᜅᜍᜓong;扌psilon;䏶rime;怵imĀ;e᜚᜛戽q;拍Ŷᜢᜦee;抽edĀ;gᜬᜭ挅e»ᜭrkĀ;t፜᜷brk;掶Āoyᜁᝁ;䐱quo;怞ʀcmprtᝓ᝛ᝡᝤᝨausĀ;eĊĉptyv;榰séᜌnoõēƀahwᝯ᝱ᝳ;䎲;愶een;扬r;쀀𝔟g΀costuvwឍឝឳេ៕៛៞ƀaiuបពរðݠrc;旯p»፱ƀdptឤឨឭot;樀lus;樁imes;樂ɱឹ\0\0ើcup;樆ar;昅riangleĀdu៍្own;施p;斳plus;樄eåᑄåᒭarow;植ƀako៭ᠦᠵĀcn៲ᠣkƀlst៺֫᠂ozenge;槫riangleȀ;dlr᠒᠓᠘᠝斴own;斾eft;旂ight;斸k;搣Ʊᠫ\0ᠳƲᠯ\0ᠱ;斒;斑4;斓ck;斈ĀeoᠾᡍĀ;qᡃᡆ쀀=⃥uiv;쀀≡⃥t;挐Ȁptwxᡙᡞᡧᡬf;쀀𝕓Ā;tᏋᡣom»Ꮜtie;拈؀DHUVbdhmptuvᢅᢖᢪᢻᣗᣛᣬ᣿ᤅᤊᤐᤡȀLRlrᢎᢐᢒᢔ;敗;敔;敖;敓ʀ;DUduᢡᢢᢤᢦᢨ敐;敦;敩;敤;敧ȀLRlrᢳᢵᢷᢹ;敝;敚;敜;教΀;HLRhlrᣊᣋᣍᣏᣑᣓᣕ救;敬;散;敠;敫;敢;敟ox;槉ȀLRlrᣤᣦᣨᣪ;敕;敒;攐;攌ʀ;DUduڽ᣷᣹᣻᣽;敥;敨;攬;攴inus;抟lus;択imes;抠ȀLRlrᤙᤛᤝ᤟;敛;敘;攘;攔΀;HLRhlrᤰᤱᤳᤵᤷ᤻᤹攂;敪;敡;敞;攼;攤;攜Āevģ᥂bar耻¦䂦Ȁceioᥑᥖᥚᥠr;쀀𝒷mi;恏mĀ;e᜚᜜lƀ;bhᥨᥩᥫ䁜;槅sub;柈Ŭᥴ᥾lĀ;e᥹᥺怢t»᥺pƀ;Eeįᦅᦇ;檮Ā;qۜۛೡᦧ\0᧨ᨑᨕᨲ\0ᨷᩐ\0\0᪴\0\0᫁\0\0ᬡᬮ᭍᭒\0᯽\0ᰌƀcpr᦭ᦲ᧝ute;䄇̀;abcdsᦿᧀᧄ᧊᧕᧙戩nd;橄rcup;橉Āau᧏᧒p;橋p;橇ot;橀;쀀∩︀Āeo᧢᧥t;恁îړȀaeiu᧰᧻ᨁᨅǰ᧵\0᧸s;橍on;䄍dil耻ç䃧rc;䄉psĀ;sᨌᨍ橌m;橐ot;䄋ƀdmnᨛᨠᨦil肻¸ƭptyv;榲t脀¢;eᨭᨮ䂢räƲr;쀀𝔠ƀceiᨽᩀᩍy;䑇ckĀ;mᩇᩈ朓ark»ᩈ;䏇r΀;Ecefms᩟᩠ᩢᩫ᪤᪪᪮旋;槃ƀ;elᩩᩪᩭ䋆q;扗eɡᩴ\0\0᪈rrowĀlr᩼᪁eft;憺ight;憻ʀRSacd᪒᪔᪖᪚᪟»ཇ;擈st;抛irc;抚ash;抝nint;樐id;櫯cir;槂ubsĀ;u᪻᪼晣it»᪼ˬ᫇᫔᫺\0ᬊonĀ;eᫍᫎ䀺Ā;qÇÆɭ᫙\0\0᫢aĀ;t᫞᫟䀬;䁀ƀ;fl᫨᫩᫫戁îᅠeĀmx᫱᫶ent»᫩eóɍǧ᫾\0ᬇĀ;dኻᬂot;橭nôɆƀfryᬐᬔᬗ;쀀𝕔oäɔ脀©;sŕᬝr;愗Āaoᬥᬩrr;憵ss;朗Ācuᬲᬷr;쀀𝒸Ābpᬼ᭄Ā;eᭁᭂ櫏;櫑Ā;eᭉᭊ櫐;櫒dot;拯΀delprvw᭠᭬᭷ᮂᮬᯔ᯹arrĀlr᭨᭪;椸;椵ɰ᭲\0\0᭵r;拞c;拟arrĀ;p᭿ᮀ憶;椽̀;bcdosᮏᮐᮖᮡᮥᮨ截rcap;橈Āauᮛᮞp;橆p;橊ot;抍r;橅;쀀∪︀Ȁalrv᮵ᮿᯞᯣrrĀ;mᮼᮽ憷;椼yƀevwᯇᯔᯘqɰᯎ\0\0ᯒreã᭳uã᭵ee;拎edge;拏en耻¤䂤earrowĀlrᯮ᯳eft»ᮀight»ᮽeäᯝĀciᰁᰇoninôǷnt;戱lcty;挭ঀAHabcdefhijlorstuwz᰸᰻᰿ᱝᱩᱵᲊᲞᲬᲷ᳻᳿ᴍᵻᶑᶫᶻ᷆᷍rò΁ar;楥Ȁglrs᱈ᱍ᱒᱔ger;怠eth;愸òᄳhĀ;vᱚᱛ怐»ऊūᱡᱧarow;椏aã̕Āayᱮᱳron;䄏;䐴ƀ;ao̲ᱼᲄĀgrʿᲁr;懊tseq;橷ƀglmᲑᲔᲘ耻°䂰ta;䎴ptyv;榱ĀirᲣᲨsht;楿;쀀𝔡arĀlrᲳᲵ»ࣜ»သʀaegsv᳂͸᳖᳜᳠mƀ;oș᳊᳔ndĀ;ș᳑uit;晦amma;䏝in;拲ƀ;io᳧᳨᳸䃷de脀÷;o᳧ᳰntimes;拇nø᳷cy;䑒cɯᴆ\0\0ᴊrn;挞op;挍ʀlptuwᴘᴝᴢᵉᵕlar;䀤f;쀀𝕕ʀ;emps̋ᴭᴷᴽᵂqĀ;d͒ᴳot;扑inus;戸lus;戔quare;抡blebarwedgåúnƀadhᄮᵝᵧownarrowóᲃarpoonĀlrᵲᵶefôᲴighôᲶŢᵿᶅkaro÷གɯᶊ\0\0ᶎrn;挟op;挌ƀcotᶘᶣᶦĀryᶝᶡ;쀀𝒹;䑕l;槶rok;䄑Ādrᶰᶴot;拱iĀ;fᶺ᠖斿Āah᷀᷃ròЩaòྦangle;榦Āci᷒ᷕy;䑟grarr;柿ऀDacdefglmnopqrstuxḁḉḙḸոḼṉṡṾấắẽỡἪἷὄ὎὚ĀDoḆᴴoôᲉĀcsḎḔute耻é䃩ter;橮ȀaioyḢḧḱḶron;䄛rĀ;cḭḮ扖耻ê䃪lon;払;䑍ot;䄗ĀDrṁṅot;扒;쀀𝔢ƀ;rsṐṑṗ檚ave耻è䃨Ā;dṜṝ檖ot;檘Ȁ;ilsṪṫṲṴ檙nters;揧;愓Ā;dṹṺ檕ot;檗ƀapsẅẉẗcr;䄓tyƀ;svẒẓẕ戅et»ẓpĀ1;ẝẤĳạả;怄;怅怃ĀgsẪẬ;䅋p;怂ĀgpẴẸon;䄙f;쀀𝕖ƀalsỄỎỒrĀ;sỊị拕l;槣us;橱iƀ;lvỚớở䎵on»ớ;䏵ȀcsuvỪỳἋἣĀioữḱrc»Ḯɩỹ\0\0ỻíՈantĀglἂἆtr»ṝess»Ṻƀaeiἒ἖Ἒls;䀽st;扟vĀ;DȵἠD;橸parsl;槥ĀDaἯἳot;打rr;楱ƀcdiἾὁỸr;愯oô͒ĀahὉὋ;䎷耻ð䃰Āmrὓὗl耻ë䃫o;悬ƀcipὡὤὧl;䀡sôծĀeoὬὴctatioîՙnentialåչৡᾒ\0ᾞ\0ᾡᾧ\0\0ῆῌ\0ΐ\0ῦῪ \0 ⁚llingdotseñṄy;䑄male;晀ƀilrᾭᾳ῁lig;耀ﬃɩᾹ\0\0᾽g;耀ﬀig;耀ﬄ;쀀𝔣lig;耀ﬁlig;쀀fjƀaltῙ῜ῡt;晭ig;耀ﬂns;斱of;䆒ǰ΅\0ῳf;쀀𝕗ĀakֿῷĀ;vῼ´拔;櫙artint;樍Āao‌⁕Ācs‑⁒α‚‰‸⁅⁈\0⁐β•‥‧‪‬\0‮耻½䂽;慓耻¼䂼;慕;慙;慛Ƴ‴\0‶;慔;慖ʴ‾⁁\0\0⁃耻¾䂾;慗;慜5;慘ƶ⁌\0⁎;慚;慝8;慞l;恄wn;挢cr;쀀𝒻ࢀEabcdefgijlnorstv₂₉₟₥₰₴⃰⃵⃺⃿℃ℒℸ̗ℾ⅒↞Ā;lٍ₇;檌ƀcmpₐₕ₝ute;䇵maĀ;dₜ᳚䎳;檆reve;䄟Āiy₪₮rc;䄝;䐳ot;䄡Ȁ;lqsؾق₽⃉ƀ;qsؾٌ⃄lanô٥Ȁ;cdl٥⃒⃥⃕c;檩otĀ;o⃜⃝檀Ā;l⃢⃣檂;檄Ā;e⃪⃭쀀⋛︀s;檔r;쀀𝔤Ā;gٳ؛mel;愷cy;䑓Ȁ;Eajٚℌℎℐ;檒;檥;檤ȀEaesℛℝ℩ℴ;扩pĀ;p℣ℤ檊rox»ℤĀ;q℮ℯ檈Ā;q℮ℛim;拧pf;쀀𝕘Āci⅃ⅆr;愊mƀ;el٫ⅎ⅐;檎;檐茀>;cdlqr׮ⅠⅪⅮⅳⅹĀciⅥⅧ;檧r;橺ot;拗Par;榕uest;橼ʀadelsↄⅪ←ٖ↛ǰ↉\0↎proø₞r;楸qĀlqؿ↖lesó₈ií٫Āen↣↭rtneqq;쀀≩︀Å↪ԀAabcefkosy⇄⇇⇱⇵⇺∘∝∯≨≽ròΠȀilmr⇐⇔⇗⇛rsðᒄf»․ilôکĀdr⇠⇤cy;䑊ƀ;cwࣴ⇫⇯ir;楈;憭ar;意irc;䄥ƀalr∁∎∓rtsĀ;u∉∊晥it»∊lip;怦con;抹r;쀀𝔥sĀew∣∩arow;椥arow;椦ʀamopr∺∾≃≞≣rr;懿tht;戻kĀlr≉≓eftarrow;憩ightarrow;憪f;쀀𝕙bar;怕ƀclt≯≴≸r;쀀𝒽asè⇴rok;䄧Ābp⊂⊇ull;恃hen»ᱛૡ⊣\0⊪\0⊸⋅⋎\0⋕⋳\0\0⋸⌢⍧⍢⍿\0⎆⎪⎴cute耻í䃭ƀ;iyݱ⊰⊵rc耻î䃮;䐸Ācx⊼⊿y;䐵cl耻¡䂡ĀfrΟ⋉;쀀𝔦rave耻ì䃬Ȁ;inoܾ⋝⋩⋮Āin⋢⋦nt;樌t;戭fin;槜ta;愩lig;䄳ƀaop⋾⌚⌝ƀcgt⌅⌈⌗r;䄫ƀelpܟ⌏⌓inåގarôܠh;䄱f;抷ed;䆵ʀ;cfotӴ⌬⌱⌽⍁are;愅inĀ;t⌸⌹戞ie;槝doô⌙ʀ;celpݗ⍌⍐⍛⍡al;抺Āgr⍕⍙eróᕣã⍍arhk;樗rod;樼Ȁcgpt⍯⍲⍶⍻y;䑑on;䄯f;쀀𝕚a;䎹uest耻¿䂿Āci⎊⎏r;쀀𝒾nʀ;EdsvӴ⎛⎝⎡ӳ;拹ot;拵Ā;v⎦⎧拴;拳Ā;iݷ⎮lde;䄩ǫ⎸\0⎼cy;䑖l耻ï䃯̀cfmosu⏌⏗⏜⏡⏧⏵Āiy⏑⏕rc;䄵;䐹r;쀀𝔧ath;䈷pf;쀀𝕛ǣ⏬\0⏱r;쀀𝒿rcy;䑘kcy;䑔Ѐacfghjos␋␖␢␧␭␱␵␻ppaĀ;v␓␔䎺;䏰Āey␛␠dil;䄷;䐺r;쀀𝔨reen;䄸cy;䑅cy;䑜pf;쀀𝕜cr;쀀𝓀஀ABEHabcdefghjlmnoprstuv⑰⒁⒆⒍⒑┎┽╚▀♎♞♥♹♽⚚⚲⛘❝❨➋⟀⠁⠒ƀart⑷⑺⑼rò৆òΕail;椛arr;椎Ā;gঔ⒋;檋ar;楢ॣ⒥\0⒪\0⒱\0\0\0\0\0⒵Ⓔ\0ⓆⓈⓍ\0⓹ute;䄺mptyv;榴raîࡌbda;䎻gƀ;dlࢎⓁⓃ;榑åࢎ;檅uo耻«䂫rЀ;bfhlpst࢙ⓞⓦⓩ⓫⓮⓱⓵Ā;f࢝ⓣs;椟s;椝ë≒p;憫l;椹im;楳l;憢ƀ;ae⓿─┄檫il;椙Ā;s┉┊檭;쀀⪭︀ƀabr┕┙┝rr;椌rk;杲Āak┢┬cĀek┨┪;䁻;䁛Āes┱┳;榋lĀdu┹┻;榏;榍Ȁaeuy╆╋╖╘ron;䄾Ādi═╔il;䄼ìࢰâ┩;䐻Ȁcqrs╣╦╭╽a;椶uoĀ;rนᝆĀdu╲╷har;楧shar;楋h;憲ʀ;fgqs▋▌উ◳◿扤tʀahlrt▘▤▷◂◨rrowĀ;t࢙□aé⓶arpoonĀdu▯▴own»њp»०eftarrows;懇ightƀahs◍◖◞rrowĀ;sࣴࢧarpoonó྘quigarro÷⇰hreetimes;拋ƀ;qs▋ও◺lanôবʀ;cdgsব☊☍☝☨c;檨otĀ;o☔☕橿Ā;r☚☛檁;檃Ā;e☢☥쀀⋚︀s;檓ʀadegs☳☹☽♉♋pproøⓆot;拖qĀgq♃♅ôউgtò⒌ôছiíলƀilr♕࣡♚sht;楼;쀀𝔩Ā;Eজ♣;檑š♩♶rĀdu▲♮Ā;l॥♳;楪lk;斄cy;䑙ʀ;achtੈ⚈⚋⚑⚖rò◁orneòᴈard;楫ri;旺Āio⚟⚤dot;䅀ustĀ;a⚬⚭掰che»⚭ȀEaes⚻⚽⛉⛔;扨pĀ;p⛃⛄檉rox»⛄Ā;q⛎⛏檇Ā;q⛎⚻im;拦Ѐabnoptwz⛩⛴⛷✚✯❁❇❐Ānr⛮⛱g;柬r;懽rëࣁgƀlmr⛿✍✔eftĀar০✇ightá৲apsto;柼ightá৽parrowĀlr✥✩efô⓭ight;憬ƀafl✶✹✽r;榅;쀀𝕝us;樭imes;樴š❋❏st;戗áፎƀ;ef❗❘᠀旊nge»❘arĀ;l❤❥䀨t;榓ʀachmt❳❶❼➅➇ròࢨorneòᶌarĀ;d྘➃;業;怎ri;抿̀achiqt➘➝ੀ➢➮➻quo;怹r;쀀𝓁mƀ;egল➪➬;檍;檏Ābu┪➳oĀ;rฟ➹;怚rok;䅂萀<;cdhilqrࠫ⟒☹⟜⟠⟥⟪⟰Āci⟗⟙;檦r;橹reå◲mes;拉arr;楶uest;橻ĀPi⟵⟹ar;榖ƀ;ef⠀भ᠛旃rĀdu⠇⠍shar;楊har;楦Āen⠗⠡rtneqq;쀀≨︀Å⠞܀Dacdefhilnopsu⡀⡅⢂⢎⢓⢠⢥⢨⣚⣢⣤ઃ⣳⤂Dot;戺Ȁclpr⡎⡒⡣⡽r耻¯䂯Āet⡗⡙;時Ā;e⡞⡟朠se»⡟Ā;sျ⡨toȀ;dluျ⡳⡷⡻owîҌefôएðᏑker;斮Āoy⢇⢌mma;権;䐼ash;怔asuredangle»ᘦr;쀀𝔪o;愧ƀcdn⢯⢴⣉ro耻µ䂵Ȁ;acdᑤ⢽⣀⣄sôᚧir;櫰ot肻·Ƶusƀ;bd⣒ᤃ⣓戒Ā;uᴼ⣘;横ţ⣞⣡p;櫛ò−ðઁĀdp⣩⣮els;抧f;쀀𝕞Āct⣸⣽r;쀀𝓂pos»ᖝƀ;lm⤉⤊⤍䎼timap;抸ఀGLRVabcdefghijlmoprstuvw⥂⥓⥾⦉⦘⧚⧩⨕⨚⩘⩝⪃⪕⪤⪨⬄⬇⭄⭿⮮ⰴⱧⱼ⳩Āgt⥇⥋;쀀⋙̸Ā;v⥐௏쀀≫⃒ƀelt⥚⥲⥶ftĀar⥡⥧rrow;懍ightarrow;懎;쀀⋘̸Ā;v⥻ే쀀≪⃒ightarrow;懏ĀDd⦎⦓ash;抯ash;抮ʀbcnpt⦣⦧⦬⦱⧌la»˞ute;䅄g;쀀∠⃒ʀ;Eiop඄⦼⧀⧅⧈;쀀⩰̸d;쀀≋̸s;䅉roø඄urĀ;a⧓⧔普lĀ;s⧓ସǳ⧟\0⧣p肻 ଷmpĀ;e௹ఀʀaeouy⧴⧾⨃⨐⨓ǰ⧹\0⧻;橃on;䅈dil;䅆ngĀ;dൾ⨊ot;쀀⩭̸p;橂;䐽ash;怓΀;Aadqsxஒ⨩⨭⨻⩁⩅⩐rr;懗rĀhr⨳⨶k;椤Ā;oᏲᏰot;쀀≐̸uiöୣĀei⩊⩎ar;椨í஘istĀ;s஠டr;쀀𝔫ȀEest௅⩦⩹⩼ƀ;qs஼⩭௡ƀ;qs஼௅⩴lanô௢ií௪Ā;rஶ⪁»ஷƀAap⪊⪍⪑rò⥱rr;憮ar;櫲ƀ;svྍ⪜ྌĀ;d⪡⪢拼;拺cy;䑚΀AEadest⪷⪺⪾⫂⫅⫶⫹rò⥦;쀀≦̸rr;憚r;急Ȁ;fqs఻⫎⫣⫯tĀar⫔⫙rro÷⫁ightarro÷⪐ƀ;qs఻⪺⫪lanôౕĀ;sౕ⫴»శiíౝĀ;rవ⫾iĀ;eచథiäඐĀpt⬌⬑f;쀀𝕟膀¬;in⬙⬚⬶䂬nȀ;Edvஉ⬤⬨⬮;쀀⋹̸ot;쀀⋵̸ǡஉ⬳⬵;拷;拶iĀ;vಸ⬼ǡಸ⭁⭃;拾;拽ƀaor⭋⭣⭩rȀ;ast୻⭕⭚⭟lleì୻l;쀀⫽⃥;쀀∂̸lint;樔ƀ;ceಒ⭰⭳uåಥĀ;cಘ⭸Ā;eಒ⭽ñಘȀAait⮈⮋⮝⮧rò⦈rrƀ;cw⮔⮕⮙憛;쀀⤳̸;쀀↝̸ghtarrow»⮕riĀ;eೋೖ΀chimpqu⮽⯍⯙⬄୸⯤⯯Ȁ;cerല⯆ഷ⯉uå൅;쀀𝓃ortɭ⬅\0\0⯖ará⭖mĀ;e൮⯟Ā;q൴൳suĀbp⯫⯭å೸åഋƀbcp⯶ⰑⰙȀ;Ees⯿ⰀഢⰄ抄;쀀⫅̸etĀ;eഛⰋqĀ;qണⰀcĀ;eലⰗñസȀ;EesⰢⰣൟⰧ抅;쀀⫆̸etĀ;e൘ⰮqĀ;qൠⰣȀgilrⰽⰿⱅⱇìௗlde耻ñ䃱çృiangleĀlrⱒⱜeftĀ;eచⱚñదightĀ;eೋⱥñ೗Ā;mⱬⱭ䎽ƀ;esⱴⱵⱹ䀣ro;愖p;怇ҀDHadgilrsⲏⲔⲙⲞⲣⲰⲶⳓⳣash;抭arr;椄p;쀀≍⃒ash;抬ĀetⲨⲬ;쀀≥⃒;쀀>⃒nfin;槞ƀAetⲽⳁⳅrr;椂;쀀≤⃒Ā;rⳊⳍ쀀<⃒ie;쀀⊴⃒ĀAtⳘⳜrr;椃rie;쀀⊵⃒im;쀀∼⃒ƀAan⳰⳴ⴂrr;懖rĀhr⳺⳽k;椣Ā;oᏧᏥear;椧ቓ᪕\0\0\0\0\0\0\0\0\0\0\0\0\0ⴭ\0ⴸⵈⵠⵥ⵲ⶄᬇ\0\0ⶍⶫ\0ⷈⷎ\0ⷜ⸙⸫⸾⹃Ācsⴱ᪗ute耻ó䃳ĀiyⴼⵅrĀ;c᪞ⵂ耻ô䃴;䐾ʀabios᪠ⵒⵗǈⵚlac;䅑v;樸old;榼lig;䅓Ācr⵩⵭ir;榿;쀀𝔬ͯ⵹\0\0⵼\0ⶂn;䋛ave耻ò䃲;槁Ābmⶈ෴ar;榵Ȁacitⶕ⶘ⶥⶨrò᪀Āir⶝ⶠr;榾oss;榻nå๒;槀ƀaeiⶱⶵⶹcr;䅍ga;䏉ƀcdnⷀⷅǍron;䎿;榶pf;쀀𝕠ƀaelⷔ⷗ǒr;榷rp;榹΀;adiosvⷪⷫⷮ⸈⸍⸐⸖戨rò᪆Ȁ;efmⷷⷸ⸂⸅橝rĀ;oⷾⷿ愴f»ⷿ耻ª䂪耻º䂺gof;抶r;橖lope;橗;橛ƀclo⸟⸡⸧ò⸁ash耻ø䃸l;折iŬⸯ⸴de耻õ䃵esĀ;aǛ⸺s;樶ml耻ö䃶bar;挽ૡ⹞\0⹽\0⺀⺝\0⺢⺹\0\0⻋ຜ\0⼓\0\0⼫⾼\0⿈rȀ;astЃ⹧⹲຅脀¶;l⹭⹮䂶leìЃɩ⹸\0\0⹻m;櫳;櫽y;䐿rʀcimpt⺋⺏⺓ᡥ⺗nt;䀥od;䀮il;怰enk;怱r;쀀𝔭ƀimo⺨⺰⺴Ā;v⺭⺮䏆;䏕maô੶ne;明ƀ;tv⺿⻀⻈䏀chfork»´;䏖Āau⻏⻟nĀck⻕⻝kĀ;h⇴⻛;愎ö⇴sҀ;abcdemst⻳⻴ᤈ⻹⻽⼄⼆⼊⼎䀫cir;樣ir;樢Āouᵀ⼂;樥;橲n肻±ຝim;樦wo;樧ƀipu⼙⼠⼥ntint;樕f;쀀𝕡nd耻£䂣Ԁ;Eaceinosu່⼿⽁⽄⽇⾁⾉⾒⽾⾶;檳p;檷uå໙Ā;c໎⽌̀;acens່⽙⽟⽦⽨⽾pproø⽃urlyeñ໙ñ໎ƀaes⽯⽶⽺pprox;檹qq;檵im;拨iíໟmeĀ;s⾈ຮ怲ƀEas⽸⾐⽺ð⽵ƀdfp໬⾙⾯ƀals⾠⾥⾪lar;挮ine;挒urf;挓Ā;t໻⾴ï໻rel;抰Āci⿀⿅r;쀀𝓅;䏈ncsp;怈̀fiopsu⿚⋢⿟⿥⿫⿱r;쀀𝔮pf;쀀𝕢rime;恗cr;쀀𝓆ƀaeo⿸〉〓tĀei⿾々rnionóڰnt;樖stĀ;e【】䀿ñἙô༔઀ABHabcdefhilmnoprstux぀けさすムㄎㄫㅇㅢㅲㆎ㈆㈕㈤㈩㉘㉮㉲㊐㊰㊷ƀartぇおがròႳòϝail;検aròᱥar;楤΀cdenqrtとふへみわゔヌĀeuねぱ;쀀∽̱te;䅕iãᅮmptyv;榳gȀ;del࿑らるろ;榒;榥å࿑uo耻»䂻rր;abcfhlpstw࿜ガクシスゼゾダッデナp;極Ā;f࿠ゴs;椠;椳s;椞ë≝ð✮l;楅im;楴l;憣;憝Āaiパフil;椚oĀ;nホボ戶aló༞ƀabrョリヮrò៥rk;杳ĀakンヽcĀekヹ・;䁽;䁝Āes㄂㄄;榌lĀduㄊㄌ;榎;榐Ȁaeuyㄗㄜㄧㄩron;䅙Ādiㄡㄥil;䅗ì࿲âヺ;䑀Ȁclqsㄴㄷㄽㅄa;椷dhar;楩uoĀ;rȎȍh;憳ƀacgㅎㅟངlȀ;ipsླྀㅘㅛႜnåႻarôྩt;断ƀilrㅩဣㅮsht;楽;쀀𝔯ĀaoㅷㆆrĀduㅽㅿ»ѻĀ;l႑ㆄ;楬Ā;vㆋㆌ䏁;䏱ƀgns㆕ㇹㇼht̀ahlrstㆤㆰ㇂㇘㇤㇮rrowĀ;t࿜ㆭaéトarpoonĀduㆻㆿowîㅾp»႒eftĀah㇊㇐rrowó࿪arpoonóՑightarrows;應quigarro÷ニhreetimes;拌g;䋚ingdotseñἲƀahm㈍㈐㈓rò࿪aòՑ;怏oustĀ;a㈞㈟掱che»㈟mid;櫮Ȁabpt㈲㈽㉀㉒Ānr㈷㈺g;柭r;懾rëဃƀafl㉇㉊㉎r;榆;쀀𝕣us;樮imes;樵Āap㉝㉧rĀ;g㉣㉤䀩t;榔olint;樒arò㇣Ȁachq㉻㊀Ⴜ㊅quo;怺r;쀀𝓇Ābu・㊊oĀ;rȔȓƀhir㊗㊛㊠reåㇸmes;拊iȀ;efl㊪ၙᠡ㊫方tri;槎luhar;楨;愞ൡ㋕㋛㋟㌬㌸㍱\0㍺㎤\0\0㏬㏰\0㐨㑈㑚㒭㒱㓊㓱\0㘖\0\0㘳cute;䅛quï➺Ԁ;Eaceinpsyᇭ㋳㋵㋿㌂㌋㌏㌟㌦㌩;檴ǰ㋺\0㋼;檸on;䅡uåᇾĀ;dᇳ㌇il;䅟rc;䅝ƀEas㌖㌘㌛;檶p;檺im;择olint;樓iíሄ;䑁otƀ;be㌴ᵇ㌵担;橦΀Aacmstx㍆㍊㍗㍛㍞㍣㍭rr;懘rĀhr㍐㍒ë∨Ā;oਸ਼਴t耻§䂧i;䀻war;椩mĀin㍩ðnuóñt;朶rĀ;o㍶⁕쀀𝔰Ȁacoy㎂㎆㎑㎠rp;景Āhy㎋㎏cy;䑉;䑈rtɭ㎙\0\0㎜iäᑤaraì⹯耻­䂭Āgm㎨㎴maƀ;fv㎱㎲㎲䏃;䏂Ѐ;deglnprካ㏅㏉㏎㏖㏞㏡㏦ot;橪Ā;q኱ኰĀ;E㏓㏔檞;檠Ā;E㏛㏜檝;檟e;扆lus;樤arr;楲aròᄽȀaeit㏸㐈㐏㐗Āls㏽㐄lsetmé㍪hp;樳parsl;槤Ādlᑣ㐔e;挣Ā;e㐜㐝檪Ā;s㐢㐣檬;쀀⪬︀ƀflp㐮㐳㑂tcy;䑌Ā;b㐸㐹䀯Ā;a㐾㐿槄r;挿f;쀀𝕤aĀdr㑍ЂesĀ;u㑔㑕晠it»㑕ƀcsu㑠㑹㒟Āau㑥㑯pĀ;sᆈ㑫;쀀⊓︀pĀ;sᆴ㑵;쀀⊔︀uĀbp㑿㒏ƀ;esᆗᆜ㒆etĀ;eᆗ㒍ñᆝƀ;esᆨᆭ㒖etĀ;eᆨ㒝ñᆮƀ;afᅻ㒦ְrť㒫ֱ»ᅼaròᅈȀcemt㒹㒾㓂㓅r;쀀𝓈tmîñiì㐕aræᆾĀar㓎㓕rĀ;f㓔ឿ昆Āan㓚㓭ightĀep㓣㓪psiloîỠhé⺯s»⡒ʀbcmnp㓻㕞ሉ㖋㖎Ҁ;Edemnprs㔎㔏㔑㔕㔞㔣㔬㔱㔶抂;櫅ot;檽Ā;dᇚ㔚ot;櫃ult;櫁ĀEe㔨㔪;櫋;把lus;檿arr;楹ƀeiu㔽㕒㕕tƀ;en㔎㕅㕋qĀ;qᇚ㔏eqĀ;q㔫㔨m;櫇Ābp㕚㕜;櫕;櫓c̀;acensᇭ㕬㕲㕹㕻㌦pproø㋺urlyeñᇾñᇳƀaes㖂㖈㌛pproø㌚qñ㌗g;晪ڀ123;Edehlmnps㖩㖬㖯ሜ㖲㖴㗀㗉㗕㗚㗟㗨㗭耻¹䂹耻²䂲耻³䂳;櫆Āos㖹㖼t;檾ub;櫘Ā;dሢ㗅ot;櫄sĀou㗏㗒l;柉b;櫗arr;楻ult;櫂ĀEe㗤㗦;櫌;抋lus;櫀ƀeiu㗴㘉㘌tƀ;enሜ㗼㘂qĀ;qሢ㖲eqĀ;q㗧㗤m;櫈Ābp㘑㘓;櫔;櫖ƀAan㘜㘠㘭rr;懙rĀhr㘦㘨ë∮Ā;oਫ਩war;椪lig耻ß䃟௡㙑㙝㙠ዎ㙳㙹\0㙾㛂\0\0\0\0\0㛛㜃\0㜉㝬\0\0\0㞇ɲ㙖\0\0㙛get;挖;䏄rë๟ƀaey㙦㙫㙰ron;䅥dil;䅣;䑂lrec;挕r;쀀𝔱Ȁeiko㚆㚝㚵㚼ǲ㚋\0㚑eĀ4fኄኁaƀ;sv㚘㚙㚛䎸ym;䏑Ācn㚢㚲kĀas㚨㚮pproø዁im»ኬsðኞĀas㚺㚮ð዁rn耻þ䃾Ǭ̟㛆⋧es膀×;bd㛏㛐㛘䃗Ā;aᤏ㛕r;樱;樰ƀeps㛡㛣㜀á⩍Ȁ;bcf҆㛬㛰㛴ot;挶ir;櫱Ā;o㛹㛼쀀𝕥rk;櫚á㍢rime;怴ƀaip㜏㜒㝤dåቈ΀adempst㜡㝍㝀㝑㝗㝜㝟ngleʀ;dlqr㜰㜱㜶㝀㝂斵own»ᶻeftĀ;e⠀㜾ñम;扜ightĀ;e㊪㝋ñၚot;旬inus;樺lus;樹b;槍ime;樻ezium;揢ƀcht㝲㝽㞁Āry㝷㝻;쀀𝓉;䑆cy;䑛rok;䅧Āio㞋㞎xô᝷headĀlr㞗㞠eftarro÷ࡏightarrow»ཝऀAHabcdfghlmoprstuw㟐㟓㟗㟤㟰㟼㠎㠜㠣㠴㡑㡝㡫㢩㣌㣒㣪㣶ròϭar;楣Ācr㟜㟢ute耻ú䃺òᅐrǣ㟪\0㟭y;䑞ve;䅭Āiy㟵㟺rc耻û䃻;䑃ƀabh㠃㠆㠋ròᎭlac;䅱aòᏃĀir㠓㠘sht;楾;쀀𝔲rave耻ù䃹š㠧㠱rĀlr㠬㠮»ॗ»ႃlk;斀Āct㠹㡍ɯ㠿\0\0㡊rnĀ;e㡅㡆挜r»㡆op;挏ri;旸Āal㡖㡚cr;䅫肻¨͉Āgp㡢㡦on;䅳f;쀀𝕦̀adhlsuᅋ㡸㡽፲㢑㢠ownáᎳarpoonĀlr㢈㢌efô㠭ighô㠯iƀ;hl㢙㢚㢜䏅»ᏺon»㢚parrows;懈ƀcit㢰㣄㣈ɯ㢶\0\0㣁rnĀ;e㢼㢽挝r»㢽op;挎ng;䅯ri;旹cr;쀀𝓊ƀdir㣙㣝㣢ot;拰lde;䅩iĀ;f㜰㣨»᠓Āam㣯㣲rò㢨l耻ü䃼angle;榧ހABDacdeflnoprsz㤜㤟㤩㤭㦵㦸㦽㧟㧤㧨㧳㧹㧽㨁㨠ròϷarĀ;v㤦㤧櫨;櫩asèϡĀnr㤲㤷grt;榜΀eknprst㓣㥆㥋㥒㥝㥤㦖appá␕othinçẖƀhir㓫⻈㥙opô⾵Ā;hᎷ㥢ïㆍĀiu㥩㥭gmá㎳Ābp㥲㦄setneqĀ;q㥽㦀쀀⊊︀;쀀⫋︀setneqĀ;q㦏㦒쀀⊋︀;쀀⫌︀Āhr㦛㦟etá㚜iangleĀlr㦪㦯eft»थight»ၑy;䐲ash»ံƀelr㧄㧒㧗ƀ;beⷪ㧋㧏ar;抻q;扚lip;拮Ābt㧜ᑨaòᑩr;쀀𝔳tré㦮suĀbp㧯㧱»ജ»൙pf;쀀𝕧roð໻tré㦴Ācu㨆㨋r;쀀𝓋Ābp㨐㨘nĀEe㦀㨖»㥾nĀEe㦒㨞»㦐igzag;榚΀cefoprs㨶㨻㩖㩛㩔㩡㩪irc;䅵Ādi㩀㩑Ābg㩅㩉ar;機eĀ;qᗺ㩏;扙erp;愘r;쀀𝔴pf;쀀𝕨Ā;eᑹ㩦atèᑹcr;쀀𝓌ૣណ㪇\0㪋\0㪐㪛\0\0㪝㪨㪫㪯\0\0㫃㫎\0㫘ៜ៟tré៑r;쀀𝔵ĀAa㪔㪗ròσrò৶;䎾ĀAa㪡㪤ròθrò৫að✓is;拻ƀdptឤ㪵㪾Āfl㪺ឩ;쀀𝕩imåឲĀAa㫇㫊ròώròਁĀcq㫒ីr;쀀𝓍Āpt៖㫜ré។Ѐacefiosu㫰㫽㬈㬌㬑㬕㬛㬡cĀuy㫶㫻te耻ý䃽;䑏Āiy㬂㬆rc;䅷;䑋n耻¥䂥r;쀀𝔶cy;䑗pf;쀀𝕪cr;쀀𝓎Ācm㬦㬩y;䑎l耻ÿ䃿Ԁacdefhiosw㭂㭈㭔㭘㭤㭩㭭㭴㭺㮀cute;䅺Āay㭍㭒ron;䅾;䐷ot;䅼Āet㭝㭡træᕟa;䎶r;쀀𝔷cy;䐶grarr;懝pf;쀀𝕫cr;쀀𝓏Ājn㮅㮇;怍j;怌'.split("").map(n=>n.charCodeAt(0))),xtt=new Uint16Array("Ȁaglq	\x1Bɭ\0\0p;䀦os;䀧t;䀾t;䀼uot;䀢".split("").map(n=>n.charCodeAt(0)));var $j;const Ett=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]),Itt=($j=String.fromCodePoint)!==null&&$j!==void 0?$j:function(n){let e="";return n>65535&&(n-=65536,e+=String.fromCharCode(n>>>10&1023|55296),n=56320|n&1023),e+=String.fromCharCode(n),e};function Ptt(n){var e;return n>=55296&&n<=57343||n>1114111?65533:(e=Ett.get(n))!==null&&e!==void 0?e:n}var ic;(function(n){n[n.NUM=35]="NUM",n[n.SEMI=59]="SEMI",n[n.EQUALS=61]="EQUALS",n[n.ZERO=48]="ZERO",n[n.NINE=57]="NINE",n[n.LOWER_A=97]="LOWER_A",n[n.LOWER_F=102]="LOWER_F",n[n.LOWER_X=120]="LOWER_X",n[n.LOWER_Z=122]="LOWER_Z",n[n.UPPER_A=65]="UPPER_A",n[n.UPPER_F=70]="UPPER_F",n[n.UPPER_Z=90]="UPPER_Z"})(ic||(ic={}));const ktt=32;var A0;(function(n){n[n.VALUE_LENGTH=49152]="VALUE_LENGTH",n[n.BRANCH_LENGTH=16256]="BRANCH_LENGTH",n[n.JUMP_TABLE=127]="JUMP_TABLE"})(A0||(A0={}));function XW(n){return n>=ic.ZERO&&n<=ic.NINE}function Ttt(n){return n>=ic.UPPER_A&&n<=ic.UPPER_F||n>=ic.LOWER_A&&n<=ic.LOWER_F}function Dtt(n){return n>=ic.UPPER_A&&n<=ic.UPPER_Z||n>=ic.LOWER_A&&n<=ic.LOWER_Z||XW(n)}function Rtt(n){return n===ic.EQUALS||Dtt(n)}var Ga;(function(n){n[n.EntityStart=0]="EntityStart",n[n.NumericStart=1]="NumericStart",n[n.NumericDecimal=2]="NumericDecimal",n[n.NumericHex=3]="NumericHex",n[n.NamedEntity=4]="NamedEntity"})(Ga||(Ga={}));var h0;(function(n){n[n.Legacy=0]="Legacy",n[n.Strict=1]="Strict",n[n.Attribute=2]="Attribute"})(h0||(h0={}));class Att{constructor(e,t,r){this.decodeTree=e,this.emitCodePoint=t,this.errors=r,this.state=Ga.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=h0.Strict}startEntity(e){this.decodeMode=e,this.state=Ga.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1}write(e,t){switch(this.state){case Ga.EntityStart:return e.charCodeAt(t)===ic.NUM?(this.state=Ga.NumericStart,this.consumed+=1,this.stateNumericStart(e,t+1)):(this.state=Ga.NamedEntity,this.stateNamedEntity(e,t));case Ga.NumericStart:return this.stateNumericStart(e,t);case Ga.NumericDecimal:return this.stateNumericDecimal(e,t);case Ga.NumericHex:return this.stateNumericHex(e,t);case Ga.NamedEntity:return this.stateNamedEntity(e,t)}}stateNumericStart(e,t){return t>=e.length?-1:(e.charCodeAt(t)|ktt)===ic.LOWER_X?(this.state=Ga.NumericHex,this.consumed+=1,this.stateNumericHex(e,t+1)):(this.state=Ga.NumericDecimal,this.stateNumericDecimal(e,t))}addToNumericResult(e,t,r,i){if(t!==r){const o=r-t;this.result=this.result*Math.pow(i,o)+parseInt(e.substr(t,o),i),this.consumed+=o}}stateNumericHex(e,t){const r=t;for(;t<e.length;){const i=e.charCodeAt(t);if(XW(i)||Ttt(i))t+=1;else return this.addToNumericResult(e,r,t,16),this.emitNumericEntity(i,3)}return this.addToNumericResult(e,r,t,16),-1}stateNumericDecimal(e,t){const r=t;for(;t<e.length;){const i=e.charCodeAt(t);if(XW(i))t+=1;else return this.addToNumericResult(e,r,t,10),this.emitNumericEntity(i,2)}return this.addToNumericResult(e,r,t,10),-1}emitNumericEntity(e,t){var r;if(this.consumed<=t)return(r=this.errors)===null||r===void 0||r.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(e===ic.SEMI)this.consumed+=1;else if(this.decodeMode===h0.Strict)return 0;return this.emitCodePoint(Ptt(this.result),this.consumed),this.errors&&(e!==ic.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed}stateNamedEntity(e,t){const{decodeTree:r}=this;let i=r[this.treeIndex],o=(i&A0.VALUE_LENGTH)>>14;for(;t<e.length;t++,this.excess++){const s=e.charCodeAt(t);if(this.treeIndex=Ott(r,i,this.treeIndex+Math.max(1,o),s),this.treeIndex<0)return this.result===0||this.decodeMode===h0.Attribute&&(o===0||Rtt(s))?0:this.emitNotTerminatedNamedEntity();if(i=r[this.treeIndex],o=(i&A0.VALUE_LENGTH)>>14,o!==0){if(s===ic.SEMI)return this.emitNamedEntityData(this.treeIndex,o,this.consumed+this.excess);this.decodeMode!==h0.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1}emitNotTerminatedNamedEntity(){var e;const{result:t,decodeTree:r}=this,i=(r[t]&A0.VALUE_LENGTH)>>14;return this.emitNamedEntityData(t,i,this.consumed),(e=this.errors)===null||e===void 0||e.missingSemicolonAfterCharacterReference(),this.consumed}emitNamedEntityData(e,t,r){const{decodeTree:i}=this;return this.emitCodePoint(t===1?i[e]&~A0.VALUE_LENGTH:i[e+1],r),t===3&&this.emitCodePoint(i[e+2],r),r}end(){var e;switch(this.state){case Ga.NamedEntity:return this.result!==0&&(this.decodeMode!==h0.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case Ga.NumericDecimal:return this.emitNumericEntity(0,2);case Ga.NumericHex:return this.emitNumericEntity(0,3);case Ga.NumericStart:return(e=this.errors)===null||e===void 0||e.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case Ga.EntityStart:return 0}}}function AEe(n){let e="";const t=new Att(n,r=>e+=Itt(r));return function(i,o){let s=0,a=0;for(;(a=i.indexOf("&",a))>=0;){e+=i.slice(s,a),t.startEntity(o);const l=t.write(i,a+1);if(l<0){s=a+t.end();break}s=a+l,a=l===0?s+1:s}const c=e+i.slice(s);return e="",c}}function Ott(n,e,t,r){const i=(e&A0.BRANCH_LENGTH)>>7,o=e&A0.JUMP_TABLE;if(i===0)return o!==0&&r===o?t:-1;if(o){const c=r-o;return c<0||c>=i?-1:n[t+c]-1}let s=t,a=s+i-1;for(;s<=a;){const c=s+a>>>1,l=n[c];if(l<r)s=c+1;else if(l>r)a=c-1;else return n[c+i]}return-1}const Mtt=AEe(Ctt);AEe(xtt);function OEe(n,e=h0.Legacy){return Mtt(n,e)}function $tt(n){return Object.prototype.toString.call(n)}function zee(n){return $tt(n)==="[object String]"}const Ltt=Object.prototype.hasOwnProperty;function Ntt(n,e){return Ltt.call(n,e)}function o7(n){return Array.prototype.slice.call(arguments,1).forEach(function(t){if(t){if(typeof t!="object")throw new TypeError(t+"must be object");Object.keys(t).forEach(function(r){n[r]=t[r]})}}),n}function MEe(n,e,t){return[].concat(n.slice(0,e),t,n.slice(e+1))}function Vee(n){return!(n>=55296&&n<=57343||n>=64976&&n<=65007||(n&65535)===65535||(n&65535)===65534||n>=0&&n<=8||n===11||n>=14&&n<=31||n>=127&&n<=159||n>1114111)}function BM(n){if(n>65535){n-=65536;const e=55296+(n>>10),t=56320+(n&1023);return String.fromCharCode(e,t)}return String.fromCharCode(n)}const $Ee=/\\([!"#$%&'()*+,\-./:;<=>?@[\\\]^_`{|}~])/g,Ftt=/&([a-z#][a-z0-9]{1,31});/gi,jtt=new RegExp($Ee.source+"|"+Ftt.source,"gi"),Btt=/^#((?:x[a-f0-9]{1,8}|[0-9]{1,8}))$/i;function Htt(n,e){if(e.charCodeAt(0)===35&&Btt.test(e)){const r=e[1].toLowerCase()==="x"?parseInt(e.slice(2),16):parseInt(e.slice(1),10);return Vee(r)?BM(r):n}const t=OEe(n);return t!==n?t:n}function Utt(n){return n.indexOf("\\")<0?n:n.replace($Ee,"$1")}function R2(n){return n.indexOf("\\")<0&&n.indexOf("&")<0?n:n.replace(jtt,function(e,t,r){return t||Htt(e,r)})}const ztt=/[&<>"]/,Vtt=/[&<>"]/g,Wtt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};function qtt(n){return Wtt[n]}function wy(n){return ztt.test(n)?n.replace(Vtt,qtt):n}const Ktt=/[.?*+^$[\]\\(){}|-]/g;function Gtt(n){return n.replace(Ktt,"\\$&")}function jo(n){switch(n){case 9:case 32:return!0}return!1}function $k(n){if(n>=8192&&n<=8202)return!0;switch(n){case 9:case 10:case 11:case 12:case 13:case 32:case 160:case 5760:case 8239:case 8287:case 12288:return!0}return!1}function Lk(n){return Uee.test(n)||DEe.test(n)}function Nk(n){switch(n){case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 58:case 59:case 60:case 61:case 62:case 63:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 124:case 125:case 126:return!0;default:return!1}}function s7(n){return n=n.trim().replace(/\s+/g," "),"ẞ".toLowerCase()==="Ṿ"&&(n=n.replace(/ẞ/g,"ß")),n.toLowerCase().toUpperCase()}const Ztt={mdurl:Stt,ucmicro:wtt},Xtt=Object.freeze(Object.defineProperty({__proto__:null,arrayReplaceAt:MEe,assign:o7,escapeHtml:wy,escapeRE:Gtt,fromCodePoint:BM,has:Ntt,isMdAsciiPunct:Nk,isPunctChar:Lk,isSpace:jo,isString:zee,isValidEntityCode:Vee,isWhiteSpace:$k,lib:Ztt,normalizeReference:s7,unescapeAll:R2,unescapeMd:Utt},Symbol.toStringTag,{value:"Module"}));function Ytt(n,e,t){let r,i,o,s;const a=n.posMax,c=n.pos;for(n.pos=e+1,r=1;n.pos<a;){if(o=n.src.charCodeAt(n.pos),o===93&&(r--,r===0)){i=!0;break}if(s=n.pos,n.md.inline.skipToken(n),o===91){if(s===n.pos-1)r++;else if(t)return n.pos=c,-1}}let l=-1;return i&&(l=n.pos),n.pos=c,l}function Jtt(n,e,t){let r,i=e;const o={ok:!1,pos:0,str:""};if(n.charCodeAt(i)===60){for(i++;i<t;){if(r=n.charCodeAt(i),r===10||r===60)return o;if(r===62)return o.pos=i+1,o.str=R2(n.slice(e+1,i)),o.ok=!0,o;if(r===92&&i+1<t){i+=2;continue}i++}return o}let s=0;for(;i<t&&(r=n.charCodeAt(i),!(r===32||r<32||r===127));){if(r===92&&i+1<t){if(n.charCodeAt(i+1)===32)break;i+=2;continue}if(r===40&&(s++,s>32))return o;if(r===41){if(s===0)break;s--}i++}return e===i||s!==0||(o.str=R2(n.slice(e,i)),o.pos=i,o.ok=!0),o}function Qtt(n,e,t,r){let i,o=e;const s={ok:!1,can_continue:!1,pos:0,str:"",marker:0};if(r)s.str=r.str,s.marker=r.marker;else{if(o>=t)return s;let a=n.charCodeAt(o);if(a!==34&&a!==39&&a!==40)return s;e++,o++,a===40&&(a=41),s.marker=a}for(;o<t;){if(i=n.charCodeAt(o),i===s.marker)return s.pos=o+1,s.str+=R2(n.slice(e,o)),s.ok=!0,s;if(i===40&&s.marker===41)return s;i===92&&o+1<t&&o++,o++}return s.can_continue=!0,s.str+=R2(n.slice(e,o)),s}const ent=Object.freeze(Object.defineProperty({__proto__:null,parseLinkDestination:Jtt,parseLinkLabel:Ytt,parseLinkTitle:Qtt},Symbol.toStringTag,{value:"Module"})),Dg={};Dg.code_inline=function(n,e,t,r,i){const o=n[e];return"<code"+i.renderAttrs(o)+">"+wy(o.content)+"</code>"};Dg.code_block=function(n,e,t,r,i){const o=n[e];return"<pre"+i.renderAttrs(o)+"><code>"+wy(n[e].content)+`</code></pre>
`};Dg.fence=function(n,e,t,r,i){const o=n[e],s=o.info?R2(o.info).trim():"";let a="",c="";if(s){const u=s.split(/(\s+)/g);a=u[0],c=u.slice(2).join("")}let l;if(t.highlight?l=t.highlight(o.content,a,c)||wy(o.content):l=wy(o.content),l.indexOf("<pre")===0)return l+`
`;if(s){const u=o.attrIndex("class"),d=o.attrs?o.attrs.slice():[];u<0?d.push(["class",t.langPrefix+a]):(d[u]=d[u].slice(),d[u][1]+=" "+t.langPrefix+a);const h={attrs:d};return`<pre><code${i.renderAttrs(h)}>${l}</code></pre>
`}return`<pre><code${i.renderAttrs(o)}>${l}</code></pre>
`};Dg.image=function(n,e,t,r,i){const o=n[e];return o.attrs[o.attrIndex("alt")][1]=i.renderInlineAsText(o.children,t,r),i.renderToken(n,e,t)};Dg.hardbreak=function(n,e,t){return t.xhtmlOut?`<br />
`:`<br>
`};Dg.softbreak=function(n,e,t){return t.breaks?t.xhtmlOut?`<br />
`:`<br>
`:`
`};Dg.text=function(n,e){return wy(n[e].content)};Dg.html_block=function(n,e){return n[e].content};Dg.html_inline=function(n,e){return n[e].content};function Jx(){this.rules=o7({},Dg)}Jx.prototype.renderAttrs=function(e){let t,r,i;if(!e.attrs)return"";for(i="",t=0,r=e.attrs.length;t<r;t++)i+=" "+wy(e.attrs[t][0])+'="'+wy(e.attrs[t][1])+'"';return i};Jx.prototype.renderToken=function(e,t,r){const i=e[t];let o="";if(i.hidden)return"";i.block&&i.nesting!==-1&&t&&e[t-1].hidden&&(o+=`
`),o+=(i.nesting===-1?"</":"<")+i.tag,o+=this.renderAttrs(i),i.nesting===0&&r.xhtmlOut&&(o+=" /");let s=!1;if(i.block&&(s=!0,i.nesting===1&&t+1<e.length)){const a=e[t+1];(a.type==="inline"||a.hidden||a.nesting===-1&&a.tag===i.tag)&&(s=!1)}return o+=s?`>
`:">",o};Jx.prototype.renderInline=function(n,e,t){let r="";const i=this.rules;for(let o=0,s=n.length;o<s;o++){const a=n[o].type;typeof i[a]<"u"?r+=i[a](n,o,e,t,this):r+=this.renderToken(n,o,e)}return r};Jx.prototype.renderInlineAsText=function(n,e,t){let r="";for(let i=0,o=n.length;i<o;i++)switch(n[i].type){case"text":r+=n[i].content;break;case"image":r+=this.renderInlineAsText(n[i].children,e,t);break;case"html_inline":case"html_block":r+=n[i].content;break;case"softbreak":case"hardbreak":r+=`
`;break}return r};Jx.prototype.render=function(n,e,t){let r="";const i=this.rules;for(let o=0,s=n.length;o<s;o++){const a=n[o].type;a==="inline"?r+=this.renderInline(n[o].children,e,t):typeof i[a]<"u"?r+=i[a](n,o,e,t,this):r+=this.renderToken(n,o,e,t)}return r};function qu(){this.__rules__=[],this.__cache__=null}qu.prototype.__find__=function(n){for(let e=0;e<this.__rules__.length;e++)if(this.__rules__[e].name===n)return e;return-1};qu.prototype.__compile__=function(){const n=this,e=[""];n.__rules__.forEach(function(t){t.enabled&&t.alt.forEach(function(r){e.indexOf(r)<0&&e.push(r)})}),n.__cache__={},e.forEach(function(t){n.__cache__[t]=[],n.__rules__.forEach(function(r){r.enabled&&(t&&r.alt.indexOf(t)<0||n.__cache__[t].push(r.fn))})})};qu.prototype.at=function(n,e,t){const r=this.__find__(n),i=t||{};if(r===-1)throw new Error("Parser rule not found: "+n);this.__rules__[r].fn=e,this.__rules__[r].alt=i.alt||[],this.__cache__=null};qu.prototype.before=function(n,e,t,r){const i=this.__find__(n),o=r||{};if(i===-1)throw new Error("Parser rule not found: "+n);this.__rules__.splice(i,0,{name:e,enabled:!0,fn:t,alt:o.alt||[]}),this.__cache__=null};qu.prototype.after=function(n,e,t,r){const i=this.__find__(n),o=r||{};if(i===-1)throw new Error("Parser rule not found: "+n);this.__rules__.splice(i+1,0,{name:e,enabled:!0,fn:t,alt:o.alt||[]}),this.__cache__=null};qu.prototype.push=function(n,e,t){const r=t||{};this.__rules__.push({name:n,enabled:!0,fn:e,alt:r.alt||[]}),this.__cache__=null};qu.prototype.enable=function(n,e){Array.isArray(n)||(n=[n]);const t=[];return n.forEach(function(r){const i=this.__find__(r);if(i<0){if(e)return;throw new Error("Rules manager: invalid rule name "+r)}this.__rules__[i].enabled=!0,t.push(r)},this),this.__cache__=null,t};qu.prototype.enableOnly=function(n,e){Array.isArray(n)||(n=[n]),this.__rules__.forEach(function(t){t.enabled=!1}),this.enable(n,e)};qu.prototype.disable=function(n,e){Array.isArray(n)||(n=[n]);const t=[];return n.forEach(function(r){const i=this.__find__(r);if(i<0){if(e)return;throw new Error("Rules manager: invalid rule name "+r)}this.__rules__[i].enabled=!1,t.push(r)},this),this.__cache__=null,t};qu.prototype.getRules=function(n){return this.__cache__===null&&this.__compile__(),this.__cache__[n]||[]};function tp(n,e,t){this.type=n,this.tag=e,this.attrs=null,this.map=null,this.nesting=t,this.level=0,this.children=null,this.content="",this.markup="",this.info="",this.meta=null,this.block=!1,this.hidden=!1}tp.prototype.attrIndex=function(e){if(!this.attrs)return-1;const t=this.attrs;for(let r=0,i=t.length;r<i;r++)if(t[r][0]===e)return r;return-1};tp.prototype.attrPush=function(e){this.attrs?this.attrs.push(e):this.attrs=[e]};tp.prototype.attrSet=function(e,t){const r=this.attrIndex(e),i=[e,t];r<0?this.attrPush(i):this.attrs[r]=i};tp.prototype.attrGet=function(e){const t=this.attrIndex(e);let r=null;return t>=0&&(r=this.attrs[t][1]),r};tp.prototype.attrJoin=function(e,t){const r=this.attrIndex(e);r<0?this.attrPush([e,t]):this.attrs[r][1]=this.attrs[r][1]+" "+t};function LEe(n,e,t){this.src=n,this.env=t,this.tokens=[],this.inlineMode=!1,this.md=e}LEe.prototype.Token=tp;const tnt=/\r\n?|\n/g,nnt=/\0/g;function rnt(n){let e;e=n.src.replace(tnt,`
`),e=e.replace(nnt,"�"),n.src=e}function int(n){let e;n.inlineMode?(e=new n.Token("inline","",0),e.content=n.src,e.map=[0,1],e.children=[],n.tokens.push(e)):n.md.block.parse(n.src,n.md,n.env,n.tokens)}function ont(n){const e=n.tokens;for(let t=0,r=e.length;t<r;t++){const i=e[t];i.type==="inline"&&n.md.inline.parse(i.content,n.md,n.env,i.children)}}function snt(n){return/^<a[>\s]/i.test(n)}function ant(n){return/^<\/a\s*>/i.test(n)}function cnt(n){const e=n.tokens;if(n.md.options.linkify)for(let t=0,r=e.length;t<r;t++){if(e[t].type!=="inline"||!n.md.linkify.pretest(e[t].content))continue;let i=e[t].children,o=0;for(let s=i.length-1;s>=0;s--){const a=i[s];if(a.type==="link_close"){for(s--;i[s].level!==a.level&&i[s].type!=="link_open";)s--;continue}if(a.type==="html_inline"&&(snt(a.content)&&o>0&&o--,ant(a.content)&&o++),!(o>0)&&a.type==="text"&&n.md.linkify.test(a.content)){const c=a.content;let l=n.md.linkify.match(c);const u=[];let d=a.level,h=0;l.length>0&&l[0].index===0&&s>0&&i[s-1].type==="text_special"&&(l=l.slice(1));for(let f=0;f<l.length;f++){const p=l[f].url,g=n.md.normalizeLink(p);if(!n.md.validateLink(g))continue;let m=l[f].text;l[f].schema?l[f].schema==="mailto:"&&!/^mailto:/i.test(m)?m=n.md.normalizeLinkText("mailto:"+m).replace(/^mailto:/,""):m=n.md.normalizeLinkText(m):m=n.md.normalizeLinkText("http://"+m).replace(/^http:\/\//,"");const v=l[f].index;if(v>h){const w=new n.Token("text","",0);w.content=c.slice(h,v),w.level=d,u.push(w)}const b=new n.Token("link_open","a",1);b.attrs=[["href",g]],b.level=d++,b.markup="linkify",b.info="auto",u.push(b);const S=new n.Token("text","",0);S.content=m,S.level=d,u.push(S);const E=new n.Token("link_close","a",-1);E.level=--d,E.markup="linkify",E.info="auto",u.push(E),h=l[f].lastIndex}if(h<c.length){const f=new n.Token("text","",0);f.content=c.slice(h),f.level=d,u.push(f)}e[t].children=i=MEe(i,s,u)}}}}const NEe=/\+-|\.\.|\?\?\?\?|!!!!|,,|--/,lnt=/\((c|tm|r)\)/i,unt=/\((c|tm|r)\)/ig,dnt={c:"©",r:"®",tm:"™"};function hnt(n,e){return dnt[e.toLowerCase()]}function fnt(n){let e=0;for(let t=n.length-1;t>=0;t--){const r=n[t];r.type==="text"&&!e&&(r.content=r.content.replace(unt,hnt)),r.type==="link_open"&&r.info==="auto"&&e--,r.type==="link_close"&&r.info==="auto"&&e++}}function pnt(n){let e=0;for(let t=n.length-1;t>=0;t--){const r=n[t];r.type==="text"&&!e&&NEe.test(r.content)&&(r.content=r.content.replace(/\+-/g,"±").replace(/\.{2,}/g,"…").replace(/([?!])…/g,"$1..").replace(/([?!]){4,}/g,"$1$1$1").replace(/,{2,}/g,",").replace(/(^|[^-])---(?=[^-]|$)/mg,"$1—").replace(/(^|\s)--(?=\s|$)/mg,"$1–").replace(/(^|[^-\s])--(?=[^-\s]|$)/mg,"$1–")),r.type==="link_open"&&r.info==="auto"&&e--,r.type==="link_close"&&r.info==="auto"&&e++}}function gnt(n){let e;if(n.md.options.typographer)for(e=n.tokens.length-1;e>=0;e--)n.tokens[e].type==="inline"&&(lnt.test(n.tokens[e].content)&&fnt(n.tokens[e].children),NEe.test(n.tokens[e].content)&&pnt(n.tokens[e].children))}const mnt=/['"]/,Ule=/['"]/g,zle="’";function ZR(n,e,t){return n.slice(0,e)+t+n.slice(e+1)}function vnt(n,e){let t;const r=[];for(let i=0;i<n.length;i++){const o=n[i],s=n[i].level;for(t=r.length-1;t>=0&&!(r[t].level<=s);t--);if(r.length=t+1,o.type!=="text")continue;let a=o.content,c=0,l=a.length;e:for(;c<l;){Ule.lastIndex=c;const u=Ule.exec(a);if(!u)break;let d=!0,h=!0;c=u.index+1;const f=u[0]==="'";let p=32;if(u.index-1>=0)p=a.charCodeAt(u.index-1);else for(t=i-1;t>=0&&!(n[t].type==="softbreak"||n[t].type==="hardbreak");t--)if(n[t].content){p=n[t].content.charCodeAt(n[t].content.length-1);break}let g=32;if(c<l)g=a.charCodeAt(c);else for(t=i+1;t<n.length&&!(n[t].type==="softbreak"||n[t].type==="hardbreak");t++)if(n[t].content){g=n[t].content.charCodeAt(0);break}const m=Nk(p)||Lk(String.fromCharCode(p)),v=Nk(g)||Lk(String.fromCharCode(g)),b=$k(p),S=$k(g);if(S?d=!1:v&&(b||m||(d=!1)),b?h=!1:m&&(S||v||(h=!1)),g===34&&u[0]==='"'&&p>=48&&p<=57&&(h=d=!1),d&&h&&(d=m,h=v),!d&&!h){f&&(o.content=ZR(o.content,u.index,zle));continue}if(h)for(t=r.length-1;t>=0;t--){let E=r[t];if(r[t].level<s)break;if(E.single===f&&r[t].level===s){E=r[t];let w,C;f?(w=e.md.options.quotes[2],C=e.md.options.quotes[3]):(w=e.md.options.quotes[0],C=e.md.options.quotes[1]),o.content=ZR(o.content,u.index,C),n[E.token].content=ZR(n[E.token].content,E.pos,w),c+=C.length-1,E.token===i&&(c+=w.length-1),a=o.content,l=a.length,r.length=t;continue e}}d?r.push({token:i,pos:u.index,single:f,level:s}):h&&f&&(o.content=ZR(o.content,u.index,zle))}}}function ynt(n){if(n.md.options.typographer)for(let e=n.tokens.length-1;e>=0;e--)n.tokens[e].type!=="inline"||!mnt.test(n.tokens[e].content)||vnt(n.tokens[e].children,n)}function bnt(n){let e,t;const r=n.tokens,i=r.length;for(let o=0;o<i;o++){if(r[o].type!=="inline")continue;const s=r[o].children,a=s.length;for(e=0;e<a;e++)s[e].type==="text_special"&&(s[e].type="text");for(e=t=0;e<a;e++)s[e].type==="text"&&e+1<a&&s[e+1].type==="text"?s[e+1].content=s[e].content+s[e+1].content:(e!==t&&(s[t]=s[e]),t++);e!==t&&(s.length=t)}}const Lj=[["normalize",rnt],["block",int],["inline",ont],["linkify",cnt],["replacements",gnt],["smartquotes",ynt],["text_join",bnt]];function Wee(){this.ruler=new qu;for(let n=0;n<Lj.length;n++)this.ruler.push(Lj[n][0],Lj[n][1])}Wee.prototype.process=function(n){const e=this.ruler.getRules("");for(let t=0,r=e.length;t<r;t++)e[t](n)};Wee.prototype.State=LEe;function Rg(n,e,t,r){this.src=n,this.md=e,this.env=t,this.tokens=r,this.bMarks=[],this.eMarks=[],this.tShift=[],this.sCount=[],this.bsCount=[],this.blkIndent=0,this.line=0,this.lineMax=0,this.tight=!1,this.ddIndent=-1,this.listIndent=-1,this.parentType="root",this.level=0;const i=this.src;for(let o=0,s=0,a=0,c=0,l=i.length,u=!1;s<l;s++){const d=i.charCodeAt(s);if(!u)if(jo(d)){a++,d===9?c+=4-c%4:c++;continue}else u=!0;(d===10||s===l-1)&&(d!==10&&s++,this.bMarks.push(o),this.eMarks.push(s),this.tShift.push(a),this.sCount.push(c),this.bsCount.push(0),u=!1,a=0,c=0,o=s+1)}this.bMarks.push(i.length),this.eMarks.push(i.length),this.tShift.push(0),this.sCount.push(0),this.bsCount.push(0),this.lineMax=this.bMarks.length-1}Rg.prototype.push=function(n,e,t){const r=new tp(n,e,t);return r.block=!0,t<0&&this.level--,r.level=this.level,t>0&&this.level++,this.tokens.push(r),r};Rg.prototype.isEmpty=function(e){return this.bMarks[e]+this.tShift[e]>=this.eMarks[e]};Rg.prototype.skipEmptyLines=function(e){for(let t=this.lineMax;e<t&&!(this.bMarks[e]+this.tShift[e]<this.eMarks[e]);e++);return e};Rg.prototype.skipSpaces=function(e){for(let t=this.src.length;e<t;e++){const r=this.src.charCodeAt(e);if(!jo(r))break}return e};Rg.prototype.skipSpacesBack=function(e,t){if(e<=t)return e;for(;e>t;)if(!jo(this.src.charCodeAt(--e)))return e+1;return e};Rg.prototype.skipChars=function(e,t){for(let r=this.src.length;e<r&&this.src.charCodeAt(e)===t;e++);return e};Rg.prototype.skipCharsBack=function(e,t,r){if(e<=r)return e;for(;e>r;)if(t!==this.src.charCodeAt(--e))return e+1;return e};Rg.prototype.getLines=function(e,t,r,i){if(e>=t)return"";const o=new Array(t-e);for(let s=0,a=e;a<t;a++,s++){let c=0;const l=this.bMarks[a];let u=l,d;for(a+1<t||i?d=this.eMarks[a]+1:d=this.eMarks[a];u<d&&c<r;){const h=this.src.charCodeAt(u);if(jo(h))h===9?c+=4-(c+this.bsCount[a])%4:c++;else if(u-l<this.tShift[a])c++;else break;u++}c>r?o[s]=new Array(c-r+1).join(" ")+this.src.slice(u,d):o[s]=this.src.slice(u,d)}return o.join("")};Rg.prototype.Token=tp;const Snt=65536;function Nj(n,e){const t=n.bMarks[e]+n.tShift[e],r=n.eMarks[e];return n.src.slice(t,r)}function Vle(n){const e=[],t=n.length;let r=0,i=n.charCodeAt(r),o=!1,s=0,a="";for(;r<t;)i===124&&(o?(a+=n.substring(s,r-1),s=r):(e.push(a+n.substring(s,r)),a="",s=r+1)),o=i===92,r++,i=n.charCodeAt(r);return e.push(a+n.substring(s)),e}function _nt(n,e,t,r){if(e+2>t)return!1;let i=e+1;if(n.sCount[i]<n.blkIndent||n.sCount[i]-n.blkIndent>=4)return!1;let o=n.bMarks[i]+n.tShift[i];if(o>=n.eMarks[i])return!1;const s=n.src.charCodeAt(o++);if(s!==124&&s!==45&&s!==58||o>=n.eMarks[i])return!1;const a=n.src.charCodeAt(o++);if(a!==124&&a!==45&&a!==58&&!jo(a)||s===45&&jo(a))return!1;for(;o<n.eMarks[i];){const E=n.src.charCodeAt(o);if(E!==124&&E!==45&&E!==58&&!jo(E))return!1;o++}let c=Nj(n,e+1),l=c.split("|");const u=[];for(let E=0;E<l.length;E++){const w=l[E].trim();if(!w){if(E===0||E===l.length-1)continue;return!1}if(!/^:?-+:?$/.test(w))return!1;w.charCodeAt(w.length-1)===58?u.push(w.charCodeAt(0)===58?"center":"right"):w.charCodeAt(0)===58?u.push("left"):u.push("")}if(c=Nj(n,e).trim(),c.indexOf("|")===-1||n.sCount[e]-n.blkIndent>=4)return!1;l=Vle(c),l.length&&l[0]===""&&l.shift(),l.length&&l[l.length-1]===""&&l.pop();const d=l.length;if(d===0||d!==u.length)return!1;if(r)return!0;const h=n.parentType;n.parentType="table";const f=n.md.block.ruler.getRules("blockquote"),p=n.push("table_open","table",1),g=[e,0];p.map=g;const m=n.push("thead_open","thead",1);m.map=[e,e+1];const v=n.push("tr_open","tr",1);v.map=[e,e+1];for(let E=0;E<l.length;E++){const w=n.push("th_open","th",1);u[E]&&(w.attrs=[["style","text-align:"+u[E]]]);const C=n.push("inline","",0);C.content=l[E].trim(),C.children=[],n.push("th_close","th",-1)}n.push("tr_close","tr",-1),n.push("thead_close","thead",-1);let b,S=0;for(i=e+2;i<t&&!(n.sCount[i]<n.blkIndent);i++){let E=!1;for(let C=0,I=f.length;C<I;C++)if(f[C](n,i,t,!0)){E=!0;break}if(E||(c=Nj(n,i).trim(),!c)||n.sCount[i]-n.blkIndent>=4||(l=Vle(c),l.length&&l[0]===""&&l.shift(),l.length&&l[l.length-1]===""&&l.pop(),S+=d-l.length,S>Snt))break;if(i===e+2){const C=n.push("tbody_open","tbody",1);C.map=b=[e+2,0]}const w=n.push("tr_open","tr",1);w.map=[i,i+1];for(let C=0;C<d;C++){const I=n.push("td_open","td",1);u[C]&&(I.attrs=[["style","text-align:"+u[C]]]);const T=n.push("inline","",0);T.content=l[C]?l[C].trim():"",T.children=[],n.push("td_close","td",-1)}n.push("tr_close","tr",-1)}return b&&(n.push("tbody_close","tbody",-1),b[1]=i),n.push("table_close","table",-1),g[1]=i,n.parentType=h,n.line=i,!0}function wnt(n,e,t){if(n.sCount[e]-n.blkIndent<4)return!1;let r=e+1,i=r;for(;r<t;){if(n.isEmpty(r)){r++;continue}if(n.sCount[r]-n.blkIndent>=4){r++,i=r;continue}break}n.line=i;const o=n.push("code_block","code",0);return o.content=n.getLines(e,i,4+n.blkIndent,!1)+`
`,o.map=[e,n.line],!0}function Cnt(n,e,t,r){let i=n.bMarks[e]+n.tShift[e],o=n.eMarks[e];if(n.sCount[e]-n.blkIndent>=4||i+3>o)return!1;const s=n.src.charCodeAt(i);if(s!==126&&s!==96)return!1;let a=i;i=n.skipChars(i,s);let c=i-a;if(c<3)return!1;const l=n.src.slice(a,i),u=n.src.slice(i,o);if(s===96&&u.indexOf(String.fromCharCode(s))>=0)return!1;if(r)return!0;let d=e,h=!1;for(;d++,!(d>=t||(i=a=n.bMarks[d]+n.tShift[d],o=n.eMarks[d],i<o&&n.sCount[d]<n.blkIndent));)if(n.src.charCodeAt(i)===s&&!(n.sCount[d]-n.blkIndent>=4)&&(i=n.skipChars(i,s),!(i-a<c)&&(i=n.skipSpaces(i),!(i<o)))){h=!0;break}c=n.sCount[e],n.line=d+(h?1:0);const f=n.push("fence","code",0);return f.info=u,f.content=n.getLines(e+1,d,c,!0),f.markup=l,f.map=[e,n.line],!0}function xnt(n,e,t,r){let i=n.bMarks[e]+n.tShift[e],o=n.eMarks[e];const s=n.lineMax;if(n.sCount[e]-n.blkIndent>=4||n.src.charCodeAt(i)!==62)return!1;if(r)return!0;const a=[],c=[],l=[],u=[],d=n.md.block.ruler.getRules("blockquote"),h=n.parentType;n.parentType="blockquote";let f=!1,p;for(p=e;p<t;p++){const S=n.sCount[p]<n.blkIndent;if(i=n.bMarks[p]+n.tShift[p],o=n.eMarks[p],i>=o)break;if(n.src.charCodeAt(i++)===62&&!S){let w=n.sCount[p]+1,C,I;n.src.charCodeAt(i)===32?(i++,w++,I=!1,C=!0):n.src.charCodeAt(i)===9?(C=!0,(n.bsCount[p]+w)%4===3?(i++,w++,I=!1):I=!0):C=!1;let T=w;for(a.push(n.bMarks[p]),n.bMarks[p]=i;i<o;){const D=n.src.charCodeAt(i);if(jo(D))D===9?T+=4-(T+n.bsCount[p]+(I?1:0))%4:T++;else break;i++}f=i>=o,c.push(n.bsCount[p]),n.bsCount[p]=n.sCount[p]+1+(C?1:0),l.push(n.sCount[p]),n.sCount[p]=T-w,u.push(n.tShift[p]),n.tShift[p]=i-n.bMarks[p];continue}if(f)break;let E=!1;for(let w=0,C=d.length;w<C;w++)if(d[w](n,p,t,!0)){E=!0;break}if(E){n.lineMax=p,n.blkIndent!==0&&(a.push(n.bMarks[p]),c.push(n.bsCount[p]),u.push(n.tShift[p]),l.push(n.sCount[p]),n.sCount[p]-=n.blkIndent);break}a.push(n.bMarks[p]),c.push(n.bsCount[p]),u.push(n.tShift[p]),l.push(n.sCount[p]),n.sCount[p]=-1}const g=n.blkIndent;n.blkIndent=0;const m=n.push("blockquote_open","blockquote",1);m.markup=">";const v=[e,0];m.map=v,n.md.block.tokenize(n,e,p);const b=n.push("blockquote_close","blockquote",-1);b.markup=">",n.lineMax=s,n.parentType=h,v[1]=n.line;for(let S=0;S<u.length;S++)n.bMarks[S+e]=a[S],n.tShift[S+e]=u[S],n.sCount[S+e]=l[S],n.bsCount[S+e]=c[S];return n.blkIndent=g,!0}function Ent(n,e,t,r){const i=n.eMarks[e];if(n.sCount[e]-n.blkIndent>=4)return!1;let o=n.bMarks[e]+n.tShift[e];const s=n.src.charCodeAt(o++);if(s!==42&&s!==45&&s!==95)return!1;let a=1;for(;o<i;){const l=n.src.charCodeAt(o++);if(l!==s&&!jo(l))return!1;l===s&&a++}if(a<3)return!1;if(r)return!0;n.line=e+1;const c=n.push("hr","hr",0);return c.map=[e,n.line],c.markup=Array(a+1).join(String.fromCharCode(s)),!0}function Wle(n,e){const t=n.eMarks[e];let r=n.bMarks[e]+n.tShift[e];const i=n.src.charCodeAt(r++);if(i!==42&&i!==45&&i!==43)return-1;if(r<t){const o=n.src.charCodeAt(r);if(!jo(o))return-1}return r}function qle(n,e){const t=n.bMarks[e]+n.tShift[e],r=n.eMarks[e];let i=t;if(i+1>=r)return-1;let o=n.src.charCodeAt(i++);if(o<48||o>57)return-1;for(;;){if(i>=r)return-1;if(o=n.src.charCodeAt(i++),o>=48&&o<=57){if(i-t>=10)return-1;continue}if(o===41||o===46)break;return-1}return i<r&&(o=n.src.charCodeAt(i),!jo(o))?-1:i}function Int(n,e){const t=n.level+2;for(let r=e+2,i=n.tokens.length-2;r<i;r++)n.tokens[r].level===t&&n.tokens[r].type==="paragraph_open"&&(n.tokens[r+2].hidden=!0,n.tokens[r].hidden=!0,r+=2)}function Pnt(n,e,t,r){let i,o,s,a,c=e,l=!0;if(n.sCount[c]-n.blkIndent>=4||n.listIndent>=0&&n.sCount[c]-n.listIndent>=4&&n.sCount[c]<n.blkIndent)return!1;let u=!1;r&&n.parentType==="paragraph"&&n.sCount[c]>=n.blkIndent&&(u=!0);let d,h,f;if((f=qle(n,c))>=0){if(d=!0,s=n.bMarks[c]+n.tShift[c],h=Number(n.src.slice(s,f-1)),u&&h!==1)return!1}else if((f=Wle(n,c))>=0)d=!1;else return!1;if(u&&n.skipSpaces(f)>=n.eMarks[c])return!1;if(r)return!0;const p=n.src.charCodeAt(f-1),g=n.tokens.length;d?(a=n.push("ordered_list_open","ol",1),h!==1&&(a.attrs=[["start",h]])):a=n.push("bullet_list_open","ul",1);const m=[c,0];a.map=m,a.markup=String.fromCharCode(p);let v=!1;const b=n.md.block.ruler.getRules("list"),S=n.parentType;for(n.parentType="list";c<t;){o=f,i=n.eMarks[c];const E=n.sCount[c]+f-(n.bMarks[c]+n.tShift[c]);let w=E;for(;o<i;){const L=n.src.charCodeAt(o);if(L===9)w+=4-(w+n.bsCount[c])%4;else if(L===32)w++;else break;o++}const C=o;let I;C>=i?I=1:I=w-E,I>4&&(I=1);const T=E+I;a=n.push("list_item_open","li",1),a.markup=String.fromCharCode(p);const D=[c,0];a.map=D,d&&(a.info=n.src.slice(s,f-1));const O=n.tight,M=n.tShift[c],R=n.sCount[c],A=n.listIndent;if(n.listIndent=n.blkIndent,n.blkIndent=T,n.tight=!0,n.tShift[c]=C-n.bMarks[c],n.sCount[c]=w,C>=i&&n.isEmpty(c+1)?n.line=Math.min(n.line+2,t):n.md.block.tokenize(n,c,t,!0),(!n.tight||v)&&(l=!1),v=n.line-c>1&&n.isEmpty(n.line-1),n.blkIndent=n.listIndent,n.listIndent=A,n.tShift[c]=M,n.sCount[c]=R,n.tight=O,a=n.push("list_item_close","li",-1),a.markup=String.fromCharCode(p),c=n.line,D[1]=c,c>=t||n.sCount[c]<n.blkIndent||n.sCount[c]-n.blkIndent>=4)break;let k=!1;for(let L=0,j=b.length;L<j;L++)if(b[L](n,c,t,!0)){k=!0;break}if(k)break;if(d){if(f=qle(n,c),f<0)break;s=n.bMarks[c]+n.tShift[c]}else if(f=Wle(n,c),f<0)break;if(p!==n.src.charCodeAt(f-1))break}return d?a=n.push("ordered_list_close","ol",-1):a=n.push("bullet_list_close","ul",-1),a.markup=String.fromCharCode(p),m[1]=c,n.line=c,n.parentType=S,l&&Int(n,g),!0}function knt(n,e,t,r){let i=n.bMarks[e]+n.tShift[e],o=n.eMarks[e],s=e+1;if(n.sCount[e]-n.blkIndent>=4||n.src.charCodeAt(i)!==91)return!1;function a(b){const S=n.lineMax;if(b>=S||n.isEmpty(b))return null;let E=!1;if(n.sCount[b]-n.blkIndent>3&&(E=!0),n.sCount[b]<0&&(E=!0),!E){const I=n.md.block.ruler.getRules("reference"),T=n.parentType;n.parentType="reference";let D=!1;for(let O=0,M=I.length;O<M;O++)if(I[O](n,b,S,!0)){D=!0;break}if(n.parentType=T,D)return null}const w=n.bMarks[b]+n.tShift[b],C=n.eMarks[b];return n.src.slice(w,C+1)}let c=n.src.slice(i,o+1);o=c.length;let l=-1;for(i=1;i<o;i++){const b=c.charCodeAt(i);if(b===91)return!1;if(b===93){l=i;break}else if(b===10){const S=a(s);S!==null&&(c+=S,o=c.length,s++)}else if(b===92&&(i++,i<o&&c.charCodeAt(i)===10)){const S=a(s);S!==null&&(c+=S,o=c.length,s++)}}if(l<0||c.charCodeAt(l+1)!==58)return!1;for(i=l+2;i<o;i++){const b=c.charCodeAt(i);if(b===10){const S=a(s);S!==null&&(c+=S,o=c.length,s++)}else if(!jo(b))break}const u=n.md.helpers.parseLinkDestination(c,i,o);if(!u.ok)return!1;const d=n.md.normalizeLink(u.str);if(!n.md.validateLink(d))return!1;i=u.pos;const h=i,f=s,p=i;for(;i<o;i++){const b=c.charCodeAt(i);if(b===10){const S=a(s);S!==null&&(c+=S,o=c.length,s++)}else if(!jo(b))break}let g=n.md.helpers.parseLinkTitle(c,i,o);for(;g.can_continue;){const b=a(s);if(b===null)break;c+=b,i=o,o=c.length,s++,g=n.md.helpers.parseLinkTitle(c,i,o,g)}let m;for(i<o&&p!==i&&g.ok?(m=g.str,i=g.pos):(m="",i=h,s=f);i<o;){const b=c.charCodeAt(i);if(!jo(b))break;i++}if(i<o&&c.charCodeAt(i)!==10&&m)for(m="",i=h,s=f;i<o;){const b=c.charCodeAt(i);if(!jo(b))break;i++}if(i<o&&c.charCodeAt(i)!==10)return!1;const v=s7(c.slice(1,l));return v?(r||(typeof n.env.references>"u"&&(n.env.references={}),typeof n.env.references[v]>"u"&&(n.env.references[v]={title:m,href:d}),n.line=s),!0):!1}const Tnt=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],Dnt="[a-zA-Z_:][a-zA-Z0-9:._-]*",Rnt="[^\"'=<>`\\x00-\\x20]+",Ant="'[^']*'",Ont='"[^"]*"',Mnt="(?:"+Rnt+"|"+Ant+"|"+Ont+")",$nt="(?:\\s+"+Dnt+"(?:\\s*=\\s*"+Mnt+")?)",FEe="<[A-Za-z][A-Za-z0-9\\-]*"+$nt+"*\\s*\\/?>",jEe="<\\/[A-Za-z][A-Za-z0-9\\-]*\\s*>",Lnt="<!---?>|<!--(?:[^-]|-[^-]|--[^>])*-->",Nnt="<[?][\\s\\S]*?[?]>",Fnt="<![A-Za-z][^>]*>",jnt="<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",Bnt=new RegExp("^(?:"+FEe+"|"+jEe+"|"+Lnt+"|"+Nnt+"|"+Fnt+"|"+jnt+")"),Hnt=new RegExp("^(?:"+FEe+"|"+jEe+")"),N_=[[/^<(script|pre|style|textarea)(?=(\s|>|$))/i,/<\/(script|pre|style|textarea)>/i,!0],[/^<!--/,/-->/,!0],[/^<\?/,/\?>/,!0],[/^<![A-Z]/,/>/,!0],[/^<!\[CDATA\[/,/\]\]>/,!0],[new RegExp("^</?("+Tnt.join("|")+")(?=(\\s|/?>|$))","i"),/^$/,!0],[new RegExp(Hnt.source+"\\s*$"),/^$/,!1]];function Unt(n,e,t,r){let i=n.bMarks[e]+n.tShift[e],o=n.eMarks[e];if(n.sCount[e]-n.blkIndent>=4||!n.md.options.html||n.src.charCodeAt(i)!==60)return!1;let s=n.src.slice(i,o),a=0;for(;a<N_.length&&!N_[a][0].test(s);a++);if(a===N_.length)return!1;if(r)return N_[a][2];let c=e+1;if(!N_[a][1].test(s)){for(;c<t&&!(n.sCount[c]<n.blkIndent);c++)if(i=n.bMarks[c]+n.tShift[c],o=n.eMarks[c],s=n.src.slice(i,o),N_[a][1].test(s)){s.length!==0&&c++;break}}n.line=c;const l=n.push("html_block","",0);return l.map=[e,c],l.content=n.getLines(e,c,n.blkIndent,!0),!0}function znt(n,e,t,r){let i=n.bMarks[e]+n.tShift[e],o=n.eMarks[e];if(n.sCount[e]-n.blkIndent>=4)return!1;let s=n.src.charCodeAt(i);if(s!==35||i>=o)return!1;let a=1;for(s=n.src.charCodeAt(++i);s===35&&i<o&&a<=6;)a++,s=n.src.charCodeAt(++i);if(a>6||i<o&&!jo(s))return!1;if(r)return!0;o=n.skipSpacesBack(o,i);const c=n.skipCharsBack(o,35,i);c>i&&jo(n.src.charCodeAt(c-1))&&(o=c),n.line=e+1;const l=n.push("heading_open","h"+String(a),1);l.markup="########".slice(0,a),l.map=[e,n.line];const u=n.push("inline","",0);u.content=n.src.slice(i,o).trim(),u.map=[e,n.line],u.children=[];const d=n.push("heading_close","h"+String(a),-1);return d.markup="########".slice(0,a),!0}function Vnt(n,e,t){const r=n.md.block.ruler.getRules("paragraph");if(n.sCount[e]-n.blkIndent>=4)return!1;const i=n.parentType;n.parentType="paragraph";let o=0,s,a=e+1;for(;a<t&&!n.isEmpty(a);a++){if(n.sCount[a]-n.blkIndent>3)continue;if(n.sCount[a]>=n.blkIndent){let f=n.bMarks[a]+n.tShift[a];const p=n.eMarks[a];if(f<p&&(s=n.src.charCodeAt(f),(s===45||s===61)&&(f=n.skipChars(f,s),f=n.skipSpaces(f),f>=p))){o=s===61?1:2;break}}if(n.sCount[a]<0)continue;let h=!1;for(let f=0,p=r.length;f<p;f++)if(r[f](n,a,t,!0)){h=!0;break}if(h)break}if(!o)return!1;const c=n.getLines(e,a,n.blkIndent,!1).trim();n.line=a+1;const l=n.push("heading_open","h"+String(o),1);l.markup=String.fromCharCode(s),l.map=[e,n.line];const u=n.push("inline","",0);u.content=c,u.map=[e,n.line-1],u.children=[];const d=n.push("heading_close","h"+String(o),-1);return d.markup=String.fromCharCode(s),n.parentType=i,!0}function Wnt(n,e,t){const r=n.md.block.ruler.getRules("paragraph"),i=n.parentType;let o=e+1;for(n.parentType="paragraph";o<t&&!n.isEmpty(o);o++){if(n.sCount[o]-n.blkIndent>3||n.sCount[o]<0)continue;let l=!1;for(let u=0,d=r.length;u<d;u++)if(r[u](n,o,t,!0)){l=!0;break}if(l)break}const s=n.getLines(e,o,n.blkIndent,!1).trim();n.line=o;const a=n.push("paragraph_open","p",1);a.map=[e,n.line];const c=n.push("inline","",0);return c.content=s,c.map=[e,n.line],c.children=[],n.push("paragraph_close","p",-1),n.parentType=i,!0}const XR=[["table",_nt,["paragraph","reference"]],["code",wnt],["fence",Cnt,["paragraph","reference","blockquote","list"]],["blockquote",xnt,["paragraph","reference","blockquote","list"]],["hr",Ent,["paragraph","reference","blockquote","list"]],["list",Pnt,["paragraph","reference","blockquote"]],["reference",knt],["html_block",Unt,["paragraph","reference","blockquote"]],["heading",znt,["paragraph","reference","blockquote"]],["lheading",Vnt],["paragraph",Wnt]];function a7(){this.ruler=new qu;for(let n=0;n<XR.length;n++)this.ruler.push(XR[n][0],XR[n][1],{alt:(XR[n][2]||[]).slice()})}a7.prototype.tokenize=function(n,e,t){const r=this.ruler.getRules(""),i=r.length,o=n.md.options.maxNesting;let s=e,a=!1;for(;s<t&&(n.line=s=n.skipEmptyLines(s),!(s>=t||n.sCount[s]<n.blkIndent));){if(n.level>=o){n.line=t;break}const c=n.line;let l=!1;for(let u=0;u<i;u++)if(l=r[u](n,s,t,!1),l){if(c>=n.line)throw new Error("block rule didn't increment state.line");break}if(!l)throw new Error("none of the block rules matched");n.tight=!a,n.isEmpty(n.line-1)&&(a=!0),s=n.line,s<t&&n.isEmpty(s)&&(a=!0,s++,n.line=s)}};a7.prototype.parse=function(n,e,t,r){if(!n)return;const i=new this.State(n,e,t,r);this.tokenize(i,i.line,i.lineMax)};a7.prototype.State=Rg;function ZT(n,e,t,r){this.src=n,this.env=t,this.md=e,this.tokens=r,this.tokens_meta=Array(r.length),this.pos=0,this.posMax=this.src.length,this.level=0,this.pending="",this.pendingLevel=0,this.cache={},this.delimiters=[],this._prev_delimiters=[],this.backticks={},this.backticksScanned=!1,this.linkLevel=0}ZT.prototype.pushPending=function(){const n=new tp("text","",0);return n.content=this.pending,n.level=this.pendingLevel,this.tokens.push(n),this.pending="",n};ZT.prototype.push=function(n,e,t){this.pending&&this.pushPending();const r=new tp(n,e,t);let i=null;return t<0&&(this.level--,this.delimiters=this._prev_delimiters.pop()),r.level=this.level,t>0&&(this.level++,this._prev_delimiters.push(this.delimiters),this.delimiters=[],i={delimiters:this.delimiters}),this.pendingLevel=this.level,this.tokens.push(r),this.tokens_meta.push(i),r};ZT.prototype.scanDelims=function(n,e){const t=this.posMax,r=this.src.charCodeAt(n),i=n>0?this.src.charCodeAt(n-1):32;let o=n;for(;o<t&&this.src.charCodeAt(o)===r;)o++;const s=o-n,a=o<t?this.src.charCodeAt(o):32,c=Nk(i)||Lk(String.fromCharCode(i)),l=Nk(a)||Lk(String.fromCharCode(a)),u=$k(i),d=$k(a),h=!d&&(!l||u||c),f=!u&&(!c||d||l);return{can_open:h&&(e||!f||c),can_close:f&&(e||!h||l),length:s}};ZT.prototype.Token=tp;function qnt(n){switch(n){case 10:case 33:case 35:case 36:case 37:case 38:case 42:case 43:case 45:case 58:case 60:case 61:case 62:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 125:case 126:return!0;default:return!1}}function Knt(n,e){let t=n.pos;for(;t<n.posMax&&!qnt(n.src.charCodeAt(t));)t++;return t===n.pos?!1:(e||(n.pending+=n.src.slice(n.pos,t)),n.pos=t,!0)}const Gnt=/(?:^|[^a-z0-9.+-])([a-z][a-z0-9.+-]*)$/i;function Znt(n,e){if(!n.md.options.linkify||n.linkLevel>0)return!1;const t=n.pos,r=n.posMax;if(t+3>r||n.src.charCodeAt(t)!==58||n.src.charCodeAt(t+1)!==47||n.src.charCodeAt(t+2)!==47)return!1;const i=n.pending.match(Gnt);if(!i)return!1;const o=i[1],s=n.md.linkify.matchAtStart(n.src.slice(t-o.length));if(!s)return!1;let a=s.url;if(a.length<=o.length)return!1;a=a.replace(/\*+$/,"");const c=n.md.normalizeLink(a);if(!n.md.validateLink(c))return!1;if(!e){n.pending=n.pending.slice(0,-o.length);const l=n.push("link_open","a",1);l.attrs=[["href",c]],l.markup="linkify",l.info="auto";const u=n.push("text","",0);u.content=n.md.normalizeLinkText(a);const d=n.push("link_close","a",-1);d.markup="linkify",d.info="auto"}return n.pos+=a.length-o.length,!0}function Xnt(n,e){let t=n.pos;if(n.src.charCodeAt(t)!==10)return!1;const r=n.pending.length-1,i=n.posMax;if(!e)if(r>=0&&n.pending.charCodeAt(r)===32)if(r>=1&&n.pending.charCodeAt(r-1)===32){let o=r-1;for(;o>=1&&n.pending.charCodeAt(o-1)===32;)o--;n.pending=n.pending.slice(0,o),n.push("hardbreak","br",0)}else n.pending=n.pending.slice(0,-1),n.push("softbreak","br",0);else n.push("softbreak","br",0);for(t++;t<i&&jo(n.src.charCodeAt(t));)t++;return n.pos=t,!0}const qee=[];for(let n=0;n<256;n++)qee.push(0);"\\!\"#$%&'()*+,./:;<=>?@[]^_`{|}~-".split("").forEach(function(n){qee[n.charCodeAt(0)]=1});function Ynt(n,e){let t=n.pos;const r=n.posMax;if(n.src.charCodeAt(t)!==92||(t++,t>=r))return!1;let i=n.src.charCodeAt(t);if(i===10){for(e||n.push("hardbreak","br",0),t++;t<r&&(i=n.src.charCodeAt(t),!!jo(i));)t++;return n.pos=t,!0}let o=n.src[t];if(i>=55296&&i<=56319&&t+1<r){const a=n.src.charCodeAt(t+1);a>=56320&&a<=57343&&(o+=n.src[t+1],t++)}const s="\\"+o;if(!e){const a=n.push("text_special","",0);i<256&&qee[i]!==0?a.content=o:a.content=s,a.markup=s,a.info="escape"}return n.pos=t+1,!0}function Jnt(n,e){let t=n.pos;if(n.src.charCodeAt(t)!==96)return!1;const i=t;t++;const o=n.posMax;for(;t<o&&n.src.charCodeAt(t)===96;)t++;const s=n.src.slice(i,t),a=s.length;if(n.backticksScanned&&(n.backticks[a]||0)<=i)return e||(n.pending+=s),n.pos+=a,!0;let c=t,l;for(;(l=n.src.indexOf("`",c))!==-1;){for(c=l+1;c<o&&n.src.charCodeAt(c)===96;)c++;const u=c-l;if(u===a){if(!e){const d=n.push("code_inline","code",0);d.markup=s,d.content=n.src.slice(t,l).replace(/\n/g," ").replace(/^ (.+) $/,"$1")}return n.pos=c,!0}n.backticks[u]=l}return n.backticksScanned=!0,e||(n.pending+=s),n.pos+=a,!0}function Qnt(n,e){const t=n.pos,r=n.src.charCodeAt(t);if(e||r!==126)return!1;const i=n.scanDelims(n.pos,!0);let o=i.length;const s=String.fromCharCode(r);if(o<2)return!1;let a;o%2&&(a=n.push("text","",0),a.content=s,o--);for(let c=0;c<o;c+=2)a=n.push("text","",0),a.content=s+s,n.delimiters.push({marker:r,length:0,token:n.tokens.length-1,end:-1,open:i.can_open,close:i.can_close});return n.pos+=i.length,!0}function Kle(n,e){let t;const r=[],i=e.length;for(let o=0;o<i;o++){const s=e[o];if(s.marker!==126||s.end===-1)continue;const a=e[s.end];t=n.tokens[s.token],t.type="s_open",t.tag="s",t.nesting=1,t.markup="~~",t.content="",t=n.tokens[a.token],t.type="s_close",t.tag="s",t.nesting=-1,t.markup="~~",t.content="",n.tokens[a.token-1].type==="text"&&n.tokens[a.token-1].content==="~"&&r.push(a.token-1)}for(;r.length;){const o=r.pop();let s=o+1;for(;s<n.tokens.length&&n.tokens[s].type==="s_close";)s++;s--,o!==s&&(t=n.tokens[s],n.tokens[s]=n.tokens[o],n.tokens[o]=t)}}function ert(n){const e=n.tokens_meta,t=n.tokens_meta.length;Kle(n,n.delimiters);for(let r=0;r<t;r++)e[r]&&e[r].delimiters&&Kle(n,e[r].delimiters)}const BEe={tokenize:Qnt,postProcess:ert};function trt(n,e){const t=n.pos,r=n.src.charCodeAt(t);if(e||r!==95&&r!==42)return!1;const i=n.scanDelims(n.pos,r===42);for(let o=0;o<i.length;o++){const s=n.push("text","",0);s.content=String.fromCharCode(r),n.delimiters.push({marker:r,length:i.length,token:n.tokens.length-1,end:-1,open:i.can_open,close:i.can_close})}return n.pos+=i.length,!0}function Gle(n,e){const t=e.length;for(let r=t-1;r>=0;r--){const i=e[r];if(i.marker!==95&&i.marker!==42||i.end===-1)continue;const o=e[i.end],s=r>0&&e[r-1].end===i.end+1&&e[r-1].marker===i.marker&&e[r-1].token===i.token-1&&e[i.end+1].token===o.token+1,a=String.fromCharCode(i.marker),c=n.tokens[i.token];c.type=s?"strong_open":"em_open",c.tag=s?"strong":"em",c.nesting=1,c.markup=s?a+a:a,c.content="";const l=n.tokens[o.token];l.type=s?"strong_close":"em_close",l.tag=s?"strong":"em",l.nesting=-1,l.markup=s?a+a:a,l.content="",s&&(n.tokens[e[r-1].token].content="",n.tokens[e[i.end+1].token].content="",r--)}}function nrt(n){const e=n.tokens_meta,t=n.tokens_meta.length;Gle(n,n.delimiters);for(let r=0;r<t;r++)e[r]&&e[r].delimiters&&Gle(n,e[r].delimiters)}const HEe={tokenize:trt,postProcess:nrt};function rrt(n,e){let t,r,i,o,s="",a="",c=n.pos,l=!0;if(n.src.charCodeAt(n.pos)!==91)return!1;const u=n.pos,d=n.posMax,h=n.pos+1,f=n.md.helpers.parseLinkLabel(n,n.pos,!0);if(f<0)return!1;let p=f+1;if(p<d&&n.src.charCodeAt(p)===40){for(l=!1,p++;p<d&&(t=n.src.charCodeAt(p),!(!jo(t)&&t!==10));p++);if(p>=d)return!1;if(c=p,i=n.md.helpers.parseLinkDestination(n.src,p,n.posMax),i.ok){for(s=n.md.normalizeLink(i.str),n.md.validateLink(s)?p=i.pos:s="",c=p;p<d&&(t=n.src.charCodeAt(p),!(!jo(t)&&t!==10));p++);if(i=n.md.helpers.parseLinkTitle(n.src,p,n.posMax),p<d&&c!==p&&i.ok)for(a=i.str,p=i.pos;p<d&&(t=n.src.charCodeAt(p),!(!jo(t)&&t!==10));p++);}(p>=d||n.src.charCodeAt(p)!==41)&&(l=!0),p++}if(l){if(typeof n.env.references>"u")return!1;if(p<d&&n.src.charCodeAt(p)===91?(c=p+1,p=n.md.helpers.parseLinkLabel(n,p),p>=0?r=n.src.slice(c,p++):p=f+1):p=f+1,r||(r=n.src.slice(h,f)),o=n.env.references[s7(r)],!o)return n.pos=u,!1;s=o.href,a=o.title}if(!e){n.pos=h,n.posMax=f;const g=n.push("link_open","a",1),m=[["href",s]];g.attrs=m,a&&m.push(["title",a]),n.linkLevel++,n.md.inline.tokenize(n),n.linkLevel--,n.push("link_close","a",-1)}return n.pos=p,n.posMax=d,!0}function irt(n,e){let t,r,i,o,s,a,c,l,u="";const d=n.pos,h=n.posMax;if(n.src.charCodeAt(n.pos)!==33||n.src.charCodeAt(n.pos+1)!==91)return!1;const f=n.pos+2,p=n.md.helpers.parseLinkLabel(n,n.pos+1,!1);if(p<0)return!1;if(o=p+1,o<h&&n.src.charCodeAt(o)===40){for(o++;o<h&&(t=n.src.charCodeAt(o),!(!jo(t)&&t!==10));o++);if(o>=h)return!1;for(l=o,a=n.md.helpers.parseLinkDestination(n.src,o,n.posMax),a.ok&&(u=n.md.normalizeLink(a.str),n.md.validateLink(u)?o=a.pos:u=""),l=o;o<h&&(t=n.src.charCodeAt(o),!(!jo(t)&&t!==10));o++);if(a=n.md.helpers.parseLinkTitle(n.src,o,n.posMax),o<h&&l!==o&&a.ok)for(c=a.str,o=a.pos;o<h&&(t=n.src.charCodeAt(o),!(!jo(t)&&t!==10));o++);else c="";if(o>=h||n.src.charCodeAt(o)!==41)return n.pos=d,!1;o++}else{if(typeof n.env.references>"u")return!1;if(o<h&&n.src.charCodeAt(o)===91?(l=o+1,o=n.md.helpers.parseLinkLabel(n,o),o>=0?i=n.src.slice(l,o++):o=p+1):o=p+1,i||(i=n.src.slice(f,p)),s=n.env.references[s7(i)],!s)return n.pos=d,!1;u=s.href,c=s.title}if(!e){r=n.src.slice(f,p);const g=[];n.md.inline.parse(r,n.md,n.env,g);const m=n.push("image","img",0),v=[["src",u],["alt",""]];m.attrs=v,m.children=g,m.content=r,c&&v.push(["title",c])}return n.pos=o,n.posMax=h,!0}const ort=/^([a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*)$/,srt=/^([a-zA-Z][a-zA-Z0-9+.-]{1,31}):([^<>\x00-\x20]*)$/;function art(n,e){let t=n.pos;if(n.src.charCodeAt(t)!==60)return!1;const r=n.pos,i=n.posMax;for(;;){if(++t>=i)return!1;const s=n.src.charCodeAt(t);if(s===60)return!1;if(s===62)break}const o=n.src.slice(r+1,t);if(srt.test(o)){const s=n.md.normalizeLink(o);if(!n.md.validateLink(s))return!1;if(!e){const a=n.push("link_open","a",1);a.attrs=[["href",s]],a.markup="autolink",a.info="auto";const c=n.push("text","",0);c.content=n.md.normalizeLinkText(o);const l=n.push("link_close","a",-1);l.markup="autolink",l.info="auto"}return n.pos+=o.length+2,!0}if(ort.test(o)){const s=n.md.normalizeLink("mailto:"+o);if(!n.md.validateLink(s))return!1;if(!e){const a=n.push("link_open","a",1);a.attrs=[["href",s]],a.markup="autolink",a.info="auto";const c=n.push("text","",0);c.content=n.md.normalizeLinkText(o);const l=n.push("link_close","a",-1);l.markup="autolink",l.info="auto"}return n.pos+=o.length+2,!0}return!1}function crt(n){return/^<a[>\s]/i.test(n)}function lrt(n){return/^<\/a\s*>/i.test(n)}function urt(n){const e=n|32;return e>=97&&e<=122}function drt(n,e){if(!n.md.options.html)return!1;const t=n.posMax,r=n.pos;if(n.src.charCodeAt(r)!==60||r+2>=t)return!1;const i=n.src.charCodeAt(r+1);if(i!==33&&i!==63&&i!==47&&!urt(i))return!1;const o=n.src.slice(r).match(Bnt);if(!o)return!1;if(!e){const s=n.push("html_inline","",0);s.content=o[0],crt(s.content)&&n.linkLevel++,lrt(s.content)&&n.linkLevel--}return n.pos+=o[0].length,!0}const hrt=/^&#((?:x[a-f0-9]{1,6}|[0-9]{1,7}));/i,frt=/^&([a-z][a-z0-9]{1,31});/i;function prt(n,e){const t=n.pos,r=n.posMax;if(n.src.charCodeAt(t)!==38||t+1>=r)return!1;if(n.src.charCodeAt(t+1)===35){const o=n.src.slice(t).match(hrt);if(o){if(!e){const s=o[1][0].toLowerCase()==="x"?parseInt(o[1].slice(1),16):parseInt(o[1],10),a=n.push("text_special","",0);a.content=Vee(s)?BM(s):BM(65533),a.markup=o[0],a.info="entity"}return n.pos+=o[0].length,!0}}else{const o=n.src.slice(t).match(frt);if(o){const s=OEe(o[0]);if(s!==o[0]){if(!e){const a=n.push("text_special","",0);a.content=s,a.markup=o[0],a.info="entity"}return n.pos+=o[0].length,!0}}}return!1}function Zle(n){const e={},t=n.length;if(!t)return;let r=0,i=-2;const o=[];for(let s=0;s<t;s++){const a=n[s];if(o.push(0),(n[r].marker!==a.marker||i!==a.token-1)&&(r=s),i=a.token,a.length=a.length||0,!a.close)continue;e.hasOwnProperty(a.marker)||(e[a.marker]=[-1,-1,-1,-1,-1,-1]);const c=e[a.marker][(a.open?3:0)+a.length%3];let l=r-o[r]-1,u=l;for(;l>c;l-=o[l]+1){const d=n[l];if(d.marker===a.marker&&d.open&&d.end<0){let h=!1;if((d.close||a.open)&&(d.length+a.length)%3===0&&(d.length%3!==0||a.length%3!==0)&&(h=!0),!h){const f=l>0&&!n[l-1].open?o[l-1]+1:0;o[s]=s-l+f,o[l]=f,a.open=!1,d.end=s,d.close=!1,u=-1,i=-2;break}}}u!==-1&&(e[a.marker][(a.open?3:0)+(a.length||0)%3]=u)}}function grt(n){const e=n.tokens_meta,t=n.tokens_meta.length;Zle(n.delimiters);for(let r=0;r<t;r++)e[r]&&e[r].delimiters&&Zle(e[r].delimiters)}function mrt(n){let e,t,r=0;const i=n.tokens,o=n.tokens.length;for(e=t=0;e<o;e++)i[e].nesting<0&&r--,i[e].level=r,i[e].nesting>0&&r++,i[e].type==="text"&&e+1<o&&i[e+1].type==="text"?i[e+1].content=i[e].content+i[e+1].content:(e!==t&&(i[t]=i[e]),t++);e!==t&&(i.length=t)}const Fj=[["text",Knt],["linkify",Znt],["newline",Xnt],["escape",Ynt],["backticks",Jnt],["strikethrough",BEe.tokenize],["emphasis",HEe.tokenize],["link",rrt],["image",irt],["autolink",art],["html_inline",drt],["entity",prt]],jj=[["balance_pairs",grt],["strikethrough",BEe.postProcess],["emphasis",HEe.postProcess],["fragments_join",mrt]];function XT(){this.ruler=new qu;for(let n=0;n<Fj.length;n++)this.ruler.push(Fj[n][0],Fj[n][1]);this.ruler2=new qu;for(let n=0;n<jj.length;n++)this.ruler2.push(jj[n][0],jj[n][1])}XT.prototype.skipToken=function(n){const e=n.pos,t=this.ruler.getRules(""),r=t.length,i=n.md.options.maxNesting,o=n.cache;if(typeof o[e]<"u"){n.pos=o[e];return}let s=!1;if(n.level<i){for(let a=0;a<r;a++)if(n.level++,s=t[a](n,!0),n.level--,s){if(e>=n.pos)throw new Error("inline rule didn't increment state.pos");break}}else n.pos=n.posMax;s||n.pos++,o[e]=n.pos};XT.prototype.tokenize=function(n){const e=this.ruler.getRules(""),t=e.length,r=n.posMax,i=n.md.options.maxNesting;for(;n.pos<r;){const o=n.pos;let s=!1;if(n.level<i){for(let a=0;a<t;a++)if(s=e[a](n,!1),s){if(o>=n.pos)throw new Error("inline rule didn't increment state.pos");break}}if(s){if(n.pos>=r)break;continue}n.pending+=n.src[n.pos++]}n.pending&&n.pushPending()};XT.prototype.parse=function(n,e,t,r){const i=new this.State(n,e,t,r);this.tokenize(i);const o=this.ruler2.getRules(""),s=o.length;for(let a=0;a<s;a++)o[a](i)};XT.prototype.State=ZT;function vrt(n){const e={};n=n||{},e.src_Any=kEe.source,e.src_Cc=TEe.source,e.src_Z=REe.source,e.src_P=Uee.source,e.src_ZPCc=[e.src_Z,e.src_P,e.src_Cc].join("|"),e.src_ZCc=[e.src_Z,e.src_Cc].join("|");const t="[><｜]";return e.src_pseudo_letter="(?:(?!"+t+"|"+e.src_ZPCc+")"+e.src_Any+")",e.src_ip4="(?:(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)",e.src_auth="(?:(?:(?!"+e.src_ZCc+"|[@/\\[\\]()]).)+@)?",e.src_port="(?::(?:6(?:[0-4]\\d{3}|5(?:[0-4]\\d{2}|5(?:[0-2]\\d|3[0-5])))|[1-5]?\\d{1,4}))?",e.src_host_terminator="(?=$|"+t+"|"+e.src_ZPCc+")(?!"+(n["---"]?"-(?!--)|":"-|")+"_|:\\d|\\.-|\\.(?!$|"+e.src_ZPCc+"))",e.src_path="(?:[/?#](?:(?!"+e.src_ZCc+"|"+t+`|[()[\\]{}.,"'?!\\-;]).|\\[(?:(?!`+e.src_ZCc+"|\\]).)*\\]|\\((?:(?!"+e.src_ZCc+"|[)]).)*\\)|\\{(?:(?!"+e.src_ZCc+'|[}]).)*\\}|\\"(?:(?!'+e.src_ZCc+`|["]).)+\\"|\\'(?:(?!`+e.src_ZCc+"|[']).)+\\'|\\'(?="+e.src_pseudo_letter+"|[-])|\\.{2,}[a-zA-Z0-9%/&]|\\.(?!"+e.src_ZCc+"|[.]|$)|"+(n["---"]?"\\-(?!--(?:[^-]|$))(?:-*)|":"\\-+|")+",(?!"+e.src_ZCc+"|$)|;(?!"+e.src_ZCc+"|$)|\\!+(?!"+e.src_ZCc+"|[!]|$)|\\?(?!"+e.src_ZCc+"|[?]|$))+|\\/)?",e.src_email_name='[\\-;:&=\\+\\$,\\.a-zA-Z0-9_][\\-;:&=\\+\\$,\\"\\.a-zA-Z0-9_]*',e.src_xn="xn--[a-z0-9\\-]{1,59}",e.src_domain_root="(?:"+e.src_xn+"|"+e.src_pseudo_letter+"{1,63})",e.src_domain="(?:"+e.src_xn+"|(?:"+e.src_pseudo_letter+")|(?:"+e.src_pseudo_letter+"(?:-|"+e.src_pseudo_letter+"){0,61}"+e.src_pseudo_letter+"))",e.src_host="(?:(?:(?:(?:"+e.src_domain+")\\.)*"+e.src_domain+"))",e.tpl_host_fuzzy="(?:"+e.src_ip4+"|(?:(?:(?:"+e.src_domain+")\\.)+(?:%TLDS%)))",e.tpl_host_no_ip_fuzzy="(?:(?:(?:"+e.src_domain+")\\.)+(?:%TLDS%))",e.src_host_strict=e.src_host+e.src_host_terminator,e.tpl_host_fuzzy_strict=e.tpl_host_fuzzy+e.src_host_terminator,e.src_host_port_strict=e.src_host+e.src_port+e.src_host_terminator,e.tpl_host_port_fuzzy_strict=e.tpl_host_fuzzy+e.src_port+e.src_host_terminator,e.tpl_host_port_no_ip_fuzzy_strict=e.tpl_host_no_ip_fuzzy+e.src_port+e.src_host_terminator,e.tpl_host_fuzzy_test="localhost|www\\.|\\.\\d{1,3}\\.|(?:\\.(?:%TLDS%)(?:"+e.src_ZPCc+"|>|$))",e.tpl_email_fuzzy="(^|"+t+'|"|\\(|'+e.src_ZCc+")("+e.src_email_name+"@"+e.tpl_host_fuzzy_strict+")",e.tpl_link_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|｜]|"+e.src_ZPCc+"))((?![$+<=>^`|｜])"+e.tpl_host_port_fuzzy_strict+e.src_path+")",e.tpl_link_no_ip_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|｜]|"+e.src_ZPCc+"))((?![$+<=>^`|｜])"+e.tpl_host_port_no_ip_fuzzy_strict+e.src_path+")",e}function YW(n){return Array.prototype.slice.call(arguments,1).forEach(function(t){t&&Object.keys(t).forEach(function(r){n[r]=t[r]})}),n}function c7(n){return Object.prototype.toString.call(n)}function yrt(n){return c7(n)==="[object String]"}function brt(n){return c7(n)==="[object Object]"}function Srt(n){return c7(n)==="[object RegExp]"}function Xle(n){return c7(n)==="[object Function]"}function _rt(n){return n.replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}const UEe={fuzzyLink:!0,fuzzyEmail:!0,fuzzyIP:!1};function wrt(n){return Object.keys(n||{}).reduce(function(e,t){return e||UEe.hasOwnProperty(t)},!1)}const Crt={"http:":{validate:function(n,e,t){const r=n.slice(e);return t.re.http||(t.re.http=new RegExp("^\\/\\/"+t.re.src_auth+t.re.src_host_port_strict+t.re.src_path,"i")),t.re.http.test(r)?r.match(t.re.http)[0].length:0}},"https:":"http:","ftp:":"http:","//":{validate:function(n,e,t){const r=n.slice(e);return t.re.no_http||(t.re.no_http=new RegExp("^"+t.re.src_auth+"(?:localhost|(?:(?:"+t.re.src_domain+")\\.)+"+t.re.src_domain_root+")"+t.re.src_port+t.re.src_host_terminator+t.re.src_path,"i")),t.re.no_http.test(r)?e>=3&&n[e-3]===":"||e>=3&&n[e-3]==="/"?0:r.match(t.re.no_http)[0].length:0}},"mailto:":{validate:function(n,e,t){const r=n.slice(e);return t.re.mailto||(t.re.mailto=new RegExp("^"+t.re.src_email_name+"@"+t.re.src_host_strict,"i")),t.re.mailto.test(r)?r.match(t.re.mailto)[0].length:0}}},xrt="a[cdefgilmnoqrstuwxz]|b[abdefghijmnorstvwyz]|c[acdfghiklmnoruvwxyz]|d[ejkmoz]|e[cegrstu]|f[ijkmor]|g[abdefghilmnpqrstuwy]|h[kmnrtu]|i[delmnoqrst]|j[emop]|k[eghimnprwyz]|l[abcikrstuvy]|m[acdeghklmnopqrstuvwxyz]|n[acefgilopruz]|om|p[aefghklmnrstwy]|qa|r[eosuw]|s[abcdeghijklmnortuvxyz]|t[cdfghjklmnortvwz]|u[agksyz]|v[aceginu]|w[fs]|y[et]|z[amw]",Ert="biz|com|edu|gov|net|org|pro|web|xxx|aero|asia|coop|info|museum|name|shop|рф".split("|");function Irt(n){n.__index__=-1,n.__text_cache__=""}function Prt(n){return function(e,t){const r=e.slice(t);return n.test(r)?r.match(n)[0].length:0}}function Yle(){return function(n,e){e.normalize(n)}}function HM(n){const e=n.re=vrt(n.__opts__),t=n.__tlds__.slice();n.onCompile(),n.__tlds_replaced__||t.push(xrt),t.push(e.src_xn),e.src_tlds=t.join("|");function r(a){return a.replace("%TLDS%",e.src_tlds)}e.email_fuzzy=RegExp(r(e.tpl_email_fuzzy),"i"),e.link_fuzzy=RegExp(r(e.tpl_link_fuzzy),"i"),e.link_no_ip_fuzzy=RegExp(r(e.tpl_link_no_ip_fuzzy),"i"),e.host_fuzzy_test=RegExp(r(e.tpl_host_fuzzy_test),"i");const i=[];n.__compiled__={};function o(a,c){throw new Error('(LinkifyIt) Invalid schema "'+a+'": '+c)}Object.keys(n.__schemas__).forEach(function(a){const c=n.__schemas__[a];if(c===null)return;const l={validate:null,link:null};if(n.__compiled__[a]=l,brt(c)){Srt(c.validate)?l.validate=Prt(c.validate):Xle(c.validate)?l.validate=c.validate:o(a,c),Xle(c.normalize)?l.normalize=c.normalize:c.normalize?o(a,c):l.normalize=Yle();return}if(yrt(c)){i.push(a);return}o(a,c)}),i.forEach(function(a){n.__compiled__[n.__schemas__[a]]&&(n.__compiled__[a].validate=n.__compiled__[n.__schemas__[a]].validate,n.__compiled__[a].normalize=n.__compiled__[n.__schemas__[a]].normalize)}),n.__compiled__[""]={validate:null,normalize:Yle()};const s=Object.keys(n.__compiled__).filter(function(a){return a.length>0&&n.__compiled__[a]}).map(_rt).join("|");n.re.schema_test=RegExp("(^|(?!_)(?:[><｜]|"+e.src_ZPCc+"))("+s+")","i"),n.re.schema_search=RegExp("(^|(?!_)(?:[><｜]|"+e.src_ZPCc+"))("+s+")","ig"),n.re.schema_at_start=RegExp("^"+n.re.schema_search.source,"i"),n.re.pretest=RegExp("("+n.re.schema_test.source+")|("+n.re.host_fuzzy_test.source+")|@","i"),Irt(n)}function krt(n,e){const t=n.__index__,r=n.__last_index__,i=n.__text_cache__.slice(t,r);this.schema=n.__schema__.toLowerCase(),this.index=t+e,this.lastIndex=r+e,this.raw=i,this.text=i,this.url=i}function JW(n,e){const t=new krt(n,e);return n.__compiled__[t.schema].normalize(t,n),t}function Ud(n,e){if(!(this instanceof Ud))return new Ud(n,e);e||wrt(n)&&(e=n,n={}),this.__opts__=YW({},UEe,e),this.__index__=-1,this.__last_index__=-1,this.__schema__="",this.__text_cache__="",this.__schemas__=YW({},Crt,n),this.__compiled__={},this.__tlds__=Ert,this.__tlds_replaced__=!1,this.re={},HM(this)}Ud.prototype.add=function(e,t){return this.__schemas__[e]=t,HM(this),this};Ud.prototype.set=function(e){return this.__opts__=YW(this.__opts__,e),this};Ud.prototype.test=function(e){if(this.__text_cache__=e,this.__index__=-1,!e.length)return!1;let t,r,i,o,s,a,c,l,u;if(this.re.schema_test.test(e)){for(c=this.re.schema_search,c.lastIndex=0;(t=c.exec(e))!==null;)if(o=this.testSchemaAt(e,t[2],c.lastIndex),o){this.__schema__=t[2],this.__index__=t.index+t[1].length,this.__last_index__=t.index+t[0].length+o;break}}return this.__opts__.fuzzyLink&&this.__compiled__["http:"]&&(l=e.search(this.re.host_fuzzy_test),l>=0&&(this.__index__<0||l<this.__index__)&&(r=e.match(this.__opts__.fuzzyIP?this.re.link_fuzzy:this.re.link_no_ip_fuzzy))!==null&&(s=r.index+r[1].length,(this.__index__<0||s<this.__index__)&&(this.__schema__="",this.__index__=s,this.__last_index__=r.index+r[0].length))),this.__opts__.fuzzyEmail&&this.__compiled__["mailto:"]&&(u=e.indexOf("@"),u>=0&&(i=e.match(this.re.email_fuzzy))!==null&&(s=i.index+i[1].length,a=i.index+i[0].length,(this.__index__<0||s<this.__index__||s===this.__index__&&a>this.__last_index__)&&(this.__schema__="mailto:",this.__index__=s,this.__last_index__=a))),this.__index__>=0};Ud.prototype.pretest=function(e){return this.re.pretest.test(e)};Ud.prototype.testSchemaAt=function(e,t,r){return this.__compiled__[t.toLowerCase()]?this.__compiled__[t.toLowerCase()].validate(e,r,this):0};Ud.prototype.match=function(e){const t=[];let r=0;this.__index__>=0&&this.__text_cache__===e&&(t.push(JW(this,r)),r=this.__last_index__);let i=r?e.slice(r):e;for(;this.test(i);)t.push(JW(this,r)),i=i.slice(this.__last_index__),r+=this.__last_index__;return t.length?t:null};Ud.prototype.matchAtStart=function(e){if(this.__text_cache__=e,this.__index__=-1,!e.length)return null;const t=this.re.schema_at_start.exec(e);if(!t)return null;const r=this.testSchemaAt(e,t[2],t[0].length);return r?(this.__schema__=t[2],this.__index__=t.index+t[1].length,this.__last_index__=t.index+t[0].length+r,JW(this,0)):null};Ud.prototype.tlds=function(e,t){return e=Array.isArray(e)?e:[e],t?(this.__tlds__=this.__tlds__.concat(e).sort().filter(function(r,i,o){return r!==o[i-1]}).reverse(),HM(this),this):(this.__tlds__=e.slice(),this.__tlds_replaced__=!0,HM(this),this)};Ud.prototype.normalize=function(e){e.schema||(e.url="http://"+e.url),e.schema==="mailto:"&&!/^mailto:/i.test(e.url)&&(e.url="mailto:"+e.url)};Ud.prototype.onCompile=function(){};const PC=2147483647,Vp=36,Kee=1,Fk=26,Trt=38,Drt=700,zEe=72,VEe=128,WEe="-",Rrt=/^xn--/,Art=/[^\0-\x7F]/,Ort=/[\x2E\u3002\uFF0E\uFF61]/g,Mrt={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},Bj=Vp-Kee,Wp=Math.floor,Hj=String.fromCharCode;function c0(n){throw new RangeError(Mrt[n])}function $rt(n,e){const t=[];let r=n.length;for(;r--;)t[r]=e(n[r]);return t}function qEe(n,e){const t=n.split("@");let r="";t.length>1&&(r=t[0]+"@",n=t[1]),n=n.replace(Ort,".");const i=n.split("."),o=$rt(i,e).join(".");return r+o}function KEe(n){const e=[];let t=0;const r=n.length;for(;t<r;){const i=n.charCodeAt(t++);if(i>=55296&&i<=56319&&t<r){const o=n.charCodeAt(t++);(o&64512)==56320?e.push(((i&1023)<<10)+(o&1023)+65536):(e.push(i),t--)}else e.push(i)}return e}const Lrt=n=>String.fromCodePoint(...n),Nrt=function(n){return n>=48&&n<58?26+(n-48):n>=65&&n<91?n-65:n>=97&&n<123?n-97:Vp},Jle=function(n,e){return n+22+75*(n<26)-((e!=0)<<5)},GEe=function(n,e,t){let r=0;for(n=t?Wp(n/Drt):n>>1,n+=Wp(n/e);n>Bj*Fk>>1;r+=Vp)n=Wp(n/Bj);return Wp(r+(Bj+1)*n/(n+Trt))},ZEe=function(n){const e=[],t=n.length;let r=0,i=VEe,o=zEe,s=n.lastIndexOf(WEe);s<0&&(s=0);for(let a=0;a<s;++a)n.charCodeAt(a)>=128&&c0("not-basic"),e.push(n.charCodeAt(a));for(let a=s>0?s+1:0;a<t;){const c=r;for(let u=1,d=Vp;;d+=Vp){a>=t&&c0("invalid-input");const h=Nrt(n.charCodeAt(a++));h>=Vp&&c0("invalid-input"),h>Wp((PC-r)/u)&&c0("overflow"),r+=h*u;const f=d<=o?Kee:d>=o+Fk?Fk:d-o;if(h<f)break;const p=Vp-f;u>Wp(PC/p)&&c0("overflow"),u*=p}const l=e.length+1;o=GEe(r-c,l,c==0),Wp(r/l)>PC-i&&c0("overflow"),i+=Wp(r/l),r%=l,e.splice(r++,0,i)}return String.fromCodePoint(...e)},XEe=function(n){const e=[];n=KEe(n);const t=n.length;let r=VEe,i=0,o=zEe;for(const c of n)c<128&&e.push(Hj(c));const s=e.length;let a=s;for(s&&e.push(WEe);a<t;){let c=PC;for(const u of n)u>=r&&u<c&&(c=u);const l=a+1;c-r>Wp((PC-i)/l)&&c0("overflow"),i+=(c-r)*l,r=c;for(const u of n)if(u<r&&++i>PC&&c0("overflow"),u===r){let d=i;for(let h=Vp;;h+=Vp){const f=h<=o?Kee:h>=o+Fk?Fk:h-o;if(d<f)break;const p=d-f,g=Vp-f;e.push(Hj(Jle(f+p%g,0))),d=Wp(p/g)}e.push(Hj(Jle(d,0))),o=GEe(i,l,a===s),i=0,++a}++i,++r}return e.join("")},Frt=function(n){return qEe(n,function(e){return Rrt.test(e)?ZEe(e.slice(4).toLowerCase()):e})},jrt=function(n){return qEe(n,function(e){return Art.test(e)?"xn--"+XEe(e):e})},YEe={version:"2.3.1",ucs2:{decode:KEe,encode:Lrt},decode:ZEe,encode:XEe,toASCII:jrt,toUnicode:Frt},Brt={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"“”‘’",highlight:null,maxNesting:100},components:{core:{},block:{},inline:{}}},Hrt={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"“”‘’",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["paragraph"]},inline:{rules:["text"],rules2:["balance_pairs","fragments_join"]}}},Urt={options:{html:!0,xhtmlOut:!0,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"“”‘’",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["blockquote","code","fence","heading","hr","html_block","lheading","list","reference","paragraph"]},inline:{rules:["autolink","backticks","emphasis","entity","escape","html_inline","image","link","newline","text"],rules2:["balance_pairs","emphasis","fragments_join"]}}},zrt={default:Brt,zero:Hrt,commonmark:Urt},Vrt=/^(vbscript|javascript|file|data):/,Wrt=/^data:image\/(gif|png|jpeg|webp);/;function qrt(n){const e=n.trim().toLowerCase();return Vrt.test(e)?Wrt.test(e):!0}const JEe=["http:","https:","mailto:"];function Krt(n){const e=Hee(n,!0);if(e.hostname&&(!e.protocol||JEe.indexOf(e.protocol)>=0))try{e.hostname=YEe.toASCII(e.hostname)}catch{}return GT(Bee(e))}function Grt(n){const e=Hee(n,!0);if(e.hostname&&(!e.protocol||JEe.indexOf(e.protocol)>=0))try{e.hostname=YEe.toUnicode(e.hostname)}catch{}return D2(Bee(e),D2.defaultChars+"%")}function Bh(n,e){if(!(this instanceof Bh))return new Bh(n,e);e||zee(n)||(e=n||{},n="default"),this.inline=new XT,this.block=new a7,this.core=new Wee,this.renderer=new Jx,this.linkify=new Ud,this.validateLink=qrt,this.normalizeLink=Krt,this.normalizeLinkText=Grt,this.utils=Xtt,this.helpers=o7({},ent),this.options={},this.configure(n),e&&this.set(e)}Bh.prototype.set=function(n){return o7(this.options,n),this};Bh.prototype.configure=function(n){const e=this;if(zee(n)){const t=n;if(n=zrt[t],!n)throw new Error('Wrong `markdown-it` preset "'+t+'", check name')}if(!n)throw new Error("Wrong `markdown-it` preset, can't be empty");return n.options&&e.set(n.options),n.components&&Object.keys(n.components).forEach(function(t){n.components[t].rules&&e[t].ruler.enableOnly(n.components[t].rules),n.components[t].rules2&&e[t].ruler2.enableOnly(n.components[t].rules2)}),this};Bh.prototype.enable=function(n,e){let t=[];Array.isArray(n)||(n=[n]),["core","block","inline"].forEach(function(i){t=t.concat(this[i].ruler.enable(n,!0))},this),t=t.concat(this.inline.ruler2.enable(n,!0));const r=n.filter(function(i){return t.indexOf(i)<0});if(r.length&&!e)throw new Error("MarkdownIt. Failed to enable unknown rule(s): "+r);return this};Bh.prototype.disable=function(n,e){let t=[];Array.isArray(n)||(n=[n]),["core","block","inline"].forEach(function(i){t=t.concat(this[i].ruler.disable(n,!0))},this),t=t.concat(this.inline.ruler2.disable(n,!0));const r=n.filter(function(i){return t.indexOf(i)<0});if(r.length&&!e)throw new Error("MarkdownIt. Failed to disable unknown rule(s): "+r);return this};Bh.prototype.use=function(n){const e=[this].concat(Array.prototype.slice.call(arguments,1));return n.apply(n,e),this};Bh.prototype.parse=function(n,e){if(typeof n!="string")throw new Error("Input data should be a String");const t=new this.core.State(n,this,e);return this.core.process(t),t.tokens};Bh.prototype.render=function(n,e){return e=e||{},this.renderer.render(this.parse(n,e),this.options,e)};Bh.prototype.parseInline=function(n,e){const t=new this.core.State(n,this,e);return t.inlineMode=!0,this.core.process(t),t.tokens};Bh.prototype.renderInline=function(n,e){return e=e||{},this.renderer.render(this.parseInline(n,e),this.options,e)};function QEe(n){return n instanceof Map?n.clear=n.delete=n.set=function(){throw new Error("map is read-only")}:n instanceof Set&&(n.add=n.clear=n.delete=function(){throw new Error("set is read-only")}),Object.freeze(n),Object.getOwnPropertyNames(n).forEach(e=>{const t=n[e],r=typeof t;(r==="object"||r==="function")&&!Object.isFrozen(t)&&QEe(t)}),n}let Qle=class{constructor(e){e.data===void 0&&(e.data={}),this.data=e.data,this.isMatchIgnored=!1}ignoreMatch(){this.isMatchIgnored=!0}};function eIe(n){return n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;")}function O0(n,...e){const t=Object.create(null);for(const r in n)t[r]=n[r];return e.forEach(function(r){for(const i in r)t[i]=r[i]}),t}const Zrt="</span>",eue=n=>!!n.scope,Xrt=(n,{prefix:e})=>{if(n.startsWith("language:"))return n.replace("language:","language-");if(n.includes(".")){const t=n.split(".");return[`${e}${t.shift()}`,...t.map((r,i)=>`${r}${"_".repeat(i+1)}`)].join(" ")}return`${e}${n}`};class Yrt{constructor(e,t){this.buffer="",this.classPrefix=t.classPrefix,e.walk(this)}addText(e){this.buffer+=eIe(e)}openNode(e){if(!eue(e))return;const t=Xrt(e.scope,{prefix:this.classPrefix});this.span(t)}closeNode(e){eue(e)&&(this.buffer+=Zrt)}value(){return this.buffer}span(e){this.buffer+=`<span class="${e}">`}}const tue=(n={})=>{const e={children:[]};return Object.assign(e,n),e};class Gee{constructor(){this.rootNode=tue(),this.stack=[this.rootNode]}get top(){return this.stack[this.stack.length-1]}get root(){return this.rootNode}add(e){this.top.children.push(e)}openNode(e){const t=tue({scope:e});this.add(t),this.stack.push(t)}closeNode(){if(this.stack.length>1)return this.stack.pop()}closeAllNodes(){for(;this.closeNode(););}toJSON(){return JSON.stringify(this.rootNode,null,4)}walk(e){return this.constructor._walk(e,this.rootNode)}static _walk(e,t){return typeof t=="string"?e.addText(t):t.children&&(e.openNode(t),t.children.forEach(r=>this._walk(e,r)),e.closeNode(t)),e}static _collapse(e){typeof e!="string"&&e.children&&(e.children.every(t=>typeof t=="string")?e.children=[e.children.join("")]:e.children.forEach(t=>{Gee._collapse(t)}))}}class Jrt extends Gee{constructor(e){super(),this.options=e}addText(e){e!==""&&this.add(e)}startScope(e){this.openNode(e)}endScope(){this.closeNode()}__addSublanguage(e,t){const r=e.root;t&&(r.scope=`language:${t}`),this.add(r)}toHTML(){return new Yrt(this,this.options).value()}finalize(){return this.closeAllNodes(),!0}}function jk(n){return n?typeof n=="string"?n:n.source:null}function tIe(n){return a_("(?=",n,")")}function Qrt(n){return a_("(?:",n,")*")}function eit(n){return a_("(?:",n,")?")}function a_(...n){return n.map(t=>jk(t)).join("")}function tit(n){const e=n[n.length-1];return typeof e=="object"&&e.constructor===Object?(n.splice(n.length-1,1),e):{}}function Zee(...n){return"("+(tit(n).capture?"":"?:")+n.map(r=>jk(r)).join("|")+")"}function nIe(n){return new RegExp(n.toString()+"|").exec("").length-1}function nit(n,e){const t=n&&n.exec(e);return t&&t.index===0}const rit=/\[(?:[^\\\]]|\\.)*\]|\(\??|\\([1-9][0-9]*)|\\./;function Xee(n,{joinWith:e}){let t=0;return n.map(r=>{t+=1;const i=t;let o=jk(r),s="";for(;o.length>0;){const a=rit.exec(o);if(!a){s+=o;break}s+=o.substring(0,a.index),o=o.substring(a.index+a[0].length),a[0][0]==="\\"&&a[1]?s+="\\"+String(Number(a[1])+i):(s+=a[0],a[0]==="("&&t++)}return s}).map(r=>`(${r})`).join(e)}const iit=/\b\B/,rIe="[a-zA-Z]\\w*",Yee="[a-zA-Z_]\\w*",iIe="\\b\\d+(\\.\\d+)?",oIe="(-?)(\\b0[xX][a-fA-F0-9]+|(\\b\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)",sIe="\\b(0b[01]+)",oit="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|-|-=|/=|/|:|;|<<|<<=|<=|<|===|==|=|>>>=|>>=|>=|>>>|>>|>|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~",sit=(n={})=>{const e=/^#![ ]*\//;return n.binary&&(n.begin=a_(e,/.*\b/,n.binary,/\b.*/)),O0({scope:"meta",begin:e,end:/$/,relevance:0,"on:begin":(t,r)=>{t.index!==0&&r.ignoreMatch()}},n)},Bk={begin:"\\\\[\\s\\S]",relevance:0},ait={scope:"string",begin:"'",end:"'",illegal:"\\n",contains:[Bk]},cit={scope:"string",begin:'"',end:'"',illegal:"\\n",contains:[Bk]},lit={begin:/\b(a|an|the|are|I'm|isn't|don't|doesn't|won't|but|just|should|pretty|simply|enough|gonna|going|wtf|so|such|will|you|your|they|like|more)\b/},l7=function(n,e,t={}){const r=O0({scope:"comment",begin:n,end:e,contains:[]},t);r.contains.push({scope:"doctag",begin:"[ ]*(?=(TODO|FIXME|NOTE|BUG|OPTIMIZE|HACK|XXX):)",end:/(TODO|FIXME|NOTE|BUG|OPTIMIZE|HACK|XXX):/,excludeBegin:!0,relevance:0});const i=Zee("I","a","is","so","us","to","at","if","in","it","on",/[A-Za-z]+['](d|ve|re|ll|t|s|n)/,/[A-Za-z]+[-][a-z]+/,/[A-Za-z][a-z]{2,}/);return r.contains.push({begin:a_(/[ ]+/,"(",i,/[.]?[:]?([.][ ]|[ ])/,"){3}")}),r},uit=l7("//","$"),dit=l7("/\\*","\\*/"),hit=l7("#","$"),fit={scope:"number",begin:iIe,relevance:0},pit={scope:"number",begin:oIe,relevance:0},git={scope:"number",begin:sIe,relevance:0},mit={scope:"regexp",begin:/\/(?=[^/\n]*\/)/,end:/\/[gimuy]*/,contains:[Bk,{begin:/\[/,end:/\]/,relevance:0,contains:[Bk]}]},vit={scope:"title",begin:rIe,relevance:0},yit={scope:"title",begin:Yee,relevance:0},bit={begin:"\\.\\s*"+Yee,relevance:0},Sit=function(n){return Object.assign(n,{"on:begin":(e,t)=>{t.data._beginMatch=e[1]},"on:end":(e,t)=>{t.data._beginMatch!==e[1]&&t.ignoreMatch()}})};var YR=Object.freeze({__proto__:null,APOS_STRING_MODE:ait,BACKSLASH_ESCAPE:Bk,BINARY_NUMBER_MODE:git,BINARY_NUMBER_RE:sIe,COMMENT:l7,C_BLOCK_COMMENT_MODE:dit,C_LINE_COMMENT_MODE:uit,C_NUMBER_MODE:pit,C_NUMBER_RE:oIe,END_SAME_AS_BEGIN:Sit,HASH_COMMENT_MODE:hit,IDENT_RE:rIe,MATCH_NOTHING_RE:iit,METHOD_GUARD:bit,NUMBER_MODE:fit,NUMBER_RE:iIe,PHRASAL_WORDS_MODE:lit,QUOTE_STRING_MODE:cit,REGEXP_MODE:mit,RE_STARTERS_RE:oit,SHEBANG:sit,TITLE_MODE:vit,UNDERSCORE_IDENT_RE:Yee,UNDERSCORE_TITLE_MODE:yit});function _it(n,e){n.input[n.index-1]==="."&&e.ignoreMatch()}function wit(n,e){n.className!==void 0&&(n.scope=n.className,delete n.className)}function Cit(n,e){e&&n.beginKeywords&&(n.begin="\\b("+n.beginKeywords.split(" ").join("|")+")(?!\\.)(?=\\b|\\s)",n.__beforeBegin=_it,n.keywords=n.keywords||n.beginKeywords,delete n.beginKeywords,n.relevance===void 0&&(n.relevance=0))}function xit(n,e){Array.isArray(n.illegal)&&(n.illegal=Zee(...n.illegal))}function Eit(n,e){if(n.match){if(n.begin||n.end)throw new Error("begin & end are not supported with match");n.begin=n.match,delete n.match}}function Iit(n,e){n.relevance===void 0&&(n.relevance=1)}const Pit=(n,e)=>{if(!n.beforeMatch)return;if(n.starts)throw new Error("beforeMatch cannot be used with starts");const t=Object.assign({},n);Object.keys(n).forEach(r=>{delete n[r]}),n.keywords=t.keywords,n.begin=a_(t.beforeMatch,tIe(t.begin)),n.starts={relevance:0,contains:[Object.assign(t,{endsParent:!0})]},n.relevance=0,delete t.beforeMatch},kit=["of","and","for","in","not","or","if","then","parent","list","value"],Tit="keyword";function aIe(n,e,t=Tit){const r=Object.create(null);return typeof n=="string"?i(t,n.split(" ")):Array.isArray(n)?i(t,n):Object.keys(n).forEach(function(o){Object.assign(r,aIe(n[o],e,o))}),r;function i(o,s){e&&(s=s.map(a=>a.toLowerCase())),s.forEach(function(a){const c=a.split("|");r[c[0]]=[o,Dit(c[0],c[1])]})}}function Dit(n,e){return e?Number(e):Rit(n)?0:1}function Rit(n){return kit.includes(n.toLowerCase())}const nue={},eS=n=>{console.error(n)},rue=(n,...e)=>{console.log(`WARN: ${n}`,...e)},F_=(n,e)=>{nue[`${n}/${e}`]||(console.log(`Deprecated as of ${n}. ${e}`),nue[`${n}/${e}`]=!0)},UM=new Error;function cIe(n,e,{key:t}){let r=0;const i=n[t],o={},s={};for(let a=1;a<=e.length;a++)s[a+r]=i[a],o[a+r]=!0,r+=nIe(e[a-1]);n[t]=s,n[t]._emit=o,n[t]._multi=!0}function Ait(n){if(Array.isArray(n.begin)){if(n.skip||n.excludeBegin||n.returnBegin)throw eS("skip, excludeBegin, returnBegin not compatible with beginScope: {}"),UM;if(typeof n.beginScope!="object"||n.beginScope===null)throw eS("beginScope must be object"),UM;cIe(n,n.begin,{key:"beginScope"}),n.begin=Xee(n.begin,{joinWith:""})}}function Oit(n){if(Array.isArray(n.end)){if(n.skip||n.excludeEnd||n.returnEnd)throw eS("skip, excludeEnd, returnEnd not compatible with endScope: {}"),UM;if(typeof n.endScope!="object"||n.endScope===null)throw eS("endScope must be object"),UM;cIe(n,n.end,{key:"endScope"}),n.end=Xee(n.end,{joinWith:""})}}function Mit(n){n.scope&&typeof n.scope=="object"&&n.scope!==null&&(n.beginScope=n.scope,delete n.scope)}function $it(n){Mit(n),typeof n.beginScope=="string"&&(n.beginScope={_wrap:n.beginScope}),typeof n.endScope=="string"&&(n.endScope={_wrap:n.endScope}),Ait(n),Oit(n)}function Lit(n){function e(s,a){return new RegExp(jk(s),"m"+(n.case_insensitive?"i":"")+(n.unicodeRegex?"u":"")+(a?"g":""))}class t{constructor(){this.matchIndexes={},this.regexes=[],this.matchAt=1,this.position=0}addRule(a,c){c.position=this.position++,this.matchIndexes[this.matchAt]=c,this.regexes.push([c,a]),this.matchAt+=nIe(a)+1}compile(){this.regexes.length===0&&(this.exec=()=>null);const a=this.regexes.map(c=>c[1]);this.matcherRe=e(Xee(a,{joinWith:"|"}),!0),this.lastIndex=0}exec(a){this.matcherRe.lastIndex=this.lastIndex;const c=this.matcherRe.exec(a);if(!c)return null;const l=c.findIndex((d,h)=>h>0&&d!==void 0),u=this.matchIndexes[l];return c.splice(0,l),Object.assign(c,u)}}class r{constructor(){this.rules=[],this.multiRegexes=[],this.count=0,this.lastIndex=0,this.regexIndex=0}getMatcher(a){if(this.multiRegexes[a])return this.multiRegexes[a];const c=new t;return this.rules.slice(a).forEach(([l,u])=>c.addRule(l,u)),c.compile(),this.multiRegexes[a]=c,c}resumingScanAtSamePosition(){return this.regexIndex!==0}considerAll(){this.regexIndex=0}addRule(a,c){this.rules.push([a,c]),c.type==="begin"&&this.count++}exec(a){const c=this.getMatcher(this.regexIndex);c.lastIndex=this.lastIndex;let l=c.exec(a);if(this.resumingScanAtSamePosition()&&!(l&&l.index===this.lastIndex)){const u=this.getMatcher(0);u.lastIndex=this.lastIndex+1,l=u.exec(a)}return l&&(this.regexIndex+=l.position+1,this.regexIndex===this.count&&this.considerAll()),l}}function i(s){const a=new r;return s.contains.forEach(c=>a.addRule(c.begin,{rule:c,type:"begin"})),s.terminatorEnd&&a.addRule(s.terminatorEnd,{type:"end"}),s.illegal&&a.addRule(s.illegal,{type:"illegal"}),a}function o(s,a){const c=s;if(s.isCompiled)return c;[wit,Eit,$it,Pit].forEach(u=>u(s,a)),n.compilerExtensions.forEach(u=>u(s,a)),s.__beforeBegin=null,[Cit,xit,Iit].forEach(u=>u(s,a)),s.isCompiled=!0;let l=null;return typeof s.keywords=="object"&&s.keywords.$pattern&&(s.keywords=Object.assign({},s.keywords),l=s.keywords.$pattern,delete s.keywords.$pattern),l=l||/\w+/,s.keywords&&(s.keywords=aIe(s.keywords,n.case_insensitive)),c.keywordPatternRe=e(l,!0),a&&(s.begin||(s.begin=/\B|\b/),c.beginRe=e(c.begin),!s.end&&!s.endsWithParent&&(s.end=/\B|\b/),s.end&&(c.endRe=e(c.end)),c.terminatorEnd=jk(c.end)||"",s.endsWithParent&&a.terminatorEnd&&(c.terminatorEnd+=(s.end?"|":"")+a.terminatorEnd)),s.illegal&&(c.illegalRe=e(s.illegal)),s.contains||(s.contains=[]),s.contains=[].concat(...s.contains.map(function(u){return Nit(u==="self"?s:u)})),s.contains.forEach(function(u){o(u,c)}),s.starts&&o(s.starts,a),c.matcher=i(c),c}if(n.compilerExtensions||(n.compilerExtensions=[]),n.contains&&n.contains.includes("self"))throw new Error("ERR: contains `self` is not supported at the top-level of a language.  See documentation.");return n.classNameAliases=O0(n.classNameAliases||{}),o(n)}function lIe(n){return n?n.endsWithParent||lIe(n.starts):!1}function Nit(n){return n.variants&&!n.cachedVariants&&(n.cachedVariants=n.variants.map(function(e){return O0(n,{variants:null},e)})),n.cachedVariants?n.cachedVariants:lIe(n)?O0(n,{starts:n.starts?O0(n.starts):null}):Object.isFrozen(n)?O0(n):n}var Fit="11.9.0";class jit extends Error{constructor(e,t){super(e),this.name="HTMLInjectionError",this.html=t}}const Uj=eIe,iue=O0,oue=Symbol("nomatch"),Bit=7,uIe=function(n){const e=Object.create(null),t=Object.create(null),r=[];let i=!0;const o="Could not find the language '{}', did you forget to load/include a language module?",s={disableAutodetect:!0,name:"Plain text",contains:[]};let a={ignoreUnescapedHTML:!1,throwUnescapedHTML:!1,noHighlightRe:/^(no-?highlight)$/i,languageDetectRe:/\blang(?:uage)?-([\w-]+)\b/i,classPrefix:"hljs-",cssSelector:"pre code",languages:null,__emitter:Jrt};function c(N){return a.noHighlightRe.test(N)}function l(N){let B=N.className+" ";B+=N.parentNode?N.parentNode.className:"";const U=a.languageDetectRe.exec(B);if(U){const K=D(U[1]);return K||(rue(o.replace("{}",U[1])),rue("Falling back to no-highlight mode for this block.",N)),K?U[1]:"no-highlight"}return B.split(/\s+/).find(K=>c(K)||D(K))}function u(N,B,U){let K="",z="";typeof B=="object"?(K=N,U=B.ignoreIllegals,z=B.language):(F_("10.7.0","highlight(lang, code, ...args) has been deprecated."),F_("10.7.0",`Please use highlight(code, options) instead.
https://github.com/highlightjs/highlight.js/issues/2277`),z=N,K=B),U===void 0&&(U=!0);const G={code:K,language:z};L("before:highlight",G);const te=G.result?G.result:d(G.language,G.code,U);return te.code=G.code,L("after:highlight",te),te}function d(N,B,U,K){const z=Object.create(null);function G(qe,Ge){return qe.keywords[Ge]}function te(){if(!ce.keywords){Ie.addText(be);return}let qe=0;ce.keywordPatternRe.lastIndex=0;let Ge=ce.keywordPatternRe.exec(be),St="";for(;Ge;){St+=be.substring(qe,Ge.index);const Pt=he.case_insensitive?Ge[0].toLowerCase():Ge[0],on=G(ce,Pt);if(on){const[an,Rt]=on;if(Ie.addText(St),St="",z[Pt]=(z[Pt]||0)+1,z[Pt]<=Bit&&(De+=Rt),an.startsWith("_"))St+=Ge[0];else{const Xt=he.classNameAliases[an]||an;ge(Ge[0],Xt)}}else St+=Ge[0];qe=ce.keywordPatternRe.lastIndex,Ge=ce.keywordPatternRe.exec(be)}St+=be.substring(qe),Ie.addText(St)}function ie(){if(be==="")return;let qe=null;if(typeof ce.subLanguage=="string"){if(!e[ce.subLanguage]){Ie.addText(be);return}qe=d(ce.subLanguage,be,!0,Ae[ce.subLanguage]),Ae[ce.subLanguage]=qe._top}else qe=f(be,ce.subLanguage.length?ce.subLanguage:null);ce.relevance>0&&(De+=qe.relevance),Ie.__addSublanguage(qe._emitter,qe.language)}function Q(){ce.subLanguage!=null?ie():te(),be=""}function ge(qe,Ge){qe!==""&&(Ie.startScope(Ge),Ie.addText(qe),Ie.endScope())}function _e(qe,Ge){let St=1;const Pt=Ge.length-1;for(;St<=Pt;){if(!qe._emit[St]){St++;continue}const on=he.classNameAliases[qe[St]]||qe[St],an=Ge[St];on?ge(an,on):(be=an,te(),be=""),St++}}function Se(qe,Ge){return qe.scope&&typeof qe.scope=="string"&&Ie.openNode(he.classNameAliases[qe.scope]||qe.scope),qe.beginScope&&(qe.beginScope._wrap?(ge(be,he.classNameAliases[qe.beginScope._wrap]||qe.beginScope._wrap),be=""):qe.beginScope._multi&&(_e(qe.beginScope,Ge),be="")),ce=Object.create(qe,{parent:{value:ce}}),ce}function se(qe,Ge,St){let Pt=nit(qe.endRe,St);if(Pt){if(qe["on:end"]){const on=new Qle(qe);qe["on:end"](Ge,on),on.isMatchIgnored&&(Pt=!1)}if(Pt){for(;qe.endsParent&&qe.parent;)qe=qe.parent;return qe}}if(qe.endsWithParent)return se(qe.parent,Ge,St)}function ee(qe){return ce.matcher.regexIndex===0?(be+=qe[0],1):(Je=!0,0)}function Y(qe){const Ge=qe[0],St=qe.rule,Pt=new Qle(St),on=[St.__beforeBegin,St["on:begin"]];for(const an of on)if(an&&(an(qe,Pt),Pt.isMatchIgnored))return ee(Ge);return St.skip?be+=Ge:(St.excludeBegin&&(be+=Ge),Q(),!St.returnBegin&&!St.excludeBegin&&(be=Ge)),Se(St,qe),St.returnBegin?0:Ge.length}function ue(qe){const Ge=qe[0],St=B.substring(qe.index),Pt=se(ce,qe,St);if(!Pt)return oue;const on=ce;ce.endScope&&ce.endScope._wrap?(Q(),ge(Ge,ce.endScope._wrap)):ce.endScope&&ce.endScope._multi?(Q(),_e(ce.endScope,qe)):on.skip?be+=Ge:(on.returnEnd||on.excludeEnd||(be+=Ge),Q(),on.excludeEnd&&(be=Ge));do ce.scope&&Ie.closeNode(),!ce.skip&&!ce.subLanguage&&(De+=ce.relevance),ce=ce.parent;while(ce!==Pt.parent);return Pt.starts&&Se(Pt.starts,qe),on.returnEnd?0:Ge.length}function ye(){const qe=[];for(let Ge=ce;Ge!==he;Ge=Ge.parent)Ge.scope&&qe.unshift(Ge.scope);qe.forEach(Ge=>Ie.openNode(Ge))}let V={};function le(qe,Ge){const St=Ge&&Ge[0];if(be+=qe,St==null)return Q(),0;if(V.type==="begin"&&Ge.type==="end"&&V.index===Ge.index&&St===""){if(be+=B.slice(Ge.index,Ge.index+1),!i){const Pt=new Error(`0 width match regex (${N})`);throw Pt.languageName=N,Pt.badRule=V.rule,Pt}return 1}if(V=Ge,Ge.type==="begin")return Y(Ge);if(Ge.type==="illegal"&&!U){const Pt=new Error('Illegal lexeme "'+St+'" for mode "'+(ce.scope||"<unnamed>")+'"');throw Pt.mode=ce,Pt}else if(Ge.type==="end"){const Pt=ue(Ge);if(Pt!==oue)return Pt}if(Ge.type==="illegal"&&St==="")return 1;if(He>1e5&&He>Ge.index*3)throw new Error("potential infinite loop, way more iterations than matches");return be+=St,St.length}const he=D(N);if(!he)throw eS(o.replace("{}",N)),new Error('Unknown language: "'+N+'"');const oe=Lit(he);let ne="",ce=K||oe;const Ae={},Ie=new a.__emitter(a);ye();let be="",De=0,Me=0,He=0,Je=!1;try{if(he.__emitTokens)he.__emitTokens(B,Ie);else{for(ce.matcher.considerAll();;){He++,Je?Je=!1:ce.matcher.considerAll(),ce.matcher.lastIndex=Me;const qe=ce.matcher.exec(B);if(!qe)break;const Ge=B.substring(Me,qe.index),St=le(Ge,qe);Me=qe.index+St}le(B.substring(Me))}return Ie.finalize(),ne=Ie.toHTML(),{language:N,value:ne,relevance:De,illegal:!1,_emitter:Ie,_top:ce}}catch(qe){if(qe.message&&qe.message.includes("Illegal"))return{language:N,value:Uj(B),illegal:!0,relevance:0,_illegalBy:{message:qe.message,index:Me,context:B.slice(Me-100,Me+100),mode:qe.mode,resultSoFar:ne},_emitter:Ie};if(i)return{language:N,value:Uj(B),illegal:!1,relevance:0,errorRaised:qe,_emitter:Ie,_top:ce};throw qe}}function h(N){const B={value:Uj(N),illegal:!1,relevance:0,_top:s,_emitter:new a.__emitter(a)};return B._emitter.addText(N),B}function f(N,B){B=B||a.languages||Object.keys(e);const U=h(N),K=B.filter(D).filter(M).map(Q=>d(Q,N,!1));K.unshift(U);const z=K.sort((Q,ge)=>{if(Q.relevance!==ge.relevance)return ge.relevance-Q.relevance;if(Q.language&&ge.language){if(D(Q.language).supersetOf===ge.language)return 1;if(D(ge.language).supersetOf===Q.language)return-1}return 0}),[G,te]=z,ie=G;return ie.secondBest=te,ie}function p(N,B,U){const K=B&&t[B]||U;N.classList.add("hljs"),N.classList.add(`language-${K}`)}function g(N){let B=null;const U=l(N);if(c(U))return;if(L("before:highlightElement",{el:N,language:U}),N.dataset.highlighted){console.log("Element previously highlighted. To highlight again, first unset `dataset.highlighted`.",N);return}if(N.children.length>0&&(a.ignoreUnescapedHTML||(console.warn("One of your code blocks includes unescaped HTML. This is a potentially serious security risk."),console.warn("https://github.com/highlightjs/highlight.js/wiki/security"),console.warn("The element with unescaped HTML:"),console.warn(N)),a.throwUnescapedHTML))throw new jit("One of your code blocks includes unescaped HTML.",N.innerHTML);B=N;const K=B.textContent,z=U?u(K,{language:U,ignoreIllegals:!0}):f(K);N.innerHTML=z.value,N.dataset.highlighted="yes",p(N,U,z.language),N.result={language:z.language,re:z.relevance,relevance:z.relevance},z.secondBest&&(N.secondBest={language:z.secondBest.language,relevance:z.secondBest.relevance}),L("after:highlightElement",{el:N,result:z,text:K})}function m(N){a=iue(a,N)}const v=()=>{E(),F_("10.6.0","initHighlighting() deprecated.  Use highlightAll() now.")};function b(){E(),F_("10.6.0","initHighlightingOnLoad() deprecated.  Use highlightAll() now.")}let S=!1;function E(){if(document.readyState==="loading"){S=!0;return}document.querySelectorAll(a.cssSelector).forEach(g)}function w(){S&&E()}typeof window<"u"&&window.addEventListener&&window.addEventListener("DOMContentLoaded",w,!1);function C(N,B){let U=null;try{U=B(n)}catch(K){if(eS("Language definition for '{}' could not be registered.".replace("{}",N)),i)eS(K);else throw K;U=s}U.name||(U.name=N),e[N]=U,U.rawDefinition=B.bind(null,n),U.aliases&&O(U.aliases,{languageName:N})}function I(N){delete e[N];for(const B of Object.keys(t))t[B]===N&&delete t[B]}function T(){return Object.keys(e)}function D(N){return N=(N||"").toLowerCase(),e[N]||e[t[N]]}function O(N,{languageName:B}){typeof N=="string"&&(N=[N]),N.forEach(U=>{t[U.toLowerCase()]=B})}function M(N){const B=D(N);return B&&!B.disableAutodetect}function R(N){N["before:highlightBlock"]&&!N["before:highlightElement"]&&(N["before:highlightElement"]=B=>{N["before:highlightBlock"](Object.assign({block:B.el},B))}),N["after:highlightBlock"]&&!N["after:highlightElement"]&&(N["after:highlightElement"]=B=>{N["after:highlightBlock"](Object.assign({block:B.el},B))})}function A(N){R(N),r.push(N)}function k(N){const B=r.indexOf(N);B!==-1&&r.splice(B,1)}function L(N,B){const U=N;r.forEach(function(K){K[U]&&K[U](B)})}function j(N){return F_("10.7.0","highlightBlock will be removed entirely in v12.0"),F_("10.7.0","Please use highlightElement now."),g(N)}Object.assign(n,{highlight:u,highlightAuto:f,highlightAll:E,highlightElement:g,highlightBlock:j,configure:m,initHighlighting:v,initHighlightingOnLoad:b,registerLanguage:C,unregisterLanguage:I,listLanguages:T,getLanguage:D,registerAliases:O,autoDetection:M,inherit:iue,addPlugin:A,removePlugin:k}),n.debugMode=function(){i=!1},n.safeMode=function(){i=!0},n.versionString=Fit,n.regex={concat:a_,lookahead:tIe,either:Zee,optional:eit,anyNumberOfTimes:Qrt};for(const N in YR)typeof YR[N]=="object"&&QEe(YR[N]);return Object.assign(n,YR),n},A2=uIe({});A2.newInstance=()=>uIe({});var Hit=A2;A2.HighlightJS=A2;A2.default=A2;const Hk=Fy(Hit);function Uit(n){const e=n.regex,t=new RegExp("[\\p{XID_Start}_]\\p{XID_Continue}*","u"),r=["and","as","assert","async","await","break","case","class","continue","def","del","elif","else","except","finally","for","from","global","if","import","in","is","lambda","match","nonlocal|10","not","or","pass","raise","return","try","while","with","yield"],a={$pattern:/[A-Za-z]\w+|__\w+__/,keyword:r,built_in:["__import__","abs","all","any","ascii","bin","bool","breakpoint","bytearray","bytes","callable","chr","classmethod","compile","complex","delattr","dict","dir","divmod","enumerate","eval","exec","filter","float","format","frozenset","getattr","globals","hasattr","hash","help","hex","id","input","int","isinstance","issubclass","iter","len","list","locals","map","max","memoryview","min","next","object","oct","open","ord","pow","print","property","range","repr","reversed","round","set","setattr","slice","sorted","staticmethod","str","sum","super","tuple","type","vars","zip"],literal:["__debug__","Ellipsis","False","None","NotImplemented","True"],type:["Any","Callable","Coroutine","Dict","List","Literal","Generic","Optional","Sequence","Set","Tuple","Type","Union"]},c={className:"meta",begin:/^(>>>|\.\.\.) /},l={className:"subst",begin:/\{/,end:/\}/,keywords:a,illegal:/#/},u={begin:/\{\{/,relevance:0},d={className:"string",contains:[n.BACKSLASH_ESCAPE],variants:[{begin:/([uU]|[bB]|[rR]|[bB][rR]|[rR][bB])?'''/,end:/'''/,contains:[n.BACKSLASH_ESCAPE,c],relevance:10},{begin:/([uU]|[bB]|[rR]|[bB][rR]|[rR][bB])?"""/,end:/"""/,contains:[n.BACKSLASH_ESCAPE,c],relevance:10},{begin:/([fF][rR]|[rR][fF]|[fF])'''/,end:/'''/,contains:[n.BACKSLASH_ESCAPE,c,u,l]},{begin:/([fF][rR]|[rR][fF]|[fF])"""/,end:/"""/,contains:[n.BACKSLASH_ESCAPE,c,u,l]},{begin:/([uU]|[rR])'/,end:/'/,relevance:10},{begin:/([uU]|[rR])"/,end:/"/,relevance:10},{begin:/([bB]|[bB][rR]|[rR][bB])'/,end:/'/},{begin:/([bB]|[bB][rR]|[rR][bB])"/,end:/"/},{begin:/([fF][rR]|[rR][fF]|[fF])'/,end:/'/,contains:[n.BACKSLASH_ESCAPE,u,l]},{begin:/([fF][rR]|[rR][fF]|[fF])"/,end:/"/,contains:[n.BACKSLASH_ESCAPE,u,l]},n.APOS_STRING_MODE,n.QUOTE_STRING_MODE]},h="[0-9](_?[0-9])*",f=`(\\b(${h}))?\\.(${h})|\\b(${h})\\.`,p=`\\b|${r.join("|")}`,g={className:"number",relevance:0,variants:[{begin:`(\\b(${h})|(${f}))[eE][+-]?(${h})[jJ]?(?=${p})`},{begin:`(${f})[jJ]?`},{begin:`\\b([1-9](_?[0-9])*|0+(_?0)*)[lLjJ]?(?=${p})`},{begin:`\\b0[bB](_?[01])+[lL]?(?=${p})`},{begin:`\\b0[oO](_?[0-7])+[lL]?(?=${p})`},{begin:`\\b0[xX](_?[0-9a-fA-F])+[lL]?(?=${p})`},{begin:`\\b(${h})[jJ](?=${p})`}]},m={className:"comment",begin:e.lookahead(/# type:/),end:/$/,keywords:a,contains:[{begin:/# type:/},{begin:/#/,end:/\b\B/,endsWithParent:!0}]},v={className:"params",variants:[{className:"",begin:/\(\s*\)/,skip:!0},{begin:/\(/,end:/\)/,excludeBegin:!0,excludeEnd:!0,keywords:a,contains:["self",c,g,d,n.HASH_COMMENT_MODE]}]};return l.contains=[d,g,c],{name:"Python",aliases:["py","gyp","ipython"],unicodeRegex:!0,keywords:a,illegal:/(<\/|\?)|=>/,contains:[c,g,{begin:/\bself\b/},{beginKeywords:"if",relevance:0},d,m,n.HASH_COMMENT_MODE,{match:[/\bdef/,/\s+/,t],scope:{1:"keyword",3:"title.function"},contains:[v]},{variants:[{match:[/\bclass/,/\s+/,t,/\s*/,/\(\s*/,t,/\s*\)/]},{match:[/\bclass/,/\s+/,t]}],scope:{1:"keyword",3:"title.class",6:"title.class.inherited"}},{className:"meta",begin:/^[\t ]*@/,end:/(?=#)|$/,contains:[g,v,d]}]}}const zit=new TextEncoder,Vit=new TextDecoder,Wit=n=>btoa(String.fromCharCode(...zit.encode(n))),qit=n=>Vit.decode(Uint8Array.from(atob(n),e=>e.charCodeAt(0)));Hk.registerLanguage("python",Uit);const Kit=Hk.getLanguage("python");if(!Kit)throw new Error("python language not found");const u7=new Bh,{fence:dIe}=u7.renderer.rules;if(!dIe)throw new Error("fence renderer not found");const sue='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 3.5C10.8954 3.5 10 4.39543 10 5.5H14C14 4.39543 13.1046 3.5 12 3.5ZM8.53513 3.5C9.22675 2.3044 10.5194 1.5 12 1.5C13.4806 1.5 14.7733 2.3044 15.4649 3.5H17.25C18.9069 3.5 20.25 4.84315 20.25 6.5V18.5C20.25 20.1569 19.1569 21.5 17.25 21.5H6.75C5.09315 21.5 3.75 20.1569 3.75 18.5V6.5C3.75 4.84315 5.09315 3.5 6.75 3.5H8.53513ZM8 5.5H6.75C6.19772 5.5 5.75 5.94772 5.75 6.5V18.5C5.75 19.0523 6.19772 19.5 6.75 19.5H17.25C18.0523 19.5 18.25 19.0523 18.25 18.5V6.5C18.25 5.94772 17.8023 5.5 17.25 5.5H16C16 6.60457 15.1046 7.5 14 7.5H10C8.89543 7.5 8 6.60457 8 5.5Z" fill="currentColor"></path></svg>',QW="copycode",nP={defaultLang:"python",copyTooltip:"copy code to clipboard",copiedTooltip:"copied!",resetCopyTooltipTimeout:1200};u7.renderer.rules.fence=function(n,e,t,r,i){const{info:o,content:s}=n[e],a=o&&Hk.getLanguage(o)?o:nP.defaultLang,c=Hk.highlight(s,{language:a,ignoreIllegals:!0}).value,l=Wit(s),u=[`window.dispatchEvent(new CustomEvent('${QW}', { detail: '${l}' } ))`,`this.parentElement.setAttribute('data-tip', '${nP.copiedTooltip}')`,`setTimeout(() => { try { this.parentElement.setAttribute('data-tip', '${nP.copyTooltip}') } catch {} }, ${nP.resetCopyTooltipTimeout})`].join(";");try{return`
            <div class="bg-neutral-light rounded-md my-2">
            <div class="flex items-center relative px-1 py-1 text-xs font-bold font-sans justify-between rounded-t-md text-primary-dark">
                ${o?`<span>${o}</span>
                <div class="tooltip tooltip-left" data-tip="copy code to clipboard">
                    <button class="flex gap-1 items-center btn btn-sm animate-none no-animation" onclick="${u}">
                        ${sue}   
                    </button>
            </div>`:`
                <div class="tooltip tooltip-right m-0 p-0" data-tip="copy code to clipboard">
                    <button class="items-center btn btn-xs p-0 m-0 h-0 animate-none no-animation" onclick="${u}">
                        ${sue}   
                    </button>
            </div>
                `}
            </div>
                <pre><code class="hljs">${c}</code></pre>
            </div>
        `}catch{return dIe(n,e,t,r,i)}};u7.renderer.rules.code_inline=function(n,e,t,r,i){const{content:o}=n[e],s=nP.defaultLang;return`<code class="hljs">${Hk.highlight(o,{language:s,ignoreIllegals:!0}).value}</code>`};function Git(n){let e;return{c(){e=Ne("link"),this.h()},l(t){e=Fe(t,"LINK",{rel:!0,href:!0}),this.h()},h(){Re(e,"rel","stylesheet"),Re(e,"href","https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/a11y-dark.min.css")},m(t,r){Ft(t,e,r)},d(t){t&&Ee(e)}}}function Zit(n){let e,t,r,i,o=n[1]&&Git();return{c(){o&&o.c(),e=Ji(),t=Kt(),r=Ne("div"),i=new zL(!1),this.h()},l(s){const a=vGe("svelte-1cqsasd",document.head);o&&o.l(a),e=Ji(),a.forEach(Ee),t=Gt(s),r=Fe(s,"DIV",{class:!0});var c=tt(r);i=VL(c,!1),c.forEach(Ee),this.h()},h(){i.a=null,Re(r,"class","markdown max-w-full")},m(s,a){o&&o.m(document.head,null),we(document.head,e),Ft(s,t,a),Ft(s,r,a),i.m(n[0],r)},p(s,[a]){a&1&&i.p(s[0])},i:Dt,o:Dt,d(s){s&&(Ee(t),Ee(r)),o&&o.d(s),Ee(e)}}}let aue=!1;function Xit(n,e,t){let r,{content:i}=e;const o=!aue;if(aue=!0,o){const s=a=>{const{detail:c}=a,l=qit(c);navigator.clipboard.writeText(l)};window.addEventListener(QW,s),w2e(()=>window.removeEventListener(QW,s))}return n.$$set=s=>{"content"in s&&t(2,i=s.content)},n.$$.update=()=>{n.$$.dirty&4&&t(0,r=u7.render(i))},[r,o,i]}class By extends fo{constructor(e){super(),po(this,e,Xit,Zit,Hi,{content:2})}}function cue(n,e,t){const r=n.slice();return r[19]=e[t].text,r[20]=e[t].action,r[22]=t,r}function lue(n){let e,t=n[2].content+"",r,i,o=n[2].stamp&&uue(n);return{c(){e=Ne("div"),r=Jr(t),i=Kt(),o&&o.c(),this.h()},l(s){e=Fe(s,"DIV",{class:!0});var a=tt(e);r=Qr(a,t),i=Gt(a),o&&o.l(a),a.forEach(Ee),this.h()},h(){Re(e,"class","chat-header")},m(s,a){Ft(s,e,a),we(e,r),we(e,i),o&&o.m(e,null)},p(s,a){a&4&&t!==(t=s[2].content+"")&&yl(r,t),s[2].stamp?o?o.p(s,a):(o=uue(s),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},d(s){s&&Ee(e),o&&o.d()}}}function uue(n){let e,t=n[2].stamp+"",r;return{c(){e=Ne("time"),r=Jr(t),this.h()},l(i){e=Fe(i,"TIME",{class:!0});var o=tt(e);r=Qr(o,t),o.forEach(Ee),this.h()},h(){Re(e,"class","text-xs opacity-50")},m(i,o){Ft(i,e,o),we(e,r)},p(i,o){o&4&&t!==(t=i[2].stamp+"")&&yl(r,t)},d(i){i&&Ee(e)}}}function Yit(n){let e;return{c(){e=Ne("span"),this.h()},l(t){e=Fe(t,"SPAN",{class:!0}),tt(e).forEach(Ee),this.h()},h(){Re(e,"class","loading loading-dots loading-md")},m(t,r){Ft(t,e,r)},p:Dt,i:Dt,o:Dt,d(t){t&&Ee(e)}}}function Jit(n){let e,t;return e=new By({props:{content:n[0]}}),{c(){Bo(e.$$.fragment)},l(r){Ho(e.$$.fragment,r)},m(r,i){Uo(e,r,i),t=!0},p(r,i){const o={};i&1&&(o.content=r[0]),e.$set(o)},i(r){t||(cn(e.$$.fragment,r),t=!0)},o(r){Sn(e.$$.fragment,r),t=!1},d(r){zo(e,r)}}}function due(n){let e,t=Fs(n[1]),r=[];for(let i=0;i<t.length;i+=1)r[i]=hue(cue(n,t,i));return{c(){e=Ne("div");for(let i=0;i<r.length;i+=1)r[i].c();this.h()},l(i){e=Fe(i,"DIV",{class:!0});var o=tt(e);for(let s=0;s<r.length;s+=1)r[s].l(o);o.forEach(Ee),this.h()},h(){Re(e,"class","join")},m(i,o){Ft(i,e,o);for(let s=0;s<r.length;s+=1)r[s]&&r[s].m(e,null)},p(i,o){if(o&2){t=Fs(i[1]);let s;for(s=0;s<t.length;s+=1){const a=cue(i,t,s);r[s]?r[s].p(a,o):(r[s]=hue(a),r[s].c(),r[s].m(e,null))}for(;s<r.length;s+=1)r[s].d(1);r.length=t.length}},d(i){i&&Ee(e),Kf(r,i)}}}function hue(n){let e,t=n[19]+"",r,i,o,s;return{c(){e=Ne("button"),r=Jr(t),i=Kt(),this.h()},l(a){e=Fe(a,"BUTTON",{class:!0});var c=tt(e);r=Qr(c,t),i=Gt(c),c.forEach(Ee),this.h()},h(){Re(e,"class","btn btn-xs btn-warning join-item")},m(a,c){Ft(a,e,c),we(e,r),we(e,i),o||(s=_r(e,"click",function(){S2(n[20])&&n[20].apply(this,arguments)}),o=!0)},p(a,c){n=a,c&2&&t!==(t=n[19]+"")&&yl(r,t)},d(a){a&&Ee(e),o=!1,s()}}}function Qit(n){let e,t,r,i,o,s,a,c,l,u,d,h=n[2]&&lue(n);const f=[Jit,Yit],p=[];function g(v,b){return v[0]?0:v[3]?-1:1}~(i=g(n))&&(o=p[i]=f[i](n));let m=n[1]&&due(n);return{c(){e=Ne("div"),h&&h.c(),t=Kt(),r=Ne("div"),o&&o.c(),s=Kt(),a=Ne("div"),c=Kt(),l=Ne("div"),u=Ne("div"),m&&m.c(),this.h()},l(v){e=Fe(v,"DIV",{class:!0});var b=tt(e);h&&h.l(b),t=Gt(b),r=Fe(b,"DIV",{class:!0});var S=tt(r);o&&o.l(S),s=Gt(S),a=Fe(S,"DIV",{}),tt(a).forEach(Ee),S.forEach(Ee),c=Gt(b),l=Fe(b,"DIV",{class:!0});var E=tt(l);u=Fe(E,"DIV",{});var w=tt(u);m&&m.l(w),w.forEach(Ee),E.forEach(Ee),b.forEach(Ee),this.h()},h(){Re(r,"class","chat-bubble bg-neutral-medium text-white"),Re(l,"class","chat-footer"),Re(e,"class","chat"),Kr(e,"chat-start",n[4]==="left"),Kr(e,"chat-end",n[4]==="right")},m(v,b){Ft(v,e,b),h&&h.m(e,null),we(e,t),we(e,r),~i&&p[i].m(r,null),we(r,s),we(r,a),n[16](a),we(e,c),we(e,l),we(l,u),m&&m.m(u,null),n[17](u),d=!0},p(v,[b]){v[2]?h?h.p(v,b):(h=lue(v),h.c(),h.m(e,t)):h&&(h.d(1),h=null);let S=i;i=g(v),i===S?~i&&p[i].p(v,b):(o&&(ja(),Sn(p[S],1,1,()=>{p[S]=null}),Ba()),~i?(o=p[i],o?o.p(v,b):(o=p[i]=f[i](v),o.c()),cn(o,1),o.m(r,s)):o=null),v[1]?m?m.p(v,b):(m=due(v),m.c(),m.m(u,null)):m&&(m.d(1),m=null),(!d||b&16)&&Kr(e,"chat-start",v[4]==="left"),(!d||b&16)&&Kr(e,"chat-end",v[4]==="right")},i(v){d||(cn(o),d=!0)},o(v){Sn(o),d=!1},d(v){v&&Ee(e),h&&h.d(),~i&&p[i].d(),n[16](null),m&&m.d(),n[17](null)}}}function eot(n,e,t){let{header:r=null}=e,{message:i}=e,{noMessageOverride:o=!1}=e,{side:s="left"}=e,{id:a=null}=e,{buttons:c=void 0}=e;const l=C=>t(1,c=C),u=C=>t(7,a=C),d=()=>a;let h,f;const p=C=>t(0,i=C),g=()=>i,m=()=>h,v=()=>f;let b;const S=C=>b=C;aee(()=>b==null?void 0:b());function E(C){na[C?"unshift":"push"](()=>{h=C,t(5,h)})}function w(C){na[C?"unshift":"push"](()=>{f=C,t(6,f)})}return n.$$set=C=>{"header"in C&&t(2,r=C.header),"message"in C&&t(0,i=C.message),"noMessageOverride"in C&&t(3,o=C.noMessageOverride),"side"in C&&t(4,s=C.side),"id"in C&&t(7,a=C.id),"buttons"in C&&t(1,c=C.buttons)},[i,c,r,o,s,h,f,a,l,u,d,p,g,m,v,S,E,w]}let fue=class extends fo{constructor(e){super(),po(this,e,eot,Qit,Hi,{header:2,message:0,noMessageOverride:3,side:4,id:7,buttons:1,setButtons:8,setID:9,getID:10,setMessage:11,getMessage:12,getChildTarget:13,getFooterTarget:14,setAfterUpdateCallback:15})}get setButtons(){return this.$$.ctx[8]}get setID(){return this.$$.ctx[9]}get getID(){return this.$$.ctx[10]}get setMessage(){return this.$$.ctx[11]}get getMessage(){return this.$$.ctx[12]}get getChildTarget(){return this.$$.ctx[13]}get getFooterTarget(){return this.$$.ctx[14]}get setAfterUpdateCallback(){return this.$$.ctx[15]}};const tot=(n,e=new Date)=>n.getDate()===e.getDate()&&n.getMonth()===e.getMonth()&&n.getFullYear()===e.getFullYear(),pue=n=>{n??(n=new Date);const e=n.toLocaleTimeString([],{hour:"numeric",minute:"2-digit",hour12:!0});return tot(n)?e:`${e} ${n.toLocaleDateString([],{month:"numeric",day:"numeric"})}`};function not(n){let e,t;return{c(){e=J1("svg"),t=J1("path"),this.h()},l(r){e=Q1(r,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var i=tt(e);t=Q1(i,"path",{d:!0}),tt(t).forEach(Ee),i.forEach(Ee),this.h()},h(){Re(t,"d","M10.894 2.553a1 1 0 00-1.788 0l-7 14a1 1 0 001.169 1.409l5-1.429A1 1 0 009 15.571V11a1 1 0 112 0v4.571a1 1 0 00.725.962l5 1.428a1 1 0 001.17-1.408l-7-14z"),Re(e,"xmlns","http://www.w3.org/2000/svg"),Re(e,"viewBox","0 0 20 20"),Re(e,"fill","currentColor"),Re(e,"class","h-6 w-6 ml-2 transform rotate-90")},m(r,i){Ft(r,e,i),we(e,t)},p:Dt,i:Dt,o:Dt,d(r){r&&Ee(e)}}}class rot extends fo{constructor(e){super(),po(this,e,null,not,Hi,{})}}const iot=n=>/\S/.test(n);function oot(n){let e,t,r;return{c(){e=J1("svg"),t=J1("polygon"),this.h()},l(i){e=Q1(i,"svg",{class:!0,xmlns:!0,width:!0,height:!0,viewBox:!0});var o=tt(e);t=Q1(o,"polygon",{points:!0}),tt(t).forEach(Ee),o.forEach(Ee),this.h()},h(){Re(t,"points","400 145.49 366.51 112 256 222.51 145.49 112 112 145.49 222.51 256 112 366.51 145.49 400 256 289.49 366.51 400 400 366.51 289.49 256 400 145.49"),Re(e,"class",r=n[2].join(" ")),Re(e,"xmlns","http://www.w3.org/2000/svg"),Re(e,"width",n[0]),Re(e,"height",n[1]),Re(e,"viewBox","0 0 512 512")},m(i,o){Ft(i,e,o),we(e,t)},p(i,[o]){o&4&&r!==(r=i[2].join(" "))&&Re(e,"class",r),o&1&&Re(e,"width",i[0]),o&2&&Re(e,"height",i[1])},i:Dt,o:Dt,d(i){i&&Ee(e)}}}function sot(n,e,t){let{width:r="1rem"}=e,{height:i="1rem"}=e,{classes:o=[]}=e;return n.$$set=s=>{"width"in s&&t(0,r=s.width),"height"in s&&t(1,i=s.height),"classes"in s&&t(2,o=s.classes)},[r,i,o]}let aot=class extends fo{constructor(e){super(),po(this,e,sot,oot,Hi,{width:0,height:1,classes:2})}};const tS={text:"var(--text)",neutral:{dark:"var(--neutral-dark)",medium:"var(--neutral-medium)",light:"var(--neutral-light)"},primary:{dark:"var(--primary-dark)",medium:"var(--primary-medium)",light:"var(--primary-light)"},accent:{blue:"var(--accent-blue)",pink:"var(--accent-pink)",purple:"var(--accent-purple)"},feedback:{error:"var(--feedback-error)",warning:"var(--feedback-warning)",success:"var(--feedback-success)"}};function cot(n){let e,t,r,i,o,s,a;return i=new aot({props:{width:"2rem",height:"2rem"}}),{c(){e=Ne("button"),t=Ne("center"),r=Ne("div"),Bo(i.$$.fragment),this.h()},l(c){e=Fe(c,"BUTTON",{class:!0});var l=tt(e);t=Fe(l,"CENTER",{class:!0});var u=tt(t);r=Fe(u,"DIV",{class:!0});var d=tt(r);Ho(i.$$.fragment,d),d.forEach(Ee),u.forEach(Ee),l.forEach(Ee),this.h()},h(){Re(r,"class","btn-circle w-8 h-8 fill-primary"),Fn(r,"background","rgba(255, 255, 255, 0.8)"),Fn(r,"fill",tS.accent.pink),Re(t,"class","m-auto text-white px-1"),Re(e,"class","btn btn-primary h-full p-0"),e.disabled=n[4],Fn(e,"background-color",tS.accent.pink),Fn(e,"border-color",tS.accent.pink)},m(c,l){Ft(c,e,l),we(e,t),we(t,r),Uo(i,r,null),o=!0,s||(a=_r(e,"click",n[12]),s=!0)},p(c,l){(!o||l&16)&&(e.disabled=c[4])},i(c){o||(cn(i.$$.fragment,c),o=!0)},o(c){Sn(i.$$.fragment,c),o=!1},d(c){c&&Ee(e),zo(i),s=!1,a()}}}function lot(n){let e,t,r,i,o,s;return r=new rot({}),{c(){e=Ne("button"),t=Ne("center"),Bo(r.$$.fragment),this.h()},l(a){e=Fe(a,"BUTTON",{class:!0});var c=tt(e);t=Fe(c,"CENTER",{class:!0});var l=tt(t);Ho(r.$$.fragment,l),l.forEach(Ee),c.forEach(Ee),this.h()},h(){Re(t,"class","m-auto mr-2"),Re(e,"class","btn btn-primary h-full p-0 bg-primary"),e.disabled=n[4]},m(a,c){Ft(a,e,c),we(e,t),Uo(r,t,null),i=!0,o||(s=_r(e,"click",n[6]),o=!0)},p(a,c){(!i||c&16)&&(e.disabled=a[4])},i(a){i||(cn(r.$$.fragment,a),i=!0)},o(a){Sn(r.$$.fragment,a),i=!1},d(a){a&&Ee(e),zo(r),o=!1,s()}}}function uot(n){let e,t,r,i,o,s,a,c,l,u,d,h,f,p="Attachments:",g,m,v,b,S,E,w,C,I='<kbd class="kbd kbd-sm">Enter</kbd>',T,D,O,M,R,A='<kbd class="kbd kbd-sm">Shift</kbd>+<kbd class="kbd kbd-sm">Enter</kbd>creates new line',k,L,j;const N=[lot,cot],B=[];function U(K,z){return K[0]===BP.send?0:1}return l=U(n),u=B[l]=N[l](n),{c(){e=Ne("div"),t=Ne("div"),r=Ne("div"),i=Ne("div"),o=Ne("textarea"),a=Kt(),c=Ne("div"),u.c(),d=Kt(),h=Ne("div"),f=Ne("span"),f.textContent=p,g=Kt(),m=Ne("div"),v=Ne("div"),b=Ne("center"),S=Ne("div"),E=Kt(),w=Ne("div"),C=Ne("span"),C.innerHTML=I,T=Jr(`
            sends
            `),D=Ne("div"),O=Ne("div"),M=Kt(),R=Ne("span"),R.innerHTML=A,this.h()},l(K){e=Fe(K,"DIV",{class:!0});var z=tt(e);t=Fe(z,"DIV",{class:!0});var G=tt(t);r=Fe(G,"DIV",{class:!0});var te=tt(r);i=Fe(te,"DIV",{class:!0});var ie=tt(i);o=Fe(ie,"TEXTAREA",{class:!0,placeholder:!0}),tt(o).forEach(Ee),a=Gt(ie),c=Fe(ie,"DIV",{class:!0});var Q=tt(c);u.l(Q),Q.forEach(Ee),ie.forEach(Ee),d=Gt(te),h=Fe(te,"DIV",{class:!0});var ge=tt(h);f=Fe(ge,"SPAN",{class:!0,"data-svelte-h":!0}),Fr(f)!=="svelte-875jx3"&&(f.textContent=p),g=Gt(ge),m=Fe(ge,"DIV",{class:!0});var _e=tt(m);v=Fe(_e,"DIV",{class:!0});var Se=tt(v);b=Fe(Se,"CENTER",{});var se=tt(b);S=Fe(se,"DIV",{class:!0}),tt(S).forEach(Ee),se.forEach(Ee),Se.forEach(Ee),_e.forEach(Ee),ge.forEach(Ee),te.forEach(Ee),E=Gt(G),w=Fe(G,"DIV",{class:!0});var ee=tt(w);C=Fe(ee,"SPAN",{class:!0,"data-svelte-h":!0}),Fr(C)!=="svelte-kgield"&&(C.innerHTML=I),T=Qr(ee,`
            sends
            `),D=Fe(ee,"DIV",{class:!0});var Y=tt(D);O=Fe(Y,"DIV",{class:!0}),tt(O).forEach(Ee),Y.forEach(Ee),M=Gt(ee),R=Fe(ee,"SPAN",{class:!0,"data-svelte-h":!0}),Fr(R)!=="svelte-pkfj5g"&&(R.innerHTML=A),ee.forEach(Ee),G.forEach(Ee),z.forEach(Ee),this.h()},h(){Re(o,"class","textarea flex-1 pr-10 svelte-1er4ovm"),Re(o,"placeholder","Type your message..."),o.disabled=s=n[0]===BP.cancel,Re(c,"class","absolute bottom-2 right-2"),Re(i,"class","w-full flex flex-row relative join-item"),Re(f,"class","indicator-item indicator-start text-xs badge border-none text-neutral-light opacity-75"),Fn(f,"--tw-translate-x","0.5rem"),Fn(f,"color","var(--neutral-medium)"),Re(S,"class","px-4 py-2"),Re(v,"class","mt-0 w-full"),Re(m,"class","join p-0 flex flex-col my-auto py-1 w-full"),Re(h,"class","w-full join-item indicator pb-1"),Re(r,"class","join join-vertical bg-white"),Re(C,"class","whitespace-nowrap border-solid"),Re(O,"class","absolute bg-base-content h-6 -my-4"),Fn(O,"width","0.075rem"),Re(D,"class","inline-block relative"),Fn(D,"margin-right","0.125rem"),Re(R,"class","whitespace-nowrap ml-0"),Re(w,"class","relative py-2 text-center text-xs text-token-text-secondary"),Re(t,"class","flex flex-col"),Re(e,"class","w-full bg-neutral-light px-2 indicator-item indicator-center mt-2")},m(K,z){Ft(K,e,z),we(e,t),we(t,r),we(r,i),we(i,o),iv(o,n[1]),n[11](o),we(i,a),we(i,c),B[l].m(c,null),we(r,d),we(r,h),we(h,f),we(h,g),we(h,m),we(m,v),we(v,b),we(b,S),n[13](S),we(t,E),we(t,w),we(w,C),we(w,T),we(w,D),we(D,O),we(w,M),we(w,R),k=!0,L||(j=[_r(o,"input",n[10]),_r(o,"input",dot),_r(o,"keydown",n[7])],L=!0)},p(K,[z]){(!k||z&1&&s!==(s=K[0]===BP.cancel))&&(o.disabled=s),z&2&&iv(o,K[1]);let G=l;l=U(K),l===G?B[l].p(K,z):(ja(),Sn(B[G],1,1,()=>{B[G]=null}),Ba(),u=B[l],u?u.p(K,z):(u=B[l]=N[l](K),u.c()),cn(u,1),u.m(c,null))},i(K){k||(cn(u),k=!0)},o(K){Sn(u),k=!1},d(K){K&&Ee(e),n[11](null),B[l].d(),n[13](null),L=!1,qh(j)}}}const dot=({currentTarget:n})=>{n.style.height="auto",n.style.height=n.scrollHeight+"px"},BP={send:"send",cancel:"cancel"};function hot(n,e,t){let r,{mode:i=BP.cancel}=e;const o=v=>{t(0,i=v)},s=WL();let a="";const c=()=>{t(1,a=a.trim()),s("send",a),t(1,a=""),d&&t(3,d.style.height="auto",d)},l=v=>{const b=v.key==="Enter",S=v.shiftKey;if(b){if(S)return;r||c(),v.preventDefault()}};let u,d;const h=()=>u;function f(){a=this.value,t(1,a)}function p(v){na[v?"unshift":"push"](()=>{d=v,t(3,d)})}const g=()=>s("cancel");function m(v){na[v?"unshift":"push"](()=>{u=v,t(2,u)})}return n.$$set=v=>{"mode"in v&&t(0,i=v.mode)},n.$$.update=()=>{n.$$.dirty&3&&t(4,r=i===BP.send&&(!a||!iot(a)))},[i,a,u,d,r,s,c,l,o,h,f,p,g,m]}let fot=class extends fo{constructor(e){super(),po(this,e,hot,uot,Hi,{mode:0,setMode:8,getContextContainer:9})}get setMode(){return this.$$.ctx[8]}get getContextContainer(){return this.$$.ctx[9]}};function pot(n){let e;return{c(){e=Jr(`Plesae let us know why you didn't appreciate the tutor's
                response.`)},l(t){e=Qr(t,`Plesae let us know why you didn't appreciate the tutor's
                response.`)},m(t,r){Ft(t,e,r)},d(t){t&&Ee(e)}}}function got(n){let e;return{c(){e=Jr("Did you like the tutor's response? Let us know why!")},l(t){e=Qr(t,"Did you like the tutor's response? Let us know why!")},m(t,r){Ft(t,e,r)},d(t){t&&Ee(e)}}}function mot(n){let e,t,r,i,o,s,a,c,l="Submit!",u,d;function h(g,m){return g[0]==="helpful"?got:pot}let f=h(n),p=f(n);return{c(){e=Ne("div"),t=Ne("center"),r=Ne("h1"),p.c(),i=Kt(),o=Ne("div"),s=Ne("textarea"),a=Kt(),c=Ne("button"),c.textContent=l,this.h()},l(g){e=Fe(g,"DIV",{});var m=tt(e);t=Fe(m,"CENTER",{});var v=tt(t);r=Fe(v,"H1",{class:!0});var b=tt(r);p.l(b),b.forEach(Ee),v.forEach(Ee),i=Gt(m),o=Fe(m,"DIV",{class:!0});var S=tt(o);s=Fe(S,"TEXTAREA",{class:!0,placeholder:!0}),tt(s).forEach(Ee),a=Gt(S),c=Fe(S,"BUTTON",{class:!0,"data-svelte-h":!0}),Fr(c)!=="svelte-1cd372j"&&(c.textContent=l),S.forEach(Ee),m.forEach(Ee),this.h()},h(){Re(r,"class","text-2xl stat-title"),Re(s,"class","textarea textarea-bordered flex-grow"),Re(s,"placeholder","Enter your feedback!"),Re(c,"class","btn ml-2 btn-outline-secondary"),Re(o,"class","flex flex-row w-full h-1.2 mt-6")},m(g,m){Ft(g,e,m),we(e,t),we(t,r),p.m(r,null),we(e,i),we(e,o),we(o,s),iv(s,n[1]),we(o,a),we(o,c),u||(d=[_r(s,"input",n[3]),_r(c,"click",i7)],u=!0)},p(g,[m]){f!==(f=h(g))&&(p.d(1),p=f(g),p&&(p.c(),p.m(r,null))),m&2&&iv(s,g[1])},i:Dt,o:Dt,d(g){g&&Ee(e),p.d(),u=!1,qh(d)}}}function vot(n,e,t){let{condition:r}=e,i;const o=()=>i;function s(){i=this.value,t(1,i)}return n.$$set=a=>{"condition"in a&&t(0,r=a.condition)},[r,i,o,s]}class gue extends fo{constructor(e){super(),po(this,e,vot,mot,Hi,{condition:0,getValue:2})}get getValue(){return this.$$.ctx[2]}}var yot=function(n,e){e=e||{},e.listUnicodeChar=e.hasOwnProperty("listUnicodeChar")?e.listUnicodeChar:!1,e.stripListLeaders=e.hasOwnProperty("stripListLeaders")?e.stripListLeaders:!0,e.gfm=e.hasOwnProperty("gfm")?e.gfm:!0,e.useImgAltText=e.hasOwnProperty("useImgAltText")?e.useImgAltText:!0,e.abbr=e.hasOwnProperty("abbr")?e.abbr:!1,e.replaceLinksWithURL=e.hasOwnProperty("replaceLinksWithURL")?e.replaceLinksWithURL:!1,e.htmlTagsToSkip=e.hasOwnProperty("htmlTagsToSkip")?e.htmlTagsToSkip:[],e.throwError=e.hasOwnProperty("throwError")?e.throwError:!1;var t=n||"";t=t.replace(/^(-\s*?|\*\s*?|_\s*?){3,}\s*/gm,"");try{e.stripListLeaders&&(e.listUnicodeChar?t=t.replace(/^([\s\t]*)([\*\-\+]|\d+\.)\s+/gm,e.listUnicodeChar+" $1"):t=t.replace(/^([\s\t]*)([\*\-\+]|\d+\.)\s+/gm,"$1")),e.gfm&&(t=t.replace(/\n={2,}/g,`
`).replace(/~{3}.*\n/g,"").replace(/~~/g,"").replace(/`{3}.*\n/g,"")),e.abbr&&(t=t.replace(/\*\[.*\]:.*\n/,"")),t=t.replace(/<[^>]*>/g,"");var r=new RegExp("<[^>]*>","g");if(e.htmlTagsToSkip.length>0){var i="(?!"+e.htmlTagsToSkip.join("|")+")";r=new RegExp("<"+i+"[^>]*>","ig")}t=t.replace(r,"").replace(/^[=\-]{2,}\s*$/g,"").replace(/\[\^.+?\](\: .*?$)?/g,"").replace(/\s{0,2}\[.*?\]: .*?$/g,"").replace(/\!\[(.*?)\][\[\(].*?[\]\)]/g,e.useImgAltText?"$1":"").replace(/\[([^\]]*?)\][\[\(].*?[\]\)]/g,e.replaceLinksWithURL?"$2":"$1").replace(/^(\n)?\s{0,3}>\s?/gm,"$1").replace(/^\s{1,2}\[(.*?)\]: (\S+)( ".*?")?\s*$/g,"").replace(/^(\n)?\s{0,}#{1,6}\s*( (.+))? +#+$|^(\n)?\s{0,}#{1,6}\s*( (.+))?$/gm,"$1$3$4$6").replace(/([\*]+)(\S)(.*?\S)??\1/g,"$2$3").replace(/(^|\W)([_]+)(\S)(.*?\S)??\2($|\W)/g,"$1$3$4$5").replace(/(`{3,})(.*?)\1/gm,"$2").replace(/`(.+?)`/g,"$1").replace(/~(.*?)~/g,"$1")}catch(o){if(e.throwError)throw o;return console.error("remove-markdown encountered error: %s",o),n}return t};const bot=Fy(yot);function mue(n,e,t){const r=n.slice();r[2]=e[t],r[16]=t;const i=r[6].get(r[2].document_id);return r[14]=i,r}function vue(n,e,t){const r=n.slice();return r[17]=e[t],r}function Sot(n){let e,t,r,i="Back",o,s,a="Scroll to Snippet",c,l,u,d,h,f=n[5]&&yue(n);return{c(){e=Ne("div"),t=Ne("div"),r=Ne("button"),r.textContent=i,o=Kt(),s=Ne("button"),s.textContent=a,c=Kt(),l=Ne("div"),f&&f.c(),this.h()},l(p){e=Fe(p,"DIV",{class:!0});var g=tt(e);t=Fe(g,"DIV",{});var m=tt(t);r=Fe(m,"BUTTON",{class:!0,"data-svelte-h":!0}),Fr(r)!=="svelte-1n1w1e5"&&(r.textContent=i),o=Gt(m),s=Fe(m,"BUTTON",{class:!0,"data-svelte-h":!0}),Fr(s)!=="svelte-1ilq0zr"&&(s.textContent=a),m.forEach(Ee),c=Gt(g),l=Fe(g,"DIV",{class:!0});var v=tt(l);f&&f.l(v),v.forEach(Ee),g.forEach(Ee),this.h()},h(){Re(r,"class","back-button mt-4 svelte-i5a1zh"),Re(s,"class","back-button mt-4 svelte-i5a1zh"),Re(l,"class","flex-grow w-full overflow-x-scroll overflow-y-scroll"),Re(e,"class","flex flex-col w-full h-full")},m(p,g){Ft(p,e,g),we(e,t),we(t,r),we(t,o),we(t,s),we(e,c),we(e,l),f&&f.m(l,null),u=!0,d||(h=[_r(r,"click",n[9]),_r(s,"click",n[7])],d=!0)},p(p,g){p[5]?f?(f.p(p,g),g&32&&cn(f,1)):(f=yue(p),f.c(),cn(f,1),f.m(l,null)):f&&(ja(),Sn(f,1,1,()=>{f=null}),Ba())},i(p){u||(cn(f),u=!0)},o(p){Sn(f),u=!1},d(p){p&&Ee(e),f&&f.d(),d=!1,qh(h)}}}function _ot(n){let e,t,r,i=Fs(n[0]),o=[];for(let a=0;a<i.length;a+=1)o[a]=wue(mue(n,i,a));const s=a=>Sn(o[a],1,1,()=>{o[a]=null});return{c(){e=Ne("div"),t=Ne("div");for(let a=0;a<o.length;a+=1)o[a].c();this.h()},l(a){e=Fe(a,"DIV",{class:!0});var c=tt(e);t=Fe(c,"DIV",{class:!0});var l=tt(t);for(let u=0;u<o.length;u+=1)o[u].l(l);l.forEach(Ee),c.forEach(Ee),this.h()},h(){Re(t,"class","join join-vertical flex flex-col flex-row"),Re(e,"class","overflow-y-scroll overflow-x-scroll expandable-container svelte-i5a1zh")},m(a,c){Ft(a,e,c),we(e,t);for(let l=0;l<o.length;l+=1)o[l]&&o[l].m(t,null);r=!0},p(a,c){if(c&867){i=Fs(a[0]);let l;for(l=0;l<i.length;l+=1){const u=mue(a,i,l);o[l]?(o[l].p(u,c),cn(o[l],1)):(o[l]=wue(u),o[l].c(),cn(o[l],1),o[l].m(t,null))}for(ja(),l=i.length;l<o.length;l+=1)s(l);Ba()}},i(a){if(!r){for(let c=0;c<i.length;c+=1)cn(o[c]);r=!0}},o(a){o=o.filter(Boolean);for(let c=0;c<o.length;c+=1)Sn(o[c]);r=!1},d(a){a&&Ee(e),Kf(o,a)}}}function yue(n){let e,t,r=n[5].filename+"",i,o,s,a,c,l,u=`the highlighted section was used for the tutor's
                                response`,d,h,f,p,g,m,v=n[2].start_char_index>0&&bue(n);p=new By({props:{content:n[5].content.substring(n[2].start_char_index,n[2].end_char_index)}});let b=n[2].end_char_index<n[5].content.length&&Sue(n);return{c(){e=Ne("div"),t=Ne("h2"),i=Jr(r),o=Jr(" Material:"),s=Kt(),a=Ne("hr"),c=Kt(),l=Ne("p"),l.textContent=u,d=Kt(),v&&v.c(),h=Kt(),f=Ne("div"),Bo(p.$$.fragment),g=Kt(),b&&b.c(),this.h()},l(S){e=Fe(S,"DIV",{class:!0});var E=tt(e);t=Fe(E,"H2",{class:!0,style:!0});var w=tt(t);i=Qr(w,r),o=Qr(w," Material:"),w.forEach(Ee),s=Gt(E),a=Fe(E,"HR",{class:!0}),c=Gt(E),l=Fe(E,"P",{class:!0,"data-svelte-h":!0}),Fr(l)!=="svelte-9punnd"&&(l.textContent=u),d=Gt(E),v&&v.l(E),h=Gt(E),f=Fe(E,"DIV",{class:!0});var C=tt(f);Ho(p.$$.fragment,C),C.forEach(Ee),g=Gt(E),b&&b.l(E),E.forEach(Ee),this.h()},h(){Re(t,"class","text-2xl font-bold my-4 svelte-i5a1zh"),Fn(t,"color","#667085"),Re(a,"class","border-t-2 border-black-500 my-4"),Re(l,"class","italic"),Re(f,"class","p-3 bg-yellow-200 rounded-lg"),Re(e,"class","flex flex-col")},m(S,E){Ft(S,e,E),we(e,t),we(t,i),we(t,o),we(e,s),we(e,a),we(e,c),we(e,l),we(e,d),v&&v.m(e,null),we(e,h),we(e,f),Uo(p,f,null),n[13](f),we(e,g),b&&b.m(e,null),m=!0},p(S,E){(!m||E&32)&&r!==(r=S[5].filename+"")&&yl(i,r),S[2].start_char_index>0?v?(v.p(S,E),E&4&&cn(v,1)):(v=bue(S),v.c(),cn(v,1),v.m(e,h)):v&&(ja(),Sn(v,1,1,()=>{v=null}),Ba());const w={};E&36&&(w.content=S[5].content.substring(S[2].start_char_index,S[2].end_char_index)),p.$set(w),S[2].end_char_index<S[5].content.length?b?(b.p(S,E),E&36&&cn(b,1)):(b=Sue(S),b.c(),cn(b,1),b.m(e,null)):b&&(ja(),Sn(b,1,1,()=>{b=null}),Ba())},i(S){m||(cn(v),cn(p.$$.fragment,S),cn(b),m=!0)},o(S){Sn(v),Sn(p.$$.fragment,S),Sn(b),m=!1},d(S){S&&Ee(e),v&&v.d(),zo(p),n[13](null),b&&b.d()}}}function bue(n){let e,t,r;return t=new By({props:{content:n[5].content.substring(0,n[2].start_char_index)}}),{c(){e=Ne("div"),Bo(t.$$.fragment),this.h()},l(i){e=Fe(i,"DIV",{class:!0});var o=tt(e);Ho(t.$$.fragment,o),o.forEach(Ee),this.h()},h(){Re(e,"class","p-3")},m(i,o){Ft(i,e,o),Uo(t,e,null),r=!0},p(i,o){const s={};o&36&&(s.content=i[5].content.substring(0,i[2].start_char_index)),t.$set(s)},i(i){r||(cn(t.$$.fragment,i),r=!0)},o(i){Sn(t.$$.fragment,i),r=!1},d(i){i&&Ee(e),zo(t)}}}function Sue(n){let e,t,r;return t=new By({props:{content:n[5].content.substring(n[2].end_char_index,n[5].content.length)}}),{c(){e=Ne("div"),Bo(t.$$.fragment),this.h()},l(i){e=Fe(i,"DIV",{class:!0});var o=tt(e);Ho(t.$$.fragment,o),o.forEach(Ee),this.h()},h(){Re(e,"class","p-3")},m(i,o){Ft(i,e,o),Uo(t,e,null),r=!0},p(i,o){const s={};o&36&&(s.content=i[5].content.substring(i[2].end_char_index,i[5].content.length)),t.$set(s)},i(i){r||(cn(t.$$.fragment,i),r=!0)},o(i){Sn(t.$$.fragment,i),r=!1},d(i){i&&Ee(e),zo(t)}}}function _ue(n){let e,t,r;return t=new By({props:{content:n[17]}}),{c(){e=Ne("p"),Bo(t.$$.fragment)},l(i){e=Fe(i,"P",{});var o=tt(e);Ho(t.$$.fragment,o),o.forEach(Ee)},m(i,o){Ft(i,e,o),Uo(t,e,null),r=!0},p(i,o){const s={};o&1&&(s.content=i[17]),t.$set(s)},i(i){r||(cn(t.$$.fragment,i),r=!0)},o(i){Sn(t.$$.fragment,i),r=!1},d(i){i&&Ee(e),zo(t)}}}function wue(n){var U,K;let e,t,r,i,o=(((U=n[14])==null?void 0:U.filename)??"Course File")+"",s,a,c=n[2].index+1+"",l,u,d,h,f,p,g="Overview:",m,v,b,S="Details:",E,w,C=n[8](((K=n[5])==null?void 0:K.content.substring(n[2].start_char_index,n[2].end_char_index))??"chunk content")+"",I,T,D,O="Read more",M,R,A,k,L,j=Fs(n[2].metadata_str.split(`
`)),N=[];for(let z=0;z<j.length;z+=1)N[z]=_ue(vue(n,j,z));const B=z=>Sn(N[z],1,1,()=>{N[z]=null});return A=bGe(n[12][0]),{c(){e=Ne("div"),t=Ne("input"),r=Kt(),i=Ne("div"),s=Jr(o),a=Jr(": Part "),l=Jr(c),u=Kt(),d=Ne("div"),h=Ne("hr"),f=Kt(),p=Ne("h2"),p.textContent=g,m=Kt();for(let z=0;z<N.length;z+=1)N[z].c();v=Kt(),b=Ne("h2"),b.textContent=S,E=Kt(),w=Ne("p"),I=Jr(C),T=Jr(` ...
                                    `),D=Ne("a"),D.textContent=O,M=Kt(),this.h()},l(z){e=Fe(z,"DIV",{class:!0});var G=tt(e);t=Fe(G,"INPUT",{type:!0,class:!0}),r=Gt(G),i=Fe(G,"DIV",{class:!0});var te=tt(i);s=Qr(te,o),a=Qr(te,": Part "),l=Qr(te,c),te.forEach(Ee),u=Gt(G),d=Fe(G,"DIV",{class:!0});var ie=tt(d);h=Fe(ie,"HR",{}),f=Gt(ie),p=Fe(ie,"H2",{class:!0,style:!0,"data-svelte-h":!0}),Fr(p)!=="svelte-1wqky9i"&&(p.textContent=g),m=Gt(ie);for(let ge=0;ge<N.length;ge+=1)N[ge].l(ie);v=Gt(ie),b=Fe(ie,"H2",{class:!0,style:!0,"data-svelte-h":!0}),Fr(b)!=="svelte-15wvrkp"&&(b.textContent=S),E=Gt(ie),w=Fe(ie,"P",{});var Q=tt(w);I=Qr(Q,C),T=Qr(Q,` ...
                                    `),D=Fe(Q,"A",{href:!0,class:!0,"data-svelte-h":!0}),Fr(D)!=="svelte-1t5ah7r"&&(D.textContent=O),Q.forEach(Ee),ie.forEach(Ee),M=Gt(G),G.forEach(Ee),this.h()},h(){Re(t,"type","radio"),t.__value=n[16],iv(t,t.__value),Re(t,"class","svelte-i5a1zh"),Re(i,"class","collapse-title text-xl font-bold"),Re(p,"class","text-m svelte-i5a1zh"),Fn(p,"color","#53389E"),Re(b,"class","text-m svelte-i5a1zh"),Fn(b,"color","#53389E"),Re(D,"href","#"),Re(D,"class","read-more-link svelte-i5a1zh"),Re(d,"class","collapse-content svelte-i5a1zh"),Re(e,"class","collapse collapse-plus join-item border-base-300 border svelte-i5a1zh"),A.p(t)},m(z,G){Ft(z,e,G),we(e,t),t.checked=t.__value===n[1],we(e,r),we(e,i),we(i,s),we(i,a),we(i,l),we(e,u),we(e,d),we(d,h),we(d,f),we(d,p),we(d,m);for(let te=0;te<N.length;te+=1)N[te]&&N[te].m(d,null);we(d,v),we(d,b),we(d,E),we(d,w),we(w,I),we(w,T),we(w,D),we(e,M),R=!0,k||(L=[_r(t,"change",n[11]),_r(D,"click",n[9])],k=!0)},p(z,G){var te,ie;if(G&3&&(t.checked=t.__value===z[1]),(!R||G&1)&&o!==(o=(((te=z[14])==null?void 0:te.filename)??"Course File")+"")&&yl(s,o),(!R||G&1)&&c!==(c=z[2].index+1+"")&&yl(l,c),G&1){j=Fs(z[2].metadata_str.split(`
`));let Q;for(Q=0;Q<j.length;Q+=1){const ge=vue(z,j,Q);N[Q]?(N[Q].p(ge,G),cn(N[Q],1)):(N[Q]=_ue(ge),N[Q].c(),cn(N[Q],1),N[Q].m(d,v))}for(ja(),Q=j.length;Q<N.length;Q+=1)B(Q);Ba()}(!R||G&33)&&C!==(C=z[8](((ie=z[5])==null?void 0:ie.content.substring(z[2].start_char_index,z[2].end_char_index))??"chunk content")+"")&&yl(I,C)},i(z){if(!R){for(let G=0;G<j.length;G+=1)cn(N[G]);R=!0}},o(z){N=N.filter(Boolean);for(let G=0;G<N.length;G+=1)Sn(N[G]);R=!1},d(z){z&&Ee(e),Kf(N,z),A.r(),k=!1,qh(L)}}}function wot(n){let e,t,r='<div class="svg-container mr-4 svelte-i5a1zh"><img src="/bulb.svg" alt="bulb" width="55" height="55"/></div> <h1 class="title-header svelte-i5a1zh">References</h1>',i,o,s,a,c,l;const u=[_ot,Sot],d=[];function h(f,p){return f[3]?1:0}return s=h(n),a=d[s]=u[s](n),{c(){e=Ne("div"),t=Ne("div"),t.innerHTML=r,i=Kt(),o=Ne("div"),a.c(),this.h()},l(f){e=Fe(f,"DIV",{class:!0});var p=tt(e);t=Fe(p,"DIV",{class:!0,"data-svelte-h":!0}),Fr(t)!=="svelte-pv6olb"&&(t.innerHTML=r),i=Gt(p),o=Fe(p,"DIV",{class:!0});var g=tt(o);a.l(g),g.forEach(Ee),p.forEach(Ee),this.h()},h(){Re(t,"class","header-container flex items-center justify-center bg-white svelte-i5a1zh"),Re(o,"class",c=$ce(`flex-grow flex flex-row w-full transition-all duration-500 ${n[3]?"document-centered-view":"centered-view"}`)+" svelte-i5a1zh"),Re(e,"class","w-full h-full flex flex-col")},m(f,p){Ft(f,e,p),we(e,t),we(e,i),we(e,o),d[s].m(o,null),l=!0},p(f,[p]){let g=s;s=h(f),s===g?d[s].p(f,p):(ja(),Sn(d[g],1,1,()=>{d[g]=null}),Ba(),a=d[s],a?a.p(f,p):(a=d[s]=u[s](f),a.c()),cn(a,1),a.m(o,null)),(!l||p&8&&c!==(c=$ce(`flex-grow flex flex-row w-full transition-all duration-500 ${f[3]?"document-centered-view":"centered-view"}`)+" svelte-i5a1zh"))&&Re(o,"class",c)},i(f){l||(cn(a),l=!0)},o(f){Sn(a),l=!1},d(f){f&&Ee(e),d[s].d()}}}function Cot(n,e,t){let r,i,{chunks:o}=e,{documents:s}=e;const a=new Map(s.map(v=>[v.id,v]));let c=0,l=!1,u;const d=()=>u==null?void 0:u.scrollIntoView({behavior:"smooth"}),h=v=>{const S=v.split(`
`).slice(0,3).join(`
`);return bot(S)};aee(async()=>{for(let b=0;b<10;b++)await new Promise(requestAnimationFrame),d()}),HT(async()=>{await yGe(),u==null||u.scrollIntoView({behavior:"smooth"})});function f(){t(3,l=!l)}const p=[[]];function g(){c=this.__value,t(1,c)}function m(v){na[v?"unshift":"push"](()=>{u=v,t(4,u)})}return n.$$set=v=>{"chunks"in v&&t(0,o=v.chunks),"documents"in v&&t(10,s=v.documents)},n.$$.update=()=>{n.$$.dirty&3&&t(2,r=o[c]),n.$$.dirty&4&&t(5,i=a.get(r.document_id))},[o,c,r,l,u,i,a,d,h,f,s,g,p,m]}class xot extends fo{constructor(e){super(),po(this,e,Cot,wot,Hi,{chunks:0,documents:10})}}function Cue(n){n[2]=n[4].chunks,n[3]=n[4].documents}function Eot(n){return{c:Dt,l:Dt,m:Dt,p:Dt,i:Dt,o:Dt,d:Dt}}function Iot(n){Cue(n);let e,t;return e=new xot({props:{chunks:n[2],documents:n[3]}}),{c(){Bo(e.$$.fragment)},l(r){Ho(e.$$.fragment,r)},m(r,i){Uo(e,r,i),t=!0},p(r,i){Cue(r)},i(r){t||(cn(e.$$.fragment,r),t=!0)},o(r){Sn(e.$$.fragment,r),t=!1},d(r){zo(e,r)}}}function Pot(n){let e,t='<span class="loading loading-spinner loading-lg w-1/2 h-1/2"></span>';return{c(){e=Ne("div"),e.innerHTML=t,this.h()},l(r){e=Fe(r,"DIV",{class:!0,"data-svelte-h":!0}),Fr(e)!=="svelte-121ntch"&&(e.innerHTML=t),this.h()},h(){Re(e,"class","w-full h-full flex items-center align-middle justify-center")},m(r,i){Ft(r,e,i)},p:Dt,i:Dt,o:Dt,d(r){r&&Ee(e)}}}function kot(n){let e,t,r={ctx:n,current:null,token:null,hasCatch:!1,pending:Pot,then:Iot,catch:Eot,value:4,blocks:[,,,]};return sv(n[0],r),{c(){e=Ne("div"),r.block.c(),this.h()},l(i){e=Fe(i,"DIV",{class:!0});var o=tt(e);r.block.l(o),o.forEach(Ee),this.h()},h(){Re(e,"class","w-full h-full")},m(i,o){Ft(i,e,o),r.block.m(e,r.anchor=null),r.mount=()=>e,r.anchor=null,t=!0},p(i,[o]){n=i,qx(r,n,o)},i(i){t||(cn(r.block),t=!0)},o(i){for(let o=0;o<3;o+=1){const s=r.blocks[o];Sn(s)}t=!1},d(i){i&&Ee(e),r.block.d(),r.token=null,r=null}}}function Tot(n,e,t){let{chatID:r}=e;const i=Ra("chatReferences","query",{chatMsgIdStr:r});return n.$$set=o=>{"chatID"in o&&t(1,r=o.chatID)},[i,r]}class Dot extends fo{constructor(e){super(),po(this,e,Tot,kot,Hi,{chatID:1})}}function xue(n,e,t){const r=n.slice();return r[17]=e[t],r[19]=t,r}function Eue(n){let e,t,r,i,o,s,a=n[17]+"",c,l,u,d;function h(){return n[8](n[19])}return{c(){e=Ne("div"),t=Ne("div"),r=Ne("input"),o=Kt(),s=Ne("div"),c=Jr(a),l=Kt(),this.h()},l(f){e=Fe(f,"DIV",{class:!0});var p=tt(e);t=Fe(p,"DIV",{class:!0,style:!0});var g=tt(t);r=Fe(g,"INPUT",{type:!0,name:!0,class:!0}),g.forEach(Ee),o=Gt(p),s=Fe(p,"DIV",{class:!0});var m=tt(s);c=Qr(m,a),m.forEach(Ee),l=Gt(p),p.forEach(Ee),this.h()},h(){Re(r,"type","radio"),Re(r,"name","response-mode"),Re(r,"class","radio radio-xs"),r.checked=i=n[1]===n[19],Re(t,"class","join-item mr-0 px-1"),Fn(t,"--fallback-bc","var(--neutral-medium)"),Fn(t,"--fallback-b1","var(--neutral-light)"),Re(s,"class","join-item h-2 text-sm text-neutral-medium"),Re(e,"class","join rounded-xl mt-1 mx-1")},m(f,p){Ft(f,e,p),we(e,t),we(t,r),we(e,o),we(e,s),we(s,c),we(e,l),u||(d=_r(r,"change",h),u=!0)},p(f,p){n=f,p&2&&i!==(i=n[1]===n[19])&&(r.checked=i)},d(f){f&&Ee(e),u=!1,d()}}}function Rot(n){let e,t,r,i,o,s="Response mode:",a,c,l,u,d,h,f=Fs(eq),p=[];for(let m=0;m<f.length;m+=1)p[m]=Eue(xue(n,f,m));let g={mode:"send"};return d=new fot({props:g}),n[9](d),d.$on("send",n[10]),d.$on("cancel",n[3]),{c(){e=Ne("div"),t=Ne("div"),r=Kt(),i=Ne("div"),o=Ne("div"),o.textContent=s,a=Kt(),c=Ne("div"),l=Ne("div");for(let m=0;m<p.length;m+=1)p[m].c();u=Kt(),Bo(d.$$.fragment),this.h()},l(m){e=Fe(m,"DIV",{class:!0});var v=tt(e);t=Fe(v,"DIV",{class:!0}),tt(t).forEach(Ee),r=Gt(v),i=Fe(v,"DIV",{class:!0});var b=tt(i);o=Fe(b,"DIV",{class:!0,"data-svelte-h":!0}),Fr(o)!=="svelte-134n4g6"&&(o.textContent=s),a=Gt(b),c=Fe(b,"DIV",{class:!0});var S=tt(c);l=Fe(S,"DIV",{class:!0});var E=tt(l);for(let w=0;w<p.length;w+=1)p[w].l(E);E.forEach(Ee),S.forEach(Ee),u=Gt(b),Ho(d.$$.fragment,b),b.forEach(Ee),v.forEach(Ee),this.h()},h(){Re(t,"class","flex-grow max-h-full overflow-y-scroll bg-white rounded-b-lg border-none"),Re(o,"class","text-xs mx-2 mt-1 text-neutral-medium"),Re(l,"class","indicator pb-0"),Fn(l,"border","1px solid var(--neutral-medium);"),Re(c,"class","mx-1 mb-0"),Re(i,"class","align-baseline rounded-md"),Re(e,"class","flex flex-col h-full bg-neutral-light"),Fn(e,"padding-left","2px"),Fn(e,"padding-right","2px")},m(m,v){Ft(m,e,v),we(e,t),n[7](t),we(e,r),we(e,i),we(i,o),we(i,a),we(i,c),we(c,l);for(let b=0;b<p.length;b+=1)p[b]&&p[b].m(l,null);we(i,u),Uo(d,i,null),h=!0},p(m,[v]){if(v&2){f=Fs(eq);let S;for(S=0;S<f.length;S+=1){const E=xue(m,f,S);p[S]?p[S].p(E,v):(p[S]=Eue(E),p[S].c(),p[S].m(l,null))}for(;S<p.length;S+=1)p[S].d(1);p.length=f.length}const b={};d.$set(b)},i(m){h||(cn(d.$$.fragment,m),h=!0)},o(m){Sn(d.$$.fragment,m),h=!1},d(m){m&&Ee(e),n[7](null),Kf(p,m),n[9](null),zo(d)}}}const eq=["message","multichoice"],hIe="send";function Aot(n,e,t){const r=WL();let i,o=0;const s=()=>ZV(i),a={you:"You",tutor:"Tutor"},c=E=>[{text:"Helpful",action:()=>ey({Component:gue,props:{condition:"helpful"},onClose:w=>Ra("chatFeedback","body",{chat_message_id:E,helpful:!0,comment:w.getValue()??null})})},{text:"Not helpful",action:()=>ey({Component:gue,props:{condition:"not-helpful"},onClose:w=>Ra("chatFeedback","body",{chat_message_id:E,helpful:!1,comment:w.getValue()??null})})},{text:"See references",action:()=>ey({Component:Dot,props:{chatID:E}})}],l=(E,w,C,I=!1,T=void 0)=>{const D=new fue({target:i,props:{message:E,side:w,header:{content:C,stamp:pue()},noMessageOverride:I,buttons:T}});return s(),D},u=(E,w,C=void 0,I=void 0,T=!1)=>{const D=i.children[0],O=a[w],M=new fue({...D?{anchor:D}:{},target:i,props:{message:E,side:O==="You"?"right":"left",header:{content:O,stamp:pue(C)},noMessageOverride:T,buttons:I&&w==="tutor"?c(I):void 0}});return I&&M.setID(I),s(),M};let d=null;const h=()=>{d==null||d()},f=async E=>{p.setMode("cancel");const w=eq[o],C=l(E,"right","You"),I=l("","left","Tutor",w!=="message");r(hIe,{responseMode:w,query:C,response:I,scrollDown:s,finish(){p.setMode("send");const T=I.getID();T&&(I.setButtons(c(T)),I.setAfterUpdateCallback(()=>{s(),I.setAfterUpdateCallback(void 0)})),d=null},setCancelCallback(T){d=T}})};C2e.register();let p;const g=()=>p.getContextContainer();function m(E){na[E?"unshift":"push"](()=>{i=E,t(0,i)})}const v=E=>t(1,o=E);function b(E){na[E?"unshift":"push"](()=>{p=E,t(2,p)})}return[i,o,p,h,f,u,g,m,v,b,({detail:E})=>f(E)]}class Iue extends fo{constructor(e){super(),po(this,e,Aot,Rot,Hi,{prependMessage:5,getContextContainer:6})}get prependMessage(){return this.$$.ctx[5]}get getContextContainer(){return this.$$.ctx[6]}}/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Jee=Symbol("Comlink.proxy"),fIe=Symbol("Comlink.endpoint"),pIe=Symbol("Comlink.releaseProxy"),m4=Symbol("Comlink.finalizer"),v4=Symbol("Comlink.thrown"),gIe=n=>typeof n=="object"&&n!==null||typeof n=="function",Oot={canHandle:n=>gIe(n)&&n[Jee],serialize(n){const{port1:e,port2:t}=new MessageChannel;return ete(n,e),[t,[t]]},deserialize(n){return n.start(),vIe(n)}},Mot={canHandle:n=>gIe(n)&&v4 in n,serialize({value:n}){let e;return n instanceof Error?e={isError:!0,value:{message:n.message,name:n.name,stack:n.stack}}:e={isError:!1,value:n},[e,[]]},deserialize(n){throw n.isError?Object.assign(new Error(n.value.message),n.value):n.value}},Qee=new Map([["proxy",Oot],["throw",Mot]]);function $ot(n,e){for(const t of n)if(e===t||t==="*"||t instanceof RegExp&&t.test(e))return!0;return!1}function ete(n,e=globalThis,t=["*"]){e.addEventListener("message",function r(i){if(!i||!i.data)return;if(!$ot(t,i.origin)){console.warn(`Invalid origin '${i.origin}' for comlink proxy`);return}const{id:o,type:s,path:a}=Object.assign({path:[]},i.data),c=(i.data.argumentList||[]).map(r1);let l;try{const u=a.slice(0,-1).reduce((h,f)=>h[f],n),d=a.reduce((h,f)=>h[f],n);switch(s){case"GET":l=d;break;case"SET":u[a.slice(-1)[0]]=r1(i.data.value),l=!0;break;case"APPLY":l=d.apply(u,c);break;case"CONSTRUCT":{const h=new d(...c);l=HP(h)}break;case"ENDPOINT":{const{port1:h,port2:f}=new MessageChannel;ete(n,f),l=SIe(h,[h])}break;case"RELEASE":l=void 0;break;default:return}}catch(u){l={value:u,[v4]:0}}Promise.resolve(l).catch(u=>({value:u,[v4]:0})).then(u=>{const[d,h]=WM(u);e.postMessage(Object.assign(Object.assign({},d),{id:o}),h),s==="RELEASE"&&(e.removeEventListener("message",r),mIe(e),m4 in n&&typeof n[m4]=="function"&&n[m4]())}).catch(u=>{const[d,h]=WM({value:new TypeError("Unserializable return value"),[v4]:0});e.postMessage(Object.assign(Object.assign({},d),{id:o}),h)})}),e.start&&e.start()}function Lot(n){return n.constructor.name==="MessagePort"}function mIe(n){Lot(n)&&n.close()}function vIe(n,e){return tq(n,[],e)}function JR(n){if(n)throw new Error("Proxy has been released and is not useable")}function yIe(n){return Aw(n,{type:"RELEASE"}).then(()=>{mIe(n)})}const zM=new WeakMap,VM="FinalizationRegistry"in globalThis&&new FinalizationRegistry(n=>{const e=(zM.get(n)||0)-1;zM.set(n,e),e===0&&yIe(n)});function Not(n,e){const t=(zM.get(e)||0)+1;zM.set(e,t),VM&&VM.register(n,e,n)}function Fot(n){VM&&VM.unregister(n)}function tq(n,e=[],t=function(){}){let r=!1;const i=new Proxy(t,{get(o,s){if(JR(r),s===pIe)return()=>{Fot(i),yIe(n),r=!0};if(s==="then"){if(e.length===0)return{then:()=>i};const a=Aw(n,{type:"GET",path:e.map(c=>c.toString())}).then(r1);return a.then.bind(a)}return tq(n,[...e,s])},set(o,s,a){JR(r);const[c,l]=WM(a);return Aw(n,{type:"SET",path:[...e,s].map(u=>u.toString()),value:c},l).then(r1)},apply(o,s,a){JR(r);const c=e[e.length-1];if(c===fIe)return Aw(n,{type:"ENDPOINT"}).then(r1);if(c==="bind")return tq(n,e.slice(0,-1));const[l,u]=Pue(a);return Aw(n,{type:"APPLY",path:e.map(d=>d.toString()),argumentList:l},u).then(r1)},construct(o,s){JR(r);const[a,c]=Pue(s);return Aw(n,{type:"CONSTRUCT",path:e.map(l=>l.toString()),argumentList:a},c).then(r1)}});return Not(i,n),i}function jot(n){return Array.prototype.concat.apply([],n)}function Pue(n){const e=n.map(WM);return[e.map(t=>t[0]),jot(e.map(t=>t[1]))]}const bIe=new WeakMap;function SIe(n,e){return bIe.set(n,e),n}function HP(n){return Object.assign(n,{[Jee]:!0})}function Bot(n,e=globalThis,t="*"){return{postMessage:(r,i)=>n.postMessage(r,t,i),addEventListener:e.addEventListener.bind(e),removeEventListener:e.removeEventListener.bind(e)}}function WM(n){for(const[e,t]of Qee)if(t.canHandle(n)){const[r,i]=t.serialize(n);return[{type:"HANDLER",name:e,value:r},i]}return[{type:"RAW",value:n},bIe.get(n)||[]]}function r1(n){switch(n.type){case"HANDLER":return Qee.get(n.name).deserialize(n.value);case"RAW":return n.value}}function Aw(n,e,t){return new Promise(r=>{const i=Hot();n.addEventListener("message",function o(s){!s.data||!s.data.id||s.data.id!==i||(n.removeEventListener("message",o),r(s.data))}),n.start&&n.start(),n.postMessage(Object.assign({id:i},e),t)})}function Hot(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}const Uot=Object.freeze(Object.defineProperty({__proto__:null,createEndpoint:fIe,expose:ete,finalizer:m4,proxy:HP,proxyMarker:Jee,releaseProxy:pIe,transfer:SIe,transferHandlers:Qee,windowEndpoint:Bot,wrap:vIe},Symbol.toStringTag,{value:"Module"}));var _Ie={exports:{}},zj={exports:{}},wIe={exports:{}};(function(n,e){(function(t,r){n.exports=r()})(self,function(){return(()=>{var t={d:(w,C)=>{for(var I in C)t.o(C,I)&&!t.o(w,I)&&Object.defineProperty(w,I,{enumerable:!0,get:C[I]})},o:(w,C)=>Object.prototype.hasOwnProperty.call(w,C),r:w=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(w,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(w,"__esModule",{value:!0})}},r={};t.r(r),t.d(r,{isServiceWorkerRequest:()=>a,serviceWorkerFetchListener:()=>c,asyncSleep:()=>l,ServiceWorkerError:()=>u,writeMessageAtomics:()=>d,writeMessageServiceWorker:()=>h,writeMessage:()=>f,makeChannel:()=>p,makeAtomicsChannel:()=>g,makeServiceWorkerChannel:()=>m,readMessage:()=>b,syncSleep:()=>S,uuidv4:()=>E});var i=function(w,C,I,T){return new(I||(I=Promise))(function(D,O){function M(k){try{A(T.next(k))}catch(L){O(L)}}function R(k){try{A(T.throw(k))}catch(L){O(L)}}function A(k){var L;k.done?D(k.value):(L=k.value,L instanceof I?L:new I(function(j){j(L)})).then(M,R)}A((T=T.apply(w,[])).next())})};const o="__SyncMessageServiceWorkerInput__",s="__sync-message-v2__";function a(w){return typeof w!="string"&&(w=w.request.url),w.includes(o)}function c(){const w={},C={};return I=>{const{url:T}=I.request;return!!a(T)&&(I.respondWith(function(){return i(this,void 0,void 0,function*(){function D(O){const M={message:O,version:s};return new Response(JSON.stringify(M),{status:200})}if(T.endsWith("/read")){const{messageId:O,timeout:M}=yield I.request.json();if(O in w){const R=w[O];return delete w[O],D(R)}return yield new Promise(R=>{C[O]=R,setTimeout(function(){delete C[O],R(new Response("",{status:408}))},M)})}if(T.endsWith("/write")){const{message:O,messageId:M}=yield I.request.json(),R=C[M];return R?(R(D(O)),delete C[M]):w[M]=O,D({early:!R})}if(T.endsWith("/version"))return new Response(s,{status:200})})}()),!0)}}function l(w){return new Promise(C=>setTimeout(C,w))}class u extends Error{constructor(C,I){super(`Received status ${I} from ${C}. Ensure the service worker is registered and active.`),this.url=C,this.status=I,this.type="ServiceWorkerError",Object.setPrototypeOf(this,u.prototype)}}function d(w,C){const I=new TextEncoder().encode(JSON.stringify(C)),{data:T,meta:D}=w;if(I.length>T.length)throw new Error("Message is too big, increase bufferSize when making channel.");T.set(I,0),Atomics.store(D,0,I.length),Atomics.store(D,1,1),Atomics.notify(D,1)}function h(w,C,I){return i(this,void 0,void 0,function*(){yield navigator.serviceWorker.ready;const T=w.baseUrl+"/write",D=Date.now();for(;;){const O={message:C,messageId:I},M=yield fetch(T,{method:"POST",body:JSON.stringify(O)});if(M.status===200&&(yield M.json()).version===s)return;if(!(Date.now()-D<w.timeout))throw new u(T,M.status);yield l(100)}})}function f(w,C,I){return i(this,void 0,void 0,function*(){w.type==="atomics"?d(w,C):yield h(w,C,I)})}function p(w={}){return typeof SharedArrayBuffer<"u"?g(w.atomics):"serviceWorker"in navigator?m(w.serviceWorker):null}function g({bufferSize:w}={}){return{type:"atomics",data:new Uint8Array(new SharedArrayBuffer(w||131072)),meta:new Int32Array(new SharedArrayBuffer(2*Int32Array.BYTES_PER_ELEMENT))}}function m(w={}){return{type:"serviceWorker",baseUrl:(w.scope||"/")+o,timeout:w.timeout||5e3}}function v(w,C){return w>0?+w:C}function b(w,C,{checkInterrupt:I,checkTimeout:T,timeout:D}={}){const O=performance.now();T=v(T,I?100:5e3);const M=v(D,Number.POSITIVE_INFINITY);let R;if(w.type==="atomics"){const{data:A,meta:k}=w;R=()=>{if(Atomics.wait(k,1,0,T)==="timed-out")return null;{const L=Atomics.exchange(k,0,0),j=A.slice(0,L);Atomics.store(k,1,0);const N=new TextDecoder().decode(j);return JSON.parse(N)}}}else R=()=>{const A=new XMLHttpRequest,k=w.baseUrl+"/read";A.open("POST",k,!1);const L={messageId:C,timeout:T};A.send(JSON.stringify(L));const{status:j}=A;if(j===408)return null;if(j===200){const N=JSON.parse(A.responseText);return N.version!==s?null:N.message}if(performance.now()-O<w.timeout)return null;throw new u(k,j)};for(;;){const A=M-(performance.now()-O);if(A<=0)return null;T=Math.min(T,A);const k=R();if(k!==null)return k;if(I!=null&&I())return null}}function S(w,C){if(w=v(w,0))if(typeof SharedArrayBuffer<"u"){const I=new Int32Array(new SharedArrayBuffer(Int32Array.BYTES_PER_ELEMENT));I[0]=0,Atomics.wait(I,0,0,w)}else b(C,`sleep ${w} ${E()}`,{timeout:w})}let E;return E="randomUUID"in crypto?function(){return crypto.randomUUID()}:function(){return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,w=>{const C=Number(w);return(C^crypto.getRandomValues(new Uint8Array(1))[0]&15>>C/4).toString(16)})},r})()})})(wIe);var y4=wIe.exports;const CIe=pee(Uot);var kue;function zot(){return kue||(kue=1,function(n,e){(function(t,r){n.exports=r(y4,CIe)})(self,function(t,r){return(()=>{var i={272:c=>{c.exports=r},746:c=>{c.exports=t}},o={};function s(c){var l=o[c];if(l!==void 0)return l.exports;var u=o[c]={exports:{}};return i[c](u,u.exports,s),u.exports}s.n=c=>{var l=c&&c.__esModule?()=>c.default:()=>c;return s.d(l,{a:l}),l},s.d=(c,l)=>{for(var u in l)s.o(l,u)&&!s.o(c,u)&&Object.defineProperty(c,u,{enumerable:!0,get:l[u]})},s.o=(c,l)=>Object.prototype.hasOwnProperty.call(c,l),s.r=c=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(c,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(c,"__esModule",{value:!0})};var a={};return(()=>{s.r(a),s.d(a,{InterruptError:()=>d,NoChannelError:()=>h,SyncClient:()=>f,syncExpose:()=>p});var c=s(746),l=s(272),u=function(m,v,b,S){return new(b||(b=Promise))(function(E,w){function C(D){try{T(S.next(D))}catch(O){w(O)}}function I(D){try{T(S.throw(D))}catch(O){w(O)}}function T(D){var O;D.done?E(D.value):(O=D.value,O instanceof b?O:new b(function(M){M(O)})).then(C,I)}T((S=S.apply(m,[])).next())})};class d extends Error{constructor(){super(...arguments),this.type="InterruptError",this.name=this.type}}class h extends Error{constructor(){super(...arguments),this.type="NoChannelError",this.name=this.type}}class f{constructor(v,b){this.workerCreator=v,this.channel=b,this.state="idle",this._messageIdBase="",this._messageIdSeq=0,this._start()}interrupt(){return u(this,void 0,void 0,function*(){this.state!=="idle"&&(this.state!=="awaitingMessage"&&this.state!=="sleeping"?this.interrupter?yield this.interrupter():(this.terminate(),this._start()):yield this._writeMessage({interrupted:!0}))})}call(v,...b){return u(this,void 0,void 0,function*(){if(this.state!=="idle")throw new Error(`State is ${this.state}, not idle`);let S=!0;this.state="running",this._messageIdBase=(0,c.uuidv4)(),this._messageIdSeq=0;const E=w=>{var C;S&&w!=="init"&&(w==="reading"?(this.state="awaitingMessage",this._messageIdSeq++,(C=this._awaitingMessageResolve)===null||C===void 0||C.call(this)):w==="sleeping"?(this.state="sleeping",this._messageIdSeq++):w==="slept"&&(this.state="running"))};this._interruptPromise=new Promise((w,C)=>this._interruptRejector=C);try{return yield Promise.race([v(this.channel,l.proxy(E),this._messageIdBase,...b),this._interruptPromise])}finally{S=!1,this._reset()}})}writeMessage(v){return u(this,void 0,void 0,function*(){if(this.state==="idle"||!this._messageIdBase)throw new Error("No active call to send a message to.");if(this.state!=="awaitingMessage"){if(this._awaitingMessageResolve)throw new Error("Not waiting for message, and another write is already queued.");yield new Promise(b=>{this._awaitingMessageResolve=b}),delete this._awaitingMessageResolve}yield this._writeMessage({message:v})})}terminate(){var v;(v=this._interruptRejector)===null||v===void 0||v.call(this,new d("Worker terminated")),this.workerProxy[l.releaseProxy](),this.worker.terminate(),delete this.workerProxy,delete this.worker}_writeMessage(v){return u(this,void 0,void 0,function*(){this.state="running";const b=g(this._messageIdBase,this._messageIdSeq);yield(0,c.writeMessage)(this.channel,v,b)})}_start(){this._reset(),this.worker=this.workerCreator(),this.workerProxy=l.wrap(this.worker)}_reset(){this.state="idle",delete this._interruptPromise,delete this._interruptRejector,delete this._awaitingMessageResolve,delete this._messageIdBase}}function p(m){return function(v,b,S,...E){return u(this,void 0,void 0,function*(){yield b("init");let w=0;function C(I,T){if(!v)throw new h;b(I);const D=g(S,++w),O=(0,c.readMessage)(v,D,T);if(O){const{message:M,interrupted:R}=O;if(R)throw new d;return M}I==="sleeping"&&b("slept")}return m({channel:v,readMessage:()=>C("reading"),syncSleep(I){I>0&&C("sleeping",{timeout:I})}},...E)})}}function g(m,v){return`${m}-${v}`}})(),a})()})}(zj)),zj.exports}function rP(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var QR={exports:{}},Tue;function Vot(){return Tue||(Tue=1,function(n,e){(function(t,r){r(e)})(Ir,function(t){var r={exports:{}},i={exports:{}};(function(C,I){C.exports=function(){function T(z){return!isNaN(parseFloat(z))&&isFinite(z)}function D(z){return z.charAt(0).toUpperCase()+z.substring(1)}function O(z){return function(){return this[z]}}var M=["isConstructor","isEval","isNative","isToplevel"],R=["columnNumber","lineNumber"],A=["fileName","functionName","source"],k=["args"],L=["evalOrigin"],j=M.concat(R,A,k,L);function N(z){if(z)for(var G=0;G<j.length;G++)z[j[G]]!==void 0&&this["set"+D(j[G])](z[j[G]])}N.prototype={getArgs:function(){return this.args},setArgs:function(z){if(Object.prototype.toString.call(z)!=="[object Array]")throw new TypeError("Args must be an Array");this.args=z},getEvalOrigin:function(){return this.evalOrigin},setEvalOrigin:function(z){if(z instanceof N)this.evalOrigin=z;else{if(!(z instanceof Object))throw new TypeError("Eval Origin must be an Object or StackFrame");this.evalOrigin=new N(z)}},toString:function(){var z=this.getFileName()||"",G=this.getLineNumber()||"",te=this.getColumnNumber()||"",ie=this.getFunctionName()||"";return this.getIsEval()?z?"[eval] ("+z+":"+G+":"+te+")":"[eval]:"+G+":"+te:ie?ie+" ("+z+":"+G+":"+te+")":z+":"+G+":"+te}},N.fromString=function(z){var G=z.indexOf("("),te=z.lastIndexOf(")"),ie=z.substring(0,G),Q=z.substring(G+1,te).split(","),ge=z.substring(te+1);if(ge.indexOf("@")===0)var _e=/@(.+?)(?::(\d+))?(?::(\d+))?$/.exec(ge,""),Se=_e[1],se=_e[2],ee=_e[3];return new N({functionName:ie,args:Q||void 0,fileName:Se,lineNumber:se||void 0,columnNumber:ee||void 0})};for(var B=0;B<M.length;B++)N.prototype["get"+D(M[B])]=O(M[B]),N.prototype["set"+D(M[B])]=function(z){return function(G){this[z]=!!G}}(M[B]);for(var U=0;U<R.length;U++)N.prototype["get"+D(R[U])]=O(R[U]),N.prototype["set"+D(R[U])]=function(z){return function(G){if(!T(G))throw new TypeError(z+" must be a Number");this[z]=Number(G)}}(R[U]);for(var K=0;K<A.length;K++)N.prototype["get"+D(A[K])]=O(A[K]),N.prototype["set"+D(A[K])]=function(z){return function(G){this[z]=String(G)}}(A[K]);return N}()})(i),function(C,I){var T,D,O,M;C.exports=(T=i.exports,D=/(^|@)\S+:\d+/,O=/^\s*at .*(\S+:\d+|\(native\))/m,M=/^(eval@)?(\[native code])?$/,{parse:function(R){if(R.stacktrace!==void 0||R["opera#sourceloc"]!==void 0)return this.parseOpera(R);if(R.stack&&R.stack.match(O))return this.parseV8OrIE(R);if(R.stack)return this.parseFFOrSafari(R);throw new Error("Cannot parse given Error object")},extractLocation:function(R){if(R.indexOf(":")===-1)return[R];var A=/(.+?)(?::(\d+))?(?::(\d+))?$/.exec(R.replace(/[()]/g,""));return[A[1],A[2]||void 0,A[3]||void 0]},parseV8OrIE:function(R){return R.stack.split(`
`).filter(function(A){return!!A.match(O)},this).map(function(A){A.indexOf("(eval ")>-1&&(A=A.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(,.*$)/g,""));var k=A.replace(/^\s+/,"").replace(/\(eval code/g,"(").replace(/^.*?\s+/,""),L=k.match(/ (\(.+\)$)/);k=L?k.replace(L[0],""):k;var j=this.extractLocation(L?L[1]:k),N=L&&k||void 0,B=["eval","<anonymous>"].indexOf(j[0])>-1?void 0:j[0];return new T({functionName:N,fileName:B,lineNumber:j[1],columnNumber:j[2],source:A})},this)},parseFFOrSafari:function(R){return R.stack.split(`
`).filter(function(A){return!A.match(M)},this).map(function(A){if(A.indexOf(" > eval")>-1&&(A=A.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1")),A.indexOf("@")===-1&&A.indexOf(":")===-1)return new T({functionName:A});var k=/((.*".+"[^@]*)?[^@]*)(?:@)/,L=A.match(k),j=L&&L[1]?L[1]:void 0,N=this.extractLocation(A.replace(k,""));return new T({functionName:j,fileName:N[0],lineNumber:N[1],columnNumber:N[2],source:A})},this)},parseOpera:function(R){return!R.stacktrace||R.message.indexOf(`
`)>-1&&R.message.split(`
`).length>R.stacktrace.split(`
`).length?this.parseOpera9(R):R.stack?this.parseOpera11(R):this.parseOpera10(R)},parseOpera9:function(R){for(var A=/Line (\d+).*script (?:in )?(\S+)/i,k=R.message.split(`
`),L=[],j=2,N=k.length;j<N;j+=2){var B=A.exec(k[j]);B&&L.push(new T({fileName:B[2],lineNumber:B[1],source:k[j]}))}return L},parseOpera10:function(R){for(var A=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,k=R.stacktrace.split(`
`),L=[],j=0,N=k.length;j<N;j+=2){var B=A.exec(k[j]);B&&L.push(new T({functionName:B[3]||void 0,fileName:B[2],lineNumber:B[1],source:k[j]}))}return L},parseOpera11:function(R){return R.stack.split(`
`).filter(function(A){return!!A.match(D)&&!A.match(/^Error created at/)},this).map(function(A){var k,L=A.split("@"),j=this.extractLocation(L.pop()),N=L.shift()||"",B=N.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^)]*\)/g,"")||void 0;N.match(/\(([^)]*)\)/)&&(k=N.replace(/^[^(]+\(([^)]*)\)$/,"$1"));var U=k===void 0||k==="[arguments not available]"?void 0:k.split(",");return new T({functionName:B,args:U,fileName:j[0],lineNumber:j[1],columnNumber:j[2],source:A})},this)}})}(r);var o=r.exports;const s=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string"&&process.browser===void 0;let a,c,l,u,d,h,f,p,g;if(h=s?function(C,I){return l.resolve(I||".",C)}:function(C,I){return I===void 0&&(I=location),new URL(C,I).toString()},s||(f="/"),p=s?async function(C,I){if(C.startsWith("file://")&&(C=C.slice(7)),C.includes("://")){let T=await c(C);if(!T.ok)throw new Error(`Failed to load '${C}': request failed.`);return new Uint8Array(await T.arrayBuffer())}{const T=await d.readFile(C);return new Uint8Array(T.buffer,T.byteOffset,T.byteLength)}}:async function(C,I){const T=new URL(C,location);let D=I?{integrity:I}:{},O=await fetch(T,D);if(!O.ok)throw new Error(`Failed to load '${T}': request failed.`);return new Uint8Array(await O.arrayBuffer())},globalThis.document)g=async C=>await import(C);else if(globalThis.importScripts)g=async C=>{try{globalThis.importScripts(C)}catch(I){if(!(I instanceof TypeError))throw I;await import(C)}};else{if(!s)throw new Error("Cannot determine runtime environment");g=async function(C){C.startsWith("file://")&&(C=C.slice(7)),C.includes("://")?u.runInThisContext(await(await c(C)).text()):await import(a.pathToFileURL(C).href)}}function m(C){var I=typeof Symbol=="function"&&Symbol.iterator,T=I&&C[I],D=0;if(T)return T.call(C);if(C&&typeof C.length=="number")return{next:function(){return C&&D>=C.length&&(C=void 0),{value:C&&C[D++],done:!C}}};throw new TypeError(I?"Object is not iterable.":"Symbol.iterator is not defined.")}function v(C){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var I,T=C[Symbol.asyncIterator];return T?T.call(C):(C=m(C),I={},D("next"),D("throw"),D("return"),I[Symbol.asyncIterator]=function(){return this},I);function D(O){I[O]=C[O]&&function(M){return new Promise(function(R,A){(function(k,L,j,N){Promise.resolve(N).then(function(B){k({value:B,done:j})},L)})(R,A,(M=C[O](M)).done,M.value)})}}}const b=async C=>{const I=[];await async function D(O){var M,R;try{for(var A,k=v(O.values());!(A=await k.next()).done;){const L=A.value;I.push(L),L.kind==="directory"&&await D(L)}}catch(L){M={error:L}}finally{try{A&&!A.done&&(R=k.return)&&await R.call(k)}finally{if(M)throw M.error}}}(C);const T=new Map;T.set(".",C);for(const D of I){const O=(await C.resolve(D)).join("/");T.set(O,D)}return T};function S(C,I){let T;T=I.stdLibURL!=null?I.stdLibURL:I.indexURL+"python_stdlib.zip",function(D,O){const M=p(O);D.preRun.push(()=>{const R=D._py_version_major(),A=D._py_version_minor();D.FS.mkdirTree("/lib"),D.FS.mkdirTree(`/lib/python${R}.${A}/site-packages`),D.addRunDependency("install-stdlib"),M.then(k=>{D.FS.writeFile(`/lib/python${R}${A}.zip`,k)}).catch(k=>{console.error("Error occurred while installing the standard library:"),console.error(k)}).finally(()=>{D.removeRunDependency("install-stdlib")})})}(C,T),function(D,O){D.preRun.push(function(){try{D.FS.mkdirTree(O)}catch(M){console.error(`Error occurred while making a home directory '${O}':`),console.error(M),console.error("Using '/' for a home directory instead"),O="/"}D.ENV.HOME=O,D.FS.chdir(O)})}(C,I.homedir),function(D,O){D.preRun.push(()=>{for(const M of O)D.FS.mkdirTree(M),D.FS.mount(D.FS.filesystems.NODEFS,{root:M},M)})}(C,I._node_mounts),C.preRun.push(()=>function(D){const O=D.FS,M=D.FS.filesystems.MEMFS,R=D.PATH,A={DIR_MODE:16895,FILE_MODE:33279,mount:function(k){if(!k.opts.fileSystemHandle)throw new Error("opts.fileSystemHandle is required");return M.mount.apply(null,arguments)},syncfs:async(k,L,j)=>{try{const N=A.getLocalSet(k),B=await A.getRemoteSet(k),U=L?B:N,K=L?N:B;await A.reconcile(k,U,K),j(null)}catch(N){j(N)}},getLocalSet:k=>{let L=Object.create(null);function j(U){return U!=="."&&U!==".."}function N(U){return K=>R.join2(U,K)}let B=O.readdir(k.mountpoint).filter(j).map(N(k.mountpoint));for(;B.length;){let U=B.pop(),K=O.stat(U);O.isDir(K.mode)&&B.push.apply(B,O.readdir(U).filter(j).map(N(U))),L[U]={timestamp:K.mtime,mode:K.mode}}return{type:"local",entries:L}},getRemoteSet:async k=>{const L=Object.create(null),j=await b(k.opts.fileSystemHandle);for(const[N,B]of j)N!=="."&&(L[R.join2(k.mountpoint,N)]={timestamp:B.kind==="file"?(await B.getFile()).lastModifiedDate:new Date,mode:B.kind==="file"?A.FILE_MODE:A.DIR_MODE});return{type:"remote",entries:L,handles:j}},loadLocalEntry:k=>{const L=O.lookupPath(k).node,j=O.stat(k);if(O.isDir(j.mode))return{timestamp:j.mtime,mode:j.mode};if(O.isFile(j.mode))return L.contents=M.getFileDataAsTypedArray(L),{timestamp:j.mtime,mode:j.mode,contents:L.contents};throw new Error("node type not supported")},storeLocalEntry:(k,L)=>{if(O.isDir(L.mode))O.mkdirTree(k,L.mode);else{if(!O.isFile(L.mode))throw new Error("node type not supported");O.writeFile(k,L.contents,{canOwn:!0})}O.chmod(k,L.mode),O.utime(k,L.timestamp,L.timestamp)},removeLocalEntry:k=>{var L=O.stat(k);O.isDir(L.mode)?O.rmdir(k):O.isFile(L.mode)&&O.unlink(k)},loadRemoteEntry:async k=>{if(k.kind==="file"){const L=await k.getFile();return{contents:new Uint8Array(await L.arrayBuffer()),mode:A.FILE_MODE,timestamp:L.lastModifiedDate}}if(k.kind==="directory")return{mode:A.DIR_MODE,timestamp:new Date};throw new Error("unknown kind: "+k.kind)},storeRemoteEntry:async(k,L,j)=>{const N=k.get(R.dirname(L)),B=O.isFile(j.mode)?await N.getFileHandle(R.basename(L),{create:!0}):await N.getDirectoryHandle(R.basename(L),{create:!0});if(B.kind==="file"){const U=await B.createWritable();await U.write(j.contents),await U.close()}k.set(L,B)},removeRemoteEntry:async(k,L)=>{await k.get(R.dirname(L)).removeEntry(R.basename(L)),k.delete(L)},reconcile:async(k,L,j)=>{let N=0;const B=[];Object.keys(L.entries).forEach(function(z){const G=L.entries[z],te=j.entries[z];(!te||O.isFile(G.mode)&&G.timestamp.getTime()>te.timestamp.getTime())&&(B.push(z),N++)}),B.sort();const U=[];if(Object.keys(j.entries).forEach(function(z){L.entries[z]||(U.push(z),N++)}),U.sort().reverse(),!N)return;const K=L.type==="remote"?L.handles:j.handles;for(const z of B){const G=R.normalize(z.replace(k.mountpoint,"/")).substring(1);if(j.type==="local"){const te=K.get(G),ie=await A.loadRemoteEntry(te);A.storeLocalEntry(z,ie)}else{const te=A.loadLocalEntry(z);await A.storeRemoteEntry(K,G,te)}}for(const z of U)if(j.type==="local")A.removeLocalEntry(z);else{const G=R.normalize(z.replace(k.mountpoint,"/")).substring(1);await A.removeRemoteEntry(K,G)}}};D.FS.filesystems.NATIVEFS_ASYNC=A}(C))}function E(C,I){C.runPythonInternal_dict=C._pyodide._base.eval_code("{}"),C.importlib=C.runPythonInternal("import importlib; importlib");let T=C.importlib.import_module;C.sys=T("sys"),C.sys.path.insert(0,I.homedir),C.os=T("os");let D=C.runPythonInternal("import __main__; __main__.__dict__"),O=C.runPythonInternal("import builtins; builtins.__dict__");var M;C.globals=(M=O,new Proxy(D,{get:(k,L)=>L==="get"?j=>{let N=k.get(j);return N===void 0&&(N=M.get(j)),N}:L==="has"?j=>k.has(j)||M.has(j):Reflect.get(k,L)}));let R=C._pyodide._importhook;R.register_js_finder.callKwargs({hook:function(k){"__all__"in k||Object.defineProperty(k,"__all__",{get:()=>A.toPy(Object.getOwnPropertyNames(k).filter(L=>L!=="__all__")),enumerable:!1,configurable:!0})}}),R.register_js_module("js",I.jsglobals);let A=C.makePublicAPI();return R.register_js_module("pyodide_js",A),C.pyodide_py=T("pyodide"),C.pyodide_code=T("pyodide.code"),C.pyodide_ffi=T("pyodide.ffi"),C.package_loader=T("pyodide._package_loader"),C.sitepackages=C.package_loader.SITE_PACKAGES.__str__(),C.dsodir=C.package_loader.DSO_DIR.__str__(),C.defaultLdLibraryPath=[C.dsodir,C.sitepackages],C.os.environ.__setitem__("LD_LIBRARY_PATH",C.defaultLdLibraryPath.join(":")),A.pyodide_py=C.pyodide_py,A.globals=C.globals,A}async function w(C={}){await async function(){if(!s||(a=(await bd(()=>import("../chunks/__vite-browser-external.IEDOrHhg.js").then(N=>N._),[],import.meta.url)).default,d=await bd(()=>import("../chunks/__vite-browser-external.IEDOrHhg.js").then(N=>N._),[],import.meta.url),c=globalThis.fetch?fetch:(await bd(()=>import("../chunks/index.BbTkrgG2.js"),__vite__mapDeps([0,1,2,3,4,5,6]),import.meta.url)).default,u=(await bd(()=>import("../chunks/__vite-browser-external.IEDOrHhg.js").then(N=>N._),[],import.meta.url)).default,l=await bd(()=>import("../chunks/__vite-browser-external.IEDOrHhg.js").then(N=>N._),[],import.meta.url),f=l.sep,typeof rP<"u"))return;const j={fs:await bd(()=>import("../chunks/__vite-browser-external.IEDOrHhg.js").then(N=>N._),[],import.meta.url),crypto:await bd(()=>import("../chunks/__vite-browser-external.IEDOrHhg.js").then(N=>N._),[],import.meta.url),ws:await bd(()=>import("../chunks/__vite-browser-external.IEDOrHhg.js").then(N=>N._),[],import.meta.url),child_process:await bd(()=>import("../chunks/__vite-browser-external.IEDOrHhg.js").then(N=>N._),[],import.meta.url)};globalThis.require=function(N){return j[N]}}();let I=C.indexURL||function(){if(typeof __dirname=="string")return __dirname;let j;try{throw new Error}catch(U){j=U}let N=o.parse(j)[0].fileName;const B=N.lastIndexOf(f);if(B===-1)throw new Error("Could not extract indexURL path from pyodide module location");return N.slice(0,B)}();I=h(I),I.endsWith("/")||(I+="/"),C.indexURL=I;const T={fullStdLib:!1,jsglobals:globalThis,stdin:globalThis.prompt?globalThis.prompt:void 0,homedir:"/home/pyodide",lockFileURL:I+"repodata.json",args:[],_node_mounts:[],packageCacheDir:I},D=Object.assign(T,C),O=function(){let j={noImageDecoding:!0,noAudioDecoding:!0,noWasmDecoding:!1,preRun:[],quit:(N,B)=>{throw j.exited={status:N,toThrow:B},B}};return j}();O.print=D.stdout,O.printErr=D.stderr,O.arguments=D.args;const M={config:D};O.API=M,S(O,D);const R=new Promise(j=>O.postRun=j);if(O.locateFile=j=>D.indexURL+j,typeof _createPyodideModule!="function"){const j=`${D.indexURL}pyodide.asm.js`;await g(j)}if(await _createPyodideModule(O),await R,O.exited)throw O.exited.toThrow;if(M.version!=="0.23.4")throw new Error(`Pyodide version does not match: '0.23.4' <==> '${M.version}'. If you updated the Pyodide version, make sure you also updated the 'indexURL' parameter passed to loadPyodide.`);O.locateFile=j=>{throw new Error("Didn't expect to load any more file_packager files!")};let[A,k]=M.rawRun("import _pyodide_core");A&&O.API.fatal_loading_error(`Failed to import _pyodide_core
`,k);const L=E(M,D);if(L.version.includes("dev")||M.setCdnUrl(`https://cdn.jsdelivr.net/pyodide/v${L.version}/full/`),await M.packageIndexReady,M._pyodide._importhook.register_module_not_found_hook(M._import_name_to_package_name,M.repodata_unvendored_stdlibs_and_test),M.repodata_info.version!=="0.23.4")throw new Error("Lock file version doesn't match Pyodide version");return M.package_loader.init_loaded_packages(),D.fullStdLib&&await L.loadPackage(M.repodata_unvendored_stdlibs),M.initializeStreams(D.stdin,D.stdout,D.stderr),L}globalThis.loadPyodide=w,t.loadPyodide=w,t.version="0.23.4",Object.defineProperty(t,"__esModule",{value:!0})})}(QR,QR.exports)),QR.exports}(function(n,e){(function(t,r){n.exports=r(zot(),CIe,Vot())})(self,(t,r,i)=>(()=>{var o={237:(l,u,d)=>{d.d(u,{Z:()=>h});const h=`import importlib
import sys
from typing import Callable, Literal, Union, TypedDict

try:
    from pyodide.code import find_imports  # noqa
except ImportError:
    from pyodide import find_imports  # noqa

import pyodide_js  # noqa

sys.setrecursionlimit(400)


class InstallEntry(TypedDict):
    module: str
    package: str


def find_imports_to_install(imports: list[str]) -> list[InstallEntry]:
    """
    Given a list of module names being imported, return a list of dicts
    representing the packages that need to be installed to import those modules.
    The returned list will only contain modules that aren't already installed.
    Each returned dict has the following keys:
      - module: the name of the module being imported
      - package: the name of the package that needs to be installed
    """
    try:
        to_package_name = pyodide_js._module._import_name_to_package_name.to_py()
    except AttributeError:
        to_package_name = pyodide_js._api._import_name_to_package_name.to_py()

    to_install: list[InstallEntry] = []
    for module in imports:
        try:
            importlib.import_module(module)
        except ModuleNotFoundError:
            to_install.append(
                dict(
                    module=module,
                    package=to_package_name.get(module, module),
                )
            )
    return to_install


async def install_imports(
    source_code_or_imports: Union[str, list[str]],
    message_callback: Callable[
        [
            Literal[
                "loading_all",
                "loaded_all",
                "loading_one",
                "loaded_one",
                "loading_micropip",
                "loaded_micropip",
            ],
            Union[InstallEntry, list[InstallEntry]],
        ],
        None,
    ] = lambda event_type, data: None,
):
    """
    Accepts a string of Python source code or a list of module names being imported.
    Installs any packages that need to be installed to import those modules,
    using micropip, which may also be installed if needed.
    If the package is not specially built for Pyodide, it must be available on PyPI
    as a pure Python wheel file.
    If the \`message_callback\` argument is provided, it will be called with an
    event type and data about the packages being installed.
    The event types start with \`loading_\` before installation, and \`loaded_\` after.
    The data is either a single dict representing the package being installed,
    or a list of all the packages being installed.
    The events are:
        - loading/loaded_all, with a list of all the packages being installed.
        - loading/loaded_one, with a dict for a single package.
        - loading/loaded_micropip, with a dict for the special micropip package.
    """
    if isinstance(source_code_or_imports, str):
        try:
            imports: list[str] = find_imports(source_code_or_imports)
        except SyntaxError:
            return
    else:
        imports: list[str] = source_code_or_imports

    to_install = find_imports_to_install(imports)
    if to_install:
        message_callback("loading_all", to_install)
        try:
            import micropip  # noqa
        except ModuleNotFoundError:
            micropip_entry = dict(module="micropip", package="micropip")
            message_callback("loading_micropip", micropip_entry)
            await pyodide_js.loadPackage("micropip")
            import micropip  # noqa

            message_callback("loaded_micropip", micropip_entry)

        for entry in to_install:
            message_callback("loading_one", entry)
            await micropip.install(entry["package"])
            message_callback("loaded_one", entry)
        message_callback("loaded_all", to_install)
`},353:(l,u,d)=>{l.exports=d(846)},846:(l,u,d)=>{var h=d(960);u.operation=function(f){var p=u.timeouts(f);return new h(p,{forever:f&&(f.forever||f.retries===1/0),unref:f&&f.unref,maxRetryTime:f&&f.maxRetryTime})},u.timeouts=function(f){if(f instanceof Array)return[].concat(f);var p={retries:10,factor:2,minTimeout:1e3,maxTimeout:1/0,randomize:!1};for(var g in f)p[g]=f[g];if(p.minTimeout>p.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var m=[],v=0;v<p.retries;v++)m.push(this.createTimeout(v,p));return f&&f.forever&&!m.length&&m.push(this.createTimeout(v,p)),m.sort(function(b,S){return b-S}),m},u.createTimeout=function(f,p){var g=p.randomize?Math.random()+1:1,m=Math.round(g*Math.max(p.minTimeout,1)*Math.pow(p.factor,f));return Math.min(m,p.maxTimeout)},u.wrap=function(f,p,g){if(p instanceof Array&&(g=p,p=null),!g)for(var m in g=[],f)typeof f[m]=="function"&&g.push(m);for(var v=0;v<g.length;v++){var b=g[v],S=f[b];f[b]=(function(E){var w=u.operation(p),C=Array.prototype.slice.call(arguments,1),I=C.pop();C.push(function(T){w.retry(T)||(T&&(arguments[0]=w.mainError()),I.apply(this,arguments))}),w.attempt(function(){E.apply(f,C)})}).bind(f,S),f[b].options=p}}},960:l=>{function u(d,h){typeof h=="boolean"&&(h={forever:h}),this._originalTimeouts=JSON.parse(JSON.stringify(d)),this._timeouts=d,this._options=h||{},this._maxRetryTime=h&&h.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}l.exports=u,u.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)},u.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null},u.prototype.retry=function(d){if(this._timeout&&clearTimeout(this._timeout),!d)return!1;var h=new Date().getTime();if(d&&h-this._operationStart>=this._maxRetryTime)return this._errors.push(d),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(d);var f=this._timeouts.shift();if(f===void 0){if(!this._cachedTimeouts)return!1;this._errors.splice(0,this._errors.length-1),f=this._cachedTimeouts.slice(-1)}var p=this;return this._timer=setTimeout(function(){p._attempts++,p._operationTimeoutCb&&(p._timeout=setTimeout(function(){p._operationTimeoutCb(p._attempts)},p._operationTimeout),p._options.unref&&p._timeout.unref()),p._fn(p._attempts)},f),this._options.unref&&this._timer.unref(),!0},u.prototype.attempt=function(d,h){this._fn=d,h&&(h.timeout&&(this._operationTimeout=h.timeout),h.cb&&(this._operationTimeoutCb=h.cb));var f=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){f._operationTimeoutCb()},f._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)},u.prototype.try=function(d){console.log("Using RetryOperation.try() is deprecated"),this.attempt(d)},u.prototype.start=function(d){console.log("Using RetryOperation.start() is deprecated"),this.attempt(d)},u.prototype.start=u.prototype.try,u.prototype.errors=function(){return this._errors},u.prototype.attempts=function(){return this._attempts},u.prototype.mainError=function(){if(this._errors.length===0)return null;for(var d={},h=null,f=0,p=0;p<this._errors.length;p++){var g=this._errors[p],m=g.message,v=(d[m]||0)+1;d[m]=v,v>=f&&(h=g,f=v)}return h}},272:l=>{l.exports=r},422:l=>{l.exports=t},28:l=>{l.exports=i}},s={};function a(l){var u=s[l];if(u!==void 0)return u.exports;var d=s[l]={exports:{}};return o[l](d,d.exports,a),d.exports}a.d=(l,u)=>{for(var d in u)a.o(u,d)&&!a.o(l,d)&&Object.defineProperty(l,d,{enumerable:!0,get:u[d]})},a.o=(l,u)=>Object.prototype.hasOwnProperty.call(l,u),a.r=l=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(l,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(l,"__esModule",{value:!0})};var c={};return(()=>{a.r(c),a.d(c,{PyodideClient:()=>O,PyodideFatalErrorReloader:()=>M,defaultPyodideLoader:()=>S,initPyodide:()=>C,loadPyodideAndPackage:()=>w,makeRunnerCallback:()=>T,pyodideExpose:()=>D,versionInfo:()=>E});var l=a(353);const u=new Set(["Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed"]);class d extends Error{constructor(A){super(),A instanceof Error?(this.originalError=A,{message:A}=A):(this.originalError=new Error(A),this.originalError.stack=this.stack),this.name="AbortError",this.message=A}}const h=R=>globalThis.DOMException===void 0?new Error(R):new DOMException(R);async function f(R,A){return new Promise((k,L)=>{A={onFailedAttempt(){},retries:10,...A};const j=l.operation(A);j.attempt(async N=>{try{k(await R(N))}catch(U){if(!(U instanceof Error))return void L(new TypeError(`Non-error was thrown: "${U}". You should only throw errors.`));if(U instanceof d)j.stop(),L(U.originalError);else if(U instanceof TypeError&&(B=U.message,!u.has(B)))j.stop(),L(U);else{((K,z,G)=>{const te=G.retries-(z-1);K.attemptNumber=z,K.retriesLeft=te})(U,N,A);try{await A.onFailedAttempt(U)}catch(K){return void L(K)}j.retry(U)||L(j.mainError())}}var B}),A.signal&&!A.signal.aborted&&A.signal.addEventListener("abort",()=>{j.stop();const N=A.signal.reason===void 0?h("The operation was aborted."):A.signal.reason;L(N instanceof Error?N:h(N))},{once:!0})})}var p=a(422),g=a(272),m=a(28),v=function(R,A,k,L){return new(k||(k=Promise))(function(j,N){function B(z){try{K(L.next(z))}catch(G){N(G)}}function U(z){try{K(L.throw(z))}catch(G){N(G)}}function K(z){var G;z.done?j(z.value):(G=z.value,G instanceof k?G:new k(function(te){te(G)})).then(B,U)}K((L=L.apply(R,[])).next())})};const b=a(237).Z;function S(R=m.version){return v(this,void 0,void 0,function*(){const A=`https://cdn.jsdelivr.net/pyodide/v${R}/full/`,k=yield(0,m.loadPyodide)({indexURL:A});if(k.version!==R)throw new Error(`loadPyodide loaded version ${k.version} instead of ${R}`);return k})}function E(R){return R.split(".").map(Number)}function w(R,A=S){return v(this,void 0,void 0,function*(){let k,L,{format:j,extractDir:N,url:B}=R;N=N||"/tmp/",[k,L]=yield Promise.all([f(()=>A(),{retries:3}),f(()=>function(K){return v(this,void 0,void 0,function*(){if(I.has(K))return console.log("Loaded package from cache"),I.get(K);console.log("Fetching package from "+K.slice(0,100)+"...");const z=yield fetch(K);if(!z.ok)throw new Error(`Request for package failed with status ${z.status}: ${z.statusText}`);const G=yield z.arrayBuffer();return console.log("Fetched package"),I.set(K,G),G})}(B),{retries:3})]);const U=E(k.version);return k.unpackArchive(L,j,U[0]===0&&U[1]<=19?N:{extractDir:N}),k.pyimport("sys").path.append(N),C(k),k})}function C(R){R.registerComlink(g);const A=R.pyimport("sys"),k=R.pyimport("pathlib"),L="/tmp/pyodide_worker_runner/";A.path.append(L),k.Path(L).mkdir(),k.Path(L+"pyodide_worker_runner.py").write_text(b),R.pyimport("pyodide_worker_runner")}const I=new Map;function T(R,A){return function(k,L){return L.toJs&&(L=L.toJs({dict_converter:Object.fromEntries})),k==="input"?(A.input&&A.input(L.prompt),R.readMessage()+`
`):k!=="sleep"?k==="output"?A.output(L.parts):A.other(k,L):void R.syncSleep(1e3*L.seconds)}}function D(R){return(0,p.syncExpose)(function(A,k,...L){return v(this,void 0,void 0,function*(){return R(Object.assign(Object.assign({},A),{interruptBuffer:k}),...L)})})}class O extends p.SyncClient{call(A,...k){const L=Object.create(null,{call:{get:()=>super.call}});return v(this,void 0,void 0,function*(){let j=null;return typeof SharedArrayBuffer<"u"&&(j=new Int32Array(new SharedArrayBuffer(1*Int32Array.BYTES_PER_ELEMENT)),this.interrupter=()=>{j[0]=2}),L.call.call(this,A,j,...k)})}}class M{constructor(A){this.loader=A,this.pyodidePromise=A()}withPyodide(A){return v(this,void 0,void 0,function*(){const k=yield this.pyodidePromise;try{return yield A(k)}catch(L){throw L.pyodide_fatal_error&&(this.pyodidePromise=this.loader()),L}})}}})(),c})())})(_Ie);var Wot=_Ie.exports;function qot(n){return new Worker(""+new URL("../workers/Worker-P3yDhRyO.js",import.meta.url).href,{type:"module",name:n==null?void 0:n.name})}const Vj="xxEND_OF_CODExx";function Kot(n){const e=new qot;async function t(){const i=y4.makeServiceWorkerChannel({timeout:1e3,scope:"/"});try{await y4.writeMessage(i,"test","foo")}catch(d){console.error("Service Worker Error",d)}const o=[i];typeof SharedArrayBuffer<"u"&&o.push(y4.makeAtomicsChannel());const a=new Wot.PyodideClient(()=>e,i);let c=!1;return{worker:e,runCode:async(d,{input:h,output:f,error:p})=>{let g=!1;for(await a.call(a.workerProxy.run,d+`
print('${Vj}')`,HP(m=>{c||h(m,v=>a.writeMessage(v))}),HP(m=>{c||(m.forEach(({text:v},b)=>{v!=null&&v.includes(Vj)&&(g=!0,m[b].text=v.substring(0,v.indexOf(Vj)))}),f(m))}),HP(m=>{c||(g=!0,p(m))}));!g&&!c;)await new Promise(m=>setTimeout(m,100))},client:a,interrupt:()=>c=!0}}return t()}const Got='File "/my_program_',Zot="During handling of the above exception,",xIe=n=>{const e=n.indexOf(Got);if(e===-1)return n;const t=n.indexOf(Zot,e);return n.slice(e,t===-1?void 0:t).trim()},Xot=n=>n.trim().split(`
`).filter(e=>e.trim()!==""&&e!==`
`),Yot=n=>{const e=[];return{result:e,input:(t,r)=>{const i=prompt(t);r(i??"")},output:t=>t.forEach(r=>{r.type==="input_prompt"?(n.append(r.text),e.push({line:r.text,type:"input",promptLength:r.text.length})):r.type==="stdout"?Xot(r.text).forEach(i=>{n.append(i),e.push({line:i,type:"output"})}):r.type==="input"?(n.appendToLast(r.text),e.at(-1).line+=r.text):n.error("Unknown part",r)}),error:t=>{t=xIe(XV(t)),n.append(t,"error"),e.push({line:t,type:"error"})}}};let nq;const EIe=async()=>{let n=nq;n==null||n.then(async({client:e,worker:t,interrupt:r})=>{console.log("Terminating current runner"),r(),await e.interrupt(),e.terminate(),t.terminate()}),nq=Kot()};EIe();const Jot=n=>n<10?`0${n}`:n,Qot=n=>n%12||12;function est(n=Date.now()){const e=new Date(n),t=e.getHours(),r=e.getMinutes(),i=e.getSeconds(),o=t>=12?"PM":"AM";return[Qot(t),r,i].map(Jot).join(":")+` ${o}`}function Due(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function $u(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Due(Object(t),!0).forEach(function(r){iq(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Due(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function rq(n){return rq=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rq(n)}function np(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function Rue(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,IIe(r.key),r)}}function rp(n,e,t){return e&&Rue(n.prototype,e),t&&Rue(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}function iq(n,e,t){return(e=IIe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Uk(n,e){if(n==null)return{};var t,r,i=function(s,a){if(s==null)return{};var c,l,u={},d=Object.keys(s);for(l=0;l<d.length;l++)c=d[l],a.indexOf(c)>=0||(u[c]=s[c]);return u}(n,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);for(r=0;r<o.length;r++)t=o[r],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(n,t)&&(i[t]=n[t])}return i}function IIe(n){var e=function(t,r){if(typeof t!="object"||t===null)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var o=i.call(t,r||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}(n,"string");return typeof e=="symbol"?e:String(e)}var oq=function(n,e){return oq=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])},oq(n,e)};function Ku(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function t(){this.constructor=n}oq(n,e),n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var UP=function(){return UP=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++)for(var i in e=arguments[t])Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i]);return n},UP.apply(this,arguments)};function PIe(n,e){var t,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(c){return function(l){return function(u){if(t)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(s=0)),s;)try{if(t=1,r&&(i=2&u[0]?r.return:u[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,u[1])).done)return i;switch(r=0,i&&(u=[2&u[0],i.value]),u[0]){case 0:case 1:i=u;break;case 4:return s.label++,{value:u[1],done:!1};case 5:s.label++,r=u[1],u=[0];continue;case 7:u=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||u[0]!==6&&u[0]!==2)){s=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){s.label=u[1];break}if(u[0]===6&&s.label<i[1]){s.label=i[1],i=u;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(u);break}i[2]&&s.ops.pop(),s.trys.pop();continue}u=e.call(n,s)}catch(d){u=[6,d],r=0}finally{t=i=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([c,l])}}}function zk(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Gf(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r,i,o=t.call(n),s=[];try{for(;(e===void 0||e-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(a){i={error:a}}finally{try{r&&!r.done&&(t=o.return)&&t.call(o)}finally{if(i)throw i.error}}return s}function ug(n,e,t){if(arguments.length===2)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return n.concat(r||Array.prototype.slice.call(e))}function zw(n){return this instanceof zw?(this.v=n,this):new zw(n)}function tst(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,t=n[Symbol.asyncIterator];return t?t.call(n):(n=zk(n),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(i){e[i]=n[i]&&function(o){return new Promise(function(s,a){(function(c,l,u,d){Promise.resolve(d).then(function(h){c({value:h,done:u})},l)})(s,a,(o=n[i](o)).done,o.value)})}}}function Bi(n){return typeof n=="function"}function YT(n){var e=n(function(t){Error.call(t),t.stack=new Error().stack});return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}var Wj=YT(function(n){return function(e){n(this),this.message=e?e.length+` errors occurred during unsubscription:
`+e.map(function(t,r){return r+1+") "+t.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=e}});function qM(n,e){if(n){var t=n.indexOf(e);0<=t&&n.splice(t,1)}}var JT=function(){function n(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}var e;return n.prototype.unsubscribe=function(){var t,r,i,o,s;if(!this.closed){this.closed=!0;var a=this._parentage;if(a)if(this._parentage=null,Array.isArray(a))try{for(var c=zk(a),l=c.next();!l.done;l=c.next())l.value.remove(this)}catch(g){t={error:g}}finally{try{l&&!l.done&&(r=c.return)&&r.call(c)}finally{if(t)throw t.error}}else a.remove(this);var u=this.initialTeardown;if(Bi(u))try{u()}catch(g){s=g instanceof Wj?g.errors:[g]}var d=this._finalizers;if(d){this._finalizers=null;try{for(var h=zk(d),f=h.next();!f.done;f=h.next()){var p=f.value;try{Aue(p)}catch(g){s=s??[],g instanceof Wj?s=ug(ug([],Gf(s)),Gf(g.errors)):s.push(g)}}}catch(g){i={error:g}}finally{try{f&&!f.done&&(o=h.return)&&o.call(h)}finally{if(i)throw i.error}}}if(s)throw new Wj(s)}},n.prototype.add=function(t){var r;if(t&&t!==this)if(this.closed)Aue(t);else{if(t instanceof n){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=(r=this._finalizers)!==null&&r!==void 0?r:[]).push(t)}},n.prototype._hasParent=function(t){var r=this._parentage;return r===t||Array.isArray(r)&&r.includes(t)},n.prototype._addParent=function(t){var r=this._parentage;this._parentage=Array.isArray(r)?(r.push(t),r):r?[r,t]:t},n.prototype._removeParent=function(t){var r=this._parentage;r===t?this._parentage=null:Array.isArray(r)&&qM(r,t)},n.prototype.remove=function(t){var r=this._finalizers;r&&qM(r,t),t instanceof n&&t._removeParent(this)},n.EMPTY=((e=new n).closed=!0,e),n}(),kIe=JT.EMPTY;function TIe(n){return n instanceof JT||n&&"closed"in n&&Bi(n.remove)&&Bi(n.add)&&Bi(n.unsubscribe)}function Aue(n){Bi(n)?n():n.unsubscribe()}var nst=void 0,rst=!1,ist={setTimeout:function(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];return setTimeout.apply(void 0,ug([n,e],Gf(t)))},clearTimeout:function(n){return clearTimeout(n)},delegate:void 0};function DIe(n){ist.setTimeout(function(){throw n})}function Vk(){}function b4(n){n()}var tte=function(n){function e(t){var r=n.call(this)||this;return r.isStopped=!1,t?(r.destination=t,TIe(t)&&t.add(r)):r.destination=ast,r}return Ku(e,n),e.create=function(t,r,i){return new KM(t,r,i)},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,n.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){try{this.destination.error(t)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(JT),ost=Function.prototype.bind;function qj(n,e){return ost.call(n,e)}var sst=function(){function n(e){this.partialObserver=e}return n.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(r){e5(r)}},n.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(r){e5(r)}else e5(e)},n.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(t){e5(t)}},n}(),KM=function(n){function e(t,r,i){var o,s,a=n.call(this)||this;return Bi(t)||!t?o={next:t??void 0,error:r??void 0,complete:i??void 0}:a&&rst?((s=Object.create(t)).unsubscribe=function(){return a.unsubscribe()},o={next:t.next&&qj(t.next,s),error:t.error&&qj(t.error,s),complete:t.complete&&qj(t.complete,s)}):o=t,a.destination=new sst(o),a}return Ku(e,n),e}(tte);function e5(n){DIe(n)}var ast={closed:!0,next:Vk,error:function(n){throw n},complete:Vk},nte=typeof Symbol=="function"&&Symbol.observable||"@@observable";function d7(n){return n}function xS(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return RIe(n)}function RIe(n){return n.length===0?d7:n.length===1?n[0]:function(e){return n.reduce(function(t,r){return r(t)},e)}}var Ns=function(){function n(e){e&&(this._subscribe=e)}return n.prototype.lift=function(e){var t=new n;return t.source=this,t.operator=e,t},n.prototype.subscribe=function(e,t,r){var i,o=this,s=(i=e)&&i instanceof tte||function(a){return a&&Bi(a.next)&&Bi(a.error)&&Bi(a.complete)}(i)&&TIe(i)?e:new KM(e,t,r);return b4(function(){var a=o,c=a.operator,l=a.source;s.add(c?c.call(s,l):l?o._subscribe(s):o._trySubscribe(s))}),s},n.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},n.prototype.forEach=function(e,t){var r=this;return new(t=Oue(t))(function(i,o){var s=new KM({next:function(a){try{e(a)}catch(c){o(c),s.unsubscribe()}},error:o,complete:i});r.subscribe(s)})},n.prototype._subscribe=function(e){var t;return(t=this.source)===null||t===void 0?void 0:t.subscribe(e)},n.prototype[nte]=function(){return this},n.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return RIe(e)(this)},n.prototype.toPromise=function(e){var t=this;return new(e=Oue(e))(function(r,i){var o;t.subscribe(function(s){return o=s},function(s){return i(s)},function(){return r(o)})})},n.create=function(e){return new n(e)},n}();function Oue(n){var e;return(e=n??nst)!==null&&e!==void 0?e:Promise}function Xc(n){return function(e){if(function(t){return Bi(t==null?void 0:t.lift)}(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function ba(n,e,t,r,i){return new cst(n,e,t,r,i)}var Kj,cst=function(n){function e(t,r,i,o,s,a){var c=n.call(this,t)||this;return c.onFinalize=s,c.shouldUnsubscribe=a,c._next=r?function(l){try{r(l)}catch(u){t.error(u)}}:n.prototype._next,c._error=o?function(l){try{o(l)}catch(u){t.error(u)}finally{this.unsubscribe()}}:n.prototype._error,c._complete=i?function(){try{i()}catch(l){t.error(l)}finally{this.unsubscribe()}}:n.prototype._complete,c}return Ku(e,n),e.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;n.prototype.unsubscribe.call(this),!r&&((t=this.onFinalize)===null||t===void 0||t.call(this))}},e}(tte),lst=YT(function(n){return function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),Lh=function(n){function e(){var t=n.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return Ku(e,n),e.prototype.lift=function(t){var r=new Mue(this,this);return r.operator=t,r},e.prototype._throwIfClosed=function(){if(this.closed)throw new lst},e.prototype.next=function(t){var r=this;b4(function(){var i,o;if(r._throwIfClosed(),!r.isStopped){r.currentObservers||(r.currentObservers=Array.from(r.observers));try{for(var s=zk(r.currentObservers),a=s.next();!a.done;a=s.next())a.value.next(t)}catch(c){i={error:c}}finally{try{a&&!a.done&&(o=s.return)&&o.call(s)}finally{if(i)throw i.error}}}})},e.prototype.error=function(t){var r=this;b4(function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=!0,r.thrownError=t;for(var i=r.observers;i.length;)i.shift().error(t)}})},e.prototype.complete=function(){var t=this;b4(function(){if(t._throwIfClosed(),!t.isStopped){t.isStopped=!0;for(var r=t.observers;r.length;)r.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(t){return this._throwIfClosed(),n.prototype._trySubscribe.call(this,t)},e.prototype._subscribe=function(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)},e.prototype._innerSubscribe=function(t){var r=this,i=this,o=i.hasError,s=i.isStopped,a=i.observers;return o||s?kIe:(this.currentObservers=null,a.push(t),new JT(function(){r.currentObservers=null,qM(a,t)}))},e.prototype._checkFinalizedStatuses=function(t){var r=this,i=r.hasError,o=r.thrownError,s=r.isStopped;i?t.error(o):s&&t.complete()},e.prototype.asObservable=function(){var t=new Ns;return t.source=this,t},e.create=function(t,r){return new Mue(t,r)},e}(Ns),Mue=function(n){function e(t,r){var i=n.call(this)||this;return i.destination=t,i.source=r,i}return Ku(e,n),e.prototype.next=function(t){var r,i;(i=(r=this.destination)===null||r===void 0?void 0:r.next)===null||i===void 0||i.call(r,t)},e.prototype.error=function(t){var r,i;(i=(r=this.destination)===null||r===void 0?void 0:r.error)===null||i===void 0||i.call(r,t)},e.prototype.complete=function(){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.complete)===null||r===void 0||r.call(t)},e.prototype._subscribe=function(t){var r,i;return(i=(r=this.source)===null||r===void 0?void 0:r.subscribe(t))!==null&&i!==void 0?i:kIe},e}(Lh),ust=function(n){function e(t){var r=n.call(this)||this;return r._value=t,r}return Ku(e,n),Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),e.prototype._subscribe=function(t){var r=n.prototype._subscribe.call(this,t);return!r.closed&&t.next(this._value),r},e.prototype.getValue=function(){var t=this,r=t.hasError,i=t.thrownError,o=t._value;if(r)throw i;return this._throwIfClosed(),o},e.prototype.next=function(t){n.prototype.next.call(this,this._value=t)},e}(Lh),rte={now:function(){return(rte.delegate||Date).now()},delegate:void 0},dst=function(n){function e(t,r,i){t===void 0&&(t=1/0),r===void 0&&(r=1/0),i===void 0&&(i=rte);var o=n.call(this)||this;return o._bufferSize=t,o._windowTime=r,o._timestampProvider=i,o._buffer=[],o._infiniteTimeWindow=!0,o._infiniteTimeWindow=r===1/0,o._bufferSize=Math.max(1,t),o._windowTime=Math.max(1,r),o}return Ku(e,n),e.prototype.next=function(t){var r=this,i=r.isStopped,o=r._buffer,s=r._infiniteTimeWindow,a=r._timestampProvider,c=r._windowTime;i||(o.push(t),!s&&o.push(a.now()+c)),this._trimBuffer(),n.prototype.next.call(this,t)},e.prototype._subscribe=function(t){this._throwIfClosed(),this._trimBuffer();for(var r=this._innerSubscribe(t),i=this._infiniteTimeWindow,o=this._buffer.slice(),s=0;s<o.length&&!t.closed;s+=i?1:2)t.next(o[s]);return this._checkFinalizedStatuses(t),r},e.prototype._trimBuffer=function(){var t=this,r=t._bufferSize,i=t._timestampProvider,o=t._buffer,s=t._infiniteTimeWindow,a=(s?1:2)*r;if(r<1/0&&a<o.length&&o.splice(0,o.length-a),!s){for(var c=i.now(),l=0,u=1;u<o.length&&o[u]<=c;u+=2)l=u;l&&o.splice(0,l+1)}},e}(Lh),hst=function(n){function e(t,r){return n.call(this)||this}return Ku(e,n),e.prototype.schedule=function(t,r){return this},e}(JT),sq={setInterval:function(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];var i=sq.delegate;return i!=null&&i.setInterval?i.setInterval.apply(i,ug([n,e],Gf(t))):setInterval.apply(void 0,ug([n,e],Gf(t)))},clearInterval:function(n){return clearInterval(n)},delegate:void 0},ite=function(n){function e(t,r){var i=n.call(this,t,r)||this;return i.scheduler=t,i.work=r,i.pending=!1,i}return Ku(e,n),e.prototype.schedule=function(t,r){var i;if(r===void 0&&(r=0),this.closed)return this;this.state=t;var o=this.id,s=this.scheduler;return o!=null&&(this.id=this.recycleAsyncId(s,o,r)),this.pending=!0,this.delay=r,this.id=(i=this.id)!==null&&i!==void 0?i:this.requestAsyncId(s,this.id,r),this},e.prototype.requestAsyncId=function(t,r,i){return i===void 0&&(i=0),sq.setInterval(t.flush.bind(t,this),i)},e.prototype.recycleAsyncId=function(t,r,i){if(i===void 0&&(i=0),i!=null&&this.delay===i&&this.pending===!1)return r;r!=null&&sq.clearInterval(r)},e.prototype.execute=function(t,r){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var i=this._execute(t,r);if(i)return i;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(t,r){var i,o=!1;try{this.work(t)}catch(s){o=!0,i=s||new Error("Scheduled action threw falsy error")}if(o)return this.unsubscribe(),i},e.prototype.unsubscribe=function(){if(!this.closed){var t=this.id,r=this.scheduler,i=r.actions;this.work=this.state=this.scheduler=null,this.pending=!1,qM(i,this),t!=null&&(this.id=this.recycleAsyncId(r,t,null)),this.delay=null,n.prototype.unsubscribe.call(this)}},e}(hst),fst=1,aq={};function AIe(n){return n in aq&&(delete aq[n],!0)}var pst=function(n){var e=fst++;return aq[e]=!0,Kj||(Kj=Promise.resolve()),Kj.then(function(){return AIe(e)&&n()}),e},cq={setImmediate:function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=cq.delegate;return((t==null?void 0:t.setImmediate)||pst).apply(void 0,ug([],Gf(n)))},clearImmediate:function(n){return function(e){AIe(e)}(n)},delegate:void 0},gst=function(n){function e(t,r){var i=n.call(this,t,r)||this;return i.scheduler=t,i.work=r,i}return Ku(e,n),e.prototype.requestAsyncId=function(t,r,i){return i===void 0&&(i=0),i!==null&&i>0?n.prototype.requestAsyncId.call(this,t,r,i):(t.actions.push(this),t._scheduled||(t._scheduled=cq.setImmediate(t.flush.bind(t,void 0))))},e.prototype.recycleAsyncId=function(t,r,i){var o;if(i===void 0&&(i=0),i!=null?i>0:this.delay>0)return n.prototype.recycleAsyncId.call(this,t,r,i);var s=t.actions;r!=null&&((o=s[s.length-1])===null||o===void 0?void 0:o.id)!==r&&(cq.clearImmediate(r),t._scheduled===r&&(t._scheduled=void 0))},e}(ite),$ue=function(){function n(e,t){t===void 0&&(t=n.now),this.schedulerActionCtor=e,this.now=t}return n.prototype.schedule=function(e,t,r){return t===void 0&&(t=0),new this.schedulerActionCtor(this,e).schedule(r,t)},n.now=rte.now,n}(),ote=function(n){function e(t,r){r===void 0&&(r=$ue.now);var i=n.call(this,t,r)||this;return i.actions=[],i._active=!1,i}return Ku(e,n),e.prototype.flush=function(t){var r=this.actions;if(this._active)r.push(t);else{var i;this._active=!0;do if(i=t.execute(t.state,t.delay))break;while(t=r.shift());if(this._active=!1,i){for(;t=r.shift();)t.unsubscribe();throw i}}},e}($ue),QT=new(function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return Ku(e,n),e.prototype.flush=function(t){this._active=!0;var r=this._scheduled;this._scheduled=void 0;var i,o=this.actions;t=t||o.shift();do if(i=t.execute(t.state,t.delay))break;while((t=o[0])&&t.id===r&&o.shift());if(this._active=!1,i){for(;(t=o[0])&&t.id===r&&o.shift();)t.unsubscribe();throw i}},e}(ote))(gst),Ag=new ote(ite),mst=Ag,vst=function(n){function e(t,r){var i=n.call(this,t,r)||this;return i.scheduler=t,i.work=r,i}return Ku(e,n),e.prototype.schedule=function(t,r){return r===void 0&&(r=0),r>0?n.prototype.schedule.call(this,t,r):(this.delay=r,this.state=t,this.scheduler.flush(this),this)},e.prototype.execute=function(t,r){return r>0||this.closed?n.prototype.execute.call(this,t,r):this._execute(t,r)},e.prototype.requestAsyncId=function(t,r,i){return i===void 0&&(i=0),i!=null&&i>0||i==null&&this.delay>0?n.prototype.requestAsyncId.call(this,t,r,i):(t.flush(this),0)},e}(ite),Lue=new(function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return Ku(e,n),e}(ote))(vst),Mt=new Ns(function(n){return n.complete()});function OIe(n){return n&&Bi(n.schedule)}function ste(n){return n[n.length-1]}function MIe(n){return Bi(ste(n))?n.pop():void 0}function h7(n){return OIe(ste(n))?n.pop():void 0}var ate=function(n){return n&&typeof n.length=="number"&&typeof n!="function"};function $Ie(n){return Bi(n==null?void 0:n.then)}function LIe(n){return Bi(n[nte])}function NIe(n){return Symbol.asyncIterator&&Bi(n==null?void 0:n[Symbol.asyncIterator])}function FIe(n){return new TypeError("You provided "+(n!==null&&typeof n=="object"?"an invalid object":"'"+n+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}var jIe=typeof Symbol=="function"&&Symbol.iterator?Symbol.iterator:"@@iterator";function BIe(n){return Bi(n==null?void 0:n[jIe])}function HIe(n){return function(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,o=r.apply(e,t||[]),s=[];return i={},a("next"),a("throw"),a("return"),i[Symbol.asyncIterator]=function(){return this},i;function a(h){o[h]&&(i[h]=function(f){return new Promise(function(p,g){s.push([h,f,p,g])>1||c(h,f)})})}function c(h,f){try{(function(p){p.value instanceof zw?Promise.resolve(p.value.v).then(l,u):d(s[0][2],p)})(o[h](f))}catch(p){d(s[0][3],p)}}function l(h){c("next",h)}function u(h){c("throw",h)}function d(h,f){h(f),s.shift(),s.length&&c(s[0][0],s[0][1])}}(this,arguments,function(){var e,t,r;return PIe(this,function(i){switch(i.label){case 0:e=n.getReader(),i.label=1;case 1:i.trys.push([1,,9,10]),i.label=2;case 2:return[4,zw(e.read())];case 3:return t=i.sent(),r=t.value,t.done?[4,zw(void 0)]:[3,5];case 4:return[2,i.sent()];case 5:return[4,zw(r)];case 6:return[4,i.sent()];case 7:return i.sent(),[3,2];case 8:return[3,10];case 9:return e.releaseLock(),[7];case 10:return[2]}})})}function UIe(n){return Bi(n==null?void 0:n.getReader)}function hc(n){if(n instanceof Ns)return n;if(n!=null){if(LIe(n))return i=n,new Ns(function(o){var s=i[nte]();if(Bi(s.subscribe))return s.subscribe(o);throw new TypeError("Provided object does not correctly implement Symbol.observable")});if(ate(n))return r=n,new Ns(function(o){for(var s=0;s<r.length&&!o.closed;s++)o.next(r[s]);o.complete()});if($Ie(n))return t=n,new Ns(function(o){t.then(function(s){o.closed||(o.next(s),o.complete())},function(s){return o.error(s)}).then(null,DIe)});if(NIe(n))return Nue(n);if(BIe(n))return e=n,new Ns(function(o){var s,a;try{for(var c=zk(e),l=c.next();!l.done;l=c.next()){var u=l.value;if(o.next(u),o.closed)return}}catch(d){s={error:d}}finally{try{l&&!l.done&&(a=c.return)&&a.call(c)}finally{if(s)throw s.error}}o.complete()});if(UIe(n))return Nue(HIe(n))}var e,t,r,i;throw FIe(n)}function Nue(n){return new Ns(function(e){(function(t,r){var i,o,s,a;return function(c,l,u,d){return new(u||(u=Promise))(function(h,f){function p(v){try{m(d.next(v))}catch(b){f(b)}}function g(v){try{m(d.throw(v))}catch(b){f(b)}}function m(v){var b;v.done?h(v.value):(b=v.value,b instanceof u?b:new u(function(S){S(b)})).then(p,g)}m((d=d.apply(c,[])).next())})}(this,void 0,void 0,function(){var c,l;return PIe(this,function(u){switch(u.label){case 0:u.trys.push([0,5,6,11]),i=tst(t),u.label=1;case 1:return[4,i.next()];case 2:if((o=u.sent()).done)return[3,4];if(c=o.value,r.next(c),r.closed)return[2];u.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return l=u.sent(),s={error:l},[3,11];case 6:return u.trys.push([6,,9,10]),o&&!o.done&&(a=i.return)?[4,a.call(i)]:[3,8];case 7:u.sent(),u.label=8;case 8:return[3,10];case 9:if(s)throw s.error;return[7];case 10:return[7];case 11:return r.complete(),[2]}})})})(n,e).catch(function(t){return e.error(t)})})}function ty(n,e,t,r,i){r===void 0&&(r=0),i===void 0&&(i=!1);var o=e.schedule(function(){t(),i?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(o),!i)return o}function bl(n,e){return e===void 0&&(e=0),Xc(function(t,r){t.subscribe(ba(r,function(i){return ty(r,n,function(){return r.next(i)},e)},function(){return ty(r,n,function(){return r.complete()},e)},function(i){return ty(r,n,function(){return r.error(i)},e)}))})}function lq(n,e){return e===void 0&&(e=0),Xc(function(t,r){r.add(n.schedule(function(){return t.subscribe(r)},e))})}function Fue(n,e){if(!n)throw new Error("Iterable cannot be null");return new Ns(function(t){ty(t,e,function(){var r=n[Symbol.asyncIterator]();ty(t,e,function(){r.next().then(function(i){i.done?t.complete():t.next(i.value)})},0,!0)})})}function Tt(n,e){return e?function(t,r){if(t!=null){if(LIe(t))return function(i,o){return hc(i).pipe(lq(o),bl(o))}(t,r);if(ate(t))return function(i,o){return new Ns(function(s){var a=0;return o.schedule(function(){a===i.length?s.complete():(s.next(i[a++]),s.closed||this.schedule())})})}(t,r);if($Ie(t))return function(i,o){return hc(i).pipe(lq(o),bl(o))}(t,r);if(NIe(t))return Fue(t,r);if(BIe(t))return function(i,o){return new Ns(function(s){var a;return ty(s,o,function(){a=i[jIe](),ty(s,o,function(){var c,l,u;try{l=(c=a.next()).value,u=c.done}catch(d){return void s.error(d)}u?s.complete():s.next(l)},0,!0)}),function(){return Bi(a==null?void 0:a.return)&&a.return()}})}(t,r);if(UIe(t))return function(i,o){return Fue(HIe(i),o)}(t,r)}throw FIe(t)}(n,e):hc(n)}function hi(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return Tt(n,h7(n))}function b1(n,e){var t=Bi(n)?n:function(){return n},r=function(i){return i.error(t())};return new Ns(r)}var yst=YT(function(n){return function(){n(this),this.name="EmptyError",this.message="no elements in sequence"}});function mc(n,e){return new Promise(function(t,r){var i=new KM({next:function(o){t(o),i.unsubscribe()},error:r,complete:function(){r(new yst)}});n.subscribe(i)})}function zIe(n){return n instanceof Date&&!isNaN(n)}var bst=YT(function(n){return function(e){e===void 0&&(e=null),n(this),this.message="Timeout has occurred",this.name="TimeoutError",this.info=e}});function VIe(n,e){var t=zIe(n)?{first:n}:typeof n=="number"?{each:n}:n,r=t.first,i=t.each,o=t.with,s=o===void 0?Sst:o,a=t.scheduler,c=a===void 0?Ag:a,l=t.meta,u=l===void 0?null:l;if(r==null&&i==null)throw new TypeError("No timeout provided.");return Xc(function(d,h){var f,p,g=null,m=0,v=function(b){p=ty(h,c,function(){try{f.unsubscribe(),hc(s({meta:u,lastValue:g,seen:m})).subscribe(h)}catch(S){h.error(S)}},b)};f=d.subscribe(ba(h,function(b){p==null||p.unsubscribe(),m++,h.next(g=b),i>0&&v(i)},void 0,void 0,function(){p!=null&&p.closed||p==null||p.unsubscribe(),g=null})),!m&&v(r!=null?typeof r=="number"?r:+r-c.now():i)})}function Sst(n){throw new bst(n)}function Vt(n,e){return Xc(function(t,r){var i=0;t.subscribe(ba(r,function(o){r.next(n.call(e,o,i++))}))})}var _st=Array.isArray;function cte(n){return Vt(function(e){return function(t,r){return _st(r)?t.apply(void 0,ug([],Gf(r))):t(r)}(n,e)})}var wst=Array.isArray,Cst=Object.getPrototypeOf,xst=Object.prototype,Est=Object.keys;function ht(n,e,t){return t===void 0&&(t=1/0),Bi(e)?ht(function(r,i){return Vt(function(o,s){return e(r,o,i,s)})(hc(n(r,i)))},t):(typeof e=="number"&&(t=e),Xc(function(r,i){return function(o,s,a,c,l,u,d,h){var f=[],p=0,g=0,m=!1,v=function(){!m||f.length||p||s.complete()},b=function(E){return p<c?S(E):f.push(E)},S=function(E){p++;var w=!1;hc(a(E,g++)).subscribe(ba(s,function(C){s.next(C)},function(){w=!0},void 0,function(){if(w)try{p--;for(var C=function(){var I=f.shift();S(I)};f.length&&p<c;)C();v()}catch(I){s.error(I)}}))};return o.subscribe(ba(s,b,function(){m=!0,v()})),function(){}}(r,i,n,t)}))}function WIe(n){return n===void 0&&(n=1/0),ht(d7,n)}function O2(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return WIe(1)(Tt(n,h7(n)))}function f7(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=MIe(n),r=function(a){if(a.length===1){var c=a[0];if(wst(c))return{args:c,keys:null};if((u=c)&&typeof u=="object"&&Cst(u)===xst){var l=Est(c);return{args:l.map(function(d){return c[d]}),keys:l}}}var u;return{args:a,keys:null}}(n),i=r.args,o=r.keys,s=new Ns(function(a){var c=i.length;if(c)for(var l=new Array(c),u=c,d=c,h=function(p){var g=!1;hc(i[p]).subscribe(ba(a,function(m){g||(g=!0,d--),l[p]=m},function(){return u--},void 0,function(){u&&g||(d||a.next(o?function(m,v){return m.reduce(function(b,S,E){return b[S]=v[E],b},{})}(o,l):l),a.complete())}))},f=0;f<c;f++)h(f);else a.complete()});return t?s.pipe(cte(t)):s}var Ist=["addListener","removeListener"],Pst=["addEventListener","removeEventListener"],kst=["on","off"];function No(n,e,t,r){if(Bi(t)&&(r=t,t=void 0),r)return No(n,e,t).pipe(cte(r));var i=Gf(function(a){return Bi(a.addEventListener)&&Bi(a.removeEventListener)}(n)?Pst.map(function(a){return function(c){return n[a](e,c,t)}}):function(a){return Bi(a.addListener)&&Bi(a.removeListener)}(n)?Ist.map(jue(n,e)):function(a){return Bi(a.on)&&Bi(a.off)}(n)?kst.map(jue(n,e)):[],2),o=i[0],s=i[1];if(!o&&ate(n))return ht(function(a){return No(a,e,t)})(hc(n));if(!o)throw new TypeError("Invalid event target");return new Ns(function(a){var c=function(){for(var l=[],u=0;u<arguments.length;u++)l[u]=arguments[u];return a.next(1<l.length?l:l[0])};return o(c),function(){return s(c)}})}function jue(n,e){return function(t){return function(r){return n[t](e,r)}}}function M0(n,e,t){return t?M0(n,e).pipe(cte(t)):new Ns(function(r){var i=function(){for(var s=[],a=0;a<arguments.length;a++)s[a]=arguments[a];return r.next(s.length===1?s[0]:s)},o=n(i);return Bi(e)?function(){return e(i,o)}:void 0})}function js(n,e,t){n===void 0&&(n=0),t===void 0&&(t=mst);var r=-1;return e!=null&&(OIe(e)?t=e:r=e),new Ns(function(i){var o=zIe(n)?+n-t.now():n;o<0&&(o=0);var s=0;return t.schedule(function(){i.closed||(i.next(s++),0<=r?this.schedule(void 0,r):i.complete())},o)})}function Wk(n,e){return n===void 0&&(n=0),e===void 0&&(e=Ag),n<0&&(n=0),js(n,n,e)}function ga(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=h7(n),r=function(o,s){return typeof ste(o)=="number"?o.pop():1/0}(n),i=n;return i.length?i.length===1?hc(i[0]):WIe(r)(Tt(i,t)):Mt}var Tst=Array.isArray;function Dst(n,e){return function(t,r){return!n.call(e,t,r)}}function st(n,e){return Xc(function(t,r){var i=0;t.subscribe(ba(r,function(o){return n.call(e,o,i++)&&r.next(o)}))})}function Ad(){for(var n,e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(e=(n=e).length===1&&Tst(n[0])?n[0]:n).length===1?hc(e[0]):new Ns(function(r){return function(i){for(var o=[],s=function(c){o.push(hc(r[c]).subscribe(ba(i,function(l){if(o){for(var u=0;u<o.length;u++)u!==c&&o[u].unsubscribe();o=null}i.next(l)})))},a=0;o&&!i.closed&&a<r.length;a++)s(a)}}(e))}function $f(n){return Xc(function(e,t){var r,i=null,o=!1;i=e.subscribe(ba(t,void 0,void 0,function(s){r=hc(n(s,$f(n)(e))),i?(i.unsubscribe(),i=null,r.subscribe(t)):o=!0})),o&&(i.unsubscribe(),i=null,r.subscribe(t))})}function Ur(n){return n<=0?function(){return Mt}:Xc(function(e,t){var r=0;e.subscribe(ba(t,function(i){++r<=n&&(t.next(i),n<=r&&t.complete())}))})}function Lu(n){return Vt(function(){return n})}function qIe(n,e){return e?function(t){return O2(e.pipe(Ur(1),Xc(function(r,i){r.subscribe(ba(i,Vk))})),t.pipe(qIe(n)))}:ht(function(t,r){return hc(n(t,r)).pipe(Ur(1),Lu(t))})}function M2(n,e){e===void 0&&(e=Ag);var t=js(n,e);return qIe(function(){return t})}function $n(n,e,t){return t===void 0&&(t=1/0),Bi(e)?ht(function(){return n},e,t):ht(function(){return n},t)}function Rst(n,e){return Xc(function(t,r,i,o,s){return function(a,c){var l=i,u=r,d=0;a.subscribe(ba(c,function(h){var f=d++;u=l?t(u,h,f):(l=!0,h),c.next(u)},void 0))}}(n,e,arguments.length>=2))}function KIe(n){return Xc(function(e,t){var r=!1,i=0;e.subscribe(ba(t,function(o){return(r||(r=!n(o,i++)))&&t.next(o)}))})}function Nh(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=h7(n);return Xc(function(r,i){(t?O2(n,r,t):O2(n,r)).subscribe(i)})}function zr(n,e){return Xc(function(t,r){var i=null,o=0,s=!1,a=function(){return s&&!i&&r.complete()};t.subscribe(ba(r,function(c){i==null||i.unsubscribe();var l=0,u=o++;hc(n(c,u)).subscribe(i=ba(r,function(d){return r.next(e?e(c,d,u,l++):d)},function(){i=null,a()}))},function(){s=!0,a()}))})}function qp(n){return Xc(function(e,t){hc(n).subscribe(ba(t,function(){return t.complete()},Vk)),!t.closed&&e.subscribe(t)})}function S1(n,e){return e===void 0&&(e=!1),Xc(function(t,r){var i=0;t.subscribe(ba(r,function(o){var s=n(o,i++);(s||e)&&r.next(o),!s&&r.complete()}))})}function en(n,e,t){var r=Bi(n)||e||t?{next:n,error:e,complete:t}:n;return r?Xc(function(i,o){var s;(s=r.subscribe)===null||s===void 0||s.call(r);var a=!0;i.subscribe(ba(o,function(c){var l;(l=r.next)===null||l===void 0||l.call(r,c),o.next(c)},function(){var c;a=!1,(c=r.complete)===null||c===void 0||c.call(r),o.complete()},function(c){var l;a=!1,(l=r.error)===null||l===void 0||l.call(r,c),o.error(c)},function(){var c,l;a&&((c=r.unsubscribe)===null||c===void 0||c.call(r)),(l=r.finalize)===null||l===void 0||l.call(r)}))}):d7}function nn(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=MIe(n);return Xc(function(r,i){for(var o=n.length,s=new Array(o),a=n.map(function(){return!1}),c=!1,l=function(d){hc(n[d]).subscribe(ba(i,function(h){s[d]=h,c||a[d]||(a[d]=!0,(c=a.every(d7))&&(a=null))},Vk))},u=0;u<o;u++)l(u);r.subscribe(ba(i,function(d){if(c){var h=ug([d],Gf(s));i.next(t?t.apply(void 0,ug([],Gf(h))):h)}}))})}function zP(n){return zP=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zP(n)}function Ast(n,e,t){return(e=function(r){var i=function(o,s){if(zP(o)!=="object"||o===null)return o;var a=o[Symbol.toPrimitive];if(a!==void 0){var c=a.call(o,"string");if(zP(c)!=="object")return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}(r);return zP(i)==="symbol"?i:String(i)}(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Bue(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function Hue(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Bue(Object(t),!0).forEach(function(r){Ast(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Bue(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function ol(n){return"Minified Redux error #"+n+"; visit https://redux.js.org/Errors?code="+n+" for the full message or use the non-minified dev environment for full errors. "}var Uue=typeof Symbol=="function"&&Symbol.observable||"@@observable",Gj=function(){return Math.random().toString(36).substring(7).split("").join(".")},GM={INIT:"@@redux/INIT"+Gj(),REPLACE:"@@redux/REPLACE"+Gj(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+Gj()}};function GIe(n,e,t){var r;if(typeof e=="function"&&typeof t=="function"||typeof t=="function"&&typeof arguments[3]=="function")throw new Error(ol(0));if(typeof e=="function"&&t===void 0&&(t=e,e=void 0),t!==void 0){if(typeof t!="function")throw new Error(ol(1));return t(GIe)(n,e)}if(typeof n!="function")throw new Error(ol(2));var i=n,o=e,s=[],a=s,c=!1;function l(){a===s&&(a=s.slice())}function u(){if(c)throw new Error(ol(3));return o}function d(f){if(typeof f!="function")throw new Error(ol(4));if(c)throw new Error(ol(5));var p=!0;return l(),a.push(f),function(){if(p){if(c)throw new Error(ol(6));p=!1,l();var g=a.indexOf(f);a.splice(g,1),s=null}}}function h(f){if(!function(m){if(typeof m!="object"||m===null)return!1;for(var v=m;Object.getPrototypeOf(v)!==null;)v=Object.getPrototypeOf(v);return Object.getPrototypeOf(m)===v}(f))throw new Error(ol(7));if(f.type===void 0)throw new Error(ol(8));if(c)throw new Error(ol(9));try{c=!0,o=i(o,f)}finally{c=!1}for(var p=s=a,g=0;g<p.length;g++)(0,p[g])();return f}return h({type:GM.INIT}),(r={dispatch:h,subscribe:d,getState:u,replaceReducer:function(f){if(typeof f!="function")throw new Error(ol(10));i=f,h({type:GM.REPLACE})}})[Uue]=function(){var f,p=d;return(f={subscribe:function(g){if(typeof g!="object"||g===null)throw new Error(ol(11));function m(){g.next&&g.next(u())}return m(),{unsubscribe:p(m)}}})[Uue]=function(){return this},f},r}function ZIe(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return e.length===0?function(r){return r}:e.length===1?e[0]:e.reduce(function(r,i){return function(){return r(i.apply(void 0,arguments))}})}var uq=function(n,e){return uq=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])},uq(n,e)},Ost=function(n){function e(t,r){var i=n.call(this,function(o){var s=i.__notifier.subscribe(o);return s&&!s.closed&&o.next(i.value),s})||this;return i.__notifier=new Lh,i.value=r,t.subscribe(function(o){o!==i.value&&(i.value=o,i.__notifier.next(o))}),i}return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=t}uq(t,r),t.prototype=r===null?Object.create(r):(i.prototype=r.prototype,new i)}(e,n),e}(Ns),zue=function(n,e){return n===e||typeof e=="function"&&n===e.toString()};function rn(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=n.length;return st(t===1?function(r){return zue(r.type,n[0])}:function(r){for(var i=0;i<t;i++)if(zue(r.type,n[i]))return!0;return!1})}var Mst=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n};function t5(n,e){n.super_=e,n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}})}function n5(n,e){Object.defineProperty(this,"kind",{value:n,enumerable:!0}),e&&e.length&&Object.defineProperty(this,"path",{value:e,enumerable:!0})}(typeof global>"u"?"undefined":Mst(global))==="object"&&global?global:typeof window<"u",t5(function n(e,t,r){n.super_.call(this,"E",e),Object.defineProperty(this,"lhs",{value:t,enumerable:!0}),Object.defineProperty(this,"rhs",{value:r,enumerable:!0})},n5),t5(function n(e,t){n.super_.call(this,"N",e),Object.defineProperty(this,"rhs",{value:t,enumerable:!0})},n5),t5(function n(e,t){n.super_.call(this,"D",e),Object.defineProperty(this,"lhs",{value:t,enumerable:!0})},n5),t5(function n(e,t,r){n.super_.call(this,"A",e),Object.defineProperty(this,"index",{value:t,enumerable:!0}),Object.defineProperty(this,"item",{value:r,enumerable:!0})},n5);const mb=!1;var _1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Vue(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function XIe(n){if(n.__esModule)return n;var e=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(n).forEach(function(t){var r=Object.getOwnPropertyDescriptor(n,t);Object.defineProperty(e,t,r.get?r:{enumerable:!0,get:function(){return n[t]}})}),e}var kC=function(n,e,t,r,i,o,s,a){if(!n){var c;if(e===void 0)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var l=[t,r,i,o,s,a],u=0;(c=new Error(e.replace(/%s/g,function(){return l[u++]}))).name="Invariant Violation"}throw c.framesToPop=1,c}},nS=function(n){return typeof n=="function"},$st=function(n){return n.length===0},Wue=function(n){return n.toString()},Zj=function(n){return typeof n=="string"},lte="/",S4="||",rS=function(n){return n},que=function(n){return n===null};function xo(n,e,t){e===void 0&&(e=rS),kC(nS(e)||que(e),"Expected payloadCreator to be a function, undefined or null");var r=que(e)||e===rS?rS:function(a){for(var c=arguments.length,l=new Array(c>1?c-1:0),u=1;u<c;u++)l[u-1]=arguments[u];return a instanceof Error?a:e.apply(void 0,[a].concat(l))},i=nS(t),o=n.toString(),s=function(){var a=r.apply(void 0,arguments),c={type:n};return a instanceof Error&&(c.error=!0),a!==void 0&&(c.payload=a),i&&(c.meta=t.apply(void 0,arguments)),c};return s.toString=function(){return o},s}var $2=function(n){if(typeof n!="object"||n===null)return!1;for(var e=n;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(n)===e},Kue=function(n){return Array.isArray(n)},YIe=function(n){return n==null},Lst=/\s/,Nst=/(_|-|\.|:)/,Fst=/([a-z][A-Z]|[A-Z][a-z])/,jst=/[\W_]+(.|$)/g,Bst=/(.)([A-Z]+)/g,Hst=function(n){return Lst.test(n)?n.toLowerCase():Nst.test(n)?(function(e){return e.replace(jst,function(t,r){return r?" "+r:""})}(n)||n).toLowerCase():Fst.test(n)?function(e){return e.replace(Bst,function(t,r,i){return r+" "+i.toLowerCase().split("").join(" ")})}(n).toLowerCase():n.toLowerCase()},Gue=function(n){return function(e){return Hst(e).replace(/[\W_]+(.|$)/g,function(t,r){return r?" "+r:""}).trim()}(n).replace(/\s(\w)/g,function(e,t){return t.toUpperCase()})},JIe=function(n){return n.indexOf("/")===-1?Gue(n):n.split("/").map(Gue).join("/")},dq=function(n,e){return n.reduce(function(t,r){return e(t,r)},{})},p7=function(n){return typeof Map<"u"&&n instanceof Map};function ute(n){if(p7(n))return Array.from(n.keys());if(typeof Reflect<"u"&&typeof Reflect.ownKeys=="function")return Reflect.ownKeys(n);var e=Object.getOwnPropertyNames(n);return typeof Object.getOwnPropertySymbols=="function"&&(e=e.concat(Object.getOwnPropertySymbols(n))),e}function QIe(n,e){return p7(e)?e.get(n):e[n]}var ePe=function(n){return function e(t,r,i,o){var s=r===void 0?{}:r,a=s.namespace,c=a===void 0?lte:a,l=s.prefix;return i===void 0&&(i={}),o===void 0&&(o=""),ute(t).forEach(function(u){var d=function(f){return o||!l||l&&new RegExp("^"+l+c).test(f)?f:""+l+c+f}(function(f){var p;if(!o)return f;var g=f.toString().split(S4),m=o.split(S4);return(p=[]).concat.apply(p,m.map(function(v){return g.map(function(b){return""+v+c+b})})).join(S4)}(u)),h=QIe(u,t);n(h)?e(h,{namespace:c,prefix:l},i,d):i[d]=h}),i}},Ust=ePe($2);function ZM(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{},r=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(t).filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable}))),r.forEach(function(i){zst(n,i,t[i])})}return n}function zst(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Sa(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];var i,o=$2((i=t)[i.length-1])?t.pop():{};return kC(t.every(Zj)&&(Zj(n)||$2(n)),"Expected optional object followed by string action types"),Zj(n)?Zue([n].concat(t),o):ZM({},function(s,a){return function(c,l){var u=l===void 0?{}:l,d=u.namespace,h=d===void 0?lte:d,f=u.prefix;function p(m,v,b){var S=JIe(b.shift());$st(b)?v[S]=c[m]:(v[S]||(v[S]={}),p(m,v[S],b))}var g={};return Object.getOwnPropertyNames(c).forEach(function(m){var v=f?m.replace(""+f+h,""):m;return p(m,g,v.split(h))}),g}(tPe(Ust(s,a)),a)}(n,o),Zue(t,o))}function tPe(n,e){var t=e===void 0?{}:e,r=t.prefix,i=t.namespace,o=i===void 0?lte:i;return dq(Object.keys(n),function(s,a){var c,l=n[a];kC(function(h){if(nS(h)||YIe(h))return!0;if(Kue(h)){var f=h[0],p=f===void 0?rS:f,g=h[1];return nS(p)&&nS(g)}return!1}(l),"Expected function, undefined, null, or array with payload and meta functions for "+a);var u=r?""+r+o+a:a,d=Kue(l)?xo.apply(void 0,[u].concat(l)):xo(u,l);return ZM({},s,((c={})[a]=d,c))})}function Zue(n,e){var t=tPe(dq(n,function(r,i){var o;return ZM({},r,((o={})[i]=rS,o))}),e);return dq(Object.keys(t),function(r,i){var o;return ZM({},r,((o={})[JIe(i)]=t[i],o))})}var Vst=function(){for(var n=arguments.length,e=Array(n),t=0;t<n;t++)e[t]=arguments[t];var r=typeof e[e.length-1]!="function"&&e.pop(),i=e;if(r===void 0)throw new TypeError("The initial state may not be undefined. If you do not want to set a value for this reducer, you can use null instead of undefined.");return function(o,s){for(var a=arguments.length,c=Array(a>2?a-2:0),l=2;l<a;l++)c[l-2]=arguments[l];var u=o===void 0,d=s===void 0;return u&&d&&r?r:i.reduce(function(h,f){return f.apply(void 0,[h,s].concat(c))},u&&!d&&r?r:o)}},Wst=ePe(function(n){return($2(n)||p7(n))&&!function(e){var t=ute(e),r=t.every(function(i){return i==="next"||i==="throw"});return t.length&&t.length<=2&&r}(n)});function ru(n,e,t){t===void 0&&(t={}),kC($2(n)||p7(n),"Expected handlers to be a plain object.");var r=Wst(n,t),i=ute(r).map(function(s){return function(a,c,l){c===void 0&&(c=rS);var u=Wue(a).split(S4);kC(!function(p){return p===void 0}(l),"defaultState for reducer handling "+u.join(", ")+" should be defined"),kC(nS(c)||$2(c),"Expected reducer to be a function or object with next and throw reducers");var d=nS(c)?[c,c]:[c.next,c.throw].map(function(p){return YIe(p)?rS:p}),h=d[0],f=d[1];return function(p,g){p===void 0&&(p=l);var m=g.type;return m&&u.indexOf(Wue(m))!==-1?(g.error===!0?f:h)(p,g):p}}(s,QIe(s,r),e)}),o=Vst.apply(void 0,i.concat([e]));return function(s,a){return s===void 0&&(s=e),o(s,a)}}const _4=xo("CONNECT_ZOOM_SOCKET"),Xj=xo("CONNECT_XMPP_SOCKET"),Zf=xo("CLOSE_ZOOM_SOCKET"),nPe=xo("CLOSE_XMPP_SOCKET"),c_=xo("RECEIVE_MESSAGE_FROM_ZOOM_SOCKET"),qst=xo("RECEIVE_SHARING_PAYLOAD_FROM_ZOOM_SOCKET"),rPe=xo("RECEIVE_MESSAGE_FROM_XMPP_SOCKET"),hq=xo("CONNECT_MAIN_SESSION_SOCKET"),iPe=xo("CLOSE_MAIN_SESSION_SOCKET"),Um=xo("RECEIVE_MESSAGE_FROM_MAIN_SESSION_SOCKET"),{setZoomSocketStatus:Vw,setRwgServersList:oPe,setRwgRetryCount:sPe,setXmppSocketStatus:w4,setMainSessionSocketStatus:C4,resetSocket:aPe}=Sa("SET_ZOOM_SOCKET_STATUS","SET_RWG_SERVERS_LIST","SET_RWG_RETRY_COUNT","SET_XMPP_SOCKET_STATUS","SET_MAIN_SESSION_SOCKET_STATUS","RESET_SOCKET"),dte=xo("CONNECT_TO_MEDIA_STREAM"),cPe=xo("RECEIVE_PAYLOAD_FROM_MEDIA_SDK"),{setAudioEncodeStatus:fq,setAudioDecodeStatus:pq,setVideoEncodeStatus:gq,setVideoDecodeStatus:mq,setSharingEncodeStatus:vq,setSharingDecodeStatus:x4,setMediaConstraints:hte,setMediaEncryptKey:lPe,setIsEnableDecoderInWorklet:uPe,setPatchedMediaSdkStatus:E4,setMediaAssetsPath:dPe,setIsEnableVideoAudioQos:hPe,setIsAudioBridgeReceiveReady:fPe,setIsAudioBridgeSendReady:pPe,setIsMediaAgentInitialized:fte,setAdaptedAbOptionForMediaSdk:gPe,resetMedia:mPe}=Sa("SET_AUDIO_ENCODE_STATUS","SET_AUDIO_DECODE_STATUS","SET_VIDEO_ENCODE_STATUS","SET_VIDEO_DECODE_STATUS","SET_SHARING_ENCODE_STATUS","SET_SHARING_DECODE_STATUS","SET_MEDIA_CONSTRAINTS","SET_MEDIA_ENCRYPT_KEY","SET_IS_ENABLE_DECODER_IN_WORKLET","SET_PATCHED_MEDIA_SDK_STATUS","SET_MEDIA_ASSETS_PATH","SET_IS_ENABLE_VIDEO_AUDIO_QOS","SET_IS_AUDIO_BRIDGE_RECEIVE_READY","SET_IS_AUDIO_BRIDGE_SEND_READY","SET_IS_MEDIA_AGENT_INITIALIZED","SET_ADAPTED_AB_OPTION_FOR_MEDIA_SDK","RESET_MEDIA");function Kst(n,e){for(var t=arguments.length,r=new Array(t>2?t-2:0),i=2;i<t;i++)r[i-2]=arguments[i];return n(hi(...r||[]),e,null)}function vPe(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];const r=function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return ga(...e.map(a=>{const c=a(...o);if(!c)throw new TypeError(`combineEpics: one of the provided Epics "${a.name||"<anonymous>"}" does not return a stream. Double check you're not missing a return statement!`);return c.pipe($f((l,u)=>(setTimeout(()=>{throw l},0),u)))}))};try{Object.defineProperty(r,"name",{value:`combineEpics(${e.map(i=>i.name||"<anonymous>").join(", ")})`})}catch{}return r}function iu(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return vPe(...e.flatMap(r=>Object.values(r)))}function zt(n,e){return n.pipe(rn(`${c_}`),st(t=>t.payload.evt===e))}function w1(n,e){return n.pipe(rn(`${Um}`),st(t=>t.payload.evt===e))}function TC(n,e){return n.pipe(rn(`${rPe}`),st(t=>t.payload.evt===e))}function Uf(n,e){return n.pipe(rn(`${c_}`,`${Um}`),st(t=>t.payload.evt===e))}function Vn(n,e){return n.pipe(rn(`${cPe}`),st(t=>Array.isArray(e)?e.indexOf(t.payload.type)>-1:t.payload.type===e))}function pte(n,e){return n.pipe(rn(`${dte}`),st(()=>{const{media:{assetsPath:t,mediaConstraints:r}}=e.value;return t!==void 0&&r!==void 0}),zr(()=>{const{media:{isMediaAgentInitialized:t}}=e.value;return t?Tt([0]):n.pipe(rn(`${fte}`),st(r=>!!r.payload),Ur(1))}))}const yPe="3.7.5",Gst=yPe,Zst=typeof atob=="function",Xst=typeof btoa=="function",Qx=typeof Buffer=="function",Xue=typeof TextDecoder=="function"?new TextDecoder:void 0,Yue=typeof TextEncoder=="function"?new TextEncoder:void 0,iP=Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="),r5=(n=>{let e={};return iP.forEach((t,r)=>e[t]=r),e})(),Yst=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,kc=String.fromCharCode.bind(String),Jue=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):n=>new Uint8Array(Array.prototype.slice.call(n,0)),bPe=n=>n.replace(/=/g,"").replace(/[+\/]/g,e=>e=="+"?"-":"_"),SPe=n=>n.replace(/[^A-Za-z0-9\+\/]/g,""),_Pe=n=>{let e,t,r,i,o="";const s=n.length%3;for(let a=0;a<n.length;){if((t=n.charCodeAt(a++))>255||(r=n.charCodeAt(a++))>255||(i=n.charCodeAt(a++))>255)throw new TypeError("invalid character found");e=t<<16|r<<8|i,o+=iP[e>>18&63]+iP[e>>12&63]+iP[e>>6&63]+iP[63&e]}return s?o.slice(0,s-3)+"===".substring(s):o},gte=Xst?n=>btoa(n):Qx?n=>Buffer.from(n,"binary").toString("base64"):_Pe,yq=Qx?n=>Buffer.from(n).toString("base64"):n=>{let e=[];for(let t=0,r=n.length;t<r;t+=4096)e.push(kc.apply(null,n.subarray(t,t+4096)));return gte(e.join(""))},I4=(n,e=!1)=>e?bPe(yq(n)):yq(n),Jst=n=>{if(n.length<2)return(e=n.charCodeAt(0))<128?n:e<2048?kc(192|e>>>6)+kc(128|63&e):kc(224|e>>>12&15)+kc(128|e>>>6&63)+kc(128|63&e);var e=65536+1024*(n.charCodeAt(0)-55296)+(n.charCodeAt(1)-56320);return kc(240|e>>>18&7)+kc(128|e>>>12&63)+kc(128|e>>>6&63)+kc(128|63&e)},Qst=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,wPe=n=>n.replace(Qst,Jst),Que=Qx?n=>Buffer.from(n,"utf8").toString("base64"):Yue?n=>yq(Yue.encode(n)):n=>gte(wPe(n)),DC=(n,e=!1)=>e?bPe(Que(n)):Que(n),ede=n=>DC(n,!0),eat=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,tat=n=>{switch(n.length){case 4:var e=((7&n.charCodeAt(0))<<18|(63&n.charCodeAt(1))<<12|(63&n.charCodeAt(2))<<6|63&n.charCodeAt(3))-65536;return kc(55296+(e>>>10))+kc(56320+(1023&e));case 3:return kc((15&n.charCodeAt(0))<<12|(63&n.charCodeAt(1))<<6|63&n.charCodeAt(2));default:return kc((31&n.charCodeAt(0))<<6|63&n.charCodeAt(1))}},CPe=n=>n.replace(eat,tat),xPe=n=>{if(n=n.replace(/\s+/g,""),!Yst.test(n))throw new TypeError("malformed base64.");n+="==".slice(2-(3&n.length));let e,t,r,i="";for(let o=0;o<n.length;)e=r5[n.charAt(o++)]<<18|r5[n.charAt(o++)]<<12|(t=r5[n.charAt(o++)])<<6|(r=r5[n.charAt(o++)]),i+=t===64?kc(e>>16&255):r===64?kc(e>>16&255,e>>8&255):kc(e>>16&255,e>>8&255,255&e);return i},mte=Zst?n=>atob(SPe(n)):Qx?n=>Buffer.from(n,"base64").toString("binary"):xPe,EPe=Qx?n=>Jue(Buffer.from(n,"base64")):n=>Jue(mte(n).split("").map(e=>e.charCodeAt(0))),IPe=n=>EPe(PPe(n)),nat=Qx?n=>Buffer.from(n,"base64").toString("utf8"):Xue?n=>Xue.decode(EPe(n)):n=>CPe(mte(n)),PPe=n=>SPe(n.replace(/[-_]/g,e=>e=="-"?"+":"/")),bq=n=>nat(PPe(n)),kPe=n=>({value:n,enumerable:!1,writable:!0,configurable:!0}),tde=function(){const n=(e,t)=>Object.defineProperty(String.prototype,e,kPe(t));n("fromBase64",function(){return bq(this)}),n("toBase64",function(e){return DC(this,e)}),n("toBase64URI",function(){return DC(this,!0)}),n("toBase64URL",function(){return DC(this,!0)}),n("toUint8Array",function(){return IPe(this)})},nde=function(){const n=(e,t)=>Object.defineProperty(Uint8Array.prototype,e,kPe(t));n("toBase64",function(e){return I4(this,e)}),n("toBase64URI",function(){return I4(this,!0)}),n("toBase64URL",function(){return I4(this,!0)})},g7={version:yPe,VERSION:Gst,atob:mte,atobPolyfill:xPe,btoa:gte,btoaPolyfill:_Pe,fromBase64:bq,toBase64:DC,encode:DC,encodeURI:ede,encodeURL:ede,utob:wPe,btou:CPe,decode:bq,isValid:n=>{if(typeof n!="string")return!1;const e=n.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(e)||!/[^\s0-9a-zA-Z\-_]/.test(e)},fromUint8Array:I4,toUint8Array:IPe,extendString:tde,extendUint8Array:nde,extendBuiltins:()=>{tde(),nde()}};function Jo(n){return g7.encode(n,!0)}function Xf(n){return g7.decode(n)}function TPe(n){return g7.encode(n,!1)}const rat={"-":"+",_:"/",".":"="};function Od(n){const e=n.replace(/[-_.]/g,t=>rat[t]);return Uint8Array.from(window.atob(e),t=>t.charCodeAt(0))}const DPe=n=>{const e=n.charCodeAt(0);return e<=parseInt("0x7F",16)?1:e<=parseInt("0x7FF",16)?2:e<=parseInt("0xFFFF",16)?3:e<=parseInt("0x1FFFFF",16)?4:e<=parseInt("0x3FFFFFF",16)?5:6},qk=(n,e)=>{const t=n.split(".").map(o=>Number(o)).slice(0,3),r=e.split(".").map(o=>Number(o)).slice(0,3);let i=0;for(let o=0;o<3;o++){const s=o<t.length?t[o]:0,a=o<r.length?r[o]:0;if(s<a){i=-1;break}if(s>a){i=1;break}}return i},XM=n=>{var e;let t=new Date().getTime(),r=1e3*((e=performance)===null||e===void 0?void 0:e.now())||0;const i="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,o=>{let s=16*Math.random();return t>0?(s=(t+s)%16|0,t=Math.floor(t/16)):(s=(r+s)%16|0,r=Math.floor(r/16)),(o==="x"?s:3&s|8).toString(16)});return typeof n=="string"||typeof n=="number"?i+":"+n:i+""};function eD(n,e){if(n===e)return!0;if(!n||!e)return!1;const t=Object.keys(n),r=Object.keys(e),i=t.length;if(r.length!==i)return!1;for(let o=0;o<i;o++){const s=t[o];if(n[s]!==e[s]||!Object.prototype.hasOwnProperty.call(e,s))return!1}return!0}const Gl=(n,e)=>n>>10==e>>10,m7=(n,e)=>new Promise(t=>{setTimeout(()=>{t(n())},e)}),$m=n=>{const e=`${Math.floor(1e4*Math.random())}`;return n.indexOf("@")>-1?n.replace("@",e):`${n}${e}`},Lf=n=>{try{const e=new URL(n);return!(e.protocol==="data:"&&e.origin==="null")&&e.origin!==location.origin}catch{return!0}},ES=n=>{const e=n.split(".")[1];if(typeof e=="string"){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("base64 string is not of the correct length")}try{const r=decodeURIComponent(window.atob(t).replace(/(.)/g,function(i,o){let s=o.charCodeAt(0).toString(16).toUpperCase();return s.length<2&&(s="0"+s),"%"+s}));return JSON.parse(r)}catch{console.error("Invalid token specified: invalid base64")}}};function vte(n){return n&&n.endsWith("/")?n.slice(0,n.length-1):n}function RPe(n){return[...new Uint8Array(n)].map(e=>e.toString(16).padStart(2,"0")).join("")}function rde(n){return`${n.tagName}${n.id?`#${n.id}`:""}${n.className?`${n.className.split(" ").map(e=>`.${e}`).join("")}`:""}`}function APe(n){const e=function(t){const r=t&&t.getRootNode();if(r&&r.nodeName!=="#document"&&r.host)return rde(r.host)}(n);return`${e?`${e}>`:""}${rde(n)}`}function YM(n){return typeof n=="object"&&n!==null?n instanceof HTMLElement?APe(n):ArrayBuffer.isView(n)?RPe(n.buffer):Array.isArray(n)?n.map(e=>YM(e)):Object.keys(n).reduce((e,t)=>({...e,[`${t}`]:YM(n[t])}),{}):n}let Eu=function(n){return n[n.Success=0]="Success",n[n.MeetingIsOver=6]="MeetingIsOver",n[n.UserFull=9]="UserFull",n[n.MeetingLocked=9]="MeetingLocked",n[n.WebinarBlockedEmail=3033]="WebinarBlockedEmail",n[n.MeetingNotStarted=3008]="MeetingNotStarted",n[n.MeetingHasClosed=103003]="MeetingHasClosed",n[n.UserHasBeenRemoved=103039]="UserHasBeenRemoved",n[n.MMRIBReject=103043]="MMRIBReject",n[n.MMRConfParticipantExists=103044]="MMRConfParticipantExists",n}({}),em=function(n){return n[n.Unknown=0]="Unknown",n[n.Normal=1]="Normal",n[n.Userrequest=2]="Userrequest",n[n.SdkConnection=3]="SdkConnection",n[n.Reconnect=5]="Reconnect",n[n.PtRequest=6]="PtRequest",n[n.KickedByHost=7]="KickedByHost",n[n.EndByHost=8]="EndByHost",n[n.EndByHostStartAnotherMeeting=9]="EndByHostStartAnotherMeeting",n[n.FreeMeetingTimeout=10]="FreeMeetingTimeout",n[n.JBHTimeout=11]="JBHTimeout",n[n.EndBySingleStatus=12]="EndBySingleStatus",n[n.WebinarNeedRegister=13]="WebinarNeedRegister",n[n.ArchiveFail=14]="ArchiveFail",n[n.EndByNone=15]="EndByNone",n[n.EndByAdmin=16]="EndByAdmin",n[n.DuplicateSession=17]="DuplicateSession",n[n.MeetingTransfer=18]="MeetingTransfer",n}({}),iat=function(n){return n[n.WaitingRoomFailover=1]="WaitingRoomFailover",n[n.WebEndAndRejoin=2]="WebEndAndRejoin",n}({}),mf=function(n){return n[n.Success=0]="Success",n[n.CommonError=200]="CommonError",n[n.WrongPasscode=3004]="WrongPasscode",n[n.RoleTypeMissing=3010]="RoleTypeMissing",n[n.InvalidParameter=4003]="InvalidParameter",n}({}),Go=function(n){return n[n.Success=0]="Success",n[n.AnotherMeetingInProgress=3e3]="AnotherMeetingInProgress",n[n.MeetingNotExist=3001]="MeetingNotExist",n[n.NotHost=3003]="NotHost",n[n.WrongPasscode=3004]="WrongPasscode",n[n.MissingEmail=3005]="MissingEmail",n[n.MeetingNotStarted=3008]="MeetingNotStarted",n[n.UserHasBeenRemoved=3009]="UserHasBeenRemoved",n[n.RoleTypeMissing=3010]="RoleTypeMissing",n[n.WebinarEnforceLogin=3034]="WebinarEnforceLogin",n[n.RealNameMissing=3082]="RealNameMissing",n[n.RegisterRequired=3099]="RegisterRequired",n[n.SsoLoginWindow=6024]="SsoLoginWindow",n[n.ZoomLoginWindow=3051]="ZoomLoginWindow",n[n.ZoomSpecificLoginWindow=3052]="ZoomSpecificLoginWindow",n[n.LoginRequired=3100]="LoginRequired",n[n.Reconnecting=4e3]="Reconnecting",n[n.Disconnect=4001]="Disconnect",n[n.InvalidParameter=4003]="InvalidParameter",n[n.DeniedRegisterWithPanelist=3032]="DeniedRegisterWithPanelist",n[n.ServiceOffline=403]="ServiceOffline",n[n.RwcEmpty=3621]="RwcEmpty",n[n.RwcError=3622]="RwcError",n[n.FrequentCall=3633]="FrequentCall",n[n.FrequentJoin=3634]="FrequentJoin",n[n.WasmFail=3635]="WasmFail",n[n.CommonError=200]="CommonError",n[n.Upgrade=1e4]="Upgrade",n}({});Go.Success,Go.RegisterRequired,Go.LoginRequired,Go.SsoLoginWindow,Go.ZoomLoginWindow,Go.ZoomSpecificLoginWindow,Go.MissingEmail,Go.MeetingNotExist,Go.NotHost,Go.WrongPasscode,Go.RoleTypeMissing,Go.AnotherMeetingInProgress,Go.MeetingNotStarted,Go.InvalidParameter,Go.Reconnecting,Go.UserHasBeenRemoved,Go.WebinarEnforceLogin,Go.Disconnect,Go.DeniedRegisterWithPanelist,Go.RwcEmpty,Go.RwcError,Go.FrequentCall,Go.FrequentJoin,Go.WasmFail,Go.Upgrade;const ide={3004:{"apac.errorcodes_pac_mn_wrong":3714},3005:{"apac.errorcodes_web_has_in_progress":3e3},3008:{"apac.errorcodes_not_start":3008},3027:{"apac.errorcodes_host_email_as_attendee":3627},3033:{"apac.errorcodes_denied_email":3620},1005:{"apac.errorcodes_no_response_from_web":3621},131005:{"apac.errorcodes_no_response_from_web":3621},1001:{"apac.errorcodes_host_inactive":3625},131001:{"apac.errorcodes_host_inactive":3625},131013:{"meeting ended":4004},103039:{"apac.errorcodes_be_removed":3009},6:{"meeting ended":4004},9:{"meeting is at capacity":4005},12:{"meeting locked":4006},103043:{"reject for information barriers":4007},103044:{"participant exist":4008}};function wp(n,e){let t={code:200,i18nKey:"apac.errorcodes_fail"};if(ide[n]!==void 0){const r=ide[n],i=Object.keys(r)[0];return t={code:r[i],i18nKey:i},{reason:i.startsWith("apac")?"":i,errorCode:t.code}}return{code:200,reason:"connection error"}}const oat=["bLock","bHoldUponEntry","viewOnly","listenOnlyPhone","bAllowRaiseHand","bAllowAttendeeRename","bBroadcast","bAllowPlayChimeForEnterOrExit","bIbDisableShare","bIbDisableChat","encryptKey","bNoHostTimeOut","bAllowShowCount","bHasAST","bHasRMC","gatewayKey","encryptKey"],ode={bChime:"bAllowPlayChimeForEnterOrExit",bHasAST:"hasAst",bHasRMC:"hasRmc",topic:n=>({meetingTopic:Xf(n)}),gatewayKey:n=>{const[,e,t]=n.split(".");return e&&t?{gatewayUser:{userId:Number(e),sn:t}}:{}},encryptKey:n=>({gcmSessinKey:Od(n)})},JM=xo("GET_MEETING_INFO"),L2=xo("GET_INSTANT_MEETING_INFO");xo("LOGON_ZOOM_DOMAIN"),xo("VERIFY_ZOOM_RECAPTCHA"),xo("LOGON_THIRD_PARTY_DOMAIN");const yte=xo("PING_RWC_SERVER"),Bc=xo("MEETING_FAILOVER"),IS=xo("LEAVE_MEETING"),Sq=xo("LEAVE_WAITING_ROOM"),N2=xo("END_MEETING");xo("REGISTER_WEBINAR");const sde=xo("TRIGGER_IDLE_CHECK"),ade=xo("END_OF_ZE_WORLD"),{setMeetingInfo:Hh,setMeetingJoinInfo:sat,setWindownOpen:aat,setAppidSignature:OPe,setZtk:cat,setZsk:lat,setTkMtkguid:uat,setPingRwcTimestamp:MPe,setInMeetingInfo:av,setMeetingAttribute:QM,resetMeeting:_q,setIsHost:$Pe,setIsCohost:LPe,setMeetingIsOnHold:Ww,setIsMeetingReset:NPe,setAudioVideoBeforeOnHold:FPe,setCurrentUserAudioBeforeReset:jPe,setIsCurrentUserMutedBeforeReset:BPe,setMeetingStatus:bte,setMeetingRegion:HPe,setIsCurrentUserStartVideoBeforeReset:UPe,setJoinMeetingTimeStamp:zPe,setActiveAppInfo:dat,setMeetingIdleStartTime:oP,setSessionIdleTimeoutMinutes:VPe,setIsAudioBridgeEnabled:WPe,addDiscardedRwcHost:qPe,setSharePronounType:KPe,setIsStayAwakeDuringTheSession:GPe,setMeetingJoinSuccessTimestamp:ZPe,resetFailoverRecord:XPe,setFailoverReason:e6,setIsQuicklyLeaveMeetingAfterRefresh:YPe,setMeetingInfoTimestamp:JPe,setIsEnableZmkFromRwg:QPe}=Sa({SET_MEETING_INFO:n=>n,SET_MEETING_JOIN_INFO:n=>n,SET_WINDOWN_OPEN:n=>n,SET_APPID_SIGNATURE:n=>n,SET_ZTK:n=>n,SET_ZSK:n=>n,SET_TK_MTKGUID:n=>n,SET_PING_RWC_TIMESTAMP:n=>n,SET_IN_MEETING_INFO:n=>n,SET_MEETING_ATTRIBUTE:n=>{if(oat.some(e=>n&&n[e]!==void 0)){let e=n;return Object.keys(ode).some(t=>n[t]!==void 0)&&(e=Object.keys(n).reduce((t,r)=>{const i=ode[r];return typeof i=="function"?Object.assign(t,i(n[r])):typeof i=="string"?t[i]=n[r]:(t[r],n[r]),t},{})),e}return{}},SET_IS_HOST:n=>n&&n.bHost,SET_IS_COHOST:n=>n&&n.bCoHost,RESET_MEETING:n=>n,SET_MEETING_IS_ON_HOLD:n=>n,SET_IS_MEETING_RESET:n=>n,SET_AUDIO_VIDEO_BEFORE_ON_HOLD:n=>n,SET_CURRENT_USER_AUDIO_BEFORE_RESET:n=>n,SET_IS_CURRENT_USER_MUTED_BEFORE_RESET:n=>n,SET_MEETING_STATUS:n=>n,SET_MEETING_REGION:n=>n,SET_IS_CURRENT_USER_START_VIDEO_BEFORE_RESET:n=>n,SET_JOIN_MEETING_TIME_STAMP:n=>n,SET_ACTIVE_APP_INFO:n=>n,SET_MEETING_IDLE_START_TIME:n=>n,SET_SESSION_IDLE_TIMEOUT_MINUTES:n=>n,SET_IS_AUDIO_BRIDGE_ENABLED:n=>n,ADD_DISCARDED_RWC_HOST:n=>n,SET_SHARE_PRONOUN_TYPE:n=>n,SET_IS_STAY_AWAKE_DURING_THE_SESSION:n=>n,SET_MEETING_JOIN_SUCCESS_TIMESTAMP:n=>n,RESET_FAILOVER_RECORD:n=>n,SET_FAILOVER_REASON:n=>n,SET_IS_QUICKLY_LEAVE_MEETING_AFTER_REFRESH:n=>n,SET_MEETING_INFO_TIMESTAMP:n=>n,SET_IS_ENABLE_ZMK_FROM_RWG:n=>n});let cc=function(n){return n.Failover="failover",n.OnHold="on hold",n.Promote="promote",n.Depromote="depromote",n.JoinBreakoutRoom="join breakout room",n.MoveToBreakoutRoom="move to breakout room",n.BackToMainSession="back to main session",n}({});const i1="js_media.min.js";let Yj=function(n){return n.CDN="CDN",n.Global="Global",n.CN="CN",n}({}),Lm=function(n){return n.Connected="Connected",n.Reconnecting="Reconnecting",n.Closed="Closed",n.Fail="Fail",n}({}),ws=function(n){return n.Initial="initial",n.Joined="joined",n.Closed="closed",n}({}),kp=function(n){return n.AudioBridgeEnable="M:1,2;V:1,2",n.AudioDecodeInWorklet="M:6;V:3",n.VideoFullHD="M:8;V:4",n.VideoShareFullHD="M:9;V:5",n.WebGL2Render="M:20;V:8",n.WebGPURender="M:21;V:9",n.ZMKFromRWG="M:19;V:10",n}({}),La=function(n){return n[n.NormalCase=-1]="NormalCase",n[n.NoHeartbeat=0]="NoHeartbeat",n[n.NoHeartbeatMChannel=1]="NoHeartbeatMChannel",n[n.NetworkChange=2]="NetworkChange",n[n.NotifyUiFailover=3]="NotifyUiFailover",n[n.InvalidParameters=4]="InvalidParameters",n[n.OnError=5]="OnError",n[n.OnErrorMChannel=6]="OnErrorMChannel",n[n.Disconnect=7]="Disconnect",n[n.DisconnectMChannel=8]="DisconnectMChannel",n[n.DisconnectXmpp=9]="DisconnectXmpp",n[n.RefreshPage=10]="RefreshPage",n}({});const hat=["8-29","9-21"];let ri=function(n){return n.LocalStorage="LocalStorage",n.SessionStorage="SessionStorage",n.Memory="Memory",n}({});const cde=Jo("{}");class rr{constructor(e){this.sessionStorageKey=void 0,this.localStorageKey=void 0,this.sessionCache=void 0,this.localCache=void 0,this.memoryCache=void 0,this.sessionStorageKey=Jo(`zoom-storage-${e}`),this.localStorageKey=Jo("zoom-local-storage"),this.memoryCache={};try{this.sessionCache=JSON.parse(Xf(sessionStorage.getItem(this.sessionStorageKey)||cde)),this.localCache=JSON.parse(Xf(localStorage.getItem(this.localStorageKey)||cde))}catch(t){console.error(t),this.sessionCache={},this.localCache={}}}static init(e){this.instance=new rr(e)}static get(e){if(this.instance===void 0)throw new Error("read before initial");return this.instance.getValue(e).value}static set(e,t,r){if(this.instance===void 0)throw new Error("set before initial");return this.instance.setValue(e,t,r)}static remove(e){if(this.instance===void 0)throw new Error("remove before initial");return this.instance.removeValue(e)}static clearSession(){if(this.instance===void 0)throw new Error("clear before initial");return this.instance.memoryCache={},this.instance.sessionCache={},this.instance.localCache={},sessionStorage.removeItem(this.instance.sessionStorageKey)}getValue(e){return this.sessionCache.hasOwnProperty(e)?{value:this.sessionCache[e],type:ri.SessionStorage}:this.localCache.hasOwnProperty(e)?{value:this.localCache[e],type:ri.LocalStorage}:{value:this.memoryCache[e],type:ri.Memory}}setValue(e,t,r){if(!e)throw new Error("key is null");switch(r){case ri.SessionStorage:{const i=this.sessionCache[e];let o=t;return typeof t=="function"&&(o=t(i)),i!==o&&(this.sessionCache[e]=o,this.flushValue(ri.SessionStorage)),o}case ri.LocalStorage:{const i=this.localCache[e];let o=t;return typeof t=="function"&&(o=t(i)),i!==o&&(this.localCache[e]=o,this.flushValue(ri.LocalStorage)),o}case ri.Memory:{const i=this.memoryCache[e];let o=t;return typeof t=="function"&&(o=t(i)),this.memoryCache[e]=o,o}default:return null}}removeValue(e){const{type:t}=this.getValue(e);switch(t){case ri.SessionStorage:delete this.sessionCache[e],this.flushValue(ri.SessionStorage);break;case ri.LocalStorage:delete this.localCache[e],this.flushValue(ri.LocalStorage);break;case ri.Memory:delete this.memoryCache[e]}}flushValue(e){e===ri.SessionStorage?sessionStorage.setItem(this.sessionStorageKey,Jo(JSON.stringify(this.sessionCache))):e===ri.LocalStorage&&localStorage.setItem(this.localStorageKey,Jo(JSON.stringify(this.localCache)))}}rr.instance=void 0;let Gi=function(n){return n.WebclientOpt="WEB_CLIENT_OPT",n.WebclientWebinarToken="WEB_CLIENT_WEBINAR_TOKEN",n.WebclientMeetingToken="WEB_CLIENT_MEETING_TOKEN",n.WebclientZtk="WEB_CLIENT_ZTK",n.WebclientZsk="WEB_CLIENT_ZSK",n.WebclientTk="WEB_CLIENT_TK",n.WebclientIVState="WEB_CLIENT_IV_STATE",n.WebclientIsOnHold="WEB_CLIENT_IS_ON_HOLD",n.WebclientParticipantId="WEB_CLIENT_PARTICIPANT_ID",n.WebclientZoomId="WEB_CLIENT_ZOOM_ID",n.WebclientUserName="WEB_CLIENT_USER_NAME",n.WebclientUserEmail="WEB_CLIENT_USER_EMAIL",n.WebclientBreakoutRoomAttendeeStatus="WEB_CLIENT_BO_ATTENDEE_STATUS",n.WebclientBreakoutRoomCommand="WEB_CLIENT_BO_COMMAND",n.WebclientAudioEncryptKey="WEB_CLIENT_AUDIO_ENCRYPT_KEY",n.WebclientVideoEncryptKey="WEB_CLIENT_VIDEO_ENCRYPT_KEY",n.WebclientSharingEncryptKey="WEB_CLIENT_SHARING_ENCRYPT_KEY",n.WebclientFailoverCount="WEB_CLIENT_FAILOVER_COUNT",n.WebclientRecordingToken="WEB_CLIENT_RECORDING_TOKEN",n}({}),wq=function(n){return n.WebclientDeviceId="WEBCLIENT_DEVICE_ID",n.VSDKLogTrackingId="ZM_VSDK_LOG_TRACKING_IDS",n}({}),Kk=function(n){return n.EnforceWebRTCAudio="ENFORCE_WEB_RTC_AUDIO",n.DisableAutoReportLogs="DISABLE_AUTO_REPORT_LOGS",n}({});function bs(n,e){const t=e.match(n);return t&&t.length>0&&t[1]||""}function eke(n,e){const t=e.match(n);return t&&t.length>1&&t[2]||""}const zv=/version\/(\d+(\.?_?\d+)+)/i,fat=[{test:[/opera/i],describe:n=>["Opera(Legacy)",bs(zv,n)||bs(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,n)]},{test:[/opr\/|opios/i],describe:n=>["Opera",bs(/(?:opr|opios)[\s/](\S+)/i,n)||bs(zv,n)]},{test:[/SamsungBrowser/i],describe:n=>["Samsung Internet for Android",bs(zv,n)||bs(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,n)]},{test:[/micromessenger/i],describe:n=>["WeChat",bs(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,n)||bs(zv,n)]},{test:[/qqbrowser/i],describe:n=>[/qqbrowserlite/i.test(n)?"QQ Browser Lite":"QQ Browser",bs(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,n)||bs(zv,n)]},{test:[/msie|trident/i],describe:n=>["Internet Explorer",bs(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,n)]},{test:[/\sedg\//i],describe:n=>["Microsoft Edge",bs(/\sedg\/(\d+(\.?_?\d+)+)/i,n)]},{test:[/edg([ea]|ios)/i],describe:n=>["Microsoft Edge(Legacy)",eke(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,n)]},{test:[/firefox|iceweasel|fxios/i],describe:n=>["Firefox",bs(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,n)]},{test:[/electron/i],describe:n=>["Electron",bs(/(?:electron)\/(\d+(\.?_?\d+)+)/i,n)]},{test:[/chromium/i],describe:n=>["Chromium",bs(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,n)||bs(zv,n)]},{test:[/chrome|crios|crmo/i],describe:n=>["Chrome",bs(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,n)]},{test:n=>!/like android/i.test(n)&&/android/i.test(n),describe:n=>["Android Browser",bs(zv,n)]},{test:[/safari|applewebkit/i],describe:n=>["Safari",bs(zv,n)]}],pat=[{test:[/windows /i],describe:n=>["Windows",bs(/Windows ((NT|XP)( \d\d?.\d)?)/i,n)]},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:n=>["iOS",eke(/(Version\/)(\d[\d.]+)/,n)]},{test:[/macintosh/i],describe:n=>["macOS",bs(/mac os x (\d+(\.?_?\d+)+)/i,n).replace(/[_\s]/g,".")]},{test:[/(ipod|iphone|ipad)/i],describe:n=>["iOS",bs(/os (\d+([_\s]\d+)*) like mac os x/i,n).replace(/[_\s]/g,".")]},{test:n=>!/like android/i.test(n)&&/android/i.test(n),describe:n=>["Android",bs(/android[\s/-](\d+(\.\d+)*)/i,n)]},{test:[/linux/i],describe:()=>["Linux"]},{test:[/CrOS/],describe:()=>["Chrome OS"]}];class gat{constructor(){this.value=void 0,this.gpu=void 0}get isSupported(){if(this.value===void 0)if(typeof window.OffscreenCanvas=="function"){const e=new OffscreenCanvas(1,1);e.addEventListener("webglcontextlost",r=>{r.preventDefault()});const t=e.getContext("webgl");if(this.value=!!t,t){const r=t.getExtension("WEBGL_debug_renderer_info");r&&(this.gpu=t.getParameter(r.UNMASKED_RENDERER_WEBGL))}}else this.value=!1;return this.value}}const tn=new class{constructor(){this._browser=void 0,this._os=void 0,this._browserVersion=void 0,this._osVersion=void 0,this._offscreenCanvasCapality=void 0,this._clientHintsData=void 0,this._offscreenCanvasCapality=new gat,"userAgentData"in navigator&&navigator.userAgentData.getHighEntropyValues(["architecture","bitness","formFactor","model","platformVersion","wow64"]).then(n=>{this._clientHintsData=n,this._os&&this._osVersion&&this._clientHintsData.platform&&this._clientHintsData.platformVersion&&(this._os=this._clientHintsData.platform,this._osVersion=this._clientHintsData.platformVersion)}).catch(n=>{console.warn(n)})}_getBrowserVersion(){var n,e;if((n=this._clientHintsData)!==null&&n!==void 0&&(e=n.brands)!==null&&e!==void 0&&e.length){const t=this._clientHintsData.brands.filter(i=>!/(Chromium|Not.*Brand)/i.test(i.brand))[0];t&&(this._browser=t.brand);const r=this._clientHintsData.brands.find(i=>{var o;return((o=i.brand)===null||o===void 0?void 0:o.toLowerCase())==="chromium"});r?(this._browserVersion=r.version,this._browser||(this._browser=r.brand)):this._browserVersion=t.version}else{const t=navigator.userAgent,r=fat.find(i=>typeof i.test=="function"?i.test(t):i.test.some(o=>o.test(t)));if(r){const i=r.describe(t);this._browser=i[0],this._browserVersion=i[1],this.isIOSMobile&&(this._browser="ios-safari")}else this._browser="unknown",this._browserVersion="0"}}_getOSVersion(){var n,e;if((n=this._clientHintsData)!==null&&n!==void 0&&n.platform&&(e=this._clientHintsData)!==null&&e!==void 0&&e.platformVersion)this._os=this._clientHintsData.platform,this._osVersion=this._clientHintsData.platformVersion;else{const t=navigator.userAgent,r=pat.find(i=>typeof i.test=="function"?i.test(t):i.test.some(o=>o.test(t)));if(r){const i=r.describe(t);this._os=i[0],this._osVersion=i[1]}else this._os="unknown",this._osVersion="0"}}get browser(){return this._browser||this._getBrowserVersion(),this._browser}get browserVersion(){return this._browserVersion||this._getBrowserVersion(),this._browserVersion}get os(){return this._os||this._getOSVersion(),this._os}get osVersion(){return this._osVersion||this._getOSVersion(),this._osVersion}get isIE(){return this.browser==="Internet Explorer"}get isLegacyEdge(){return this.browser==="Microsoft Edge(Legacy)"}get isLegacyOpera(){return this.browser==="Opera(Legacy)"}get isFirefox(){return this.browser==="Firefox"}get isSafari(){return this.browser==="Safari"}get isChrome(){var n,e,t;if((n=this._clientHintsData)!==null&&n!==void 0&&(e=n.brands)!==null&&e!==void 0&&e.length)return(t=this._clientHintsData)===null||t===void 0?void 0:t.brands.some(i=>{var o;return((o=i.brand)===null||o===void 0?void 0:o.toLocaleLowerCase())==="chromium"});const{userAgent:r}=navigator;return!this.isLegacyOpera&&!this.isLegacyEdge&&/chrome/i.test(r)&&/webkit/i.test(r)}get isLegacyChrome(){var n;return this.isChrome&&typeof((n=navigator.mediaDevices)===null||n===void 0?void 0:n.getDisplayMedia)!="function"}get isMacOS(){return this.os==="macOS"}get isIPad(){var n;return/iPad/i.test(navigator.userAgent)||this.isMacOS&&((n=navigator)===null||n===void 0?void 0:n.maxTouchPoints)>2}get isIOSMobile(){return this.os==="iOS"||this.isIPad}get architecture(){var n,e;return(n=(e=this._clientHintsData)===null||e===void 0?void 0:e.architecture)!==null&&n!==void 0?n:""}get isArm(){return this.architecture?this.architecture==="arm":/arm/i.test(navigator.userAgent)}get isChromeOS(){return this.os==="Chrome OS"}get isAndroidBrowser(){var n;return((n=this.os)===null||n===void 0?void 0:n.toLowerCase())==="android"}get isArmChromeOS(){return this.isArm&&this.isChromeOS}get isAndroidOrIOSBrowser(){return this.isAndroidBrowser||this.isIOSMobile}get isSupportEssentialAudioAndVideoAbility(){return typeof WebAssembly=="object"&&typeof Worker=="function"}get isSupportAudioWorklet(){return typeof AudioWorklet=="function"}get isSupportImageCapture(){return"ImageCapture"in window}get isSupportMediaStreamTrackProcessor(){return"MediaStreamTrackProcessor"in window}get isSupportOffscreenCanvas(){return this._offscreenCanvasCapality.isSupported}get gpu(){return this._offscreenCanvasCapality.isSupported?this._offscreenCanvasCapality.gpu:""}get bitness(){var n,e;return(n=(e=this._clientHintsData)===null||e===void 0?void 0:e.bitness)!==null&&n!==void 0?n:""}get model(){var n,e;return(n=(e=this._clientHintsData)===null||e===void 0?void 0:e.model)!==null&&n!==void 0?n:""}get wow64(){var n;if(this.os.toLowerCase()==="windows")return(n=this._clientHintsData)===null||n===void 0?void 0:n.wow64}get isSupportSendScreenSharing(){return"getDisplayMedia"in navigator.mediaDevices&&typeof navigator.mediaDevices.getDisplayMedia=="function"}};function ra(){return tn.isAndroidOrIOSBrowser||!!rr.get(Kk.EnforceWebRTCAudio)}const tke=()=>tn.isIE,v7=()=>{var n;return tn.isSupportOffscreenCanvas&&((n=navigator)===null||n===void 0?void 0:n.hardwareConcurrency)>=2&&typeof requestAnimationFrame=="function"&&typeof SharedArrayBuffer=="function"},RC=(n,e)=>{var t;const{isSafari:r,isIOSMobile:i,isSupportMediaStreamTrackProcessor:o,isAndroidOrIOSBrowser:s,isArmChromeOS:a,isChromeOS:c,isArm:l,isSupportOffscreenCanvas:u,isIPad:d}=tn;if(!v7()){const h=r||i,f=typeof window.SharedArrayBuffer!="function"&&(!!h||o&&u);return n&&f?e?25:navigator.hardwareConcurrency<4?2:4:1}return s?e?25:d?9:4:a||c&&!l?navigator.hardwareConcurrency>=4?9:2:((t=navigator)===null||t===void 0?void 0:t.hardwareConcurrency)<4?2:25};function nke(){var n;return"webkit"in window&&!("chrome"in window)&&!((n=window.webkit.messageHandlers)===null||n===void 0||!n.jsOCHelper)}function i5(){var n;const{isAndroidBrowser:e,isIOSMobile:t,osVersion:r,browserVersion:i,isChrome:o,isFirefox:s,isSafari:a}=tn;var c,l;if(t)return Number((c=r.match(/^\d+/))===null||c===void 0?void 0:c[0])>=15;if(e)return Number((l=r.match(/^\d+/))===null||l===void 0?void 0:l[0])>=10;const u=Number((n=i.match(/^\d+/))===null||n===void 0?void 0:n[0]);return!!(o&&u>=69)||!!(a&&u>14)||!!(s&&u>=76)}let fa=function(n){return n.VIDEO_ENCODE="0",n.VIDEO_DECODE="1",n.AUDIO_ENCODE="2",n.AUDIO_DECODE="3",n.SHARING_ENCODE="4",n.SHARING_DECODE="5",n}({}),tD=function(n){return n[n.NONE=0]="NONE",n[n.AES_256=1]="AES_256",n[n.AES_GCM=2]="AES_GCM",n}({});const fc=Object.freeze({RWG_CHAT:{gcmType:1,sessionType:"RWG_CHAT"},XMPP_CHAT:{gcmType:1,sessionType:"XMPP_CHAT"},CC_MESSAGE:{gcmType:3,sessionType:"CC_MESSAGE"},BO_BROADCAST:{gcmType:1,sessionType:"BO_BROADCAST"},CHAT_FILE:{gcmType:2,sessionType:"CHAT_FILE"},CHAT_FILE_INFO:{gcmType:1,sessionType:"CHAT_FILE_INFO"}}),KE=(window.crypto||window.msCrypto).subtle,j_=Gi.WebclientIVState,mat=Object.keys(fc).map(n=>fc[n].sessionType);let zc=class rke{constructor(e,t,r){this.isGCMEnabled=void 0,this.gcmSessionKey=void 0,this.gcmMainSessionKey=void 0,this.zoomId=void 0,this.resetParameters(e,t,r),rr.set(j_,{},ri.SessionStorage)}static init(e,t,r){this.instance?this.instance.resetParameters(e,t,r):this.instance=new rke(e,t,r)}static destroy(){this.instance&&(this.instance=void 0)}resetParameters(e,t,r){this.isGCMEnabled=!(tn.isIE||!tn.isSupportEssentialAudioAndVideoAbility)&&r===tD.AES_GCM,this.gcmSessionKey=Od(t),this.gcmMainSessionKey||(this.gcmMainSessionKey=this.gcmSessionKey),this.zoomId=String(e)}beginCrypto(e,t,r){const i=new Uint32Array(1);i[0]=9,i[0]+=Number(r);const o=new Uint8Array(i.buffer);let s=new Uint8Array(132);const a=Od(t);return s.set(a,0),s.set(o,a.length),s=s.subarray(0,a.length+4),KE.importKey("raw",e,{name:"HMAC",hash:"SHA-256"},!0,["sign"]).then(c=>KE.sign({name:"HMAC"},c,s)).then(c=>KE.importKey("raw",c,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"]))}getNextIV(e){const t=rr.get(j_);return t[e]===void 0?(t[e]=0,rr.set(j_,t,ri.SessionStorage)):rr.set(j_,r=>({...r,[e]:r[e]+1}),ri.SessionStorage)}resetIVState(){const e=rr.get(j_);if(e!==void 0){const t=Object.keys(e).filter(r=>mat.indexOf(r)>-1);t.length>0&&(t.forEach(r=>{e[r]+=1e6}),rr.set(j_,e,ri.SessionStorage))}}static resetIV(){if(this.instance===void 0)throw new Error("reset before intialize");this.instance.resetIVState()}static beginEncrypt(e){let{text:t,type:r}=e;const i=new Uint8Array(0);if(this.instance&&this.instance.isGCMEnabled){const a=this.instance.getNextIV(r.sessionType),c=new ArrayBuffer(12),l=new Uint8Array(c);new DataView(c).setUint32(0,a,!0);let u=null;return u=r.sessionType==="BO_BROADCAST"||r.sessionType==="XMPP_CHAT"?this.instance.gcmMainSessionKey:this.instance.gcmSessionKey,this.instance.beginCrypto(u,this.instance.zoomId,r.gcmType).then(d=>{const h=ArrayBuffer.isView(t)?t:new TextEncoder().encode(t);return KE.encrypt({name:"AES-GCM",iv:l,additionalData:i,tagLength:8*16},d,h)}).then(d=>{const h=1+l.byteLength+2+i.byteLength+4+d.byteLength,f=new ArrayBuffer(h);if(new Uint8Array(f)[0]=l.length,new Uint8Array(f,1,l.byteLength).set(l),new DataView(f).setUint16(1+l.byteLength,i.length,!0),new Uint8Array(f,3+l.byteLength).set(i),new DataView(f).setUint32(1+l.byteLength+2+i.byteLength,d.byteLength-16,!0),new Uint8Array(f,1+l.byteLength+2+i.byteLength+4).set(new Uint8Array(d)),r.sessionType===fc.CHAT_FILE.sessionType)return f;const p=new Uint8Array(f).reduce((g,m)=>g+String.fromCharCode(m),"");return window.btoa(p).replace(/_/g,"/").replace(/-/g,"+").replace(/\=/g,"")})}return Promise.resolve(ArrayBuffer.isView(t)?t:Jo(t))}static beginDecrypt(e){let{decryptedText:t,type:r,zoomId:i}=e;if(this.instance&&this.instance.isGCMEnabled){const o=ArrayBuffer.isView(t)||t instanceof ArrayBuffer?new Uint8Array(t):function(m){let v;const b=m.length,S=new Array(b);for(v=0;v<b;++v)S[v]=255&m.charCodeAt(v);return new Uint8Array(S)}(atob(t.replace(/_/g,"/").replace(/-/g,"+"))),s=o[0],a=o.slice(1,s+1),c=o.slice(1+s,3+s),l=new DataView(c.buffer).getUint16(0,!0),u=o.slice(1+s+2,1+s+2+l),d=o.slice(1+s+2+l,1+s+2+l+4),h=new DataView(d.buffer).getUint32(0,!0),f=o.slice(1+s+2+l+4,1+s+2+l+4+h),p=o.slice(1+s+2+l+4+h);let g=null;return g=r.sessionType==="BO_BROADCAST"||r.sessionType==="XMPP_CHAT"?this.instance.gcmMainSessionKey:this.instance.gcmSessionKey,this.instance.beginCrypto(g,i,r.gcmType).then(m=>{const v=function(b,S){b=new Uint8Array(b),S=new Uint8Array(S);const E=new Uint8Array(b.length+S.length);return E.set(b),E.set(S,b.length),E}(f,p);return KE.decrypt({name:"AES-GCM",iv:a,additionalData:u,tagLength:8*p.length},m,v.buffer)}).then(m=>({message:r.sessionType===fc.CHAT_FILE.sessionType?m:new TextDecoder().decode(m),iv:a,aad:u})).catch(m=>({message:"[This is an encrypted message]",iv:a,aad:u}))}{const o=new TextDecoder("utf-8");return Promise.resolve({message:ArrayBuffer.isView(t)||t instanceof ArrayBuffer?t:o.decode(Od(t))})}}};zc.instance=void 0;const Cq=20225,Ste=20234,Co=7937,Md=7938,xq=12039,lde=16138,y7=4098,Jj=4305,o5=4343,Eq=16428;let $o=function(n){return n[n.NoAttendee=0]="NoAttendee",n[n.All=1]="All",n[n.AllPanelist=2]="AllPanelist",n[n.Host=3]="Host",n[n.NoOne=4]="NoOne",n[n.EveryonePublicly=5]="EveryonePublicly",n}({}),PS=function(n){return n[n.AllPanelist=1]="AllPanelist",n[n.Everyone=2]="Everyone",n[n.Invalid=0]="Invalid",n}({}),Zi=function(n){return n[n.All=0]="All",n[n.Panelist=1]="Panelist",n[n.IndividualCcPanelist=2]="IndividualCcPanelist",n[n.Individual=3]="Individual",n[n.SilentModeUsers=4]="SilentModeUsers",n}({}),t6=function(n){return n[n.None=0]="None",n[n.Delete=1]="Delete",n[n.Modify=2]="Modify",n}({}),Qj=function(n){return n[n.Success=0]="Success",n[n.Delete=1]="Delete",n[n.Block=3]="Block",n}({});const vat=[$o.All,$o.Host,$o.NoOne,$o.EveryonePublicly],yat=[$o.NoOne,$o.All,$o.AllPanelist],n6={AllPanelist:11,Everyone:12},bat={[n6.AllPanelist]:PS.AllPanelist,[n6.Everyone]:PS.Everyone},sP={userId:Zi.All,displayName:"Everyone",isHost:!1,isCoHost:!1},qw={userId:Zi.Panelist,displayName:"All panelists"},Sat={userId:Zi.SilentModeUsers,displayName:"Everyone (in Waiting Room)",isHost:!1,isCoHost:!1};let _at=function(n){return n[n.Local=0]="Local",n[n.ThirdParty=1]="ThirdParty",n}({}),Xa=function(n){return n[n.ChunkSize=20971520]="ChunkSize",n[n.EncodeBlockSize=32768]="EncodeBlockSize",n[n.DecodeBlockSize=32803]="DecodeBlockSize",n[n.MaxSize=2147483648]="MaxSize",n[n.ReaderChunkSize=1073741824]="ReaderChunkSize",n}({}),Qs=function(n){return n[n.Init=0]="Init",n[n.InProgress=1]="InProgress",n[n.Success=2]="Success",n[n.Fail=3]="Fail",n[n.Cancel=4]="Cancel",n[n.Complete=5]="Complete",n}({}),Sm=function(n){return n[n.InProgress=1]="InProgress",n[n.Success=2]="Success",n[n.Fail=3]="Fail",n[n.Cancel=4]="Cancel",n}({});const wat={"7z":"application/x-7z-compressed",avi:"video/x-msvideo",bin:"application/octet-stream",bmp:"image/bmp",css:"text/css",csv:"text/csv",doc:"application/msword",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",gif:"image/gif",gz:"application/gzip",html:"text/html",ics:"text/calendar",jar:"application/java-archive",jpeg:"image/jpeg",jpg:"image/jpeg",js:"text/javascript",json:"application/json",mid:"audio/midi",mov:"video/*",mp3:"audio/mpeg",mp4:"video/mp4",mpeg:"video/*",mpg:"video/*",pdf:"application/pdf",png:"image/png",ppt:"application/vnd.ms-powerpoint",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",rar:"application/vnd.rar",rtf:"application/rtf",tar:"application/x-tar",tif:"image/tiff",tiff:"image/tiff",txt:"text/plain",wav:"audio/wav",webp:"image/webp",wma:"audio/*",wmv:"video/*",xls:"application/vnd.ms-excel",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xml:"application/xml",zip:"application/zip"};let gl=function(n){return n.Open="open",n.Message="message",n.Error="error",n.Close="close",n.Inactive="inactive",n}({});class ike{constructor(){this.eventHandlers=void 0,this.websocket=void 0,this.seq=void 0,this.intervalsToBeCleardWhenSocketClose=[],this.isAlive=!1,this.eventHandlers=new Map,this.websocket=null,this.seq=1}on(e,t){let r=this.eventHandlers.get(e);r||(r=[]),r.push(t),this.eventHandlers.set(e,r)}off(e,t){const r=this.eventHandlers.get(e);if(r){const i=r.filter(o=>o!==t);this.eventHandlers.set(e,i)}}emit(e,t){const r=this.eventHandlers.get(e);r&&r instanceof Array&&r.slice(0).forEach(i=>{try{i(t)}catch(o){console.error(o)}})}sendMessageToRwg(e){this.seq+=1;const t=this.seq;return this.websocket&&this.websocket.readyState===WebSocket.OPEN&&this.websocket.send(JSON.stringify(Object.assign(e,{seq:t}))),t}connect(e){this.websocket=new WebSocket(e),this.websocket.binaryType="arraybuffer",this.addWebSocketEventListeners()}close(){var e;(e=this.websocket)===null||e===void 0||e.close()}addHeartBeat(){const e=tn.isAndroidOrIOSBrowser?15e3:2e4,t=setInterval(()=>{this.isAlive||this.emit(gl.Inactive,{}),this.sendMessageToRwg({evt:0}),this.isAlive=!1},e);this.intervalsToBeCleardWhenSocketClose.push(t)}clearIntervals(){this.intervalsToBeCleardWhenSocketClose.forEach(e=>clearInterval(e)),this.isAlive=!1}addWebSocketEventListeners(){this.websocket&&(this.websocket.addEventListener("open",e=>{this.addHeartBeat(),this.emit(gl.Open,e)}),this.websocket.addEventListener("message",e=>{this.isAlive=!0,this.emit(gl.Message,e)}),this.websocket.addEventListener("close",e=>{this.clearIntervals(),this.emit(gl.Close,e)}),this.websocket.addEventListener("error",e=>{this.clearIntervals(),this.emit(gl.Error,e)}))}sendLaunchParams(e){return{seq:this.sendMessageToRwg({evt:4301,body:e})}}joinMeeting(e){return{seq:this.sendMessageToRwg({evt:4097,body:{meetingtoken:e}})}}lockMeeting(e){return{seq:this.sendMessageToRwg({evt:4099,body:{bLock:e}})}}endMeeting(){return{seq:this.sendMessageToRwg({evt:4101,body:{}})}}leaveMeeting(){const e=arguments.length>0&&arguments[0]!==void 0&&arguments[0]?4364:4103;return{seq:this.sendMessageToRwg({evt:e,body:{}})}}recordMeeting(e,t){return{seq:this.sendMessageToRwg({evt:4105,body:{bRecord:e,bPause:t}})}}localRecordingGrantPermission(e,t,r){return{seq:this.sendMessageToRwg({evt:o5,body:{cmdType:"permission_request_answer",userId:e,agreed:t,saveAgreed:r}})}}hostGrantPermission(e,t){return{seq:this.sendMessageToRwg({evt:o5,body:{cmdType:"grant_permission",userId:e,grant:t}})}}localRecordingRequestPermission(){return{seq:this.sendMessageToRwg({evt:o5,body:{cmdType:"request_permission"}})}}localRecordingMeeting(e){return{seq:this.sendMessageToRwg({evt:o5,body:{cmdType:"change_recording_status",status:e}})}}summaryMeeting(e){return{seq:this.sendMessageToRwg({evt:8009,body:{type:e?"start":"stop"}})}}startMeetingQuery(e){return{seq:this.sendMessageToRwg({evt:8017,body:{type:e?"start":"stop"}})}}allowSelfRecord(e){return{seq:this.sendMessageToRwg({evt:4325,body:{bAllowISORecord:e}})}}enableZoomIQRecord(e){return{seq:this.sendMessageToRwg({evt:4318,body:{check:e}})}}expel(e){return{seq:this.sendMessageToRwg({evt:4107,body:{id:e}})}}expelAttendee(e){return{seq:this.sendMessageToRwg({evt:4205,body:{jid:e}})}}rename(e,t,r){return{seq:this.sendMessageToRwg({evt:4109,body:{id:e,dn2:t,olddn2:r}})}}assignHost(e,t){return{seq:this.sendMessageToRwg({evt:4111,body:{id:e,bCoHost:t}})}}reclaimHost(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return{seq:this.sendMessageToRwg({evt:4133,body:{id:e,bCoHost:t}})}}revokeCoHost(e){return{seq:this.sendMessageToRwg({evt:4195,body:{id:e}})}}putOnHold(e,t){return{seq:this.sendMessageToRwg({evt:4113,body:{id:e,bHold:t}})}}setMuteOnEntry(e){return{seq:this.sendMessageToRwg({evt:4115,body:{bOn:e}})}}setHoldOnEntry(e){return{seq:this.sendMessageToRwg({evt:4117,body:{bOn:e}})}}inviteCRCDevice(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:2;return{seq:this.sendMessageToRwg({evt:4119,body:{ip:e,type:t,encrypt:r}})}}cancelInviteCRCDevice(e){return{seq:this.sendMessageToRwg({evt:4121,body:{transID:e}})}}sendCloseCaption(e){return{seq:this.sendMessageToRwg({evt:4125,body:{...e}})}}allowViewParticipantNumber(e){return{seq:this.sendMessageToRwg({evt:4127,body:{bOn:e}})}}lowerAllHands(){return{seq:this.sendMessageToRwg({evt:4129,body:{}})}}raiseLowerHand(e,t){return{seq:this.sendMessageToRwg({evt:4131,body:{id:e,bOn:t}})}}chat(e,t,r,i){const o={text:e,destNodeID:t};return r&&Object.assign(o,{sn:r}),i&&Object.assign(o,{attendeeNodeID:i}),{seq:this.sendMessageToRwg({evt:4135,body:o})}}assignCC(e,t){return{seq:this.sendMessageToRwg({evt:4137,body:{id:e,bCCEditor:t}})}}enableLT(e){return{seq:this.sendMessageToRwg({evt:4227,body:{op:e?2:4}})}}enableNewLLT(){return{seq:this.sendMessageToRwg({evt:4285})}}disableCaptions(e){return{seq:this.sendMessageToRwg({evt:Jj,body:{type:4,disableNewLtt:e}})}}enableManualCaption(e){return{seq:this.sendMessageToRwg({evt:4291,body:{op:e?1:0}})}}setTranslationLanguage(e){return e!==void 0?{seq:this.sendMessageToRwg({evt:Jj,body:{type:1,lang:e}})}:{seq:this.sendMessageToRwg({evt:Jj,body:{type:3}})}}setSpokenLanguage(e){return{seq:this.sendMessageToRwg({evt:4287,body:{lang:e}})}}allowAskLT(e){return{seq:this.sendMessageToRwg({evt:4263,body:{bAnonymous:e}})}}approveLT(){return{seq:this.sendMessageToRwg({evt:4262,body:{bApproved:!0}})}}askLT(e){return{seq:this.sendMessageToRwg({evt:4261,body:{bAnonymous:e}})}}setChatPriviledge(e){return{seq:this.sendMessageToRwg({evt:4141,body:{chatPriviledge:e}})}}setPanelistChatPrivilege(e){if(!Object.values(n6).includes(e))throw Error("Invalid panelist chat privilege req value");return{seq:this.sendMessageToRwg({evt:4141,body:{chatPriviledge:e}})}}sendFeedback(e){return{seq:this.sendMessageToRwg({evt:4143,body:{feedback:e}})}}clearFeedback(){return{seq:this.sendMessageToRwg({evt:4145,body:{}})}}allowUnmuteVideo(e){return{seq:this.sendMessageToRwg({evt:4147,body:{bOn:e}})}}allowUnmuteAudio(e){return{seq:this.sendMessageToRwg({evt:4149,body:{bOn:e}})}}allowRaiseHand(e){return{seq:this.sendMessageToRwg({evt:4151,body:{bOn:e}})}}boToken(e){return{seq:this.sendMessageToRwg({evt:4173,body:{topic:e}})}}startBO(e){return{seq:this.sendMessageToRwg({evt:4175,body:{proto:e}})}}stopBO(e){return{seq:this.sendMessageToRwg({evt:4177,body:{status:e}})}}assignToBO(e,t){return{seq:this.sendMessageToRwg({evt:4179,body:{targetID:e,targetBID:t}})}}switchBO(e,t){return{seq:this.sendMessageToRwg({evt:4181,body:{targetID:e,targetBID:t}})}}wantJoinBO(e,t){return{seq:this.sendMessageToRwg({evt:4183,body:{targetID:e,targetBID:t}})}}joinBO(e){return{seq:this.sendMessageToRwg({evt:4193,body:{targetBID:e}})}}leaveBO(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1;return{seq:this.sendMessageToRwg({evt:4185,body:{reason:e}})}}broadcastBO(e){return{seq:this.sendMessageToRwg({evt:4187,body:{textContent:e}})}}askForHelpBO(e){return{seq:this.sendMessageToRwg({evt:4189,body:{targetID:e}})}}askForHelpResultBO(e,t){return{seq:this.sendMessageToRwg({evt:4191,body:{targetID:e,helpResult:t}})}}coHostStartBO(e,t){return{seq:this.sendMessageToRwg({evt:4241,body:{proto:e,targetID:t}})}}coHostStopBO(e,t){return{seq:this.sendMessageToRwg({evt:4243,body:{status:e,targetID:t}})}}coHostAssignToBO(e,t,r){return{seq:this.sendMessageToRwg({evt:4245,body:{userGUID:e,targetID:r,targetBID:t}})}}moveToMainSession(e){return{seq:this.sendMessageToRwg({evt:4247,body:{userGUID:e}})}}coHostMoveToMainSession(e,t){return{seq:this.sendMessageToRwg({evt:4249,body:{userGUID:e,targetID:t}})}}allowParticipantRename(e){return{seq:this.sendMessageToRwg({evt:4163,body:{bOn:e}})}}allowMessageFeedbackNotify(e,t){return{seq:this.sendMessageToRwg({evt:4171,body:{bOn:e,id:t}})}}setPlayChime(e,t){return{seq:this.sendMessageToRwg({evt:4197,body:{bOn:e,id:t}})}}admitAllSilentUsers(){return{seq:this.sendMessageToRwg({evt:4199,body:{}})}}bindTeleUser(e,t,r){return{seq:this.sendMessageToRwg({evt:4201,body:{teleUserID:e,targetUserID:t,bBind:r}})}}practiceSession(){return{seq:this.sendMessageToRwg({evt:4207,body:null})}}roleChangeWebinar(e,t,r,i){return{seq:this.sendMessageToRwg({evt:4209,body:{jid:t,userID:r,clientCap:i,bPromote:e}})}}sendPromoteConsent(e,t){return{seq:this.sendMessageToRwg({evt:4254,body:{agreed:e,req_id:t}})}}batchCreateBOToken(e){const t=e.map((r,i)=>({topic:r,index:i}));return{seq:this.sendMessageToRwg({evt:4211,body:t})}}mute(e,t){return{seq:this.sendMessageToRwg({evt:8193,body:{bMute:t,id:e}})}}audioDrop(e){return{seq:this.sendMessageToRwg({evt:8195,body:{id:e}})}}audioDialout(e,t,r,i,o){return{seq:this.sendMessageToRwg({evt:8197,body:{pn:e,dn2:Jo(t),bCallme:r,bPressOne:i,bGreeting:o}})}}audioCancelDialout(e,t){return{seq:this.sendMessageToRwg({evt:8199,body:{pn:e,bCallme:t}})}}audioMuteAll(e){return{seq:this.sendMessageToRwg({evt:8201,body:{bMute:e}})}}allowToTalk(e,t){return{seq:this.sendMessageToRwg({evt:8204,body:{id:e,bAllowTalk:t}})}}subscribeVideo(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0;return{seq:this.sendMessageToRwg({evt:12289,body:{id:e,size:t,bOn:r}})}}unsubscribeVideo(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1;return{seq:this.sendMessageToRwg({evt:12291,body:{id:e}})}}muteAttendeeVideo(e,t){return{seq:this.sendMessageToRwg({evt:12297,body:{id:e,bOn:t}})}}notifyRwgIsMuteVideo(e,t){return this.muteAttendeeVideo(e,t)}pauseSharing(){return{seq:this.sendMessageToRwg({evt:16385,body:{}})}}resumeSharing(){return{seq:this.sendMessageToRwg({evt:16387,body:{}})}}allowAnonymousQuestion(e,t){return{seq:this.sendMessageToRwg({evt:4155,body:{userId:e,bOn:t}})}}allowViewAll(e,t){return{seq:this.sendMessageToRwg({evt:4157,body:{userId:e,bOn:t}})}}allowVote(e,t){return{seq:this.sendMessageToRwg({evt:4159,body:{userId:e,bOn:t}})}}allowComment(e,t){return{seq:this.sendMessageToRwg({evt:4161,body:{userId:e,bOn:t}})}}sharingRequestRemoteControl(e,t){return{seq:this.sendMessageToRwg({evt:16389,body:{id:e,bOn:t}})}}subscribeGrabRemoteControl(e,t){return{seq:this.sendMessageToRwg({evt:16393,body:{id:e,bOn:t}})}}subscribeSharing(e,t,r,i){const o={id:e,size:t};return r&&Object.assign(o,{bShareToBO:!0}),i!==void 0&&Object.assign(o,{bVideoShare:i}),{seq:this.sendMessageToRwg({evt:16415,body:o})}}unsubscribeSharing(e,t){const r={id:e};return t&&Object.assign(r,{bShareToBO:!0}),{seq:this.sendMessageToRwg({evt:16417,body:r})}}sendRWGConnectionPerformance(e){return{seq:this.sendMessageToRwg({evt:4167,body:{data:e}})}}sendSdkKeyToMonitor(e,t,r){return{seq:this.sendMessageToRwg({evt:4167,body:{data:`ZoomConferenceClient,videoapp_HTML5_sdk_web_join,${r},2,${t},${e}`}})}}sendDatachannelOffer(e){return{seq:this.sendMessageToRwg({evt:24321,offer:e})}}joinOrLeaveVoip(e){return{seq:this.sendMessageToRwg({evt:8203,body:{bOn:e}})}}startSharing(e,t){return{seq:this.sendMessageToRwg({evt:16409,body:{id:e,boOn:!1,...t??{}}})}}stopSharing(e){return{seq:this.sendMessageToRwg({evt:16409,body:{id:e,bOn:!0}})}}lockSharing(e){return{seq:this.sendMessageToRwg({evt:4169,body:{lockShare:e}})}}startShareToBreakoutRoom(e){return{seq:this.sendMessageToRwg({evt:16425,body:{id:e,bShareToBO:!0}})}}stopShareToBreakoutRoom(e){return{seq:this.sendMessageToRwg({evt:16425,body:{id:e,bShareToBO:!1}})}}preAssignBreakoutRoom(){return{seq:this.sendMessageToRwg({evt:4213,body:{}})}}claimHost(e){return{seq:this.sendMessageToRwg({evt:4215,body:{hostKey:e}})}}allowMultiplePin(e,t){return{seq:this.sendMessageToRwg({evt:4217,body:{userID:e,bOn:t}})}}spotlightVideo(e,t){return{seq:this.sendMessageToRwg({evt:4219,body:{id:e,...t}})}}connectCamera(e,t){const r={evt:12307,body:{id:e,bOn:t}};return{seq:this.sendMessageToRwg(r)}}followHostLayout(e){return{seq:this.sendMessageToRwg({evt:4223,body:{bFollowHostVideo:e}})}}setVideoDragLayout(e){return{seq:this.sendMessageToRwg({evt:4218,body:{drag_list:e}})}}chatCmdReq(e,t){return{seq:this.sendMessageToRwg({evt:4237,body:{msgID:e,cmd:t}})}}activeAppLinkReq(e){return{seq:this.sendMessageToRwg({evt:4257,body:{appId:e}})}}activeAppInfoReq(){return{seq:this.sendMessageToRwg({evt:4255,body:{}})}}muteShareAudio(e,t){const r={bOn:!0,bShareAudio:!e};return t&&Object.assign(r,{bShareAudioOnly:!0}),{seq:this.sendMessageToRwg({evt:16423,body:r})}}localMuteAudio(e,t){return{seq:this.sendMessageToRwg({evt:8209,body:{id:e,bMute:t}})}}changeSharePronoun(e,t){return{seq:this.sendMessageToRwg({evt:4264,body:{bPronoun:e,strPronoun:t}})}}sendReceivingSharingReady(e){return{seq:this.sendMessageToRwg({evt:16421,body:{ssrc:e}})}}sendManualCaption(e){return{seq:this.sendMessageToRwg({evt:4289,body:{...e}})}}sendPollingAction(e,t,r){return{seq:this.sendMessageToRwg({evt:4224,body:{action:e,PollingId:t,...r}})}}broadcastUserNetworkQuality(e){const t={type:e.isUplink,level:e.level,bwLevel:e.bwLevel};return{seq:this.sendMessageToRwg({evt:4331,body:t})}}sendFarEndCameraControl(e,t,r){return{seq:this.sendMessageToRwg({evt:4329,body:{cmd:e,userID:t,buttonID:r}})}}sendCameraAblity(e){return{seq:this.sendMessageToRwg({evt:4330,body:{...e,focus:!1}})}}sendReaction(e){return{seq:this.sendMessageToRwg({evt:4259,body:{...e}})}}remoteControlConsent(e,t,r,i){let o=arguments.length>4&&arguments[4]!==void 0&&arguments[4],s=arguments.length>5?arguments[5]:void 0;const{deviceId:a,...c}=i,l=s!==void 0?{runAsAdmin:s}:{};return{seq:this.sendMessageToRwg({evt:16427,body:{DeviceID:a,op:e,SendUserID:r,AssignUserID:t,...c,bAutoDelete:o,...l}})}}takeBackRemoteControlPermission(e,t){return{seq:this.sendMessageToRwg({evt:16431,body:{SendUserID:e,ReceiverUserID:t}})}}syncSharedContentMetaWithRcApp(e){const{deviceId:t,...r}=e;return{seq:this.sendMessageToRwg({evt:16429,body:{DeviceID:t,...r}})}}startLiveStream(e,t,r){return{seq:this.sendMessageToRwg({evt:7977,body:{action:1,streamingURL:e,streamingKey:t,broadcastURL:r}})}}stopLiveStream(){return{seq:this.sendMessageToRwg({evt:7977,body:{action:0}})}}sendRemoteControlAuth(e){return{seq:this.sendMessageToRwg({evt:16433,body:{auth:e}})}}chatFileTransfer(e){return{seq:this.sendMessageToRwg({evt:4307,body:{...e,fileType:0,receiverType:0}})}}broadcastVoiceReq(e){return{seq:this.sendMessageToRwg({evt:4314,body:{broadcastVoice:e}})}}}class Gr extends ike{static createAgent(){return this.rwgInstance||(this.rwgInstance=new Gr),this.rwgInstance}}Gr.rwgInstance=null;class b7 extends ike{static getInstance(){return this.instance||(this.instance=new b7),this.instance}}b7.instance=null;const oke=[{name:"audio_simd.min.js",category:"audio",type:"worker",tag:"simd",alias:"audioSIMDWorkletPath"},{name:"audio.simd.wasm",category:"audio",type:"wasm",tag:"simd",alias:"audioSIMDWasm"},{name:"js_audio_process.min.js",category:"audio",type:"worker",tag:"",alias:"audioWorkerPath"},{name:"audio.encode.wasm",category:"audio",type:"wasm",tag:"",alias:"audioWasm"},{name:"js_audio_worklet.min.js",category:"audio",type:"worklet",tag:"",alias:"audioWorkletPath"},{name:"js_audio_worklet_simd.min.js",category:"audio",type:"worklet",tag:"simd",alias:"audioWorkletSIMDPath"},{name:"js_audio_worklet_process.min.js",category:"audio",type:"worklet",tag:"",alias:"audioWorkletProcessPath"},{name:"js_sharing_audio_worklet.min.js",category:"audio",type:"worklet",tag:"",alias:"sharingAudioWorkletPath"},{name:"js_audio_level_worklet_process.min.js",category:"audio",type:"worklet",tag:"",alias:"audioLevelWorkletPath"},{name:"video_mtsimd.min.js",category:"video",type:"worker",tag:"simd,thread",alias:"videoMSIMDWorkerPath"},{name:"video.mtsimd.wasm",category:"video",type:"wasm",tag:"simd,thread,videoShare",alias:"videoMSIMDWasm"},{name:"video_m.min.js",category:"video",type:"worker",tag:"thread",alias:"videoMtWorkerPath"},{name:"video.mt.wasm",category:"video",type:"wasm",tag:"thread",alias:"videoMtWasm"},{name:"video_simd.min.js",category:"video",type:"worker",tag:"simd",alias:"videoSIMDWorkerPath"},{name:"video.simd.wasm",category:"video",type:"wasm",tag:"simd",alias:"videoSIMDWasm"},{name:"video_s.min.js",category:"video",type:"worker",tag:"",alias:"videoWorkerPath"},{name:"video.decode.wasm",category:"video",type:"wasm",tag:"",alias:"videoWasm"},{name:"video_share_mtsimd.min.js",category:"video",type:"worker",tag:"videoShare",alias:"vsmiworkerpath"},{name:"sharing_mtsimd.min.js",category:"sharing",type:"worker",tag:"simd,thread",alias:"sharingMSIMDWorkerPath"},{name:"sharing_m.min.js",category:"sharing",type:"worker",tag:"thread",alias:"sharingMtWorkerPath"},{name:"sharing_simd.min.js",category:"sharing",type:"worker",tag:"simd",alias:"sharingSIMDWorkerPath"},{name:"sharing_s.min.js",category:"sharing",type:"worker",tag:"",alias:"sharingWorkerPath"}],ude="1507",ske=(n,e)=>oke.reduce((t,r)=>{const{name:i,alias:o}=r;return Object.assign(t,{[`${o}`]:`${n}/${e&&ude?`${ude}_`:""}${i}`}),t},{});let Ya=function(n){return n.VideoEncode="0",n.VideoDecode="1",n.AudioEncode="2",n.AudioDecode="3",n.SharingEncode="4",n.SharingDecode="5",n}({});const B_=Gi.WebclientIVState;class zn{static getInstance(){return this.agentInstance===void 0&&(this.agentInstance=new zn),this.agentInstance}constructor(){this.assetsPath=void 0,this.instance=void 0,this.callbackList=void 0,this.mediaWorkersPath=void 0,this.constraints=void 0,this.svcUrl=void 0,this.meetingNumber=void 0,this.confId=void 0,this.mediaSocketAddress=void 0,this.currentUserId=void 0,this.receivedSharingCanvas=void 0,this.sharingCanvas=void 0,this.mediaOptions=void 0,this.inProgress=void 0,this.callbackList=[]}init(e){if(!this.instance&&window.JsMediaSDK_Instance){const t={ivObj:{[fa.AUDIO_ENCODE]:rr.get(B_)&&rr.get(B_)[fa.AUDIO_ENCODE],[fa.VIDEO_ENCODE]:rr.get(B_)&&rr.get(B_)[fa.VIDEO_ENCODE],[fa.SHARING_ENCODE]:rr.get(B_)&&rr.get(B_)[fa.SHARING_ENCODE]},globalTracingLogger:e};this.instance=new window.JsMediaSDK_Instance(t),this.instance.setRWGAgent(Gr.createAgent())}}setAssetsAndConstraint(e,t,r,i){var o;this.assetsPath=e,this.constraints=t,this.mediaWorkersPath=ske(this.assetsPath,!!r),this.onMediaSDKCallback=this.onMediaSDKCallback.bind(this),this.mediaOptions=i,(o=this.instance)===null||o===void 0||o.JsMediaSDK_PreLoad(this.mediaWorkersPath,this.onMediaSDKCallback,i)}onMediaSDKCallback(e,t){this.callbackList.length>0&&this.callbackList.forEach(r=>r(e,t))}registerCallback(e){this.callbackList.push(e)}unregisterCallback(e){this.callbackList=this.callbackList.filter(t=>t!==e)}static isSupportVideoEncodeHardwareAcceleration(){return window.JsMediaSDK_Instance.util.IsSupportVideoEncodeHardwareAcceleration()}static isSupportVideoDecodeHardwareAcceleration(){return window.JsMediaSDK_Instance.util.IsSupportVideoDecodeHardwareAcceleration()}static isCompatibleHardwareForEncode(){var e;return tn.isSupportOffscreenCanvas&&((e=window.JsMediaSDK_Instance)===null||e===void 0?void 0:e.util.AdapterWhiteListCheckForEncoder())==0}static getPTZCapability(){var e,t,r,i,o,s,a,c,l;return{pan:!((e=window.JsMediaSDK_Instance)===null||e===void 0||(t=e.util)===null||t===void 0||(r=t.isSupportCameraPan)===null||r===void 0||!r.call(t)),tilt:!((i=window.JsMediaSDK_Instance)===null||i===void 0||(o=i.util)===null||o===void 0||(s=o.isSupportCameraTilt)===null||s===void 0||!s.call(o)),zoom:!((a=window.JsMediaSDK_Instance)===null||a===void 0||(c=a.util)===null||c===void 0||(l=c.isSupportCameraZoom)===null||l===void 0||!l.call(c))}}static isSupportVideoShare(){var e,t,r;return!((e=window.JsMediaSDK_Instance)===null||e===void 0||(t=e.util)===null||t===void 0||(r=t.isSupportVideoShareReceive)===null||r===void 0||!r.call(t))}static isSupportVideoShareSend(){var e,t,r;return!((e=window.JsMediaSDK_Instance)===null||e===void 0||(t=e.util)===null||t===void 0||(r=t.isSupportVideoShareSend)===null||r===void 0||!r.call(t))}static isSupportSending720P(){var e,t;return!((e=window.JsMediaSDK_Instance)===null||e===void 0||(t=e.util)===null||t===void 0||!t.get720pcapacity())}static isSupportSubscribing1080P(){var e,t;return!((e=window.JsMediaSDK_Instance)===null||e===void 0||(t=e.util)===null||t===void 0||!t.getsub1080pcapacity())}static isSupportOpenMicWhenShareAudio(){var e;return!((e=window.JsMediaSDK_Instance)===null||e===void 0||!e.util.isSupportOpenMicWhenShareAudio())}static isSupportMediaPlaybackAsVideoInput(){var e,t;return!((e=window.JsMediaSDK_Instance)===null||e===void 0||(t=e.util.videoToMediaStreamManager)===null||t===void 0||!t.isSupported())}static isSupportMediaPlaybackAsAudioInput(){var e,t;return!((e=window.JsMediaSDK_Instance)===null||e===void 0||(t=e.util.audioToMediaStreamMananger)===null||t===void 0||!t.isSupported())}static isSupportAudioDenoise(e){var t;return!((t=window.JsMediaSDK_Instance)===null||t===void 0||!t.util.isSupportAudioDenoise(e))}static isSupportAudioBridgeAVSync(){var e;return!((e=window.JsMediaSDK_Instance)===null||e===void 0||!e.util.isSupportAudioBridgeAvsync())}static getAudioFeatureFlag(){var e;return(e=window.JsMediaSDK_Instance)===null||e===void 0?void 0:e.util.getAudioFeatureFlags()}static isSupportShareMultiStream(){var e;return(e=window.JsMediaSDK_Instance)===null||e===void 0?void 0:e.util.isSupportShareMultiStream()}static isSupportVideoLTR(){var e;return(e=window.JsMediaSDK_Instance)===null||e===void 0?void 0:e.util.isSupportVideoLTR()}static isSupportStereoAudio(){var e;return!((e=window.JsMediaSDK_Instance)===null||e===void 0||!e.util.isBrowserSupportStereo())}static isSupportFullHDVideo(){var e;return!((e=window.JsMediaSDK_Instance)===null||e===void 0||!e.util.isSupportSendVideoFullHD())}static isSupportFullHDVideoShare(){var e;return!((e=window.JsMediaSDK_Instance)===null||e===void 0||!e.util.isSupportSendVideoShareFullHD())}static isSupportShare2ndAudioDevice(e){var t;return!((t=window.JsMediaSDK_Instance)===null||t===void 0||!t.util.isSupportShare2ndAudioDevice(e))}connect(e){var t,r,i,o,s,a;let{svcUrl:c,meetingNumber:l,conId:u,e2eEncrypt:d,isViewOnly:h,currentUserId:f,isWebinar:p,enableAudioQos:g,enableVideoQos:m=!1,enableWebtransport:v=!1,webtransportPort:b,rendererType:S,adaptedABOptionForMediaSDK:E}=e;const{isSupportEssentialAudioAndVideoAbility:w,isSupportAudioWorklet:C,isSupportSendScreenSharing:I}=tn;this.svcUrl=c,this.meetingNumber=l,this.confId=u;const T=((K,z,G)=>({videoSocketAddress:`wss://${K}/wc/media/${z}?type=v&cid=${G}`,audioSocketAddress:`wss://${K}/wc/media/${z}?type=a&cid=${G}`,sharingSocketAddress:`wss://${K}/wc/media/${z}?type=${tke()?"j":"s"}&cid=${G}`}))(c,l,u);this.mediaSocketAddress=T,this.currentUserId=f;const D=RC((t=this.mediaOptions)===null||t===void 0?void 0:t.enableMultiDecodeVideoWithoutSAB);var O,M,R,A,k,L,j,N,B,U;(r=this.instance)===null||r===void 0||r.setPropsBeforeInit({callback:this.onMediaSDKCallback,audioWorkerPath:w?(i=this.mediaWorkersPath)===null||i===void 0?void 0:i.audioWorkletPath:void 0,e2eEncrypt:d,isEnableListenInitEvent:!0,enableWebtransport:v,webtransportPort:b,featureOptions:E,rendererType:S}),((o=this.constraints)===null||o===void 0?void 0:o.audio)===!0&&w&&!ra()&&((p||C)&&((O=this.instance)===null||O===void 0||O.initAudioDecode(this.mediaWorkersPath,T.audioSocketAddress,f,mb,u,l,D,g)),!C||p&&h||(M=this.instance)===null||M===void 0||M.initAudioEncode(this.mediaWorkersPath,T.audioSocketAddress,f,mb,u,l,D,g)),((s=this.constraints)===null||s===void 0?void 0:s.video)===!0&&w&&((R=this.instance)===null||R===void 0||R.initVideoDecode(this.mediaWorkersPath,T.videoSocketAddress,f,mb,u,l,D,(A=(k=window.JsMediaSDK_Instance)===null||k===void 0||(L=k.util)===null||L===void 0?void 0:L.isGraphicShouldUseHardwareAccelerationDecode())===null||A===void 0||A,m),p&&h||(j=this.instance)===null||j===void 0||j.initVideoEncode(this.mediaWorkersPath,T.videoSocketAddress,f,mb,u,l,D,!1,m,!0,!0)),((a=this.constraints)===null||a===void 0?void 0:a.screen)===!0&&(w?((N=this.instance)===null||N===void 0||N.initSharingDecode(this.mediaWorkersPath,T.sharingSocketAddress,f,mb,u,l,D),!I||p&&h||(B=this.instance)===null||B===void 0||B.initSharingEncode(this.mediaWorkersPath,T.sharingSocketAddress,f,mb,u,l,D)):(U=this.instance)===null||U===void 0||U.initSharingDecode(T.sharingSocketAddress)),this.inProgress=!0}async destroy(){var e;this.callbackList=[],[Ya.AudioDecode,Ya.AudioEncode,Ya.VideoDecode,Ya.VideoEncode].forEach(r=>{var i;(i=this.instance)===null||i===void 0||i.updateQosSubscription(!1,r)});const t=(e=this.instance)===null||e===void 0?void 0:e.destroy.bind(this.instance);this.instance=null,this.inProgress=!1,await(t==null?void 0:t())}disconnect(){var e,t;(e=this.instance)===null||e===void 0||e.Notify_MeidaSDK(17,{}),(t=this.instance)===null||t===void 0||t.JsMediaSDK_UnInit()}muteAudio(){var e;(e=this.instance)===null||e===void 0||e.Notify_MeidaSDK(8,{ssrc:0})}unmuteAudio(){var e;(e=this.instance)===null||e===void 0||e.Notify_MeidaSDK(7,{ssrc:0,AudioSelectValue:0})}joinComputerAudio(e,t,r,i,o,s,a){var c;const l=a?{...a,enableHID:!0}:{enableHID:!1};return(c=this.instance)===null||c===void 0?void 0:c.Notify_MeidaSDK(22,{CaptureAudio:i,CaptureAudioInfo:{ssrc:e,AudioSelectValue:t==="default"?null:t,...l,audioProfile:o},speakerInfo:{defaultDeviceId:r},...s?{useAudioBridge:!0,audioBridge:s}:{}})}leaveComputerAudio(){var e;return(e=this.instance)===null||e===void 0?void 0:e.Notify_MeidaSDK(21,null)}joinSharingAudio(e){var t;let{ssrc:r,microphoneDeviceId:i,speakerDeviceId:o,isCaptureAudio:s,audioBridge:a}=e;return(t=this.instance)===null||t===void 0?void 0:t.Notify_MeidaSDK(72,{CaptureAudio:s,CaptureAudioInfo:{ssrc:r,AudioSelectValue:i==="default"?null:i},speakerInfo:{defaultDeviceId:o},checkAutoplay:!1,...a?{useAudioBridge:!0,audioBridge:a}:{}})}leaveSharingAudio(e){var t;return(t=this.instance)===null||t===void 0?void 0:t.Notify_MeidaSDK(73,{isPause:e?1:0})}changeSpeaker(e){var t;(t=this.instance)===null||t===void 0||t.Notify_MeidaSDK(11,{ssrc:0,AudioSelectValue:e})}changeMicrophone(e,t,r){var i;(i=this.instance)===null||i===void 0||i.Notify_MeidaSDK(18,{ssrc:0,AudioSelectValue:e==="default"?null:e,microphoneLabel:t??"default",defaultMuted:r})}restoreWebRTC(e){var t;(t=this.instance)===null||t===void 0||t.Notify_MeidaSDK(19,{ssrc:0,AudioSelectValue:e==="default"?null:e})}renderVideo(e,t,r,i,o,s,a,c,l,u,d){var h;const f={userId:t,width:i,height:o,x:s,y:a,quality:c,isMyself:l,canvas:e,enableWaterMark:d,waterMarkText:u,zone:r};e instanceof HTMLVideoElement&&Object.assign(f,{videodom:e}),(h=this.instance)===null||h===void 0||h.Notify_MeidaSDK(1,f)}stopRenderVideo(e,t,r,i){var o;let s=arguments.length>4&&arguments[4]!==void 0&&arguments[4];(o=this.instance)===null||o===void 0||o.Notify_MeidaSDK(2,{canvas:e,userId:t,RGBA:i,doNotClean:s,zone:r})}startCaptureVideo(e,t,r,i,o,s){var a;let c=arguments.length>6&&arguments[6]!==void 0&&arguments[6],l=arguments.length>8?arguments[8]:void 0;const u=arguments.length>7&&arguments[7]?zn.getPTZCapability():void 0;(a=this.instance)===null||a===void 0||a.Notify_MeidaSDK(3,{ssid:e,width:r,height:i,fps:l,video:o,usingFacingMode:s,VideoSelectValue:t==="default"?null:t,disableOriginalRatio:c,...u})}stopCaptureVideo(){var e;(e=this.instance)===null||e===void 0||e.Notify_MeidaSDK(4,{ssrc:0})}changeCamera(e,t,r){var i;(i=this.instance)===null||i===void 0||i.Notify_MeidaSDK(12,{VideoSelectValue:e==="default"?null:e,usingFacingMode:!!t,...r||{}})}switchCanvasForVideoCapture(e){var t;let r=e;typeof e=="string"&&(r=[e]),(t=this.instance)===null||t===void 0||t.Notify_MeidaSDK(25,r)}renderSharing(e,t){var r;let i=arguments.length>2&&arguments[2]!==void 0&&arguments[2],o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"",s=arguments.length>4&&arguments[4]!==void 0&&arguments[4];this.receivedSharingCanvas=t,(r=this.instance)===null||r===void 0||r.Notify_MeidaSDK(23,{width:0,height:0,ssrc:e,canvas:t,enableWaterMark:i,waterMarkText:o,isFromMainSession:s})}stopRenderSharing(){var e;(e=this.instance)===null||e===void 0||e.Notify_MeidaSDK(24,{})}switchSharingSource(e){var t;let r=arguments.length>1&&arguments[1]!==void 0&&arguments[1];(t=this.instance)===null||t===void 0||t.Notify_MeidaSDK(36,{ssrc:e,isFromMainSession:Number(r)})}ajustmentReceivedSharingCanvas(e,t){if(this.receivedSharingCanvas&&e&&t)try{if(tn.isAndroidOrIOSBrowser){const[r,i]=[1280,720],o=Math.max(e/r,t/i,1);this.receivedSharingCanvas.width=Math.floor(e/o),this.receivedSharingCanvas.height=Math.floor(t/o)}else this.receivedSharingCanvas.width=e,this.receivedSharingCanvas.height=t}catch{}}startRemoteControl(e,t,r){var i;(i=this.instance)===null||i===void 0||i.Notify_MeidaSDK(26,{socketURL:`wss://${this.svcUrl}`,meetingID:this.meetingNumber,condID:this.confId,os:t,dom:e,...r})}stopRemoteControl(){var e;(e=this.instance)===null||e===void 0||e.Notify_MeidaSDK(28)}resendRemoteControlPositionPDU(){var e;(e=this.instance)===null||e===void 0||e.Notify_MeidaSDK(41)}updateRemoteControlProperties(e){var t;const{dimension:r,...i}=e;(t=this.instance)===null||t===void 0||t.Notify_MeidaSDK(27,{...r,...i})}startDesktopSharing(e,t,r,i){var o;let s=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4],a=arguments.length>5?arguments[5]:void 0,c=arguments.length>6?arguments[6]:void 0,l=arguments.length>7?arguments[7]:void 0;this.sharingCanvas=t;const u={};i&&Object.assign(u,{share2ndCamera:!0,share2ndCameraParams:{VideoSelectValue:i.cameraId==="default"?null:i.cameraId,width:i.width,height:i.height}}),a!==void 0&&Object.assign(u,{videoParams:{displaySurface:a}}),l!==void 0&&Object.assign(u,{otherParams:{...l}}),(o=this.instance)===null||o===void 0||o.Notify_MeidaSDK(30,{ssid:e,canvas:t,video:r,...u,showShareAudioOption:s,sourceId:c})}stopDesktopSharing(){var e;(e=this.instance)===null||e===void 0||e.Notify_MeidaSDK(31,{})}pauseDesktopSharing(){var e;(e=this.instance)===null||e===void 0||e.Notify_MeidaSDK(32,{})}resumeDesktopSharing(){var e;(e=this.instance)===null||e===void 0||e.Notify_MeidaSDK(33,{})}selectLanguageChannelForNewLTT(e){var t;(t=this.instance)===null||t===void 0||t.Notify_MeidaSDK(57,{lang:e})}changeSharingSecondCamera(e){var t;(t=this.instance)===null||t===void 0||t.Notify_MeidaSDK(49,{VideoSelectValue:e})}ajustmentSharingCanvas(e,t){if(this.sharingCanvas)try{this.sharingCanvas.width=e,this.sharingCanvas.height=t}catch{}}checkChromeSharingExtension(){var e;(e=this.instance)===null||e===void 0||e.Notify_MeidaSDK(34,{})}enableAudioEncode(){var e,t;(e=this.instance)===null||e===void 0||e.initAudioEncode(this.mediaWorkersPath,this.mediaSocketAddress.audioSocketAddress,this.currentUserId,mb,this.confId,this.meetingNumber,RC((t=this.mediaOptions)===null||t===void 0?void 0:t.enableMultiDecodeVideoWithoutSAB))}sendUserNodeList(e,t){var r;(r=this.instance)===null||r===void 0||r.Notify_MeidaSDK(43,{userList:e,encryptKey:t})}updateRenderedSharingDimension(e,t){var r;(r=this.instance)===null||r===void 0||r.Notify_MeidaSDK(44,{width:e,height:t})}pauseOrResumeAudio(e){var t;(t=this.instance)===null||t===void 0||t.Notify_MeidaSDK(45,{bPause:e})}updateRenderedVideoCanvasDimension(e,t,r){var i;(i=this.instance)===null||i===void 0||i.Notify_MeidaSDK(46,{canvas:e,width:t,height:r})}clearVideoCanvas(e,t){var r;(r=this.instance)===null||r===void 0||r.Notify_MeidaSDK(47,{id:e,RGBA:t})}adjustRenderedVideoPosition(e,t,r,i,o,s,a,c){var l;(l=this.instance)===null||l===void 0||l.Notify_MeidaSDK(48,{userId:t,x:i,y:o,width:s,height:a,canvas:e,zone:r,RGBA:c})}mirrorVideo(e){var t;(t=this.instance)===null||t===void 0||t.Notify_MeidaSDK(75,{isMirrorMyVideo:e})}updateUserMediaSN(e){var t,r,i;(t=this.instance)===null||t===void 0||t.Notify_MeidaSDK(80,{isFromMainSession:Number(e.isFromMainSession),mediaActionType:e.iVType,body:{add:(r=e.added)!==null&&r!==void 0?r:[],remove:(i=e.removed)!==null&&i!==void 0?i:[]}})}updateMediaParams(e){var t;const{iVType:r,isFromMainSession:i,updateParams:o}=e;(t=this.instance)===null||t===void 0||t.Notify_MeidaSDK(81,{mediaActionType:r,isFromMainSession:Number(i),updateParams:o})}createMainSessionChannel(e,t){var r,i;e==="sharing"?(r=this.instance)===null||r===void 0||r.Notify_MeidaSDK(84,t):(i=this.instance)===null||i===void 0||i.Notify_MeidaSDK(85,t)}addReceivedSharingChannelType(e){var t;const{isFromMainSession:r,...i}=e;(t=this.instance)===null||t===void 0||t.Notify_MeidaSDK(82,{isFromMainSession:Number(r),...i})}removeReceivedSharingChannelType(e){var t;(t=this.instance)===null||t===void 0||t.Notify_MeidaSDK(83,{isFromMainSession:Number(e.isFromMainSession),ssrc:e.ssrc})}enableHardwareAccelerationForVideoDecode(e){var t;(t=this.instance)===null||t===void 0||t.Notify_MeidaSDK(70,{enable:e})}enableHardwareAccelerationForVideoEncode(e){var t;(t=this.instance)===null||t===void 0||t.Notify_MeidaSDK(71,{enable:e})}setSharingAudioVolume(e,t,r){var i;(i=this.instance)===null||i===void 0||i.Notify_MeidaSDK(74,{userid:e>>10,shareVolume:t?0:100,isFromMainSession:r})}subscribeToQos(e,t){e.forEach(r=>{var i;(i=this.instance)===null||i===void 0||i.updateQosSubscription(!0,r,t)})}unsubscribeFromQos(e){e.forEach(t=>{var r;(r=this.instance)===null||r===void 0||r.updateQosSubscription(!1,t)})}passThroughRWGMessage(e){var t;(t=this.instance)===null||t===void 0||t.Notify_MeidaSDK(40,e)}startVirtualBackgroundSetting(e,t,r,i,o,s){var a;let c=arguments.length>6&&arguments[6]!==void 0&&arguments[6];(a=this.instance)===null||a===void 0||a.Notify_MeidaSDK(91,{canvas:e,bgdom:t,width:o,height:s,ssid:r,VideoSelectValue:i==="default"?null:i,disableOriginalRatio:c})}updateVirtualBackgroundImage(e){var t;(t=this.instance)===null||t===void 0||t.Notify_MeidaSDK(92,{bgdom:e})}stopVirtualBackgroundSetting(){var e;let t=arguments.length>0&&arguments[0]!==void 0&&arguments[0];(e=this.instance)===null||e===void 0||e.Notify_MeidaSDK(93,{isSwitch:t})}startMaskSetting(e,t,r,i,o,s,a,c,l){var u;(u=this.instance)===null||u===void 0||u.Notify_MeidaSDK(62,{canvas:e,maskdom:r,bgdom:t,dx:0,dy:0,dWidth:s,dHeight:a,width:c,height:l,ssid:i,VideoSelectValue:o==="default"?null:o})}updateMaskBackgroundImage(e){var t;(t=this.instance)===null||t===void 0||t.Notify_MeidaSDK(63,{bgdom:e})}updateMaskClip(e,t,r){var i;(i=this.instance)===null||i===void 0||i.Notify_MeidaSDK(64,{maskdom:e,dx:0,dy:0,dWidth:t,dHeight:r})}stopMaskSetting(){var e;let t=arguments.length>0&&arguments[0]!==void 0&&arguments[0];(e=this.instance)===null||e===void 0||e.Notify_MeidaSDK(65,{isSwitch:t})}enableVideoObserver(e){var t;let r=arguments.length>1&&arguments[1]!==void 0&&arguments[1];(t=this.instance)===null||t===void 0||t.Notify_MeidaSDK(99,{enable:e,fpsdisbale:r})}enableShareAudioToBreakoutRoom(e){var t;(t=this.instance)===null||t===void 0||t.Notify_MeidaSDK(86,{enable:e})}sendUserAudioStatus(e){var t;(t=this.instance)===null||t===void 0||t.Notify_MeidaSDK(51,e)}muteOrUnmuteOtherAudio(e,t){var r;(r=this.instance)===null||r===void 0||r.Notify_MeidaSDK(50,{userId:e,volume:t?0:100})}adjustOtherAudioVolume(e,t){var r;(r=this.instance)===null||r===void 0||r.Notify_MeidaSDK(50,{userId:e,volume:t})}notifySDKMeetingReady(){var e;(e=this.instance)===null||e===void 0||e.Notify_MeidaSDK(113)}movePTZCamera(e){var t,r;return(t=window.JsMediaSDK_Instance)===null||t===void 0||(r=t.util)===null||r===void 0?void 0:r.queryPTZPermisson().then(i=>{var o;return i?((o=this.instance)===null||o===void 0||o.Notify_MeidaSDK(53,e),Promise.resolve("")):Promise.reject("Cannot move camera without permission granted")})}switchSharingMode(e){var t;(t=this.instance)===null||t===void 0||t.Notify_MeidaSDK(101,{mode:e})}updateVideoHDValue(e){var t;(t=this.instance)===null||t===void 0||t.Notify_MeidaSDK("update_videohd_value",{videohd:e})}updateVideoFullhdValue(e){var t;(t=this.instance)===null||t===void 0||t.Notify_MeidaSDK("update_videofullhd_value",{videofullhd:e})}changeAudioProfile(e){var t;(t=this.instance)===null||t===void 0||t.Notify_MeidaSDK(126,e)}enableSyncButtonsOnHeadset(e,t,r){var i;(i=this.instance)===null||i===void 0||i.Notify_MeidaSDK(100,{enable:e,microphoneLabel:t,defaultMuted:r})}stopAllIncomingAudio(e){var t;(t=this.instance)===null||t===void 0||t.Notify_MeidaSDK(123,e)}isSharingEntireScreen(){var e,t;const r=(e=this.instance)===null||e===void 0||(t=e.getShareStreamInfo)===null||t===void 0?void 0:t.call(e);if(r){const{displaySurface:i}=r;return!i||i==="monitor"}return!1}getShareStreamInfo(){var e,t;const r=(e=this.instance)===null||e===void 0||(t=e.getShareStreamInfo)===null||t===void 0?void 0:t.call(e);if(r){const{deviceId:i,width:o,height:s}=r;return{deviceId:i,width:o,height:s}}return{}}preInitAudioBridge(e){var t;(t=this.instance)===null||t===void 0||t.previewInit({audioBridge:{...e}})}prefetchVideoSsrc(e){var t;(t=this.instance)===null||t===void 0||t.Notify_MeidaSDK(110,{ssrc:e})}cancelPrefetchVideoSsrc(e){var t;(t=this.instance)===null||t===void 0||t.Notify_MeidaSDK(112,{ssrc:e,haddata:!1})}setMobileRotateMode(e){var t;(t=this.instance)===null||t===void 0||t.Notify_MeidaSDK(124,{isLandScape:e})}changeActiveVideoSsrc(e){var t;(t=this.instance)===null||t===void 0||t.Notify_MeidaSDK(13,{ssrc:e})}setAudioCodecMode(e){var t;(t=this.instance)===null||t===void 0||t.Notify_MeidaSDK(122,{mode:e})}startRemoteControlQRCheck(e){var t;(t=this.instance)===null||t===void 0||t.Notify_MeidaSDK(54,{enable:e})}broadcastVoiceToBreakoutRoom(e){var t;(t=this.instance)===null||t===void 0||t.Notify_MeidaSDK(87,{enable:e})}share2ndAudio(e,t){var r;const i={audioOnly:!0,deviceId:e==="default"?null:e};t&&Object.assign(i,t),(r=this.instance)===null||r===void 0||r.Notify_MeidaSDK(129,i)}}zn.agentInstance=void 0;const nD="ADD_CURRENT_USER_PARTICIPANT_ATTRIBUTE",ql="UPDATE_CURRENT_USER_PARTICIPANT_ATTRIBUTE",_te="ADD_USER_PARTICIPANT_ATTRIBUTE",dg="UPDATE_USER_PARTICIPANT_ATTRIBUTE",wte="REMOVE_USER_PARTICIPANT_ATTRIBUTE",f0="UPDATE_WEBINAR_PARTICIPANT_ATTRIBUTE",ake="REMOVE_WEBINAR_ATTENDEE_ATTRIBUTE",cke="JOIN_MEETING_SUCCESS",cs="JOIN_MEETING_FAILED",Yl="RECONNECTING_MEETING",Ub="LEAVING_MEETING",Cte="MEETING_IN_WAITING_ROOM",xte="UPDATE_MEETING_ATTRIBUTE",lke="SHARE_PRONOUN_TYPE_UPDATE";var hf=function(n){return n.ConnectionChange="connection-change",n.OnHoldChange="on-hold-change",n.UserAdd="user-added",n.UserUpdate="user-updated",n.UserRemove="user-removed",n.AttendeeUpdate="attendee-updated",n.MeetingAttributeUpdate="meeting-attribute-updated",n.PromoteAttendeeConsent="promote-attendee-consent",n.ActiveAppsUpdate="active-apps-updated",n.SharePronounTypeUpdate="share-pronoun-type-update",n}(hf||{});const Cat={JoinMeeting:{success:nD,fail:[cs]}},xat={[hf.ConnectionChange]:[{event:cke,payload:()=>({state:Lm.Connected})},{event:cs,payload:n=>({state:Lm.Fail,...n})},{event:Yl,payload:n=>({state:Lm.Reconnecting,...n})},{event:Ub,payload:n=>({state:Lm.Closed,...n})}],[hf.OnHoldChange]:[{event:Cte,payload:n=>({isOnHold:n})}],[hf.UserAdd]:[{event:nD,payload:n=>[n]},{event:_te,payload:n=>n}],[hf.UserUpdate]:[{event:ql,payload:n=>[n]},{event:dg,payload:n=>n}],[hf.UserRemove]:[{event:wte,payload:n=>n}],[hf.AttendeeUpdate]:[{event:f0,payload:n=>n},{event:ake,payload:n=>n}],[hf.MeetingAttributeUpdate]:[{event:xte,payload:n=>"bNoHostTimeOut"in n?{isHostLost:n.bNoHostTimeOut}:null}],[hf.PromoteAttendeeConsent]:[{event:"MEETING_WEBINAR_PROMOTE_CONSENT_REQ",payload:n=>{let{req_id:e,sender_id:t}=n;return{reqId:e,senderId:t}}}],[hf.ActiveAppsUpdate]:[{event:"ACTIVE_APPS_UPDATE",payload:()=>{}}],[hf.SharePronounTypeUpdate]:[{event:lke,payload:n=>n}]},VP="LIVE_TRANSCRIPTION_RECEIVE_MESSAGE",Tf="LIVE_TRANSCRIPTION_CAPTION_STATUS_CHANGE_RESPONSE",uke="LIVE_TRANSCRIPTION_STATUS_CHANGE",r6="LIVE_TRANSCRIPTION_HOST_DISABLE_CHANGE",Eat={"caption-message":[{event:VP,payload:n=>n}],"caption-status":[{event:Tf,payload:n=>n}],"caption-enable":[{event:uke,payload:n=>n}],"caption-host-disable":[{event:r6,payload:n=>n}]},iS="CHAT_RECEIVE_MESSAGE_EVENTS",AC="CHAT_PRIVILEGE_CHANGE",dke="CHAT_MESSAGE_RESPONSE",i6="CHAT_DELETE_MESSAGE_REPONSE",kS="CHAT_FILE_CHAT_UPLOAD_PROGRESS",P4="CHAT_FILE_CHAT_DOWNLOAD_PROGRESS";let GE=function(n){return n.ChatOnMessage="chat-on-message",n.ChatPrivilegeChange="chat-privilege-change",n.ChatDeleteMessage="chat-delete-message",n.ChatFileUploadProgress="chat-file-upload-progress",n.ChatFileDownloadProgress="chat-file-download-progress",n}({});const Iat={[GE.ChatOnMessage]:[{event:iS,payload:n=>n}],[GE.ChatPrivilegeChange]:[{event:AC,payload:n=>n}],[GE.ChatDeleteMessage]:[{event:i6,payload:n=>n}],[GE.ChatFileUploadProgress]:[{event:kS,payload:n=>n}],[GE.ChatFileDownloadProgress]:[{event:P4,payload:n=>n}]},hke="COMMAND_RECEIVE_MESSAGE_EVENTS",Ete="COMMAND_STATUS_EVENTS";let dde=function(n){return n.CommandChannelStatus="command-channel-status",n.CommandChannelMessage="command-channel-message",n}({});const Pat={[dde.CommandChannelStatus]:[{event:Ete,payload:n=>n}],[dde.CommandChannelMessage]:[{event:hke,payload:n=>n}]};let Df=function(n){return n.Recording="Recording",n.Paused="Paused",n.Stopped="Stopped",n.Ask="Ask",n.Accept="Accept",n.Decline="Decline",n}({}),da=function(n){return n[n.None=0]="None",n[n.Init=1]="Init",n[n.Start=2]="Start",n[n.Pause=3]="Pause",n[n.Stop=4]="Stop",n}({}),Gk=function(n){return n[n.Stop=0]="Stop",n[n.Start=1]="Start",n[n.Pause=2]="Pause",n}({}),Vl=function(n){return n[n.None=0]="None",n[n.Deny=1]="Deny",n[n.Allow=2]="Allow",n}({}),kat=function(n){return n[n.None=0]="None",n[n.DenyAllRequest=1]="DenyAllRequest",n[n.AllowAllRequest=2]="AllowAllRequest",n}({});const WP="CLOUD_RECORDING_STATUS_CHANGE",o6="CLOUD_RECORDING_ISO_STATUS_CHANGE",s6="LOCAL_RECORDING_CHANGE",Ap="LOCAL_RECORDING_PERMISSION_CHANGE",fke="RECORDING_FOR_IQ_STATUS_CHANGE",pke="RECORDING_FOR_IQ_OPERATION_CHANGE";let vb=function(n){return n.RecordingChange="recording-change",n.IndividualRecordingChange="individual-recording-change",n.LocalRecordingChange="local-recording-change",n.LocalRecordingPermissionChange="local-recording-permission-change",n.MediaCaptureStatusChange="media-capture-status-change",n.MediaCapturePermissionChange="media-capture-permission-change",n.RecordingIqChange="recording-iq-change",n}({});const Tat={[vb.RecordingChange]:[{event:WP,payload:n=>{const{cmrServerStatus:e}=n;return e===da.Start?Df.Recording:e===da.Pause?Df.Paused:Df.Stopped}}],[vb.IndividualRecordingChange]:[{event:o6,payload:n=>n}],[vb.LocalRecordingChange]:[{event:s6,payload:n=>n}],[vb.LocalRecordingPermissionChange]:[{event:Ap,payload:n=>n}],[vb.MediaCaptureStatusChange]:[{event:s6,payload:n=>n}],[vb.MediaCapturePermissionChange]:[{event:Ap,payload:n=>n}],[vb.RecordingIqChange]:[{event:fke,payload:n=>n}]};let bt=function(n){return n[n.InitSuccess=1]="InitSuccess",n[n.InitSuccessVideo=1.1]="InitSuccessVideo",n[n.InitSuccessAudio=1.2]="InitSuccessAudio",n[n.InitSuccessSharing=1.3]="InitSuccessSharing",n[n.UserGrantCaptureAudio=2]="UserGrantCaptureAudio",n[n.CurrentVideoResolution=3]="CurrentVideoResolution",n[n.JpegDecThreadOk=4]="JpegDecThreadOk",n[n.JpegData=5]="JpegData",n[n.SharingPara=6]="SharingPara",n[n.VideoDecodeMaxSize=7]="VideoDecodeMaxSize",n[n.CurrentCaptureVideoWidthHeight=8]="CurrentCaptureVideoWidthHeight",n[n.StartVideoCaptureSuccess=9]="StartVideoCaptureSuccess",n[n.StopVideoCaptureSuccess=10]="StopVideoCaptureSuccess",n[n.StartRemoteControlSuccess=11]="StartRemoteControlSuccess",n[n.CancelRemoteControlSuccess=12]="CancelRemoteControlSuccess",n[n.RemoteControlCopiedTextNotify=13]="RemoteControlCopiedTextNotify",n[n.MonitorLog=14]="MonitorLog",n[n.CurrentDesktopSharingWidthHeight=15]="CurrentDesktopSharingWidthHeight",n[n.DesktopSharingCaptureSuccess=16]="DesktopSharingCaptureSuccess",n[n.CheckChromeSharingExtensionResponse=17]="CheckChromeSharingExtensionResponse",n[n.SharingDecodeMaxSize=18]="SharingDecodeMaxSize",n[n.DataChannelOffer=19]="DataChannelOffer",n[n.AesGcmIvResponse=21]="AesGcmIvResponse",n[n.SharingDesktopStreamHaveAudio=23]="SharingDesktopStreamHaveAudio",n[n.JoinComputerAudioComplete=24]="JoinComputerAudioComplete",n[n.JoinSharingAudioComplete=25]="JoinSharingAudioComplete",n[n.LeaveComputerAudioComplete=26]="LeaveComputerAudioComplete",n[n.LeaveSharingAudioComplete=27]="LeaveSharingAudioComplete",n[n.HidStatusMute=28]="HidStatusMute",n[n.AudioStreamFailed=31]="AudioStreamFailed",n[n.VideoStreamFailed=32]="VideoStreamFailed",n[n.AudioSpeakerSetSuccess=33]="AudioSpeakerSetSuccess",n[n.AudiobridgeSetCcLangSuccess=36]="AudiobridgeSetCcLangSuccess",n[n.AudioLevelIndicator=38]="AudioLevelIndicator",n[n.SyncRendererTypeResponse=39]="SyncRendererTypeResponse",n[n.SendRemoteControlQrCode=55]="SendRemoteControlQrCode",n[n.StartVideoStreamInMaskSettingSuccess=66]="StartVideoStreamInMaskSettingSuccess",n[n.CurrentDecodeVideoQuality=66.5]="CurrentDecodeVideoQuality",n[n.CurrentDecodeVideoFps=66.6]="CurrentDecodeVideoFps",n[n.SharingFirstDecodeFrameReceivedSsrc=70]="SharingFirstDecodeFrameReceivedSsrc",n[n.StartVideoStreamInVbSettingSuccess=94]="StartVideoStreamInVbSettingSuccess",n[n.VbModelPreloading_3S=96]="VbModelPreloading_3S",n[n.VbModelPreloading_10S=97]="VbModelPreloading_10S",n[n.VbModelPreloadingOk=98]="VbModelPreloadingOk",n[n.NewActiveSpeakerFirstFrameCallback=111]="NewActiveSpeakerFirstFrameCallback",n[n.AudioBridgeFirstRecvData=114]="AudioBridgeFirstRecvData",n[n.AudioBridgeCanSendData=115]="AudioBridgeCanSendData",n[n.InitFailed=-1]="InitFailed",n[n.InitFailedVideo=-1.1]="InitFailedVideo",n[n.InitFailedAudio=-1.2]="InitFailedAudio",n[n.InitFailedSharing=-1.3]="InitFailedSharing",n[n.UserForbiddedCaptureAudio=-2]="UserForbiddedCaptureAudio",n[n.AudioWebsocketBroken=-3]="AudioWebsocketBroken",n[n.VideoWebsocketBroken=-4]="VideoWebsocketBroken",n[n.SharingDecThreadFailed=-5]="SharingDecThreadFailed",n[n.AudioZeroData=-6]="AudioZeroData",n[n.AudioCtxSamplerate=-7]="AudioCtxSamplerate",n[n.UserForbiddedCaptureVideo=-8]="UserForbiddedCaptureVideo",n[n.UserCameraIsTakenByOtherPrograms=-9]="UserCameraIsTakenByOtherPrograms",n[n.StopVideoCaptureFailed=-10]="StopVideoCaptureFailed",n[n.StartRemoteControlFailed=-11]="StartRemoteControlFailed",n[n.CancelRemoteControlFailed=-12]="CancelRemoteControlFailed",n[n.RemoteControlPasteTextLengthOverflow=-14]="RemoteControlPasteTextLengthOverflow",n[n.UserStopDesktopSharing=-15]="UserStopDesktopSharing",n[n.UserCancelPermissionRequest=-16]="UserCancelPermissionRequest",n[n.DesktopSharingChromeExtensionUninstalled=-17]="DesktopSharingChromeExtensionUninstalled",n[n.DesktopSharingPermissionDenied=-18]="DesktopSharingPermissionDenied",n[n.DesktopSharingTimeOut=-19]="DesktopSharingTimeOut",n[n.DesktopSharingError=-20]="DesktopSharingError",n[n.AudioSpeakerSetError=-21]="AudioSpeakerSetError",n[n.DesktopSharingSystemError=-22]="DesktopSharingSystemError",n[n.SharingDesktopStreamHaveNoAudio=-27]="SharingDesktopStreamHaveNoAudio",n.AudioQosData="AUDIO_QOS_DATA",n.VideoQosData="VIDEO_QOS_DATA",n.ShareQosData="VIDEOSHARE_QOS_DATA",n.NetworkQualityChange="NETWORK_QUALITY_CHANGE",n[n.AudioBridgeReconnectStart=-29]="AudioBridgeReconnectStart",n[n.AudioBridgeReconnectEnd=-31]="AudioBridgeReconnectEnd",n[n.WebglLostInMultiView=-32]="WebglLostInMultiView",n[n.MaskSettingParaError=-33]="MaskSettingParaError",n[n.VbSettingParaError=-34]="VbSettingParaError",n[n.NotifyUIFailover=-35]="NotifyUIFailover",n[n.RecoverWebrtcAudio=-36]="RecoverWebrtcAudio",n[n.AudiobridgeSetCcLangFailure=-39]="AudiobridgeSetCcLangFailure",n[n.SharingHealthCheckFailed=-129]="SharingHealthCheckFailed",n[n.VideoHealthCheckFailed=-130]="VideoHealthCheckFailed",n[n.AudioHealthCheckFailed=-131]="AudioHealthCheckFailed",n}({}),Ul=function(n){return n[n.EncodeSuccess=1]="EncodeSuccess",n[n.DecodeSuccess=2]="DecodeSuccess",n[n.EncodeFailed=-1]="EncodeFailed",n[n.DecodeFailed=-2]="DecodeFailed",n}({}),eB=function(n){return n.Spotlight="Spotlight",n.Unmute="Unmute",n.AllowToTalk="Allow to talk",n}({}),Sf=function(n){return n.Inherited="inherited",n.Active="active",n.PassiveByMuteOne="passive(mute one)",n.PassiveByMuteAll="passive(mute all)",n.SharingAudio="sharing audio",n}({}),qP=function(n){return n.Inherited="inherited",n.Active="active",n.Passive="passive",n.SharingAudio="sharing audio",n}({}),Zk=function(n){return n.Active="active",n.Failover="failover",n.EndedBySystem="audio stream is ended by system",n.Pstn="pstn",n.MicrophoneError="microphone error",n}({}),km=function(n){return n.Join="join",n.Leave="leave",n.Muted="muted",n.Unmuted="unmuted",n}({}),Ss=function(n){return n[n.Calling=1]="Calling",n[n.Ringing=2]="Ringing",n[n.Accepted=3]="Accepted",n[n.Busy=4]="Busy",n[n.NotAvailable=5]="NotAvailable",n[n.HangUp=6]="HangUp",n[n.Fail=7]="Fail",n[n.Success=8]="Success",n[n.Timeout=9]="Timeout",n[n.Canceling=10]="Canceling",n[n.Canceled=11]="Canceled",n[n.CancelFailed=12]="CancelFailed",n}({});const Dat=(()=>{const n=new ArrayBuffer(684),e=new Uint32Array(n);return e.set([1179011410,676,1163280727,544501094,16,65539,16e3,64e3,2097156,1635017060,640],0),new Blob([e],{type:"audio/wav"})})(),Rat=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]),Aat=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);let Cd=function(n){return n[n.HostGrab=0]="HostGrab",n[n.OnlyHost=1]="OnlyHost",n[n.AnyoneGrab=2]="AnyoneGrab",n[n.MultipleShare=3]="MultipleShare",n}({}),Hr=function(n){return n.Sharing="sharing",n.Paused="paused",n.End="ended",n}({}),Ph=function(n){return n[n.Video_90P=0]="Video_90P",n[n.Video_180P=1]="Video_180P",n[n.Video_360P=2]="Video_360P",n[n.Video_720P=3]="Video_720P",n[n.Video_1080P=4]="Video_1080P",n}({}),hde=function(n){return n.Active="Active",n.Inactive="Inactive",n}({}),s5=function(n){return n.Muted="Muted",n.Unmuted="Unmuted",n}({}),k4=function(n){return n.Started="Started",n.Stopped="Stopped",n.Failed="Failed",n}({}),fde=function(n){return n.Approved="Approved",n.Rejected="Rejected",n}({}),tB=function(n){return n.PrivilegeChange="PrivilegeChange",n.StopScreenCapture="StopScreenCapture",n.ShareFromMainSession="ShareFromMainSession",n}({}),gke=function(n){return n[n.ImageNotMatch=2]="ImageNotMatch",n[n.CanvasNotMatch=3]="CanvasNotMatch",n[n.VBModelNotMatch=4]="VBModelNotMatch",n}({});const F2="blur";let Kw=function(n){return n.User="user",n.Environment="environment",n.Left="left",n.Right="right",n}({});const S7=Object.values(Kw),l0=1e3,pde="__ZOOM_SDK_SHARING_VIDEO__",zb="__ZOOM_SDK_VIDEO_ZONE__",Oat="__ZOOM_SDK_VIRTUAL_BACKGROUND_CANVAS_@__",Mat="__ZOOM_SDK_VIRTUAL_BACKGROUND_IMAGE_@__",$at="__ZOOM_SDK_MASK_CLIP_@__",nB="__ZOOM_SDK_MEDIA_PLAYBACK_SOURCE_VIDEO__",KP="__ZOOM_SDK_DYMMY_VIDEO_PLAYER_CANVAS_ID__",rB="__ZOOM_SDK_DUMMY_HIDDEN_SELF_VIEW_VIDEO_ID__",a6={data:{sample_rate:0,rtt:0,jitter:0,avg_loss:0,max_loss:0,rate:0,bandwidth:0}},$0={data:{sample_rate:0,rtt:0,jitter:0,avg_loss:0,max_loss:0,width:0,height:0,fps:0,rate:0,bandwidth:0}};let ul=function(n){return n[n.Request=11]="Request",n[n.Decline=12]="Decline",n[n.Approve=13]="Approve",n[n.GiveUp=14]="GiveUp",n[n.StartControl=15]="StartControl",n[n.ContinueControl=16]="ContinueControl",n[n.StopControl=17]="StopControl",n[n.SwitchCamera=20]="SwitchCamera",n}({}),u0=function(n){return n[n.Bk=0]="Bk",n[n.Center=1]="Center",n[n.ZoomIn=2]="ZoomIn",n[n.ZoomOut=3]="ZoomOut",n[n.Left=4]="Left",n[n.Right=5]="Right",n[n.Up=6]="Up",n[n.Down=7]="Down",n[n.SwitchCamera=8]="SwitchCamera",n}({}),H_=function(n){return n[n.Pan=192]="Pan",n[n.Tilt=48]="Tilt",n[n.Zoom=12]="Zoom",n[n.Focus=3]="Focus",n}({});(function(n){return n[n.ZoomIn=2]="ZoomIn",n[n.ZoomOut=3]="ZoomOut",n[n.Left=4]="Left",n[n.Right=5]="Right",n[n.Up=6]="Up",n[n.Down=7]="Down",n[n.SwitchCamera=8]="SwitchCamera",n})({});(function(n){return n[n.None=0]="None",n[n.ApproveAnother=3]="ApproveAnother",n[n.Stop=5]="Stop",n})({});let GP=function(n){return n[n.Null=0]="Null",n[n.Normal=1]="Normal",n[n.VideoMode=2]="VideoMode",n}({}),Yf=function(n){return n[n.Null=0]="Null",n[n.VirtualBackground=1]="VirtualBackground",n[n.Mask=2]="Mask",n}({}),ci=function(n){return n.Computer="computer",n.Phone="phone",n}({}),c6=function(n){return n[n.Decline=0]="Decline",n[n.Approve=1]="Approve",n[n.CacheClean=2]="CacheClean",n}({}),Qa=function(n){return n.Unknown="unknown",n.Uninstalled="uninstalled",n.Installed="installed",n}({}),l6=function(n){return n.Unlaunched="unlaunched",n.Launched="launched",n}({}),iB=function(n){return n.Started="started",n.Ended="ended",n}({}),oB=function(n){return n[n.Max=30]="Max",n[n.Min=10]="Min",n[n.Default=24]="Default",n}({}),aP=function(n){return n[n.Loading=1]="Loading",n[n.Done=2]="Done",n}({}),gde=function(n){return n.Browser="Browser",n.Zoom="Zoom",n}({}),mde=function(n){return n.Denoise="backgroundNoiseSuppression",n.OriginalSound="originalSound",n}({}),Iq=function(n){return n[n.Undefined=0]="Undefined",n[n.WebGL=1]="WebGL",n[n.WebGPU=2]="WebGPU",n[n.WebGL2=3]="WebGL2",n}({});(function(n){return n[n.H323=1]="H323",n[n.SIP=2]="SIP",n})({});let Np=function(n){return n[n.Success=0]="Success",n[n.Ringing=1]="Ringing",n[n.Timeout=2]="Timeout",n[n.Busy=101]="Busy",n[n.Fail=104]="Fail",n}({});const mke="RECEIVE_VIDEO_ACTIVE_INDICATION",vke="RECEIVE_VIDEO_MUTE_INDICATION",yke="ASK_FOR_START_VIDEO_CONSENT",Pq="RECEIVE_VIDEO_DIMENSION_CHANGE",bke="CAPTURED_VIDEO_DIMENSION_CHANGE",kq="CAN_NOT_DETECT_CAMERA",Tq="CAN_NOT_FIND_CAMERA",Dq="VIDEO_USER_FORBIDDEN_CAPTURE",Rq="VIDEO_CAMERA_IS_TAKEN",Ske="VIDEO_BACKGROUND_FAILED",_ke="VIDEO_ESTABLISH_STREAM_ERROR",Ite="VIDEO_CAPTURE_START_SUCCESS",oS="VIDEO_CAPTURE_STOP_RESULT",Aq="VIDEO_SPOTLIGHT_CHANGE",wke="VIDEO_FOLLOW_HOST_ORDER_CHANGE",Cke="VIDEO_HOST_DRAG_LAYOUT_CHANGE",xke="VIDEO_NEW_USER_START",T4="VIDEO_OLD_USER_STOP",u6="VIDEO_VIRTUAL_BACKGROUND_PRELOAD_READY",Oq="VIDEO_VIRTUAL_BACKGROUND_SETTING_SUCCESS",Mq="VIDEO_STATISTIC_DATA",$q="VIDEO_CELL_DETAILED_DATA",Lq="VIDEO_NETWORK_QUALITY_CHANGE",Eke="VIDEO_FAR_END_CAMERA_CONTROL_REQUEST",Nq="VIDEO_FAR_END_CAMERA_CONTROL_RESPONSE",d6="VIDEO_FAR_END_CAMERA_IN_CONTROL_CHANGE",Ike="VIDEO_FAR_END_CAMERA_CAPABILITY_CHANGE",Fq="VIDEO_MASK_SETTING_SUCCESS",Pke="VIDEO_CAPTURE_SDK_SUCCESS",kke="VIDEO_PREFETCH_VIDEO_FRAME_CALLBACK",Tke="VIDEO_CURRENT_USER_SSRC",Dke="VIDEO_RENDER_ASPECT_RATIO_CHANGE",vde={startCaptureVideo:{success:Ite,fail:[kq,Tq,Dq,_ke,Rq,Ske]},switchCameraVideo:{success:Pke,fail:[kq,Tq,Dq,Rq]},stopCaptureVideo:{success:oS}};let Ka=function(n){return n.VideoActiveChange="video-active-change",n.PeerVideoStateChange="peer-video-state-change",n.VideoSpotlightChange="video-spotlight-change",n.VideoMutedChange="video-muted-change",n.VideoCapturingChange="video-capturing-change",n.AskForStartVideoConsent="ask-for-start-video-consent",n.VideoDimensionChange="video-dimension-change",n.VideoFollowHostOrder="video-follow-host-order-change",n.VideoHostLayoutChange="video-host-layout-change",n.VideoVBPreloadChange="video-virtual-background-preload-change",n.VideoStatisticDataChange="video-statistic-data-change",n.VideoDetailedDataChange="video-detailed-data-change",n.VideoAspectRatioChange="video-aspect-ratio-change",n.NetworkQualityChange="network-quality-change",n.FarEndCameraRequestControl="far-end-camera-request-control",n.FarEndCameraResponseControl="far-end-camera-response-control",n.FarEndCameraInControlChange="far-end-camera-in-control-change",n.FarEndCameraCapabilityChange="far-end-camera-capability-change",n}({});const Lat={[Ka.VideoActiveChange]:[{event:mke,payload:n=>({state:n.bVideoOn?hde.Active:hde.Inactive,userId:n.userId})}],[Ka.VideoCapturingChange]:[{event:Ite,payload:()=>({state:k4.Started})},{event:oS,payload:n=>({state:n!=null&&n.failed?k4.Failed:k4.Stopped})}],[Ka.VideoMutedChange]:[{event:vke,payload:n=>({state:n.isVideoMuted?s5.Muted:s5.Unmuted,userId:n.id})}],[Ka.AskForStartVideoConsent]:[{event:yke,payload:n=>({state:n.isVideoMuted?s5.Muted:s5.Unmuted,userId:n.id})}],[Ka.VideoSpotlightChange]:[{event:Aq,payload:n=>({spotlightList:n.spotlightList&&n.spotlightList.map(e=>({userId:e}))})}],[Ka.VideoDimensionChange]:[{event:Pq,payload:n=>({type:"received",width:n.width,height:n.height})},{event:bke,payload:n=>({type:"captured",width:n.width,height:n.height})}],[Ka.VideoFollowHostOrder]:[{event:wke,payload:n=>({isFollowHostOrder:n.bOn})}],[Ka.VideoHostLayoutChange]:[{event:Cke,payload:n=>Array.isArray(n.layout)?n.layout.map(e=>({userId:e})):[]}],[Ka.PeerVideoStateChange]:[{event:xke,payload:n=>({action:"Start",...n})},{event:T4,payload:n=>({action:"Stop",...n})}],[Ka.VideoVBPreloadChange]:[{event:u6,payload:n=>({isReady:n})}],[Ka.VideoStatisticDataChange]:[{event:Mq,payload:n=>{const{data:{rate:e,...t},...r}=n??{data:{}};return{data:{bitrate:e,...t},...r}}}],[Ka.VideoDetailedDataChange]:[{event:$q,payload:n=>n}],[Ka.VideoAspectRatioChange]:[{event:Dke,payload:n=>n}],[Ka.NetworkQualityChange]:[{event:Lq,payload:n=>n}],[Ka.FarEndCameraRequestControl]:[{event:Eke,payload:n=>n}],[Ka.FarEndCameraResponseControl]:[{event:Nq,payload:n=>n}],[Ka.FarEndCameraInControlChange]:[{event:d6,payload:n=>n}],[Ka.FarEndCameraCapabilityChange]:[{event:Ike,payload:n=>n}]},Rke="AUDIO_ACTIVE_SPEAKER",D4="AUDIO_UNMUTE_CONSENT",Gw="AUDIO_CURRENT_USER_JOIN_BY_VOIP",jq="AUDIO_CURRENT_USER_JOIN_BY_PHONE",Xk="AUDIO_CURRENT_USER_LEAVE_AUDIO",Pte="AUDIO_CURRENT_USER_MUTED",kte="AUDIO_CURRENT_USER_UNMUTED",Ake="AUDIO_PARTICIPANT_AUDIO_UPDATE",Oke="AUDIO_DIALOUT_RESULT_CODE",Mke="AUDIO_DIALOUT_RESULT_SUCCESS",$ke="AUDIO_DIALOUT_RESULT_FAIL",Lke="AUDIO_DIALOUT_CANCEL_SUCCESS",Nke="DIALOUT_CANCEL_FAIL",Fke="AUDIO_MERGE_AUDIO_INDICATION",jke="USER_FORBIDDEN_MICROPHONE",Bke="ESTABLISH_AUDIO_STREAM_ERROR",Hke="AUDIO_AUTO_PLAY_FAILED",yde="INVALID_DEVICE_ID",Uke="AUDIO_ALLOW_TALK_CHANGE",j2="SHARE_AUDIO_STATE_CHANGE",Bq="AUDIO_STATISTIC_DATA",zke="AUDIO_CURRENT_USER_SSRC",Hq="AUDIO_SET_SPEAKER_RESULT",Vke="AUDIO_SHARE_SECONDARY_AUDIO_SUCCESS",Wke="AUDIO_CRC_CALL_OUT_RESULT_CODE",qke="AUDIO_CRC_CALL_OUT_RESULT_SUCCESS",Kke="AUDIO_CRC_CALL_OUT_RESULT_FAIL",Gke="AUDIO_CURRENT_AUDIO_LEVEL_CHANGE";let of=function(n){return n.ActiveSpeaker="active-speaker",n.UnmuteAudioConsent="unmute-audio-consent",n.CurrentAudioChange="current-audio-change",n.CurrentAudioLevelChange="current-audio-level-change",n.DialoutStateChange="dialout-state-change",n.MergeAudio="merged-audio",n.AutoPlayFailed="auto-play-audio-failed",n.AllowTalkChange="allow-talk-change",n.ShareAudioChange="share-audio-change",n.AudioStatisticDataChange="audio-statistic-data-change",n.CrcCallOutStateChange="crc-call-out-state-change",n}({});const yb={JoinComputerAudio:{success:Gw,fail:[jke,Bke]},LeaveComputerAudio:{success:Xk},JoinAudioByCallMe:{success:Mke,fail:[$ke]},cancelDialOut:{success:Lke,fail:[Nke]},hangup:{success:Xk},crcCallOut:{success:qke,fail:[Kke]}},Nat={[of.ActiveSpeaker]:[{event:Rke,payload:n=>n}],[of.UnmuteAudioConsent]:[{event:D4,payload:n=>({reason:n})}],[of.CurrentAudioChange]:[{event:jq,payload:()=>({action:km.Join,type:ci.Phone})},{event:Gw,payload:()=>({action:km.Join,type:ci.Computer})},{event:Xk,payload:n=>{let{source:e}=n;return{action:km.Leave,source:e}}},{event:Pte,payload:n=>{let{source:e}=n;return{action:km.Muted,source:e}}},{event:kte,payload:n=>{let{source:e}=n;return{action:km.Unmuted,source:e}}}],[of.DialoutStateChange]:[{event:Oke,payload:n=>n}],[of.MergeAudio]:[{event:Fke,payload:n=>n}],[of.AutoPlayFailed]:[{event:Hke,payload:()=>{}}],[of.AllowTalkChange]:[{event:Uke,payload:n=>({enabled:n})}],[of.ShareAudioChange]:[{event:j2,payload:n=>n}],[of.AudioStatisticDataChange]:[{event:Bq,payload:n=>{const{data:{rate:e,...t},...r}=n??{data:{}};return{data:{bitrate:e,...t},...r}}}],[of.CrcCallOutStateChange]:[{event:Wke,payload:n=>n}],[of.CurrentAudioLevelChange]:[{event:Gke,payload:n=>n}]},Uq="SHARE_ACTIVE_INDICATION",zq="SHARE_CHECK_CHROME_SHARING_EXTENSION",Zke="SHARE_START_DESKTOP_SHARE_FAILED",Xke="SHARE_DIMENSION_CHANGE",h6="SHARE_RECEIVED_DIMENSION_CHANGE",Yke="SHARE_VIDEO_STREAMS_END",Jke="SHARE_PASSIVE_STOP_SHARE",Qke="SHARE_PASSIVE_BO_STOP",Tte="SHARE_NEW_USER_ADD",Dte="SHARE_USER_REMOVE",e3e="SHARE_USER_PAUSED",t3e="SHARE_USER_RESUMED",f6="SHARE_AUTO_CHANGE_SOURCE",p6="SHARE_REMOTE_CONTROL_APPROVE",sS="SHARE_GRAB_REMOTE_CONTROL_CHANGE",Vq="SHARE_REMOTE_CONTROL_CLIPBOARD_CHANGE",n3e="SHARE_REMOTE_CONTROL_SUCCESS",r3e="SHARE_REMOTE_CONTROL_FAILED",i3e="SHARE_PRIVILEGE_CHANGE",o3e="SHARE_READ_RECEIPT",Wq="SHARE_STATISTIC_DATA",s3e="SHARE_REMOTE_CONTROL_REQUEST",Vb="SHARE_REMOTE_CONTROL_APP_STATUS",R4="SHARE_REMOTE_CONTROL_SESSION_STATUS",a3e="SHARE_REMOTE_CONTROL_APP_SCHEME";let gu=function(n){return n.ShareActiveChange="active-share-change",n.ShareDimensionChange="share-content-dimension-change",n.SharePassiveStop="passively-stop-share",n.SharePeerStateChange="peer-share-state-change",n.ShareContentChange="share-content-change",n.SharePrivilegeChange="share-privilege-change",n.ShareReadReceipt="share-can-see-screen",n.ShareStatisticDataChange="share-statistic-data-change",n.RemoteControlApprovedChange="remote-control-approved-change",n.RemoteControlInControlChange="remote-control-in-control-change",n.RemoteControlClipboardChange="remote-control-clipboard-change",n.RemoteControlRequestChange="remote-control-request-change",n.RemoteControlAppStatusChange="remote-control-app-status-change",n.RemoteControlControlledStatusChange="remote-control-controlled-status-change",n}({});const Fat={[gu.ShareActiveChange]:[{event:Uq,payload:n=>{const{isActive:e,activeUserId:t,...r}=n;return{state:e?"Active":"Inactive",userId:t,...r}}}],[gu.ShareDimensionChange]:[{event:Xke,payload:n=>({type:"sended",width:n.width,height:n.height})},{event:h6,payload:n=>({type:"received",width:n.width,height:n.height})}],[gu.SharePassiveStop]:[{event:Yke,payload:()=>({reason:tB.StopScreenCapture})},{event:Jke,payload:()=>({reason:tB.PrivilegeChange})},{event:Qke,payload:()=>({reason:tB.ShareFromMainSession})}],[gu.SharePeerStateChange]:[{event:Tte,payload:n=>({userId:n.id,action:"Start"})},{event:Dte,payload:n=>({userId:n.id,action:"Stop"})},{event:e3e,payload:n=>({userId:n.id,action:"Pause"})},{event:t3e,payload:n=>({userId:n.id,action:"Resume"})}],[gu.ShareContentChange]:[{event:f6,payload:n=>n}],[gu.SharePrivilegeChange]:[{event:i3e,payload:n=>({privilege:n})}],[gu.ShareReadReceipt]:[{event:o3e,payload:()=>{}}],[gu.ShareStatisticDataChange]:[{event:Wq,payload:n=>{const{data:{rate:e,...t},...r}=n??{data:{}};return{data:{bitrate:e,...t},...r}}}],[gu.RemoteControlApprovedChange]:[{event:p6,payload:n=>({state:n?fde.Approved:fde.Rejected})}],[gu.RemoteControlInControlChange]:[{event:sS,payload:n=>({isControlling:n})}],[gu.RemoteControlClipboardChange]:[{event:Vq,payload:n=>n}],[gu.RemoteControlRequestChange]:[{event:s3e,payload:n=>n}],[gu.RemoteControlAppStatusChange]:[{event:Vb,payload:n=>n}],[gu.RemoteControlControlledStatusChange]:[{event:R4,payload:n=>n}]};let tm=function(n){return n.Question="question",n.UpdateQuestion="updateQuestion",n.Answer="answer",n.DeleteComment="deleteComment",n.DeleteQuestion="deleteQuestion",n.Dismiss="dismiss",n.Reopen="reopen",n.Upvote="upvote",n.AnswerLive="answerLive",n}({}),bde=function(n){return n.QaSettingChange="qa-setting-change",n.QaActionChange="qa-action-change",n}({});const jat={[bde.QaSettingChange]:[{event:"QA_SETTING_OPTION_CHANGE",payload:n=>n}],[bde.QaActionChange]:[{event:"QA_NEW_ASK_QUESTION",payload:n=>({action:tm.Question,data:n})},{event:"QA_UPDATE_ANONYMOUS_QUESTION",payload:n=>({action:tm.UpdateQuestion,data:n})},{event:"QA_ANSWER_QUESTION",payload:n=>({action:tm.Answer,data:n})},{event:"QA_ANSWER_REMOVE_COMMENT",payload:n=>({action:tm.DeleteComment,data:n})},{event:"QA_ANSWER_REMOVE_QUESTION",payload:n=>({action:tm.DeleteQuestion,data:n})},{event:"QA_ANSWER_DISMISS_QUESTION",payload:n=>({action:tm.Dismiss,data:n})},{event:"QA_ANSWER_REOPEN_QUESTION",payload:n=>({action:tm.Reopen,data:n})},{event:"QA_ANSWER_VOTE_QUESTION",payload:n=>({action:tm.Upvote,data:n})},{event:"QA_ANSWER_QUESTION_LIVE",payload:n=>({action:tm.AnswerLive,data:n})}]},lt="INVALID_OPERATION",Nf="INTERNAL_ERROR",Rte="OPERATION_TIMEOUT",Oc="INSUFFICIENT_PRIVILEGES",OC="IMPROPER_MEETING_STATE",Jn="INVALID_PARAMETERS",c3e="AUDIO_ENCODE_SUCCESS",l3e="AUDIO_DECODE_SUCCESS",u3e="VIDEO_ENCODE_SUCCESS",d3e="VIDEO_DECODE_SUCCESS",h3e="SHARING_ENCODE_SUCCESS",qq="SHARING_DECODE_SUCCESS",f3e="AUDIO_ENCODE_FAIL",p3e="AUDIO_DECODE_FAIL",g3e="VIDEO_ENCODE_FAIL",m3e="VIDEO_DECODE_FAIL",v3e="SHARING_ENCODE_FAIL",y3e="SHARING_DECODE_FAIL",b3e="MEDIA_DEVICE_CHANGE",A4="MEDIS_SDK_PATHCH_LOADED",S3e="AUDIO_BRIDGE_PEER_CONNECTION_RECEIVE_READY",_3e="AUDIO_BRIDGE_PEER_CONNECTION_SEND_READY",w3e="DEVICE_PERMISSION_CHANGE",C3e="MEDIA_HEALTH_CHECK_FAILED";let a5=function(n){return n.DeviceChange="device-change",n.MediaSDKChange="media-sdk-change",n.DevicePermissionChange="device-permission-change",n.MediaInternalError="media-internal-error",n}({});const Bat={[a5.DeviceChange]:[{event:b3e,payload:()=>({})}],[a5.MediaSDKChange]:[{event:c3e,payload:()=>({type:"audio",action:"encode",result:"success"})},{event:f3e,payload:()=>({type:"audio",action:"encode",result:"fail"})},{event:l3e,payload:()=>({type:"audio",action:"decode",result:"success"})},{event:p3e,payload:()=>({type:"audio",action:"decode",result:"fail"})},{event:u3e,payload:()=>({type:"video",action:"encode",result:"success"})},{event:g3e,payload:()=>({type:"video",action:"encode",result:"fail"})},{event:d3e,payload:()=>({type:"video",action:"decode",result:"success"})},{event:m3e,payload:()=>({type:"video",action:"decode",result:"fail"})},{event:h3e,payload:()=>({type:"share",action:"encode",result:"success"})},{event:v3e,payload:()=>({type:"share",action:"encode",result:"fail"})},{event:qq,payload:()=>({type:"share",action:"decode",result:"success"})},{event:y3e,payload:()=>({type:"share",action:"decode",result:"fail"})}],[a5.DevicePermissionChange]:[{event:w3e,payload:n=>n}],[a5.MediaInternalError]:[{event:C3e,payload:n=>n}]},x3e="BREAKOUT_ROOM_ADD_TOKEN",O4="BREAKOUT_ROOM_INVITE_TO_JOIN_NOTIFICATION",Kq="BREAKOUT_ROOM_ROOM_CLOSING_COUNTDOWN",Gq="BREAKOUT_ROOM_ROOM_COUTDOWN",E3e="BREAKOUT_ROOM_BROADCAST_MESSAGE",I3e="BREAKOUT_ROOM_ASK_HELP_REQUEST",Ate="BREAKOUT_ROOM_ASK_HELP_RESPONSE",o1="BREAKOUT_ROOM_ATTRIBUTE_INDICATION",M4="BREAKOUT_ROOM_JOIN_BO_RESPONSE",P3e="BREAKOUT_ROOM_ROOM_COUNTDOWN_TIME_UP",Zq="BREAKOUT_ROOM_CURRENT_USER_PARTICIPANT_ROLE",k3e="BREAKOUT_ROOM_LOAD_PRE_ASSIGNED_ROOMS",T3e="BREAKOUT_ROOM_MAIN_SESSION_USER_UPDATE",D3e="BREAKOUT_ROOM_INVITE_TO_BACK_NOTIFICATION",R3e="BREAKOUT_ROOM_IN_ROOM_USER_STATUS_UPDATE",A3e="BREAKOUT_ROOM_BROADCAST_VOICE";let ah=function(n){return n.InviteToJoin="invite-to-join",n.RoomCountdown="room-countdown",n.RoomTimeUp="room-time-up",n.ClosingRoomCountdown="closing-room-countdown",n.BroadcastMessage="broadcast-message",n.AskForHelp="ask-for-help",n.AskForHelpResponse="ask-for-help-response",n.RoomStateChange="room-state-change",n.MainSessionUserUpdate="main-session-user-updated",n.InviteToBack="invite-back-to-main-session",n.RoomUserUpdate="room-user-update",n.BroadcastVoice="broadcast-voice",n}({});const Hat={[ah.InviteToJoin]:[{event:O4,payload:n=>n}],[ah.RoomCountdown]:[{event:Gq,payload:n=>n}],[ah.RoomTimeUp]:[{event:P3e,payload:n=>n}],[ah.ClosingRoomCountdown]:[{event:Kq,payload:n=>n}],[ah.BroadcastMessage]:[{event:E3e,payload:n=>n}],[ah.AskForHelp]:[{event:I3e,payload:n=>n}],[ah.AskForHelpResponse]:[{event:Ate,payload:n=>n}],[ah.RoomStateChange]:[{event:o1,payload:n=>({status:n.controlStatus})}],[ah.MainSessionUserUpdate]:[{event:T3e,payload:()=>({})}],[ah.InviteToBack]:[{event:D3e,payload:n=>n}],[ah.RoomUserUpdate]:[{event:R3e,payload:n=>n}],[ah.BroadcastVoice]:[{event:A3e,payload:n=>n}]};var Xq=function(n){return n.StatusUpdate="archiving-status-update",n.OptionsUpdate="archiving-options-update",n}(Xq||{});const Uat={[Xq.StatusUpdate]:[{event:"ARCHIVING_STATUS_UPDATE",payload:n=>n}],[Xq.OptionsUpdate]:[{event:"ARCHIVING_OPTIONS_UPDATE",payload:n=>n}]};let sB=function(n){return n.PollDataChange="poll-data-change",n.PollSizeUpdate="poll-size-update",n.PollStatusUpdate="poll-status-update",n}({});const zat={[sB.PollDataChange]:[{event:"POLL_DATA_CHANGE",payload:n=>n}],[sB.PollSizeUpdate]:[{event:"POLL_SIZE_UPDATE",payload:n=>n}],[sB.PollStatusUpdate]:[{event:"POLL_STATUS_UPDATE",payload:n=>n}]};let Sde=function(n){return n.ReactionReceived="reaction-received",n.ReactionRemoved="reaction-removed",n}({});const Vat={[Sde.ReactionReceived]:[{event:"REACTION_RECEIVED",payload:n=>n}],[Sde.ReactionRemoved]:[{event:"REACTION_REMOVED",payload:n=>n}]},p0="SMART_SUMMARY_STATUS_CHANGE",g0="MEETING_QUERY_STATUS_CHANGE";let _de=function(n){return n.SummaryChange="summary-status-change",n.MeetingQueryChang="meeting-query-status-change",n}({});const Wat={[_de.SummaryChange]:[{event:p0,payload:n=>n}],[_de.MeetingQueryChang]:[{event:g0,payload:n=>n}]},ZP="LIVE_STREAM_STATUS_CHANGE",qat={"live-stream-status":[{event:ZP,payload:n=>n}]},wde={...xat,...Eat,...Iat,...Pat,...Tat,...Nat,...Lat,...jat,...Fat,...Bat,...Hat,...Uat,"closed-caption-message":[{event:"CC_RECEIVE_MESSAGE",payload:n=>n}],"closed-caption-lt-status":[{event:"LT_STATUS_CHANGE",payload:n=>n}],"closed-caption-lt-message":[{event:"LT_RECEIVE_MESSAGE",payload:n=>n}],"closed-caption-status":[{event:"CC_ASSIGN_CC_EDITOR_SUCCESS",payload:n=>n},{event:"CC_STATUS_CHANGE",payload:n=>n}],...zat,...Vat,...Wat,...qat},zm=function(n){return{all:n=n||new Map,on:function(e,t){var r=n.get(e);r?r.push(t):n.set(e,[t])},off:function(e,t){var r=n.get(e);r&&(t?r.splice(r.indexOf(t)>>>0,1):n.set(e,[]))},emit:function(e,t){var r=n.get(e);r&&r.slice().map(function(i){i(t)}),(r=n.get("*"))&&r.slice().map(function(i){i(e,t)})}}}(),Wb=new Map,Yq=new Array,me=function(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0;zm.emit(n,e)},pm=n=>new Promise((e,t)=>{n.fail&&n.fail.length>0?Ad(No(zm,n.success).pipe(Ur(1)),ga(...n.fail.map(r=>No(zm,r).pipe(Ur(1),ht(i=>b1({type:r,payload:i})))))).subscribe(r=>e(r),r=>{typeof r.payload=="object"?t({type:r.type,...r.payload}):r.payload===void 0?t({type:r.type}):t(r)}):No(zm,n.success).pipe(Ur(1)).subscribe(r=>e(r))}),Un=function(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1e4;return new Promise((r,i)=>{let o=Mt;typeof n=="string"?o=No(zm,n).pipe(Ur(1)):(o=No(zm,n.event),n.operations&&(o=n.operations.reduce((s,a)=>s.pipe(a),o))),Ad(o,js(t).pipe($n(b1("timeout")))).subscribe(s=>{if(e){const a=e(s);typeof a=="boolean"?a?r(""):i({type:Nf}):a.ret===0?r(a.body):i({type:Nf,reason:a.body})}else r(s)},()=>{i({type:Rte})})})},Mi=(n,e)=>e!==void 0?No(zm,n).pipe(Ur(e)):No(zm,n),Ote=()=>{Yq.forEach(n=>{n.unsubscribe()}),Yq.length=0,Wb.clear()},{setAttendeesList:g6,setAssistantList:Acn,setIsAdmitAllSilentUsers:O3e,resetParticipants:M3e,addFailoverAttendees:Jq,removeFailoverAttendees:$3e,setClearRaiseHand:L3e,setClearAttendeeFeedback:N3e,updateAttendeeDisplayName:F3e,removeXmppAttendeeUser:j3e,updateXmppAttendeeList:B3e,setAttendeeExtraKey:Yk}=Sa({SET_ATTENDEES_LIST:n=>n,SET_ASSISTANT_LIST:n=>n,UPDATE_XMPP_ATTENDEE_LIST:n=>n,RESET_PARTICIPANTS:()=>({}),SET_IS_ADMIT_ALL_SILENT_USERS:n=>n,REMOVE_FAILOVER_ATTENDEES:n=>n,ADD_FAILOVER_ATTENDEES:n=>n,SET_CLEAR_RAISE_HAND:()=>({}),SET_CLEAR_ATTENDEE_FEEDBACK:()=>({}),UPDATE_ATTENDEE_DISPLAY_NAME:n=>n,REMOVE_XMPP_ATTENDEE_USER:n=>n,SET_ATTENDEE_EXTRA_KEY:n=>n});var c5="NOT_FOUND",Kat=function(n,e){return n===e};function H3e(n,e){var t,r,i=typeof e=="object"?e:{equalityCheck:e},o=i.equalityCheck,s=o===void 0?Kat:o,a=i.maxSize,c=a===void 0?1:a,l=i.resultEqualityCheck,u=function(f){return function(p,g){if(p===null||g===null||p.length!==g.length)return!1;for(var m=p.length,v=0;v<m;v++)if(!f(p[v],g[v]))return!1;return!0}}(s),d=c===1?(t=u,{get:function(f){return r&&t(r.key,f)?r.value:c5},put:function(f,p){r={key:f,value:p}},getEntries:function(){return r?[r]:[]},clear:function(){r=void 0}}):function(f,p){var g=[];function m(v){var b=g.findIndex(function(E){return p(v,E.key)});if(b>-1){var S=g[b];return b>0&&(g.splice(b,1),g.unshift(S)),S.value}return c5}return{get:m,put:function(v,b){m(v)===c5&&(g.unshift({key:v,value:b}),g.length>f&&g.pop())},getEntries:function(){return g},clear:function(){g=[]}}}(c,u);function h(){var f=d.get(arguments);if(f===c5){if(f=n.apply(null,arguments),l){var p=d.getEntries().find(function(g){return l(g.value,f)});p&&(f=p.value)}d.put(arguments,f)}return f}return h.clearCache=function(){return d.clear()},h}function U3e(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];return function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];var a,c=0,l={memoizeOptions:void 0},u=o.pop();if(typeof u=="object"&&(l=u,u=o.pop()),typeof u!="function")throw new Error("createSelector expects an output function after the inputs, but received: ["+typeof u+"]");var d=l.memoizeOptions,h=d===void 0?t:d,f=Array.isArray(h)?h:[h],p=function(v){var b=Array.isArray(v[0])?v[0]:v;if(!b.every(function(E){return typeof E=="function"})){var S=b.map(function(E){return typeof E=="function"?"function "+(E.name||"unnamed")+"()":typeof E}).join(", ");throw new Error("createSelector expects all input-selectors to be functions, but received the following types: ["+S+"]")}return b}(o),g=n.apply(void 0,[function(){return c++,u.apply(null,arguments)}].concat(f)),m=n(function(){for(var v=[],b=p.length,S=0;S<b;S++)v.push(p[S].apply(null,arguments));return a=g.apply(null,v)});return Object.assign(m,{resultFunc:u,memoizedResultFunc:g,dependencies:p,lastResult:function(){return a},recomputations:function(){return c},resetRecomputations:function(){return c=0}}),m}}var Eo=U3e(H3e);const Hy=n=>{let{participants:{attendeesList:e}}=n;return e},z3e=n=>{let{meeting:{userId:e}}=n;return e},Qq=n=>{let{participants:{xmppAttendeeList:e}}=n;return e};let TS=function(n){return n[n.Attendee=0]="Attendee",n[n.Host=1]="Host",n[n.Owner=4]="Owner",n[n.ViewOnly=8]="ViewOnly",n[n.HostOwner=5]="HostOwner",n[n.ViewOnlyCanTalk=24]="ViewOnlyCanTalk",n}({}),Gat=function(n){return n[n.Host=10]="Host",n[n.Panelist=20]="Panelist",n[n.Attendee=30]="Attendee",n}({}),eK=function(n){return n[n.Client=9]="Client",n[n.Phone=5]="Phone",n[n.H323=15]="H323",n[n.Assitant=51]="Assitant",n}({});const m6=n=>(n&TS.Host)===TS.Host,DS=n=>(n&eK.Phone)===eK.Phone,v6=n=>n===TS.ViewOnlyCanTalk,ma=n=>(n&TS.ViewOnly)===TS.ViewOnly;let C1=function(n){return n[n.Automatically=1]="Automatically",n[n.Manually=2]="Manually",n[n.SelfSelect=3]="SelfSelect",n}({}),Sr=function(n){return n[n.NotStarted=1]="NotStarted",n[n.InProgress=2]="InProgress",n[n.Closing=3]="Closing",n[n.Closed=4]="Closed",n}({}),V3e=function(n){return n[n.NoToken=1]="NoToken",n[n.GotToken=2]="GotToken",n[n.Started=3]="Started",n[n.Closing=4]="Closing",n[n.Closed=5]="Closed",n}({}),Cn=function(n){return n.Initial="initial",n.Invited="invited",n.Joining="joining",n.InRoom="in room",n.Leaving="leaving",n.TimeUp="time up",n.MainSession="main session",n}({}),bb=function(n){return n.Join="joinRequest",n.Switch="switchRequest",n.Leave="leaveRequest",n.Broadcast="messageText",n.HelpReq="helpRequest",n.HelpRes="helpResponse",n.CoHostWantJoinThisBo="wantJoinThisBO",n.BOActivity="BOActivity",n}({});const Cde="Subsession";let m0=function(n){return n[n.Received=0]="Received",n[n.Busy=1]="Busy",n[n.Ignore=2]="Ignore",n[n.AlreadyInRoom=3]="AlreadyInRoom",n}({}),xde=function(n){return n[n.AskToLeave=0]="AskToLeave",n[n.ClosingRoom=1]="ClosingRoom",n}({}),Zat=function(n){return n[n.Active=0]="Active",n[n.Ask=1]="Ask",n}({}),aB=function(n){return n[n.Connect=1]="Connect",n[n.Muted=2]="Muted",n[n.Voip=4]="Voip",n}({}),Ede=function(n){return n[n.Connect=8]="Connect",n[n.On=16]="On",n}({}),Ide=function(n){return n[n.Share=32]="Share",n[n.ShareAudio=64]="ShareAudio",n}({});const W3e=n=>{let{breakoutRoom:e}=n;return e&&e.controlStatus},q3e=n=>{let{breakoutRoom:e}=n;return e&&e.currentRoom.status},mn=Eo([z3e,Hy],(n,e)=>e.find(t=>t.userId===n)),Td=Eo([mn],n=>(n==null?void 0:n.isHost)||(n==null?void 0:n.bCoHost)),K3e=Eo([mn],n=>n==null?void 0:n.isHost),rD=Eo([Qq],n=>n.filter(e=>e.userRole===Gat.Attendee)),Xat=Eo([Hy],n=>n.filter(e=>e.bHold&&!e.bid)),Yi=Eo([Hy,W3e,q3e],(n,e,t)=>e!==Sr.InProgress&&e!==Sr.Closing||t!==Cn.InRoom?n.filter(r=>!r.bHold&&!r.bid):n.filter(r=>!r.bHold)),Yat=Eo([n=>{let{participants:{assistantList:e}}=n;return e}],n=>n),tK=Eo([Yi],n=>n.find(e=>e.isHost)),Pde=Eo([Yi],n=>n.filter(e=>e.bCoHost)),Mte=Eo([mn,Yi],(n,e)=>e.filter(t=>t.userId!==(n==null?void 0:n.userId)));Eo([Qq],n=>n.reduce((e,t)=>{const{jid:r}=t;return Object.assign(e,{[r]:t}),e},{})),Eo([Qq,n=>{let{meeting:{jid:e}}=n;return e}],(n,e)=>{var t;return(t=n.find(r=>r.jid===e))===null||t===void 0?void 0:t.userId});const Jat=Eo([Hy],function(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).some(n=>(n==null?void 0:n.bLocalRecord)===Gk.Start)}),Qat=Eo([W3e,n=>{let{meeting:e}=n;return e&&e.meetingOptions},Hy,K3e],(n,e,t,r)=>{const i=t.filter(a=>a.bCoHost),{moveToWRIfHostLeave:o}=e,s=n===Sr.InProgress;return r&&!!o&&i.length<=0&&!s&&t.length>1});Eo([Hy,q3e,n=>{let{breakoutRoom:e}=n;return e&&e.mainSessionAttendeeList}],(n,e,t)=>(e===Cn.InRoom?t:n).filter(r=>{return!(r.bHold||r.isHost||r.audio===ci.Phone||DS(r==null?void 0:r.userType)||(i=r==null?void 0:r.caps,o=r==null?void 0:r.bMultiStreamVideoUser,((s,a)=>(c=>!!(128&c))(s)&&a!==void 0)(i,o)&&o));var i,o}));let $i=function(n){return n.Closed="closed",n.Connecting="connecting",n.Connected="connected",n}({});function Ia(n){return 1<<n-1}let mu=function(n){return n[n.SupportASL=Ia(1)]="SupportASL",n[n.SidecarPhase2=Ia(2)]="SidecarPhase2",n[n.SupportBroadcastVoice=Ia(4)]="SupportBroadcastVoice",n[n.SendMeetingTokenSeparately=Ia(5)]="SendMeetingTokenSeparately",n[n.SupportPreview=Ia(6)]="SupportPreview",n[n.WebCameraIndication=Ia(7)]="WebCameraIndication",n[n.SupportFarEndCameraControl=Ia(9)]="SupportFarEndCameraControl",n[n.SupportVideoShare=Ia(10)]="SupportVideoShare",n[n.UnifyErrorType=Ia(11)]="UnifyErrorType",n[n.WhiteBoard=Ia(12)]="WhiteBoard",n[n.RequestRemoteControl=Ia(14)]="RequestRemoteControl",n[n.SmartSummary=Ia(15)]="SmartSummary",n[n.LocalRecording=Ia(16)]="LocalRecording",n[n.LocalRecordingGrantPermission=Ia(17)]="LocalRecordingGrantPermission",n[n.ShareMultiStream=Ia(18)]="ShareMultiStream",n[n.VideoLTR=Ia(19)]="VideoLTR",n[n.WebrtcAudioRtcpTime=Ia(20)]="WebrtcAudioRtcpTime",n[n.SupportSend1080PVideo=Ia(29)]="SupportSend1080PVideo",n[n.SupportSend1080PVideoShare=Ia(30)]="SupportSend1080PVideoShare",n}({});const{setAsnIds:G3e,setIsCanUnmute:Z3e,setDialoutSequence:X3e,setDialoutResultCode:Y3e,setIsAllowToTalk:nK,setAudioSsrc:J3e,setIsMutedUponEntry:Q3e,setIsUserGrantCaptureAudio:eTe,setIsMicrophoneForbidden:$te,setWebrtcRestartCount:iD,setMicrophoneList:tTe,setSpeakerList:nTe,setActiveMicrophone:Jk,setActiveSpeaker:_7,setCanPlayAudio:B2,resetAudio:rTe,setIsComputerAudioLoading:qb,setIsAllowToTalkAttendeeConnected:rK,setIsMuteBeforeSharingAudio:Vm,addLocalShareAudioUser:iTe,updateLocalShareAudioUser:oTe,setIsJoinComputerAudioBeforeSharingAudio:H2,setIsShareAudioEnabled:w7,setIsShareAudioMuted:y6,setIsSharingAudio:U2,setAudioDataEncoding:b6,setAudioDataDecoding:S6,addLocallyMutedAudio:sTe,removeLocallyMutedAudio:_6,updateUserAudioVolumeLocally:aTe,removeLocalUserAudioVolume:cTe,setCustomizedAudioOption:Lte,setIsBackgroundNoiseSuppression:iK,setIsHidEnabled:lTe,setAudioMediaPlaybackFile:oK,setIsStopAllIncomingAudio:sK,setIsVerifiedAudioPermissionOnIosMobile:uTe,setIsAudioBridgeSignalReconnecting:Nte,setAudioMutedSource:_m,setAudioUnmutedSource:Qk,setAudioOriginalSound:aK,setLeaveAudioSource:RS,setSecondaryAudioMicrophoneId:w6,setCrcCallOutSequence:dTe,setCrcCallOutReturnCode:hTe}=Sa("SET_ASN_IDS","SET_IS_CAN_UNMUTE","SET_DIALOUT_SEQUENCE","SET_DIALOUT_RESULT_CODE","SET_IS_ALLOW_TO_TALK","SET_AUDIO_SSRC","SET_IS_MUTED_UPON_ENTRY","SET_IS_USER_GRANT_CAPTURE_AUDIO","SET_IS_MICROPHONE_FORBIDDEN","SET_WEBRTC_RESTART_COUNT","SET_MICROPHONE_LIST","SET_SPEAKER_LIST","SET_ACTIVE_MICROPHONE","SET_ACTIVE_SPEAKER","SET_CAN_PLAY_AUDIO","RESET_AUDIO","SET_IS_COMPUTER_AUDIO_LOADING","SET_IS_ALLOW_TO_TALK_ATTENDEE_CONNECTED","SET_IS_MUTE_BEFORE_SHARING_AUDIO","SET_IS_SHARING_AUDIO","ADD_LOCAL_SHARE_AUDIO_USER","UPDATE_LOCAL_SHARE_AUDIO_USER","SET_IS_JOIN_COMPUTER_AUDIO_BEFORE_SHARING_AUDIO","SET_IS_SHARE_AUDIO_ENABLED","SET_IS_SHARE_AUDIO_MUTED","SET_AUDIO_DATA_ENCODING","SET_AUDIO_DATA_DECODING","ADD_LOCALLY_MUTED_AUDIO","REMOVE_LOCALLY_MUTED_AUDIO","UPDATE_USER_AUDIO_VOLUME_LOCALLY","REMOVE_LOCAL_USER_AUDIO_VOLUME","SET_CUSTOMIZED_AUDIO_OPTION","SET_IS_BACKGROUND_NOISE_SUPPRESSION","SET_IS_HID_ENABLED","SET_AUDIO_MEDIA_PLAYBACK_FILE","SET_IS_STOP_ALL_INCOMING_AUDIO","SET_IS_VERIFIED_AUDIO_PERMISSION_ON_IOS_MOBILE","SET_IS_AUDIO_BRIDGE_SIGNAL_RECONNECTING","SET_AUDIO_MUTED_SOURCE","SET_AUDIO_UNMUTED_SOURCE","SET_AUDIO_ORIGINAL_SOUND","SET_LEAVE_AUDIO_SOURCE","SET_SECONDARY_AUDIO_MICROPHONE_ID","SET_CRC_CALL_OUT_SEQUENCE","SET_CRC_CALL_OUT_RETURN_CODE"),{setSharePrivilege:Fte,setShareActiveNode:C6,setIsReceiveSharing:x6,setIsChromeExtensionInstalled:fTe,setIsScreenShareForbidden:kde,setShareDimension:pTe,setShareStatus:Dd,setShareSsrc:gTe,setShareQuality:jte,setReceivedShareDimension:cK,setIsGrabRemoteControl:$4,setIsSdkGrabControl:lK,setIsReceiveSharingFromMainSession:mTe,setIsSharingToBreakoutRoom:cP,setIsSharingWithSecondCamera:vTe,setShringSecondCameraId:yTe,setIsRequireReadReceipt:bTe,setIsOptimizedForSharedVideo:E6,setShareDataEncoding:uK,setShareDataDecoding:e3,addShareCapturedEnsuredCanvas:STe,addShareRenderedEnsuredCanvas:_Te,setRemoteControlCurrentSsrc:Ocn,setRemoteControllingSsrc:XP,setApprovedRemoteControlSsrc:MC,setRemoteControlAppDownloadUrl:wTe,setRemoteControlAppInstallStatus:s1,remoteControlAppStatusFallbackCheck:Tde,remoteControlAppLaunchedCheck:cB,setIsEnableAutoDeleteRcApp:Mcn,setRemoteControlAppLaunchSheme:Fp,addSharingUserIdSsrcMapping:dK,addRemoteControlledUser:CTe,removeRemoteControlledUser:hK,setRemoteControlSetting:Bte,setRemoteControlViewportDomSelector:xTe,setIsFullHdVideoShareEnabled:ETe,resetShare:ITe}=Sa("SET_SHARE_PRIVILEGE","SET_SHARE_ACTIVE_NODE","SET_IS_RECEIVE_SHARING","SET_IS_CHROME_EXTENSION_INSTALLED","SET_IS_SCREEN_SHARE_FORBIDDEN","SET_SHARE_DIMENSION","SET_SHARE_STATUS","SET_SHARE_SSRC","SET_SHARE_QUALITY","SET_RECEIVED_SHARE_DIMENSION","SET_IS_GRAB_REMOTE_CONTROL","SET_IS_SDK_GRAB_CONTROL","SET_IS_RECEIVE_SHARING_FROM_MAIN_SESSION","SET_IS_SHARING_TO_BREAKOUT_ROOM","SET_IS_SHARING_WITH_SECOND_CAMERA","SET_SHRING_SECOND_CAMERA_ID","SET_IS_REQUIRE_READ_RECEIPT","SET_IS_OPTIMIZED_FOR_SHARED_VIDEO","SET_SHARE_DATA_ENCODING","SET_SHARE_DATA_DECODING","ADD_SHARE_CAPTURED_ENSURED_CANVAS","ADD_SHARE_RENDERED_ENSURED_CANVAS","SET_REMOTE_CONTROL_CURRENT_SSRC","SET_REMOTE_CONTROLLING_SSRC","SET_APPROVED_REMOTE_CONTROL_SSRC","SET_REMOTE_CONTROL_APP_DOWNLOAD_URL","SET_REMOTE_CONTROL_APP_INSTALL_STATUS","REMOTE_CONTROL_APP_STATUS_FALLBACK_CHECK","REMOTE_CONTROL_APP_LAUNCHED_CHECK","SET_IS_ENABLE_AUTO_DELETE_RC_APP","SET_REMOTE_CONTROL_APP_LAUNCH_SHEME","ADD_SHARING_USER_ID_SSRC_MAPPING","ADD_REMOTE_CONTROLLED_USER","REMOVE_REMOTE_CONTROLLED_USER","SET_REMOTE_CONTROL_SETTING","SET_REMOTE_CONTROL_VIEWPORT_DOM_SELECTOR","SET_IS_FULL_HD_VIDEO_SHARE_ENABLED","RESET_SHARE"),{setVideoSsrc:PTe,setActiveVideoId:kTe,setCameraList:Hte,setActiveCamera:I6,setIsCurrentUserStartedVideo:TTe,setSpotlightVideo:fK,setIsCaptureForbidden:P6,setVideoMaxQuality:DTe,setIsVideoMuted:RTe,setIsCaptureCameraLoading:lP,setIsCameraTaken:k6,resetVideo:ATe,setReceivedVideoDimension:pK,addSubscribedVideoId:L4,removeSubscribedVideoId:N4,setIsFollowHostVideoLayout:OTe,setHostDragLayout:MTe,addRenderedVideoId:$C,removeRenderedVideoId:T6,setIsSupportHdVideo:$Te,setMaximumNumbeOfHdSubscriptions:LTe,setIsCanUnmuteVideo:NTe,setIsVbPreloadReady:gK,setIsVbConfiged:D6,setVbImageSrc:F4,setVideoDataEncoding:R6,setVideoDataDecoding:A6,setHardwareAccelerationState:Ow,setVideoCaptureCustomizedOption:FTe,setNetworkQuality:mK,setVideoCameraPtzCapabilities:jTe,setIsCurrentUserRequestCameraControlled:O6,setIsCurrentUserCameraInControl:M6,addVideoFarEndCameraControlUser:BTe,removeVideoFarEndCameraControlUser:$6,setVideoPtzCameraMoving:vK,setVideoPtzCameraValue:Ute,setIsControllingFarEndCamera:yK,setNetworkQualityBroadcastTime:HTe,setIsMaskConfiged:L6,setVideoBackgroundMode:ect,setVideoMask:j4,setVideoCapturedDimension:UTe,addVideoRenderedEnsuredCanvas:zTe,setVideoMediaPlaybackFile:bK,setPrefetchedVideoUser:LC,setVideoQosSubscriptionStatus:SK,setIsSupportFullHdVideo:VTe,addVideoPlayerAttachment:WTe,removeVideoPlayerAttachment:B4,setIsWebGl2RendererType:qTe,setIsWebGpuRendererType:KTe,setVideoRendererType:GTe,setIsVideoMirrored:ZTe,addSelfPreviewVideoTag:XTe,removeSelfPreviewVideoTag:_K}=Sa("SET_VIDEO_SSRC","SET_ACTIVE_VIDEO_ID","SET_CAMERA_LIST","SET_ACTIVE_CAMERA","SET_IS_CURRENT_USER_STARTED_VIDEO","SET_SPOTLIGHT_VIDEO","SET_IS_CAPTURE_FORBIDDEN","SET_VIDEO_MAX_QUALITY","SET_IS_VIDEO_MUTED","SET_IS_CAPTURE_CAMERA_LOADING","SET_IS_CAMERA_TAKEN","RESET_VIDEO","SET_RECEIVED_VIDEO_DIMENSION","ADD_SUBSCRIBED_VIDEO_ID","REMOVE_SUBSCRIBED_VIDEO_ID","SET_IS_FOLLOW_HOST_VIDEO_LAYOUT","SET_HOST_DRAG_LAYOUT","ADD_RENDERED_VIDEO_ID","REMOVE_RENDERED_VIDEO_ID","SET_IS_SUPPORT_HD_VIDEO","SET_MAXIMUM_NUMBE_OF_HD_SUBSCRIPTIONS","SET_IS_CAN_UNMUTE_VIDEO","SET_IS_VB_PRELOAD_READY","SET_IS_VB_CONFIGED","SET_VB_IMAGE_SRC","SET_VIDEO_DATA_ENCODING","SET_VIDEO_DATA_DECODING","SET_HARDWARE_ACCELERATION_STATE","SET_VIDEO_CAPTURE_CUSTOMIZED_OPTION","SET_NETWORK_QUALITY","SET_VIDEO_CAMERA_PTZ_CAPABILITIES","SET_IS_CURRENT_USER_REQUEST_CAMERA_CONTROLLED","SET_IS_CURRENT_USER_CAMERA_IN_CONTROL","ADD_VIDEO_FAR_END_CAMERA_CONTROL_USER","REMOVE_VIDEO_FAR_END_CAMERA_CONTROL_USER","SET_VIDEO_PTZ_CAMERA_MOVING","SET_VIDEO_PTZ_CAMERA_VALUE","SET_IS_CONTROLLING_FAR_END_CAMERA","SET_NETWORK_QUALITY_BROADCAST_TIME","SET_IS_MASK_CONFIGED","SET_VIDEO_BACKGROUND_MODE","SET_VIDEO_MASK","SET_VIDEO_CAPTURED_DIMENSION","ADD_VIDEO_RENDERED_ENSURED_CANVAS","SET_VIDEO_MEDIA_PLAYBACK_FILE","SET_PREFETCHED_VIDEO_USER","SET_VIDEO_QOS_SUBSCRIPTION_STATUS","SET_IS_SUPPORT_FULL_HD_VIDEO","ADD_VIDEO_PLAYER_ATTACHMENT","REMOVE_VIDEO_PLAYER_ATTACHMENT","SET_IS_WEB_GL2_RENDERER_TYPE","SET_IS_WEB_GPU_RENDERER_TYPE","SET_VIDEO_RENDERER_TYPE","SET_IS_VIDEO_MIRRORED","ADD_SELF_PREVIEW_VIDEO_TAG","REMOVE_SELF_PREVIEW_VIDEO_TAG"),{setQaSetting:$cn,addQaQuestion:Lcn,addQaAnswer:Ncn,removeQaComment:Fcn,removeQaQuestion:jcn,dismissQaQuestion:Bcn,reopenQaQuestion:Hcn,voteQaQuestion:Ucn,answerQaQuestionLive:zcn,updateAttendeeAnonymousQuestion:Vcn,setQaEnabled:Wcn,resetQa:tct}=Sa("SET_QA_SETTING","ADD_QA_QUESTION","ADD_QA_ANSWER","REMOVE_QA_COMMENT","REMOVE_QA_QUESTION","DISMISS_QA_QUESTION","REOPEN_QA_QUESTION","VOTE_QA_QUESTION","ANSWER_QA_QUESTION_LIVE","UPDATE_ATTENDEE_ANONYMOUS_QUESTION","SET_QA_ENABLED","RESET_QA"),{setChatPrivilege:zte,setPanelistChatPrivilege:YTe,addChatMessageHistory:t3,resetChat:JTe,setIsAllowAttendeeChat:QTe,setLatestChatMessageId:eDe,removeChatMessage:H4,setFileChatSetting:tDe,addChatFileRecord:Vte,updateChatFileRecord:Da,cancelSendFileChat:n3,addFailedChatFileTransfer:Wte,setChatFileMessageId:nDe,cancelDownloadFileChat:qte}=Sa("SET_CHAT_PRIVILEGE","SET_PANELIST_CHAT_PRIVILEGE","ADD_CHAT_MESSAGE_HISTORY","RESET_CHAT","SET_IS_ALLOW_ATTENDEE_CHAT","SET_LATEST_CHAT_MESSAGE_ID","REMOVE_CHAT_MESSAGE","SET_FILE_CHAT_SETTING","ADD_CHAT_FILE_RECORD","UPDATE_CHAT_FILE_RECORD","CANCEL_SEND_FILE_CHAT","ADD_FAILED_CHAT_FILE_TRANSFER","SET_CHAT_FILE_MESSAGE_ID","CANCEL_DOWNLOAD_FILE_CHAT"),{setCcEditorInfo:rDe,setTempSendCcText:qcn,setCcLtMessage:Kcn,setTempReceiveLtText:Gcn,setTempReceiveCcText:Zcn,setGatewayInfoList:Xcn,setLtEnable:Ycn,setIsListenClosedCaption:Jcn,setCcEnable:Qcn,allowParticipantAskLt:eln,receiveAskStartLt:tln,setMeetingEnabledLtFeature:nln,updateLtStatus:rln,deleteMessage:iln,updateMessage:oln,resetClosedCaption:nct}=Sa("SET_CC_EDITOR_INFO","SET_CC_LT_MESSAGE","SET_TEMP_SEND_CC_TEXT","SET_TEMP_RECEIVE_LT_TEXT","SET_TEMP_RECEIVE_CC_TEXT","SET_GATEWAY_INFO_LIST","SET_LT_ENABLE","SET_IS_LISTEN_CLOSED_CAPTION","SET_CC_ENABLE","ALLOW_PARTICIPANT_ASK_LT","RECEIVE_ASK_START_LT","SET_MEETING_ENABLED_LT_FEATURE","UPDATE_LT_STATUS","DELETE_MESSAGE","UPDATE_MESSAGE","RESET_CLOSED_CAPTION"),{addBreakoutRooms:iDe,setBreakoutRoomAllocationPattern:wK,setBreakoutRoomSequenceId:N6,setMeetingElapsedTime:CK,setStartRoomElapsedTime:oDe,setBreakoutRoomOptions:sDe,setBreakoutRoomControlStatus:aDe,setBreakoutRooms:YP,setCurrentBreakoutRoom:F6,setBreakoutRoomAttendeeStatus:aS,setBreakoutRoomConfId:xK,setBreakoutRoomToken:EK,resetBreakoutRoom:cDe,setBreakoutRoomClosingRoomTime:IK,setBreakoutRoomBroadcastMessage:lDe,setBreakoutRoomHostReplyType:Kte,setBreakoutRoomHostReplyRequestId:uDe,setMainSessionAttendeeList:dDe,setIsHugeBreakoutRoom:hDe,setBreakoutRoomPreAssignedRoomList:PK,setBreakoutRoomUserRoleUpdated:kK,setBreakoutRoomMeetingOptions:fDe,setBreakoutRoomUserActivityStatus:pDe,setBreakoutRoomIsBroadcastVoice:j6}=Sa("ADD_BREAKOUT_ROOMS","SET_BREAKOUT_ROOM_ALLOCATION_PATTERN","SET_BREAKOUT_ROOM_SEQUENCE_ID","SET_MEETING_ELAPSED_TIME","SET_START_ROOM_ELAPSED_TIME","SET_BREAKOUT_ROOM_OPTIONS","SET_BREAKOUT_ROOM_CONTROL_STATUS","SET_BREAKOUT_ROOMS","SET_CURRENT_BREAKOUT_ROOM","SET_BREAKOUT_ROOM_ATTENDEE_STATUS","SET_BREAKOUT_ROOM_CONF_ID","SET_BREAKOUT_ROOM_TOKEN","RESET_BREAKOUT_ROOM","SET_BREAKOUT_ROOM_CLOSING_ROOM_TIME","SET_BREAKOUT_ROOM_BROADCAST_MESSAGE","SET_BREAKOUT_ROOM_HOST_REPLY_TYPE","SET_BREAKOUT_ROOM_HOST_REPLY_REQUEST_ID","SET_MAIN_SESSION_ATTENDEE_LIST","SET_IS_HUGE_BREAKOUT_ROOM","SET_BREAKOUT_ROOM_PRE_ASSIGNED_ROOM_LIST","SET_BREAKOUT_ROOM_USER_ROLE_UPDATED","SET_BREAKOUT_ROOM_MEETING_OPTIONS","SET_BREAKOUT_ROOM_USER_ACTIVITY_STATUS","SET_BREAKOUT_ROOM_IS_BROADCAST_VOICE"),{setCloudRecordingStatus:gDe,setCloudRecordingEnable:mDe,setCloudIsoRecordingEnable:vDe,setAllowStopAutoRecording:yDe,setAutomaticCloudRecordingEnable:bDe,setIsZoomIQ:Gte,setZoomIQChanging:Zte,setLocalRecordStatus:Xte,setSupportLocalRecording:TK,setLocalGrantPermissionOption:SDe,setLocalPermissionUserList:NC,resetRecording:_De}=Sa("SET_CLOUD_RECORDING_STATUS","SET_CLOUD_RECORDING_ENABLE","SET_CLOUD_ISO_RECORDING_ENABLE","SET_ALLOW_STOP_AUTO_RECORDING","SET_AUTOMATIC_CLOUD_RECORDING_ENABLE","SET_IS_ZOOM_I_Q","SET_ZOOM_I_Q_CHANGING","SET_LOCAL_RECORD_STATUS","SET_SUPPORT_LOCAL_RECORDING","SET_LOCAL_GRANT_PERMISSION_OPTION","SET_LOCAL_PERMISSION_USER_LIST","RESET_RECORDING"),{updateCmdJid:wDe,removeCmdJid:CDe,setCmdChannelConnectionStatus:xDe,resetCmdChannel:EDe}=Sa("UPDATE_CMD_JID","REMOVE_CMD_JID","SET_CMD_CHANNEL_CONNECTION_STATUS","RESET_CMD_CHANNEL"),{setArchivingStatus:sln,setArchivingSessionReady:aln,setArchivingOptions:cln,resetArchiving:rct}=Sa({SET_ARCHIVING_STATUS:n=>n,SET_ARCHIVING_SESSION_READY:n=>n,SET_ARCHIVING_OPTIONS:n=>n,RESET_ARCHIVING:()=>{}}),{setIsLiveTranscriptionEnabled:IDe,setLiveTranscriptionMeetingOptions:PDe,setIsLiveTranscriptionManualCaptionerEnabled:DK,setLiveTranscriptionGatewayId:kDe,setLiveTranscriptionSupportedLanguage:TDe,setIsLiveTranscriptionSubscribed:RK,setCurrentTranscriptionLang:x1,setCurrentTranslationLang:B6,addLiveTranscriptionMessage:AK,updateLiveTranscriptionMessage:DDe,reduceLiveTranscriptionMessages:RDe,setLiveTranscriptionEngineType:ADe,removeLiveTranscriptionFailoverState:ODe,setLiveTranscriptionLastCaptionMessage:MDe,resetLiveTranscription:$De,setIsHostDisableCaptions:LDe}=Sa("SET_IS_LIVE_TRANSCRIPTION_ENABLED","SET_LIVE_TRANSCRIPTION_MEETING_OPTIONS","SET_IS_LIVE_TRANSCRIPTION_MANUAL_CAPTIONER_ENABLED","SET_LIVE_TRANSCRIPTION_GATEWAY_ID","SET_LIVE_TRANSCRIPTION_SUPPORTED_LANGUAGE","SET_IS_LIVE_TRANSCRIPTION_SUBSCRIBED","SET_CURRENT_TRANSCRIPTION_LANG","SET_CURRENT_TRANSLATION_LANG","ADD_LIVE_TRANSCRIPTION_MESSAGE","UPDATE_LIVE_TRANSCRIPTION_MESSAGE","REDUCE_LIVE_TRANSCRIPTION_MESSAGES","SET_LIVE_TRANSCRIPTION_ENGINE_TYPE","REMOVE_LIVE_TRANSCRIPTION_FAILOVER_STATE","SET_LIVE_TRANSCRIPTION_LAST_CAPTION_MESSAGE","RESET_LIVE_TRANSCRIPTION"," SET_IS_HOST_DISABLE_CAPTIONS"),{setPollData:lln,setPollingId:uln,setPollingWebLinks:dln,setPollingDocMaxSize:hln,setPollingDocSize:fln,setPollingDocLibraryMaxSize:pln,setPollingDocLibrarySize:gln,resetPoll:ict}=Sa("SET_POLL_DATA","SET_POLLING_ID","SET_POLLING_WEB_LINKS","SET_POLLING_DOC_MAX_SIZE","SET_POLLING_DOC_SIZE","SET_POLLING_DOC_LIBRARY_MAX_SIZE","SET_POLLING_DOC_LIBRARY_SIZE","RESET_POLL"),{setLoggerInitOptions:Yte,setIsLaplaceInitialized:H6,resetLogger:NDe}=Sa("SET_LOGGER_INIT_OPTIONS","SET_IS_LAPLACE_INITIALIZED","RESET_LOGGER"),{setIsLiveStreamEnable:FDe,setLiveStreamStatus:U6,resetLiveStream:jDe}=Sa("SET_IS_LIVE_STREAM_ENABLE","SET_LIVE_STREAM_STATUS","RESET_LIVE_STREAM");var OK={exports:{}},lB={};(function(n,e){var t=function(se,ee){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(Y,ue){Y.__proto__=ue}||function(Y,ue){for(var ye in ue)ue.hasOwnProperty(ye)&&(Y[ye]=ue[ye])},t(se,ee)};function r(se,ee){function Y(){this.constructor=se}t(se,ee),se.prototype=ee===null?Object.create(ee):(Y.prototype=ee.prototype,new Y)}var i=function(){return i=Object.assign||function(se){for(var ee,Y=1,ue=arguments.length;Y<ue;Y++)for(var ye in ee=arguments[Y])Object.prototype.hasOwnProperty.call(ee,ye)&&(se[ye]=ee[ye]);return se},i.apply(this,arguments)},o,s=function(se,ee){var Y=new Uint8Array(se.byteLength+ee.byteLength);return Y.set(new Uint8Array(se),0),Y.set(new Uint8Array(ee),se.byteLength),Y.buffer},a="/";(o=n.TransformDataFormat||(n.TransformDataFormat={})).STRING="string",o.BLOB="blob",o.ARRAY_BUFFER="arraybuffer";var c=function(se){return Blob&&se instanceof Blob?"blob":ArrayBuffer&&se instanceof ArrayBuffer?"arrayBuffer":typeof se},l=[],u=function(){for(var se=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],ee="",Y=0;Y<32;Y++)ee+=se[Math.round(61*Math.random())];return l.indexOf(ee)!==-1?u():(l.push(ee),ee)},d=function(se){return se.arrayBuffer?se.arrayBuffer():new Promise(function(ee,Y){var ue=new FileReader;ue.readAsArrayBuffer(se),ue.onload=function(ye){ee(ye.target&&ye.target.result)},ue.onerror=function(ye){Y(ye)}})},h=function(se){return se.text?se.text():new Promise(function(ee,Y){var ue=new FileReader;ue.readAsText(se),ue.onload=function(ye){ee(ye.target&&ye.target.result)},ue.onerror=function(ye){Y(ye)}})},f=function(se,ee){return Promise.resolve(new Blob([new Uint8Array(se)],{type:ee}))},p=function(se,ee){var Y=new Blob([se],{type:ee||"text/plain"});return h(Y)},g=function(se,ee){return Promise.resolve(new Blob([se],{type:ee||"text/plain"}))},m=function(se,ee){return d(new Blob([se],{type:ee||"text/plain"}))};function v(se){var ee=(se||"").split(".");return ee[ee.length-1]||""}function b(se){var ee=(se||"").lastIndexOf(a);return ee<0?"":se.slice(0,ee)}function S(se){var ee=(se||"").lastIndexOf(a),Y=ee<0?se:se.slice(ee+1),ue=(Y||"").lastIndexOf(".");return ue<0?Y:Y.slice(0,ue)}function E(se){return["png","jpg","jpeg","svg"].includes(v(se))}function w(se){return v(se)==="json"}function C(se){return v(se)==="version"}function I(se,ee){return se.reduce(function(Y,ue){var ye,V=ue.data,le=ue.file,he=v(le.name),oe=b(le.name),ne=S(le.name),ce=((ee==null?void 0:ee.combineExtNames)||[]).includes(he)&&typeof V=="string",Ae=ce?""+(oe?""+oe+a+he:he):le.name;return ce&&Y.some(function(Ie){return Ie.path===Ae&&(Ie.data[ne]=V,!0)})||Y.push({path:Ae,extName:he,data:ce?(ye={},ye[ne]=V,ye):V,shouldCombine:ce}),Y},[]).map(function(Y){var ue=Y.data,ye=Y.shouldCombine,V=function(le,he){var oe={};for(var ne in le)Object.prototype.hasOwnProperty.call(le,ne)&&he.indexOf(ne)<0&&(oe[ne]=le[ne]);if(le!=null&&typeof Object.getOwnPropertySymbols=="function"){var ce=0;for(ne=Object.getOwnPropertySymbols(le);ce<ne.length;ce++)he.indexOf(ne[ce])<0&&Object.prototype.propertyIsEnumerable.call(le,ne[ce])&&(oe[ne[ce]]=le[ne[ce]])}return oe}(Y,["data","shouldCombine"]);return i(i({},V),{data:ye?JSON.stringify(ue):ue})})}function T(se,ee){return e.loadAsync(se).then(function(Y){return Promise.all(Y.filter(function(ue,ye){return!ye.dir}).map(function(ue){var ye=function(V){return w(V.name)?"string":E(V.name)?"base64":C(V.name)?"text":"blob"}(ue);return ee!=null&&ee.setUnZipFormat&&(ye=ee.setUnZipFormat(ue)||ye),ue.async(ye).then(function(V){var le=V,he=v(ue.name),oe=he==="svg"?"svg+xml":he;return ye==="base64"&&E(ue.name)&&!V.startsWith("data")&&(le="data:image/"+oe+";base64,"+le),{data:le,file:ue}})}))}).then(function(Y){return I(Y,ee)})}function D(se,ee){var Y=ee||{},ue=Y.encoding,ye=Y.blobType,V=Y.unZipOptions;if(function(be){return c(be)==="blob"&&(be.type.includes("compressed")||be.type.includes("zip"))}(se)&&!(V!=null&&V.disableUnZip))return T(se,V);if(!ue)return Promise.resolve(se);var le=c(se),he=le==="string",oe=le==="blob",ne=le==="arrayBuffer";if(ue===n.TransformDataFormat.BLOB){var ce=se;if(he)return h(ce);if(ne)return d(ce)}else if(ue===n.TransformDataFormat.ARRAY_BUFFER){var Ae=se;if(he)return p(Ae,ye);if(oe)return f(Ae,ye)}else if(ue===n.TransformDataFormat.STRING){var Ie=se;if(oe)return g(Ie,ye);if(ne)return m(Ie,ye)}return Promise.resolve(se)}function O(se){var ee=0,Y=!1,ue=function(){ee>90||Y||(se(ee+=(100-ee)/50),requestAnimationFrame(ue))};return ue(),{finish:function(){ee===100||Y||(ee=100,se(100))},abort:function(){ee===100||Y||(Y=!0)},get curProgress(){return ee}}}function M(){}function R(){R.init.call(this)}function A(se){return se._maxListeners===void 0?R.defaultMaxListeners:se._maxListeners}function k(se,ee,Y,ue){var ye,V,le;if(typeof Y!="function")throw new TypeError('"listener" argument must be a function');if((V=se._events)?(V.newListener&&(se.emit("newListener",ee,Y.listener?Y.listener:Y),V=se._events),le=V[ee]):(V=se._events=new M,se._eventsCount=0),le){if(typeof le=="function"?le=V[ee]=ue?[Y,le]:[le,Y]:ue?le.unshift(Y):le.push(Y),!le.warned&&(ye=A(se))&&ye>0&&le.length>ye){le.warned=!0;var he=new Error("Possible EventEmitter memory leak detected. "+le.length+" "+ee+" listeners added. Use emitter.setMaxListeners() to increase limit");he.name="MaxListenersExceededWarning",he.emitter=se,he.type=ee,he.count=le.length,function(oe){typeof console.warn=="function"?console.warn(oe):console.log(oe)}(he)}}else le=V[ee]=Y,++se._eventsCount;return se}function L(se,ee,Y){var ue=!1;function ye(){se.removeListener(ee,ye),ue||(ue=!0,Y.apply(se,arguments))}return ye.listener=Y,ye}function j(se){var ee=this._events;if(ee){var Y=ee[se];if(typeof Y=="function")return 1;if(Y)return Y.length}return 0}function N(se,ee){for(var Y=new Array(ee);ee--;)Y[ee]=se[ee];return Y}M.prototype=Object.create(null),R.EventEmitter=R,R.usingDomains=!1,R.prototype.domain=void 0,R.prototype._events=void 0,R.prototype._maxListeners=void 0,R.defaultMaxListeners=10,R.init=function(){this.domain=null,R.usingDomains&&(void 0).active,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new M,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},R.prototype.setMaxListeners=function(se){if(typeof se!="number"||se<0||isNaN(se))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=se,this},R.prototype.getMaxListeners=function(){return A(this)},R.prototype.emit=function(se){var ee,Y,ue,ye,V,le,he,oe=se==="error";if(le=this._events)oe=oe&&le.error==null;else if(!oe)return!1;if(he=this.domain,oe){if(ee=arguments[1],!he){if(ee instanceof Error)throw ee;var ne=new Error('Uncaught, unspecified "error" event. ('+ee+")");throw ne.context=ee,ne}return ee||(ee=new Error('Uncaught, unspecified "error" event')),ee.domainEmitter=this,ee.domain=he,ee.domainThrown=!1,he.emit("error",ee),!1}if(!(Y=le[se]))return!1;var ce=typeof Y=="function";switch(ue=arguments.length){case 1:(function(Ae,Ie,be){if(Ie)Ae.call(be);else for(var De=Ae.length,Me=N(Ae,De),He=0;He<De;++He)Me[He].call(be)})(Y,ce,this);break;case 2:(function(Ae,Ie,be,De){if(Ie)Ae.call(be,De);else for(var Me=Ae.length,He=N(Ae,Me),Je=0;Je<Me;++Je)He[Je].call(be,De)})(Y,ce,this,arguments[1]);break;case 3:(function(Ae,Ie,be,De,Me){if(Ie)Ae.call(be,De,Me);else for(var He=Ae.length,Je=N(Ae,He),qe=0;qe<He;++qe)Je[qe].call(be,De,Me)})(Y,ce,this,arguments[1],arguments[2]);break;case 4:(function(Ae,Ie,be,De,Me,He){if(Ie)Ae.call(be,De,Me,He);else for(var Je=Ae.length,qe=N(Ae,Je),Ge=0;Ge<Je;++Ge)qe[Ge].call(be,De,Me,He)})(Y,ce,this,arguments[1],arguments[2],arguments[3]);break;default:for(ye=new Array(ue-1),V=1;V<ue;V++)ye[V-1]=arguments[V];(function(Ae,Ie,be,De){if(Ie)Ae.apply(be,De);else for(var Me=Ae.length,He=N(Ae,Me),Je=0;Je<Me;++Je)He[Je].apply(be,De)})(Y,ce,this,ye)}return!0},R.prototype.addListener=function(se,ee){return k(this,se,ee,!1)},R.prototype.on=R.prototype.addListener,R.prototype.prependListener=function(se,ee){return k(this,se,ee,!0)},R.prototype.once=function(se,ee){if(typeof ee!="function")throw new TypeError('"listener" argument must be a function');return this.on(se,L(this,se,ee)),this},R.prototype.prependOnceListener=function(se,ee){if(typeof ee!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(se,L(this,se,ee)),this},R.prototype.removeListener=function(se,ee){var Y,ue,ye,V,le;if(typeof ee!="function")throw new TypeError('"listener" argument must be a function');if(!(ue=this._events))return this;if(!(Y=ue[se]))return this;if(Y===ee||Y.listener&&Y.listener===ee)--this._eventsCount==0?this._events=new M:(delete ue[se],ue.removeListener&&this.emit("removeListener",se,Y.listener||ee));else if(typeof Y!="function"){for(ye=-1,V=Y.length;V-- >0;)if(Y[V]===ee||Y[V].listener&&Y[V].listener===ee){le=Y[V].listener,ye=V;break}if(ye<0)return this;if(Y.length===1){if(Y[0]=void 0,--this._eventsCount==0)return this._events=new M,this;delete ue[se]}else(function(he,oe){for(var ne=oe,ce=ne+1,Ae=he.length;ce<Ae;ne+=1,ce+=1)he[ne]=he[ce];he.pop()})(Y,ye);ue.removeListener&&this.emit("removeListener",se,le||ee)}return this},R.prototype.removeAllListeners=function(se){var ee,Y;if(!(Y=this._events))return this;if(!Y.removeListener)return arguments.length===0?(this._events=new M,this._eventsCount=0):Y[se]&&(--this._eventsCount==0?this._events=new M:delete Y[se]),this;if(arguments.length===0){for(var ue,ye=Object.keys(Y),V=0;V<ye.length;++V)(ue=ye[V])!=="removeListener"&&this.removeAllListeners(ue);return this.removeAllListeners("removeListener"),this._events=new M,this._eventsCount=0,this}if(typeof(ee=Y[se])=="function")this.removeListener(se,ee);else if(ee)do this.removeListener(se,ee[ee.length-1]);while(ee[0]);return this},R.prototype.listeners=function(se){var ee,Y=this._events;return Y&&(ee=Y[se])?typeof ee=="function"?[ee.listener||ee]:function(ue){for(var ye=new Array(ue.length),V=0;V<ye.length;++V)ye[V]=ue[V].listener||ue[V];return ye}(ee):[]},R.listenerCount=function(se,ee){return typeof se.listenerCount=="function"?se.listenerCount(ee):j.call(se,ee)},R.prototype.listenerCount=j,R.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};var B=function(se){function ee(Y){var ue=se.call(this)||this;return ue.timeout=(Y==null?void 0:Y.timeout)||3e4,ue}return r(ee,se),ee.prototype.clearTimeoutCheck=function(){this.timeoutTimer&&(clearTimeout(this.timeoutTimer),this.timeoutTimer=null)},ee.prototype.startTimeoutCheck=function(){var Y=this;!this.timeoutTimer&&!this.finished&&this.timeout>0&&(this.timeoutTimer=setTimeout(function(){Y.finished||(Y.finished=!0,Y.data=null,Y.emit("timeout")),Y.clearTimeoutCheck()},this.timeout))},ee}(R),U=function(se){function ee(Y){var ue=se.call(this,Y)||this;return ue.uuid=u(),ue.domParams=Y||{},ue}return r(ee,se),ee.prototype.jsonp=function(){var Y=this;if(!this.finished){var ue=this.domParams,ye=ue.url,V=ue.jsonpCallbackName,le=V===void 0?"callback":V,he=ue.body,oe=ue.integrity;this.script=document.createElement("script"),oe&&(this.script.integrity=oe,this.script.crossOrigin="anonymous");var ne="";he&&Object.entries(he).forEach(function(ce){var Ae=ce[0],Ie=ce[1];ne+=(ne?"&":"")+Ae+"="+Ie}),ne+=(ne?"&":"")+le+"="+this.uuid,this.script.src=ye+(ye.includes("?")?"":"?")+ne,this.jsonpCallback(),this.progressMonitory=O(function(ce){Y.finished||Y.emit("progressUpdated",ce)}),document.body.appendChild(this.script)}},ee.prototype.clearSideEffect=function(Y){if(Y===void 0&&(Y=!1),document.body.removeChild(this.script),Y){var ue=this.uuid;window[this.uuid]=function(){window[ue]&&delete window[ue]}}else delete window[this.uuid];this.script=null,this.uuid=null,this.finished=!0,this.data=null,this.clearTimeoutCheck()},ee.prototype.jsonpCallback=function(){var Y=this;this.script.onerror=function(ue){var ye;Y.finished||(Y.clearSideEffect(),(ye=Y.progressMonitory)===null||ye===void 0||ye.abort(),Y.emit("error",new Error(typeof ue=="string"?ue:"load jsonp script failed")))},window[this.uuid]=function(ue){var ye;if(!Y.finished){var V=Y.domParams,le=V.encoding,he=V.blobType,oe=V.unZipOptions,ne=V.beforeTransformData,ce=V.afterTransformData;(ye=Y.progressMonitory)===null||ye===void 0||ye.finish(),Y.clearSideEffect(),(ne?ne(ue||""):Promise.resolve(ue||"")).then(function(Ae){return D(Ae,{encoding:le,blobType:he,unZipOptions:oe}).then(function(Ie){return(ce?ce(Ie):Promise.resolve(Ie)).then(function(be){return Y.emit("finished",be)})})}).catch(function(Ae){return Y.emit("error",Ae)})}}},ee.prototype.abort=function(){this.clearSideEffect(!0)},ee}(B),K=function(se){function ee(Y){var ue=se.call(this,Y)||this;return ue.socketParams=Y||{},ue}return r(ee,se),ee.prototype.write=function(Y,ue){Y&&!this.finished&&(Y instanceof Error?this.handleError(Y):(this.data?this.appendData(Y):this.data=Y,this.handlePerCentUpdate(ue)))},ee.prototype.handlePerCentUpdate=function(Y){Y===void 0||this.finished||this.emit("progressUpdated",Y)},ee.prototype.handleError=function(Y){this.data=null,this.finished=!0,this.clearTimeoutCheck(),this.emit("error",Y)},ee.prototype.appendData=function(Y){c(Y)===c(this.data)?typeof Y=="string"?this.data+=Y:Blob&&Y instanceof Blob?this.data=new Blob([this.data,Y],{type:Y.type}):ArrayBuffer&&Y instanceof ArrayBuffer&&(this.data=s(this.data,Y)):this.handleError(new Error("every piece of the data format must be the same"))},ee.prototype.end=function(Y){var ue=this;if(!this.finished){this.handlePerCentUpdate(100),Y&&this.write(Y);var ye=this.socketParams,V=ye.encoding,le=ye.blobType,he=ye.unZipOptions,oe=ye.beforeTransformData,ne=ye.afterTransformData;(oe?oe(this.data):Promise.resolve(this.data)).then(function(ce){return D(ce,{encoding:V,blobType:le,unZipOptions:he}).then(function(Ae){return(ne?ne(Ae):Promise.resolve(Ae)).then(function(Ie){return ue.emit("finished",Ie)})})}).catch(function(ce){return ue.emit("error",ce)}),this.data=null,this.finished=!0,this.clearTimeoutCheck()}},ee.prototype.abort=function(){this.data=null,this.finished=!0,this.clearTimeoutCheck()},ee}(B),z=function(se){function ee(Y){var ue=se.call(this,Y)||this;return ue.xhrParams=Y||{},ue.xhrParams.headers=i({},ue.xhrParams.headers||{}),ue}return r(ee,se),ee.prototype.supportFetch=function(){return!!window.fetch&&window.AbortController&&window.Request},ee.prototype.ajax=function(){var Y=this;if(!this.finished)if(this.xhrParams.url){var ue=this.xhrParams,ye=ue.headers,V=ye===void 0?{}:ye,le=ue.url,he=ue.body,oe=he===void 0?{}:he,ne=ue.method,ce=ne===void 0?"POST":ne,Ae=ue.encoding,Ie=ue.integrity;this.controller=this.supportFetch()?new AbortController:new XMLHttpRequest;var be=this.supportFetch()?O(function(De){Y.finished||Y.emit("progressUpdated",De)}):null;(this.supportFetch()?fetch(new Request(le,i({method:ce,headers:V,body:ce==="GET"?void 0:JSON.stringify(oe),signal:this.controller.signal},Ie?{integrity:Ie,mode:"cors"}:{}))).then(function(De){return De.ok?Ae===n.TransformDataFormat.STRING?De.text():Ae===n.TransformDataFormat.ARRAY_BUFFER?De.arrayBuffer():De.blob():Promise.reject(new Error("xhr download "+le+" failed!"))}):new Promise(function(De,Me){var He=new XMLHttpRequest;Y.controller=He,He.open(ce,le),He.responseType=Ae===n.TransformDataFormat.STRING?"text":Ae===n.TransformDataFormat.ARRAY_BUFFER?"arraybuffer":"blob",Object.entries(V).forEach(function(Je){var qe=Je[0],Ge=Je[1];He.setRequestHeader(qe,Ge)}),He.onload=function(){var Je=He.status,qe=He.response,Ge=He.statusText;Je>=200&&Je<300||Je===304?De(qe):Me(new Error(Je+": "+Ge))},He.onprogress=function(Je){var qe=Je||{},Ge=qe.total,St=qe.loaded;St===void 0||Y.finished||(Ge?Y.emit("progressUpdated",St/Ge*100):St&&!be&&(be=O(function(Pt){Y.finished||Y.emit("progressUpdated",Pt)})))},He.onerror=function(){Me(new Error("xhr download "+le+" failed!"))},He.send(JSON.stringify(oe))})).then(function(De){if(!Y.finished){var Me=Y.xhrParams,He=Me.encoding,Je=Me.blobType,qe=Me.unZipOptions,Ge=Me.beforeTransformData,St=Me.afterTransformData;be==null||be.finish(),Y.finished=!0,Y.clearTimeoutCheck(),(Ge?Ge(De):Promise.resolve(De)).then(function(Pt){return D(Pt,{encoding:He,blobType:Je,unZipOptions:qe}).then(function(on){return(St?St(on):Promise.resolve(on)).then(function(an){return Y.emit("finished",an)})})}).catch(function(Pt){return Y.emit("error",Pt)})}}).catch(function(De){Y.finished||(Y.finished=!0,Y.clearTimeoutCheck(),be==null||be.abort(),Y.emit("error",De))})}else this.emit("error",new Error("xhrDownloader url params invalid!"))},ee.prototype.abort=function(){this.data=null,this.finished=!0,this.clearTimeoutCheck(),this.controller.abort()},ee}(B),G=0;R.defaultMaxListeners=500;var te,ie=new R,Q="ThreadPoolReady",ge=function(){G-=1,ie.emit(Q)};(te=n.DownloaderType||(n.DownloaderType={})).XHR="xhr",te.DOM="dom",te.SOCKET="socket";var _e=function(se){function ee(Y){var ue=se.call(this)||this;return ue.aborted=!1,ue.downloadParmas=i({type:n.DownloaderType.XHR},Y),ue.id=u(),ue}return r(ee,se),ee.prototype.start=function(){var Y=this;G+=1,this.progress=0,this.emit("downloadStart"),this.onDownloadStartCallback&&this.onDownloadStartCallback();var ue=this.downloadParmas,ye=ue.type,V=ue.xhrParams,le=ue.domParams,he=ue.socketParams;switch(ye){case n.DownloaderType.DOM:this.downloader=new U(le),this.downloader.jsonp();break;case n.DownloaderType.SOCKET:this.downloader=new K(he);break;default:this.downloader=new z(V),this.downloader.ajax()}return this.downloader.startTimeoutCheck(),this.downloader.on("error",function(oe){Y.emit("error",oe),Y.onErrorCallback&&Y.onErrorCallback(oe),ge()}).on("finished",function(oe){Y.emit("complete",oe),Y.onCompleteCallback&&Y.onCompleteCallback(oe),ge()}).on("progressUpdated",function(oe){Y.progress=oe,Y.emit("progressUpdated",oe),Y.onProgressUpdatedCallback&&Y.onProgressUpdatedCallback(oe)}).on("timeout",function(){Y.emit("timeout"),Y.onTimeoutCallback&&Y.onTimeoutCallback(),ge()}),this},ee.prototype.abort=function(){if(this.aborted)return this;this.aborted=!0,this.downloader&&!this.downloader.finished&&this.downloader.abort();var Y=new Error("file download has been aborted");return this.emit("abort",Y),this.onAbortCallback&&this.onAbortCallback(Y),ge(),this},ee.prototype.onDownloadStart=function(Y){return this.onDownloadStartCallback=Y,this},ee.prototype.onProgressUpdated=function(Y){return this.onProgressUpdatedCallback=Y,this},ee.prototype.onError=function(Y){return this.onErrorCallback=Y,this},ee.prototype.onComplete=function(Y){return this.onCompleteCallback=Y,this},ee.prototype.onAbort=function(Y){return this.onAbortCallback=Y,this},ee.prototype.onTimeout=function(Y){return this.onTimeoutCallback=Y,this},ee.prototype.isInProgress=function(){return this.progress!==void 0},ee.prototype.isFinished=function(){return this.progress===100},ee}(R),Se=function(){function se(ee){this.taskList=[],this.options=ee||{};var Y=this.options.threadLimit;if((Y===void 0?6:Y)>6)throw new Error("threadLimit must be lower than 6");ie.on(Q,this.startNextTask.bind(this))}return se.prototype.download=function(ee){var Y=new _e(ee),ue=this.removeTask.bind(this,Y);return Y.on("abort",ue),this.taskList.push(Y),this.checkTaskReady(Y),Y},se.prototype.startNextTask=function(){var ee=this.taskList.find(function(Y){return!Y.isInProgress()});ee&&this.checkTaskReady(ee)},se.prototype.checkTaskReady=function(ee){var Y=this.options.threadLimit,ue=Y===void 0?6:Y;if(!(this.taskList.findIndex(function(V){return!V.isInProgress()})>=ue||G+1>6)){var ye=this.removeTask.bind(this,ee);ee.on("complete",ye),ee.on("error",ye),ee.on("timeout",ye),setTimeout(function(){return ee.start()},0)}},se.prototype.removeTask=function(ee){var Y=this;this.taskList.some(function(ue,ye){return ue===ee&&(setTimeout(function(){return ee.removeAllListeners()},0),Y.taskList.splice(ye,1),!0)})},se}();n.DownloadTask=_e,n.IDownloadManager=Se,n.appendBuffer=s,n.arrayBufferToBlob=f,n.arrayBufferToString=p,n.blobToArrayBuffer=d,n.blobToText=h,n.genUuid=u,n.getDataFormat=c,n.getExtName=v,n.getFileName=S,n.getFullPathName=b,n.isImgFile=E,n.isJsonFile=w,n.isVersionFile=C,n.monitorProgress=O,n.sep=a,n.stringToArrayBuffer=m,n.stringToBlob=g,n.transformData=D,Object.defineProperty(n,"__esModule",{value:!0})})(lB,XIe(Object.freeze({__proto__:null,default:{}}))),Vue(lB),function(n,e){var t=function(O,M){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(R,A){R.__proto__=A}||function(R,A){for(var k in A)A.hasOwnProperty(k)&&(R[k]=A[k])},t(O,M)};function r(O,M){function R(){this.constructor=O}t(O,M),O.prototype=M===null?Object.create(M):(R.prototype=M.prototype,new R)}var i=function(){return i=Object.assign||function(O){for(var M,R=1,A=arguments.length;R<A;R++)for(var k in M=arguments[R])Object.prototype.hasOwnProperty.call(M,k)&&(O[k]=M[k]);return O},i.apply(this,arguments)};function o(){}function s(){s.init.call(this)}function a(O){return O._maxListeners===void 0?s.defaultMaxListeners:O._maxListeners}function c(O,M,R,A){var k,L,j;if(typeof R!="function")throw new TypeError('"listener" argument must be a function');if((L=O._events)?(L.newListener&&(O.emit("newListener",M,R.listener?R.listener:R),L=O._events),j=L[M]):(L=O._events=new o,O._eventsCount=0),j){if(typeof j=="function"?j=L[M]=A?[R,j]:[j,R]:A?j.unshift(R):j.push(R),!j.warned&&(k=a(O))&&k>0&&j.length>k){j.warned=!0;var N=new Error("Possible EventEmitter memory leak detected. "+j.length+" "+M+" listeners added. Use emitter.setMaxListeners() to increase limit");N.name="MaxListenersExceededWarning",N.emitter=O,N.type=M,N.count=j.length,function(B){typeof console.warn=="function"?console.warn(B):console.log(B)}(N)}}else j=L[M]=R,++O._eventsCount;return O}function l(O,M,R){var A=!1;function k(){O.removeListener(M,k),A||(A=!0,R.apply(O,arguments))}return k.listener=R,k}function u(O){var M=this._events;if(M){var R=M[O];if(typeof R=="function")return 1;if(R)return R.length}return 0}function d(O,M){for(var R=new Array(M);M--;)R[M]=O[M];return R}o.prototype=Object.create(null),s.EventEmitter=s,s.usingDomains=!1,s.prototype.domain=void 0,s.prototype._events=void 0,s.prototype._maxListeners=void 0,s.defaultMaxListeners=10,s.init=function(){this.domain=null,s.usingDomains&&(void 0).active,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new o,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(O){if(typeof O!="number"||O<0||isNaN(O))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=O,this},s.prototype.getMaxListeners=function(){return a(this)},s.prototype.emit=function(O){var M,R,A,k,L,j,N,B=O==="error";if(j=this._events)B=B&&j.error==null;else if(!B)return!1;if(N=this.domain,B){if(M=arguments[1],!N){if(M instanceof Error)throw M;var U=new Error('Uncaught, unspecified "error" event. ('+M+")");throw U.context=M,U}return M||(M=new Error('Uncaught, unspecified "error" event')),M.domainEmitter=this,M.domain=N,M.domainThrown=!1,N.emit("error",M),!1}if(!(R=j[O]))return!1;var K=typeof R=="function";switch(A=arguments.length){case 1:(function(z,G,te){if(G)z.call(te);else for(var ie=z.length,Q=d(z,ie),ge=0;ge<ie;++ge)Q[ge].call(te)})(R,K,this);break;case 2:(function(z,G,te,ie){if(G)z.call(te,ie);else for(var Q=z.length,ge=d(z,Q),_e=0;_e<Q;++_e)ge[_e].call(te,ie)})(R,K,this,arguments[1]);break;case 3:(function(z,G,te,ie,Q){if(G)z.call(te,ie,Q);else for(var ge=z.length,_e=d(z,ge),Se=0;Se<ge;++Se)_e[Se].call(te,ie,Q)})(R,K,this,arguments[1],arguments[2]);break;case 4:(function(z,G,te,ie,Q,ge){if(G)z.call(te,ie,Q,ge);else for(var _e=z.length,Se=d(z,_e),se=0;se<_e;++se)Se[se].call(te,ie,Q,ge)})(R,K,this,arguments[1],arguments[2],arguments[3]);break;default:for(k=new Array(A-1),L=1;L<A;L++)k[L-1]=arguments[L];(function(z,G,te,ie){if(G)z.apply(te,ie);else for(var Q=z.length,ge=d(z,Q),_e=0;_e<Q;++_e)ge[_e].apply(te,ie)})(R,K,this,k)}return!0},s.prototype.addListener=function(O,M){return c(this,O,M,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(O,M){return c(this,O,M,!0)},s.prototype.once=function(O,M){if(typeof M!="function")throw new TypeError('"listener" argument must be a function');return this.on(O,l(this,O,M)),this},s.prototype.prependOnceListener=function(O,M){if(typeof M!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(O,l(this,O,M)),this},s.prototype.removeListener=function(O,M){var R,A,k,L,j;if(typeof M!="function")throw new TypeError('"listener" argument must be a function');if(!(A=this._events))return this;if(!(R=A[O]))return this;if(R===M||R.listener&&R.listener===M)--this._eventsCount==0?this._events=new o:(delete A[O],A.removeListener&&this.emit("removeListener",O,R.listener||M));else if(typeof R!="function"){for(k=-1,L=R.length;L-- >0;)if(R[L]===M||R[L].listener&&R[L].listener===M){j=R[L].listener,k=L;break}if(k<0)return this;if(R.length===1){if(R[0]=void 0,--this._eventsCount==0)return this._events=new o,this;delete A[O]}else(function(N,B){for(var U=B,K=U+1,z=N.length;K<z;U+=1,K+=1)N[U]=N[K];N.pop()})(R,k);A.removeListener&&this.emit("removeListener",O,j||M)}return this},s.prototype.removeAllListeners=function(O){var M,R;if(!(R=this._events))return this;if(!R.removeListener)return arguments.length===0?(this._events=new o,this._eventsCount=0):R[O]&&(--this._eventsCount==0?this._events=new o:delete R[O]),this;if(arguments.length===0){for(var A,k=Object.keys(R),L=0;L<k.length;++L)(A=k[L])!=="removeListener"&&this.removeAllListeners(A);return this.removeAllListeners("removeListener"),this._events=new o,this._eventsCount=0,this}if(typeof(M=R[O])=="function")this.removeListener(O,M);else if(M)do this.removeListener(O,M[M.length-1]);while(M[0]);return this},s.prototype.listeners=function(O){var M,R=this._events;return R&&(M=R[O])?typeof M=="function"?[M.listener||M]:function(A){for(var k=new Array(A.length),L=0;L<k.length;++L)k[L]=A[L].listener||A[L];return k}(M):[]},s.listenerCount=function(O,M){return typeof O.listenerCount=="function"?O.listenerCount(M):u.call(O,M)},s.prototype.listenerCount=u,s.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};var h="ZipInfo:";function f(O){var M;return(M=O==null?void 0:O.path)===null||M===void 0?void 0:M.startsWith(h)}function p(O){return typeof O=="string"&&O.startsWith(h)}function g(O,M){return(Array.isArray(O)?O:[O]).some(function(R){if(typeof R.version!="number")throw new Error("file version must be an int number");return R.version<M})}function m(O,M){return O.reduce(function(R,A){return R.then(function(k){return M(k,A)}).catch(function(){return M(void 0,A)})},Promise.resolve(void 0))}var v,b=function(O){function M(){return O!==null&&O.apply(this,arguments)||this}return r(M,O),M}(s),S="resource",E=function(O){function M(R){var A=O.call(this)||this;if(A.ready=!1,A.openError=!1,A.isEnable()){var k=R||{},L=k.nameSpaceId,j=k.indexDbVersion;A.dbName=function(B){return"resource-manager"+(B?"-"+B:"")}(L);var N=indexedDB.open(A.dbName,j||1);N.addEventListener("error",function(){A.openError=!0,A.checkReady(),A.emit("error",new Error("failed to open indexedDB"))}),N.addEventListener("success",function(){A.db=N.result,A.checkReady()}),N.addEventListener("upgradeneeded",function(){A.db=N.result,A.handleSuccess()}),setTimeout(function(){A.checkReady()},5e3)}else A.checkReady();return A}return r(M,O),M.prototype.checkReady=function(){this.ready||(this.ready=!0,this.emit("ready"))},M.prototype.handleSuccess=function(){if(!this.db.objectStoreNames||this.db.objectStoreNames.length===0||!this.db.objectStoreNames.contains(S)){var R=this.db.createObjectStore(S,{keyPath:"path",autoIncrement:!1});R.createIndex("path","path"),R.createIndex("sourceURL","sourceURL",{unique:!1})}},M.prototype.createAction=function(R){var A=this.db.transaction([S],R||"readonly");return{trans:A,store:A.objectStore(S)}},M.prototype.handleAction=function(R,A){return new Promise(function(k,L){var j=A();R.addEventListener("complete",function(){k(j.result)}),R.addEventListener("error",function(){L(R.error||new Error("transaction error"))}),R.addEventListener("abort",function(){L(R.error||new Error("transaction aborted"))})})},M.prototype.put=function(){for(var R=[],A=0;A<arguments.length;A++)R[A]=arguments[A];var k=this.createAction("readwrite"),L=k.trans,j=k.store;return this.handleAction(L,function(){return j.put.apply(j,R)})},M.prototype.getAllKeysFromIndex=function(R){for(var A=[],k=1;k<arguments.length;k++)A[k-1]=arguments[k];if(IDBObjectStore.prototype.getAllKeys){var L=this.createAction(),j=L.trans,N=L.store;return this.handleAction(j,function(){var B;return(B=N.index(R)).getAllKeys.apply(B,A)})}return this.openKeyCursor(R)},M.prototype.getAllFromIndex=function(R){for(var A=[],k=1;k<arguments.length;k++)A[k-1]=arguments[k];var L=this.createAction(),j=L.trans,N=L.store;return IDBObjectStore.prototype.getAll?this.handleAction(j,function(){var B;return(B=N.index(R)).getAll.apply(B,A)}):this.openCursor(R)},M.prototype.getFromIndex=function(R){for(var A=[],k=1;k<arguments.length;k++)A[k-1]=arguments[k];var L=this.createAction(),j=L.trans,N=L.store;return this.handleAction(j,function(){var B;return(B=N.index(R)).get.apply(B,A)})},M.prototype.deleteKey=function(){for(var R=[],A=0;A<arguments.length;A++)R[A]=arguments[A];var k=this.createAction("readwrite"),L=k.trans,j=k.store;return this.handleAction(L,function(){return j.delete.apply(j,R)})},M.prototype.handleCursorAction=function(R,A,k,L){return new Promise(function(j,N){A.addEventListener("success",function(){A.result?(k(L,A.result),A.result.continue()):j(L)}),A.addEventListener("error",function(){N(R.error||new Error("transaction error"))})})},M.prototype.openKeyCursor=function(R){for(var A,k=[],L=1;L<arguments.length;L++)k[L-1]=arguments[L];var j=this.createAction("readwrite"),N=j.trans,B=j.store;return this.handleCursorAction(N,(A=B.index(R)).openKeyCursor.apply(A,k),function(U,K){return U.push(K.key),U},[])},M.prototype.openCursor=function(R){for(var A,k=[],L=1;L<arguments.length;L++)k[L-1]=arguments[L];var j=this.createAction("readwrite"),N=j.trans,B=j.store;return this.handleCursorAction(N,(A=B.index(R)).openCursor.apply(A,k),function(U,K){return U.push(K.value),U},[])},M.prototype.isEnable=function(){return!!window.indexedDB&&!this.openError},M.prototype.saveFile=function(R){return this.db?this.put(R).then(function(){return!0}):Promise.resolve(!1)},M.prototype.removeFile=function(R){var A=this;return this.db?typeof R=="string"?this.getAllKeysFromIndex("path").then(function(k){var L=(k||[]).filter(function(j){return j===R||j.startsWith(""+R+e.sep)});return Promise.all(L.map(function(j){return A.deleteKey(j)}))}).then(function(){return!0}):this.deleteKey(R.path).then(function(){return!0}):Promise.resolve(!1)},M.prototype.clear=function(){if(!this.db)return Promise.resolve(!1);var R=this.createAction("readwrite"),A=R.trans,k=R.store;return this.handleAction(A,function(){return k.clear()}).then(function(){return!0})},M.prototype.findFileByPath=function(R){return this.db&&R?this.getFromIndex("path",R):Promise.resolve(void 0)},M.prototype.findFileBySourceURL=function(R){return this.db&&R?this.getAllFromIndex("sourceURL",R):Promise.resolve([])},M.prototype.isDirectory=function(R){var A=this;return this.db?new Promise(function(k){p(R)?k(!1):A.getAllKeysFromIndex("path").then(function(L){return(L||[]).some(function(j){return j.startsWith(""+R+e.sep)})}).then(k).catch(function(){return k(!1)})}):Promise.resolve(!1)},M.prototype.ls=function(R){var A=this;return this.db?this.getAllKeysFromIndex("path").then(function(k){var L=[];return Promise.all((k||[]).map(function(j){if(p(j))return Promise.resolve(void 0);if(R){if(j.startsWith(""+R+e.sep)){var N=j.split(""+R+e.sep)[1]||"";if(N.includes(e.sep)){var B=""+R+e.sep+N.split(e.sep)[0];return B&&!L.includes(B)?(L.push(B),Promise.resolve(B)):Promise.resolve(void 0)}return A.getFromIndex("path",j)}return Promise.resolve(void 0)}if(j.includes(e.sep)){var U=j.split(e.sep)[0]||"";return U&&!L.includes(U)?(L.push(U),Promise.resolve(U)):Promise.resolve(void 0)}return A.getFromIndex("path",j)})).then(function(j){return j.filter(function(N){return!!N})})}):Promise.resolve([])},M}(b),w=function(O){function M(){var R=O!==null&&O.apply(this,arguments)||this;return R.memoryFiles=[],R}return r(M,O),M.prototype.isEnable=function(){return!0},M.prototype.saveFile=function(R){var A=this;return new Promise(function(k){A.memoryFiles.some(function(L,j){return L.path===R.path&&(A.memoryFiles.splice(j,1,R),!0)})||A.memoryFiles.push(R),k(!0)})},M.prototype.removeFile=function(R){var A=this;return new Promise(function(k){for(var L=A.memoryFiles.length-1;L>=0;L--){var j=A.memoryFiles[L];(typeof R=="string"&&(j.path===R||j.path.startsWith(""+R+e.sep))||R.path===j.path)&&A.memoryFiles.splice(L,1)}k(!0)})},M.prototype.clear=function(){var R=this;return new Promise(function(A){R.memoryFiles=[],A(!0)})},M.prototype.findFileByPath=function(R){var A=this;return new Promise(function(k){k(A.memoryFiles.filter(function(L){return L.path===R})[0])})},M.prototype.findFileBySourceURL=function(R){var A=this;return new Promise(function(k){k(A.memoryFiles.filter(function(L){return L.sourceURL===R}))})},M.prototype.isDirectory=function(R){var A=this;return new Promise(function(k){p(R)?k(!1):k(A.memoryFiles.some(function(L){return L.path.startsWith(""+R+e.sep)}))})},M.prototype.ls=function(R){var A=this;return new Promise(function(k){var L=[];A.memoryFiles.forEach(function(j){if(!f(j))if(R){if(j.path.startsWith(""+R+e.sep)){var N=j.path.split(""+R+e.sep)[1]||"";if(N.includes(e.sep)){var B=""+R+e.sep+N.split(e.sep)[0];return void(B&&!L.includes(B)&&L.push(B))}L.push(j)}}else if(j.path.includes(e.sep)){var U=j.path.split(e.sep)[0]||"";U&&!L.includes(U)&&L.push(U)}else L.push(j)}),k(L)})},M}(b),C=function(O){function M(R){var A=O.call(this)||this;if(A.isLocalAvaliable=void 0,A.isEnable()){var k=(R||{}).nameSpaceId;A.storageName=function(L){return"resource-manager"+(L?"-"+L:"")}(k)}return A}return r(M,O),M.prototype.isEnable=function(){if(this.isLocalAvaliable!==void 0)return this.isLocalAvaliable;try{this.isLocalAvaliable=!0,localStorage.setItem("privateTest","")}catch{this.isLocalAvaliable=!1}return this.isLocalAvaliable},M.prototype.saveFile=function(R){var A=this;return this.isEnable()?new Promise(function(k){var L=A.getLocalFile();L.some(function(j,N){return j.path===R.path&&(L.splice(N,1,R),!0)})||L.push(R),localStorage.setItem(A.storageName,JSON.stringify(L)),k(!0)}):Promise.resolve(!1)},M.prototype.getLocalFile=function(){var R=localStorage.getItem(this.storageName),A=[];if(R)try{A=JSON.parse(R)||"[]"}catch(k){console.log(k)}return A},M.prototype.removeFile=function(R){var A=this;return this.isEnable()?new Promise(function(k){for(var L=A.getLocalFile(),j=L.length-1;j>=0;j--){var N=L[j];(typeof R=="string"&&(N.path===R||N.path.startsWith(""+R+e.sep))||R.path===N.path)&&L.splice(j,1)}localStorage.setItem(A.storageName,JSON.stringify(L)),k(!0)}):Promise.resolve(!1)},M.prototype.clear=function(){var R=this;return this.isEnable()?new Promise(function(A){localStorage.removeItem(R.storageName),A(!0)}):Promise.resolve(!1)},M.prototype.findFileByPath=function(R){var A=this;return this.isEnable()?new Promise(function(k){k(A.getLocalFile().filter(function(L){return L.path===R})[0])}):Promise.resolve(void 0)},M.prototype.findFileBySourceURL=function(R){var A=this;return this.isEnable()?new Promise(function(k){k(A.getLocalFile().filter(function(L){return L.sourceURL===R}))}):Promise.resolve([])},M.prototype.isDirectory=function(R){var A=this;return this.isEnable()?new Promise(function(k){p(R)?k(!1):k(A.getLocalFile().some(function(L){return L.path.startsWith(""+R+e.sep)}))}):Promise.resolve(!1)},M.prototype.ls=function(R){var A=this;return this.isEnable()?new Promise(function(k){var L=[];A.getLocalFile().forEach(function(j){if(!f(j))if(R){if(j.path.startsWith(""+R+e.sep)){var N=j.path.split(""+R+e.sep)[1]||"";if(N.includes(e.sep)){var B=""+R+e.sep+N.split(e.sep)[0];return void(B&&!L.includes(B)&&L.push(B))}L.push(j)}}else if(j.path.includes(e.sep)){var U=j.path.split(e.sep)[0]||"";U&&!L.includes(U)&&L.push(U)}else L.push(j)}),k(L)}):Promise.resolve([])},M}(b);(v=n.FileStoreEnum||(n.FileStoreEnum={})).MEMORY="memoryStore",v.INDEX_DB="indexedDBStore",v.STORAGE="storageStore";var I=function(O){function M(R){var A=O.call(this)||this;return A.indexedDBStore=new E(R),A.memoryStore=new w,A.storageStore=new C(R),A}return r(M,O),M.prototype.saveFile=function(R,A,k){var L=this;A===void 0&&(A=!0);var j=(k||{}).forceSpecifyStore;return(A?this.findFileByPath(R.path,k):Promise.resolve(void 0)).then(function(N){if(N!=null&&N.version&&g(R,N.version))throw new Error("there is an higher version file existed already");var B=i(i({},R),{createTime:N&&N.createTime||Date.now(),updateTime:Date.now()});return j&&L[j]&&L[j].isEnable()&&(j!==n.FileStoreEnum.STORAGE||L.isLocalStorageAvaliable(B))?L[j].saveFile(B):L[L.saveToTargetStoreRule(B)].saveFile(B)})},M.prototype.isLocalStorageAvaliable=function(R){var A=R.data;return e.getDataFormat(A)==="string"&&A.length<=102400&&this.storageStore.isEnable()},M.prototype.saveToTargetStoreRule=function(R){return this.indexedDBStore.isEnable()?n.FileStoreEnum.INDEX_DB:this.isLocalStorageAvaliable(R)?n.FileStoreEnum.STORAGE:n.FileStoreEnum.MEMORY},M.prototype.removeFile=function(R,A){var k=(A||{}).forceSpecifyStore;return k&&this[k]?this[k].removeFile(R):Promise.all([this.indexedDBStore.removeFile(R),this.storageStore.removeFile(R),this.memoryStore.removeFile(R)]).then(function(){return!0})},M.prototype.clear=function(R){var A=(R||{}).forceSpecifyStore;return A&&this[A]?this[A].clear():Promise.all([this.indexedDBStore.clear(),this.storageStore.clear(),this.memoryStore.clear()]).then(function(){return!0})},M.prototype.findFileByPath=function(R,A){var k=this,L=(A||{}).forceSpecifyStore;return L&&this[L]?this[L].findFileByPath(R):m(this.searchInTargetStoreRule(),function(j,N){return j?Promise.resolve(j):k[N].findFileByPath(R)})},M.prototype.findFileBySourceURL=function(R,A){var k=this,L=(A||{}).forceSpecifyStore;return L&&this[L]?this[L].findFileBySourceURL(R):m(this.searchInTargetStoreRule(),function(j,N){return k[N].findFileBySourceURL(R).then(function(B){return j?j.filter(function(U){return!B.some(function(K){return K.path===U.path})}).concat(B||[]):B||[]})})},M.prototype.searchInTargetStoreRule=function(){return[n.FileStoreEnum.INDEX_DB,n.FileStoreEnum.STORAGE,n.FileStoreEnum.MEMORY]},M.prototype.isDirectory=function(R){var A=this;return R?m(this.searchInTargetStoreRule(),function(k,L){return k?Promise.resolve(!0):A[L].isDirectory(R)}):Promise.resolve(!0)},M.prototype.ls=function(R){var A=this;return this.isDirectory(R).then(function(k){if(!k)throw new Error("path: "+R+" is an invalid directory path");return m(A.searchInTargetStoreRule(),function(L,j){return A[j].ls(R).then(function(N){return L?(N||[]).concat(L.filter(function(B){return!N.some(function(U){return typeof B=="string"?U===B:typeof U!="string"&&U.path===B.path})})):N})})})},M}(s),T=function(O){function M(){return O!==null&&O.apply(this,arguments)||this}return r(M,O),M}(s),D=function(O){function M(R){var A=O.call(this)||this,k=R||{},L=k.storeOptions,j=k.downloadManagerOptions;return A.downloadManager=new e.IDownloadManager(j),A.store=new I(L),A.store.indexedDBStore.on("ready",function(){return A.emit("ready")}),A}return r(M,O),M.prototype.getFile=function(R,A,k){var L=this,j=new T,N=Promise.resolve(void 0),B=A||{},U=B.downloadOptions,K=B.forceDownload,z=B.saveRootPath;K?N=Promise.resolve(void 0):typeof R=="string"?N=this.store.findFileByPath(R,k):R!=null&&R.sourceURL?N=this.store.findFileBySourceURL(R.sourceURL):U&&(U.domParams||U.socketParams||U.xhrParams)&&(N=this.store.findFileBySourceURL(this.genSourceURL(U)));var G=null,te=new Promise(function(ie){G=ie});return j.getDownloadTask=function(){return te},N=N.then(function(ie){if(ie&&(!Array.isArray(ie)||ie.length)){var Q=ie;if(Array.isArray(Q)){var ge=Q.find(function(Se){return f(Se)});if(!ge)return;Q=Q.filter(function(Se){return!f(Se)});var _e=ge.data;if(typeof _e!="string"||!JSON.parse(_e||"[]").every(function(Se){return Q.some(function(se){return se.path===Se})}))return}if(!(k!=null&&k.targetVersion)||!g(Q,k.targetVersion))return j.emit("checkExpire",!1),Q;j.emit("checkExpire",!0)}}).then(function(ie){if(!ie&&U){var Q=L.downloadManager.download(U);return G(Q),new Promise(function(ge,_e){Q.on("complete",function(Se){setTimeout(function(){var se=Array.isArray(Se)?Se.map(function(Y){var ue=Y.data,ye=Y.path,V=Y.extName;return{path:L.genFilePath(z,ye),sourceURL:L.genSourceURL(U),data:ue,fileFormat:V||L.getFileFormat(U),version:(k==null?void 0:k.targetVersion)||1}}):{path:L.genFilePath(z,void 0),sourceURL:L.genSourceURL(U),data:Se,fileFormat:L.getFileFormat(U),version:(k==null?void 0:k.targetVersion)||1};if(Array.isArray(se)&&typeof R=="string"&&R){var ee=se.find(function(Y){return Y.path===R});ge(ee||se)}else ge(se);j.emit("beforeSet",se),L.beforeWrite(se,k).then(function(){j.emit("afterSet")}).catch(function(Y){return j.emit("afterSet",Y)})},0)}),Q.on("abort",_e),Q.on("error",_e),Q.on("timeout",function(){return _e(new Error("download timeout"))})})}return G(void 0),ie}).catch(function(ie){return G(void 0),Promise.reject(ie)}),j.getResult=function(){return N},j},M.prototype.genSourceURL=function(R){var A=R.domParams,k=R.type,L=R.xhrParams;if(k===e.DownloaderType.SOCKET)return null;var j=(k===e.DownloaderType.DOM?A:L)||{},N=j.url,B=N===void 0?"":N,U=j.body;return U&&Object.keys(U).length?B+(B.includes("?")?"&":"?")+"downloadBodyParams="+JSON.stringify(U):B},M.prototype.updateFile=function(R,A){return this.saveStore(R,!0,A)},M.prototype.beforeWrite=function(R,A){var k=this;return Array.isArray(R)?Promise.all(R.concat(function(L){var j=L[0].sourceURL||"";return{path:""+h+j,sourceURL:j,data:JSON.stringify(L.map(function(N){return N.path}))}}(R)).map(function(L){return k.saveStore(L,!1,A)})).then(function(L){return L.filter(function(j){return!f(j)})}):this.saveStore(R,!0,A)},M.prototype.getFileFormat=function(R){var A=R||{},k=A.xhrParams,L=A.domParams,j=A.socketParams,N=A.type;return N===e.DownloaderType.DOM&&(L!=null&&L.fileFormat)?L.fileFormat:N===e.DownloaderType.SOCKET&&(j!=null&&j.fileFormat)?j.fileFormat:k!=null&&k.fileFormat?k.fileFormat:"unknow"},M.prototype.genFilePath=function(R,A){return A?""+(R||"")+(R?e.sep:"")+A:R||""},M.prototype.saveStore=function(R,A,k){return A===void 0&&(A=!0),this.store.saveFile(R,A,k).then(function(L){if(L)return R;throw new Error("fail to save file in local store")})},M.prototype.remove=function(R,A){return this.store.removeFile(R,A)},M.prototype.clear=function(R){return this.store.clear(R)},M.prototype.list=function(R){return this.store.ls(R)},M.prototype.updateVersion=function(R,A){var k=this;return this.store.findFileByPath(R).then(function(L){if(L)return k.saveStore(i(i({},L),{version:A})).then(function(){});throw new Error("the target path: "+R+" isn't existed")})},M.prototype.updateSourceURL=function(R,A){var k=this;return this.store.findFileByPath(R).then(function(L){if(L)return k.saveStore(i(i({},L),{sourceURL:A})).then(function(){});throw new Error("the target path: "+R+" isn't existed")})},M}(s);n.IResourceManager=D,Object.defineProperty(n,"__esModule",{value:!0})}(OK.exports,lB),Vue(OK.exports);class BDe{constructor(e){this._cancelError=new Error("request for lock canceled"),this._locked=void 0,this._queue=[],this._waiters=[],this._currentReleaser=void 0,e&&(this._cancelError=e),this._locked=!1}acquire(){const e=this.isLocked(),t=new Promise((r,i)=>this._queue.push({resolve:r,reject:i}));return e||this._dispatch(),t}async runExclusive(e){const t=await this.acquire();try{return await e()}finally{t()}}async waitForUnlock(){return this.isLocked()?new Promise(e=>this._waiters.push({resolve:e})):Promise.resolve()}isLocked(){return this._locked}release(){if(this._currentReleaser){const e=this._currentReleaser;this._currentReleaser=void 0,e()}}cancel(){this._queue.forEach(e=>e.reject(this._cancelError)),this._queue=[]}_dispatch(){const e=this._queue.shift();if(!e)return;let t=!1;this._currentReleaser=()=>{t||(t=!0,this._locked=!1,this._resolveWaiters(),this._dispatch())},this._locked=!0,e.resolve(this._currentReleaser)}_resolveWaiters(){this._waiters.forEach(e=>e.resolve()),this._waiters=[]}}function Jte(n,e,t){const r=document.createElement("script");r.type="text/javascript",r.readyState?r.onreadystatechange=()=>{r.readyState!=="loaded"&&r.readyState!=="complete"||(r.onreadystatechange=null,e())}:(r.onload=()=>{e()},r.onerror=()=>{t()}),r.src=n,window.crossOriginIsolated&&(r.crossOrigin="anonymous"),typeof document.body.append=="function"?document.getElementsByTagName("head")[0].append(r):document.getElementsByTagName("head")[0].appendChild(r)}function HDe(n,e){let t=n;/^https?:\/\//.test(t)||(t=`https://${n}`);try{const r=new URL(t);if(!e)return r.href;if(e.hostname)return r.hostname;if(e.path)return r.pathname}catch{return""}return""}function r3(n){if(n){var e;const t=document.getElementById(n);t==null||(e=t.parentNode)===null||e===void 0||e.removeChild(t)}}let i3="zoom.us";const C7="3.8.5",U4=`https://dmogdx0jrul3u.cloudfront.net/${C7}/lib/av`,a1=`https://source.zoom.us/${C7}/lib/av`,z4=`https://jssdk.zoomus.cn/${C7}/lib/av`,UDe=()=>i3,Tc=(n,e,t)=>f7([e,t].map((r,i)=>{if(r!=="initial")return Tt([r==="success"]);{const o=i===0?"ENCODE":"DECODE";return Ad(Mi(`${n.toUpperCase()}_${o}_SUCCESS`,1).pipe(Vt(()=>!0)),Mi(`${n.toUpperCase()}_${o}_FAIL`,1).pipe(Vt(()=>!1)))}})),AS=n=>{const e=mn(n.value);return e?hi(e):Mi(nD,1).pipe(bl(QT),nn(n),Vt(t=>{let[,r]=t;return mn(r)}))};function Dde(n,e){var t,r;const i=n==="audio"?(t=e.audio)===null||t===void 0?void 0:t.audioSsrc:(r=e.video)===null||r===void 0?void 0:r.videoSsrc,o=n==="audio"?zke:Tke;return n==="audio"&&ra()||i?Promise.resolve():Un(o)}const z6=()=>Tt(navigator.mediaDevices.enumerateDevices()).pipe(Vt(n=>{const e=[],t=[],r=[];return n.forEach(i=>{const{kind:o,deviceId:s,label:a}=i,c=a.replace(/\([\w,\d]+:[\w,\d]+\)/i,"").trim();switch(o){case"audioinput":s==="communications"||/ZoomAudioDevice/i.test(c)||/Zoom-\S*/.test(c)||/CubebAggregateDevice\S*/.test(c)||/Microsoft Teams Audio/i.test(c)||e.push({deviceId:s,label:c});break;case"audiooutput":s==="communications"||/ZoomAudioDevice/i.test(c)||/Microsoft Teams Audio/i.test(c)||t.push({deviceId:s,label:c});break;case"videoinput":r.push({deviceId:s,label:c})}}),{microphones:e,speakers:t,cameras:r}}));function MK(n){const{x:e,y:t,width:r,height:i}=n.getBoundingClientRect();return{scaleWidth:r,scaleHeight:i,srcOffsetX:e,srcOffsetY:t}}function V4(n){if(n){let t=n;try{const r=n.width;n.width=r}catch{var e;t=n.cloneNode(!0),(e=n.parentNode)===null||e===void 0||e.replaceChild(t,n)}return t}return n}function $K(){try{return typeof MessageChannel<"u"&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(Rat)}catch{return!1}}function l5(){var n;return(n=WebAssembly)===null||n===void 0?void 0:n.validate(Aat)}const zDe=(()=>{const n=new BDe;return{withAudioAction:e=>function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return new Promise(async(o,s)=>{let a=!1;const c=setTimeout(()=>{a=!0,n.release()},3e4);try{await n.acquire(),a||clearTimeout(c),o(e(...r))}catch(l){a||(clearTimeout(c),s(l))}})},processAudioAction:e=>n.acquire().then(()=>e()),completeAudioAction:()=>{n.release()},cancelAllAudioAction:()=>{n.cancel()}}})();function x7(n){const e=["joinComputerAudio","joinSharingAudio","leaveComputerAudio","leaveSharingAudio"];return new Proxy(n,{get:(t,r)=>typeof r=="string"&&e.includes(r)?function(){return zDe.withAudioAction(t[r].bind(t))(...arguments)}:Reflect.get(t,r)})}function V6(n){var e;const{browserVersion:t,isChrome:r,isFirefox:i,isSafari:o,isAndroidOrIOSBrowser:s,isSupportMediaStreamTrackProcessor:a,isSupportOffscreenCanvas:c}=tn,l=Number(t==null||(e=t.match(/^\d+/))===null||e===void 0?void 0:e[0]),u=r&&l>=91,d=i&&l>=89,h=o&&qk(t,"17.4")>=0,f=navigator.hardwareConcurrency>2;let p=v7();return n&&!p&&(p=c&&a),!s&&p&&(u||d||h)&&f}const uB=(n,e)=>{const t=document.createElement("link");return t.rel="preload",t.href=n,t.as=e,t.crossOrigin="anonymous",t},Sb=(n,e,t)=>{const r=[],i=[],o=Array.isArray(n)?n:[n];return oke.filter(s=>{var a;return o.includes(s.category)&&(s.tag===e||((a=s.tag)===null||a===void 0?void 0:a.split(",").includes(e)))}).forEach(s=>{s.type==="worker"?r.push(`${t}${s.name}`):s.type==="wasm"&&i.push(`${t}${s.name}`)}),{workers:r,wasms:i}};function VDe(n,e,t){const r={};if(typeof window.SharedArrayBuffer!="function"){const{isIOSMobile:i,isSafari:o,isSupportOffscreenCanvas:s,isSupportMediaStreamTrackProcessor:a}=tn;Object.assign(r,{enableMultiDecodeVideoWithoutSAB:!!e&&(i||o||s&&a)}),s&&a&&Object.assign(r,{enableVirtualBackgroundWithoutSAB:!!t})}return V6(t)&&Object.assign(r,{resourceManager:OK.exports.IResourceManager,file:[{path:`${n}/vb-resource/dualModel.bin`,type:"bin"},{path:`${n}/vb-resource/tf.min.js`,type:"js"}]}),r}function Qte(n,e){const{media:{isAudioBridgeReceiveReady:t,isAudioBridgeSendReady:r},audio:{customizeAudioOption:i}}=n,o=e!==void 0?e:!(i==null||!i.speakerOnly);return f7([t?Tt([!0]):Mi(S3e,1).pipe(Lu(!0)),r||o?Tt([!0]):Mi(_3e,1).pipe(Lu(!0))])}function Rde(n,e,t){if(n.deviceId===e)return!0;if(e==="default"){const r=t.find(i=>i.deviceId===e);if(r)return r.label.indexOf(n.label)>-1}return!1}function ZE(n){return n.find(e=>e.deviceId==="default")}const LK=(()=>{let n,e=!1;return{watch:function(t){e=!0,n=Promise.race([t,m7(()=>!0,1e4)]).then(()=>{n=void 0,e=!1}).finally(()=>{n=void 0,e=!1})},acquire:function(){return e&&n?n:Promise.resolve()}}})(),NK=(n,e)=>Un({event:xte,operations:[st(t=>t[`${n}`]!==void 0),Ur(1)]},t=>t[`${n}`]===e);class Tu{constructor(){this.audioPlaybackUrl=void 0,this.videoPlaybackUrl=void 0,this._audioElement=void 0,this._videoElement=void 0,this.videoSrc=void 0,this.isUsingSameFile=void 0}static getInstance(){return this.instance===void 0&&(this.instance=new Tu),this.instance}static destroyInstance(){if(this.instance){this.instance.stopAudioElement(),this.instance.stopVideoElement();const t=document.getElementById(nB);var e;t&&((e=t.parentNode)===null||e===void 0||e.removeChild(t)),this.instance=void 0}}setAudioElement(e){return this._audioElement===void 0&&(this._audioElement=new Audio),new Promise((t,r)=>{if(this.videoSrc===e.url)this._audioElement.pause(),this.isUsingSameFile=!0,this._videoElement.muted=!1,(o=this._videoElement).currentTime>0&&!o.paused&&!o.ended&&o.readyState>2?t(""):this._videoElement.play().then(()=>{t("")}).catch(()=>{r()});else{var i;this.isUsingSameFile=!1;const s=tn.isFirefox?"canplay":"canplaythrough",a=()=>{this._audioElement.play().then(()=>{this._audioElement.removeEventListener(s,a),t("")})},c=()=>{this._audioElement.removeEventListener(s,a),this._audioElement.removeEventListener("error",c),r()};this._audioElement.addEventListener(s,a),this._audioElement.addEventListener("error",c),this._audioElement.src=e.url,this._audioElement.loop=!!e.loop,Lf(e.url)&&this._audioElement.setAttribute("crossorigin",""),this._audioElement.currentTime=Math.max((i=e.currentTime)!==null&&i!==void 0?i:0,1e-4)}var o})}setVideoElement(e){return this._videoElement===void 0&&(this._videoElement=document.createElement("video")),new Promise((t,r)=>{var i;this.videoSrc=e.url;const o=tn.isFirefox?"canplay":"canplaythrough",s=()=>{this._videoElement.play().then(()=>{this._videoElement.removeEventListener(o,s),t("")})},a=()=>{this._videoElement.removeEventListener(o,s),this._videoElement.removeEventListener("error",a),r()};this._videoElement.addEventListener(o,s),this._videoElement.addEventListener("error",a),this._videoElement.src=e.url,this.isUsingSameFile||(this._videoElement.muted=!0),this._videoElement.loop=!!e.loop,this._videoElement.currentTime=(i=e.currentTime)!==null&&i!==void 0?i:0,Lf(e.url)&&this._videoElement.setAttribute("crossorigin",""),tn.isSafari&&!document.getElementById(nB)&&(this._videoElement.id=nB,this._videoElement.setAttribute("style","position:fixed;top:-10000px;left:-10000px"),document.body.appendChild(this._videoElement))})}get audioElement(){return this.isUsingSameFile?this._videoElement:this._audioElement}get videoElement(){return this._videoElement}stopAudioElement(){this.isUsingSameFile||this._audioElement&&(this._audioElement.currentTime=0,this._audioElement.pause())}stopVideoElement(){this._videoElement&&this._videoElement.pause(),this.videoSrc=void 0}}Tu.instance=void 0;const Zw=function(n){let e=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const{socket:{zoomSocketStatus:t,xmppSocketStatus:r,mainSessionSocketStatus:i},meeting:{meetingStatus:o}}=n,s=[];if(o===ws.Joined){var a;const c=zn.getInstance(),l=Gr.createAgent();if(((a=mn(n))===null||a===void 0?void 0:a.audio)===ci.Computer&&c.leaveComputerAudio(),c.disconnect(),LK.watch(c.destroy()),n.video&&(n.video.subscribedVideoList.length>0&&n.video.subscribedVideoList.forEach(u=>{l.unsubscribeVideo(u)}),n.video.isCurrentUserStartedVideo&&me(oS)),n.share&&n.share.isReceiveSharing){const u=n.share.activeNodeId;n.share.remoteControlledUserList.length>0&&n.share.remoteControlledUserList.forEach(d=>{l.sharingRequestRemoteControl(d,!1)}),l.unsubscribeSharing(u)}Tu.destroyInstance()}if(e||(rr.clearSession(),[Gi.WebclientTk,Gi.WebclientZsk,Gi.WebclientZtk,Gi.WebclientRecordingToken].forEach(c=>{sessionStorage.removeItem(c)}),zc.destroy()),t!==$i.Closed&&s.push(Zf()),r!==$i.Closed&&s.push(nPe()),i!==$i.Closed&&s.push(iPe()),e){const c=mn(n);s.push(_q({audio:c==null?void 0:c.audio,muted:c==null?void 0:c.muted,video:c==null?void 0:c.bVideoOn,isFailover:e}))}else s.push(_q({audio:!1,muted:void 0,video:!1,isFailover:e}));return s.push(aPe(),mPe(),M3e(),rTe(e),ITe(),ATe(e),tct(),JTe(),_De(),nct(),cDe(),EDe(),rct(),$De(e),ict(),NDe(e),jDe(e),bte(ws.Closed)),s},u5=function(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];return Un({event:dg,operations:[Vt(i=>i.find(o=>o.userId===n.userId&&(!n.key||o[`${n.key}`]!==void 0))),st(i=>!!i),Ur(1)]},...t)},oct={[`${kp.AudioBridgeEnable}`]:{mask:240,action:WPe},[`${kp.AudioDecodeInWorklet}`]:{mask:15,action:uPe},[`${kp.VideoFullHD}`]:{mask:15,action:VTe},[`${kp.VideoShareFullHD}`]:{mask:15,action:ETe},[`${kp.WebGL2Render}`]:{mask:15,action:qTe},[`${kp.WebGPURender}`]:{mask:15,action:KTe},[`${kp.ZMKFromRWG}`]:{mask:15,action:QPe}};function sct(n){if(!n)return"";const e=n.match(/rid=(.*)/);return e?e[1]:""}function OS(n){return xS(Vt((e,t)=>n(e,t)),st(e=>e!=null))}function WDe(n){return xS(ht((e,t)=>n(e,t)||Mt))}function ny(n){return xS(ht((e,t)=>n(e,t)),ht(e=>Array.isArray(e)?Tt(e):hi(e)))}const act={period:500,rules:[{peak:50,throttle:300},{peak:60,throttle:400}]},dB={[`${Co}`]:()=>({payloads:{add:[],update:[],remove:[]},onThrottle(n){n.add&&this.payloads.add.push(...n.add),n.update&&this.payloads.update.push(...n.update),n.remove&&this.payloads.remove.push(...n.remove)}})};function qDe(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:act;return e=>new Ns(t=>{const r=new Map;let i=0,o=null;const{period:s,rules:a}=n;let c=null;o||(o=((d,h)=>{const f=performance.now();let p=0,g=!1;return setTimeout(function m(){p+=h,d();const v=performance.now()-f-p,b=setTimeout(m,Math.max(h-v,0));g&&clearTimeout(b)},h),()=>{g=!0}})(()=>{i=0},s));const l=Object.keys(dB),u=e.subscribe({next(d){if(d&&d.evt&&o!==null){i+=1;const{evt:h,body:f}=d,p=String(h);if(l.indexOf(p)>=0)if(c){const g=r.get(p);if(g)g.onThrottle(f);else{const m=dB[p]();m.onThrottle(f),r.set(p,m)}}else{let g=0;if(a.forEach(m=>{i>m.peak&&(g=m.throttle)}),g>0){const m=dB[p]();m.onThrottle(f),r.set(p,m),c=setTimeout(()=>{r.forEach((v,b)=>{const S={evt:Number(b),body:v.payloads};t.next(S)}),r.clear(),c=null},g)}else t.next(d)}else t.next(d)}else t.next(d)},error(d){t.error(d)},complete(){t.complete()}});return()=>{u.unsubscribe(),o&&(o(),o=null),i=0}})}let Ade=function(n){return n[n.Unknown=0]="Unknown",n[n.Windows=1]="Windows",n[n.Mac=2]="Mac",n[n.Pad=3]="Pad",n[n.Mobile=4]="Mobile",n[n.CallIn=5]="CallIn",n[n.Linux=6]="Linux",n[n.WebClient=7]="WebClient",n[n.ChromeOs=8]="ChromeOs",n}({});const Ode=262144,Mde=1048576,KDe=n=>(4&n)==4,d5=n=>(n&Mde)===Mde,GDe=n=>{let{share:{isReceiveSharing:e}}=n;return e},ZDe=n=>{let{share:{activeNodeId:e}}=n;return e},cct=Eo([Yi,GDe,ZDe],function(){let n=arguments.length>2?arguments[2]:void 0;if(arguments.length>1&&arguments[1]){const e=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).find(t=>t.userId===n&&t.sharerOn===!0);if(e){let{os:t}=e;const{pwaOS:r}=e;return r==="mac"?t=Ade.Mac:r==="win"&&(t=Ade.Windows),{...e,os:t}}}return null}),E1=Eo([Yi],n=>n.filter(e=>e.sharerOn)),XDe=Eo([E1],n=>n.some(e=>!!e.bVideoShare)),Kb=Eo([n=>{let{share:{remoteControlledUserList:e}}=n;return e},GDe,ZDe],(n,e,t)=>!!e&&n.some(r=>Gl(r,t)));var hB,lct=new Uint8Array(16);function uct(){if(!hB&&!(hB=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return hB(lct)}for(var Za,as,W6,Kp,dct=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,Ic=[],fB=0;fB<256;++fB)Ic.push((fB+256).toString(16).substr(1));function q6(n,e,t){var r=(n=n||{}).random||(n.rng||uct)();return r[6]=15&r[6]|64,r[8]=63&r[8]|128,function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=(Ic[i[o+0]]+Ic[i[o+1]]+Ic[i[o+2]]+Ic[i[o+3]]+"-"+Ic[i[o+4]]+Ic[i[o+5]]+"-"+Ic[i[o+6]]+Ic[i[o+7]]+"-"+Ic[i[o+8]]+Ic[i[o+9]]+"-"+Ic[i[o+10]]+Ic[i[o+11]]+Ic[i[o+12]]+Ic[i[o+13]]+Ic[i[o+14]]+Ic[i[o+15]]).toLowerCase();if(!function(a){return typeof a=="string"&&dct.test(a)}(s))throw TypeError("Stringified UUID is invalid");return s}(r)}(function(n){n[n.PLAIN=0]="PLAIN",n[n.RSA=1]="RSA",n[n.AESGCM256=2]="AESGCM256"})(Za||(Za={})),function(n){n[n.info=0]="info",n[n.debug=1]="debug",n[n.log=2]="log",n[n.warn=3]="warn",n[n.error=4]="error"}(as||(as={})),function(n){n[n.PROTECT_LOCAL_KEY=0]="PROTECT_LOCAL_KEY"}(W6||(W6={})),function(n){n.beforeInit="beforeInit",n.afterInit="afterInit",n.beforeLog="beforeLog",n.hitSizeLimit="hitSizeLimit",n.afterLog="afterLog",n.beforeReport="beforeReport",n.afterReport="afterReport"}(Kp||(Kp={}));class ene{constructor(){}}var pB,tne={exports:{}},FK={exports:{}},hct=XIe(Object.freeze({__proto__:null,default:{}}));FK.exports=(pB=pB||function(n,e){var t;if(typeof window<"u"&&window.crypto&&(t=window.crypto),typeof self<"u"&&self.crypto&&(t=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(t=globalThis.crypto),!t&&typeof window<"u"&&window.msCrypto&&(t=window.msCrypto),!t&&_1!==void 0&&_1.crypto&&(t=_1.crypto),!t)try{t=hct}catch{}var r=function(){if(t){if(typeof t.getRandomValues=="function")try{return t.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof t.randomBytes=="function")try{return t.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},i=Object.create||function(){function g(){}return function(m){var v;return g.prototype=m,v=new g,g.prototype=null,v}}(),o={},s=o.lib={},a=s.Base={extend:function(g){var m=i(this);return g&&m.mixIn(g),m.hasOwnProperty("init")&&this.init!==m.init||(m.init=function(){m.$super.init.apply(this,arguments)}),m.init.prototype=m,m.$super=this,m},create:function(){var g=this.extend();return g.init.apply(g,arguments),g},init:function(){},mixIn:function(g){for(var m in g)g.hasOwnProperty(m)&&(this[m]=g[m]);g.hasOwnProperty("toString")&&(this.toString=g.toString)},clone:function(){return this.init.prototype.extend(this)}},c=s.WordArray=a.extend({init:function(g,m){g=this.words=g||[],this.sigBytes=m??4*g.length},toString:function(g){return(g||u).stringify(this)},concat:function(g){var m=this.words,v=g.words,b=this.sigBytes,S=g.sigBytes;if(this.clamp(),b%4)for(var E=0;E<S;E++){var w=v[E>>>2]>>>24-E%4*8&255;m[b+E>>>2]|=w<<24-(b+E)%4*8}else for(var C=0;C<S;C+=4)m[b+C>>>2]=v[C>>>2];return this.sigBytes+=S,this},clamp:function(){var g=this.words,m=this.sigBytes;g[m>>>2]&=4294967295<<32-m%4*8,g.length=n.ceil(m/4)},clone:function(){var g=a.clone.call(this);return g.words=this.words.slice(0),g},random:function(g){for(var m=[],v=0;v<g;v+=4)m.push(r());return new c.init(m,g)}}),l=o.enc={},u=l.Hex={stringify:function(g){for(var m=g.words,v=g.sigBytes,b=[],S=0;S<v;S++){var E=m[S>>>2]>>>24-S%4*8&255;b.push((E>>>4).toString(16)),b.push((15&E).toString(16))}return b.join("")},parse:function(g){for(var m=g.length,v=[],b=0;b<m;b+=2)v[b>>>3]|=parseInt(g.substr(b,2),16)<<24-b%8*4;return new c.init(v,m/2)}},d=l.Latin1={stringify:function(g){for(var m=g.words,v=g.sigBytes,b=[],S=0;S<v;S++){var E=m[S>>>2]>>>24-S%4*8&255;b.push(String.fromCharCode(E))}return b.join("")},parse:function(g){for(var m=g.length,v=[],b=0;b<m;b++)v[b>>>2]|=(255&g.charCodeAt(b))<<24-b%4*8;return new c.init(v,m)}},h=l.Utf8={stringify:function(g){try{return decodeURIComponent(escape(d.stringify(g)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(g){return d.parse(unescape(encodeURIComponent(g)))}},f=s.BufferedBlockAlgorithm=a.extend({reset:function(){this._data=new c.init,this._nDataBytes=0},_append:function(g){typeof g=="string"&&(g=h.parse(g)),this._data.concat(g),this._nDataBytes+=g.sigBytes},_process:function(g){var m,v=this._data,b=v.words,S=v.sigBytes,E=this.blockSize,w=S/(4*E),C=(w=g?n.ceil(w):n.max((0|w)-this._minBufferSize,0))*E,I=n.min(4*C,S);if(C){for(var T=0;T<C;T+=E)this._doProcessBlock(b,T);m=b.splice(0,C),v.sigBytes-=I}return new c.init(m,I)},clone:function(){var g=a.clone.call(this);return g._data=this._data.clone(),g},_minBufferSize:0});s.Hasher=f.extend({cfg:a.extend(),init:function(g){this.cfg=this.cfg.extend(g),this.reset()},reset:function(){f.reset.call(this),this._doReset()},update:function(g){return this._append(g),this._process(),this},finalize:function(g){return g&&this._append(g),this._doFinalize()},blockSize:16,_createHelper:function(g){return function(m,v){return new g.init(v).finalize(m)}},_createHmacHelper:function(g){return function(m,v){return new p.HMAC.init(g,v).finalize(m)}}});var p=o.algo={};return o}(Math),pB),tne.exports=FK.exports.enc.Utf8;var nne={exports:{}};nne.exports=function(n){return function(){var e=n,t=e.lib.WordArray;function r(i,o,s){for(var a=[],c=0,l=0;l<o;l++)if(l%4){var u=s[i.charCodeAt(l-1)]<<l%4*2|s[i.charCodeAt(l)]>>>6-l%4*2;a[c>>>2]|=u<<24-c%4*8,c++}return t.create(a,c)}e.enc.Base64={stringify:function(i){var o=i.words,s=i.sigBytes,a=this._map;i.clamp();for(var c=[],l=0;l<s;l+=3)for(var u=(o[l>>>2]>>>24-l%4*8&255)<<16|(o[l+1>>>2]>>>24-(l+1)%4*8&255)<<8|o[l+2>>>2]>>>24-(l+2)%4*8&255,d=0;d<4&&l+.75*d<s;d++)c.push(a.charAt(u>>>6*(3-d)&63));var h=a.charAt(64);if(h)for(;c.length%4;)c.push(h);return c.join("")},parse:function(i){var o=i.length,s=this._map,a=this._reverseMap;if(!a){a=this._reverseMap=[];for(var c=0;c<s.length;c++)a[s.charCodeAt(c)]=c}var l=s.charAt(64);if(l){var u=i.indexOf(l);u!==-1&&(o=u)}return r(i,o,a)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),n.enc.Base64}(FK.exports);var K6=function(n,e,t,r){return new(t||(t=Promise))(function(i,o){function s(l){try{c(r.next(l))}catch(u){o(u)}}function a(l){try{c(r.throw(l))}catch(u){o(u)}}function c(l){var u;l.done?i(l.value):(u=l.value,u instanceof t?u:new t(function(d){d(u)})).then(s,a)}c((r=r.apply(n,[])).next())})};const fct=n=>{try{const e=nne.exports.parse(n);return tne.exports.stringify(e)}catch{return n}},G6=n=>{for(var e=n.length,t=n.length-1;t>=0;t--){var r=n.charCodeAt(t);r>127&&r<=2047?e++:r>2047&&r<=65535&&(e+=2),r>=56320&&r<=57343&&t--}return e},YDe=()=>K6(void 0,void 0,void 0,function*(){return yield self.crypto.subtle.generateKey({name:"AES-GCM",length:256},!0,["encrypt","decrypt"])}),pct=(n,e,t)=>K6(void 0,void 0,void 0,function*(){try{return yield self.crypto.subtle.encrypt({name:"AES-GCM",iv:t},e,n)}catch(r){throw r}}),gct=(n,e)=>{const t=typeof n=="string"?function(r){const i=new ArrayBuffer(r.length),o=new Uint8Array(i);for(let s=0,a=r.length;s<a;s++)o[s]=r.charCodeAt(s);return i}(n):n;return self.crypto.subtle.encrypt({name:"RSA-OAEP"},e,t)},JDe={},Z6=(n,e)=>{JDe[e]=n},mct=JDe,rne=n=>{try{return JSON.stringify(n)}catch{return"json stringify failed"}},vct=n=>{try{return JSON.parse(n)}catch{return n}},$de=n=>{let e=0;return e+=G6(n.message),n.tags.forEach(t=>{e+=G6(t)}),e};class yct{constructor(e){this.uuid="randomUUID"in self.crypto?self.crypto.randomUUID():"10000000-1000-4000-8000-100000000000".replace(/[018]/g,h=>(h^crypto.getRandomValues(new Uint8Array(1))[0]&15>>h/4).toString(16));const{databaseName:t,maxSize:r,publicKey:i,reportUrl:o,plugins:s,idbManager:a,logManager:c,currentSize:l,externalKeys:u,codecWorkerFilePath:d}=e;this.databaseName=t,this.maxSize=r,this.publicKey=i??"",this.reportUrl=o??"",this.plugins=s??[],this.idbManager=a,this.logManager=c,this.currentSize=l??0,this.externalKeys=u,this.commonMethods=Object.assign({},mct)}getLocalAESGCM256Key(){var e;return function(t,r,i,o){return new(i||(i=Promise))(function(s,a){function c(d){try{u(o.next(d))}catch(h){a(h)}}function l(d){try{u(o.throw(d))}catch(h){a(h)}}function u(d){var h;d.done?s(d.value):(h=d.value,h instanceof i?h:new i(function(f){f(h)})).then(c,l)}u((o=o.apply(t,[])).next())})}(this,void 0,void 0,function*(){if(this.localAESGCM256Key)return this.localAESGCM256Key;this.localAESGCM256Key=yield YDe();const t=this.externalKeys?(e=this.externalKeys.filter(r=>r.usage===W6.PROTECT_LOCAL_KEY)[0])===null||e===void 0?void 0:e.key:void 0;return yield this.idbManager.saveAESGCM256Key(this.uuid,this.localAESGCM256Key,t),this.localAESGCM256Key})}updateCurrentSize(e){var t;let r=(t=this.currentSize)!==null&&t!==void 0?t:0;if(e instanceof Map)for(const[i,o]of e)r+=$de(o);else r+=$de(e);return this.currentSize=r,r>=this.maxSize}}const gB=(...n)=>{const e={},t=[];for(const i of n)i.forEach(o=>{e[o.id]||(e[o.id]=!0,t.push(o))});const r=new Map;return t.sort((i,o)=>(i==null?void 0:i.id)-(o==null?void 0:o.id)).forEach(i=>{r.set(i.id,i)}),r},h5=(n,e)=>{const t=new Map;return e.forEach(r=>{n(r)&&t.set(r.id,r)}),t};class bct{constructor(){this.getStore=()=>({byTag:Object.assign({},this.store.byTag),byTime:new Map(this.store.byTime)}),this.pushByTime=e=>{for(const t of e)this.store.byTime.set(t.id,t)},this.pushByTag=e=>{e.forEach(t=>{const r=t.tags;Array.isArray(r)&&r.forEach(i=>{this.store.byTag[i]||(this.store.byTag[i]=new Map),this.store.byTag[i].set(t.id,t)})})},this.addLog=e=>{let t=e;Array.isArray(e)||(t=[e]),this.pushByTime(t),this.pushByTag(t)},this.syncFromIDB=e=>function(t,r,i,o){return new(i||(i=Promise))(function(s,a){function c(d){try{u(o.next(d))}catch(h){a(h)}}function l(d){try{u(o.throw(d))}catch(h){a(h)}}function u(d){var h;d.done?s(d.value):(h=d.value,h instanceof i?h:new i(function(f){f(h)})).then(c,l)}u((o=o.apply(t,[])).next())})}(this,void 0,void 0,function*(){const t=yield e.getAllLogs();this.addLog(t)}),this.reset=()=>{this.store={byTag:{},byTime:new Map}},this.deleteLogs=e=>{for(const t of e){const r=this.store.byTime.get(t);if(!r)continue;const{tags:i}=r;for(const o of i)this.store.byTag[o].delete(t);this.store.byTime.delete(t)}},this.filterStore=e=>{const t=((i,o)=>{if(!o)return i.byTime;if(typeof o=="string")return i.byTag[o]||new Map;if(Array.isArray(o)){if(o.every(s=>typeof s=="string"))return gB(...o.map(s=>i.byTag[s]).filter(s=>!!s))}else{if(typeof o=="function")return h5(o,i.byTime);if(typeof o=="object")if(o.tags&&o.filter){if(typeof o.tags=="string")return h5(o.filter,i.byTag[o.tags]);if(Array.isArray(o.tags)&&o.tags.every(s=>typeof s=="string"))return gB(...o.tags.map(s=>{const a=i.byTag[s];return a?h5(o.filter,a):new Map}))}else{if(o.filter)return h5(o.filter,i.byTime);if(o.tags){if(typeof o=="string")return i.byTag[o]||new Map;if(Array.isArray(o)&&o.every(s=>typeof s=="string"))return gB(...o.map(s=>i.byTag[s]))}}else console.error("Wrong filter type")}return new Map})(this.store,e),r=new Map;for(const[i,o]of t){const s=Object.assign(Object.assign({},o),{message:vct(fct(o.message))});r.set(i,s)}return r},this.store={byTag:{},byTime:new Map}}}function L0(n,e,t){const r=n.plugins;if(!Array.isArray(r))return t;let i=t;return r.forEach(o=>{const s=o[e];if(typeof s=="function"){const a=s(n,i);a&&(i=a)}}),i}const QDe=(n,e,t,r,i,o={})=>function(s,a,c,l){return new(c||(c=Promise))(function(u,d){function h(g){try{p(l.next(g))}catch(m){d(m)}}function f(g){try{p(l.throw(g))}catch(m){d(m)}}function p(g){var m;g.done?u(g.value):(m=g.value,m instanceof c?m:new c(function(v){v(m)})).then(h,f)}p((l=l.apply(s,[])).next())})}(void 0,void 0,void 0,function*(){const{noCache:s,extraProperties:a={}}=o,c=((u,d,h,f,p,g)=>{const m=Array.isArray(d)?d:[d],v=Date.now();return Object.assign({message:u,logLevel:h,tags:m,encryptMode:f,timestamp:v,laplaceSessionId:p},g)})(`${e}`,t,r,i,n.uuid,a),l=L0(n,Kp.beforeLog,c);if(s)L0(n,Kp.afterLog,c);else{const{idbManager:u,logManager:d}=n,h=yield u.makeNextId();l.message=(p=>{try{const g=tne.exports.parse(p);return nne.exports.stringify(g)}catch{return p}})(l.message);const f=Object.assign(Object.assign({},l),{id:h});n.updateCurrentSize(f)&&L0(n,Kp.hitSizeLimit,f),d.addLog(f),yield u.addLog(f),L0(n,Kp.afterLog,f)}});Z6(QDe,"commonLog");const Sct=n=>new Promise(e=>{const t=new XMLHttpRequest;t.open(n.type||"GET",n.url,!0),t.withCredentials=n.withCredentials,t.onerror=r=>{e({error:r,report:n.reportItem})},t.onreadystatechange=function(){if(t.readyState===4){const r=t.status;e(r>=200&&r<300?{report:n.reportItem}:{error:`Request failed, status: ${r}, responseText: ${t.responseText}`,report:n.reportItem})}},Object.entries(n.headers).forEach(([r,i])=>{i&&r&&t.setRequestHeader(r,i)}),t.send(n.data)}),U_=(n,e=2)=>{let t=`${n}`;for(;t.length<e;)t=`0${t}`;return t},eRe=n=>{const e=new Date(n);return`${e.getUTCFullYear()}-${U_(e.getUTCMonth()+1)}-${U_(e.getUTCDate())} ${U_(e.getUTCHours())}:${U_(e.getUTCMinutes())}:${U_(e.getUTCSeconds())}.${U_(e.getUTCMilliseconds(),3)}`},tRe={version:"000001",flag:"0"},_ct=(n,e)=>Array.from(n.values()).reduce((t,r)=>{const i=((a,c)=>{const{message:l,logLevel:u,tags:d,timestamp:h,encryptMode:f,id:p}=a,g=function(v,b){var S={};for(var E in v)Object.prototype.hasOwnProperty.call(v,E)&&b.indexOf(E)<0&&(S[E]=v[E]);if(v!=null&&typeof Object.getOwnPropertySymbols=="function"){var w=0;for(E=Object.getOwnPropertySymbols(v);w<E.length;w++)b.indexOf(E[w])<0&&Object.prototype.propertyIsEnumerable.call(v,E[w])&&(S[E[w]]=v[E[w]])}return S}(a,["message","logLevel","tags","timestamp","encryptMode","id"]),m=Object.assign(Object.assign({time:eRe(h),logLevel:as[u],message:l,tags:d},c),g);return rne(m)})(r,e),o=G6(i),s=t[t.length-1];return s.currentSize+o>30720?t.push({messages:[i],ids:[r.id],currentSize:o}):(s.messages.push(i),s.ids.push(r.id),s.currentSize+=o),t},[{messages:[],ids:[],currentSize:0}]).filter(t=>t.currentSize>0).map(t=>({messages:t.messages.join(`
`),ids:t.ids,meta:tRe})),nRe=(n,e,t)=>((r,i,o)=>Promise.all(r.map(s=>Object.assign({url:i||"",type:"POST",withCredentials:!1,headers:{},data:rne({messages:s.messages,meta:s.meta}),reportItem:s},o)).map(Sct)))(n,e.reportUrl,t).then(r=>{r.forEach(i=>{var o;L0(e,Kp.afterReport,{report:i.report,error:(o=i.error)!==null&&o!==void 0?o:null})})}),rRe=(n,e,t)=>function(r,i,o,s){return new(o||(o=Promise))(function(a,c){function l(h){try{d(s.next(h))}catch(f){c(f)}}function u(h){try{d(s.throw(h))}catch(f){c(f)}}function d(h){var f;h.done?a(h.value):(f=h.value,f instanceof o?f:new o(function(p){p(f)})).then(l,u)}d((s=s.apply(r,[])).next())})}(void 0,void 0,void 0,function*(){const r=n.logManager.filterStore(e);if(!r||(r==null?void 0:r.size)===0||!t)return;const{xhrOptions:i={},additionalContext:o}=t,s=L0(n,Kp.beforeReport,r),a=_ct(s,o);nRe(a,n,i)});Z6(rRe,"commonReport");var iRe=function(n,e,t,r){return new(t||(t=Promise))(function(i,o){function s(l){try{c(r.next(l))}catch(u){o(u)}}function a(l){try{c(r.throw(l))}catch(u){o(u)}}function c(l){var u;l.done?i(l.value):(u=l.value,u instanceof t?u:new t(function(d){d(u)})).then(s,a)}c((r=r.apply(n,[])).next())})};const oRe=(n,e,t)=>iRe(void 0,void 0,void 0,function*(){const{idbManager:r,logManager:i}=n;if(Array.isArray(t)&&(yield r.deleteLogs(t),i.deleteLogs(t),!e))return;const o=n.logManager.filterStore(e),s=[];for(const[c,l]of o)s.push(l.id);let a=s;Array.isArray(s)||(a=[s]),yield r.deleteLogs(a),i.deleteLogs(a)}),sRe=n=>iRe(void 0,void 0,void 0,function*(){const{idbManager:e,logManager:t}=n;yield e.reset(),t.reset()});function Lde(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function ry(n){return new Promise(function(e,t){n.oncomplete=n.onsuccess=function(){return e(n.result)},n.onabort=n.onerror=function(){return t(n.error)}})}function aRe(n,e){var t=indexedDB.open(n);t.onupgradeneeded=function(){return t.result.createObjectStore(e)};var r=ry(t);return function(i,o){return r.then(function(s){return o(s.transaction(e,i).objectStore(e))})}}var mB;function JP(){return mB||(mB=aRe("keyval-store","keyval")),mB}function Nde(n){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:JP())("readwrite",function(e){return n.forEach(function(t){return e.delete(t)}),ry(e.transaction)})}function wct(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:JP();return n("readonly",function(e){if(e.getAll&&e.getAllKeys)return Promise.all([ry(e.getAllKeys()),ry(e.getAll())]).then(function(r){var i=function(a,c){return function(l){if(Array.isArray(l))return l}(a)||function(l,u){var d=l==null?null:typeof Symbol<"u"&&l[Symbol.iterator]||l["@@iterator"];if(d!=null){var h,f,p=[],g=!0,m=!1;try{for(d=d.call(l);!(g=(h=d.next()).done)&&(p.push(h.value),!u||p.length!==u);g=!0);}catch(v){m=!0,f=v}finally{try{g||d.return==null||d.return()}finally{if(m)throw f}}return p}}(a,c)||function(l,u){if(l){if(typeof l=="string")return Lde(l,u);var d=Object.prototype.toString.call(l).slice(8,-1);return d==="Object"&&l.constructor&&(d=l.constructor.name),d==="Map"||d==="Set"?Array.from(l):d==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(d)?Lde(l,u):void 0}}(a,c)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}(r,2),o=i[0],s=i[1];return o.map(function(a,c){return[a,s[c]]})});var t=[];return n("readonly",function(r){return function(i,o){return i.openCursor().onsuccess=function(){this.result&&(function(s){t.push([s.key,s.value])}(this.result),this.result.continue())},ry(i.transaction)}(r).then(function(){return t})})})}Z6(oRe,"commonDelete"),Z6(sRe,"commonReset");var Cct=function(n,e,t,r){return new(t||(t=Promise))(function(i,o){function s(l){try{c(r.next(l))}catch(u){o(u)}}function a(l){try{c(r.throw(l))}catch(u){o(u)}}function c(l){var u;l.done?i(l.value):(u=l.value,u instanceof t?u:new t(function(d){d(u)})).then(s,a)}c((r=r.apply(n,[])).next())})};const Fde={default:{queue:[],isRunning:!1,listeners:[]}},ine=n=>{let e=Fde[n];return e||(e={queue:[],isRunning:!1,listeners:[]},Fde[n]=e),e};function cRe(n){return Cct(this,void 0,void 0,function*(){const e=ine(n),{queue:t,listeners:r}=e;for(;t.length>0&&!e.isRunning;){const i=t.shift();e.isRunning=!0;try{const o=yield i.task();i.resolution(o)}catch(o){i.rejection(o)}e.isRunning=!1,cRe(n)}r.length&&r.forEach(i=>{i()})})}function f5(n,e){const t=ine(e);try{return new Promise((r,i)=>{t.queue.push({task:n,resolution:r,rejection:i}),cRe(e)})}catch(r){return Promise.reject(r)}}const jde=(n,e)=>{ine(n).listeners.push(e)};var sd=function(n,e,t,r){return new(t||(t=Promise))(function(i,o){function s(l){try{c(r.next(l))}catch(u){o(u)}}function a(l){try{c(r.throw(l))}catch(u){o(u)}}function c(l){var u;l.done?i(l.value):(u=l.value,u instanceof t?u:new t(function(d){d(u)})).then(s,a)}c((r=r.apply(n,[])).next())})};const vB="change_meta",yB="change_log",z_=()=>Promise.resolve();class xct{constructor(e){this.waitingForReset=!1,this.resetting=!1,this.isChangingMeta=!1,this.isChangingLog=!1,this.dbFailCount={read:0,write:0},this.get=t=>function(r){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:JP())("readonly",function(i){return ry(i.get(r))})}(t,this.store),this.set=(t,r)=>sd(this,void 0,void 0,function*(){try{return!(this.dbFailCount.write>3)&&(yield function(i,o){return(arguments.length>2&&arguments[2]!==void 0?arguments[2]:JP())("readwrite",function(s){return s.put(o,i),ry(s.transaction)})}(t,r,this.store))}catch(i){i instanceof DOMException&&(i&&i.name==="QuotaExceededError"?(yield this.deleteOldLogsForSetNewOne(),yield this.set(t,r)):this.dbFailCount.write+=1),console.error(i)}}),this.deleteOldLogsForSetNewOne=()=>sd(this,void 0,void 0,function*(){var t;const r=yield this.getAllLogs(),i=[];for(let o=0;o<13;o++){const s=(t=r[o])===null||t===void 0?void 0:t.id;(s||s===0)&&i.push(`${s}`)}return Nde(i,this.store)}),this.adjustMaxId=()=>sd(this,void 0,void 0,function*(){return this.resetting?z_():(this.isChangingMeta=!0,yield f5(()=>sd(this,void 0,void 0,function*(){var t;const r=yield this.getAllLogs(),i=r[r.length-1],o=(t=i==null?void 0:i.id)!==null&&t!==void 0?t:0;return yield this.set("maxId",o),o}),vB))}),this.makeNextId=()=>sd(this,void 0,void 0,function*(){return this.resetting?z_():(this.isChangingMeta=!0,yield f5(()=>sd(this,void 0,void 0,function*(){const t=yield this.get("maxId");if(!t&&t!==0)return yield this.set("maxId",0),0;const r=t+1;return yield this.set("maxId",r),r}),vB))}),this.addLog=t=>sd(this,void 0,void 0,function*(){if(this.resetting)return z_();this.isChangingLog=!0,yield f5(()=>sd(this,void 0,void 0,function*(){const{id:r}=t;return this.set(`${r}`,t)}),yB)}),this.getAllLogs=()=>sd(this,void 0,void 0,function*(){return(yield wct(this.store)).filter(([t])=>t!=="maxId").sort((t,r)=>{var i,o;return((i=t[1])===null||i===void 0?void 0:i.id)-((o=r[1])===null||o===void 0?void 0:o.id)}).map(([,t])=>t)}),this.deleteLogs=t=>sd(this,void 0,void 0,function*(){if(this.resetting)return z_();this.isChangingLog=!0,yield f5(()=>sd(this,void 0,void 0,function*(){return Nde(t.map(r=>`${r}`),this.store)}),yB),yield this.adjustMaxId()}),this.saveAESGCM256Key=(t,r,i)=>sd(this,void 0,void 0,function*(){if(i){const o=yield self.crypto.subtle.exportKey("raw",r),s=yield((a,c,l)=>K6(void 0,void 0,void 0,function*(){return new Promise((u,d)=>{requestAnimationFrame(()=>K6(void 0,void 0,void 0,function*(){var h;const f=(h=c==null?void 0:c.algorithm)===null||h===void 0?void 0:h.name;let p;if(f==="RSA-OAEP"?p=gct:f==="AES-GCM"&&(p=pct),!p)throw new Error("Unsupported encrypt key type");if(typeof a=="string"){const g=new TextEncoder,m=yield p(g.encode(a),c,l);u(m)}else{const g=yield p(a,c,l);u(g)}}))})}))(o,i,new Uint8Array(16));yield this.set(`aes-gcm-256-${t}`,s)}else yield this.set(`aes-gcm-256-${t}`,r)}),this.reset=()=>sd(this,void 0,void 0,function*(){return this.resetting?z_():(this.waitingForReset=!0,this.isChangingLog||this.isChangingMeta?z_():(this.resetting=!0,yield function(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:JP())("readwrite",function(t){return t.clear(),ry(t.transaction)})}(this.store),this.resetting=!1,void(this.waitingForReset=!1)))}),this.store=aRe(e,e+"-store"),jde(vB,()=>{if(this.isChangingMeta=!1,this.waitingForReset)return this.reset()}),jde(yB,()=>{if(this.isChangingLog=!1,this.waitingForReset)return this.reset()})}}var os=function(n,e,t,r){return new(t||(t=Promise))(function(i,o){function s(l){try{c(r.next(l))}catch(u){o(u)}}function a(l){try{c(r.throw(l))}catch(u){o(u)}}function c(l){var u;l.done?i(l.value):(u=l.value,u instanceof t?u:new t(function(d){d(u)})).then(s,a)}c((r=r.apply(n,[])).next())})};const Ect={databaseName:"laplace-default-db",maxSize:49283072};class jK{constructor(e){this.commonLogWithContext=(r,i,o,s,a)=>os(this,void 0,void 0,function*(){yield QDe(this.runtimeMetaManager,r,i,o,s,a)}),this.commonReportWithContext=(r,i)=>os(this,void 0,void 0,function*(){yield rRe(this.runtimeMetaManager,r,i)}),this.commonDeleteWithContext=r=>os(this,void 0,void 0,function*(){yield oRe(this.runtimeMetaManager,r)}),this.resetWithContext=()=>os(this,void 0,void 0,function*(){yield sRe(this.runtimeMetaManager)}),this.initLocalAESGCM256Key=()=>os(this,void 0,void 0,function*(){return yield YDe()}),this.doNotUseDirtyGetStore=()=>this.runtimeMetaManager.logManager.getStore(),this.log=(r,i,o)=>os(this,void 0,void 0,function*(){yield this.commonLogWithContext(r,i,as.log,Za.PLAIN,{extraProperties:o})}),this.info=(r,i,o)=>os(this,void 0,void 0,function*(){yield this.commonLogWithContext(r,i,as.info,Za.PLAIN,{extraProperties:o})}),this.warn=(r,i,o)=>os(this,void 0,void 0,function*(){yield this.commonLogWithContext(r,i,as.warn,Za.PLAIN,{extraProperties:o})}),this.debug=(r,i,o)=>os(this,void 0,void 0,function*(){yield this.commonLogWithContext(r,i,as.debug,Za.PLAIN,{extraProperties:o})}),this.error=(r,i,o)=>os(this,void 0,void 0,function*(){yield this.commonLogWithContext(r,i,as.error,Za.PLAIN,{extraProperties:o})}),this.logWithEncryption=(r,i,o)=>os(this,void 0,void 0,function*(){yield this.commonLogWithContext(r,i,as.log,Za.AESGCM256,{extraProperties:o})}),this.infoWithEncryption=(r,i,o)=>os(this,void 0,void 0,function*(){yield this.commonLogWithContext(r,i,as.info,Za.AESGCM256,{extraProperties:o})}),this.debugWithEncryption=(r,i,o)=>os(this,void 0,void 0,function*(){yield this.commonLogWithContext(r,i,as.debug,Za.AESGCM256,{extraProperties:o})}),this.warnWithEncryption=(r,i,o)=>os(this,void 0,void 0,function*(){yield this.commonLogWithContext(r,i,as.warn,Za.AESGCM256,{extraProperties:o})}),this.errorWithEncryption=(r,i,o)=>os(this,void 0,void 0,function*(){yield this.commonLogWithContext(r,i,as.error,Za.AESGCM256,{extraProperties:o})}),this.logWithoutCache=(r,i,o)=>os(this,void 0,void 0,function*(){yield this.commonLogWithContext(r,i,as.log,Za.PLAIN,{extraProperties:o,noCache:!0})}),this.infoWithoutCache=(r,i,o)=>os(this,void 0,void 0,function*(){yield this.commonLogWithContext(r,i,as.info,Za.PLAIN,{extraProperties:o,noCache:!0})}),this.warnWithoutCache=(r,i,o)=>os(this,void 0,void 0,function*(){yield this.commonLogWithContext(r,i,as.warn,Za.PLAIN,{extraProperties:o,noCache:!0})}),this.debugWithoutCache=(r,i,o)=>os(this,void 0,void 0,function*(){yield this.commonLogWithContext(r,i,as.debug,Za.PLAIN,{extraProperties:o,noCache:!0})}),this.errorWithoutCache=(r,i,o)=>os(this,void 0,void 0,function*(){yield this.commonLogWithContext(r,i,as.error,Za.PLAIN,{extraProperties:o,noCache:!0})}),this.getLogs=r=>{const i=this.runtimeMetaManager.logManager;return i?i.filterStore(r):new Map},this.report=(...r)=>((i,o,s={})=>function(a,c,l,u){return new(l||(l=Promise))(function(d,h){function f(m){try{g(u.next(m))}catch(v){h(v)}}function p(m){try{g(u.throw(m))}catch(v){h(v)}}function g(m){var v;m.done?d(m.value):(v=m.value,v instanceof l?v:new l(function(b){b(v)})).then(f,p)}g((u=u.apply(a,[])).next())})}(void 0,void 0,void 0,function*(){var a,c;const l=(a=s.sampleRate)!==null&&a!==void 0?a:1;if(Math.random()>l)return;if(G6(o)>30720)throw new Error("ERROR: Laplace .report(strMsg) size bigger than 30KB is NOT allowed.");const u=Object.assign({message:Object.assign({strMsg:o},s.extraMsg),time:eRe(Date.now())},s.extraData);return!((c=s==null?void 0:s.tags)===null||c===void 0)&&c.length&&(u.tags=s==null?void 0:s.tags),nRe([{messages:JSON.stringify(u),meta:tRe}],i,s.xhrOptions)}))(this.runtimeMetaManager,...r),this.reportByHttps=(r,i)=>os(this,void 0,void 0,function*(){yield this.commonReportWithContext(r,i)}),this.deleteLog=r=>os(this,void 0,void 0,function*(){yield this.commonDeleteWithContext(r)}),this.deleteAll=()=>os(this,void 0,void 0,function*(){yield this.resetWithContext()});const{runtimeMetaManager:t}=e;this.runtimeMetaManager=t}}jK.init=n=>os(void 0,void 0,void 0,function*(){const{databaseName:e="laplace-default-db"}=n,t=new xct(e),r=new bct,i=new yct(Object.assign(Object.assign(Object.assign({},Ect),n),{idbManager:t,logManager:r}));L0(i,Kp.beforeInit),yield r.syncFromIDB(i.idbManager);const o=new jK({runtimeMetaManager:i});return L0(i,Kp.afterInit),o});class Ict extends ene{constructor(e){super(),this.config={verbose:!1},this.beforeLog=(t,r)=>{const{verbose:i}=this.config;switch(i&&console.log("beforeLog, ","state: ",r,"meta: ",t),r.logLevel){case as.error:console.error(r.message);break;case as.warn:console.warn(r.message);break;case as.log:console.log(r.message);break;case as.debug:console.debug(r.message);break;case as.info:console.info(r.message)}},this.afterLog=(t,r)=>{const{verbose:i}=this.config;i&&console.log("afterLog, ","state: ",r,"meta: ",t)},this.beforeReport=(t,r)=>{const{verbose:i}=this.config;i&&console.log("beforeReport, ","pluginParams: ",r,"meta: ",t)},this.afterReport=(t,r)=>{const{verbose:i}=this.config;i&&console.log("afterReport, ","pluginParams: ",r,"runtimeMetaManager: ",t)},e&&(this.config=e)}}const Bde=n=>{const e=[];for(const[t,r]of n)e.push(r);return e};class Pct extends ene{constructor(e){super(),this.config={debug:!1},this.debugLog=t=>{const{debug:r}=this.config;r&&console.log(`[AutoCleanLogPlugin]: ${t}`)},this.afterInit=t=>{const{expireBefore:r}=this.config;if(!r)return void this.debugLog("early return on beforeInit because expireBefore is falsy");const{logManager:i,commonMethods:{commonDelete:o}}=t,s=i.getStore().byTime,a=(typeof r=="function"?Bde(s).filter(r):Bde(s).filter(c=>c.timestamp<r)).map(c=>c.id);o(t,void 0,a),this.debugLog(`afterInit, clean log id: ${a}`)},this.afterReport=(t,{report:r,error:i})=>{if(i)return this.debugLog("error"),void console.error(i);const{cleanAfterReport:o}=this.config;if(!o)return void this.debugLog("early return on afterReport because cleanAfterReport is falsy");const{commonMethods:{commonDelete:s}}=t;s(t,void 0,r.ids),this.debugLog(`afterReport, clean log id: ${r.ids}`)},e&&(this.config=e)}}var Hde="Expected a function",Ude=NaN,kct="[object Symbol]",Tct=/^\s+|\s+$/g,Dct=/^[-+]0x[0-9a-f]+$/i,Rct=/^0b[01]+$/i,Act=/^0o[0-7]+$/i,Oct=parseInt,Mct=typeof _1=="object"&&_1&&_1.Object===Object&&_1,$ct=typeof self=="object"&&self&&self.Object===Object&&self,Lct=Mct||$ct||Function("return this")(),Nct=Object.prototype.toString,Fct=Math.max,jct=Math.min,bB=function(){return Lct.Date.now()};function X6(n){var e=typeof n;return!!n&&(e=="object"||e=="function")}function zde(n){if(typeof n=="number")return n;if(function(r){return typeof r=="symbol"||function(i){return!!i&&typeof i=="object"}(r)&&Nct.call(r)==kct}(n))return Ude;if(X6(n)){var e=typeof n.valueOf=="function"?n.valueOf():n;n=X6(e)?e+"":e}if(typeof n!="string")return n===0?n:+n;n=n.replace(Tct,"");var t=Rct.test(n);return t||Act.test(n)?Oct(n.slice(2),t?2:8):Dct.test(n)?Ude:+n}var Bct=function(n,e,t){var r=!0,i=!0;if(typeof n!="function")throw new TypeError(Hde);return X6(t)&&(r="leading"in t?!!t.leading:r,i="trailing"in t?!!t.trailing:i),function(o,s,a){var c,l,u,d,h,f,p=0,g=!1,m=!1,v=!0;if(typeof o!="function")throw new TypeError(Hde);function b(I){var T=c,D=l;return c=l=void 0,p=I,d=o.apply(D,T)}function S(I){var T=I-f;return f===void 0||T>=s||T<0||m&&I-p>=u}function E(){var I=bB();if(S(I))return w(I);h=setTimeout(E,function(T){var D=s-(T-f);return m?jct(D,u-(T-p)):D}(I))}function w(I){return h=void 0,v&&c?b(I):(c=l=void 0,d)}function C(){var I=bB(),T=S(I);if(c=arguments,l=this,f=I,T){if(h===void 0)return function(D){return p=D,h=setTimeout(E,s),g?b(D):d}(f);if(m)return h=setTimeout(E,s),b(f)}return h===void 0&&(h=setTimeout(E,s)),d}return s=zde(s)||0,X6(a)&&(g=!!a.leading,u=(m="maxWait"in a)?Fct(zde(a.maxWait)||0,s):u,v="trailing"in a?!!a.trailing:v),C.cancel=function(){h!==void 0&&clearTimeout(h),p=0,c=f=l=h=void 0},C.flush=function(){return h===void 0?d:w(bB())},C}(n,e,{leading:r,maxWait:e,trailing:i})};const Hct=["RESOURCE_ERROR","JS_ERROR","UNHANDLED_PROMISE_REJECTION"];class Uct extends ene{constructor(e){super(),this.config={debug:!1,publicTags:[]},this.errorCount=0,this.hashErrors={},this.runtimeMetaManager=null,this.addPublicTags=t=>{var r;return(r=this.config.publicTags)===null||r===void 0?void 0:r.concat(t).filter(i=>i)},this.debugLog=t=>{const{debug:r}=this.config;r&&console.log("[AutoLogErrorPlugin]:",t)},this.ignore=t=>{var r,i,o,s,a;return((r=this.config)===null||r===void 0?void 0:r.maxErrorCount)!==void 0&&this.errorCount>=((i=this.config)===null||i===void 0?void 0:i.maxErrorCount)||!!(!((o=this.config)===null||o===void 0)&&o.ignoredErrorMsgKeywords)&&t&&((a=(s=this.config)===null||s===void 0?void 0:s.ignoredErrorMsgKeywords)===null||a===void 0?void 0:a.some(c=>t==null?void 0:t.includes(c)))},this.report=Bct(()=>{if(this.runtimeMetaManager===null)return;const{autoReport:t}=this.config,{commonMethods:{commonReport:r}}=this.runtimeMetaManager;return r(this.runtimeMetaManager,Hct,t)},600,{trailing:!0,leading:!1}),this.afterInit=t=>{if(this.runtimeMetaManager=t,!self.addEventListener)return;const{commonMethods:{commonLog:r}}=t,i=(o,s,a)=>{this.debugLog(a),this.errorCount+=1;try{return function(c){const l=new TextEncoder().encode(c);return crypto.subtle.digest("SHA-1",l).then(u=>Array.from(new Uint8Array(u)).map(d=>d.toString(16).padStart(2,"0")).join(""))}(o).then(c=>this.hashErrors[c]?"dismissed":(this.hashErrors[c]=!0,r(t,o,this.addPublicTags([].concat(s)),as.error,Za.PLAIN,{extraProperties:{messageHash:c}}).then(this.report))).catch(console.error)}catch(c){return console.error(c),Promise.resolve(c)}};try{self.addEventListener("error",o=>{var s,a,c,l,u,d,h;if(!this.ignore(o==null?void 0:o.message)){if(o!=null&&o.target&&(!((s=o==null?void 0:o.target)===null||s===void 0)&&s.src||!((a=o==null?void 0:o.target)===null||a===void 0)&&a.href)){const f=`Load Resource Error in ${(c=o==null?void 0:o.target)===null||c===void 0?void 0:c.tagName} element: ${((l=o==null?void 0:o.target)===null||l===void 0?void 0:l.src)||((u=o==null?void 0:o.target)===null||u===void 0?void 0:u.href)}`;return i(f,"RESOURCE_ERROR",o)}{const f=`Javascript Runtime Error in ${o==null?void 0:o.filename} (${o==null?void 0:o.lineno}:${o==null?void 0:o.colno}): ${o==null?void 0:o.message}
Stack: ${(h=(d=o==null?void 0:o.error)===null||d===void 0?void 0:d.stack)!==null&&h!==void 0?h:o==null?void 0:o.stack}`;return i(f,"JS_ERROR",o)}}}),self.addEventListener("unhandledrejection",o=>{var s;if(this.ignore((s=o==null?void 0:o.reason)===null||s===void 0?void 0:s.message))return;let a;const c=o==null?void 0:o.reason;return a=typeof c=="string"?`Promise Error: ${c}`:c instanceof Error?`Promise Error: ${c.message} ${c.name} ${c.stack}`:typeof c=="object"?`Promise Error with reason: ${rne(c)}`:`Promise Error with unrecognized reason: ${c}`,i(a,"UNHANDLED_PROMISE_REJECTION",o)})}catch(o){console.error(o)}this.debugLog("afterInit, add listener")},e&&(this.config=e),this.config.publicTags=[].concat(e==null?void 0:e.publicTags)}}let _b=function(n){return n.DeviceAudioStreamCaptured="device audio stream captured",n.AudioJoinComplete="audio join complete",n.AudioLeaveComplete="audio leave complete",n.SharingAudioStartComplete="sharing audio start complete",n.SharingAudioStopComplete="sharing audio stop complete",n.AudioBridgeReconnectStart="audio bridge reconnect start",n.AudioBridgeReconnectEnd="audio bridge reconnect end",n}({}),wb=function(n){return n.VBSettingSuccess="video VB setting success",n.VBSettingFailed="init video VB failed",n.VBPreloadSuccess="preload video VB success",n.VBPreloading3S="preload video VB 3s",n.VBPreloading10S="preload video VB 10s",n.StartCaptureVideoSuccess="start capture video success",n.StopCaptureVideoSuccess="stop capture video success",n}({});function oc(n){return`{E}${n}{/E}`}const zct={enable:!1,enableReport:!1,gatewayEndPoint:"",newGatewayEndPoint:"",logLevel:{debug:!1,log:!1,info:!1,print:!1,warn:!1,error:!1},performanceReportRatio:.25,trackingCount:7},Vde=["debug","log","info","print","warn","error"],V_=(n,e)=>[...n,...e].filter(t=>!!t);class xl{static getInstance(){return this.agentInstance||(this.agentInstance=new xl),this.agentInstance}constructor(){var e=this;this.laplace=void 0,this.trackingId=void 0,this.logConfig=void 0,this.reportUrl=void 0,this.publicTags=void 0,this.accountId=void 0,this.disableAutoReport=void 0,this.initConfig=async t=>{let r,i=zct;try{t.logConfig&&(i=JSON.parse(t.logConfig),i.gatewayEndPoint&&(this.reportUrl=i.gatewayEndPoint),i.newGatewayEndPoint&&(this.reportUrl=i.newGatewayEndPoint));const{enable:c,enableReport:l,reportUrl:u,logLevel:d,encryptKeys:h,trackingId:f,accountId:p}=t;if(c!==void 0&&(i={...i,enable:!!c}),l!==void 0&&(i={...i,enableReport:!!l}),u&&(this.reportUrl=u),typeof d=="string"){const g=Vde.indexOf(d),m=Vde.reduce((v,b,S)=>S<g?{...v,[`${b}`]:!1}:{...v,[`${b}`]:!0},{});i={...i,logLevel:m}}else d!==void 0&&(i={...i,logLevel:d});if(f&&(this.trackingId=f,i={...i,enable:!0,enableReport:!0}),h!==void 0){const g=Array.isArray(h)?h:[h];r=await Promise.all(g.map(m=>function(v){return window.crypto.subtle.importKey("raw",new TextEncoder().encode(v.slice(0,32)),"AES-GCM",!1,["encrypt","decrypt"])}(m).then(v=>({usage:W6.PROTECT_LOCAL_KEY,key:v}))))}p!==void 0&&(this.accountId=p)}catch(c){console.error("parse log config error",c)}const o=new Date().getTime()-6048e5,s=i.enableReport&&this.reportUrl?{gzip:!1,encrypt:!1,additionalContext:{trackingId:this.trackingId}}:void 0;this.publicTags=["VideoSDK",this.trackingId];const a=[t.debugMode&&new Ict({verbose:!1}),new Pct({debug:!1,cleanAfterReport:!0,expireBefore:o}),new Uct({debug:!1,autoReport:s,ignoredErrorMsgKeywords:["table index is out of bounds"],maxErrorCount:223,publicTags:this.accountId?[...this.publicTags,oc(this.accountId)]:this.publicTags})].filter(Boolean);return{laplaceConfig:{databaseName:"ZM-VSDK-LOG-DATABASE",maxSize:49283072,publicKey:t.logEncryptionPubKey,reportUrl:this.reportUrl,externalKeys:r,plugins:a},logConfig:i}},this.handleInitLaplaceSuccess=(t,r)=>{var i;this.laplace=t;const o=rr.get(wq.VSDKLogTrackingId);let s=[];try{s=JSON.parse(o?window.atob(o):"[]")}catch{}((i=s.length>=(r==null?void 0:r.trackingCount))===null||i===void 0||i)&&s.shift();const a=s.reduce((c,l)=>({...c,[`${l}`]:!0}),{});t.deleteLog(c=>{var l;return!((l=c.tags)!==null&&l!==void 0&&l.some(u=>a[u]))}),s.push(this.trackingId),rr.set(wq.VSDKLogTrackingId,window.btoa(JSON.stringify(s)),ri.LocalStorage)},this.init=async t=>{const{laplaceConfig:r,logConfig:i}=await this.initConfig(t);return i.enable?(this.logConfig=i,jK.init(r).then(o=>{this.handleInitLaplaceSuccess(o,i)}).catch(o=>{throw{type:Nf,reason:"Logger init failed.",error:o}})):Promise.reject({type:lt,reason:"Logger feature is not enabled."})},this.check=t=>{var r,i;return!(!this.checkLaplace()||((r=this.logConfig)===null||r===void 0||(i=r.logLevel)===null||i===void 0||!i[t])&&(console.warn(`Logger ${t} is not enabled.`),1))},this.log=(t,r,i)=>{if(this.check("log"))try{var o;return(o=this.laplace.logWithEncryption(t,V_(r,i)))===null||o===void 0?void 0:o.catch(()=>{})}catch{return}},this.logWithExtraProperties=(t,r,i)=>{if(this.check("log"))try{var o;return(o=this.laplace.log(t,r,i))===null||o===void 0?void 0:o.catch(()=>{})}catch{return}},this.warn=(t,r,i)=>{if(this.check("warn"))try{var o;return(o=this.laplace.warnWithEncryption(t,V_(r,i)))===null||o===void 0?void 0:o.catch(()=>{})}catch{return}},this.info=(t,r,i)=>{if(this.check("info"))try{var o;return(o=this.laplace.infoWithEncryption(t,V_(r,i)))===null||o===void 0?void 0:o.catch(()=>{})}catch{return}},this.debug=(t,r,i)=>{if(this.check("debug"))try{var o;return(o=this.laplace.debugWithEncryption(t,V_(r,i)))===null||o===void 0?void 0:o.catch(()=>{})}catch{return}},this.error=(t,r,i)=>{if(this.check("error"))try{var o;return(o=this.laplace.errorWithEncryption(t,V_(r,i)))===null||o===void 0?void 0:o.catch(()=>{})}catch{return}},this.checkLaplace=()=>{var t;return!((t=this.laplace)===null||t===void 0||!t.log)},this.makeLogger=t=>{var r;const i=V_((r=this.publicTags)!==null&&r!==void 0?r:[],t);return{log:(o,s)=>this.log(o,i,s??[]),logWithExtraProperties:(o,s)=>this.logWithExtraProperties(o,i,s),warn:(o,s)=>this.warn(o,i,s??[]),info:(o,s)=>this.info(o,i,s??[]),debug:(o,s)=>this.debug(o,i,s??[]),error:(o,s)=>this.error(o,i,s??[])}},this.reportToGlobalTracing=function(t){var r;let i=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return e.checkLaplace()?(r=e.logConfig)!==null&&r!==void 0&&r.enableReport&&e.reportUrl?function(){try{return!!rr.get(Kk.DisableAutoReportLogs)}catch{return!1}}()&&!i?Promise.resolve():e.laplace.reportByHttps(t,{gzip:!1,encrypt:!1,xhrOptions:{url:e.reportUrl},additionalContext:{trackingId:e.trackingId}}):Promise.reject({type:lt,reason:"Please use getLogs to obtain log data and report by yourself."}):Promise.reject({type:lt,reason:"Logger has not been enabled or initialized."})},this.report=function(t,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"warn";if(e.checkLaplace()&&e.logConfig.enableReport&&e.reportUrl){var o,s;const a=Array.isArray(r)?r:[r],c=e.accountId?[...a,oc(e.accountId)]:a;(o=(s=e.makeLogger(c))[`${i}`])===null||o===void 0||o.call(s,t).then(()=>{e.reportToGlobalTracing(a)})}},this.getLogs=(t,r)=>{if(!this.checkLaplace())return console.warn("Logger has not been enabled or initialized."),[];const i=t.getState(),{meeting:{meetingNumber:o,userId:s,userEmail:a,userName:c}}=i,l={meetingNumber:o,userId:s,userEmail:a,userName:c},u=this.laplace.getLogs(r),d=[];for(const[,h]of u)d.push({...h,...l});return d},this.doNotUseDirtyGetStore=()=>this.checkLaplace()?this.laplace.doNotUseDirtyGetStore():(console.warn("Logger has not been enabled or initialized."),{byTag:{},byTime:new Map}),this.trackingId=q6()}}xl.agentInstance=void 0;const lRe=xl.getInstance(),uRe=[{type:"MediaMeta",methods:["sendUserNodeList","updateUserMediaSN","updateMediaParams","subscribeToQos","unsubscribeFromQos","sendUserAudioStatus","destroy","createMainSessionChannel","notifySDKMeetingReady"]},{type:"Audio",methods:["joinComputerAudio","leaveComputerAudio","joinSharingAudio","leaveSharingAudio","changeSpeaker","changeMicrophone","enableAudioEncode","pauseOrResumeAudio","setSharingAudioVolume","enableShareAudioToBreakoutRoom","enableAudioDenoise","enableSyncButtonsOnHeadset","stopAllIncomingAudio","preInitAudioBridge","setAudioCodecMode","muteOrUnmuteOtherAudio","adjustOtherAudioVolume","changeAudioProfile","unmuteAudio","muteAudio"]},{type:"Video",methods:["startCaptureVideo","stopCaptureVideo","renderVideo","stopRenderVideo","changeCamera","updateRenderedVideoCanvasDimension","adjustRenderedVideoPosition","mirrorVideo","enableHardwareAccelerationForVideoDecode","enableHardwareAccelerationForVideoEncode","startVirtualBackgroundSetting","updateVirtualBackgroundImage","stopVirtualBackgroundSetting","startMaskSetting","updateMaskBackgroundImage","updateMaskClip","stopMaskSetting","enableVideoObserver","prefetchVideoSsrc","cancelPrefetchVideoSsrc","setMobileRotateMode","changeActiveVideoSsrc","updateVideoHDValue","updateVideoFullhdValue","clearVideoCanvas"]},{type:"Sharing",methods:["stopDesktopSharing","startDesktopSharing","pauseDesktopSharing","resumeDesktopSharing","renderSharing","stopRenderSharing","switchSharingSource","ajustmentReceivedSharingCanvas","changeSharingSecondCamera","updateRenderedSharingDimension","addReceivedSharingChannelType","removeReceivedSharingChannelType","switchSharingMode","ajustmentSharingCanvas"]},{type:"RemoteControl",methods:["startRemoteControl","stopRemoteControl","resendRemoteControlPositionPDU","updateRemoteControlProperties","ajustmentReceivedSharingCanvas","startRemoteControlQRCheck"]},{type:"LiveTranscription",methods:["selectLanguageChannelForNewLTT"]},{type:"RemoteCamera",methods:["movePTZCamera"]}].reduce((n,e)=>{const{type:t,methods:r}=e;return[...n,...r.map(i=>({name:i,type:t}))]},[]),Vct=uRe.map(n=>n.name),Wct=function(n){const e=uRe.find(o=>o.name===n);if(e){const{type:o}=e;for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];const s=r==null?void 0:r.map(a=>YM(a));lRe.makeLogger([o,`${o} Media SDK`]).info(`${n},params:${JSON.stringify(s)}`)}};function El(n){return new Proxy(n,{get:(e,t)=>typeof t=="string"&&Vct.includes(t)?function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];try{Reflect.apply(Wct,void 0,[t,...i])}catch{}return Reflect.apply(Reflect.get(e,t),e,i)}:Reflect.get(e,t)})}const W4=xl.getInstance().makeLogger(["Remote Control"]),qct=El(zn.getInstance());function FC(n,e,t,r){let{share:{activeNodeId:i,shareQuality:o}}=e;const{share:{isReceiveSharingFromMainSession:s}}=e;t&&(i=t),r!==void 0&&(o=r);const a=XDe(e);n.subscribeSharing(i,o,s,a)}class dRe{constructor(){this.checkerSubject=void 0,this.checkerSubscription=void 0}startCheck(e){return this.checkerSubject&&this.stopCheck(),this.checkerSubject=new Lh,this.checkerSubscription=js(e).subscribe(this.checkerSubject),this.checkerSubject}stopCheck(){var e;this.checkerSubject&&(this.checkerSubject.complete(),(e=this.checkerSubscription)===null||e===void 0||e.unsubscribe(),this.checkerSubject=void 0)}}const hRe=new dRe,fRe=new dRe;function uP(){return hRe.stopCheck()}function BK(){return fRe.stopCheck()}function Y6(n,e){uP(),BK();const{share:{remoteControllingSsrc:t},meeting:{userId:r}}=n;t&&(pRe(),e.takeBackRemoteControlPermission(r,t))}async function Wde(n,e,t,r,i){const{share:{isSDKGrabControl:o,isGrabRemoteControl:s}}=t;s||(r.subscribeGrabRemoteControl(n,!0),await mc(Mi(sS,1).pipe(st(c=>!!c))));const a=cct(t);a&&(o?(i.resendRemoteControlPositionPDU(),i.updateRemoteControlProperties({os:a.os,isControllerNow:!0,dimension:e&&MK(e)})):e&&i.startRemoteControl(e,a.os,MK(e)))}function pRe(){W4.log("qr scanning stop"),qct.startRemoteControlQRCheck(!1)}const sf=Gr.createAgent(),Cc=El(zn.getInstance()),nm=Gr.createAgent(),rm=El(zn.getInstance());function If(n){for(var e=arguments.length,t=Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];throw Error("[Immer] minified error nr: "+n+(t.length?" "+t.map(function(i){return"'"+i+"'"}).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function jC(n){return!!n&&!!n[$d]}function cS(n){var e;return!!n&&(function(t){if(!t||typeof t!="object")return!1;var r=Object.getPrototypeOf(t);if(r===null)return!0;var i=Object.hasOwnProperty.call(r,"constructor")&&r.constructor;return i===Object||typeof i=="function"&&Function.toString.call(i)===Yct}(n)||Array.isArray(n)||!!n[Qde]||!!(!((e=n.constructor)===null||e===void 0)&&e[Qde])||one(n)||sne(n))}function o3(n,e,t){t===void 0&&(t=!1),z2(n)===0?(t?Object.keys:dne)(n).forEach(function(r){t&&typeof r=="symbol"||e(r,n[r],n)}):n.forEach(function(r,i){return e(i,r,n)})}function z2(n){var e=n[$d];return e?e.i>3?e.i-4:e.i:Array.isArray(n)?1:one(n)?2:sne(n)?3:0}function HK(n,e){return z2(n)===2?n.has(e):Object.prototype.hasOwnProperty.call(n,e)}function gRe(n,e,t){var r=z2(n);r===2?n.set(e,t):r===3?(n.delete(e),n.add(t)):n[e]=t}function one(n){return Zct&&n instanceof Map}function sne(n){return Xct&&n instanceof Set}function Gb(n){return n.o||n.t}function ane(n){if(Array.isArray(n))return Array.prototype.slice.call(n);var e=Jct(n);delete e[$d];for(var t=dne(e),r=0;r<t.length;r++){var i=t[r],o=e[i];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(e[i]={configurable:!0,writable:!0,enumerable:o.enumerable,value:n[i]})}return Object.create(Object.getPrototypeOf(n),e)}function cne(n,e){return e===void 0&&(e=!1),lne(n)||jC(n)||!cS(n)||(z2(n)>1&&(n.set=n.add=n.clear=n.delete=Kct),Object.freeze(n),e&&o3(n,function(t,r){return cne(r,!0)},!0)),n}function Kct(){If(2)}function lne(n){return n==null||typeof n!="object"||Object.isFrozen(n)}function tg(n){var e=Qct[n];return e||If(18,n),e}function qde(){return s3}function SB(n,e){e&&(tg("Patches"),n.u=[],n.s=[],n.v=e)}function J6(n){UK(n),n.p.forEach(Gct),n.p=null}function UK(n){n===s3&&(s3=n.l)}function Kde(n){return s3={p:[],l:s3,h:n,m:!0,_:0}}function Gct(n){var e=n[$d];e.i===0||e.i===1?e.j():e.O=!0}function _B(n,e){e._=e.p.length;var t=e.p[0],r=n!==void 0&&n!==t;return e.h.g||tg("ES5").S(e,n,r),r?(t[$d].P&&(J6(e),If(4)),cS(n)&&(n=Q6(e,n),e.l||e8(e,n)),e.u&&tg("Patches").M(t[$d].t,n,e.u,e.s)):n=Q6(e,t,[]),J6(e),e.u&&e.v(e.u,e.s),n!==mRe?n:void 0}function Q6(n,e,t){if(lne(e))return e;var r=e[$d];if(!r)return o3(e,function(o,s){return Gde(n,r,e,o,s,t)},!0),e;if(r.A!==n)return e;if(!r.P)return e8(n,r.t,!0),r.t;if(!r.I){r.I=!0,r.A._--;var i=r.i===4||r.i===5?r.o=ane(r.k):r.o;o3(r.i===3?new Set(i):i,function(o,s){return Gde(n,r,i,o,s,t)}),e8(n,i,!1),t&&n.u&&tg("Patches").R(r,t,n.u,n.s)}return r.o}function Gde(n,e,t,r,i,o){if(jC(i)){var s=Q6(n,i,o&&e&&e.i!==3&&!HK(e.D,r)?o.concat(r):void 0);if(gRe(t,r,s),!jC(s))return;n.m=!1}if(cS(i)&&!lne(i)){if(!n.h.F&&n._<1)return;Q6(n,i),e&&e.A.l||e8(n,i)}}function e8(n,e,t){t===void 0&&(t=!1),n.h.F&&n.m&&cne(e,t)}function wB(n,e){var t=n[$d];return(t?Gb(t):n)[e]}function Zde(n,e){if(e in n)for(var t=Object.getPrototypeOf(n);t;){var r=Object.getOwnPropertyDescriptor(t,e);if(r)return r;t=Object.getPrototypeOf(t)}}function zK(n){n.P||(n.P=!0,n.l&&zK(n.l))}function CB(n){n.o||(n.o=ane(n.t))}function VK(n,e,t){var r=one(e)?tg("MapSet").N(e,t):sne(e)?tg("MapSet").T(e,t):n.g?function(i,o){var s=Array.isArray(i),a={i:s?1:0,A:o?o.A:qde(),P:!1,I:!1,D:{},l:o,t:i,k:null,o:null,j:null,C:!1},c=a,l=WK;s&&(c=[a],l=dP);var u=Proxy.revocable(c,l),d=u.revoke,h=u.proxy;return a.k=h,a.j=d,h}(e,t):tg("ES5").J(e,t);return(t?t.A:qde()).p.push(r),r}function Xde(n,e){switch(e){case 2:return new Map(n);case 3:return Array.from(n)}return ane(n)}var Yde,s3,une=typeof Symbol<"u"&&typeof Symbol("x")=="symbol",Zct=typeof Map<"u",Xct=typeof Set<"u",Jde=typeof Proxy<"u"&&Proxy.revocable!==void 0&&typeof Reflect<"u",mRe=une?Symbol.for("immer-nothing"):((Yde={})["immer-nothing"]=!0,Yde),Qde=une?Symbol.for("immer-draftable"):"__$immer_draftable",$d=une?Symbol.for("immer-state"):"__$immer_state",Yct=""+Object.prototype.constructor,dne=typeof Reflect<"u"&&Reflect.ownKeys?Reflect.ownKeys:Object.getOwnPropertySymbols!==void 0?function(n){return Object.getOwnPropertyNames(n).concat(Object.getOwnPropertySymbols(n))}:Object.getOwnPropertyNames,Jct=Object.getOwnPropertyDescriptors||function(n){var e={};return dne(n).forEach(function(t){e[t]=Object.getOwnPropertyDescriptor(n,t)}),e},Qct={},WK={get:function(n,e){if(e===$d)return n;var t=Gb(n);if(!HK(t,e))return function(i,o,s){var a,c=Zde(o,s);return c?"value"in c?c.value:(a=c.get)===null||a===void 0?void 0:a.call(i.k):void 0}(n,t,e);var r=t[e];return n.I||!cS(r)?r:r===wB(n.t,e)?(CB(n),n.o[e]=VK(n.A.h,r,n)):r},has:function(n,e){return e in Gb(n)},ownKeys:function(n){return Reflect.ownKeys(Gb(n))},set:function(n,e,t){var r=Zde(Gb(n),e);if(r!=null&&r.set)return r.set.call(n.k,t),!0;if(!n.P){var i=wB(Gb(n),e),o=i==null?void 0:i[$d];if(o&&o.t===t)return n.o[e]=t,n.D[e]=!1,!0;if(function(s,a){return s===a?s!==0||1/s==1/a:s!=s&&a!=a}(t,i)&&(t!==void 0||HK(n.t,e)))return!0;CB(n),zK(n)}return n.o[e]===t&&typeof t!="number"&&(t!==void 0||e in n.o)||(n.o[e]=t,n.D[e]=!0,!0)},deleteProperty:function(n,e){return wB(n.t,e)!==void 0||e in n.t?(n.D[e]=!1,CB(n),zK(n)):delete n.D[e],n.o&&delete n.o[e],!0},getOwnPropertyDescriptor:function(n,e){var t=Gb(n),r=Reflect.getOwnPropertyDescriptor(t,e);return r&&{writable:!0,configurable:n.i!==1||e!=="length",enumerable:r.enumerable,value:t[e]}},defineProperty:function(){If(11)},getPrototypeOf:function(n){return Object.getPrototypeOf(n.t)},setPrototypeOf:function(){If(12)}},dP={};o3(WK,function(n,e){dP[n]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}}),dP.deleteProperty=function(n,e){return dP.set.call(this,n,e,void 0)},dP.set=function(n,e,t){return WK.set.call(this,n[0],e,t,n[0])};var elt=function(){function n(t){var r=this;this.g=Jde,this.F=!0,this.produce=function(i,o,s){if(typeof i=="function"&&typeof o!="function"){var a=o;o=i;var c=r;return function(g){var m=this;g===void 0&&(g=a);for(var v=arguments.length,b=Array(v>1?v-1:0),S=1;S<v;S++)b[S-1]=arguments[S];return c.produce(g,function(E){var w;return(w=o).call.apply(w,[m,E].concat(b))})}}var l;if(typeof o!="function"&&If(6),s!==void 0&&typeof s!="function"&&If(7),cS(i)){var u=Kde(r),d=VK(r,i,void 0),h=!0;try{l=o(d),h=!1}finally{h?J6(u):UK(u)}return typeof Promise<"u"&&l instanceof Promise?l.then(function(g){return SB(u,s),_B(g,u)},function(g){throw J6(u),g}):(SB(u,s),_B(l,u))}if(!i||typeof i!="object"){if((l=o(i))===void 0&&(l=i),l===mRe&&(l=void 0),r.F&&cne(l,!0),s){var f=[],p=[];tg("Patches").M(i,l,f,p),s(f,p)}return l}If(21,i)},this.produceWithPatches=function(i,o){if(typeof i=="function")return function(l){for(var u=arguments.length,d=Array(u>1?u-1:0),h=1;h<u;h++)d[h-1]=arguments[h];return r.produceWithPatches(l,function(f){return i.apply(void 0,[f].concat(d))})};var s,a,c=r.produce(i,o,function(l,u){s=l,a=u});return typeof Promise<"u"&&c instanceof Promise?c.then(function(l){return[l,s,a]}):[c,s,a]},typeof(t==null?void 0:t.useProxies)=="boolean"&&this.setUseProxies(t.useProxies),typeof(t==null?void 0:t.autoFreeze)=="boolean"&&this.setAutoFreeze(t.autoFreeze)}var e=n.prototype;return e.createDraft=function(t){cS(t)||If(8),jC(t)&&(t=function(o){return jC(o)||If(22,o),function s(a){if(!cS(a))return a;var c,l=a[$d],u=z2(a);if(l){if(!l.P&&(l.i<4||!tg("ES5").K(l)))return l.t;l.I=!0,c=Xde(a,u),l.I=!1}else c=Xde(a,u);return o3(c,function(d,h){l&&function(f,p){return z2(f)===2?f.get(p):f[p]}(l.t,d)===h||gRe(c,d,s(h))}),u===3?new Set(c):c}(o)}(t));var r=Kde(this),i=VK(this,t,void 0);return i[$d].C=!0,UK(r),i},e.finishDraft=function(t,r){var i=(t&&t[$d]).A;return SB(i,r),_B(void 0,i)},e.setAutoFreeze=function(t){this.F=t},e.setUseProxies=function(t){t&&!Jde&&If(20),this.g=t},e.applyPatches=function(t,r){var i;for(i=r.length-1;i>=0;i--){var o=r[i];if(o.path.length===0&&o.op==="replace"){t=o.value;break}}i>-1&&(r=r.slice(i+1));var s=tg("Patches").$;return jC(t)?s(t,r):this.produce(t,function(a){return s(a,r)})},n}(),hd=new elt,Pe=hd.produce;hd.produceWithPatches.bind(hd),hd.setAutoFreeze.bind(hd),hd.setUseProxies.bind(hd),hd.applyPatches.bind(hd),hd.createDraft.bind(hd),hd.finishDraft.bind(hd);const ehe={ssrc:0,status:Hr.End,shareDimension:{width:0,height:0},receivedShareDimension:{width:1920,height:1080,logicWidth:1920,logicHeight:1080},sharePrivilege:Cd.OnlyHost,activeNodeId:0,activeSsrc:0,shareQuality:1,isRemoteSharingActive:!1,isReceiveSharing:!1,isGrabRemoteControl:!1,isSDKGrabControl:!1,isChromeExtensionInstalled:!1,isScreenShareForbidden:!1,isReceiveSharingFromMainSession:!1,isSharingToBreakoutRoom:!1,isSharingWithSecondCamera:!1,secondCameraId:"default",isRequireReadReceipt:!1,capturedEnsuredCanvas:[],renderedEnsuredCanvas:[],remoteControllingSsrc:0,remoteControlApprovedSsrc:0,remoteControlAppDownloadUrl:"",remoteControlAppInstallStatus:Qa.Unknown,isEnableAutoDeleteRcApp:!1,remoteControlledUserList:[],isRemoteControlEnabled:!1,isFullHDVideoShareEnabled:!1,userSsrcMapping:{},statistic:{encode:{sample_rate:0,rtt:0,jitter:0,avg_loss:0,max_loss:0,width:0,height:0,fps:0,bandwidth:0,bitrate:0},decode:{sample_rate:0,rtt:0,jitter:0,avg_loss:0,max_loss:0,width:0,height:0,fps:0,bandwidth:0,bitrate:0}}},tlt=ru({[`${Fte}`]:Pe((n,e)=>{let{payload:t}=e;n.sharePrivilege=t}),[`${C6}`]:Pe((n,e)=>{let{payload:t}=e;n.isRemoteSharingActive=t.bStatus===1,n.activeNodeId=t.activeNodeID,n.activeSsrc=t.ssrc}),[`${x6}`]:Pe((n,e)=>{let{payload:t}=e;n.isReceiveSharing=t}),[`${fTe}`]:Pe((n,e)=>{let{payload:t}=e;n.isChromeExtensionInstalled=t}),[`${pTe}`]:Pe((n,e)=>{let{payload:t}=e;n.shareDimension={...t}}),[`${Dd}`]:Pe((n,e)=>{let{payload:t}=e;n.status=t}),[`${gTe}`]:Pe((n,e)=>{let{payload:t}=e;n.ssrc=t}),[`${jte}`]:Pe((n,e)=>{let{payload:t}=e;n.shareQuality=t}),[`${cK}`]:Pe((n,e)=>{let{payload:t}=e;n.receivedShareDimension={...t}}),[`${CTe}`]:Pe((n,e)=>{let{payload:t}=e;n.remoteControlledUserList.includes(t)||n.remoteControlledUserList.push(t)}),[`${hK}`]:Pe((n,e)=>{let{payload:t}=e;const r=n.remoteControlledUserList.indexOf(t);r>=0&&n.remoteControlledUserList.splice(r,1)}),[`${$4}`]:Pe((n,e)=>{let{payload:t}=e;n.isGrabRemoteControl=t,t===!1&&(n.remoteControlViewportDomSelector=void 0)}),[`${lK}`]:Pe((n,e)=>{let{payload:t}=e;n.isSDKGrabControl=t}),[`${mTe}`]:Pe((n,e)=>{let{payload:t}=e;n.isReceiveSharingFromMainSession=t}),[`${cP}`]:Pe((n,e)=>{let{payload:t}=e;n.isSharingToBreakoutRoom=t}),[`${vTe}`]:Pe((n,e)=>{let{payload:t}=e;n.isSharingWithSecondCamera=t}),[`${yTe}`]:Pe((n,e)=>{let{payload:t}=e;n.secondCameraId=t}),[`${bTe}`]:Pe((n,e)=>{let{payload:t}=e;n.isRequireReadReceipt=t}),[`${E6}`]:Pe((n,e)=>{let{payload:t}=e;n.isOptimizedForSharedVideo=t}),[`${uK}`]:Pe((n,e)=>{let{payload:t}=e;const{data:{encoding:r,rate:i,...o}}=t;n.statistic.encode={bitrate:i,...o}}),[`${e3}`]:Pe((n,e)=>{let{payload:t}=e;const{data:{encoding:r,rate:i,...o}}=t;n.statistic.decode={bitrate:i,...o}}),[`${STe}`]:Pe((n,e)=>{let{payload:t}=e;n.capturedEnsuredCanvas.includes(t)||n.capturedEnsuredCanvas.push(t)}),[`${_Te}`]:Pe((n,e)=>{let{payload:t}=e;n.renderedEnsuredCanvas.includes(t)||n.renderedEnsuredCanvas.push(t)}),[`${XP}`]:Pe((n,e)=>{let{payload:t}=e;n.remoteControllingSsrc=t}),[`${MC}`]:Pe((n,e)=>{let{payload:t}=e;n.remoteControlApprovedSsrc=t}),[`${wTe}`]:Pe((n,e)=>{let{payload:t}=e;n.remoteControlAppDownloadUrl=t}),[`${s1}`]:Pe((n,e)=>{let{payload:t}=e;(n.remoteControlAppInstallStatus!==Qa.Installed||Qa.Unknown)&&(n.remoteControlAppInstallStatus=t)}),[`${Fp}`]:Pe((n,e)=>{let{payload:t}=e;n.remoteControlAppLaunchSheme=t}),[`${dK}`]:Pe((n,e)=>{let{payload:t}=e;const{userId:r,ssrc:i}=t;Object.assign(n.userSsrcMapping,{[`${r}`]:i})}),[`${Bte}`]:Pe((n,e)=>{let{payload:t}=e;Object.assign(n,t)}),[`${xTe}`]:Pe((n,e)=>{let{payload:t}=e;n.remoteControlViewportDomSelector=t}),[`${ETe}`]:Pe((n,e)=>{let{payload:t}=e;n.isFullHDVideoShareEnabled=t}),[`${ITe}`]:()=>({...ehe})},ehe),nlt={remoteControlEpics0:n=>n.pipe(rn(`${Hh}`),Vt(e=>{const{payload:{meetingOptions:t,rcAutoDelete:r,jwtRc:i,opRc:o}}=e,s=(t==null?void 0:t.isRemoteControlEnbaled)&&o&&i===1;return Bte({isRemoteControlEnabled:s,isEnableAutoDeleteRcApp:r===1})})),remoteControlEpics1:(n,e)=>zt(n,16391).pipe(ht(t=>{const{payload:{body:{bOn:r,sendID:i,receiveID:o}}}=t,{meeting:{userId:s},share:{status:a,activeNodeId:c,isGrabRemoteControl:l}}=e.value,u=[];if(a===Hr.End&&u.push(XP(0)),a!==Hr.End)if(Gl(s,i))if(r){uP(),BK(),a===Hr.Paused&&(nm.resumeSharing(),rm.resumeDesktopSharing(),u.push(Dd(Hr.Sharing))),u.push(XP(o));const h=Yi(e.value).find(f=>Gl(f.userId,o));h&&u.push(dK({userId:h.userId,ssrc:o}))}else u.push(XP(0));else{var d;const h=(d=Yi(e.value))===null||d===void 0?void 0:d.find(f=>Gl(f.userId,i));h&&(u.push(dK({userId:h.userId,ssrc:i})),me(s3e,{userId:h.userId,displayName:h.displayName,isSharingEntireScreen:rm.isSharingEntireScreen()}))}else if(!o||Gl(o,s)){const h=mn(e.value);if(!ma(h.userRole)&&!tn.isAndroidOrIOSBrowser){const f=i&&Gl(c,i);r?(u.push(CTe(c)),f&&(l||nm.subscribeGrabRemoteControl(c,!0))):(u.push(hK(c)),f&&(l&&(nm.subscribeGrabRemoteControl(c,!1),u.push($4(!1)),me(sS,!1)),rm.updateRemoteControlProperties({isControllerNow:!1}))),me(p6,r)}}return Tt(u)})),remoteControlEpics2:(n,e)=>zt(n,16395).pipe(nn(e),st(t=>{let[r,i]=t;return r.payload.body.id===i.meeting.userId}),Vt(t=>{let[r]=t;const{payload:{body:{bOn:i}}}=r;return rm.updateRemoteControlProperties({isControllerNow:i}),me(sS,i),$4(i)})),remoteControlEpics3:n=>Vn(n,[bt.StartRemoteControlSuccess,bt.StartRemoteControlFailed,bt.CancelRemoteControlSuccess]).pipe(OS(e=>e.payload.type===bt.StartRemoteControlSuccess?(me(n3e),lK(!0)):e.payload.type===bt.CancelRemoteControlSuccess?lK(!1):void(e.payload.type===bt.StartRemoteControlFailed&&me(r3e)))),remoteControlEpics4:n=>Vn(n,[bt.RemoteControlCopiedTextNotify,bt.RemoteControlPasteTextLengthOverflow]).pipe(en(e=>{if(e.payload.type===bt.RemoteControlCopiedTextNotify){const{payload:{data:t}}=e;me(Vq,{content:t.data,x:t.x,y:t.y})}else me(Vq,{error:"length of pasted text is too long"})}),$n(Mt)),remoteControlEpics5:(n,e)=>zt(n,4342).pipe(st(t=>t.payload.body.result===0),ht(t=>{const{payload:{body:{downloadUrl:r,ssrc:i,urlScheme:o}}}=t,{share:{remoteControlApprovedSsrc:s,status:a}}=e.value,c=[],{isMacOS:l}=tn;if(a!==Hr.End){if(!s||s===i){uP();try{const p=JSON.parse(r||"{}"),g=l?p.macDownloadUrl:p.winDownloadUrl;c.push(wTe(g))}catch(p){console.warn("unsupported JSON string",p)}}const u={},d=Yi(e.value).find(p=>Gl(p.userId,i));d&&Object.assign(u,{controllerName:Jo(d.displayName)}),Object.assign(u,{ssrc:i});const{deviceId:h}=rm.getShareStreamInfo();h&&Object.assign(u,{DeviceID:h});const f=`${o}&${new URLSearchParams(u).toString()}`;c.push(Fp(f),s1(Qa.Unknown)),me(a3e,f)}return Tt(c)})),remoteControlEpics6:n=>n.pipe(rn(`${Tde}`),ht(()=>hRe.startCheck(1e4).pipe(Vt(()=>(me(Vb,Qa.Unknown),s1(Qa.Unknown)))))),remoteControlEpics7:(n,e)=>n.pipe(rn(`${cB}`),st(()=>{const{share:{remoteControlAppInstallStatus:t}}=e.value;return t===Qa.Installed}),ht(()=>fRe.startCheck(12e4).pipe(ht(()=>{me(Vb,l6.Unlaunched);const{share:{remoteControlApprovedSsrc:t,isEnableAutoDeleteRcApp:r},meeting:{userId:i}}=e.value,o=[],{isMacOS:s}=tn;return t&&(nm.remoteControlConsent(c6.CacheClean,t,i,{...rm.getShareStreamInfo(),platform:s?"mac":"win"},r),o.push(Fp(""),MC(0))),Tt(o)})))),remoteControlEpics8:(n,e)=>n.pipe(rn(`${Fp}`),st(t=>!!t.payload),ht(t=>{const{payload:r}=t,i=[];let o;if(r){(function(a){if(!a.startsWith("zoomprc://"))return;const c=$m("__ZOOM_SDK_RC_APP_SCHEME_@__");let l=document.getElementById(c);l||(l=document.createElement("iframe"),l.id=c,l.style.display="none",document.body.appendChild(l)),l.contentWindow.location.href=a})(r),i.push(cB());const s=performance.now();document.hasFocus()?o=Wk(25).pipe(S1(()=>{const a=performance.now()-s<500;return a||me(Vb,Qa.Uninstalled),a&&e.value.share.remoteControlAppInstallStatus===Qa.Unknown}),zr(()=>{const a=performance.now()-s,c=[];return document.hasFocus()||(a>75?c.push(Tde()):uP(),me(Vb,Qa.Installed),c.push(s1(Qa.Installed),cB())),Tt(c)}),function(){for(var a=[],c=0;c<arguments.length;c++)a[c]=arguments[c];return function(l){return O2(l,hi.apply(void 0,ug([],Gf(a))))}}(s1(Qa.Uninstalled))):(me(Vb,Qa.Unknown),i.push(s1(Qa.Unknown)))}return o?ga(o,Tt(i)):Tt(i)})),remoteControlEpics9:(n,e)=>zt(n,Eq).pipe(ht(()=>(me(R4,iB.Ended),Y6(e.value,nm),Tt([Fp(""),MC(0)])))),remoteControlEpics10:(n,e)=>n.pipe(rn(`${Dd}`),st(t=>{const{share:{remoteControllingSsrc:r,remoteControlApprovedSsrc:i}}=e.value;return!(t.payload!==Hr.End||!r&&!i)}),en(()=>{const{share:{remoteControllingSsrc:t,remoteControlApprovedSsrc:r,isEnableAutoDeleteRcApp:i},meeting:{userId:o}}=e.value,{isMacOS:s}=tn;t&&Y6(e.value,nm),r!==t&&nm.remoteControlConsent(c6.Decline,r,o,{...rm.getShareStreamInfo(),platform:s?"mac":"win"},i)}),$n(Mt)),remoteControlEpics11:(n,e)=>zt(n,16430).pipe(ht(()=>(uP(),BK(),me(Vb,l6.Launched),e.value.share.status!==Hr.End&&function(t,r){(async function(i){const{media:{assetsPath:o}}=i,s=`${o}/qrscanner.min.js`;return"WebQrscanner"in window?Promise.resolve(""):new Promise((a,c)=>{W4.log(`load qr scanner script start. url:${s}`),Jte(s,()=>{W4.log("load qr scanner script done."),a("")},c)})})(t).then(()=>{W4.log("qr scanning start"),r.startRemoteControlQRCheck(!0)})}(e.value,rm),Tt([Fp(""),MC(0)])))),remoteControlEpics12:n=>Vn(n,bt.CurrentDesktopSharingWidthHeight).pipe(en(()=>{nm.syncSharedContentMetaWithRcApp(rm.getShareStreamInfo())}),$n(Mt)),remoteControlEpics13:(n,e)=>Vn(n,bt.SendRemoteControlQrCode).pipe(en(t=>{const{payload:{data:r}}=t,{share:{status:i}}=e.value;i!==Hr.End&&Array.isArray(r)&&r.length>0&&r.forEach(o=>{o!=null&&o.startsWith("zrc_")&&nm.sendRemoteControlAuth(o)})}),$n(Mt)),remoteControlEpics14:n=>zt(n,16434).pipe(en(e=>{const{payload:{body:{result:t}}}=e;t===0&&(pRe(),me(R4,iB.Started))}),$n(Mt)),remoteControlEpics15:(n,e)=>zt(n,Co).pipe(st(t=>{var r,i;const{meeting:{userId:o},share:{remoteControlledUserList:s}}=e.value,{payload:{body:a}}=t;return s.length>0&&(((r=a.update)===null||r===void 0?void 0:r.some(c=>c.id!==o&&c.bShareOn===!1))||((i=a.remove)===null||i===void 0?void 0:i.some(c=>c.id!==o)))}),ht(t=>{var r,i,o,s;const{payload:{body:a}}=t,{share:{remoteControlledUserList:c,activeNodeId:l,isGrabRemoteControl:u},meeting:{userId:d}}=e.value,h=((r=(i=a.update)===null||i===void 0?void 0:i.filter(p=>p.id!==d&&p.bShareOn===!1))!==null&&r!==void 0?r:[]).concat((o=(s=a.remove)===null||s===void 0?void 0:s.filter(p=>p.id!==d))!==null&&o!==void 0?o:[]),f=[];return c.forEach(p=>{h.find(g=>g.id===p)&&(f.push(hK(p)),p===l&&u&&(f.push($4(!1)),me(sS,!1)))}),Tt(f)})),remoteControlEpics16:(n,e)=>n.pipe(rn(`${Bc}`),en(()=>{const{share:{remoteControllingSsrc:t,status:r}}=e.value;r===Hr.Sharing&&t&&me(R4,iB.Ended)}),$n(Mt))},rlt={epics0:(n,e)=>zt(n,Md).pipe(st(t=>{var r;return((r=t.payload.body)===null||r===void 0?void 0:r.lockShare)!==void 0}),nn(e),en(t=>{let[r,i]=t;const{share:{sharePrivilege:o}}=i,{payload:{body:{lockShare:s}}}=r;o!==s&&me(i3e,s)}),Vt(t=>{let[r]=t;return Fte(r.payload.body.lockShare)})),epics1:n=>zt(n,20227).pipe(Vt(e=>gTe(e.payload.body.ssrc))),epics2:(n,e)=>zt(n,Cq).pipe(nn(e),st(t=>{let[r,i]=t;const{payload:{body:o}}=r,{share:{isReceiveSharingFromMainSession:s}}=i;return!s||s&&o.fromMainSession}),Vt(t=>{let[r,i]=t;const{share:{isReceiveSharing:o,activeNodeId:s,isReceiveSharingFromMainSession:a},breakoutRoom:c}=i,{payload:{body:l}}=r;if(o&&l.bStatus===1){let u=!1;(c==null?void 0:c.currentRoom.status)===Cn.InRoom&&c.mainSessionAttendeeList.length>0&&(u=c.mainSessionAttendeeList.findIndex(d=>d.userId===s)>-1),sf.unsubscribeSharing(s,u),FC(sf,i,l.activeNodeID),Cc.switchSharingSource(l.ssrc,a),me(f6,{userId:l.activeNodeID})}else if(l.bStatus===1){const u={activeUserId:l.activeNodeID,isActive:!0};a&&Object.assign(u,{isFromMainSession:!0}),me(Uq,u)}else if(o){const u={activeUserId:l.activeNodeID,isActive:!1};a&&Object.assign(u,{isFromMainSession:!0}),me(Uq,u)}return C6(l)})),epics3:n=>Vn(n,bt.CheckChromeSharingExtensionResponse).pipe(Vt(e=>(me(zq,e.payload.data),fTe(e.payload.data)))),epics4:(n,e)=>Vn(n,[bt.SharingDesktopStreamHaveAudio,bt.SharingDesktopStreamHaveNoAudio]).pipe(st(t=>t.payload.type!==bt.SharingDesktopStreamHaveAudio||!e.value.audio.secondaryAudioMicrophoneId),nn(e),Vt(t=>{let[r,i]=t;const{meeting:{userId:o},share:{isSharingToBreakoutRoom:s,isOptimizedForSharedVideo:a}}=i,{payload:{type:c}}=r,l=c===bt.SharingDesktopStreamHaveAudio;return sf.startSharing(o,{bShareToBO:s,bShareAudio:l,bShareVideo:!!a}),Cc.switchSharingMode(a?GP.VideoMode:GP.Normal),kde(!1)})),epics5:n=>Vn(n,[bt.DesktopSharingError,bt.DesktopSharingChromeExtensionUninstalled,bt.DesktopSharingPermissionDenied,bt.DesktopSharingSystemError]).pipe(ht(e=>{const t=[];let r="";return[bt.DesktopSharingPermissionDenied,bt.DesktopSharingSystemError].includes(e.payload.type)&&(t.push(kde(!0)),e.payload.type===bt.DesktopSharingSystemError?tn.isMacOS&&(r="To use screen share on Chrome, please allow screen recording access in system setting."):r="To use screen share, please allow the permission request."),me(Zke,{reason:r}),Tt(t)})),epics6:n=>Vn(n,bt.CurrentDesktopSharingWidthHeight).pipe(st(e=>!!e.payload.data),Vt(e=>{me(Xke,e.payload.data);const{payload:{data:{width:t,height:r}}}=e;return Cc.ajustmentSharingCanvas(t,r),pTe(e.payload.data)})),epics7:(n,e)=>Vn(n,bt.SharingDecodeMaxSize).pipe(st(t=>!!t.payload.data),nn(e),OS(t=>{let[r,i]=t;const{share:{shareQuality:o,activeNodeId:s}}=i,{payload:{data:{fps:a}}}=r,c=Number(a);if(o!==c)return FC(sf,i,s,c),jte(c)})),epics8:n=>zt(n,20226).pipe(en(e=>{var t,r;if(me(h6,(t=e.payload)===null||t===void 0?void 0:t.body),(r=e.payload)!==null&&r!==void 0&&r.body){const{payload:{body:{width:i,height:o}}}=e;Cc.ajustmentReceivedSharingCanvas(i,o)}}),Vt(e=>cK(e.payload.body))),epics9:n=>Vn(n,bt.SharingPara).pipe(en(e=>{var t,r;if(me(h6,(t=e.payload.data)===null||t===void 0?void 0:t.body),(r=e.payload.data)!==null&&r!==void 0&&r.body){const{payload:{data:{body:{width:i,height:o}}}}=e;Cc.ajustmentReceivedSharingCanvas(i,o)}}),Vt(e=>{var t;return cK((t=e.payload.data)===null||t===void 0?void 0:t.body)})),epics10:(n,e)=>Vn(n,bt.UserStopDesktopSharing).pipe(nn(e),Vt(t=>{let[,r]=t;const{meeting:{userId:i},share:{status:o}}=r;return o!==Hr.End&&(sf.stopSharing(i),Cc.stopDesktopSharing(),me(Yke)),Dd(Hr.End)})),epics11:(n,e)=>zt(n,Co).pipe(nn(e),st(t=>{let[r,i]=t;const{meeting:{userId:o}}=i,s=r.payload.body.update;return s&&s.length>0&&s.findIndex(a=>a.id===o&&a.bShareOn!==void 0)>-1}),ht(t=>{let[r,i]=t;const{meeting:{userId:o},share:{status:s,isReceiveSharing:a,activeNodeId:c}}=i,{payload:{body:{update:l}}}=r,u=l.find(f=>f.id===o&&f.bShareOn===!1),d=l.find(f=>f.id===o&&f.bShareOn===!0),h=[];return u&&s!==Hr.End&&(sf.stopSharing(o),Cc.stopDesktopSharing(),h.push(Dd(Hr.End)),me(Jke)),d&&s===Hr.End&&(a&&(Cc.stopRenderSharing(),sf.unsubscribeSharing(c),h.push(x6(!1))),h.push(Dd(Hr.Sharing))),Tt(h)})),epics12:(n,e)=>zt(n,Co).pipe(nn(e),st(t=>{let[r,i]=t;const{meeting:{userId:o}}=i,s=r.payload.body.update;return s&&s.length>0&&s.findIndex(a=>a.id!==o&&a.bShareOn!==void 0)>-1}),ht(t=>{let[r,i]=t;const{payload:{body:{update:o}}}=r,{share:{activeNodeId:s,isReceiveSharing:a}}=i,c=E1(i),l=o.filter(h=>h.bShareOn===!0&&h.bSharePause===!1),u=o.filter(h=>h.bShareOn===!0&&h.bSharePause===!0),d=o.filter(h=>h.bShareOn===!1);return l.length>0&&l.forEach(h=>{c.findIndex(f=>f.userId===h.id)===-1?me(Tte,h):me(t3e,h)}),u.length>0&&u.forEach(h=>{me(e3e,h)}),d.length>0&&(d.forEach(h=>{me(Dte,h)}),a&&d.some(h=>h.id===s))?Ad(zt(n,Cq).pipe(Ur(1),$n(Mt)),js(50).pipe($n(b1("timeout")))).pipe($f(()=>{const{share:{activeNodeId:h,isReceiveSharingFromMainSession:f},audio:p}=e.value,g=c.filter(m=>m.userId!==h);if(g.length>0){const m=g[0],{userId:v}=m;return sf.unsubscribeSharing(h,f),FC(sf,e.value,v),Cc.switchSharingSource(v,f),p==null||p.localShareAudioUserMutedList.forEach(b=>{Cc.setSharingAudioVolume(v,b.userId!==v||b.muted,b.isFromMainSession)}),me(f6,{userId:v}),hi(C6({activeNodeID:v,bStatus:1,ssrc:v}))}return Mt})):Mt})),epics13:(n,e)=>zt(n,Ste).pipe(nn(e),zr(t=>{let[r,i]=t;const{payload:{body:{encryptKey:o,additionalType:s}}}=r,{media:{sharingDecodeStatus:a,sharingEncodeStatus:c},meeting:{confId:l,userId:u,zoomId:d,meetingId:h,meetingNumber:f,isWebinar:p}}=i;return AS(e).pipe(zr(g=>{let m=c;return(!tn.isSupportSendScreenSharing||p&&g&&ma(g.userRole))&&(m="failed"),Tc("sharing",m,a).pipe(en(v=>{let[b,S]=v;const E={userId:u,sn:Od(d),confId:l,encryptKey:Od(o),encryptType:s,meetingId:h,meetingNumber:f};if(b&&(Cc==null||Cc.updateMediaParams({iVType:fa.SHARING_ENCODE,isFromMainSession:!1,updateParams:E})),S){Cc.updateMediaParams({iVType:fa.SHARING_DECODE,isFromMainSession:!1,updateParams:E});const{participants:{attendeesList:w}}=e.value;if(w.length>0){const C=w.map(I=>({userid:I.userId,sn:I.zoomID&&Od(I.zoomID)}));Cc.updateUserMediaSN({added:C,isFromMainSession:!1,iVType:fa.SHARING_DECODE})}}}),$n(Mt))}))})),epics14:(n,e)=>Uf(n,20235).pipe(nn(e),en(t=>{let[r,i]=t;const{media:{sharingDecodeStatus:o}}=i,{type:s,payload:{body:a}}=r,c=s===`${Um}`;Tc("sharing","success",o).subscribe(l=>{let[,u]=l;u&&Cc.addReceivedSharingChannelType({isFromMainSession:c,...a})})}),$n(Mt)),epics15:(n,e)=>Uf(n,20236).pipe(nn(e),en(t=>{let[r,i]=t;const{media:{sharingDecodeStatus:o}}=i,{type:s,payload:{body:{ssrc:a}}}=r,c=s===`${Um}`;Tc("sharing","success",o).subscribe(l=>{let[,u]=l;u&&Cc.removeReceivedSharingChannelType({isFromMainSession:c,ssrc:a})})}),$n(Mt)),epics16:n=>Vn(n,bt.SharingFirstDecodeFrameReceivedSsrc).pipe(st(e=>!!e.payload.data),en(e=>{const{payload:{data:{ssrc:t}}}=e;sf.sendReceivingSharingReady(t)}),$n(Mt)),epics17:(n,e)=>zt(n,20233).pipe(st(()=>!!e.value.share.isRequireReadReceipt),en(t=>{const{payload:{body:{bReceiveOk:r}}}=t;r&&me(o3e)}),$n(Mt)),epics18:(n,e)=>zt(n,Md).pipe(st(t=>{var r;return((r=t.payload.body)===null||r===void 0?void 0:r.lockShare)!==void 0}),ht(t=>{const{payload:{body:{lockShare:r}}}=t,{share:{isOptimizedForSharedVideo:i,isSharingToBreakoutRoom:o},audio:{isSharingAudio:s},meeting:{userId:a}}=e.value,c=[];return r===Cd.MultipleShare&&i&&(sf.startSharing(a,{bShareAudio:s,bShareToBO:o,bShareVideo:!1}),Cc.switchSharingMode(GP.Normal),c.push(E6(!1))),Tt(c)})),epics19:(n,e)=>Vn(n,bt.ShareQosData).pipe(nn(e),Vt(t=>{var r;let[i,o]=t;const{meeting:{isWebinar:s},media:{sharingEncodeStatus:a,sharingDecodeStatus:c},share:{status:l,isReceiveSharing:u},participants:{xmppAttendeeList:d}}=o;let h=Mte(o).length>0;s&&(h=h||!!d.length);const f=l!==Hr.End&&a==="success"&&h,p=u&&c==="success";return(r=i.payload.data)!==null&&r!==void 0&&r.encoding?f?(me(Wq,i.payload),uK(i.payload)):uK($0):p?(me(Wq,i.payload),e3(i.payload)):e3($0)}))},ilt=iu(rlt,nlt),ch=Gr.createAgent();let Op=function(n){return n.Add="add",n.List="list",n.Remove="memberremove",n.rename="rename",n.update="UPDATE",n}({}),Tm=function(n){return n.Open="open",n.Message="message",n.Error="error",n.Close="close",n}({});class l_{constructor(){this.eventHandlers=void 0,this.websocket=void 0,this.seq=void 0,this.eventHandlers=new Map,this.websocket=null,this.seq=1}static getInstance(){return this.xmppInstance||(this.xmppInstance=new l_),this.xmppInstance}on(e,t){let r=this.eventHandlers.get(e);r||(r=[]),r.push(t),this.eventHandlers.set(e,r)}off(e,t){const r=this.eventHandlers.get(e);if(r){const i=r.filter(o=>o!==t);this.eventHandlers.set(e,i)}}emit(e,t){const r=this.eventHandlers.get(e);r&&r instanceof Array&&r.slice(0).forEach(i=>{try{i(t)}catch(o){console.error(o)}})}sendMessageToRwg(e){this.seq+=1;const t=this.seq;return this.websocket&&this.websocket.readyState===WebSocket.OPEN&&this.websocket.send(JSON.stringify(Object.assign(e,{seq:t}))),t}connect(e){this.websocket=new WebSocket(e),this.websocket.binaryType="arraybuffer",this.addWebSocketEventListeners()}close(){var e;(e=this.websocket)===null||e===void 0||e.close()}addWebSocketEventListeners(){this.websocket&&(this.websocket.addEventListener("open",e=>{this.emit(Tm.Open,e)}),this.websocket.addEventListener("message",e=>{const{data:t}=e;var r;if(t instanceof ArrayBuffer)new Uint8Array(t)[0]===0&&((r=this.websocket)===null||r===void 0||r.send(t));else try{this.emit(Tm.Message,JSON.parse(t))}catch{console.warn("Unsupported format",t)}}),this.websocket.addEventListener("close",e=>{this.emit(Tm.Close,e)}),this.websocket.addEventListener("error",e=>{this.emit(Tm.Error,e)}))}join(e){return{seq:this.sendMessageToRwg({evt:24576,body:{clientCap:e}})}}raiseHand(){return{seq:this.sendMessageToRwg({evt:24580,body:null})}}lowerHand(e){return{seq:this.sendMessageToRwg({evt:24578,jids:e||[]})}}sendWebinarMseeage(e,t,r){const i={msg:e,jid:t?[t]:[],type:r,bcm:arguments.length>3&&arguments[3]!==void 0&&arguments[3]};return{seq:this.sendMessageToRwg({evt:24582,body:i})}}sendAnswer(e,t,r){return{seq:this.sendMessageToRwg({evt:24584,body:{question_attendeejid:t.jid,question_attendeename:t.displayName,question_text:t.questionText,question_id:t.questionId,question_anonymous:t.isAnonymous,question_time:t.questionTime,text:e,isPrivate:r}})}}answerOnline(e,t){return{seq:this.sendMessageToRwg({evt:24586,body:{question_attendeejid:e.jid,question_attendeename:e.displayName,question_text:e.questionText,question_id:e.questionId,question_anonymous:e.isAnonymous,question_time:e.questionTime,isLiveStart:t}})}}dismissQuestion(e){return{seq:this.sendMessageToRwg({evt:24590,body:{question_attendeejid:e.jid,question_attendeename:e.displayName,question_text:e.questionText,question_id:e.questionId,question_anonymous:e.isAnonymous,question_time:e.questionTime,bOpen:!1}})}}deleteQuestion(e){return{seq:this.sendMessageToRwg({evt:24614,body:{question_id:e,bDelete:!0}})}}deleteComment(e){return{seq:this.sendMessageToRwg({body:{comment_id:e,bDelete:!0},evt:24616})}}reopenQuestion(e){return{seq:this.sendMessageToRwg({body:{question_attendeejid:e.jid,question_attendeename:e.displayName,question_text:e.questionText,question_id:e.questionId,question_anonymous:e.isAnonymous,question_time:e.questionTime,bOpen:!0},evt:24590})}}askQuestion(e,t){let r=arguments.length>2&&arguments[2]!==void 0&&arguments[2],i=arguments.length>3?arguments[3]:void 0;const o=XM();return{seq:this.sendMessageToRwg({body:{id:o,text:e,isAnonymous:r,bAllowAttendeeViewAllQuestion:i,name:t},evt:24592}),questionId:o}}upOrDownVote(e,t){return{seq:this.sendMessageToRwg({body:{question_attendeejid:e.jid,question_attendeename:e.displayName,question_text:e.questionText,question_id:e.questionId,question_anonymous:e.isAnonymous,question_time:e.questionTime,bUpVote:t},evt:24598})}}rename(e,t){return{seq:this.sendMessageToRwg({body:{jid:e,displayName:t},evt:24600})}}setSkinTome(e){return{seq:this.sendMessageToRwg({body:{skinTone:e},evt:24618})}}}l_.xmppInstance=null;const olt=xl.getInstance();let Cb,the;const slt=Gr.createAgent();let Ll=null;function vRe(n){switch(n.responseType){case"json":if("response"in n)return n.response;var e=n;return JSON.parse(e.responseText);case"document":return n.responseXML;default:return"response"in n?n.response:(e=n).responseText}}var alt=function(n,e,t,r){r===void 0&&(r="download_load"),this.originalEvent=n,this.xhr=e,this.request=t,this.type=r;var i=e.status,o=e.responseType;this.status=i??0,this.responseType=o??"";var s=e.getAllResponseHeaders();this.responseHeaders=s?s.split(`
`).reduce(function(l,u){var d=u.indexOf(": ");return l[u.slice(0,d)]=u.slice(d+2),l},{}):{},this.response=vRe(e);var a=n.loaded,c=n.total;this.loaded=a,this.total=c},t8=YT(function(n){return function(e,t,r){var i;this.message=e,this.name="AjaxError",this.xhr=t,this.request=r,this.status=t.status,this.responseType=t.responseType;try{i=vRe(t)}catch{i=t.responseText}this.response=i}}),clt=function(){function n(e,t){return t8.call(this,"ajax timeout",e,t),this.name="AjaxTimeoutError",this}return n.prototype=Object.create(t8.prototype),n}(),llt=Vt(function(n){return n.response}),Vv,wh=(Vv=function(n){var e;return e=typeof n=="string"?{url:n}:n,new Ns(function(t){var r,i,o,s=UP({async:!0,crossDomain:!1,withCredentials:!1,method:"GET",timeout:0,responseType:"json"},e),a=s.queryParams,c=s.body,l=s.headers,u=s.url;if(!u)throw new TypeError("url is required");if(a)if(u.includes("?")){var d=u.split("?");if(2<d.length)throw new TypeError("invalid url");o=new URLSearchParams(d[1]),new URLSearchParams(a).forEach(function(B,U){return o.set(U,B)}),u=d[0]+"?"+o}else u=u+"?"+(o=new URLSearchParams(a));var h={};if(l)for(var f in l)l.hasOwnProperty(f)&&(h[f.toLowerCase()]=l[f]);var p=s.crossDomain;p||"x-requested-with"in h||(h["x-requested-with"]="XMLHttpRequest");var g=s.withCredentials,m=s.xsrfCookieName,v=s.xsrfHeaderName;if((g||!p)&&m&&v){var b=(i=(r=document==null?void 0:document.cookie.match(new RegExp("(^|;\\s*)("+m+")=([^;]*)")))===null||r===void 0?void 0:r.pop())!==null&&i!==void 0?i:"";b&&(h[v]=b)}var S,E=function(B,U){var K;if(!B||typeof B=="string"||function(z){return typeof FormData<"u"&&z instanceof FormData}(B)||function(z){return typeof URLSearchParams<"u"&&z instanceof URLSearchParams}(B)||function(z){return IB(z,"ArrayBuffer")}(B)||function(z){return IB(z,"File")}(B)||function(z){return IB(z,"Blob")}(B)||function(z){return typeof ReadableStream<"u"&&z instanceof ReadableStream}(B))return B;if(function(z){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView(z)}(B))return B.buffer;if(typeof B=="object")return U["content-type"]=(K=U["content-type"])!==null&&K!==void 0?K:"application/json;charset=utf-8",JSON.stringify(B);throw new TypeError("Unknown body type")}(c,h),w=UP(UP({},s),{url:u,headers:h,body:E});S=e.createXHR?e.createXHR():new XMLHttpRequest;var C=e.progressSubscriber,I=e.includeDownloadProgress,T=I!==void 0&&I,D=e.includeUploadProgress,O=D!==void 0&&D,M=function(B,U){S.addEventListener(B,function(){var K,z=U();(K=C==null?void 0:C.error)===null||K===void 0||K.call(C,z),t.error(z)})};M("timeout",function(){return new clt(S,w)}),M("abort",function(){return new t8("aborted",S,w)});var R=function(B,U){return new alt(U,S,w,B+"_"+U.type)},A=function(B,U,K){B.addEventListener(U,function(z){t.next(R(K,z))})};O&&[xB,EB,rhe].forEach(function(B){return A(S.upload,B,ult)}),C&&[xB,EB].forEach(function(B){return S.upload.addEventListener(B,function(U){var K;return(K=C==null?void 0:C.next)===null||K===void 0?void 0:K.call(C,U)})}),T&&[xB,EB].forEach(function(B){return A(S,B,nhe)});var k=function(B){var U="ajax error"+(B?" "+B:"");t.error(new t8(U,S,w))};S.addEventListener("error",function(B){var U;(U=C==null?void 0:C.error)===null||U===void 0||U.call(C,B),k()}),S.addEventListener(rhe,function(B){var U,K,z=S.status;if(z<400){(U=C==null?void 0:C.complete)===null||U===void 0||U.call(C);var G=void 0;try{G=R(nhe,B)}catch(te){return void t.error(te)}t.next(G),t.complete()}else(K=C==null?void 0:C.error)===null||K===void 0||K.call(C,B),k(z)});var L=w.user,j=w.method,N=w.async;for(var f in L?S.open(j,u,N,L,w.password):S.open(j,u,N),N&&(S.timeout=w.timeout,S.responseType=w.responseType),"withCredentials"in S&&(S.withCredentials=w.withCredentials),h)h.hasOwnProperty(f)&&S.setRequestHeader(f,h[f]);return E?S.send(E):S.send(),function(){S&&S.readyState!==4&&S.abort()}})},Vv.get=function(n,e){return wh({method:"GET",url:n,headers:e})},Vv.post=function(n,e,t){return wh({method:"POST",url:n,body:e,headers:t})},Vv.delete=function(n,e){return wh({method:"DELETE",url:n,headers:e})},Vv.put=function(n,e,t){return wh({method:"PUT",url:n,body:e,headers:t})},Vv.patch=function(n,e,t){return wh({method:"PATCH",url:n,body:e,headers:t})},Vv.getJSON=function(n,e){return llt(wh({method:"GET",url:n,headers:e}))},Vv),ult="upload",nhe="download",xB="loadstart",EB="progress",rhe="load",dlt=Object.prototype.toString;function IB(n,e){return dlt.call(n)==="[object "+e+"]"}const ihe=xl.getInstance(),PB=n=>{const{meeting:{encryptedRWC:e,encryptedGEORWC:t,discardedRwcList:r,meetingOptions:i}}=n;let o=[];return i!=null&&i.isEnableGeoFenceRWC&&t&&(t==null?void 0:t.length)>0?o=t.filter(s=>!r.includes(s.rwc)).reduce((s,a)=>{const{dl:c,rwc:l,rwcToken:u}=a,d=s.find(h=>h.dl===c);if(d)d.items.push({rwc:l,rwcToken:u});else{const h={dl:c,items:[]};h.items.push({rwc:l,rwcToken:u}),s.push(h)}return s},[]):e&&(o=[{dl:0,items:Object.keys(e).map(s=>({rwc:s,rwcToken:e[s]}))}]),o},kB=n=>ga(...n.map(e=>e.dl===0?Tt(e.items):js(e.dl).pipe(ht(()=>Tt(e.items))))),ohe=(n,e)=>n.pipe(rn(`${yte}`),nn(e),st(t=>{let[,r]=t;return r.meeting.encryptedRWC!==void 0||r.meeting.encryptedGEORWC!==void 0&&r.meeting.encryptedGEORWC.length>0}),zr(t=>{let[,r]=t;const{meeting:{ts:i,auth:o,meetingNumber:s,meetingOptions:a,meetingId:c,userName:l},breakoutRoom:u}=r,d=a==null?void 0:a.isEnableGeoFenceRWC,h=PB(r);if(h.length>0){const f={serversLength:h.reduce((g,m)=>g+m.items.length,0),pingFailedServerList:[],pingRwcServerCounts:0,retryCounts:0};let p;return d&&(p=new dst,kB(h).subscribe(g=>{var m;return(m=p)===null||m===void 0?void 0:m.next(g)})),(d?p:kB(h)).pipe(qp(n.pipe(rn(`${IS}`))),S1(()=>{const{meeting:{meetingStatus:g,meetingId:m}}=e.value,v=g===ws.Initial&&!!m&&f.pingFailedServerList.length<f.serversLength&&f.serversLength>0;return!v&&p&&p.complete(),v}),en(()=>{if(f.pingRwcServerCounts=f.pingRwcServerCounts+1,d&&f.pingRwcServerCounts===f.serversLength){const g=1e3*Math.floor(5*Math.pow(2,f.retryCounts));f.retryCounts=f.retryCounts+1,ihe.makeLogger(["Join Meeting Flow"]).info(`ping rwc retry,current rwc list:${JSON.stringify(PB(e.value))},retry counts:${f.retryCounts}, ${JSON.stringify({meetingId:c,meetingNumber:oc(s),userName:oc(l)})}`,["Ping RWC Retry"]),js(g).pipe(Vt(()=>{const m=PB(e.value);return Object.assign(f,{serversLength:m.reduce((v,b)=>v+b.items.length,0),pingFailedServerList:[],pingRwcServerCounts:0}),m})).subscribe(m=>{kB(m).subscribe(v=>{p.next(v)})})}}),ht(g=>{const{rwc:m,rwcToken:v}=g,b=((S,E,w,C,I,T)=>{const D={ts:C,auth:I,rwcToken:w,dmz:1};return T&&Object.assign(D,{confID:T}),`https://${S}/wc/ping/${E}?${new URLSearchParams(D).toString()}`})(m,s,v,i,o,u==null?void 0:u.currentRoom.boConfId);return wh({url:b,crossDomain:Lf(b)}).pipe(ht(S=>{let E={};return E=S.response?{...S.response,rwc:m,fromNginx:!1}:{rwc:m,rwg:m,rwcToken:v,fromNginx:!0},Tt([oPe(E),_4()])}),$f(()=>{const{pingFailedServerList:S,serversLength:E}=f;return S.push(b),S.length===E&&(d&&p&&p.complete(),ihe.report(`ping rwc error, ${JSON.stringify({meetingId:c,meetingNumber:oc(s),userName:oc(l)})}`,["Join Meeting Flow","Ping RWC Error"],"error"),me(cs,{reason:"connection error",errorCode:mf.CommonError})),Mt}))}),Nh(MPe(performance.now())))}return Mt}));let she=0;const hlt=xl.getInstance(),TB={meetingStatus:ws.Initial,isWindowOpen:!1,apiKey:"",signature:"",signatureType:"",lang:"en-US",tk:"",customerKey:"",mtkGuid:"",pingRWCTimestamp:0,meetingInfoTimestamp:0,passWord:"",meetingNumber:0,userName:"",userEmail:"",sdkUrl:"",sdkOrigin:"",proxy:1,cv:"",meetingId:"",tid:"",ts:"",auth:"",sign:"",isSupportCallOut:!1,tollNumbers:void 0,recordingEnable:!1,callOutCountry:void 0,inviteEmail:"",xmppConfig:null,isSupportH323:!1,h323GatewayInfo:"",h323Password:"",trackAuth:"",isOriginHost:!1,isWebinar:!1,encryptedRWC:void 0,meetingOptions:{},meetingTopic:"",bLock:!1,bHoldUponEntry:!1,viewOnly:0,listenOnlyPhone:0,bAllowRaiseHand:!1,bAllowAttendeeRename:!1,bBroadcast:void 0,bAllowPlayChimeForEnterOrExit:!1,bIbDisableShare:!1,bIbDisableChat:!1,bAllowShowCount:!1,encryptKey:"",bNoHostTimeOut:!1,confId:"",conId:"",e2eEncrypt:!1,zoomId:"",jid:"",xtoken:"",groups:void 0,svcUrl:"",encType:NaN,userGUID:"",userId:NaN,isHost:!1,isCoHost:!1,participantID:0,isOnHold:!1,isMeetingReset:!1,bRecord:!1,audioVideoBeforeOnHold:void 0,region:void 0,network:void 0,joinMeetingTimeStamp:0,activeAppInfo:void 0,recordingDisclaimerForRecorder:{},recordingDisclaimer:{},ccUrl:"",sessionIdleTimeoutMins:40,reportDomain:"",isAudioBridgeEnabled:!0,discardedRwcList:[],sharePronounType:void 0,stayAwake:!1,wrInfo:{},meetingInfo:{},isNewJoinFlow:!1,gatewayUserList:[],logConfig:"",logEncryptionPubKey:"",failover:{count:0,isCurrentFailoverRecorded:!1,reason:-1,interval:0,joinMeetingSuccessTimestamp:0,sequence:""},enableLongPollingCheckStart:!1,rsPwd:"",chatModerationPolicy:{}},flt=ru({[`${Hh}`]:Pe((n,e)=>{let{payload:t}=e;t.customerKey=n.customerKey||t.customerKey||"",Object.assign(n,t),n.meetingStatus=ws.Initial}),[`${sat}`]:Pe((n,e)=>{let{payload:t}=e;t.customerKey=n.customerKey||t.customerKey||"",Object.assign(n,t)}),[`${aat}`]:Pe((n,e)=>{let{payload:t}=e;n.isWindowOpen=t}),[`${OPe}`]:Pe((n,e)=>{let{payload:t}=e;t.useSDK?n.signatureType="sdk":n.signatureType="api",n.apiKey=t.apiKey,n.signature=t.signature,n.lang=t.language}),[`${cat}`]:Pe((n,e)=>{let{payload:t}=e;n.ztk=t}),[`${lat}`]:Pe((n,e)=>{let{payload:t}=e;n.zsk=t}),[`${uat}`]:Pe((n,e)=>{let{payload:t}=e;n.tk=t.tk,n.mtkGuid=t.mtkGuid}),[`${MPe}`]:Pe((n,e)=>{let{payload:t}=e;n.pingRWCTimestamp=t}),[`${JPe}`]:Pe((n,e)=>{let{payload:t}=e;n.meetingInfoTimestamp=t}),[`${av}`]:Pe((n,e)=>{let{payload:t}=e;n.confId=t.confID,n.conId=t.conID,n.e2eEncrypt=t.e2eEncrypt,n.meetingNumber=parseInt(t.mn,10),n.zoomId=t.zoomID,n.meetingStatus=ws.Joined,n.jid=t.jid,n.xtoken=t.xtoken,n.groups=t.groups,n.svcUrl=t.svcUrl,n.encType=t.encType,n.userGUID=t.userGUID,n.userId=t.userID,n.role=t.role,n.participantID=t.participantID,n.reportDomain=t.reportDomain,n.abToken=t.ABtoken,n.supportLocalAB=!!t.supportLocalAB,t.enableWebTransport&&(n.enableWebtransport=t.enableWebTransport,n.webtransportPort=t.WebTransportPort)}),[`${QM}`]:Pe((n,e)=>{let{payload:t}=e;if(t.gatewayUser){var r;const{userId:o,sn:s}=t.gatewayUser,a=(r=n.gatewayUserList)===null||r===void 0?void 0:r.find(c=>c.userId===o);var i;a?a.sn=s:(i=n.gatewayUserList)===null||i===void 0||i.push(t.gatewayUser)}else Object.assign(n,t)}),[`${$Pe}`]:Pe((n,e)=>{let{payload:t}=e;n.isHost=t}),[`${LPe}`]:Pe((n,e)=>{let{payload:t}=e;n.isCoHost=t}),[`${Ww}`]:Pe((n,e)=>{let{payload:t}=e;n.isOnHold=t}),[`${NPe}`]:Pe((n,e)=>{let{payload:t}=e;n.isMeetingReset=t}),[`${FPe}`]:Pe((n,e)=>{let{payload:t}=e;n.audioVideoBeforeOnHold=t}),[`${jPe}`]:Pe((n,e)=>{let{payload:t}=e;n.currentUserAudioBeforeReset=t}),[`${BPe}`]:Pe((n,e)=>{let{payload:t}=e;n.isCurrentUserMutedBeforeReset=t}),[`${bte}`]:Pe((n,e)=>{let{payload:t}=e;n.meetingStatus=t}),[`${HPe}`]:Pe((n,e)=>{let{payload:t}=e;n.region=t.region,n.network=t.network}),[`${UPe}`]:Pe((n,e)=>{let{payload:t}=e;n.isCurrentUserStartVideoBeforeReset=t}),[`${zPe}`]:Pe((n,e)=>{let{payload:t}=e;n.joinMeetingTimeStamp=t}),[`${dat}`]:Pe((n,e)=>{let{payload:t}=e;n.activeAppInfo=t}),[`${oP}`]:Pe((n,e)=>{let{payload:t}=e;n.idleStartTime=t}),[`${VPe}`]:Pe((n,e)=>{let{payload:t}=e;n.sessionIdleTimeoutMins=t}),[`${WPe}`]:Pe((n,e)=>{let{payload:t}=e;n.isAudioBridgeEnabled=t}),[`${qPe}`]:Pe((n,e)=>{var t,r;let{payload:i}=e;const o=(t=n.encryptedGEORWC)===null||t===void 0||(r=t.find(a=>a.rwc===i))===null||r===void 0?void 0:r.dc;if(o){var s;const a=(s=n.encryptedGEORWC)===null||s===void 0?void 0:s.filter(c=>c.dc===o);a&&n.discardedRwcList.some(c=>(a==null?void 0:a.findIndex(l=>l.rwc===c))>=0)&&n.discardedRwcList.push(...a.map(c=>c.rwc)),n.discardedRwcList.push(i)}}),[`${KPe}`]:Pe((n,e)=>{let{payload:t}=e;n.sharePronounType=t}),[`${GPe}`]:Pe((n,e)=>{let{payload:t}=e;n.stayAwake=t}),[`${ZPe}`]:Pe((n,e)=>{let{payload:t}=e;n.failover.joinMeetingSuccessTimestamp=t}),[`${XPe}`]:Pe(n=>{Object.assign(n.failover,{...TB.failover,count:n.failover.count,joinMeetingSuccessTimestamp:n.failover.joinMeetingSuccessTimestamp})}),[`${e6}`]:Pe((n,e)=>{let{payload:t}=e;const{count:r,reason:i,interval:o,sequence:s}=t;n.failover.count=r,n.failover.reason=i,n.failover.interval=o,n.failover.isCurrentFailoverRecorded=!0,n.failover.sequence=s}),[`${YPe}`]:Pe((n,e)=>{let{payload:t}=e;n.quicklyLeave=t}),[`${QPe}`]:Pe((n,e)=>{let{payload:t}=e;n.isEnableZmkFromRWG=t}),[`${_q}`]:(n,e)=>{let{payload:t}=e;const{isFailover:r}=t,i={isMeetingReset:!0,apiKey:n.apiKey,signatureType:n.signatureType,signature:n.signature,lang:n.lang,proxy:1,stayAwake:n.stayAwake};return r&&Object.assign(i,{currentUserAudioBeforeReset:n.audioVideoBeforeOnHold?n.audioVideoBeforeOnHold.audio:t.audio,isCurrentUserMutedBeforeReset:n.audioVideoBeforeOnHold?n.audioVideoBeforeOnHold.muted:t.muted,isCurrentUserStartVideoBeforeReset:n.audioVideoBeforeOnHold?n.audioVideoBeforeOnHold.video:t.video,meetingNumber:n.meetingNumber,userName:n.userName,passWord:n.passWord,userEmail:n.userEmail,sdkUrl:n.sdkUrl,sdkOrigin:n.sdkOrigin,cv:n.cv,zsk:n.zsk,ztk:n.ztk,idleStartTime:n.idleStartTime,sessionIdleTimeoutMins:n.sessionIdleTimeoutMins,customerKey:n.customerKey,failover:n.failover,stayAwake:n.stayAwake,quicklyLeave:n.quicklyLeave}),{...TB,...i}}},TB),plt={meetingFailoverReportEpic0:(n,e)=>n.pipe(rn(`${Hh}`),zr(()=>{const t=e.value.meeting.failover.joinMeetingSuccessTimestamp===0&&!!rr.get(Gi.WebclientZoomId);return n.pipe(rn(`${av}`),Ur(1),ht(()=>{const r=[],{count:i,sequence:o}=rr.get(Gi.WebclientFailoverCount)||{};let{meeting:{failover:{count:s,reason:a,interval:c}}}=e.value;const{meeting:{pingRWCTimestamp:l}}=e.value;if(t){s=i+1,a=La.RefreshPage,c=0;const h=o?`${o}-${a}`:`${a}`;rr.set(Gi.WebclientFailoverCount,{count:s,sequence:h},ri.SessionStorage),r.push(e6({count:s,reason:a,interval:c,sequence:h}))}const u=performance.now();let d=`WCL_M, JMCT(${u-l})`;return s>0&&a!==La.NormalCase&&(d=`${d},FAILOVER(${s},${a},${(c/1e3).toFixed(1)})`),slt.sendRWGConnectionPerformance(d),r.push(XPe(),ZPe(u)),Tt(r)}))})),meetingFailoverReportEpic1:(n,e)=>n.pipe(rn(`${Bc}`),ht(t=>{const{payload:r}=t,{meeting:{failover:{joinMeetingSuccessTimestamp:i,isCurrentFailoverRecorded:o},userGUID:s,userId:a}}=e.value,c=[];if(!o){let{count:l,sequence:u}=rr.get(Gi.WebclientFailoverCount)||{};u=u?`${u}-${r}`:`${r}`,r!==La.NormalCase&&(l+=1,rr.set(Gi.WebclientFailoverCount,{count:l,sequence:u},ri.SessionStorage));const d=performance.now()-i;c.push(e6({reason:r,count:l,interval:d,sequence:u,userGUID:s,userId:a}))}return Tt(c)}))},glt={sessionIdleEpic0:(n,e)=>n.pipe(rn(`${av}`),nn(e),st(t=>{let[,r]=t;return r.meeting.zlkJwtToken!==void 0}),zr(()=>(Cb&&Cb.complete(),Cb=new Lh,the=Wk(6e4).pipe(Vt(()=>performance.now())).subscribe(Cb),Cb.pipe(Vt(t=>sde(t)))))),sessionIdleEpic1:n=>n.pipe(rn(`${Zf}`)).pipe(en(()=>{Cb&&(Cb.complete(),the.unsubscribe())}),$n(Mt)),sessionIdleEpic2:(n,e)=>n.pipe(rn(`${sde}`),nn(e),ht(t=>{var r;let[i,o]=t;const{meeting:{idleStartTime:s,sessionIdleTimeoutMins:a,isOriginHost:c,isWebinar:l},participants:{attendeesList:u,xmppAttendeeList:d},recording:h,breakoutRoom:f}=o,p=i.payload,g=[];if(u.length!==1||l&&d.length!==0||(f==null||(r=f.currentRoom)===null||r===void 0?void 0:r.status)===Cn.InRoom||(h==null?void 0:h.cmrStatus)===da.Start)g.push(oP(void 0));else if(s){const m=c&&m6(u[0].userRole)?a:40;p-s>60*m*1e3&&(console.warn(`No active for ${m} minutes, will end the session.`),olt.report(`Session idle timeout(${m} minutes), end the session automatically!`,["Join Meeting Flow","Session idle"],"warn"),g.push(N2()),js(500).subscribe(()=>{Ote()}))}else g.push(oP(p));return Tt(g)})),sessionIdleEpic3:(n,e)=>n.pipe(rn(`${c_}`),st(t=>[Co,Md].includes(t.payload.evt)&&e.value.meeting.idleStartTime!==void 0),bl(Ag),ht(()=>{var t;const{participants:{attendeesList:r,xmppAttendeeList:i},recording:o,breakoutRoom:s}=e.value,a=[];return(r.length>1||i.length>0||(o==null?void 0:o.cmrStatus)===da.Start||(s==null||(t=s.currentRoom)===null||t===void 0?void 0:t.status)===Cn.InRoom)&&a.push(oP(void 0)),Tt(a)})),sessionIdleEpic4:n=>n.pipe(rn(`${IS}`,`${N2}`),Lu(oP(void 0)))},mlt={meetingMainEpics0:(n,e)=>zt(n,0).pipe(en(t=>{var r;if(((r=t.payload.body)===null||r===void 0?void 0:r.status)==="READY"){const{meeting:{zlkJwtToken:i,signatureType:o,sign:s,passWord:a,isHost:c,isOriginHost:l,ztk:u,zsk:d,tk:h,userEmail:f},breakoutRoom:p}=e.value,g=i?{zlkJwtToken:i}:{signType:o,sign:s};if(a&&a!==""&&(i?Object.assign(g,{mpwd:Jo(a)}):c&&l||Object.assign(g,{mpwd:a})),(p==null?void 0:p.currentRoom.status)===Cn.Joining){const{currentRoom:{boId:v,boConfId:b,boToken:S}}=p;v&&b&&S&&Object.assign(g,{botk:S})}if(!i){u&&Object.assign(g,{zak:u}),(sessionStorage.getItem(Gi.WebclientZsk)||d)&&Object.assign(g,{zak:d}),h&&Object.assign(g,{tk:h});const v=rr.get(Gi.WebclientWebinarToken);v!==void 0&&Object.assign(g,{tk:v});const b=sessionStorage.getItem(Gi.WebclientRecordingToken);b&&Object.assign(g,{localRecordToken:b}),f&&Object.assign(g,{email:f})}ch.sendLaunchParams(g);const m=rr.get(Gi.WebclientMeetingToken);m&&ch.joinMeeting(m)}}),$n(Mt)),meetingMainEpics1:(n,e)=>{return zt(n,y7).pipe(nn(e),(t=r=>{let[i,o]=r;const{payload:{body:{res:s,userID:a,zoomID:c,mn:l,participantID:u,meetingtoken:d,role:h}}}=i,{meeting:{userEmail:f,userName:p,isMeetingReset:g,apiKey:m,zsk:v,signatureType:b}}=o;if(Eu.Success===s){const{WebclientParticipantId:E,WebclientZoomId:w,WebclientUserEmail:C,WebclientUserName:I,WebclientMeetingToken:T}=Gi;rr.set(w,c,ri.SessionStorage),rr.set(E,u,ri.SessionStorage),f&&rr.set(C,f,ri.SessionStorage),rr.set(I,p,ri.SessionStorage),d&&rr.set(T,d,ri.SessionStorage),v&&ch.sendSdkKeyToMonitor(b,m,a);const D=[av(i.payload.body),zPe(performance.now())];return g&&D.push(NPe(!1)),(h&TS.Owner)===TS.Owner&&(me(cs,{reason:"dont support assisnt join through widget",errorCode:-1}),ch.leaveMeeting()),me(cke,{meetingNumber:l}),Tt(D)}if(Eu.MeetingLocked===s)me(cs,wp(s));else if(Eu.UserFull===s)me(cs,Object.assign({},wp(s),{lmUrl:i.payload.body.lmURL}));else if(Eu.MeetingIsOver===s)me(cs,wp(s));else if(Eu.MMRIBReject===s)me(cs,wp(s));else if(Eu.MMRConfParticipantExists===s)me(cs,wp(s));else if([Eu.UserHasBeenRemoved,Eu.WebinarBlockedEmail].includes(s))me(cs,wp(s));else if(Eu.MeetingNotStarted===s){var S;const E=wp(s),{meeting:{meetingNumber:w,passWord:C,userName:I,userEmail:T,inviteEmail:D,meetingTopic:O,region:M,network:R,userId:A,lang:k,meetingId:L,participantID:j,wrInfo:N,meetingInfo:B,isNewJoinFlow:U,enableLongPollingCheckStart:K,tid:z,signature:G,rsPwd:te}}=o;Object.assign(E,{meetingInfo:{meetingNumber:w,password:C,userName:I,userEmail:T,inviteEmail:D,meetingTopic:O,region:M,network:R,userId:A,lang:k,webEndpoint:UDe(),meetingId:L,participantId:j,wrInfo:Object.assign({},N,{isNew:U}),scheduleInfo:B,enableLongPollingCheckStart:K,rid:sct(z),role:Number((S=ES(G))===null||S===void 0?void 0:S.role),rsPwd:te}}),me(cs,E)}else me(cs,wp(s));return Tt(Zw(o,!1))},xS(zr((r,i)=>t(r)||Mt))));var t},meetingMainEpics2:(n,e)=>zt(n,Md).pipe(nn(e),Vt(t=>{let[r,i]=t;const{payload:{body:o}}=r,{meeting:{zoomId:s,encType:a,gcmSessinKey:c}}=i;if((o==null?void 0:o.encryptKey)!==void 0&&zc.init(s,o.encryptKey,a),(o==null?void 0:o.gatewayKey)!==void 0){const l=zn.getInstance(),[,u,d]=o.gatewayKey.split(".");l.sendUserNodeList([{userid:Number(u),sn:d&&Od(d)}],c)}return me(xte,o),QM(o)})),meetingMainEpics3:(n,e)=>zt(n,7939).pipe(nn(e),ht(t=>{let[r,i]=t;const{payload:{body:o}}=r;if(o.reason!==void 0){if(em.Reconnect===o.reason)return iat.WaitingRoomFailover===o.subReason?me(Yl,{reason:cc.OnHold}):me(Yl,{reason:cc.Failover}),hi(Bc(La.NormalCase));em.KickedByHost===o.reason?me(Ub,{reason:"kicked by host"}):[em.EndByHost,em.EndByNone,em.EndByAdmin,em.EndByHostStartAnotherMeeting].includes(o.reason)?me(Ub,{reason:"ended by host"}):em.FreeMeetingTimeout===o.reason?me(Ub,{reason:"free meeting ended"}):[em.DuplicateSession,em.MeetingTransfer].includes(o.reason)&&me(Ub,{reason:"duplicated session"})}return i.meeting.isMeetingReset?Mt:Tt(Zw(i,!1))})),meetingMainEpics4:(n,e)=>n.pipe(rn(`${Bc}`),nn(e),ht(t=>{let[,r]=t;const i=Zw(r,!0);let o;if(r.meeting.zlkJwtToken){const s=function(c){if(c){const{meeting:{topic:l,passWord:u,userName:d,zlkJwtToken:h,lang:f,cv:p,customerKey:g}}=c;return{topic:l,passWord:u,userName:d,zlkJwtToken:h,lang:f,cv:p,customerKey:g}}return null}(r),a={topic:s==null?void 0:s.topic,password:s!=null&&s.passWord?encodeURIComponent(s==null?void 0:s.passWord):"",userName:s==null?void 0:s.userName,zlk:s==null?void 0:s.zlkJwtToken,lang:s==null?void 0:s.lang,cv:s==null?void 0:s.cv,customerKey:s==null?void 0:s.customerKey};o=hi(L2(a)).pipe(M2(1e3))}else{const s=function(a){var c;const{meeting:{apiKey:l,signature:u,signatureType:d,meetingNumber:h,userName:f,lang:p,passWord:g,userEmail:m,sdkUrl:v,sdkOrigin:b,proxy:S,cv:E,ztk:w,zsk:C,tk:I}}=a;let T=w||sessionStorage.getItem(Gi.WebclientZtk),D=C||sessionStorage.getItem(Gi.WebclientZsk);const O=Number((c=ES(u))===null||c===void 0?void 0:c.role)===1;return O||(T=D,D=""),{apiKey:l,signature:u,signatureType:d,meetingNumber:h,userName:f,lang:p,passWord:g?encodeURIComponent(g):"",userEmail:m,sdkUrl:v,sdkOrigin:b,proxy:S,cv:E,ztk:T,zsk:D,tk:I||sessionStorage.getItem(Gi.WebclientTk),ulsm:O&&D?1:0}}(r);o=hi(JM(s)).pipe(M2(1e3))}return O2(Tt(i),o)})),meetingMainEpics5:n=>Uf(n,7940).pipe(en(e=>{me("MEETING_HOST_CHANGE_INDICATION",e.payload.body.bHost)}),Vt(e=>$Pe(e.payload.body))),meetingMainEpics6:n=>Uf(n,7941).pipe(en(e=>{me("MEETING_COHOST_CHANGE_INDICATION",e.payload.body.bCoHost)}),Vt(e=>LPe(e.payload.body))),meetingMainEpics7:n=>Uf(n,7945).pipe(en(e=>{const{payload:{body:{opt:t}}}=e;rr.set(Gi.WebclientOpt,t,ri.SessionStorage)}),$n(Mt)),meetingMainEpics8:(n,e)=>zt(n,7942).pipe(en(t=>{const{payload:{body:{bHold:r}}}=t;rr.set(Gi.WebclientIsOnHold,r?1:0,ri.SessionStorage),me(Cte,r)}),nn(e),ht(t=>{let[r,i]=t;const o=[Ww(r.payload.body.bHold)];if(r.payload.body.bHold){const s=mn(i);if(s){o.push(FPe({audio:s.audio,video:s.bVideoOn,muted:s.muted}));const a=El(zn.getInstance());if(s.audio==="computer"&&(a.leaveComputerAudio(),ch.joinOrLeaveVoip(!1)),s.bVideoOn&&a.stopCaptureVideo(),s.sharerOn&&(ch.stopSharing(s.userId),a.stopDesktopSharing(),o.push(Dd(Hr.End))),i.video&&i.video.subscribedVideoList.length>0&&i.video.subscribedVideoList.forEach(c=>{ch.unsubscribeVideo(c)}),i.share&&i.share.isReceiveSharing){const c=i.share.activeNodeId;i.share.remoteControlledUserList.length>0&&(i.share.remoteControlledUserList.forEach(l=>{ch.sharingRequestRemoteControl(l,!1)}),Kb(i)&&a.stopRemoteControl()),ch.unsubscribeSharing(c),a.stopRenderSharing()}}}return Tt(o)})),meetingMainEpics9:n=>zt(n,7954).pipe(Vt(e=>HPe(e.payload.body))),meetingMainEpics10:n=>zt(n,4216).pipe(en(e=>{me("MEETING_CLAIM_HOST_KEY_RESPONSE",e.payload.body.bresult)}),$n(Mt)),meetingMainEpics11:(n,e)=>n.pipe(rn(`${IS}`,`${N2}`),nn(e),ht(t=>{let[r,i]=t;const o=Qat(i);return r.type===`${IS}`?(ch.leaveMeeting(o),me(Ub,{})):r.type===`${N2}`&&(ch.endMeeting(),me(Ub,{})),Tt(Zw(i,!1))})),meetingMainEpics12:(n,e)=>n.pipe(rn(`${Sq}`),nn(e),ht(t=>{let[r,i]=t;if(r.type===`${Sq}`&&i.meeting.meetingNumber&&!i.meeting.zlkJwtToken){const o={mn:i.meeting.meetingNumber.toString(),name:i.meeting.userName,customerKey:i.meeting.customerKey?Jo(i.meeting.customerKey):""},{jbhLeave:s}={jbhLeave:`https://${i3}/wc/jbhLeave`},a=`${s}/?${new URLSearchParams(o).toString()}`;fetch(a,{method:"POST",headers:{"Content-type":"application/json; charset=UTF-8"}})}return Mt})),meetingMainEpics13:n=>zt(n,2).pipe(en(()=>{console.warn("Upgrade to latest version to optimize meeting experience")}),$n(Mt)),meetingMainEpics14:n=>zt(n,1).pipe(en(e=>{const{payload:{body:{upgradeVersion:t}}}=e,r=wp(1e4);if(r&&r.reason){const i=r.reason.replace(/{(\d+)}/g,()=>t);r.reason=i}me(cs,r)}),$n(Mt)),meetingMainEpics15:n=>zt(n,4265).pipe(Vt(e=>{const{payload:{body:t}}=e,{nShareType:r}=t;return me(lke,{userSharePronounType:r}),KPe(r)})),meetingMainEpics16:n=>zt(n,4128).pipe(en(e=>{const{payload:{body:{meetingtoken:t}}}=e,{WebclientMeetingToken:r}=Gi;t&&rr.set(r,t,ri.SessionStorage)}),$n(Mt)),meetingMainEpics17:(n,e)=>n.pipe(rn(`${av}`),st(()=>!!e.value.meeting.quicklyLeave),zr(()=>No(window,"beforeunload").pipe(en(()=>{ch.leaveMeeting()}),$n(Mt)))),meetingMainEpics18:(n,e)=>zt(n,8025).pipe(st(t=>!!t.payload.body.Zmk&&!!e.value.meeting.isEnableZmkFromRWG),Vt(t=>{const{payload:{body:{Zmk:r}}}=t;return QM({zmk:r})}))},vlt=iu(mlt,{wakeLockEpic0:(n,e)=>n.pipe(rn(`${av}`),nn(e),st(t=>{let[,r]=t;return!!r.meeting.stayAwake}),en(async()=>{try{const{isSafari:t,isIOSMobile:r}=tn;Ll&&Ll.release().then(()=>{Ll=null}),"wakeLock"in navigator&&((t||r)&&await mc(Ad(No(document,"click").pipe(Ur(1)),No(document,"touchend").pipe(Ur(1)))),Ll=await navigator.wakeLock.request("screen"),Ll.addEventListener("release",()=>{}))}catch{}}),zr(()=>No(document,"visibilitychange").pipe(ht(async()=>{if(document.visibilityState==="visible"){const{isSafari:t,isIOSMobile:r}=tn;Ll&&Ll.release().then(()=>{Ll=null}),"wakeLock"in navigator&&((t||r)&&await mc(Ad(No(document,"click").pipe(Ur(1)),No(document,"touchend").pipe(Ur(1)))),Ll=await navigator.wakeLock.request("screen"))}else Ll&&Ll.release().then(()=>{Ll=null})}),$n(Mt)))),wakeLockEpic1:n=>n.pipe(rn(`${Zf}`)).pipe(en(()=>{Ll&&Ll.release().then(()=>{Ll=null})}),$n(Mt))},plt,glt,{meetingInfoEpic:(n,e)=>n.pipe(rn(`${L2}`),zr(t=>{const r=Object.assign({},t.payload,{password:Jo(t.payload.password),topic:Jo(t.payload.topic)}),{videoSDKUrl:i}={meetingSDKUrl:`https://${i3}/api/v1/wc/info`,videoSDKUrl:`https://${i3}/wc/lsdk`};return function(o,s){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"zoomsdkjsonpcallback";return new Ns(c=>{she++;const l=`${a}${she}`,u=document.createElement("script");Object.keys(s).forEach(d=>(s[d]===void 0||s[d]===null)&&delete s[d]),u.src=`${o}?${new URLSearchParams(Object.assign(s,{callback:l})).toString()}`,u.async=!0,u.onerror=d=>c.error(d),document.getElementsByTagName("head")[0].appendChild(u),window[l]=d=>{u.parentNode&&u.parentNode.removeChild(u),delete window[l],c.next(d),c.complete()}})}(i,r).pipe(qp(n.pipe(rn(`${IS}`))),$f(o=>hi({status:!1,result:o.toString(),errorCode:-3e3})),ht(o=>{const[s,a]=(c=hi(o),[st(l=d=>d.status===!0&&d.result!==void 0,u)(hc(c)),st(Dst(l,u))(hc(c))]);var c,l,u;return a.subscribe(d=>{hlt.report(`get meeting info error, ${JSON.stringify(d)}`,["Join Meeting Flow","Get Meeting Info Error"],"error"),d.state||(d.errorCode===3e3&&d.errorMessage==="Meeting password is incorrect"?me(cs,{errorCode:mf.WrongPasscode,reason:"Incorrect passcode."}):d.errorCode===3e3&&d.errorMessage==="The role type error"?me(cs,{errorCode:mf.RoleTypeMissing,reason:"Role type error"}):d.errorCode===-3e3?me(cs,{errorCode:mf.CommonError,reason:"connection error"}):d.errorCode===3e3?me(cs,{reason:d.errorMessage,errorCode:mf.CommonError}):d.errorCode===300?me(cs,{reason:"This account does not exist or does not belong to you",errorCode:mf.CommonError}):d.errorCode===124&&d.errorMessage==="Parse lite sdk topic and pwd fail"?me(cs,{reason:"Topic is invalid",errorCode:mf.CommonError}):d.errorCode===124&&d.errorMessage==="The java web token is expired or more than 2 days or ineffective."?me(cs,{reason:"The token has expired, is over 2 days old, or is ineffective.",errorCode:mf.CommonError}):d.errorCode===124&&me(cs,{reason:"Verify JWT failed",errorCode:mf.CommonError}))}),s.pipe(WDe(d=>{if(d.status===!0){const{result:{mid:f,websdkClientFeatureOptions:p,showRecommendVersion:g}}=d;rr.init(f);const m=((E,w)=>{if(E.result){const{result:{mn:C,ts:I,auth:T,track_auth:D,mid:O,tid:M,encryptedRWC:R,encryptedGEORWC:A,user_identity:k,meetingOptions:L,can_recording:j,wcXMPPConfig:N,call_out_country_json:B,isOriginalHost:U,support_call_out:K,liveTranscription:z,logConfig:G,logEncryptionPubKey:te,toll_numbers_json:ie,h323Password:Q,liveStreamInfo:ge,rc_auto_delete:_e,jwt_rc:Se,op_rc:se,mediaSDKVersion:ee,mediaSDKPathPrefix:Y,zmk:ue,fileTransfer:ye,fileServerDomain:V,accountId:le}}=E,{lang:he,password:oe,topic:ne,zlk:ce,cv:Ae,userName:Ie}=w;return{meetingNumber:C,meetingId:O,tid:M,ts:I,auth:T,passWord:oe,trackAuth:D,customerKey:k,encryptedRWC:JSON.parse(R||"{}"),encryptedGEORWC:JSON.parse(A||"{}"),meetingOptions:JSON.parse(L||"{}"),recordingEnable:j==="1",topic:ne,userName:rr.get(Gi.WebclientUserName)||Ie,cv:Ae,zlkJwtToken:ce,xmppConfig:JSON.parse(N||"{}"),callOutCountry:JSON.parse(B||"{}"),lang:he,isOriginHost:U,isSupportCallOut:K==="1",liveTranscription:JSON.parse(z||"{}"),logConfig:G,logEncryptionPubKey:te,tollNumbers:ie===void 0?void 0:JSON.parse(ie),h323Password:Q,liveStreamInfo:JSON.parse(ge||"{}"),rcAutoDelete:_e,jwtRc:Se,opRc:se,mediaSDKPath:ee&&Y?`${vte(Y)}/${ee}`:void 0,zmk:ue,fileTransfer:JSON.parse(ye||"{}"),fileServerDomain:V,accountId:le}}return E})(d,t.payload);var h;g&&(t==null||(h=t.payload)===null||h===void 0||h.lang,console.log("Update VideoSDK-Web to the latest version to optimize meeting experience","https://developers.zoom.us/docs/video-sdk/web/"));const v=[hi(Hh(m)),Kst(ohe,e,yte())],b=((E,w)=>{const C=[];if(E){const I=E.split("").reverse();Object.keys(kp).filter(T=>/M:\d+(,\d+)*;V:\d+(,\d+)*/.test(kp[T])).forEach(T=>{const D=kp[T];let[O,M]=D.split(";");O.startsWith("V:")&&([O,M]=[M,O]);const R=M.slice(2).split(",").map(L=>I[Number(L)-1]).reverse().join(""),A=parseInt(R,16),k=oct[D];k&&(Array.isArray(k)?k:[k]).forEach(L=>{const j=L.mask?(A&L.mask)>0:A;C.push(hi(L.action(j)))})})}return C})(p);b.length>0&&v.unshift(...b);const S=((E,w)=>{const C=[];if(E){const T=E.split("").reverse(),D=[];hat.forEach(O=>{var M;const[R,A]=O.split("-"),k=Number(A)-1;D.length<k&&(D.length=k+1),D[k]=(M=T[Number(R)-1])!==null&&M!==void 0?M:"0"});for(let O=0;O<D.length;O++){var I;D[O]=(I=D[O])!==null&&I!==void 0?I:"0"}C.push(hi(gPe(D.reverse().join(""))))}return C})(p);return S.length>0&&v.unshift(...S),O2(...v)}}))}),Nh(JPe(performance.now())))})),pingRWCEpic:ohe});var yRe={exports:{}};yRe.exports=function(){function n(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)e[i]=r[i]}return e}return function e(t,r){function i(o,s,a){if(typeof document<"u"){typeof(a=n({},r,a)).expires=="number"&&(a.expires=new Date(Date.now()+864e5*a.expires)),a.expires&&(a.expires=a.expires.toUTCString()),o=encodeURIComponent(o).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var c="";for(var l in a)a[l]&&(c+="; "+l,a[l]!==!0&&(c+="="+a[l].split(";")[0]));return document.cookie=o+"="+t.write(s,o)+c}}return Object.create({set:i,get:function(o){if(typeof document<"u"&&(!arguments.length||o)){for(var s=document.cookie?document.cookie.split("; "):[],a={},c=0;c<s.length;c++){var l=s[c].split("="),u=l.slice(1).join("=");try{var d=decodeURIComponent(l[0]);if(a[d]=t.read(u,d),o===d)break}catch{}}return o?a[o]:a}},remove:function(o,s){i(o,"",n({},s,{expires:-1}))},withAttributes:function(o){return e(this.converter,n({},this.attributes,o))},withConverter:function(o){return e(n({},this.converter,o),this.attributes)}},{attributes:{value:Object.freeze(r)},converter:{value:Object.freeze(t)}})}({read:function(e){return e[0]==='"'&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"})}();var ylt=yRe.exports;const{WebclientIsOnHold:blt,WebclientOpt:Slt,WebclientParticipantId:_lt,WebclientZoomId:wlt,WebclientMeetingToken:Clt}=Gi,{WebclientDeviceId:ahe}=wq;function che(n){let{retryCount:e,rwgServerList:t,userName:r,auth:i,trackAuth:o,meetingId:s,customerKey:a,tid:c,lang:l,ts:u,bid:d,botk:h,confID:f,zlkJwtToken:p,isAudioBridgeEnabled:g,isMeetingReset:m,cameraDevicesList:v,isFullHDVideoEnabled:b,isFullHDVideoShareEnabled:S}=n;const E=ylt.get("_zm_mtk_guid");let w=rr.get(ahe);if(w||(w=q6(),rr.set(ahe,w,ri.LocalStorage)),t.length>e){var C;const I=t[e],T={dn2:Jo(r),auth:i,browser:`${tn.browser}${tn.browserVersion} ${(C=window)!==null&&C!==void 0&&C.crossOriginIsolated?"SAB":""}`,trackAuth:o,mid:s,tid:c,lang:l,ts:u,"ZM-CID":w,_ZM_MTG_TRACK_ID:E||"",customer_key:Jo(a),cfs:0,islch:1};if(p)try{const{vendor:R}=ES(p);R&&Object.assign(T,{vendor:R})}catch(R){console.log(R)}I.rwcAuth?Object.assign(T,{rwcAuth:I.rwcAuth}):I.rwcToken&&Object.assign(T,{rwcToken:I.rwcToken});const D=tke()?1:tn.isIE||tn.isSupportEssentialAudioAndVideoAbility?2:0;Object.assign(T,{as_type:D}),[{key:Slt,queryKey:"opt"},{key:_lt,queryKey:"participantID"},{key:wlt,queryKey:"zoomid"}].forEach(R=>{const A=rr.get(R.key);A!==void 0&&(T[R.queryKey]=A)});const O=d&&h&&f;O&&Object.assign(T,{bid:Jo(d),confID:f}),rr.get(Clt)&&Object.assign(T,{isdj:1}),ra()&&(Object.assign(T,{from:tn.isAndroidBrowser?"android":"ios"}),g&&Object.assign(T,{useABAudio:1})),Object.assign(T,{clientCaps:xlt({isAudioBridgeEnabled:g&&ra(),isBO:O,isFullHDVideoEnabled:b,isFullHDVideoShareEnabled:S})});const M=m?v.length>0?1:0:1;return Object.assign(T,{isCamera:M}),Object.assign(T,{clientOS:tn.isAndroidOrIOSBrowser?tn.isIOSMobile?"ios":"android":tn.isMacOS?"mac":"win"}),Object.assign(T,{audioFeature:zn.getAudioFeatureFlag()}),{queryObject:{...T},rwgServer:I}}return null}function xlt(n){const{isAudioBridgeEnabled:e,isBO:t,isFullHDVideoEnabled:r,isFullHDVideoShareEnabled:i}=n;let o=mu.WebCameraIndication|mu.SendMeetingTokenSeparately|mu.SmartSummary|mu.LocalRecording|mu.LocalRecordingGrantPermission|mu.UnifyErrorType;const s=zn.getPTZCapability();return(s.pan||s.tilt||s.zoom)&&(o|=mu.SupportFarEndCameraControl),zn.isSupportVideoShare()&&(o|=mu.SupportVideoShare),e&&zn.isSupportAudioBridgeAVSync()&&(o|=mu.WebrtcAudioRtcpTime),zn.isSupportShareMultiStream()&&(o|=mu.ShareMultiStream),zn.isSupportVideoLTR()&&(o|=mu.VideoLTR),t||(o|=mu.RequestRemoteControl),r&&zn.isSupportFullHDVideo()&&(o|=mu.SupportSend1080PVideo),i&&zn.isSupportFullHDVideoShare()&&(o|=mu.SupportSend1080PVideoShare),o}function Xw(n,e){return e?xS(M2(e),st(()=>{const{socket:{zoomSocketStatus:t},meeting:{meetingStatus:r,isMeetingReset:i}}=n.value;return t!==$i.Closed&&r===ws.Joined&&!i})):xS(st(()=>{const{socket:{zoomSocketStatus:t},meeting:{meetingStatus:r,isMeetingReset:i}}=n.value;return t!==$i.Closed&&r===ws.Joined&&!i}))}const W_=Gr.createAgent();let p5;const xb=l_.getInstance();let g5;const q_=b7.getInstance();let m5;const lhe={zoomSocketStatus:$i.Closed,xmppSocketStatus:$i.Closed,mainSessionSocketStatus:$i.Closed,retryCount:0,rwgServerList:[]},Elt=ru({[`${Vw}`]:Pe((n,e)=>{let{payload:t}=e;n.zoomSocketStatus=t.status}),[`${oPe}`]:Pe((n,e)=>{let{payload:t}=e;const{rwgServerList:r}=n;r.find(i=>i.rwg===t.rwg)||r.push(t)}),[`${sPe}`]:Pe((n,e)=>{let{payload:t}=e;n.retryCount=t}),[`${w4}`]:Pe((n,e)=>{let{payload:t}=e;n.xmppSocketStatus=t}),[`${C4}`]:Pe((n,e)=>{let{payload:t}=e;n.mainSessionSocketStatus=t}),[`${aPe}`]:()=>lhe},lhe),Ilt={epics0:(n,e)=>n.pipe(rn(`${_4}`),nn(e),st(t=>{let[,r]=t;return r.socket.zoomSocketStatus===$i.Closed&&!!r.meeting.meetingId}),zr(t=>{let[,r]=t;const{media:{patchedMediaSDKStatus:i}}=r;return(i===aP.Loading?Mi(A4,1):Tt([0])).pipe(zr(()=>{const{socket:{retryCount:o,rwgServerList:s},meeting:a,breakoutRoom:c,video:l,share:u}=e.value;let d;const h={...a,retryCount:o,rwgServerList:s};if(l){const{cameraDevicesList:p,isFullHDVideoEnabled:g}=l;Object.assign(h,{cameraDevicesList:p,isFullHDVideoEnabled:g})}if(u){const{isFullHDVideoShareEnabled:p}=u;Object.assign(h,{isFullHDVideoShareEnabled:p})}if(c&&c.currentRoom.status===Cn.Joining){const{currentRoom:{boId:p,boConfId:g,boToken:m}}=c;Object.assign(h,{bid:p,botk:m,confID:g})}if(d=a.zlkJwtToken?function(p){const g=che(p);if(g){const{queryObject:m,rwgServer:v}=g,{topic:b,cv:S,meetingNumber:E}=p;return Object.assign(m,{topic:Jo(b),iccv:S}),`wss://${v.rwg}/instantsdk/${E}?${new URLSearchParams(m).toString()}`}return null}(h):function(p){const g=che(p);if(g){const{queryObject:m,rwgServer:v}=g,{cv:b,meetingNumber:S}=p;return Object.assign(m,{jscv:b,browser:m.browser+" ComponentView"}),[{key:blt,queryKey:"cfs"}].forEach(E=>{const w=rr.get(E.key);w!==void 0&&(m[E.queryKey]=w)}),`wss://${v.rwg}/wc/api/${S}?${new URLSearchParams(m).toString()}`}return null}(h),d){const p=(f=d,W_.connect(f),p5=new Lh,M0(g=>W_.on(gl.Message,g),g=>W_.off(gl.Message,g),g=>g.data).subscribe(p5),p5);return ga(p.pipe(st(g=>typeof g=="string"),Vt(g=>{try{return JSON.parse(g)}catch(m){return console.error(m),{evt:0}}}),qDe(),OS(g=>{if(g.evt!==0||!g.body||g.body.test!=="invalid parameters!")return c_(g);me(cs,{errorCode:mf.InvalidParameter,reason:"Invalid parameter"})}),Nh(Vw({status:$i.Connecting,rwgUrl:d}))),p.pipe(st(g=>g instanceof ArrayBuffer),Vt(g=>qst(g))))}var f;return Mt}))})),epics1:(n,e)=>n.pipe(rn(`${_4}`),nn(e),st(t=>{let[,r]=t;return r.socket.zoomSocketStatus===$i.Closed&&!!r.meeting.meetingId}),zr(()=>{const[t,r,i,o]=[gl.Open,gl.Close,gl.Error,gl.Inactive].map(s=>M0(a=>W_.on(s,a),a=>W_.on(s,a)));return ga(t.pipe(ht(()=>ga(hi(Vw({status:$i.Connected})),js(6e4).pipe(nn(e),st(s=>{let[,a]=s;return a.meeting.meetingStatus===ws.Initial&&!a.meeting.isMeetingReset}),Vt(()=>(me(Yl,{reason:cc.Failover}),Bc(La.NoHeartbeat))))))),r.pipe(Xw(e),Vt(()=>(me(Yl,{reason:cc.Failover}),Bc(La.Disconnect)))),o.pipe(Xw(e),Vt(()=>(me(Yl,{reason:cc.Failover}),Bc(La.NoHeartbeat)))),i.pipe(nn(e),ht(s=>{let[,a]=s;const{meeting:{meetingStatus:c,isMeetingReset:l},socket:{rwgServerList:u,retryCount:d}}=a,h=[];if(c===ws.Initial&&u!=null&&u.length){const f=u[d];return js(5e3).pipe(st(()=>e.value.meeting.meetingStatus===ws.Initial),ht(()=>{const{socket:{rwgServerList:p,retryCount:g}}=e.value,m=[];return p.length>g+1?m.push(sPe(g+1),Zf({retry:!0})):(me(cs,{reason:"connection error",errorCode:mf.CommonError}),m.push(...Zw(e.value))),Tt(m)}),Nh(qPe(f==null?void 0:f.rwc)))}return l||c!==ws.Joined||(me(Yl,{reason:cc.Failover}),h.push(Bc(La.OnError))),Tt(h)})))})),epics2:(n,e)=>n.pipe(rn(`${Zf}`),zr(t=>t.payload&&t.payload.retry?hi(_4()).pipe(M2(1e3),Nh(Vw({status:$i.Closed}))):hi(Vw({status:$i.Closed}))),M2(100),en(()=>{var t;e.value.socket.zoomSocketStatus===$i.Closed&&(W_.close(),(t=p5)===null||t===void 0||t.complete())}))},Plt=iu(Ilt,{xmppEpics0:(n,e)=>n.pipe(rn(`${av}`),ht(()=>{const{meeting:{meetingOptions:t,zlkJwtToken:r,isWebinar:i}}=e.value,o=[];return(t.isPollingEnabled||r||i)&&o.push(Xj()),Tt(o)})),xmppEpics1:(n,e)=>n.pipe(rn(`${Xj}`),nn(e),st(t=>{let[,r]=t;return r.socket.xmppSocketStatus==="closed"}),zr(t=>{let[,r]=t;const{meeting:{svcUrl:i,meetingNumber:o,conId:s}}=r,a=function(c,l,u){return`wss://${c}/wc/media/${l}?type=x&cid=${u}`}(i,o,s);return(c=>(xb.connect(c),g5=new Lh,M0(l=>xb.on(Tm.Message,l),l=>xb.off(Tm.Message,l)).subscribe(g5),g5))(a).pipe(st(c=>(c==null?void 0:c.evt)!==void 0),Vt(c=>rPe(c)),Nh(w4($i.Connecting)))})),xmppEpics2:(n,e)=>n.pipe(rn(`${Xj}`),zr(()=>{const[t,r,i]=[Tm.Open,Tm.Close,Tm.Error].map(o=>M0(s=>xb.on(o,s),s=>xb.on(o,s)));return ga(t.pipe(en(()=>{const o=function(){const{isSupportEssentialAudioAndVideoAbility:s,isSupportAudioWorklet:a}=tn;return s&&a?11:10}();xb.join(o)}),Lu(w4($i.Connected))),r.pipe(Xw(e,500),Vt(()=>(me(Yl,{reason:cc.Failover}),Bc(La.DisconnectXmpp)))),i.pipe(Xw(e,500),Vt(()=>(me(Yl,{reason:cc.Failover}),Bc(La.OnError)))))})),xmppEpics3:n=>n.pipe(rn(`${nPe}`),Lu(w4($i.Closed)),M2(100),en(()=>{var e;xb.close(),(e=g5)===null||e===void 0||e.complete()}))},{mainSessionEpics0:(n,e)=>n.pipe(rn(`${hq}`),nn(e),st(t=>{let[,r]=t;return r.socket.mainSessionSocketStatus==="closed"}),zr(t=>{let[,r]=t;const{meeting:{svcUrl:i,meetingNumber:o,conId:s}}=r,a=function(c,l,u){return`wss://${c}/wc/media/${l}?type=m&cid=${u}&mode=2`}(i,o,s);return(c=>(q_.connect(c),m5=new Lh,M0(l=>q_.on(gl.Message,l),l=>q_.off(gl.Message,l)).pipe(Vt(l=>l.data)).subscribe(m5),m5))(a).pipe(Vt(c=>{try{return JSON.parse(c)}catch(l){return console.error(l),{evt:0}}}),st(c=>c.evt!==0),qDe(),Vt(c=>Um(c)),Nh(C4($i.Connecting)))})),mainSessionEpics1:(n,e)=>n.pipe(rn(`${hq}`),zr(()=>{const[t,r,i]=[gl.Open,gl.Close,gl.Error].map(o=>M0(s=>q_.on(o,s),s=>q_.on(o,s)));return ga(t.pipe(Lu(C4($i.Connected))),r.pipe(Xw(e,500),Vt(()=>(me(Yl,{reason:cc.Failover}),Bc(La.DisconnectMChannel)))),i.pipe(Xw(e,500),Vt(()=>(me(Yl,{reason:cc.Failover}),Bc(La.OnErrorMChannel)))))})),mainSessionEpics2:n=>n.pipe(rn(`${iPe}`),Lu(C4($i.Closed)),en(()=>{var e;q_.close(),(e=m5)===null||e===void 0||e.complete()}))}),klt={id:"userId",type:n=>DS(n)?{userType:n,avatarBackgroundType:Math.floor(8*Math.random())+1}:{userType:n},role:n=>({userRole:n,isHost:m6(n)}),dn2:n=>({displayName:Xf(n)}),bShareOn:"sharerOn",bSharePause:"sharerPause",bLocalRecordStatus:n=>({bLocalRecord:n}),bGuest:"isGuest",bCapsRequestLT:"isRequestLT",customerKey:"userIdentity"},n8=n=>{const e={};return["add","remove","update"].forEach(t=>{const r=t,i=n[r];i!=null&&(e[r]=i.reduce((o,s)=>{const a=Object.keys(s).reduce((l,u)=>{const d=klt[u];return typeof d=="function"?Object.assign(l,d(s[u])):typeof d=="string"?Object.assign(l,{[`${d}`]:s[u]}):Object.assign(l,{[`${u}`]:s[u]}),l},{}),c=o.find(l=>l.userId===a.userId);return c!==void 0?Object.assign(c,a):o.push(a),o},[]))}),e},Tlt={name:"displayName",node:n=>({userId:Number(n)}),role:n=>({userRole:Number(n)})},DB=n=>Object.keys(n).reduce((e,t)=>{const r=Tlt[t];return typeof r=="function"?Object.assign(e,r(n[t])):typeof r=="string"?Object.assign(e,{[`${r}`]:n[t]}):Object.assign(e,{[`${t}`]:n[t]}),e},{}),uhe={attendeesList:[],assistantList:[],xmppAttendeeList:[],allowTalkAttendeesList:[],failoverAttendeesList:[],isAdmitAllSilentUsers:!1},Dlt=ru({[`${g6}`]:Pe((n,e)=>{let{payload:t}=e;t.add!==void 0&&t.add.length>0&&t.add.forEach(r=>{if(r.userType===eK.Assitant){const i=n.assistantList.find(o=>o.userId===r.userId);i!==void 0?Object.assign(i,r):n.assistantList.push(r)}else if(v6(r.userRole)){const i=n.allowTalkAttendeesList.find(o=>o.userId===r.userId);i!==void 0?Object.assign(i,r):n.allowTalkAttendeesList.push(r)}else{const i=n.attendeesList.find(o=>o.userId===r.userId);i!==void 0?Object.assign(i,r):n.attendeesList.push(r)}}),t.update!==void 0&&t.update.length>0&&t.update.forEach(r=>{const i=n.attendeesList.find(o=>o.userId===r.userId);if(i!==void 0)Object.assign(i,r);else{const o=n.allowTalkAttendeesList.find(s=>s.userId===r.userId);if(o!==void 0)Object.assign(o,r);else{const s=n.assistantList.find(a=>a.userId===r.userId);s!==void 0&&Object.assign(s,r)}}}),t.remove!==void 0&&t.remove.length>0&&t.remove.forEach(r=>{const i=n.attendeesList.findIndex(o=>o.userId===r.userId);if(i!==-1)n.attendeesList.splice(i,1);else{const o=n.allowTalkAttendeesList.findIndex(s=>s.userId===r.userId);if(o!==-1)n.allowTalkAttendeesList.splice(o,1);else{const s=n.assistantList.findIndex(a=>a.userId===r.userId);s!==-1&&n.assistantList.splice(s,1)}}})}),[`${B3e}`]:Pe((n,e)=>{let{payload:t}=e;const{xmppAttendeeList:r}=n,i=r.map(o=>o.jid);t.forEach(o=>{const{jid:s}=o,a=i.indexOf(s);a!==-1?Object.assign(r[a],o):r.push(o)})}),[`${O3e}`]:Pe((n,e)=>{let{payload:t}=e;n.isAdmitAllSilentUsers=t}),[`${L3e}`]:Pe(n=>{n.attendeesList.forEach(e=>{e.bRaiseHand&&(e.bRaiseHand=!1)})}),[`${N3e}`]:Pe(n=>{n.attendeesList.forEach(e=>{e.feedback>0&&(e.feedback=0)})}),[`${Jq}`]:Pe((n,e)=>{let{payload:t}=e;n.failoverAttendeesList.push(t)}),[`${$3e}`]:Pe((n,e)=>{let{payload:t}=e;t.forEach(r=>{const i=n.failoverAttendeesList.findIndex(o=>o.zoomID===r.zoomID);i!==-1&&n.failoverAttendeesList.splice(i,1)})}),[`${F3e}`]:Pe((n,e)=>{let{payload:t}=e;const{jid:r,name:i}=t,o=n.xmppAttendeeList.find(s=>s.jid===r);o&&(o.displayName=i)}),[`${j3e}`]:Pe((n,e)=>{let{payload:t}=e;const{jid:r}=t,i=n.xmppAttendeeList.findIndex(o=>o.jid===r);r!==-1&&n.xmppAttendeeList.splice(i,1)}),[`${Yk}`]:Pe((n,e)=>{let{payload:t}=e;const{userId:r,key:i,value:o}=t,s=n.attendeesList.find(a=>a.userId===r);s&&(s[`${i}`]=o)}),[`${M3e}`]:()=>uhe},uhe),Rlt={epics0:(n,e)=>zt(n,Co).pipe(Vt(t=>n8(t.payload.body)),nn(e),ht(t=>{let[r,i]=t,o=[g6(r)];const{meeting:{userId:s,isWebinar:a,isOnHold:c},participants:{attendeesList:l,failoverAttendeesList:u,allowTalkAttendeesList:d}}=i,h=d.map(p=>p.userId);if(r.add){const p=r.add.filter(m=>m.userId===s);p.length>0&&p.forEach(m=>{m.bHold!==void 0&&o.push(Ww(m.bHold)),me(nD,m)});const g=r.add.filter(m=>m.userId!==s);if(g.length>0){const m=g.filter(b=>!v6(b.userRole)).map(b=>{const S={...b};if(DS(b.userType)){var E;const C=(E=i.audio)===null||E===void 0?void 0:E.dialout.find(I=>I.phoneNodeId===b.userId);C&&Object.assign(S,{phoneNumber:C.phoneNumber})}const w=u.find(C=>C.zoomID===b.zoomID);return w&&Object.assign(S,{source:w.isOnHold?"on hold":"failover"}),S}),v=m.filter(b=>!!b.source).map(b=>({zoomID:b.zoomID}));if(o.push($3e(v)),me(_te,m),a){const b=g.filter(S=>v6(S.userRole));b.length>0&&me(f0,b.map(S=>({userId:S.userId,isAllowToTalk:!0})))}}}if(r.update){const p=r.update.filter(m=>m.userId===s);p.length>0&&p.forEach(m=>{me(ql,m),m.bHold!==void 0&&o.push(Ww(m.bHold))});const g=r.update.filter(m=>!(m.userId===s||h.includes(m.userId)));if(g.length>0&&me(dg,g),a){const m=r.update.filter(v=>v.userId!==s&&h.includes(v.userId));m.length>0&&me(f0,m)}}if(r.remove){const p=r.remove.map(g=>{const m=l.find(v=>v.userId===g.userId);return m?g.action===2&&g.nUserStatus===1?m.bHold?(o.push(Jq({zoomID:m.zoomID,isOnHold:!0})),{...g,...m,reason:"on hold"}):(o.push(Jq({zoomID:m.zoomID,isOnHold:!1})),{...g,...m,reason:"failover"}):{...g,...m}:null}).filter(g=>!!g);if(me(wte,p),a){const g=r.remove.filter(m=>h.includes(m.userId));g.length>0&&me(f0,g.map(m=>({userId:m.userId,isAllowToTalk:!1})))}}const f=o.filter(p=>p.type===`${Ww}`);if(f.length>0){const p=f[f.length-1];o=o.filter(g=>g.type!==`${Ww}`),p.payload!==c&&(o.push(p),me(Cte,!c))}return Tt(o)})),epics1:(n,e)=>TC(n,24595).pipe(ht(t=>{const{payload:{body:{action:r,data:i}}}=t,{meeting:{jid:o},participants:{xmppAttendeeList:s}}=e.value,a=[];if(r===Op.rename){i.forEach(l=>{a.push(F3e(l))});const c=i.map(l=>DB(l));me(f0,c)}if(r===Op.Remove){i.forEach(l=>{a.push(j3e(l))});const c=i.map(l=>({...DB(l),removed:!0}));me(ake,c)}if([Op.Add,Op.List,Op.update].includes(r)){const c=i.map(l=>{const u=DB(l);return Object.keys(u).reduce((d,h)=>(u[h]!==""&&Object.assign(d,{[h]:u[h]}),d),{})});if(me(f0,c),a.push(B3e(c)),r===Op.update){const l=i.find(u=>u.jid===o);if(l&&l.bRaiseHand!==void 0){const u=s.find(d=>d.jid===o);(u==null?void 0:u.bRaiseHand)!==l.bRaiseHand&&me("MEETING_WEBINAR_ATTENDEE_RAISE_HAND",{bRaiseHand:l.bRaiseHand})}}}return Tt(a)})),epics2:n=>zt(n,7951).pipe(en(e=>{e.payload.body.bStarted===!1&&me("ADMIT_ALL_SILENT_USERS_END",e.payload.body.bStarted)}),Vt(e=>O3e(e.payload.body.bStarted))),epics3:n=>zt(n,7946).pipe(st(e=>{var t;return["bRaiseHand","feedback"].includes((t=e.payload.body)===null||t===void 0?void 0:t.key)&&e.payload.body.value===0}),Vt(e=>(me(dg,{}),e.payload.body.key==="bRaiseHand"?L3e():N3e())))},Alt=iu(Rlt),dhe={audioEncodeStatus:"initial",audioDecodeStatus:"initial",videoEncodeStatus:"initial",videoDecodeStatus:"initial",sharingEncodeStatus:"initial",sharingDecodeStatus:"initial",assetsPath:"",mediaConstraints:void 0,fileWithVersion:!1,enforceMultipleVideos:!1,enforceVirtualBackground:!1,enableAudioQos:!0,enableVideoQos:!0,isAudioBridgeReceiveReady:!1,isAudioBridgeSendReady:!1,isMediaAgentInitialized:!1,disableRenderLimits:!1,adaptedABOptionForMediaSDK:""},Olt=ru({[`${pq}`]:Pe((n,e)=>{let{payload:t}=e;n.audioDecodeStatus=t}),[`${fq}`]:Pe((n,e)=>{let{payload:t}=e;n.audioEncodeStatus=t}),[`${x4}`]:Pe((n,e)=>{let{payload:t}=e;n.sharingDecodeStatus=t}),[`${vq}`]:Pe((n,e)=>{let{payload:t}=e;n.sharingEncodeStatus=t}),[`${mq}`]:Pe((n,e)=>{let{payload:t}=e;n.videoDecodeStatus=t}),[`${gq}`]:Pe((n,e)=>{let{payload:t}=e;n.videoEncodeStatus=t}),[`${hte}`]:Pe((n,e)=>{let{payload:t}=e;n.mediaConstraints=t.mediaConstraints,n.assetsPath=t.assetsPath,n.fileWithVersion=t.fileWithVersion,n.enforceMultipleVideos=!!t.enforceMultipleVideos,n.enforceVirtualBackground=t.enforceVirtualBackground,n.skipJsMedia=t.skipJsMedia,n.patchJsMedia=t.patchJsMedia,n.alternativeNameForVideoPlayer=t.alternativeNameForVideoPlayer,t.enforceMultipleVideos&&typeof t.enforceMultipleVideos=="object"&&(n.disableRenderLimits=!!t.enforceMultipleVideos.disableRenderLimits)}),[`${lPe}`]:Pe((n,e)=>{let{payload:t}=e;const{type:r,encrypeKey:i,additionalType:o}=t,s={encrypeKey:i,additionalType:o};r==="audio"?n.audioEncrypt=s:r==="video"?n.videoEncrypt=s:r==="sharing"&&(n.sharingEncrypt=s)}),[`${uPe}`]:Pe((n,e)=>{let{payload:t}=e;n.isEnableDecoderInWorklet=t}),[`${E4}`]:Pe((n,e)=>{let{payload:t}=e;n.patchedMediaSDKStatus=t}),[`${dPe}`]:Pe((n,e)=>{let{payload:t}=e;n.assetsPath=t}),[`${hPe}`]:Pe((n,e)=>{let{payload:t}=e;n.enableAudioQos=t.audioQos,n.enableVideoQos=t.videoQos}),[`${fPe}`]:Pe((n,e)=>{let{payload:t}=e;n.isAudioBridgeReceiveReady=t}),[`${pPe}`]:Pe((n,e)=>{let{payload:t}=e;n.isAudioBridgeSendReady=t}),[`${fte}`]:Pe((n,e)=>{let{payload:t}=e;n.isMediaAgentInitialized=t}),[`${gPe}`]:Pe((n,e)=>{let{payload:t}=e;n.adaptedABOptionForMediaSDK=t}),[`${mPe}`]:n=>({...dhe,mediaConstraints:n.mediaConstraints,assetsPath:n.assetsPath,fileWithVersion:n.fileWithVersion,enforceMultipleVideos:n.enforceMultipleVideos,disableRenderLimits:n.disableRenderLimits,enforceVirtualBackground:n.enforceVirtualBackground,alternativeNameForVideoPlayer:n.alternativeNameForVideoPlayer})},dhe),sc=new class{constructor(){this.state={mediaSDK:void 0,mediaSDKInstanceMap:new Map,tagName:"video-player",renderCountMap:new Map},this.onceMap=new WeakMap,this.subscribers=[]}get(n){return this.state[n]}dispatch(n,e,t){e&&Object.assign(this.state,e),n&&this.notifySubscribers(n,t)}subscribe(n){return this.subscribers.push(n),()=>{const e=this.subscribers.indexOf(n);e!==-1&&this.subscribers.splice(e,1)}}once(n,e){this.onceMap.set(e,{event:n,unSubscribe:this.subscribe(e)})}notifySubscribers(n,e){const t=[];this.subscribers.forEach(r=>{r(n,this.state,e);const i=this.onceMap.get(r);if(i){const{event:o,unSubscribe:s}=i;o===n&&(t.push(s),this.onceMap.delete(r))}}),t.forEach(r=>r())}};var pc,r8;(function(n){n[n.ADD_RENDER_VIDEO=1]="ADD_RENDER_VIDEO",n[n.STOP_RENDER_VIDEO=2]="STOP_RENDER_VIDEO",n[n.START_SHARING=23]="START_SHARING",n[n.STOP_SHARING=24]="STOP_SHARING",n[n.SWITCH_CANVAS_FOR_VIDEO_CAPTURE=25]="SWITCH_CANVAS_FOR_VIDEO_CAPTURE",n[n.UPDATE_SHARING_DECODE_PARAM=44]="UPDATE_SHARING_DECODE_PARAM",n[n.UPDATE_CANVAS_SIZE=46]="UPDATE_CANVAS_SIZE",n[n.ZOOM_RENDER=48]="ZOOM_RENDER",n[n.REMOVE_EXPIRED_CANVAS=76]="REMOVE_EXPIRED_CANVAS",n[n.WEBGL_LOST_REPLACE_CANVAS=77]="WEBGL_LOST_REPLACE_CANVAS",n[n.UPDATE_VIDEO_QUALITY=78]="UPDATE_VIDEO_QUALITY",n[n.SEND_RENDER_LOG=79]="SEND_RENDER_LOG"})(pc||(pc={})),function(n){n[n.WEBGL_LOST_IN_MULTI_VIEW=-32]="WEBGL_LOST_IN_MULTI_VIEW",n[n.MOBILE_CAPTURE_DEVICE_CHANGE=135]="MOBILE_CAPTURE_DEVICE_CHANGE"}(r8||(r8={}));const a3="default-sesssion-key";var i8,hhe,fhe,Dm;function phe(n,e,t,r,i){const o=document.createElement("canvas");o.id=r;const s=wRe(o,n,e);return i(`VPISC:${window.devicePixelRatio},${s}`),o.style.pointerEvents="none",o.style.position="absolute",o.style.left="0px",o.style.top="0px",o.style.width=n+"px",o.width=n*F0(o),o.style.height=e+"px",o.height=e*F0(o),o.ariaHidden="true",o.style.zIndex=t,o}function ghe(n,e){const t=qK(()=>{if(n){wRe(n,e.clientWidth,e.clientHeight),[pc.UPDATE_CANVAS_SIZE,pc.UPDATE_SHARING_DECODE_PARAM].forEach(o=>{var s,a;(a=N0((s=e==null?void 0:e.getSessionId)===null||s===void 0?void 0:s.call(e)))===null||a===void 0||a.Notify_MeidaSDK(o,{width:e.clientWidth*F0(n),height:e.clientHeight*F0(n),canvas:n})}),n.style.width=e.clientWidth+"px",n.style.height=e.clientHeight+"px";try{n.width=e.clientWidth*F0(n),n.height=e.clientHeight*F0(n)}catch{}sc.dispatch("resize",void 0,n.id)}},300),r=matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`),i=new ResizeObserver(t);return r.addEventListener("change",t),i.observe(e),()=>{(function(o){o8.delete(o)})(n),i==null||i.disconnect(),r.removeEventListener("change",t)}}function bRe(n,e){Object.defineProperties(n,e.reduce((t,r)=>(t[r]={get:()=>n.getAttribute(r),set:i=>{i?n.setAttribute(r,i):n.removeAttribute(r)}},t),{}))}function SRe(n,e){Object.entries(e).forEach(([t,r])=>{n.getAttribute(t)||n.setAttribute(t,r)})}function mhe(n,e){const t=n.getAttribute(e);return!(!t||t!=="true")}function N0(n=a3){var e;return(e=sc.get("mediaSDKInstanceMap").get(n))===null||e===void 0?void 0:e()}function hne(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();let n=new Date().getTime(),e=performance&&performance.now&&1e3*performance.now()||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{let r=16*Math.random();return n>0?(r=(n+r)%16|0,n=Math.floor(n/16)):(r=(e+r)%16|0,e=Math.floor(e/16)),(t==="x"?r:3&r|8).toString(16)})}function qK(n,e){let t;return function(...r){clearTimeout(t),t=setTimeout(()=>{n(...r)},e)}}function _Re(n,e){const t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(const i of t){const o=n[i],s=e[i];if(typeof o=="object"&&typeof s=="object"){if(!_Re(o,s))return!1}else if(o!==s)return!1}return!0}function Wv(n){return!n||n==="0"}(function(n){n.Video="video",n.Share="share"})(i8||(i8={})),function(n){n.DEFAULT="",n.MAIN="main"}(hhe||(hhe={})),function(n){n.Video_90P="0",n.Video_180P="1",n.Video_360P="2",n.Video_720P="3",n.Video_1080P="4"}(fhe||(fhe={})),function(n){n[n.Unknown=0]="Unknown",n[n.VideoTag=1]="VideoTag",n[n.WebGL=2]="WebGL",n[n.WebGL2=3]="WebGL2",n[n.WebGPU=4]="WebGPU"}(Dm||(Dm={}));const o8=new Map;function wRe(n,e,t){const r=e>=2*window.screen.width||t>=2*window.screen.height?1:window.devicePixelRatio,i=o8.get(n);return o8.set(n,r),i&&i!==r&&sc.dispatch("scale",void 0,n.id),r}function F0(n){return o8.get(n)||window.devicePixelRatio}function I1(n,e){e&&(n==null||n.Notify_MeidaSDK(pc.SEND_RENDER_LOG,{message:e}))}function vhe(n,e){const t=sc.get("renderCountMap"),r=t.get(n)||0;t.set(n,e?r+1:r-1)}function RB(n,e){const{left:t,top:r,bottom:i,right:o,width:s,height:a}=n.getBoundingClientRect(),c=e.getBoundingClientRect();return{left:t-c.left,top:r-c.top,bottom:c.bottom-i,right:c.right-o,width:s,height:a}}const CRe=[];for(let n=0;n<=1;n+=.01)CRe.push(n);class fne{constructor(e,t){if(this.getRenderParams=t,this.el=document.createElement("div"),this.position=null,this.id="",this.srcObject=null,this.removePositionObserve=null,this.viewId=`${sc.get("tagName")}-${hne()}`,this.getSDK=()=>{var r,i;return N0((i=(r=this.container)===null||r===void 0?void 0:r.getSessionId)===null||i===void 0?void 0:i.call(r))},!e)throw new Error(`The ${sc.get("tagName")} must have a ${sc.get("tagName")}-container as its ancestor element.`);this.container=e,this.el.style.width="100%",this.el.style.height="100%",this.debounceUpdateVideoPosition=qK(this.updateVideoPosition.bind(this),300)}getElement(){return this.el}init(){this.removeSubscribe=sc.subscribe((e,t,r)=>{r===this.getCanvas().id&&(e==="resize"?(this.updateVideoPosition(),setTimeout(()=>{this.updateVideoPosition()},300)):e==="scale"&&I1(this.getSDK(),`VPSC:${F0(this.getCanvas())}`))})}getCanvas(){return this.container.getCanvas()}initObservePosition(){this.stopObservePosition(),this.removePositionObserve=function(e,t,r){const{wrapper:i=document.documentElement}=r,o=qK(t,300);let s,a;const c=(l=1,u=!1)=>{s&&(s.disconnect(),s=null);const{top:d,left:h,width:f,height:p,right:g,bottom:m}=RB(e,i);if(!f||!p)return void t({hide:!0,cross:!1,width:0,height:0,top:0,left:0,bottom:0,right:0});const v=((C,I,T,D)=>C<0||I<0||T<0||D<0)(d,m,h,g),b=((C,I,T,D,O,M)=>C<=0&&C+M<=0||I<=0&&I+M<=0||T<=0&&T+O<=0||D<=0&&D+O<=0)(d,m,h,g,f,p),S={root:i,threshold:v?CRe:l};v||(S.rootMargin=`${-d}px ${-g}px ${-m}px ${-h}px`);let E=!0,w=!0;u&&(w=!1),t({hide:b,cross:v,top:d,left:h,width:f,height:p,bottom:m,right:g}),o({hide:b,cross:v,top:d,left:h,width:f,height:p,bottom:m,right:g},!0),s=new IntersectionObserver(([C])=>{if(C.intersectionRatio===0)return w?c(1,!0):void 0;if(l!==C.intersectionRatio){if(!E)return c();c(C.intersectionRatio===0?1e-7:C.intersectionRatio)}C.intersectionRatio===1&&v&&c(),E=!1},S),s.observe(e)};return c(),a=new ResizeObserver(()=>c()),a.observe(e),()=>{s==null||s.disconnect(),s=null,a==null||a.disconnect(),a=null}}(this.el,(e,t)=>{t?setTimeout(()=>{this.updateVideoPosition()},300):this.debounceUpdateVideoPosition(e)},{wrapper:this.container})}stopObservePosition(){this.removePositionObserve&&(this.removePositionObserve(),this.removePositionObserve=null)}getCurrentPosition(e){return this.transformRectToPosition(RB(e,this.container))}transformRectToPosition(e){const{left:t,width:r,height:i,bottom:o,top:s}=e,a=F0(this.getCanvas());return{x:t*a,y:o*a,width:r*a,height:i*a,left:t*a,bottom:o*a,top:s*a}}playVideo(e){this.initObservePosition(),typeof e=="string"?this.id=e:this.srcObject=e;const t=this.getCurrentPosition(this.el);this.addRender(Object.assign(Object.assign(Object.assign(Object.assign({},t),{canvas:this.getCanvas(),zone:this.viewId,userId:Number(this.id),ssrc:Number(this.id)}),this.getRenderParams()),this.srcObject?{srcObject:this.srcObject}:{})),this.position=t}updateVideoPosition(e){if(!this.id&&!this.srcObject)return;const t=this.transformRectToPosition(e||RB(this.el,this.container));this.position&&_Re(t,this.position)||(this.zoomRender(Object.assign(Object.assign(Object.assign(Object.assign({},t),{userId:Number(this.id),canvas:this.getCanvas(),RGBA:this.container.getRGBA(),zone:this.viewId}),this.getRenderParams()),this.srcObject?{srcObject:this.srcObject}:{})),this.position=t)}stopVideo(){this.stopObservePosition(),(this.id||this.srcObject)&&this.position&&((this.id||this.srcObject)&&this.stopRender(Object.assign(Object.assign(Object.assign(Object.assign({},this.position),{userId:Number(this.id),canvas:this.getCanvas(),RGBA:this.container.getRGBA(),zone:this.viewId}),this.getRenderParams()),this.srcObject?{srcObject:this.srcObject}:{})),this.position=null,this.id="",this.srcObject=null)}updateVideoQuality(e){var t;this.id&&((t=this.getSDK())===null||t===void 0||t.Notify_MeidaSDK(pc.UPDATE_VIDEO_QUALITY,{userId:this.id,videoQuality:e}))}refresh(){this.debounceUpdateVideoPosition()}destroy(){var e;this.stopVideo(),(e=this.removeSubscribe)===null||e===void 0||e.call(this)}}class pne{constructor(e){this.container=e,this.id="",this.srcObject=null,this.getSDK=()=>{var t,r;return N0((r=(t=this.container)===null||t===void 0?void 0:t.getSessionId)===null||r===void 0?void 0:r.call(t))},this.el=document.createElement("video"),this.el.style.width="100%",this.el.style.height="100%",this.el.setAttribute("autoplay","true"),this.el.setAttribute("muted","true"),this.el.setAttribute("playsinline","true")}getElement(){return this.el}init(){}playVideo(e){typeof e=="string"?this.id=e:this.srcObject=e,this.addRender(Object.assign({userId:Number(this.id),videodom:this.el},this.srcObject?{srcObject:this.srcObject}:{}))}stopVideo(){(this.id||this.srcObject)&&(this.stopRender(Object.assign({userId:Number(this.id),videodom:this.el},this.srcObject?{srcObject:this.srcObject}:{})),this.id="",this.srcObject=null)}updateVideoQuality(e){}destroy(){this.stopVideo()}}class Mlt extends fne{addRender({width:e,height:t,x:r,y:i,canvas:o,zone:s,userId:a,left:c,bottom:l,top:u,fillMode:d,videoQuality:h}){var f;this.getSDK()&&(vhe(this.container,!0),function(p){var g,m;const v=sc.get("renderCountMap").get(p)||0,b=((m=(g=JsMediaSDK_Instance==null?void 0:JsMediaSDK_Instance.util)===null||g===void 0?void 0:g.getMaxCountRender)===null||m===void 0?void 0:m.call(g))||25,S=v>=0&&v<=b,E=sc.get("tagName");S||console.error(`In your environment, the maximum number of ${E} that can be accommodated in each ${E}-container is ${b}. The current number has exceeded this limit, which may cause video rendering issues.`)}(this.container)),(f=this.getSDK())===null||f===void 0||f.Notify_MeidaSDK(pc.ADD_RENDER_VIDEO,{width:e,height:t,x:r,y:i,canvas:o,zone:s,userId:a,left:c,bottom:l,top:u,fillMode:d,videoQuality:h})}zoomRender({width:e,height:t,x:r,y:i,userId:o,canvas:s,RGBA:a,zone:c,left:l,bottom:u,top:d}){var h;(h=this.getSDK())===null||h===void 0||h.Notify_MeidaSDK(pc.ZOOM_RENDER,{width:e,height:t,x:r,y:i,userId:o,canvas:s,RGBA:a,zone:c,left:l,bottom:u,top:d})}stopRender({width:e,height:t,x:r,y:i,userId:o,canvas:s,doNotClean:a,RGBA:c,zone:l,left:u,bottom:d,top:h,videoQuality:f}){var p;this.getSDK()&&vhe(this.container,!1),(p=this.getSDK())===null||p===void 0||p.Notify_MeidaSDK(pc.STOP_RENDER_VIDEO,{width:e,height:t,x:r,y:i,userId:o,canvas:s,doNotClean:a,RGBA:c,zone:l,left:u,bottom:d,top:h,videoQuality:f})}}class $lt extends pne{addRender({userId:e,videodom:t}){var r;(r=this.getSDK())===null||r===void 0||r.Notify_MeidaSDK(pc.ADD_RENDER_VIDEO,{userId:e,videodom:t})}stopRender({userId:e,videodom:t}){var r;(r=this.getSDK())===null||r===void 0||r.Notify_MeidaSDK(pc.STOP_RENDER_VIDEO,{userId:e,videodom:t})}}class Llt extends fne{addRender({width:e,height:t,userId:r,canvas:i,isFromMainSession:o}){var s;(s=this.getSDK())===null||s===void 0||s.Notify_MeidaSDK(pc.START_SHARING,{width:e,height:t,canvas:i,ssrc:r,isFromMainSession:o})}zoomRender(){}stopRender({canvas:e}){var t;(t=this.getSDK())===null||t===void 0||t.Notify_MeidaSDK(pc.STOP_SHARING,{canvas:e})}}class yhe extends pne{addRender({userId:e,videodom:t}){var r,i;(r=this.getSDK())===null||r===void 0||r.Notify_MeidaSDK(pc.SWITCH_CANVAS_FOR_VIDEO_CAPTURE,[t]),(i=this.getSDK())===null||i===void 0||i.Notify_MeidaSDK(pc.ADD_RENDER_VIDEO,{userId:e,videodom:t})}stopRender({userId:e,videodom:t}){var r;(r=this.getSDK())===null||r===void 0||r.Notify_MeidaSDK(pc.STOP_RENDER_VIDEO,{userId:e,videodom:t})}}var bL,xRe,xT,GK,SL,ERe;const mC=class mC{constructor(){Tn(this,bL);Tn(this,xT);Tn(this,SL)}preview(e,t,r){const i=t.getContext("webgl"),o=Yg(this,bL,xRe).call(this,i,mC.VERTEX_SHADER,mC.FRAGMENT_SHADER),s=i.getAttribLocation(o,"position"),a=i.getUniformLocation(o,"videoTexture");i.useProgram(o);const c=Yg(this,SL,ERe).call(this,i);i.bindBuffer(i.ARRAY_BUFFER,c),i.enableVertexAttribArray(s),i.vertexAttribPointer(s,2,i.FLOAT,!1,0,0),this.frame({glContext:i,program:o,positionAttributeLocation:s,textureLocation:a,positionBuffer:c,viewport:r,source:e})}frame(e){const t=e.glContext;e.glContext.clearColor(0,0,0,1),e.glContext.clear(e.glContext.COLOR_BUFFER_BIT),e.glContext.viewport(e.viewport.x,e.viewport.y,e.viewport.w,e.viewport.h),e.glContext.enable(e.glContext.DEPTH_TEST);const r=e.glContext.createTexture();t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,r),t.uniform1i(e.textureLocation,0),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e.source),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),e.glContext.drawArrays(e.glContext.TRIANGLE_STRIP,0,4),requestAnimationFrame(()=>this.frame(e))}};bL=new WeakSet,xRe=function(e,t,r){const i=Yg(this,xT,GK).call(this,e,e.VERTEX_SHADER,t),o=Yg(this,xT,GK).call(this,e,e.FRAGMENT_SHADER,r);let s=e.createProgram();return e.attachShader(s,i),e.attachShader(s,o),e.linkProgram(s),s},xT=new WeakSet,GK=function(e,t,r){const i=e.createShader(t);return e.shaderSource(i,r),e.compileShader(i),i},SL=new WeakSet,ERe=function(e){const t=e.createBuffer();return e.bindBuffer(e.ARRAY_BUFFER,t),e.bufferData(e.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,1,1]),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null),t},$(mC,"VERTEX_SHADER",`
    attribute vec2 position;
    varying vec2 texCoord;

    void main() {
      texCoord = (position + 1.0) * 0.5;
      // gl_Position = vec4(position, 0.0, 1.0);
      gl_Position = vec4(position.x, -position.y, 0.0, 1.0);
    }
  `),$(mC,"FRAGMENT_SHADER",`
    precision mediump float;
    varying vec2 texCoord;
    uniform sampler2D videoTexture;

    void main() {
      gl_FragColor = texture2D(videoTexture, texCoord);
    }
  `);let KK=mC;var _L,IRe,ET,XK,wL,PRe;const vC=class vC{constructor(){Tn(this,_L);Tn(this,ET);Tn(this,wL)}preview(e,t,r){const i=t.getContext("webgl2"),o=Yg(this,_L,IRe).call(this,i,vC.VERTEX_SHADER,vC.FRAGMENT_SHADER),s=i.getAttribLocation(o,"position"),a=i.getUniformLocation(o,"videoTexture");i.useProgram(o);const c=Yg(this,wL,PRe).call(this,i);i.bindBuffer(i.ARRAY_BUFFER,c),i.enableVertexAttribArray(s),i.vertexAttribPointer(s,2,i.FLOAT,!1,0,0),this.frame({glContext:i,program:o,positionAttributeLocation:s,textureLocation:a,positionBuffer:c,viewport:r,source:e})}frame(e){const t=e.glContext;e.glContext.clearColor(0,0,0,1),e.glContext.clear(e.glContext.COLOR_BUFFER_BIT),e.glContext.viewport(e.viewport.x,e.viewport.y,e.viewport.w,e.viewport.h),e.glContext.enable(e.glContext.DEPTH_TEST);const r=e.glContext.createTexture();t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,r),t.uniform1i(e.textureLocation,0),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e.source),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),e.glContext.drawArrays(e.glContext.TRIANGLE_STRIP,0,4),requestAnimationFrame(()=>this.frame(e))}};_L=new WeakSet,IRe=function(e,t,r){const i=Yg(this,ET,XK).call(this,e,e.VERTEX_SHADER,t),o=Yg(this,ET,XK).call(this,e,e.FRAGMENT_SHADER,r);let s=e.createProgram();return e.attachShader(s,i),e.attachShader(s,o),e.linkProgram(s),s},ET=new WeakSet,XK=function(e,t,r){const i=e.createShader(t);return e.shaderSource(i,r),e.compileShader(i),i},wL=new WeakSet,PRe=function(e){const t=e.createBuffer();return e.bindBuffer(e.ARRAY_BUFFER,t),e.bufferData(e.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,1,1]),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null),t},$(vC,"VERTEX_SHADER",`#version 300 es
    in vec2 position;
    out vec2 texCoord;

    void main() {
      texCoord = (position + 1.0) * 0.5;
      gl_Position = vec4(position.x, -position.y, 0.0, 1.0);
    }
  `),$(vC,"FRAGMENT_SHADER",`#version 300 es
    precision mediump float;
    in vec2 texCoord;
    uniform sampler2D videoTexture;
    out vec4 fragColor;

    void main() {
      fragColor = texture(videoTexture, texCoord);
    }
  `);let ZK=vC;const yC=class yC{constructor(){}async preview(e,t,r){if(!e||!t||!r)throw new Error("Invalid arguments: source, target, or viewport is missing");const i=await navigator.gpu.requestAdapter(),o=await i.requestDevice(),s=navigator.gpu.getPreferredCanvasFormat(),a=t.getContext("webgpu");a.configure({device:o,format:s,alphaMode:"opaque"});const c=o.createSampler({}),l=o.createRenderPipeline({layout:"auto",vertex:{module:o.createShaderModule({code:yC.VERTEX_SHADER}),entryPoint:"vert_main"},fragment:{module:o.createShaderModule({code:yC.FRAG_SHADER_VF}),entryPoint:"frag_main",targets:[{format:s}]},primitive:{topology:"triangle-list"}}),u={device:o,context:a,pipeline:l,sampler:c,source:e,viewport:r};this.frame(u)}frame(e){const t=e.device.createCommandEncoder(),r={colorAttachments:[{view:e.context.getCurrentTexture().createView(),loadOp:"clear",storeOp:"store"}]},i=t.beginRenderPass(r);i.setPipeline(e.pipeline);const o=e.device.createBindGroup({layout:e.pipeline.getBindGroupLayout(0),entries:[{binding:0,resource:e.sampler},{binding:1,resource:e.device.importExternalTexture({source:e.source})}]});i.setBindGroup(0,o),i.setViewport(e.viewport.x,e.viewport.y,e.viewport.w,e.viewport.h,0,1),i.draw(6),i.end(),e.device.queue.submit([t.finish()]),requestAnimationFrame(()=>this.frame(e))}};$(yC,"VERTEX_SHADER",`
    struct VertexOutput {
      @builtin(position) Position: vec4<f32>,
      @location(0) uv: vec2<f32>,
    }

    @vertex
    fn vert_main(@builtin(vertex_index) VertexIndex: u32) -> VertexOutput {
      var pos = array<vec2<f32>, 6>(
        vec2<f32>( 1.0,  1.0),
        vec2<f32>( 1.0, -1.0),
        vec2<f32>(-1.0, -1.0),
        vec2<f32>( 1.0,  1.0),
        vec2<f32>(-1.0, -1.0),
        vec2<f32>(-1.0,  1.0)
      );

      var uv = array<vec2<f32>, 6>(
        vec2<f32>(1.0, 0.0),
        vec2<f32>(1.0, 1.0),
        vec2<f32>(0.0, 1.0),
        vec2<f32>(1.0, 0.0),
        vec2<f32>(0.0, 1.0),
        vec2<f32>(0.0, 0.0)
      );

      var output : VertexOutput;
      output.Position = vec4<f32>(pos[VertexIndex], 0.0, 1.0);
      output.uv = uv[VertexIndex];
      return output;
    }
  `),$(yC,"FRAG_SHADER_VF",`
    @group(0) @binding(0) var mySampler: sampler;
    @group(0) @binding(1) var vfTexture: texture_external;

    @fragment
    fn frag_main(@location(0) uv : vec2<f32>) -> @location(0) vec4<f32> {
      var color0: vec4<f32> = textureSampleBaseClampToEdge(vfTexture, mySampler, uv);
      return color0;
    }
  `);let YK=yC;class P1{constructor(){}preview(e,t,r,i){let o=null;e==1?r.srcObject=t:e==2?(o=new KK,o.preview(t,r,i)):e==3?(o=new ZK,o.preview(t,r,i)):e==4&&(o=new YK,o.preview(t,r,i))}static getInstance(){return P1.instance||(P1.instance=new P1),P1.instance}}class Nlt extends fne{constructor(){super(...arguments),this.rendersProxy=P1.getInstance(),this.videoSource=null}createSource(e,t,r){return function(i,o,s,a){return new(s||(s=Promise))(function(c,l){function u(f){try{h(a.next(f))}catch(p){l(p)}}function d(f){try{h(a.throw(f))}catch(p){l(p)}}function h(f){var p;f.done?c(f.value):(p=f.value,p instanceof s?p:new s(function(g){g(p)})).then(u,d)}h((a=a.apply(i,[])).next())})}(this,void 0,void 0,function*(){const i=document.createElement("video");return i.width=t,i.height=r,i.loop=!0,i.autoplay=!0,i.muted=!0,i.srcObject=e,yield i.play(),i})}addRender(e){e.renderType&&e.srcObject&&!this.videoSource&&(this.videoSource&&(this.videoSource=null),this.createSource(e.srcObject,e.width,e.height).then(t=>{this.videoSource=t,this.rendersProxy.preview(e.renderType,this.videoSource,e.canvas,{x:e.x,y:e.renderType===Dm.WebGPU?e.top:e.y,w:e.width,h:e.height})}))}zoomRender(e){e.renderType&&this.videoSource&&(this.videoSource.width!==e.width&&(this.videoSource.width=e.width),this.videoSource.height!==e.height&&(this.videoSource.height=e.height))}stopRender(e){e.renderType&&this.videoSource&&(this.videoSource.srcObject=null,this.videoSource=null)}}class Flt extends pne{constructor(){super(...arguments),this.rendersProxy=P1.getInstance()}addRender(e){e.srcObject&&e.videodom&&this.rendersProxy.preview(Dm.VideoTag,e.srcObject,e.videodom)}stopRender(e){e.videodom.srcObject=null}}const vm="node-id",QP="media-type",q4="video-quality",kRe="share-source",TRe="fill-mode",DRe="stop-no-clean",JK="refresh-key";class V2 extends HTMLElement{static get observedAttributes(){return[vm,QP,q4,JK]}constructor(){super(),this.container=null,this._srcObject=null,bRe(this,V2.customAttributes),this.getRenderParams=this.getParsedParams.bind(this),this.callback=(e,t)=>{e===r8.MOBILE_CAPTURE_DEVICE_CHANGE&&t===this.getAttribute(vm)&&this.initRender()}}initRender(){var e,t,r,i,o;if(this.render&&this.render.destroy(),(e=this.getContainer())===null||e===void 0?void 0:e.useInsideRender()){const u=(t=this.getContainer())===null||t===void 0?void 0:t.getInsideRenderType();if(u===Dm.VideoTag)this.render=new Flt(this.getContainer());else{if(![Dm.WebGL,Dm.WebGL2,Dm.WebGPU].includes(u))return void console.error("Inside render type error.");this.render=new Nlt(this.getContainer(),this.getRenderParams)}return this.shadowRoot&&(this.shadowRoot.innerHTML="",this.shadowRoot.appendChild(this.render.getElement())),this.render.init(),void(this.srcObject&&this.render.playVideo(this.srcObject))}const s=this.getAttribute(vm),a=s&&((r=this.getCurrentMediaSDK())===null||r===void 0?void 0:r.isPreviewVideotag(s));let c=0;this.getAttribute(QP)===i8.Share?(this.render=new Llt(this.getContainer(),this.getRenderParams),c=2):!((i=this.getCurrentMediaSDK())===null||i===void 0)&&i.getWebRTCFlag()?(this.render=new $lt(this.getContainer()),c=4):a?(this.render=new yhe(this.getContainer()),c=1):(this.render=new Mlt(this.getContainer(),this.getRenderParams),c=3),this.getCurrentMediaSDK()&&I1(this.getCurrentMediaSDK(),`VPREN:${c}`),this.innerHTML="",this.appendChild(this.render.getElement()),this.render.init();const l=this.getAttribute(vm);Wv(l)||(o=this.render)===null||o===void 0||o.playVideo(l)}get srcObject(){return this._srcObject}set srcObject(e){var t,r,i,o;!this._srcObject&&e?(t=this.render)===null||t===void 0||t.playVideo(e):this._srcObject&&e?((r=this.render)===null||r===void 0||r.stopVideo(),(i=this.render)===null||i===void 0||i.playVideo(e)):this._srcObject&&((o=this.render)===null||o===void 0||o.stopVideo()),this._srcObject=e}getContainer(){return this.container||(this.container=this.closest(`${sc.get("tagName")}-container`)),this.container}getCurrentMediaSDK(){var e,t;return N0((t=(e=this.getContainer())===null||e===void 0?void 0:e.getSessionId)===null||t===void 0?void 0:t.call(e))}getParsedParams(){var e,t;return{fillMode:mhe(this,TRe),doNotClean:mhe(this,DRe),isFromMainSession:this.getAttribute(kRe)==="main",videoQuality:this.getAttribute(q4),renderType:(t=(e=this.getContainer())===null||e===void 0?void 0:e.getInsideRenderType())!==null&&t!==void 0?t:Dm.Unknown}}connectedCallback(){var e;this.style.display="block",SRe(this,V2.defaultValues),this.initRender(),(e=this.getCurrentMediaSDK())===null||e===void 0||e.addCallback(this.callback),this.removeSubscribe=sc.subscribe((t,r,i)=>{var o,s,a,c;t==="failover"&&i===(((s=(o=this.getContainer())===null||o===void 0?void 0:o.getSessionId)===null||s===void 0?void 0:s.call(o))||a3)&&(this.initRender(),Wv(this.getAttribute(vm))||(a=this.render)===null||a===void 0||a.playVideo(this.getAttribute(vm)),this.srcObject&&((c=this.render)===null||c===void 0||c.playVideo(this.srcObject)))})}disconnectedCallback(){var e,t,r;(e=this.removeSubscribe)===null||e===void 0||e.call(this),(t=this.render)===null||t===void 0||t.destroy(),this.callback&&((r=this.getCurrentMediaSDK())===null||r===void 0||r.removeCallback(this.callback))}attributeChangedCallback(e,t,r){var i,o,s,a,c;if(this.render)switch(e){case vm:!((i=this.getCurrentMediaSDK())===null||i===void 0)&&i.getWebRTCFlag()||!!(!((o=this.getCurrentMediaSDK())===null||o===void 0)&&o.isPreviewVideotag(r))!=this.render instanceof yhe&&this.initRender(),Wv(t)&&!Wv(r)?this.render.playVideo(r):Wv(t)||Wv(r)?Wv(t)||this.render.stopVideo():(this.render.stopVideo(),this.render.playVideo(r));break;case QP:this.initRender();break;case q4:(s=this.render)===null||s===void 0||s.updateVideoQuality(r);break;case JK:Wv(r)||(c=(a=this.render)===null||a===void 0?void 0:a.refresh)===null||c===void 0||c.call(a)}}}V2.customAttributes=[vm,QP,q4,kRe,TRe,DRe,JK],V2.defaultValues={[vm]:"",[QP]:i8.Video};const bhe="session-id",v5="z-index",XE="inside-render",She="label";class W2 extends HTMLElement{static get observedAttributes(){return[bhe,v5,XE]}constructor(){super(),this.canvasId="video-player-canvas-"+(this.getAttribute(She)?`${this.getAttribute(She)}-`:"")+hne(),this.needInitCanvas=!1,this.callback=null,bRe(this,W2.customAttributes);const e=this.attachShadow({mode:"open"}),t=document.createElement("slot");this.appendCanvas=r=>{e.insertBefore(r,t)},e.appendChild(t)}connectedCallback(){this.style.display="block",this.style.position||(this.style.position="relative"),SRe(this,W2.defaultValues),this.needInitCanvas&&this.initCanvasEvents(),this.removeSubscribe=sc.subscribe((e,t,r)=>{e==="failover"&&r===(this.getSessionId()||a3)&&(this.replaceCanvas(),this.initCanvasEvents())})}disconnectedCallback(){var e,t,r,i;(e=this.removeListener)===null||e===void 0||e.call(this),(t=this.removeSubscribe)===null||t===void 0||t.call(this),this.canvas&&((r=N0(this.getSessionId()))===null||r===void 0||r.Notify_MeidaSDK(pc.REMOVE_EXPIRED_CANVAS,{canvasId:this.canvasId}),this.canvas.remove(),this.canvas=void 0),this.callback&&((i=N0(this.getSessionId()))===null||i===void 0||i.removeCallback(this.callback))}attributeChangedCallback(e,t,r){e===v5&&this.canvas&&r&&(this.canvas.style.zIndex=r)}adoptedCallback(){}createCanvas(){this.getCurrentMediaSDK()&&I1(this.getCurrentMediaSDK(),"VPCC"),this.canvas=phe(this.clientWidth,this.clientHeight,this.getAttribute(v5)||"",this.canvasId,e=>I1(this.getCurrentMediaSDK(),e)),this.appendCanvas(this.canvas),this.isConnected?this.initCanvasEvents():this.needInitCanvas=!0}initCanvasEvents(){var e;this.removeListener=ghe(this.canvas,this),this.callback=(t,r)=>{var i,o;t===r8.WEBGL_LOST_IN_MULTI_VIEW&&r.replaceCanvas&&r.canvasId===((i=this.canvas)===null||i===void 0?void 0:i.id)&&(this.replaceCanvas(),(o=N0(this.getSessionId()))===null||o===void 0||o.Notify_MeidaSDK(pc.WEBGL_LOST_REPLACE_CANVAS,{canvasId:this.canvasId,canvas:this.canvas}))},(e=this.getCurrentMediaSDK())===null||e===void 0||e.addCallback(this.callback)}replaceCanvas(){var e;if(this.getCurrentMediaSDK()&&I1(this.getCurrentMediaSDK(),"VPRC"),this.canvas){(e=this.removeListener)===null||e===void 0||e.call(this);const t=phe(this.clientWidth,this.clientHeight,this.getAttribute(v5)||"",this.canvasId,r=>I1(this.getCurrentMediaSDK(),r));this.removeListener=ghe(t,this),this.shadowRoot&&this.shadowRoot.replaceChild(t,this.canvas),this.canvas=t}}getCanvas(){return this.canvas||this.createCanvas(),this.canvas}useInsideRender(){return this.getAttribute(XE)!==null&&this.getAttribute(XE)!==void 0&&this.getAttribute(XE)!=="false"&&this.getAttribute(XE)!=="0"}getInsideRenderType(){return Number(this.getAttribute("inside-render-type"))}getSessionId(){return this.getAttribute(bhe)||void 0}getCurrentMediaSDK(){return N0(this.getSessionId())}getRGBA(){return function(e){let t=0,r=0,i=0,o=0;if(e[0]==="r")if(e[3]==="a"){const s=e.slice(5,-1).split(",").map(a=>parseInt(a.trim(),10));t=s[0],r=s[1],i=s[2],o=s[3]}else{const s=e.slice(4,-1).split(",").map(a=>parseInt(a.trim(),10));t=s[0],r=s[1],i=s[2]}else if(e[0]==="#"){let s=e.slice(1);s.length===3&&(s=s.split("").map(c=>c.repeat(2)).join(""));const a=parseInt(s,16);t=a>>16&255,r=a>>8&255,i=255&a}return{R:t/255,G:r/255,B:i/255,A:o}}(getComputedStyle(this).getPropertyValue("background-color"))}}function QK(n){const{audio:{isBackgroundNoiseSuppression:e,originalSound:t,highBitrate:r}}=n,i={currentSelect:mde.Denoise},o={highfidelity:!1,stereo:!1};if(t){Object.assign(i,{currentSelect:mde.OriginalSound});const s={};typeof t=="boolean"?Object.assign(s,o):Object.assign(s,{highfidelity:!!t.hifi,stereo:!!t.stereo}),Object.assign(i,{originalSound:s})}return Object.assign(i,{backgroundNoiseSuppression:e?gde.Zoom:gde.Browser,highBitrate:r}),i}function c3(n,e,t,r){const{meeting:{userId:i},audio:{localShareAudioUserMutedList:o},share:{isReceiveSharingFromMainSession:s}}=r;return o.filter(a=>a.userId!==e).forEach(a=>{n.setSharingAudioVolume(a.userId,!0,a.isFromMainSession)}),n.setSharingAudioVolume(e,t,!!s),e===i?y6(t):oTe({userId:e,muted:t})}async function lS(n,e,t){var r,i;const{audio:{audioSsrc:o,activeMicrophone:s,activeSpeaker:a,isAllowToTalk:c,customizeAudioOption:{speakerOnly:l,mute:u,microphoneId:d,speakerId:h},isUsingMediaPlayback:f,mediaPlaybackFile:p,isHIDEnabled:g,microphoneDevicesList:m,isVerifiedAudioPermissionOnIOSMobile:v,speakerDevicesList:b},meeting:{svcUrl:S,conId:E,reportDomain:w,isAudioBridgeEnabled:C,userId:I,supportLocalAB:T,abToken:D}}=e,O=mn(e),M=!!l||ma(O.userRole)&&!c,R=t??!M;ra()&&(C||console.warn("Cannot start audio due to the service is not ready."),await mc(Qte(e,!R)).then(L=>{let[j,N]=L;return j&&N?Promise.resolve():Promise.reject()}));let A=s,k=a;if(d!==void 0||h!==void 0){let L=m,j=b;if(m.length===0){const{microphones:N,speakers:B}=await mc(z6());L=N,j=B}d&&L.findIndex(N=>N.deviceId===d)>-1&&(A=d),h&&j.findIndex(N=>N.deviceId===h)>-1&&(k=h)}if(f&&p!=null&&p.url){const L=Tu.getInstance();await L.setAudioElement(p),A=L.audioElement}else Tu.getInstance().stopAudioElement();return M&&!v&&tn.isIOSMobile&&await async function(){await navigator.mediaDevices.getUserMedia({audio:!0})}(),(r=n.joinComputerAudio(o,A,k,R,QK(e),ra()?{rwgHost:S,cid:E,nginxHost:w,abToken:D,supportLocalAB:T,useWebRTCOnDesktop:!tn.isAndroidOrIOSBrowser}:void 0,g?{microphoneLabel:(i=m.find(L=>L.deviceId===s))===null||i===void 0?void 0:i.label,defaultMuted:!(O==null||!O.muted)}:void 0))===null||r===void 0?void 0:r.then(()=>{u&&(Gr.createAgent().mute(I,!0),n.muteAudio()),O!=null&&O.muted?n.muteAudio():n.unmuteAudio()})}async function gne(n,e,t){const r=[],{audio:{isJoinComputerAudioBeforeSharingAudio:i,mutedBeforeSharingAudio:o}}=t,s=mn(t);return i===!0&&(await lS(n,t),r.push(H2(void 0)),o===!1&&(r.push(Qk(qP.SharingAudio)),e.mute(s.userId,!1)),r.push(Vm(void 0))),r}async function _he(n,e,t){const{audio:{isSharingAudio:r},meeting:{userId:i}}=t,o=[];if(o.push(c3(n,i,!0,t)),r){await n.leaveSharingAudio(!1),o.push(U2(!1));const s=await gne(n,e,t);o.push(...s),setTimeout(()=>{me(j2,{state:"off"})},0)}return o.push(w7(!1)),o}async function eG(n,e,t){const{audio:{audioSsrc:r,activeMicrophone:i,activeSpeaker:o},meeting:{svcUrl:s,conId:a,reportDomain:c,supportLocalAB:l,abToken:u}}=t,d=mn(t),h=[];if(!jp()){const f=await async function(p,g){const m=[],v=mn(g),{audio:{isMicrophoneForbidden:b}}=g;return(v==null?void 0:v.audio)===ci.Computer&&(m.push(H2(!0)),m.push(Vm(v.muted)),v.muted||p.muteAudio(),await p.leaveComputerAudio(),m.push(iD(0)),b&&m.push($te(!1))),m}(n,t);h.push(...f)}return await n.leaveSharingAudio(!0),await n.joinSharingAudio({ssrc:r,microphoneDeviceId:i,speakerDeviceId:o,isCaptureAudio:ma(d.userRole),audioBridge:ra()?{rwgHost:s,cid:a,nginxHost:c,abToken:u,supportLocalAB:l,useWebRTCOnDesktop:!tn.isAndroidOrIOSBrowser}:void 0}),h.push(w7(!0)),h.push(U2(!0)),h.push(c3(n,d.userId,!1,t)),h.findIndex(f=>f.type===`${H2}`&&f.payload===!0)>-1&&(h.push(_m(Sf.SharingAudio)),e.mute(t.meeting.userId,!0)),setTimeout(()=>{me(j2,{state:"on"})},0),h}W2.customAttributes=[],W2.defaultValues={};const l3=()=>{if(nke())return!0;{var n;let{browser:t}=tn;if(t=(n=t)===null||n===void 0?void 0:n.toLocaleLowerCase(),t.indexOf("safari")>-1&&t.indexOf("ios-safari")===-1){var e;const r=(e=navigator.userAgent.match(/version\/(\d+\.?\d+)/i))===null||e===void 0?void 0:e[1];return qk(r||"","15.2")>=0&&qk(r||"","17.1")<0}return!1}};function whe(n,e,t){for(let r=0;r<t.length&&e.length!==0;r++){const{userId:i,displayName:o}=t[r];if(e.includes(i)){const s=n.find(a=>a.userId===i);s&&(s.displayName=o,e.splice(e.indexOf(i),1))}}}function jp(){return zn.isSupportOpenMicWhenShareAudio()}function Che(n){return zn.isSupportAudioDenoise(n)}function xhe(){return zn.isSupportStereoAudio()}function Ehe(){var n;return typeof((n=window.navigator.hid)===null||n===void 0?void 0:n.requestDevice)=="function"}function tG(n,e,t){const{audio:{isAllowToTalk:r,customizeAudioOption:i},media:{audioDecodeStatus:o,audioEncodeStatus:s}}=n;return{encodeInitStatus:ma(e.userRole)&&!r||t||i!=null&&i.speakerOnly||ra()?"success":s,decodeInitStatus:ra()?"success":o}}function s8(n,e,t){ra()?Qte(e,t).subscribe(r=>{let[i,o]=r;i&&o&&n.joinOrLeaveVoip(!0)}):n.joinOrLeaveVoip(!0)}const im=Gr.createAgent(),vu=x7(El(zn.getInstance())),Ihe=n=>!n.muted,YE=Gr.createAgent(),Eb=x7(El(zn.getInstance())),AB=Gr.createAgent(),K_=x7(El(zn.getInstance())),y5={asnIds:{asn1:{userId:0,displayName:null},asn2:{userId:0,displayName:null},asn3:{userId:0,displayName:null}},microphoneDevicesList:[],speakerDevicesList:[],activeMicrophone:"default",activeSpeaker:"default",isMicrophoneForbidden:!1,audioSsrc:0,bCanUnmute:!1,bMutedUponEntry:!1,isAllowToTalk:void 0,dialout:[],crcDevice:[],canPlayAudio:!1,mutedSource:void 0,unmutedSource:void 0,isUserGrantCaptureAudio:!1,webrtcRestartCount:0,isComputerAudioLoading:!1,isUsingMediaPlayback:!1,customizeAudioOption:{},localShareAudioUserMutedList:[],locallyMutedAudioList:[],localUserAudioVolumeList:[],isStopAllImcomingAudio:!1,statistic:{encode:{sample_rate:0,rtt:0,jitter:0,avg_loss:0,max_loss:0,bandwidth:0,bitrate:0},decode:{sample_rate:0,rtt:0,jitter:0,avg_loss:0,max_loss:0,bandwidth:0,bitrate:0}}},jlt=ru({[`${G3e}`]:Pe((n,e)=>{let{payload:t}=e;n.asnIds={...t}}),[`${Z3e}`]:Pe((n,e)=>{let{payload:t}=e;n.bCanUnmute=t}),[`${X3e}`]:Pe((n,e)=>{let{payload:t}=e;const{sequence:r,phoneNumber:i}=t;n.dialout.findIndex(o=>o.sequence===r)===-1&&n.dialout.push({sequence:r,phoneNumber:i,returnCode:-1,uuid:q6()})}),[`${Y3e}`]:Pe((n,e)=>{let{payload:t}=e;const{sequence:r,code:i,nodeId:o}=t,s=n.dialout.find(a=>a.sequence===r);s&&(s.returnCode=i,o&&(s.phoneNodeId=o))}),[`${nK}`]:Pe((n,e)=>{let{payload:t}=e;n.isAllowToTalk=t,n.isAllowToTalkAttendeeConnected=!1}),[`${_m}`]:Pe((n,e)=>{let{payload:t}=e;n.mutedSource=t}),[`${Qk}`]:Pe((n,e)=>{let{payload:t}=e;n.unmutedSource=t}),[`${J3e}`]:Pe((n,e)=>{let{payload:t}=e;n.audioSsrc=t}),[`${Q3e}`]:Pe((n,e)=>{let{payload:t}=e;n.bMutedUponEntry=t}),[`${eTe}`]:Pe((n,e)=>{let{payload:t}=e;n.isUserGrantCaptureAudio=t}),[`${$te}`]:Pe((n,e)=>{let{payload:t}=e;n.isMicrophoneForbidden=t}),[`${iD}`]:Pe((n,e)=>{let{payload:t}=e;n.webrtcRestartCount=t}),[`${tTe}`]:Pe((n,e)=>{let{payload:t}=e;n.microphoneDevicesList=t}),[`${nTe}`]:Pe((n,e)=>{let{payload:t}=e;n.speakerDevicesList=t}),[`${Jk}`]:Pe((n,e)=>{let{payload:t}=e;n.activeMicrophone=t}),[`${_7}`]:Pe((n,e)=>{let{payload:t}=e;n.activeSpeaker=t}),[`${B2}`]:Pe((n,e)=>{let{payload:t}=e;n.canPlayAudio=t}),[`${qb}`]:Pe((n,e)=>{let{payload:t}=e;n.isComputerAudioLoading=t}),[`${Lte}`]:Pe((n,e)=>{let{payload:t}=e;if(t){const{speakerOnly:r,mute:i,backgroundNoiseSuppression:o,originalSound:s,syncButtonsOnHeadset:a,mediaFile:c,microphoneId:l,speakerId:u,highBitrate:d}=t;n.customizeAudioOption.speakerOnly=r,n.customizeAudioOption.mute=i,n.customizeAudioOption.microphoneId=l,n.customizeAudioOption.speakerId=u,n.isBackgroundNoiseSuppression=!!o,n.isHIDEnabled=!!a,n.originalSound=s,n.highBitrate=!!d,eD(n.mediaPlaybackFile,c)||(n.mediaPlaybackFile=c,n.isUsingMediaPlayback=!(c==null||!c.url)),i&&(n.mutedSource=Sf.Inherited)}}),[`${rK}`]:Pe((n,e)=>{let{payload:t}=e;n.isAllowToTalkAttendeeConnected=t}),[`${Vm}`]:Pe((n,e)=>{let{payload:t}=e;n.mutedBeforeSharingAudio=t}),[`${U2}`]:Pe((n,e)=>{let{payload:t}=e;n.isSharingAudio=t}),[`${y6}`]:Pe((n,e)=>{let{payload:t}=e;n.isShareAudioMuted=t}),[`${iTe}`]:Pe((n,e)=>{let{payload:t}=e;const{userId:r,isFromMainSession:i}=t;n.localShareAudioUserMutedList.findIndex(o=>o.userId===r)===-1&&n.localShareAudioUserMutedList.push({userId:r,isFromMainSession:i,muted:!1})}),[`${oTe}`]:Pe((n,e)=>{let{payload:t}=e;const r=n.localShareAudioUserMutedList.find(i=>i.userId===t.userId);r&&(r.muted=t.muted)}),[`${H2}`]:Pe((n,e)=>{let{payload:t}=e;n.isJoinComputerAudioBeforeSharingAudio=t}),[`${w7}`]:Pe((n,e)=>{let{payload:t}=e;n.isShareAudioEnabled=t}),[`${b6}`]:Pe((n,e)=>{let{payload:t}=e;const{data:{encoding:r,rate:i,...o}}=t;n.statistic.encode={bitrate:i,...o}}),[`${S6}`]:Pe((n,e)=>{let{payload:t}=e;const{data:{encoding:r,rate:i,...o}}=t;n.statistic.decode={bitrate:i,...o}}),[`${sTe}`]:Pe((n,e)=>{let{payload:t}=e;n.locallyMutedAudioList.findIndex(r=>r===t)===-1&&n.locallyMutedAudioList.push(t)}),[`${_6}`]:Pe((n,e)=>{let{payload:t}=e;const r=n.locallyMutedAudioList.findIndex(i=>i===t);r!==-1&&n.locallyMutedAudioList.splice(r,1)}),[`${aTe}`]:Pe((n,e)=>{let{payload:t}=e;const r=n.localUserAudioVolumeList.find(i=>i.userId===t.userId);r?r.volume=t.volume:n.localUserAudioVolumeList.push(t)}),[`${cTe}`]:Pe((n,e)=>{let{payload:t}=e;const r=n.localUserAudioVolumeList.findIndex(i=>i.userId===t.userId);r!==-1&&n.localUserAudioVolumeList.splice(r,1)}),[`${iK}`]:Pe((n,e)=>{let{payload:t}=e;n.isBackgroundNoiseSuppression=t}),[`${lTe}`]:Pe((n,e)=>{let{payload:t}=e;n.isHIDEnabled=t}),[`${oK}`]:Pe((n,e)=>{let{payload:t}=e;n.mediaPlaybackFile=t,n.isUsingMediaPlayback=!(t==null||!t.url)}),[`${sK}`]:Pe((n,e)=>{let{payload:t}=e;n.isStopAllImcomingAudio=t}),[`${uTe}`]:Pe((n,e)=>{let{payload:t}=e;n.isVerifiedAudioPermissionOnIOSMobile=t}),[`${Nte}`]:Pe((n,e)=>{let{payload:t}=e;n.isAudioBridgeSignalReconnecting=t}),[`${aK}`]:Pe((n,e)=>{let{payload:t}=e;n.originalSound=t}),[`${RS}`]:Pe((n,e)=>{let{payload:t}=e;n.leaveAudioSource=t}),[`${w6}`]:Pe((n,e)=>{let{payload:t}=e;n.secondaryAudioMicrophoneId=t}),[`${dTe}`]:Pe((n,e)=>{let{payload:t}=e;const{sequence:r,ip:i,protocol:o}=t;n.crcDevice.findIndex(s=>s.sequence===r)===-1&&n.crcDevice.push({sequence:r,ip:i,protocol:o,transId:0,uuid:q6()})}),[`${hTe}`]:Pe((n,e)=>{let{payload:t}=e;const{sequence:r,transID:i,result:o}=t,s=n.crcDevice.find(a=>a.sequence===r);s&&Object.assign(s,{transId:i,returnCode:o})}),[`${rTe}`]:(n,e)=>{let{dialout:t,crcDevice:r,locallyMutedAudioList:i,localUserAudioVolumeList:o,customizeAudioOption:s,originalSound:a,highBitrate:c,isHIDEnabled:l,isBackgroundNoiseSuppression:u,isStopAllImcomingAudio:d,mediaPlaybackFile:h,isUsingMediaPlayback:f,isVerifiedAudioPermissionOnIOSMobile:p,activeSpeaker:g,activeMicrophone:m}=n,{payload:v}=e;return v?{...y5,dialout:t,crcDevice:r,locallyMutedAudioList:i,localUserAudioVolumeList:o,customizeAudioOption:{...y5.customizeAudioOption,speakerOnly:s.speakerOnly},originalSound:a,highBitrate:c,isHIDEnabled:l,isBackgroundNoiseSuppression:u,isStopAllImcomingAudio:d,mediaPlaybackFile:h,isUsingMediaPlayback:f,isVerifiedAudioPermissionOnIOSMobile:p,activeSpeaker:g,activeMicrophone:m}:{...y5}}},y5),Blt={dialEpics0:(n,e)=>zt(n,8198).pipe(nn(e),st(t=>{let[r,i]=t;return i.audio.dialout.map(o=>o.sequence).includes(r.payload.seq)}),ht(t=>{let[r,i]=t;const{payload:{seq:o,body:{phoneNodeID:s,result:a}}}=r,c=[Y3e({code:a,sequence:o,nodeId:s})],{audio:{dialout:l}}=i,u=l.find(f=>f.sequence===o),d={code:a};if(u&&(Object.assign(d,{phoneNumber:u.phoneNumber,uuid:u.uuid}),s&&Object.assign(d,{userId:s})),me(Oke,d),a===Ss.Success){if(me(Mke),s&&Yi(i).findIndex(f=>f.userId===s)>-1){var h;const f=(h=i.audio.dialout.find(p=>p.sequence===o))===null||h===void 0?void 0:h.phoneNumber;f&&(c.push(Yk({userId:s,key:"phoneNumber",value:f})),me(dg,[{userId:s,phoneNumber:f}]))}}else[Ss.Canceling,Ss.Canceled,Ss.CancelFailed].includes(a)?a===Ss.Canceled?me(Lke):a===Ss.CancelFailed&&me(Nke):[Ss.Calling,Ss.Ringing,Ss.Accepted,Ss.Success].indexOf(a)===-1&&me($ke);return Tt(c)})),dialEpics1:(n,e)=>zt(n,4120).pipe(nn(e),st(t=>{let[r,i]=t;return i.audio.crcDevice.map(o=>o.sequence).includes(r.payload.seq)}),ht(t=>{let[r,i]=t;const{payload:{seq:o,body:{result:s,transID:a}}}=r,{audio:{crcDevice:c}}=i,l=[],u=c.find(d=>d.sequence===o);return u&&(me(Wke,{code:s,ip:u.ip,protocol:u.protocol,uuid:u.uuid}),l.push(hTe({sequence:o,transID:a,result:s}))),s===Np.Success?me(qke):[Np.Success,Np.Ringing].includes(s)||me(Kke),Tt(l)}))},Hlt={epics0:(n,e)=>zt(n,12033).pipe(nn(e),Vt(t=>{let[r,i]=t;const{participants:{allowTalkAttendeesList:o}}=i,s=r.payload.body;let a={};if(s){const c=Yi(i),l=Object.keys(s).map(d=>({key:d,userId:s[d]})),u=l.map(d=>d.userId);whe(l,u,c),o.length>0&&u.length>0&&whe(l,u,o),a=l.reduce((d,h)=>({...d,[`${h.key}`]:{userId:h.userId,displayName:h.displayName}}),{}),me(Rke,Object.values(a))}return G3e(a)})),epics1:(n,e)=>zt(n,16135).pipe(nn(e),en(t=>{let[r,i]=t;const{payload:{body:{id:o,bLeadershipOn:s}}}=r,{audio:{bCanUnmute:a}}=i,c=mn(i);if(c){const{isHost:l,bCoHost:u,userId:d,audio:h,muted:f}=c,p=l||u;s&&Gl(d,o)&&(h!==null&&h!==""&&f!==!0||!p&&!a||me(D4,eB.Spotlight))}}),$n(Mt)),epics2:(n,e)=>zt(n,12037).pipe(nn(e),en(t=>{let[,r]=t;const i=mn(r);(i==null?void 0:i.audio)!==null&&(i==null?void 0:i.audio)!==""&&(i==null?void 0:i.muted)==1&&me(D4,eB.Unmute)}),$n(Mt)),epics3:(n,e)=>zt(n,Md).pipe(st(t=>t.payload.body&&["bCanUnmute","bMutedAll","bMutedUponEntry"].some(r=>t.payload.body[r]!==void 0)),ht(t=>{const{payload:{body:{bCanUnmute:r,bMutedAll:i,bMutedUponEntry:o}}}=t,s=[];if(r!==void 0&&s.push(Z3e(t.payload.body.bCanUnmute)),i!==void 0){const a=mn(e.value);(a==null?void 0:a.audio)!==ci.Computer&&(a==null?void 0:a.audio)!==ci.Phone||a.muted!=0||t.payload.body.bMutedAll&&s.push(_m(Sf.PassiveByMuteAll))}return o!==void 0&&s.push(Q3e(t.payload.body.bMutedUponEntry)),Tt(s)})),epics4:(n,e)=>zt(n,Co).pipe(nn(e),st(t=>{let[,r]=t;return r.socket.zoomSocketStatus===$i.Connected}),ht(t=>{let[r,i]=t;const{payload:{body:{update:o}}}=r;if(o!=null&&o.some(s=>s.audio!==void 0||s.muted!==void 0)){const{meeting:{userId:s}}=i,a=o.filter(l=>l.id!==s),c=o.filter(l=>l.id===s);if(a&&a.forEach(l=>{me(Ake,l)}),c.length>0)return AS(e).pipe(ht(l=>{const{audio:{mutedSource:u,unmutedSource:d,isAllowToTalk:h,isShareAudioEnabled:f,isSharingAudio:p,isAudioBridgeSignalReconnecting:g,leaveAudioSource:m,customizeAudioOption:{speakerOnly:v}}}=e.value,b=l;return Tt(c).pipe(ny(async S=>{const E=[];if(S.audio!==b.audio)if(S.audio==="")me(Xk,{source:m}),E.push(RS(void 0));else if(S.audio===ci.Computer){const w=ma(b.userRole)&&!h||!!v;p&&me(Gw),w&&(me(Gw),tn.isIOSMobile&&E.push(uTe(!0))),g&&(me(Gw),E.push(Nte(!1)))}else S.audio===ci.Phone&&(b.audio===ci.Computer&&(await vu.leaveComputerAudio(),E.push(RS(Zk.Pstn)),im.joinOrLeaveVoip(!1)),me(jq));if(b.audio!==""&&S.muted!==b.muted){if(S.muted!==b.muted){if(S.muted===!0){if(u!==Sf.Inherited){const w=u??Sf.PassiveByMuteOne;me(Pte,{source:w})}b.audio!==ci.Computer||f&&!jp()||vu.muteAudio()}else if(S.muted===!1){if(d!==qP.Inherited){const w=d??qP.Passive;me(kte,{source:w})}b.audio===ci.Computer&&vu.unmuteAudio()}}S.muted!==void 0&&E.push(_m(void 0),Qk(void 0))}return E}))}))}return Mt})),epics5:(n,e)=>zt(n,12036).pipe(nn(e),ht(t=>{let[r,i]=t;const o=mn(i),{media:{audioEncodeStatus:s}}=i,{promoterID:a,bAllowTalk:c}=r.payload.body;if((o==null?void 0:o.userId)===a){if(me(Uke,c),c)return s!=="success"&&vu.enableAudioEncode(),Tc("audio",s,"success").pipe(ht(l=>(l&&me(D4,eB.AllowToTalk),Mt)),Nh(nK(!0)));if(im.mute(a,!0),(o==null?void 0:o.audio)===ci.Computer)return vu.leaveComputerAudio(),js(300).pipe(en(async()=>{(l3()?mc(Ad(No(document,"click").pipe(Ur(1)),No(document,"touchend").pipe(Ur(1)))):Promise.resolve(!0)).then(()=>{lS(vu,i,!1)})}),$n(Mt),Nh(nK(!1),_m(Sf.Inherited)))}return Mt})),epics6:n=>zt(n,8205).pipe(en(e=>{me("AUDIO_ALLOW_TO_TALK_RESPONSE",e.payload.body)}),$n(Mt)),epics7:(n,e)=>TC(n,24597).pipe(nn(e),en(t=>{let[r,i]=t;const o=mn(i);(o==null?void 0:o.audio)===ci.Phone?im.audioDrop(o.userId):(o==null?void 0:o.audio)===ci.Computer&&r.payload.body.bPromote}),$n(Mt)),epics8:(n,e)=>zt(n,12035).pipe(nn(e),zr(t=>{let[r,i]=t;const{meeting:{currentUserAudioBeforeReset:o}}=i,{payload:{body:{ssrc:s}}}=r,a=AS(e).pipe(ht(c=>{if(o===ci.Computer&&(c==null||!c.audio)){const{encodeInitStatus:l,decodeInitStatus:u}=tG(e.value,c);return Tc("audio",l,u).pipe(st(d=>{let[h,f]=d;return h&&f}),en(()=>{(l3()?mc(Ad(No(document,"click").pipe(Ur(1)),No(document,"touchend").pipe(Ur(1)))):Promise.resolve(!0)).then(()=>{s8(im,e.value),lS(vu,e.value)});const{audio:{locallyMutedAudioList:d,localUserAudioVolumeList:h,isStopAllImcomingAudio:f}}=e.value;d.length>0&&d.forEach(p=>{vu.muteOrUnmuteOtherAudio(p,!0)}),h.length>0&&h.forEach(p=>{vu.adjustOtherAudioVolume(p.userId,p.volume)}),f&&vu.stopAllIncomingAudio(!0)}),Lu(jPe(void 0)))}return Mt}));return me(zke,s),ga(hi(J3e(s)),a)})),epics9:(n,e)=>zt(n,7952).pipe(zr(t=>Mi(jq,1).pipe(nn(e),en(r=>{let[,i]=r;const{BindStatus:o,nOperatorUserId:s}=t.payload.body,a=i.participants.attendeesList.find(c=>c.userId===s);o===!0&&me(Fke,{operatorName:a==null?void 0:a.displayName,operatorUserId:s,operatorRole:a==null?void 0:a.userRole})}),$n(Mt)))),epics10:(n,e)=>Vn(n,bt.UserGrantCaptureAudio).pipe(nn(e),ht(t=>{let[r,i]=t;const o=mn(i);var s;(s=o,(s==null?void 0:s.audio)===ci.Computer?Promise.resolve():Un({event:ql,operations:[st(p=>p.audio!==void 0&&p.audio!==""),Ur(1)]},p=>{let{audio:g}=p;return g===ci.Phone||g===ci.Computer})).then(()=>{me(Gw)});const{meeting:{isCurrentUserMutedBeforeReset:a},audio:{bMutedUponEntry:c,isUserGrantCaptureAudio:l,isAllowToTalk:u,activeMicrophone:d}}=i,{payload:{data:h}}=r,f=[eTe(!0)];if(o){o.muted===!0&&u===!1&&(f.push(_m(Sf.Inherited)),im.mute(o.userId,!0));const p=l||o.isHost||u;(a===!0||!p&&c)&&(f.push(_m(Sf.Inherited)),im.mute(o.userId,!0),a&&f.push(BPe(void 0))),h&&d!==h&&f.push(Jk(h))}return Tt(f)})),epics11:n=>Vn(n,bt.UserForbiddedCaptureAudio).pipe(en(()=>{me(jke)}),Lu($te(!0))),epics12:n=>Vn(n,bt.AudioWebsocketBroken).pipe(en(()=>{me(Bke)}),$n(Mt)),epics13:(n,e)=>Vn(n,bt.AudioZeroData).pipe(nn(e),OS(t=>{let[,r]=t;const{audio:{webrtcRestartCount:i,activeMicrophone:o}}=r;if(i<3)return vu.restoreWebRTC(o),iD(i+1)})),epics14:(n,e)=>n.pipe(rn(`${B2}`),st(t=>t.payload===!1),ht(()=>(me(Hke),Ad(No(document,"click").pipe(Ur(1)),No(document,"touchend").pipe(Ur(1))).pipe(en(()=>{s8(im,e.value),lS(vu,e.value)}),Lu(B2(!0)))))),epics15:n=>Vn(n,[bt.JoinComputerAudioComplete,bt.JoinSharingAudioComplete,bt.LeaveComputerAudioComplete,bt.LeaveSharingAudioComplete]).pipe(en(()=>{zDe.completeAudioAction()}),$n(Mt)),epics16:(n,e)=>Vn(n,bt.AudioQosData).pipe(nn(e),Vt(t=>{var r;let[i,o]=t;const{meeting:{isWebinar:s},media:{audioEncodeStatus:a,audioDecodeStatus:c},participants:{xmppAttendeeList:l,allowTalkAttendeesList:u}}=o,d=mn(o),h=Mte(o);let f=h.length>0,p=h.some(Ihe);const g=ra();s&&(f=f||!!l.length,p=p||u.some(Ihe));const m=((d==null?void 0:d.audio)===ci.Computer||(d==null?void 0:d.audio)===ci.Phone)&&(a==="success"||g)&&!(d!=null&&d.muted)&&f,v=((d==null?void 0:d.audio)===ci.Computer||(d==null?void 0:d.audio)===ci.Phone)&&(c==="success"||g)&&f&&p;return(r=i.payload.data)!==null&&r!==void 0&&r.encoding?m?(me(Bq,i.payload),b6(i.payload)):b6(a6):v?(me(Bq,i.payload),S6(i.payload)):S6(a6)})),epics17:(n,e)=>zt(n,Co).pipe(nn(e),st(t=>{let[r,i]=t;const{payload:{body:o}}=r,{audio:{locallyMutedAudioList:s,localUserAudioVolumeList:a}}=i;return(s.length>0||a.length>0)&&(o==null?void 0:o.remove)&&o.remove.length>0}),ht(t=>{let[r,i]=t;const{payload:{body:{remove:o}}}=r,{audio:{locallyMutedAudioList:s,localUserAudioVolumeList:a}}=i,c=s.concat(a.map(l=>l.userId)).filter(l=>o.indexOf(u=>u.id===l)!==-1);return c.length>0?(c.forEach(l=>{vu.muteOrUnmuteOtherAudio(l,!1)}),Tt(c.map(l=>[_6(l),cTe({userId:l})]).flat())):Mt})),epics18:(n,e)=>Vn(n,bt.HidStatusMute).pipe(ht(t=>{const{payload:{data:r}}=t,i=e.value,{meeting:{userId:o},audio:{isShareAudioEnabled:s,bCanUnmute:a}}=i,c=[];if(r)s&&!jp()&&c.push(Vm(!0)),c.push(_m(Sf.Active)),im.mute(o,!0);else if(!s||jp()){s&&c.push(Vm(!1));const l=mn(i);(a||l!=null&&l.isHost||l!=null&&l.bCoHost)&&(c.push(Qk(qP.Active)),im.mute(o,!1))}return Tt(c)})),epics19:n=>zt(n,12040).pipe(en(e=>{const{payload:{body:{mode:t}}}=e;vu.setAudioCodecMode(t)}),$n(Mt)),epics20:(n,e)=>Vn(n,[bt.AudioSpeakerSetSuccess,bt.JoinComputerAudioComplete,bt.AudioSpeakerSetError]).pipe(ht(t=>{const{payload:{data:r,type:i}}=t,{audio:{activeSpeaker:o,activeMicrophone:s}}=e.value,a=[];return i===bt.AudioSpeakerSetSuccess&&o!==r?a.push(_7(r)):i===bt.JoinComputerAudioComplete&&r!==null&&s!==r&&a.push(Jk(r)),i===bt.AudioSpeakerSetSuccess?me(Hq,!0):i===bt.AudioSpeakerSetError&&me(Hq,!1),Tt(a)})),epics21:(n,e)=>Vn(n,bt.AudioLevelIndicator).pipe(st(()=>{const t=mn(e.value);return!!t&&t.audio===ci.Computer&&!t.muted}),en(t=>{const{payload:{data:r}}=t;me(Gke,{level:r.value})}),ht(()=>Mt))},Ult=iu(Hlt,{shareAudioEpics0:(n,e)=>Uf(n,Co).pipe(st(t=>{const r=t.payload.body.update;return r&&r.length>0&&r.findIndex(i=>i.bShareOn!==void 0)>-1}),nn(e),ht(t=>{let[r,i]=t;const{payload:{body:{update:o}}}=r,{audio:{localShareAudioUserMutedList:s}}=i,a=o.filter(l=>l.bShareOn===!0&&l.bShareAudioOn===!0),c=[];return a.length>0&&a.forEach(l=>{s.findIndex(u=>u.userId===l.id)===-1&&c.push(iTe({userId:l.id,isFromMainSession:!!l.bShareToBORooms}))}),Tt(c)})),shareAudioEpics1:(n,e)=>Vn(n,bt.SharingDesktopStreamHaveAudio).pipe(st(()=>!e.value.audio.secondaryAudioMicrophoneId),zr(()=>zt(n,Co).pipe(st(t=>{var r;const{payload:{body:i}}=t,{meeting:{userId:o}}=e.value;return(i==null||(r=i.update)===null||r===void 0?void 0:r.findIndex(s=>s.id===o&&s.bShareOn===!0))>-1}),Ur(1),ny(async()=>{const t=e.value;return await eG(Eb,YE,t)}),Nh(w7(!0))))),shareAudioEpics2:(n,e)=>Vn(n,bt.SharingDesktopStreamHaveNoAudio).pipe(nn(e),st(t=>{var r;let[,i]=t;return((r=i.audio)===null||r===void 0?void 0:r.isShareAudioEnabled)===!0}),ny(async t=>{let[,r]=t;return await _he(Eb,YE,r)})),shareAudioEpics3:(n,e)=>zt(n,Co).pipe(nn(e),st(t=>{let[,r]=t;return r.socket.zoomSocketStatus===$i.Connected&&r.audio.isSharingAudio===!0}),ht(t=>{var r;let[i,o]=t;if((r=i.payload.body.update)!==null&&r!==void 0&&r.some(s=>s.audio!==void 0||s.muted!==void 0)){const{meeting:{userId:s}}=o,a=i.payload.body.update.filter(c=>c.id===s);return AS(e).pipe(ht(c=>{const l=[];return a.findIndex(u=>u.audio===ci.Computer)>-1&&(c==null?void 0:c.audio)!==ci.Computer&&!jp()&&(l.push(H2(!0)),l.push(Vm(!0))),Tt(l)}))}return Mt})),shareAudioEpics4:(n,e)=>n.pipe(rn(`${Dd}`),bl(Ag),nn(e),st(t=>{var r;let[,i]=t;return((r=i.audio)===null||r===void 0?void 0:r.isShareAudioEnabled)===!0}),ny(async t=>{let[r,i]=t;const{payload:o}=r,{audio:{isShareAudioMuted:s,isSharingAudio:a}}=i,c=[];if(o===Hr.End){const l=await _he(Eb,YE,i);c.push(...l)}else if(o===Hr.Paused){if(s===!1&&a===!0){await Eb.leaveSharingAudio(!0),c.push(U2(!1));const l=await gne(Eb,YE,i);c.push(...l),setTimeout(()=>{me(j2,{state:"off"})},0)}}else if(o===Hr.Sharing&&s===!1&&a===!1){const l=await eG(Eb,YE,i);c.push(...l)}return c})),shareAudioEpics5:(n,e)=>Vn(n,bt.SharingDesktopStreamHaveAudio).pipe(st(()=>!!e.value.audio.secondaryAudioMicrophoneId),en(()=>{const{audio:{audioSsrc:t,secondaryAudioMicrophoneId:r},meeting:{svcUrl:i,conId:o,reportDomain:s,supportLocalAB:a,abToken:c}}=e.value;Eb.joinSharingAudio({ssrc:t,microphoneDeviceId:r,speakerDeviceId:null,isCaptureAudio:!0,audioBridge:ra()?{rwgHost:i,cid:o,nginxHost:s,abToken:c,supportLocalAB:a,useWebRTCOnDesktop:!tn.isAndroidOrIOSBrowser}:void 0}),me(Vke)}),ht(()=>Mt))},{audioBridgEpics0:n=>zt(n,4299).pipe(en(e=>{const{payload:t}=e;K_.passThroughRWGMessage(t)}),$n(Mt)),audioBridgEpics1:n=>Vn(n,bt.AudioBridgeReconnectStart).pipe(ht(()=>(AB.joinOrLeaveVoip(!1),Tt([Nte(!0),RS(Zk.Failover)])))),audioBridgEpics2:(n,e)=>Vn(n,bt.AudioBridgeReconnectEnd).pipe(en(()=>{s8(AB,e.value)}),$n(Mt)),audioBridgEpics3:n=>zt(n,Co).pipe(st(e=>{var t,r;return ra()&&(((t=e.payload.body.update)===null||t===void 0?void 0:t.some(i=>i.muted!==void 0))||((r=e.payload.body.remove)===null||r===void 0?void 0:r.length)>0)}),en(e=>{const{payload:{body:{update:t,remove:r}}}=e;K_.sendUserAudioStatus({update:(t||[]).filter(i=>i.muted!==void 0).map(i=>({userId:i.id,muted:i.muted})),remove:(r||[]).map(i=>({userId:i.id}))})}),$n(Mt)),audioBridgEpics4:(n,e)=>Vn(n,bt.NotifyUIFailover).pipe(st(()=>!e.value.meeting.isMeetingReset&&e.value.meeting.meetingStatus===ws.Joined),Vt(()=>(me(Yl,{reason:cc.Failover}),Bc(La.NotifyUiFailover)))),audioBridgEpics5:(n,e)=>pte(n,e).pipe(st(()=>{const{meeting:{isAudioBridgeEnabled:t,abToken:r}}=e.value;return t&&ra()&&!!r}),en(()=>{const{meeting:{abToken:t,svcUrl:r,reportDomain:i,conId:o,supportLocalAB:s}}=e.value;K_.preInitAudioBridge({abToken:t,rwgHost:r,cid:o,nginxHost:i,supportLocalAB:s,useWebRTCOnDesktop:!tn.isAndroidOrIOSBrowser})}),$n(Mt)),audioBridgEpics6:(n,e)=>zt(n,16129).pipe(st(t=>{const{payload:{body:{bVideoOn:r}}}=t,{meeting:{isAudioBridgeEnabled:i}}=e.value;return i&&ra()&&!!r}),en(t=>{const{payload:{body:{id:r}}}=t;K_.changeActiveVideoSsrc(r)}),$n(Mt)),audioBridgEpics7:(n,e)=>Vn(n,[bt.RecoverWebrtcAudio,bt.AudioStreamFailed]).pipe(ht(()=>{const t=mn(e.value),r=[];return(t==null?void 0:t.audio)===ci.Computer&&(K_.leaveComputerAudio(),l3()?(AB.joinOrLeaveVoip(!1),r.push(RS(Zk.EndedBySystem)),r.push(iD(0))):lS(K_,e.value)),Tt(r)})),audioBridgEpics8:n=>Vn(n,[bt.AudioBridgeFirstRecvData,bt.AudioBridgeCanSendData]).pipe(Vt(e=>{const{payload:{type:t}}=e;return t===bt.AudioBridgeFirstRecvData?(me(S3e),fPe(!0)):(me(_3e),pPe(!0))})),audioBridgEpics9:(n,e)=>n.pipe(rn(`${Hh}`),st(()=>!!e.value.meeting.zlkJwtToken),en(()=>{const{meeting:{zlkJwtToken:t}}=e.value;if(t){const{enforce_web_rtc_audio:r,audio_compatible_mode:i}=ES(t);r===void 0&&i===void 0||rr.set(Kk.EnforceWebRTCAudio,Number(r)===1||Number(i)===1,ri.Memory)}}),$n(Mt))},Blt);var RRe=typeof global=="object"&&global&&global.Object===Object&&global,zlt=typeof self=="object"&&self&&self.Object===Object&&self,vv=RRe||zlt||Function("return this")(),q2=vv.Symbol,ARe=Object.prototype,Vlt=ARe.hasOwnProperty,Wlt=ARe.toString,JE=q2?q2.toStringTag:void 0,qlt=Object.prototype.toString,Klt="[object Null]",Glt="[object Undefined]",Phe=q2?q2.toStringTag:void 0;function oD(n){return n==null?n===void 0?Glt:Klt:Phe&&Phe in Object(n)?function(e){var t=Vlt.call(e,JE),r=e[JE];try{e[JE]=void 0;var i=!0}catch{}var o=Wlt.call(e);return i&&(t?e[JE]=r:delete e[JE]),o}(n):function(e){return qlt.call(e)}(n)}function u3(n){return n!=null&&typeof n=="object"}var d3=Array.isArray;function ORe(n){var e=typeof n;return n!=null&&(e=="object"||e=="function")}var Zlt="[object AsyncFunction]",Xlt="[object Function]",Ylt="[object GeneratorFunction]",Jlt="[object Proxy]";function MRe(n){if(!ORe(n))return!1;var e=oD(n);return e==Xlt||e==Ylt||e==Zlt||e==Jlt}var khe,OB=vv["__core-js_shared__"],The=(khe=/[^.]+$/.exec(OB&&OB.keys&&OB.keys.IE_PROTO||""))?"Symbol(src)_1."+khe:"",Qlt=Function.prototype.toString;function u_(n){if(n!=null){try{return Qlt.call(n)}catch{}try{return n+""}catch{}}return""}var eut=/^\[object .+?Constructor\]$/,tut=Function.prototype,nut=Object.prototype,rut=tut.toString,iut=nut.hasOwnProperty,out=RegExp("^"+rut.call(iut).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function eE(n,e){var t=function(r,i){return r==null?void 0:r[i]}(n,e);return function(r){return!(!ORe(r)||(i=r,The&&The in i))&&(MRe(r)?out:eut).test(u_(r));var i}(t)?t:void 0}var nG=eE(vv,"WeakMap"),sut=9007199254740991,aut=/^(?:0|[1-9]\d*)$/;function cut(n,e){var t=typeof n;return!!(e=e??sut)&&(t=="number"||t!="symbol"&&aut.test(n))&&n>-1&&n%1==0&&n<e}function $Re(n,e){return n===e||n!=n&&e!=e}var lut=9007199254740991;function LRe(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=lut}function NRe(n){return n!=null&&LRe(n.length)&&!MRe(n)}var uut=Object.prototype;function FRe(n){var e=n&&n.constructor;return n===(typeof e=="function"&&e.prototype||uut)}function Dhe(n){return u3(n)&&oD(n)=="[object Arguments]"}var jRe=Object.prototype,dut=jRe.hasOwnProperty,hut=jRe.propertyIsEnumerable,BRe=Dhe(function(){return arguments}())?Dhe:function(n){return u3(n)&&dut.call(n,"callee")&&!hut.call(n,"callee")},HRe=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Rhe=HRe&&typeof module=="object"&&module&&!module.nodeType&&module,Ahe=Rhe&&Rhe.exports===HRe?vv.Buffer:void 0,a8=(Ahe?Ahe.isBuffer:void 0)||function(){return!1},Xo={};Xo["[object Float32Array]"]=Xo["[object Float64Array]"]=Xo["[object Int8Array]"]=Xo["[object Int16Array]"]=Xo["[object Int32Array]"]=Xo["[object Uint8Array]"]=Xo["[object Uint8ClampedArray]"]=Xo["[object Uint16Array]"]=Xo["[object Uint32Array]"]=!0,Xo["[object Arguments]"]=Xo["[object Array]"]=Xo["[object ArrayBuffer]"]=Xo["[object Boolean]"]=Xo["[object DataView]"]=Xo["[object Date]"]=Xo["[object Error]"]=Xo["[object Function]"]=Xo["[object Map]"]=Xo["[object Number]"]=Xo["[object Object]"]=Xo["[object RegExp]"]=Xo["[object Set]"]=Xo["[object String]"]=Xo["[object WeakMap]"]=!1;var Ohe,URe=typeof exports=="object"&&exports&&!exports.nodeType&&exports,ek=URe&&typeof module=="object"&&module&&!module.nodeType&&module,MB=ek&&ek.exports===URe&&RRe.process,Mhe=function(){try{return ek&&ek.require&&ek.require("util").types||MB&&MB.binding&&MB.binding("util")}catch{}}(),$he=Mhe&&Mhe.isTypedArray,mne=$he?(Ohe=$he,function(n){return Ohe(n)}):function(n){return u3(n)&&LRe(n.length)&&!!Xo[oD(n)]},fut=Object.prototype.hasOwnProperty,put=function(n,e){return function(t){return n(e(t))}}(Object.keys,Object),gut=Object.prototype.hasOwnProperty;function zRe(n){if(!FRe(n))return put(n);var e=[];for(var t in Object(n))gut.call(n,t)&&t!="constructor"&&e.push(t);return e}function mut(n){return NRe(n)?function(e,t){var r=d3(e),i=!r&&BRe(e),o=!r&&!i&&a8(e),s=!r&&!i&&!o&&mne(e),a=r||i||o||s,c=a?function(d,h){for(var f=-1,p=Array(d);++f<d;)p[f]=h(f);return p}(e.length,String):[],l=c.length;for(var u in e)!fut.call(e,u)||a&&(u=="length"||o&&(u=="offset"||u=="parent")||s&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||cut(u,l))||c.push(u);return c}(n):zRe(n)}var QE=eE(Object,"create"),vut=Object.prototype.hasOwnProperty,yut=Object.prototype.hasOwnProperty;function c1(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}function b5(n,e){for(var t=n.length;t--;)if($Re(n[t][0],e))return t;return-1}c1.prototype.clear=function(){this.__data__=QE?QE(null):{},this.size=0},c1.prototype.delete=function(n){var e=this.has(n)&&delete this.__data__[n];return this.size-=e?1:0,e},c1.prototype.get=function(n){var e=this.__data__;if(QE){var t=e[n];return t==="__lodash_hash_undefined__"?void 0:t}return vut.call(e,n)?e[n]:void 0},c1.prototype.has=function(n){var e=this.__data__;return QE?e[n]!==void 0:yut.call(e,n)},c1.prototype.set=function(n,e){var t=this.__data__;return this.size+=this.has(n)?0:1,t[n]=QE&&e===void 0?"__lodash_hash_undefined__":e,this};var but=Array.prototype.splice;function Rm(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}Rm.prototype.clear=function(){this.__data__=[],this.size=0},Rm.prototype.delete=function(n){var e=this.__data__,t=b5(e,n);return!(t<0||(t==e.length-1?e.pop():but.call(e,t,1),--this.size,0))},Rm.prototype.get=function(n){var e=this.__data__,t=b5(e,n);return t<0?void 0:e[t][1]},Rm.prototype.has=function(n){return b5(this.__data__,n)>-1},Rm.prototype.set=function(n,e){var t=this.__data__,r=b5(t,n);return r<0?(++this.size,t.push([n,e])):t[r][1]=e,this};var h3=eE(vv,"Map");function S5(n,e){var t,r,i=n.__data__;return((r=typeof(t=e))=="string"||r=="number"||r=="symbol"||r=="boolean"?t!=="__proto__":t===null)?i[typeof e=="string"?"string":"hash"]:i.map}function Zb(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}function v0(n){var e=this.__data__=new Rm(n);this.size=e.size}Zb.prototype.clear=function(){this.size=0,this.__data__={hash:new c1,map:new(h3||Rm),string:new c1}},Zb.prototype.delete=function(n){var e=S5(this,n).delete(n);return this.size-=e?1:0,e},Zb.prototype.get=function(n){return S5(this,n).get(n)},Zb.prototype.has=function(n){return S5(this,n).has(n)},Zb.prototype.set=function(n,e){var t=S5(this,n),r=t.size;return t.set(n,e),this.size+=t.size==r?0:1,this},v0.prototype.clear=function(){this.__data__=new Rm,this.size=0},v0.prototype.delete=function(n){var e=this.__data__,t=e.delete(n);return this.size=e.size,t},v0.prototype.get=function(n){return this.__data__.get(n)},v0.prototype.has=function(n){return this.__data__.has(n)},v0.prototype.set=function(n,e){var t=this.__data__;if(t instanceof Rm){var r=t.__data__;if(!h3||r.length<199)return r.push([n,e]),this.size=++t.size,this;t=this.__data__=new Zb(r)}return t.set(n,e),this.size=t.size,this};var Sut=Object.prototype.propertyIsEnumerable,Lhe=Object.getOwnPropertySymbols,_ut=Lhe?function(n){return n==null?[]:(n=Object(n),function(e,t){for(var r=-1,i=e==null?0:e.length,o=0,s=[];++r<i;){var a=e[r];t(a)&&(s[o++]=a)}return s}(Lhe(n),function(e){return Sut.call(n,e)}))}:function(){return[]};function Nhe(n){return function(e,t,r){var i=mut(e);return d3(e)?i:function(o,s){for(var a=-1,c=s.length,l=o.length;++a<c;)o[l+a]=s[a];return o}(i,r(e))}(n,0,_ut)}var rG=eE(vv,"DataView"),iG=eE(vv,"Promise"),oG=eE(vv,"Set"),Fhe="[object Map]",jhe="[object Promise]",Bhe="[object Set]",Hhe="[object WeakMap]",Uhe="[object DataView]",wut=u_(rG),Cut=u_(h3),xut=u_(iG),Eut=u_(oG),Iut=u_(nG),Xb=oD;(rG&&Xb(new rG(new ArrayBuffer(1)))!=Uhe||h3&&Xb(new h3)!=Fhe||iG&&Xb(iG.resolve())!=jhe||oG&&Xb(new oG)!=Bhe||nG&&Xb(new nG)!=Hhe)&&(Xb=function(n){var e=oD(n),t=e=="[object Object]"?n.constructor:void 0,r=t?u_(t):"";if(r)switch(r){case wut:return Uhe;case Cut:return Fhe;case xut:return jhe;case Eut:return Bhe;case Iut:return Hhe}return e});var sG=Xb,zhe=vv.Uint8Array;function K4(n){var e=-1,t=n==null?0:n.length;for(this.__data__=new Zb;++e<t;)this.add(n[e])}function Put(n,e){for(var t=-1,r=n==null?0:n.length;++t<r;)if(e(n[t],t,n))return!0;return!1}K4.prototype.add=K4.prototype.push=function(n){return this.__data__.set(n,"__lodash_hash_undefined__"),this},K4.prototype.has=function(n){return this.__data__.has(n)};var kut=1,Tut=2;function Vhe(n,e,t,r,i,o){var s=t&kut,a=n.length,c=e.length;if(a!=c&&!(s&&c>a))return!1;var l=o.get(n),u=o.get(e);if(l&&u)return l==e&&u==n;var d=-1,h=!0,f=t&Tut?new K4:void 0;for(o.set(n,e),o.set(e,n);++d<a;){var p=n[d],g=e[d];if(r)var m=s?r(g,p,d,e,n,o):r(p,g,d,n,e,o);if(m!==void 0){if(m)continue;h=!1;break}if(f){if(!Put(e,function(v,b){if(S=b,!f.has(S)&&(p===v||i(p,v,t,r,o)))return f.push(b);var S})){h=!1;break}}else if(p!==g&&!i(p,g,t,r,o)){h=!1;break}}return o.delete(n),o.delete(e),h}function Dut(n){var e=-1,t=Array(n.size);return n.forEach(function(r,i){t[++e]=[i,r]}),t}function Rut(n){var e=-1,t=Array(n.size);return n.forEach(function(r){t[++e]=r}),t}var Aut=1,Out=2,Mut="[object Boolean]",$ut="[object Date]",Lut="[object Error]",Nut="[object Map]",Fut="[object Number]",jut="[object RegExp]",But="[object Set]",Hut="[object String]",Uut="[object Symbol]",zut="[object ArrayBuffer]",Vut="[object DataView]",Whe=q2?q2.prototype:void 0,$B=Whe?Whe.valueOf:void 0,Wut=1,qut=Object.prototype.hasOwnProperty,Kut=1,qhe="[object Arguments]",Khe="[object Array]",_5="[object Object]",Ghe=Object.prototype.hasOwnProperty;function VRe(n,e,t,r,i){return n===e||(n==null||e==null||!u3(n)&&!u3(e)?n!=n&&e!=e:function(o,s,a,c,l,u){var d=d3(o),h=d3(s),f=d?Khe:sG(o),p=h?Khe:sG(s),g=(f=f==qhe?_5:f)==_5,m=(p=p==qhe?_5:p)==_5,v=f==p;if(v&&a8(o)){if(!a8(s))return!1;d=!0,g=!1}if(v&&!g)return u||(u=new v0),d||mne(o)?Vhe(o,s,a,c,l,u):function(C,I,T,D,O,M,R){switch(T){case Vut:if(C.byteLength!=I.byteLength||C.byteOffset!=I.byteOffset)return!1;C=C.buffer,I=I.buffer;case zut:return!(C.byteLength!=I.byteLength||!M(new zhe(C),new zhe(I)));case Mut:case $ut:case Fut:return $Re(+C,+I);case Lut:return C.name==I.name&&C.message==I.message;case jut:case Hut:return C==I+"";case Nut:var A=Dut;case But:var k=D&Aut;if(A||(A=Rut),C.size!=I.size&&!k)return!1;var L=R.get(C);if(L)return L==I;D|=Out,R.set(C,I);var j=Vhe(A(C),A(I),D,O,M,R);return R.delete(C),j;case Uut:if($B)return $B.call(C)==$B.call(I)}return!1}(o,s,f,a,c,l,u);if(!(a&Kut)){var b=g&&Ghe.call(o,"__wrapped__"),S=m&&Ghe.call(s,"__wrapped__");if(b||S){var E=b?o.value():o,w=S?s.value():s;return u||(u=new v0),l(E,w,a,c,u)}}return!!v&&(u||(u=new v0),function(C,I,T,D,O,M){var R=T&Wut,A=Nhe(C),k=A.length;if(k!=Nhe(I).length&&!R)return!1;for(var L=k;L--;){var j=A[L];if(!(R?j in I:qut.call(I,j)))return!1}var N=M.get(C),B=M.get(I);if(N&&B)return N==I&&B==C;var U=!0;M.set(C,I),M.set(I,C);for(var K=R;++L<k;){var z=C[j=A[L]],G=I[j];if(D)var te=R?D(G,z,j,I,C,M):D(z,G,j,C,I,M);if(!(te===void 0?z===G||O(z,G,T,D,M):te)){U=!1;break}K||(K=j=="constructor")}if(U&&!K){var ie=C.constructor,Q=I.constructor;ie==Q||!("constructor"in C)||!("constructor"in I)||typeof ie=="function"&&ie instanceof ie&&typeof Q=="function"&&Q instanceof Q||(U=!1)}return M.delete(C),M.delete(I),U}(o,s,a,c,l,u))}(n,e,t,r,VRe,i))}var Gut=Object.prototype.hasOwnProperty;const Zhe=n=>4294966272&n,LB=n=>{let e={R:0,G:0,B:0,A:0};if(typeof n=="string"&&n.startsWith("#")){const a=n.slice(1);try{if(a.length===3){const c=Array.from(a).map(l=>l.repeat(2)).map(l=>parseInt(l,16));e={R:c[0]/255,G:c[1]/255,B:c[2]/255,A:1}}else if(a.length===6||a.length===8){var t,r,i,o,s;const c=(t=a.match(/\S{2}/g))===null||t===void 0?void 0:t.map(l=>parseInt(l,16));e={R:((r=c==null?void 0:c[0])!==null&&r!==void 0?r:0)/255,G:((i=c==null?void 0:c[1])!==null&&i!==void 0?i:0)/255,B:((o=c==null?void 0:c[2])!==null&&o!==void 0?o:0)/255,A:c!=null&&c[3]?((s=c==null?void 0:c[3])!==null&&s!==void 0?s:0)/255:1}}}catch{console.warn("error color representation:",n)}}else typeof n=="object"&&(e={R:n.R/255,G:n.G/255,B:n.B/255,A:n.A||1});return e};function vne(n){let{captureWidth:e=0,captureHeight:t=0}=n||{};const{hd:r}=n||{};var i,o;return e!==0&&t!==0||(r&&zn.isSupportSending720P()?(e=1280,t=720):(e=640,t=360)),{captureWidth:e,captureHeight:t,isCustomizedResolution:!(n==null||!n.captureWidth||!n.captureHeight||(i=e,o=t,Math.abs(Math.floor(i/o*10)-Math.floor(16/9*10))<=1))}}function WRe(n,e){return n==="default"||e.some(t=>t.deviceId===n)||[Kw.Environment,Kw.User,Kw.Left,Kw.Right].includes(n)}function qRe(n,e){if(typeof DOMMatrixReadOnly=="function"){const t=new DOMMatrixReadOnly(getComputedStyle(n).transform).scale(-1,1).toString();n.style.transform=t,n.dataset.mirrored=e?"1":"0"}}function KRe(n,e,t){const r=[],{video:{videoSsrc:i,activeCamera:o}}=e,{cameraId:s=o,videoElement:a,originalRatio:c,ptz:l,hd:u,fullHd:d,mediaFile:h,fps:f,mirrored:p}=t||{};let g;if(a!==void 0){let w=a instanceof HTMLVideoElement?a:null;if(typeof a=="string"){let[C,I]=[document.body,a];if(a.indexOf(">")>-1){const[T,D]=a.split(">");C=document.querySelector(T),I=D}C&&(w=C.querySelector(I))}if(!w)return[];g=w,w.id||(w.id=$m("__ZOOM_SDK_SELF_VIDEO_@__")),p&&w.dataset.mirrored!=="1"&&qRe(w,p)}let m=f??oB.Default;m=Math.max(oB.Min,m),m=Math.min(oB.Max,m);const{captureWidth:v,captureHeight:b,isCustomizedResolution:S}=vne(t);if(S)n.updateVideoHDValue(!1);else{n.updateVideoHDValue(!!u||!!d);const w=!!d&&zn.isSupportFullHDVideo();n.updateVideoFullhdValue(w)}let E=Promise.resolve(s);if(h&&h.url){const w=Tu.getInstance();E=w.setVideoElement(h).then(()=>w.videoElement)}else Tu.getInstance().stopVideoElement();return E.then(w=>{n.startCaptureVideo(i,w,v,b,g,tn.isAndroidOrIOSBrowser&&S7.includes(w),!c&&function(){var C,I;const{isAndroidOrIOSBrowser:T,isFirefox:D,isSafari:O}=tn;return T||!((C=navigator.mediaDevices)!==null&&C!==void 0&&(I=C.getSupportedConstraints)!==null&&I!==void 0&&I.call(C).aspectRatio)||D||O||nke()}(),l,m)}),r.push(FTe({cameraId:s,captureWidth:v,captureHeight:b,videoElement:typeof a=="string"?a:a instanceof HTMLVideoElement?APe(a):void 0,originalRatio:c,ptz:l,hd:u,fullHd:d,mediaFile:h,fps:m,mirrored:p})),r}function GRe(n,e,t){const{max:r,min:i,step:o}=n;let s=t/100*(r-i);o&&(s=Math.min(Math.floor(s/o)*o,Math.floor(s)));let a=e+s;return a=Math.min(r,a),a=Math.max(i,a),a}function ZRe(n,e){let t="",r=e;switch(n){case u0.Down:r=-e,t="tilt";break;case u0.Up:t="tilt";break;case u0.Left:r=-e,t="pan";break;case u0.Right:t="pan";break;case u0.ZoomIn:t="zoom";break;case u0.ZoomOut:r=-e,t="zoom"}return{key:t,range:r}}function yne(n){const e=["pan","tilt","zoom"].reduce((t,r)=>n[r]&&n[r].value!==0?{...t,[r]:n[r].value}:t,{});return function(t){if(t==null)return!0;if(NRe(t)&&(d3(t)||typeof t=="string"||typeof t.splice=="function"||a8(t)||mne(t)||BRe(t)))return!t.length;var r=sG(t);if(r=="[object Map]"||r=="[object Set]")return!t.size;if(FRe(t))return!zRe(t).length;for(var i in t)if(Gut.call(t,i))return!1;return!0}(e)?null:e}function XRe(n){return{pan:(n&H_.Pan)===H_.Pan,tilt:(n&H_.Tilt)===H_.Tilt,zoom:(n&H_.Zoom)===H_.Zoom}}function G_(n){const{isAndroidBrowser:e,isIOSMobile:t,isFirefox:r,isSupportImageCapture:i,isSupportMediaStreamTrackProcessor:o,isSupportOffscreenCanvas:s}=tn,a=e&&!r,c=typeof window.SharedArrayBuffer!="function"&&a;return t&&typeof VideoFrame=="function"||c||!v7()&&!n&&!$K()&&(i||o)&&s}function Xhe(){var n,e;return"orientation"in window.screen?(n=screen.orientation.type)===null||n===void 0?void 0:n.startsWith("landscape"):"orientation"in window?Math.abs(window.orientation)===90:"matchMedia"in window?!((e=window.matchMedia("(orientation: landscape)"))===null||e===void 0||!e.matches):screen.availWidth>screen.availHeight}function Yhe(n,e,t){const{meeting:{userId:r},video:{isSupportHDVideo:i,renderedVideoList:o,maximumNumbeOfHDSubscriptions:s,receivedVideoMaxQuality:a}}=t,c=n===r;let l=e;if(e>=Ph.Video_720P)if(i){const d=o.filter(f=>f.videoQuality===Ph.Video_720P).map(f=>f.userId),h=s??1;d.length>=h&&(d.includes(n)||c||(console.warn(`Warning: Web Video SDK currently only supports subscribing to ${h} 720p video stream, so quality has been downgraded to 360p`),l=Ph.Video_360P))}else console.warn("Can not subscribe 720P video stream,will downgrade to 360P stream"),l=Ph.Video_360P;const u=Math.max(a,Ph.Video_360P);return[l,Math.min(l,u)]}const Z_=Gr.createAgent(),vp=El(zn.getInstance());let Mp,BC;async function YRe(n,e,t){const r=$m(n),i=document.createElement("img");return i.src=e,i.id=r,i.style.display="none",Lf(e)&&i.setAttribute("crossorigin",""),await new Promise((o,s)=>{i.onload=()=>{t&&URL.revokeObjectURL(e),o("")},i.onerror=()=>{t&&URL.revokeObjectURL(e),s("Cannot load  image.")}}),{imageId:r,imgElement:i}}async function sD(n,e,t){if(n===F2)return F2;{let r=n;if(e){const i=await function(o){return new Promise((s,a)=>{try{Mp&&BC||(Mp=document.createElement("canvas"),BC=Mp.getContext("2d"));const c=Mp,l=BC;if(l){l.clearRect(0,0,Mp.width,Mp.height);const u=new Image;u.src=o,Lf(o)&&(u.crossOrigin="");const d=16/9,h=1280,f=Math.floor(h/d);c.width=h,c.height=f,u.onload=()=>{const{width:p,height:g}=u,m=g*d;if(m>p){const v=p,b=Math.floor(p/d),S=0,E=(g-b)/2;l==null||l.drawImage(u,S,E,v,b,0,0,h,f)}else{const v=m,b=g,S=(p-v)/2;l.drawImage(u,S,0,v,b,0,0,h,f)}try{c.toBlob(v=>{s(v)})}catch(v){v instanceof DOMException&&v.code===DOMException.SECURITY_ERR&&console.error("Image is not from the same origin, add CORS header to solve this issue"),a(v)}},u.onerror=p=>{a("Cannot load  image.")}}}catch(c){a(c)}})}(n);r=URL.createObjectURL(i)}if(r){const{imageId:i,imgElement:o}=await YRe(Mat,r,!!e);return(t??document.body).appendChild(o),i}}return null}async function JRe(n,e,t){var r;const i=(r=t&&t.parentNode)!==null&&r!==void 0?r:document.body,{imageUrl:o,cropped:s,rootWidth:a,rootHeight:c}=n;let l=n;!e.video.customizedVideoOption||n.captureWidth&&n.captureHeight||(l=e.video.customizedVideoOption);const{captureWidth:u,captureHeight:d}=vne(l),h=document.createElement("div");let f;h.style.display="none",f=o?await sD(o,s,h):null;let p,g=$m(Oat);if(t){const m=V4(t);m.id?g=m.id:m.id=g,p=m;try{a&&t.width!==a&&(t.width=a),c&&t.height!==c&&(t.height=c)}catch{console.warn("Cannot set the canvas width/height, and pay attention the canvas dimension is different from the setting")}}else{const m=document.createElement("canvas");m.width=a??380,m.height=c??214,m.id=g,p=m,h.appendChild(m)}return i==null||i.appendChild(h),{captureWidth:u,captureHeight:d,imageId:f,canvas:p,divElement:h}}async function Jhe(n,e,t,r){const i=Array.isArray(n)?n:n&&[n];if((i==null?void 0:i.length)>0){Mp&&BC||(Mp=document.createElement("canvas"),BC=Mp.getContext("2d"));const o=Mp,s=BC;if(o.width=e,o.height=t,s)try{s.fillStyle="#fff",s.clearRect(0,0,e,t);for(let c=0;c<i.length;c++){const l=i[c],{type:u,x:d,y:h}=l;if(u==="rectangle"){const{width:f,height:p}=l;s.fillRect(d,h,f,p)}else if(u==="square"){const{length:f}=l;s.fillRect(d,h,f,f)}else if(u==="circle"){const{radius:f}=l;s.beginPath(),s.arc(d,h,f,0,2*Math.PI),s.fill()}else if(u==="svg"){const{svg:f,width:p,height:g}=l,m=new Image;m.src=f,Lf(f)&&(m.crossOrigin=""),await new Promise((S,E)=>{m.onload=()=>{S("")},m.onerror=()=>{E()}});const{width:v,height:b}=m;s.drawImage(m,0,0,v,b,d,h,p,g)}}const a=await new Promise(c=>{o==null||o.toBlob(l=>{c(l)})});if(a){const c=URL.createObjectURL(a),{imageId:l,imgElement:u}=await YRe($at,c,!0);return(r??document.body).appendChild(u),l}}catch(a){a instanceof DOMException&&a.code===DOMException.SECURITY_ERR&&console.error("Image is not from the same origin, add CORS header to solve this issue")}}return null}function Qhe(n,e){if(n===e||n==null&&e==null)return!0;const t=Array.isArray(n)?[...n]:[n],r=Array.isArray(e)?[...e]:[e];if(t.length!==r.length)return!1;const i=(o,s)=>o.type<s.type?-1:o.type===s.type?0:1;t.sort(i),r.sort(i);for(let o=0;o<t.length;o++)if(!eD(t[o],r[o]))return!1;return!0}function G4(n,e,t,r){const{video:{isCurrentUserStartedVideo:i,virtualBackground:{isVBPreloadReady:o,isVBConfigured:s,imageSrc:a},backgroundMode:c},meeting:{isCurrentUserStartVideoBeforeReset:l}}=t;return mc(function(u){return u!==void 0?Tt([u]):Mi(u6,1).pipe(Vt(d=>d))}(o)).then(u=>u?r||!s&&n.imageUrl!==F2&&n.imageUrl?async function(d,h,f,p){const{canvas:g,imageId:m,captureHeight:v,captureWidth:b,divElement:S}=await JRe(d,f,p),{cameraId:E}=d,{video:{videoSsrc:w,activeCamera:C}}=f;return h.startVirtualBackgroundSetting(g,m,w,E??C,b,v),S}(n,e,t,r).then(d=>i?D6(!0):mc(Mi(Oq,1)).then(h=>{var f;return r||e.stopVirtualBackgroundSetting(),h?(d==null||(f=d.parentNode)===null||f===void 0||f.removeChild(d),!0):Promise.reject("Cannot access the virtual background image.")})):a===n.imageUrl&&c===Yf.VirtualBackground&&!l||async function(d,h,f){const{imageUrl:p,cropped:g}=d;if(p){const m=await sD(p,g);m&&(f.video.backgroundMode===Yf.Mask&&(h.stopMaskSetting(!0),await m7(()=>{h.stopVirtualBackgroundSetting()},0)),h.updateVirtualBackgroundImage(m),m!==F2&&setTimeout(()=>{r3(m)},0))}else h.updateVirtualBackgroundImage(null)}(n,e,t):Promise.reject("Cannot load virtual background model."))}function Z4(n,e,t,r){const{video:{mask:{isMaskConfigured:i,imageSrc:o,clip:s},backgroundMode:a,isCurrentUserStartedVideo:c},meeting:{isCurrentUserStartVideoBeforeReset:l}}=t;return r||!i&&n.imageUrl?async function(u,d,h,f){const{canvas:p,imageId:g,captureHeight:m,captureWidth:v,divElement:b}=await JRe(u,h,f),{cameraId:S,clip:E,rootWidth:w=1280,rootHeight:C=720}=u,I=E?await Jhe(E,w,C,b):null,{video:{videoSsrc:T,activeCamera:D}}=h;return I?(d.startMaskSetting(p,g,I,T,S??D,w,C,v,m),b):Promise.reject("Clip is empty")}(n,e,t,r).then(u=>c?L6(!0):mc(Mi(Fq,1)).then(d=>{var h;return r||e.stopMaskSetting(),d?(u==null||(h=u.parentNode)===null||h===void 0||h.removeChild(u),!0):Promise.reject("Cannot set video mask")})):a===Yf.Mask&&n.imageUrl===o&&Qhe(n.clip,s)&&!l?Promise.resolve(!0):async function(u,d,h){const{imageUrl:f,cropped:p,clip:g,rootWidth:m,rootHeight:v}=u,{video:{mask:{imageSrc:b,cropped:S,clip:E},backgroundMode:w}}=h;if(f){if(w===Yf.VirtualBackground&&(d.stopVirtualBackgroundSetting(!0),await m7(()=>{d.stopMaskSetting()},0)),f!==b||p!==S){const C=await sD(f,p);C&&(d.updateMaskBackgroundImage(C),setTimeout(()=>{r3(C)},0))}if((!Qhe(g,E)||!b)&&g&&m&&v){const C=await Jhe(g,m,v);C&&(d.updateMaskClip(C,m,v),setTimeout(()=>{r3(C)},0))}}else d.updateMaskBackgroundImage(null),d.updateMaskClip(null,m,v)}(n,e,t)}const w5=Gr.createAgent(),af=El(zn.getInstance()),Zut=Gr.createAgent(),efe=El(zn.getInstance()),tfe={videoSsrc:0,cameraDevicesList:[],activeCamera:tn.isAndroidOrIOSBrowser?Kw.User:"default",activeVideoId:0,isCurrentUserStartedVideo:!1,spotlightUserList:[],isCaptureForbidden:!1,isMirrored:!1,receivedVideoMaxQuality:navigator.hardwareConcurrency>=8?Ph.Video_1080P:Ph.Video_360P,subscribedVideoList:[],renderedVideoList:[],ensuredCanvas:[],isVideoMuted:!1,isCaptureCameraLoading:!1,isCameraTaken:!1,isUsingMediaPlayback:!1,receivedVideoDimension:{width:0,height:0},capturedVideoDimension:{width:0,height:0},isFollowHostVideoLayout:!1,hostDragLayout:[],isSupportHDVideo:!1,isFullHDVideoEnabled:!1,bCanUnmuteVideo:!1,virtualBackground:{isVBConfigured:!1,isVBPreloadReady:void 0,imageSrc:void 0,cropped:void 0},mask:{imageSrc:void 0,cropped:void 0,clip:void 0},backgroundMode:Yf.Null,statistic:{encode:{sample_rate:0,rtt:0,jitter:0,avg_loss:0,max_loss:0,width:0,height:0,fps:0,bandwidth:0,bitrate:0},decode:{sample_rate:0,rtt:0,jitter:0,avg_loss:0,max_loss:0,width:0,height:0,fps:0,bandwidth:0,bitrate:0}},hardwareAcceleration:{encode:!1,decode:!1},networkQuality:{},ptz:{},currentCameraControlStatus:{isRequested:!1,isInControl:!1,isCameraMoving:!1},farEndCameraControlStatus:{controlledUserList:[],isControlling:!1},subscriptionStatus:{encode:!1,decode:!1,detailed:!1},videoAttachments:{},rendererType:Iq.WebGL,selfPreviewVideoList:[]},Xut=ru({[`${PTe}`]:Pe((n,e)=>{let{payload:t}=e;n.videoSsrc=t}),[`${Hte}`]:Pe((n,e)=>{let{payload:t}=e;n.cameraDevicesList=t}),[`${I6}`]:Pe((n,e)=>{let{payload:t}=e;const r=n.activeCamera;if(r in n.ptz){const i=n.ptz[r];["pan","tilt","zoom"].forEach(o=>{i[o]&&(i[o].value=0)})}n.activeCamera=t}),[`${kTe}`]:Pe((n,e)=>{let{payload:t}=e;n.activeVideoId=t.userId}),[`${TTe}`]:Pe((n,e)=>{let{payload:t}=e;n.isCurrentUserStartedVideo=t}),[`${fK}`]:Pe((n,e)=>{let{payload:t}=e;n.spotlightUserList=t}),[`${P6}`]:Pe((n,e)=>{let{payload:t}=e;n.isCaptureForbidden=t}),[`${DTe}`]:Pe((n,e)=>{let{payload:t}=e;n.receivedVideoMaxQuality=t}),[`${RTe}`]:Pe((n,e)=>{let{payload:t}=e;n.isVideoMuted=t}),[`${lP}`]:Pe((n,e)=>{let{payload:t}=e;n.isCaptureCameraLoading=t}),[`${k6}`]:Pe((n,e)=>{let{payload:t}=e;n.isCameraTaken=t}),[`${pK}`]:Pe((n,e)=>{let{payload:t}=e;n.receivedVideoDimension=t}),[`${L4}`]:Pe((n,e)=>{let{payload:t}=e;n.subscribedVideoList.includes(t)||n.subscribedVideoList.push(t)}),[`${N4}`]:Pe((n,e)=>{let{payload:t}=e;const r=n.subscribedVideoList.indexOf(t);r>=0&&n.subscribedVideoList.splice(r,1)}),[`${$C}`]:Pe((n,e)=>{let{payload:t}=e;const r=n.renderedVideoList.find(i=>i.userId===t.userId&&i.key===t.key&&i.canvasId===t.canvasId);r?(t.videoQuality!==void 0&&(r.videoQuality=t.videoQuality),t.aspectRatio!==void 0&&(r.aspectRatio=t.aspectRatio)):n.renderedVideoList.push({...t})}),[`${T6}`]:Pe((n,e)=>{let{payload:t}=e;const r=n.renderedVideoList.findIndex(i=>i.userId===t.userId&&i.key===t.key&&i.canvasId===t.canvasId);r>=0&&n.renderedVideoList.splice(r,1)}),[`${OTe}`]:Pe((n,e)=>{let{payload:t}=e;n.isFollowHostVideoLayout=t}),[`${MTe}`]:Pe((n,e)=>{let{payload:t}=e;n.hostDragLayout=t}),[`${$Te}`]:Pe((n,e)=>{let{payload:t}=e;n.isSupportHDVideo=t}),[`${LTe}`]:Pe((n,e)=>{let{payload:t}=e;n.maximumNumbeOfHDSubscriptions=t}),[`${NTe}`]:Pe((n,e)=>{let{payload:t}=e;n.bCanUnmuteVideo=t}),[`${gK}`]:Pe((n,e)=>{let{payload:t}=e;n.virtualBackground.isVBPreloadReady=t}),[`${D6}`]:Pe((n,e)=>{let{payload:t}=e;n.virtualBackground.isVBConfigured=t}),[`${F4}`]:Pe((n,e)=>{let{payload:t}=e;n.virtualBackground.imageSrc=t.imageUrl,n.virtualBackground.cropped=t.cropped,n.backgroundMode=Yf.VirtualBackground}),[`${Ow}`]:Pe((n,e)=>{let{payload:t}=e;const{encode:r,decode:i}=t;r!==void 0&&(n.hardwareAcceleration.encode=r),i!==void 0&&(n.hardwareAcceleration.decode=i)}),[`${R6}`]:Pe((n,e)=>{let{payload:t}=e;const{data:{encoding:r,rate:i,...o}}=t;n.statistic.encode={bitrate:i,...o}}),[`${A6}`]:Pe((n,e)=>{let{payload:t}=e;const{data:{encoding:r,rate:i,...o}}=t;n.statistic.decode={bitrate:i,...o}}),[`${FTe}`]:Pe((n,e)=>{let{payload:t}=e;const{cameraId:r,captureWidth:i,captureHeight:o,videoElement:s,originalRatio:a,ptz:c,hd:l,fullHd:u,mediaFile:d,fps:h,mirrored:f}=t;n.activeCamera=r,n.customizedVideoOption={captureWidth:i,captureHeight:o,videoElement:s,originalRatio:a,ptz:c,hd:l,fullHd:u,fps:h},eD(n.mediaPlaybackFile,d)||(n.mediaPlaybackFile=d,n.isUsingMediaPlayback=!(d==null||!d.url)),f!==void 0&&(n.isMirrored=!!f)}),[`${mK}`]:Pe((n,e)=>{let{payload:t}=e;const{userId:r,level:i,bwLevel:o,type:s}=t;if(Object.prototype.hasOwnProperty.call(n.networkQuality,`${r}`))n.networkQuality[`${r}`][`${s}`]={level:i,bwLevel:o};else{const a={[s]:{level:i,bwLevel:o}};Object.assign(n.networkQuality,{[`${r}`]:a})}}),[`${jTe}`]:Pe((n,e)=>{let{payload:t}=e;const{deviceId:r,ptzRange:i}=t;if(Object.prototype.hasOwnProperty.call(n.ptz,r)){const o=n.ptz[r];o&&["pan","tilt","zoom"].forEach(s=>{const a=i[s];if(a){var c;const l=(c=o[s])===null||c===void 0?void 0:c.capability;l?Object.assign(l,{...a}):o[s]={capability:{...a},value:0}}})}else Object.assign(n.ptz,{[r]:{pan:i.pan?{capability:{...i.pan},value:0}:null,tilt:i.tilt?{capability:{...i.tilt},value:0}:null,zoom:i.zoom?{capability:{...i.zoom},value:0}:null}})}),[`${O6}`]:Pe((n,e)=>{let{payload:t}=e;n.currentCameraControlStatus.isRequested=t}),[`${M6}`]:Pe((n,e)=>{let{payload:t}=e;const{isInControl:r,userId:i}=t;n.currentCameraControlStatus.isInControl=r,n.currentCameraControlStatus.controllingUserId=i}),[`${BTe}`]:Pe((n,e)=>{let{payload:t}=e;n.farEndCameraControlStatus.controlledUserList.includes(t)||n.farEndCameraControlStatus.controlledUserList.push(t)}),[`${$6}`]:Pe((n,e)=>{let{payload:t}=e;const r=n.farEndCameraControlStatus.controlledUserList.indexOf(t);r!==-1&&n.farEndCameraControlStatus.controlledUserList.splice(r,1)}),[`${vK}`]:Pe((n,e)=>{let{payload:t}=e;n.currentCameraControlStatus.isCameraMoving=t.cmd==="start"}),[`${Ute}`]:Pe((n,e)=>{let{payload:t}=e;const{constraints:r,deviceId:i}=t,o=n.ptz[i];["pan","tilt","zoom"].forEach(s=>{r[s]!==void 0&&(o[s].value=r[s])})}),[`${yK}`]:Pe((n,e)=>{let{payload:t}=e;n.farEndCameraControlStatus.isControlling=t}),[`${HTe}`]:Pe((n,e)=>{let{payload:t}=e;n.networkQualityBroadcastTime=t}),[`${L6}`]:Pe((n,e)=>{let{payload:t}=e;n.mask.isMaskConfigured=t}),[`${j4}`]:Pe((n,e)=>{let{payload:t}=e;const{imageUrl:r,cropped:i,rootHeight:o,rootWidth:s,clip:a}=t;n.mask.imageSrc=r,n.mask.cropped=i,n.mask.clip=a,n.mask.rootWidth=s,n.mask.rootHeight=o,n.backgroundMode=Yf.Mask}),[`${ect}`]:Pe((n,e)=>{let{payload:t}=e;n.backgroundMode=t}),[`${UTe}`]:Pe((n,e)=>{let{payload:t}=e;n.capturedVideoDimension=t}),[`${zTe}`]:Pe((n,e)=>{let{payload:t}=e;n.ensuredCanvas.includes(t)||n.ensuredCanvas.push(t)}),[`${bK}`]:Pe((n,e)=>{let{payload:t}=e;n.mediaPlaybackFile=t,n.isUsingMediaPlayback=!(t==null||!t.url)}),[`${LC}`]:Pe((n,e)=>{let{payload:t}=e;if(t){const{lastCopy:r,...i}=t;n.prefetchedVideo=i}else n.prefetchedVideo=t}),[`${SK}`]:Pe((n,e)=>{let{payload:t}=e;Object.assign(n.subscriptionStatus,t)}),[`${VTe}`]:Pe((n,e)=>{let{payload:t}=e;n.isFullHDVideoEnabled=t}),[`${WTe}`]:Pe((n,e)=>{let{payload:t}=e;const{userId:r,element:i}=t,o=n.videoAttachments[`${r}`];if(o)o.indexOf(i)===-1&&o.push(i);else{const s=[];s.push(i),Object.assign(n.videoAttachments,{[`${r}`]:s})}}),[`${B4}`]:Pe((n,e)=>{let{payload:t}=e;const{userId:r,element:i}=t,o=n.videoAttachments[`${r}`];let s=i;Array.isArray(i)||(s=[i]),s.forEach(a=>{if(o){const c=o.indexOf(a);c!==-1&&o.splice(c,1)}})}),[`${qTe}`]:Pe((n,e)=>{let{payload:t}=e;t&&(n.rendererType=Iq.WebGL2)}),[`${KTe}`]:Pe((n,e)=>{let{payload:t}=e;t&&(n.rendererType=Iq.WebGPU)}),[`${GTe}`]:Pe((n,e)=>{let{payload:t}=e;n.rendererType=t}),[`${ZTe}`]:Pe((n,e)=>{let{payload:t}=e;n.isMirrored=t}),[`${XTe}`]:Pe((n,e)=>{let{payload:t}=e;n.selfPreviewVideoList.includes(t)||n.selfPreviewVideoList.push(t)}),[`${_K}`]:Pe((n,e)=>{let{payload:t}=e;if(t){const r=n.selfPreviewVideoList.indexOf(t);r>=0&&n.selfPreviewVideoList.splice(r,1)}else n.selfPreviewVideoList=[]}),[`${ATe}`]:(n,e)=>{let{payload:t}=e;const r={cameraDevicesList:n.cameraDevicesList};return t&&Object.assign(r,{activeCamera:n.activeCamera,customizedVideoOption:n.customizedVideoOption,virtualBackground:{imageSrc:n.virtualBackground.imageSrc,cropped:n.virtualBackground.cropped},mask:{imageSrc:n.mask.imageSrc,cropped:n.mask.cropped,rootWidth:n.mask.rootWidth,rootHeight:n.mask.rootHeight,clip:n.mask.clip},backgroundMode:n.backgroundMode,ptz:n.ptz,subscriptionStatus:n.subscriptionStatus}),{...tfe,...r}}},tfe),Yut={cameraPtzEpics0:(n,e)=>zt(n,8004).pipe(ht(t=>{const{payload:{body:{nCmd:r,nUserID:i,nReason:o,nButtonID:s}}}=t,a=e.value,c=Yi(a),{video:{currentCameraControlStatus:{isInControl:l,controllingUserId:u},cameraDevicesList:d,activeCamera:h}}=a,f=c.find(g=>Gl(g.userId,i)),p=[];if(p.push(O6(!0)),r===ul.Request){const g={userId:f==null?void 0:f.userId,displayName:f==null?void 0:f.displayName};if(l){const m=c.find(v=>v.userId===u);Object.assign(g,{currentControllingUserId:m==null?void 0:m.userId,currentControllingDisplayName:m==null?void 0:m.displayName})}me(Eke,g)}else if(r===ul.Approve)p.push(BTe(f==null?void 0:f.userId)),me(Nq,{isApproved:!0,userId:f==null?void 0:f.userId,displayName:f==null?void 0:f.displayName});else if(r===ul.Decline)p.push($6(f==null?void 0:f.userId)),me(Nq,{isApproved:!1,userId:f==null?void 0:f.userId,displayName:f==null?void 0:f.displayName,reason:o});else if(r===ul.GiveUp)p.push(M6({isInControl:!1,userId:0})),me(d6,{isControlled:!1});else if(r===ul.StartControl||r===ul.StopControl)p.push(vK({cmd:r===ul.StartControl?"start":"stop",type:s}));else if(r===ul.SwitchCamera){const g=d.findIndex(v=>v.deviceId===h),m=g+1===d.length?0:g+1;if(m!==g){const v=d[m].deviceId;efe.changeCamera(v,S7.includes(v))}}return Tt(p)})),cameraPtzEpics1:(n,e)=>zt(n,Co).pipe(st(t=>{var r;const{payload:{body:i}}=t;return i==null||(r=i.update)===null||r===void 0?void 0:r.some(o=>o.nFECC!==void 0||o.nFECCExecutive!==void 0)}),en(t=>{const{payload:{body:{update:r}}}=t,i=r.find(o=>o.nFECC!==void 0||o.nFECCExecutive!==void 0);if(i){const{meeting:{userId:o}}=e.value;Gl(i.nFECCExecutive,o)&&me(Ike,{userId:i.id,ptz:XRe(i.nFECC)})}}),$n(Mt)),cameraPtzEpics2:(n,e)=>zt(n,Co).pipe(st(t=>{var r;const{payload:{body:i}}=t,{video:{farEndCameraControlStatus:{controlledUserList:o}}}=e.value;return i==null||(r=i.remove)===null||r===void 0?void 0:r.some(s=>o.includes(s.id))}),ht(t=>{var r;const{payload:{body:i}}=t,o=[],{video:{farEndCameraControlStatus:{controlledUserList:s}}}=e.value,a=i==null||(r=i.remove)===null||r===void 0?void 0:r.find(c=>s.includes(c.id));return a&&o.push($6(a.id)),Tt(o)})),cameraPtzEpics3:(n,e)=>n.pipe(rn(`${vK}`),zr(t=>{const{payload:{cmd:r,type:i}}=t;return r==="start"?js(0,200).pipe(S1(()=>!!e.value.video.currentCameraControlStatus.isCameraMoving),ht(()=>{const{video:{ptz:o,activeCamera:s}}=e.value,a=o[s],c=yne(a)||{},{key:l,range:u}=ZRe(i,2);return a[l]?(Object.assign(c,{[l]:GRe(a[l].capability,a[l].value,u)}),efe.movePTZCamera(c).then(()=>Ute({deviceId:s,constraints:c}))):Promise.resolve(void 0)}),ht(o=>typeof o=="object"&&o.type!==void 0?hi(o):Mt)):Mt})),cameraPtzEpics4:(n,e)=>n.pipe(rn(`${I6}`),ht(t=>{const{payload:r}=t,{video:{customizedVideoOption:i,ptz:o}}=e.value;if(i!=null&&i.ptz){const s=o==null?void 0:o[r];s!==void 0&&Zut.sendCameraAblity({pan:!!s.pan,tilt:!!s.tilt,zoom:!!s.zoom})}return Mt}))},Jut={videoCaptureEpics0:(n,e)=>Vn(n,bt.StartVideoCaptureSuccess).pipe(bl(Ag),ht(t=>{const{video:{cameraDevicesList:r,activeCamera:i,ptz:o,isCurrentUserStartedVideo:s,isUsingMediaPlayback:a},meeting:{userId:c}}=e.value,{payload:{data:{currentDeviceID:l,PTZRange:u}}}=t,d=[];if(r.length<1&&!a&&(me(kq,{reason:"Cannot detect camera devices"}),af.stopCaptureVideo()),WRe(i,r)||a){if(s||w5.muteAttendeeVideo(c,!1),me(Pke),a)d.push(I6("default"));else if(l&&u&&d.push(jTe({deviceId:l,ptzRange:u})),i!==l&&d.push(I6(l)),Object.prototype.hasOwnProperty.call(o,l)){const h=o[l];if(h){const f=yne(h);f&&af.movePTZCamera(f)}}}else me(Tq,{reason:"cannot find target camera"}),af.stopCaptureVideo();return Tt(d)})),videoCaptureEpics1:(n,e)=>zt(n,Co).pipe(st(t=>{const{payload:{body:{update:r}}}=t,{meeting:{userId:i}}=e.value;return r==null?void 0:r.some(o=>o.id===i&&o.bVideoOn!==void 0)}),Vt(t=>{const{payload:{body:{update:r}}}=t,{meeting:{userId:i}}=e.value,o=r.find(s=>s.id===i);return o.bVideoOn===!0?me(Ite):me(oS),TTe(!!o.bVideoOn)})),videoCaptureEpics2:n=>Vn(n,[bt.UserForbiddedCaptureVideo,bt.UserCameraIsTakenByOtherPrograms,bt.VideoWebsocketBroken,bt.StopVideoCaptureFailed]).pipe(ht(e=>{const{payload:{type:t}}=e,r=[];switch(t){case bt.UserForbiddedCaptureVideo:me(Dq),r.push(P6(!0));break;case bt.UserCameraIsTakenByOtherPrograms:me(Rq,{reason:"User camera is taken by other programs."}),r.push(k6(!0));break;case bt.VideoWebsocketBroken:me(_ke,{reason:"Video websocket broken."});break;case bt.StopVideoCaptureFailed:me(oS,{failed:!0,reason:"Unknown."})}return Tt(r)})),videoCaptureEpics3:(n,e)=>Vn(n,bt.StopVideoCaptureSuccess).pipe(nn(e),OS(t=>{let[,r]=t;const{meeting:{userId:i},video:{isCurrentUserStartedVideo:o}}=r;o||me(oS),w5.muteAttendeeVideo(i,!0)})),videoCaptureEpics4:(n,e)=>zt(n,16133).pipe(nn(e),st(t=>{var r,i;let[o,s]=t;return(o==null||(r=o.payload)===null||r===void 0||(i=r.body)===null||i===void 0?void 0:i.id)===s.meeting.userId}),OS(t=>{let[r]=t;const{id:i,bVideoMute:o}=r.payload.body;return me(vke,{id:i,isVideoMuted:o}),o===!0&&af.stopCaptureVideo(),o===!1&&me(yke,{id:i,isVideoMuted:o}),RTe(o)})),videoCaptureEpics5:(n,e)=>zt(n,16131).pipe(st(t=>t.payload.body.ssrc!==void 0),zr(t=>{const{payload:{body:{ssrc:r}}}=t;return me(Tke,r),ga(hi(PTe(r)),AS(e).pipe(ht(i=>{const{meeting:{isCurrentUserStartVideoBeforeReset:o},media:{videoEncodeStatus:s}}=e.value;return(i==null?void 0:i.bVideoOn)!==!0&&o===!0?Tc("video",s,"success").pipe(st(a=>{let[c,l]=a;return c&&l}),Vt(()=>{const a=e.value,{video:{backgroundMode:c,mask:l,virtualBackground:u,activeCamera:d,customizedVideoOption:h}}=a;let f=Promise.resolve(!0);return c===Yf.VirtualBackground&&u.imageSrc?f=G4({imageUrl:u.imageSrc,cropped:u.cropped},af,a):c===Yf.Mask&&l.imageSrc&&l.clip&&(f=Z4({imageUrl:l.imageSrc,cropped:l.cropped,clip:l.clip,rootHeight:l.rootHeight,rootWidth:l.rootWidth},af,a)),f.then(()=>{KRe(af,a,{cameraId:d,...h})}),UPe(void 0)})):Mt})))})),videoCaptureEpics6:(n,e)=>n.pipe(rn(`${Hte}`),en(t=>{const{payload:r}=t,i=e.value,{meeting:{userId:o}}=i,s=mn(i);r.length===0?s&&!s.bVideoConnect||w5.connectCamera(o,!1):s!=null&&s.bVideoConnect||w5.connectCamera(o,!0)}),$n(Mt)),videoCaptureEpics7:n=>Vn(n,bt.InitSuccessVideo).pipe(st(e=>!tn.isIPad&&tn.isAndroidOrIOSBrowser&&e.payload.data===Ul.EncodeSuccess),zr(()=>"orientation"in window.screen?No(screen.orientation,"change").pipe(ht(()=>(af.setMobileRotateMode(Xhe()),Mt))):No(window,"orientationchange").pipe(ht(e=>{var t,r,i;const o=(t=e.target)===null||t===void 0||(r=t.screen)===null||r===void 0||(i=r.orientation)===null||i===void 0?void 0:i.angle,s=Math.abs(o)===90;return af.setMobileRotateMode(s),Mt})))),videoCaptureEpics8:n=>Vn(n,bt.StartVideoCaptureSuccess).pipe(st(()=>!tn.isIPad&&tn.isAndroidOrIOSBrowser),en(()=>{af.setMobileRotateMode(Xhe())}),$n(Mt)),videoCaptureEpics9:(n,e)=>Vn(n,bt.VideoStreamFailed).pipe(st(()=>!!e.value.video.isCurrentUserStartedVideo&&tn.isIOSMobile),en(()=>{af.stopCaptureVideo()}),$n(Mt))},Qut={videoRenderEpics0:n=>zt(n,16129).pipe(Vt(e=>{const{payload:{body:{id:t,bVideoOn:r}}}=e,i=Zhe(t);return me(mke,{bVideoOn:r,userId:i}),kTe({bVideoOn:r,userId:i})})),videoRenderEpics1:(n,e)=>Vn(n,bt.VideoDecodeMaxSize).pipe(st(t=>{var r;return t==null||(r=t.payload)===null||r===void 0?void 0:r.data}),Vt(t=>{const{size:r}=t.payload.data,{video:{renderedVideoList:i,receivedVideoMaxQuality:o},meeting:{userId:s}}=e.value,a=i.filter(c=>c.videoQuality>=Ph.Video_720P&&c.userId!==s);return o!==r&&a.length>0&&(r>=Ph.Video_720P||o>=Ph.Video_720P)&&a.forEach(c=>{Z_.subscribeVideo(c.userId,c.videoQuality,!1)}),DTe(r)})),videoRenderEpics2:n=>zt(n,16135).pipe(Vt(e=>{const{payload:{body:{bLeadershipOn:t,id:r}}}=e,i=[];return t&&i.push(Zhe(r)),me(Aq,{spotlightList:i}),fK(i)})),videoRenderEpics3:(n,e)=>zt(n,7958).pipe(nn(e),Vt(t=>{let[r,i]=t;const{payload:{body:o}}=r;let s=[];o&&o.group_list&&o.group_list[0]&&(s=o.group_list[0].map(c=>c.id));const a=Yi(i);return s=s.filter(c=>a.findIndex(l=>l.userId===c)>=0),me(Aq,{spotlightList:s}),fK(s)})),videoRenderEpics4:n=>Vn(n,bt.CurrentVideoResolution).pipe(OS(e=>(me(Pq,e.payload.data),pK(e.payload.data)))),videoRenderEpics5:n=>Vn(n,[bt.CurrentVideoResolution,bt.CurrentCaptureVideoWidthHeight]).pipe(st(e=>!!e.payload.data),Vt(e=>{const{payload:{data:t,type:r}}=e;return r===bt.CurrentVideoResolution?(me(Pq,t),pK(t)):(me(bke,t),UTe(t))})),videoRenderEpics6:n=>zt(n,Md).pipe(st(e=>{const{payload:{body:t}}=e;return["bFollowHostVideo","VideoHd","bCanUnmuteVideo"].some(r=>t[r]!==void 0)}),Vt(e=>{const{payload:{body:{bFollowHostVideo:t,VideoHd:r,bCanUnmuteVideo:i}}}=e;if(t!==void 0)return me(wke,{bOn:t}),OTe(t);if(i!==void 0)return NTe(i);{const o=r===1;return vp.updateVideoHDValue(o),vp.enableHardwareAccelerationForVideoEncode(!1),$Te(o)}})),videoRenderEpics7:(n,e)=>zt(n,7957).pipe(nn(e),Vt(t=>{let[r,i]=t;const{video:{isFollowHostVideoLayout:o}}=i,{payload:{body:s}}=r,a=s&&s.drag_list&&s.drag_list.map(c=>c.id);return o&&me(Cke,{layout:a}),MTe(a)})),videoRenderEpics8:(n,e)=>zt(n,Co).pipe(nn(e),st(t=>{let[r,i]=t;const{meeting:{userId:o},video:{subscribedVideoList:s}}=i,a=r.payload.body.update,c=r.payload.body.remove;return a&&a.length>0&&a.findIndex(l=>l.id!==o&&(l.bVideoOn!==void 0||l.bHold))>-1||c&&c.some(l=>s.includes(l.id))}),en(t=>{let[r,i]=t;const{payload:{body:{remove:o,update:s}}}=r,{video:{subscribedVideoList:a}}=i,c=Xat(i);if(o&&o.length>0&&o.filter(l=>a.includes(l.id)).forEach(l=>{me(T4,{userId:l.id})}),s&&s.length>0){const l=s.filter(d=>d.bVideoOn!==void 0).filter(d=>c.findIndex(h=>h.userId===d.id)===-1),u=s.filter(d=>d.bHold===!0);u.length>0&&u.filter(d=>a.includes(d.id)).forEach(d=>{me(T4,{userId:d.id})}),l.forEach(d=>{d.bVideoOn?me(xke,{userId:d.id}):a.includes(d.id)&&me(T4,{userId:d.id})})}}),$n(Mt)),videoRenderEpics9:(n,e)=>Vn(n,bt.VideoQosData).pipe(nn(e),Vt(t=>{var r;let[i,o]=t;const{video:{isCaptureForbidden:s,isCameraTaken:a},media:{videoEncodeStatus:c,videoDecodeStatus:l}}=o,u=mn(o),d=Mte(o),h=d.length>0,f=(u==null?void 0:u.bVideoOn)&&!s&&!a,p=d.some(v=>v.bVideoOn),g=c==="success"&&f&&h,m=l==="success"&&h&&p;return(r=i.payload.data)!==null&&r!==void 0&&r.encoding?g?(me(Mq,i.payload),R6(i.payload)):R6($0):m?(me(Mq,i.payload),A6(i.payload)):A6($0)})),videoRenderEpics10:(n,e)=>Vn(n,[bt.CurrentDecodeVideoQuality,bt.CurrentDecodeVideoFps]).pipe(en(t=>{const{payload:{type:r,data:i}}=t,{video:{subscriptionStatus:o}}=e.value;if(o.detailed){if(r===bt.CurrentDecodeVideoQuality){const{ssrc:s,width:a,height:c,quality:l}=i;me($q,{userId:s,width:a,height:c,quality:l})}else if(r===bt.CurrentDecodeVideoFps){const{ssrc:s,fps:a}=i;me($q,{userId:s,fps:a})}}}),$n(Mt)),videoRenderEpics11:(n,e)=>pte(n,e).pipe(ht(async()=>tn.isAndroidOrIOSBrowser?1:await zn.isSupportVideoDecodeHardwareAcceleration()?4:1),Vt(t=>LTe(t))),videoRenderEpics12:(n,e)=>Vn(n,bt.NetworkQualityChange).pipe(st(t=>!!t.payload.data),ht(t=>{var r;const{payload:{data:{bwLevel:i,isUplink:o,networkLevel:s}}}=t,a=[],{meeting:{userId:c},video:{networkQuality:l,subscribedVideoList:u,networkQualityBroadcastTime:d}}=e.value,h=o?"uplink":"downlink";a.push(mK({userId:c,level:s,bwLevel:i,type:h}));const f=eD((r=l[`${c}`])===null||r===void 0?void 0:r[h],{level:s,bwLevel:i});if(!f&&s!==-1&&(!o&&u.filter(p=>p!==c).length>0||o)&&me(Lq,{userId:c,type:h,level:s}),o){const p=performance.now();(!f||p-(d??0)>3e4)&&(Z_.broadcastUserNetworkQuality({isUplink:o,level:s,bwLevel:i}),a.push(HTe(p)))}return Tt(a)})),videoRenderEpics13:(n,e)=>Uf(n,8005).pipe(st(t=>{var r;return!((r=t.payload.body)===null||r===void 0||!r.nUserID)}),ht(t=>{const{payload:{body:{nLevel:r,nUserID:i}}}=t,{video:{networkQuality:o}}=e.value,s=o[`${i}`],a=[];return s&&s.uplink.level===r||(me(Lq,{userId:i,level:r,type:"uplink"}),a.push(mK({userId:i,level:r,type:"uplink"}))),Tt(a)})),videoRenderEpics14:(n,e)=>zt(n,Co).pipe(st(t=>{const{payload:{body:r}}=t,{video:{prefetchedVideo:i}}=e.value;return(i==null?void 0:i.userId)&&(r.update||r.remove)}),ht(t=>{const{payload:{body:r}}=t,i=[],{video:{prefetchedVideo:o}}=e.value;let s=!1;return r.remove&&(s=r.remove.findIndex(a=>a.id===(o==null?void 0:o.userId))!==-1),r.update&&(s=r.update.findIndex(a=>a.id===(o==null?void 0:o.userId)&&a.bVideoOn===!1)!==-1),s&&o&&(o.loaded||vp.cancelPrefetchVideoSsrc(o.userId),Z_.unsubscribeVideo(o.userId),i.push(LC(void 0))),Tt(i)})),videoRenderEpics15:(n,e)=>n.pipe(rn(`${LC}`),st(t=>!!t.payload),en(t=>{const{payload:{lastCopy:r}}=t,{video:{prefetchedVideo:i}}=e.value;!i||r&&r.userId===i.userId||(r!=null&&r.userId&&(r.loaded&&vp.cancelPrefetchVideoSsrc(r.userId),Z_.unsubscribeVideo(r.userId)),Z_.subscribeVideo(i.userId,Ph.Video_360P,!1),vp.prefetchVideoSsrc(i.userId))}),$n(Mt)),videoRenderEpics16:(n,e)=>Vn(n,bt.NewActiveSpeakerFirstFrameCallback).pipe(st(()=>!!e.value.video.prefetchedVideo),ht(t=>{const{payload:{data:{ssrc:r}}}=t,{video:{prefetchedVideo:i}}=e.value,o=[];return i&&(Gl(i.userId,r)?(o.push(LC({userId:i.userId,loaded:!0,lastCopy:i})),me(kke,{userId:i.userId})):Z_.unsubscribeVideo(i.userId)),Tt(o)})),videoRenderEpics17:(n,e)=>zt(n,16131).pipe(st(t=>t.payload.body.ssrc!==void 0),en(()=>{const{media:{videoDecodeStatus:t,videoEncodeStatus:r}}=e.value;Tc("video",r,t).subscribe(i=>{let[o,s]=i;const{video:{subscriptionStatus:a}}=e.value;o&&a.encode&&vp.subscribeToQos([Ya.VideoEncode],l0),s&&(a.decode&&vp.subscribeToQos([Ya.VideoDecode],l0),a.detailed&&vp.enableVideoObserver(!0))})}),$n(Mt)),videoRenderEpics18:(n,e)=>n.pipe(rn(`${$C}`,`${T6}`),st(()=>{const t=e.value.video.renderedVideoList.length;return[0,1].includes(t)}),en(()=>{const t=e.value.video.renderedVideoList.length;t===1?vp.enableVideoObserver(!0,!0):t===0&&vp.enableVideoObserver(!1)}),$n(Mt)),videoRenderEpics19:(n,e)=>Vn(n,bt.CurrentDecodeVideoQuality).pipe(ht(t=>{const{payload:{data:r}}=t,{video:{renderedVideoList:i,videoAttachments:o}}=e.value,s=[],{ssrc:a,width:c,height:l}=r,u=l?c/l:0,d=i.filter(h=>Gl(h.userId,a));if(d.some(h=>h.aspectRatio&&Math.abs(h.aspectRatio-u)>.2)){const h=d.filter(f=>f.canvasId===KP);if(h.length>0){const f=o[`${a}`];f&&f.every(p=>{if(p){const{clientWidth:g,clientHeight:m}=p,v=m?g/m:0;return Math.abs(v-u)<=.2}return!0})&&s.push($C({userId:a,key:zb,canvasId:KP,aspectRatio:u}))}h.length===d.length&&s.length!==0||me(Dke,{userId:a,aspectRatio:u})}return Tt(s)})),videoRenderEpics20:(n,e)=>Vn(n,bt.SyncRendererTypeResponse).pipe(ht(t=>{const{payload:{data:{rendererType:r}}}=t,{video:{rendererType:i}}=e.value,o=[];return i!==r&&o.push(GTe(r)),Tt(o)}))},edt=iu(Qut,Jut,{vbEpics0:n=>Vn(n,[bt.VbModelPreloadingOk,bt.VbModelPreloading_3S,bt.VbModelPreloading_10S,bt.VbSettingParaError]).pipe(ht(e=>{const{payload:{type:t,data:r}}=e,i=[];return[bt.VbModelPreloadingOk,bt.VbModelPreloading_3S,bt.VbModelPreloading_10S].includes(t)?(i.push(gK(!0)),me(u6,!0),t===bt.VbModelPreloading_10S&&console.warn("Virtual Background is taking longer than expected to load.")):t===bt.VbSettingParaError&&(r===gke.VBModelNotMatch?(me(u6,!1),i.push(gK(!1))):(me(Oq,!1),i.push(D6(!1)))),Tt(i)})),vbEpics1:n=>Vn(n,bt.StartVideoStreamInVbSettingSuccess).pipe(Vt(()=>(me(Oq,!0),D6(!0)))),vbEpics2:n=>Vn(n,bt.StartVideoStreamInMaskSettingSuccess).pipe(Vt(()=>(me(Fq,!0),L6(!0)))),vbEpics3:n=>Vn(n,bt.MaskSettingParaError).pipe(Vt(()=>(me(Fq,!1),L6(!1))))},Yut);class Ch{constructor(){this.assetsPath=void 0,this.instance=void 0,this.callbackList=void 0,this.mediaWorkersPath=void 0,this.mediaOptions=void 0,this.inProgress=void 0,this.callbackList=[]}static getInstance(){return this.agentInstance===void 0&&(this.agentInstance=new Ch),this.agentInstance}init(e,t){var r,i,o,s,a;if(!this.instance&&window.JsMediaSDK_Instance){const l={ivObj:{[fa.AUDIO_ENCODE]:void 0,[fa.VIDEO_ENCODE]:void 0,[fa.SHARING_ENCODE]:void 0}};this.instance=new window.JsMediaSDK_Instance(l)}this.mediaWorkersPath=ske(e,!1),this.onMediaSDKCallback=this.onMediaSDKCallback.bind(this),this.mediaOptions=t,(r=this.instance)===null||r===void 0||r.JsMediaSDK_PreLoad(this.mediaWorkersPath,this.onMediaSDKCallback,t);const c=RC((i=this.mediaOptions)===null||i===void 0?void 0:i.enableMultiDecodeVideoWithoutSAB);(o=this.instance)===null||o===void 0||o.setPropsBeforeInit({callback:this.onMediaSDKCallback,audioWorkerPath:(s=this.mediaWorkersPath)===null||s===void 0?void 0:s.audioWorkletPath,isEnableListenInitEvent:!0}),(a=this.instance)===null||a===void 0||a.initVideoEncode(this.mediaWorkersPath,"",0,!1,"",0,c,!1,!1,!0,!0,!1,!0),this.inProgress=!0}onMediaSDKCallback(e,t){this.callbackList.length>0&&this.callbackList.forEach(r=>r(e,t))}registerCallback(e){this.callbackList.push(e)}unregisterCallback(e){this.callbackList=this.callbackList.filter(t=>t!==e)}async destroy(){var e;this.callbackList=[],await((e=this.instance)===null||e===void 0?void 0:e.destroy()),this.instance=null,this.inProgress=!1}disconnect(){var e,t;(e=this.instance)===null||e===void 0||e.Notify_MeidaSDK(17,{}),(t=this.instance)===null||t===void 0||t.JsMediaSDK_UnInit()}startVirtualBackgroundSetting(e,t,r,i,o,s){var a;let c=arguments.length>6&&arguments[6]!==void 0&&arguments[6];(a=this.instance)===null||a===void 0||a.Notify_MeidaSDK(91,{canvas:e,bgdom:t,width:o,height:s,ssid:0,VideoSelectValue:i==="default"?null:i,disableOriginalRatio:c,usingFacingMode:["user","environment"].includes(i)})}updateVirtualBackgroundImage(e){var t;(t=this.instance)===null||t===void 0||t.Notify_MeidaSDK(92,{bgdom:e})}stopVirtualBackgroundSetting(){var e;let t=arguments.length>0&&arguments[0]!==void 0&&arguments[0];(e=this.instance)===null||e===void 0||e.Notify_MeidaSDK(93,{isSwitch:t})}startMaskSetting(e,t,r,i,o,s,a,c,l){var u;(u=this.instance)===null||u===void 0||u.Notify_MeidaSDK(62,{canvas:e,maskdom:null,bgdom:null,dx:0,dy:0,dWidth:170,dHeight:170,width:1280,height:720,ssid:0,originWidth:379,originHeight:213,VideoSelectValue:o==="default"?null:o,usingFacingMode:["user","environment"].includes(o)})}stopMaskSetting(){var e;let t=arguments.length>0&&arguments[0]!==void 0&&arguments[0];(e=this.instance)===null||e===void 0||e.Notify_MeidaSDK(65,{isSwitch:t})}}Ch.agentInstance=void 0;const nfe="PREVIEW_VIDEO_ENCODE_SUCCESS",NB="PREVIEW_VIDEO_VB_MODEL_READY";async function rfe(n,e,t,r){const{imageUrl:i,cropped:o,deviceId:s}=t,a=$m("__ZOOM_SDK_PREVIEW_VIRTUAL_BACKGROUND_CANVAS_@__");e.id||(e.id=a);let[c,l]=[640,360];if(zn.isSupportSending720P()&&(c=1280,l=720),i&&V6(r)){const u=await sD(i,o);return n.startVirtualBackgroundSetting(e,u,0,s??"default",c,l),u&&u!==F2&&setTimeout(()=>{r3(u)},0),"vb"}return n.startMaskSetting(e,null,null,0,s??"default",0,0,0,0),"mask"}class Am{constructor(){this.previewMediaAgent=Ch.getInstance(),this.isInit=void 0,this.isVideoEncoded=void 0,this.isVBModelReady=void 0,this.state=void 0,this.eventHandler=(e,t)=>{switch(e){case bt.InitSuccessVideo:t===Ul.EncodeSuccess&&(this.isVideoEncoded=!0,me(nfe));break;case bt.VbModelPreloadingOk:case bt.VbModelPreloading_3S:case bt.VbModelPreloading_10S:this.isVBModelReady=!0,me(NB,!0);break;case bt.VbSettingParaError:t===gke.VBModelNotMatch&&(this.isVBModelReady=!1,me(NB,!1))}}}static setMediaOption(e){Am.mediaOption=e}setup(){if(Am.mediaOption){if(zn.getInstance().inProgress)return Promise.resolve("");if(!Ch.getInstance().inProgress){this.isVideoEncoded=void 0,this.isVBModelReady=void 0,this.previewMediaAgent.unregisterCallback(this.eventHandler);const{assetsPath:e,enforceMultipleVideos:t,enforceVirtualBackground:r}=Am.mediaOption,i={...VDe(e,t,r)};this.previewMediaAgent.init(e,i),this.previewMediaAgent.registerCallback(this.eventHandler)}return Promise.resolve("")}return Promise.reject({type:lt,reason:"Cannot preview video with virtual background before `client.init` method."})}async startPreview(e,t){var r;zn.getInstance().inProgress?rfe(zn.getInstance(),e,t,(r=Am.mediaOption)===null||r===void 0?void 0:r.enforceVirtualBackground):(this.isVBModelReady!==void 0?Tt([this.isVBModelReady]):Mi(NB,1)).subscribe(i=>{i&&(this.isVideoEncoded?Tt([!0]):Mi(nfe,1)).subscribe(()=>{var o;rfe(Ch.getInstance(),e,t,(o=Am.mediaOption)===null||o===void 0?void 0:o.enforceVirtualBackground).then(s=>{this.state={mode:s,canvas:e,vb:t}})})})}async stopPreview(){var e;zn.getInstance().inProgress?zn.getInstance().stopVirtualBackgroundSetting():((e=this.state)===null||e===void 0?void 0:e.mode)==="vb"?Ch.getInstance().stopVirtualBackgroundSetting():Ch.getInstance().stopMaskSetting()}async updatePreview(e,t){const r=zn.getInstance().inProgress?zn.getInstance():Ch.getInstance();var i;if(e)if(((i=this.state)===null||i===void 0?void 0:i.mode)==="mask"){var o;tn.isChrome?(await this.stopPreview(),await this.startPreview(this.state.canvas,{imageUrl:e,cropped:t,deviceId:(o=this.state.vb)===null||o===void 0?void 0:o.deviceId})):console.warn('use the `start` method with the virtual background image parameter instead of using `updateVirtualBackground` to preview the video." ')}else{const s=await sD(e,t);s&&(r.updateVirtualBackgroundImage(s),s!==F2&&setTimeout(()=>{r3(s)},0))}else r.updateVirtualBackgroundImage(null)}}Am.mediaOption=void 0;const{InitSuccessVideo:FB,InitSuccessAudio:jB,InitSuccessSharing:BB,InitFailedVideo:HB,InitFailedAudio:UB,InitFailedSharing:zB,SharingHealthCheckFailed:tdt,VideoHealthCheckFailed:ndt,AudioHealthCheckFailed:rdt}=bt,xc=El(zn.getInstance()),QRe=xl.getInstance(),ife=QRe.makeLogger(["Media Agent"]),idt=[U4,z4,a1].map(n=>HDe(n,{hostname:!0})),C5=[],odt={epics0:(n,e)=>n.pipe(rn(`${Hh}`),zr(()=>{const{meeting:{isMeetingReset:t}}=e.value;return n.pipe(qp(n.pipe(rn(`${Zf}`))),rn(`${av}`),Ur(1),ny(r=>{var i;const{logger:o,media:{mediaConstraints:s,assetsPath:a},meeting:{zlkJwtToken:c,cv:l}}=e.value,{payload:{disableAqos:u,disableVqos:d}}=r,h=o!=null&&(i=o.options)!==null&&i!==void 0&&i.enable?xl.getInstance().makeLogger(["MEDIA SDK"]):void 0;return function(f){const{media:{patchedMediaSDKStatus:p}}=f;return p===aP.Loading?mc(Mi(A4,1)):Promise.resolve()}(e.value).then(()=>{const f=[];let p=!d;const g=!u;return c&&qk(l,"1.3.0")<0&&(p=!1),f.push(hPe({audioQos:g,videoQos:p})),xc.init(function(m){return m&&new Proxy(m,{get:(v,b)=>typeof b=="string"&&b==="error"?function(){try{var S;lRe.report(arguments.length<=0?void 0:arguments[0],["MEDIA SDK",...(S=arguments.length<=1?void 0:arguments[1])!==null&&S!==void 0?S:[]],"error")}catch{}}:Reflect.get(v,b)})}(h)),f.push(fte(!0)),t&&s!==void 0&&a!==void 0&&f.push(dte()),f})}))})),epics1:(n,e)=>n.pipe(rn(`${Hh}`),st(t=>{const{payload:{mediaSDKPath:r}}=t,{media:{skipJsMedia:i,patchJsMedia:o,assetsPath:s},meeting:{isMeetingReset:a}}=e.value;return!i&&idt.some(c=>new RegExp(`^https://${c}`).test(s??""))&&!!o&&!!r&&!a}),zr(t=>{const{payload:{mediaSDKPath:r}}=t,i=vte(r);return Tt(new Promise((o,s)=>{const a=`${i}/${i1}`;"JsMediaSDK_Instance"in window&&(window.JsMediaSDK_Instance_backup=window.JsMediaSDK_Instance,delete window.JsMediaSDK_Instance),Jte(a,()=>{"JsMediaSDK_Instance_backup"in window&&delete window.JsMediaSDK_Instance_backup,ife.info(`patched media sdk url:${a}`),o("")},()=>{"JsMediaSDK_Instance_backup"in window&&(window.JsMediaSDK_Instance=window.JsMediaSDK_Instance_backup,delete window.JsMediaSDK_Instance_backup),ife.error(`cannot load patched media sdk :${a}`),s()})})).pipe(ht(()=>(me(A4),Tt([E4(aP.Done),dPe(i)]))),$f(()=>(me(A4),Tt([E4(aP.Done)]))),Nh(E4(aP.Loading)))})),epics2:(n,e)=>pte(n,e).pipe(en(()=>{const{media:{assetsPath:t,mediaConstraints:r,fileWithVersion:i,enforceMultipleVideos:o,enforceVirtualBackground:s,isEnableDecoderInWorklet:a},meeting:{isAudioBridgeEnabled:c}}=e.value;if(xc.notifySDKMeetingReady(),t&&r){const l={enableDecoderInWorklet:a,enableAudioBridge:c&&ra()};Object.assign(l,VDe(t,o,s)),xc.setAssetsAndConstraint(t,r,i,l)}AS(e).pipe(zr(l=>Tt(LK.acquire().then(()=>l)))).subscribe(l=>{const{meeting:{svcUrl:u,meetingNumber:d,conId:h,e2eEncrypt:f,userId:p,isWebinar:g,enableWebtransport:m,webtransportPort:v},media:{enableAudioQos:b,enableVideoQos:S,alternativeNameForVideoPlayer:E,adaptedABOptionForMediaSDK:w},video:{rendererType:C}}=e.value;l&&(xc.connect({svcUrl:u,meetingNumber:d,conId:h,e2eEncrypt:f,isViewOnly:ma(l.userRole),currentUserId:p,isWebinar:g,enableAudioQos:b,enableVideoQos:S,enableWebtransport:m,webtransportPort:v,rendererType:C,adaptedABOptionForMediaSDK:w}),function(I){var T;let D="video-player";I.tagName&&(D=I.tagName,sc.dispatch("",{tagName:I.tagName}),I1((T=I.mediaSDK)===null||T===void 0?void 0:T.call(I),`VPTN:${D}`));const O=`${D}-container`,M=I.sessionId||hne();sc.get("renderCountMap").clear(),I.mediaSDK&&(sc.get("mediaSDKInstanceMap").set(a3,I.mediaSDK),sc.get("mediaSDKInstanceMap").set(M,I.mediaSDK)),I.failover&&sc.dispatch("failover",void 0,I.sessionId||a3),customElements.get(O)||customElements.define(O,W2),customElements.get(D)||customElements.define(D,V2)}({mediaSDK:()=>xc.instance,tagName:E,failover:"1"}))})}),zr(()=>M0(t=>xc.registerCallback(t),t=>xc.unregisterCallback(t),(t,r)=>({type:t,data:r})).pipe(Vt(t=>cPe(t))))),epics3:n=>Vn(n,[FB,jB,BB,HB,UB,zB]).pipe(WDe(e=>{const{payload:{type:t,data:r}}=e;if(t===jB||t===UB){if(r===Ul.EncodeSuccess)return me(c3e),hi(fq("success"));if(r===Ul.DecodeSuccess)return me(l3e),hi(pq("success"));if(r===Ul.EncodeFailed)return me(f3e),hi(fq("failed"));if(r===Ul.DecodeFailed)return me(p3e),hi(pq("failed"))}else if(t===FB||t===HB){if(r===Ul.EncodeSuccess)return me(u3e),hi(gq("success"));if(r===Ul.DecodeSuccess)return me(d3e),hi(mq("success"));if(r===Ul.EncodeFailed)return me(g3e),hi(gq("failed"));if(r===Ul.DecodeFailed)return me(m3e),hi(mq("failed"))}else if(t===BB||t===zB){if(r===Ul.EncodeSuccess)return me(h3e),hi(vq("success"));if(r===Ul.DecodeSuccess)return me(qq),hi(x4("success"));if(r===Ul.EncodeFailed)return me(v3e),hi(vq("failed"));if(r===Ul.DecodeFailed)return me(y3e),hi(x4("failed"));if(t===BB&&r===void 0)return me(qq),hi(x4("success"))}})),epics4:(n,e)=>Vn(n,[FB,jB]).pipe(zr(()=>typeof navigator.mediaDevices=="object"?ga(z6(),ga(Vn(n,bt.StartVideoCaptureSuccess),No(navigator.mediaDevices,"devicechange"),Vn(n,bt.UserGrantCaptureAudio).pipe(st(()=>!e.value.audio.isUserGrantCaptureAudio))).pipe(ht(()=>z6().pipe(en(()=>{setTimeout(()=>{me(b3e)},50)}))))).pipe(nn(e),ht(t=>{let[r,i]=t;const o=[tTe(r.microphones),nTe(r.speakers),Hte(r.cameras)];if(i.audio){const{audio:{activeMicrophone:c,activeSpeaker:l,microphoneDevicesList:u,speakerDevicesList:d}}=i,h=mn(i),{microphones:f,speakers:p}=r,g=u.filter(v=>f.findIndex(b=>b.deviceId===v.deviceId)===-1),m=d.filter(v=>p.findIndex(b=>b.deviceId===v.deviceId)===-1);if(g.length>0){if(Rde(g[0],c,u)){const v=ZE(f);xc.changeMicrophone("default",v==null?void 0:v.label,!(h==null||!h.muted)),o.push(Jk("default"))}}else if(c==="default"){const v=ZE(u),b=ZE(f);u.length>0&&(v==null?void 0:v.label)!==(b==null?void 0:b.label)&&xc.changeMicrophone("default",b==null?void 0:b.label,!(h==null||!h.muted))}var s,a;m.length>0?Rde(m[0],l,d)&&(xc.changeSpeaker("default"),o.push(_7("default"))):l==="default"&&d.length>0&&((s=ZE(d))===null||s===void 0?void 0:s.label)!==((a=ZE(p))===null||a===void 0?void 0:a.label)&&xc.changeSpeaker("default")}return Tt(o)})):Mt)),epics5:(n,e)=>Uf(n,Co).pipe(en(t=>{const{type:r,payload:{body:i}}=t,o=r===`${Um}`;if(i.add){const s=i.add.map(a=>({userid:a.id,sn:a.zoomID&&Od(a.zoomID)}));if(!o){const{meeting:{gcmSessinKey:a}}=e.value;xc.sendUserNodeList(s,a)}xc.updateUserMediaSN({added:s,isFromMainSession:o,iVType:fa.SHARING_DECODE}),o&&xc.updateUserMediaSN({added:s,isFromMainSession:o,iVType:fa.AUDIO_DECODE})}if(i.remove&&i.remove.length>0){if(!o){const{meeting:{gcmSessinKey:s}}=e.value;xc.sendUserNodeList(i.remove.map(a=>({userid:a.id,bremove:!0})),s)}xc.updateUserMediaSN({removed:i.remove.map(s=>s.id),isFromMainSession:o,iVType:fa.SHARING_DECODE}),o&&xc.updateUserMediaSN({removed:i.remove.map(s=>s.id),isFromMainSession:o,iVType:fa.AUDIO_DECODE})}}),$n(Mt)),epics6:n=>Vn(n,bt.AesGcmIvResponse).pipe(en(e=>{const{payload:{data:{workerType:t,iv:r}}}=e,i=rr.get(Gi.WebclientIVState);if(i){const o={...i,[t]:r};rr.set(Gi.WebclientIVState,o,ri.SessionStorage)}}),$n(Mt)),epics7:n=>n.pipe(rn(`${c_}`),st(e=>[xq,lde,Ste].includes(e.payload.evt)),Vt(e=>{const{payload:{evt:t,body:{encryptKey:r,additionalType:i}}}=e;return lPe({type:t===xq?"audio":t===lde?"video":"sharing",encryptKey:r,additionalType:i})})),epics8:n=>n.pipe(rn(`${hte}`),en(e=>{const{payload:t}=e;Am.setMediaOption({assetsPath:t.assetsPath,enforceMultipleVideos:t.enforceMultipleVideos,enforceVirtualBackground:t.enforceVirtualBackground})}),$n(Mt)),epics9:n=>n.pipe(rn(`${L2}`,`${JM}`),en(()=>{Ch.getInstance().inProgress&&(Ch.getInstance().disconnect(),LK.watch(Ch.getInstance().destroy()))}),$n(Mt)),epics10:n=>n.pipe(rn(`${L2}`,`${JM}`),zr(()=>"permissions"in navigator?["microphone","camera"].map(e=>{navigator.permissions.query({name:e}).then(t=>{const r=()=>{me(w3e,{name:e,state:t.state})};r(),t.addEventListener("change",r),C5.push(()=>{t.removeEventListener("change",r)})}).catch(()=>{})}):Mt),$n(Mt)),epics11:n=>n.pipe(rn(`${bte}`),st(e=>e.payload===ws.Closed),en(()=>{C5.length>0&&(C5.forEach(e=>e()),C5.length=0)}),$n(Mt)),epics12:n=>Vn(n,[tdt,ndt,rdt,HB,UB,zB]).pipe(en(e=>{QRe.report(`Media health check failed,refresh or restart the browser may recover,reason:${e.payload.type}`,"Media exception flow"),me(C3e)}),ht(()=>Mt))},sdt=iu(odt),adt={meeting:flt,socket:Elt,participants:Dlt,media:Olt},cdt=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||ZIe;function ofe(n){return function(e){for(var t=Object.keys(e),r={},i=0;i<t.length;i++){var o=t[i];typeof e[o]=="function"&&(r[o]=e[o])}var s,a=Object.keys(r);try{(function(c){Object.keys(c).forEach(function(l){var u=c[l];if(u(void 0,{type:GM.INIT})===void 0)throw new Error(ol(12));if(u(void 0,{type:GM.PROBE_UNKNOWN_ACTION()})===void 0)throw new Error(ol(13))})})(r)}catch(c){s=c}return function(c,l){if(c===void 0&&(c={}),s)throw s;for(var u=!1,d={},h=0;h<a.length;h++){var f=a[h],p=r[f],g=c[f],m=p(g,l);if(m===void 0)throw l&&l.type,new Error(ol(14));d[f]=m,u=u||m!==g}return(u=u||a.length!==Object.keys(c).length)?d:c}}({...adt,...n})}function gt(n,e,t,r,i){var o={};return Object.keys(r).forEach(function(s){o[s]=r[s]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=t.slice().reverse().reduce(function(s,a){return a(n,e,s)||s},o),i&&o.initializer!==void 0&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),o.initializer===void 0&&(Object.defineProperty(n,e,o),o=null),o}const wo=Symbol("store"),Qt=Symbol("getState"),Qo=Symbol("dispatch"),c8=Symbol("additionFeatures"),pt=Symbol("mediaContext");function yt(n,e,t){const r=t.value;t.value=function(){const i=this[wo];if(i){const{meeting:{isOnHold:c,isMeetingReset:l,meetingStatus:u}}=i.getState();if(u!==ws.Joined)return Promise.reject({type:OC,reason:"closed"});if(l)return Promise.reject({type:OC,reason:"reconnecting"});if(c)return Promise.reject({type:OC,reason:"on hold"})}for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return r.apply(this,s)}}function Ls(n,e,t){const r=t.value;t.value=function(){const i=this[wo];if(i){const c=i.getState();if(!Td(c))return Promise.reject({type:Oc,reason:"only host or co-host can do the operation"})}for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return r.apply(this,s)}}function Na(n,e,t){const r=t.value;t.value=function(){const i=this[wo];if(i){const c=i.getState();if(!K3e(c))return Promise.reject({type:Oc,reason:"only host can do the operation"})}for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return r.apply(this,s)}}function Yt(n){return function(e,t,r){const i=r.value;r.value=function(){const o=this[wo];if(o&&o.getState()[n]===void 0)return Promise.reject({type:lt,reason:`Module:${n} is not enabled`});for(var s=arguments.length,a=new Array(s),c=0;c<s;c++)a[c]=arguments[c];return i.apply(this,a)}}}function sfe(n){return function(e,t,r){const i=r.value;r.value=function(){const o=this[wo];if(o){const{meeting:{meetingOptions:l}}=o.getState();if(l[n]===!0)return Promise.reject({type:"OPERATION_LOCKED",reason:`${n} is locked`})}for(var s=arguments.length,a=new Array(s),c=0;c<s;c++)a[c]=arguments[c];return i.apply(this,a)}}}let y0=function(n){return n.Self="Self",n.Other="Other",n.Client="Client",n.Phone="Phone",n.Attendee="Attendee",n}({});function VB(n){return function(e,t,r){const i=r.value;r.value=function(o){const s=this[wo];if(s){const d=s.getState(),h=Array.isArray(n)?n:[n];let f=Yi(d).find(p=>p.userId===o);if(h.findIndex(p=>p===y0.Attendee)>-1&&(f=rD(d).find(p=>p.userId===o)),!f)return Promise.reject({type:Jn,reason:"no matching user"});{const{meeting:{userId:p}}=s.getState();for(let g=0;g<h.length;g++){const m=h[g];if(m===y0.Other&&o===p)return Promise.reject({type:lt,reason:"operation is not applicable to self"});if(m===y0.Self&&o!==p)return Promise.reject({type:lt,reason:"operation is only applicable to self "});if(m===y0.Client&&DS(f.userType)||m===y0.Phone&&!DS(f.userType))return Promise.reject({types:lt,reason:"improper target client"})}}}for(var a=arguments.length,c=new Array(a>1?a-1:0),l=1;l<a;l++)c[l-1]=arguments[l];const u=[o,...c];return i.apply(this,u)}}}const WB=xl.getInstance();function Nu(n,e){return function(t,r,i){const o=i.value;i.value=function(){for(var s=arguments.length,a=new Array(s),c=0;c<s;c++)a[c]=arguments[c];if(WB.checkLaplace())try{var l;const u=WB.makeLogger([n]),d=(l=e?a.map((h,f)=>e.includes(f+1)?oc(h):h):a)===null||l===void 0?void 0:l.map(h=>YM(h));return u.info(`${r},params:${JSON.stringify(d)}`),o.apply(this,a).then(h=>(u.info(`${r} success`),h)).catch(h=>{let f=`${r},params:${JSON.stringify(d)},return failed,`;return typeof h=="object"&&(f=`${f},${h.type?`type:${h.type},`:""}${h.reason?`reason:${h.reason}`:""}`),WB.report(f,`${n} exception flow`,"error"),Promise.reject(h)})}catch{}return o.apply(this,a)}}}function E7(n,e,t){return function(r,i,o){const s=o.value;o.value=function(){for(var a,c,l=arguments.length,u=new Array(l),d=0;d<l;d++)u[d]=arguments[d];const h=u[e];let f=n;return Array.isArray(f)||(f=[f]),!f.some(p=>h instanceof p)||t&&!t.every(p=>!!h[p])?Promise.reject({type:Jn,reason:`Expected to accept ${(a=f)===null||a===void 0?void 0:a.map(p=>p.name).join(" or ")}, but actual it is ${typeof h=="object"&&h!==null?(c=Object.getPrototypeOf(h))===null||c===void 0?void 0:c.constructor.name:h}`}):s.apply(this,u)}}}class Og{constructor(e){this[wo]=void 0,this[Qo]=void 0,this[Qt]=void 0,this[c8]=void 0,this[wo]=e,this[Qo]=e.dispatch,this[Qt]=e.getState}}const ldt=["userId","displayName","audio","isHost","avatar","bRaiseHand","bHold","bVideoOn","sharerOn","sharerPause","feedback","bLocalRecord","strPronoun","sdkKey","audioConnectionStatus","caps","bAllowISORecord","bVideoConnect","userIdentity","isSpeakerOnly","bVideoShare","bShareAudioOn","bShareToBORooms","bid",{from:"bInFailover",to:"isInFailover"},{from:"userGUID",to:"userGuid"},{from:"bGuest",to:"isGuest"},{from:"sharerPause",to:"sharePause"},{from:"bCoHost",to:n=>({isCoHost:!!n})},{from:"muted",to:(n,e)=>({muted:e!=null&&e.isSpeakerOnly||(e==null?void 0:e.audio)===""?void 0:n})},{from:"userType",to:(n,e)=>{const t=DS(n),r={isPhoneUser:t};return t&&e!=null&&e.phoneNumber&&Object.assign(r,{phoneNumber:e.phoneNumber}),r}}];function HC(n){return ldt.reduce((e,t)=>{const r=typeof t=="string"?t:t.from,i=function(o,s,a){if(typeof o=="string")return{[`${o}`]:s};if(typeof o=="object"&&o.from!==void 0){const{to:c}=o;return typeof c=="string"?{[`${c}`]:s}:c(s,a)}}(t,n[r],n);return{...e,...i}},{})}function e5e(){const{isSupportAudioWorklet:n,isSupportEssentialAudioAndVideoAbility:e,isAndroidOrIOSBrowser:t,isSupportSendScreenSharing:r}=tn;return{audio:e&&n||t,video:e&&navigator.mediaDevices!==void 0&&navigator.mediaCapabilities!==void 0,screen:e&&r}}const bne=n=>{let{breakoutRoom:{mainSessionAttendeeList:e}}=n;return e},t5e=n=>{let{meeting:{zoomId:e}}=n;return e},n5e=n=>{let{breakoutRoom:{isHugeBO:e}}=n;return e},zf=Eo([n=>{let{breakoutRoom:{controlStatus:e}}=n;return e},n=>{let{breakoutRoom:{currentRoom:{status:e}}}=n;return e},n=>{let{breakoutRoom:{currentRoom:{boId:e}}}=n;return e}],(n,e,t)=>!(n!==Sr.InProgress&&n!==Sr.Closing||e!==Cn.InRoom&&e!==Cn.TimeUp||!t)),qB=Eo([n=>{let{breakoutRoom:{rooms:e}}=n;return e},Hy,t5e,bne,zf,n5e],(n,e,t,r,i,o)=>{const s=n.reduce((a,c)=>{const{attendeeGuidList:l}=c;return a.concat(l)},[]);return(i?r:e).filter(a=>!a.bHold&&!a.isHost&&a.zoomID!==t&&!a.bid&&!s.includes(a.userGUID)&&(!o||KDe(a.caps)))}),udt=Eo([zf,bne,Hy,t5e,n5e],(n,e,t,r,i)=>(n?e:t).filter(o=>!o.bHold&&!o.isHost&&o.zoomID!==r&&!o.bid&&(!i||KDe(o.caps)))),Ib=Eo([zf,bne,Yi],(n,e,t)=>n?e.find(r=>r.isHost):t.find(r=>r.isHost));var afe,cfe,lfe,ca;const Pb=Gr.createAgent();let ddt=(afe=VB(y0.Other),cfe=VB(y0.Other),lfe=VB(y0.Other),ca=class extends Og{constructor(n){super(n),this.modules=void 0,this.useSDK=void 0,this.useSDK=!1,this.modules=new Map}initWithSDK(n,e,t){return this.useSDK=!0,this.init(n,e,t)}init(n,e,t){const{audio:r,video:i}=e5e();if(!r||!i)return console.error("https://developers.zoom.us/docs/video-sdk/web/browser-support"),Promise.reject({type:lt,reason:"Please update to the latest Chrome, Edge, Safari, or Firefox, as your current browser doesn't support audio/video. Retry after the upgrade."});const{[Qo]:o,[wo]:s}=this;let a=a1;const c=(t==null?void 0:t.fileWithVersion)||!1;let l="en-US",u=`${a1}/${i1}`;if(t){const{dependentAssets:d,additionalFeatures:h,constraints:f,language:p,webEndpoint:g}=t;p&&(l=p),g&&function(m){i3=HDe(m,{hostname:!0})}(g),d===Yj.CDN||d===U4?(a=U4,u=`${U4}/${i1}`):d===Yj.Global||d===a1?(a=a1,u=`${a1}/${i1}`):d===Yj.CN||d===z4?(a=z4,u=`${z4}/${i1}`):d&&/^https?:\/\//.test(d)&&(a=vte(d),u=c?`${a}/1507_js_media.min.js`:`${a}/${i1}`),h&&Array.isArray(h)&&h.forEach(m=>{if(this[c8][m]&&s.getState()[m]===void 0){const{epic:v,reducer:b,Client:S}=this[c8][m];s.injectReducer(m,b),s.injectEpic(v);const E=new S(s);this.modules.set(m,E)}}),f!=null&&f.audio&&s.getState().audio===void 0&&(s.injectReducer("audio",jlt),s.injectEpic(Ult)),f!=null&&f.video&&s.getState().video===void 0&&(s.injectReducer("video",Xut),s.injectEpic(edt)),f!=null&&f.screen&&s.getState().share===void 0&&(s.injectReducer("share",tlt),s.injectEpic(ilt))}return o(OPe({apiKey:n,signature:e,language:l,useSDK:this.useSDK})),o(hte({mediaConstraints:t&&t.constraints||{},assetsPath:a,fileWithVersion:c,enforceMultipleVideos:t==null?void 0:t.enforceMultipleVideos,enforceVirtualBackground:t==null?void 0:t.enforceVirtualBackground,skipJsMedia:t==null?void 0:t.skipJsMedia,patchJsMedia:t==null?void 0:t.patchJsMedia,alternativeNameForVideoPlayer:t==null?void 0:t.alternativeNameForVideoPlayer})),(t==null?void 0:t.stayAwake)!==void 0&&o(GPe(t.stayAwake)),(t==null?void 0:t.quicklyLeaveMeeting)!==void 0&&o(YPe(t.quicklyLeaveMeeting)),new Promise((d,h)=>{t!=null&&t.skipJsMedia?d(""):Jte(u,()=>{d("")},()=>{h({type:Jn,reason:"dependent assets are not accessible"})})})}on(n,e){((t,r)=>{const i=wde[t];if(i){const o=Wb.get(t);if(o)o.push(r),Wb.set(t,o);else{const s=[r];Wb.set(t,s);const a=ga(...i.map(c=>{const{event:l,payload:u}=c;return No(zm,l).pipe(Vt(d=>u(d)),bl(QT))})).subscribe(c=>{const l=Wb.get(t);l&&l.forEach(u=>{u(c)})});Yq.push(a)}}})(n,e)}off(n,e){((t,r)=>{if(wde[t]){const i=Wb.get(t);if(Array.isArray(i)){const o=i.filter(s=>s!==r);Wb.set(t,o)}}})(n,e)}getFeatureModule(n){return this.modules.get(n)}leave(){const{[Qt]:n,[Qo]:e}=this,{socket:{zoomSocketStatus:t}}=n();return t===$i.Connected||t===$i.Connecting?e(IS()):e(Sq()),mc(js(500).pipe(Lu("")))}end(){const{[Qt]:n,[Qo]:e}=this;return n().socket.zoomSocketStatus==="connected"?(e(N2()),mc(js(500).pipe(en(()=>{Ote()}),Lu("")))):Promise.resolve("")}changeName(n,e){const t=this[wo].getState(),{meeting:{bAllowAttendeeRename:r}}=t,i=mn(t),o=ma(i.userRole),s=Td(t);if(o)return Promise.reject({type:Oc});if(e&&e!==(i==null?void 0:i.userId)){if(s){const{participants:{attendeesList:a}}=t,c=a.find(l=>l.userId===e);if(c)return Pb.rename(e,Jo(n),Jo(c.displayName)),u5({userId:e,key:"displayName"},l=>l.displayName===n);{const l=rD(t).find(u=>u.userId===e);if(l){const u=l_.getInstance();return Pb.rename(l.userId,Jo(n),Jo(l.displayName)),u.rename(l.jid,n),Un(f0,d=>{const h=d.find(f=>f.jid===l.jid);return h&&h.displayName===n})}return Promise.reject({type:Jn,reason:"no matching user"})}}return Promise.reject({type:Oc})}return n===i.displayName?Promise.resolve():s||r?(Pb.rename(i.userId,Jo(n),Jo(i.displayName)),Un(ql,a=>a.displayName===n)):Promise.reject({type:Oc,reason:"host disallow rename themselves"})}makeHost(n){return Pb.assignHost(n,!1),u5({userId:n,key:"isHost"},e=>e.isHost===!0)}makeCoHost(n){const e=this[wo].getState(),t=Yi(e).find(r=>r.userId===n);return(t==null?void 0:t.bCoHost)===!0?Promise.reject({type:Jn,reason:`user:[${n}] is already co-host `}):(Pb.assignHost(n,!0),u5({userId:n,key:"bCoHost"},r=>r.bCoHost===!0))}revokeCoHost(n){const e=this[wo].getState(),t=Yi(e).find(r=>r.userId===n);return(t==null?void 0:t.bCoHost)===!1?Promise.reject({type:Jn,reason:`user:[${n}] is not a co-host`}):(Pb.revokeCoHost(n),u5({userId:n,key:"bCoHost"},r=>r.bCoHost===!1))}reclaimHost(){const n=this[Qt](),{meeting:{isOriginHost:e}}=n,t=mn(n);return t!=null&&t.isHost?Promise.resolve(""):e?(Pb.reclaimHost(t.userId,!1),Un(ql,r=>r.isHost===!0)):Promise.reject({type:Oc,reason:"You are not the origin host"})}isHost(){const n=this[wo].getState(),e=mn(n);return!!e&&e.isHost}isCoHost(){const n=this[wo].getState(),e=mn(n);return!!e&&!!e.bCoHost}isOriginHost(){const{meeting:{isOriginHost:n}}=this[Qt]();return n}getCurrentUserInfo(){const n=this[wo].getState(),e=mn(n);if(e){const t=HC(e);if(n.meeting.isWebinar&&ma(e.userRole)){const{audio:r}=n,i=r==null?void 0:r.isAllowToTalk;Object.assign(t,{isAllowToTalk:i})}if(n.breakoutRoom&&zf(n)){const{breakoutRoom:{currentRoom:{boId:r}}}=n;Object.assign(t,{bid:r})}return t}return null}getParticipantsList(){const n=this[wo].getState(),{meeting:{meetingStatus:e}}=n,t=mn(n);if(e===ws.Joined&&t&&!t.bHold){var r,i;const o=n.breakoutRoom&&zf(n)?(r=n.breakoutRoom)===null||r===void 0||(i=r.currentRoom)===null||i===void 0?void 0:i.boId:"";return Yi(n).map(s=>{const a=HC(s);return o&&Object.assign(a,{bid:o}),a})}return[]}getAssistantsList(){const n=this[wo].getState(),{meeting:{meetingStatus:e}}=n,t=mn(n);return e===ws.Joined&&t?Yat(n).map(r=>({userId:r.userId,displayName:r.displayName,isNewAst:!0})):[]}getMeetingHost(){var n;const e=this[Qt]();let t=tK(e);return t||((n=e.breakoutRoom)===null||n===void 0?void 0:n.currentRoom.status)!==Cn.InRoom||(t=e.breakoutRoom.mainSessionAttendeeList.find(r=>r.isHost)),t!==void 0?HC(t):null}getMeetingInfo(){const{meeting:{meetingStatus:n,isOnHold:e,meetingNumber:t,passWord:r,userName:i,userEmail:o,meetingTopic:s,meetingOptions:a,encType:c,region:l,network:u,topic:d,zlkJwtToken:h,userId:f,lang:p,inviteEmail:g,meetingId:m,participantID:v,h323Password:b,recordingDisclaimer:S,recordingDisclaimerForRecorder:E,wrInfo:w,meetingInfo:C,isNewJoinFlow:I,chatModerationPolicy:T}}=this[Qt](),D=n===ws.Joined&&!e;if(h)return{topic:d,password:r,userName:i,isInMeeting:D,userId:f,meetingId:m};{let O="";return c===0?O="None":c===1?O="AES ECB":c===2&&(O="AES GCM"),{meetingNumber:t,password:r,userName:i,userEmail:o,inviteEmail:g,meetingTopic:s,encryptionType:O,region:l,network:u,isInMeeting:D,userId:f,lang:p,webEndpoint:UDe(),meetingId:m,participantId:v,telPwd:b,recordingInfo:{recordingDisclaimer:S,recordingDisclaimerForRecorder:E,isUserEnableRecordingReminder:a==null?void 0:a.isUserEnableRecordingReminder},wrInfo:Object.assign({},w,{isNew:I}),scheduleInfo:C,chatModerationPolicy:T}}}},gt(ca.prototype,"end",[Na,yt],Object.getOwnPropertyDescriptor(ca.prototype,"end"),ca.prototype),gt(ca.prototype,"changeName",[yt],Object.getOwnPropertyDescriptor(ca.prototype,"changeName"),ca.prototype),gt(ca.prototype,"makeHost",[afe,Na,yt],Object.getOwnPropertyDescriptor(ca.prototype,"makeHost"),ca.prototype),gt(ca.prototype,"makeCoHost",[cfe,Na,yt],Object.getOwnPropertyDescriptor(ca.prototype,"makeCoHost"),ca.prototype),gt(ca.prototype,"revokeCoHost",[lfe,Na,yt],Object.getOwnPropertyDescriptor(ca.prototype,"revokeCoHost"),ca.prototype),gt(ca.prototype,"reclaimHost",[yt],Object.getOwnPropertyDescriptor(ca.prototype,"reclaimHost"),ca.prototype),ca);const hdt=Gr.createAgent(),fdt=l_.getInstance(),ufe=(n,e,t)=>{const r=e==null?void 0:e.userId;if(n==null||!n.zoomID||e==null||!e.displayName||r===n.userId)return{type:Jn,reason:"invalid target user"};const{chat:{chatPrivilege:i,panelistChatPrivilege:o},meeting:{isWebinar:s}}=t,a=Td(t),c=e.isHost||e.bCoHost;let l=!1;if(!a){if(s)if(ma(n.userRole))(i===$o.NoAttendee||i===$o.AllPanelist&&r!==Zi.Panelist||i===$o.All&&r!==Zi.All&&r!==Zi.Panelist)&&(l=!0);else{const u=ma(e==null?void 0:e.userRole);(o===PS.Invalid||o===PS.AllPanelist&&(u||r===Zi.All))&&(l=!0)}else(i===$o.NoAttendee||i===$o.Host&&!c||r===Zi.SilentModeUsers||i===$o.EveryonePublicly&&r!==Zi.All&&!c)&&(l=!0);if(l)return{type:Oc,reason:"Insufficient chat privilege"}}return null};function dfe(n,e){if(e===Zi.All)return sP;if(e===Zi.Panelist)return qw;if(e===Zi.SilentModeUsers)return Sat;{const{meeting:{isWebinar:t},participants:{xmppAttendeeList:r,attendeesList:i}}=n;return t?i.find(o=>o.userId===e)||r.find(o=>o.userId===e):i.find(o=>o.userId===e)}}function eI(n,e,t){if(t!=null&&t.host)return[tK(n),...Pde(n)].filter(r=>(r==null?void 0:r.userId)!==e).map(r=>({userId:r==null?void 0:r.userId,displayName:r==null?void 0:r.displayName,isHost:r==null?void 0:r.isHost,isCoHost:r==null?void 0:r.bCoHost}));{let r=[tK(n),...Pde(n),...n.participants.attendeesList.filter(i=>!(i.bCoHost||i.isHost||i.bHold))];if(t!=null&&t.includeAttendee){const i=rD(n).filter(o=>!DS(o.userType));r=[...r,...i]}return r.filter(i=>i!==void 0&&i.userId!==e).map(i=>({userId:i==null?void 0:i.userId,displayName:i==null?void 0:i.displayName,isHost:i==null?void 0:i.isHost,isCoHost:i==null?void 0:i.bCoHost}))}}function x5(n){const{text:e,destId:t,sn:r,attendeeId:i}=n;return zc.beginEncrypt({text:e,type:fc.RWG_CHAT}).then(o=>{hdt.chat(o,t,r,i)})}function Yw(n,e){const{chat:{chatHistory:t}}=e;return t.find(r=>{var i,o;return((i=r.file)===null||i===void 0||(o=i.upload)===null||o===void 0?void 0:o.uniqueId)===n})}function r5e(n,e){const{meeting:{isWebinar:t},participants:{attendeesList:r}}=e,{destNodeID:i,senderName:o,attendeeNodeID:s}=n,a=r.find(h=>h.userId===i),c=n.sn?n.sn:a==null?void 0:a.zoomID,l=o?Xf(o):a==null?void 0:a.displayName;let u,d="";if(s===Zi.SilentModeUsers)return{sender:{name:"Host",userId:i},receiver:{name:"Everyone (in Waiting Room)",userId:s},timestamp:new Date().getTime()};if(s===Zi.All)d=t?"All panelists and attendees":"Everyone";else if(s===Zi.Panelist)d="All panelists";else{if(t){const h=rD(e).find(f=>f.userId===s);h&&(d=h.displayName)}if(!d){const h=r.find(f=>f.userId===s);h&&(d=h.displayName,u=h.userGUID)}}return{sn:c,sender:{name:l,userId:i,userGuid:a==null?void 0:a.userGUID,avatar:a==null?void 0:a.avatar},receiver:{name:d,userId:s,userGuid:u},timestamp:new Date().getTime()}}function pdt(n){var e;const[t]=n.split(".").reverse();return(e=wat[t])!==null&&e!==void 0?e:""}function i5e(n,e){const t=[];for(let r=n.length-1;r>=0;r--){const i=n[r];if(!i.file&&(!i.id&&i.sender.userId===e.userId&&[Zi.All,Zi.Panelist,Zi.IndividualCcPanelist,e.destNodeID].includes(i.receiver.userId)&&t.unshift(i),i.id))break}return t.length>0?t[0]:null}const o5e=xl.getInstance(),s5e=o5e.makeLogger(["File Transfer"]);function a5e(n,e,t){const{name:r,size:i}=n,{meeting:{reportDomain:o,svcUrl:s,conId:a}}=t;return`https://${o}${e}?${new URLSearchParams({filename:r,filesize:i,rwg:s,cid:a}).toString()}`}function c5e(n,e){return e.fileObj?`${n}/zoomfile/download?objkey=${e.fileObj}`:`${n}/file/${e.fileID}`}function K2(n,e){return{fileName:n.name,fileSize:n.size,receiverId:e==null?void 0:e.userId,receiverGuid:e==null?void 0:e.userGuid}}function d0(n,e,t){o5e.report(`${n}. file name:${oc(e.name)},file size:${e.size}, ${"type"in e?`file type:${e.type}`:""}, error:${t.name};${t.message}`,["File Transfer"])}function KB(n){var e,t,r;return{id:n.id,fileName:(e=n.file)===null||e===void 0?void 0:e.name,fileSize:(t=n.file)===null||t===void 0?void 0:t.size,fileUrl:(r=n.file)===null||r===void 0?void 0:r.fileUrl,senderId:n.sender.userId,senderGuid:n.sender.userGuid}}function l5e(n,e,t){return new Promise((r,i)=>{const o=new FileReader;o.readAsArrayBuffer(n.slice(e,t)),o.onload=s=>{var a;return r((a=s.target)===null||a===void 0?void 0:a.result)},o.onerror=s=>i(s)})}async function u5e(n,e){let[t,r]=[n.size,0];e!=null&&(t=Math.min(Xa.ChunkSize,n.size-e),r=e);const i=n.size-r<=Xa.ChunkSize,o=Math.ceil(t/Xa.EncodeBlockSize);try{return function(s){const a=s.reduce((u,d)=>u+d.byteLength,0),c=new Uint8Array(a);let l=0;for(const u of s)c.set(new Uint8Array(u),l),l+=u.byteLength;return c}(await Promise.all(Array.from({length:i?Math.max(o-1,1):o},(s,a)=>({start:a*Xa.EncodeBlockSize+r,end:(i&&a===o-2?a+2:a+1)*Xa.EncodeBlockSize+r})).map(async s=>{let{start:a,end:c}=s;try{const l=await l5e(n,a,c);return l?await zc.beginEncrypt({text:new Uint8Array(l),type:fc.CHAT_FILE}):Promise.reject(null)}catch(l){return d0(`encrypt file buffer error. offset:${e},`,n,l),Promise.reject(l)}})))}catch(s){console.warn(s)}return null}function X4(n,e,t,r){return r.pipe(rn(`${n3}`,`${Zf}`),st(i=>{if(i.type===`${Zf}`)return!0;const{payload:{uniqueId:o,fileName:s,userId:a}}=i;return e===o&&n.name===s&&t.userId===a}),en(i=>{s5e.info(`Cancel file upload. file name:${oc(n.name)},file size:${n.size},receiver id:${t.userId}`),me(kS,{...K2(n,t),progress:0,status:Qs.Cancel,retryToken:i.type===`${n3}`?e:void 0})}))}function Y4(n,e){if(n!=null&&n.file){const{file:t,receiver:r}=n,{upload:{chunkIndex:i,totalChunks:o,uniqueId:s}}=t;return me(kS,{...K2(e,r),progress:Math.floor((i??0)/(o??1)*100),status:Qs.Fail,retryToken:s}),Tt([Da({upload:{status:Qs.Fail,progress:0,uniqueId:s}}),Wte({uniqueId:s,file:e})])}return Mt}function J4(n,e){return me(kS,{...K2(n),progress:0,status:Qs.Fail}),hi(Da({upload:{status:Qs.Fail,progress:0,uniqueId:e}}))}async function hfe(n,e,t,r){const i=a5e(n,"/wc/fileupload",r.value),o=new FormData;try{const s=await u5e(n),a=Yw(e,r.value);if(s&&a){o.append("file",new File([s],n.name));const{meeting:{zmk:c}}=r.value,{receiver:l}=a;return wh({url:i,method:"POST",headers:{"Zoom-File-Origin":"redirect=support_auth",zmk:c},crossDomain:Lf(i),body:o,includeUploadProgress:!0}).pipe(qp(X4(n,e,l,t)),ht(u=>{const{type:d,loaded:h,responseHeaders:f,total:p}=u;let g=0,m=Qs.InProgress;const v={upload:{uniqueId:e}},b=[];if(d==="upload_loadstart")g=0;else if(d==="upload_progress")g=Math.floor(h/p*100*.9);else if(d==="upload_load")g=90;else if(d==="download_load"){var S,E;g=100,m=Qs.Success;const{chat:{fileServerDomain:w}}=r.value,C=(S=f["zoom-file-id"])===null||S===void 0?void 0:S.trim(),I=(E=f["zoom-file-obj"])===null||E===void 0?void 0:E.trim(),T=c5e(w,{fileObj:I});Object.assign(v,{fileID:C,fileObj:I,fileUrl:T})}return Object.assign(v.upload,{progress:g,status:m}),(g>0||d==="upload_loadstart")&&(me(kS,{...K2(n,l),progress:g,status:m}),b.push(Da(v))),Tt(b)}),$f(u=>(console.warn(u),d0("Upload small file error.",n,u),Y4(a,n))))}}catch(s){console.warn(s)}return J4(n,e)}const gdt=(()=>{const n=new BDe;return e=>async function(){await n.acquire(),e(...arguments),setTimeout(()=>{n.release()},3e3)}})(),mdt=function(n){const e=["chatFileTransfer"];return new Proxy(n,{get:(t,r)=>typeof r=="string"&&e.includes(r)?function(){return gdt(t[r].bind(t))(...arguments)}:Reflect.get(t,r)})}(Gr.createAgent()),ffe={chatHistory:[],chatPrivilege:$o.All,panelistChatPrivilege:PS.AllPanelist,isAllowAttendeeChat:!0,isFileTransferEnable:!0,isEnableFileTransferEncrypted:!0,fileTransferFileType:[],fileDownloadPromptIgnoreList:[],fileTransferSizeLimit:0,fileServerDomain:"",failedFileTransfer:{}},vdt=ru({[`${t3}`]:Pe((n,e)=>{let{payload:t}=e;n.chatHistory.push(t)}),[`${zte}`]:Pe((n,e)=>{let{payload:t}=e;n.chatPrivilege=t}),[`${YTe}`]:Pe((n,e)=>{let{payload:t}=e;n.panelistChatPrivilege=t}),[`${QTe}`]:Pe((n,e)=>{let{payload:t}=e;n.isAllowAttendeeChat=t}),[`${eDe}`]:Pe((n,e)=>{let{payload:t}=e;const{destNodeID:r,msgID:i,userId:o}=t,s=i5e(n.chatHistory,{userId:o,destNodeID:r});s&&Object.assign(s,{id:i})}),[`${H4}`]:Pe((n,e)=>{let{payload:t}=e;const{msgId:r}=t,i=n.chatHistory.findIndex(o=>o.id===r);i>=0&&n.chatHistory.splice(i,1)}),[`${tDe}`]:Pe((n,e)=>{let{payload:t}=e;Object.assign(n,t)}),[`${Vte}`]:Pe((n,e)=>{let{payload:t}=e;const{originFile:r,...i}=t;n.chatHistory.push(i)}),[`${Da}`]:Pe((n,e)=>{let{payload:t}=e;const{upload:r,download:i,originFile:o,...s}=t;if(r){var a;const{uniqueId:c,...l}=r,u=n.chatHistory.find(d=>{var h;return d.file&&((h=d.file.upload)===null||h===void 0?void 0:h.uniqueId)===c});u!=null&&(a=u.file)!==null&&a!==void 0&&a.upload&&(Object.assign(u.file.upload,{...l}),Object.assign(u.file,{...s}),u.file.upload.status===Qs.Success&&n.failedFileTransfer[u.file.upload.uniqueId]&&delete n.failedFileTransfer[u.file.upload.uniqueId])}else if(i){const{id:c,fileUrl:l}=s,u=n.chatHistory.find(d=>{var h;return d.id===c&&((h=d.file)===null||h===void 0?void 0:h.fileUrl)===l});u!=null&&u.file&&(u.file.download?Object.assign(u.file.download,{...i}):Object.assign(u.file,{download:i}))}}),[`${n3}`]:Pe((n,e)=>{let{payload:t}=e;const{uniqueId:r,fileName:i,userId:o}=t,s=n.chatHistory.find(c=>c.file&&c.file.name==i&&c.file.upload.uniqueId===r&&c.file.upload.status===Qs.InProgress&&c.receiver.userId===o);var a;s!=null&&s.file&&Object.assign((a=s.file)===null||a===void 0?void 0:a.upload,{status:Qs.Cancel,progress:0})}),[`${Wte}`]:Pe((n,e)=>{let{payload:t}=e;const{uniqueId:r,file:i}=t;n.failedFileTransfer[`${r}`]||Object.assign(n.failedFileTransfer,{[`${r}`]:i})}),[`${nDe}`]:Pe((n,e)=>{let{payload:t}=e;const{fileID:r,msgID:i,senderId:o}=t,s=n.chatHistory.find(a=>{var c;return((c=a.file)===null||c===void 0?void 0:c.fileID)===r&&a.sender.userId===o});s&&Object.assign(s,{id:i})}),[`${qte}`]:Pe((n,e)=>{let{payload:t}=e;const{id:r,fileUrl:i}=t,o=n.chatHistory.find(a=>{var c,l;return a.id===r&&((c=a.file)===null||c===void 0?void 0:c.fileUrl)===i&&((l=a.file)===null||l===void 0?void 0:l.download.status)===Sm.InProgress});var s;o!=null&&o.file&&Object.assign((s=o.file)===null||s===void 0?void 0:s.download,{status:Sm.Cancel,progress:0})}),[`${JTe}`]:()=>({...ffe})},ffe);var ys;const tI=Gr.createAgent();let ydt=(ys=class extends Og{send(n,e){if(!n)return Promise.reject({type:Jn,reason:"Text is empty"});const{[Qt]:t,[Qo]:r}=this,i=t(),o=mn(i),s=dfe(i,e),a=ufe(o,s,i);if(a)return Promise.reject(a);const{meeting:{isWebinar:c,encType:l}}=i,u=l===tD.AES_GCM;let d=Promise.resolve(),h=!1;const f=c&&ma(s.userRole);return e===Zi.SilentModeUsers?tI.chat(Jo(n),e):c?f?(8&s.clientCap)==8?d=x5({text:n,destId:Zi.IndividualCcPanelist,sn:o==null?void 0:o.zoomID,attendeeId:e}):(d=x5({text:n,destId:Zi.Panelist,sn:o==null?void 0:o.zoomID,attendeeId:e}).then(()=>function(p){const{text:g,jid:m,isGCMEnabled:v}=p;return zc.beginEncrypt({text:g,type:fc.XMPP_CHAT}).then(b=>{fdt.sendWebinarMseeage(b,m,Zi.IndividualCcPanelist,v)})}({text:n,jid:s.jid,isGCMEnabled:u})),h=!0):s&&(d=x5({text:n,destId:s.userId,sn:o==null?void 0:o.zoomID})):d=x5({text:n,destId:s.userId,sn:o==null?void 0:o.zoomID}),d.then(()=>{const p=function(g,m,v,b){const S=new Date().getTime(),E=performance.now();return{message:g,sender:{name:m.displayName,userId:m.userId,userGuid:m.userGUID,avatar:m.avatar},receiver:{name:v==null?void 0:v.displayName,userId:b?Zi.IndividualCcPanelist:v==null?void 0:v.userId,userGuid:v==null?void 0:v.userGUID},timestamp:S,highResTimeStampForIdentification:E}}(n,o,s,f);return r(t3(p)),h?(me(iS,p),p):new Promise((g,m)=>{Mi(dke).pipe(VIe(5e3),KIe(v=>p.highResTimeStampForIdentification!==v.identification||!([v.receiverId,Zi.All,Zi.Panelist].includes(e)||v.receiverId===Zi.IndividualCcPanelist)),Ur(1)).subscribe(v=>{const{msgId:b}=v,{highResTimeStampForIdentification:S,...E}=p,w={id:b,...E,...f&&{receiver:{name:s==null?void 0:s.displayName,userId:s==null?void 0:s.userId}}};me(iS,w),g(w)},()=>{m({type:Rte})})})})}setPrivilege(n){const e=this[Qt](),{meeting:{isWebinar:t},chat:{chatPrivilege:r},breakoutRoom:i}=e;return r===n?Promise.resolve(""):(i==null?void 0:i.controlStatus)===Sr.InProgress&&zf(e)?Promise.reject({type:lt,reason:"Cannot update chat privilege in a subsession"}):!t&&!vat.includes(n)||t&&!yat.includes(n)?Promise.reject({type:Jn,reason:"invalid privilege value of parameter"}):(tI.setChatPriviledge(n),Un(AC,o=>o.chatPrivilege===n))}setPanelistPrivilege(n){const e=this[Qt](),{chat:{panelistChatPrivilege:t}}=e,r=bat[n];return t===r?Promise.resolve(""):Object.values(n6).includes(n)?(tI.setPanelistChatPrivilege(n),Un(AC,i=>i.panelistChatPrivilege===r)):Promise.reject({type:Jn,reason:"Panelist privilege value is invalid"})}deleteMessage(n){const e=this[Qt](),{chat:{chatHistory:t},meeting:{meetingOptions:r,userId:i}}=e;if(r!=null&&r.isEnableDeleteChatMsg){const o=Td(e),s=t.find(a=>a.id===n);if(s){const{sender:a}=s;if(o)tI.chatCmdReq(n,t6.Delete);else{if(a.userId!==i)return Promise.reject({type:Oc,reason:"can not delete message"});tI.chatCmdReq(n,t6.Delete)}return Un(i6,c=>c.id===n).then(()=>({id:n}))}return Promise.reject({type:Jn,reason:"msgId is wrong"})}return Promise.reject({type:lt,reason:"can not delete messages"})}lockChat(n){const e=this[Qt](),{meeting:{meetingOptions:t}}=e,r=t!=null&&t.isPrivateChatEnabled?$o.All:$o.EveryonePublicly;return this.setPrivilege(n?$o.NoOne:r)}sendFile(n,e){if(!n)return Promise.reject({type:Jn,reason:"File is empty"});const{[Qt]:t,[Qo]:r}=this,i=t(),{chat:{isFileTransferEnable:o,fileTransferFileType:s,fileTransferSizeLimit:a,failedFileTransfer:c}}=i;if(!o)return Promise.reject({type:lt,reason:"Send files via in-session chat is not enabled"});if(typeof n=="string"){const l=Yw(n,i);if(l!=null&&l.file&&c[n]){const{file:{upload:u,...d}}=l,{file:{name:h,upload:{uniqueId:f}},receiver:{userId:p}}=l;return r(Da({originFile:c[n],...d,upload:{...u,status:Qs.InProgress}})),Promise.resolve(()=>{r(n3({uniqueId:f,fileName:h,userId:p}))})}return Promise.reject({type:Jn,reason:"Retry token is not correct."})}{const{name:l}=n;if(s.length>0){const[p]=l.split(".").reverse();if(!s.some(g=>g===p))return Promise.reject({type:lt,reason:"File is not in the allow list"})}if(n.size>a)return Promise.reject({type:lt,reason:"File size exceeds the maximum limit."});const u=mn(i),d=dfe(i,e),h=ufe(u,d,i);if(h)return Promise.reject(h);const f=XM();return r(Vte(function(p,g,m,v,b){const S=new Date().getTime();return{file:{name:p.name,size:p.size,type:p.type,upload:{progress:0,uniqueId:g,totalChunks:0,chunkIndex:0}},originFile:p,sender:{name:m.displayName,userId:m.userId,userGuid:m.userGUID,avatar:m.avatar},receiver:{name:v==null?void 0:v.displayName,userId:v==null?void 0:v.userId,attendeeId:void 0,userGuid:v==null?void 0:v.userGUID},timestamp:S}}(n,f,u,d))),Promise.resolve(()=>{r(Wte({uniqueId:f,file:n})),r(n3({uniqueId:f,fileName:l,userId:d==null?void 0:d.userId}))})}}downloadFile(n,e,t){const{[Qt]:r,[Qo]:i}=this,{chat:{chatHistory:o}}=r();return!n||!e?Promise.reject({type:Jn,reason:"Invalid message id or file url!"}):o.find(a=>{var c;return a.id===n&&((c=a.file)===null||c===void 0?void 0:c.fileUrl)===e})?(i(Da({id:n,fileUrl:e,download:{status:Sm.InProgress,progress:0,blob:t}})),Promise.resolve(()=>i(qte({id:n,fileUrl:e})))):Promise.reject({type:Jn,reason:"Invalid message id or file url!"})}getPrivilege(){const{chat:{chatPrivilege:n,isAllowAttendeeChat:e}}=this[Qt]();return e?n:$o.NoAttendee}getReceivers(){const n=this[Qt](),{chat:{chatPrivilege:e,panelistChatPrivilege:t,isAllowAttendeeChat:r},meeting:{isWebinar:i}}=n;if(!i&&!r)return[];const o=mn(n),s=Td(n);if(o)if(i)if(ma(o.userRole)){if(!r)return[];if(e===$o.All)return[qw,sP];if(e===$o.AllPanelist)return[qw];if(e===$o.NoOne)return[]}else{if(s||t===PS.Everyone){const a=eI(n,o.userId,{includeAttendee:!0});return[qw,sP,...a]}if(t===PS.AllPanelist){const a=eI(n,o.userId);return[qw,...a]}}else{const a=Td(n);if(e===$o.All||a){const c=eI(n,o.userId);return[sP,...c]}if(e===$o.Host)return eI(n,o.userId,{host:!0});if(e===$o.EveryonePublicly){const c=eI(n,o.userId,{host:!0});return[sP,...c]}if(e===$o.NoOne)return[]}return[]}getHistory(){return this[Qt]().chat.chatHistory.map(n=>{const{highResTimeStampForIdentification:e,...t}=n;if(t.file){const{name:r,size:i,type:o,fileUrl:s,upload:a,download:c}=t.file,l={name:r,size:i,type:o,fileUrl:s};return a&&Object.assign(l,{upload:{status:a.status,progress:a.progress}}),c&&Object.assign(l,{download:{status:c.status,progress:c.progress}}),{...t,file:l}}return t})}isAllowToDeleteMessages(){const n=this[Qt](),{meeting:{meetingOptions:e}}=n;return e==null?void 0:e.isEnableDeleteChatMsg}isFileTransferEnabled(){return this[Qt]().chat.isFileTransferEnable}getFileTransferSetting(){const n=this[Qt](),{chat:{fileTransferFileType:e,fileTransferSizeLimit:t}}=n;return{typeLimit:(e??[]).map(r=>`.${r}`).join(","),sizeLimit:t}}},gt(ys.prototype,"send",[yt],Object.getOwnPropertyDescriptor(ys.prototype,"send"),ys.prototype),gt(ys.prototype,"setPrivilege",[Ls,yt],Object.getOwnPropertyDescriptor(ys.prototype,"setPrivilege"),ys.prototype),gt(ys.prototype,"setPanelistPrivilege",[Ls,yt,function(n,e,t){const r=t.value;t.value=function(){const i=this[wo];if(i){const{meeting:{isWebinar:c}}=i.getState();if(!c)return Promise.reject({type:OC,reason:"non-webinar"})}for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return r.apply(this,s)}}],Object.getOwnPropertyDescriptor(ys.prototype,"setPanelistPrivilege"),ys.prototype),gt(ys.prototype,"deleteMessage",[yt],Object.getOwnPropertyDescriptor(ys.prototype,"deleteMessage"),ys.prototype),gt(ys.prototype,"lockChat",[Ls,yt],Object.getOwnPropertyDescriptor(ys.prototype,"lockChat"),ys.prototype),gt(ys.prototype,"sendFile",[yt],Object.getOwnPropertyDescriptor(ys.prototype,"sendFile"),ys.prototype),gt(ys.prototype,"downloadFile",[yt],Object.getOwnPropertyDescriptor(ys.prototype,"downloadFile"),ys.prototype),ys);const bdt={epics0:(n,e)=>TC(n,24583).pipe(nn(e),ht(t=>{let[r,i]=t;if(i.meeting.zlkJwtToken)return Mt;const{payload:{body:{sn:o,senderName:s,senderJid:a,receiver:c,text:l,type:u}}}=r,d=mn(i),h=rD(i),{meeting:{jid:f,userId:p},participants:{xmppAttendeeList:g}}=i;return zc.beginDecrypt({decryptedText:l,type:fc.XMPP_CHAT,zoomId:o}).then(m=>{var v;let{message:b}=m,S=null,E=0,w="";d&&ma(d.userRole)&&f===c?(S=g.find(I=>I.jid===a),E=p,w=d.displayName):u===Zi.Panelist&&(S=h.find(I=>I.jid===a),E=Zi.Panelist,w=qw.displayName);const C={message:b,sender:{name:s,userId:((v=S)===null||v===void 0?void 0:v.userId)||0,avatar:""},receiver:{name:w,userId:E},timestamp:new Date().getTime()};return me(iS,C),t3(C)})})),epics1:(n,e)=>zt(n,7944).pipe(nn(e),ht(t=>{let[r,i]=t;const{meeting:{bIbDisableChat:o}}=i,{payload:{body:{attendeeNodeID:s,sn:a,destNodeID:c,text:l,senderName:u,msgID:d}}}=r,h=mn(i);if(h){const f=ma(h==null?void 0:h.userRole)&&s===h.userId&&!d;if(!o&&!f){const{sn:p,...g}=r5e({destNodeID:c,attendeeNodeID:s,senderName:u,sn:a},i);return(s===Zi.SilentModeUsers?Promise.resolve({id:d,message:Xf(l),...g}):zc.beginDecrypt({decryptedText:l,zoomId:p,type:fc.RWG_CHAT}).then(m=>{let{message:v}=m;return{id:d,message:v,...g}})).then(m=>(me(iS,m),t3(m)))}}return Mt})),epics2:(n,e)=>zt(n,Md).pipe(st(t=>{var r,i;return((r=t.payload.body)===null||r===void 0?void 0:r.chatPriviledge)!==void 0||((i=t.payload.body)===null||i===void 0?void 0:i.bAllowAttendeeChat)!==void 0}),nn(e),Vt(t=>{let[r,i]=t;const{payload:{body:{chatPriviledge:o,bAllowAttendeeChat:s}}}=r,{chat:{chatPrivilege:a}}=i;return s!==void 0?(me(AC,s===!0?{chatPrivilege:a}:{chatPrivilege:$o.NoAttendee}),QTe(s)):(me(AC,{chatPrivilege:o}),zte(o))})),epics3:n=>zt(n,Md).pipe(st(e=>{var t;return((t=e.payload.body)===null||t===void 0?void 0:t.panelistChatPriviledge)!==void 0}),Vt(e=>{const{payload:{body:{panelistChatPriviledge:t}}}=e;return me(AC,{panelistChatPrivilege:t}),YTe(t)})),epics4:(n,e)=>zt(n,4136).pipe(nn(e),ht(t=>{let[r,i]=t;const{payload:{body:{result:o,destNodeID:s,msgID:a,fileID:c}}}=r,{meeting:{userId:l},chat:{chatHistory:u}}=i,d=[];if(o===Qj.Success)if(c){const f=u.find(p=>{var g;return((g=p.file)===null||g===void 0?void 0:g.fileID)===c});if(f){const{file:p,receiver:g,...m}=f,{name:v,size:b,type:S,fileUrl:E}=p??{},{attendeeId:w,...C}=g;me(iS,{id:a,file:{name:v,size:b,type:S,fileUrl:E,upload:{status:Qs.Complete,progress:100}},receiver:{...C},...m}),d.push(nDe({fileID:c,msgID:a,senderId:l}))}}else{const f=i5e(u,{userId:l,destNodeID:s});var h;f&&(me(dke,{msgId:a,receiverId:s,identification:(h=f.highResTimeStampForIdentification)!==null&&h!==void 0?h:0}),d.push(eDe({destNodeID:s,msgID:a,userId:l})))}else o!==Qj.Delete&&o!==Qj.Block||d.push(H4({msgId:a}));return Tt(d)})),epics5:n=>zt(n,4238).pipe(ht(e=>{const{payload:{body:{bSuccess:t,cmd:r,msgID:i}}}=e,o=[];return t&&r===t6.Delete&&(o.push(H4({msgId:i})),me(i6,{id:i})),Tt(o)})),epics6:n=>zt(n,7960).pipe(ht(e=>{const{payload:{body:{cmd:t,msgID:r}}}=e,i=[];return t===t6.Delete&&(i.push(H4({msgId:r})),me(i6,{id:r})),Tt(i)}))},Sdt=iu(bdt,{chatFileEpics0:n=>n.pipe(rn(`${Hh}`),Vt(e=>{var t,r,i;const{payload:{fileTransfer:o,fileServerDomain:s}}=e;return tDe({isFileTransferEnable:o==null?void 0:o.isEnable,isEnableFileTransferEncrypted:o==null?void 0:o.isEnableFileTransferEncrypted,fileTransferFileType:((t=o==null?void 0:o.fileType)!==null&&t!==void 0?t:"").replace(/\./g,"").split(",").filter(Boolean),fileTransferSizeLimit:1024*((r=o==null?void 0:o.sizeLimit)!==null&&r!==void 0?r:0)*1024||Xa.MaxSize,fileDownloadPromptIgnoreList:((i=o==null?void 0:o.fileDownloadPromptIgnoreList)!==null&&i!==void 0?i:"").replace(/\./g,"").split(","),fileServerDomain:`https://${s}`})})),chatFileEpics1:(n,e)=>n.pipe(rn(`${Vte}`),ht(async t=>{const{payload:{originFile:r,file:{upload:{uniqueId:i}}}}=t;return r.size>Xa.ChunkSize?await async function(o,s,a,c){const l=a5e(o,"/wc/multiupload/init",c.value),u=await async function(p){const g=Math.ceil(p.size/Xa.ReaderChunkSize);return(await Promise.all(Array.from({length:g},(m,v)=>({start:v*Xa.ReaderChunkSize,end:(v+1)*Xa.ReaderChunkSize})).map(async m=>{let{start:v,end:b}=m;try{const S=await l5e(p,v,b);return RPe(await window.crypto.subtle.digest("SHA-256",S))}catch(S){return d0("calculate file hash error.",p,S),Promise.reject(S)}}))).join("")}(o),{meeting:{zmk:d,meetingId:h}}=c.value,f=Yw(s,c.value);if(u&&f){const{receiver:p}=f,g={fileName:o.name,length:o.size,channelType:4,digest:u,shareJid:h};return wh({url:l,method:"POST",headers:{"Zoom-File-Origin":"redirect=support_auth",zmk:d},crossDomain:Lf(l),body:g}).pipe(qp(X4(o,s,p,a)),Vt(m=>{var v;const{responseHeaders:b,response:S}=m,E=(v=b["x-zm-trackingid"])===null||v===void 0?void 0:v.trim(),{uploadid:w,path:C,metadata:I}=S,T=Math.ceil(o.size/Xa.ChunkSize);return Da({originFile:o,upload:{uniqueId:s,status:Qs.InProgress,progress:0,chunkIndex:0,totalChunks:T,uploadid:w,trackingId:E,path:C,metadata:I}})}),$f(m=>(console.warn(m),d0("Upload file meta error.",o,m),Y4(f,o))),Nh(Da({upload:{uniqueId:s,status:Qs.Init}})))}return J4(o,s)}(r,i,n,e):await hfe(r,i,n,e)}),ht(t=>t)),chatFileEpics2:(n,e)=>n.pipe(rn(`${Da}`),st(t=>{var r;return((r=t.payload.upload)===null||r===void 0?void 0:r.status)===Qs.Success}),ny(async t=>{const{payload:{upload:{uniqueId:r}}}=t,{chat:{isEnableFileTransferEncrypted:i,chatHistory:o}}=e.value,s=o.find(c=>{var l,u;return((l=c.file)===null||l===void 0||(u=l.upload)===null||u===void 0?void 0:u.uniqueId)===r}),a=[];if(s&&s.file){const{file:{name:c,size:l,fileObj:u,fileID:d,type:h},receiver:{userId:f,attendeeId:p}}=s;let[g,m]=["",""];if(i){const[v,b]=await Promise.all([c,`${l}`].map(S=>zc.beginEncrypt({text:S,type:fc.RWG_CHAT})));[g,m]=[v,b]}else[g,m]=[c,`${l}`].map(v=>Jo(v));await mdt.chatFileTransfer({fileID:d,fileSize:m,fileName:g,fileObj:u,type:h,destNodeID:f,attendeeNodeID:p}),a.push(Da({upload:{uniqueId:r,status:Qs.Complete}}))}return a})),chatFileEpics3:(n,e)=>n.pipe(rn(`${Da}`),st(t=>{const{payload:{upload:r,originFile:i}}=t;return!!r&&!!r.uniqueId&&r.status===Qs.InProgress&&(i==null?void 0:i.size)<=Xa.ChunkSize&&r.totalChunks===0}),ht(async t=>{const{payload:{originFile:r,upload:{uniqueId:i}}}=t;return await hfe(r,i,n,e)}),ht(t=>t)),chatFileEpics4:(n,e)=>n.pipe(rn(`${Da}`),st(t=>{const{payload:{upload:r}}=t;return!!r&&!!r.uniqueId&&r.totalChunks>0&&r.chunkIndex!==r.totalChunks}),ht(async t=>{const{payload:{originFile:r,upload:{uniqueId:i}}}=t;return await async function(o,s,a,c){const l=Yw(s,c.value);if(l!=null&&l.file){const{file:{upload:{chunkIndex:u,totalChunks:d,uploadid:h,path:f,trackingId:p,etags:g},size:m},receiver:v}=l,b=u*Xa.ChunkSize,S=await u5e(o,b);if(S){const{chat:{fileServerDomain:E},meeting:{zmk:w}}=c.value,C=`${E}/upload/parts?${new URLSearchParams({uploadid:h,partNumber:u+1}).toString()}`,I=new FormData,T=new File([S],o.name);return I.append("file",T),wh({url:C,method:"POST",headers:{"Zoom-File-Size":T.size,"Zoom-File-Path":f,"x-zm-trackingid":p,"Zoom-File-Origin":"redirect=support_auth",zmk:w},crossDomain:Lf(C),body:I,includeUploadProgress:!0}).pipe(qp(X4(o,s,v,a)),ht(D=>{var O;const{type:M,loaded:R,total:A,responseHeaders:k}=D;let L=0;const j={upload:{uniqueId:s,status:Qs.InProgress}},N=[],B=Yw(s,c.value),U=B==null||(O=B.file)===null||O===void 0?void 0:O.upload.progress;if(M==="upload_loadstart")L=U||Math.floor(u/d*100);else if(M==="upload_progress")L=Math.floor((u*Xa.ChunkSize+.9*R)/m*100);else if(M==="upload_load")L=Math.floor((u*Xa.ChunkSize+.9*A)/m*100);else if(M==="download_load"){L=U||Math.floor((u+1)/d*100);const K=k["x-zm-etag"].trim(),z=g?{...g,[`${u+1}`]:K}:{[`${u+1}`]:K};Object.assign(j.upload,{etags:z,chunkIndex:u+1,totalChunks:d}),Object.assign(j,{originFile:o})}return(L>0||M==="upload_loadstart")&&(Object.assign(j.upload,{progress:L}),me(kS,{...K2(o,v),progress:L,status:Qs.InProgress}),N.push(Da(j))),Tt(N)}),$f(D=>(console.warn(D),d0(`Upload file chunk error. chunk:${u},total chunks:${d},uploadid:${h},trackingId:${p}`,o,D),Y4(l,o))))}}return J4(o,s)}(r,i,n,e)}),ht(t=>t)),chatFileEpics5:(n,e)=>n.pipe(rn(`${Da}`),st(t=>{const{payload:{upload:r}}=t;return!!r&&!!r.uniqueId&&r.totalChunks>0&&r.chunkIndex==r.totalChunks}),ht(t=>{const{payload:{originFile:r,upload:{uniqueId:i}}}=t;return function(o,s,a,c){const{chat:{fileServerDomain:l},meeting:{zmk:u}}=c.value,d=Yw(s,c.value);if(d!=null&&d.file){const{file:{upload:{uploadid:h,metadata:f,etags:p,trackingId:g}},receiver:m}=d,v=`${l}/upload/complete?uploadid=${h}`;return wh({url:v,method:"POST",headers:{"x-zm-trackingid":g,"Zoom-File-Origin":"redirect=support_auth",zmk:u},crossDomain:Lf(v),body:{metadata:f,etags:p}}).pipe(qp(X4(o,s,m,a)),Vt(b=>{var S,E;const{chat:{fileServerDomain:w}}=c.value,{responseHeaders:C}=b,I=(S=C["zoom-file-id"])===null||S===void 0?void 0:S.trim(),T=(E=C["zoom-file-obj"])===null||E===void 0?void 0:E.trim(),D=`${w}/zoomfile/download?objkey=${T}`;return me(kS,{...K2(o,m),progress:100,status:Qs.Success}),Da({fileID:I,fileObj:T,fileUrl:D,upload:{uniqueId:s,progress:100,status:Qs.Success}})}),$f(b=>(console.warn(b),d0(`Upload chunks checksum error.uploadid${h},trackingId${g}`,o,b),Y4(d,o))))}return J4(o,s)}(r,i,n,e)})),chatFileEpics6:(n,e)=>zt(n,4308).pipe(ny(async t=>{const{payload:{body:{attendeeNodeID:r,destNodeID:i,fileID:o,fileName:s,fileObj:a,fileSize:c,fileType:l,msgID:u,senderName:d}}}=t,{meeting:{bIbDisableChat:h},chat:{fileServerDomain:f,isEnableFileTransferEncrypted:p}}=e.value,g=[];if(!h){const m=c5e(f,{fileObj:a,fileID:o});if(l===_at.Local){const{sn:v,...b}=r5e({destNodeID:i,attendeeNodeID:r,senderName:d},e.value);let[S,E]=["",0];if(p){const[C,I]=await Promise.all([s,c].map(T=>zc.beginDecrypt({decryptedText:T,zoomId:v,type:fc.RWG_CHAT})));S=C.message,E=Number(I.message)}else S=Xf(s),E=Number(Xf(c));const w={id:u,file:{name:S,size:E,fileUrl:m},...b};g.push(t3({...w,file:{...w.file,fileID:o,fileObj:a}})),setTimeout(()=>{me(iS,w)},0)}}return g})),chatFileEpics7:(n,e)=>n.pipe(rn(`${Da}`),st(t=>{var r,i;const{payload:o}=t;return o.id&&o.fileUrl&&((r=o.download)===null||r===void 0?void 0:r.status)===Sm.InProgress&&((i=o.download)===null||i===void 0?void 0:i.progress)===0}),ht(t=>function(r,i,o){var s;const{chat:{chatHistory:a},meeting:{zmk:c},participants:{attendeesList:l}}=o.value,u=a.find(d=>d.id===r);if(u!=null&&(s=u.file)!==null&&s!==void 0&&s.fileUrl){const{file:{fileUrl:d}}=u;return wh({url:d,method:"GET",headers:{"Zoom-File-Origin":"redirect=support_auth",zmk:c},crossDomain:Lf(d),responseType:"arraybuffer",includeDownloadProgress:!0}).pipe(qp(function(h,f){return f.pipe(rn(`${qte}`,`${Zf}`),st(p=>{if(p.type===`${Zf}`)return!0;const{payload:{id:g}}=p;return h.id===g}),en(()=>{var p,g,m;s5e.info(`Cancel file download. file name:${oc((p=h.file)===null||p===void 0?void 0:p.name)},file size:${(g=h.file)===null||g===void 0?void 0:g.size},sender id:${(m=h.sender)===null||m===void 0?void 0:m.userId}`),me(P4,{...KB(h),progress:0,status:Sm.Cancel})}))}(u,i)),ny(async h=>{const{type:f,loaded:p,total:g}=h,m=[],v={...KB(u),progress:0,status:Sm.InProgress};if(f==="download_loadstart"&&Object.assign(v,{progress:0}),f==="download_progress"){var b;const T=Math.floor(p/g*100);m.push(Da({id:r,fileUrl:(b=u.file)===null||b===void 0?void 0:b.fileUrl,download:{progress:T}})),Object.assign(v,{progress:T})}else if(f==="download_load"){var S,E,w;const D=Sm.Success;Object.assign(v,{progress:100,status:D}),m.push(Da({id:r,fileUrl:(S=u.file)===null||S===void 0?void 0:S.fileUrl,download:{progress:100,status:D}}));const O=(E=l.find(R=>R.userId===u.sender.userId))===null||E===void 0?void 0:E.zoomID,M=await async function(R,A,k){const L=Math.ceil(R.byteLength/Xa.DecodeBlockSize);try{const j=await Promise.all(Array.from({length:Math.max(L-1,1)},(N,B)=>({start:B*Xa.DecodeBlockSize,end:(B===L-2?B+2:B+1)*Xa.DecodeBlockSize})).map(async N=>{let{start:B,end:U}=N;try{const K=R.slice(B,U),{message:z}=await zc.beginDecrypt({decryptedText:K,zoomId:k,type:fc.CHAT_FILE});return z}catch(K){return d0("decrypt file buffer error.",{name:A,size:R.byteLength},K),Promise.reject(K)}}));return new Blob(j,{type:pdt(A)})}catch{return null}}(h.response,(w=u.file)===null||w===void 0?void 0:w.name,O);var C,I;M&&((C=u.file)!==null&&C!==void 0&&C.download.blob?Object.assign(v,{fileBlob:M}):function(R,A){const k=document.createElement("a"),L=window.URL.createObjectURL(R);k.href=L,k.download=A,k.click(),window.URL.revokeObjectURL(L)}(M,(I=u.file)===null||I===void 0?void 0:I.name))}return(v.progress>0||f==="download_loadstart")&&me(P4,v),m}),$f(h=>(console.warn(h),d0(`download file error. file url:${d}`,{name:void 0,size:void 0},h),me(P4,{...KB(u),progress:0,status:Sm.Fail}),hi(Da({id:r,fileUrl:d,download:{status:Sm.Fail,progress:0}})))))}return Mt}(t.payload.id,n,e)))});function X_(n,e){const{meeting:{isMeetingReset:t,meetingId:r,meetingNumber:i,userName:o,userEmail:s,tid:a,userId:c,userGUID:l},breakoutRoom:u}=n;let d="";var h;return d=t?u!=null&&(h=u.currentRoom)!==null&&h!==void 0&&h.boConfId?"join breakout room":"meeting failover":"join meeting",{label:d,payload:{meetingId:r,tid:a,userId:c||(e==null?void 0:e.userId),userGUID:l||(e==null?void 0:e.userGUID),meetingNumber:oc(i),userName:oc(o),userEmail:oc(s)}}}function Id(n,e,t){return xS(zr(r=>{let i=!1;try{var o,s;const{logger:{options:a},meeting:{logConfig:c}}=e.value;i=(o=a==null?void 0:a.enable)!==null&&o!==void 0?o:(s=JSON.parse(c||"{}"))===null||s===void 0?void 0:s.enable}catch{}try{if(i){const{logger:{isLaplaceInitialized:a}}=e.value;if(!a)return n.pipe(rn(`${H6}`),Ur(1),ht(c=>(c.payload&&t(r),Mt)));t(r)}}catch(a){console.warn(a)}return Mt}))}function Ep(n,e,t,r){return Vn(n,t).pipe(Id(n,e,r))}function UC(n,e,t,r){return zt(n,t).pipe(Id(n,e,r))}function aG(n){var e,t;const{audio:{activeMicrophone:r,activeSpeaker:i,microphoneDevicesList:o,speakerDevicesList:s}}=n;return`microphone: [${r} - ${o==null||(e=o.find(a=>a.deviceId===r))===null||e===void 0?void 0:e.label}]; speaker: [${i} - ${s==null||(t=s.find(a=>a.deviceId===i))===null||t===void 0?void 0:t.label}]`}function d5e(n){var e;const{video:{activeCamera:t,cameraDevicesList:r}}=n;return`camera: [${t} - ${r==null||(e=r.find(i=>i.deviceId===t))===null||e===void 0?void 0:e.label}]`}function nI(n,e){return e?` ,${n}:${e}`:""}const{InitSuccessAudio:_dt,InitFailedAudio:wdt,InitSuccessVideo:Cdt,InitFailedVideo:xdt,InitSuccessSharing:Edt,InitFailedSharing:Idt}=bt,{DecodeSuccess:pfe,DecodeFailed:gfe,EncodeSuccess:mfe,EncodeFailed:vfe}=Ul,Pdt={[`${_dt}`]:{name:"Audio",isException:!1},[`${wdt}`]:{name:"Audio",isException:!0},[`${Cdt}`]:{name:"Video",isException:!1},[`${xdt}`]:{name:"Video",isException:!0},[`${Edt}`]:{name:"Sharing",isException:!1},[`${Idt}`]:{name:"Sharing",isException:!0}};function kdt(n){const e=(n??"").split("-");return[...new Set(e)].map(t=>({reason:t,count:e.filter(r=>t===r).length}))}const _u=xl.getInstance(),GB=()=>{if("connection"in navigator){const{effectiveType:n,rtt:e,downlink:t}=navigator.connection;_u.makeLogger(["Network Connection Type"]).info(`Network connection. ect:${n},rtt:${e},downlink:${t}`)}},qv=xl.getInstance().makeLogger(["Remote Control"]),yfe=El(zn.getInstance()),Tdt=[{event:bt.AudioBridgeReconnectStart,message:_b.AudioBridgeReconnectStart,logType:"info",additionalTags:["Audio Join Flow"]},{event:bt.AudioBridgeReconnectEnd,message:_b.AudioBridgeReconnectEnd,logType:"info",additionalTags:["Audio Join Flow"]},{event:bt.UserGrantCaptureAudio,message:n=>`${_b.DeviceAudioStreamCaptured},${aG(n)}`,logType:"info",additionalTags:["Audio Capture Flow"]},{event:bt.JoinComputerAudioComplete,message:_b.AudioJoinComplete,logType:"info",additionalTags:["Audio Join Flow"]},{event:bt.LeaveComputerAudioComplete,message:_b.AudioLeaveComplete,logType:"info",additionalTags:["Audio Join Flow"]},{event:bt.JoinSharingAudioComplete,message:_b.SharingAudioStartComplete,logType:"info",additionalTags:["Audio Sharing Flow"]},{event:bt.LeaveSharingAudioComplete,message:_b.SharingAudioStopComplete,logType:"info",additionalTags:["Audio Sharing Flow"]}],Ddt=[{event:bt.StartVideoCaptureSuccess,message:n=>`${wb.StartCaptureVideoSuccess}, ${d5e(n)}`,logType:"info",additionalTags:["Video Join Flow"]},{event:bt.StopVideoCaptureSuccess,message:wb.StopCaptureVideoSuccess,logType:"info",additionalTags:["Video Join Flow"]},{event:bt.StartVideoStreamInVbSettingSuccess,message:wb.VBSettingSuccess,logType:"info",additionalTags:["Video VB Flow"]},{event:bt.VbModelPreloadingOk,message:wb.VBPreloadSuccess,logType:"info",additionalTags:["Video VB Flow"]},{event:bt.VbModelPreloading_3S,message:wb.VBPreloading3S,logType:"warn",additionalTags:["Video VB Flow"]},{event:bt.VbModelPreloading_10S,message:wb.VBPreloading10S,logType:"warn",additionalTags:["Video VB Flow"]},{event:bt.VbSettingParaError,message:wb.VBSettingFailed,logType:"error",additionalTags:["Video VB Flow"]}],bfe=Tdt.map(n=>({...n,tag:"Audio"})).concat(Ddt.map(n=>({...n,tag:"Video"}))),ad=xl.getInstance(),{InitSuccessVideo:Rdt,InitSuccessAudio:Adt,InitSuccessSharing:Odt,InitFailedVideo:Mdt,InitFailedAudio:$dt,InitFailedSharing:Ldt,RecoverWebrtcAudio:Ndt,AudioBridgeFirstRecvData:Sfe,AudioBridgeCanSendData:Fdt,UserForbiddedCaptureAudio:_fe,AudioWebsocketBroken:jdt,AudioZeroData:wfe,UserForbiddedCaptureVideo:Cfe,UserCameraIsTakenByOtherPrograms:xfe,VideoWebsocketBroken:Bdt,StopVideoCaptureFailed:Hdt,DesktopSharingPermissionDenied:Udt,DesktopSharingSystemError:Efe,AudioSpeakerSetError:Ife,VbSettingParaError:zdt,MaskSettingParaError:Vdt,WebglLostInMultiView:Wdt,VideoStreamFailed:Pfe,AudioStreamFailed:kfe,NotifyUIFailover:qdt}=bt,kb=xl.getInstance(),ZB={options:void 0,isLaplaceInitialized:!1},Kdt=ru({[`${Yte}`]:Pe((n,e)=>{let{payload:t}=e;n.options=t}),[`${H6}`]:Pe((n,e)=>{let{payload:t}=e;n.isLaplaceInitialized=t}),[`${NDe}`]:(n,e)=>{let{options:t}=n,{payload:r}=e;return r?{...ZB,options:t}:{...ZB}}},ZB),Gdt={mlEpics0:(n,e)=>Vn(n,[Rdt,Adt,Odt,Mdt,$dt,Ldt]).pipe(Id(n,e,t=>{const{payload:{type:r,data:i}}=t,{meeting:{userId:o}}=e.value,s=function(a,c){const l=Pdt[`${a}`];if(l){const{name:u,isException:d}=l,h=[u,`${u} Init Flow`];d&&h.push(`${u} exception flow`);let f="";return[pfe,gfe].includes(c)&&(f=`${f} decode`.trim()),[mfe,vfe].includes(c)&&(f=`${f} encode`.trim()),[mfe,pfe].includes(c)&&(f=`${f} success`.trim()),[gfe,vfe].includes(c)&&(f=`${f} failed`.trim()),{message:`init ${u.toLowerCase()} ${f}`,tags:h,isException:d}}return null}(r,i);if(s){const{message:a,tags:c,isException:l}=s;l?ad.report(`${a}. userId:${o}`,c):ad.makeLogger(c).info(a)}})),mlEpics1:(n,e)=>Ep(n,e,bfe.map(t=>t.event),t=>{const{payload:{type:r}}=t,i=bfe.find(o=>o.event===r);if(i){const{message:o,logType:s,additionalTags:a,tag:c}=i;let l=o;typeof o=="function"&&(l=o(e.value)),l&&ad.makeLogger([c])[s](l,a)}}),mlEpics2:(n,e)=>n.pipe(rn(`${B2}`),st(t=>!t.payload),Id(n,e,()=>{ad.makeLogger(["Audio"]).warn(`Auto play audio failed,${aG(e.value)}`)})),mlEpics3:(n,e)=>Ep(n,e,Ndt,()=>{ad.report("Audio bridge, recover audio failed, need to rejoin the audio",["Audio exception flow"])}),mlEpics4:(n,e)=>Ep(n,e,[Sfe,Fdt],t=>{const{payload:{type:r}}=t;ad.makeLogger(["Audio"]).log("Audio bridge connection: "+(r===Sfe?"first receive data":"can send data"))}),mlEpics5:(n,e)=>Ep(n,e,qdt,t=>{ad.report(`Audio bridge, notify ui failover, subreason:${t.payload.data}`,["Audio exception flow"])}),mlEpics6:(n,e)=>Ep(n,e,[_fe,jdt,wfe,Ife,kfe],t=>{const{payload:{type:r}}=t;let i=`Audio error case:${r}`;r===_fe?i="Audio capture is forbidden by the user":r===wfe?e.value.audio.webrtcRestartCount<3&&(i="audio capture zero data, auto failover"):r===Ife?i="audio change speaker error":r===kfe&&(i="audio stream ended or muted, stop capture audio"),ad.report(`${i},${aG(e.value)}`,["Audio exception flow"])}),mlEpics7:(n,e)=>Ep(n,e,[Cfe,xfe,Bdt,Hdt,Pfe],t=>{const{payload:{type:r,data:i}}=t;let o=`Video error case:${r}`;if(r===Cfe)o="Video capture is forbidden by the user"+(i?` (error name:${i==null?void 0:i.name};error message:${i==null?void 0:i.message})`:"");else if(r===xfe)o="Camera is taken by other programs"+(i?` (error name:${i==null?void 0:i.name};error message:${i==null?void 0:i.message})`:"");else if(r===zdt){var s;o=`VB setting error, param:${JSON.stringify((s=e.value.video.virtualBackground)!==null&&s!==void 0?s:{})}`}else if(r===Vdt){var a;o=`Mask setting error, param:${JSON.stringify((a=e.value.video.mask)!==null&&a!==void 0?a:{})}`}else r===Pfe&&(o=`Video stream ended or muted, if it is on iOS platform, will stop capture video.platform:${tn.browser}`);ad.report(`${o},${d5e(e.value)}`,["Video exception flow"])}),mlEpics8:(n,e)=>Ep(n,e,[Udt,Efe],t=>{const{payload:{type:r}}=t;let i="";r===Efe?tn.isMacOS&&(i="Need to allow screen recording access in system setting on MacOS"):i="Need to allow the permission request",ad.report(`${i}`,["Sharing exception flow"])}),mlEpics9:(n,e)=>Ep(n,e,Wdt,t=>{const{payload:{data:r}}=t,{video:{renderedVideoList:i}}=e.value;if(r!=null&&r.canvasId){const o=i.filter(s=>s.canvasId===r.canvasId);ad.report(`WebGl Context lost, canvas ID:${r.canvasId}, affected video node Ids:${o.map(s=>s.userId).join(",")}`,["Video exception flow"])}}),mlEpics10:(n,e)=>No(document,"visibilitychange").pipe(Id(n,e,()=>{ad.makeLogger(["Video"]).log(`Page visibility ${document.visibilityState} `),setTimeout(()=>{const t=document.visibilityState!=="visible",{video:{subscribedVideoList:r},meeting:{userId:i}}=e.value,o=r.filter(s=>s!==i).length>0;t&&o&&(Gr.createAgent().sendRWGConnectionPerformance("VCSV"),ad.makeLogger(["Video"]).warn("Still subscribing videos after switching to background"))},1e3)}))},Zdt={rmclEpics0:(n,e)=>n.pipe(rn(`${Bte}`),Id(n,e,t=>{const{payload:{isRemoteControlEnabled:r,isEnableAutoDeleteRcApp:i}}=t;qv.log(`isRemoteControlEnabled:${r},auto delete:${i}`)})),rmclEpics1:(n,e)=>n.pipe(rn(`${Fp}`),st(t=>!!t.payload),Id(n,e,t=>{qv.log(`Launch Remote control app, scheme:${t.payload}`)})),rmclEpics2:(n,e)=>n.pipe(rn(`${XP}`),st(t=>!!t.payload),Id(n,e,t=>{qv.log(`Remote control session starts, controlling ssrc:${t.payload}`)})),rmclEpics3:(n,e)=>UC(n,e,16430,()=>{qv.log("Remote control app connected to rwg.")}),rmclEpics4:(n,e)=>UC(n,e,Eq,()=>{qv.log("Remote control app disconnected to rwg.")}),rmclEpics5:(n,e)=>UC(n,e,Eq,t=>{const{share:{status:r,isRemoteControlEnabled:i}}=e.value;i&&r!==Hr.End&&t.payload.body.bOn&&qv.log(`Remote control sharing device info.${JSON.stringify(yfe.getShareStreamInfo())}`)}),rmclEpics6:(n,e)=>Ep(n,e,bt.CurrentDesktopSharingWidthHeight,()=>{const{share:{isRemoteControlEnabled:t}}=e.value;t&&qv.log(`Remote control sharing device info changes.${JSON.stringify(yfe.getShareStreamInfo())}`)}),rmclEpics7:(n,e)=>Ep(n,e,bt.SendRemoteControlQrCode,t=>{const{share:{status:r}}=e.value,{payload:{data:i}}=t;qv.log(`Remote control QR code result. sharing status:${r}, result${JSON.stringify(i)}`)})},Xdt={epics0:(n,e)=>n.pipe(rn(`${Hh}`),ht(async t=>{const{meeting:{logConfig:r,logEncryptionPubKey:i,zlkJwtToken:o,accountId:s,enableAutoLog:a,collectionToggleEnable:c,zsk:l},logger:{options:u}}=e.value;let d=u||{};if(r)try{const{enable:h,enableReport:f}=JSON.parse(r);d={...d,enable:h,enableReport:f}}catch{}if(o){const{telemetry_tracking_id:h}=ES(o),{payload:{meetingId:f}}=t;d={...d,enable:!0,enableReport:!0,trackingId:h??f}}else{let h=!1;h=l&&c!==void 0?!(a&&c):!a,rr.set(Kk.DisableAutoReportLogs,h,ri.Memory)}return _u.init({...d,logConfig:r,logEncryptionPubKey:i,accountId:s}).then(()=>[H6(!0),Yte(d)]).catch(()=>[H6(!1)])}),ht(t=>Tt(t))),epics1:(n,e)=>UC(n,e,y7,t=>{var r,i,o,s;const{payload:{body:a}}=t;if(a&&a.res===Eu.Success){_u.makeLogger(["A/V Performance Info"]).info(`CPU cores:${navigator.hardwareConcurrency}, SharedArrayBuffer:${!!window.crossOriginIsolated}, browser:${tn.browser} ${tn.browserVersion}, OS:${tn.os} ${tn.osVersion}${nI("wow64",tn.wow64)}${nI("GPU",tn.gpu)}${nI("architecture",tn.architecture)}${nI("bitness",tn.bitness)}${nI("model",tn.model)}${rr.get(Kk.EnforceWebRTCAudio)?"; Enforce WebTRC audio":""}`,["CPU_CORES"]);const{media:{enforceMultipleVideos:D,enforceVirtualBackground:O,assetsPath:M,disableRenderLimits:R},meeting:{stayAwake:A,quicklyLeave:k}}=e.value;_u.makeLogger(["Init Option"]).info(`Init option:${JSON.stringify({enforceMultipleVideos:D,disableRenderLimits:R,enforceVirtualBackground:O,assetsPath:M,stayAwake:A,leaveOnPageUnload:k})}`),"connection"in navigator&&(GB(),navigator.connection.addEventListener("change",GB))}else _u.report(`join meeting failed, error:${JSON.stringify(wp(a==null?void 0:a.res))}, rwg error code:${a==null?void 0:a.res}, rwg conID:${a==null?void 0:a.conID}, error message:${a==null?void 0:a.error_desc}, rwg url:${a==null?void 0:a.svcUrl},mid:${e.value.meeting.meetingId}`,"JOIN_MEETING_FAILED","error");const{meeting:{meetingInfoTimestamp:c,pingRWCTimestamp:l,tid:u,meetingId:d,topic:h,accountId:f,cv:p},socket:{rwgServerList:g,retryCount:m},video:{rendererType:v},media:{patchJsMedia:b,assetsPath:S}}=e.value;let E=["conID","confID","mmrFeature","mmrFeatureEx","reportDomain","res","role","svcUrl","userID"].reduce((D,O)=>a[O]!==void 0?{...D,[`${O}`]:a[O]}:D,{});E=["jid","mn","participantID","zoomID"].reduce((D,O)=>a[O]!==void 0?{...D,[`${O}`]:oc(a[O])}:D,E),E.response=E.res,delete E.res;const w=["connection_info_map"];let C;if(a.res===Eu.Success&&w.push("Command Socket Event","User Info Map"),u){const D=u.match(/clid=(\S+);/);D&&D.length>1&&(C=D[1])}const I=Math.floor(performance.now()-c),T=Math.floor(performance.now()-l);_u.report(JSON.stringify({...E,tid:u,mid:d,userRegion:C,rwgUrl:g.length>0?(r=g[m])===null||r===void 0?void 0:r.rwg:void 0,hardwareConcurrency:navigator.hardwareConcurrency,sharedArrayBuffer:!!window.crossOriginIsolated,browserVersion:`${tn.browser} ${tn.browserVersion}`,osVersion:`${tn.os} ${tn.osVersion}`,gpu:tn.gpu,architecture:tn.architecture,model:tn.model,bitness:tn.bitness,totalDurationOfJoining:I,durationOfRWG:T,rendererType:v,sdkVersion:p,mediaSdkVersion:(i=window.JsMediaSDK_Instance)===null||i===void 0?void 0:i.version,topic:h?oc(h):void 0,accountId:f?oc(f):void 0,patchJSMediaSDK:b,dependentAssets:S,webRtcAudio:ra()}),w,"info"),Gr.createAgent().sendRWGConnectionPerformance(`WCL_M, conId: ${a==null?void 0:a.conID}, trackingId: ${(o=e.value.logger)===null||o===void 0||(s=o.options)===null||s===void 0?void 0:s.trackingId}, JOINFS(${I}), JOINFRWC(${T})`)}),epics2:(n,e)=>n.pipe(rn(`${yte}`),nn(e),st(t=>{let[,r]=t;return r.meeting.encryptedRWC===void 0&&(r.meeting.encryptedGEORWC===void 0||r.meeting.encryptedGEORWC.length===0)}),Id(n,e,()=>{const{label:t,payload:r}=X_(e.value);_u.report(`${t} ${JSON.stringify(r)}`,["Join Meeting Flow","Ping RWC Domain Empty"],"error")})),epics3:(n,e)=>n.pipe(rn(`${Bc}`),st(t=>t.payload===La.OnError||t.payload===La.Disconnect||t.payload===La.NoHeartbeat),Id(n,e,t=>{const{payload:r}=t,{socket:{rwgServerList:i,retryCount:o}}=e.value,{payload:s}=X_(e.value);_u.report(`websocket unexpected disconnected,${JSON.stringify({code:r,rwgHost:i[o],...s})}`,["Join Meeting Flow","RWG Disconnect"])})),epics4:(n,e)=>n.pipe(rn(`${e6}`),Id(n,e,t=>{const{payload:{reason:r,count:i,interval:o,sequence:s,userId:a,userGUID:c}}=t,{payload:l}=X_(e.value,{userId:a,userGUID:c});_u.report(`meeting failover,${JSON.stringify({reason:r,count:i,interval:o,sequence:s,detailed:kdt(s),...l})}`,["Join Meeting Flow","Failover"]),"connection"in navigator&&navigator.connection.removeEventListener("change",GB)})),epics5:(n,e)=>n.pipe(rn(`${Vw}`),st(t=>t.payload.status===$i.Connecting),Id(n,e,t=>{const{payload:{rwgUrl:r}}=t;let i=r.replace(/(\d+)\?/,`${oc("$1")}?`);i=["email","zoomid","participantID","dn2","customer_key","mpwd","topic"].reduce((s,a)=>s.indexOf(a)>-1?s.replace(new RegExp(`${a}=([^&]+)`,"g"),`${a}=${oc("$1")}`):s,i);const{payload:o}=X_(e.value);_u.makeLogger(["Join Meeting Flow"]).info(`RWG URL,${JSON.stringify({rwgUrl:i,...o})}`,["RWG Url"])})),epics6:(n,e)=>n.pipe(rn(`${Zf}`),st(t=>{const{payload:r}=t;return r?r.retry:e.value.meeting.meetingStatus===ws.Initial}),Id(n,e,()=>{const{meeting:{meetingStatus:t},socket:{rwgServerList:r,retryCount:i}}=e.value;if(t!==ws.Joined){const{payload:o}=X_(e.value),s=(r==null?void 0:r.length)>0?r[i]:void 0;_u.report(JSON.stringify({...o,rwc:s==null?void 0:s.rwc,rwg:s==null?void 0:s.rwg}),["UNAVAILABLE_RWG"])}})),epics7:(n,e)=>UC(n,e,1,t=>{const{payload:{body:r}}=t;_u.report(`join meeting failed, version blocked. Current version:${e.value.meeting.cv},upgrade version:${r==null?void 0:r.upgradeVersion}`,"JOIN_MEETING_FAILED","error")}),epics8:(n,e)=>UC(n,e,2,()=>{_u.report(`join meeting with low version of SDK. Current version:${e.value.meeting.cv}.`,"Join Meeting Flow","warn")}),epics9:(n,e)=>n.pipe(rn(`${JM}`,`${L2}`),zr(()=>Mi(cs,1).pipe(en(t=>{try{const{payload:r}=X_(e.value);_u.report(`Connection change with join meeting failed. payload:${JSON.stringify(t)}. meeting info:${JSON.stringify(r)}`,"JOIN_MEETING_FAILED","error")}catch{}}),ht(()=>Mt))))},Ydt=iu(Xdt,Zdt,Gdt),Jdt=Gr.createAgent(),Tfe={cmrStatus:da.Stop,recordingEnable:!1,recordingIsoEnable:!1,allowStopAutoRecording:!1,automaticCloudRecordingEnable:!1,isZoomIQ:!1,zoomIQChanging:!1,localStatus:Gk.Stop,supportLocalRecording:Vl.None,localGrantPermissionOption:kat.None,localPermissionUserList:[]},Qdt=ru({[`${gDe}`]:Pe((n,e)=>{let{payload:t}=e;n.cmrStatus=t}),[`${mDe}`]:Pe((n,e)=>{let{payload:t}=e;n.recordingEnable=t}),[`${vDe}`]:Pe((n,e)=>{let{payload:t}=e;n.recordingIsoEnable=t}),[`${yDe}`]:Pe((n,e)=>{let{payload:t}=e;n.allowStopAutoRecording=t}),[`${bDe}`]:Pe((n,e)=>{let{payload:t}=e;n.automaticCloudRecordingEnable=t}),[`${Gte}`]:Pe((n,e)=>{let{payload:t}=e;n.isZoomIQ=t}),[`${Zte}`]:Pe((n,e)=>{let{payload:t}=e;n.zoomIQChanging=t}),[`${Xte}`]:Pe((n,e)=>{let{payload:t}=e;n.localStatus=t}),[`${TK}`]:Pe((n,e)=>{let{payload:t}=e;n.supportLocalRecording=t}),[`${SDe}`]:Pe((n,e)=>{let{payload:t}=e;n.localGrantPermissionOption=t}),[`${NC}`]:Pe((n,e)=>{let{payload:t}=e;n.localPermissionUserList=t}),[`${_De}`]:()=>({...Tfe})},Tfe);var Dfe,Rfe,Afe,Ofe,Mfe,$fe,Lfe,Nfe,ko;const cf=Gr.createAgent(),rI=Nu("Recording");let eht=(Dfe=Yt("recording"),Rfe=Yt("recording"),Afe=Yt("recording"),Ofe=Yt("recording"),Mfe=Yt("recording"),$fe=Yt("recording"),Lfe=Yt("recording"),Nfe=Yt("recording"),ko=class extends Og{startRecording(){const n=this[Qt](),{meeting:{bIbDisableRecording:e,recordingEnable:t},recording:{cmrStatus:r}}=n;return e?Promise.reject({type:lt,reason:"Rejected by Information Barrier"}):t?r===da.Start?Promise.resolve(""):(cf.recordMeeting(!0,!1),Un(WP,i=>i.cmrServerStatus===da.Start)):Promise.reject({type:lt,reason:"The account of the meeting disabled the cloud recording"})}pauseRecording(){const n=this[Qt](),{recording:{cmrStatus:e,allowStopAutoRecording:t}}=n;return e===da.Pause?Promise.resolve(""):e!==da.Start?Promise.reject({type:lt,reason:"Recording is not started"}):t?(cf.recordMeeting(!1,!0),Un(WP,r=>r.cmrServerStatus===da.Pause)):Promise.reject({type:lt,reason:"Cannot pause cloud recording due to web setting config"})}stopRecording(){const n=this[Qt](),{recording:{cmrStatus:e,allowStopAutoRecording:t}}=n;return e===da.Stop?Promise.resolve(""):t?(cf.recordMeeting(!1,!1),Un(WP,r=>r.cmrServerStatus===da.Stop)):Promise.reject({type:lt,reason:"Cannot stop cloud recording due to web setting config"})}accept(){const n=this[Qt](),{recording:{cmrStatus:e,recordingIsoEnable:t}}=n,r=mn(n);return t?e!==da.Start&&e!==da.Pause?Promise.reject({type:lt,reason:"Recording is not started"}):r!=null&&r.bAllowISORecord?Promise.resolve("You accepted ISO recording"):(cf.allowSelfRecord(!0),Un(o6,i=>(i==null?void 0:i.userId)===(r==null?void 0:r.userId)&&(i==null?void 0:i.status)===Df.Accept)):Promise.reject({type:lt,reason:"ISO Recording is not enabled"})}decline(){const n=this[Qt](),{recording:{cmrStatus:e,recordingIsoEnable:t}}=n,r=mn(n);return t?e!==da.Start&&e!==da.Pause?Promise.reject({type:lt,reason:"Recording is not started"}):(r==null?void 0:r.bAllowISORecord)===!0?Promise.reject({type:lt,reason:"You had accept ISO recording, cant change it"}):(cf.allowSelfRecord(!1),Promise.resolve("")):Promise.reject({type:lt,reason:"ISO Recording is not enabled"})}getRecordingStatus(){const n=this[Qt](),{recording:{cmrStatus:e}}=n,t=Jat(n);return e===da.Start?Df.Recording:e===da.Pause?Df.Paused:t?Df.Recording:Df.Stopped}isRecordingEnabled(){const n=this[Qt](),{recording:{recordingEnable:e}}=n;return e}isAllowedToStopAutoRecording(){const n=this[Qt](),{recording:{allowStopAutoRecording:e}}=n;return e}isAutomaticCloudRecordingEnabled(){const n=this[Qt](),{recording:{automaticCloudRecordingEnable:e}}=n;return e}enableRecordingWithIQ(n){const{[Qt]:e,[Qo]:t}=this,r=e(),{recording:{isZoomIQ:i,zoomIQChanging:o},meeting:{meetingOptions:s}}=e();return s.isEnableKiwiRecording?Td(r)?o?Promise.reject({type:lt,reason:"We are changing, please wait"}):n===i?Promise.reject({type:lt,reason:`You have ${n?"enable":"disable"} Zoom IQ, don't need change`}):(t(Zte(!o)),t(Gte(!i)),cf.enableZoomIQRecord(n),Un(pke,a=>a==null?void 0:a.success)):Promise.reject({type:lt,reason:"Only Host or co-host can enable/disable Zoom IQ"}):Promise.reject({type:lt,reason:"You not have zoom IQ license or not enable zoom IQ, please check and retry"})}isSupportLocalRecording(){const n=this[Qt](),{meeting:{meetingOptions:e,isWebinar:t},breakoutRoom:r}=n;if((r==null?void 0:r.currentRoom.status)===Cn.InRoom)return!1;const i=mn(n);return(!t||!ma(i.userRole))&&(e==null?void 0:e.isLocalRecordingEnabled)}isSupportLocalRecordingPermission(){const n=this[Qt](),{recording:{supportLocalRecording:e}}=n;if(!this.isSupportLocalRecording())return!1;const t=mn(n);return!(t==null||!t.isHost)||e===Vl.Allow}askLocalRecordingPermission(){const{[Qt]:n}=this,{recording:{supportLocalRecording:e}}=n();return this.isSupportLocalRecording()?e===Vl.None?(cf.localRecordingRequestPermission(),Promise.resolve("")):e===Vl.Allow?Promise.resolve(""):Promise.reject("permission is denied"):Promise.reject("not support")}startLocalRecording(n){const{[Qt]:e,[Qo]:t}=this,r=e(),{recording:{localStatus:i,supportLocalRecording:o},meeting:{userId:s}}=r;if(!(n in Gk))return Promise.reject({type:lt,reason:"not support you parameter, only support type are 0(stop)/1(start)/2(pause)."});if(!this.isSupportLocalRecording())return Promise.reject({type:lt,reason:"not support local recording"});if(n===i)return Promise.resolve(`you currently status is ${i}, do nothing`);const a=mn(r);return o===Vl.Allow||a!=null&&a.isHost?(cf.localRecordingMeeting(n),Un(s6,c=>(c==null?void 0:c.userId)===s&&(t(Xte(c.bLocalRecord)),c.bLocalRecord===n),1e3)):Promise.reject({type:lt,reason:"you not have local recording permission, please use askLocalRecordingPermission request it first"})}isSupportLocalRecordingGrantPermission(){const n=this[Qt]();if(!this.isSupportLocalRecording())return!1;const e=mn(n);return!(e==null||!e.isHost)&&!!d5(e.caps)}grantLocalRecordingPermission(n,e,t){const{[Qt]:r,[Qo]:i}=this,o=r(),{recording:{localPermissionUserList:s}}=o;if(!this.isSupportLocalRecording())return Promise.resolve(!1);const a=mn(o);if(!d5(a.caps))return Promise.reject({type:lt,reason:"you can not grant permission"});let c=!1;if(t&&(c=!0),s.filter(l=>l===n).length>0){if(e===Vl.Allow)cf.localRecordingGrantPermission(n,!0,c);else{if(e!==Vl.Deny)return Promise.reject({type:lt,reason:"only support DENY(1)/ALLOW(2)"});cf.localRecordingGrantPermission(n,!1,c)}return i(NC(s.filter(l=>l!==n))),me(Ap,{type:"answer",value:e===Vl.Allow}),Promise.resolve(!1)}return e!==Vl.Deny?Promise.reject({type:lt,reason:"Direct grant only support DENY(1)"}):(cf.hostGrantPermission(n,!1),Un(Ap,l=>(l==null?void 0:l.value)===n&&(e===Vl.Allow?(i(NC([...s,n])),(l==null?void 0:l.canRecord)===!0):(i(NC(s.filter(u=>u!==n))),(l==null?void 0:l.canRecord)===!1)),1e3))}getLocalRecordingPermissionUserList(){const n=this[Qt](),{recording:{localPermissionUserList:e}}=n;if(!this.isSupportLocalRecording())return[];const t=mn(n);return d5(t.caps)?e:Promise.reject({type:lt,reason:"you can not grant permission"})}getLocalRecordingPermissionOperation(){const n=this[Qt](),{recording:{localGrantPermissionOption:e}}=n;if(!this.isSupportLocalRecording())return null;const t=mn(n);return d5(t.caps)?e:null}},gt(ko.prototype,"startRecording",[Ls,yt,Dfe,rI],Object.getOwnPropertyDescriptor(ko.prototype,"startRecording"),ko.prototype),gt(ko.prototype,"pauseRecording",[Ls,yt,Rfe,rI],Object.getOwnPropertyDescriptor(ko.prototype,"pauseRecording"),ko.prototype),gt(ko.prototype,"stopRecording",[Ls,yt,Afe,rI],Object.getOwnPropertyDescriptor(ko.prototype,"stopRecording"),ko.prototype),gt(ko.prototype,"accept",[yt,Ofe,rI],Object.getOwnPropertyDescriptor(ko.prototype,"accept"),ko.prototype),gt(ko.prototype,"decline",[yt,Mfe,rI],Object.getOwnPropertyDescriptor(ko.prototype,"decline"),ko.prototype),gt(ko.prototype,"askLocalRecordingPermission",[yt,$fe],Object.getOwnPropertyDescriptor(ko.prototype,"askLocalRecordingPermission"),ko.prototype),gt(ko.prototype,"startLocalRecording",[yt,Lfe],Object.getOwnPropertyDescriptor(ko.prototype,"startLocalRecording"),ko.prototype),gt(ko.prototype,"grantLocalRecordingPermission",[yt,Na,Nfe],Object.getOwnPropertyDescriptor(ko.prototype,"grantLocalRecordingPermission"),ko.prototype),ko);const tht={moduleEpics0:n=>n.pipe(rn(`${Hh}`),Vt(e=>{const{payload:{recordingEnable:t}}=e;return mDe(t)})),moduleEpics1:(n,e)=>zt(n,Md).pipe(st(t=>{var r,i,o;return((r=t.payload.body)===null||r===void 0?void 0:r.cmrServerStatus)!==void 0||((i=t.payload.body)===null||i===void 0?void 0:i.disAllowClientStopAutoCmr)!==void 0||((o=t.payload.body)===null||o===void 0?void 0:o.enableAutomicRecordingCloud)!==void 0}),nn(e),ht(t=>{let[r,i]=t;const{cmrServerStatus:o,disAllowClientStopAutoCmr:s,enableAutomicRecordingCloud:a}=r.payload.body,c=[];return o!==void 0&&(o!==da.Init&&(me(WP,{cmrServerStatus:o}),i.recording.recordingIsoEnable&&o===da.Start&&me(o6,{status:Df.Ask})),c.push(gDe(o))),s!==void 0&&c.push(yDe(!s)),a!==void 0&&c.push(bDe(a)),Tt(c)})),moduleEpics2:n=>zt(n,Md).pipe(st(e=>{var t;return((t=e.payload.body)===null||t===void 0?void 0:t.bCmrIsoEnble)!==void 0}),Vt(e=>{const{bCmrIsoEnble:t}=e.payload.body;return vDe(t)})),moduleEpics3:(n,e)=>zt(n,Co).pipe(nn(e),st(t=>{let[r]=t;const{payload:{body:{update:i,add:o}}}=r;return(i==null?void 0:i.some(s=>s.bLocalRecordStatus!==void 0||s.canRecord!==void 0))||(o==null?void 0:o.some(s=>s.bLocalRecordStatus!==void 0||s.canRecord!==void 0))}),ht(t=>{let[r,i]=t;const{payload:{body:{update:o,add:s}}}=r,{meeting:{userId:a,isHost:c},recording:{supportLocalRecording:l},participants:{attendeesList:u}}=i,d=[];return o==null||o.concat(s||[]).filter(h=>h.bLocalRecordStatus!==void 0||h.canRecord!==void 0).forEach(h=>{if(h.canRecord!==void 0){const f=!!h.canRecord;if(a===h.id||c){const p=u.find(g=>g.userId===a);!f&&p!=null&&p.bLocalRecord&&(me(Ap,{type:"revoke",value:h.id,canRecord:f}),Jdt.localRecordingMeeting(Gk.Stop)),!f||p!=null&&p.bLocalRecord||me(Ap,{type:"grant",value:h.id,canRecord:f})}a===h.id&&((l!==Vl.None||f)&&d.push(TK(f?Vl.Allow:Vl.Deny)),f||d.push(Xte(Gk.Stop)))}else me(s6,{userId:h.id,bLocalRecord:h.bLocalRecordStatus})}),Tt(d)})),moduleEpics4:(n,e)=>zt(n,Co).pipe(Vt(t=>n8(t.payload.body)),nn(e),ht(t=>{let[r,i]=t;const o=[],{recording:{localPermissionUserList:s}}=i;return r.remove&&r.remove.forEach(a=>{s.filter(c=>c===(a==null?void 0:a.userId))&&(o.push(NC(s.filter(c=>c!==(a==null?void 0:a.userId)))),me(Ap,{type:"remove",value:a==null?void 0:a.userId}))}),Tt(o)})),moduleEpics5:n=>zt(n,Co).pipe(st(e=>{const{payload:{body:{update:t}}}=e;return t==null?void 0:t.some(r=>r.bAllowISORecord!==void 0)}),en(e=>{const{payload:{body:{update:t}}}=e;t.filter(r=>r.bAllowISORecord!==void 0).forEach(r=>{me(o6,{userId:r.id,status:r.bAllowISORecord?Df.Accept:Df.Decline})})}),$n(Mt)),moduleEpics6:n=>zt(n,Md).pipe(st(e=>{var t;return((t=e.payload.body)===null||t===void 0?void 0:t.SalesRecordingAnalytics)!==void 0}),Vt(e=>{const{SalesRecordingAnalytics:t}=e.payload.body;return me(fke,{isZoomIQ:t}),Gte(t)})),moduleEpics7:(n,e)=>zt(n,4319).pipe(nn(e),st(t=>{var r;let[i]=t;return((r=i.payload.body)===null||r===void 0?void 0:r.success)!==void 0}),ht(t=>{let[r,i]=t;const o=[],{success:s}=r.payload.body,{recording:{zoomIQChanging:a}}=i;return me(pke,{success:s}),s&&o.push(Zte(!a)),Tt(o)})),moduleEpics8:(n,e)=>zt(n,4344).pipe(nn(e),st(t=>{var r;let[i]=t;return((r=i.payload.body)===null||r===void 0?void 0:r.cmdType)!==void 0}),ht(t=>{var r;let[i,o]=t;const s=[],{cmdType:a}=i.payload.body,{recording:{localPermissionUserList:c},meeting:{isHost:l}}=o;var u,d,h,f;return a==="permission_req_option"&&(me(Ap,{type:"option",value:(u=i.payload.body)===null||u===void 0?void 0:u.option}),s.push(SDe((d=i.payload.body)===null||d===void 0?void 0:d.option))),a==="request_permission"&&(r=i.payload.body)!==null&&r!==void 0&&r.userId&&(l&&me(Ap,{type:"request",value:(f=i.payload.body)===null||f===void 0?void 0:f.userId}),s.push(NC([...c,(h=i.payload.body)===null||h===void 0?void 0:h.userId]))),a==="permission_request_answer"&&(me(Ap,{type:"answer",value:i.payload.body.agreed}),s.push(TK(i.payload.body.agreed?Vl.Allow:Vl.Deny))),Tt(s)}))},nht=iu(tht);let l8=function(n){return n[n.All=1]="All",n[n.Private=2]="Private",n}({}),h5e=function(n){return n.SUCCESS="success",n}({}),u8=function(n){return n.CustomizedKey="__zoom_internal_message_customized_key__@@",n.SpeakerOnly="__zoom_internal_message_speaker_only__@@",n}({});const Ffe=l_.getInstance(),d8=(n,e,t)=>{const{meeting:{encType:r}}=t,i=e,o=TPe(n),s=i?l8.Private:l8.All;return r===tD.AES_GCM?zc.beginEncrypt({text:o,type:fc.XMPP_CHAT}).then(a=>{Ffe.sendWebinarMseeage(a,i,s,!0)}):Ffe.sendWebinarMseeage(o,i,s,!1)};function f5e(n,e){const{cmd:{jids:t}}=e;return Object.prototype.hasOwnProperty.call(t,n)?Promise.resolve():mc(Mi(f0).pipe(KIe(r=>r.findIndex(i=>Number(i.userId)===n)===-1),Ur(1),bl(Ag)))}function p5e(n){const{cmd:{connectionStatus:e}}=n;return e===h5e.SUCCESS?Promise.resolve(!0):mc(Mi(Ete,1)).then(t=>t===Lm.Connected||Promise.reject({type:lt,reason:"Cannot establish the command channel"}))}function cG(n,e){for(const[t,r]of Object.entries(n))if(r.jid===e)return t}const jfe={connectionStatus:"initial",jids:{}},rht=ru({[`${EDe}`]:()=>({...jfe}),[`${wDe}`]:Pe((n,e)=>{let{payload:t}=e;const{data:r,attendees:i}=t;r.forEach(o=>{const{jid:s,node:a}=o;if(!n.jids[a]||n.jids[a].jid!==s){const c=i.find(l=>l.userId===Number(a));n.jids[a]={jid:s,userGuid:c==null?void 0:c.userGUID}}})}),[`${CDe}`]:Pe((n,e)=>{let{payload:t}=e;t.forEach(r=>{const{jid:i}=r,o=cG(n.jids,i);o&&delete n.jids[o]})}),[`${xDe}`]:Pe((n,e)=>{let{payload:t}=e;n.connectionStatus=t})},jfe);var iI;let iht=(iI=class extends Og{send(n,e){if(!n)return Promise.reject({type:Jn,reason:"Text is empty"});if(typeof n!="string")return Promise.reject({type:Jn,reason:"Text is not a string"});if(n.length>512)return Promise.reject({type:Jn,reason:"Text exceeds the max length(512)."});const{[Qt]:t}=this,r=t(),{socket:{xmppSocketStatus:i},meeting:{userId:o}}=r;return i!==$i.Connected?Promise.reject({type:OC,reason:"Command channel is not ready"}):p5e(r).then(()=>e?Yi(t()).findIndex(s=>s.userId===e)!==-1?f5e(e,r).then(()=>{const{cmd:{jids:s}}=t();return s[e]?(d8(n,s[e].jid,t()),{timestamp:new Date().getTime(),text:n,receiverId:e,senderId:o}):Promise.reject({type:Nf})}):Promise.reject({type:Jn,reason:"Cannot find the user"}):(d8(n,"",r),{timestamp:new Date().getTime(),text:n,receiverId:0,senderId:o}))}getJids(){const{[Qt]:n}=this,e=n(),{cmd:{jids:t}}=e;return t}},gt(iI.prototype,"send",[yt],Object.getOwnPropertyDescriptor(iI.prototype,"send"),iI.prototype),iI);const oht={extraEpics0:(n,e)=>n.pipe(rn(`${Lte}`),zr(t=>{const{payload:{speakerOnly:r}}=t,i=mn(e.value);return((i==null?void 0:i.audio)!==void 0?Tt([i.audio]):Mi(ql).pipe(st(o=>o.audio!==void 0),Ur(1))).pipe(en(()=>{p5e(e.value).then(()=>{d8(`${u8.SpeakerOnly}${r?1:0}`,"",e.value)})}),$n(Mt))})),extraEpics1:(n,e)=>zt(n,Co).pipe(st(t=>{var r,i;const{payload:{body:o}}=t;return!!o.add&&!((r=e.value.audio)===null||r===void 0||(i=r.customizeAudioOption)===null||i===void 0||!i.speakerOnly)}),bl(Ag),en(async t=>{const{payload:{body:{add:r}}}=t,i=e.value,{meeting:{userId:o}}=i;for(let s=0;s<r.length;s++){const{id:a}=r[s];if(a!==o){await f5e(a,e.value);const{cmd:{jids:c},participants:{attendeesList:l}}=e.value;c[a]&&setTimeout(()=>{d8(`${u8.SpeakerOnly}1`,c[a].jid,e.value)},Math.floor(Math.random()*Math.log10(l.length)*1e3))}}}),$n(Mt))},sht={epics0:(n,e)=>TC(n,24577).pipe(nn(e),Vt(t=>{let[r]=t;const{payload:{body:{status:i}}}=r;return i===h5e.SUCCESS&&me(Ete,Lm.Connected),xDe(i)})),epics1:(n,e)=>TC(n,24583).pipe(nn(e),ht(t=>{let[r,i]=t;const{meeting:{userId:o,encType:s},cmd:{jids:a}}=i,{payload:{body:{senderName:c,senderJid:l,text:u,type:d,receiver:h,msgid:f,sn:p}}}=r,g=cG(a,h),m=s===tD.AES_GCM,v=cG(a,l),b=new Date().getTime();let S=Promise.resolve({message:u});return m&&(S=zc.beginDecrypt({decryptedText:u,type:fc.XMPP_CHAT,zoomId:p})),S.then(E=>{let{message:w}=E;if(d===l8.Private&&Number(g)===o||d===l8.All){const I=Xf(w);if(I!=null&&I.startsWith(u8.SpeakerOnly)){const T=I.substring(u8.SpeakerOnly.length),D=Number(T)===1;return Yk({userId:Number(v),key:"isSpeakerOnly",value:D})}{var C;const T=v&&((C=a[v])===null||C===void 0?void 0:C.userGuid);me(hke,{senderId:v,senderName:c,senderGuid:T,text:I,timestamp:b,msgid:f})}}return""})}),st(t=>typeof t=="object"&&t!==null&&t.type!==void 0),en(t=>{const{payload:{userId:r,key:i,value:o}}=t;me(dg,[{userId:r,[`${i}`]:o}])})),epics2:(n,e)=>TC(n,24595).pipe(ht(t=>{const{payload:{body:{action:r,data:i}}}=t,o=[];if([Op.List,Op.Add,Op.update].includes(r)&&i){const{breakoutRoom:s,participants:{attendeesList:a}}=e.value,c=(s==null?void 0:s.currentRoom.status)===Cn.InRoom?a.concat(s.mainSessionAttendeeList):a;o.push(wDe({data:i,attendees:c}))}return r===Op.Remove&&i&&o.push(CDe(i)),Tt(o)}))},aht=iu(sht,oht),Bfe=(n,e,t,r)=>{const{getState:i,dispatch:o}=t,s=i(),{participants:{attendeesList:a},audio:{localShareAudioUserMutedList:c},share:{isReceiveSharingFromMainSession:l},breakoutRoom:u}=s,d=(l?u==null?void 0:u.mainSessionAttendeeList:a).find(h=>h.userId==n);if(d){if(d.bShareAudioOn){const h=c.find(f=>f.userId===n);return h&&h.muted===!e&&o(c3(r,n,e,s)),Promise.resolve("")}return Promise.reject({type:lt,reason:`Cannot ${e?"mute":"unmute"} share audio when the user's share audio is not enable.`})}return Promise.reject({type:Jn,reason:"Cannot find the user"})},Hfe=(n,e)=>{const{store:{getState:t},rwgAgent:r}=n,{share:{sharePrivilege:i}}=t();return i===e?Promise.resolve(""):Object.values(Cd).includes(e)?(r.lockSharing(e),NK("lockShare",e)):Promise.reject({type:Jn})},Q4=Eo([Yi],n=>n.filter(e=>e.bVideoOn)),XB=Eo([Q4],n=>n.filter(e=>(e.caps&Ode)===Ode)),Ufe=(n,e)=>{const t=n.store.getState(),r=E1(t).find(i=>i.userId===e);if(r){const{caps:i}=r;return(o=>(512&o)==512)(i)}return!1};var zfe,Vfe,Wfe,qfe,Kfe,Gfe,Zfe,Xfe,Yfe,Jfe,Qfe,epe,tpe,npe,rpe,ipe,ope,spe,ape,cpe,lpe,upe,dpe,hpe,fpe,ppe,gpe,mpe,vpe,ype,bpe,Spe,_pe,wpe,Cpe,xpe,Epe,Ipe,Ppe,kpe,Tpe,Dpe,Rpe,Ape,Ope,Mpe,$pe,Lpe,Npe,Fpe,jpe,Bpe,Hpe,Upe,zpe,Vpe,Wpe,qpe,Kpe,Gpe,Zpe,Xpe,Ype,Jpe,Qpe,ege,tge,nge,rge,ige,oge,sge,age,cge,lge,uge,dge,hge,je;const yu=Nu("Audio"),la=Nu("Video"),Ec=Nu("Sharing"),Y_=Nu("CameraControl"),om=Nu("Remote Control"),YB=E7(HTMLCanvasElement,0),cht=E7([HTMLCanvasElement,HTMLVideoElement],0),fge=E7(HTMLCanvasElement,0,["id"]),pge=E7([HTMLCanvasElement,HTMLVideoElement],0,["id"]);let lht=(zfe=Yt("audio"),Vfe=Yt("audio"),Wfe=Yt("audio"),qfe=Yt("audio"),Kfe=Yt("audio"),Gfe=Nu("Audio",[1,2,3]),Zfe=Yt("audio"),Xfe=Nu("Audio",[1,2]),Yfe=Yt("audio"),Jfe=Yt("audio"),Qfe=Yt("audio"),epe=Yt("audio"),tpe=Yt("share"),npe=Yt("audio"),rpe=Yt("share"),ipe=Yt("audio"),ope=Yt("audio"),spe=Yt("audio"),ape=Yt("audio"),cpe=Yt("audio"),lpe=Yt("audio"),upe=Nu("Audio",[1,2]),dpe=Yt("audio"),hpe=Nu("Audio",[1,2]),fpe=Yt("audio"),ppe=Yt("audio"),gpe=Yt("video"),mpe=Yt("video"),vpe=Yt("video"),ype=Yt("video"),bpe=Yt("video"),Spe=Yt("video"),_pe=Yt("video"),wpe=Yt("video"),Cpe=Yt("video"),xpe=Yt("video"),Epe=Yt("video"),Ipe=Yt("video"),Ppe=Yt("video"),kpe=Yt("video"),Tpe=Yt("video"),Dpe=Yt("video"),Rpe=Yt("video"),Ape=Yt("video"),Ope=Yt("video"),Mpe=Yt("video"),$pe=Yt("video"),Lpe=Yt("video"),Npe=Yt("video"),Fpe=Yt("video"),jpe=Yt("video"),Bpe=Yt("video"),Hpe=Yt("share"),Upe=Yt("share"),zpe=Yt("share"),Vpe=Yt("share"),Wpe=Yt("share"),qpe=Yt("share"),Kpe=Yt("share"),Gpe=Yt("share"),Zpe=sfe("isShareOptionLocked"),Xpe=sfe("isShareOptionLocked"),Ype=Yt("share"),Jpe=Yt("share"),Qpe=Yt("share"),ege=Yt("share"),tge=Yt("share"),nge=Yt("share"),rge=Yt("share"),ige=Yt("share"),oge=Yt("share"),sge=Yt("share"),age=Yt("share"),cge=Yt("share"),lge=Yt("share"),uge=Yt("share"),dge=Yt("share"),hge=Yt("share"),je=class extends Og{constructor(n){super(n),this[wo].dispatch(dte()),this[pt]={store:n,mediaAgent:x7(El(zn.getInstance())),rwgAgent:Gr.createAgent()}}startAudio(n){return((e,t)=>{const{store:{getState:r,dispatch:i},rwgAgent:o,mediaAgent:s}=e,a=r(),c=mn(a);if((c==null?void 0:c.audio)===ci.Computer)return Promise.resolve("");if((c==null?void 0:c.audio)===ci.Phone)return Promise.reject({type:lt,reason:"joined by phone"});{const{audio:{isAllowToTalk:l,isComputerAudioLoading:u,canPlayAudio:d,customizeAudioOption:{speakerOnly:h}},media:{audioDecodeStatus:f,audioEncodeStatus:p}}=a;if(u)return Promise.reject({type:lt,reason:"Computer audio has been loading, please wait."});const g=function(b){const S=b?{...b}:void 0;if(Che(ra())||(S==null?void 0:S.backgroundNoiseSuppression)!==!0||(console.warn("Background noise suppression requires SharedArrayBuffer and is only supported on desktop browser"),Object.assign(S,{backgroundNoiseSuppression:void 0})),(S==null?void 0:S.originalSound)!==void 0){S.backgroundNoiseSuppression&&S.originalSound&&(console.warn("Enabling original sound will disable background noise suppression."),Object.assign(S,{backgroundNoiseSuppression:!1}));const{originalSound:E}=S;typeof E=="object"&&E.stereo&&!xhe()&&(console.warn("Cannot enable stereo audio on current platform due to the browser limitation"),Object.assign(E,{stereo:!1}))}return Ehe()||(S==null?void 0:S.syncButtonsOnHeadset)!==!0||(console.warn("Sync buttons on headset is not supported on the current platform"),Object.assign(S,{syncButtonsOnHeadset:void 0})),S!=null&&S.mediaFile&&!zn.isSupportMediaPlaybackAsVideoInput()&&(console.warn("Cannot use media file as audio input due to the browser limitation"),Object.assign(S,{mediaFile:void 0})),S}(t);i(Lte(g??{}));const{speakerOnly:m,autoStartAudioInSafari:v}=g||{};if(!!h!=!!m&&i(Yk({userId:a.meeting.userId,key:"isSpeakerOnly",value:!!m})),!c)return Promise.reject({type:lt,reason:"Please call `startAudio` method after the `join` has been resolved"});{const b=ma(c.userRole)&&!l||m,{encodeInitStatus:S,decodeInitStatus:E}=tG(a,c,m);if(l3()&&(E!=="success"||S!=="success"))return Promise.reject({type:lt,reason:"It is required to wait for the audio encoding and decoding to be ready before calling `startAudio` method"});i(qb(!0)),Tc("audio",S,E).subscribe(w=>{let[C,I]=w;if(C&&I){let T=d||(l3()||tn.isIOSMobile)&&!v?Promise.resolve():function(){const D=URL.createObjectURL(Dat),O=new Audio(D);O.muted=!1;const M=m7(()=>Promise.reject(),3e3),R=tn.isIOSMobile?new Promise((A,k)=>{var L;O.addEventListener("canplaythrough",()=>{O.play().then(()=>{A(!0)}).catch(j=>{k(j)})}),(L=O.load)===null||L===void 0||L.call(O)}):O.play();return Promise.race([R,M]).finally(()=>{URL.revokeObjectURL(D)})}();T===void 0&&(T=Promise.resolve()),T.then(()=>Dde("audio",r())).then(()=>{const D=r(),{audio:{isSharingAudio:O}}=D;s8(o,D,b),O&&!jp()||lS(s,D,!b),ma(c.userRole)&&l&&i(rK(!0)),i(B2(!0))}).catch(()=>{i(B2(!1)),i(qb(!1))})}else i(qb(!1))})}return p==="failed"||f==="failed"?(i(qb(!1)),Promise.reject({type:Nf,reason:"audio encode or decode error"})):new Promise((b,S)=>{Ad(Mi(yb.JoinComputerAudio.success,1),ga(...yb.JoinComputerAudio.fail.map(E=>Mi(E,1).pipe(ht(()=>b1({type:Oc,reason:E}))))),js(45e3).pipe(ht(()=>b1({type:Rte})))).subscribe({next:()=>{i(qb(!1)),b("")},error:E=>{zn.getInstance().leaveComputerAudio();const w=mn(r());(w==null?void 0:w.audio)!==ci.Phone&&(i(RS(Zk.MicrophoneError)),o.joinOrLeaveVoip(!1)),i(qb(!1)),S(E)}})})}})(this[pt],n)}stopAudio(){return(async n=>{const{store:{getState:e,dispatch:t},mediaAgent:r,rwgAgent:i}=n,o=e(),{audio:{isComputerAudioLoading:s,isShareAudioEnabled:a,isSharingAudio:c,isUsingMediaPlayback:l,customizeAudioOption:{speakerOnly:u}}}=o,d=mn(o);if(s)return Promise.reject({type:lt,reason:"Computer audio has not finished joining, please wait."});if(a){if(c&&!jp())return Promise.reject({type:lt,reason:"Cannot stop audio during sharing with audio"});t(H2(void 0)),t(Vm(void 0))}return(d==null?void 0:d.audio)===ci.Computer?(t(RS(Zk.Active)),await r.leaveComputerAudio(),i.joinOrLeaveVoip(!1),u&&t(Yk({userId:o.meeting.userId,key:"isSpeakerOnly",value:void 0})),l&&Tu.getInstance().stopAudioElement(),t(iD(0)),Un(Xk)):Promise.resolve("")})(this[pt])}muteAudio(n){return((e,t)=>{const{store:{getState:r,dispatch:i},rwgAgent:o,mediaAgent:s}=e,a=r(),c=mn(a);if(t==null||t===(c==null?void 0:c.userId))return(c==null?void 0:c.audio)===""||(c==null?void 0:c.audio)===null?Promise.reject({type:lt,reason:"no audio joined"}):(c==null?void 0:c.muted)===!0?Promise.resolve(""):(i(_m(Sf.Active)),o.mute(c.userId,!0),s.muteAudio(),a.audio.isShareAudioEnabled&&!jp()&&i(Vm(!0)),Un(Pte).then(()=>""));if(Td(a)){const{participants:{allowTalkAttendeesList:l,attendeesList:u}}=a,d=l.concat(u).find(h=>h.userId===t);return d?d.audio===""||d===null?Promise.reject({type:lt,reason:"no audio joined"}):d.muted===!1?(o.mute(t,!0),Un(Ake,h=>h.id===t&&h.muted==1)):Promise.resolve(""):Promise.reject({type:Jn,reason:"no matching user"})}return Promise.reject({type:Oc})})(this[pt],n)}unmuteAudio(n){return(async(e,t)=>{const{store:{getState:r,dispatch:i},rwgAgent:o,mediaAgent:s}=e,a=r(),c=mn(a);if(t===void 0||t===(c==null?void 0:c.userId)){if((c==null?void 0:c.audio)===""||(c==null?void 0:c.audio)===null)return Promise.reject({type:lt,reason:"no audio joined"});if((c==null?void 0:c.muted)===!1)return Promise.resolve("");if(a.audio.isShareAudioEnabled&&!jp()){if(a.audio.isSharingAudio)return Promise.reject({type:lt,reason:"Cannot unmute audio during sharing with audio"});i(Vm(!1))}if(a.audio.bCanUnmute||c!=null&&c.isHost||c!=null&&c.bCoHost){if(ma(c.userRole)){const{audio:{isAllowToTalk:l,isAllowToTalkAttendeeConnected:u}}=a;l?u||(await s.leaveComputerAudio(),await lS(s,a,!0),i(rK(!0))):Promise.reject({type:lt,reason:"Webinar attendee cannot unmute self audio."})}return i(Qk(qP.Active)),o.mute(c.userId,!1),s.unmuteAudio(),Un(kte).then(()=>"")}return Promise.reject({type:Oc,reason:"host not allow unmute themselves"})}if(Td(a)){const{participants:{allowTalkAttendeesList:l,attendeesList:u}}=a,d=l.concat(u).find(h=>h.userId===t);return d?d.audio===""||d===null?Promise.reject({type:lt,reason:"no audio joined"}):(d.muted===!0&&o.mute(t,!1),Promise.resolve("")):Promise.reject({type:Jn,reason:"no matching user"})}return Promise.reject({type:Oc})})(this[pt],n)}dialOut(n,e,t,r){return((i,o,s,a,c)=>{const{store:{getState:l,dispatch:u},rwgAgent:d}=i,h=l(),{meeting:{callOutCountry:f,isSupportCallOut:p}}=h;if(p&&Array.isArray(f)&&f.findIndex(g=>g.code===o)>-1){const{seq:g}=d.audioDialout(o+s,a,!(c==null||!c.callMe),!(c==null||!c.pressingOne),!(c==null||!c.greeting));return u(X3e({sequence:g,phoneNumber:o+s})),pm(yb.JoinAudioByCallMe)}return Promise.reject({type:Jn,reason:"no matching country code"})})(this[pt],n,e,t,r)}cancelDialOut(n,e,t){return((r,i,o,s)=>{const{rwgAgent:a}=r;return a.audioCancelDialout(i+o,!(s==null||!s.callMe)),pm(yb.cancelDialOut)})(this[pt],n,e,t)}hangup(){return(n=>{const{store:{getState:e},rwgAgent:t}=n,r=e(),i=mn(r);return(i==null?void 0:i.audio)===ci.Phone&&i.userId!==null?(t.audioDrop(i.userId),pm(yb.hangup)):Promise.reject({type:lt,reason:"not joined audio by phone"})})(this[pt])}switchMicrophone(n){return((e,t)=>{const{store:{getState:r,dispatch:i},mediaAgent:o}=e,s=r(),{audio:{microphoneDevicesList:a,activeMicrophone:c,mediaPlaybackFile:l,isUsingMediaPlayback:u}}=s,d=a.find(h=>h.deviceId===t);if(t==="default"||typeof t!="string"||d){const h=mn(s);if((h==null?void 0:h.audio)===ci.Computer){let f=!1;if(typeof t=="string")t!==c&&(o.changeMicrophone(t,d==null?void 0:d.label,!(h==null||!h.muted)),i(oK(void 0)),Tu.getInstance().stopAudioElement(),f=!0);else if(t&&(!u||(l==null?void 0:l.url)!==t.url)){const p=Tu.getInstance();p.setAudioElement(t).then(()=>{o.changeMicrophone(p.audioElement,void 0,!(h==null||!h.muted)),i(oK(t))}),f=!0}if(f)return pm(yb.JoinComputerAudio)}else typeof t=="string"&&i(Jk(t));return Promise.resolve("")}return Promise.reject({type:yde})})(this[pt],n)}switchSpeaker(n){return((e,t)=>{const{store:{getState:r,dispatch:i},mediaAgent:o}=e,{audio:{speakerDevicesList:s,activeSpeaker:a}}=r();if(t!=="default"&&s.findIndex(l=>l.deviceId===t)==-1)return Promise.reject({type:yde});var c;if(((c=mn(r()))===null||c===void 0?void 0:c.audio)===ci.Computer){if(t!==a)return o.changeSpeaker(t),Un(Hq,l=>l)}else i(_7(t));return Promise.resolve("")})(this[pt],n)}muteShareAudio(n){return((e,t)=>{const{mediaAgent:r,rwgAgent:i,store:{getState:o,dispatch:s}}=e,a=o(),{meeting:{userId:c}}=a;if(t&&t!==c)return Bfe(t,!0,e.store,r);{const{audio:{isSharingAudio:u,isShareAudioEnabled:d,isShareAudioMuted:h}}=a;if(!d)return Promise.reject({type:lt,reason:"Cannot mute sharing audio when sharing audio is not enable"});if(h)return Promise.resolve("");{i.muteShareAudio(!0);let f=Promise.resolve();var l;return u&&(f=(l=r.leaveSharingAudio(!0))===null||l===void 0?void 0:l.then(()=>gne(r,i,a).then(p=>{p.forEach(g=>s(g))}))),c3(r,c,!0,a),Promise.all([Un({event:ql,operations:[st(p=>p.bShareAudioOn!==void 0),Ur(1)]},p=>p.bShareAudioOn===!1),f]).then(()=>(s(y6(!0)),u&&(s(U2(!1)),me(j2,{state:"off"})),""))}}})(this[pt],n)}unmuteShareAudio(n){return((e,t)=>{const{mediaAgent:r,rwgAgent:i,store:{getState:o,dispatch:s}}=e,a=o(),{meeting:{userId:c}}=a;if(t&&t!==c)return Bfe(t,!1,e.store,r);{const{audio:{isSharingAudio:l,isShareAudioEnabled:u,isShareAudioMuted:d},share:{status:h}}=a;if(!u)return Promise.reject({type:lt,reason:"Cannot unmute sharing audio when sharing audio is not enable"});if(d===!1)return Promise.resolve("");{i.muteShareAudio(!1);let f=Promise.resolve();return l===!1&&h===Hr.Sharing&&(f=eG(r,i,a).then(p=>{p.forEach(g=>s(g))})),c3(r,c,!1,a),Promise.all([Un({event:ql,operations:[st(p=>p.bShareAudioOn!==void 0),Ur(1)]},p=>p.bShareAudioOn===!0),f]).then(()=>(s(y6(!1)),l===!1&&h===Hr.Sharing&&(s(U2(!0)),me(j2,{state:"on"})),""))}}})(this[pt],n)}subscribeAudioStatisticData(n){return(async(e,t)=>{const{mediaAgent:r,store:{getState:i}}=e,o=i(),s=mn(o),a=!t||t.decode,c=!t||t.encode;if(!s)return Promise.reject({type:lt,reason:"Call this function after the 'join' method resolved."});{var l;const{encodeInitStatus:u,decodeInitStatus:d}=tG(o,s);(ra()?Qte(o,!((l=o.audio.customizeAudioOption)!==null&&l!==void 0&&l.speakerOnly)):Tc("audio",u,d)).subscribe(h=>{let[f,p]=h;f&&p&&(a&&r.subscribeToQos([Ya.AudioDecode],l0),c&&r.subscribeToQos([Ya.AudioEncode],l0))})}return""})(this[pt],n)}unsubscribeAudioStatisticData(n){return(async(e,t)=>{const{mediaAgent:r,store:{dispatch:i}}=e,o=!t||t.decode,s=!t||t.encode;return o&&(r.unsubscribeFromQos([Ya.AudioDecode]),i(b6(a6))),s&&(r.unsubscribeFromQos([Ya.AudioEncode]),i(S6(a6))),null})(this[pt],n)}enableBackgroundNoiseSuppression(n){return((e,t)=>{const{mediaAgent:r,store:{getState:i,dispatch:o}}=e,{audio:{isBackgroundNoiseSuppression:s,originalSound:a}}=i();let c=t;return c===!!s||(c&&!Che(ra())?(console.warn("Background noise suppression requires SharedArrayBuffer and is only supported on desktop browser"),c=!1):(c&&a&&(console.warn("Enabling noise suppression will disable original sound."),o(aK(!1))),o(iK(c)),r.changeAudioProfile(QK(i())))),Promise.resolve("")})(this[pt],n)}enableSyncButtonsOnHeadset(n){return((e,t)=>{const{mediaAgent:r,store:{getState:i,dispatch:o}}=e,s=i(),{audio:{isHIDEnabled:a,microphoneDevicesList:c,activeMicrophone:l}}=s;if(t===!!a)return Promise.resolve("");{const d=mn(s);var u;return d?(t&&!Ehe()?console.warn("Sync buttons on headset is not supported on the current platform"):(r.enableSyncButtonsOnHeadset(t,(u=c.find(h=>h.deviceId===l))===null||u===void 0?void 0:u.label,d.muted),o(lTe(t))),Promise.resolve("")):Promise.reject({type:lt,reason:"Please call `enableSyncButtonsOnHeadset` method after the `join` has been resolved"})}})(this[pt],n)}enableOriginalSound(n){return((e,t)=>{const{mediaAgent:r,store:{getState:i,dispatch:o}}=e,{audio:{isBackgroundNoiseSuppression:s,originalSound:a}}=i(),c=t;return c===a||typeof t=="object"&&eD(t,a)||(typeof c!="object"||(c==null?void 0:c.stereo)!==!0||xhe()||(console.warn("Cannot enable stereo audio on current platform due to the browser limitation"),c.stereo=!1),s&&c&&(console.warn("Enabling original sound will disable background noise suppression."),o(iK(!1))),o(aK(c)),r.changeAudioProfile(QK(i()))),Promise.resolve("")})(this[pt],n)}callCRCDevice(n,e){return((t,r,i)=>{const{rwgAgent:o,store:{dispatch:s,getState:a}}=t,{seq:c}=o.inviteCRCDevice(r,i);return s(dTe({sequence:c,ip:r,protocol:i})),pm(yb.crcCallOut).then(()=>{var l;const{audio:{crcDevice:u}}=a();return(l=u.find(d=>d.ip===r&&d.protocol===i&&d.sequence===c))===null||l===void 0?void 0:l.uuid})})(this[pt],n,e)}cancelCallCRCDevice(n,e){return((t,r,i)=>{const{rwgAgent:o,store:{getState:s}}=t,{audio:{crcDevice:a}}=s(),c=a.find(l=>l.ip===r&&l.protocol===i);return c&&c.returnCode===Np.Ringing?(o.cancelInviteCRCDevice(c.transId),Promise.resolve("")):Promise.reject({type:lt,reason:"Cannot cancel call out "})})(this[pt],n,e)}muteAllAudio(){return(n=>{const{rwgAgent:e}=n;return e.audioMuteAll(!0),NK("bMutedAll",!0)})(this[pt])}unmuteAllAudio(){return(n=>{const{rwgAgent:e}=n;return e.audioMuteAll(!1),NK("bMutedAll",!1)})(this[pt])}getMicList(){return(n=>{let{store:{getState:e}}=n;const t=e();return t.audio?[...t.audio.microphoneDevicesList]:[]})(this[pt])}getSpeakerList(){return(n=>{let{store:{getState:e}}=n;const t=e();return t.audio?[...t.audio.speakerDevicesList]:[]})(this[pt])}getAudioState(n){return((e,t)=>{let{store:{getState:r}}=e;const i=r(),{meeting:{isWebinar:o}}=i;let s=null;return t==null?s=mn(i):(s=i.participants.attendeesList.find(a=>a.userId===t),o&&!s&&(s=i.participants.xmppAttendeeList.find(a=>a.userId===t))),s?s.audio:null})(this[pt],n)}isAudioMuted(n){return((e,t)=>{let{store:{getState:r}}=e;const i=r(),{meeting:{isWebinar:o}}=i;let s=null;return t===void 0?s=mn(i):(s=i.participants.attendeesList.find(a=>a.userId===t),o&&!s&&(s=i.participants.xmppAttendeeList.find(a=>a.userId===t))),!!s&&!!s.muted})(this[pt],n)}getActiveMicrophone(){return(n=>{let{store:{getState:e}}=n;const t=e();return t.audio?t.audio.activeMicrophone:null})(this[pt])}getActiveSpeaker(){return(n=>{let{store:{getState:e}}=n;const t=e();return t.audio?t.audio.activeSpeaker:null})(this[pt])}isSupportCallOut(){return(n=>{let{store:{getState:e}}=n;const{meeting:{isSupportCallOut:t,callOutCountry:r}}=e();return t&&Array.isArray(r)&&(r==null?void 0:r.length)>0})(this[pt])}getDialOutStatus(){return(n=>{let{store:{getState:e}}=n;const{audio:t}=e();return t==null?void 0:t.dialout[t.dialout.length-1].returnCode})(this[pt])}getDialOutCountries(){return(n=>{let{store:{getState:e}}=n;const{meeting:{callOutCountry:t}}=e();return Array.isArray(t)?t:[]})(this[pt])}getShareAudioStatus(){return(n=>{let{store:{getState:e}}=n;const{audio:{isShareAudioEnabled:t,isShareAudioMuted:r,isSharingAudio:i}}=e();return{isShareAudioEnabled:t,isShareAudioMuted:r,isSharingAudio:i}})(this[pt])}isOthersShareAudioMutedLocally(n){return((e,t)=>{var r;let{store:{getState:i}}=e;const{audio:{localShareAudioUserMutedList:o}}=i();return(r=o.find(s=>s.userId===t))===null||r===void 0?void 0:r.muted})(this[pt],n)}getAudioStatisticData(){return(n=>{let{store:{getState:e}}=n;const{audio:{statistic:t}}=e();return{...t}})(this[pt])}getDialInInfo(){return(n=>{let{store:{getState:e}}=n;const{meeting:{meetingNumber:t,tollNumbers:r,participantID:i,h323Password:o}}=e();return r===void 0?null:{meetingId:t,participantId:i,password:o||"",tollNumbers:r.map(s=>({...s}))}})(this[pt])}isSupportMicrophoneAndShareAudioSimultaneously(){return jp()}startVideo(n){return((e,t)=>{const{store:{getState:r,dispatch:i},mediaAgent:o}=e,s=r(),{media:{videoDecodeStatus:a,videoEncodeStatus:c,enforceVirtualBackground:l},video:{isCaptureCameraLoading:u,isCurrentUserStartedVideo:d,isVideoMuted:h}}=s,f=t?{...t}:void 0;if(d)return Promise.reject({type:lt,reason:"Video is started"});if(u)return Promise.reject({type:lt,reason:"Camera is starting,please wait."});if(h&&!Td(s))return Promise.reject({type:lt,reason:"Video is muted by the host"});if(G_(l)&&!((f==null?void 0:f.videoElement)instanceof HTMLVideoElement)){console.warn('Rendering self-view on Chromium browser, Android browser without SharedArrayBuffer or iOS browser requires video tag, Please pass a video element instead of a canvas element in the "renderVideo" method');let p=document.body.querySelector(`#${rB}`);if(!p){p=document.createElement("video");const g=tn.isSafari||tn.isIOSMobile?"position:fixed;top:-10000px;left:-10000px":"display:none";p.setAttribute("style",g),p.muted=!0,p.playsInline=!0,p.autoplay=!0,p.id=rB,document.body.appendChild(p)}f&&Object.assign(f,{videoElement:p})}return!V6(l)&&f!=null&&f.virtualBackground?Promise.reject({type:Jn,reason:"Virtual background only compatible with Chrome and Edge with SharedArrayBuffer enabled."}):(i(lP(!0)),Tc("video",c,a).subscribe(p=>{let[g]=p;if(g){const m=r(),{video:{activeCamera:v,isSupportHDVideo:b,virtualBackground:{imageSrc:S},mask:{imageSrc:E}}}=m,{cameraId:w=v,captureWidth:C=0,captureHeight:I=0,mirrored:T,hd:D,fullHd:O,virtualBackground:M,mask:R}=f||{};T&&o.mirrorVideo(T),(D||O)&&(console.log("HD support is currently limited, and comes with a number of restrictions and limitations. Please visit https://developers.zoom.us/docs/video-sdk/web/video/#720p-video for more details"),b&&zn.isCompatibleHardwareForEncode()&&zn.isSupportVideoEncodeHardwareAcceleration().then(j=>{j&&(o.enableHardwareAccelerationForVideoEncode(!0),i(Ow({encode:j})))}),b||console.warn("Cannot capture HD video due to either account restriction and/or hardware limitation"));const A=M||M===void 0&&!!S&&R===void 0,k=R||R===void 0&&!!E;let L=Promise.resolve({});if(A){const j=M||{imageUrl:void 0,cropped:void 0};L=G4({...j,captureWidth:C,captureHeight:I,cameraId:w,hd:D},o,m).then(()=>j)}else if(k){const j=R||{imageUrl:void 0,cropped:void 0,clip:void 0,rootWidth:void 0,rootHeight:void 0};j.rootWidth||Object.assign(j,{rootWidth:1280}),j.rootHeight||Object.assign(j,{rootHeight:720}),L=Z4({...j,captureWidth:C,captureHeight:I,cameraId:w,hd:D},o,m).then(()=>j)}f!=null&&f.mediaFile&&!zn.isSupportMediaPlaybackAsVideoInput()&&(console.warn("Cannot use media file as video input due to the browser limitation."),Object.assign(f,{mediaFile:void 0})),L.then(j=>Dde("video",r()).then(()=>j)).then(j=>{KRe(o,m,f).forEach(N=>{i(N)}),A?i(F4(j)):k&&i(j4(j))}).catch(j=>{i(lP(!1)),me(Ske,{reason:j})})}else i(lP(!1))}),pm(vde.startCaptureVideo).then(()=>{i(k6(!1)),i(P6(!1))}).finally(()=>{i(lP(!1))}))})(this[pt],n)}stopVideo(){return(n=>{const{store:{getState:e},mediaAgent:t}=n,{video:{isCaptureCameraLoading:r,isCurrentUserStartedVideo:i,isUsingMediaPlayback:o}}=e();return r?Promise.reject({type:lt,reason:"Camera is starting,please wait."}):i?(t.stopCaptureVideo(),o&&Tu.getInstance().stopVideoElement(),Un(oS,s=>(s==null?void 0:s.failed)!==!0)):Promise.reject({type:lt,reason:"camera is closed"})})(this[pt])}switchCamera(n){return((e,t)=>{const{store:{getState:r,dispatch:i},mediaAgent:o}=e,s=r(),{video:{cameraDevicesList:a,isCurrentUserStartedVideo:c,virtualBackground:l,mask:u,mediaPlaybackFile:d,isUsingMediaPlayback:h,customizedVideoOption:f}}=s;if(typeof t=="string"&&!WRe(t,a))return Promise.reject({type:Jn,reason:"Cannot find cameraDeviceId in camera devices list."});if(c||l!=null&&l.isVBConfigured||u.isMaskConfigured){if(typeof t=="string"){const{captureWidth:p,captureHeight:g}=vne(f);o.changeCamera(t,S7.includes(t),{width:p,height:g}),i(bK(void 0)),Tu.getInstance().stopVideoElement()}else if(t&&(!h||(d==null?void 0:d.url)!==t.url)){const p=Tu.getInstance();p.setVideoElement(t).then(()=>{o.changeCamera(p.videoElement),i(bK(t))})}return pm(vde.switchCameraVideo).then(()=>{i(k6(!1)),i(P6(!1))})}return Promise.resolve()})(this[pt],n)}renderVideo(n,e,t,r,i,o,s,a,c){return((l,u,d,h,f,p,g,m,v,b)=>{const{store:{getState:S,dispatch:E},mediaAgent:w,rwgAgent:C}=l,I=S(),{meeting:{userId:T},media:{enforceMultipleVideos:D,enforceVirtualBackground:O,disableRenderLimits:M},video:{subscribedVideoList:R,renderedVideoList:A}}=I,k=RC(!!D,M),L=G_(O)&&d===T;if(u instanceof HTMLCanvasElement&&!R.includes(d)&&R.length>=k&&new Set(A.map(B=>B.canvasId)).has(u.id))return Promise.reject({type:lt,reason:`subscribe video counts greater than maximum size (${k})`});if(Q4(I).findIndex(B=>B.userId===d)===-1)return Promise.reject({type:Jn,reason:"user is not send video"});if(u.id||(u.id=$m("__ZOOM_SDK_VIDEO_CANVAS_@__")),L){if(u instanceof HTMLVideoElement){u.playsInline=!0,u.muted=!0,u.autoplay=!0,tn.isIOSMobile&&(w.switchCanvasForVideoCapture(u),E(_K())),w.renderVideo(u,d,v||zb,h,f,p,g,m,!0,b||"",!1),E(L4(d)),E(XTe(u.id));const B=document.querySelector(`#${rB}`);return B&&B.remove(),Promise.resolve("")}return Promise.reject({type:Jn,reason:"You must use a <video> element to render self video for Chromium browser, Android browser without SharedArrayBuffer or iOS browser "})}const j=!!b,{media:{videoDecodeStatus:N}}=I;return Tc("video","success",N).subscribe(async B=>{let[U,K]=B;if(K){const{video:{ensuredCanvas:z,renderedVideoList:G}}=S();let te=u;z.includes(u.id)||(te=V4(u),E(zTe(u.id)));const ie=d===T,[Q,ge]=Yhe(d,m,S()),_e=v||zb,Se=await async function(se,ee){const{video:{prefetchedVideo:Y}}=ee;return(Y==null?void 0:Y.userId)!==se||Y.loaded?"":mc(Ad(Mi(kke,1),js(1e3).pipe(Lu(""))))}(d,S());G.some(se=>se.userId===d&&se.key===_e&&se.canvasId===te.id)||w.renderVideo(te,d,_e,h,f,p,g,ge,ie,b||"",j),d!==T&&C.subscribeVideo(d,ge,!1),R.includes(d)||E(L4(d)),Se&&E(LC(void 0)),E($C({userId:d,key:_e,canvasId:te.id,videoQuality:Q,aspectRatio:f?h/f:0}))}}),N==="failed"?Promise.reject({type:Nf,reason:"Video  decode status is failed"}):Promise.resolve("")})(this[pt],n,e,t,r,i,o,s,a,c)}stopRenderVideo(n,e,t,r){let i=arguments.length>4&&arguments[4]!==void 0&&arguments[4],o=arguments.length>5?arguments[5]:void 0;return function(s,a,c,l,u){let d=arguments.length>5&&arguments[5]!==void 0&&arguments[5],h=arguments.length>6?arguments[6]:void 0;const{store:{getState:f,dispatch:p},mediaAgent:g,rwgAgent:m}=s,v=f(),{video:{subscribedVideoList:b,renderedVideoList:S},meeting:{userId:E},media:{enforceVirtualBackground:w}}=v;if(b.includes(c)){const C=l||zb;if(G_(w)&&c===E&&a instanceof HTMLVideoElement)return a.pause(),p(N4(c)),p(_K(a.id)),Promise.resolve("");if(S.find(I=>I.userId===c&&I.key===C&&I.canvasId===a.id)&&(g.stopRenderVideo(a.id,c,C,LB(u),d),S.filter(I=>I.userId===c).length==1&&(c!==E&&m.unsubscribeVideo(c),p(N4(c))),p(T6({userId:c,key:C,canvasId:a.id}))),h&&E!==h){const{video:{subscribedVideoList:I,prefetchedVideo:T}}=f();Q4(v).find(D=>D.userId===h)&&!I.includes(h)&&(T==null?void 0:T.userId)!==h&&p(LC({userId:h,lastCopy:T}))}}return Promise.resolve("")}(this[pt],n,e,t,r,i,o)}updateVideoCanvasDimension(n,e,t){return((r,i,o,s)=>{const{mediaAgent:a}=r;return o>=0&&s>=0&&a.updateRenderedVideoCanvasDimension(i,o,s),Promise.resolve("")})(this[pt],n,e,t)}adjustRenderedVideoPosition(n,e,t,r,i,o,s){return((a,c,l,u,d,h,f,p)=>{const{store:{getState:g,dispatch:m},mediaAgent:v}=a,{video:{subscribedVideoList:b}}=g();if(b.includes(l)){if(c instanceof HTMLVideoElement)return Promise.resolve("");const S=p||zb;v.adjustRenderedVideoPosition(c.id,l,S,h,f,u,d,LB("#000")),m($C({userId:l,key:S,canvasId:c.id,aspectRatio:d?u/d:0}))}else console.warn("Cannot adjust the size or position of the video as the video has not been rendered yet.");return Promise.resolve("")})(this[pt],n,e,t,r,i,o,s)}clearVideoCanvas(n,e){return((t,r,i)=>{const{mediaAgent:o}=t;return o.clearVideoCanvas(r.id,LB(i)),Promise.resolve("")})(this[pt],n,e)}mirrorVideo(n){return((e,t)=>{const{store:{getState:r,dispatch:i},mediaAgent:o}=e,{media:{enforceVirtualBackground:s},video:{isCurrentUserStartedVideo:a,virtualBackground:c,selfPreviewVideoList:l,customizedVideoOption:u,videoAttachments:d,isMirrored:h},meeting:{userId:f}}=r();if(h===t)return Promise.resolve("");if(a||c!=null&&c.isVBConfigured){if(G_(s)){const p=[];l.length>0&&l.forEach(g=>{p.push(document.getElementById(g))}),u!=null&&u.videoElement&&p.push(document.querySelector(u==null?void 0:u.videoElement)),d&&d[`${f}`]&&d[`${f}`].forEach(g=>{p.push(g.render.el)}),p.filter(g=>!!g).forEach(g=>{g&&qRe(g,t)})}else o.mirrorVideo(t);i(ZTe(t))}return Promise.resolve("")})(this[pt],n)}enableHardwareAcceleration(n){return((e,t)=>{const{store:{getState:r,dispatch:i},mediaAgent:o}=e,{video:{isSupportHDVideo:s}}=r();if(typeof t=="boolean"||t.decode!==void 0){const a=typeof t=="boolean"?t:!!t.decode;return a?zn.isSupportVideoDecodeHardwareAcceleration().then(c=>(c&&o.enableHardwareAccelerationForVideoDecode(c),i(Ow({decode:c})),c)):(o.enableHardwareAccelerationForVideoDecode(a),i(Ow({decode:a})),Promise.resolve(!0))}if(typeof t=="boolean"||t.encode!==void 0){const a=typeof t=="boolean"?t:!!t.encode;if(s){if(!a)return o.enableHardwareAccelerationForVideoEncode(!1),i(Ow({encode:!1})),Promise.resolve(!0);if(zn.isCompatibleHardwareForEncode())return zn.isSupportVideoEncodeHardwareAcceleration().then(c=>(c&&o.enableHardwareAccelerationForVideoEncode(c),i(Ow({encode:c})),c));console.warn("Can not turn on hardware acceleration with your graphic card due to the technical limitation")}else typeof t!="boolean"&&t!=null&&t.encode&&console.warn("Can not use the hardware acceleration for video encoding due to the account restriction")}return Promise.resolve(!1)})(this[pt],n)}subscribeVideoStatisticData(n){return(async(e,t)=>{const{mediaAgent:r,store:{getState:i,dispatch:o}}=e,{media:{videoDecodeStatus:s,videoEncodeStatus:a},video:{subscriptionStatus:c}}=i(),l=!t||t.decode,u=!t||t.encode;return Tc("video",a,s).subscribe(d=>{let[h,f]=d;const p={};l&&f&&!c.decode&&(r.subscribeToQos([Ya.VideoDecode],l0),Object.assign(p,{decode:!0})),u&&h&&!c.encode&&(r.subscribeToQos([Ya.VideoEncode],l0),Object.assign(p,{encode:!0})),t!=null&&t.detailed&&f&&!c.detailed&&(r.enableVideoObserver(!0),Object.assign(p,{detailed:!0})),o(SK(p))}),null})(this[pt],n)}unsubscribeVideoStatisticData(n){return(async(e,t)=>{const{mediaAgent:r,store:{dispatch:i}}=e,o=!t||t.decode,s=!t||t.encode,a={};return o&&(r.unsubscribeFromQos([Ya.VideoDecode]),i(R6($0)),Object.assign(a,{decode:!1})),s&&(r.unsubscribeFromQos([Ya.VideoEncode]),i(A6($0)),Object.assign(a,{encode:!1})),t!=null&&t.detailed&&(r.enableVideoObserver(!1),Object.assign(a,{detailed:!1})),i(SK(a)),null})(this[pt],n)}previewVirtualBackground(n,e,t,r){return((i,o,s,a,c)=>{const{store:{getState:l,dispatch:u},mediaAgent:d}=i,h=l();return G4({imageUrl:s,cropped:a,cameraId:c},d,h,o).then(f=>(typeof f=="object"&&f!=null&&f.type&&u(f),u(F4({imageUrl:s,cropped:a})),!0)).catch(f=>Promise.reject({type:lt,reason:f}))})(this[pt],n,e,t,r)}updateVirtualBackgroundImage(n,e){return((t,r,i)=>{const{store:{getState:o,dispatch:s},mediaAgent:a}=t,c=o(),{video:{virtualBackground:{imageSrc:l,cropped:u},backgroundMode:d}}=c;return r===l&&i===u?Promise.resolve(!0):d===Yf.Mask?Promise.reject({type:lt,reason:"Cannot update virtual background in the mask mode"}):G4({imageUrl:r,cropped:i},a,c).then(h=>(typeof h=="object"&&h!=null&&h.type&&s(h),s(F4({imageUrl:r,cropped:i})),!0)).catch(h=>Promise.reject({type:lt,reason:h}))})(this[pt],n,e)}stopPreviewVirtualBackground(){return(n=>{const{store:{getState:e},mediaAgent:t}=n,{video:{virtualBackground:{isVBConfigured:r}}}=e();return r?(t.stopVirtualBackgroundSetting(),Promise.resolve(!0)):Promise.reject({type:lt,reason:"Cannot stop preview virtual background before start"})})(this[pt])}previewVideoMask(n,e){return((t,r,i)=>{const{store:{getState:o,dispatch:s},mediaAgent:a}=t,c=o();return i.rootWidth&&i.rootHeight||Object.assign(i,{rootWidth:r.width,rootHeight:r.height}),Z4(i,a,c,r).then(l=>(typeof l=="object"&&l!=null&&l.type&&s(l),s(j4(i)),!0)).catch(l=>Promise.reject({type:lt,reason:l}))})(this[pt],n,e)}updateVideoMask(n){return((e,t)=>{const{store:{getState:r,dispatch:i},mediaAgent:o}=e,s=r(),{video:{mask:a,backgroundMode:c}}=s,{isMaskConfigured:l}=a;if(c===Yf.VirtualBackground)return Promise.reject({type:lt,reason:"Cannot update mask in the virtual background mode"});if(l){const u={...t};return["imageUrl","cropped","clip","rootHeight","rootWidth"].forEach(d=>{(t==null?void 0:t[d])===void 0&&(d==="imageUrl"?Object.assign(u,{imageUrl:a.imageSrc}):Object.assign(u,{[`${d}`]:a[d]}))}),Z4(u,o,s).then(d=>(typeof d=="object"&&d!=null&&d.type&&i(d),i(j4(u)),!0)).catch(d=>Promise.reject({type:lt,reason:d}))}return Promise.reject({type:lt,reason:"Cannot update mask"})})(this[pt],n)}stopPreviewVideoMask(){return(n=>{const{store:{getState:e},mediaAgent:t}=n,{video:{mask:{isMaskConfigured:r}}}=e();return r?(t.stopMaskSetting(),Promise.resolve(!0)):Promise.reject({type:lt,reason:"Cannot stop preview mask before start"})})(this[pt])}requestFarEndCameraControl(n){return((e,t)=>{const{store:{getState:r},rwgAgent:i}=e,o=r(),{meeting:{userId:s},video:{farEndCameraControlStatus:{controlledUserList:a}}}=o;return s===t?Promise.reject({type:lt,reason:'Using "stream.controlCamera" method to control self camera'}):XB(o).findIndex(c=>c.userId===t)!==-1?(a.includes(t)||i.sendFarEndCameraControl(ul.Request,t),Promise.resolve("")):Promise.reject({type:Jn,reason:"Cannot request control camera with video off"})})(this[pt],n)}approveFarEndCameraControl(n){return((e,t)=>{const{store:{getState:r,dispatch:i},rwgAgent:o}=e,{video:{currentCameraControlStatus:{isRequested:s,isInControl:a,controllingUserId:c},ptz:l,activeCamera:u}}=r();if(s){if(a&&(!c||t===c))return Promise.resolve("");o.sendFarEndCameraControl(ul.Approve,t);const d=l==null?void 0:l[u];return d!==void 0&&o.sendCameraAblity({pan:!!d.pan,tilt:!!d.tilt,zoom:!!d.zoom}),i(O6(!1)),i(M6({isInControl:!0,userId:t})),me(d6,{isControlled:!0,userId:t}),Promise.resolve("")}return Promise.reject({type:lt,reason:"Cannot approve before request"})})(this[pt],n)}declineFarEndCameraControl(n){return((e,t)=>{const{store:{getState:r,dispatch:i},rwgAgent:o}=e,{video:{currentCameraControlStatus:{isInControl:s,isRequested:a}}}=r();return a||s?(o.sendFarEndCameraControl(ul.Decline,t),i(O6(!1)),i(M6({isInControl:!1,userId:0})),me(d6,{isControlled:!1}),Promise.resolve("")):Promise.reject({type:lt,reason:"Cannot decline before request"})})(this[pt],n)}giveUpFarEndCameraControl(n){return((e,t)=>{const{store:{getState:r,dispatch:i},rwgAgent:o}=e,{video:{farEndCameraControlStatus:{controlledUserList:s}}}=r();return s.includes(t)?(o.sendFarEndCameraControl(ul.GiveUp,t),i($6(t)),Promise.resolve("")):Promise.reject({type:lt,reason:"Cannot give up control befire aquired"})})(this[pt],n)}controlCamera(n){return((e,t)=>{const{store:{getState:r,dispatch:i},mediaAgent:o}=e,{video:{isCurrentUserStartedVideo:s,ptz:a,activeCamera:c}}=r();if(s){const{cmd:l,range:u,reset:d}=t,h=a[c];if(h){const f=yne(h)||{},{key:p,range:g}=ZRe(l,u);if(h[p])return Object.assign(f,{[p]:d?0:GRe(h[p].capability,h[p].value,g)}),o.movePTZCamera(f).then(()=>{i(Ute({constraints:f,deviceId:c}))}).catch(m=>Promise.reject({type:lt,reason:m}))}return Promise.resolve("")}return Promise.reject({type:lt,reason:"Cannot control the camera before it's started"})})(this[pt],n)}controlFarEndCamera(n){return((e,t)=>{const{store:{getState:r,dispatch:i},rwgAgent:o}=e,s=r(),{video:{farEndCameraControlStatus:{controlledUserList:a,isControlling:c}}}=s,{userId:l,cmd:u,range:d}=t;if(c)return Promise.reject({type:lt,reason:"Cannot send new command while the previous control is not done"});if(a.includes(l)){if(u===u0.SwitchCamera)return o.sendFarEndCameraControl(ul.SwitchCamera,l,u0.SwitchCamera),Promise.resolve("");{const h=XB(s).find(f=>f.userId===l);if(h==null||!h.nFECC)return Promise.reject({type:lt,reason:"The far end camera does not support PTZ"});if(d&&d>0){const f=d/100*1e4;return o.sendFarEndCameraControl(ul.StartControl,l,u),i(yK(!0)),Wk(200).pipe(qp(js(f-100))).subscribe(()=>{o.sendFarEndCameraControl(ul.ContinueControl,l,u)}),mc(js(f).pipe(en(()=>{o.sendFarEndCameraControl(ul.StopControl,l,u),i(yK(!1))}))).then(()=>"")}return Promise.reject({type:Jn,reason:"Range cannot be negative or 0"})}}return Promise.reject({type:lt,reason:"Cannot control before request granted"})})(this[pt],n)}attachVideo(n,e,t){return((r,i,o,s)=>{const{store:{getState:a,dispatch:c},rwgAgent:l}=r,u=a(),{meeting:{userId:d},media:{enforceMultipleVideos:h,alternativeNameForVideoPlayer:f,enforceVirtualBackground:p,disableRenderLimits:g},video:{videoAttachments:m,subscribedVideoList:v}}=u,b=RC(!!h,g);if(b>1&&v.length>b)throw Promise.reject({type:lt,reason:`subscribe video counts greater than maximum size (${b})`});if(Q4(u).findIndex(O=>O.userId===i)===-1)return Promise.reject({type:Jn,reason:"user is not send video"});const{media:{videoDecodeStatus:S}}=u;let E;const w=f??"video-player";if(s){var C,I,T;if(typeof s=="string"){if(E=document.querySelector(s),!E)return Promise.reject({type:"INVALID_PARAMETERS",reason:"Cannot find the element"})}else E=s;if(((C=E)===null||C===void 0||(I=C.tagName)===null||I===void 0?void 0:I.toUpperCase())!==w.toUpperCase())return Promise.reject({type:"INVALID_PARAMETERS",reason:"Invalid element type"});const O=Number((T=E.getAttribute("node-id"))!==null&&T!==void 0?T:"0");if(O!==i&&G_(p)&&[O,i].includes(d)){var D;const M=document.createElement(w);for(const R of E.attributes)M.setAttribute(R.name,R.value);O&&(E.setAttribute("node-id","0"),c(B4({userId:O,element:E}))),(D=E.parentElement)===null||D===void 0||D.replaceChild(M,E),E=M}}else E=document.createElement(w);return Tc("video","success",S).subscribe(async O=>{let[M,R]=O;if(R){const[k,L]=Yhe(i,o,a()),j=m[`${i}`];var A;E&&j&&j.findIndex(N=>N===E)!==-1?E.setAttribute("video-quality",`${L}`):(A=E)===null||A===void 0||A.setAttribute("node-id",`${i}`),c(WTe({userId:i,element:E})),i!==d&&l.subscribeVideo(i,L,!1),v.includes(i)||c(L4(i)),c($C({userId:i,key:zb,canvasId:KP,videoQuality:k,aspectRatio:16/9}))}}),Promise.resolve(E)})(this[pt],n,e,t)}detachVideo(n,e){return((t,r,i)=>{const{store:{getState:o,dispatch:s},rwgAgent:a}=t,c=o(),{video:{subscribedVideoList:l,videoAttachments:u},meeting:{userId:d},media:{alternativeNameForVideoPlayer:h}}=c;if(l.includes(r)){let m;const v=h??"video-player";var f,p;i&&(m=typeof i=="string"?document.querySelector(i):i,((f=m)===null||f===void 0||(p=f.tagName)===null||p===void 0?void 0:p.toUpperCase())!==v.toUpperCase()&&(m=void 0));const b=u[`${r}`];let S;if(b&&b.length!==0){var g;m?b.findIndex(C=>C===m)!==-1?(S=m,S.setAttribute("node-id","0"),s(B4({userId:r,element:S}))):console.warn(`${i} has not been attached with userID:${r}`):(S=[...b],S.forEach(C=>{C.setAttribute("node-id","0")}),s(B4({userId:r,element:S})));const{video:{videoAttachments:E,renderedVideoList:w}}=o();((g=E[`${r}`])===null||g===void 0?void 0:g.length)===0&&(w.filter(C=>C.userId===r&&C.canvasId!==KP).length===0&&(r!==d&&a.unsubscribeVideo(r),s(N4(r))),s(T6({userId:r,key:zb,canvasId:KP})))}else console.warn(`UserId:${r} has not been attached.`);return Promise.resolve(S)}return Promise.resolve(void 0)})(this[pt],n,e)}isCapturingVideo(){return(n=>{const{store:{getState:e}}=n,t=e();return!!t.video&&t.video.isCurrentUserStartedVideo})(this[pt])}isCameraTaken(){return(n=>{const{store:{getState:e}}=n,t=e();return!!t.video&&t.video.isCameraTaken})(this[pt])}isCaptureForbidden(){return(n=>{const{store:{getState:e}}=n,t=e();return!!t.video&&t.video.isCaptureForbidden})(this[pt])}getCameraList(){return(n=>{const{store:{getState:e}}=n,t=e();if(!t.video)return[];const{video:{cameraDevicesList:r}}=t;return r.map(i=>Object.assign({},i))})(this[pt])}getActiveCamera(){return(n=>{const{store:{getState:e}}=n,t=e();return t.video?t.video.activeCamera:""})(this[pt])}getActiveVideoId(){return(n=>{const{store:{getState:e}}=n,t=e();return t.video?t.video.activeVideoId:0})(this[pt])}getVideoMaxQuality(){return(n=>{const{store:{getState:e}}=n,t=e();return t.video?t.video.receivedVideoMaxQuality:Ph.Video_90P})(this[pt])}getReceivedVideoDimension(){return(n=>{const{store:{getState:e}}=n,t=e();return t.video?t.video.receivedVideoDimension:null})(this[pt])}getCapturedVideoResolution(){return(n=>{const{store:{getState:e}}=n;return{...e().video.capturedVideoDimension}})(this[pt])}isSupportMultipleVideos(){return(n=>{const{store:{getState:e}}=n,{media:{enforceMultipleVideos:t}}=e();return v7()||!!t&&!window.crossOriginIsolated&&RC(t)>1})(this[pt])}isSupportHDVideo(){return(n=>{var e;const{store:{getState:t}}=n;return(e=t().video)===null||e===void 0?void 0:e.isSupportHDVideo})(this[pt])}getHardwareAccelerationStatus(){return(n=>{var e;const{store:{getState:t}}=n;return(e=t().video)===null||e===void 0?void 0:e.hardwareAcceleration})(this[pt])}getVideoStatisticData(){return(n=>{let{store:{getState:e}}=n;const{video:{statistic:t}}=e();return{...t}})(this[pt])}isSupportVirtualBackground(){return(n=>{const{store:{getState:e}}=n;return V6(e().media.enforceVirtualBackground)})(this[pt])}getVirtualbackgroundStatus(){return(n=>{const{store:{getState:e}}=n;return{...e().video.virtualBackground}})(this[pt])}isRenderSelfViewWithVideoElement(){return G_(this[wo].getState().media.enforceVirtualBackground)}getNetworkQuality(n){return((e,t)=>{var r;const{store:{getState:i}}=e,o=i(),{video:s,meeting:{userId:a}}=o,c=t??a,l=s==null||(r=s.networkQuality)===null||r===void 0?void 0:r[`${c}`];if(l){const u={};return l.uplink&&Object.assign(u,{uplink:l.uplink.level}),l.downlink&&Object.assign(u,{downlink:l.downlink.level}),u}return null})(this[pt],n)}getFarEndCameraPTZCapability(n){return((e,t)=>{const{store:{getState:r}}=e,i=XB(r()).find(o=>o.userId===t);return(i==null?void 0:i.nFECC)!==void 0?XRe(i==null?void 0:i.nFECC):{pan:!1,tilt:!1,zoom:!1}})(this[pt],n)}getCameraPTZCapability(n){return((e,t)=>{const{store:{getState:r}}=e,{video:{ptz:i,activeCamera:o}}=r(),s=i[t??o];return{pan:!(s==null||!s.pan),tilt:!(s==null||!s.tilt),zoom:!(s==null||!s.zoom)}})(this[pt],n)}isBrowserSupportPTZ(){const{pan:n,tilt:e,zoom:t}=zn.getPTZCapability();return n||e||t}getVideoMaskStatus(){return(n=>{var e;const{store:{getState:t}}=n,r=t(),{isMaskConfigured:i,imageSrc:o,...s}=((e=r.video)===null||e===void 0?void 0:e.mask)||{};return{...s,imageUrl:o}})(this[pt])}isVideoMirrored(){return(n=>{const{store:{getState:e}}=n,{video:{isMirrored:t}}=e();return t})(this[pt])}startShareView(n,e,t){return((r,i,o,s)=>{const{store:{getState:a,dispatch:c},mediaAgent:l,rwgAgent:u}=r,{share:{isReceiveSharing:d,isRemoteSharingActive:h,activeNodeId:f,activeSsrc:p,status:g,renderedEnsuredCanvas:m,isReceiveSharingFromMainSession:v},media:{sharingDecodeStatus:b}}=a();if(!i||o!==f)return Promise.reject({type:Jn,reason:""});if(!h||d||g!==Hr.End)return Promise.reject({type:lt,reason:""});i.id||(i.id=$m("__ZOOM_SDK_SHARE_CANVAS_@__"));const S=!!s;return Tc("sharing","success",b).subscribe(E=>{let[,w]=E;if(w){let C=i;m.includes(i.id)||(C=V4(i),c(_Te(i.id))),c(x6(!0)),FC(u,a(),o),l.renderSharing(p,C,S,s,v);const{audio:I}=a();if(I!=null&&I.localShareAudioUserMutedList){const T=I.localShareAudioUserMutedList.find(D=>D.userId===o);T&&l.setSharingAudioVolume(o,T.muted,T.isFromMainSession)}}}),b==="failed"?Promise.reject({type:Nf,reason:""}):Un(h6,E=>!!E,6e4)})(this[pt],n,e,t)}stopShareView(){return(n=>{const{store:{dispatch:e,getState:t},rwgAgent:r,mediaAgent:i}=n,{share:{isReceiveSharing:o,activeNodeId:s},breakoutRoom:a}=t();if(!o)return Promise.resolve("");let c=!1;return(a==null?void 0:a.currentRoom.status)===Cn.InRoom&&a.mainSessionAttendeeList.length>0&&(c=a.mainSessionAttendeeList.findIndex(l=>l.userId===s)>-1),i.stopRenderSharing(),r.unsubscribeSharing(s,c),e(x6(!1)),Promise.resolve("")})(this[pt])}switchShareView(n){return((e,t)=>{const{store:{getState:r,dispatch:i},rwgAgent:o,mediaAgent:s}=e,a=r(),{share:{isReceiveSharing:c,activeNodeId:l,isReceiveSharingFromMainSession:u,remoteControlledUserList:d,isGrabRemoteControl:h},audio:f,breakoutRoom:p}=a;if(!c)return Promise.reject({type:lt});if(t===l)return Promise.resolve("");let g=[];return g=u?p.mainSessionAttendeeList.filter(m=>m.bShareToBORooms&&m.sharerOn):E1(a),g.findIndex(m=>m.userId===l)>-1?(d.includes(l)&&(h&&o.subscribeGrabRemoteControl(l,!1),s.updateRemoteControlProperties({isControllerNow:!1})),o.unsubscribeSharing(l,u),FC(o,r(),t),s.switchSharingSource(t,u),d.includes(t)&&Wde(t,void 0,a,o,s),f==null||f.localShareAudioUserMutedList.forEach(m=>{s.setSharingAudioVolume(t,m.userId!==t||m.muted,m.isFromMainSession)}),i(C6({bStatus:1,activeNodeID:t,ssrc:t})),me(f6,{userId:t}),Promise.resolve("")):Promise.reject({type:Jn,reason:"no matching user id"})})(this[pt],n)}updateSharingCanvasDimension(n,e){return((t,r,i)=>{const{store:{getState:o},mediaAgent:s}=t,a=o(),{share:{isReceiveSharing:c,isGrabRemoteControl:l,remoteControlViewportDomSelector:u}}=a;if(c&&(s.updateRenderedSharingDimension(r,i),l&&u)){const d=document.querySelector(u);s.updateRemoteControlProperties({dimension:d&&MK(d)})}return Promise.resolve("")})(this[pt],n,e)}startShareScreen(n,e){return((t,r,i)=>{var o;const{store:{getState:s,dispatch:a},mediaAgent:c}=t,l=s(),{meeting:{bIbDisableShare:u,meetingOptions:d},share:{sharePrivilege:h,ssrc:f,isChromeExtensionInstalled:p,capturedEnsuredCanvas:g,isReceiveSharingFromMainSession:m},media:{sharingEncodeStatus:v},breakoutRoom:b}=l,{isSupportMediaStreamTrackProcessor:S,isLegacyChrome:E}=tn;if(u)return Promise.reject({type:lt,reason:"information barrier"});if(typeof((o=navigator.mediaDevices)===null||o===void 0?void 0:o.getDisplayMedia)!="function")return Promise.reject({type:lt,reason:"Unable to share your screen due to the technical limitation"});if(m)return Promise.reject({type:lt,reason:"Unable to share your screen while someone is sharing from the main session"});var w;if(S){if(!(r instanceof HTMLVideoElement))return Promise.reject({type:Jn,reason:"Use Video element instead of Canvas element when WebCodecs enabled"})}else if(!(r instanceof HTMLCanvasElement))return Promise.reject({type:Jn,reason:`Expected to accept HTMLCanvasElement, but actual it is ${typeof r=="object"&&r!==null?(w=Object.getPrototypeOf(r))===null||w===void 0?void 0:w.constructor.name:r}`});const C=Td(l);if(i!=null&&i.broadcastToBreakoutRoom){if(!C||(b==null?void 0:b.currentRoom.status)===Cn.InRoom)return C?Promise.reject({type:lt,reason:"Unable to share screen to breakout room when in the room"}):Promise.reject({type:Oc});a(cP(!0))}else a(cP(!1));(i==null?void 0:i.requestReadReceipt)!==void 0&&a(bTe(i==null?void 0:i.requestReadReceipt)),(i==null?void 0:i.optimizedForSharedVideo)!==void 0&&h!==Cd.MultipleShare&&a(E6((i==null?void 0:i.optimizedForSharedVideo)&&zn.isSupportVideoShareSend()));const I=E1(l);if(h===Cd.OnlyHost&&!C)return Promise.reject({type:Oc,reason:"only host can start screen share"});if(h===Cd.HostGrab&&!C&&I.length>0)return Promise.reject({type:Oc,reason:"only host can grab screen share"});const T=mn(l);if((T==null?void 0:T.sharerOn)===!0)return Promise.reject({type:lt,reason:"you have already started screen share."});let D=hi(!0);return E&&!p&&(c.checkChromeSharingExtension(),D=Mi(zq,1)),r.id||(r.id=$m("__ZOOM_SDK_SELF_SHARE_CANVAS_@__")),f7([Tc("sharing",v,"success"),D]).subscribe(O=>{let[M,R]=O;const[A]=M;if(A&&R){g.includes(r.id)||(V4(r),a(STe(r.id)));let k=document.querySelector(`#${pde}`);k&&k.tagName==="VIDEO"||(k=document.createElement("video"),k.id=pde,k.style.display="none",document.body.appendChild(k));const L=i!=null&&i.secondaryCameraId?{cameraId:i.secondaryCameraId,width:i.captureWidth,height:i.captureHeight}:void 0,j=!(i!=null&&i.hideShareAudioOption);c.startDesktopSharing(f,r,k,L,d!=null&&d.isDisableShareAudioIntoBo?j&&!(i!=null&&i.broadcastToBreakoutRoom):j,i==null?void 0:i.displaySurface,i==null?void 0:i.sourceId,i==null?void 0:i.controls),a(w6(void 0)),a(vTe(!!L))}}),new Promise((O,M)=>{Ad(Mi(ql).pipe(st(R=>R.sharerOn!==void 0),Ur(1)),Mi(zq).pipe(st(R=>!R),Ur(1),$n(b1({reason:"required extension",extensionUrl:"https://chrome.google.com/webstore/detail/zoom-scheduler/kgjfgplpablkjnlkjmjdecgdpfankdle"}))),Mi(Zke,1).pipe(ht(R=>b1({reason:R.reason||"user deny screen share"})))).subscribe(R=>{if(R.sharerOn===!0){const{share:{isSharingToBreakoutRoom:A},meeting:{meetingOptions:k}}=s(),L=!(k!=null&&k.isDisableShareAudioIntoBo||!A);c.enableShareAudioToBreakoutRoom(L),O("")}else M({type:Nf})},R=>{M({type:lt,...R})})})})(this[pt],n,e)}stopShareScreen(){return(n=>{const{store:{getState:e,dispatch:t},rwgAgent:r,mediaAgent:i}=n,{share:{status:o},meeting:{userId:s}}=e();return o===Hr.End?Promise.resolve(""):(t(Dd(Hr.End)),r.stopSharing(s),i.stopDesktopSharing(),Un(ql,a=>a.sharerOn===!1))})(this[pt])}pauseShareScreen(){return(n=>{const{store:{getState:e,dispatch:t},rwgAgent:r,mediaAgent:i}=n,{share:{status:o}}=e();return o===Hr.Sharing?(r.pauseSharing(),i.pauseDesktopSharing(),Un(ql,s=>s.sharerPause===!0).then(()=>(t(Dd(Hr.Paused)),""))):Promise.reject({type:lt})})(this[pt])}resumeShareScreen(){return(n=>{const{store:{getState:e,dispatch:t},rwgAgent:r,mediaAgent:i}=n,{share:{status:o}}=e();return o===Hr.Paused?(r.resumeSharing(),i.resumeDesktopSharing(),Un(ql,s=>s.sharerOn===!0&&s.sharerPause===!1).then(()=>(t(Dd(Hr.Sharing)),""))):Promise.reject({type:lt})})(this[pt])}setSharePrivilege(n){return Hfe(this[pt],n)}lockShare(n){return((e,t)=>Hfe(e,t?Cd.OnlyHost:Cd.HostGrab))(this[pt],n)}shareToBreakoutRoom(){return(n=>{const{store:{getState:e,dispatch:t},rwgAgent:r,mediaAgent:i}=n,{meeting:{userId:o},breakoutRoom:s,share:{isSharingToBreakoutRoom:a,status:c}}=e();return c===Hr.End?Promise.reject({type:lt,reason:"Invalid sharing status"}):a?Promise.resolve(""):s.currentRoom.status===Cn.InRoom?Promise.reject({type:lt,reason:"Unable to share screen to breakout room when in the room"}):(r.startShareToBreakoutRoom(o),t(cP(!0)),i.enableShareAudioToBreakoutRoom(!0),Promise.resolve(""))})(this[pt])}stopShareToBreakoutRoom(){return(n=>{const{store:{getState:e,dispatch:t},rwgAgent:r,mediaAgent:i}=n,{meeting:{userId:o},share:{isSharingToBreakoutRoom:s}}=e();return s&&(r.stopShareToBreakoutRoom(o),t(cP(!1)),i.enableShareAudioToBreakoutRoom(!1)),Promise.resolve("")})(this[pt])}muteOthersScreenShare(n){return((e,t)=>{const{store:{getState:r},rwgAgent:i}=e,o=r(),{meeting:{userId:s}}=o,a=E1(o);return t===s?Promise.reject({type:lt,reason:"Cannot mute self share, use 'stopScreenShare' instead"}):a.findIndex(c=>c.userId===t)===-1?Promise.reject({type:Jn,reason:"Target user is not sharing"}):(i.stopSharing(t),Un(dg,c=>c.some(l=>l.userId===t&&l.sharerOn===!1)))})(this[pt],n)}enableOptimizeForSharedVideo(n){return((e,t)=>{const{store:{getState:r,dispatch:i},mediaAgent:o,rwgAgent:s}=e,{share:{status:a,isOptimizedForSharedVideo:c,isSharingToBreakoutRoom:l,sharePrivilege:u},audio:{isSharingAudio:d},meeting:{userId:h}}=r();return a!==Hr.End?c===t?Promise.resolve(""):u!==Cd.MultipleShare?t&&!zn.isSupportVideoShareSend()?Promise.reject({type:lt,reason:"Cannot enable optimize for shared video due to the platform is not supported "}):(s.startSharing(h,{bShareAudio:d,bShareToBO:l,bShareVideo:t}),o.switchSharingMode(t?GP.VideoMode:GP.Normal),Un({event:ql,operations:[st(f=>f.bVideoShare!==void 0),Ur(1)]},f=>f.bVideoShare===t).then(()=>(i(E6(t)),""))):Promise.reject({type:lt,reason:"Cannot enable optimize for shared video when enabling multiple screen shares"}):Promise.reject({type:lt,reason:"Cannot enable optimize for shared video when screen share is not started"})})(this[pt],n)}updateSharedVideoQuality(n){return((e,t)=>{const{store:{getState:r,dispatch:i},rwgAgent:o}=e,s=r(),{share:{shareQuality:a,activeNodeId:c,isReceiveSharing:l}}=s,u=XDe(s);return l&&c!==0?(u&&a!==t&&(FC(o,s,c,t),i(jte(t))),Promise.resolve("")):Promise.reject({type:lt,reason:"Cannot update shared video quality when screen share is not started"})})(this[pt],n)}subscribeShareStatisticData(n){return(async(e,t)=>{const{mediaAgent:r,store:{getState:i}}=e,o=i(),{media:{sharingEncodeStatus:s,sharingDecodeStatus:a}}=i(),c=mn(o),l=!t||t.decode,u=!t||t.encode;if(!c)return Promise.reject({type:lt,reason:"Call this function after the 'join' method resolved."});{const d=ma(c.userRole)||!tn.isSupportSendScreenSharing?"failed":s;Tc("sharing",d,a).subscribe(h=>{let[f,p]=h;l&&p&&r.subscribeToQos([Ya.SharingDecode],l0),u&&f&&r.subscribeToQos([Ya.SharingEncode],l0)})}return""})(this[pt],n)}unsubscribeShareStatisticData(n){return(async(e,t)=>{const{mediaAgent:r,store:{dispatch:i}}=e,o=!t||t.decode,s=!t||t.encode;return o&&(r.unsubscribeFromQos([Ya.SharingDecode]),i(e3($0))),s&&(r.unsubscribeFromQos([Ya.SharingEncode]),i(e3($0))),null})(this[pt],n)}getShareUserList(){return(n=>{const{store:{getState:e}}=n,t=e();if(!t.share)return[];const{share:{isReceiveSharingFromMainSession:r}}=t;if(r){const{breakoutRoom:{mainSessionAttendeeList:i}}=t;return i.filter(o=>o.bShareToBORooms&&(o.sharerOn||o.sharerPause)).map(o=>HC(o))}return E1(t).map(i=>HC(i))})(this[pt])}getActiveShareUserId(){return(n=>{const{store:{getState:e}}=n,t=e();return t.share&&t.share.isRemoteSharingActive?t.share.activeNodeId:0})(this[pt])}isReceiveSharing(){return(n=>{const{store:{getState:e}}=n,t=e();return!!t.share&&t.share.isReceiveSharing})(this[pt])}getShareViewDimension(){return(n=>{const{store:{getState:e}}=n,t=e();if(t.share){if(t.share.status!==Hr.End)return{...t.share.shareDimension};{const{share:{receivedShareDimension:r}}=t;return{width:r.width,height:r.height}}}return null})(this[pt])}getShareStatus(){return(n=>{const{store:{getState:e}}=n,t=e();return t.share?t.share.status:null})(this[pt])}isShareLocked(){return(n=>{const{store:{getState:e}}=n,t=e();return!!t.share&&t.share.sharePrivilege===Cd.OnlyHost})(this[pt])}isReceiveSharingFromMainSession(){return(n=>{const{store:{getState:e}}=n,t=e();return!!t.share&&t.share.isReceiveSharingFromMainSession})(this[pt])}getSharePrivilege(){return(n=>{const{store:{getState:e}}=n,t=e();return t.share?t.share.sharePrivilege:null})(this[pt])}isStartShareScreenWithVideoElement(){return tn.isSupportMediaStreamTrackProcessor}isOptimizeForSharedVideoEnabled(){return(n=>{const{store:{getState:e}}=n,t=e();return!!t.share&&t.share.isOptimizedForSharedVideo})(this[pt])}isSupportOptimizedForSharedVideo(){return zn.isSupportVideoShareSend()}getShareStatisticData(){return(n=>{let{store:{getState:e}}=n;const{share:{statistic:t}}=e();return{...t}})(this[pt])}requestRemoteControl(){return(n=>{const{store:{getState:e},rwgAgent:t}=n,{share:{isReceiveSharing:r,activeNodeId:i,isRemoteControlEnabled:o}}=e();return o?Ufe(n,i)?r?Kb(e())?Promise.reject({type:lt,reason:"Already get the approval"}):(t.sharingRequestRemoteControl(i,!0),new Promise(s=>{Mi(p6,1).subscribe(a=>{s(a)})})):Promise.reject({type:lt,reason:"Cannot request control due to no sharing available"}):Promise.reject({type:Jn}):Promise.reject({type:lt,reason:"Cannot request control due to the feature is not enabled."})})(this[pt])}giveUpRemoteControl(){return(n=>{const{store:{getState:e},rwgAgent:t}=n,{share:{isGrabRemoteControl:r,activeNodeId:i}}=e();return Kb(e())?(r&&t.subscribeGrabRemoteControl(i,!1),t.sharingRequestRemoteControl(i,!1),Un(p6,o=>o===!1)):Promise.reject({type:lt})})(this[pt])}startRemoteControl(n){return(async(e,t)=>{const{store:{getState:r,dispatch:i},mediaAgent:o,rwgAgent:s}=e,{share:{isSDKGrabControl:a,activeNodeId:c}}=r();return Kb(r())?(await Wde(c,t,r(),s,o),t.dataset.zmrvId||t.setAttribute("data-zmrv-id",$m("__ZOOM_SDK_RC_VIEWPORT_DATA_ID_@__")),i(xTe(`${t.tagName}[data-zmrv-id="${t.dataset.zmrvId}"]`)),a?Un(sS,l=>!!l):pm({success:n3e,fail:[r3e]})):Promise.reject({type:lt,reason:"required to be approved"})})(this[pt],n)}grabRemotoControl(){return(n=>{const{store:{getState:e},rwgAgent:t}=n,{share:{isGrabRemoteControl:r,activeNodeId:i}}=e();return Kb(e())?r?Promise.resolve(""):(t.subscribeGrabRemoteControl(i,!0),Un(sS,o=>!!o)):Promise.reject({type:lt,reason:"should be approved before grab"})})(this[pt])}updateRemoteControlViewportDimension(n){return((e,t)=>{const{store:{getState:r},mediaAgent:i}=e;return Kb(r())&&i.updateRemoteControlProperties({dimension:{scaleWidth:t.width,scaleHeight:t.height,srcOffsetX:t.left,srcOffsetY:t.top}}),Promise.resolve("")})(this[pt],n)}approveRemoteControl(n,e){return((t,r,i)=>{const{store:{getState:o,dispatch:s},rwgAgent:a,mediaAgent:c}=t,l=o(),{share:{status:u,isEnableAutoDeleteRcApp:d,remoteControllingSsrc:h,userSsrcMapping:f},meeting:{userId:p}}=l;if(u===Hr.End)return Promise.reject({type:lt,reason:"Cannot approve remote control when sharing is not ongoing."});if(u===Hr.Paused&&(a.resumeSharing(),c.resumeDesktopSharing(),s(Dd(Hr.Sharing))),c.isSharingEntireScreen()){var g,m;h&&!Gl(h,r)&&(Y6(l,a),s(Fp("")));const v=(g=f[`${r}`])!==null&&g!==void 0?g:r,{isMacOS:b}=tn,S=(m=Yi(l).find(E=>Gl(E.userId,v)))===null||m===void 0?void 0:m.displayName;return a.remoteControlConsent(c6.Approve,v,p,{...c.getShareStreamInfo(),platform:tn.isMacOS?"mac":"win",controllerName:S?Jo(S):""},d,b?void 0:i?1:0),s(MC(v)),Un(a3e)}return Promise.reject({type:lt,reason:"Cannot approve remote control when not sharing entire screen."})})(this[pt],n,e)}declineRemoteControl(n){return((e,t)=>{var r;const{store:{getState:i},rwgAgent:o,mediaAgent:s}=e,a=i(),{meeting:{userId:c},share:{isEnableAutoDeleteRcApp:l,userSsrcMapping:u}}=a,d=(r=u[`${t}`])!==null&&r!==void 0?r:t;return o.remoteControlConsent(c6.Decline,d,c,{...s.getShareStreamInfo(),platform:tn.isMacOS?"mac":"win"},l),Promise.resolve("")})(this[pt],n)}stopRemoteControl(){return(n=>{const{store:{getState:e,dispatch:t},rwgAgent:r}=n;return Y6(e(),r),t(Fp("")),t(MC(0)),Promise.resolve("")})(this[pt])}launchRemoteControlApp(n){return((e,t)=>{const{store:{getState:r,dispatch:i}}=e,o=r(),{share:{remoteControlAppLaunchSheme:s}}=o;return s?(i(Fp(t?`${s}&bAutoDelete=1`:s)),i(s1(Qa.Unknown)),Promise.resolve("")):Promise.reject({type:lt,reason:"Cannot launch app due to no permission"})})(this[pt],n)}isRemoteControlEnabled(){return(n=>{var e;const{store:{getState:t}}=n;return!((e=t().share)===null||e===void 0||!e.isRemoteControlEnabled)})(this[pt])}getRemoteControlAppDownloadUrl(){return(n=>{const{store:{getState:e}}=n,t=e();return t.share?t.share.remoteControlAppDownloadUrl:null})(this[pt])}isTargetShareSupportRemoteControl(n){return Ufe(this[pt],n)}isRemotelyControlApproved(){return(n=>{const{store:{getState:e}}=n,t=e();return!!t.share&&Kb(t)})(this[pt])}isControllingUserRemotely(){return(n=>{const{store:{getState:e}}=n,t=e();return!!t.share&&t.share.isGrabRemoteControl})(this[pt])}getRemotelyControllingUser(){return(n=>{const{store:{getState:e}}=n,t=e();if(t.share){const{remoteControllingSsrc:r}=t.share;if(r)return Yi(t).find(i=>Gl(i.userId,r))}return null})(this[pt])}},gt(je.prototype,"startAudio",[yt,zfe,yu],Object.getOwnPropertyDescriptor(je.prototype,"startAudio"),je.prototype),gt(je.prototype,"stopAudio",[yt,Vfe,yu],Object.getOwnPropertyDescriptor(je.prototype,"stopAudio"),je.prototype),gt(je.prototype,"muteAudio",[yt,Wfe,yu],Object.getOwnPropertyDescriptor(je.prototype,"muteAudio"),je.prototype),gt(je.prototype,"unmuteAudio",[yt,qfe,yu],Object.getOwnPropertyDescriptor(je.prototype,"unmuteAudio"),je.prototype),gt(je.prototype,"dialOut",[yt,Kfe,Gfe],Object.getOwnPropertyDescriptor(je.prototype,"dialOut"),je.prototype),gt(je.prototype,"cancelDialOut",[yt,Zfe,Xfe],Object.getOwnPropertyDescriptor(je.prototype,"cancelDialOut"),je.prototype),gt(je.prototype,"hangup",[yt,Yfe,yu],Object.getOwnPropertyDescriptor(je.prototype,"hangup"),je.prototype),gt(je.prototype,"switchMicrophone",[yt,Jfe,yu],Object.getOwnPropertyDescriptor(je.prototype,"switchMicrophone"),je.prototype),gt(je.prototype,"switchSpeaker",[yt,Qfe,yu],Object.getOwnPropertyDescriptor(je.prototype,"switchSpeaker"),je.prototype),gt(je.prototype,"muteShareAudio",[yt,epe,tpe,yu],Object.getOwnPropertyDescriptor(je.prototype,"muteShareAudio"),je.prototype),gt(je.prototype,"unmuteShareAudio",[yt,npe,rpe,yu],Object.getOwnPropertyDescriptor(je.prototype,"unmuteShareAudio"),je.prototype),gt(je.prototype,"subscribeAudioStatisticData",[yt,ipe,yu],Object.getOwnPropertyDescriptor(je.prototype,"subscribeAudioStatisticData"),je.prototype),gt(je.prototype,"unsubscribeAudioStatisticData",[yt,ope,yu],Object.getOwnPropertyDescriptor(je.prototype,"unsubscribeAudioStatisticData"),je.prototype),gt(je.prototype,"enableBackgroundNoiseSuppression",[yt,spe,yu],Object.getOwnPropertyDescriptor(je.prototype,"enableBackgroundNoiseSuppression"),je.prototype),gt(je.prototype,"enableSyncButtonsOnHeadset",[yt,ape,yu],Object.getOwnPropertyDescriptor(je.prototype,"enableSyncButtonsOnHeadset"),je.prototype),gt(je.prototype,"enableOriginalSound",[yt,cpe,yu],Object.getOwnPropertyDescriptor(je.prototype,"enableOriginalSound"),je.prototype),gt(je.prototype,"callCRCDevice",[yt,lpe,upe],Object.getOwnPropertyDescriptor(je.prototype,"callCRCDevice"),je.prototype),gt(je.prototype,"cancelCallCRCDevice",[yt,dpe,hpe],Object.getOwnPropertyDescriptor(je.prototype,"cancelCallCRCDevice"),je.prototype),gt(je.prototype,"muteAllAudio",[Ls,yt,fpe],Object.getOwnPropertyDescriptor(je.prototype,"muteAllAudio"),je.prototype),gt(je.prototype,"unmuteAllAudio",[Ls,yt,ppe],Object.getOwnPropertyDescriptor(je.prototype,"unmuteAllAudio"),je.prototype),gt(je.prototype,"startVideo",[yt,gpe,la],Object.getOwnPropertyDescriptor(je.prototype,"startVideo"),je.prototype),gt(je.prototype,"stopVideo",[yt,mpe,la],Object.getOwnPropertyDescriptor(je.prototype,"stopVideo"),je.prototype),gt(je.prototype,"switchCamera",[yt,vpe,la],Object.getOwnPropertyDescriptor(je.prototype,"switchCamera"),je.prototype),gt(je.prototype,"renderVideo",[cht,yt,ype,la],Object.getOwnPropertyDescriptor(je.prototype,"renderVideo"),je.prototype),gt(je.prototype,"stopRenderVideo",[pge,yt,bpe,la],Object.getOwnPropertyDescriptor(je.prototype,"stopRenderVideo"),je.prototype),gt(je.prototype,"updateVideoCanvasDimension",[fge,yt,Spe,la],Object.getOwnPropertyDescriptor(je.prototype,"updateVideoCanvasDimension"),je.prototype),gt(je.prototype,"adjustRenderedVideoPosition",[pge,yt,_pe,la],Object.getOwnPropertyDescriptor(je.prototype,"adjustRenderedVideoPosition"),je.prototype),gt(je.prototype,"clearVideoCanvas",[fge,yt,wpe,la],Object.getOwnPropertyDescriptor(je.prototype,"clearVideoCanvas"),je.prototype),gt(je.prototype,"mirrorVideo",[yt,Cpe,la],Object.getOwnPropertyDescriptor(je.prototype,"mirrorVideo"),je.prototype),gt(je.prototype,"enableHardwareAcceleration",[yt,xpe,la],Object.getOwnPropertyDescriptor(je.prototype,"enableHardwareAcceleration"),je.prototype),gt(je.prototype,"subscribeVideoStatisticData",[yt,Epe,la],Object.getOwnPropertyDescriptor(je.prototype,"subscribeVideoStatisticData"),je.prototype),gt(je.prototype,"unsubscribeVideoStatisticData",[yt,Ipe,la],Object.getOwnPropertyDescriptor(je.prototype,"unsubscribeVideoStatisticData"),je.prototype),gt(je.prototype,"previewVirtualBackground",[YB,yt,Ppe,la],Object.getOwnPropertyDescriptor(je.prototype,"previewVirtualBackground"),je.prototype),gt(je.prototype,"updateVirtualBackgroundImage",[yt,kpe,la],Object.getOwnPropertyDescriptor(je.prototype,"updateVirtualBackgroundImage"),je.prototype),gt(je.prototype,"stopPreviewVirtualBackground",[yt,Tpe,la],Object.getOwnPropertyDescriptor(je.prototype,"stopPreviewVirtualBackground"),je.prototype),gt(je.prototype,"previewVideoMask",[YB,yt,Dpe,la],Object.getOwnPropertyDescriptor(je.prototype,"previewVideoMask"),je.prototype),gt(je.prototype,"updateVideoMask",[yt,Rpe,la],Object.getOwnPropertyDescriptor(je.prototype,"updateVideoMask"),je.prototype),gt(je.prototype,"stopPreviewVideoMask",[yt,Ape,la],Object.getOwnPropertyDescriptor(je.prototype,"stopPreviewVideoMask"),je.prototype),gt(je.prototype,"requestFarEndCameraControl",[yt,Ope,Y_],Object.getOwnPropertyDescriptor(je.prototype,"requestFarEndCameraControl"),je.prototype),gt(je.prototype,"approveFarEndCameraControl",[yt,Mpe,Y_],Object.getOwnPropertyDescriptor(je.prototype,"approveFarEndCameraControl"),je.prototype),gt(je.prototype,"declineFarEndCameraControl",[yt,$pe,Y_],Object.getOwnPropertyDescriptor(je.prototype,"declineFarEndCameraControl"),je.prototype),gt(je.prototype,"giveUpFarEndCameraControl",[yt,Lpe,Y_],Object.getOwnPropertyDescriptor(je.prototype,"giveUpFarEndCameraControl"),je.prototype),gt(je.prototype,"controlCamera",[yt,Npe,Y_],Object.getOwnPropertyDescriptor(je.prototype,"controlCamera"),je.prototype),gt(je.prototype,"controlFarEndCamera",[yt,Fpe,Y_],Object.getOwnPropertyDescriptor(je.prototype,"controlFarEndCamera"),je.prototype),gt(je.prototype,"attachVideo",[yt,jpe,la],Object.getOwnPropertyDescriptor(je.prototype,"attachVideo"),je.prototype),gt(je.prototype,"detachVideo",[yt,Bpe,la],Object.getOwnPropertyDescriptor(je.prototype,"detachVideo"),je.prototype),gt(je.prototype,"startShareView",[YB,yt,Hpe,Ec],Object.getOwnPropertyDescriptor(je.prototype,"startShareView"),je.prototype),gt(je.prototype,"stopShareView",[yt,Upe,Ec],Object.getOwnPropertyDescriptor(je.prototype,"stopShareView"),je.prototype),gt(je.prototype,"switchShareView",[yt,zpe,Ec],Object.getOwnPropertyDescriptor(je.prototype,"switchShareView"),je.prototype),gt(je.prototype,"updateSharingCanvasDimension",[yt,Vpe,Ec],Object.getOwnPropertyDescriptor(je.prototype,"updateSharingCanvasDimension"),je.prototype),gt(je.prototype,"startShareScreen",[yt,Wpe,Ec],Object.getOwnPropertyDescriptor(je.prototype,"startShareScreen"),je.prototype),gt(je.prototype,"stopShareScreen",[yt,qpe,Ec],Object.getOwnPropertyDescriptor(je.prototype,"stopShareScreen"),je.prototype),gt(je.prototype,"pauseShareScreen",[yt,Kpe,Ec],Object.getOwnPropertyDescriptor(je.prototype,"pauseShareScreen"),je.prototype),gt(je.prototype,"resumeShareScreen",[yt,Gpe,Ec],Object.getOwnPropertyDescriptor(je.prototype,"resumeShareScreen"),je.prototype),gt(je.prototype,"setSharePrivilege",[Ls,Zpe,yt,Ec],Object.getOwnPropertyDescriptor(je.prototype,"setSharePrivilege"),je.prototype),gt(je.prototype,"lockShare",[Ls,Xpe,yt,Ec],Object.getOwnPropertyDescriptor(je.prototype,"lockShare"),je.prototype),gt(je.prototype,"shareToBreakoutRoom",[yt,Ls,Ype,Ec],Object.getOwnPropertyDescriptor(je.prototype,"shareToBreakoutRoom"),je.prototype),gt(je.prototype,"stopShareToBreakoutRoom",[yt,Ls,Jpe,Ec],Object.getOwnPropertyDescriptor(je.prototype,"stopShareToBreakoutRoom"),je.prototype),gt(je.prototype,"muteOthersScreenShare",[yt,Ls,Qpe,Ec],Object.getOwnPropertyDescriptor(je.prototype,"muteOthersScreenShare"),je.prototype),gt(je.prototype,"enableOptimizeForSharedVideo",[yt,ege,Ec],Object.getOwnPropertyDescriptor(je.prototype,"enableOptimizeForSharedVideo"),je.prototype),gt(je.prototype,"updateSharedVideoQuality",[yt,tge,Ec],Object.getOwnPropertyDescriptor(je.prototype,"updateSharedVideoQuality"),je.prototype),gt(je.prototype,"subscribeShareStatisticData",[yt,nge,Ec],Object.getOwnPropertyDescriptor(je.prototype,"subscribeShareStatisticData"),je.prototype),gt(je.prototype,"unsubscribeShareStatisticData",[yt,rge,Ec],Object.getOwnPropertyDescriptor(je.prototype,"unsubscribeShareStatisticData"),je.prototype),gt(je.prototype,"requestRemoteControl",[yt,ige,om],Object.getOwnPropertyDescriptor(je.prototype,"requestRemoteControl"),je.prototype),gt(je.prototype,"giveUpRemoteControl",[yt,oge,om],Object.getOwnPropertyDescriptor(je.prototype,"giveUpRemoteControl"),je.prototype),gt(je.prototype,"startRemoteControl",[yt,sge,om],Object.getOwnPropertyDescriptor(je.prototype,"startRemoteControl"),je.prototype),gt(je.prototype,"grabRemotoControl",[yt,age,om],Object.getOwnPropertyDescriptor(je.prototype,"grabRemotoControl"),je.prototype),gt(je.prototype,"updateRemoteControlViewportDimension",[yt,cge,om],Object.getOwnPropertyDescriptor(je.prototype,"updateRemoteControlViewportDimension"),je.prototype),gt(je.prototype,"approveRemoteControl",[yt,lge,om],Object.getOwnPropertyDescriptor(je.prototype,"approveRemoteControl"),je.prototype),gt(je.prototype,"declineRemoteControl",[yt,uge,om],Object.getOwnPropertyDescriptor(je.prototype,"declineRemoteControl"),je.prototype),gt(je.prototype,"stopRemoteControl",[yt,dge,om],Object.getOwnPropertyDescriptor(je.prototype,"stopRemoteControl"),je.prototype),gt(je.prototype,"launchRemoteControlApp",[yt,hge,om],Object.getOwnPropertyDescriptor(je.prototype,"launchRemoteControlApp"),je.prototype),je);var gge,mge,vge,yge,bge,Sge,_ge,wge,To;const Tb=Nu("Audio"),uht=Nu("Sharing");let dht=(gge=Yt("share"),mge=Yt("audio"),vge=Yt("audio"),yge=Yt("audio"),bge=Yt("audio"),Sge=Yt("audio"),_ge=Yt("audio"),wge=Yt("audio"),To=class extends lht{switchSharingSecondaryCamera(n){return((e,t)=>{const{store:{getState:r,dispatch:i},mediaAgent:o}=e,s=r(),{video:{cameraDevicesList:a},share:{status:c,isSharingWithSecondCamera:l}}=s;return t!=="default"&&a.map(u=>u.deviceId).indexOf(t)===-1?Promise.reject({type:Jn,reason:"Cannot find cameraDeviceId in camera devices list."}):(c===Hr.Sharing&&l&&o.changeSharingSecondCamera(t),i(yTe(t)),Promise.resolve())})(this[pt],n)}muteUserAudioLocally(n){return((e,t)=>{const{mediaAgent:r,store:{getState:i,dispatch:o}}=e,s=i(),{audio:{locallyMutedAudioList:a}}=s,c=Yi(s).filter(l=>l.audio===ci.Computer);return a.includes(t)||c.findIndex(l=>l.userId===t)===-1||(r.muteOrUnmuteOtherAudio(t,!0),o(sTe(t))),Promise.resolve("")})(this[pt],n)}unmuteUserAudioLocally(n){return((e,t)=>{const{mediaAgent:r,store:{getState:i,dispatch:o}}=e,{audio:{locallyMutedAudioList:s}}=i();return s.includes(t)&&(r.muteOrUnmuteOtherAudio(t,!1),o(_6(t))),Promise.resolve("")})(this[pt],n)}adjustUserAudioVolumeLocally(n,e){return((t,r,i)=>{const{mediaAgent:o,store:{getState:s,dispatch:a}}=t,c=s();return Yi(c).findIndex(l=>l.userId===r)!==-1&&(o.adjustOtherAudioVolume(r,i),a(aTe({userId:r,volume:i}))),Promise.resolve("")})(this[pt],n,e)}muteAllUserAudioLocally(){return(n=>{const{mediaAgent:e,store:{getState:t,dispatch:r}}=n,{audio:{isStopAllImcomingAudio:i}}=t();return i||(e.stopAllIncomingAudio(!0),r(sK(!0))),Promise.resolve("")})(this[pt])}unmuteAllUserAudioLocally(){return(n=>{const{mediaAgent:e,store:{getState:t,dispatch:r}}=n,{audio:{isStopAllImcomingAudio:i,locallyMutedAudioList:o}}=t();return i&&(e.stopAllIncomingAudio(!1),r(sK(!1)),o.length>0&&o.forEach(s=>{e.muteOrUnmuteOtherAudio(s,!1),r(_6(s))})),Promise.resolve("")})(this[pt])}startSecondaryAudio(n,e){return(async(t,r,i)=>{const{mediaAgent:o,rwgAgent:s,store:{getState:a,dispatch:c}}=t,l=a(),{audio:{microphoneDevicesList:u,activeMicrophone:d},share:{status:h}}=l,f=mn(l);if(!zn.isSupportShare2ndAudioDevice(ra()))return Promise.reject({type:lt,reason:"Cannot start secondary audio due to platform is not supported"});if((f==null?void 0:f.audio)===ci.Computer&&d===r)return Promise.reject({type:lt,reason:"Cannot start secondary audio with the same microphone"});if(h!==Hr.End)return Promise.reject({type:lt,reason:"Cannot start secondary audio while screen sharing is in progress"});let p=u;if(u.length===0){const{microphones:g}=await mc(z6());p=g}return r&&p.findIndex(g=>g.deviceId===r)===-1?Promise.reject({type:Jn,reason:"Cannot find the microphone"}):(s.muteShareAudio(!1,!0),o.share2ndAudio(r,i),c(w6(r)),Un(Vke))})(this[pt],n,e)}stopSecondaryAudio(){return(async n=>{const{mediaAgent:e,rwgAgent:t,store:{getState:r,dispatch:i}}=n,o=r(),{audio:{secondaryAudioMicrophoneId:s}}=o;if(!s)return Promise.reject({type:lt,reason:"Cannot stop secondary audio due to not started "});t.muteShareAudio(!0,!0),e.leaveSharingAudio(!1),i(w6(void 0))})(this[pt])}isUserAudioMutedLocally(n){return((e,t)=>{let{store:{getState:r}}=e;const{audio:{locallyMutedAudioList:i}}=r();return i.includes(t)})(this[pt],n)}getUserVolumeLocally(n){return((e,t)=>{var r,i;let{store:{getState:o}}=e;const{audio:{localUserAudioVolumeList:s,locallyMutedAudioList:a}}=o();return(r=(i=s.find(c=>c.userId===t))===null||i===void 0?void 0:i.volume)!==null&&r!==void 0?r:a.includes(t)?0:100})(this[pt],n)}},gt(To.prototype,"switchSharingSecondaryCamera",[yt,gge,uht],Object.getOwnPropertyDescriptor(To.prototype,"switchSharingSecondaryCamera"),To.prototype),gt(To.prototype,"muteUserAudioLocally",[yt,mge,Tb],Object.getOwnPropertyDescriptor(To.prototype,"muteUserAudioLocally"),To.prototype),gt(To.prototype,"unmuteUserAudioLocally",[yt,vge,Tb],Object.getOwnPropertyDescriptor(To.prototype,"unmuteUserAudioLocally"),To.prototype),gt(To.prototype,"adjustUserAudioVolumeLocally",[yt,yge,Tb],Object.getOwnPropertyDescriptor(To.prototype,"adjustUserAudioVolumeLocally"),To.prototype),gt(To.prototype,"muteAllUserAudioLocally",[yt,bge,Tb],Object.getOwnPropertyDescriptor(To.prototype,"muteAllUserAudioLocally"),To.prototype),gt(To.prototype,"unmuteAllUserAudioLocally",[yt,Sge,Tb],Object.getOwnPropertyDescriptor(To.prototype,"unmuteAllUserAudioLocally"),To.prototype),gt(To.prototype,"startSecondaryAudio",[yt,_ge,Tb],Object.getOwnPropertyDescriptor(To.prototype,"startSecondaryAudio"),To.prototype),gt(To.prototype,"stopSecondaryAudio",[yt,wge,Tb],Object.getOwnPropertyDescriptor(To.prototype,"stopSecondaryAudio"),To.prototype),To);const E5={controlStatus:Sr.NotStarted,sequenceId:1,rooms:[],isHugeBO:!1,allocationPattern:C1.Automatically,currentRoom:{status:Cn.Initial,boStatus:V3e.NoToken,boConfId:"",boId:"",name:"",boToken:""},options:{isAutoJoinRoom:!1,isBackToMainSessionEnabled:!0,isTimerEnabled:!1,timerDuration:1800,isTimerAutoEnabled:!1,waitSeconds:60,isAutoMovetoMainSession:!1,isRoomSelectionEnabled:!1},mainSessionAttendeeList:[],preAssignedRooms:[],meetingElapsedTime:0,startRoomElapsedTime:0,closingRoomTime:0,broadcastMessage:"",hostReplyToQuestionerType:void 0,hostReplyToRequestId:void 0,isUserRoleUpdated:!1,mainSessionConfId:"",isEnableBOBroadcast:!1,isEnableBreakoutRoom:!1,isEnableBOViewActivityStatus:!1,inRoomUserActivityStatusMap:{},isEnableBOBroadcastVoice:!1,isBroadcastVoice:!1},hht=ru({[`${iDe}`]:Pe((n,e)=>{let{payload:t}=e;Array.isArray(t)?n.rooms.push(...t):n.rooms.push(t)}),[`${wK}`]:Pe((n,e)=>{let{payload:t}=e;n.allocationPattern=t}),[`${N6}`]:Pe((n,e)=>{let{payload:t}=e;n.sequenceId=t}),[`${CK}`]:Pe((n,e)=>{let{payload:t}=e;n.meetingElapsedTime=t}),[`${oDe}`]:Pe((n,e)=>{let{payload:t}=e;n.startRoomElapsedTime=t}),[`${sDe}`]:Pe((n,e)=>{let{payload:t}=e;const{options:r}=n;Object.assign(r,t)}),[`${aDe}`]:Pe((n,e)=>{let{payload:t}=e;n.controlStatus=t}),[`${YP}`]:Pe((n,e)=>{let{payload:t}=e;n.rooms=t}),[`${F6}`]:Pe((n,e)=>{let{payload:t}=e;const{currentRoom:r}=n;Object.assign(r,t)}),[`${aS}`]:Pe((n,e)=>{let{payload:t}=e;const{currentRoom:r}=n;r.status=t}),[`${xK}`]:Pe((n,e)=>{let{payload:t}=e;const{currentRoom:r}=n;r.boConfId=t}),[`${EK}`]:Pe((n,e)=>{let{payload:t}=e;const{currentRoom:r}=n;r.boToken=t}),[`${IK}`]:Pe((n,e)=>{let{payload:t}=e;n.closingRoomTime=t}),[`${lDe}`]:Pe((n,e)=>{let{payload:t}=e;n.broadcastMessage=t}),[`${Kte}`]:Pe((n,e)=>{let{payload:t}=e;n.hostReplyToQuestionerType=t}),[`${uDe}`]:Pe((n,e)=>{let{payload:t}=e;n.hostReplyToRequestId=t}),[`${dDe}`]:Pe((n,e)=>{let{payload:t}=e;t.add!==void 0&&t.add.length>0&&t.add.forEach(r=>{const i=n.mainSessionAttendeeList.find(o=>o.userId===r.userId);i!==void 0?Object.assign(i,r):v6(r.userRole)||n.mainSessionAttendeeList.push(r)}),t.update!==void 0&&t.update.length>0&&t.update.forEach(r=>{const i=n.mainSessionAttendeeList.find(o=>o.userId===r.userId);i!==void 0&&Object.assign(i,r)}),t.remove!==void 0&&t.remove.length>0&&t.remove.forEach(r=>{const i=n.mainSessionAttendeeList.findIndex(o=>o.userId===r.userId);i!==-1&&n.mainSessionAttendeeList.splice(i,1)})}),[`${hDe}`]:Pe((n,e)=>{let{payload:t}=e;n.isHugeBO=t}),[`${kK}`]:Pe((n,e)=>{let{payload:t}=e;n.isUserRoleUpdated=t}),[`${PK}`]:Pe((n,e)=>{let{payload:t}=e;n.preAssignedRooms=t}),[`${fDe}`]:Pe((n,e)=>{let{payload:t}=e;n.isEnableBreakoutRoom=t.isEnableBreakoutRoom,n.isEnableBOBroadcast=t.isEnableBOBroadcast,n.isEnableBOViewActivityStatus=t.isEnableBOViewActivityStatus,n.isEnableBOBroadcastVoice=t.isEnableBOBroadcastVoice}),[`${pDe}`]:Pe((n,e)=>{let{payload:t}=e;const{userGuid:r,status:i}=t,{inRoomUserActivityStatusMap:o}=n;o[`${r}`]=i}),[`${j6}`]:Pe((n,e)=>{let{payload:t}=e;n.isBroadcastVoice=t}),[`${cDe}`]:n=>{const{currentRoom:{status:e}}=n;return e===Cn.Joining?{...E5,preAssignedRooms:n.preAssignedRooms,currentRoom:n.currentRoom,closingRoomTime:n.closingRoomTime}:e===Cn.Leaving?{...E5,preAssignedRooms:n.preAssignedRooms,closingRoomTime:n.closingRoomTime}:{...E5,preAssignedRooms:n.preAssignedRooms}}},E5);var rc=Uint8Array,Fu=Uint16Array,I7=Uint32Array,P7=new rc([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),k7=new rc([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),lG=new rc([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),g5e=function(n,e){for(var t=new Fu(31),r=0;r<31;++r)t[r]=e+=1<<n[r-1];var i=new I7(t[30]);for(r=1;r<30;++r)for(var o=t[r];o<t[r+1];++o)i[o]=o-t[r]<<5|r;return[t,i]},m5e=g5e(P7,2),v5e=m5e[0],uG=m5e[1];v5e[28]=258,uG[258]=28;for(var Cge=g5e(k7,0),fht=Cge[0],xge=Cge[1],dG=new Fu(32768),ts=0;ts<32768;++ts){var Db=(43690&ts)>>>1|(21845&ts)<<1;Db=(61680&(Db=(52428&Db)>>>2|(13107&Db)<<2))>>>4|(3855&Db)<<4,dG[ts]=((65280&Db)>>>8|(255&Db)<<8)>>>1}var ng=function(n,e,t){for(var r=n.length,i=0,o=new Fu(e);i<r;++i)n[i]&&++o[n[i]-1];var s,a=new Fu(e);for(i=0;i<e;++i)a[i]=a[i-1]+o[i-1]<<1;if(t){s=new Fu(1<<e);var c=15-e;for(i=0;i<r;++i)if(n[i])for(var l=i<<4|n[i],u=e-n[i],d=a[n[i]-1]++<<u,h=d|(1<<u)-1;d<=h;++d)s[dG[d]>>>c]=l}else for(s=new Fu(r),i=0;i<r;++i)n[i]&&(s[i]=dG[a[n[i]-1]++]>>>15-n[i]);return s},Cy=new rc(288);for(ts=0;ts<144;++ts)Cy[ts]=8;for(ts=144;ts<256;++ts)Cy[ts]=9;for(ts=256;ts<280;++ts)Cy[ts]=7;for(ts=280;ts<288;++ts)Cy[ts]=8;var f3=new rc(32);for(ts=0;ts<32;++ts)f3[ts]=5;var pht=ng(Cy,9,0),ght=ng(Cy,9,1),mht=ng(f3,5,0),vht=ng(f3,5,1),JB=function(n){for(var e=n[0],t=1;t<n.length;++t)n[t]>e&&(e=n[t]);return e},lf=function(n,e,t){var r=e/8|0;return(n[r]|n[r+1]<<8)>>(7&e)&t},QB=function(n,e){var t=e/8|0;return(n[t]|n[t+1]<<8|n[t+2]<<16)>>(7&e)},Sne=function(n){return(n+7)/8|0},h8=function(n,e,t){(e==null||e<0)&&(e=0),(t==null||t>n.length)&&(t=n.length);var r=new(n.BYTES_PER_ELEMENT==2?Fu:n.BYTES_PER_ELEMENT==4?I7:rc)(t-e);return r.set(n.subarray(e,t)),r},yht=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Cp=function(n,e,t){var r=new Error(e||yht[n]);if(r.code=n,Error.captureStackTrace&&Error.captureStackTrace(r,Cp),!t)throw r;return r},sm=function(n,e,t){t<<=7&e;var r=e/8|0;n[r]|=t,n[r+1]|=t>>>8},oI=function(n,e,t){t<<=7&e;var r=e/8|0;n[r]|=t,n[r+1]|=t>>>8,n[r+2]|=t>>>16},eH=function(n,e){for(var t=[],r=0;r<n.length;++r)n[r]&&t.push({s:r,f:n[r]});var i=t.length,o=t.slice();if(!i)return[b5e,0];if(i==1){var s=new rc(t[0].s+1);return s[t[0].s]=1,[s,1]}t.sort(function(w,C){return w.f-C.f}),t.push({s:-1,f:25001});var a=t[0],c=t[1],l=0,u=1,d=2;for(t[0]={s:-1,f:a.f+c.f,l:a,r:c};u!=i-1;)a=t[t[l].f<t[d].f?l++:d++],c=t[l!=u&&t[l].f<t[d].f?l++:d++],t[u++]={s:-1,f:a.f+c.f,l:a,r:c};var h=o[0].s;for(r=1;r<i;++r)o[r].s>h&&(h=o[r].s);var f=new Fu(h+1),p=hG(t[u-1],f,0);if(p>e){r=0;var g=0,m=p-e,v=1<<m;for(o.sort(function(w,C){return f[C.s]-f[w.s]||w.f-C.f});r<i;++r){var b=o[r].s;if(!(f[b]>e))break;g+=v-(1<<p-f[b]),f[b]=e}for(g>>>=m;g>0;){var S=o[r].s;f[S]<e?g-=1<<e-f[S]++-1:++r}for(;r>=0&&g;--r){var E=o[r].s;f[E]==e&&(--f[E],++g)}p=e}return[new rc(f),p]},hG=function(n,e,t){return n.s==-1?Math.max(hG(n.l,e,t+1),hG(n.r,e,t+1)):e[n.s]=t},Ege=function(n){for(var e=n.length;e&&!n[--e];);for(var t=new Fu(++e),r=0,i=n[0],o=1,s=function(c){t[r++]=c},a=1;a<=e;++a)if(n[a]==i&&a!=e)++o;else{if(!i&&o>2){for(;o>138;o-=138)s(32754);o>2&&(s(o>10?o-11<<5|28690:o-3<<5|12305),o=0)}else if(o>3){for(s(i),--o;o>6;o-=6)s(8304);o>2&&(s(o-3<<5|8208),o=0)}for(;o--;)s(i);o=1,i=n[a]}return[t.subarray(0,r),e]},sI=function(n,e){for(var t=0,r=0;r<e.length;++r)t+=n[r]*e[r];return t},y5e=function(n,e,t){var r=t.length,i=Sne(e+2);n[i]=255&r,n[i+1]=r>>>8,n[i+2]=255^n[i],n[i+3]=255^n[i+1];for(var o=0;o<r;++o)n[i+o+4]=t[o];return 8*(i+4+r)},Ige=function(n,e,t,r,i,o,s,a,c,l,u){sm(e,u++,t),++i[256];for(var d=eH(i,15),h=d[0],f=d[1],p=eH(o,15),g=p[0],m=p[1],v=Ege(h),b=v[0],S=v[1],E=Ege(g),w=E[0],C=E[1],I=new Fu(19),T=0;T<b.length;++T)I[31&b[T]]++;for(T=0;T<w.length;++T)I[31&w[T]]++;for(var D=eH(I,7),O=D[0],M=D[1],R=19;R>4&&!O[lG[R-1]];--R);var A,k,L,j,N=l+5<<3,B=sI(i,Cy)+sI(o,f3)+s,U=sI(i,h)+sI(o,g)+s+14+3*R+sI(I,O)+(2*I[16]+3*I[17]+7*I[18]);if(N<=B&&N<=U)return y5e(e,u,n.subarray(c,c+l));if(sm(e,u,1+(U<B)),u+=2,U<B){A=ng(h,f,0),k=h,L=ng(g,m,0),j=g;var K=ng(O,M,0);for(sm(e,u,S-257),sm(e,u+5,C-1),sm(e,u+10,R-4),u+=14,T=0;T<R;++T)sm(e,u+3*T,O[lG[T]]);u+=3*R;for(var z=[b,w],G=0;G<2;++G){var te=z[G];for(T=0;T<te.length;++T){var ie=31&te[T];sm(e,u,K[ie]),u+=O[ie],ie>15&&(sm(e,u,te[T]>>>5&127),u+=te[T]>>>12)}}}else A=pht,k=Cy,L=mht,j=f3;for(T=0;T<a;++T)if(r[T]>255){ie=r[T]>>>18&31,oI(e,u,A[ie+257]),u+=k[ie+257],ie>7&&(sm(e,u,r[T]>>>23&31),u+=P7[ie]);var Q=31&r[T];oI(e,u,L[Q]),u+=j[Q],Q>3&&(oI(e,u,r[T]>>>5&8191),u+=k7[Q])}else oI(e,u,A[r[T]]),u+=k[r[T]];return oI(e,u,A[256]),u+k[256]},bht=new I7([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),b5e=new rc(0),Sht=function(){for(var n=new Int32Array(256),e=0;e<256;++e){for(var t=e,r=9;--r;)t=(1&t&&-306674912)^t>>>1;n[e]=t}return n}(),tH=function(n,e,t){for(;t;++e)n[e]=t,t>>>=8};function _ht(n,e){e||(e={});var t=function(){var s=-1;return{p:function(a){for(var c=s,l=0;l<a.length;++l)c=Sht[255&c^a[l]]^c>>>8;s=c},d:function(){return~s}}}(),r=n.length;t.p(n);var i=function(s,a,c,l,u){return function(d,h,f,p,g,m){var v=d.length,b=new rc(p+v+5*(1+Math.ceil(v/7e3))+g),S=b.subarray(p,b.length-g),E=0;if(!h||v<8)for(var w=0;w<=v;w+=65535){var C=w+65535;C>=v&&(S[E>>3]=m),E=y5e(S,E+1,d.subarray(w,C))}else{for(var I=bht[h-1],T=I>>>13,D=8191&I,O=(1<<f)-1,M=new Fu(32768),R=new Fu(O+1),A=Math.ceil(f/3),k=2*A,L=function(De){return(d[De]^d[De+1]<<A^d[De+2]<<k)&O},j=new I7(25e3),N=new Fu(288),B=new Fu(32),U=0,K=0,z=(w=0,0),G=0,te=0;w<v;++w){var ie=L(w),Q=32767&w,ge=R[ie];if(M[Q]=ge,R[ie]=Q,G<=w){var _e=v-w;if((U>7e3||z>24576)&&_e>423){E=Ige(d,S,0,j,N,B,K,z,te,w-te,E),z=U=K=0,te=w;for(var Se=0;Se<286;++Se)N[Se]=0;for(Se=0;Se<30;++Se)B[Se]=0}var se=2,ee=0,Y=D,ue=Q-ge&32767;if(_e>2&&ie==L(w-ue))for(var ye=Math.min(T,_e)-1,V=Math.min(32767,w),le=Math.min(258,_e);ue<=V&&--Y&&Q!=ge;){if(d[w+se]==d[w+se-ue]){for(var he=0;he<le&&d[w+he]==d[w+he-ue];++he);if(he>se){if(se=he,ee=ue,he>ye)break;var oe=Math.min(ue,he-2),ne=0;for(Se=0;Se<oe;++Se){var ce=w-ue+Se+32768&32767,Ae=ce-M[ce]+32768&32767;Ae>ne&&(ne=Ae,ge=ce)}}}ue+=(Q=ge)-(ge=M[Q])+32768&32767}if(ee){j[z++]=268435456|uG[se]<<18|xge[ee];var Ie=31&uG[se],be=31&xge[ee];K+=P7[Ie]+k7[be],++N[257+Ie],++B[be],G=w+se,++U}else j[z++]=d[w],++N[d[w]]}}E=Ige(d,S,m,j,N,B,K,z,te,w-te,E)}return h8(b,0,p+Sne(E)+g)}(s,a.level==null?6:a.level,a.mem==null?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(s.length)))):12+a.mem,c,l,!u)}(n,e,function(s){return 10+(s.filename&&s.filename.length+1||0)}(e),8),o=i.length;return function(s,a){var c=a.filename;if(s[0]=31,s[1]=139,s[2]=8,s[8]=a.level<2?4:a.level==9?2:0,s[9]=3,a.mtime!=0&&tH(s,4,Math.floor(new Date(a.mtime||Date.now())/1e3)),c){s[3]=8;for(var l=0;l<=c.length;++l)s[l+10]=c.charCodeAt(l)}}(i,e),tH(i,o-8,t.d()),tH(i,o-4,r),i}var Pge=typeof TextEncoder<"u"&&new TextEncoder,fG=typeof TextDecoder<"u"&&new TextDecoder;try{fG.decode(b5e,{stream:!0})}catch{}const{WebclientBreakoutRoomAttendeeStatus:_ne,WebclientBreakoutRoomCommand:wht}=Gi,nH=El(zn.getInstance());function vf(n,e){let t=0;for(;t<n.length;t++){const r=n[t],{attendeeGuidList:i}=r;if(i!=null&&i.includes(e))break}return t<n.length?n[t]:void 0}function Mw(){rr.remove(_ne),rr.remove(wht)}function pG(){return Gr.createAgent().leaveBO(1),me(Yl,{reason:cc.BackToMainSession}),Mw(),[aS(Cn.Leaving),Bc(La.NormalCase)]}function rH(n,e){return me(Yl,{reason:cc.JoinBreakoutRoom,roomName:n}),e===Cn.InRoom&&Gr.createAgent().leaveBO(1),[aS(Cn.Joining),Bc(La.NormalCase)]}function kge(n){return me(Yl,{reason:cc.MoveToBreakoutRoom,roomName:n}),Gr.createAgent().leaveBO(1),[aS(Cn.Joining),Bc(La.NormalCase)]}function iH(n){return n!==Cn.InRoom&&n!==Cn.Joining&&n!==Cn.Leaving}function I5(n){const e=arguments.length>1&&arguments[1]!==void 0&&arguments[1]?Cn.InRoom:Cn.Invited;return rr.set(_ne,JSON.stringify({status:e,boId:n.boId}),ri.SessionStorage),F6({status:e,boId:n.boId,name:n.name,boStatus:n.boStatus})}function oH(n){const{breakoutRoom:{isUserRoleUpdated:e,currentRoom:{boConfId:t}}}=n.value,r=mn(n.value);return r&&(!t||t&&e)?hi(r.isHost):(t?Mi(Zq,1):Mi(nD,1).pipe(ht(o=>m6(o.userRole)?Tt([1]):Ad(Mi(ql).pipe(st(s=>s.userRole!==void 0||s.bVideoConnect!==void 0),Ur(1)),Mi(_te).pipe(st(s=>s.some(a=>m6(a.userRole))),Ur(1)),js(3e3))))).pipe(bl(QT),nn(n),Vt(o=>{let[,s]=o;return mn(s).isHost}))}function gG(n){return f7({boIdList:Mi(x3e).pipe(Rst((e,t)=>[...e,t],[]),Ur(n))}).pipe(VIe(1e4))}const Cht=[{mask:aB.Connect,key:"audio",value:""},{mask:aB.Voip,key:"audio",value:"computer"},{mask:aB.Muted,key:"muted",value:!0},{mask:Ede.Connect,key:"bVideoOn",value:!1},{mask:Ede.On,key:"bVideoOn",value:!0},{mask:Ide.Share,key:"sharerOn",value:!0},{mask:Ide.ShareAudio,key:"bShareAudioOn",value:!0}];function Tge(n,e){const t=(zf(e)?e.breakoutRoom.mainSessionAttendeeList:e.participants.attendeesList).find(r=>r.userId===Number(n));return t?{inviterId:t.userId,inviterGuid:t.userGUID,inviterName:t.displayName}:{}}const uf=Gr.createAgent(),Dge=["userRole","bCoHost","bCCEditor","bHold"],xht=Gr.createAgent(),Eht=El(zn.getInstance());var Cr;const Ds=Gr.createAgent(),Rge=El(zn.getInstance()),bu=Nu("Breakout Room");let Iht=(Cr=class extends Og{createRooms(n,e){const t=this[Qt](),r=this[Qo],{breakoutRoom:{isHugeBO:i,sequenceId:o,rooms:s,controlStatus:a,isEnableBreakoutRoom:c}}=t;if(!c)return Promise.reject({type:lt,reason:"Breakout room feature is not enabled."});if(a===Sr.InProgress||a===Sr.Closing)return Promise.resolve({type:lt,reason:"breakout room has started!"});let l;l=typeof n=="string"?[n]:typeof n=="number"?Array.from({length:n}).map((d,h)=>`${Cde} ${h+o}`):n;const u=i?100:50;return l.length<1||s.length+l.length>u?Promise.reject({type:Jn,reason:"exceed maximum size"}):(Ds.batchCreateBOToken(l),new Promise((d,h)=>{gG(l.length).subscribe(f=>{let{boIdList:p}=f,g=p.map((v,b)=>({boId:v,name:l[b]}));if(e===C1.Automatically){const v=qB(t),b=g.length,S=v.length;g=g.map((E,w)=>{const C=[];let I=w;for(;I<S;)C.push(v[I]),I+=b;return{...E,attendeeList:C}})}const m=g.map(v=>{let{boId:b,name:S,attendeeList:E}=v;return{boId:b,name:S,attendeeGuidList:E&&E.map(w=>w.userGUID)}});if(r(iDe(m)),r(wK(e)),r(N6(o+g.length)),e===C1.Automatically){const v=g.map(b=>({roomId:b.boId,name:b.name,attendeeList:b.attendeeList.map(S=>({userId:S.userId,avatar:S.avatar,displayName:S.displayName}))}));d(v)}else d(g.map(v=>({roomId:v.boId,name:v.name,attendeeList:[]})))},()=>{h({type:Nf})})}))}recreateRooms(n,e){const t=this[Qt](),r=this[Qo],{breakoutRoom:{isHugeBO:i,sequenceId:o,rooms:s,controlStatus:a,isEnableBreakoutRoom:c}}=t;if(!c)return Promise.reject({type:lt,reason:"Breakout room feature is not enabled."});if(a===Sr.InProgress||a===Sr.Closing)return Promise.resolve({type:lt,reason:"breakout room has started!"});let l;l=typeof n=="string"?[n]:typeof n=="number"?Array.from({length:n}).map((d,h)=>`${Cde} ${h+o}`):n;const u=i?100:50;return l.length<1||s.length+l.length>u?Promise.reject({type:Jn,reason:"exceed maximum size"}):(Ds.batchCreateBOToken(l),new Promise((d,h)=>{gG(l.length).subscribe(f=>{let{boIdList:p}=f,g=p.map((v,b)=>({boId:v,name:l[b]}));if(e===C1.Automatically){const v=g.length,b=udt(t),S=b.length;g=g.map((E,w)=>{const C=[];let I=w;for(;I<S;)C.push(b[I]),I+=v;return{...E,attendeeList:C}})}const m=g.map(v=>{let{boId:b,name:S,attendeeList:E}=v;return{boId:b,name:S,attendeeGuidList:E&&E.map(w=>w.userGUID)}});if(r(YP(m)),r(wK(e)),r(N6(o+g.length)),e===C1.Automatically){const v=g.map(b=>({roomId:b.boId,name:b.name,attendeeList:b.attendeeList.map(S=>({userId:S.userId,avatar:S.avatar,displayName:S.displayName}))}));d(v)}else d(g.map(v=>({roomId:v.boId,name:v.name,attendeeList:[]})))},()=>{h({type:Nf})})}))}openRooms(n,e){var t;const r=this[Qt](),i={isAutoJoinRoom:!1,isBackToMainSessionEnabled:!0,isTimerEnabled:!1,timerDuration:1800,isTimerAutoEnabled:!1,waitSeconds:60,isAutoMoveBackToMainSession:!1,isRoomSelectionEnabled:!1},{breakoutRoom:{controlStatus:o,rooms:s,sequenceId:a,isHugeBO:c}}=r;if(o===Sr.InProgress||o===Sr.Closing)return Promise.resolve({type:lt,reason:"breakout room has started!"});if(n.some(p=>s.findIndex(g=>g.boId===p.roomId)===-1))return Promise.reject({type:Jn,reason:"roomId is wrong"});const l=Yi(r);if(n.reduce((p,g)=>p.concat(g.attendeeList),[]).some(p=>l.findIndex(g=>g.userId===p.userId)===-1))return Promise.reject({type:Jn,reason:"bad user"});const u=n.map(p=>{const{attendeeList:g}=p,m=g.map(v=>{const b=l.find(S=>S.userId===v.userId);return b==null?void 0:b.userGUID});return{BID:p.roomId,MeetingTitle:p.name,MeetingToken:void 0,Status:V3e.Started,HostID:"",ParticipantList:m}}),d=e?{...i,...e}:i,h={ControlStatus:Sr.InProgress,NameIndex:a,IsAutoJoinEnabled:+d.isAutoJoinRoom,IsBackToMainSessionEnabled:+d.isBackToMainSessionEnabled,IsTimerEnabled:+d.isTimerEnabled,TimerDuration:d.timerDuration,IsTimerAutoEndEnabled:+d.isTimerAutoEnabled,WaitSeconds:d.waitSeconds<0?0:d.waitSeconds,StartTimeOnMMR:void 0,ItemList:u,IsAutoMovetoMainSessionEnabled:d.isAutoMoveBackToMainSession,IsParticipantsChooseRoomEnabled:+d.isRoomSelectionEnabled};let f=TPe(JSON.stringify(h));if(c&&(f=(p=>g7.fromUint8Array(_ht(function(g,m){var v;if(Pge)return Pge.encode(g);var b=g.length,S=new rc(g.length+(g.length>>1)),E=0,w=function(T){S[E++]=T};for(v=0;v<b;++v){if(E+5>S.length){var C=new rc(E+8+(b-v<<1));C.set(S),S=C}var I=g.charCodeAt(v);I<128?w(I):I<2048?(w(192|I>>6),w(128|63&I)):I>55295&&I<57344?(w(240|(I=65536+(1047552&I)|1023&g.charCodeAt(++v))>>18),w(128|I>>12&63),w(128|I>>6&63),w(128|63&I)):(w(224|I>>12),w(128|I>>6&63),w(128|63&I))}return h8(S,0,E)}(p))))(f)),(t=mn(r))!==null&&t!==void 0&&t.isHost)Ds.startBO(f);else{const p=Ib(r);p&&Ds.coHostStartBO(f,p.userId)}return Un(o1,p=>p.controlStatus===Sr.InProgress)}joinRoom(n){const e=this[Qt](),t=mn(e),{breakoutRoom:{controlStatus:r,rooms:i,mainSessionAttendeeList:o,options:{isRoomSelectionEnabled:s},currentRoom:{status:a,boId:c}},meeting:{userGUID:l}}=e;if(r!==Sr.InProgress)return Promise.reject({type:OC,reason:"Breakout room is not started"});if(t!=null&&t.isHost){const u=i.find(d=>d.boId===n);if(!u)return Promise.reject({type:Jn,reason:"Room ID is not correct"});Ds.joinBO(u.boId)}else if(t!=null&&t.bCoHost){if(!i.find(d=>d.boId===n))return Promise.reject({type:Jn,reason:"Room ID is not correct"});{const d=Ib(e);d&&Ds.wantJoinBO(d==null?void 0:d.userId,n)}}else{if(a===Cn.InRoom&&c===n)return Promise.resolve("");{let u=!1;const d=vf(i,l);if(d&&d.boId===n)Ds.joinBO(d.boId);else if(s)if(i.findIndex(h=>h.boId===n)!==-1){const h=Ib(e);h&&Ds.wantJoinBO(h.userId,n)}else u=!0;else u=!0;if(u)return Promise.reject({type:Jn,reason:"Room ID is not correct"})}}return Un(M4,u=>u.boId===n)}leaveRoom(){const n=this[Qt](),e=this[Qo],{breakoutRoom:{controlStatus:t,options:r,currentRoom:{status:i}}}=n;if(t!==Sr.InProgress&&t!==Sr.Closing||i!==Cn.InRoom)return Promise.reject({type:lt});{const o=Td(n);if(!r.isBackToMainSessionEnabled&&!o)return Promise.reject({type:Oc,reason:"Can not return main session during the breakout room"});pG().forEach(s=>e(s))}return Promise.resolve("")}askForHelp(){const n=this[Qt](),{breakoutRoom:{controlStatus:e,mainSessionAttendeeList:t,currentRoom:{status:r}},participants:{attendeesList:i}}=n,o=Td(n);if(e!==Sr.InProgress||r!==Cn.InRoom)return Promise.reject({type:lt,reason:"you are not in breakout room"});if(o)return Promise.reject({type:lt,reason:"host or co-host can not ask for help"});{const s=t.find(a=>a.isHost);if(s){if(i.findIndex(a=>a.zoomID===s.zoomID)>-1)return Promise.reject({type:lt,reason:"host is in room"});Ds.askForHelpBO(s.userId)}}return Un(Ate,s=>s.result===m0.Received)}postponeHelping(n){const e=this[Qt](),t=this[Qo],{breakoutRoom:{mainSessionAttendeeList:r,currentRoom:{status:i}},participants:{attendeesList:o}}=e;let s=o;return i===Cn.InRoom&&(s=r),s.findIndex(a=>a.userId===n)>-1?(Ds.askForHelpResultBO(n,m0.Ignore),t(Kte(m0.Ignore)),Promise.resolve("")):Promise.reject({type:Jn,reason:"user id is not correct"})}broadcast(n){const{breakoutRoom:{isEnableBOBroadcast:e}}=this[Qt]();return e?n?zc.beginEncrypt({text:n,type:fc.BO_BROADCAST}).then(t=>(Ds.broadcastBO(t),Promise.resolve(""))):Promise.reject({type:Jn,reason:"content empty"}):Promise.reject({type:lt,reason:"Cannot broadcast message due to the feature is not enable"})}startBroadcastVoice(){const n=this[Qt](),e=this[Qo],{breakoutRoom:{isEnableBOBroadcast:t,isEnableBOBroadcastVoice:r,isBroadcastVoice:i}}=n;if(t&&r){if(zf(n))return Promise.reject({type:lt,reason:"Cannot broadcast voice in the room"});{if(i)return Promise.resolve("");const o=mn(n);return(o==null?void 0:o.audio)===ci.Computer&&o.muted===!1?(Ds.broadcastVoiceReq(!0),Rge.broadcastVoiceToBreakoutRoom(!0),e(j6(!0)),Promise.resolve("")):Promise.reject({type:lt,reason:"Start audio and unmute to broadcast"})}}return Promise.reject({type:lt,reason:"Cannot broadcast voice due to the feature is not enable"})}stopBroadcastVoice(){const n=this[Qt](),e=this[Qo],{breakoutRoom:{isBroadcastVoice:t}}=n;return t?(Ds.broadcastVoiceReq(!1),Rge.broadcastVoiceToBreakoutRoom(!1),e(j6(!1)),Promise.resolve("")):Promise.reject({type:lt,reason:"Cannot stop broadcast voice due to it is not started"})}assignUserToRoom(n,e){const t=this[Qt](),{breakoutRoom:{rooms:r}}=t,i=qB(t).find(s=>s.userId===n);if(!(i&&r.findIndex(s=>s.boId===e)>-1))return Promise.reject({type:Jn,reason:""});var o;if((o=mn(t))!==null&&o!==void 0&&o.isHost)Ds.assignToBO(n,e);else{const s=Ib(t);s&&Ds.coHostAssignToBO(i.userGUID,e,s.userId)}return Un(o1,s=>{const{controlStatus:a,roomList:c}=s,l=c.find(u=>u.boId===e);return a===Sr.InProgress&&l&&l.attendeeGuidList.includes(i.userGUID)})}moveUserToRoom(n,e){const t=this[Qt](),{breakoutRoom:{rooms:r,mainSessionAttendeeList:i},participants:{attendeesList:o}}=t,s=(zf(t)?i:o).find(c=>c.userId===n);if(!s)return Promise.reject({type:Jn,reason:"user id not correct"});{const c=vf(r,s.userGUID);if(!c)return Promise.reject({type:lt,reason:"user not in a room"});if(c.boId===e)return Promise.reject({type:lt,reason:"user already in the target room"});{const l=r.find(u=>u.boId===e);if(!l)return Promise.reject({type:Jn,reason:"invalid room id"});var a;if((a=mn(t))!==null&&a!==void 0&&a.isHost)Ds.switchBO(n,l.boId);else{const u=Ib(t);u&&Ds.coHostAssignToBO(s.userGUID,l.boId,u.userId)}}}return Un(o1,c=>{const{controlStatus:l,roomList:u}=c,d=u.find(h=>h.boId===e);return l===Sr.InProgress&&d&&d.attendeeGuidList.includes(s.userGUID)})}moveBackToMainSession(n){const e=this[Qt](),{breakoutRoom:{rooms:t,mainSessionAttendeeList:r},participants:{attendeesList:i}}=e,o=(zf(e)?r:i).find(a=>a.userId===n);if(!o)return Promise.reject({type:Jn,reason:"user id not correct"});if(!vf(t,o.userGUID))return Promise.reject({type:lt,reason:"user not in a room"});var s;if((s=mn(e))!==null&&s!==void 0&&s.isHost)Ds.moveToMainSession(o.userGUID);else{const a=Ib(e);a&&Ds.coHostMoveToMainSession(o.userGUID,a.userId)}return Un(o1,a=>{const{controlStatus:c,roomList:l}=a;return c===Sr.InProgress&&l.some(u=>{const{attendeeGuidList:d}=u;return d.includes(o.userGUID)})})}closeRoom(){const n=this[Qt](),{breakoutRoom:{controlStatus:e}}=n;if(e!==Sr.InProgress)return Promise.reject({type:lt,reason:"room is not started"});var t;if((t=mn(n))!==null&&t!==void 0&&t.isHost)Ds.stopBO(Sr.Closing);else{const r=Ib(n);r&&Ds.coHostStopBO(Sr.Closing,r.userId)}return Un(o1,r=>r.controlStatus===Sr.Closing)}loadPreAssignedRooms(){const n=this[Qt](),{meeting:{meetingOptions:e},breakoutRoom:{controlStatus:t}}=n;return!e.isAllowBreakoutRoomPreAssign||t!==Sr.NotStarted&&t!==Sr.Closed?Promise.reject({type:lt}):(Ds.preAssignBreakoutRoom(),Un(k3e))}getUnassignedAttendeeList(){const n=this[Qt](),e=mn(n);return e!=null&&e.isHost||e!=null&&e.bCoHost?qB(n).map(t=>HC(t)):[]}getRoomList(){const n=this[Qt](),{breakoutRoom:{rooms:e,currentRoom:{status:t,boId:r},mainSessionAttendeeList:i,inRoomUserActivityStatusMap:o,options:{isRoomSelectionEnabled:s}},participants:{attendeesList:a}}=n,c=mn(n);if(c&&(c.isHost||c.bCoHost||s)){const l=t===Cn.InRoom,u=l?i:a;return e.map(d=>{const{attendeeGuidList:h,boId:f,name:p}=d,g=(h||[]).map(m=>u.find(v=>v.userGUID===m)).filter(m=>!(m!=null&&m.isHost)).filter(Boolean);return l&&c.isHost&&f===r&&g.unshift(c),{roomId:f,name:p,attendeeList:g.filter(m=>!!m).map(m=>{var v;const b=(v=o[m.userGUID])!==null&&v!==void 0?v:{};return{userId:m.userId,displayName:m.displayName,avatar:m.avatar,isInRoom:m.bid===f,userGuid:m.userGUID,...b}})}})}return n.breakoutRoom.rooms.map(l=>{const{boId:u,name:d}=l;return{roomId:u,name:d,attendeeList:[]}})}getAttendeeStatus(){return this[Qt]().breakoutRoom.currentRoom.status}getRoomStatus(){return this[Qt]().breakoutRoom.controlStatus}getCurrentRoom(){const n=this[Qt](),{breakoutRoom:{currentRoom:{status:e,name:t,boId:r}}}=n;return{attendeeStatus:e,name:t,roomId:r}}getRoomOptions(){const n=this[Qt](),{breakoutRoom:{options:e}}=n,{whoStart:t,whoStop:r,...i}=e;return{...i}}},gt(Cr.prototype,"createRooms",[yt,Ls,bu],Object.getOwnPropertyDescriptor(Cr.prototype,"createRooms"),Cr.prototype),gt(Cr.prototype,"recreateRooms",[yt,Ls,bu],Object.getOwnPropertyDescriptor(Cr.prototype,"recreateRooms"),Cr.prototype),gt(Cr.prototype,"openRooms",[yt,Ls,bu],Object.getOwnPropertyDescriptor(Cr.prototype,"openRooms"),Cr.prototype),gt(Cr.prototype,"joinRoom",[yt,bu],Object.getOwnPropertyDescriptor(Cr.prototype,"joinRoom"),Cr.prototype),gt(Cr.prototype,"leaveRoom",[yt,bu],Object.getOwnPropertyDescriptor(Cr.prototype,"leaveRoom"),Cr.prototype),gt(Cr.prototype,"askForHelp",[yt,bu],Object.getOwnPropertyDescriptor(Cr.prototype,"askForHelp"),Cr.prototype),gt(Cr.prototype,"postponeHelping",[Na,yt,bu],Object.getOwnPropertyDescriptor(Cr.prototype,"postponeHelping"),Cr.prototype),gt(Cr.prototype,"broadcast",[Ls,yt],Object.getOwnPropertyDescriptor(Cr.prototype,"broadcast"),Cr.prototype),gt(Cr.prototype,"startBroadcastVoice",[Na,yt,bu],Object.getOwnPropertyDescriptor(Cr.prototype,"startBroadcastVoice"),Cr.prototype),gt(Cr.prototype,"stopBroadcastVoice",[Na,yt,bu],Object.getOwnPropertyDescriptor(Cr.prototype,"stopBroadcastVoice"),Cr.prototype),gt(Cr.prototype,"assignUserToRoom",[Ls,yt,bu],Object.getOwnPropertyDescriptor(Cr.prototype,"assignUserToRoom"),Cr.prototype),gt(Cr.prototype,"moveUserToRoom",[Ls,yt,bu],Object.getOwnPropertyDescriptor(Cr.prototype,"moveUserToRoom"),Cr.prototype),gt(Cr.prototype,"moveBackToMainSession",[Ls,yt,bu],Object.getOwnPropertyDescriptor(Cr.prototype,"moveBackToMainSession"),Cr.prototype),gt(Cr.prototype,"closeRoom",[Ls,yt,bu],Object.getOwnPropertyDescriptor(Cr.prototype,"closeRoom"),Cr.prototype),gt(Cr.prototype,"loadPreAssignedRooms",[Na,yt,bu],Object.getOwnPropertyDescriptor(Cr.prototype,"loadPreAssignedRooms"),Cr.prototype),Cr);const Pht={breakoutRoomSharingEpics0:(n,e)=>w1(n,Co).pipe(st(t=>{var r;const{payload:{body:i}}=t;return i==null||(r=i.update)===null||r===void 0?void 0:r.some(o=>o.bShareToBORooms!==void 0||o.bShareOn!==void 0)}),nn(e),Vt(t=>{let[r,i]=t;const{payload:{body:{update:o}}}=r,{breakoutRoom:{mainSessionAttendeeList:s}}=i,a=o.filter(u=>u.bShareOn&&u.bShareToBORooms),c=o.filter(u=>!u.bShareOn||!u.bShareToBORooms),l=s.filter(u=>u.sharerOn&&u.bShareToBORooms);return a.length>0&&a.forEach(u=>{l.findIndex(d=>d.userId===u.id)===-1&&me(Tte,{...u,isFromMainSession:!0})}),c.length>0&&c.forEach(u=>{me(Dte,{...u,isFromMainSession:!0})}),o.map(u=>{if(u.bShareOn&&u.bShareToBORooms){if(s.filter(d=>d.sharerOn&&d.bShareToBORooms&&d.userId!==u.id).length===0)return{activeNodeID:u.id,bStatus:1,ssrc:u.shareSsrc};{const d=s.find(h=>h.userId===u.id);if(d!=null&&d.isHost)return{activeNodeID:u.id,bStatus:1,ssrc:u.shareSsrc}}}else if(!u.bShareOn||!u.bShareToBORooms){const d=s.filter(h=>h.bShareToBORooms&&h.sharerOn);if(d.length===1&&d[0].userId===u.id)return{activeNodeID:u.id,bStatus:0,ssrc:0};{const h=d.filter(p=>p.userId!==u.id),f=h.find(p=>p.isHost);if(f)return{activeNodeID:f.userId,bStatus:1,ssrc:f.shareSsrc};{const p=h[0];if(p)return{activeNodeID:p.userId,bStatus:1,ssrc:p.shareSsrc}}}}}).filter(Boolean)}),ht(t=>{const{share:{status:r},meeting:{userId:i}}=e.value,o=[];return t.map(s=>{const{activeNodeID:a,bStatus:c,ssrc:l}=s,u=c===1;o.push(mTe(u)),u&&r!==Hr.End&&(xht.stopSharing(i),Eht.stopDesktopSharing(),o.push(Dd(Hr.End)),me(Qke));let d={activeNodeID:a,bStatus:c,ssrc:l,fromMainSession:!0};if(!u){const{participants:{attendeesList:h}}=e.value,f=h.filter(p=>p.sharerOn);if(f.length>0){const p=f[0];d={activeNodeID:p.userId,bStatus:1,ssrc:p.shareSsrc||0}}}o.push(c_({evt:Cq,body:d}))}),Tt(o)})),breakoutRoomSharingEpics1:(n,e)=>w1(n,y7).pipe(zr(t=>{const{payload:{body:{userID:r,confID:i}}}=t;return ga(...["sharing","audio"].map(o=>function(s,a,c,l,u){return w1(a,s==="audio"?xq:Ste).pipe(Ur(1),en(d=>{const{payload:{body:{encryptKey:h,additionalType:f}}}=d,{media:{sharingDecodeStatus:p,audioDecodeStatus:g},meeting:{svcUrl:m,meetingNumber:v,conId:b,zoomId:S,meetingId:E}}=c.value;Tc(s,"success",s==="audio"?g:p).subscribe(w=>{let[,C]=w;if(C){const I=`wss://${m}/wc/media/${v}?type=${s==="audio"?"ma":"ms"}&cid=${b}&mode=1`;nH.createMainSessionChannel(s,I),nH.updateMediaParams({iVType:s==="audio"?fa.AUDIO_DECODE:fa.SHARING_DECODE,isFromMainSession:!0,updateParams:{userId:l,sn:Od(S),confId:u,encryptType:f,encryptKey:Od(h),meetingId:E,meetingNumber:v}});const{breakoutRoom:{mainSessionAttendeeList:T}}=c.value;if((T==null?void 0:T.length)>0){const D=T.map(O=>({userid:O.userId,sn:O.zoomID&&Od(O.zoomID)}));nH.updateUserMediaSN({added:D,isFromMainSession:!0,iVType:s==="audio"?fa.AUDIO_DECODE:fa.SHARING_DECODE})}}})}),ht(()=>Mt))}(o,n,e,r,i)))}))},kht={epics0:(n,e)=>n.pipe(rn(`${av}`),zr(t=>{const{breakoutRoom:r,meeting:{meetingOptions:i}}=e.value,{payload:{hugeBO:o,elapsed:s}}=t,a=[];return r&&(i&&(a.push(hDe(o&&i.isBO100Enabled===!0)),a.push(fDe({isEnableBreakoutRoom:i.isEnableBreakoutRoom,isEnableBOBroadcast:i.isEnableBOBroadcast,isEnableBOViewActivityStatus:i.isEnableBOViewActivityStatus,isEnableBOBroadcastVoice:i.isEnableBOBroadcastVoice}))),r.currentRoom.boConfId&&a.push(hq()),s!==void 0&&a.push(CK(s))),Tt(a)})),epics1:n=>zt(n,4174).pipe(en(e=>{me(x3e,e.payload.body.bid)}),$n(Mt)),epics2:(n,e)=>Uf(n,7950).pipe(nn(e),zr(t=>{let[r,i]=t;const{payload:{body:{proto:o}}}=r,{breakoutRoom:{isHugeBO:s,currentRoom:{status:a,boId:c}},meeting:{userGUID:l}}=i;let u=o;s&&(u=function(f,p){if(fG)return fG.decode(f);var g=function(v){for(var b="",S=0;;){var E=v[S++],w=(E>127)+(E>223)+(E>239);if(S+w>v.length)return[b,h8(v,S-1)];w?w==3?(E=((15&E)<<18|(63&v[S++])<<12|(63&v[S++])<<6|63&v[S++])-65536,b+=String.fromCharCode(55296|E>>10,56320|1023&E)):b+=1&w?String.fromCharCode((31&E)<<6|63&v[S++]):String.fromCharCode((15&E)<<12|(63&v[S++])<<6|63&v[S++]):b+=String.fromCharCode(E)}}(f),m=g[0];return g[1].length&&Cp(8),m}(function(f,p){return function(g,m,v){var b=g.length;if(!b||v&&v.f&&!v.l)return m||new rc(0);var S=!m||v,E=!v||v.i;v||(v={}),m||(m=new rc(3*b));var w=function(Ie){var be=m.length;if(Ie>be){var De=new rc(Math.max(2*be,Ie));De.set(m),m=De}},C=v.f||0,I=v.p||0,T=v.b||0,D=v.l,O=v.d,M=v.m,R=v.n,A=8*b;do{if(!D){C=lf(g,I,1);var k=lf(g,I+1,3);if(I+=3,!k){var L=g[(ge=Sne(I)+4)-4]|g[ge-3]<<8,j=ge+L;if(j>b){E&&Cp(0);break}S&&w(T+L),m.set(g.subarray(ge,j),T),v.b=T+=L,v.p=I=8*j,v.f=C;continue}if(k==1)D=ght,O=vht,M=9,R=5;else if(k==2){var N=lf(g,I,31)+257,B=lf(g,I+10,15)+4,U=N+lf(g,I+5,31)+1;I+=14;for(var K=new rc(U),z=new rc(19),G=0;G<B;++G)z[lG[G]]=lf(g,I+3*G,7);I+=3*B;var te=JB(z),ie=(1<<te)-1,Q=ng(z,te,1);for(G=0;G<U;){var ge,_e=Q[lf(g,I,ie)];if(I+=15&_e,(ge=_e>>>4)<16)K[G++]=ge;else{var Se=0,se=0;for(ge==16?(se=3+lf(g,I,3),I+=2,Se=K[G-1]):ge==17?(se=3+lf(g,I,7),I+=3):ge==18&&(se=11+lf(g,I,127),I+=7);se--;)K[G++]=Se}}var ee=K.subarray(0,N),Y=K.subarray(N);M=JB(ee),R=JB(Y),D=ng(ee,M,1),O=ng(Y,R,1)}else Cp(1);if(I>A){E&&Cp(0);break}}S&&w(T+131072);for(var ue=(1<<M)-1,ye=(1<<R)-1,V=I;;V=I){var le=(Se=D[QB(g,I)&ue])>>>4;if((I+=15&Se)>A){E&&Cp(0);break}if(Se||Cp(2),le<256)m[T++]=le;else{if(le==256){V=I,D=null;break}var he=le-254;if(le>264){var oe=P7[G=le-257];he=lf(g,I,(1<<oe)-1)+v5e[G],I+=oe}var ne=O[QB(g,I)&ye],ce=ne>>>4;if(ne||Cp(3),I+=15&ne,Y=fht[ce],ce>3&&(oe=k7[ce],Y+=QB(g,I)&(1<<oe)-1,I+=oe),I>A){E&&Cp(0);break}S&&w(T+131072);for(var Ae=T+he;T<Ae;T+=4)m[T]=m[T-Y],m[T+1]=m[T+1-Y],m[T+2]=m[T+2-Y],m[T+3]=m[T+3-Y];T=Ae}}v.l=D,v.p=V,v.b=T,v.f=C,D&&(C=1,v.m=M,v.d=O,v.n=R)}while(!C);return T==m.length?m:h8(m,0,T)}(f.subarray(function(g){g[0]==31&&g[1]==139&&g[2]==8||Cp(6,"invalid gzip data");var m=g[3],v=10;4&m&&(v+=g[10]|2+(g[11]<<8));for(var b=(m>>3&1)+(m>>4&1);b>0;b-=!g[v++]);return v+(2&m)}(f),-8),new rc(function(g){var m=g.length;return(g[m-4]|g[m-3]<<8|g[m-2]<<16|g[m-1]<<24)>>>0}(f)))}(Od(o))));const d=[];let h;try{const f=JSON.parse(Xf(u)),{ControlStatus:p,NameIndex:g,IsAutoJoinEnabled:m,IsBackToMainSessionEnabled:v,IsParticipantsChooseRoomEnabled:b,IsTimerEnabled:S,TimerDuration:E,IsTimerAutoEndEnabled:w,WaitSeconds:C,StartTimeOnMMR:I,ItemList:T,WhoStart:D,WhoStop:O,IsAutoMovetoMainSessionEnabled:M}=f,R={isAutoJoinRoom:m,isBackToMainSessionEnabled:v,isTimerEnabled:S,timerDuration:E,isTimerAutoEnabled:w,waitSeconds:C,isAutoMoveBackToMainSession:M,isRoomSelectionEnabled:b,whoStart:D,whoStop:O};d.push(sDe(R)),d.push(oDe(I)),d.push(N6(g)),d.push(aDe(p));const A=T&&T.map(k=>({boId:k.BID,name:k.MeetingTitle,boStatus:k.Status,hostId:k.HostID,attendeeGuidList:k.ParticipantList||[]}))||[];switch(d.push(YP(A)),me(o1,{controlStatus:p,roomList:A}),p){case Sr.InProgress:if(a!==Cn.InRoom&&a!==Cn.Joining){const k=function(L,j){const{meeting:{isHost:N,userGUID:B},breakoutRoom:{currentRoom:{status:U,boId:K}}}=j.value,z=rr.get(_ne),G=[];if(z)try{const{status:te,boId:ie}=JSON.parse(z);if(te===Cn.Invited)if(N)Mw();else{const Q=vf(L,B);Q&&(G.push(I5(Q)),U!==Cn.Initial&&K===Q.boId||me(O4,{roomId:Q.boId,name:Q.name}))}else if(te===Cn.InRoom){let Q;if(Q=N?L.find(ge=>ge.boId===ie):vf(L,B),Q){G.push(I5(Q));const ge=Q.boId;AS(j).subscribe(()=>{Gr.createAgent().joinBO(ge)})}Mw()}}catch(te){console.error(te)}return G}(A,e);if(k.length===0){const L=vf(A,l);L&&d.push(I5(L))}else d.push(...k)}else if(a===Cn.InRoom&&r.type===`${Um}`){const k=vf(A,l);k&&oH(e).subscribe(L=>{c===k.boId||L||uf.joinBO(k.boId)})}R.isTimerEnabled&&R.timerDuration>0&&(h=function(k,L,j){return oH(k).pipe(nn(k),zr(N=>{let[B,U]=N;const{breakoutRoom:{currentRoom:{status:K},meetingElapsedTime:z},meeting:{joinMeetingTimeStamp:G}}=U,te=G-1e3*z+1e3*j+1e3*L;if(performance.now()<te){if(B)return Wk(1e3).pipe(Vt(()=>Math.floor((te-performance.now())/1e3)),nn(k),S1(ie=>{let[Q,ge]=ie;const{breakoutRoom:{controlStatus:_e,currentRoom:{status:Se}},socket:{zoomSocketStatus:se},meeting:{isHost:ee}}=ge;return Q>=0&&ee&&_e===Sr.InProgress&&(Se===Cn.InRoom||Se===Cn.MainSession||Se===Cn.Initial)&&se===$i.Connected}),en(ie=>{let[Q]=ie;me(Gq,{countdown:Q})}),st(ie=>{let[Q]=ie;return Q===0}),en(ie=>{let[,Q]=ie;const{breakoutRoom:{options:ge}}=Q;ge.isTimerAutoEnabled?Gr.createAgent().stopBO(Sr.Closing):me(P3e)}),ht(()=>Mt));if(K===Cn.InRoom)return Wk(1e3).pipe(Vt(()=>Math.floor((te-performance.now())/1e3)),nn(k),S1(ie=>{let[Q,ge]=ie;const{breakoutRoom:{currentRoom:{status:_e}},meeting:{isHost:Se},socket:{zoomSocketStatus:se}}=ge;return Q>=0&&_e===Cn.InRoom&&!Se&&se===$i.Connected}),en(ie=>{let[Q]=ie;me(Gq,{countdown:Q})}),ht(()=>Mt))}return Mt}))}(e,R.timerDuration,I));break;case Sr.Closing:h=oH(e).pipe(st(k=>k),ht(()=>{const k=[],{breakoutRoom:{closingRoomTime:L,currentRoom:{status:j}},participants:{attendeesList:N}}=e.value;let B=R.waitSeconds;if(L!==0&&R.waitSeconds>0){const U=Math.floor((performance.now()-L)/1e3);B=Math.max(R.waitSeconds-U,0)}if(B===0)return uf.stopBO(Sr.Closed),Mt;{if(j!==Cn.InRoom&&N.length>1&&N.every(K=>!K.bid))return uf.stopBO(Sr.Closed),Mt;L||k.push(IK(performance.now()));const U=performance.now()+1e3*B;return ga(Tt(k),js(0,1e3).pipe(Vt(()=>Math.floor((U-performance.now())/1e3)),nn(e),S1(K=>{let[,z]=K;const{breakoutRoom:{controlStatus:G},meeting:{isHost:te},socket:{zoomSocketStatus:ie}}=z;return G===Sr.Closing&&ie===$i.Connected&&te}),en(K=>{let[z]=K;z>=0&&me(Kq,{countdown:z})}),st(K=>{let[z]=K;return z<=0}),en(()=>{uf.stopBO(Sr.Closed)}),ht(()=>Mt)))}}));break;case Sr.Closed:d.push(IK(0)),a===Cn.Leaving?d.push(aS(Cn.MainSession)):a===Cn.Invited?d.push(aS(Cn.Initial)):a!==Cn.InRoom&&a!==Cn.Joining||d.push(...pG()),Mw()}}catch(f){console.error(f)}return h?ga(Tt(d),h):Tt(d)})),epics3:(n,e)=>Uf(n,4194).pipe(nn(e),zr(t=>{let[r,i]=t;const{payload:{body:{bid:o,botoken:s,confID:a}}}=r,{meeting:{isHost:c},breakoutRoom:{rooms:l,currentRoom:{status:u}}}=i,d=[],h=l.find(f=>f.boId===o);return h&&(d.push(I5(h,c)),d.push(xK(a)),d.push(EK(s)),c||u!==Cn.InRoom?d.push(...rH(h.name,u)):d.push(...kge(h.name))),me(M4,{boId:o}),Tt(d)})),epics4:(n,e)=>n.pipe(rn(`${c_}`,`${Um}`),st(t=>t.payload.evt===7949),nn(e),ht(t=>{var r;let[i,o]=t;const{payload:{body:s}}=i,{meeting:{userGUID:a},breakoutRoom:{rooms:c,options:{isAutoJoinRoom:l,isAutoMovetoMainSession:u},currentRoom:{status:d},mainSessionAttendeeList:h},participants:{attendeesList:f}}=o,{commandType:p}=s,g=[];let m;const v=(r=(iH(d)?f:h).find(C=>C.userGUID===a))===null||r===void 0?void 0:r.userId;switch(p){case bb.Join:{const{targetBID:C,botoken:I,confID:T,joinReason:D,requestSourceID:O}=s,M=vf(c,a);if(M&&M.boId===C){g.push(xK(T)),g.push(EK(I));const R=Number(D)===Zat.Active&&v===Number(O);l||R?(R&&me(M4,{boId:C}),g.push(...rH(M.name))):(rr.set(Gi.WebclientBreakoutRoomCommand,p,ri.SessionStorage),me(O4,{roomId:C,name:M.name,...Tge(O,o)}))}break}case bb.Switch:{const{targetBID:C,botoken:I,confID:T,joinMethod:D,requestSourceID:O}=s,M=vf(c,a);if(M&&M.boId===C){g.push(F6({boId:M.boId,boToken:I,boConfId:T,name:M.name}));const R=v===Number(O)&&Number(D)===xde.AskToLeave;d===Cn.Invited?(rr.set(Gi.WebclientBreakoutRoomCommand,p,ri.SessionStorage),l||v===Number(O)?g.push(...rH(M.name)):me(O4,{roomId:C,name:M.name,...Tge(O,o)})):g.push(...kge(M.name)),R&&me(M4,{boId:C})}break}case bb.Leave:{const{waitTime:C,joinMethod:I}=s;if(iH(d))g.push(F6({boId:"",boToken:"",boConfId:"",status:Cn.Initial}));else{const T=Number(C);if(T>0){const D=performance.now()+1e3*T;m=js(0,1e3).pipe(Vt(()=>Math.floor((D-performance.now())/1e3)),nn(e),S1(O=>{let[M,R]=O;const{breakoutRoom:{controlStatus:A,currentRoom:{status:k}},meeting:{isHost:L},socket:{zoomSocketStatus:j}}=R;return M>=0&&j===$i.Connected&&A===Sr.Closing&&k===Cn.InRoom&&!L}),en(O=>{let[M]=O;M>=0&&me(Kq,{countdown:M})}),$n(Mt))}else if(Number(I)!==xde.AskToLeave||u)g.push(...pG());else{var b,S,E;const{requestSourceID:D}=s,O=Number(D),{participants:{attendeesList:M}}=o;let R=M.find(A=>A.userId===O);if(!R){const{breakoutRoom:{mainSessionAttendeeList:A}}=o;R=A.find(k=>k.userId===O)}me(D3e,{inviterId:(b=R)===null||b===void 0?void 0:b.userId,inviterGuid:(S=R)===null||S===void 0?void 0:S.userGUID,inviterName:(E=R)===null||E===void 0?void 0:E.displayName})}Mw()}break}case bb.Broadcast:{const{textContent:C,requestID:I}=s;if(C){const{meeting:{encType:T},participants:{attendeesList:D},breakoutRoom:{mainSessionAttendeeList:O}}=o;let M="";if(T===tD.AES_GCM){const R=(iH(d)?D:O).find(A=>A.userId===Number(I));R&&(M=R.zoomID)}m=Tt(zc.beginDecrypt({decryptedText:C,type:fc.BO_BROADCAST,zoomId:M}).then(R=>{let{message:A}=R;return me(E3e,{message:A}),lDe(A)}))}break}case bb.HelpReq:{const{requestID:C}=s,{breakoutRoom:{mainSessionAttendeeList:I,rooms:T,currentRoom:{boId:D},hostReplyToQuestionerType:O,hostReplyToRequestId:M},participants:{attendeesList:R}}=o;if(C){if(d===Cn.InRoom){const A=I.find(k=>k.userId===C);if(A&&A.bid===D){uf.askForHelpResultBO(C,m0.AlreadyInRoom);break}}if(O===m0.Received&&M!==C)uf.askForHelpResultBO(C,m0.Busy);else{uf.askForHelpResultBO(C,m0.Received),g.push(Kte(m0.Received),uDe(C));const A=(d===Cn.InRoom?I:R).find(k=>k.userId===C);if(A){const k=A.bid,L=T.find(j=>j.boId===k);L&&me(I3e,{userId:C,userGuid:A.userGUID,displayName:A.displayName,roomName:L.name,roomId:L.boId})}}}break}case bb.HelpRes:{const{helpResult:C}=s;me(Ate,{result:Number(C)});break}case bb.BOActivity:{var w;const{activityRoster:C,activityTalking:I,requestID:T}=s,D=(w=(zf(o)?o.breakoutRoom.mainSessionAttendeeList:o.participants.attendeesList).find(O=>O.userId===T))===null||w===void 0?void 0:w.userGUID;if(D){const{breakoutRoom:{rooms:O}}=o,M=vf(O,D),R=function(A,k){const L={isTalking:k===1};return Cht.forEach(j=>{const{mask:N,key:B,value:U}=j;return(N&A)===N&&Object.assign(L,{[`${B}`]:U}),L}),L}(Number(C),Number(I));g.push(pDe({userGuid:D,status:R})),me(R3e,{...R,userId:T,userGuid:D,roomId:M==null?void 0:M.boId,roomName:M==null?void 0:M.name})}break}}return m?ga(Tt(g),m):Tt(g)})),epics5:(n,e)=>w1(n,y7).pipe(nn(e),zr(t=>{let[r,i]=t;const{payload:{body:{res:o,elapsed:s}}}=r,a=[];return o===Eu.MeetingHasClosed||o===Eu.UserHasBeenRemoved?(Mw(),a.push(...Zw(i,!1))):o===Eu.Success&&(a.push(CK(s)),a.push(aS(Cn.InRoom)),rr.set(Gi.WebclientBreakoutRoomAttendeeStatus,JSON.stringify({status:Cn.InRoom,boId:i.breakoutRoom.currentRoom.boId}),ri.SessionStorage)),Tt(a)})),epics6:(n,e)=>w1(n,Co).pipe(Vt(t=>n8(t.payload.body)),nn(e),ht(t=>{let[r,i]=t;const o=[dDe(r)],{participants:{attendeesList:s},breakoutRoom:{mainSessionAttendeeList:a,isUserRoleUpdated:c},meeting:{userId:l}}=i;let u=[];return["add","update"].forEach(d=>r[d]&&u.push(...r[d])),u=u.filter(d=>Dge.some(h=>d[h]!==void 0)).map(d=>{const h=a.find(f=>f.userId===d.userId);if(h){const f=s.find(p=>p.zoomID===h.zoomID);if(f)return d.userRole===void 0||c||f.userId!==l||(o.push(kK(!0)),me(Zq,d)),d.bCCEditor!==void 0&&o.push(rDe({editorId:d.bCCEditor?f.userId:"",isEditor:!!d.bCCEditor,editorZoomId:d.bCCEditor?f.zoomID:""})),delete d.bRaiseHand,delete d.bCapsPinMultiVideo,{...d,userId:f.userId}}return null}).filter(d=>!!d),u.length>0&&(me(dg,u),o.push(g6({update:u}))),me(T3e),Tt(o)})),epics7:n=>w1(n,Md).pipe(st(e=>{const{payload:{body:t}}=e;return(t==null?void 0:t.bAllowAttendeeRename)!==void 0||(t==null?void 0:t.chatPriviledge)!==void 0||(t==null?void 0:t.lockShare)!==void 0}),Vt(e=>{const{payload:{body:t}}=e;return t.bAllowAttendeeRename!==void 0?QM(e.payload.body):t.chatPriviledge!==void 0?zte(t.chatPriviledge):t.lockShare!==void 0?Fte(t.lockShare):void 0})),epics8:(n,e)=>zt(n,Co).pipe(nn(e),st(t=>{let[,r]=t;const{meeting:{isHost:i},breakoutRoom:{controlStatus:o,currentRoom:{status:s}}}=r;return i&&o===Sr.Closing&&s!==Cn.InRoom}),bl(QT),en(()=>{const{participants:{attendeesList:t}}=e.value;t.every(r=>!r.bid)&&t.length>1&&uf.stopBO(Sr.Closed)}),$n(Mt)),epics9:(n,e)=>zt(n,4214).pipe(nn(e),zr(t=>{let[r,i]=t;const{payload:{body:{proto:o}}}=r,{breakoutRoom:{rooms:s,isHugeBO:a}}=i;try{const c=JSON.parse(Xf(o)),l=[];if(c&&c.PreAssignBoList&&Array.isArray(c.PreAssignBoList)){const u=c.PreAssignBoList.map(h=>({name:h.BoName,emails:h.email}));l.push(PK(u));const d=a?100:50;if(s.length+u.length<d){const h=u.map(f=>f.name);return uf.batchCreateBOToken(h),ga(Tt(l),gG(h.length).pipe(nn(e),ht(f=>{let[{boIdList:p},g]=f;const m=Yi(g),v=u.map((S,E)=>{const{emails:w,name:C}=S;let I=[];return w&&Array.isArray(w)&&(I=w.map(T=>m.filter(D=>D.userEmail===T).map(D=>D.userGUID)).reduce((T,D)=>[...T,...D],[])),{boId:p[E],name:C,attendeeGuidList:I}}),b=v.map((S,E)=>({roomId:S.boId,name:S.name,emails:u[E].emails}));return me(k3e,{rooms:b}),Tt([YP(v),PK(b)])})))}return Tt(l)}}catch{console.error("pre assign proto is not valid")}return Mt})),epics10:(n,e)=>Uf(n,Co).pipe(nn(e),st(t=>{let[r,i]=t;const{meeting:{isHost:o,meetingStatus:s,meetingOptions:a},breakoutRoom:{controlStatus:c}}=i,{payload:{body:l}}=r;return s===ws.Joined&&(a==null?void 0:a.isAllowBreakoutRoomPreAssign)&&o&&(c===Sr.NotStarted||c===Sr.InProgress)&&Array.isArray(l.add)}),ht(t=>{let[r,i]=t;const{breakoutRoom:{controlStatus:o,rooms:s,preAssignedRooms:a,currentRoom:{status:c}},participants:{failoverAttendeesList:l}}=i,u=a==null?void 0:a.filter(f=>s.findIndex(p=>p.boId===f.roomId)>-1),{payload:{body:{add:d}}}=r,h=[];return u.length>0&&d.filter(f=>f.userEmail&&f.userGUID).filter(f=>l.findIndex(p=>p.zoomID===f.zoomID)===-1).forEach(f=>{if(!vf(s,f.userGUID))for(let p=0;p<(u==null?void 0:u.length);p++){const g=u[p];if(g.emails.includes(f.userEmail)){if(o===Sr.NotStarted){const m=Pe(s,v=>{const b=v.find(S=>S.boId===g.roomId);b==null||b.attendeeGuidList.push(f.userGUID)});h.push(YP(m))}else o===Sr.InProgress&&(c===Cn.InRoom&&r.type===`${Um}`?uf.assignToBO(f.id,String(g.roomId)):c!==Cn.Initial&&c!==Cn.MainSession||uf.assignToBO(f.id,String(g.roomId)));break}}}),Tt(h)})),epics11:(n,e)=>zt(n,Co).pipe(st(t=>{const{breakoutRoom:{mainSessionAttendeeList:r}}=e.value,{payload:{body:i}}=t;return r.length>0&&(i.add!==void 0||i.update!==void 0)}),bl(Ag),Vt(t=>n8(t.payload.body)),ht(t=>{const{breakoutRoom:{mainSessionAttendeeList:r,isUserRoleUpdated:i},participants:{attendeesList:o}}=e.value;let s=[];const a=[];["add","update"].forEach(u=>t[u]&&s.push(...t[u]));const c=[...Dge,"isHost"];s=s.filter(u=>c.some(d=>u[d]!==void 0));const l=s.filter(u=>u.zoomID!==void 0);return s=s.map(u=>{var d,h,f,p;const g=(d=(h=u.zoomID)!==null&&h!==void 0?h:(f=l.find(m=>m.userId===u.userId))===null||f===void 0?void 0:f.zoomID)!==null&&d!==void 0?d:(p=o.find(m=>m.userId===u.userId))===null||p===void 0?void 0:p.zoomID;if(g){const m=r.find(v=>v.zoomID===g);if(m)return i||(a.push(kK(!0)),me(Zq,m)),Object.keys(u).filter(v=>Object.prototype.hasOwnProperty.call(u,v)).filter(v=>c.includes(v)).reduce((v,b)=>{const S=m[b];if(S!==void 0||b==="bCoHost"){const E=typeof u[b]=="boolean"?!!S:S;Object.assign(v,{[b]:E})}return v},{userId:u.userId})}}).filter(Boolean),s.length>0&&(me(dg,s),a.push(g6({update:s}))),Tt(a)})),epics12:n=>w1(n,7999).pipe(en(e=>{const{payload:{body:{bStatus:t}}}=e;me(A3e,{status:!!t})}),ht(()=>Mt)),epics13:(n,e)=>zt(n,7940).pipe(ht(t=>{const{payload:{body:{bHost:r}}}=t,{breakoutRoom:{isBroadcastVoice:i}}=e.value,o=[];return!r&&i&&(zn.getInstance().broadcastVoiceToBreakoutRoom(!1),o.push(j6(!1))),Tt(o)}))},Tht=iu(kht,Pht);let P5=function(n){return n[n.Ready=0]="Ready",n[n.UserSub=1]="UserSub",n[n.ManualCaptionerEnabled=2]="ManualCaptionerEnabled",n[n.ManualCaptionerDisabled=3]="ManualCaptionerDisabled",n}({}),kh=function(n){return n[n.Unspecified=-1]="Unspecified",n[n.English=0]="English",n[n["Chinese (Simplified)"]=1]="Chinese (Simplified)",n[n.Japanese=2]="Japanese",n[n.German=3]="German",n[n.French=4]="French",n[n.Russian=5]="Russian",n[n.Portuguese=6]="Portuguese",n[n.Spanish=7]="Spanish",n[n.Korean=8]="Korean",n[n.Italian=9]="Italian",n[n.Reserved=10]="Reserved",n[n.Vietnamese=11]="Vietnamese",n[n.Dutch=12]="Dutch",n[n.Ukrainian=13]="Ukrainian",n[n.Arabic=14]="Arabic",n[n["Chinese (Traditional)"]=16]="Chinese (Traditional)",n[n.Czech=17]="Czech",n[n.Estonian=18]="Estonian",n[n.Finnish=19]="Finnish",n[n.Hebrew=21]="Hebrew",n[n.Hindi=22]="Hindi",n[n.Hungarian=23]="Hungarian",n[n.Indonesian=24]="Indonesian",n[n.Malay=25]="Malay",n[n.Persian=26]="Persian",n[n.Polish=27]="Polish",n[n.Romanian=28]="Romanian",n[n.Swedish=29]="Swedish",n[n.Tamil=30]="Tamil",n[n.Telugu=31]="Telugu",n[n.Tagalog=32]="Tagalog",n[n.Turkish=33]="Turkish",n[n["French (Canada)"]=34]="French (Canada)",n[n.Danish=35]="Danish",n[n.Thai=37]="Thai",n[n.Cantonese=44]="Cantonese",n[n.NoTranslation=400]="NoTranslation",n[n.DefaultManualInput=401]="DefaultManualInput",n[n.Customized=500]="Customized",n}({}),Kv=function(n){return n[n.Unknown=0]="Unknown",n[n.Close=1]="Close",n[n.New=2]="New",n[n.Insert=3]="Insert",n[n.Delete=4]="Delete",n[n.Reset=5]="Reset",n[n.Audiodesc=6]="Audiodesc",n[n.Speaker=7]="Speaker",n[n.Error=8]="Error",n}({}),Age=function(n){return n[n.TranslateNotSupport=1]="TranslateNotSupport",n}({}),n0=function(n){return n[n.Unspecified=0]="Unspecified",n[n.InMeetingManual=1]="InMeetingManual",n[n.ExternalCaptioner=2]="ExternalCaptioner",n[n.ASR=4]="ASR",n}({});const tk={en:0,zh:1,ja:2,de:3,fr:4,ru:5,pt:6,es:7,ko:8,it:9,en1:10,vi:11,nl:12,uk:13,ar:14,"zh-hant":16,cs:17,et:18,fi:19,he:21,hi:22,hu:23,id:24,ms:25,fa:26,pl:27,ro:28,sv:29,ta:30,te:31,tl:32,tr:33,"fr-ca":34,da:35,th:37,"zh-yue":44},nk=Object.keys(kh).filter(n=>/\d+/.test(kh[n])).reduce((n,e)=>({...n,[`${kh[e]}`]:e}),{}),Oge=Object.keys(tk).reduce((n,e)=>(Object.assign(n,{[`${tk[`${e}`]}`]:e}),n),{}),eO="zoom-sdk-live-trasncription",wm="live-trasncription";(function(n){return n[n.English=0]="English",n[n.Chinese=1]="Chinese",n[n.Japanese=2]="Japanese",n[n.German=3]="German",n[n.French=4]="French",n[n.Russian=5]="Russian",n[n.Portuguese=6]="Portuguese",n[n.Spanish=7]="Spanish",n[n.Korean=8]="Korean",n[n.Italian=9]="Italian",n[n.Reserved=10]="Reserved",n[n.Vietnamese=11]="Vietnamese",n[n.Dutch=12]="Dutch",n[n.Ukrainian=13]="Ukrainian",n[n.Arabic=14]="Arabic",n[n["Chinese (Traditional)"]=16]="Chinese (Traditional)",n[n.Czech=17]="Czech",n[n.Estonian=18]="Estonian",n[n.Finnish=19]="Finnish",n[n.Hebrew=21]="Hebrew",n[n.Hindi=22]="Hindi",n[n.Hungarian=23]="Hungarian",n[n.Indonesian=24]="Indonesian",n[n.Malay=25]="Malay",n[n.Persian=26]="Persian",n[n.Polish=27]="Polish",n[n.Romanian=28]="Romanian",n[n.Swedish=29]="Swedish",n[n.Tamil=30]="Tamil",n[n.Telugu=31]="Telugu",n[n.Tagalog=32]="Tagalog",n[n.Turkish=33]="Turkish",n[n["French (Canada)"]=34]="French (Canada)",n[n.Danish=35]="Danish",n[n.Thai=37]="Thai",n[n.Cantonese=44]="Cantonese",n[n.NoTranslation=400]="NoTranslation",n[n.DefaultManualInput=401]="DefaultManualInput",n})({});(function(n){return n.English="en",n["Chinese (Simplified)"]="zh",n.Japanese="ja",n.German="de",n.French="fr",n.Russian="ru",n.Portuguese="pt",n.Spanish="es",n.Korean="ko",n.Italian="it",n.Reserved="en1",n.Vietnamese="vi",n.Dutch="nl",n.Ukrainian="uk",n.Arabic="ar",n["Chinese (Traditional)"]="zh-hant",n.Czech="cs",n.Estonian="et",n.Finnish="fi",n.Hebrew="he",n.Hindi="hi",n.Hungarian="hu",n.Indonesian="id",n.Malay="ms",n.Persian="fa",n.Polish="pl",n.Romanian="ro",n.Swedish="sv",n.Tamil="ta",n.Telugu="te",n.Tagalog="tl",n.Turkish="tr",n["French (Canada)"]="fr-ca",n.Danish="da",n.Thai="th",n.Cantonese="zh-yue",n})({});function rk(n){const e=n===kh.Unspecified?kh.Reserved:n;zn.getInstance().selectLanguageChannelForNewLTT(e)}const Dht=U3e(H3e,function(n,e){return VRe(n,e)})([Yi,n=>{let{meeting:{gatewayUserList:e}}=n;return e}],(n,e)=>{const t={};return n.forEach(r=>{Object.assign(t,{[`${r.userId}`]:r.zoomID})}),e==null||e.forEach(r=>{Object.assign(t,{[`${r.userId}`]:r.sn})}),t}),Mge=Eo([Yi],n=>n.find(e=>e.bCCEditor===!0)),Rht=Eo([Yi,z3e],(n,e)=>n.some(t=>t.bCCEditor===!0&&t.userId===e)),$ge=Gr.createAgent(),sH={isEnableTranslatedCaptions:!1,isHostLockSpeakingLanguage:!1,transcriptionLang:[],isEnableAutomatedCaptions:!1,supportedTranscriptionLanguage:[],isLiveTranscriptionEnabled:!1,isHostDisableCaptions:!1,isManualCaptionerEnabled:!1,gatewayId:void 0,isLiveTranscriptionSubscribed:!1,messageRecords:[],isRecordsReduced:!1,reducedRecordsCount:0},Aht=ru({[`${IDe}`]:Pe((n,e)=>{let{payload:t}=e;n.isLiveTranscriptionEnabled=t}),[`${PDe}`]:Pe((n,e)=>{let{payload:t}=e;const{transcriptionLang:r,translatedSetting:i,...o}=t;r&&(n.transcriptionLang=r.split(";").map(s=>{const a=s&&tk[s];return a!==void 0?{lang:s,code:a}:null}).filter(Boolean)),i&&(n.translatedSetting=Object.keys(i).map(s=>{const a=i[s];if(a){const c=a.split(";").map(l=>{const u=l&&tk[l];return u!==void 0?{lang:l,code:u}:null}).filter(Boolean);return{lang:s,code:tk[s],translatedToLanguage:c}}return null}).filter(Boolean)),Object.assign(n,o)}),[`${DK}`]:Pe((n,e)=>{let{payload:t}=e;n.isManualCaptionerEnabled=t}),[`${kDe}`]:Pe((n,e)=>{let{payload:t}=e;n.gatewayId=t}),[`${LDe}`]:Pe((n,e)=>{let{payload:t}=e;n.isHostDisableCaptions=t}),[`${TDe}`]:Pe((n,e)=>{let{payload:t}=e;n.supportedTranscriptionLanguage=t}),[`${x1}`]:Pe((n,e)=>{let{payload:t}=e;n.currentTranscriptionLang=t}),[`${B6}`]:Pe((n,e)=>{let{payload:t}=e;n.currentTranslationLang=t}),[`${AK}`]:Pe((n,e)=>{let{payload:t}=e;n.messageRecords.push(t)}),[`${DDe}`]:Pe((n,e)=>{let{payload:t}=e;const r=n.messageRecords.find(i=>i.msgId===t.msgId);r&&Object.assign(r,t)}),[`${RDe}`]:Pe((n,e)=>{let{payload:t}=e;const{remains:r,reducedRecordsCount:i}=t,o=n.messageRecords.length-r;n.isRecordsReduced=!0,n.reducedRecordsCount=i,n.messageRecords.splice(0,o)}),[`${RK}`]:Pe((n,e)=>{let{payload:t}=e;n.isLiveTranscriptionSubscribed=t}),[`${ADe}`]:Pe((n,e)=>{let{payload:t}=e;n.liveTransEngineType=t}),[`${ODe}`]:Pe(n=>{n.stateBeforeFailover=void 0}),[`${MDe}`]:Pe((n,e)=>{let{payload:t}=e;n.lastManualCaption=t}),[`${$De}`]:(n,e)=>{let{payload:t}=e;return t?{...sH,stateBeforeFailover:{currentTranscriptionLang:n.currentTranscriptionLang,currentTranslationLang:n.currentTranslationLang,isLiveTranscriptionSubscribed:n.isLiveTranscriptionSubscribed},messageRecords:n.messageRecords,isRecordsReduced:n.isRecordsReduced,reducedRecordsCount:n.reducedRecordsCount}:{...sH}}},sH);var Do;const lh=Gr.createAgent(),Gv=Nu("Live transcription");let Oht=(Do=class extends Og{startLiveTranscription(){const{[Qt]:n,[Qo]:e}=this,{liveTranscription:{isLiveTranscriptionEnabled:t,isEnableTranslatedCaptions:r,isLiveTranscriptionSubscribed:i,isHostLockSpeakingLanguage:o,isHostDisableCaptions:s}}=n();return i?Promise.resolve(""):s?Promise.reject({type:lt,reason:"Captions has been disabled by host."}):t?(lh.enableNewLLT(),Un(Tf).then(()=>(o?lh.setSpokenLanguage(kh.English):rk(kh.Unspecified),e(x1(kh.English)),r&&lh.setTranslationLanguage(),Un({event:Tf,operations:[st(a=>a.autoCaption===!0&&a.lang!==void 0)]})))):Promise.reject({type:lt,reason:"Live transcription is not enabled."})}disableCaptions(n){const{[Qt]:e}=this,{liveTranscription:{isHostDisableCaptions:t}}=e();return n?t?Promise.resolve():(lh.disableCaptions(!0),Un(r6)):t?(lh.disableCaptions(!1),Un(r6)):Promise.resolve()}setSpeakingLanguage(n){const{[Qt]:e,[Qo]:t}=this,{liveTranscription:{isLiveTranscriptionSubscribed:r,isHostLockSpeakingLanguage:i,transcriptionLang:o}}=e(),s=o.find(a=>a.lang===n);if(s){const{code:a}=s;return r?(i?lh.setSpokenLanguage(a):rk(a),t(x1(a)),Promise.resolve("")):Promise.reject({type:lt,reason:"Cannot set speaking language before starting live transcription"})}return Promise.reject({type:Jn,reason:"Unsupported transcription language"})}setTranslationLanguage(n){const{[Qt]:e,[Qo]:t}=this,r=e(),{liveTranscription:{isEnableTranslatedCaptions:i,isLiveTranscriptionSubscribed:o,translatedSetting:s,currentTranscriptionLang:a}}=r;if(!i)return Promise.reject({type:lt,reason:"Live translation is not enabled."});if(!o)return Promise.reject({type:lt,reason:"Cannot set translation language before starting live transcription"});if(n){const c=s==null?void 0:s.find(l=>l.code===a);if(c){const{translatedToLanguage:l}=c,u=l.find(d=>d.lang===n);if(u)return lh.setTranslationLanguage(u.code),Un({event:Tf,operations:[st(d=>d.autoCaption===!0&&d.lang===u.code),Ur(1)]},d=>{let{lang:h}=d;return h===u.code})}return Promise.reject({type:lt,reason:`Cannot support translating ${nk[a||0]} to ${n}`})}return lh.setTranslationLanguage(),t(B6(void 0)),Promise.resolve("")}enableManualCaptioner(){const{[Qt]:n}=this,{meeting:{meetingOptions:e},liveTranscription:{isManualCaptionerEnabled:t,isHostDisableCaptions:r}}=n();if(r)return Promise.reject({type:lt,reason:"Captions has been disabled by host."});const{isEnableManualCaptions:i,isEnableClosedCaption:o}=e;return i??o?t?Promise.resolve():(lh.enableManualCaption(!0),Un(Tf,s=>{let{autoCaption:a}=s;return a===!1})):Promise.reject({type:lt,reason:"Manual caption is not enabled."})}disableManualCaptioner(){const{[Qt]:n}=this,{liveTranscription:{isManualCaptionerEnabled:e}}=n();return e?(lh.enableManualCaption(!1),Un(Tf,t=>{let{autoCaption:r}=t;return r===!0})):Promise.resolve()}assignManualCaption(n){var e;const{[Qt]:t}=this,r=t(),{liveTranscription:{isManualCaptionerEnabled:i},participants:{attendeesList:o},meeting:{userId:s}}=r;return i?((e=Mge(r))===null||e===void 0?void 0:e.userId)===n?Promise.resolve(""):o.find(c=>c.userId===n)?(lh.assignCC(n,!0),Un({event:s===n?ql:dg,operations:[st(c=>c.userId===n),Ur(1)]},c=>c.bCCEditor===!0)):Promise.reject({type:Jn,reason:"Cannot find the user"}):Promise.reject({type:lt,reason:"Cannot assign caption editor due to the manual captioner is not enabled."})}sendCaptionTextManually(n,e){var t;const{[Qt]:r,[Qo]:i}=this,o=r(),{liveTranscription:{lastManualCaption:s},meeting:{userId:a}}=o,c=mn(o);let l=Promise.resolve();const u=(t=Mge(o))===null||t===void 0?void 0:t.userId;return c!=null&&c.isHost&&u!==a&&(l=this.assignManualCaption(a)),l.then(()=>Rht(r())?function(d,h,f){const p=d.length,g=[];var m;if(f)g.push({op:"close",text:d,msgId:(m=h==null?void 0:h.msgId)!==null&&m!==void 0?m:XM()});else if(h&&h!=null&&h.text){const v=h.text.length;let b=0,S=0;for(;d[b]===h.text[b]&&b<p;)S+=DPe(d[b]),b+=1;b===v&&b===p?g.push({op:"same"}):b===v&&b<p?g.push({op:"insert",text:d.slice(b),size:0,pos:S,msgId:h.msgId}):b<v&&b===p?g.push({op:"delete",size:0,pos:S,msgId:h.msgId}):(g.push({op:"delete",size:0,pos:S,msgId:h.msgId}),g.push({op:"insert",text:d.slice(b),pos:S,msgId:h.msgId}))}else p>0&&g.push({op:"start",text:d,pos:0,size:0,msgId:XM()});return g.filter(v=>v.op!=="same")}(n,s,e):Promise.reject({type:Oc,reason:"Cannot type caption "})).then(d=>Array.isArray(d)?(d.forEach(h=>{const{text:f,...p}=h;zc.beginEncrypt({text:f??"",type:fc.CC_MESSAGE}).then(g=>{lh.sendManualCaption({text:g,...p});const m=e?void 0:{text:f,msgId:h.msgId};i(MDe(m))})}),Un(VP,h=>h.source===n0.InMeetingManual)):"")}getLiveTranscriptionStatus(){const{[Qt]:n}=this,{liveTranscription:{isLiveTranscriptionEnabled:e,isEnableTranslatedCaptions:t,isManualCaptionerEnabled:r,transcriptionLang:i,translatedSetting:o,isHostDisableCaptions:s}}=n();return{isLiveTranscriptionEnabled:e,isLiveTranslationEnabled:t,isHostDisableCaptions:s,isManualCaptionerEnabled:r,transcriptionLanguage:i.map(a=>a.lang).join(";"),translationLanguage:o==null?void 0:o.map(a=>({speakingLanguage:a.lang,translatedToLanguage:a.translatedToLanguage.map(c=>c.lang).join(";")}))}}getLiveTranscriptionSetting(){const{[Qt]:n}=this,{meeting:{meetingOptions:e}}=n(),{isEnableManualCaptions:t,isEnableLiveTranscription:r,isEnableClosedCaption:i,isEnableAllowThirdPartyCCToken:o,isEnableViewFullTranscript:s,isEnableSaveCaptions:a}=e||{};return{isEnableManualCaptions:t,isEnableLiveTranscription:r,isEnableClosedCaption:i,isEnableAllowThirdPartyCCToken:o,isEnableViewFullTranscript:s,isEnableSaveCaptions:a}}getCurrentTranscriptionLanguage(){const{[Qt]:n}=this,{liveTranscription:{currentTranscriptionLang:e}}=n();return e!==void 0?{code:Oge[e],name:nk[e]}:null}getCurrentTranslationLanguage(){const{[Qt]:n}=this,{liveTranscription:{currentTranslationLang:e}}=n();return e!==void 0?{code:Oge[e],name:nk[e]}:null}getLatestTranscription(){const{[Qt]:n}=this,{liveTranscription:{messageRecords:e,isManualCaptionerEnabled:t}}=n(),r=t?kh.DefaultManualInput:kh.NoTranslation,i=e.filter(o=>o.language===r);return i.length?i[i.length-1].text:""}getLatestTranslation(){const{[Qt]:n}=this,{liveTranscription:{messageRecords:e,currentTranslationLang:t,isEnableTranslatedCaptions:r}}=n();if(r||t!==void 0){const i=e.filter(o=>o.language===t);return i.length?i[i.length-1].text:""}return""}getFullTranscriptionHistory(){const{[Qt]:n}=this,e=n(),{liveTranscription:{messageRecords:t,isRecordsReduced:r}}=e;return r?function(i){return window.indexedDB!==void 0?new Promise(o=>{const s=window.indexedDB.open(eO,1);s.addEventListener("success",()=>{const a=s.result;if(a.objectStoreNames.contains(wm)){const c=a.transaction([wm],"readonly").objectStore(wm),l=[],u=i.meeting.meetingId,d=c.openCursor();d.onsuccess=()=>{const h=d.result;h?(h.value.mid===u&&l.push(...h.value.records),h.continue()):(o(l),a.close())}}else o("")})}):Promise.resolve("")}(e).then(i=>Array.isArray(i)?i.concat(t):[...t]):[...t]}getManualCaptionEditor(){const{[Qt]:n}=this,e=n(),{closedCaption:{editorId:t}}=e;let r;if(!t)return{};if(r=Yi(e).find(u=>u.userId===t),!r)return{};const{userId:i,isHost:o,displayName:s,avatar:a,bCoHost:c,zoomID:l}=r;return{userId:i,isHost:o,displayName:s,avatar:a,bCoHost:c,zoomID:l}}getManualCaptionUrl(){const{[Qt]:n}=this,{meeting:{meetingOptions:e,ccUrl:t}}=n(),{isEnableManualCaptions:r}=e||{};return r?t:(console.warn("you not enable manual caption"),"")}},gt(Do.prototype,"startLiveTranscription",[yt,Gv],Object.getOwnPropertyDescriptor(Do.prototype,"startLiveTranscription"),Do.prototype),gt(Do.prototype,"disableCaptions",[Na,yt,Gv],Object.getOwnPropertyDescriptor(Do.prototype,"disableCaptions"),Do.prototype),gt(Do.prototype,"setSpeakingLanguage",[yt,Gv],Object.getOwnPropertyDescriptor(Do.prototype,"setSpeakingLanguage"),Do.prototype),gt(Do.prototype,"setTranslationLanguage",[yt,Gv],Object.getOwnPropertyDescriptor(Do.prototype,"setTranslationLanguage"),Do.prototype),gt(Do.prototype,"enableManualCaptioner",[Na,yt,Gv],Object.getOwnPropertyDescriptor(Do.prototype,"enableManualCaptioner"),Do.prototype),gt(Do.prototype,"disableManualCaptioner",[Na,yt,Gv],Object.getOwnPropertyDescriptor(Do.prototype,"disableManualCaptioner"),Do.prototype),gt(Do.prototype,"assignManualCaption",[yt,Na,Gv],Object.getOwnPropertyDescriptor(Do.prototype,"assignManualCaption"),Do.prototype),gt(Do.prototype,"sendCaptionTextManually",[yt,Gv],Object.getOwnPropertyDescriptor(Do.prototype,"sendCaptionTextManually"),Do.prototype),Do);const Mht={epics0:n=>n.pipe(rn(`${Hh}`),Vt(e=>{const{payload:{liveTranscription:t}}=e;return PDe(t)})),epics1:(n,e)=>zt(n,Md).pipe(st(t=>{var r,i;return((r=t.payload.body)===null||r===void 0?void 0:r.NewLttAvaliable)!==void 0||((i=t.payload.body)===null||i===void 0?void 0:i.LiveTransEngineType)!==void 0}),Vt(t=>{const{payload:{body:{NewLttAvaliable:r,LiveTransEngineType:i}}}=t,{liveTranscription:{isEnableAutomatedCaptions:o}}=e.value;return r!==void 0?(me(uke,!!r),IDe(o&&!!r)):ADe(i)})),epics2:(n,e)=>zt(n,7982).pipe(ht(t=>{const{payload:{body:{status:r,gwId:i}}}=t,o=[];switch(r){case P5.Ready:o.push(kDe(i));break;case P5.ManualCaptionerEnabled:me(Tf,{autoCaption:!1}),o.push(DK(!0));break;case P5.ManualCaptionerDisabled:me(Tf,{autoCaption:!0}),o.push(rDe({editorId:"",isEditor:!1,editorZoomId:""})),o.push(DK(!1));break;case P5.UserSub:{me(Tf,{autoCaption:e.value.liveTranscription.isLiveTranscriptionEnabled});const{liveTranscription:{stateBeforeFailover:a}}=e.value;if(a!=null&&a.isLiveTranscriptionSubscribed){var s;$ge.enableNewLLT();const c=(s=a.currentTranscriptionLang)!==null&&s!==void 0?s:kh.Unspecified;rk(c),o.push(x1(c)),a.currentTranslationLang!==void 0&&$ge.setTranslationLanguage(a.currentTranslationLang),o.push(ODe())}break}}return Tt(o)})),epics3:n=>zt(n,7984).pipe(Vt(e=>{const{payload:{body:{langs:t}}}=e;return TDe(t)})),epics4:n=>zt(n,8011).pipe(ht(e=>{const{payload:{body:{disabled:t}}}=e,r=[];return me(r6,t),r.push(LDe(t)),t&&r.push(RK(!1)),Tt(r)})),epics5:n=>zt(n,7985).pipe(st(e=>{var t;return((t=e.payload.body)===null||t===void 0?void 0:t.success)===!0}),ht(e=>{const{payload:{body:{src:t,lang:r,success:i}}}=e,o=[];return i&&o.push(RK(!0)),t===n0.ASR?(r===kh.NoTranslation?o.push(B6(void 0)):o.push(B6(r)),me(Tf,{autoCaption:!0,lang:r})):[n0.InMeetingManual,n0.ExternalCaptioner].includes(t)&&me(Tf,{autoCaption:!1}),Tt(o)})),epics6:(n,e)=>zt(n,7986).pipe(nn(e),ht(t=>{let[r,i]=t;const o=mn(i),{liveTranscription:{currentTranscriptionLang:s}}=i,{payload:{body:a}}=r,c=[];if((a==null?void 0:a.lang)!==void 0){const{lang:l}=a;(o==null?void 0:o.audio)==="computer"&&s!==l&&rk(l),c.push(x1(l))}return Tt(c)})),epics7:(n,e)=>Vn(n,bt.JoinComputerAudioComplete).pipe(st(()=>e.value.liveTranscription.isLiveTranscriptionSubscribed),en(()=>{const{liveTranscription:{currentTranscriptionLang:t}}=e.value;t&&rk(t)}),$n(Mt)),epics8:(n,e)=>zt(n,7983).pipe(st(t=>t.payload.body!==void 0),ht(t=>{const{payload:{body:{msgType:r,errorCode:i,language:o,source:s,content:a,keyNodeId:c,msgId:l,nodeId:u,pos:d,size:h,audioLanguage:f}}}=t;if(r===Kv.Error){if(i===Age.TranslateNotSupport){const{liveTranscription:{currentTranslationLang:p}}=e.value;p&&me(VP,{error:Age.TranslateNotSupport,errorMessage:`${nk[f]} to ${nk[p]} translation is not supported!`,audioLanguage:f,translationLang:p})}}else{const p=e.value,g=Yi(p),{liveTranscription:{isManualCaptionerEnabled:m}}=p;if(m&&s===n0.ASR)return Promise.resolve();if(function(v,b){const{liveTranscription:{isEnableTranslatedCaptions:S,isLiveTranscriptionEnabled:E},meeting:{meetingOptions:w}}=b,{isEnableManualCaptions:C,isEnableAllowHostAssignTypeCC:I,isEnableClosedCaption:T,isEnableAllowThirdPartyCCToken:D}=w;return v===n0.ASR?S||E:v===n0.InMeetingManual?C&&I||C===void 0&&T:v===n0.ExternalCaptioner?D:void 0}(s,p)&&a&&c){const v=Dht(p)[c];if(v)return zc.beginDecrypt({decryptedText:a,type:fc.CC_MESSAGE,zoomId:v}).then(b=>{let{message:S}=b;const{liveTranscription:{messageRecords:E}}=e.value,w=[],C=E.find(I=>I.msgId===l);if(C){const{text:I}=C,T=((O,M)=>{if(!O||M===0)return"";let R=0;for(let A=0;A<O.length;A++)if(R+=DPe(O[A]),R===M)return O.slice(0,A+1);return O})(I,d);let D;r===Kv.Insert&&h===0||r===Kv.Delete&&h===0?D={...C,text:T+S,msgType:r}:r===Kv.Close&&(D={...C,text:S,msgType:r,done:!0}),D&&(w.push(DDe(D)),me(VP,D))}else if([Kv.New,Kv.Close].includes(r)||m&&r===Kv.Insert){const I=g.find(D=>D.userId===u),T={msgId:l,userId:u,displayName:I==null?void 0:I.displayName,avatar:I==null?void 0:I.avatar,text:S,source:s,language:o,timestamp:new Date().getTime(),done:r===Kv.Close};w.push(AK({...T,msgType:r})),me(VP,T)}return w})}}return Promise.resolve()}),ht(t=>Array.isArray(t)?Tt(t):Mt)),epics9:(n,e)=>n.pipe(rn(`${AK}`),bl(QT),ht(()=>{const{liveTranscription:{messageRecords:t}}=e.value;return t.length>=1e5?function(r){const{meeting:{meetingId:i},liveTranscription:{messageRecords:o,reducedRecordsCount:s}}=r;return window.indexedDB!==void 0?new Promise(a=>{const c=window.indexedDB.open(eO,1);c.addEventListener("upgradeneeded",()=>{const l=c.result;if(!l.objectStoreNames.contains(wm)){const u=l.createObjectStore(wm,{keyPath:["startIndex","mid"],autoIncrement:!1});u.createIndex("mid","mid",{unique:!1}),u.transaction.oncomplete=()=>{console.log(`Create objectStore [${wm}] complete`)}}}),c.addEventListener("success",()=>{const l=c.result,u=o.length,d=.9*u,h=u-d,f=o.slice(0,d),p=s+f.length,g=l.transaction([wm],"readwrite");g.objectStore(wm).put({startIndex:s,mid:i,records:f}),g.oncomplete=()=>{a(RDe({remains:h,reducedRecordsCount:p})),l.close()},g.onerror=()=>{a(""),l.close()}})}):Promise.resolve("")}(e.value):Promise.resolve("")}),st(t=>typeof t=="object")),epics10:(n,e)=>n.pipe(rn(`${IS}`,`${N2}`),st(()=>e.value.liveTranscription.isRecordsReduced),en(()=>{(function(){if(window.indexedDB!==void 0){const t=window.indexedDB.open(eO,1);t.addEventListener("success",()=>{const r=t.result;r.objectStoreNames.contains(wm)&&(window.indexedDB.deleteDatabase(eO),r.close())})}})()}),$n(Mt)),epics11:(n,e)=>Vn(n,[bt.AudiobridgeSetCcLangSuccess,bt.AudiobridgeSetCcLangFailure]).pipe(ht(t=>{const{payload:{type:r,data:i}}=t,{liveTranscription:{currentTranscriptionLang:o}}=e.value,s=[];return r===bt.AudiobridgeSetCcLangSuccess&&i!==o?s.push(x1(i)):r===bt.AudiobridgeSetCcLangFailure&&s.push(x1(void 0)),Tt(s)}))},$ht=iu(Mht),Lge={isLiveStreamEnable:!1,status:0},Lht=ru({[`${FDe}`]:Pe((n,e)=>{let{payload:t}=e;n.isLiveStreamEnable=t}),[`${U6}`]:Pe((n,e)=>{let{payload:t}=e;n.status=t}),[`${jDe}`]:(n,e)=>{let{payload:t}=e;return t?{...n}:{...Lge}}},Lge);let Zv=function(n){return n[n.Ended=0]="Ended",n[n.InProgress=1]="InProgress",n[n.Connecting=2]="Connecting",n[n.Timeout=3]="Timeout",n}({});var Rb;const Nge=Gr.createAgent();let Nht=(gt((Rb=class extends Og{startLiveStream(n,e,t){const{[Qt]:r,[Qo]:i}=this,{liveStream:{isLiveStreamEnable:o,status:s}}=r();return s===Zv.InProgress?Promise.reject({type:lt,reason:"Live stream is already on"}):o?n&&e&&t?(Nge.startLiveStream(n,e,t),Un({event:ZP,operations:[st(a=>a===Zv.InProgress),Ur(1)]},void 0,3e4).then(()=>"").catch(()=>{const{liveStream:{status:a}}=r();return a===Zv.Connecting?(me(ZP,Zv.Timeout),i(U6(Zv.Timeout)),Promise.reject({type:Nf})):Promise.resolve("")})):Promise.reject({type:Jn,reason:"parameter cannot be empty"}):Promise.reject({type:lt,reason:"Live stream is not enabled"})}stopLiveStream(){const{[Qt]:n,[Qo]:e}=this,{liveStream:{status:t}}=n();return t===Zv.InProgress&&(Nge.stopLiveStream(),me(ZP,Zv.Ended),e(U6(Zv.Ended))),Promise.resolve("")}isLiveStreamEnabled(){var n;const{[Qt]:e}=this;return!((n=e().liveStream)===null||n===void 0||!n.isLiveStreamEnable)}getLiveStreamStatus(){var n;const{[Qt]:e}=this;return(n=e().liveStream)===null||n===void 0?void 0:n.status}}).prototype,"startLiveStream",[Na],Object.getOwnPropertyDescriptor(Rb.prototype,"startLiveStream"),Rb.prototype),gt(Rb.prototype,"stopLiveStream",[Na],Object.getOwnPropertyDescriptor(Rb.prototype,"stopLiveStream"),Rb.prototype),Rb);const Fht=iu({epics0:n=>n.pipe(rn(`${Hh}`),Vt(e=>{const{payload:{liveStreamInfo:t}}=e;return FDe(!(t==null||!t.isEnabledLiveStream))})),epics1:n=>zt(n,7970).pipe(Vt(e=>{const{payload:{body:{channelName:t,liveStreamOn:r,isApiCall:i,status:o,viewerUrl:s}}}=e;return me(ZP,o),U6(o)}))}),{setSummaryEnable:S5e,setSmartSummaryStatus:_5e,resetSummary:jht}=Sa("SET_SUMMARY_ENABLE","SET_SMART_SUMMARY_STATUS","RESET_SUMMARY"),{setMeetingQueryEnable:w5e,setMeetingQueryStatus:C5e}=Sa("SET_MEETING_QUERY_ENABLE","SET_MEETING_QUERY_STATUS");let b0=function(n){return n.Default="",n.Start="Start",n.Paused="Paused",n.Stopped="Stopped",n}({}),j0=function(n){return n[n.GW_IND_NONE=0]="GW_IND_NONE",n[n.GW_IND_START=1]="GW_IND_START",n[n.GW_IND_PAUSE=2]="GW_IND_PAUSE",n[n.GW_IND_STOP=3]="GW_IND_STOP",n}({}),S0=function(n){return n.Default="",n.Start="Start",n.Paused="Paused",n.Stopped="Stopped",n}({}),B0=function(n){return n[n.GW_IND_NONE=0]="GW_IND_NONE",n[n.GW_IND_START=1]="GW_IND_START",n[n.GW_IND_PAUSE=2]="GW_IND_PAUSE",n[n.GW_IND_STOP=3]="GW_IND_STOP",n}({});const Fge={summaryStatus:j0.GW_IND_STOP,summaryEnable:!1,meetingQueryStatus:B0.GW_IND_STOP,meetingQueryEnable:!1},Bht=ru({[`${S5e}`]:Pe((n,e)=>{let{payload:t}=e;n.summaryEnable=t}),[`${_5e}`]:Pe((n,e)=>{let{payload:t}=e;n.summaryStatus=t}),[`${w5e}`]:Pe((n,e)=>{let{payload:t}=e;n.meetingQueryEnable=t}),[`${C5e}`]:Pe((n,e)=>{let{payload:t}=e;n.meetingQueryStatus=t}),[`${jht}`]:()=>({...Fge})},Fge);var jge,Bge,Hge,Uge,cd;const k5=Gr.createAgent();let Hht=(jge=Yt("summary"),Bge=Yt("summary"),Hge=Yt("summary"),Uge=Yt("summary"),gt((cd=class extends Og{startSummary(){const n=this[Qt](),{summary:{summaryEnable:e,summaryStatus:t}}=n;return e?t===j0.GW_IND_START?Promise.resolve(""):(k5.summaryMeeting(!0),Un(p0,r=>r.status===b0.Start)):Promise.reject({type:lt,reason:"The account of the meeting disabled the smart summary"})}stopSummary(){const n=this[Qt](),{summary:{summaryStatus:e}}=n;return e!==j0.GW_IND_START?Promise.resolve("not start summary, do nothing"):(k5.summaryMeeting(!1),Un(p0,t=>t.status===b0.Stopped))}getSummaryStatus(){const n=this[Qt](),{summary:{summaryStatus:e}}=n;return e===j0.GW_IND_START?b0.Start:e===j0.GW_IND_STOP?b0.Stopped:b0.Default}isSummaryEnabled(){const n=this[Qt](),{summary:{summaryEnable:e}}=n;return e}startMeetingQuery(){const n=this[Qt](),{summary:{meetingQueryEnable:e,meetingQueryStatus:t}}=n;return e?t===B0.GW_IND_START?Promise.resolve(""):(k5.startMeetingQuery(!0),Un(g0,r=>r.status===S0.Start)):Promise.reject({type:lt,reason:"The account of the meeting disabled the smart summary"})}stopMeetingQuery(){const n=this[Qt](),{summary:{meetingQueryStatus:e}}=n;return e!==B0.GW_IND_START?Promise.resolve("not start meeting query, do nothing"):(k5.startMeetingQuery(!1),Un(g0,t=>t.status===S0.Stopped))}getMeetingQueryStatus(){const n=this[Qt](),{summary:{meetingQueryStatus:e}}=n;return e===B0.GW_IND_START?S0.Start:e===B0.GW_IND_STOP?S0.Stopped:S0.Default}isMeetingQueryEnabled(){const n=this[Qt](),{summary:{meetingQueryEnable:e}}=n;return e}}).prototype,"startSummary",[Na,yt,jge],Object.getOwnPropertyDescriptor(cd.prototype,"startSummary"),cd.prototype),gt(cd.prototype,"stopSummary",[Na,yt,Bge],Object.getOwnPropertyDescriptor(cd.prototype,"stopSummary"),cd.prototype),gt(cd.prototype,"startMeetingQuery",[Na,yt,Hge],Object.getOwnPropertyDescriptor(cd.prototype,"startMeetingQuery"),cd.prototype),gt(cd.prototype,"stopMeetingQuery",[Na,yt,Uge],Object.getOwnPropertyDescriptor(cd.prototype,"stopMeetingQuery"),cd.prototype),cd);const Uht=iu({moduleEpics0:n=>zt(n,8007).pipe(st(e=>{var t;return((t=e.payload.body)===null||t===void 0?void 0:t.supported)!==void 0}),Vt(e=>{const{supported:t}=e.payload.body;return me(p0,{supported:t}),S5e(t)})),moduleEpics1:(n,e)=>zt(n,8008).pipe(st(t=>{var r;return((r=t.payload.body)===null||r===void 0?void 0:r.status)!==void 0}),nn(e),ht(t=>{let[r,i]=t;const{status:o}=r.payload.body,{summary:{summaryStatus:s}}=i,a=[];if(o!==s)switch(o){case j0.GW_IND_START:me(p0,{status:b0.Start});break;case j0.GW_IND_PAUSE:me(p0,{status:b0.Paused});break;case j0.GW_IND_STOP:me(p0,{status:b0.Stopped});break;default:me(p0,{status:""})}return a.push(_5e(o)),Tt(a)})),moduleEpics2:(n,e)=>zt(n,8015).pipe(st(t=>{var r;return((r=t.payload.body)===null||r===void 0?void 0:r.supported)!==void 0}),nn(e),Vt(t=>{let[r,i]=t;const{supported:o}=r.payload.body;me(g0,{supported:o});const{meeting:{zlkJwtToken:s}}=i;if(s){const{auto_transcription:a}=ES(s);a&&(o?Gr.createAgent().startMeetingQuery(!0):console.warn("You account don't support auto transcription"))}return w5e(o)})),moduleEpics3:(n,e)=>zt(n,8016).pipe(st(t=>{var r;return((r=t.payload.body)===null||r===void 0?void 0:r.status)!==void 0}),nn(e),ht(t=>{let[r,i]=t;const{status:o}=r.payload.body,{summary:{meetingQueryStatus:s}}=i,a=[];if(o!==s)switch(o){case B0.GW_IND_START:me(g0,{status:S0.Start});break;case B0.GW_IND_PAUSE:me(g0,{status:S0.Paused});break;case B0.GW_IND_STOP:me(g0,{status:S0.Stopped});break;default:me(g0,{status:""})}return a.push(C5e(o)),Tt(a)}))});var aI;const zht={chat:{epic:Sdt,reducer:vdt,Client:ydt},logger:{epic:Ydt,reducer:Kdt,Client:class extends Og{getLogs(n){return kb.getLogs(this[wo],n)}getStore(){return kb.doNotUseDirtyGetStore()}setLogOptions(n){n&&this[wo].dispatch(Yte(n))}isAutoReportInAccountSettingEnabled(){const{meeting:{zlkJwtToken:n,enableAutoLog:e,collectionToggleEnable:t,zsk:r}}=this[wo].getState();return!!n||(r?e&&t:e)}reportMeetingProblem(n){var e;const{product:t,problem:r,timeOfOccurrence:i,description:o,ticket:s,isLogIncluded:a}=n,{meeting:{userId:c,confId:l,conId:u,svcUrl:d}}=this[wo].getState(),h=`'product':${t}
'problem':${r}
'timeOfOccurrence':${i}
'description':${o}
'ticketID':${s}
'isLogIncluded':${a?"Logs included":""}
'nodeId':${c}
'confId':${l}
'conId':${u}
'svcUrl':${d}`,f=["REPORT_NOTIFICATION"];return(e=kb.makeLogger(f).logWithExtraProperties("",{IM_NOTIFICATION:`${h}
TrackingId:${kb.trackingId}`}))===null||e===void 0?void 0:e.then(()=>{kb.reportToGlobalTracing(a?void 0:f,!0)})}reportToGlobalTracing(n){return kb.reportToGlobalTracing(n)}reportRating(n,e){const{meeting:t,media:r,socket:i}=this[wo].getState();if(t){var o,s,a,c,l;const{zlkJwtToken:u,meetingStatus:d}=t,{assetsPath:h,enforceMultipleVideos:f,enforceVirtualBackground:p,disableRenderLimits:g}=r;kb.report(`rating:${n}, feedback:${e}, appKey:${u?(o=ES(u))===null||o===void 0?void 0:o.app_key:""}, CPU:${navigator.hardwareConcurrency}, GPU:${(s=tn.gpu)!==null&&s!==void 0?s:""}, browser:${tn.browser} ${tn.browserVersion}, OS:${tn.os} ${tn.osVersion}, SharedArrayBuffer:${!!window.crossOriginIsolated}, assetPath:${h}, enforceMultipleVideos:${f},disableRenderLimits:${g} enforceVirtualBackground:${p}, ${d===ws.Joined?`session duration:${Math.floor(((a=performance.now()-(t==null?void 0:t.pingRWCTimestamp))!==null&&a!==void 0?a:0)/1e3)}, rwg:${i==null||(c=i.rwgServerList)===null||c===void 0||(l=c[i.retryCount])===null||l===void 0?void 0:l.rwg}, failover count:${t==null?void 0:t.failover.count}`:""}`,"User Rating","info"),Number(n)<=2&&this.reportToGlobalTracing()}return Promise.resolve()}}},recording:{epic:nht,reducer:Qdt,Client:eht},cmd:{epic:aht,reducer:rht,Client:iht},breakoutRoom:{epic:Tht,reducer:hht,Client:Iht},liveTranscription:{epic:$ht,reducer:Aht,Client:Oht},liveStream:{epic:Fht,reducer:Lht,Client:Nht},summary:{epic:Uht,reducer:Bht,Client:Hht}},Vht=Gr.createAgent();let Wht=(aI=class extends ddt{constructor(n){super(n),this.mediaStream=void 0,this[c8]=zht}getMediaStream(){return this.mediaStream===void 0&&(this.mediaStream=new dht(this[wo])),this.mediaStream}joinInstant(n,e,t,r,i,o){const{[Qt]:s,[Qo]:a}=this,{meeting:{lang:c,meetingStatus:l},socket:{zoomSocketStatus:u}}=s();return e?l!==ws.Joined&&u===$i.Closed?(a(L2({topic:n,password:i||"",userName:t,zlk:e,lang:c,cv:r})),o&&a(VPe(o)),pm(Cat.JoinMeeting)):Promise.reject({type:lt,reason:"duplicated operation"}):Promise.reject({type:lt,reason:"invalid  signature"})}removeUser(n){const e=this[wo].getState(),{participants:{attendeesList:t}}=e;return t.find(i=>i.userId===n)?(Vht.expel(n),Un(wte,i=>i.some(o=>o.userId===n))):Promise.reject({type:Jn,reason:"no matched user"})}},gt(aI.prototype,"removeUser",[Ls,yt],Object.getOwnPropertyDescriptor(aI.prototype,"removeUser"),aI.prototype),aI);class qht{constructor(e){this.instant=void 0,this.context=void 0,this.script=void 0,this.mic=void 0,this.instant=0,this.context=e,this.mic=null,this.script=e.createScriptProcessor(2048,1,1),this.script.onaudioprocess=t=>{const r=t.inputBuffer.getChannelData(0);let i,o=0;for(i=0;i<r.length;++i)o+=r[i]*r[i];this.instant=Math.sqrt(o/r.length)}}connectToSource(e){console.log("InputMicDetector is listening");try{var t;this.mic=this.context.createMediaStreamSource(e),this.mic.connect(this.script),(t=this.script)===null||t===void 0||t.connect(this.context.destination)}catch(r){console.error(r)}}stop(){var e,t;console.log("Audio Previewer stopped"),(e=this.mic)===null||e===void 0||e.disconnect(),this.mic=null,(t=this.script)===null||t===void 0||t.disconnect(),this.script=null}getMicVolume(){return this.instant}}const Kht="https://st1.zoom.us/web_client/4qu8baa/audio/ring.mp3";class Ght{constructor(){this.sampleAudio=void 0,this.audioCtx=void 0,this.destinationNode=void 0,this.audioPlayer=void 0,this.analyzserInterval=void 0,this.analyserNode=void 0,this.analyserNodeBufferDataArray=void 0,this.analyserCallback=void 0,this.sourceNode=void 0,this.mAudioStream=void 0,this.mSourceNode=void 0,this.mediaRecorder=void 0,this.isRecording=void 0,this.recorderChunks=[],this.recorderObjUrl=void 0,this.recorderPlayer=void 0,this.maximumRecordingTimer=void 0,this.shouldPlayAfterRecording=!0,this.isRunning=!1}testSpeaker(e){var t;if(typeof AudioContext!="function"||typeof MediaStreamAudioDestinationNode!="function"||!AudioContext.prototype.decodeAudioData)return void console.warn("Cannot test the speaker due to the browser capability");const{speakerId:r,sampleAudioUrl:i=Kht,onAnalyseFrequency:o}=e||{};if(this.isRunning)return void console.warn("A tester is running,please stop it first");this.isRunning=!0,this.initAudioContext(),(((t=this.sampleAudio)===null||t===void 0?void 0:t.url)===i&&this.sampleAudio.data?Promise.resolve(this.sampleAudio.data):window.fetch(i).then(a=>a.arrayBuffer()).then(a=>this.audioCtx.decodeAudioData(a)).then(a=>(this.sampleAudio={url:i,data:a},a))).then(a=>{var c,l,u;this.sourceNode=this.audioCtx.createBufferSource(),this.sourceNode.buffer=a,this.sourceNode.loop=!0,r&&(c=this.audioPlayer)!==null&&c!==void 0&&c.setSinkId&&this.audioPlayer.setSinkId(r),o?typeof AudioContext.prototype.createAnalyser=="function"?(this.analyzserInterval&&window.clearInterval(this.analyzserInterval),this.analyserCallback=o,this.initAnalyserNode(),this.analyserNode&&this.sourceNode.connect(this.analyserNode)):(this.sourceNode.connect(this.destinationNode),console.warn("Cannot analyze the stream due to the browser capability")):(this.analyserCallback=void 0,this.sourceNode.connect(this.destinationNode)),this.sourceNode.start(0),((l=this.audioCtx)===null||l===void 0?void 0:l.state)!=="running"&&((u=this.audioCtx)===null||u===void 0||u.resume()),this.audioPlayer&&(this.audioPlayer.muted=!1,this.audioPlayer.currentTime=0,this.audioPlayer.play())});const s=()=>{this.isRunning=!1,this.audioPlayer&&(this.audioPlayer.currentTime=0,this.audioPlayer.pause()),this.analyserNode&&this.analyzserInterval&&(window.clearInterval(this.analyzserInterval),this.analyzserInterval=void 0,this.analyserNodeBufferDataArray=void 0),this.sourceNode&&(this.sourceNode.stop(0),this.sourceNode.disconnect(),this.sourceNode.buffer=null,this.sourceNode=void 0)};return{stop:s,destroy:()=>{var a;s(),this.analyserNode&&this.destinationNode&&(this.analyserNode.disconnect(this.destinationNode),this.analyserNode=void 0),(a=this.audioCtx)===null||a===void 0||a.close(),this.audioCtx=void 0}}}testMicrophone(e){var t;if(typeof AudioContext!="function"||typeof MediaStreamAudioDestinationNode!="function"||typeof AudioContext.prototype.createMediaStreamSource!="function"||typeof((t=navigator.mediaDevices)===null||t===void 0?void 0:t.getUserMedia)!="function")return void console.warn("Cannot test the microphone due to the browser capability");const{microphoneId:r,speakerId:i,recordAndPlay:o,maxRecordDuration:s,onAnalyseFrequency:a,onStartRecording:c,onStopRecording:l,onStartPlayRecording:u,onStopPlayRecording:d}=e||{};if(this.isRunning)return void console.warn("A tester is running,please stop it first");this.isRunning=!0,this.initAudioContext();const h=()=>{o&&this.mediaRecorder&&this.isRecording&&(this.shouldPlayAfterRecording=!0,this.mediaRecorder.state!=="inactive"&&this.mediaRecorder.stop())};window.navigator.mediaDevices.getUserMedia({audio:!r||{deviceId:{exact:r}}}).then(p=>{var g,m,v,b;this.mAudioStream=p,this.mSourceNode=(g=this.audioCtx)===null||g===void 0?void 0:g.createMediaStreamSource(p),this.audioPlayer.muted=!0,a?(this.analyzserInterval&&window.clearInterval(this.analyzserInterval),this.analyserCallback=a,this.initAnalyserNode(),this.analyserNode&&((v=this.mSourceNode)===null||v===void 0||v.connect(this.analyserNode))):this.analyserCallback=void 0,o&&(typeof MediaRecorder=="function"?(this.recorderObjUrl&&window.URL.revokeObjectURL(this.recorderObjUrl),this.mediaRecorder=new MediaRecorder(this.mAudioStream),this.mediaRecorder.ondataavailable=S=>{S.data&&this.recorderChunks.push(S.data)},this.mediaRecorder.onstop=()=>{if(this.isRecording=!1,this.maximumRecordingTimer&&(window.clearTimeout(this.maximumRecordingTimer),this.maximumRecordingTimer=void 0),l==null||l(),this.recorderChunks.length>0){var S;const E=new Blob(this.recorderChunks,{type:((S=this.recorderChunks[0])===null||S===void 0?void 0:S.type)||"audio/ogg; codecs=opus"});this.recorderObjUrl=window.URL.createObjectURL(E),this.shouldPlayAfterRecording&&this.playRecording(this.recorderObjUrl,i,u,d).catch(w=>{this.analyzserInterval&&(window.clearInterval(this.analyzserInterval),this.analyzserInterval=void 0,this.analyserNodeBufferDataArray=void 0),console.warn(w)}),this.recorderChunks=[],this.mediaRecorder&&(this.mediaRecorder.ondataavailable=null,this.mediaRecorder.onstop=null,this.mediaRecorder=void 0)}},this.mediaRecorder.start(),this.isRecording=!0,c==null||c(),this.maximumRecordingTimer=window.setTimeout(()=>{h()},s||1e4)):console.warn("Cannot record the sound due to the browser capability")),((m=this.audioCtx)===null||m===void 0?void 0:m.state)!=="running"&&((b=this.audioCtx)===null||b===void 0||b.resume()),this.audioPlayer&&(this.audioPlayer.currentTime=0,this.audioPlayer.play())});const f=()=>{this.isRunning=!1,this.maximumRecordingTimer&&(window.clearTimeout(this.maximumRecordingTimer),this.maximumRecordingTimer=void 0),this.audioPlayer&&(this.audioPlayer.currentTime=0,this.audioPlayer.pause()),this.analyserNode&&this.analyzserInterval&&(window.clearInterval(this.analyzserInterval),this.analyzserInterval=void 0,this.analyserNodeBufferDataArray=void 0),this.mSourceNode&&(a&&this.analyserNode&&this.mSourceNode.disconnect(this.analyserNode),this.mSourceNode=void 0),this.mAudioStream&&(this.mAudioStream.getAudioTracks().forEach(p=>{p.stop()}),this.mAudioStream=void 0),this.mediaRecorder&&(this.shouldPlayAfterRecording=!1,this.mediaRecorder.ondataavailable=null,this.mediaRecorder.onstop=null,this.mediaRecorder.state!=="inactive"&&this.mediaRecorder.stop(),this.isRecording=!1,this.mediaRecorder=void 0,this.recorderChunks=[]),this.recorderPlayer&&(this.recorderPlayer.currentTime=0,this.recorderPlayer.pause())};return{stop:f,stopRecording:h,destroy:()=>{var p;f(),this.analyserNode&&this.destinationNode&&(this.analyserNode.disconnect(this.destinationNode),this.analyserNode=void 0),(p=this.audioCtx)===null||p===void 0||p.close(),this.audioCtx=void 0}}}initAudioContext(){this.audioCtx&&this.audioPlayer||(this.audioCtx=new AudioContext,this.destinationNode=new MediaStreamAudioDestinationNode(this.audioCtx),this.audioPlayer=new Audio,this.audioPlayer.loop=!0,this.audioPlayer.srcObject=this.destinationNode.stream)}initAnalyserNode(){if(!this.audioCtx)return;this.analyserNode||(this.analyserNode=this.audioCtx.createAnalyser(),this.analyserNode.connect(this.destinationNode),this.analyserNode.fftSize=1024);const e=this.analyserNode.frequencyBinCount;this.analyserNodeBufferDataArray=new Uint8Array(e),this.analyzserInterval=window.setInterval(this.audioAnalyserCallback.bind(this),20)}audioAnalyserCallback(){if(this.analyserNodeBufferDataArray&&this.analyserNode&&this.analyserCallback){this.analyserNode.getByteFrequencyData(this.analyserNodeBufferDataArray);let e=0;for(const r of this.analyserNodeBufferDataArray)e+=r;const t=e/this.analyserNodeBufferDataArray.length;this.analyserCallback(t)}}playRecording(e,t,r,i){this.recorderPlayer=new Audio,this.recorderPlayer.src=e,this.recorderPlayer.currentTime=0,this.recorderPlayer.setSinkId&&t&&this.recorderPlayer.setSinkId(t);const o=()=>{i==null||i(),this.recorderPlayer&&(this.recorderPlayer.onpause=null,this.recorderPlayer.onended=null,this.recorderPlayer=void 0,this.isRunning=!1)};return new Promise((s,a)=>{this.recorderPlayer&&(this.recorderPlayer.onpause=()=>{s(!0)},this.recorderPlayer.onended=()=>{s(!0)},this.recorderPlayer.onerror=a,r==null||r(),this.recorderPlayer.play().catch(a))}).finally(()=>{window.URL.revokeObjectURL(e),o()})}}const aH="AudioNotStartedError";class Zht{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";this.audioContext=void 0,this.inputMicDetector=void 0,this.isMicUnmuted=void 0,this.isAudioStarted=void 0,this.audioStream=void 0,this.deviceId=void 0,this.tester=void 0,this.audioContext=null,this.inputMicDetector=null,this.isMicUnmuted=!1,this.isAudioStarted=!1,this.audioStream=null,this.deviceId=e,this.tester=new Ght}async start(){if(this.audioStream||this.isAudioStarted)throw new Error("AudioAlreadyStartedError");try{const e=await navigator.mediaDevices.getUserMedia(this.getAudioConstraints());this.audioStream=e,this.isAudioStarted=!0}catch(e){throw e}}async unmute(){if(!this.audioStream||!this.isAudioStarted)throw new Error(aH);if(this.isMicUnmuted)throw new Error("AudioAlreadyUnmutedError");return this.toggleMicIsMuted(!0)}async mute(){if(!this.audioStream||!this.isAudioStarted)throw new Error(aH);if(!this.isMicUnmuted)throw new Error("AudioAlreadyMutedError");return this.toggleMicIsMuted(!1)}getCurrentVolume(){return this.inputMicDetector?this.inputMicDetector.getMicVolume():0}async stop(){if(!this.audioStream||!this.isAudioStarted)throw new Error(aH);this.audioStream.getAudioTracks().forEach(e=>e.stop()),this.audioStream=null,this.isAudioStarted=!1}async toggleMicIsMuted(e){if(e){if(!this.audioContext){const t=window.AudioContext||window.webkitAudioContext;this.audioContext=new t}this.inputMicDetector=new qht(this.audioContext),this.inputMicDetector.connectToSource(this.audioStream)}else this.inputMicDetector&&this.inputMicDetector.stop(),this.inputMicDetector=null;this.isMicUnmuted=e}getAudioConstraints(){return{audio:this.deviceId===""||{deviceId:{exact:this.deviceId}},video:!1}}testSpeaker(e){return this.tester.testSpeaker(e)}testMicrophone(e){return this.tester.testMicrophone(e)}}const Xht={width:{min:1024,ideal:1280,max:1920},height:{min:576,ideal:720,max:1080},aspectRatio:{ideal:1.777777778}};class Yht{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";this.isVideoStarted=void 0,this.videoStream=void 0,this.deviceId=void 0,this.localPreview=void 0,this.vbPreviewInProgress=void 0,this.videoParams=void 0,this.isVideoStarted=!1,this.videoStream=null,this.vbPreviewInProgress=!1,this.deviceId=e,this.localPreview=new Am}async start(e,t){if(!e)throw new Error("Video DOM element is falsy");if(this.isVideoStarted||this.videoStream)throw new Error("VideoAlreadyStartedError");this.videoParams={videoDOMElement:e,virtualBackground:t};const r=async i=>{if(!i||i.name!=="OverconstrainedError"&&i.name!=="ConstraintNotSatisfiedError")throw i;console.log(`Warning: detected ${i.name} -- trying to fall back to lower aspect ratio`);try{const o=await navigator.mediaDevices.getUserMedia(this.getVideoConstraints(!0));return this.tryPlayVideo(e,o)}catch(o){throw o}};if(e instanceof HTMLVideoElement)try{const i=await navigator.mediaDevices.getUserMedia(this.getVideoConstraints());return this.tryPlayVideo(e,i)}catch(i){return r(i)}else{if(!(e instanceof HTMLCanvasElement))throw new Error("Cannot start video with virtual background");this.localPreview.setup().then(()=>this.localPreview.startPreview(e,{...t,deviceId:this.deviceId})).then(()=>{this.vbPreviewInProgress=!0})}}async stop(){if(this.vbPreviewInProgress)await this.localPreview.stopPreview(),this.vbPreviewInProgress=!1;else{if(!this.videoStream||!this.isVideoStarted)throw new Error("VideoNotStartedError");this.videoStream.getVideoTracks().forEach(e=>e.stop()),this.videoStream=null,this.isVideoStarted=!1}}async switchCamera(e){e!==this.deviceId&&(this.deviceId=e,await this.stop(),this.videoParams&&await this.start(this.videoParams.videoDOMElement,this.videoParams.virtualBackground))}async updateVirtualBackground(e,t){this.vbPreviewInProgress&&await this.localPreview.updatePreview(e,t)}getVideoConstraints(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],t=Xht;return S7.includes(this.deviceId)?{audio:!1,video:{facingMode:this.deviceId}}:(e?t=this.deviceId===""||{deviceId:{exact:this.deviceId}}:this.deviceId!==""&&(t.deviceId={exact:this.deviceId}),{audio:!1,video:t})}async tryPlayVideo(e,t){if(!e)throw new Error("Video DOM element is falsy");try{this.videoStream=t,e.muted=!0,e.playsInline=!0,e.srcObject=this.videoStream,await e.play(),this.isVideoStarted=!0}catch(r){throw r}}}class $p{static createClient(){if(!this.meetingClient){const e=function(){const t=function(a){a===void 0&&(a={});var c,l=new Lue.constructor(Lue.schedulerActionCtor),u=new Lh,d=function(h){c=h;var f=new Lh,p=new Lh,g=f.asObservable().pipe(bl(l)),m=new Ost(p.pipe(bl(l)),c.getState());return u.pipe(Vt(function(v){var b=v(g,m,a.dependencies);if(!b)throw new TypeError('Your root Epic "'+(v.name||"<anonymous>")+`" does not return a stream. Double check you're not missing a return statement!`);return b}),ht(function(v){return Tt(v).pipe(lq(l),bl(l))})).subscribe(c.dispatch),function(v){return function(b){var S=v(b);return p.next(c.getState()),f.next(b),S}}};return d.run=function(h){u.next(h)},d}(),{epicSubject:r,rootEpic:i}=function(){const a=new ust(vPe(vlt,Plt,Alt,sdt));return{epicSubject:a,rootEpic:(c,l,u)=>a.pipe(qp(c.pipe(rn(`${ade}`))),ht(d=>d(c,l,u)))}}(),o=[t],s=GIe(ofe(),cdt(function(){for(var a=arguments.length,c=new Array(a),l=0;l<a;l++)c[l]=arguments[l];return function(u){return function(){var d=u.apply(void 0,arguments),h=function(){throw new Error(ol(15))},f={getState:d.getState,dispatch:function(){return h.apply(void 0,arguments)}},p=c.map(function(g){return g(f)});return h=ZIe.apply(void 0,p)(d.dispatch),Hue(Hue({},d),{},{dispatch:h})}}}(...o)));return s.asyncReducers={},s.injectReducer=(a,c)=>{s.asyncReducers[a]===void 0&&(s.asyncReducers[a]=c,s.replaceReducer(ofe(s.asyncReducers)))},s.injectEpic=a=>{r.next(a)},t.run(i),s}();this.meetingClient=new Wht(e)}return this.meetingClient}static destroyClient(){if(this.meetingClient){const e=this.meetingClient[Qo];this.meetingClient.leave().then(()=>{js(500).subscribe(()=>{e==null||e(ade()),Ote()})}),this.meetingClient=null}}static checkFeatureRequirements(){return function(){const e=[],t=[],{isAndroidOrIOSBrowser:r,browser:i,browserVersion:o,os:s,osVersion:a,isChrome:c,isFirefox:l,isSafari:u}=tn;!r&&(c||l||u)&&i5()?e.push("Virtual Background"):t.push("Virtual Background"),(r||c)&&i5()?e.push("Share Chrome Tab Audio"):t.push("Share Chrome Tab Audio"),!r&&i5()?(e.push("Screen Share (send)"),e.push("720p Video (receive)"),e.push("Share 2nd Camera")):(t.push("Screen Share (send)"),t.push("720p Video (receive)"),t.push("Share 2nd Camera")),i5()?(e.push("Audio"),e.push("Video"),e.push("Screen Share (receive)"),e.push("Chat"),e.push("Closed Captioning"),e.push("Live Transcription"),e.push("Live Translation"),e.push("Cloud Recording"),e.push("Call Out (PSTN)"),e.push("Command Channel"),e.push("RTMP Live Streaming"),e.push("Encryption"),e.push("720p Video (send)"),e.push("Render Multiple Videos")):(t.push("Audio"),t.push("Video"),t.push("Screen Share (receive)"),t.push("Chat"),t.push("Closed Captioning"),t.push("Live Transcription"),t.push("Live Translation"),t.push("Cloud Recording"),t.push("Call Out (PSTN)"),t.push("Command Channel"),t.push("RTMP Live Streaming"),t.push("Encryption"),e.push("720p Video (send)"),e.push("Render Multiple Videos"));const d=r?`${s}${a}`:`${i}${o}`;return t.length>0&&console.log("Some features are not supported on your platform, please refer to https://developers.zoom.us/docs/video-sdk/web/browser-support/"),{platform:d,supportFeatures:e,unSupportFeatures:t}}()}static checkSystemRequirements(){return e5e()}static getDevices(e){return e?navigator.mediaDevices.enumerateDevices():navigator.mediaDevices.getUserMedia({audio:!0,video:!0}).then(t=>(t.getTracks().forEach(r=>r.stop()),navigator.mediaDevices.enumerateDevices())).catch(t=>(console.warn(t),navigator.mediaDevices.enumerateDevices()))}static createLocalAudioTrack(){return new Zht(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")}static createLocalVideoTrack(){return new Yht(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")}static preloadDependentAssets(e){(async t=>{const r=t||a1,i=`${r}/${i1}`,o=[],s=[],a=`${r}/`;if(l5()){const{workers:l,wasms:u}=Sb("audio","simd",a);o.push(...l),s.push(...u)}else{const{workers:l,wasms:u}=Sb("audio","",a);o.push(...l),s.push(...u)}if(l5()&&function(){const{browser:l,browserVersion:u,isAndroidBrowser:d}=tn;return!d&&l.toLowerCase()==="chrome"&&qk(u,"100")>0&&window.crossOriginIsolated}()){const{workers:l,wasms:u}=Sb(["video","sharing"],"videoShare",a);o.push(...l),s.push(...u)}else if(l5()&&$K()){const{workers:l,wasms:u}=Sb(["video","sharing"],"simd,thread",a);o.push(...l),s.push(...u)}else if($K()){const{workers:l,wasms:u}=Sb(["video","sharing"],"thread",a);o.push(...l),s.push(...u)}else if(l5()){const{workers:l,wasms:u}=Sb(["video","sharing"],"simd",a);o.push(...l),s.push(...u)}else{const{workers:l,wasms:u}=Sb(["video","sharing"],"",a);o.push(...l),s.push(...u)}const c=[uB(i,"script")];o.forEach(l=>{c.push(uB(l,"fetch"))}),s.forEach(l=>{c.push(uB(l,"fetch"))});try{document.head.append(...c)}catch{}})(e)}}$p.meetingClient=void 0,$p.VERSION=C7;var aD="1.12.1",T5="INVALID_PARAMETERS",Jht="https://dmogdx0jrul3u.cloudfront.net/videosdk/".concat(aD,"/lib"),Qht="https://source.zoom.us/videosdk/".concat(aD,"/lib"),eft="https://jssdk.zoomus.cn/videosdk/".concat(aD,"/lib"),cH=function(n){return typeof n=="string"&&n.length>0},x5e=function(n){var e="";switch(n){case"Global":e=Qht;break;case"CN":e=eft;break;case"CDN":e=Jht;break;default:e=n}return e},E5e=["userId","avatar","displayName","isHost","audio","muted","bVideoOn","sharerOn","sharerPause","userIdentity","isSpeakerOnly","bVideoShare","bShareAudioOn","userGuid","isPhoneUser","isInFailover",{from:"isCoHost",to:"isManager"},{from:"bAllowISORecord",to:"isAllowIndividualRecording"},{from:"bVideoConnect",to:"isVideoConnect"},{from:"bShareToBORooms",to:"bShareToSubsession"},{from:"bid",to:"subsessionId"},{from:"phoneNumber",to:function(n){return n===void 0?{}:{phoneNumber:n}}}],I5e=[].concat(E5e,[{from:"userGUID",to:"userGuid"},{from:"bCoHost",to:function(n){return{isManager:!!n}}},{from:"userType",to:function(n){return{isPhoneUser:(5&n)==5}}},{from:"bid",to:function(n){return n?{subsessionId:n}:{}}}]),tft=I5e.map(function(n){return typeof n=="string"?n:n.from});function P5e(n,e){return typeof n=="string"?iq({},"".concat(n),e):typeof n.to=="string"?iq({},"".concat(n.to),e):n.to(e)}function Jw(n){if(n)return E5e.reduce(function(e,t){var r=typeof t=="string"?t:t.from,i=P5e(t,n[r]);return $u($u({},e),i)},{})}function lH(n){if(n)return Object.keys(n).reduce(function(e,t){var r=tft.indexOf(t);if(r>-1){var i=I5e[r],o=typeof i=="string"?i:i.from,s=P5e(i,n[o]);return $u($u({},e),s)}return e},{})}var zge,Vge,Wge,qge,Kge,Qw,Gge,Zge,mt=Symbol("stream"),nft=function(){function n(e){np(this,n),this[mt]=void 0,this[mt]=e}return rp(n,[{key:"startAudio",value:function(e){return this[mt].startAudio(e)}},{key:"stopAudio",value:function(){return this[mt].stopAudio()}},{key:"muteAudio",value:function(e){return this[mt].muteAudio(e)}},{key:"unmuteAudio",value:function(e){return this[mt].unmuteAudio(e)}},{key:"inviteByPhone",value:function(e,t,r,i){return this[mt].dialOut(e,t,r,i)}},{key:"cancelInviteByPhone",value:function(e,t,r){return this[mt].cancelDialOut(e,t,r)}},{key:"hangup",value:function(){return this[mt].hangup()}},{key:"getCurrentSessionCallinInfo",value:function(){return this[mt].getDialInInfo()}},{key:"muteShareAudio",value:function(e){return this[mt].muteShareAudio(e)}},{key:"unmuteShareAudio",value:function(e){return this[mt].unmuteShareAudio(e)}},{key:"subscribeAudioStatisticData",value:function(e){return this[mt].subscribeAudioStatisticData(e)}},{key:"unsubscribeAudioStatisticData",value:function(e){return this[mt].unsubscribeAudioStatisticData(e)}},{key:"muteUserAudioLocally",value:function(e){return this[mt].muteUserAudioLocally(e)}},{key:"unmuteUserAudioLocally",value:function(e){return this[mt].unmuteUserAudioLocally(e)}},{key:"adjustUserAudioVolumeLocally",value:function(e,t){return this[mt].adjustUserAudioVolumeLocally(e,t)}},{key:"enableBackgroundNoiseSuppression",value:function(e){return this[mt].enableBackgroundNoiseSuppression(e)}},{key:"enableSyncButtonsOnHeadset",value:function(e){return this[mt].enableSyncButtonsOnHeadset(e)}},{key:"muteAllUserAudioLocally",value:function(){return this[mt].muteAllUserAudioLocally()}},{key:"unmuteAllUserAudioLocally",value:function(){return this[mt].unmuteAllUserAudioLocally()}},{key:"enableOriginalSound",value:function(e){return this[mt].enableOriginalSound(e)}},{key:"callCRCDevice",value:function(e,t){return this[mt].callCRCDevice(e,t)}},{key:"cancelCallCRCDevice",value:function(e,t){return this[mt].cancelCallCRCDevice(e,t)}},{key:"startSecondaryAudio",value:function(e,t){return this[mt].startSecondaryAudio(e,t)}},{key:"stopSecondaryAudio",value:function(){return this[mt].stopSecondaryAudio()}},{key:"muteAllAudio",value:function(){return this[mt].muteAllAudio()}},{key:"unmuteAllAudio",value:function(){return this[mt].unmuteAllAudio()}},{key:"isAudioMuted",value:function(e){return this[mt].isAudioMuted(e)}},{key:"getMicList",value:function(){return this[mt].getMicList()}},{key:"getSpeakerList",value:function(){return this[mt].getSpeakerList()}},{key:"getActiveMicrophone",value:function(){return this[mt].getActiveMicrophone()}},{key:"getActiveSpeaker",value:function(){return this[mt].getActiveSpeaker()}},{key:"switchMicrophone",value:function(e){return this[mt].switchMicrophone(e)}},{key:"switchSpeaker",value:function(e){return this[mt].switchSpeaker(e)}},{key:"isSupportPhoneFeature",value:function(){return this[mt].isSupportCallOut()}},{key:"getSupportCountryInfo",value:function(){return this[mt].getDialOutCountries()}},{key:"getInviteByPhoneStatus",value:function(){return this[mt].getDialOutStatus()}},{key:"getShareAudioStatus",value:function(){return this[mt].getShareAudioStatus()}},{key:"isOthersShareAudioMutedLocally",value:function(e){return this[mt].isOthersShareAudioMutedLocally(e)}},{key:"getAudioStatisticData",value:function(){return this[mt].getAudioStatisticData()}},{key:"isUserAudioMutedLocally",value:function(e){return this[mt].isUserAudioMutedLocally(e)}},{key:"getUserVolumeLocally",value:function(e){return this[mt].getUserVolumeLocally(e)}},{key:"isSupportMicrophoneAndShareAudioSimultaneously",value:function(){return this[mt].isSupportMicrophoneAndShareAudioSimultaneously()}},{key:"startVideo",value:function(e){return this[mt].startVideo(e)}},{key:"stopVideo",value:function(){return this[mt].stopVideo()}},{key:"renderVideo",value:function(e,t,r,i,o,s,a,c){return this[mt].renderVideo(e,t,r,i,o,s,a,c)}},{key:"stopRenderVideo",value:function(e,t,r,i){var o=arguments.length>4&&arguments[4]!==void 0&&arguments[4],s=arguments.length>5?arguments[5]:void 0;return this[mt].stopRenderVideo(e,t,r,i,o,s)}},{key:"updateVideoCanvasDimension",value:function(e,t,r){return this[mt].updateVideoCanvasDimension(e,t,r)}},{key:"adjustRenderedVideoPosition",value:function(e,t,r,i,o,s,a){return this[mt].adjustRenderedVideoPosition(e,t,r,i,o,s,a)}},{key:"clearVideoCanvas",value:function(e,t){return this[mt].clearVideoCanvas(e,t)}},{key:"mirrorVideo",value:function(e){return this[mt].mirrorVideo(e)}},{key:"enableHardwareAcceleration",value:function(e){return this[mt].enableHardwareAcceleration(e)}},{key:"previewVirtualBackground",value:function(e,t,r,i){return this[mt].previewVirtualBackground(e,t,r,i)}},{key:"updateVirtualBackgroundImage",value:function(e,t){return this[mt].updateVirtualBackgroundImage(e,t)}},{key:"stopPreviewVirtualBackground",value:function(){return this[mt].stopPreviewVirtualBackground()}},{key:"previewVideoMask",value:function(e,t){return this[mt].previewVideoMask(e,t)}},{key:"updateVideoMask",value:function(e){return this[mt].updateVideoMask(e)}},{key:"stopPreviewVideoMask",value:function(){return this[mt].stopPreviewVideoMask()}},{key:"switchCamera",value:function(e){return this[mt].switchCamera(e)}},{key:"subscribeVideoStatisticData",value:function(e){return this[mt].subscribeVideoStatisticData(e)}},{key:"unsubscribeVideoStatisticData",value:function(e){return this[mt].unsubscribeVideoStatisticData(e)}},{key:"attachVideo",value:function(e,t,r){return this[mt].attachVideo(e,t,r)}},{key:"detachVideo",value:function(e,t){return this[mt].detachVideo(e,t)}},{key:"isCapturingVideo",value:function(){return this[mt].isCapturingVideo()}},{key:"isCameraTaken",value:function(){return this[mt].isCameraTaken()}},{key:"getActiveVideoId",value:function(){return this[mt].getActiveVideoId()}},{key:"getActiveCamera",value:function(){return this[mt].getActiveCamera()}},{key:"getCameraList",value:function(){return this[mt].getCameraList()}},{key:"isCaptureForbidden",value:function(){return this[mt].isCaptureForbidden()}},{key:"getVideoMaxQuality",value:function(){return this[mt].getVideoMaxQuality()}},{key:"getReceivedVideoDimension",value:function(){return this[mt].getReceivedVideoDimension()}},{key:"isSupportMultipleVideos",value:function(){return this[mt].isSupportMultipleVideos()}},{key:"isSupportHDVideo",value:function(){return this[mt].isSupportHDVideo()}},{key:"isSupportVirtualBackground",value:function(){return this[mt].isSupportVirtualBackground()}},{key:"getVirtualbackgroundStatus",value:function(){return this[mt].getVirtualbackgroundStatus()}},{key:"getVideoStatisticData",value:function(){return this[mt].getVideoStatisticData()}},{key:"isRenderSelfViewWithVideoElement",value:function(){return this[mt].isRenderSelfViewWithVideoElement()}},{key:"getCapturedVideoResolution",value:function(){return this[mt].getCapturedVideoResolution()}},{key:"getVideoMaskStatus",value:function(){return this[mt].getVideoMaskStatus()}},{key:"isVideoMirrored",value:function(){return this[mt].isVideoMirrored()}},{key:"startShareView",value:function(e,t){return this[mt].startShareView(e,t)}},{key:"stopShareView",value:function(){return this[mt].stopShareView()}},{key:"switchShareView",value:function(e){return this[mt].switchShareView(e)}},{key:"startShareScreen",value:function(e,t){return(t==null?void 0:t.broadcastToSubsession)!==void 0&&Object.assign(t||{},{broadcastToBreakoutRoom:t==null?void 0:t.broadcastToSubsession}),this[mt].startShareScreen(e,t)}},{key:"pauseShareScreen",value:function(){return this[mt].pauseShareScreen()}},{key:"resumeShareScreen",value:function(){return this[mt].resumeShareScreen()}},{key:"stopShareScreen",value:function(){return this[mt].stopShareScreen()}},{key:"lockShare",value:function(e){return this[mt].lockShare(e)}},{key:"updateSharingCanvasDimension",value:function(e,t){return this[mt].updateSharingCanvasDimension(e,t)}},{key:"switchSharingSecondaryCamera",value:function(e){return this[mt].switchSharingSecondaryCamera(e)}},{key:"setSharePrivilege",value:function(e){return this[mt].setSharePrivilege(e)}},{key:"shareToSubsession",value:function(){return this[mt].shareToBreakoutRoom()}},{key:"stopShareToSubsession",value:function(){return this[mt].stopShareToBreakoutRoom()}},{key:"enableOptimizeForSharedVideo",value:function(e){return this[mt].enableOptimizeForSharedVideo(e)}},{key:"updateSharedVideoQuality",value:function(e){return this[mt].updateSharedVideoQuality(e)}},{key:"subscribeShareStatisticData",value:function(e){return this[mt].subscribeShareStatisticData(e)}},{key:"unsubscribeShareStatisticData",value:function(e){return this[mt].unsubscribeShareStatisticData(e)}},{key:"isShareLocked",value:function(){return this[mt].isShareLocked()}},{key:"getSharePrivilege",value:function(){return this[mt].getSharePrivilege()}},{key:"getActiveShareUserId",value:function(){return this[mt].getActiveShareUserId()}},{key:"getShareStatus",value:function(){return this[mt].getShareStatus()}},{key:"getShareUserList",value:function(){return this[mt].getShareUserList().map(function(e){return Jw(e)})}},{key:"isStartShareScreenWithVideoElement",value:function(){return this[mt].isStartShareScreenWithVideoElement()}},{key:"isOptimizeForSharedVideoEnabled",value:function(){return this[mt].isOptimizeForSharedVideoEnabled()}},{key:"isSupportOptimizedForSharedVideo",value:function(){return this[mt].isSupportOptimizedForSharedVideo()}},{key:"getShareStatisticData",value:function(){return this[mt].getShareStatisticData()}},{key:"requestFarEndCameraControl",value:function(e){return this[mt].requestFarEndCameraControl(e)}},{key:"approveFarEndCameraControl",value:function(e){return this[mt].approveFarEndCameraControl(e)}},{key:"declineFarEndCameraControl",value:function(e){return this[mt].declineFarEndCameraControl(e)}},{key:"giveUpFarEndCameraControl",value:function(e){return this[mt].giveUpFarEndCameraControl(e)}},{key:"controlCamera",value:function(e){return this[mt].controlCamera(e)}},{key:"controlFarEndCamera",value:function(e){return this[mt].controlFarEndCamera(e)}},{key:"getFarEndCameraPTZCapability",value:function(e){return this[mt].getFarEndCameraPTZCapability(e)}},{key:"getCameraPTZCapability",value:function(e){return this[mt].getCameraPTZCapability(e)}},{key:"isBrowserSupportPTZ",value:function(){return this[mt].isBrowserSupportPTZ()}},{key:"getNetworkQuality",value:function(e){return this[mt].getNetworkQuality(e)}},{key:"requestRemoteControl",value:function(){return this[mt].requestRemoteControl()}},{key:"giveUpRemoteControl",value:function(){return this[mt].giveUpRemoteControl()}},{key:"startRemoteControl",value:function(e){return this[mt].startRemoteControl(e)}},{key:"grabRemotoControl",value:function(){return this[mt].grabRemotoControl()}},{key:"approveRemoteControl",value:function(e,t){return this[mt].approveRemoteControl(e,t)}},{key:"declineRemoteControl",value:function(e){return this[mt].declineRemoteControl(e)}},{key:"stopRemoteControl",value:function(){return this[mt].stopRemoteControl()}},{key:"launchRemoteControlApp",value:function(e){return this[mt].launchRemoteControlApp(e)}},{key:"isRemotelyControlApproved",value:function(){return this[mt].isRemotelyControlApproved()}},{key:"isControllingUserRemotely",value:function(){return this[mt].isControllingUserRemotely()}},{key:"isTargetShareSupportRemoteControl",value:function(e){return this[mt].isTargetShareSupportRemoteControl(e)}},{key:"getRemoteControlAppDownloadUrl",value:function(){return this[mt].getRemoteControlAppDownloadUrl()}},{key:"getRemotelyControllingUser",value:function(){return this[mt].getRemotelyControllingUser()}},{key:"isRemoteControlEnabled",value:function(){return this[mt].isRemoteControlEnabled()}}]),n}(),rft=["isCoHost"],uh=Symbol("chat"),ift=function(){function n(e){np(this,n),this[uh]=void 0,this[uh]=e}return rp(n,[{key:"send",value:function(e,t){return this[uh].send(e,t)}},{key:"sendToAll",value:function(e){return this[uh].send(e,Zi.All)}},{key:"sendFile",value:function(e,t){return this[uh].sendFile(e,t)}},{key:"downloadFile",value:function(e,t,r){return this[uh].downloadFile(e,t,r)}},{key:"setPrivilege",value:function(e){return this[uh].setPrivilege(e)}},{key:"getPrivilege",value:function(){return this[uh].getPrivilege()}},{key:"getReceivers",value:function(){return this[uh].getReceivers().map(function(e){return $u({isManager:e.isCoHost},Uk(e,rft))})}},{key:"getHistory",value:function(){return this[uh].getHistory()}},{key:"isFileTransferEnabled",value:function(){return this[uh].isFileTransferEnabled()}},{key:"getFileTransferSetting",value:function(){return this[uh].getFileTransferSetting()}}]),n}(),yp=Symbol("recording"),oft=function(){function n(e){np(this,n),this[yp]=void 0,this[yp]=e}return rp(n,[{key:"canStartRecording",value:function(){return this[yp].isRecordingEnabled()}},{key:"startCloudRecording",value:function(){return this[yp].startRecording()}},{key:"pauseCloudRecording",value:function(){return this[yp].pauseRecording()}},{key:"resumeCloudRecording",value:function(){return this[yp].startRecording()}},{key:"stopCloudRecording",value:function(){return this[yp].stopRecording()}},{key:"getCloudRecordingStatus",value:function(){return this[yp].getRecordingStatus()}},{key:"acceptIndividualRecording",value:function(){return this[yp].accept()}},{key:"declineIndividualRecording",value:function(){return this[yp].decline()}}]),n}(),uH=Symbol("command"),sft=function(){function n(e){np(this,n),this[uH]=void 0,this[uH]=e}return rp(n,[{key:"send",value:function(e,t){return this[uH].send(e,t)}}]),n}(),aft=["isInRoom"],cft=["isAutoJoinRoom","isRoomSelectionEnabled"],Gs=Symbol("breakout-room"),lft=function(){function n(e){np(this,n),this[Gs]=void 0,this[Gs]=e}return rp(n,[{key:"createSubsessions",value:function(e,t){return this[Gs].createRooms(e,t).then(function(r){return r.map(function(i){return{subsessionId:i.roomId,subsessionName:i.name,userList:i.attendeeList}})})}},{key:"openSubsessions",value:function(e,t){var r=t?$u($u({},t),{},{isAutoJoinRoom:t.isAutoJoinSubsession,isRoomSelectionEnabled:t.isSubsessionSelectionEnabled}):void 0,i=e.map(function(o){return{roomId:o.subsessionId,name:o.subsessionName,attendeeList:o.userList}});return this[Gs].openRooms(i,r)}},{key:"joinSubsession",value:function(e){return this[Gs].joinRoom(e)}},{key:"leaveSubsession",value:function(){return this[Gs].leaveRoom()}},{key:"askForHelp",value:function(){return this[Gs].askForHelp()}},{key:"postponeHelping",value:function(e){return this[Gs].postponeHelping(e)}},{key:"broadcast",value:function(e){return this[Gs].broadcast(e)}},{key:"assignUserToSubsession",value:function(e,t){return this[Gs].assignUserToRoom(e,t)}},{key:"moveUserToSubsession",value:function(e,t){return this[Gs].moveUserToRoom(e,t)}},{key:"moveBackToMainSession",value:function(e){return this[Gs].moveBackToMainSession(e)}},{key:"closeAllSubsessions",value:function(){return this[Gs].closeRoom()}},{key:"startBroadcastVoice",value:function(){return this[Gs].startBroadcastVoice()}},{key:"stopBroadcastVoice",value:function(){return this[Gs].stopBroadcastVoice()}},{key:"getUnassignedUserList",value:function(){return this[Gs].getUnassignedAttendeeList().map(function(e){return Jw(e)})}},{key:"getSubsessionList",value:function(){return this[Gs].getRoomList().map(function(e){return{subsessionId:e.roomId,subsessionName:e.name,userList:e.attendeeList.map(function(t){var r=t;return $u({isInSubsession:r.isInRoom},Uk(r,aft))})}})}},{key:"getUserStatus",value:function(){return this[Gs].getAttendeeStatus()}},{key:"getSubsessionStatus",value:function(){return this[Gs].getRoomStatus()}},{key:"getCurrentSubsession",value:function(){var e=this[Gs].getCurrentRoom();return{userStatus:e.attendeeStatus,subsessionName:e.name,subsessionId:e.roomId}}},{key:"getSubsessionOptions",value:function(){var e=this[Gs].getRoomOptions();return $u({isAutoJoinSubsession:e.isAutoJoinRoom,isSubsessionSelectionEnabled:e.isRoomSelectionEnabled},Uk(e,cft))}}]),n}(),dh=Symbol("liveTranscription"),uft=function(){function n(e){np(this,n),this[dh]=void 0,this[dh]=e}return rp(n,[{key:"startLiveTranscription",value:function(){return this[dh].startLiveTranscription()}},{key:"setSpeakingLanguage",value:function(e){return this[dh].setSpeakingLanguage(e)}},{key:"setTranslationLanguage",value:function(e){return this[dh].setTranslationLanguage(e)}},{key:"getLiveTranscriptionStatus",value:function(){return this[dh].getLiveTranscriptionStatus()}},{key:"getCurrentTranscriptionLanguage",value:function(){return this[dh].getCurrentTranscriptionLanguage()}},{key:"getCurrentTranslationLanguage",value:function(){return this[dh].getCurrentTranslationLanguage()}},{key:"getLatestTranscription",value:function(){return this[dh].getLatestTranscription()}},{key:"getLatestTranslation",value:function(){return this[dh].getLatestTranslation()}},{key:"getFullTranscriptionHistory",value:function(){return this[dh].getFullTranscriptionHistory()}},{key:"disableCaptions",value:function(e){return this[dh].disableCaptions(e)}}]),n}(),J_=Symbol("liveStream"),dft=function(){function n(e){np(this,n),this[J_]=void 0,this[J_]=e}return rp(n,[{key:"startLiveStream",value:function(e,t,r){return this[J_].startLiveStream(e,t,r)}},{key:"stopLiveStream",value:function(){return this[J_].stopLiveStream()}},{key:"isLiveStreamEnabled",value:function(){return this[J_].isLiveStreamEnabled()}},{key:"getLiveStreamStatus",value:function(){return this[J_].getLiveStreamStatus()}}]),n}(),cI=Symbol("logger"),hft=function(){function n(e,t){if(np(this,n),this[cI]=void 0,this[cI]=e,t){var r=t.debugMode,i=t.trackingId;this[cI].setLogOptions({debugMode:r,trackingId:i})}}return rp(n,[{key:"reportToGlobalTracing",value:function(e){return this[cI].reportToGlobalTracing(e)}},{key:"reportRating",value:function(e,t){return this[cI].reportRating(e,t)}}]),n}(),fft=["roomName"],pft=["roomId","roomName"],Xge=[{event:"connection-change",originalEvent:"connection-change",payloadTransform:function(n){var e=n.roomName,t=Uk(n,fft);return e?$u($u({},t),{},{subsessionName:e}):n}},{event:"user-added",originalEvent:"user-added",payloadTransform:function(n){return n.map(function(e){return lH(e)})}},{event:"user-updated",originalEvent:"user-updated",payloadTransform:function(n){return n.map(function(e){return lH(e)})}},{event:"user-removed",originalEvent:"user-removed",payloadTransform:function(n){return n.map(function(e){return lH(e)})}},{event:"subsession-invite-to-join",originalEvent:"invite-to-join",payloadTransform:function(n){return{subsessionId:n.roomId,subsessionName:n.name}}},{event:"subsession-countdown",originalEvent:"room-countdown"},{event:"subsession-time-up",originalEvent:"room-time-up"},{event:"closing-subsession-countdown",originalEvent:"closing-room-countdown"},{event:"subsession-broadcast-message",originalEvent:"broadcast-message"},{event:"subsession-broadcast-voice",originalEvent:"broadcast-voice"},{event:"subsession-ask-for-help",originalEvent:"ask-for-help",payloadTransform:function(n){return{userId:n.userId,userGuid:n.userGuid,displayName:n.displayName,subsessionId:n.roomId,subsessionName:n.roomName}}},{event:"subsession-ask-for-help-response",originalEvent:"ask-for-help-response"},{event:"subsession-invite-back-to-main-session",originalEvent:"invite-back-to-main-session"},{event:"subsession-state-change",originalEvent:"room-state-change"},{event:"host-ask-unmute-audio",originalEvent:"unmute-audio-consent"},{event:"subsession-user-update",originalEvent:"room-user-update",payloadTransform:function(n){return $u({subsessionId:n.roomId,subsessionName:n.roomName},Uk(n,pft))}},{event:"active-media-failed",originalEvent:"media-internal-error"}],bp=Symbol("summary"),gft=function(){function n(e){np(this,n),this[bp]=void 0,this[bp]=e}return rp(n,[{key:"startSummary",value:function(){return this[bp].startSummary()}},{key:"stopSummary",value:function(){return this[bp].stopSummary()}},{key:"isSummaryEnabled",value:function(){return this[bp].isSummaryEnabled()}},{key:"getSummaryStatus",value:function(){return this[bp].getSummaryStatus()}},{key:"startMeetingQuery",value:function(){return this[bp].startMeetingQuery()}},{key:"stopMeetingQuery",value:function(){return this[bp].stopMeetingQuery()}},{key:"isMeetingQueryEnabled",value:function(){return this[bp].isMeetingQueryEnabled()}},{key:"getMeetingQueryStatus",value:function(){return this[bp].getMeetingQueryStatus()}}]),n}(),bi=Symbol("Client"),D5=new WeakMap,mft=function(){function n(){np(this,n),this[bi]=void 0,this.stream=void 0,this.chat=void 0,this.command=void 0,this.recording=void 0,this.subsession=void 0,this.liveTranscription=void 0,this.logger=void 0,this.liveStream=void 0,this.aiClient=void 0,this[bi]=$p.createClient(),D5.set(this,new Map)}return rp(n,[{key:"init",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"en-US",t=arguments.length>2?arguments[2]:void 0,r=x5e(arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Global");return window.isSecureContext===!1&&console.warn("The page is not in a secure context, to use audio, video, screen, a secure context must be enabled."),function(){var i="__ZOOM_VIDEO_SDK_DOM_STORAGE_TEST__";try{return localStorage.setItem(i,i),localStorage.removeItem(i),sessionStorage.setItem(i,i),sessionStorage.removeItem(i),!0}catch{return!1}}()||console.warn("localstorage or sessionstorage is not enabled, please enable to use the video sdk,"),this[bi].init("","",{language:e,dependentAssets:r,constraints:$u($u({},$p.checkSystemRequirements()),{},{screen:(typeof WebAssembly>"u"?"undefined":rq(WebAssembly))==="object"&&typeof Worker=="function"}),additionalFeatures:["chat","cmd","recording","breakoutRoom","liveTranscription","logger","liveStream","summary"],webEndpoint:(t==null?void 0:t.webEndpoint)||"zoom.us",skipJsMedia:t==null?void 0:t.skipJsMedia,enforceMultipleVideos:t==null?void 0:t.enforceMultipleVideos,stayAwake:t==null?void 0:t.stayAwake,enforceVirtualBackground:t==null?void 0:t.enforceVirtualBackground,quicklyLeaveMeeting:t==null?void 0:t.leaveOnPageUnload,patchJsMedia:t==null?void 0:t.patchJsMedia,alternativeNameForVideoPlayer:t==null?void 0:t.alternativeNameForVideoPlayer})}},{key:"join",value:function(e,t,r,i,o){return cH(e)&&cH(t)&&cH(r)?e.length>200?Promise.reject({type:T5,reason:"The maximum length of topic is 200"}):r.length>200?Promise.reject({type:T5,reason:"The maximum length of username is 200"}):i&&(typeof i!="string"||i.length>10)?Promise.reject({type:T5,reason:"The maximum length of password is 10"}):this[bi].joinInstant(e,t,r,aD,i,o):Promise.reject({type:T5,reason:"Topic, token and userName must be string and required"})}},{key:"leave",value:function(){var e;return arguments.length>0&&arguments[0]!==void 0&&arguments[0]?((e=D5.get(this))===null||e===void 0||e.clear(),this[bi].end()):this[bi].leave()}},{key:"on",value:function(e,t){var r=Xge.find(function(l){return l.event===e});if(r){var i=r.originalEvent,o=r.payloadTransform;if(o){var s=function(l){var u=o(l);t(u)};this[bi].on(i,s);var a=D5.get(this);if(a){a.has(e)||a.set(e,[]);var c=a.get(e);c==null||c.push({originalCb:t,newCb:s})}}else this[bi].on(i,t)}else this[bi].on(e,t)}},{key:"off",value:function(e,t){var r=Xge.find(function(l){return l.event===e});if(r){var i=r.originalEvent;if(r.payloadTransform){var o=D5.get(this);if(o){var s=o.get(e),a=s==null?void 0:s.find(function(l){return l.originalCb===t});if(a&&s){this[bi].off(i,a.newCb);var c=s==null?void 0:s.filter(function(l){return l.originalCb!==t});o.set(e,c)}}}else this[bi].off(i,t)}else this[bi].off(e,t)}},{key:"getMediaStream",value:function(){return this.stream||(this.stream=new nft(this[bi].getMediaStream())),this.stream}},{key:"getChatClient",value:function(){return this.chat||(this.chat=new ift(this[bi].getFeatureModule("chat"))),this.chat}},{key:"getRecordingClient",value:function(){return this.recording||(this.recording=new oft(this[bi].getFeatureModule("recording"))),this.recording}},{key:"getCommandClient",value:function(){return this.command||(this.command=new sft(this[bi].getFeatureModule("cmd"))),this.command}},{key:"getSubsessionClient",value:function(){return this.subsession||(this.subsession=new lft(this[bi].getFeatureModule("breakoutRoom"))),this.subsession}},{key:"getLiveTranscriptionClient",value:function(){return this.liveTranscription||(this.liveTranscription=new uft(this[bi].getFeatureModule("liveTranscription"))),this.liveTranscription}},{key:"getLoggerClient",value:function(e){return this.logger||(this.logger=new hft(this[bi].getFeatureModule("logger"),e)),this.logger}},{key:"getLiveStreamClient",value:function(){return this.liveStream||(this.liveStream=new dft(this[bi].getFeatureModule("liveStream"))),this.liveStream}},{key:"getAIClient",value:function(){return this.aiClient||(this.aiClient=new gft(this[bi].getFeatureModule("summary"))),this.aiClient}},{key:"getSessionInfo",value:function(){var e=this[bi].getMeetingInfo();return{isInMeeting:e.isInMeeting||!1,password:e.password||"",topic:e.topic,userName:e.userName,userId:e.userId,sessionId:e.meetingId}}},{key:"getCurrentUserInfo",value:function(){return Jw(this[bi].getCurrentUserInfo())}},{key:"getUser",value:function(e){return Jw(this[bi].getParticipantsList().find(function(t){return t.userId===e}))}},{key:"getAllUser",value:function(){return this[bi].getParticipantsList().map(function(e){return Jw(e)})}},{key:"changeName",value:function(e,t){return this[bi].changeName(e,t)}},{key:"makeHost",value:function(e){return this[bi].makeHost(e)}},{key:"removeUser",value:function(e){return this[bi].removeUser(e)}},{key:"makeManager",value:function(e){return this[bi].makeCoHost(e)}},{key:"revokeManager",value:function(e){return this[bi].revokeCoHost(e)}},{key:"reclaimHost",value:function(){return this[bi].reclaimHost()}},{key:"isHost",value:function(){return this[bi].isHost()}},{key:"isOriginalHost",value:function(){return this[bi].isOriginHost()}},{key:"getSessionHost",value:function(){return Jw(this[bi].getMeetingHost())}},{key:"isManager",value:function(){return this[bi].isCoHost()}}]),n}(),p3=function(){function n(){np(this,n)}return rp(n,null,[{key:"createClient",value:function(){return this.videoClient||(this.videoClient=new mft),this.videoClient}},{key:"destroyClient",value:function(){this.videoClient&&(this.videoClient.leave(),this.videoClient=null)}},{key:"checkSystemRequirements",value:function(){return $p.checkSystemRequirements()}},{key:"checkFeatureRequirements",value:function(){return $p.checkFeatureRequirements()}},{key:"getDevices",value:function(e){return $p.getDevices(e)}},{key:"createLocalAudioTrack",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return $p.createLocalAudioTrack(e)}},{key:"createLocalVideoTrack",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return $p.createLocalVideoTrack(e)}},{key:"preloadDependentAssets",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"Global";$p.preloadDependentAssets(x5e(e))}}]),n}();p3.videoClient=void 0,p3.VERSION=aD,function(n){n[n.All=1]="All",n[n.NoOne=4]="NoOne",n[n.EveryonePublicly=5]="EveryonePublicly"}(zge||(zge={})),function(n){n[n.All=0]="All"}(Vge||(Vge={})),function(n){n[n.Automatically=C1.Automatically]="Automatically",n[n.Manually=C1.Manually]="Manually"}(Wge||(Wge={})),function(n){n[n.Initial=Cn.Initial]="Initial",n[n.Invited=Cn.Invited]="Invited",n[n.Joining=Cn.Joining]="Joining",n[n.InSubsession=Cn.InRoom]="InSubsession",n[n.Leaving=Cn.Leaving]="Leaving",n[n.MainSession=Cn.MainSession]="MainSession"}(qge||(qge={})),function(n){n[n.NotStarted=Sr.NotStarted]="NotStarted",n[n.InProgress=Sr.InProgress]="InProgress",n[n.Closing=Sr.Closing]="Closing",n[n.Closed=Sr.Closed]="Closed"}(Kge||(Kge={})),function(n){n[n.Failover=cc.Failover]="Failover",n[n.JoinSubsession=cc.JoinBreakoutRoom]="JoinSubsession",n[n.MoveToSubsession=cc.MoveToBreakoutRoom]="MoveToSubsession",n[n.BackToMainSession=cc.BackToMainSession]="BackToMainSession"}(Qw||(Qw={})),function(n){n[n.Unlocked=Cd.HostGrab]="Unlocked",n[n.Locked=Cd.OnlyHost]="Locked",n[n.MultipleShare=Cd.MultipleShare]="MultipleShare"}(Gge||(Gge={})),function(n){n[n.Unknown=Qa.Unknown]="Unknown",n[n.Uninstalled=Qa.Uninstalled]="Uninstalled",n[n.Installed=Qa.Installed]="Installed",n[n.Unlaunched=l6.Unlaunched]="Unlaunched",n[n.Launched=l6.Launched]="Launched"}(Zge||(Zge={}));var k5e={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(n){(function(){var e={}.hasOwnProperty;function t(){for(var o="",s=0;s<arguments.length;s++){var a=arguments[s];a&&(o=i(o,r(a)))}return o}function r(o){if(typeof o=="string"||typeof o=="number")return o;if(typeof o!="object")return"";if(Array.isArray(o))return t.apply(null,o);if(o.toString!==Object.prototype.toString&&!o.toString.toString().includes("[native code]"))return o.toString();var s="";for(var a in o)e.call(o,a)&&o[a]&&(s=i(s,a));return s}function i(o,s){return s?o?o+" "+s:o+s:o}n.exports?(t.default=t,n.exports=t):window.classNames=t})()})(k5e);var vft=k5e.exports;const Ue=Fy(vft);function ln(){return ln=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},ln.apply(null,arguments)}var T5e={exports:{}},so={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wne=Symbol.for("react.element"),Cne=Symbol.for("react.portal"),T7=Symbol.for("react.fragment"),D7=Symbol.for("react.strict_mode"),R7=Symbol.for("react.profiler"),A7=Symbol.for("react.provider"),O7=Symbol.for("react.context"),yft=Symbol.for("react.server_context"),M7=Symbol.for("react.forward_ref"),$7=Symbol.for("react.suspense"),L7=Symbol.for("react.suspense_list"),N7=Symbol.for("react.memo"),F7=Symbol.for("react.lazy"),bft=Symbol.for("react.offscreen"),D5e;D5e=Symbol.for("react.module.reference");function Kh(n){if(typeof n=="object"&&n!==null){var e=n.$$typeof;switch(e){case wne:switch(n=n.type,n){case T7:case R7:case D7:case $7:case L7:return n;default:switch(n=n&&n.$$typeof,n){case yft:case O7:case M7:case F7:case N7:case A7:return n;default:return e}}case Cne:return e}}}so.ContextConsumer=O7;so.ContextProvider=A7;so.Element=wne;so.ForwardRef=M7;so.Fragment=T7;so.Lazy=F7;so.Memo=N7;so.Portal=Cne;so.Profiler=R7;so.StrictMode=D7;so.Suspense=$7;so.SuspenseList=L7;so.isAsyncMode=function(){return!1};so.isConcurrentMode=function(){return!1};so.isContextConsumer=function(n){return Kh(n)===O7};so.isContextProvider=function(n){return Kh(n)===A7};so.isElement=function(n){return typeof n=="object"&&n!==null&&n.$$typeof===wne};so.isForwardRef=function(n){return Kh(n)===M7};so.isFragment=function(n){return Kh(n)===T7};so.isLazy=function(n){return Kh(n)===F7};so.isMemo=function(n){return Kh(n)===N7};so.isPortal=function(n){return Kh(n)===Cne};so.isProfiler=function(n){return Kh(n)===R7};so.isStrictMode=function(n){return Kh(n)===D7};so.isSuspense=function(n){return Kh(n)===$7};so.isSuspenseList=function(n){return Kh(n)===L7};so.isValidElementType=function(n){return typeof n=="string"||typeof n=="function"||n===T7||n===R7||n===D7||n===$7||n===L7||n===bft||typeof n=="object"&&n!==null&&(n.$$typeof===F7||n.$$typeof===N7||n.$$typeof===A7||n.$$typeof===O7||n.$$typeof===M7||n.$$typeof===D5e||n.getModuleId!==void 0)};so.typeOf=Kh;T5e.exports=so;var ik=T5e.exports;function hg(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=[];return Ke.Children.forEach(n,function(r){r==null&&!e.keepEmpty||(Array.isArray(r)?t=t.concat(hg(r)):ik.isFragment(r)&&r.props?t=t.concat(hg(r.props.children,e)):t.push(r))}),t}var mG={},Sft=function(e){};function _ft(n,e){}function wft(n,e){}function Cft(){mG={}}function R5e(n,e,t){!e&&!mG[t]&&(n(!1,t),mG[t]=!0)}function Sl(n,e){R5e(_ft,n,e)}function xft(n,e){R5e(wft,n,e)}Sl.preMessage=Sft;Sl.resetWarned=Cft;Sl.noteOnce=xft;function Wn(n){"@babel/helpers - typeof";return Wn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wn(n)}function Eft(n,e){if(Wn(n)!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(Wn(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function A5e(n){var e=Eft(n,"string");return Wn(e)=="symbol"?e:e+""}function Le(n,e,t){return(e=A5e(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Yge(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function $e(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Yge(Object(t),!0).forEach(function(r){Le(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Yge(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function g3(n){return n instanceof HTMLElement||n instanceof SVGElement}function O5e(n){return n&&Wn(n)==="object"&&g3(n.nativeElement)?n.nativeElement:g3(n)?n:null}function ok(n){var e=O5e(n);if(e)return e;if(n instanceof Ke.Component){var t;return(t=sW.findDOMNode)===null||t===void 0?void 0:t.call(sW,n)}return null}function cD(n,e,t){var r=y.useRef({});return(!("value"in r.current)||t(r.current.condition,e))&&(r.current.value=n(),r.current.condition=e),r.current.value}var xne=function(e,t){typeof e=="function"?e(t):Wn(e)==="object"&&e&&"current"in e&&(e.current=t)},Gd=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var i=t.filter(Boolean);return i.length<=1?i[0]:function(o){t.forEach(function(s){xne(s,o)})}},Uy=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return cD(function(){return Gd.apply(void 0,t)},t,function(i,o){return i.length!==o.length||i.every(function(s,a){return s!==o[a]})})},yv=function(e){var t,r,i=ik.isMemo(e)?e.type.type:e.type;return!(typeof i=="function"&&!((t=i.prototype)!==null&&t!==void 0&&t.render)&&i.$$typeof!==ik.ForwardRef||typeof e=="function"&&!((r=e.prototype)!==null&&r!==void 0&&r.render)&&e.$$typeof!==ik.ForwardRef)};function vG(n){return y.isValidElement(n)&&!ik.isFragment(n)}var Ift=function(e){return vG(e)&&yv(e)};Number(y.version.split(".")[0])>=19;var yG=y.createContext(null);function Pft(n){var e=n.children,t=n.onBatchResize,r=y.useRef(0),i=y.useRef([]),o=y.useContext(yG),s=y.useCallback(function(a,c,l){r.current+=1;var u=r.current;i.current.push({size:a,element:c,data:l}),Promise.resolve().then(function(){u===r.current&&(t==null||t(i.current),i.current=[])}),o==null||o(a,c,l)},[t,o]);return y.createElement(yG.Provider,{value:s},e)}var M5e=function(){if(typeof Map<"u")return Map;function n(e,t){var r=-1;return e.some(function(i,o){return i[0]===t?(r=o,!0):!1}),r}return function(){function e(){this.__entries__=[]}return Object.defineProperty(e.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),e.prototype.get=function(t){var r=n(this.__entries__,t),i=this.__entries__[r];return i&&i[1]},e.prototype.set=function(t,r){var i=n(this.__entries__,t);~i?this.__entries__[i][1]=r:this.__entries__.push([t,r])},e.prototype.delete=function(t){var r=this.__entries__,i=n(r,t);~i&&r.splice(i,1)},e.prototype.has=function(t){return!!~n(this.__entries__,t)},e.prototype.clear=function(){this.__entries__.splice(0)},e.prototype.forEach=function(t,r){r===void 0&&(r=null);for(var i=0,o=this.__entries__;i<o.length;i++){var s=o[i];t.call(r,s[1],s[0])}},e}()}(),bG=typeof window<"u"&&typeof document<"u"&&window.document===document,f8=function(){return typeof global<"u"&&global.Math===Math?global:typeof self<"u"&&self.Math===Math?self:typeof window<"u"&&window.Math===Math?window:Function("return this")()}(),kft=function(){return typeof requestAnimationFrame=="function"?requestAnimationFrame.bind(f8):function(n){return setTimeout(function(){return n(Date.now())},1e3/60)}}(),Tft=2;function Dft(n,e){var t=!1,r=!1,i=0;function o(){t&&(t=!1,n()),r&&a()}function s(){kft(o)}function a(){var c=Date.now();if(t){if(c-i<Tft)return;r=!0}else t=!0,r=!1,setTimeout(s,e);i=c}return a}var Rft=20,Aft=["top","right","bottom","left","width","height","size","weight"],Oft=typeof MutationObserver<"u",Mft=function(){function n(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=Dft(this.refresh.bind(this),Rft)}return n.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},n.prototype.removeObserver=function(e){var t=this.observers_,r=t.indexOf(e);~r&&t.splice(r,1),!t.length&&this.connected_&&this.disconnect_()},n.prototype.refresh=function(){var e=this.updateObservers_();e&&this.refresh()},n.prototype.updateObservers_=function(){var e=this.observers_.filter(function(t){return t.gatherActive(),t.hasActive()});return e.forEach(function(t){return t.broadcastActive()}),e.length>0},n.prototype.connect_=function(){!bG||this.connected_||(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),Oft?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},n.prototype.disconnect_=function(){!bG||!this.connected_||(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},n.prototype.onTransitionEnd_=function(e){var t=e.propertyName,r=t===void 0?"":t,i=Aft.some(function(o){return!!~r.indexOf(o)});i&&this.refresh()},n.getInstance=function(){return this.instance_||(this.instance_=new n),this.instance_},n.instance_=null,n}(),$5e=function(n,e){for(var t=0,r=Object.keys(e);t<r.length;t++){var i=r[t];Object.defineProperty(n,i,{value:e[i],enumerable:!1,writable:!1,configurable:!0})}return n},G2=function(n){var e=n&&n.ownerDocument&&n.ownerDocument.defaultView;return e||f8},L5e=j7(0,0,0,0);function p8(n){return parseFloat(n)||0}function Jge(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];return e.reduce(function(r,i){var o=n["border-"+i+"-width"];return r+p8(o)},0)}function $ft(n){for(var e=["top","right","bottom","left"],t={},r=0,i=e;r<i.length;r++){var o=i[r],s=n["padding-"+o];t[o]=p8(s)}return t}function Lft(n){var e=n.getBBox();return j7(0,0,e.width,e.height)}function Nft(n){var e=n.clientWidth,t=n.clientHeight;if(!e&&!t)return L5e;var r=G2(n).getComputedStyle(n),i=$ft(r),o=i.left+i.right,s=i.top+i.bottom,a=p8(r.width),c=p8(r.height);if(r.boxSizing==="border-box"&&(Math.round(a+o)!==e&&(a-=Jge(r,"left","right")+o),Math.round(c+s)!==t&&(c-=Jge(r,"top","bottom")+s)),!jft(n)){var l=Math.round(a+o)-e,u=Math.round(c+s)-t;Math.abs(l)!==1&&(a-=l),Math.abs(u)!==1&&(c-=u)}return j7(i.left,i.top,a,c)}var Fft=function(){return typeof SVGGraphicsElement<"u"?function(n){return n instanceof G2(n).SVGGraphicsElement}:function(n){return n instanceof G2(n).SVGElement&&typeof n.getBBox=="function"}}();function jft(n){return n===G2(n).document.documentElement}function Bft(n){return bG?Fft(n)?Lft(n):Nft(n):L5e}function Hft(n){var e=n.x,t=n.y,r=n.width,i=n.height,o=typeof DOMRectReadOnly<"u"?DOMRectReadOnly:Object,s=Object.create(o.prototype);return $5e(s,{x:e,y:t,width:r,height:i,top:t,right:e+r,bottom:i+t,left:e}),s}function j7(n,e,t,r){return{x:n,y:e,width:t,height:r}}var Uft=function(){function n(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=j7(0,0,0,0),this.target=e}return n.prototype.isActive=function(){var e=Bft(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},n.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e},n}(),zft=function(){function n(e,t){var r=Hft(t);$5e(this,{target:e,contentRect:r})}return n}(),Vft=function(){function n(e,t,r){if(this.activeObservations_=[],this.observations_=new M5e,typeof e!="function")throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=t,this.callbackCtx_=r}return n.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(e instanceof G2(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)||(t.set(e,new Uft(e)),this.controller_.addObserver(this),this.controller_.refresh())}},n.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(e instanceof G2(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)&&(t.delete(e),t.size||this.controller_.removeObserver(this))}},n.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},n.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach(function(t){t.isActive()&&e.activeObservations_.push(t)})},n.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,t=this.activeObservations_.map(function(r){return new zft(r.target,r.broadcastRect())});this.callback_.call(e,t,e),this.clearActive()}},n.prototype.clearActive=function(){this.activeObservations_.splice(0)},n.prototype.hasActive=function(){return this.activeObservations_.length>0},n}(),N5e=typeof WeakMap<"u"?new WeakMap:new M5e,F5e=function(){function n(e){if(!(this instanceof n))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var t=Mft.getInstance(),r=new Vft(e,t,this);N5e.set(this,r)}return n}();["observe","unobserve","disconnect"].forEach(function(n){F5e.prototype[n]=function(){var e;return(e=N5e.get(this))[n].apply(e,arguments)}});var Wft=function(){return typeof f8.ResizeObserver<"u"?f8.ResizeObserver:F5e}(),H0=new Map;function qft(n){n.forEach(function(e){var t,r=e.target;(t=H0.get(r))===null||t===void 0||t.forEach(function(i){return i(r)})})}var j5e=new Wft(qft);function Kft(n,e){H0.has(n)||(H0.set(n,new Set),j5e.observe(n)),H0.get(n).add(e)}function Gft(n,e){H0.has(n)&&(H0.get(n).delete(e),H0.get(n).size||(j5e.unobserve(n),H0.delete(n)))}function vc(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function Qge(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,A5e(r.key),r)}}function yc(n,e,t){return e&&Qge(n.prototype,e),t&&Qge(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}function m3(n,e){return m3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},m3(n,e)}function zy(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),e&&m3(n,e)}function v3(n){return v3=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},v3(n)}function Ene(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ene=function(){return!!n})()}function Yr(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function Zft(n,e){if(e&&(Wn(e)=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Yr(n)}function Vy(n){var e=Ene();return function(){var t,r=v3(n);if(e){var i=v3(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return Zft(this,t)}}var Xft=function(n){zy(t,n);var e=Vy(t);function t(){return vc(this,t),e.apply(this,arguments)}return yc(t,[{key:"render",value:function(){return this.props.children}}]),t}(y.Component);function Yft(n,e){var t=n.children,r=n.disabled,i=y.useRef(null),o=y.useRef(null),s=y.useContext(yG),a=typeof t=="function",c=a?t(i):t,l=y.useRef({width:-1,height:-1,offsetWidth:-1,offsetHeight:-1}),u=!a&&y.isValidElement(c)&&yv(c),d=u?c.ref:null,h=Uy(d,i),f=function(){var v;return ok(i.current)||(i.current&&Wn(i.current)==="object"?ok((v=i.current)===null||v===void 0?void 0:v.nativeElement):null)||ok(o.current)};y.useImperativeHandle(e,function(){return f()});var p=y.useRef(n);p.current=n;var g=y.useCallback(function(m){var v=p.current,b=v.onResize,S=v.data,E=m.getBoundingClientRect(),w=E.width,C=E.height,I=m.offsetWidth,T=m.offsetHeight,D=Math.floor(w),O=Math.floor(C);if(l.current.width!==D||l.current.height!==O||l.current.offsetWidth!==I||l.current.offsetHeight!==T){var M={width:D,height:O,offsetWidth:I,offsetHeight:T};l.current=M;var R=I===Math.round(w)?w:I,A=T===Math.round(C)?C:T,k=$e($e({},M),{},{offsetWidth:R,offsetHeight:A});s==null||s(k,m,S),b&&Promise.resolve().then(function(){b(k,m)})}},[]);return y.useEffect(function(){var m=f();return m&&!r&&Kft(m,g),function(){return Gft(m,g)}},[i.current,r]),y.createElement(Xft,{ref:o},u?y.cloneElement(c,{ref:h}):c)}var Jft=y.forwardRef(Yft),Qft="rc-observer-key";function ept(n,e){var t=n.children,r=typeof t=="function"?[t]:hg(t);return r.map(function(i,o){var s=(i==null?void 0:i.key)||"".concat(Qft,"-").concat(o);return y.createElement(Jft,ln({},n,{key:s,ref:o===0?e:void 0}),i)})}var Wy=y.forwardRef(ept);Wy.Collection=Pft;function Yc(n,e){var t=Object.assign({},n);return Array.isArray(e)&&e.forEach(function(r){delete t[r]}),t}function SG(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=Array(e);t<e;t++)r[t]=n[t];return r}function tpt(n){if(Array.isArray(n))return SG(n)}function B5e(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function Ine(n,e){if(n){if(typeof n=="string")return SG(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?SG(n,e):void 0}}function npt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ht(n){return tpt(n)||B5e(n)||Ine(n)||npt()}var H5e=function(e){return+setTimeout(e,16)},U5e=function(e){return clearTimeout(e)};typeof window<"u"&&"requestAnimationFrame"in window&&(H5e=function(e){return window.requestAnimationFrame(e)},U5e=function(e){return window.cancelAnimationFrame(e)});var eme=0,Pne=new Map;function z5e(n){Pne.delete(n)}var no=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;eme+=1;var r=eme;function i(o){if(o===0)z5e(r),e();else{var s=H5e(function(){i(o-1)});Pne.set(r,s)}}return i(t),r};no.cancel=function(n){var e=Pne.get(n);return z5e(n),U5e(e)};function V5e(n){if(Array.isArray(n))return n}function rpt(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var r,i,o,s,a=[],c=!0,l=!1;try{if(o=(t=t.call(n)).next,e===0){if(Object(t)!==t)return;c=!1}else for(;!(c=(r=o.call(t)).done)&&(a.push(r.value),a.length!==e);c=!0);}catch(u){l=!0,i=u}finally{try{if(!c&&t.return!=null&&(s=t.return(),Object(s)!==s))return}finally{if(l)throw i}}return a}}function W5e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rt(n,e){return V5e(n)||rpt(n,e)||Ine(n,e)||W5e()}function y3(n){for(var e=0,t,r=0,i=n.length;i>=4;++r,i-=4)t=n.charCodeAt(r)&255|(n.charCodeAt(++r)&255)<<8|(n.charCodeAt(++r)&255)<<16|(n.charCodeAt(++r)&255)<<24,t=(t&65535)*1540483477+((t>>>16)*59797<<16),t^=t>>>24,e=(t&65535)*1540483477+((t>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(i){case 3:e^=(n.charCodeAt(r+2)&255)<<16;case 2:e^=(n.charCodeAt(r+1)&255)<<8;case 1:e^=n.charCodeAt(r)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}function eu(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}function _G(n,e){if(!n)return!1;if(n.contains)return n.contains(e);for(var t=e;t;){if(t===n)return!0;t=t.parentNode}return!1}var tme="data-rc-order",nme="data-rc-priority",ipt="rc-util-key",wG=new Map;function q5e(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=n.mark;return e?e.startsWith("data-")?e:"data-".concat(e):ipt}function B7(n){if(n.attachTo)return n.attachTo;var e=document.querySelector("head");return e||document.body}function opt(n){return n==="queue"?"prependQueue":n?"prepend":"append"}function kne(n){return Array.from((wG.get(n)||n).children).filter(function(e){return e.tagName==="STYLE"})}function K5e(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!eu())return null;var t=e.csp,r=e.prepend,i=e.priority,o=i===void 0?0:i,s=opt(r),a=s==="prependQueue",c=document.createElement("style");c.setAttribute(tme,s),a&&o&&c.setAttribute(nme,"".concat(o)),t!=null&&t.nonce&&(c.nonce=t==null?void 0:t.nonce),c.innerHTML=n;var l=B7(e),u=l.firstChild;if(r){if(a){var d=(e.styles||kne(l)).filter(function(h){if(!["prepend","prependQueue"].includes(h.getAttribute(tme)))return!1;var f=Number(h.getAttribute(nme)||0);return o>=f});if(d.length)return l.insertBefore(c,d[d.length-1].nextSibling),c}l.insertBefore(c,u)}else l.appendChild(c);return c}function G5e(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=B7(e);return(e.styles||kne(t)).find(function(r){return r.getAttribute(q5e(e))===n})}function b3(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=G5e(n,e);if(t){var r=B7(e);r.removeChild(t)}}function spt(n,e){var t=wG.get(n);if(!t||!_G(document,t)){var r=K5e("",e),i=r.parentNode;wG.set(n,i),n.removeChild(r)}}function Wm(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=B7(t),i=kne(r),o=$e($e({},t),{},{styles:i});spt(r,o);var s=G5e(e,o);if(s){var a,c;if((a=o.csp)!==null&&a!==void 0&&a.nonce&&s.nonce!==((c=o.csp)===null||c===void 0?void 0:c.nonce)){var l;s.nonce=(l=o.csp)===null||l===void 0?void 0:l.nonce}return s.innerHTML!==n&&(s.innerHTML=n),s}var u=K5e(n,o);return u.setAttribute(q5e(o),e),u}function apt(n,e){if(n==null)return{};var t={};for(var r in n)if({}.hasOwnProperty.call(n,r)){if(e.includes(r))continue;t[r]=n[r]}return t}function jr(n,e){if(n==null)return{};var t,r,i=apt(n,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);for(r=0;r<o.length;r++)t=o[r],e.includes(t)||{}.propertyIsEnumerable.call(n,t)&&(i[t]=n[t])}return i}function S3(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=new Set;function i(o,s){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,c=r.has(o);if(Sl(!c,"Warning: There may be circular references"),c)return!1;if(o===s)return!0;if(t&&a>1)return!1;r.add(o);var l=a+1;if(Array.isArray(o)){if(!Array.isArray(s)||o.length!==s.length)return!1;for(var u=0;u<o.length;u++)if(!i(o[u],s[u],l))return!1;return!0}if(o&&s&&Wn(o)==="object"&&Wn(s)==="object"){var d=Object.keys(o);return d.length!==Object.keys(s).length?!1:d.every(function(h){return i(o[h],s[h],l)})}return!1}return i(n,e)}var cpt="%";function CG(n){return n.join(cpt)}var lpt=function(){function n(e){vc(this,n),Le(this,"instanceId",void 0),Le(this,"cache",new Map),this.instanceId=e}return yc(n,[{key:"get",value:function(t){return this.opGet(CG(t))}},{key:"opGet",value:function(t){return this.cache.get(t)||null}},{key:"update",value:function(t,r){return this.opUpdate(CG(t),r)}},{key:"opUpdate",value:function(t,r){var i=this.cache.get(t),o=r(i);o===null?this.cache.delete(t):this.cache.set(t,o)}}]),n}(),Z2="data-token-hash",Vf="data-css-hash",U0="__cssinjs_instance__";function upt(){var n=Math.random().toString(12).slice(2);if(typeof document<"u"&&document.head&&document.body){var e=document.body.querySelectorAll("style[".concat(Vf,"]"))||[],t=document.head.firstChild;Array.from(e).forEach(function(i){i[U0]=i[U0]||n,i[U0]===n&&document.head.insertBefore(i,t)});var r={};Array.from(document.querySelectorAll("style[".concat(Vf,"]"))).forEach(function(i){var o=i.getAttribute(Vf);if(r[o]){if(i[U0]===n){var s;(s=i.parentNode)===null||s===void 0||s.removeChild(i)}}else r[o]=!0})}return new lpt(n)}var dpt=y.createContext({hashPriority:"low",cache:upt(),defaultCache:!0});const H7=dpt;function hpt(n,e){if(n.length!==e.length)return!1;for(var t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}var Tne=function(){function n(){vc(this,n),Le(this,"cache",void 0),Le(this,"keys",void 0),Le(this,"cacheCallTimes",void 0),this.cache=new Map,this.keys=[],this.cacheCallTimes=0}return yc(n,[{key:"size",value:function(){return this.keys.length}},{key:"internalGet",value:function(t){var r,i,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s={map:this.cache};return t.forEach(function(a){if(!s)s=void 0;else{var c;s=(c=s)===null||c===void 0||(c=c.map)===null||c===void 0?void 0:c.get(a)}}),(r=s)!==null&&r!==void 0&&r.value&&o&&(s.value[1]=this.cacheCallTimes++),(i=s)===null||i===void 0?void 0:i.value}},{key:"get",value:function(t){var r;return(r=this.internalGet(t,!0))===null||r===void 0?void 0:r[0]}},{key:"has",value:function(t){return!!this.internalGet(t)}},{key:"set",value:function(t,r){var i=this;if(!this.has(t)){if(this.size()+1>n.MAX_CACHE_SIZE+n.MAX_CACHE_OFFSET){var o=this.keys.reduce(function(l,u){var d=rt(l,2),h=d[1];return i.internalGet(u)[1]<h?[u,i.internalGet(u)[1]]:l},[this.keys[0],this.cacheCallTimes]),s=rt(o,1),a=s[0];this.delete(a)}this.keys.push(t)}var c=this.cache;t.forEach(function(l,u){if(u===t.length-1)c.set(l,{value:[r,i.cacheCallTimes++]});else{var d=c.get(l);d?d.map||(d.map=new Map):c.set(l,{map:new Map}),c=c.get(l).map}})}},{key:"deleteByPath",value:function(t,r){var i=t.get(r[0]);if(r.length===1){var o;return i.map?t.set(r[0],{map:i.map}):t.delete(r[0]),(o=i.value)===null||o===void 0?void 0:o[0]}var s=this.deleteByPath(i.map,r.slice(1));return(!i.map||i.map.size===0)&&!i.value&&t.delete(r[0]),s}},{key:"delete",value:function(t){if(this.has(t))return this.keys=this.keys.filter(function(r){return!hpt(r,t)}),this.deleteByPath(this.cache,t)}}]),n}();Le(Tne,"MAX_CACHE_SIZE",20);Le(Tne,"MAX_CACHE_OFFSET",5);var rme=0,Z5e=function(){function n(e){vc(this,n),Le(this,"derivatives",void 0),Le(this,"id",void 0),this.derivatives=Array.isArray(e)?e:[e],this.id=rme,e.length===0&&(e.length>0,void 0),rme+=1}return yc(n,[{key:"getDerivativeToken",value:function(t){return this.derivatives.reduce(function(r,i){return i(t,r)},void 0)}}]),n}(),dH=new Tne;function xG(n){var e=Array.isArray(n)?n:[n];return dH.has(e)||dH.set(e,new Z5e(e)),dH.get(e)}var fpt=new WeakMap,hH={};function ppt(n,e){for(var t=fpt,r=0;r<e.length;r+=1){var i=e[r];t.has(i)||t.set(i,new WeakMap),t=t.get(i)}return t.has(hH)||t.set(hH,n()),t.get(hH)}var ime=new WeakMap;function sk(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,t=ime.get(n)||"";return t||(Object.keys(n).forEach(function(r){var i=n[r];t+=r,i instanceof Z5e?t+=i.id:i&&Wn(i)==="object"?t+=sk(i,e):t+=i}),e&&(t=y3(t)),ime.set(n,t)),t}function ome(n,e){return y3("".concat(e,"_").concat(sk(n,!0)))}var EG=eu();function Ct(n){return typeof n=="number"?"".concat(n,"px"):n}function g8(n,e,t){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(i)return n;var o=$e($e({},r),{},Le(Le({},Z2,e),Vf,t)),s=Object.keys(o).map(function(a){var c=o[a];return c?"".concat(a,'="').concat(c,'"'):null}).filter(function(a){return a}).join(" ");return"<style ".concat(s,">").concat(n,"</style>")}var tO=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return"--".concat(t?"".concat(t,"-"):"").concat(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").replace(/([A-Z]+)([A-Z][a-z0-9]+)/g,"$1-$2").replace(/([a-z])([A-Z0-9])/g,"$1-$2").toLowerCase()},gpt=function(e,t,r){return Object.keys(e).length?".".concat(t).concat(r!=null&&r.scope?".".concat(r.scope):"","{").concat(Object.entries(e).map(function(i){var o=rt(i,2),s=o[0],a=o[1];return"".concat(s,":").concat(a,";")}).join(""),"}"):""},X5e=function(e,t,r){var i={},o={};return Object.entries(e).forEach(function(s){var a,c,l=rt(s,2),u=l[0],d=l[1];if(r!=null&&(a=r.preserve)!==null&&a!==void 0&&a[u])o[u]=d;else if((typeof d=="string"||typeof d=="number")&&!(r!=null&&(c=r.ignore)!==null&&c!==void 0&&c[u])){var h,f=tO(u,r==null?void 0:r.prefix);i[f]=typeof d=="number"&&!(r!=null&&(h=r.unitless)!==null&&h!==void 0&&h[u])?"".concat(d,"px"):String(d),o[u]="var(".concat(f,")")}}),[o,gpt(i,t,{scope:r==null?void 0:r.scope})]},sme=eu()?y.useLayoutEffect:y.useEffect,es=function(e,t){var r=y.useRef(!0);sme(function(){return e(r.current)},t),sme(function(){return r.current=!1,function(){r.current=!0}},[])},ame=function(e,t){es(function(r){if(!r)return e()},t)},mpt=$e({},zT),cme=mpt.useInsertionEffect,vpt=function(e,t,r){y.useMemo(e,r),es(function(){return t(!0)},r)},ypt=cme?function(n,e,t){return cme(function(){return n(),e()},t)}:vpt;const bpt=ypt;var Spt=$e({},zT),_pt=Spt.useInsertionEffect,wpt=function(e){var t=[],r=!1;function i(o){r||t.push(o)}return y.useEffect(function(){return r=!1,function(){r=!0,t.length&&t.forEach(function(o){return o()})}},e),i},Cpt=function(){return function(e){e()}},xpt=typeof _pt<"u"?wpt:Cpt;const Ept=xpt;function Dne(n,e,t,r,i){var o=y.useContext(H7),s=o.cache,a=[n].concat(Ht(e)),c=CG(a),l=Ept([c]),u=function(p){s.opUpdate(c,function(g){var m=g||[void 0,void 0],v=rt(m,2),b=v[0],S=b===void 0?0:b,E=v[1],w=E,C=w||t(),I=[S,C];return p?p(I):I})};y.useMemo(function(){u()},[c]);var d=s.opGet(c),h=d[1];return bpt(function(){i==null||i(h)},function(f){return u(function(p){var g=rt(p,2),m=g[0],v=g[1];return f&&m===0&&(i==null||i(h)),[m+1,v]}),function(){s.opUpdate(c,function(p){var g=p||[],m=rt(g,2),v=m[0],b=v===void 0?0:v,S=m[1],E=b-1;return E===0?(l(function(){(f||!s.opGet(c))&&(r==null||r(S,!1))}),null):[b-1,S]})}},[c]),h}var Ipt={},Ppt="css",l1=new Map;function kpt(n){l1.set(n,(l1.get(n)||0)+1)}function Tpt(n,e){if(typeof document<"u"){var t=document.querySelectorAll("style[".concat(Z2,'="').concat(n,'"]'));t.forEach(function(r){if(r[U0]===e){var i;(i=r.parentNode)===null||i===void 0||i.removeChild(r)}})}}var Dpt=0;function Rpt(n,e){l1.set(n,(l1.get(n)||0)-1);var t=Array.from(l1.keys()),r=t.filter(function(i){var o=l1.get(i)||0;return o<=0});t.length-r.length>Dpt&&r.forEach(function(i){Tpt(i,e),l1.delete(i)})}var Apt=function(e,t,r,i){var o=r.getDerivativeToken(e),s=$e($e({},o),t);return i&&(s=i(s)),s},Y5e="token";function Opt(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=y.useContext(H7),i=r.cache.instanceId,o=r.container,s=t.salt,a=s===void 0?"":s,c=t.override,l=c===void 0?Ipt:c,u=t.formatToken,d=t.getComputedToken,h=t.cssVar,f=ppt(function(){return Object.assign.apply(Object,[{}].concat(Ht(e)))},e),p=sk(f),g=sk(l),m=h?sk(h):"",v=Dne(Y5e,[a,n.id,p,g,m],function(){var b,S=d?d(f,l,n):Apt(f,l,n,u),E=$e({},S),w="";if(h){var C=X5e(S,h.key,{prefix:h.prefix,ignore:h.ignore,unitless:h.unitless,preserve:h.preserve}),I=rt(C,2);S=I[0],w=I[1]}var T=ome(S,a);S._tokenKey=T,E._tokenKey=ome(E,a);var D=(b=h==null?void 0:h.key)!==null&&b!==void 0?b:T;S._themeKey=D,kpt(D);var O="".concat(Ppt,"-").concat(y3(T));return S._hashId=O,[S,O,E,w,(h==null?void 0:h.key)||""]},function(b){Rpt(b[0]._themeKey,i)},function(b){var S=rt(b,4),E=S[0],w=S[3];if(h&&w){var C=Wm(w,y3("css-variables-".concat(E._themeKey)),{mark:Vf,prepend:"queue",attachTo:o,priority:-999});C[U0]=i,C.setAttribute(Z2,E._themeKey)}});return v}var Mpt=function(e,t,r){var i=rt(e,5),o=i[2],s=i[3],a=i[4],c=r||{},l=c.plain;if(!s)return null;var u=o._tokenKey,d=-999,h={"data-rc-order":"prependQueue","data-rc-priority":"".concat(d)},f=g8(s,a,u,h,l);return[d,u,f]},$pt={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},J5e="comm",Q5e="rule",eAe="decl",Lpt="@import",Npt="@keyframes",Fpt="@layer",tAe=Math.abs,Rne=String.fromCharCode;function nAe(n){return n.trim()}function nO(n,e,t){return n.replace(e,t)}function jpt(n,e,t){return n.indexOf(e,t)}function _3(n,e){return n.charCodeAt(e)|0}function X2(n,e,t){return n.slice(e,t)}function Tp(n){return n.length}function Bpt(n){return n.length}function R5(n,e){return e.push(n),n}var U7=1,Y2=1,rAe=0,Uh=0,pa=0,tE="";function Ane(n,e,t,r,i,o,s,a){return{value:n,root:e,parent:t,type:r,props:i,children:o,line:U7,column:Y2,length:s,return:"",siblings:a}}function Hpt(){return pa}function Upt(){return pa=Uh>0?_3(tE,--Uh):0,Y2--,pa===10&&(Y2=1,U7--),pa}function Wf(){return pa=Uh<rAe?_3(tE,Uh++):0,Y2++,pa===10&&(Y2=1,U7++),pa}function z0(){return _3(tE,Uh)}function rO(){return Uh}function z7(n,e){return X2(tE,n,e)}function w3(n){switch(n){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function zpt(n){return U7=Y2=1,rAe=Tp(tE=n),Uh=0,[]}function Vpt(n){return tE="",n}function fH(n){return nAe(z7(Uh-1,IG(n===91?n+2:n===40?n+1:n)))}function Wpt(n){for(;(pa=z0())&&pa<33;)Wf();return w3(n)>2||w3(pa)>3?"":" "}function qpt(n,e){for(;--e&&Wf()&&!(pa<48||pa>102||pa>57&&pa<65||pa>70&&pa<97););return z7(n,rO()+(e<6&&z0()==32&&Wf()==32))}function IG(n){for(;Wf();)switch(pa){case n:return Uh;case 34:case 39:n!==34&&n!==39&&IG(pa);break;case 40:n===41&&IG(n);break;case 92:Wf();break}return Uh}function Kpt(n,e){for(;Wf()&&n+pa!==57;)if(n+pa===84&&z0()===47)break;return"/*"+z7(e,Uh-1)+"*"+Rne(n===47?n:Wf())}function Gpt(n){for(;!w3(z0());)Wf();return z7(n,Uh)}function Zpt(n){return Vpt(iO("",null,null,null,[""],n=zpt(n),0,[0],n))}function iO(n,e,t,r,i,o,s,a,c){for(var l=0,u=0,d=s,h=0,f=0,p=0,g=1,m=1,v=1,b=0,S="",E=i,w=o,C=r,I=S;m;)switch(p=b,b=Wf()){case 40:if(p!=108&&_3(I,d-1)==58){jpt(I+=nO(fH(b),"&","&\f"),"&\f",tAe(l?a[l-1]:0))!=-1&&(v=-1);break}case 34:case 39:case 91:I+=fH(b);break;case 9:case 10:case 13:case 32:I+=Wpt(p);break;case 92:I+=qpt(rO()-1,7);continue;case 47:switch(z0()){case 42:case 47:R5(Xpt(Kpt(Wf(),rO()),e,t,c),c),(w3(p||1)==5||w3(z0()||1)==5)&&Tp(I)&&X2(I,-1,void 0)!==" "&&(I+=" ");break;default:I+="/"}break;case 123*g:a[l++]=Tp(I)*v;case 125*g:case 59:case 0:switch(b){case 0:case 125:m=0;case 59+u:v==-1&&(I=nO(I,/\f/g,"")),f>0&&(Tp(I)-d||g===0&&p===47)&&R5(f>32?ume(I+";",r,t,d-1,c):ume(nO(I," ","")+";",r,t,d-2,c),c);break;case 59:I+=";";default:if(R5(C=lme(I,e,t,l,u,i,a,S,E=[],w=[],d,o),o),b===123)if(u===0)iO(I,e,C,C,E,o,d,a,w);else switch(h===99&&_3(I,3)===110?100:h){case 100:case 108:case 109:case 115:iO(n,C,C,r&&R5(lme(n,C,C,0,0,i,a,S,i,E=[],d,w),w),i,w,d,a,r?E:w);break;default:iO(I,C,C,C,[""],w,0,a,w)}}l=u=f=0,g=v=1,S=I="",d=s;break;case 58:d=1+Tp(I),f=p;default:if(g<1){if(b==123)--g;else if(b==125&&g++==0&&Upt()==125)continue}switch(I+=Rne(b),b*g){case 38:v=u>0?1:(I+="\f",-1);break;case 44:a[l++]=(Tp(I)-1)*v,v=1;break;case 64:z0()===45&&(I+=fH(Wf())),h=z0(),u=d=Tp(S=I+=Gpt(rO())),b++;break;case 45:p===45&&Tp(I)==2&&(g=0)}}return o}function lme(n,e,t,r,i,o,s,a,c,l,u,d){for(var h=i-1,f=i===0?o:[""],p=Bpt(f),g=0,m=0,v=0;g<r;++g)for(var b=0,S=X2(n,h+1,h=tAe(m=s[g])),E=n;b<p;++b)(E=nAe(m>0?f[b]+" "+S:nO(S,/&\f/g,f[b])))&&(c[v++]=E);return Ane(n,e,t,i===0?Q5e:a,c,l,u,d)}function Xpt(n,e,t,r){return Ane(n,e,t,J5e,Rne(Hpt()),X2(n,2,-2),0,r)}function ume(n,e,t,r,i){return Ane(n,e,t,eAe,X2(n,0,r),X2(n,r+1,-1),r,i)}function PG(n,e){for(var t="",r=0;r<n.length;r++)t+=e(n[r],r,n,e)||"";return t}function Ypt(n,e,t,r){switch(n.type){case Fpt:if(n.children.length)break;case Lpt:case eAe:return n.return=n.return||n.value;case J5e:return"";case Npt:return n.return=n.value+"{"+PG(n.children,r)+"}";case Q5e:if(!Tp(n.value=n.props.join(",")))return""}return Tp(t=PG(n.children,r))?n.return=n.value+"{"+t+"}":""}var dme="data-ant-cssinjs-cache-path",iAe="_FILE_STYLE__",uS,oAe=!0;function Jpt(){if(!uS&&(uS={},eu())){var n=document.createElement("div");n.className=dme,n.style.position="fixed",n.style.visibility="hidden",n.style.top="-9999px",document.body.appendChild(n);var e=getComputedStyle(n).content||"";e=e.replace(/^"/,"").replace(/"$/,""),e.split(";").forEach(function(i){var o=i.split(":"),s=rt(o,2),a=s[0],c=s[1];uS[a]=c});var t=document.querySelector("style[".concat(dme,"]"));if(t){var r;oAe=!1,(r=t.parentNode)===null||r===void 0||r.removeChild(t)}document.body.removeChild(n)}}function Qpt(n){return Jpt(),!!uS[n]}function egt(n){var e=uS[n],t=null;if(e&&eu())if(oAe)t=iAe;else{var r=document.querySelector("style[".concat(Vf,'="').concat(uS[n],'"]'));r?t=r.innerHTML:delete uS[n]}return[t,e]}var tgt="_skip_check_",sAe="_multi_value_";function oO(n){var e=PG(Zpt(n),Ypt);return e.replace(/\{%%%\:[^;];}/g,";")}function ngt(n){return Wn(n)==="object"&&n&&(tgt in n||sAe in n)}function hme(n,e,t){if(!e)return n;var r=".".concat(e),i=t==="low"?":where(".concat(r,")"):r,o=n.split(",").map(function(s){var a,c=s.trim().split(/\s+/),l=c[0]||"",u=((a=l.match(/^\w+/))===null||a===void 0?void 0:a[0])||"";return l="".concat(u).concat(i).concat(l.slice(u.length)),[l].concat(Ht(c.slice(1))).join(" ")});return o.join(",")}var rgt=function n(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{root:!0,parentSelectors:[]},i=r.root,o=r.injectHash,s=r.parentSelectors,a=t.hashId,c=t.layer;t.path;var l=t.hashPriority,u=t.transformers,d=u===void 0?[]:u;t.linters;var h="",f={};function p(v){var b=v.getName(a);if(!f[b]){var S=n(v.style,t,{root:!1,parentSelectors:s}),E=rt(S,1),w=E[0];f[b]="@keyframes ".concat(v.getName(a)).concat(w)}}function g(v){var b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return v.forEach(function(S){Array.isArray(S)?g(S,b):S&&b.push(S)}),b}var m=g(Array.isArray(e)?e:[e]);return m.forEach(function(v){var b=typeof v=="string"&&!i?{}:v;if(typeof b=="string")h+="".concat(b,`
`);else if(b._keyframe)p(b);else{var S=d.reduce(function(E,w){var C;return(w==null||(C=w.visit)===null||C===void 0?void 0:C.call(w,E))||E},b);Object.keys(S).forEach(function(E){var w=S[E];if(Wn(w)==="object"&&w&&(E!=="animationName"||!w._keyframe)&&!ngt(w)){var C=!1,I=E.trim(),T=!1;(i||o)&&a?I.startsWith("@")?C=!0:I==="&"?I=hme("",a,l):I=hme(E,a,l):i&&!a&&(I==="&"||I==="")&&(I="",T=!0);var D=n(w,t,{root:T,injectHash:C,parentSelectors:[].concat(Ht(s),[I])}),O=rt(D,2),M=O[0],R=O[1];f=$e($e({},f),R),h+="".concat(I).concat(M)}else{let L=function(j,N){var B=j.replace(/[A-Z]/g,function(K){return"-".concat(K.toLowerCase())}),U=N;!$pt[j]&&typeof U=="number"&&U!==0&&(U="".concat(U,"px")),j==="animationName"&&N!==null&&N!==void 0&&N._keyframe&&(p(N),U=N.getName(a)),h+="".concat(B,":").concat(U,";")};var A,k=(A=w==null?void 0:w.value)!==null&&A!==void 0?A:w;Wn(w)==="object"&&w!==null&&w!==void 0&&w[sAe]&&Array.isArray(k)?k.forEach(function(j){L(E,j)}):L(E,k)}})}}),i?c&&(h="@layer ".concat(c.name," {").concat(h,"}"),c.dependencies&&(f["@layer ".concat(c.name)]=c.dependencies.map(function(v){return"@layer ".concat(v,", ").concat(c.name,";")}).join(`
`))):h="{".concat(h,"}"),[h,f]};function aAe(n,e){return y3("".concat(n.join("%")).concat(e))}function igt(){return null}var cAe="style";function kG(n,e){var t=n.token,r=n.path,i=n.hashId,o=n.layer,s=n.nonce,a=n.clientOnly,c=n.order,l=c===void 0?0:c,u=y.useContext(H7),d=u.autoClear;u.mock;var h=u.defaultCache,f=u.hashPriority,p=u.container,g=u.ssrInline,m=u.transformers,v=u.linters,b=u.cache,S=u.layer,E=t._tokenKey,w=[E];S&&w.push("layer"),w.push.apply(w,Ht(r));var C=EG,I=Dne(cAe,w,function(){var R=w.join("|");if(Qpt(R)){var A=egt(R),k=rt(A,2),L=k[0],j=k[1];if(L)return[L,E,j,{},a,l]}var N=e(),B=rgt(N,{hashId:i,hashPriority:f,layer:S?o:void 0,path:r.join("-"),transformers:m,linters:v}),U=rt(B,2),K=U[0],z=U[1],G=oO(K),te=aAe(w,G);return[G,E,te,z,a,l]},function(R,A){var k=rt(R,3),L=k[2];(A||d)&&EG&&b3(L,{mark:Vf})},function(R){var A=rt(R,4),k=A[0];A[1];var L=A[2],j=A[3];if(C&&k!==iAe){var N={mark:Vf,prepend:S?!1:"queue",attachTo:p,priority:l},B=typeof s=="function"?s():s;B&&(N.csp={nonce:B});var U=[],K=[];Object.keys(j).forEach(function(G){G.startsWith("@layer")?U.push(G):K.push(G)}),U.forEach(function(G){Wm(oO(j[G]),"_layer-".concat(G),$e($e({},N),{},{prepend:!0}))});var z=Wm(k,L,N);z[U0]=b.instanceId,z.setAttribute(Z2,E),K.forEach(function(G){Wm(oO(j[G]),"_effect-".concat(G),N)})}}),T=rt(I,3),D=T[0],O=T[1],M=T[2];return function(R){var A;return!g||C||!h?A=y.createElement(igt,null):A=y.createElement("style",ln({},Le(Le({},Z2,O),Vf,M),{dangerouslySetInnerHTML:{__html:D}})),y.createElement(y.Fragment,null,A,R)}}var ogt=function(e,t,r){var i=rt(e,6),o=i[0],s=i[1],a=i[2],c=i[3],l=i[4],u=i[5],d=r||{},h=d.plain;if(l)return null;var f=o,p={"data-rc-order":"prependQueue","data-rc-priority":"".concat(u)};return f=g8(o,s,a,p,h),c&&Object.keys(c).forEach(function(g){if(!t[g]){t[g]=!0;var m=oO(c[g]),v=g8(m,s,"_effect-".concat(g),p,h);g.startsWith("@layer")?f=v+f:f+=v}}),[u,a,f]},lAe="cssVar",sgt=function(e,t){var r=e.key,i=e.prefix,o=e.unitless,s=e.ignore,a=e.token,c=e.scope,l=c===void 0?"":c,u=y.useContext(H7),d=u.cache.instanceId,h=u.container,f=a._tokenKey,p=[].concat(Ht(e.path),[r,l,f]),g=Dne(lAe,p,function(){var m=t(),v=X5e(m,r,{prefix:i,unitless:o,ignore:s,scope:l}),b=rt(v,2),S=b[0],E=b[1],w=aAe(p,E);return[S,E,w,r]},function(m){var v=rt(m,3),b=v[2];EG&&b3(b,{mark:Vf})},function(m){var v=rt(m,3),b=v[1],S=v[2];if(b){var E=Wm(b,S,{mark:Vf,prepend:"queue",attachTo:h,priority:-999});E[U0]=d,E.setAttribute(Z2,r)}});return g},agt=function(e,t,r){var i=rt(e,4),o=i[1],s=i[2],a=i[3],c=r||{},l=c.plain;if(!o)return null;var u=-999,d={"data-rc-order":"prependQueue","data-rc-priority":"".concat(u)},h=g8(o,a,s,d,l);return[u,s,h]};Le(Le(Le({},cAe,ogt),Y5e,Mpt),lAe,agt);var Oi=function(){function n(e,t){vc(this,n),Le(this,"name",void 0),Le(this,"style",void 0),Le(this,"_keyframe",!0),this.name=e,this.style=t}return yc(n,[{key:"getName",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return t?"".concat(t,"-").concat(this.name):this.name}}]),n}();function Q_(n){return n.notSplit=!0,n}Q_(["borderTop","borderBottom"]),Q_(["borderTop"]),Q_(["borderBottom"]),Q_(["borderLeft","borderRight"]),Q_(["borderLeft"]),Q_(["borderRight"]);var V7=y.createContext({});function uAe(n){return V5e(n)||B5e(n)||Ine(n)||W5e()}function Gp(n,e){for(var t=n,r=0;r<e.length;r+=1){if(t==null)return;t=t[e[r]]}return t}function dAe(n,e,t,r){if(!e.length)return t;var i=uAe(e),o=i[0],s=i.slice(1),a;return!n&&typeof o=="number"?a=[]:Array.isArray(n)?a=Ht(n):a=$e({},n),r&&t===void 0&&s.length===1?delete a[o][s[0]]:a[o]=dAe(a[o],s,t,r),a}function _f(n,e,t){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;return e.length&&r&&t===void 0&&!Gp(n,e.slice(0,-1))?n:dAe(n,e,t,r)}function cgt(n){return Wn(n)==="object"&&n!==null&&Object.getPrototypeOf(n)===Object.prototype}function fme(n){return Array.isArray(n)?[]:{}}var lgt=typeof Reflect>"u"?Object.keys:Reflect.ownKeys;function eC(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];var r=fme(e[0]);return e.forEach(function(i){function o(s,a){var c=new Set(a),l=Gp(i,s),u=Array.isArray(l);if(u||cgt(l)){if(!c.has(l)){c.add(l);var d=Gp(r,s);u?r=_f(r,s,[]):(!d||Wn(d)!=="object")&&(r=_f(r,s,fme(l))),lgt(l).forEach(function(h){o([].concat(Ht(s),[h]),c)})}}else r=_f(r,s,l)}o([])}),r}function ugt(){}const dgt=y.createContext({}),lD=()=>{const n=()=>{};return n.deprecated=ugt,n},hAe=y.createContext(void 0);var hgt={items_per_page:"/ page",jump_to:"Go to",jump_to_confirm:"confirm",page:"Page",prev_page:"Previous Page",next_page:"Next Page",prev_5:"Previous 5 Pages",next_5:"Next 5 Pages",prev_3:"Previous 3 Pages",next_3:"Next 3 Pages",page_size:"Page Size"},fgt={yearFormat:"YYYY",dayFormat:"D",cellMeridiemFormat:"A",monthBeforeYear:!0},pgt=$e($e({},fgt),{},{locale:"en_US",today:"Today",now:"Now",backToToday:"Back to today",ok:"OK",clear:"Clear",month:"Month",year:"Year",timeSelect:"select time",dateSelect:"select date",weekSelect:"Choose a week",monthSelect:"Choose a month",yearSelect:"Choose a year",decadeSelect:"Choose a decade",dateFormat:"M/D/YYYY",dateTimeFormat:"M/D/YYYY HH:mm:ss",previousMonth:"Previous month (PageUp)",nextMonth:"Next month (PageDown)",previousYear:"Last year (Control + left)",nextYear:"Next year (Control + right)",previousDecade:"Last decade",nextDecade:"Next decade",previousCentury:"Last century",nextCentury:"Next century"});const fAe={placeholder:"Select time",rangePlaceholder:["Start time","End time"]},pme={lang:Object.assign({placeholder:"Select date",yearPlaceholder:"Select year",quarterPlaceholder:"Select quarter",monthPlaceholder:"Select month",weekPlaceholder:"Select week",rangePlaceholder:["Start date","End date"],rangeYearPlaceholder:["Start year","End year"],rangeQuarterPlaceholder:["Start quarter","End quarter"],rangeMonthPlaceholder:["Start month","End month"],rangeWeekPlaceholder:["Start week","End week"]},pgt),timePickerLocale:Object.assign({},fAe)},ld="${label} is not a valid ${type}",xy={locale:"en",Pagination:hgt,DatePicker:pme,TimePicker:fAe,Calendar:pme,global:{placeholder:"Please select"},Table:{filterTitle:"Filter menu",filterConfirm:"OK",filterReset:"Reset",filterEmptyText:"No filters",filterCheckall:"Select all items",filterSearchPlaceholder:"Search in filters",emptyText:"No data",selectAll:"Select current page",selectInvert:"Invert current page",selectNone:"Clear all data",selectionAll:"Select all data",sortTitle:"Sort",expand:"Expand row",collapse:"Collapse row",triggerDesc:"Click to sort descending",triggerAsc:"Click to sort ascending",cancelSort:"Click to cancel sorting"},Tour:{Next:"Next",Previous:"Previous",Finish:"Finish"},Modal:{okText:"OK",cancelText:"Cancel",justOkText:"OK"},Popconfirm:{okText:"OK",cancelText:"Cancel"},Transfer:{titles:["",""],searchPlaceholder:"Search here",itemUnit:"item",itemsUnit:"items",remove:"Remove",selectCurrent:"Select current page",removeCurrent:"Remove current page",selectAll:"Select all data",deselectAll:"Deselect all data",removeAll:"Remove all data",selectInvert:"Invert current page"},Upload:{uploading:"Uploading...",removeFile:"Remove file",uploadError:"Upload error",previewFile:"Preview file",downloadFile:"Download file"},Empty:{description:"No data"},Icon:{icon:"icon"},Text:{edit:"Edit",copy:"Copy",copied:"Copied",expand:"Expand",collapse:"Collapse"},Form:{optional:"(optional)",defaultValidateMessages:{default:"Field validation error for ${label}",required:"Please enter ${label}",enum:"${label} must be one of [${enum}]",whitespace:"${label} cannot be a blank character",date:{format:"${label} date format is invalid",parse:"${label} cannot be converted to a date",invalid:"${label} is an invalid date"},types:{string:ld,method:ld,array:ld,object:ld,number:ld,date:ld,boolean:ld,integer:ld,float:ld,regexp:ld,email:ld,url:ld,hex:ld},string:{len:"${label} must be ${len} characters",min:"${label} must be at least ${min} characters",max:"${label} must be up to ${max} characters",range:"${label} must be between ${min}-${max} characters"},number:{len:"${label} must be equal to ${len}",min:"${label} must be minimum ${min}",max:"${label} must be maximum ${max}",range:"${label} must be between ${min}-${max}"},array:{len:"Must be ${len} ${label}",min:"At least ${min} ${label}",max:"At most ${max} ${label}",range:"The amount of ${label} must be between ${min}-${max}"},pattern:{mismatch:"${label} does not match the pattern ${pattern}"}}},Image:{preview:"Preview"},QRCode:{expired:"QR code expired",refresh:"Refresh",scanned:"Scanned"},ColorPicker:{presetEmpty:"Empty",transparent:"Transparent",singleColor:"Single",gradientColor:"Gradient"}};let sO=Object.assign({},xy.Modal),aO=[];const gme=()=>aO.reduce((n,e)=>Object.assign(Object.assign({},n),e),xy.Modal);function ggt(n){if(n){const e=Object.assign({},n);return aO.push(e),sO=gme(),()=>{aO=aO.filter(t=>t!==e),sO=gme()}}sO=Object.assign({},xy.Modal)}function pAe(){return sO}const One=y.createContext(void 0),uD=(n,e)=>{const t=y.useContext(One),r=y.useMemo(()=>{var o;const s=e||xy[n],a=(o=t==null?void 0:t[n])!==null&&o!==void 0?o:{};return Object.assign(Object.assign({},typeof s=="function"?s():s),a||{})},[n,e,t]),i=y.useMemo(()=>{const o=t==null?void 0:t.locale;return t!=null&&t.exist&&!o?xy.locale:o},[t]);return[r,i]},mgt="internalMark",vgt=n=>{const{locale:e={},children:t,_ANT_MARK__:r}=n;y.useEffect(()=>ggt(e==null?void 0:e.Modal),[e]);const i=y.useMemo(()=>Object.assign(Object.assign({},e),{exist:!0}),[e]);return y.createElement(One.Provider,{value:i},t)};function Vc(n,e){ygt(n)&&(n="100%");var t=bgt(n);return n=e===360?n:Math.min(e,Math.max(0,parseFloat(n))),t&&(n=parseInt(String(n*e),10)/100),Math.abs(n-e)<1e-6?1:(e===360?n=(n<0?n%e+e:n%e)/parseFloat(String(e)):n=n%e/parseFloat(String(e)),n)}function A5(n){return Math.min(1,Math.max(0,n))}function ygt(n){return typeof n=="string"&&n.indexOf(".")!==-1&&parseFloat(n)===1}function bgt(n){return typeof n=="string"&&n.indexOf("%")!==-1}function gAe(n){return n=parseFloat(n),(isNaN(n)||n<0||n>1)&&(n=1),n}function O5(n){return n<=1?"".concat(Number(n)*100,"%"):n}function k1(n){return n.length===1?"0"+n:String(n)}function Sgt(n,e,t){return{r:Vc(n,255)*255,g:Vc(e,255)*255,b:Vc(t,255)*255}}function mme(n,e,t){n=Vc(n,255),e=Vc(e,255),t=Vc(t,255);var r=Math.max(n,e,t),i=Math.min(n,e,t),o=0,s=0,a=(r+i)/2;if(r===i)s=0,o=0;else{var c=r-i;switch(s=a>.5?c/(2-r-i):c/(r+i),r){case n:o=(e-t)/c+(e<t?6:0);break;case e:o=(t-n)/c+2;break;case t:o=(n-e)/c+4;break}o/=6}return{h:o,s,l:a}}function pH(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*(6*t):t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function _gt(n,e,t){var r,i,o;if(n=Vc(n,360),e=Vc(e,100),t=Vc(t,100),e===0)i=t,o=t,r=t;else{var s=t<.5?t*(1+e):t+e-t*e,a=2*t-s;r=pH(a,s,n+1/3),i=pH(a,s,n),o=pH(a,s,n-1/3)}return{r:r*255,g:i*255,b:o*255}}function TG(n,e,t){n=Vc(n,255),e=Vc(e,255),t=Vc(t,255);var r=Math.max(n,e,t),i=Math.min(n,e,t),o=0,s=r,a=r-i,c=r===0?0:a/r;if(r===i)o=0;else{switch(r){case n:o=(e-t)/a+(e<t?6:0);break;case e:o=(t-n)/a+2;break;case t:o=(n-e)/a+4;break}o/=6}return{h:o,s:c,v:s}}function wgt(n,e,t){n=Vc(n,360)*6,e=Vc(e,100),t=Vc(t,100);var r=Math.floor(n),i=n-r,o=t*(1-e),s=t*(1-i*e),a=t*(1-(1-i)*e),c=r%6,l=[t,s,o,o,a,t][c],u=[a,t,t,s,o,o][c],d=[o,o,a,t,t,s][c];return{r:l*255,g:u*255,b:d*255}}function DG(n,e,t,r){var i=[k1(Math.round(n).toString(16)),k1(Math.round(e).toString(16)),k1(Math.round(t).toString(16))];return r&&i[0].startsWith(i[0].charAt(1))&&i[1].startsWith(i[1].charAt(1))&&i[2].startsWith(i[2].charAt(1))?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function Cgt(n,e,t,r,i){var o=[k1(Math.round(n).toString(16)),k1(Math.round(e).toString(16)),k1(Math.round(t).toString(16)),k1(xgt(r))];return i&&o[0].startsWith(o[0].charAt(1))&&o[1].startsWith(o[1].charAt(1))&&o[2].startsWith(o[2].charAt(1))&&o[3].startsWith(o[3].charAt(1))?o[0].charAt(0)+o[1].charAt(0)+o[2].charAt(0)+o[3].charAt(0):o.join("")}function xgt(n){return Math.round(parseFloat(n)*255).toString(16)}function vme(n){return fd(n)/255}function fd(n){return parseInt(n,16)}function Egt(n){return{r:n>>16,g:(n&65280)>>8,b:n&255}}var RG={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function $w(n){var e={r:0,g:0,b:0},t=1,r=null,i=null,o=null,s=!1,a=!1;return typeof n=="string"&&(n=kgt(n)),typeof n=="object"&&(am(n.r)&&am(n.g)&&am(n.b)?(e=Sgt(n.r,n.g,n.b),s=!0,a=String(n.r).substr(-1)==="%"?"prgb":"rgb"):am(n.h)&&am(n.s)&&am(n.v)?(r=O5(n.s),i=O5(n.v),e=wgt(n.h,r,i),s=!0,a="hsv"):am(n.h)&&am(n.s)&&am(n.l)&&(r=O5(n.s),o=O5(n.l),e=_gt(n.h,r,o),s=!0,a="hsl"),Object.prototype.hasOwnProperty.call(n,"a")&&(t=n.a)),t=gAe(t),{ok:s,format:n.format||a,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:t}}var Igt="[-\\+]?\\d+%?",Pgt="[-\\+]?\\d*\\.\\d+%?",V0="(?:".concat(Pgt,")|(?:").concat(Igt,")"),gH="[\\s|\\(]+(".concat(V0,")[,|\\s]+(").concat(V0,")[,|\\s]+(").concat(V0,")\\s*\\)?"),mH="[\\s|\\(]+(".concat(V0,")[,|\\s]+(").concat(V0,")[,|\\s]+(").concat(V0,")[,|\\s]+(").concat(V0,")\\s*\\)?"),ff={CSS_UNIT:new RegExp(V0),rgb:new RegExp("rgb"+gH),rgba:new RegExp("rgba"+mH),hsl:new RegExp("hsl"+gH),hsla:new RegExp("hsla"+mH),hsv:new RegExp("hsv"+gH),hsva:new RegExp("hsva"+mH),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function kgt(n){if(n=n.trim().toLowerCase(),n.length===0)return!1;var e=!1;if(RG[n])n=RG[n],e=!0;else if(n==="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var t=ff.rgb.exec(n);return t?{r:t[1],g:t[2],b:t[3]}:(t=ff.rgba.exec(n),t?{r:t[1],g:t[2],b:t[3],a:t[4]}:(t=ff.hsl.exec(n),t?{h:t[1],s:t[2],l:t[3]}:(t=ff.hsla.exec(n),t?{h:t[1],s:t[2],l:t[3],a:t[4]}:(t=ff.hsv.exec(n),t?{h:t[1],s:t[2],v:t[3]}:(t=ff.hsva.exec(n),t?{h:t[1],s:t[2],v:t[3],a:t[4]}:(t=ff.hex8.exec(n),t?{r:fd(t[1]),g:fd(t[2]),b:fd(t[3]),a:vme(t[4]),format:e?"name":"hex8"}:(t=ff.hex6.exec(n),t?{r:fd(t[1]),g:fd(t[2]),b:fd(t[3]),format:e?"name":"hex"}:(t=ff.hex4.exec(n),t?{r:fd(t[1]+t[1]),g:fd(t[2]+t[2]),b:fd(t[3]+t[3]),a:vme(t[4]+t[4]),format:e?"name":"hex8"}:(t=ff.hex3.exec(n),t?{r:fd(t[1]+t[1]),g:fd(t[2]+t[2]),b:fd(t[3]+t[3]),format:e?"name":"hex"}:!1)))))))))}function am(n){return!!ff.CSS_UNIT.exec(String(n))}var Fa=function(){function n(e,t){e===void 0&&(e=""),t===void 0&&(t={});var r;if(e instanceof n)return e;typeof e=="number"&&(e=Egt(e)),this.originalInput=e;var i=$w(e);this.originalInput=e,this.r=i.r,this.g=i.g,this.b=i.b,this.a=i.a,this.roundA=Math.round(100*this.a)/100,this.format=(r=t.format)!==null&&r!==void 0?r:i.format,this.gradientType=t.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=i.ok}return n.prototype.isDark=function(){return this.getBrightness()<128},n.prototype.isLight=function(){return!this.isDark()},n.prototype.getBrightness=function(){var e=this.toRgb();return(e.r*299+e.g*587+e.b*114)/1e3},n.prototype.getLuminance=function(){var e=this.toRgb(),t,r,i,o=e.r/255,s=e.g/255,a=e.b/255;return o<=.03928?t=o/12.92:t=Math.pow((o+.055)/1.055,2.4),s<=.03928?r=s/12.92:r=Math.pow((s+.055)/1.055,2.4),a<=.03928?i=a/12.92:i=Math.pow((a+.055)/1.055,2.4),.2126*t+.7152*r+.0722*i},n.prototype.getAlpha=function(){return this.a},n.prototype.setAlpha=function(e){return this.a=gAe(e),this.roundA=Math.round(100*this.a)/100,this},n.prototype.isMonochrome=function(){var e=this.toHsl().s;return e===0},n.prototype.toHsv=function(){var e=TG(this.r,this.g,this.b);return{h:e.h*360,s:e.s,v:e.v,a:this.a}},n.prototype.toHsvString=function(){var e=TG(this.r,this.g,this.b),t=Math.round(e.h*360),r=Math.round(e.s*100),i=Math.round(e.v*100);return this.a===1?"hsv(".concat(t,", ").concat(r,"%, ").concat(i,"%)"):"hsva(".concat(t,", ").concat(r,"%, ").concat(i,"%, ").concat(this.roundA,")")},n.prototype.toHsl=function(){var e=mme(this.r,this.g,this.b);return{h:e.h*360,s:e.s,l:e.l,a:this.a}},n.prototype.toHslString=function(){var e=mme(this.r,this.g,this.b),t=Math.round(e.h*360),r=Math.round(e.s*100),i=Math.round(e.l*100);return this.a===1?"hsl(".concat(t,", ").concat(r,"%, ").concat(i,"%)"):"hsla(".concat(t,", ").concat(r,"%, ").concat(i,"%, ").concat(this.roundA,")")},n.prototype.toHex=function(e){return e===void 0&&(e=!1),DG(this.r,this.g,this.b,e)},n.prototype.toHexString=function(e){return e===void 0&&(e=!1),"#"+this.toHex(e)},n.prototype.toHex8=function(e){return e===void 0&&(e=!1),Cgt(this.r,this.g,this.b,this.a,e)},n.prototype.toHex8String=function(e){return e===void 0&&(e=!1),"#"+this.toHex8(e)},n.prototype.toHexShortString=function(e){return e===void 0&&(e=!1),this.a===1?this.toHexString(e):this.toHex8String(e)},n.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},n.prototype.toRgbString=function(){var e=Math.round(this.r),t=Math.round(this.g),r=Math.round(this.b);return this.a===1?"rgb(".concat(e,", ").concat(t,", ").concat(r,")"):"rgba(".concat(e,", ").concat(t,", ").concat(r,", ").concat(this.roundA,")")},n.prototype.toPercentageRgb=function(){var e=function(t){return"".concat(Math.round(Vc(t,255)*100),"%")};return{r:e(this.r),g:e(this.g),b:e(this.b),a:this.a}},n.prototype.toPercentageRgbString=function(){var e=function(t){return Math.round(Vc(t,255)*100)};return this.a===1?"rgb(".concat(e(this.r),"%, ").concat(e(this.g),"%, ").concat(e(this.b),"%)"):"rgba(".concat(e(this.r),"%, ").concat(e(this.g),"%, ").concat(e(this.b),"%, ").concat(this.roundA,")")},n.prototype.toName=function(){if(this.a===0)return"transparent";if(this.a<1)return!1;for(var e="#"+DG(this.r,this.g,this.b,!1),t=0,r=Object.entries(RG);t<r.length;t++){var i=r[t],o=i[0],s=i[1];if(e===s)return o}return!1},n.prototype.toString=function(e){var t=!!e;e=e??this.format;var r=!1,i=this.a<1&&this.a>=0,o=!t&&i&&(e.startsWith("hex")||e==="name");return o?e==="name"&&this.a===0?this.toName():this.toRgbString():(e==="rgb"&&(r=this.toRgbString()),e==="prgb"&&(r=this.toPercentageRgbString()),(e==="hex"||e==="hex6")&&(r=this.toHexString()),e==="hex3"&&(r=this.toHexString(!0)),e==="hex4"&&(r=this.toHex8String(!0)),e==="hex8"&&(r=this.toHex8String()),e==="name"&&(r=this.toName()),e==="hsl"&&(r=this.toHslString()),e==="hsv"&&(r=this.toHsvString()),r||this.toHexString())},n.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},n.prototype.clone=function(){return new n(this.toString())},n.prototype.lighten=function(e){e===void 0&&(e=10);var t=this.toHsl();return t.l+=e/100,t.l=A5(t.l),new n(t)},n.prototype.brighten=function(e){e===void 0&&(e=10);var t=this.toRgb();return t.r=Math.max(0,Math.min(255,t.r-Math.round(255*-(e/100)))),t.g=Math.max(0,Math.min(255,t.g-Math.round(255*-(e/100)))),t.b=Math.max(0,Math.min(255,t.b-Math.round(255*-(e/100)))),new n(t)},n.prototype.darken=function(e){e===void 0&&(e=10);var t=this.toHsl();return t.l-=e/100,t.l=A5(t.l),new n(t)},n.prototype.tint=function(e){return e===void 0&&(e=10),this.mix("white",e)},n.prototype.shade=function(e){return e===void 0&&(e=10),this.mix("black",e)},n.prototype.desaturate=function(e){e===void 0&&(e=10);var t=this.toHsl();return t.s-=e/100,t.s=A5(t.s),new n(t)},n.prototype.saturate=function(e){e===void 0&&(e=10);var t=this.toHsl();return t.s+=e/100,t.s=A5(t.s),new n(t)},n.prototype.greyscale=function(){return this.desaturate(100)},n.prototype.spin=function(e){var t=this.toHsl(),r=(t.h+e)%360;return t.h=r<0?360+r:r,new n(t)},n.prototype.mix=function(e,t){t===void 0&&(t=50);var r=this.toRgb(),i=new n(e).toRgb(),o=t/100,s={r:(i.r-r.r)*o+r.r,g:(i.g-r.g)*o+r.g,b:(i.b-r.b)*o+r.b,a:(i.a-r.a)*o+r.a};return new n(s)},n.prototype.analogous=function(e,t){e===void 0&&(e=6),t===void 0&&(t=30);var r=this.toHsl(),i=360/t,o=[this];for(r.h=(r.h-(i*e>>1)+720)%360;--e;)r.h=(r.h+i)%360,o.push(new n(r));return o},n.prototype.complement=function(){var e=this.toHsl();return e.h=(e.h+180)%360,new n(e)},n.prototype.monochromatic=function(e){e===void 0&&(e=6);for(var t=this.toHsv(),r=t.h,i=t.s,o=t.v,s=[],a=1/e;e--;)s.push(new n({h:r,s:i,v:o})),o=(o+a)%1;return s},n.prototype.splitcomplement=function(){var e=this.toHsl(),t=e.h;return[this,new n({h:(t+72)%360,s:e.s,l:e.l}),new n({h:(t+216)%360,s:e.s,l:e.l})]},n.prototype.onBackground=function(e){var t=this.toRgb(),r=new n(e).toRgb(),i=t.a+r.a*(1-t.a);return new n({r:(t.r*t.a+r.r*r.a*(1-t.a))/i,g:(t.g*t.a+r.g*r.a*(1-t.a))/i,b:(t.b*t.a+r.b*r.a*(1-t.a))/i,a:i})},n.prototype.triad=function(){return this.polyad(3)},n.prototype.tetrad=function(){return this.polyad(4)},n.prototype.polyad=function(e){for(var t=this.toHsl(),r=t.h,i=[this],o=360/e,s=1;s<e;s++)i.push(new n({h:(r+s*o)%360,s:t.s,l:t.l}));return i},n.prototype.equals=function(e){return this.toRgbString()===new n(e).toRgbString()},n}(),M5=2,yme=.16,Tgt=.05,Dgt=.05,Rgt=.15,mAe=5,vAe=4,Agt=[{index:7,opacity:.15},{index:6,opacity:.25},{index:5,opacity:.3},{index:5,opacity:.45},{index:5,opacity:.65},{index:5,opacity:.85},{index:4,opacity:.9},{index:3,opacity:.95},{index:2,opacity:.97},{index:1,opacity:.98}];function bme(n){var e=n.r,t=n.g,r=n.b,i=TG(e,t,r);return{h:i.h*360,s:i.s,v:i.v}}function $5(n){var e=n.r,t=n.g,r=n.b;return"#".concat(DG(e,t,r,!1))}function Ogt(n,e,t){var r=t/100,i={r:(e.r-n.r)*r+n.r,g:(e.g-n.g)*r+n.g,b:(e.b-n.b)*r+n.b};return i}function Sme(n,e,t){var r;return Math.round(n.h)>=60&&Math.round(n.h)<=240?r=t?Math.round(n.h)-M5*e:Math.round(n.h)+M5*e:r=t?Math.round(n.h)+M5*e:Math.round(n.h)-M5*e,r<0?r+=360:r>=360&&(r-=360),r}function _me(n,e,t){if(n.h===0&&n.s===0)return n.s;var r;return t?r=n.s-yme*e:e===vAe?r=n.s+yme:r=n.s+Tgt*e,r>1&&(r=1),t&&e===mAe&&r>.1&&(r=.1),r<.06&&(r=.06),Number(r.toFixed(2))}function wme(n,e,t){var r;return t?r=n.v+Dgt*e:r=n.v-Rgt*e,r>1&&(r=1),Number(r.toFixed(2))}function C3(n){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=[],r=$w(n),i=mAe;i>0;i-=1){var o=bme(r),s=$5($w({h:Sme(o,i,!0),s:_me(o,i,!0),v:wme(o,i,!0)}));t.push(s)}t.push($5(r));for(var a=1;a<=vAe;a+=1){var c=bme(r),l=$5($w({h:Sme(c,a),s:_me(c,a),v:wme(c,a)}));t.push(l)}return e.theme==="dark"?Agt.map(function(u){var d=u.index,h=u.opacity,f=$5(Ogt($w(e.backgroundColor||"#141414"),$w(t[d]),h*100));return f}):t}var vH={red:"#F5222D",volcano:"#FA541C",orange:"#FA8C16",gold:"#FAAD14",yellow:"#FADB14",lime:"#A0D911",green:"#52C41A",cyan:"#13C2C2",blue:"#1677FF",geekblue:"#2F54EB",purple:"#722ED1",magenta:"#EB2F96",grey:"#666666"},AG=["#fff1f0","#ffccc7","#ffa39e","#ff7875","#ff4d4f","#f5222d","#cf1322","#a8071a","#820014","#5c0011"];AG.primary=AG[5];var OG=["#fff2e8","#ffd8bf","#ffbb96","#ff9c6e","#ff7a45","#fa541c","#d4380d","#ad2102","#871400","#610b00"];OG.primary=OG[5];var MG=["#fff7e6","#ffe7ba","#ffd591","#ffc069","#ffa940","#fa8c16","#d46b08","#ad4e00","#873800","#612500"];MG.primary=MG[5];var $G=["#fffbe6","#fff1b8","#ffe58f","#ffd666","#ffc53d","#faad14","#d48806","#ad6800","#874d00","#613400"];$G.primary=$G[5];var LG=["#feffe6","#ffffb8","#fffb8f","#fff566","#ffec3d","#fadb14","#d4b106","#ad8b00","#876800","#614700"];LG.primary=LG[5];var NG=["#fcffe6","#f4ffb8","#eaff8f","#d3f261","#bae637","#a0d911","#7cb305","#5b8c00","#3f6600","#254000"];NG.primary=NG[5];var FG=["#f6ffed","#d9f7be","#b7eb8f","#95de64","#73d13d","#52c41a","#389e0d","#237804","#135200","#092b00"];FG.primary=FG[5];var jG=["#e6fffb","#b5f5ec","#87e8de","#5cdbd3","#36cfc9","#13c2c2","#08979c","#006d75","#00474f","#002329"];jG.primary=jG[5];var m8=["#e6f4ff","#bae0ff","#91caff","#69b1ff","#4096ff","#1677ff","#0958d9","#003eb3","#002c8c","#001d66"];m8.primary=m8[5];var BG=["#f0f5ff","#d6e4ff","#adc6ff","#85a5ff","#597ef7","#2f54eb","#1d39c4","#10239e","#061178","#030852"];BG.primary=BG[5];var HG=["#f9f0ff","#efdbff","#d3adf7","#b37feb","#9254de","#722ed1","#531dab","#391085","#22075e","#120338"];HG.primary=HG[5];var UG=["#fff0f6","#ffd6e7","#ffadd2","#ff85c0","#f759ab","#eb2f96","#c41d7f","#9e1068","#780650","#520339"];UG.primary=UG[5];var zG=["#a6a6a6","#999999","#8c8c8c","#808080","#737373","#666666","#404040","#1a1a1a","#000000","#000000"];zG.primary=zG[5];var yH={red:AG,volcano:OG,orange:MG,gold:$G,yellow:LG,lime:NG,green:FG,cyan:jG,blue:m8,geekblue:BG,purple:HG,magenta:UG,grey:zG};const yAe={blue:"#1677FF",purple:"#722ED1",cyan:"#13C2C2",green:"#52C41A",magenta:"#EB2F96",pink:"#EB2F96",red:"#F5222D",orange:"#FA8C16",yellow:"#FADB14",volcano:"#FA541C",geekblue:"#2F54EB",gold:"#FAAD14",lime:"#A0D911"},x3=Object.assign(Object.assign({},yAe),{colorPrimary:"#1677ff",colorSuccess:"#52c41a",colorWarning:"#faad14",colorError:"#ff4d4f",colorInfo:"#1677ff",colorLink:"",colorTextBase:"",colorBgBase:"",fontFamily:`-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial,
'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol',
'Noto Color Emoji'`,fontFamilyCode:"'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier, monospace",fontSize:14,lineWidth:1,lineType:"solid",motionUnit:.1,motionBase:0,motionEaseOutCirc:"cubic-bezier(0.08, 0.82, 0.17, 1)",motionEaseInOutCirc:"cubic-bezier(0.78, 0.14, 0.15, 0.86)",motionEaseOut:"cubic-bezier(0.215, 0.61, 0.355, 1)",motionEaseInOut:"cubic-bezier(0.645, 0.045, 0.355, 1)",motionEaseOutBack:"cubic-bezier(0.12, 0.4, 0.29, 1.46)",motionEaseInBack:"cubic-bezier(0.71, -0.46, 0.88, 0.6)",motionEaseInQuint:"cubic-bezier(0.755, 0.05, 0.855, 0.06)",motionEaseOutQuint:"cubic-bezier(0.23, 1, 0.32, 1)",borderRadius:6,sizeUnit:4,sizeStep:4,sizePopupArrow:16,controlHeight:32,zIndexBase:0,zIndexPopupBase:1e3,opacityImage:1,wireframe:!1,motion:!0});function Mgt(n,e){let{generateColorPalettes:t,generateNeutralColorPalettes:r}=e;const{colorSuccess:i,colorWarning:o,colorError:s,colorInfo:a,colorPrimary:c,colorBgBase:l,colorTextBase:u}=n,d=t(c),h=t(i),f=t(o),p=t(s),g=t(a),m=r(l,u),v=n.colorLink||n.colorInfo,b=t(v);return Object.assign(Object.assign({},m),{colorPrimaryBg:d[1],colorPrimaryBgHover:d[2],colorPrimaryBorder:d[3],colorPrimaryBorderHover:d[4],colorPrimaryHover:d[5],colorPrimary:d[6],colorPrimaryActive:d[7],colorPrimaryTextHover:d[8],colorPrimaryText:d[9],colorPrimaryTextActive:d[10],colorSuccessBg:h[1],colorSuccessBgHover:h[2],colorSuccessBorder:h[3],colorSuccessBorderHover:h[4],colorSuccessHover:h[4],colorSuccess:h[6],colorSuccessActive:h[7],colorSuccessTextHover:h[8],colorSuccessText:h[9],colorSuccessTextActive:h[10],colorErrorBg:p[1],colorErrorBgHover:p[2],colorErrorBgActive:p[3],colorErrorBorder:p[3],colorErrorBorderHover:p[4],colorErrorHover:p[5],colorError:p[6],colorErrorActive:p[7],colorErrorTextHover:p[8],colorErrorText:p[9],colorErrorTextActive:p[10],colorWarningBg:f[1],colorWarningBgHover:f[2],colorWarningBorder:f[3],colorWarningBorderHover:f[4],colorWarningHover:f[4],colorWarning:f[6],colorWarningActive:f[7],colorWarningTextHover:f[8],colorWarningText:f[9],colorWarningTextActive:f[10],colorInfoBg:g[1],colorInfoBgHover:g[2],colorInfoBorder:g[3],colorInfoBorderHover:g[4],colorInfoHover:g[4],colorInfo:g[6],colorInfoActive:g[7],colorInfoTextHover:g[8],colorInfoText:g[9],colorInfoTextActive:g[10],colorLinkHover:b[4],colorLink:b[6],colorLinkActive:b[7],colorBgMask:new Fa("#000").setAlpha(.45).toRgbString(),colorWhite:"#fff"})}const $gt=n=>{let e=n,t=n,r=n,i=n;return n<6&&n>=5?e=n+1:n<16&&n>=6?e=n+2:n>=16&&(e=16),n<7&&n>=5?t=4:n<8&&n>=7?t=5:n<14&&n>=8?t=6:n<16&&n>=14?t=7:n>=16&&(t=8),n<6&&n>=2?r=1:n>=6&&(r=2),n>4&&n<8?i=4:n>=8&&(i=6),{borderRadius:n,borderRadiusXS:r,borderRadiusSM:t,borderRadiusLG:e,borderRadiusOuter:i}};function Lgt(n){const{motionUnit:e,motionBase:t,borderRadius:r,lineWidth:i}=n;return Object.assign({motionDurationFast:`${(t+e).toFixed(1)}s`,motionDurationMid:`${(t+e*2).toFixed(1)}s`,motionDurationSlow:`${(t+e*3).toFixed(1)}s`,lineWidthBold:i+1},$gt(r))}const Ngt=n=>{const{controlHeight:e}=n;return{controlHeightSM:e*.75,controlHeightXS:e*.5,controlHeightLG:e*1.25}};function cO(n){return(n+8)/n}function Fgt(n){const e=new Array(10).fill(null).map((t,r)=>{const i=r-1,o=n*Math.pow(Math.E,i/5),s=r>1?Math.floor(o):Math.ceil(o);return Math.floor(s/2)*2});return e[1]=n,e.map(t=>({size:t,lineHeight:cO(t)}))}const jgt=n=>{const e=Fgt(n),t=e.map(u=>u.size),r=e.map(u=>u.lineHeight),i=t[1],o=t[0],s=t[2],a=r[1],c=r[0],l=r[2];return{fontSizeSM:o,fontSize:i,fontSizeLG:s,fontSizeXL:t[3],fontSizeHeading1:t[6],fontSizeHeading2:t[5],fontSizeHeading3:t[4],fontSizeHeading4:t[3],fontSizeHeading5:t[2],lineHeight:a,lineHeightLG:l,lineHeightSM:c,fontHeight:Math.round(a*i),fontHeightLG:Math.round(l*s),fontHeightSM:Math.round(c*o),lineHeightHeading1:r[6],lineHeightHeading2:r[5],lineHeightHeading3:r[4],lineHeightHeading4:r[3],lineHeightHeading5:r[2]}};function Bgt(n){const{sizeUnit:e,sizeStep:t}=n;return{sizeXXL:e*(t+8),sizeXL:e*(t+4),sizeLG:e*(t+2),sizeMD:e*(t+1),sizeMS:e*t,size:e*t,sizeSM:e*(t-1),sizeXS:e*(t-2),sizeXXS:e*(t-3)}}const cm=(n,e)=>new Fa(n).setAlpha(e).toRgbString(),lI=(n,e)=>new Fa(n).darken(e).toHexString(),Hgt=n=>{const e=C3(n);return{1:e[0],2:e[1],3:e[2],4:e[3],5:e[4],6:e[5],7:e[6],8:e[4],9:e[5],10:e[6]}},Ugt=(n,e)=>{const t=n||"#fff",r=e||"#000";return{colorBgBase:t,colorTextBase:r,colorText:cm(r,.88),colorTextSecondary:cm(r,.65),colorTextTertiary:cm(r,.45),colorTextQuaternary:cm(r,.25),colorFill:cm(r,.15),colorFillSecondary:cm(r,.06),colorFillTertiary:cm(r,.04),colorFillQuaternary:cm(r,.02),colorBgLayout:lI(t,4),colorBgContainer:lI(t,0),colorBgElevated:lI(t,0),colorBgSpotlight:cm(r,.85),colorBgBlur:"transparent",colorBorder:lI(t,15),colorBorderSecondary:lI(t,6)}};function zgt(n){vH.pink=vH.magenta,yH.pink=yH.magenta;const e=Object.keys(yAe).map(t=>{const r=n[t]===vH[t]?yH[t]:C3(n[t]);return new Array(10).fill(1).reduce((i,o,s)=>(i[`${t}-${s+1}`]=r[s],i[`${t}${s+1}`]=r[s],i),{})}).reduce((t,r)=>(t=Object.assign(Object.assign({},t),r),t),{});return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n),e),Mgt(n,{generateColorPalettes:Hgt,generateNeutralColorPalettes:Ugt})),jgt(n.fontSize)),Bgt(n)),Ngt(n)),Lgt(n))}const bAe=xG(zgt),VG={token:x3,override:{override:x3},hashed:!0},SAe=Ke.createContext(VG),E3="ant",Mne="anticon",Vgt=["outlined","borderless","filled"],Wgt=(n,e)=>e||(n?`${E3}-${n}`:E3),fr=y.createContext({getPrefixCls:Wgt,iconPrefixCls:Mne}),qgt=`-ant-${Date.now()}-${Math.random()}`;function Kgt(n,e){const t={},r=(s,a)=>{let c=s.clone();return c=(a==null?void 0:a(c))||c,c.toRgbString()},i=(s,a)=>{const c=new Fa(s),l=C3(c.toRgbString());t[`${a}-color`]=r(c),t[`${a}-color-disabled`]=l[1],t[`${a}-color-hover`]=l[4],t[`${a}-color-active`]=l[6],t[`${a}-color-outline`]=c.clone().setAlpha(.2).toRgbString(),t[`${a}-color-deprecated-bg`]=l[0],t[`${a}-color-deprecated-border`]=l[2]};if(e.primaryColor){i(e.primaryColor,"primary");const s=new Fa(e.primaryColor),a=C3(s.toRgbString());a.forEach((l,u)=>{t[`primary-${u+1}`]=l}),t["primary-color-deprecated-l-35"]=r(s,l=>l.lighten(35)),t["primary-color-deprecated-l-20"]=r(s,l=>l.lighten(20)),t["primary-color-deprecated-t-20"]=r(s,l=>l.tint(20)),t["primary-color-deprecated-t-50"]=r(s,l=>l.tint(50)),t["primary-color-deprecated-f-12"]=r(s,l=>l.setAlpha(l.getAlpha()*.12));const c=new Fa(a[0]);t["primary-color-active-deprecated-f-30"]=r(c,l=>l.setAlpha(l.getAlpha()*.3)),t["primary-color-active-deprecated-d-02"]=r(c,l=>l.darken(2))}return e.successColor&&i(e.successColor,"success"),e.warningColor&&i(e.warningColor,"warning"),e.errorColor&&i(e.errorColor,"error"),e.infoColor&&i(e.infoColor,"info"),`
  :root {
    ${Object.keys(t).map(s=>`--${n}-${s}: ${t[s]};`).join(`
`)}
  }
  `.trim()}function Ggt(n,e){const t=Kgt(n,e);eu()&&Wm(t,`${qgt}-dynamic-theme`)}const fg=y.createContext(!1),$ne=n=>{let{children:e,disabled:t}=n;const r=y.useContext(fg);return y.createElement(fg.Provider,{value:t??r},e)},MS=y.createContext(void 0),Zgt=n=>{let{children:e,size:t}=n;const r=y.useContext(MS);return y.createElement(MS.Provider,{value:t||r},e)};function Xgt(){const n=y.useContext(fg),e=y.useContext(MS);return{componentDisabled:n,componentSize:e}}var _Ae=yc(function n(){vc(this,n)}),wAe="CALC_UNIT",Ygt=new RegExp(wAe,"g");function bH(n){return typeof n=="number"?"".concat(n).concat(wAe):n}var Jgt=function(n){zy(t,n);var e=Vy(t);function t(r,i){var o;vc(this,t),o=e.call(this),Le(Yr(o),"result",""),Le(Yr(o),"unitlessCssVar",void 0),Le(Yr(o),"lowPriority",void 0);var s=Wn(r);return o.unitlessCssVar=i,r instanceof t?o.result="(".concat(r.result,")"):s==="number"?o.result=bH(r):s==="string"&&(o.result=r),o}return yc(t,[{key:"add",value:function(i){return i instanceof t?this.result="".concat(this.result," + ").concat(i.getResult()):(typeof i=="number"||typeof i=="string")&&(this.result="".concat(this.result," + ").concat(bH(i))),this.lowPriority=!0,this}},{key:"sub",value:function(i){return i instanceof t?this.result="".concat(this.result," - ").concat(i.getResult()):(typeof i=="number"||typeof i=="string")&&(this.result="".concat(this.result," - ").concat(bH(i))),this.lowPriority=!0,this}},{key:"mul",value:function(i){return this.lowPriority&&(this.result="(".concat(this.result,")")),i instanceof t?this.result="".concat(this.result," * ").concat(i.getResult(!0)):(typeof i=="number"||typeof i=="string")&&(this.result="".concat(this.result," * ").concat(i)),this.lowPriority=!1,this}},{key:"div",value:function(i){return this.lowPriority&&(this.result="(".concat(this.result,")")),i instanceof t?this.result="".concat(this.result," / ").concat(i.getResult(!0)):(typeof i=="number"||typeof i=="string")&&(this.result="".concat(this.result," / ").concat(i)),this.lowPriority=!1,this}},{key:"getResult",value:function(i){return this.lowPriority||i?"(".concat(this.result,")"):this.result}},{key:"equal",value:function(i){var o=this,s=i||{},a=s.unit,c=!0;return typeof a=="boolean"?c=a:Array.from(this.unitlessCssVar).some(function(l){return o.result.includes(l)})&&(c=!1),this.result=this.result.replace(Ygt,c?"px":""),typeof this.lowPriority<"u"?"calc(".concat(this.result,")"):this.result}}]),t}(_Ae),Qgt=function(n){zy(t,n);var e=Vy(t);function t(r){var i;return vc(this,t),i=e.call(this),Le(Yr(i),"result",0),r instanceof t?i.result=r.result:typeof r=="number"&&(i.result=r),i}return yc(t,[{key:"add",value:function(i){return i instanceof t?this.result+=i.result:typeof i=="number"&&(this.result+=i),this}},{key:"sub",value:function(i){return i instanceof t?this.result-=i.result:typeof i=="number"&&(this.result-=i),this}},{key:"mul",value:function(i){return i instanceof t?this.result*=i.result:typeof i=="number"&&(this.result*=i),this}},{key:"div",value:function(i){return i instanceof t?this.result/=i.result:typeof i=="number"&&(this.result/=i),this}},{key:"equal",value:function(){return this.result}}]),t}(_Ae),emt=function(e,t){var r=e==="css"?Jgt:Qgt;return function(i){return new r(i,t)}},Cme=function(e,t){return"".concat([t,e.replace(/([A-Z]+)([A-Z][a-z]+)/g,"$1-$2").replace(/([a-z])([A-Z])/g,"$1-$2")].filter(Boolean).join("-"))};function ea(n){var e=y.useRef();e.current=n;var t=y.useCallback(function(){for(var r,i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return(r=e.current)===null||r===void 0?void 0:r.call.apply(r,[e].concat(o))},[]);return t}function $S(n){var e=y.useRef(!1),t=y.useState(n),r=rt(t,2),i=r[0],o=r[1];y.useEffect(function(){return e.current=!1,function(){e.current=!0}},[]);function s(a,c){c&&e.current||o(a)}return[i,s]}function SH(n){return n!==void 0}function Ql(n,e){var t=e||{},r=t.defaultValue,i=t.value,o=t.onChange,s=t.postState,a=$S(function(){return SH(i)?i:SH(r)?typeof r=="function"?r():r:typeof n=="function"?n():n}),c=rt(a,2),l=c[0],u=c[1],d=i!==void 0?i:l,h=s?s(d):d,f=ea(o),p=$S([d]),g=rt(p,2),m=g[0],v=g[1];ame(function(){var S=m[0];l!==S&&f(l,S)},[m]),ame(function(){SH(i)||u(i)},[i]);var b=ea(function(S,E){u(S,E),v([d],E)});return[h,b]}function xme(n,e,t,r){var i=$e({},e[n]);if(r!=null&&r.deprecatedTokens){var o=r.deprecatedTokens;o.forEach(function(a){var c=rt(a,2),l=c[0],u=c[1];if(i!=null&&i[l]||i!=null&&i[u]){var d;(d=i[u])!==null&&d!==void 0||(i[u]=i==null?void 0:i[l])}})}var s=$e($e({},t),i);return Object.keys(s).forEach(function(a){s[a]===e[a]&&delete s[a]}),s}var CAe=typeof CSSINJS_STATISTIC<"u",WG=!0;function oo(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];if(!CAe)return Object.assign.apply(Object,[{}].concat(e));WG=!1;var r={};return e.forEach(function(i){if(Wn(i)==="object"){var o=Object.keys(i);o.forEach(function(s){Object.defineProperty(r,s,{configurable:!0,enumerable:!0,get:function(){return i[s]}})})}}),WG=!0,r}var Eme={};function tmt(){}var nmt=function(e){var t,r=e,i=tmt;return CAe&&typeof Proxy<"u"&&(t=new Set,r=new Proxy(e,{get:function(s,a){return WG&&t.add(a),s[a]}}),i=function(s,a){var c;Eme[s]={global:Array.from(t),component:$e($e({},(c=Eme[s])===null||c===void 0?void 0:c.component),a)}}),{token:r,keys:t,flush:i}};function Ime(n,e,t){if(typeof t=="function"){var r;return t(oo(e,(r=e[n])!==null&&r!==void 0?r:{}))}return t??{}}function rmt(n){return n==="js"?{max:Math.max,min:Math.min}:{max:function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return"max(".concat(r.map(function(o){return Ct(o)}).join(","),")")},min:function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return"min(".concat(r.map(function(o){return Ct(o)}).join(","),")")}}}var imt=1e3*60*10,omt=function(){function n(){vc(this,n),Le(this,"map",new Map),Le(this,"objectIDMap",new WeakMap),Le(this,"nextID",0),Le(this,"lastAccessBeat",new Map),Le(this,"accessBeat",0)}return yc(n,[{key:"set",value:function(t,r){this.clear();var i=this.getCompositeKey(t);this.map.set(i,r),this.lastAccessBeat.set(i,Date.now())}},{key:"get",value:function(t){var r=this.getCompositeKey(t),i=this.map.get(r);return this.lastAccessBeat.set(r,Date.now()),this.accessBeat+=1,i}},{key:"getCompositeKey",value:function(t){var r=this,i=t.map(function(o){return o&&Wn(o)==="object"?"obj_".concat(r.getObjectID(o)):"".concat(Wn(o),"_").concat(o)});return i.join("|")}},{key:"getObjectID",value:function(t){if(this.objectIDMap.has(t))return this.objectIDMap.get(t);var r=this.nextID;return this.objectIDMap.set(t,r),this.nextID+=1,r}},{key:"clear",value:function(){var t=this;if(this.accessBeat>1e4){var r=Date.now();this.lastAccessBeat.forEach(function(i,o){r-i>imt&&(t.map.delete(o),t.lastAccessBeat.delete(o))}),this.accessBeat=0}}}]),n}(),Pme=new omt;function smt(n,e){return Ke.useMemo(function(){var t=Pme.get(e);if(t)return t;var r=n();return Pme.set(e,r),r},e)}var amt=function(){return{}};function cmt(n){var e=n.useCSP,t=e===void 0?amt:e,r=n.useToken,i=n.usePrefix,o=n.getResetStyles,s=n.getCommonStyle,a=n.getCompUnitless;function c(h,f,p,g){var m=Array.isArray(h)?h[0]:h;function v(T){return"".concat(String(m)).concat(T.slice(0,1).toUpperCase()).concat(T.slice(1))}var b=(g==null?void 0:g.unitless)||{},S=typeof a=="function"?a(h):{},E=$e($e({},S),{},Le({},v("zIndexPopup"),!0));Object.keys(b).forEach(function(T){E[v(T)]=b[T]});var w=$e($e({},g),{},{unitless:E,prefixToken:v}),C=u(h,f,p,w),I=l(m,p,w);return function(T){var D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:T,O=C(T,D),M=rt(O,2),R=M[1],A=I(D),k=rt(A,2),L=k[0],j=k[1];return[L,R,j]}}function l(h,f,p){var g=p.unitless,m=p.injectStyle,v=m===void 0?!0:m,b=p.prefixToken,S=p.ignore,E=function(I){var T=I.rootCls,D=I.cssVar,O=D===void 0?{}:D,M=r(),R=M.realToken;return sgt({path:[h],prefix:O.prefix,key:O.key,unitless:g,ignore:S,token:R,scope:T},function(){var A=Ime(h,R,f),k=xme(h,R,A,{deprecatedTokens:p==null?void 0:p.deprecatedTokens});return Object.keys(A).forEach(function(L){k[b(L)]=k[L],delete k[L]}),k}),null},w=function(I){var T=r(),D=T.cssVar;return[function(O){return v&&D?Ke.createElement(Ke.Fragment,null,Ke.createElement(E,{rootCls:I,cssVar:D,component:h}),O):O},D==null?void 0:D.key]};return w}function u(h,f,p){var g=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},m=Array.isArray(h)?h:[h,h],v=rt(m,1),b=v[0],S=m.join("-");return function(E){var w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:E,C=r(),I=C.theme,T=C.realToken,D=C.hashId,O=C.token,M=C.cssVar,R=i(),A=R.rootPrefixCls,k=R.iconPrefixCls,L=t(),j=M?"css":"js",N=smt(function(){var te=new Set;return M&&Object.keys(g.unitless||{}).forEach(function(ie){te.add(tO(ie,M.prefix)),te.add(tO(ie,Cme(b,M.prefix)))}),emt(j,te)},[j,b,M==null?void 0:M.prefix]),B=rmt(j),U=B.max,K=B.min,z={theme:I,token:O,hashId:D,nonce:function(){return L.nonce},clientOnly:g.clientOnly,layer:{name:"antd"},order:g.order||-999};kG($e($e({},z),{},{clientOnly:!1,path:["Shared",A]}),function(){return typeof o=="function"?o(O):[]});var G=kG($e($e({},z),{},{path:[S,E,k]}),function(){if(g.injectStyle===!1)return[];var te=nmt(O),ie=te.token,Q=te.flush,ge=Ime(b,T,p),_e=".".concat(E),Se=xme(b,T,ge,{deprecatedTokens:g.deprecatedTokens});M&&Wn(ge)==="object"&&Object.keys(ge).forEach(function(ue){ge[ue]="var(".concat(tO(ue,Cme(b,M.prefix)),")")});var se=oo(ie,{componentCls:_e,prefixCls:E,iconCls:".".concat(k),antCls:".".concat(A),calc:N,max:U,min:K},M?ge:Se),ee=f(se,{hashId:D,prefixCls:E,rootPrefixCls:A,iconPrefixCls:k});Q(b,Se);var Y=typeof s=="function"?s(se,E,w,g.resetFont):null;return[g.resetStyle===!1?null:Y,ee]});return[G,D]}}function d(h,f,p){var g=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},m=u(h,f,p,$e({resetStyle:!1,order:-998},g)),v=function(S){var E=S.prefixCls,w=S.rootCls,C=w===void 0?E:w;return m(E,C),null};return v}return{genStyleHooks:c,genSubStyleComponent:d,genComponentStyleHook:u}}const v8=["blue","purple","cyan","green","magenta","pink","red","orange","yellow","volcano","geekblue","lime","gold"],lmt="5.20.5";function _H(n){return n>=0&&n<=255}function L5(n,e){const{r:t,g:r,b:i,a:o}=new Fa(n).toRgb();if(o<1)return n;const{r:s,g:a,b:c}=new Fa(e).toRgb();for(let l=.01;l<=1;l+=.01){const u=Math.round((t-s*(1-l))/l),d=Math.round((r-a*(1-l))/l),h=Math.round((i-c*(1-l))/l);if(_H(u)&&_H(d)&&_H(h))return new Fa({r:u,g:d,b:h,a:Math.round(l*100)/100}).toRgbString()}return new Fa({r:t,g:r,b:i,a:1}).toRgbString()}var umt=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t};function xAe(n){const{override:e}=n,t=umt(n,["override"]),r=Object.assign({},e);Object.keys(x3).forEach(h=>{delete r[h]});const i=Object.assign(Object.assign({},t),r),o=480,s=576,a=768,c=992,l=1200,u=1600;if(i.motion===!1){const h="0s";i.motionDurationFast=h,i.motionDurationMid=h,i.motionDurationSlow=h}return Object.assign(Object.assign(Object.assign({},i),{colorFillContent:i.colorFillSecondary,colorFillContentHover:i.colorFill,colorFillAlter:i.colorFillQuaternary,colorBgContainerDisabled:i.colorFillTertiary,colorBorderBg:i.colorBgContainer,colorSplit:L5(i.colorBorderSecondary,i.colorBgContainer),colorTextPlaceholder:i.colorTextQuaternary,colorTextDisabled:i.colorTextQuaternary,colorTextHeading:i.colorText,colorTextLabel:i.colorTextSecondary,colorTextDescription:i.colorTextTertiary,colorTextLightSolid:i.colorWhite,colorHighlight:i.colorError,colorBgTextHover:i.colorFillSecondary,colorBgTextActive:i.colorFill,colorIcon:i.colorTextTertiary,colorIconHover:i.colorText,colorErrorOutline:L5(i.colorErrorBg,i.colorBgContainer),colorWarningOutline:L5(i.colorWarningBg,i.colorBgContainer),fontSizeIcon:i.fontSizeSM,lineWidthFocus:i.lineWidth*4,lineWidth:i.lineWidth,controlOutlineWidth:i.lineWidth*2,controlInteractiveSize:i.controlHeight/2,controlItemBgHover:i.colorFillTertiary,controlItemBgActive:i.colorPrimaryBg,controlItemBgActiveHover:i.colorPrimaryBgHover,controlItemBgActiveDisabled:i.colorFill,controlTmpOutline:i.colorFillQuaternary,controlOutline:L5(i.colorPrimaryBg,i.colorBgContainer),lineType:i.lineType,borderRadius:i.borderRadius,borderRadiusXS:i.borderRadiusXS,borderRadiusSM:i.borderRadiusSM,borderRadiusLG:i.borderRadiusLG,fontWeightStrong:600,opacityLoading:.65,linkDecoration:"none",linkHoverDecoration:"none",linkFocusDecoration:"none",controlPaddingHorizontal:12,controlPaddingHorizontalSM:8,paddingXXS:i.sizeXXS,paddingXS:i.sizeXS,paddingSM:i.sizeSM,padding:i.size,paddingMD:i.sizeMD,paddingLG:i.sizeLG,paddingXL:i.sizeXL,paddingContentHorizontalLG:i.sizeLG,paddingContentVerticalLG:i.sizeMS,paddingContentHorizontal:i.sizeMS,paddingContentVertical:i.sizeSM,paddingContentHorizontalSM:i.size,paddingContentVerticalSM:i.sizeXS,marginXXS:i.sizeXXS,marginXS:i.sizeXS,marginSM:i.sizeSM,margin:i.size,marginMD:i.sizeMD,marginLG:i.sizeLG,marginXL:i.sizeXL,marginXXL:i.sizeXXL,boxShadow:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowSecondary:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowTertiary:`
      0 1px 2px 0 rgba(0, 0, 0, 0.03),
      0 1px 6px -1px rgba(0, 0, 0, 0.02),
      0 2px 4px 0 rgba(0, 0, 0, 0.02)
    `,screenXS:o,screenXSMin:o,screenXSMax:s-1,screenSM:s,screenSMMin:s,screenSMMax:a-1,screenMD:a,screenMDMin:a,screenMDMax:c-1,screenLG:c,screenLGMin:c,screenLGMax:l-1,screenXL:l,screenXLMin:l,screenXLMax:u-1,screenXXL:u,screenXXLMin:u,boxShadowPopoverArrow:"2px 2px 5px rgba(0, 0, 0, 0.05)",boxShadowCard:`
      0 1px 2px -2px ${new Fa("rgba(0, 0, 0, 0.16)").toRgbString()},
      0 3px 6px 0 ${new Fa("rgba(0, 0, 0, 0.12)").toRgbString()},
      0 5px 12px 4px ${new Fa("rgba(0, 0, 0, 0.09)").toRgbString()}
    `,boxShadowDrawerRight:`
      -6px 0 16px 0 rgba(0, 0, 0, 0.08),
      -3px 0 6px -4px rgba(0, 0, 0, 0.12),
      -9px 0 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerLeft:`
      6px 0 16px 0 rgba(0, 0, 0, 0.08),
      3px 0 6px -4px rgba(0, 0, 0, 0.12),
      9px 0 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerUp:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerDown:`
      0 -6px 16px 0 rgba(0, 0, 0, 0.08),
      0 -3px 6px -4px rgba(0, 0, 0, 0.12),
      0 -9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowTabsOverflowLeft:"inset 10px 0 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowRight:"inset -10px 0 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowTop:"inset 0 10px 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowBottom:"inset 0 -10px 8px -8px rgba(0, 0, 0, 0.08)"}),r)}var kme=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t};const EAe={lineHeight:!0,lineHeightSM:!0,lineHeightLG:!0,lineHeightHeading1:!0,lineHeightHeading2:!0,lineHeightHeading3:!0,lineHeightHeading4:!0,lineHeightHeading5:!0,opacityLoading:!0,fontWeightStrong:!0,zIndexPopupBase:!0,zIndexBase:!0,opacityImage:!0},dmt={size:!0,sizeSM:!0,sizeLG:!0,sizeMD:!0,sizeXS:!0,sizeXXS:!0,sizeMS:!0,sizeXL:!0,sizeXXL:!0,sizeUnit:!0,sizeStep:!0,motionBase:!0,motionUnit:!0},hmt={screenXS:!0,screenXSMin:!0,screenXSMax:!0,screenSM:!0,screenSMMin:!0,screenSMMax:!0,screenMD:!0,screenMDMin:!0,screenMDMax:!0,screenLG:!0,screenLGMin:!0,screenLGMax:!0,screenXL:!0,screenXLMin:!0,screenXLMax:!0,screenXXL:!0,screenXXLMin:!0},IAe=(n,e,t)=>{const r=t.getDerivativeToken(n),{override:i}=e,o=kme(e,["override"]);let s=Object.assign(Object.assign({},r),{override:i});return s=xAe(s),o&&Object.entries(o).forEach(a=>{let[c,l]=a;const{theme:u}=l,d=kme(l,["theme"]);let h=d;u&&(h=IAe(Object.assign(Object.assign({},s),d),{override:d},u)),s[c]=h}),s};function Gu(){const{token:n,hashed:e,theme:t,override:r,cssVar:i}=Ke.useContext(SAe),o=`${lmt}-${e||""}`,s=t||bAe,[a,c,l]=Opt(s,[x3,n],{salt:o,override:r,getComputedToken:IAe,formatToken:xAe,cssVar:i&&{prefix:i.prefix,key:i.key,unitless:EAe,ignore:dmt,preserve:hmt}});return[s,l,e?c:"",a,i]}const y8={overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},gc=function(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return{boxSizing:"border-box",margin:0,padding:0,color:n.colorText,fontSize:n.fontSize,lineHeight:n.lineHeight,listStyle:"none",fontFamily:e?"inherit":n.fontFamily}},W7=()=>({display:"inline-flex",alignItems:"center",color:"inherit",fontStyle:"normal",lineHeight:0,textAlign:"center",textTransform:"none",verticalAlign:"-0.125em",textRendering:"optimizeLegibility","-webkit-font-smoothing":"antialiased","-moz-osx-font-smoothing":"grayscale","> *":{lineHeight:1},svg:{display:"inline-block"}}),b8=()=>({"&::before":{display:"table",content:'""'},"&::after":{display:"table",clear:"both",content:'""'}}),fmt=n=>({a:{color:n.colorLink,textDecoration:n.linkDecoration,backgroundColor:"transparent",outline:"none",cursor:"pointer",transition:`color ${n.motionDurationSlow}`,"-webkit-text-decoration-skip":"objects","&:hover":{color:n.colorLinkHover},"&:active":{color:n.colorLinkActive},"&:active, &:hover":{textDecoration:n.linkHoverDecoration,outline:0},"&:focus":{textDecoration:n.linkFocusDecoration,outline:0},"&[disabled]":{color:n.colorTextDisabled,cursor:"not-allowed"}}}),pmt=(n,e,t,r)=>{const i=`[class^="${e}"], [class*=" ${e}"]`,o=t?`.${t}`:i,s={boxSizing:"border-box","&::before, &::after":{boxSizing:"border-box"}};let a={};return r!==!1&&(a={fontFamily:n.fontFamily,fontSize:n.fontSize}),{[o]:Object.assign(Object.assign(Object.assign({},a),s),{[i]:s})}},dD=n=>({outline:`${Ct(n.lineWidthFocus)} solid ${n.colorPrimaryBorder}`,outlineOffset:1,transition:"outline-offset 0s, outline 0s"}),S8=n=>({"&:focus-visible":Object.assign({},dD(n))}),PAe=(n,e)=>{const[t,r]=Gu();return kG({theme:t,token:r,hashId:"",path:["ant-design-icons",n],nonce:()=>e==null?void 0:e.nonce,layer:{name:"antd"}},()=>[{[`.${n}`]:Object.assign(Object.assign({},W7()),{[`.${n} .${n}-icon`]:{display:"block"}})}])},{genStyleHooks:Jc,genComponentStyleHook:gmt,genSubStyleComponent:Lne}=cmt({usePrefix:()=>{const{getPrefixCls:n,iconPrefixCls:e}=y.useContext(fr);return{rootPrefixCls:n(),iconPrefixCls:e}},useToken:()=>{const[n,e,t,r,i]=Gu();return{theme:n,realToken:e,hashId:t,token:r,cssVar:i}},useCSP:()=>{const{csp:n,iconPrefixCls:e}=y.useContext(fr);return PAe(e,n),n??{}},getResetStyles:n=>[{"&":fmt(n)}],getCommonStyle:pmt,getCompUnitless:()=>EAe});function mmt(n,e){return v8.reduce((t,r)=>{const i=n[`${r}1`],o=n[`${r}3`],s=n[`${r}6`],a=n[`${r}7`];return Object.assign(Object.assign({},t),e(r,{lightColor:i,lightBorderColor:o,darkColor:s,textColor:a}))},{})}const vmt=Object.assign({},zT),{useId:Tme}=vmt,ymt=()=>"",bmt=typeof Tme>"u"?ymt:Tme;function Smt(n,e,t){var r;lD();const i=n||{},o=i.inherit===!1||!e?Object.assign(Object.assign({},VG),{hashed:(r=e==null?void 0:e.hashed)!==null&&r!==void 0?r:VG.hashed,cssVar:e==null?void 0:e.cssVar}):e,s=bmt();return cD(()=>{var a,c;if(!n)return e;const l=Object.assign({},o.components);Object.keys(n.components||{}).forEach(h=>{l[h]=Object.assign(Object.assign({},l[h]),n.components[h])});const u=`css-var-${s.replace(/:/g,"")}`,d=((a=i.cssVar)!==null&&a!==void 0?a:o.cssVar)&&Object.assign(Object.assign(Object.assign({prefix:t==null?void 0:t.prefixCls},typeof o.cssVar=="object"?o.cssVar:{}),typeof i.cssVar=="object"?i.cssVar:{}),{key:typeof i.cssVar=="object"&&((c=i.cssVar)===null||c===void 0?void 0:c.key)||u});return Object.assign(Object.assign(Object.assign({},o),i),{token:Object.assign(Object.assign({},o.token),i.token),components:l,cssVar:d})},[i,o],(a,c)=>a.some((l,u)=>{const d=c[u];return!S3(l,d,!0)}))}var _mt=["children"],kAe=y.createContext({});function wmt(n){var e=n.children,t=jr(n,_mt);return y.createElement(kAe.Provider,{value:t},e)}var Cmt=function(n){zy(t,n);var e=Vy(t);function t(){return vc(this,t),e.apply(this,arguments)}return yc(t,[{key:"render",value:function(){return this.props.children}}]),t}(y.Component);function xmt(n){var e=y.useReducer(function(a){return a+1},0),t=rt(e,2),r=t[1],i=y.useRef(n),o=ea(function(){return i.current}),s=ea(function(a){i.current=typeof a=="function"?a(i.current):a,r()});return[o,s]}var r0="none",N5="appear",F5="enter",j5="leave",Dme="none",wf="prepare",tC="start",nC="active",Nne="end",TAe="prepared";function Rme(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit".concat(n)]="webkit".concat(e),t["Moz".concat(n)]="moz".concat(e),t["ms".concat(n)]="MS".concat(e),t["O".concat(n)]="o".concat(e.toLowerCase()),t}function Emt(n,e){var t={animationend:Rme("Animation","AnimationEnd"),transitionend:Rme("Transition","TransitionEnd")};return n&&("AnimationEvent"in e||delete t.animationend.animation,"TransitionEvent"in e||delete t.transitionend.transition),t}var Imt=Emt(eu(),typeof window<"u"?window:{}),DAe={};if(eu()){var Pmt=document.createElement("div");DAe=Pmt.style}var B5={};function RAe(n){if(B5[n])return B5[n];var e=Imt[n];if(e)for(var t=Object.keys(e),r=t.length,i=0;i<r;i+=1){var o=t[i];if(Object.prototype.hasOwnProperty.call(e,o)&&o in DAe)return B5[n]=e[o],B5[n]}return""}var AAe=RAe("animationend"),OAe=RAe("transitionend"),MAe=!!(AAe&&OAe),Ame=AAe||"animationend",Ome=OAe||"transitionend";function Mme(n,e){if(!n)return null;if(Wn(n)==="object"){var t=e.replace(/-\w/g,function(r){return r[1].toUpperCase()});return n[t]}return"".concat(n,"-").concat(e)}const kmt=function(n){var e=y.useRef();function t(i){i&&(i.removeEventListener(Ome,n),i.removeEventListener(Ame,n))}function r(i){e.current&&e.current!==i&&t(e.current),i&&i!==e.current&&(i.addEventListener(Ome,n),i.addEventListener(Ame,n),e.current=i)}return y.useEffect(function(){return function(){t(e.current)}},[]),[r,t]};var $Ae=eu()?y.useLayoutEffect:y.useEffect;const Tmt=function(){var n=y.useRef(null);function e(){no.cancel(n.current)}function t(r){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2;e();var o=no(function(){i<=1?r({isCanceled:function(){return o!==n.current}}):t(r,i-1)});n.current=o}return y.useEffect(function(){return function(){e()}},[]),[t,e]};var Dmt=[wf,tC,nC,Nne],Rmt=[wf,TAe],LAe=!1,Amt=!0;function NAe(n){return n===nC||n===Nne}const Omt=function(n,e,t){var r=$S(Dme),i=rt(r,2),o=i[0],s=i[1],a=Tmt(),c=rt(a,2),l=c[0],u=c[1];function d(){s(wf,!0)}var h=e?Rmt:Dmt;return $Ae(function(){if(o!==Dme&&o!==Nne){var f=h.indexOf(o),p=h[f+1],g=t(o);g===LAe?s(p,!0):p&&l(function(m){function v(){m.isCanceled()||s(p,!0)}g===!0?v():Promise.resolve(g).then(v)})}},[n,o]),y.useEffect(function(){return function(){u()}},[]),[d,o]};function Mmt(n,e,t,r){var i=r.motionEnter,o=i===void 0?!0:i,s=r.motionAppear,a=s===void 0?!0:s,c=r.motionLeave,l=c===void 0?!0:c,u=r.motionDeadline,d=r.motionLeaveImmediately,h=r.onAppearPrepare,f=r.onEnterPrepare,p=r.onLeavePrepare,g=r.onAppearStart,m=r.onEnterStart,v=r.onLeaveStart,b=r.onAppearActive,S=r.onEnterActive,E=r.onLeaveActive,w=r.onAppearEnd,C=r.onEnterEnd,I=r.onLeaveEnd,T=r.onVisibleChanged,D=$S(),O=rt(D,2),M=O[0],R=O[1],A=xmt(r0),k=rt(A,2),L=k[0],j=k[1],N=$S(null),B=rt(N,2),U=B[0],K=B[1],z=L(),G=y.useRef(!1),te=y.useRef(null);function ie(){return t()}var Q=y.useRef(!1);function ge(){j(r0),K(null,!0)}var _e=ea(function(Ae){var Ie=L();if(Ie!==r0){var be=ie();if(!(Ae&&!Ae.deadline&&Ae.target!==be)){var De=Q.current,Me;Ie===N5&&De?Me=w==null?void 0:w(be,Ae):Ie===F5&&De?Me=C==null?void 0:C(be,Ae):Ie===j5&&De&&(Me=I==null?void 0:I(be,Ae)),De&&Me!==!1&&ge()}}}),Se=kmt(_e),se=rt(Se,1),ee=se[0],Y=function(Ie){switch(Ie){case N5:return Le(Le(Le({},wf,h),tC,g),nC,b);case F5:return Le(Le(Le({},wf,f),tC,m),nC,S);case j5:return Le(Le(Le({},wf,p),tC,v),nC,E);default:return{}}},ue=y.useMemo(function(){return Y(z)},[z]),ye=Omt(z,!n,function(Ae){if(Ae===wf){var Ie=ue[wf];return Ie?Ie(ie()):LAe}if(he in ue){var be;K(((be=ue[he])===null||be===void 0?void 0:be.call(ue,ie(),null))||null)}return he===nC&&z!==r0&&(ee(ie()),u>0&&(clearTimeout(te.current),te.current=setTimeout(function(){_e({deadline:!0})},u))),he===TAe&&ge(),Amt}),V=rt(ye,2),le=V[0],he=V[1],oe=NAe(he);Q.current=oe,$Ae(function(){R(e);var Ae=G.current;G.current=!0;var Ie;!Ae&&e&&a&&(Ie=N5),Ae&&e&&o&&(Ie=F5),(Ae&&!e&&l||!Ae&&d&&!e&&l)&&(Ie=j5);var be=Y(Ie);Ie&&(n||be[wf])?(j(Ie),le()):j(r0)},[e]),y.useEffect(function(){(z===N5&&!a||z===F5&&!o||z===j5&&!l)&&j(r0)},[a,o,l]),y.useEffect(function(){return function(){G.current=!1,clearTimeout(te.current)}},[]);var ne=y.useRef(!1);y.useEffect(function(){M&&(ne.current=!0),M!==void 0&&z===r0&&((ne.current||M)&&(T==null||T(M)),ne.current=!0)},[M,z]);var ce=U;return ue[wf]&&he===tC&&(ce=$e({transition:"none"},ce)),[z,he,ce,M??e]}function $mt(n){var e=n;Wn(n)==="object"&&(e=n.transitionSupport);function t(i,o){return!!(i.motionName&&e&&o!==!1)}var r=y.forwardRef(function(i,o){var s=i.visible,a=s===void 0?!0:s,c=i.removeOnLeave,l=c===void 0?!0:c,u=i.forceRender,d=i.children,h=i.motionName,f=i.leavedClassName,p=i.eventProps,g=y.useContext(kAe),m=g.motion,v=t(i,m),b=y.useRef(),S=y.useRef();function E(){try{return b.current instanceof HTMLElement?b.current:ok(S.current)}catch{return null}}var w=Mmt(v,a,E,i),C=rt(w,4),I=C[0],T=C[1],D=C[2],O=C[3],M=y.useRef(O);O&&(M.current=!0);var R=y.useCallback(function(U){b.current=U,xne(o,U)},[o]),A,k=$e($e({},p),{},{visible:a});if(!d)A=null;else if(I===r0)O?A=d($e({},k),R):!l&&M.current&&f?A=d($e($e({},k),{},{className:f}),R):u||!l&&!f?A=d($e($e({},k),{},{style:{display:"none"}}),R):A=null;else{var L;T===wf?L="prepare":NAe(T)?L="active":T===tC&&(L="start");var j=Mme(h,"".concat(I,"-").concat(L));A=d($e($e({},k),{},{className:Ue(Mme(h,I),Le(Le({},j,j&&L),h,typeof h=="string")),style:D}),R)}if(y.isValidElement(A)&&yv(A)){var N=A,B=N.ref;B||(A=y.cloneElement(A,{ref:R}))}return y.createElement(Cmt,{ref:S},A)});return r.displayName="CSSMotion",r}const bv=$mt(MAe);var qG="add",KG="keep",GG="remove",wH="removed";function Lmt(n){var e;return n&&Wn(n)==="object"&&"key"in n?e=n:e={key:n},$e($e({},e),{},{key:String(e.key)})}function ZG(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return n.map(Lmt)}function Nmt(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=[],r=0,i=e.length,o=ZG(n),s=ZG(e);o.forEach(function(l){for(var u=!1,d=r;d<i;d+=1){var h=s[d];if(h.key===l.key){r<d&&(t=t.concat(s.slice(r,d).map(function(f){return $e($e({},f),{},{status:qG})})),r=d),t.push($e($e({},h),{},{status:KG})),r+=1,u=!0;break}}u||t.push($e($e({},l),{},{status:GG}))}),r<i&&(t=t.concat(s.slice(r).map(function(l){return $e($e({},l),{},{status:qG})})));var a={};t.forEach(function(l){var u=l.key;a[u]=(a[u]||0)+1});var c=Object.keys(a).filter(function(l){return a[l]>1});return c.forEach(function(l){t=t.filter(function(u){var d=u.key,h=u.status;return d!==l||h!==GG}),t.forEach(function(u){u.key===l&&(u.status=KG)})}),t}var Fmt=["component","children","onVisibleChanged","onAllRemoved"],jmt=["status"],Bmt=["eventProps","visible","children","motionName","motionAppear","motionEnter","motionLeave","motionLeaveImmediately","motionDeadline","removeOnLeave","leavedClassName","onAppearPrepare","onAppearStart","onAppearActive","onAppearEnd","onEnterStart","onEnterActive","onEnterEnd","onLeaveStart","onLeaveActive","onLeaveEnd"];function Hmt(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:bv,t=function(r){zy(o,r);var i=Vy(o);function o(){var s;vc(this,o);for(var a=arguments.length,c=new Array(a),l=0;l<a;l++)c[l]=arguments[l];return s=i.call.apply(i,[this].concat(c)),Le(Yr(s),"state",{keyEntities:[]}),Le(Yr(s),"removeKey",function(u){var d=s.state.keyEntities,h=d.map(function(f){return f.key!==u?f:$e($e({},f),{},{status:wH})});return s.setState({keyEntities:h}),h.filter(function(f){var p=f.status;return p!==wH}).length}),s}return yc(o,[{key:"render",value:function(){var a=this,c=this.state.keyEntities,l=this.props,u=l.component,d=l.children,h=l.onVisibleChanged,f=l.onAllRemoved,p=jr(l,Fmt),g=u||y.Fragment,m={};return Bmt.forEach(function(v){m[v]=p[v],delete p[v]}),delete p.keys,y.createElement(g,p,c.map(function(v,b){var S=v.status,E=jr(v,jmt),w=S===qG||S===KG;return y.createElement(e,ln({},m,{key:E.key,visible:w,eventProps:E,onVisibleChanged:function(I){if(h==null||h(I,{key:E.key}),!I){var T=a.removeKey(E.key);T===0&&f&&f()}}}),function(C,I){return d($e($e({},C),{},{index:b}),I)})}))}}],[{key:"getDerivedStateFromProps",value:function(a,c){var l=a.keys,u=c.keyEntities,d=ZG(l),h=Nmt(u,d);return{keyEntities:h.filter(function(f){var p=u.find(function(g){var m=g.key;return f.key===m});return!(p&&p.status===wH&&f.status===GG)})}}}]),o}(y.Component);return Le(t,"defaultProps",{component:"div"}),t}const FAe=Hmt(MAe);function Umt(n){const{children:e}=n,[,t]=Gu(),{motion:r}=t,i=y.useRef(!1);return i.current=i.current||r===!1,i.current?y.createElement(wmt,{motion:r},e):e}const zmt=()=>null;var Vmt=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t};const Wmt=["getTargetContainer","getPopupContainer","renderEmpty","input","pagination","form","select","button"];let _8,jAe,BAe,HAe;function lO(){return _8||E3}function qmt(){return jAe||Mne}function Kmt(n){return Object.keys(n).some(e=>e.endsWith("Color"))}const Gmt=n=>{const{prefixCls:e,iconPrefixCls:t,theme:r,holderRender:i}=n;e!==void 0&&(_8=e),t!==void 0&&(jAe=t),"holderRender"in n&&(HAe=i),r&&(Kmt(r)?Ggt(lO(),r):BAe=r)},Fne=()=>({getPrefixCls:(n,e)=>e||(n?`${lO()}-${n}`:lO()),getIconPrefixCls:qmt,getRootPrefixCls:()=>_8||lO(),getTheme:()=>BAe,holderRender:HAe}),Zmt=n=>{const{children:e,csp:t,autoInsertSpaceInButton:r,alert:i,anchor:o,form:s,locale:a,componentSize:c,direction:l,space:u,virtual:d,dropdownMatchSelectWidth:h,popupMatchSelectWidth:f,popupOverflow:p,legacyLocale:g,parentContext:m,iconPrefixCls:v,theme:b,componentDisabled:S,segmented:E,statistic:w,spin:C,calendar:I,carousel:T,cascader:D,collapse:O,typography:M,checkbox:R,descriptions:A,divider:k,drawer:L,skeleton:j,steps:N,image:B,layout:U,list:K,mentions:z,modal:G,progress:te,result:ie,slider:Q,breadcrumb:ge,menu:_e,pagination:Se,input:se,textArea:ee,empty:Y,badge:ue,radio:ye,rate:V,switch:le,transfer:he,avatar:oe,message:ne,tag:ce,table:Ae,card:Ie,tabs:be,timeline:De,timePicker:Me,upload:He,notification:Je,tree:qe,colorPicker:Ge,datePicker:St,rangePicker:Pt,flex:on,wave:an,dropdown:Rt,warning:Xt,tour:yn,floatButtonGroup:bn,variant:Kn,inputNumber:lr,treeSelect:Rr}=n,Lr=y.useCallback((hn,Ut)=>{const{prefixCls:sn}=n;if(Ut)return Ut;const ae=sn||m.getPrefixCls("");return hn?`${ae}-${hn}`:ae},[m.getPrefixCls,n.prefixCls]),er=v||m.iconPrefixCls||Mne,ke=t||m.csp;PAe(er,ke);const Qn=Smt(b,m.theme,{prefixCls:Lr("")}),Gn={csp:ke,autoInsertSpaceInButton:r,alert:i,anchor:o,locale:a||g,direction:l,space:u,virtual:d,popupMatchSelectWidth:f??h,popupOverflow:p,getPrefixCls:Lr,iconPrefixCls:er,theme:Qn,segmented:E,statistic:w,spin:C,calendar:I,carousel:T,cascader:D,collapse:O,typography:M,checkbox:R,descriptions:A,divider:k,drawer:L,skeleton:j,steps:N,image:B,input:se,textArea:ee,layout:U,list:K,mentions:z,modal:G,progress:te,result:ie,slider:Q,breadcrumb:ge,menu:_e,pagination:Se,empty:Y,badge:ue,radio:ye,rate:V,switch:le,transfer:he,avatar:oe,message:ne,tag:ce,table:Ae,card:Ie,tabs:be,timeline:De,timePicker:Me,upload:He,notification:Je,tree:qe,colorPicker:Ge,datePicker:St,rangePicker:Pt,flex:on,wave:an,dropdown:Rt,warning:Xt,tour:yn,floatButtonGroup:bn,variant:Kn,inputNumber:lr,treeSelect:Rr},J=Object.assign({},m);Object.keys(Gn).forEach(hn=>{Gn[hn]!==void 0&&(J[hn]=Gn[hn])}),Wmt.forEach(hn=>{const Ut=n[hn];Ut&&(J[hn]=Ut)}),typeof r<"u"&&(J.button=Object.assign({autoInsertSpace:r},J.button));const ze=cD(()=>J,J,(hn,Ut)=>{const sn=Object.keys(hn),ae=Object.keys(Ut);return sn.length!==ae.length||sn.some(Wt=>hn[Wt]!==Ut[Wt])}),it=y.useMemo(()=>({prefixCls:er,csp:ke}),[er,ke]);let at=y.createElement(y.Fragment,null,y.createElement(zmt,{dropdownMatchSelectWidth:h}),e);const Lt=y.useMemo(()=>{var hn,Ut,sn,ae;return eC(((hn=xy.Form)===null||hn===void 0?void 0:hn.defaultValidateMessages)||{},((sn=(Ut=ze.locale)===null||Ut===void 0?void 0:Ut.Form)===null||sn===void 0?void 0:sn.defaultValidateMessages)||{},((ae=ze.form)===null||ae===void 0?void 0:ae.validateMessages)||{},(s==null?void 0:s.validateMessages)||{})},[ze,s==null?void 0:s.validateMessages]);Object.keys(Lt).length>0&&(at=y.createElement(hAe.Provider,{value:Lt},at)),a&&(at=y.createElement(vgt,{locale:a,_ANT_MARK__:mgt},at)),(er||ke)&&(at=y.createElement(V7.Provider,{value:it},at)),c&&(at=y.createElement(Zgt,{size:c},at)),at=y.createElement(Umt,null,at);const fn=y.useMemo(()=>{const hn=Qn||{},{algorithm:Ut,token:sn,components:ae,cssVar:Wt}=hn,un=Vmt(hn,["algorithm","token","components","cssVar"]),qt=Ut&&(!Array.isArray(Ut)||Ut.length>0)?xG(Ut):bAe,Ce={};Object.entries(ae||{}).forEach(At=>{let[$t,_n]=At;const jn=Object.assign({},_n);"algorithm"in jn&&(jn.algorithm===!0?jn.theme=qt:(Array.isArray(jn.algorithm)||typeof jn.algorithm=="function")&&(jn.theme=xG(jn.algorithm)),delete jn.algorithm),Ce[$t]=jn});const ct=Object.assign(Object.assign({},x3),sn);return Object.assign(Object.assign({},un),{theme:qt,token:ct,components:Ce,override:Object.assign({override:ct},Ce),cssVar:Wt})},[Qn]);return b&&(at=y.createElement(SAe.Provider,{value:fn},at)),ze.warning&&(at=y.createElement(dgt.Provider,{value:ze.warning},at)),S!==void 0&&(at=y.createElement($ne,{disabled:S},at)),y.createElement(fr.Provider,{value:ze},at)},Sv=n=>{const e=y.useContext(fr),t=y.useContext(One);return y.createElement(Zmt,Object.assign({parentContext:e,legacyLocale:t},n))};Sv.ConfigContext=fr;Sv.SizeContext=MS;Sv.config=Gmt;Sv.useConfig=Xgt;Object.defineProperty(Sv,"SizeContext",{get:()=>MS});var Xmt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm193.5 301.7l-210.6 292a31.8 31.8 0 01-51.7 0L318.5 484.9c-3.8-5.3 0-12.7 6.5-12.7h46.9c10.2 0 19.9 4.9 25.9 13.3l71.2 98.8 157.2-218c6-8.3 15.6-13.3 25.9-13.3H699c6.5 0 10.3 7.4 6.5 12.7z"}}]},name:"check-circle",theme:"filled"};function UAe(n){var e;return n==null||(e=n.getRootNode)===null||e===void 0?void 0:e.call(n)}function Ymt(n){return UAe(n)instanceof ShadowRoot}function w8(n){return Ymt(n)?UAe(n):null}function Jmt(n){return n.replace(/-(.)/g,function(e,t){return t.toUpperCase()})}function XG(n,e){Sl(n,"[@ant-design/icons] ".concat(e))}function $me(n){return Wn(n)==="object"&&typeof n.name=="string"&&typeof n.theme=="string"&&(Wn(n.icon)==="object"||typeof n.icon=="function")}function Lme(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.keys(n).reduce(function(e,t){var r=n[t];switch(t){case"class":e.className=r,delete e.class;break;default:delete e[t],e[Jmt(t)]=r}return e},{})}function YG(n,e,t){return t?Ke.createElement(n.tag,$e($e({key:e},Lme(n.attrs)),t),(n.children||[]).map(function(r,i){return YG(r,"".concat(e,"-").concat(n.tag,"-").concat(i))})):Ke.createElement(n.tag,$e({key:e},Lme(n.attrs)),(n.children||[]).map(function(r,i){return YG(r,"".concat(e,"-").concat(n.tag,"-").concat(i))}))}function zAe(n){return C3(n)[0]}function VAe(n){return n?Array.isArray(n)?n:[n]:[]}var Qmt={width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true",focusable:"false"},evt=`
.anticon {
  display: inline-flex;
  align-items: center;
  color: inherit;
  font-style: normal;
  line-height: 0;
  text-align: center;
  text-transform: none;
  vertical-align: -0.125em;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

.anticon > * {
  line-height: 1;
}

.anticon svg {
  display: inline-block;
}

.anticon::before {
  display: none;
}

.anticon .anticon-icon {
  display: block;
}

.anticon[tabindex] {
  cursor: pointer;
}

.anticon-spin::before,
.anticon-spin {
  display: inline-block;
  -webkit-animation: loadingCircle 1s infinite linear;
  animation: loadingCircle 1s infinite linear;
}

@-webkit-keyframes loadingCircle {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}

@keyframes loadingCircle {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}
`,WAe=function(e){var t=y.useContext(V7),r=t.csp,i=t.prefixCls,o=evt;i&&(o=o.replace(/anticon/g,i)),y.useEffect(function(){var s=e.current,a=w8(s);Wm(o,"@ant-design-icons",{prepend:!0,csp:r,attachTo:a})},[])},tvt=["icon","className","onClick","style","primaryColor","secondaryColor"],ak={primaryColor:"#333",secondaryColor:"#E6E6E6",calculated:!1};function nvt(n){var e=n.primaryColor,t=n.secondaryColor;ak.primaryColor=e,ak.secondaryColor=t||zAe(e),ak.calculated=!!t}function rvt(){return $e({},ak)}var nE=function(e){var t=e.icon,r=e.className,i=e.onClick,o=e.style,s=e.primaryColor,a=e.secondaryColor,c=jr(e,tvt),l=y.useRef(),u=ak;if(s&&(u={primaryColor:s,secondaryColor:a||zAe(s)}),WAe(l),XG($me(t),"icon should be icon definiton, but got ".concat(t)),!$me(t))return null;var d=t;return d&&typeof d.icon=="function"&&(d=$e($e({},d),{},{icon:d.icon(u.primaryColor,u.secondaryColor)})),YG(d.icon,"svg-".concat(d.name),$e($e({className:r,onClick:i,style:o,"data-icon":d.name,width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true"},c),{},{ref:l}))};nE.displayName="IconReact";nE.getTwoToneColors=rvt;nE.setTwoToneColors=nvt;function qAe(n){var e=VAe(n),t=rt(e,2),r=t[0],i=t[1];return nE.setTwoToneColors({primaryColor:r,secondaryColor:i})}function ivt(){var n=nE.getTwoToneColors();return n.calculated?[n.primaryColor,n.secondaryColor]:n.primaryColor}var ovt=["className","icon","spin","rotate","tabIndex","onClick","twoToneColor"];qAe(m8.primary);var _a=y.forwardRef(function(n,e){var t=n.className,r=n.icon,i=n.spin,o=n.rotate,s=n.tabIndex,a=n.onClick,c=n.twoToneColor,l=jr(n,ovt),u=y.useContext(V7),d=u.prefixCls,h=d===void 0?"anticon":d,f=u.rootClassName,p=Ue(f,h,Le(Le({},"".concat(h,"-").concat(r.name),!!r.name),"".concat(h,"-spin"),!!i||r.name==="loading"),t),g=s;g===void 0&&a&&(g=-1);var m=o?{msTransform:"rotate(".concat(o,"deg)"),transform:"rotate(".concat(o,"deg)")}:void 0,v=VAe(c),b=rt(v,2),S=b[0],E=b[1];return y.createElement("span",ln({role:"img","aria-label":r.name},l,{ref:e,tabIndex:g,onClick:a,className:p}),y.createElement(nE,{icon:r,primaryColor:S,secondaryColor:E,style:m}))});_a.displayName="AntdIcon";_a.getTwoToneColor=ivt;_a.setTwoToneColor=qAe;var svt=function(e,t){return y.createElement(_a,ln({},e,{ref:t,icon:Xmt}))},jne=y.forwardRef(svt),avt={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64c247.4 0 448 200.6 448 448S759.4 960 512 960 64 759.4 64 512 264.6 64 512 64zm127.98 274.82h-.04l-.08.06L512 466.75 384.14 338.88c-.04-.05-.06-.06-.08-.06a.12.12 0 00-.07 0c-.03 0-.05.01-.09.05l-45.02 45.02a.2.2 0 00-.05.09.12.12 0 000 .07v.02a.27.27 0 00.06.06L466.75 512 338.88 639.86c-.05.04-.06.06-.06.08a.12.12 0 000 .07c0 .03.01.05.05.09l45.02 45.02a.2.2 0 00.09.05.12.12 0 00.07 0c.02 0 .04-.01.08-.05L512 557.25l127.86 127.87c.04.04.06.05.08.05a.12.12 0 00.07 0c.03 0 .05-.01.09-.05l45.02-45.02a.2.2 0 00.05-.09.12.12 0 000-.07v-.02a.27.27 0 00-.05-.06L557.25 512l127.87-127.86c.04-.04.05-.06.05-.08a.12.12 0 000-.07c0-.03-.01-.05-.05-.09l-45.02-45.02a.2.2 0 00-.09-.05.12.12 0 00-.07 0z"}}]},name:"close-circle",theme:"filled"},cvt=function(e,t){return y.createElement(_a,ln({},e,{ref:t,icon:avt}))},hD=y.forwardRef(cvt),lvt={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M799.86 166.31c.02 0 .04.02.08.06l57.69 57.7c.04.03.05.05.06.08a.12.12 0 010 .06c0 .03-.02.05-.06.09L569.93 512l287.7 287.7c.04.04.05.06.06.09a.12.12 0 010 .07c0 .02-.02.04-.06.08l-57.7 57.69c-.03.04-.05.05-.07.06a.12.12 0 01-.07 0c-.03 0-.05-.02-.09-.06L512 569.93l-287.7 287.7c-.04.04-.06.05-.09.06a.12.12 0 01-.07 0c-.02 0-.04-.02-.08-.06l-57.69-57.7c-.04-.03-.05-.05-.06-.07a.12.12 0 010-.07c0-.03.02-.05.06-.09L454.07 512l-287.7-287.7c-.04-.04-.05-.06-.06-.09a.12.12 0 010-.07c0-.02.02-.04.06-.08l57.7-57.69c.03-.04.05-.05.07-.06a.12.12 0 01.07 0c.03 0 .05.02.09.06L512 454.07l287.7-287.7c.04-.04.06-.05.09-.06a.12.12 0 01.07 0z"}}]},name:"close",theme:"outlined"},uvt=function(e,t){return y.createElement(_a,ln({},e,{ref:t,icon:lvt}))},fD=y.forwardRef(uvt),dvt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm-32 232c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V296zm32 440a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"}}]},name:"exclamation-circle",theme:"filled"},hvt=function(e,t){return y.createElement(_a,ln({},e,{ref:t,icon:dvt}))},Bne=y.forwardRef(hvt),fvt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm32 664c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V456c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272zm-32-344a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"}}]},name:"info-circle",theme:"filled"},pvt=function(e,t){return y.createElement(_a,ln({},e,{ref:t,icon:fvt}))},KAe=y.forwardRef(pvt),gvt=`accept acceptCharset accessKey action allowFullScreen allowTransparency
    alt async autoComplete autoFocus autoPlay capture cellPadding cellSpacing challenge
    charSet checked classID className colSpan cols content contentEditable contextMenu
    controls coords crossOrigin data dateTime default defer dir disabled download draggable
    encType form formAction formEncType formMethod formNoValidate formTarget frameBorder
    headers height hidden high href hrefLang htmlFor httpEquiv icon id inputMode integrity
    is keyParams keyType kind label lang list loop low manifest marginHeight marginWidth max maxLength media
    mediaGroup method min minLength multiple muted name noValidate nonce open
    optimum pattern placeholder poster preload radioGroup readOnly rel required
    reversed role rowSpan rows sandbox scope scoped scrolling seamless selected
    shape size sizes span spellCheck src srcDoc srcLang srcSet start step style
    summary tabIndex target title type useMap value width wmode wrap`,mvt=`onCopy onCut onPaste onCompositionEnd onCompositionStart onCompositionUpdate onKeyDown
    onKeyPress onKeyUp onFocus onBlur onChange onInput onSubmit onClick onContextMenu onDoubleClick
    onDrag onDragEnd onDragEnter onDragExit onDragLeave onDragOver onDragStart onDrop onMouseDown
    onMouseEnter onMouseLeave onMouseMove onMouseOut onMouseOver onMouseUp onSelect onTouchCancel
    onTouchEnd onTouchMove onTouchStart onScroll onWheel onAbort onCanPlay onCanPlayThrough
    onDurationChange onEmptied onEncrypted onEnded onError onLoadedData onLoadedMetadata
    onLoadStart onPause onPlay onPlaying onProgress onRateChange onSeeked onSeeking onStalled onSuspend onTimeUpdate onVolumeChange onWaiting onLoad onError`,vvt="".concat(gvt," ").concat(mvt).split(/[\s\n]+/),yvt="aria-",bvt="data-";function Nme(n,e){return n.indexOf(e)===0}function pg(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,t;e===!1?t={aria:!0,data:!0,attr:!0}:e===!0?t={aria:!0}:t=$e({},e);var r={};return Object.keys(n).forEach(function(i){(t.aria&&(i==="role"||Nme(i,yvt))||t.data&&Nme(i,bvt)||t.attr&&vvt.includes(i))&&(r[i]=n[i])}),r}function GAe(n){return n&&Ke.isValidElement(n)&&n.type===Ke.Fragment}const Svt=(n,e,t)=>Ke.isValidElement(n)?Ke.cloneElement(n,typeof t=="function"?t(n.props||{}):t):e;function gg(n,e){return Svt(n,n,e)}const Fme=n=>typeof n=="object"&&n!=null&&n.nodeType===1,jme=(n,e)=>(!e||n!=="hidden")&&n!=="visible"&&n!=="clip",CH=(n,e)=>{if(n.clientHeight<n.scrollHeight||n.clientWidth<n.scrollWidth){const t=getComputedStyle(n,null);return jme(t.overflowY,e)||jme(t.overflowX,e)||(r=>{const i=(o=>{if(!o.ownerDocument||!o.ownerDocument.defaultView)return null;try{return o.ownerDocument.defaultView.frameElement}catch{return null}})(r);return!!i&&(i.clientHeight<r.scrollHeight||i.clientWidth<r.scrollWidth)})(n)}return!1},H5=(n,e,t,r,i,o,s,a)=>o<n&&s>e||o>n&&s<e?0:o<=n&&a<=t||s>=e&&a>=t?o-n-r:s>e&&a<t||o<n&&a>t?s-e+i:0,_vt=n=>{const e=n.parentElement;return e??(n.getRootNode().host||null)},Bme=(n,e)=>{var t,r,i,o;if(typeof document>"u")return[];const{scrollMode:s,block:a,inline:c,boundary:l,skipOverflowHiddenElements:u}=e,d=typeof l=="function"?l:j=>j!==l;if(!Fme(n))throw new TypeError("Invalid target");const h=document.scrollingElement||document.documentElement,f=[];let p=n;for(;Fme(p)&&d(p);){if(p=_vt(p),p===h){f.push(p);break}p!=null&&p===document.body&&CH(p)&&!CH(document.documentElement)||p!=null&&CH(p,u)&&f.push(p)}const g=(r=(t=window.visualViewport)==null?void 0:t.width)!=null?r:innerWidth,m=(o=(i=window.visualViewport)==null?void 0:i.height)!=null?o:innerHeight,{scrollX:v,scrollY:b}=window,{height:S,width:E,top:w,right:C,bottom:I,left:T}=n.getBoundingClientRect(),{top:D,right:O,bottom:M,left:R}=(j=>{const N=window.getComputedStyle(j);return{top:parseFloat(N.scrollMarginTop)||0,right:parseFloat(N.scrollMarginRight)||0,bottom:parseFloat(N.scrollMarginBottom)||0,left:parseFloat(N.scrollMarginLeft)||0}})(n);let A=a==="start"||a==="nearest"?w-D:a==="end"?I+M:w+S/2-D+M,k=c==="center"?T+E/2-R+O:c==="end"?C+O:T-R;const L=[];for(let j=0;j<f.length;j++){const N=f[j],{height:B,width:U,top:K,right:z,bottom:G,left:te}=N.getBoundingClientRect();if(s==="if-needed"&&w>=0&&T>=0&&I<=m&&C<=g&&w>=K&&I<=G&&T>=te&&C<=z)return L;const ie=getComputedStyle(N),Q=parseInt(ie.borderLeftWidth,10),ge=parseInt(ie.borderTopWidth,10),_e=parseInt(ie.borderRightWidth,10),Se=parseInt(ie.borderBottomWidth,10);let se=0,ee=0;const Y="offsetWidth"in N?N.offsetWidth-N.clientWidth-Q-_e:0,ue="offsetHeight"in N?N.offsetHeight-N.clientHeight-ge-Se:0,ye="offsetWidth"in N?N.offsetWidth===0?0:U/N.offsetWidth:0,V="offsetHeight"in N?N.offsetHeight===0?0:B/N.offsetHeight:0;if(h===N)se=a==="start"?A:a==="end"?A-m:a==="nearest"?H5(b,b+m,m,ge,Se,b+A,b+A+S,S):A-m/2,ee=c==="start"?k:c==="center"?k-g/2:c==="end"?k-g:H5(v,v+g,g,Q,_e,v+k,v+k+E,E),se=Math.max(0,se+b),ee=Math.max(0,ee+v);else{se=a==="start"?A-K-ge:a==="end"?A-G+Se+ue:a==="nearest"?H5(K,G,B,ge,Se+ue,A,A+S,S):A-(K+B/2)+ue/2,ee=c==="start"?k-te-Q:c==="center"?k-(te+U/2)+Y/2:c==="end"?k-z+_e+Y:H5(te,z,U,Q,_e+Y,k,k+E,E);const{scrollLeft:le,scrollTop:he}=N;se=V===0?0:Math.max(0,Math.min(he+se/V,N.scrollHeight-B/V+ue)),ee=ye===0?0:Math.max(0,Math.min(le+ee/ye,N.scrollWidth-U/ye+Y)),A+=he-se,k+=le-ee}L.push({el:N,top:se,left:ee})}return L},wvt=n=>n===!1?{block:"end",inline:"nearest"}:(e=>e===Object(e)&&Object.keys(e).length!==0)(n)?n:{block:"start",inline:"nearest"};function Cvt(n,e){if(!n.isConnected||!(i=>{let o=i;for(;o&&o.parentNode;){if(o.parentNode===document)return!0;o=o.parentNode instanceof ShadowRoot?o.parentNode.host:o.parentNode}return!1})(n))return;const t=(i=>{const o=window.getComputedStyle(i);return{top:parseFloat(o.scrollMarginTop)||0,right:parseFloat(o.scrollMarginRight)||0,bottom:parseFloat(o.scrollMarginBottom)||0,left:parseFloat(o.scrollMarginLeft)||0}})(n);if((i=>typeof i=="object"&&typeof i.behavior=="function")(e))return e.behavior(Bme(n,e));const r=typeof e=="boolean"||e==null?void 0:e.behavior;for(const{el:i,top:o,left:s}of Bme(n,wvt(e))){const a=o-t.top+t.bottom,c=s-t.left+t.right;i.scroll({top:a,left:c,behavior:r})}}const Qc=n=>{const[,,,,e]=Gu();return e?`${n}-css-var`:""};var Bt={MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,QUESTION_MARK:63,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,WIN_IME:229,isTextModifyingKeyEvent:function(e){var t=e.keyCode;if(e.altKey&&!e.ctrlKey||e.metaKey||t>=Bt.F1&&t<=Bt.F12)return!1;switch(t){case Bt.ALT:case Bt.CAPS_LOCK:case Bt.CONTEXT_MENU:case Bt.CTRL:case Bt.DOWN:case Bt.END:case Bt.ESC:case Bt.HOME:case Bt.INSERT:case Bt.LEFT:case Bt.MAC_FF_META:case Bt.META:case Bt.NUMLOCK:case Bt.NUM_CENTER:case Bt.PAGE_DOWN:case Bt.PAGE_UP:case Bt.PAUSE:case Bt.PRINT_SCREEN:case Bt.RIGHT:case Bt.SHIFT:case Bt.UP:case Bt.WIN_KEY:case Bt.WIN_KEY_RIGHT:return!1;default:return!0}},isCharacterKey:function(e){if(e>=Bt.ZERO&&e<=Bt.NINE||e>=Bt.NUM_ZERO&&e<=Bt.NUM_MULTIPLY||e>=Bt.A&&e<=Bt.Z||window.navigator.userAgent.indexOf("WebKit")!==-1&&e===0)return!0;switch(e){case Bt.SPACE:case Bt.QUESTION_MARK:case Bt.NUM_PLUS:case Bt.NUM_MINUS:case Bt.NUM_PERIOD:case Bt.NUM_DIVISION:case Bt.SEMICOLON:case Bt.DASH:case Bt.EQUALS:case Bt.COMMA:case Bt.PERIOD:case Bt.SLASH:case Bt.APOSTROPHE:case Bt.SINGLE_QUOTE:case Bt.OPEN_SQUARE_BRACKET:case Bt.BACKSLASH:case Bt.CLOSE_SQUARE_BRACKET:return!0;default:return!1}}},ZAe=y.forwardRef(function(n,e){var t=n.prefixCls,r=n.style,i=n.className,o=n.duration,s=o===void 0?4.5:o,a=n.showProgress,c=n.pauseOnHover,l=c===void 0?!0:c,u=n.eventKey,d=n.content,h=n.closable,f=n.closeIcon,p=f===void 0?"x":f,g=n.props,m=n.onClick,v=n.onNoticeClose,b=n.times,S=n.hovering,E=y.useState(!1),w=rt(E,2),C=w[0],I=w[1],T=y.useState(0),D=rt(T,2),O=D[0],M=D[1],R=y.useState(0),A=rt(R,2),k=A[0],L=A[1],j=S||C,N=s>0&&a,B=function(){v(u)},U=function(Q){(Q.key==="Enter"||Q.code==="Enter"||Q.keyCode===Bt.ENTER)&&B()};y.useEffect(function(){if(!j&&s>0){var ie=Date.now()-k,Q=setTimeout(function(){B()},s*1e3-k);return function(){l&&clearTimeout(Q),L(Date.now()-ie)}}},[s,j,b]),y.useEffect(function(){if(!j&&N&&(l||k===0)){var ie=performance.now(),Q,ge=function _e(){cancelAnimationFrame(Q),Q=requestAnimationFrame(function(Se){var se=Se+k-ie,ee=Math.min(se/(s*1e3),1);M(ee*100),ee<1&&_e()})};return ge(),function(){l&&cancelAnimationFrame(Q)}}},[s,k,j,N,b]);var K=y.useMemo(function(){return Wn(h)==="object"&&h!==null?h:h?{closeIcon:p}:{}},[h,p]),z=pg(K,!0),G=100-(!O||O<0?0:O>100?100:O),te="".concat(t,"-notice");return y.createElement("div",ln({},g,{ref:e,className:Ue(te,i,Le({},"".concat(te,"-closable"),h)),style:r,onMouseEnter:function(Q){var ge;I(!0),g==null||(ge=g.onMouseEnter)===null||ge===void 0||ge.call(g,Q)},onMouseLeave:function(Q){var ge;I(!1),g==null||(ge=g.onMouseLeave)===null||ge===void 0||ge.call(g,Q)},onClick:m}),y.createElement("div",{className:"".concat(te,"-content")},d),h&&y.createElement("a",ln({tabIndex:0,className:"".concat(te,"-close"),onKeyDown:U,"aria-label":"Close"},z,{onClick:function(Q){Q.preventDefault(),Q.stopPropagation(),B()}}),K.closeIcon),N&&y.createElement("progress",{className:"".concat(te,"-progress"),max:"100",value:G},G+"%"))}),XAe=Ke.createContext({}),xvt=function(e){var t=e.children,r=e.classNames;return Ke.createElement(XAe.Provider,{value:{classNames:r}},t)},Hme=8,Ume=3,zme=16,Evt=function(e){var t={offset:Hme,threshold:Ume,gap:zme};if(e&&Wn(e)==="object"){var r,i,o;t.offset=(r=e.offset)!==null&&r!==void 0?r:Hme,t.threshold=(i=e.threshold)!==null&&i!==void 0?i:Ume,t.gap=(o=e.gap)!==null&&o!==void 0?o:zme}return[!!e,t]},Ivt=["className","style","classNames","styles"],Pvt=function(e){var t=e.configList,r=e.placement,i=e.prefixCls,o=e.className,s=e.style,a=e.motion,c=e.onAllNoticeRemoved,l=e.onNoticeClose,u=e.stack,d=y.useContext(XAe),h=d.classNames,f=y.useRef({}),p=y.useState(null),g=rt(p,2),m=g[0],v=g[1],b=y.useState([]),S=rt(b,2),E=S[0],w=S[1],C=t.map(function(j){return{config:j,key:String(j.key)}}),I=Evt(u),T=rt(I,2),D=T[0],O=T[1],M=O.offset,R=O.threshold,A=O.gap,k=D&&(E.length>0||C.length<=R),L=typeof a=="function"?a(r):a;return y.useEffect(function(){D&&E.length>1&&w(function(j){return j.filter(function(N){return C.some(function(B){var U=B.key;return N===U})})})},[E,C,D]),y.useEffect(function(){var j;if(D&&f.current[(j=C[C.length-1])===null||j===void 0?void 0:j.key]){var N;v(f.current[(N=C[C.length-1])===null||N===void 0?void 0:N.key])}},[C,D]),Ke.createElement(FAe,ln({key:r,className:Ue(i,"".concat(i,"-").concat(r),h==null?void 0:h.list,o,Le(Le({},"".concat(i,"-stack"),!!D),"".concat(i,"-stack-expanded"),k)),style:s,keys:C,motionAppear:!0},L,{onAllRemoved:function(){c(r)}}),function(j,N){var B=j.config,U=j.className,K=j.style,z=j.index,G=B,te=G.key,ie=G.times,Q=String(te),ge=B,_e=ge.className,Se=ge.style,se=ge.classNames,ee=ge.styles,Y=jr(ge,Ivt),ue=C.findIndex(function(Me){return Me.key===Q}),ye={};if(D){var V=C.length-1-(ue>-1?ue:z-1),le=r==="top"||r==="bottom"?"-50%":"0";if(V>0){var he,oe,ne;ye.height=k?(he=f.current[Q])===null||he===void 0?void 0:he.offsetHeight:m==null?void 0:m.offsetHeight;for(var ce=0,Ae=0;Ae<V;Ae++){var Ie;ce+=((Ie=f.current[C[C.length-1-Ae].key])===null||Ie===void 0?void 0:Ie.offsetHeight)+A}var be=(k?ce:V*M)*(r.startsWith("top")?1:-1),De=!k&&m!==null&&m!==void 0&&m.offsetWidth&&(oe=f.current[Q])!==null&&oe!==void 0&&oe.offsetWidth?((m==null?void 0:m.offsetWidth)-M*2*(V<3?V:3))/((ne=f.current[Q])===null||ne===void 0?void 0:ne.offsetWidth):1;ye.transform="translate3d(".concat(le,", ").concat(be,"px, 0) scaleX(").concat(De,")")}else ye.transform="translate3d(".concat(le,", 0, 0)")}return Ke.createElement("div",{ref:N,className:Ue("".concat(i,"-notice-wrapper"),U,se==null?void 0:se.wrapper),style:$e($e($e({},K),ye),ee==null?void 0:ee.wrapper),onMouseEnter:function(){return w(function(He){return He.includes(Q)?He:[].concat(Ht(He),[Q])})},onMouseLeave:function(){return w(function(He){return He.filter(function(Je){return Je!==Q})})}},Ke.createElement(ZAe,ln({},Y,{ref:function(He){ue>-1?f.current[Q]=He:delete f.current[Q]},prefixCls:i,classNames:se,styles:ee,className:Ue(_e,h==null?void 0:h.notice),style:Se,times:ie,key:te,eventKey:te,onNoticeClose:l,hovering:D&&E.length>0})))})},kvt=y.forwardRef(function(n,e){var t=n.prefixCls,r=t===void 0?"rc-notification":t,i=n.container,o=n.motion,s=n.maxCount,a=n.className,c=n.style,l=n.onAllRemoved,u=n.stack,d=n.renderNotifications,h=y.useState([]),f=rt(h,2),p=f[0],g=f[1],m=function(D){var O,M=p.find(function(R){return R.key===D});M==null||(O=M.onClose)===null||O===void 0||O.call(M),g(function(R){return R.filter(function(A){return A.key!==D})})};y.useImperativeHandle(e,function(){return{open:function(D){g(function(O){var M=Ht(O),R=M.findIndex(function(L){return L.key===D.key}),A=$e({},D);if(R>=0){var k;A.times=(((k=O[R])===null||k===void 0?void 0:k.times)||0)+1,M[R]=A}else A.times=0,M.push(A);return s>0&&M.length>s&&(M=M.slice(-s)),M})},close:function(D){m(D)},destroy:function(){g([])}}});var v=y.useState({}),b=rt(v,2),S=b[0],E=b[1];y.useEffect(function(){var T={};p.forEach(function(D){var O=D.placement,M=O===void 0?"topRight":O;M&&(T[M]=T[M]||[],T[M].push(D))}),Object.keys(S).forEach(function(D){T[D]=T[D]||[]}),E(T)},[p]);var w=function(D){E(function(O){var M=$e({},O),R=M[D]||[];return R.length||delete M[D],M})},C=y.useRef(!1);if(y.useEffect(function(){Object.keys(S).length>0?C.current=!0:C.current&&(l==null||l(),C.current=!1)},[S]),!i)return null;var I=Object.keys(S);return Wu.createPortal(y.createElement(y.Fragment,null,I.map(function(T){var D=S[T],O=y.createElement(Pvt,{key:T,configList:D,placement:T,prefixCls:r,className:a==null?void 0:a(T),style:c==null?void 0:c(T),motion:o,onNoticeClose:m,onAllNoticeRemoved:w,stack:u});return d?d(O,{prefixCls:r,key:T}):O})),i)}),Tvt=["getContainer","motion","prefixCls","maxCount","className","style","onAllRemoved","stack","renderNotifications"],Dvt=function(){return document.body},Vme=0;function Rvt(){for(var n={},e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.forEach(function(i){i&&Object.keys(i).forEach(function(o){var s=i[o];s!==void 0&&(n[o]=s)})}),n}function Avt(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=n.getContainer,t=e===void 0?Dvt:e,r=n.motion,i=n.prefixCls,o=n.maxCount,s=n.className,a=n.style,c=n.onAllRemoved,l=n.stack,u=n.renderNotifications,d=jr(n,Tvt),h=y.useState(),f=rt(h,2),p=f[0],g=f[1],m=y.useRef(),v=y.createElement(kvt,{container:p,ref:m,prefixCls:i,motion:r,maxCount:o,className:s,style:a,onAllRemoved:c,stack:l,renderNotifications:u}),b=y.useState([]),S=rt(b,2),E=S[0],w=S[1],C=y.useMemo(function(){return{open:function(T){var D=Rvt(d,T);(D.key===null||D.key===void 0)&&(D.key="rc-notification-".concat(Vme),Vme+=1),w(function(O){return[].concat(Ht(O),[{type:"open",config:D}])})},close:function(T){w(function(D){return[].concat(Ht(D),[{type:"close",key:T}])})},destroy:function(){w(function(T){return[].concat(Ht(T),[{type:"destroy"}])})}}},[]);return y.useEffect(function(){g(t())}),y.useEffect(function(){m.current&&E.length&&(E.forEach(function(I){switch(I.type){case"open":m.current.open(I.config);break;case"close":m.current.close(I.key);break;case"destroy":m.current.destroy();break}}),w(function(I){return I.filter(function(T){return!E.includes(T)})}))},[E]),[C,v]}var Ovt={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M988 548c-19.9 0-36-16.1-36-36 0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 00-94.3-139.9 437.71 437.71 0 00-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.3C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3.1 19.9-16 36-35.9 36z"}}]},name:"loading",theme:"outlined"},Mvt=function(e,t){return y.createElement(_a,ln({},e,{ref:t,icon:Ovt}))},q7=y.forwardRef(Mvt);const K7=Ke.createContext(void 0),Yb=100,$vt=10,YAe=Yb*$vt,JAe={Modal:Yb,Drawer:Yb,Popover:Yb,Popconfirm:Yb,Tooltip:Yb,Tour:Yb},Lvt={SelectLike:50,Dropdown:50,DatePicker:50,Menu:50,ImagePreview:1};function Nvt(n){return n in JAe}function pD(n,e){const[,t]=Gu(),r=Ke.useContext(K7),i=Nvt(n);let o;if(e!==void 0)o=[e,e];else{let s=r??0;i?s+=(r?0:t.zIndexPopupBase)+JAe[n]:s+=Lvt[n],o=[r===void 0?e:s,s]}return o}const Fvt=n=>{const{componentCls:e,iconCls:t,boxShadow:r,colorText:i,colorSuccess:o,colorError:s,colorWarning:a,colorInfo:c,fontSizeLG:l,motionEaseInOutCirc:u,motionDurationSlow:d,marginXS:h,paddingXS:f,borderRadiusLG:p,zIndexPopup:g,contentPadding:m,contentBg:v}=n,b=`${e}-notice`,S=new Oi("MessageMoveIn",{"0%":{padding:0,transform:"translateY(-100%)",opacity:0},"100%":{padding:f,transform:"translateY(0)",opacity:1}}),E=new Oi("MessageMoveOut",{"0%":{maxHeight:n.height,padding:f,opacity:1},"100%":{maxHeight:0,padding:0,opacity:0}}),w={padding:f,textAlign:"center",[`${e}-custom-content`]:{display:"flex",alignItems:"center"},[`${e}-custom-content > ${t}`]:{marginInlineEnd:h,fontSize:l},[`${b}-content`]:{display:"inline-block",padding:m,background:v,borderRadius:p,boxShadow:r,pointerEvents:"all"},[`${e}-success > ${t}`]:{color:o},[`${e}-error > ${t}`]:{color:s},[`${e}-warning > ${t}`]:{color:a},[`${e}-info > ${t},
      ${e}-loading > ${t}`]:{color:c}};return[{[e]:Object.assign(Object.assign({},gc(n)),{color:i,position:"fixed",top:h,width:"100%",pointerEvents:"none",zIndex:g,[`${e}-move-up`]:{animationFillMode:"forwards"},[`
        ${e}-move-up-appear,
        ${e}-move-up-enter
      `]:{animationName:S,animationDuration:d,animationPlayState:"paused",animationTimingFunction:u},[`
        ${e}-move-up-appear${e}-move-up-appear-active,
        ${e}-move-up-enter${e}-move-up-enter-active
      `]:{animationPlayState:"running"},[`${e}-move-up-leave`]:{animationName:E,animationDuration:d,animationPlayState:"paused",animationTimingFunction:u},[`${e}-move-up-leave${e}-move-up-leave-active`]:{animationPlayState:"running"},"&-rtl":{direction:"rtl",span:{direction:"rtl"}}})},{[e]:{[`${b}-wrapper`]:Object.assign({},w)}},{[`${e}-notice-pure-panel`]:Object.assign(Object.assign({},w),{padding:0,textAlign:"start"})}]},jvt=n=>({zIndexPopup:n.zIndexPopupBase+YAe+10,contentBg:n.colorBgElevated,contentPadding:`${(n.controlHeightLG-n.fontSize*n.lineHeight)/2}px ${n.paddingSM}px`}),QAe=Jc("Message",n=>{const e=oo(n,{height:150});return[Fvt(e)]},jvt);var Bvt=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t};const Hvt={info:y.createElement(KAe,null),success:y.createElement(jne,null),error:y.createElement(hD,null),warning:y.createElement(Bne,null),loading:y.createElement(q7,null)},e4e=n=>{let{prefixCls:e,type:t,icon:r,children:i}=n;return y.createElement("div",{className:Ue(`${e}-custom-content`,`${e}-${t}`)},r||Hvt[t],y.createElement("span",null,i))},Uvt=n=>{const{prefixCls:e,className:t,type:r,icon:i,content:o}=n,s=Bvt(n,["prefixCls","className","type","icon","content"]),{getPrefixCls:a}=y.useContext(fr),c=e||a("message"),l=Qc(c),[u,d,h]=QAe(c,l);return u(y.createElement(ZAe,Object.assign({},s,{prefixCls:c,className:Ue(t,d,`${c}-notice-pure-panel`,h,l),eventKey:"pure",duration:null,content:y.createElement(e4e,{prefixCls:c,type:r,icon:i},o)})))};function zvt(n,e){return{motionName:e??`${n}-move-up`}}function Hne(n){let e;const t=new Promise(i=>{e=n(()=>{i(!0)})}),r=()=>{e==null||e()};return r.then=(i,o)=>t.then(i,o),r.promise=t,r}var Vvt=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t};const Wvt=8,qvt=3,Kvt=n=>{let{children:e,prefixCls:t}=n;const r=Qc(t),[i,o,s]=QAe(t,r);return i(y.createElement(xvt,{classNames:{list:Ue(o,s,r)}},e))},Gvt=(n,e)=>{let{prefixCls:t,key:r}=e;return y.createElement(Kvt,{prefixCls:t,key:r},n)},Zvt=y.forwardRef((n,e)=>{const{top:t,prefixCls:r,getContainer:i,maxCount:o,duration:s=qvt,rtl:a,transitionName:c,onAllRemoved:l}=n,{getPrefixCls:u,getPopupContainer:d,message:h,direction:f}=y.useContext(fr),p=r||u("message"),g=()=>({left:"50%",transform:"translateX(-50%)",top:t??Wvt}),m=()=>Ue({[`${p}-rtl`]:a??f==="rtl"}),v=()=>zvt(p,c),b=y.createElement("span",{className:`${p}-close-x`},y.createElement(fD,{className:`${p}-close-icon`})),[S,E]=Avt({prefixCls:p,style:g,className:m,motion:v,closable:!1,closeIcon:b,duration:s,getContainer:()=>(i==null?void 0:i())||(d==null?void 0:d())||document.body,maxCount:o,onAllRemoved:l,renderNotifications:Gvt});return y.useImperativeHandle(e,()=>Object.assign(Object.assign({},S),{prefixCls:p,message:h})),E});let Wme=0;function t4e(n){const e=y.useRef(null);return lD(),[y.useMemo(()=>{const r=c=>{var l;(l=e.current)===null||l===void 0||l.close(c)},i=c=>{if(!e.current){const C=()=>{};return C.then=()=>{},C}const{open:l,prefixCls:u,message:d}=e.current,h=`${u}-notice`,{content:f,icon:p,type:g,key:m,className:v,style:b,onClose:S}=c,E=Vvt(c,["content","icon","type","key","className","style","onClose"]);let w=m;return w==null&&(Wme+=1,w=`antd-message-${Wme}`),Hne(C=>(l(Object.assign(Object.assign({},E),{key:w,content:y.createElement(e4e,{prefixCls:u,type:g,icon:p},f),placement:"top",className:Ue(g&&`${h}-${g}`,v,d==null?void 0:d.className),style:Object.assign(Object.assign({},d==null?void 0:d.style),b),onClose:()=>{S==null||S(),C()}})),()=>{r(w)}))},s={open:i,destroy:c=>{var l;c!==void 0?r(c):(l=e.current)===null||l===void 0||l.destroy()}};return["info","success","warning","error","loading"].forEach(c=>{const l=(u,d,h)=>{let f;u&&typeof u=="object"&&"content"in u?f=u:f={content:u};let p,g;typeof d=="function"?g=d:(p=d,g=h);const m=Object.assign(Object.assign({onClose:g,duration:p},f),{type:c});return i(m)};s[c]=l}),s},[]),y.createElement(Zvt,Object.assign({key:"message-holder"},n,{ref:e}))]}function Xvt(n){return t4e(n)}function Yvt(){const[n,e]=y.useState([]),t=y.useCallback(r=>(e(i=>[].concat(Ht(i),[r])),()=>{e(i=>i.filter(o=>o!==r))}),[]);return[n,t]}function tu(){tu=function(){return e};var n,e={},t=Object.prototype,r=t.hasOwnProperty,i=Object.defineProperty||function(j,N,B){j[N]=B.value},o=typeof Symbol=="function"?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function l(j,N,B){return Object.defineProperty(j,N,{value:B,enumerable:!0,configurable:!0,writable:!0}),j[N]}try{l({},"")}catch{l=function(B,U,K){return B[U]=K}}function u(j,N,B,U){var K=N&&N.prototype instanceof v?N:v,z=Object.create(K.prototype),G=new k(U||[]);return i(z,"_invoke",{value:O(j,B,G)}),z}function d(j,N,B){try{return{type:"normal",arg:j.call(N,B)}}catch(U){return{type:"throw",arg:U}}}e.wrap=u;var h="suspendedStart",f="suspendedYield",p="executing",g="completed",m={};function v(){}function b(){}function S(){}var E={};l(E,s,function(){return this});var w=Object.getPrototypeOf,C=w&&w(w(L([])));C&&C!==t&&r.call(C,s)&&(E=C);var I=S.prototype=v.prototype=Object.create(E);function T(j){["next","throw","return"].forEach(function(N){l(j,N,function(B){return this._invoke(N,B)})})}function D(j,N){function B(K,z,G,te){var ie=d(j[K],j,z);if(ie.type!=="throw"){var Q=ie.arg,ge=Q.value;return ge&&Wn(ge)=="object"&&r.call(ge,"__await")?N.resolve(ge.__await).then(function(_e){B("next",_e,G,te)},function(_e){B("throw",_e,G,te)}):N.resolve(ge).then(function(_e){Q.value=_e,G(Q)},function(_e){return B("throw",_e,G,te)})}te(ie.arg)}var U;i(this,"_invoke",{value:function(z,G){function te(){return new N(function(ie,Q){B(z,G,ie,Q)})}return U=U?U.then(te,te):te()}})}function O(j,N,B){var U=h;return function(K,z){if(U===p)throw Error("Generator is already running");if(U===g){if(K==="throw")throw z;return{value:n,done:!0}}for(B.method=K,B.arg=z;;){var G=B.delegate;if(G){var te=M(G,B);if(te){if(te===m)continue;return te}}if(B.method==="next")B.sent=B._sent=B.arg;else if(B.method==="throw"){if(U===h)throw U=g,B.arg;B.dispatchException(B.arg)}else B.method==="return"&&B.abrupt("return",B.arg);U=p;var ie=d(j,N,B);if(ie.type==="normal"){if(U=B.done?g:f,ie.arg===m)continue;return{value:ie.arg,done:B.done}}ie.type==="throw"&&(U=g,B.method="throw",B.arg=ie.arg)}}}function M(j,N){var B=N.method,U=j.iterator[B];if(U===n)return N.delegate=null,B==="throw"&&j.iterator.return&&(N.method="return",N.arg=n,M(j,N),N.method==="throw")||B!=="return"&&(N.method="throw",N.arg=new TypeError("The iterator does not provide a '"+B+"' method")),m;var K=d(U,j.iterator,N.arg);if(K.type==="throw")return N.method="throw",N.arg=K.arg,N.delegate=null,m;var z=K.arg;return z?z.done?(N[j.resultName]=z.value,N.next=j.nextLoc,N.method!=="return"&&(N.method="next",N.arg=n),N.delegate=null,m):z:(N.method="throw",N.arg=new TypeError("iterator result is not an object"),N.delegate=null,m)}function R(j){var N={tryLoc:j[0]};1 in j&&(N.catchLoc=j[1]),2 in j&&(N.finallyLoc=j[2],N.afterLoc=j[3]),this.tryEntries.push(N)}function A(j){var N=j.completion||{};N.type="normal",delete N.arg,j.completion=N}function k(j){this.tryEntries=[{tryLoc:"root"}],j.forEach(R,this),this.reset(!0)}function L(j){if(j||j===""){var N=j[s];if(N)return N.call(j);if(typeof j.next=="function")return j;if(!isNaN(j.length)){var B=-1,U=function K(){for(;++B<j.length;)if(r.call(j,B))return K.value=j[B],K.done=!1,K;return K.value=n,K.done=!0,K};return U.next=U}}throw new TypeError(Wn(j)+" is not iterable")}return b.prototype=S,i(I,"constructor",{value:S,configurable:!0}),i(S,"constructor",{value:b,configurable:!0}),b.displayName=l(S,c,"GeneratorFunction"),e.isGeneratorFunction=function(j){var N=typeof j=="function"&&j.constructor;return!!N&&(N===b||(N.displayName||N.name)==="GeneratorFunction")},e.mark=function(j){return Object.setPrototypeOf?Object.setPrototypeOf(j,S):(j.__proto__=S,l(j,c,"GeneratorFunction")),j.prototype=Object.create(I),j},e.awrap=function(j){return{__await:j}},T(D.prototype),l(D.prototype,a,function(){return this}),e.AsyncIterator=D,e.async=function(j,N,B,U,K){K===void 0&&(K=Promise);var z=new D(u(j,N,B,U),K);return e.isGeneratorFunction(N)?z:z.next().then(function(G){return G.done?G.value:z.next()})},T(I),l(I,c,"Generator"),l(I,s,function(){return this}),l(I,"toString",function(){return"[object Generator]"}),e.keys=function(j){var N=Object(j),B=[];for(var U in N)B.push(U);return B.reverse(),function K(){for(;B.length;){var z=B.pop();if(z in N)return K.value=z,K.done=!1,K}return K.done=!0,K}},e.values=L,k.prototype={constructor:k,reset:function(N){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(A),!N)for(var B in this)B.charAt(0)==="t"&&r.call(this,B)&&!isNaN(+B.slice(1))&&(this[B]=n)},stop:function(){this.done=!0;var N=this.tryEntries[0].completion;if(N.type==="throw")throw N.arg;return this.rval},dispatchException:function(N){if(this.done)throw N;var B=this;function U(Q,ge){return G.type="throw",G.arg=N,B.next=Q,ge&&(B.method="next",B.arg=n),!!ge}for(var K=this.tryEntries.length-1;K>=0;--K){var z=this.tryEntries[K],G=z.completion;if(z.tryLoc==="root")return U("end");if(z.tryLoc<=this.prev){var te=r.call(z,"catchLoc"),ie=r.call(z,"finallyLoc");if(te&&ie){if(this.prev<z.catchLoc)return U(z.catchLoc,!0);if(this.prev<z.finallyLoc)return U(z.finallyLoc)}else if(te){if(this.prev<z.catchLoc)return U(z.catchLoc,!0)}else{if(!ie)throw Error("try statement without catch or finally");if(this.prev<z.finallyLoc)return U(z.finallyLoc)}}}},abrupt:function(N,B){for(var U=this.tryEntries.length-1;U>=0;--U){var K=this.tryEntries[U];if(K.tryLoc<=this.prev&&r.call(K,"finallyLoc")&&this.prev<K.finallyLoc){var z=K;break}}z&&(N==="break"||N==="continue")&&z.tryLoc<=B&&B<=z.finallyLoc&&(z=null);var G=z?z.completion:{};return G.type=N,G.arg=B,z?(this.method="next",this.next=z.finallyLoc,m):this.complete(G)},complete:function(N,B){if(N.type==="throw")throw N.arg;return N.type==="break"||N.type==="continue"?this.next=N.arg:N.type==="return"?(this.rval=this.arg=N.arg,this.method="return",this.next="end"):N.type==="normal"&&B&&(this.next=B),m},finish:function(N){for(var B=this.tryEntries.length-1;B>=0;--B){var U=this.tryEntries[B];if(U.finallyLoc===N)return this.complete(U.completion,U.afterLoc),A(U),m}},catch:function(N){for(var B=this.tryEntries.length-1;B>=0;--B){var U=this.tryEntries[B];if(U.tryLoc===N){var K=U.completion;if(K.type==="throw"){var z=K.arg;A(U)}return z}}throw Error("illegal catch attempt")},delegateYield:function(N,B,U){return this.delegate={iterator:L(N),resultName:B,nextLoc:U},this.method==="next"&&(this.arg=n),m}},e}function qme(n,e,t,r,i,o,s){try{var a=n[o](s),c=a.value}catch(l){return void t(l)}a.done?e(c):Promise.resolve(c).then(r,i)}function d_(n){return function(){var e=this,t=arguments;return new Promise(function(r,i){var o=n.apply(e,t);function s(c){qme(o,r,i,s,a,"next",c)}function a(c){qme(o,r,i,s,a,"throw",c)}s(void 0)})}}var gD=$e({},hZe),Jvt=gD.version,Qvt=gD.render,e0t=gD.unmountComponentAtNode,G7;try{var t0t=Number((Jvt||"").split(".")[0]);t0t>=18&&(G7=gD.createRoot)}catch{}function Kme(n){var e=gD.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;e&&Wn(e)==="object"&&(e.usingClientEntryPoint=n)}var C8="__rc_react_root__";function n0t(n,e){Kme(!0);var t=e[C8]||G7(e);Kme(!1),t.render(n),e[C8]=t}function r0t(n,e){Qvt(n,e)}function Une(n,e){if(G7){n0t(n,e);return}r0t(n,e)}function i0t(n){return JG.apply(this,arguments)}function JG(){return JG=d_(tu().mark(function n(e){return tu().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",Promise.resolve().then(function(){var i;(i=e[C8])===null||i===void 0||i.unmount(),delete e[C8]}));case 1:case"end":return r.stop()}},n)})),JG.apply(this,arguments)}function o0t(n){e0t(n)}function n4e(n){return QG.apply(this,arguments)}function QG(){return QG=d_(tu().mark(function n(e){return tu().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(G7===void 0){r.next=2;break}return r.abrupt("return",i0t(e));case 2:o0t(e);case 3:case"end":return r.stop()}},n)})),QG.apply(this,arguments)}const xH=()=>({height:0,opacity:0}),Gme=n=>{const{scrollHeight:e}=n;return{height:e,opacity:1}},s0t=n=>({height:n?n.offsetHeight:0}),EH=(n,e)=>(e==null?void 0:e.deadline)===!0||e.propertyName==="height",eZ=function(){return{motionName:`${arguments.length>0&&arguments[0]!==void 0?arguments[0]:E3}-motion-collapse`,onAppearStart:xH,onEnterStart:xH,onAppearActive:Gme,onEnterActive:Gme,onLeaveStart:s0t,onLeaveActive:xH,onAppearEnd:EH,onEnterEnd:EH,onLeaveEnd:EH,motionDeadline:500}},J2=(n,e,t)=>t!==void 0?t:`${n}-${e}`,Z7=function(n){if(!n)return!1;if(n instanceof Element){if(n.offsetParent)return!0;if(n.getBBox){var e=n.getBBox(),t=e.width,r=e.height;if(t||r)return!0}if(n.getBoundingClientRect){var i=n.getBoundingClientRect(),o=i.width,s=i.height;if(o||s)return!0}}return!1},a0t=n=>{const{componentCls:e,colorPrimary:t}=n;return{[e]:{position:"absolute",background:"transparent",pointerEvents:"none",boxSizing:"border-box",color:`var(--wave-color, ${t})`,boxShadow:"0 0 0 0 currentcolor",opacity:.2,"&.wave-motion-appear":{transition:[`box-shadow 0.4s ${n.motionEaseOutCirc}`,`opacity 2s ${n.motionEaseOutCirc}`].join(","),"&-active":{boxShadow:"0 0 0 6px currentcolor",opacity:0},"&.wave-quick":{transition:[`box-shadow ${n.motionDurationSlow} ${n.motionEaseInOut}`,`opacity ${n.motionDurationSlow} ${n.motionEaseInOut}`].join(",")}}}}},c0t=gmt("Wave",n=>[a0t(n)]),X7=`${E3}-wave-target`;function l0t(n){const e=(n||"").match(/rgba?\((\d*), (\d*), (\d*)(, [\d.]*)?\)/);return e&&e[1]&&e[2]&&e[3]?!(e[1]===e[2]&&e[2]===e[3]):!0}function IH(n){return n&&n!=="#fff"&&n!=="#ffffff"&&n!=="rgb(255, 255, 255)"&&n!=="rgba(255, 255, 255, 1)"&&l0t(n)&&!/rgba\((?:\d*, ){3}0\)/.test(n)&&n!=="transparent"}function u0t(n){const{borderTopColor:e,borderColor:t,backgroundColor:r}=getComputedStyle(n);return IH(e)?e:IH(t)?t:IH(r)?r:null}function PH(n){return Number.isNaN(n)?0:n}const d0t=n=>{const{className:e,target:t,component:r}=n,i=y.useRef(null),[o,s]=y.useState(null),[a,c]=y.useState([]),[l,u]=y.useState(0),[d,h]=y.useState(0),[f,p]=y.useState(0),[g,m]=y.useState(0),[v,b]=y.useState(!1),S={left:l,top:d,width:f,height:g,borderRadius:a.map(C=>`${C}px`).join(" ")};o&&(S["--wave-color"]=o);function E(){const C=getComputedStyle(t);s(u0t(t));const I=C.position==="static",{borderLeftWidth:T,borderTopWidth:D}=C;u(I?t.offsetLeft:PH(-parseFloat(T))),h(I?t.offsetTop:PH(-parseFloat(D))),p(t.offsetWidth),m(t.offsetHeight);const{borderTopLeftRadius:O,borderTopRightRadius:M,borderBottomLeftRadius:R,borderBottomRightRadius:A}=C;c([O,M,A,R].map(k=>PH(parseFloat(k))))}if(y.useEffect(()=>{if(t){const C=no(()=>{E(),b(!0)});let I;return typeof ResizeObserver<"u"&&(I=new ResizeObserver(E),I.observe(t)),()=>{no.cancel(C),I==null||I.disconnect()}}},[]),!v)return null;const w=(r==="Checkbox"||r==="Radio")&&(t==null?void 0:t.classList.contains(X7));return y.createElement(bv,{visible:!0,motionAppear:!0,motionName:"wave-motion",motionDeadline:5e3,onAppearEnd:(C,I)=>{var T;if(I.deadline||I.propertyName==="opacity"){const D=(T=i.current)===null||T===void 0?void 0:T.parentElement;n4e(D).then(()=>{D==null||D.remove()})}return!1}},(C,I)=>{let{className:T}=C;return y.createElement("div",{ref:Gd(i,I),className:Ue(e,T,{"wave-quick":w}),style:S})})},h0t=(n,e)=>{var t;const{component:r}=e;if(r==="Checkbox"&&!(!((t=n.querySelector("input"))===null||t===void 0)&&t.checked))return;const i=document.createElement("div");i.style.position="absolute",i.style.left="0px",i.style.top="0px",n==null||n.insertBefore(i,n==null?void 0:n.firstChild),Une(y.createElement(d0t,Object.assign({},e,{target:n})),i)},f0t=(n,e,t)=>{const{wave:r}=y.useContext(fr),[,i,o]=Gu(),s=ea(l=>{const u=n.current;if(r!=null&&r.disabled||!u)return;const d=u.querySelector(`.${X7}`)||u,{showEffect:h}=r||{};(h||h0t)(d,{className:e,token:i,component:t,event:l,hashId:o})}),a=y.useRef();return l=>{no.cancel(a.current),a.current=no(()=>{s(l)})}},zne=n=>{const{children:e,disabled:t,component:r}=n,{getPrefixCls:i}=y.useContext(fr),o=y.useRef(null),s=i("wave"),[,a]=c0t(s),c=f0t(o,Ue(s,a),r);if(Ke.useEffect(()=>{const u=o.current;if(!u||u.nodeType!==1||t)return;const d=h=>{!Z7(h.target)||!u.getAttribute||u.getAttribute("disabled")||u.disabled||u.className.includes("disabled")||u.className.includes("-leave")||c(h)};return u.addEventListener("click",d,!0),()=>{u.removeEventListener("click",d,!0)}},[t]),!Ke.isValidElement(e))return e??null;const l=yv(e)?Gd(e.ref,o):o;return gg(e,{ref:l})},_v=n=>{const e=Ke.useContext(MS);return Ke.useMemo(()=>n?typeof n=="string"?n??e:n instanceof Function?n(e):e:e,[n,e])},p0t=n=>{const{componentCls:e}=n;return{[e]:{"&-block":{display:"flex",width:"100%"},"&-vertical":{flexDirection:"column"}}}},g0t=n=>{const{componentCls:e,antCls:t}=n;return{[e]:{display:"inline-flex","&-rtl":{direction:"rtl"},"&-vertical":{flexDirection:"column"},"&-align":{flexDirection:"column","&-center":{alignItems:"center"},"&-start":{alignItems:"flex-start"},"&-end":{alignItems:"flex-end"},"&-baseline":{alignItems:"baseline"}},[`${e}-item:empty`]:{display:"none"},[`${e}-item > ${t}-badge-not-a-wrapper:only-child`]:{display:"block"}}}},m0t=n=>{const{componentCls:e}=n;return{[e]:{"&-gap-row-small":{rowGap:n.spaceGapSmallSize},"&-gap-row-middle":{rowGap:n.spaceGapMiddleSize},"&-gap-row-large":{rowGap:n.spaceGapLargeSize},"&-gap-col-small":{columnGap:n.spaceGapSmallSize},"&-gap-col-middle":{columnGap:n.spaceGapMiddleSize},"&-gap-col-large":{columnGap:n.spaceGapLargeSize}}}},r4e=Jc("Space",n=>{const e=oo(n,{spaceGapSmallSize:n.paddingXS,spaceGapMiddleSize:n.padding,spaceGapLargeSize:n.paddingLG});return[g0t(e),m0t(e),p0t(e)]},()=>({}),{resetStyle:!1});var i4e=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t};const Y7=y.createContext(null),mD=(n,e)=>{const t=y.useContext(Y7),r=y.useMemo(()=>{if(!t)return"";const{compactDirection:i,isFirstItem:o,isLastItem:s}=t,a=i==="vertical"?"-vertical-":"-";return Ue(`${n}-compact${a}item`,{[`${n}-compact${a}first-item`]:o,[`${n}-compact${a}last-item`]:s,[`${n}-compact${a}item-rtl`]:e==="rtl"})},[n,e,t]);return{compactSize:t==null?void 0:t.compactSize,compactDirection:t==null?void 0:t.compactDirection,compactItemClassnames:r}},v0t=n=>{let{children:e}=n;return y.createElement(Y7.Provider,{value:null},e)},y0t=n=>{var{children:e}=n,t=i4e(n,["children"]);return y.createElement(Y7.Provider,{value:t},e)},b0t=n=>{const{getPrefixCls:e,direction:t}=y.useContext(fr),{size:r,direction:i,block:o,prefixCls:s,className:a,rootClassName:c,children:l}=n,u=i4e(n,["size","direction","block","prefixCls","className","rootClassName","children"]),d=_v(S=>r??S),h=e("space-compact",s),[f,p]=r4e(h),g=Ue(h,p,{[`${h}-rtl`]:t==="rtl",[`${h}-block`]:o,[`${h}-vertical`]:i==="vertical"},a,c),m=y.useContext(Y7),v=hg(l),b=y.useMemo(()=>v.map((S,E)=>{const w=(S==null?void 0:S.key)||`${h}-item-${E}`;return y.createElement(y0t,{key:w,compactSize:d,compactDirection:i,isFirstItem:E===0&&(!m||(m==null?void 0:m.isFirstItem)),isLastItem:E===v.length-1&&(!m||(m==null?void 0:m.isLastItem))},S)}),[r,v,m]);return v.length===0?null:f(y.createElement("div",Object.assign({className:g},u),b))};var S0t=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t};const o4e=y.createContext(void 0),_0t=n=>{const{getPrefixCls:e,direction:t}=y.useContext(fr),{prefixCls:r,size:i,className:o}=n,s=S0t(n,["prefixCls","size","className"]),a=e("btn-group",r),[,,c]=Gu();let l="";switch(i){case"large":l="lg";break;case"small":l="sm";break}const u=Ue(a,{[`${a}-${l}`]:l,[`${a}-rtl`]:t==="rtl"},o,c);return y.createElement(o4e.Provider,{value:i},y.createElement("div",Object.assign({},s,{className:u})))},Zme=/^[\u4e00-\u9fa5]{2}$/,tZ=Zme.test.bind(Zme);function s4e(n){return n==="danger"?{danger:!0}:{type:n}}function Xme(n){return typeof n=="string"}function kH(n){return n==="text"||n==="link"}function w0t(n,e){if(n==null)return;const t=e?" ":"";return typeof n!="string"&&typeof n!="number"&&Xme(n.type)&&tZ(n.props.children)?gg(n,{children:n.props.children.split("").join(t)}):Xme(n)?tZ(n)?Ke.createElement("span",null,n.split("").join(t)):Ke.createElement("span",null,n):GAe(n)?Ke.createElement("span",null,n):n}function C0t(n,e){let t=!1;const r=[];return Ke.Children.forEach(n,i=>{const o=typeof i,s=o==="string"||o==="number";if(t&&s){const a=r.length-1,c=r[a];r[a]=`${c}${i}`}else r.push(i);t=s}),Ke.Children.map(r,i=>w0t(i,e))}const a4e=y.forwardRef((n,e)=>{const{className:t,style:r,children:i,prefixCls:o}=n,s=Ue(`${o}-icon`,t);return Ke.createElement("span",{ref:e,className:s,style:r},i)}),Yme=y.forwardRef((n,e)=>{const{prefixCls:t,className:r,style:i,iconClassName:o}=n,s=Ue(`${t}-loading-icon`,r);return Ke.createElement(a4e,{prefixCls:t,className:s,style:i,ref:e},Ke.createElement(q7,{className:o}))}),TH=()=>({width:0,opacity:0,transform:"scale(0)"}),DH=n=>({width:n.scrollWidth,opacity:1,transform:"scale(1)"}),x0t=n=>{const{prefixCls:e,loading:t,existIcon:r,className:i,style:o}=n,s=!!t;return r?Ke.createElement(Yme,{prefixCls:e,className:i,style:o}):Ke.createElement(bv,{visible:s,motionName:`${e}-loading-icon-motion`,motionLeave:s,removeOnLeave:!0,onAppearStart:TH,onAppearActive:DH,onEnterStart:TH,onEnterActive:DH,onLeaveStart:DH,onLeaveActive:TH},(a,c)=>{let{className:l,style:u}=a;return Ke.createElement(Yme,{prefixCls:e,className:i,style:Object.assign(Object.assign({},o),u),ref:c,iconClassName:l})})},Jme=(n,e)=>({[`> span, > ${n}`]:{"&:not(:last-child)":{[`&, & > ${n}`]:{"&:not(:disabled)":{borderInlineEndColor:e}}},"&:not(:first-child)":{[`&, & > ${n}`]:{"&:not(:disabled)":{borderInlineStartColor:e}}}}}),E0t=n=>{const{componentCls:e,fontSize:t,lineWidth:r,groupBorderColor:i,colorErrorHover:o}=n;return{[`${e}-group`]:[{position:"relative",display:"inline-flex",[`> span, > ${e}`]:{"&:not(:last-child)":{[`&, & > ${e}`]:{borderStartEndRadius:0,borderEndEndRadius:0}},"&:not(:first-child)":{marginInlineStart:n.calc(r).mul(-1).equal(),[`&, & > ${e}`]:{borderStartStartRadius:0,borderEndStartRadius:0}}},[e]:{position:"relative",zIndex:1,"&:hover, &:focus, &:active":{zIndex:2},"&[disabled]":{zIndex:0}},[`${e}-icon-only`]:{fontSize:t}},Jme(`${e}-primary`,i),Jme(`${e}-danger`,o)]}},c4e=n=>{const{paddingInline:e,onlyIconSize:t,paddingBlock:r}=n;return oo(n,{buttonPaddingHorizontal:e,buttonPaddingVertical:r,buttonIconOnlyFontSize:t})},l4e=n=>{var e,t,r,i,o,s;const a=(e=n.contentFontSize)!==null&&e!==void 0?e:n.fontSize,c=(t=n.contentFontSizeSM)!==null&&t!==void 0?t:n.fontSize,l=(r=n.contentFontSizeLG)!==null&&r!==void 0?r:n.fontSizeLG,u=(i=n.contentLineHeight)!==null&&i!==void 0?i:cO(a),d=(o=n.contentLineHeightSM)!==null&&o!==void 0?o:cO(c),h=(s=n.contentLineHeightLG)!==null&&s!==void 0?s:cO(l);return{fontWeight:400,defaultShadow:`0 ${n.controlOutlineWidth}px 0 ${n.controlTmpOutline}`,primaryShadow:`0 ${n.controlOutlineWidth}px 0 ${n.controlOutline}`,dangerShadow:`0 ${n.controlOutlineWidth}px 0 ${n.colorErrorOutline}`,primaryColor:n.colorTextLightSolid,dangerColor:n.colorTextLightSolid,borderColorDisabled:n.colorBorder,defaultGhostColor:n.colorBgContainer,ghostBg:"transparent",defaultGhostBorderColor:n.colorBgContainer,paddingInline:n.paddingContentHorizontal-n.lineWidth,paddingInlineLG:n.paddingContentHorizontal-n.lineWidth,paddingInlineSM:8-n.lineWidth,onlyIconSize:n.fontSizeLG,onlyIconSizeSM:n.fontSizeLG-2,onlyIconSizeLG:n.fontSizeLG+2,groupBorderColor:n.colorPrimaryHover,linkHoverBg:"transparent",textHoverBg:n.colorBgTextHover,defaultColor:n.colorText,defaultBg:n.colorBgContainer,defaultBorderColor:n.colorBorder,defaultBorderColorDisabled:n.colorBorder,defaultHoverBg:n.colorBgContainer,defaultHoverColor:n.colorPrimaryHover,defaultHoverBorderColor:n.colorPrimaryHover,defaultActiveBg:n.colorBgContainer,defaultActiveColor:n.colorPrimaryActive,defaultActiveBorderColor:n.colorPrimaryActive,contentFontSize:a,contentFontSizeSM:c,contentFontSizeLG:l,contentLineHeight:u,contentLineHeightSM:d,contentLineHeightLG:h,paddingBlock:Math.max((n.controlHeight-a*u)/2-n.lineWidth,0),paddingBlockSM:Math.max((n.controlHeightSM-c*d)/2-n.lineWidth,0),paddingBlockLG:Math.max((n.controlHeightLG-l*h)/2-n.lineWidth,0)}},I0t=n=>{const{componentCls:e,iconCls:t,fontWeight:r}=n;return{[e]:{outline:"none",position:"relative",display:"inline-flex",gap:n.marginXS,alignItems:"center",justifyContent:"center",fontWeight:r,whiteSpace:"nowrap",textAlign:"center",backgroundImage:"none",background:"transparent",border:`${Ct(n.lineWidth)} ${n.lineType} transparent`,cursor:"pointer",transition:`all ${n.motionDurationMid} ${n.motionEaseInOut}`,userSelect:"none",touchAction:"manipulation",color:n.colorText,"&:disabled > *":{pointerEvents:"none"},"> span":{display:"inline-block"},[`${e}-icon`]:{lineHeight:1},"> a":{color:"currentColor"},"&:not(:disabled)":Object.assign({},S8(n)),[`&${e}-two-chinese-chars::first-letter`]:{letterSpacing:"0.34em"},[`&${e}-two-chinese-chars > *:not(${t})`]:{marginInlineEnd:"-0.34em",letterSpacing:"0.34em"},"&-icon-end":{flexDirection:"row-reverse"}}}},cv=(n,e,t)=>({[`&:not(:disabled):not(${n}-disabled)`]:{"&:hover":e,"&:active":t}}),P0t=n=>({minWidth:n.controlHeight,paddingInlineStart:0,paddingInlineEnd:0,borderRadius:"50%"}),k0t=n=>({borderRadius:n.controlHeight,paddingInlineStart:n.calc(n.controlHeight).div(2).equal(),paddingInlineEnd:n.calc(n.controlHeight).div(2).equal()}),T0t=n=>({cursor:"not-allowed",borderColor:n.borderColorDisabled,color:n.colorTextDisabled,background:n.colorBgContainerDisabled,boxShadow:"none"}),I3=(n,e,t,r,i,o,s,a)=>({[`&${n}-background-ghost`]:Object.assign(Object.assign({color:t||void 0,background:e,borderColor:r||void 0,boxShadow:"none"},cv(n,Object.assign({background:e},s),Object.assign({background:e},a))),{"&:disabled":{cursor:"not-allowed",color:i||void 0,borderColor:o||void 0}})}),Vne=n=>({[`&:disabled, &${n.componentCls}-disabled`]:Object.assign({},T0t(n))}),u4e=n=>Object.assign({},Vne(n)),x8=n=>({[`&:disabled, &${n.componentCls}-disabled`]:{cursor:"not-allowed",color:n.colorTextDisabled}}),d4e=n=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},u4e(n)),{background:n.defaultBg,borderColor:n.defaultBorderColor,color:n.defaultColor,boxShadow:n.defaultShadow}),cv(n.componentCls,{color:n.defaultHoverColor,borderColor:n.defaultHoverBorderColor,background:n.defaultHoverBg},{color:n.defaultActiveColor,borderColor:n.defaultActiveBorderColor,background:n.defaultActiveBg})),I3(n.componentCls,n.ghostBg,n.defaultGhostColor,n.defaultGhostBorderColor,n.colorTextDisabled,n.colorBorder)),{[`&${n.componentCls}-dangerous`]:Object.assign(Object.assign(Object.assign({color:n.colorError,borderColor:n.colorError},cv(n.componentCls,{color:n.colorErrorHover,borderColor:n.colorErrorBorderHover},{color:n.colorErrorActive,borderColor:n.colorErrorActive})),I3(n.componentCls,n.ghostBg,n.colorError,n.colorError,n.colorTextDisabled,n.colorBorder)),Vne(n))}),D0t=n=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},u4e(n)),{color:n.primaryColor,background:n.colorPrimary,boxShadow:n.primaryShadow}),cv(n.componentCls,{color:n.colorTextLightSolid,background:n.colorPrimaryHover},{color:n.colorTextLightSolid,background:n.colorPrimaryActive})),I3(n.componentCls,n.ghostBg,n.colorPrimary,n.colorPrimary,n.colorTextDisabled,n.colorBorder,{color:n.colorPrimaryHover,borderColor:n.colorPrimaryHover},{color:n.colorPrimaryActive,borderColor:n.colorPrimaryActive})),{[`&${n.componentCls}-dangerous`]:Object.assign(Object.assign(Object.assign({background:n.colorError,boxShadow:n.dangerShadow,color:n.dangerColor},cv(n.componentCls,{background:n.colorErrorHover},{background:n.colorErrorActive})),I3(n.componentCls,n.ghostBg,n.colorError,n.colorError,n.colorTextDisabled,n.colorBorder,{color:n.colorErrorHover,borderColor:n.colorErrorHover},{color:n.colorErrorActive,borderColor:n.colorErrorActive})),Vne(n))}),R0t=n=>Object.assign(Object.assign({},d4e(n)),{borderStyle:"dashed"}),A0t=n=>Object.assign(Object.assign(Object.assign({color:n.colorLink},cv(n.componentCls,{color:n.colorLinkHover,background:n.linkHoverBg},{color:n.colorLinkActive})),x8(n)),{[`&${n.componentCls}-dangerous`]:Object.assign(Object.assign({color:n.colorError},cv(n.componentCls,{color:n.colorErrorHover},{color:n.colorErrorActive})),x8(n))}),O0t=n=>Object.assign(Object.assign(Object.assign({},cv(n.componentCls,{color:n.colorText,background:n.textHoverBg},{color:n.colorText,background:n.colorBgTextActive})),x8(n)),{[`&${n.componentCls}-dangerous`]:Object.assign(Object.assign({color:n.colorError},x8(n)),cv(n.componentCls,{color:n.colorErrorHover,background:n.colorErrorBg},{color:n.colorErrorHover,background:n.colorErrorBgActive}))}),M0t=n=>{const{componentCls:e}=n;return{[`${e}-default`]:d4e(n),[`${e}-primary`]:D0t(n),[`${e}-dashed`]:R0t(n),[`${e}-link`]:A0t(n),[`${e}-text`]:O0t(n),[`${e}-ghost`]:I3(n.componentCls,n.ghostBg,n.colorBgContainer,n.colorBgContainer,n.colorTextDisabled,n.colorBorder)}},Wne=function(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const{componentCls:t,controlHeight:r,fontSize:i,lineHeight:o,borderRadius:s,buttonPaddingHorizontal:a,iconCls:c,buttonPaddingVertical:l}=n,u=`${t}-icon-only`;return[{[e]:{fontSize:i,lineHeight:o,height:r,padding:`${Ct(l)} ${Ct(a)}`,borderRadius:s,[`&${u}`]:{width:r,paddingInline:0,[`&${t}-compact-item`]:{flex:"none"},[`&${t}-round`]:{width:"auto"},[c]:{fontSize:n.buttonIconOnlyFontSize}},[`&${t}-loading`]:{opacity:n.opacityLoading,cursor:"default"},[`${t}-loading-icon`]:{transition:`width ${n.motionDurationSlow} ${n.motionEaseInOut}, opacity ${n.motionDurationSlow} ${n.motionEaseInOut}`}}},{[`${t}${t}-circle${e}`]:P0t(n)},{[`${t}${t}-round${e}`]:k0t(n)}]},$0t=n=>{const e=oo(n,{fontSize:n.contentFontSize,lineHeight:n.contentLineHeight});return Wne(e,n.componentCls)},L0t=n=>{const e=oo(n,{controlHeight:n.controlHeightSM,fontSize:n.contentFontSizeSM,lineHeight:n.contentLineHeightSM,padding:n.paddingXS,buttonPaddingHorizontal:n.paddingInlineSM,buttonPaddingVertical:n.paddingBlockSM,borderRadius:n.borderRadiusSM,buttonIconOnlyFontSize:n.onlyIconSizeSM});return Wne(e,`${n.componentCls}-sm`)},N0t=n=>{const e=oo(n,{controlHeight:n.controlHeightLG,fontSize:n.contentFontSizeLG,lineHeight:n.contentLineHeightLG,buttonPaddingHorizontal:n.paddingInlineLG,buttonPaddingVertical:n.paddingBlockLG,borderRadius:n.borderRadiusLG,buttonIconOnlyFontSize:n.onlyIconSizeLG});return Wne(e,`${n.componentCls}-lg`)},F0t=n=>{const{componentCls:e}=n;return{[e]:{[`&${e}-block`]:{width:"100%"}}}},j0t=Jc("Button",n=>{const e=c4e(n);return[I0t(e),$0t(e),L0t(e),N0t(e),F0t(e),M0t(e),E0t(e)]},l4e,{unitless:{fontWeight:!0,contentLineHeight:!0,contentLineHeightSM:!0,contentLineHeightLG:!0}});function B0t(n,e,t){const{focusElCls:r,focus:i,borderElCls:o}=t,s=o?"> *":"",a=["hover",i?"focus":null,"active"].filter(Boolean).map(c=>`&:${c} ${s}`).join(",");return{[`&-item:not(${e}-last-item)`]:{marginInlineEnd:n.calc(n.lineWidth).mul(-1).equal()},"&-item":Object.assign(Object.assign({[a]:{zIndex:2}},r?{[`&${r}`]:{zIndex:2}}:{}),{[`&[disabled] ${s}`]:{zIndex:0}})}}function H0t(n,e,t){const{borderElCls:r}=t,i=r?`> ${r}`:"";return{[`&-item:not(${e}-first-item):not(${e}-last-item) ${i}`]:{borderRadius:0},[`&-item:not(${e}-last-item)${e}-first-item`]:{[`& ${i}, &${n}-sm ${i}, &${n}-lg ${i}`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`&-item:not(${e}-first-item)${e}-last-item`]:{[`& ${i}, &${n}-sm ${i}, &${n}-lg ${i}`]:{borderStartStartRadius:0,borderEndStartRadius:0}}}}function qne(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{focus:!0};const{componentCls:t}=n,r=`${t}-compact`;return{[r]:Object.assign(Object.assign({},B0t(n,r,e)),H0t(t,r,e))}}function U0t(n,e){return{[`&-item:not(${e}-last-item)`]:{marginBottom:n.calc(n.lineWidth).mul(-1).equal()},"&-item":{"&:hover,&:focus,&:active":{zIndex:2},"&[disabled]":{zIndex:0}}}}function z0t(n,e){return{[`&-item:not(${e}-first-item):not(${e}-last-item)`]:{borderRadius:0},[`&-item${e}-first-item:not(${e}-last-item)`]:{[`&, &${n}-sm, &${n}-lg`]:{borderEndEndRadius:0,borderEndStartRadius:0}},[`&-item${e}-last-item:not(${e}-first-item)`]:{[`&, &${n}-sm, &${n}-lg`]:{borderStartStartRadius:0,borderStartEndRadius:0}}}}function V0t(n){const e=`${n.componentCls}-compact-vertical`;return{[e]:Object.assign(Object.assign({},U0t(n,e)),z0t(n.componentCls,e))}}const W0t=n=>{const{componentCls:e,calc:t}=n;return{[e]:{[`&-compact-item${e}-primary`]:{[`&:not([disabled]) + ${e}-compact-item${e}-primary:not([disabled])`]:{position:"relative","&:before":{position:"absolute",top:t(n.lineWidth).mul(-1).equal(),insetInlineStart:t(n.lineWidth).mul(-1).equal(),display:"inline-block",width:n.lineWidth,height:`calc(100% + ${Ct(n.lineWidth)} * 2)`,backgroundColor:n.colorPrimaryHover,content:'""'}}},"&-compact-vertical-item":{[`&${e}-primary`]:{[`&:not([disabled]) + ${e}-compact-vertical-item${e}-primary:not([disabled])`]:{position:"relative","&:before":{position:"absolute",top:t(n.lineWidth).mul(-1).equal(),insetInlineStart:t(n.lineWidth).mul(-1).equal(),display:"inline-block",width:`calc(100% + ${Ct(n.lineWidth)} * 2)`,height:n.lineWidth,backgroundColor:n.colorPrimaryHover,content:'""'}}}}}}},q0t=Lne(["Button","compact"],n=>{const e=c4e(n);return[qne(e),V0t(e),W0t(e)]},l4e);var K0t=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t};function G0t(n){if(typeof n=="object"&&n){let e=n==null?void 0:n.delay;return e=!Number.isNaN(e)&&typeof e=="number"?e:0,{loading:e<=0,delay:e}}return{loading:!!n,delay:0}}const Z0t=Ke.forwardRef((n,e)=>{var t,r,i;const{loading:o=!1,prefixCls:s,type:a,danger:c=!1,shape:l="default",size:u,styles:d,disabled:h,className:f,rootClassName:p,children:g,icon:m,iconPosition:v="start",ghost:b=!1,block:S=!1,htmlType:E="button",classNames:w,style:C={},autoInsertSpace:I}=n,T=K0t(n,["loading","prefixCls","type","danger","shape","size","styles","disabled","className","rootClassName","children","icon","iconPosition","ghost","block","htmlType","classNames","style","autoInsertSpace"]),D=a||"default",{getPrefixCls:O,direction:M,button:R}=y.useContext(fr),A=(t=I??(R==null?void 0:R.autoInsertSpace))!==null&&t!==void 0?t:!0,k=O("btn",s),[L,j,N]=j0t(k),B=y.useContext(fg),U=h??B,K=y.useContext(o4e),z=y.useMemo(()=>G0t(o),[o]),[G,te]=y.useState(z.loading),[ie,Q]=y.useState(!1),_e=Gd(e,y.createRef()),Se=y.Children.count(g)===1&&!m&&!kH(D);y.useEffect(()=>{let Me=null;z.delay>0?Me=setTimeout(()=>{Me=null,te(!0)},z.delay):te(z.loading);function He(){Me&&(clearTimeout(Me),Me=null)}return He},[z]),y.useEffect(()=>{if(!_e||!_e.current||!A)return;const Me=_e.current.textContent;Se&&tZ(Me)?ie||Q(!0):ie&&Q(!1)},[_e]);const se=Me=>{const{onClick:He}=n;if(G||U){Me.preventDefault();return}He==null||He(Me)},{compactSize:ee,compactItemClassnames:Y}=mD(k,M),ue={large:"lg",small:"sm",middle:void 0},ye=_v(Me=>{var He,Je;return(Je=(He=u??ee)!==null&&He!==void 0?He:K)!==null&&Je!==void 0?Je:Me}),V=ye&&ue[ye]||"",le=G?"loading":m,he=Yc(T,["navigate"]),oe=Ue(k,j,N,{[`${k}-${l}`]:l!=="default"&&l,[`${k}-${D}`]:D,[`${k}-${V}`]:V,[`${k}-icon-only`]:!g&&g!==0&&!!le,[`${k}-background-ghost`]:b&&!kH(D),[`${k}-loading`]:G,[`${k}-two-chinese-chars`]:ie&&A&&!G,[`${k}-block`]:S,[`${k}-dangerous`]:c,[`${k}-rtl`]:M==="rtl",[`${k}-icon-end`]:v==="end"},Y,f,p,R==null?void 0:R.className),ne=Object.assign(Object.assign({},R==null?void 0:R.style),C),ce=Ue(w==null?void 0:w.icon,(r=R==null?void 0:R.classNames)===null||r===void 0?void 0:r.icon),Ae=Object.assign(Object.assign({},(d==null?void 0:d.icon)||{}),((i=R==null?void 0:R.styles)===null||i===void 0?void 0:i.icon)||{}),Ie=m&&!G?Ke.createElement(a4e,{prefixCls:k,className:ce,style:Ae},m):Ke.createElement(x0t,{existIcon:!!m,prefixCls:k,loading:G}),be=g||g===0?C0t(g,Se&&A):null;if(he.href!==void 0)return L(Ke.createElement("a",Object.assign({},he,{className:Ue(oe,{[`${k}-disabled`]:U}),href:U?void 0:he.href,style:ne,onClick:se,ref:_e,tabIndex:U?-1:0}),Ie,be));let De=Ke.createElement("button",Object.assign({},T,{type:E,className:oe,style:ne,onClick:se,disabled:U,ref:_e}),Ie,be,!!Y&&Ke.createElement(q0t,{key:"compact",prefixCls:k}));return kH(D)||(De=Ke.createElement(zne,{component:"Button",disabled:G},De)),L(De)}),mg=Z0t;mg.Group=_0t;mg.__ANT_BUTTON=!0;function RH(n){return!!(n!=null&&n.then)}const h4e=n=>{const{type:e,children:t,prefixCls:r,buttonProps:i,close:o,autoFocus:s,emitEvent:a,isSilent:c,quitOnNullishReturnValue:l,actionFn:u}=n,d=y.useRef(!1),h=y.useRef(null),[f,p]=$S(!1),g=function(){o==null||o.apply(void 0,arguments)};y.useEffect(()=>{let b=null;return s&&(b=setTimeout(()=>{var S;(S=h.current)===null||S===void 0||S.focus()})),()=>{b&&clearTimeout(b)}},[]);const m=b=>{RH(b)&&(p(!0),b.then(function(){p(!1,!0),g.apply(void 0,arguments),d.current=!1},S=>{if(p(!1,!0),d.current=!1,!(c!=null&&c()))return Promise.reject(S)}))},v=b=>{if(d.current)return;if(d.current=!0,!u){g();return}let S;if(a){if(S=u(b),l&&!RH(S)){d.current=!1,g(b);return}}else if(u.length)S=u(o),d.current=!1;else if(S=u(),!RH(S)){g();return}m(S)};return y.createElement(mg,Object.assign({},s4e(e),{onClick:v,loading:f,prefixCls:r},i,{ref:h}),t)},vD=Ke.createContext({}),{Provider:f4e}=vD,Qme=()=>{const{autoFocusButton:n,cancelButtonProps:e,cancelTextLocale:t,isSilent:r,mergedOkCancel:i,rootPrefixCls:o,close:s,onCancel:a,onConfirm:c}=y.useContext(vD);return i?Ke.createElement(h4e,{isSilent:r,actionFn:a,close:function(){s==null||s.apply(void 0,arguments),c==null||c(!1)},autoFocus:n==="cancel",buttonProps:e,prefixCls:`${o}-btn`},t):null},eve=()=>{const{autoFocusButton:n,close:e,isSilent:t,okButtonProps:r,rootPrefixCls:i,okTextLocale:o,okType:s,onConfirm:a,onOk:c}=y.useContext(vD);return Ke.createElement(h4e,{isSilent:t,type:s||"primary",actionFn:c,close:function(){e==null||e.apply(void 0,arguments),a==null||a(!0)},autoFocus:n==="ok",buttonProps:r,prefixCls:`${i}-btn`},o)};var p4e=y.createContext(null),tve=[];function X0t(n,e){var t=y.useState(function(){if(!eu())return null;var p=document.createElement("div");return p}),r=rt(t,1),i=r[0],o=y.useRef(!1),s=y.useContext(p4e),a=y.useState(tve),c=rt(a,2),l=c[0],u=c[1],d=s||(o.current?void 0:function(p){u(function(g){var m=[p].concat(Ht(g));return m})});function h(){i.parentElement||document.body.appendChild(i),o.current=!0}function f(){var p;(p=i.parentElement)===null||p===void 0||p.removeChild(i),o.current=!1}return es(function(){return n?s?s(h):h():f(),f},[n]),es(function(){l.length&&(l.forEach(function(p){return p()}),u(tve))},[l]),[i,d]}function Y0t(n){var e="rc-scrollbar-measure-".concat(Math.random().toString(36).substring(7)),t=document.createElement("div");t.id=e;var r=t.style;r.position="absolute",r.left="0",r.top="0",r.width="100px",r.height="100px",r.overflow="scroll";var i,o;if(n){var s=getComputedStyle(n);r.scrollbarColor=s.scrollbarColor,r.scrollbarWidth=s.scrollbarWidth;var a=getComputedStyle(n,"::-webkit-scrollbar"),c=parseInt(a.width,10),l=parseInt(a.height,10);try{var u=c?"width: ".concat(a.width,";"):"",d=l?"height: ".concat(a.height,";"):"";Wm(`
#`.concat(e,`::-webkit-scrollbar {
`).concat(u,`
`).concat(d,`
}`),e)}catch(p){console.error(p),i=c,o=l}}document.body.appendChild(t);var h=n&&i&&!isNaN(i)?i:t.offsetWidth-t.clientWidth,f=n&&o&&!isNaN(o)?o:t.offsetHeight-t.clientHeight;return document.body.removeChild(t),b3(e),{width:h,height:f}}function J0t(n){return typeof document>"u"||!n||!(n instanceof Element)?{width:0,height:0}:Y0t(n)}function Q0t(){return document.body.scrollHeight>(window.innerHeight||document.documentElement.clientHeight)&&window.innerWidth>document.body.offsetWidth}var eyt="rc-util-locker-".concat(Date.now()),nve=0;function tyt(n){var e=!!n,t=y.useState(function(){return nve+=1,"".concat(eyt,"_").concat(nve)}),r=rt(t,1),i=r[0];es(function(){if(e){var o=J0t(document.body).width,s=Q0t();Wm(`
html body {
  overflow-y: hidden;
  `.concat(s?"width: calc(100% - ".concat(o,"px);"):"",`
}`),i)}else b3(i);return function(){b3(i)}},[e,i])}var nyt=!1;function ryt(n){return nyt}var rve=function(e){return e===!1?!1:!eu()||!e?null:typeof e=="string"?document.querySelector(e):typeof e=="function"?e():e},Kne=y.forwardRef(function(n,e){var t=n.open,r=n.autoLock,i=n.getContainer;n.debug;var o=n.autoDestroy,s=o===void 0?!0:o,a=n.children,c=y.useState(t),l=rt(c,2),u=l[0],d=l[1],h=u||t;y.useEffect(function(){(s||t)&&d(t)},[t,s]);var f=y.useState(function(){return rve(i)}),p=rt(f,2),g=p[0],m=p[1];y.useEffect(function(){var M=rve(i);m(M??null)});var v=X0t(h&&!g),b=rt(v,2),S=b[0],E=b[1],w=g??S;tyt(r&&t&&eu()&&(w===S||w===document.body));var C=null;if(a&&yv(a)&&e){var I=a;C=I.ref}var T=Uy(C,e);if(!h||!eu()||g===void 0)return null;var D=w===!1||ryt(),O=a;return e&&(O=y.cloneElement(a,{ref:T})),y.createElement(p4e.Provider,{value:E},D?O:Wu.createPortal(O,w))}),g4e=y.createContext({});function iyt(){var n=$e({},zT);return n.useId}var ive=0,ove=iyt();const m4e=ove?function(e){var t=ove();return e||t}:function(e){var t=y.useState("ssr-id"),r=rt(t,2),i=r[0],o=r[1];return y.useEffect(function(){var s=ive;ive+=1,o("rc_unique_".concat(s))},[]),e||i};function sve(n,e,t){var r=e;return!r&&t&&(r="".concat(n,"-").concat(t)),r}function ave(n,e){var t=n["page".concat(e?"Y":"X","Offset")],r="scroll".concat(e?"Top":"Left");if(typeof t!="number"){var i=n.document;t=i.documentElement[r],typeof t!="number"&&(t=i.body[r])}return t}function oyt(n){var e=n.getBoundingClientRect(),t={left:e.left,top:e.top},r=n.ownerDocument,i=r.defaultView||r.parentWindow;return t.left+=ave(i),t.top+=ave(i,!0),t}const syt=y.memo(function(n){var e=n.children;return e},function(n,e){var t=e.shouldUpdate;return!t});var cve={width:0,height:0,overflow:"hidden",outline:"none"},ayt={outline:"none"},v4e=Ke.forwardRef(function(n,e){var t=n.prefixCls,r=n.className,i=n.style,o=n.title,s=n.ariaId,a=n.footer,c=n.closable,l=n.closeIcon,u=n.onClose,d=n.children,h=n.bodyStyle,f=n.bodyProps,p=n.modalRender,g=n.onMouseDown,m=n.onMouseUp,v=n.holderRef,b=n.visible,S=n.forceRender,E=n.width,w=n.height,C=n.classNames,I=n.styles,T=Ke.useContext(g4e),D=T.panel,O=Uy(v,D),M=y.useRef(),R=y.useRef(),A=y.useRef();Ke.useImperativeHandle(e,function(){return{focus:function(){var te;(te=A.current)===null||te===void 0||te.focus({preventScroll:!0})},changeActive:function(te){var ie=document,Q=ie.activeElement;te&&Q===R.current?M.current.focus({preventScroll:!0}):!te&&Q===M.current&&R.current.focus({preventScroll:!0})}}});var k={};E!==void 0&&(k.width=E),w!==void 0&&(k.height=w);var L=a?Ke.createElement("div",{className:Ue("".concat(t,"-footer"),C==null?void 0:C.footer),style:$e({},I==null?void 0:I.footer)},a):null,j=o?Ke.createElement("div",{className:Ue("".concat(t,"-header"),C==null?void 0:C.header),style:$e({},I==null?void 0:I.header)},Ke.createElement("div",{className:"".concat(t,"-title"),id:s},o)):null,N=y.useMemo(function(){return Wn(c)==="object"&&c!==null?c:c?{closeIcon:l??Ke.createElement("span",{className:"".concat(t,"-close-x")})}:{}},[c,l,t]),B=pg(N,!0),U=Wn(c)==="object"&&c.disabled,K=c?Ke.createElement("button",ln({type:"button",onClick:u,"aria-label":"Close"},B,{className:"".concat(t,"-close"),disabled:U}),N.closeIcon):null,z=Ke.createElement("div",{className:Ue("".concat(t,"-content"),C==null?void 0:C.content),style:I==null?void 0:I.content},K,j,Ke.createElement("div",ln({className:Ue("".concat(t,"-body"),C==null?void 0:C.body),style:$e($e({},h),I==null?void 0:I.body)},f),d),L);return Ke.createElement("div",{key:"dialog-element",role:"dialog","aria-labelledby":o?s:null,"aria-modal":"true",ref:O,style:$e($e({},i),k),className:Ue(t,r),onMouseDown:g,onMouseUp:m},Ke.createElement("div",{tabIndex:0,ref:M,style:cve,"aria-hidden":"true"}),Ke.createElement("div",{ref:A,tabIndex:-1,style:ayt},Ke.createElement(syt,{shouldUpdate:b||S},p?p(z):z)),Ke.createElement("div",{tabIndex:0,ref:R,style:cve,"aria-hidden":"true"}))}),y4e=y.forwardRef(function(n,e){var t=n.prefixCls,r=n.title,i=n.style,o=n.className,s=n.visible,a=n.forceRender,c=n.destroyOnClose,l=n.motionName,u=n.ariaId,d=n.onVisibleChanged,h=n.mousePosition,f=y.useRef(),p=y.useState(),g=rt(p,2),m=g[0],v=g[1],b={};m&&(b.transformOrigin=m);function S(){var E=oyt(f.current);v(h&&(h.x||h.y)?"".concat(h.x-E.left,"px ").concat(h.y-E.top,"px"):"")}return y.createElement(bv,{visible:s,onVisibleChanged:d,onAppearPrepare:S,onEnterPrepare:S,forceRender:a,motionName:l,removeOnLeave:c,ref:f},function(E,w){var C=E.className,I=E.style;return y.createElement(v4e,ln({},n,{ref:e,title:r,ariaId:u,prefixCls:t,holderRef:w,style:$e($e($e({},I),i),b),className:Ue(o,C)}))})});y4e.displayName="Content";var cyt=function(e){var t=e.prefixCls,r=e.style,i=e.visible,o=e.maskProps,s=e.motionName,a=e.className;return y.createElement(bv,{key:"mask",visible:i,motionName:s,leavedClassName:"".concat(t,"-mask-hidden")},function(c,l){var u=c.className,d=c.style;return y.createElement("div",ln({ref:l,style:$e($e({},d),r),className:Ue("".concat(t,"-mask"),u,a)},o))})},lyt=function(e){var t=e.prefixCls,r=t===void 0?"rc-dialog":t,i=e.zIndex,o=e.visible,s=o===void 0?!1:o,a=e.keyboard,c=a===void 0?!0:a,l=e.focusTriggerAfterClose,u=l===void 0?!0:l,d=e.wrapStyle,h=e.wrapClassName,f=e.wrapProps,p=e.onClose,g=e.afterOpenChange,m=e.afterClose,v=e.transitionName,b=e.animation,S=e.closable,E=S===void 0?!0:S,w=e.mask,C=w===void 0?!0:w,I=e.maskTransitionName,T=e.maskAnimation,D=e.maskClosable,O=D===void 0?!0:D,M=e.maskStyle,R=e.maskProps,A=e.rootClassName,k=e.classNames,L=e.styles,j=y.useRef(),N=y.useRef(),B=y.useRef(),U=y.useState(s),K=rt(U,2),z=K[0],G=K[1],te=m4e();function ie(){_G(N.current,document.activeElement)||(j.current=document.activeElement)}function Q(){if(!_G(N.current,document.activeElement)){var le;(le=B.current)===null||le===void 0||le.focus()}}function ge(le){if(le)Q();else{if(G(!1),C&&j.current&&u){try{j.current.focus({preventScroll:!0})}catch{}j.current=null}z&&(m==null||m())}g==null||g(le)}function _e(le){p==null||p(le)}var Se=y.useRef(!1),se=y.useRef(),ee=function(){clearTimeout(se.current),Se.current=!0},Y=function(){se.current=setTimeout(function(){Se.current=!1})},ue=null;O&&(ue=function(he){Se.current?Se.current=!1:N.current===he.target&&_e(he)});function ye(le){if(c&&le.keyCode===Bt.ESC){le.stopPropagation(),_e(le);return}s&&le.keyCode===Bt.TAB&&B.current.changeActive(!le.shiftKey)}y.useEffect(function(){s&&(G(!0),ie())},[s]),y.useEffect(function(){return function(){clearTimeout(se.current)}},[]);var V=$e($e($e({zIndex:i},d),L==null?void 0:L.wrapper),{},{display:z?null:"none"});return y.createElement("div",ln({className:Ue("".concat(r,"-root"),A)},pg(e,{data:!0})),y.createElement(cyt,{prefixCls:r,visible:C&&s,motionName:sve(r,I,T),style:$e($e({zIndex:i},M),L==null?void 0:L.mask),maskProps:R,className:k==null?void 0:k.mask}),y.createElement("div",ln({tabIndex:-1,onKeyDown:ye,className:Ue("".concat(r,"-wrap"),h,k==null?void 0:k.wrapper),ref:N,onClick:ue,style:V},f),y.createElement(y4e,ln({},e,{onMouseDown:ee,onMouseUp:Y,ref:B,closable:E,ariaId:te,prefixCls:r,visible:s&&z,onClose:_e,onVisibleChanged:ge,motionName:sve(r,v,b)}))))},b4e=function(e){var t=e.visible,r=e.getContainer,i=e.forceRender,o=e.destroyOnClose,s=o===void 0?!1:o,a=e.afterClose,c=e.panelRef,l=y.useState(t),u=rt(l,2),d=u[0],h=u[1],f=y.useMemo(function(){return{panel:c}},[c]);return y.useEffect(function(){t&&h(!0)},[t]),!i&&s&&!d?null:y.createElement(g4e.Provider,{value:f},y.createElement(Kne,{open:t||i||d,autoDestroy:!1,getContainer:r,autoLock:t||d},y.createElement(lyt,ln({},e,{destroyOnClose:s,afterClose:function(){a==null||a(),h(!1)}}))))};b4e.displayName="Dialog";var T1="RC_FORM_INTERNAL_HOOKS",ao=function(){Sl(!1,"Can not find FormContext. Please make sure you wrap Field under Form.")},LS=y.createContext({getFieldValue:ao,getFieldsValue:ao,getFieldError:ao,getFieldWarning:ao,getFieldsError:ao,isFieldsTouched:ao,isFieldTouched:ao,isFieldValidating:ao,isFieldsValidating:ao,resetFields:ao,setFields:ao,setFieldValue:ao,setFieldsValue:ao,validateFields:ao,submit:ao,getInternalHooks:function(){return ao(),{dispatch:ao,initEntityValue:ao,registerField:ao,useSubscribe:ao,setInitialValues:ao,destroyForm:ao,setCallbacks:ao,registerWatch:ao,getFields:ao,setValidateMessages:ao,setPreserve:ao,getInitialValue:ao}}}),P3=y.createContext(null);function nZ(n){return n==null?[]:Array.isArray(n)?n:[n]}function uyt(n){return n&&!!n._init}function rZ(){return{default:"Validation error on field %s",required:"%s is required",enum:"%s must be one of %s",whitespace:"%s cannot be empty",date:{format:"%s date %s is invalid for format %s",parse:"%s date could not be parsed, %s is invalid ",invalid:"%s date %s is invalid"},types:{string:"%s is not a %s",method:"%s is not a %s (function)",array:"%s is not an %s",object:"%s is not an %s",number:"%s is not a %s",date:"%s is not a %s",boolean:"%s is not a %s",integer:"%s is not an %s",float:"%s is not a %s",regexp:"%s is not a valid %s",email:"%s is not a valid %s",url:"%s is not a valid %s",hex:"%s is not a valid %s"},string:{len:"%s must be exactly %s characters",min:"%s must be at least %s characters",max:"%s cannot be longer than %s characters",range:"%s must be between %s and %s characters"},number:{len:"%s must equal %s",min:"%s cannot be less than %s",max:"%s cannot be greater than %s",range:"%s must be between %s and %s"},array:{len:"%s must be exactly %s in length",min:"%s cannot be less than %s in length",max:"%s cannot be greater than %s in length",range:"%s must be between %s and %s in length"},pattern:{mismatch:"%s value %s does not match pattern %s"},clone:function(){var e=JSON.parse(JSON.stringify(this));return e.clone=this.clone,e}}}var iZ=rZ();function dyt(n){try{return Function.toString.call(n).indexOf("[native code]")!==-1}catch{return typeof n=="function"}}function hyt(n,e,t){if(Ene())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,e);var i=new(n.bind.apply(n,r));return t&&m3(i,t.prototype),i}function oZ(n){var e=typeof Map=="function"?new Map:void 0;return oZ=function(r){if(r===null||!dyt(r))return r;if(typeof r!="function")throw new TypeError("Super expression must either be null or a function");if(e!==void 0){if(e.has(r))return e.get(r);e.set(r,i)}function i(){return hyt(r,arguments,v3(this).constructor)}return i.prototype=Object.create(r.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),m3(i,r)},oZ(n)}var fyt=/%[sdj%]/g,pyt=function(){};function sZ(n){if(!n||!n.length)return null;var e={};return n.forEach(function(t){var r=t.field;e[r]=e[r]||[],e[r].push(t)}),e}function Rd(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];var i=0,o=t.length;if(typeof n=="function")return n.apply(null,t);if(typeof n=="string"){var s=n.replace(fyt,function(a){if(a==="%%")return"%";if(i>=o)return a;switch(a){case"%s":return String(t[i++]);case"%d":return Number(t[i++]);case"%j":try{return JSON.stringify(t[i++])}catch{return"[Circular]"}break;default:return a}});return s}return n}function gyt(n){return n==="string"||n==="url"||n==="hex"||n==="email"||n==="date"||n==="pattern"}function Ha(n,e){return!!(n==null||e==="array"&&Array.isArray(n)&&!n.length||gyt(e)&&typeof n=="string"&&!n)}function myt(n,e,t){var r=[],i=0,o=n.length;function s(a){r.push.apply(r,Ht(a||[])),i++,i===o&&t(r)}n.forEach(function(a){e(a,s)})}function lve(n,e,t){var r=0,i=n.length;function o(s){if(s&&s.length){t(s);return}var a=r;r=r+1,a<i?e(n[a],o):t([])}o([])}function vyt(n){var e=[];return Object.keys(n).forEach(function(t){e.push.apply(e,Ht(n[t]||[]))}),e}var uve=function(n){zy(t,n);var e=Vy(t);function t(r,i){var o;return vc(this,t),o=e.call(this,"Async Validation Error"),Le(Yr(o),"errors",void 0),Le(Yr(o),"fields",void 0),o.errors=r,o.fields=i,o}return yc(t)}(oZ(Error));function yyt(n,e,t,r,i){if(e.first){var o=new Promise(function(h,f){var p=function(v){return r(v),v.length?f(new uve(v,sZ(v))):h(i)},g=vyt(n);lve(g,t,p)});return o.catch(function(h){return h}),o}var s=e.firstFields===!0?Object.keys(n):e.firstFields||[],a=Object.keys(n),c=a.length,l=0,u=[],d=new Promise(function(h,f){var p=function(m){if(u.push.apply(u,m),l++,l===c)return r(u),u.length?f(new uve(u,sZ(u))):h(i)};a.length||(r(u),h(i)),a.forEach(function(g){var m=n[g];s.indexOf(g)!==-1?lve(m,t,p):myt(m,t,p)})});return d.catch(function(h){return h}),d}function byt(n){return!!(n&&n.message!==void 0)}function Syt(n,e){for(var t=n,r=0;r<e.length;r++){if(t==null)return t;t=t[e[r]]}return t}function dve(n,e){return function(t){var r;return n.fullFields?r=Syt(e,n.fullFields):r=e[t.field||n.fullField],byt(t)?(t.field=t.field||n.fullField,t.fieldValue=r,t):{message:typeof t=="function"?t():t,fieldValue:r,field:t.field||n.fullField}}}function hve(n,e){if(e){for(var t in e)if(e.hasOwnProperty(t)){var r=e[t];Wn(r)==="object"&&Wn(n[t])==="object"?n[t]=$e($e({},n[t]),r):n[t]=r}}return n}var ew="enum",_yt=function(e,t,r,i,o){e[ew]=Array.isArray(e[ew])?e[ew]:[],e[ew].indexOf(t)===-1&&i.push(Rd(o.messages[ew],e.fullField,e[ew].join(", ")))},wyt=function(e,t,r,i,o){if(e.pattern){if(e.pattern instanceof RegExp)e.pattern.lastIndex=0,e.pattern.test(t)||i.push(Rd(o.messages.pattern.mismatch,e.fullField,t,e.pattern));else if(typeof e.pattern=="string"){var s=new RegExp(e.pattern);s.test(t)||i.push(Rd(o.messages.pattern.mismatch,e.fullField,t,e.pattern))}}},Cyt=function(e,t,r,i,o){var s=typeof e.len=="number",a=typeof e.min=="number",c=typeof e.max=="number",l=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,u=t,d=null,h=typeof t=="number",f=typeof t=="string",p=Array.isArray(t);if(h?d="number":f?d="string":p&&(d="array"),!d)return!1;p&&(u=t.length),f&&(u=t.replace(l,"_").length),s?u!==e.len&&i.push(Rd(o.messages[d].len,e.fullField,e.len)):a&&!c&&u<e.min?i.push(Rd(o.messages[d].min,e.fullField,e.min)):c&&!a&&u>e.max?i.push(Rd(o.messages[d].max,e.fullField,e.max)):a&&c&&(u<e.min||u>e.max)&&i.push(Rd(o.messages[d].range,e.fullField,e.min,e.max))},S4e=function(e,t,r,i,o,s){e.required&&(!r.hasOwnProperty(e.field)||Ha(t,s||e.type))&&i.push(Rd(o.messages.required,e.fullField))},U5;const xyt=function(){if(U5)return U5;var n="[a-fA-F\\d:]",e=function(C){return C&&C.includeBoundaries?"(?:(?<=\\s|^)(?=".concat(n,")|(?<=").concat(n,")(?=\\s|$))"):""},t="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",r="[a-fA-F\\d]{1,4}",i=["(?:".concat(r,":){7}(?:").concat(r,"|:)"),"(?:".concat(r,":){6}(?:").concat(t,"|:").concat(r,"|:)"),"(?:".concat(r,":){5}(?::").concat(t,"|(?::").concat(r,"){1,2}|:)"),"(?:".concat(r,":){4}(?:(?::").concat(r,"){0,1}:").concat(t,"|(?::").concat(r,"){1,3}|:)"),"(?:".concat(r,":){3}(?:(?::").concat(r,"){0,2}:").concat(t,"|(?::").concat(r,"){1,4}|:)"),"(?:".concat(r,":){2}(?:(?::").concat(r,"){0,3}:").concat(t,"|(?::").concat(r,"){1,5}|:)"),"(?:".concat(r,":){1}(?:(?::").concat(r,"){0,4}:").concat(t,"|(?::").concat(r,"){1,6}|:)"),"(?::(?:(?::".concat(r,"){0,5}:").concat(t,"|(?::").concat(r,"){1,7}|:))")],o="(?:%[0-9a-zA-Z]{1,})?",s="(?:".concat(i.join("|"),")").concat(o),a=new RegExp("(?:^".concat(t,"$)|(?:^").concat(s,"$)")),c=new RegExp("^".concat(t,"$")),l=new RegExp("^".concat(s,"$")),u=function(C){return C&&C.exact?a:new RegExp("(?:".concat(e(C)).concat(t).concat(e(C),")|(?:").concat(e(C)).concat(s).concat(e(C),")"),"g")};u.v4=function(w){return w&&w.exact?c:new RegExp("".concat(e(w)).concat(t).concat(e(w)),"g")},u.v6=function(w){return w&&w.exact?l:new RegExp("".concat(e(w)).concat(s).concat(e(w)),"g")};var d="(?:(?:[a-z]+:)?//)",h="(?:\\S+(?::\\S*)?@)?",f=u.v4().source,p=u.v6().source,g="(?:(?:[a-z\\u00a1-\\uffff0-9][-_]*)*[a-z\\u00a1-\\uffff0-9]+)",m="(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*",v="(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))",b="(?::\\d{2,5})?",S='(?:[/?#][^\\s"]*)?',E="(?:".concat(d,"|www\\.)").concat(h,"(?:localhost|").concat(f,"|").concat(p,"|").concat(g).concat(m).concat(v,")").concat(b).concat(S);return U5=new RegExp("(?:^".concat(E,"$)"),"i"),U5};var fve={email:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+\.)+[a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]{2,}))$/,hex:/^#?([a-f0-9]{6}|[a-f0-9]{3})$/i},hP={integer:function(e){return hP.number(e)&&parseInt(e,10)===e},float:function(e){return hP.number(e)&&!hP.integer(e)},array:function(e){return Array.isArray(e)},regexp:function(e){if(e instanceof RegExp)return!0;try{return!!new RegExp(e)}catch{return!1}},date:function(e){return typeof e.getTime=="function"&&typeof e.getMonth=="function"&&typeof e.getYear=="function"&&!isNaN(e.getTime())},number:function(e){return isNaN(e)?!1:typeof e=="number"},object:function(e){return Wn(e)==="object"&&!hP.array(e)},method:function(e){return typeof e=="function"},email:function(e){return typeof e=="string"&&e.length<=320&&!!e.match(fve.email)},url:function(e){return typeof e=="string"&&e.length<=2048&&!!e.match(xyt())},hex:function(e){return typeof e=="string"&&!!e.match(fve.hex)}},Eyt=function(e,t,r,i,o){if(e.required&&t===void 0){S4e(e,t,r,i,o);return}var s=["integer","float","array","regexp","object","method","email","number","date","url","hex"],a=e.type;s.indexOf(a)>-1?hP[a](t)||i.push(Rd(o.messages.types[a],e.fullField,e.type)):a&&Wn(t)!==e.type&&i.push(Rd(o.messages.types[a],e.fullField,e.type))},Iyt=function(e,t,r,i,o){(/^\s+$/.test(t)||t==="")&&i.push(Rd(o.messages.whitespace,e.fullField))};const mi={required:S4e,whitespace:Iyt,type:Eyt,range:Cyt,enum:_yt,pattern:wyt};var Pyt=function(e,t,r,i,o){var s=[],a=e.required||!e.required&&i.hasOwnProperty(e.field);if(a){if(Ha(t)&&!e.required)return r();mi.required(e,t,i,s,o)}r(s)},kyt=function(e,t,r,i,o){var s=[],a=e.required||!e.required&&i.hasOwnProperty(e.field);if(a){if(t==null&&!e.required)return r();mi.required(e,t,i,s,o,"array"),t!=null&&(mi.type(e,t,i,s,o),mi.range(e,t,i,s,o))}r(s)},Tyt=function(e,t,r,i,o){var s=[],a=e.required||!e.required&&i.hasOwnProperty(e.field);if(a){if(Ha(t)&&!e.required)return r();mi.required(e,t,i,s,o),t!==void 0&&mi.type(e,t,i,s,o)}r(s)},Dyt=function(e,t,r,i,o){var s=[],a=e.required||!e.required&&i.hasOwnProperty(e.field);if(a){if(Ha(t,"date")&&!e.required)return r();if(mi.required(e,t,i,s,o),!Ha(t,"date")){var c;t instanceof Date?c=t:c=new Date(t),mi.type(e,c,i,s,o),c&&mi.range(e,c.getTime(),i,s,o)}}r(s)},Ryt="enum",Ayt=function(e,t,r,i,o){var s=[],a=e.required||!e.required&&i.hasOwnProperty(e.field);if(a){if(Ha(t)&&!e.required)return r();mi.required(e,t,i,s,o),t!==void 0&&mi[Ryt](e,t,i,s,o)}r(s)},Oyt=function(e,t,r,i,o){var s=[],a=e.required||!e.required&&i.hasOwnProperty(e.field);if(a){if(Ha(t)&&!e.required)return r();mi.required(e,t,i,s,o),t!==void 0&&(mi.type(e,t,i,s,o),mi.range(e,t,i,s,o))}r(s)},Myt=function(e,t,r,i,o){var s=[],a=e.required||!e.required&&i.hasOwnProperty(e.field);if(a){if(Ha(t)&&!e.required)return r();mi.required(e,t,i,s,o),t!==void 0&&(mi.type(e,t,i,s,o),mi.range(e,t,i,s,o))}r(s)},$yt=function(e,t,r,i,o){var s=[],a=e.required||!e.required&&i.hasOwnProperty(e.field);if(a){if(Ha(t)&&!e.required)return r();mi.required(e,t,i,s,o),t!==void 0&&mi.type(e,t,i,s,o)}r(s)},Lyt=function(e,t,r,i,o){var s=[],a=e.required||!e.required&&i.hasOwnProperty(e.field);if(a){if(t===""&&(t=void 0),Ha(t)&&!e.required)return r();mi.required(e,t,i,s,o),t!==void 0&&(mi.type(e,t,i,s,o),mi.range(e,t,i,s,o))}r(s)},Nyt=function(e,t,r,i,o){var s=[],a=e.required||!e.required&&i.hasOwnProperty(e.field);if(a){if(Ha(t)&&!e.required)return r();mi.required(e,t,i,s,o),t!==void 0&&mi.type(e,t,i,s,o)}r(s)},Fyt=function(e,t,r,i,o){var s=[],a=e.required||!e.required&&i.hasOwnProperty(e.field);if(a){if(Ha(t,"string")&&!e.required)return r();mi.required(e,t,i,s,o),Ha(t,"string")||mi.pattern(e,t,i,s,o)}r(s)},jyt=function(e,t,r,i,o){var s=[],a=e.required||!e.required&&i.hasOwnProperty(e.field);if(a){if(Ha(t)&&!e.required)return r();mi.required(e,t,i,s,o),Ha(t)||mi.type(e,t,i,s,o)}r(s)},Byt=function(e,t,r,i,o){var s=[],a=Array.isArray(t)?"array":Wn(t);mi.required(e,t,i,s,o,a),r(s)},Hyt=function(e,t,r,i,o){var s=[],a=e.required||!e.required&&i.hasOwnProperty(e.field);if(a){if(Ha(t,"string")&&!e.required)return r();mi.required(e,t,i,s,o,"string"),Ha(t,"string")||(mi.type(e,t,i,s,o),mi.range(e,t,i,s,o),mi.pattern(e,t,i,s,o),e.whitespace===!0&&mi.whitespace(e,t,i,s,o))}r(s)},AH=function(e,t,r,i,o){var s=e.type,a=[],c=e.required||!e.required&&i.hasOwnProperty(e.field);if(c){if(Ha(t,s)&&!e.required)return r();mi.required(e,t,i,a,o,s),Ha(t,s)||mi.type(e,t,i,a,o)}r(a)};const ck={string:Hyt,method:$yt,number:Lyt,boolean:Tyt,regexp:jyt,integer:Myt,float:Oyt,array:kyt,object:Nyt,enum:Ayt,pattern:Fyt,date:Dyt,url:AH,hex:AH,email:AH,required:Byt,any:Pyt};var yD=function(){function n(e){vc(this,n),Le(this,"rules",null),Le(this,"_messages",iZ),this.define(e)}return yc(n,[{key:"define",value:function(t){var r=this;if(!t)throw new Error("Cannot configure a schema with no rules");if(Wn(t)!=="object"||Array.isArray(t))throw new Error("Rules must be an object");this.rules={},Object.keys(t).forEach(function(i){var o=t[i];r.rules[i]=Array.isArray(o)?o:[o]})}},{key:"messages",value:function(t){return t&&(this._messages=hve(rZ(),t)),this._messages}},{key:"validate",value:function(t){var r=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){},s=t,a=i,c=o;if(typeof a=="function"&&(c=a,a={}),!this.rules||Object.keys(this.rules).length===0)return c&&c(null,s),Promise.resolve(s);function l(p){var g=[],m={};function v(S){if(Array.isArray(S)){var E;g=(E=g).concat.apply(E,Ht(S))}else g.push(S)}for(var b=0;b<p.length;b++)v(p[b]);g.length?(m=sZ(g),c(g,m)):c(null,s)}if(a.messages){var u=this.messages();u===iZ&&(u=rZ()),hve(u,a.messages),a.messages=u}else a.messages=this.messages();var d={},h=a.keys||Object.keys(this.rules);h.forEach(function(p){var g=r.rules[p],m=s[p];g.forEach(function(v){var b=v;typeof b.transform=="function"&&(s===t&&(s=$e({},s)),m=s[p]=b.transform(m),m!=null&&(b.type=b.type||(Array.isArray(m)?"array":Wn(m)))),typeof b=="function"?b={validator:b}:b=$e({},b),b.validator=r.getValidationMethod(b),b.validator&&(b.field=p,b.fullField=b.fullField||p,b.type=r.getType(b),d[p]=d[p]||[],d[p].push({rule:b,value:m,source:s,field:p}))})});var f={};return yyt(d,a,function(p,g){var m=p.rule,v=(m.type==="object"||m.type==="array")&&(Wn(m.fields)==="object"||Wn(m.defaultField)==="object");v=v&&(m.required||!m.required&&p.value),m.field=p.field;function b(I,T){return $e($e({},T),{},{fullField:"".concat(m.fullField,".").concat(I),fullFields:m.fullFields?[].concat(Ht(m.fullFields),[I]):[I]})}function S(){var I=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],T=Array.isArray(I)?I:[I];!a.suppressWarning&&T.length&&n.warning("async-validator:",T),T.length&&m.message!==void 0&&(T=[].concat(m.message));var D=T.map(dve(m,s));if(a.first&&D.length)return f[m.field]=1,g(D);if(!v)g(D);else{if(m.required&&!p.value)return m.message!==void 0?D=[].concat(m.message).map(dve(m,s)):a.error&&(D=[a.error(m,Rd(a.messages.required,m.field))]),g(D);var O={};m.defaultField&&Object.keys(p.value).map(function(A){O[A]=m.defaultField}),O=$e($e({},O),p.rule.fields);var M={};Object.keys(O).forEach(function(A){var k=O[A],L=Array.isArray(k)?k:[k];M[A]=L.map(b.bind(null,A))});var R=new n(M);R.messages(a.messages),p.rule.options&&(p.rule.options.messages=a.messages,p.rule.options.error=a.error),R.validate(p.value,p.rule.options||a,function(A){var k=[];D&&D.length&&k.push.apply(k,Ht(D)),A&&A.length&&k.push.apply(k,Ht(A)),g(k.length?k:null)})}}var E;if(m.asyncValidator)E=m.asyncValidator(m,p.value,S,p.source,a);else if(m.validator){try{E=m.validator(m,p.value,S,p.source,a)}catch(I){var w,C;(w=(C=console).error)===null||w===void 0||w.call(C,I),a.suppressValidatorError||setTimeout(function(){throw I},0),S(I.message)}E===!0?S():E===!1?S(typeof m.message=="function"?m.message(m.fullField||m.field):m.message||"".concat(m.fullField||m.field," fails")):E instanceof Array?S(E):E instanceof Error&&S(E.message)}E&&E.then&&E.then(function(){return S()},function(I){return S(I)})},function(p){l(p)},s)}},{key:"getType",value:function(t){if(t.type===void 0&&t.pattern instanceof RegExp&&(t.type="pattern"),typeof t.validator!="function"&&t.type&&!ck.hasOwnProperty(t.type))throw new Error(Rd("Unknown rule type %s",t.type));return t.type||"string"}},{key:"getValidationMethod",value:function(t){if(typeof t.validator=="function")return t.validator;var r=Object.keys(t),i=r.indexOf("message");return i!==-1&&r.splice(i,1),r.length===1&&r[0]==="required"?ck.required:ck[this.getType(t)]||void 0}}]),n}();Le(yD,"register",function(e,t){if(typeof t!="function")throw new Error("Cannot register a validator by type, validator is not a function");ck[e]=t});Le(yD,"warning",pyt);Le(yD,"messages",iZ);Le(yD,"validators",ck);var ud="'${name}' is not a valid ${type}",_4e={default:"Validation error on field '${name}'",required:"'${name}' is required",enum:"'${name}' must be one of [${enum}]",whitespace:"'${name}' cannot be empty",date:{format:"'${name}' is invalid for format date",parse:"'${name}' could not be parsed as date",invalid:"'${name}' is invalid date"},types:{string:ud,method:ud,array:ud,object:ud,number:ud,date:ud,boolean:ud,integer:ud,float:ud,regexp:ud,email:ud,url:ud,hex:ud},string:{len:"'${name}' must be exactly ${len} characters",min:"'${name}' must be at least ${min} characters",max:"'${name}' cannot be longer than ${max} characters",range:"'${name}' must be between ${min} and ${max} characters"},number:{len:"'${name}' must equal ${len}",min:"'${name}' cannot be less than ${min}",max:"'${name}' cannot be greater than ${max}",range:"'${name}' must be between ${min} and ${max}"},array:{len:"'${name}' must be exactly ${len} in length",min:"'${name}' cannot be less than ${min} in length",max:"'${name}' cannot be greater than ${max} in length",range:"'${name}' must be between ${min} and ${max} in length"},pattern:{mismatch:"'${name}' does not match pattern ${pattern}"}},pve=yD;function Uyt(n,e){return n.replace(/\\?\$\{\w+\}/g,function(t){if(t.startsWith("\\"))return t.slice(1);var r=t.slice(2,-1);return e[r]})}var gve="CODE_LOGIC_ERROR";function aZ(n,e,t,r,i){return cZ.apply(this,arguments)}function cZ(){return cZ=d_(tu().mark(function n(e,t,r,i,o){var s,a,c,l,u,d,h,f,p;return tu().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return s=$e({},r),delete s.ruleIndex,pve.warning=function(){},s.validator&&(a=s.validator,s.validator=function(){try{return a.apply(void 0,arguments)}catch(v){return console.error(v),Promise.reject(gve)}}),c=null,s&&s.type==="array"&&s.defaultField&&(c=s.defaultField,delete s.defaultField),l=new pve(Le({},e,[s])),u=eC(_4e,i.validateMessages),l.messages(u),d=[],m.prev=10,m.next=13,Promise.resolve(l.validate(Le({},e,t),$e({},i)));case 13:m.next=18;break;case 15:m.prev=15,m.t0=m.catch(10),m.t0.errors&&(d=m.t0.errors.map(function(v,b){var S=v.message,E=S===gve?u.default:S;return y.isValidElement(E)?y.cloneElement(E,{key:"error_".concat(b)}):E}));case 18:if(!(!d.length&&c)){m.next=23;break}return m.next=21,Promise.all(t.map(function(v,b){return aZ("".concat(e,".").concat(b),v,c,i,o)}));case 21:return h=m.sent,m.abrupt("return",h.reduce(function(v,b){return[].concat(Ht(v),Ht(b))},[]));case 23:return f=$e($e({},r),{},{name:e,enum:(r.enum||[]).join(", ")},o),p=d.map(function(v){return typeof v=="string"?Uyt(v,f):v}),m.abrupt("return",p);case 26:case"end":return m.stop()}},n,null,[[10,15]])})),cZ.apply(this,arguments)}function zyt(n,e,t,r,i,o){var s=n.join("."),a=t.map(function(u,d){var h=u.validator,f=$e($e({},u),{},{ruleIndex:d});return h&&(f.validator=function(p,g,m){var v=!1,b=function(){for(var w=arguments.length,C=new Array(w),I=0;I<w;I++)C[I]=arguments[I];Promise.resolve().then(function(){Sl(!v,"Your validator function has already return a promise. `callback` will be ignored."),v||m.apply(void 0,C)})},S=h(p,g,b);v=S&&typeof S.then=="function"&&typeof S.catch=="function",Sl(v,"`callback` is deprecated. Please return a promise instead."),v&&S.then(function(){m()}).catch(function(E){m(E||" ")})}),f}).sort(function(u,d){var h=u.warningOnly,f=u.ruleIndex,p=d.warningOnly,g=d.ruleIndex;return!!h==!!p?f-g:h?1:-1}),c;if(i===!0)c=new Promise(function(){var u=d_(tu().mark(function d(h,f){var p,g,m;return tu().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:p=0;case 1:if(!(p<a.length)){b.next=12;break}return g=a[p],b.next=5,aZ(s,e,g,r,o);case 5:if(m=b.sent,!m.length){b.next=9;break}return f([{errors:m,rule:g}]),b.abrupt("return");case 9:p+=1,b.next=1;break;case 12:h([]);case 13:case"end":return b.stop()}},d)}));return function(d,h){return u.apply(this,arguments)}}());else{var l=a.map(function(u){return aZ(s,e,u,r,o).then(function(d){return{errors:d,rule:u}})});c=(i?Wyt(l):Vyt(l)).then(function(u){return Promise.reject(u)})}return c.catch(function(u){return u}),c}function Vyt(n){return lZ.apply(this,arguments)}function lZ(){return lZ=d_(tu().mark(function n(e){return tu().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",Promise.all(e).then(function(i){var o,s=(o=[]).concat.apply(o,Ht(i));return s}));case 1:case"end":return r.stop()}},n)})),lZ.apply(this,arguments)}function Wyt(n){return uZ.apply(this,arguments)}function uZ(){return uZ=d_(tu().mark(function n(e){var t;return tu().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return t=0,i.abrupt("return",new Promise(function(o){e.forEach(function(s){s.then(function(a){a.errors.length&&o([a]),t+=1,t===e.length&&o([])})})}));case 2:case"end":return i.stop()}},n)})),uZ.apply(this,arguments)}function Xs(n){return nZ(n)}function mve(n,e){var t={};return e.forEach(function(r){var i=Gp(n,r);t=_f(t,r,i)}),t}function zC(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return n&&n.some(function(r){return w4e(e,r,t)})}function w4e(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return!n||!e||!t&&n.length!==e.length?!1:e.every(function(r,i){return n[i]===r})}function qyt(n,e){if(n===e)return!0;if(!n&&e||n&&!e||!n||!e||Wn(n)!=="object"||Wn(e)!=="object")return!1;var t=Object.keys(n),r=Object.keys(e),i=new Set([].concat(t,r));return Ht(i).every(function(o){var s=n[o],a=e[o];return typeof s=="function"&&typeof a=="function"?!0:s===a})}function Kyt(n){var e=arguments.length<=1?void 0:arguments[1];return e&&e.target&&Wn(e.target)==="object"&&n in e.target?e.target[n]:e}function vve(n,e,t){var r=n.length;if(e<0||e>=r||t<0||t>=r)return n;var i=n[e],o=e-t;return o>0?[].concat(Ht(n.slice(0,t)),[i],Ht(n.slice(t,e)),Ht(n.slice(e+1,r))):o<0?[].concat(Ht(n.slice(0,e)),Ht(n.slice(e+1,t+1)),[i],Ht(n.slice(t+1,r))):n}var Gyt=["name"],hh=[];function OH(n,e,t,r,i,o){return typeof n=="function"?n(e,t,"source"in o?{source:o.source}:{}):r!==i}var Gne=function(n){zy(t,n);var e=Vy(t);function t(r){var i;if(vc(this,t),i=e.call(this,r),Le(Yr(i),"state",{resetCount:0}),Le(Yr(i),"cancelRegisterFunc",null),Le(Yr(i),"mounted",!1),Le(Yr(i),"touched",!1),Le(Yr(i),"dirty",!1),Le(Yr(i),"validatePromise",void 0),Le(Yr(i),"prevValidating",void 0),Le(Yr(i),"errors",hh),Le(Yr(i),"warnings",hh),Le(Yr(i),"cancelRegister",function(){var c=i.props,l=c.preserve,u=c.isListField,d=c.name;i.cancelRegisterFunc&&i.cancelRegisterFunc(u,l,Xs(d)),i.cancelRegisterFunc=null}),Le(Yr(i),"getNamePath",function(){var c=i.props,l=c.name,u=c.fieldContext,d=u.prefixName,h=d===void 0?[]:d;return l!==void 0?[].concat(Ht(h),Ht(l)):[]}),Le(Yr(i),"getRules",function(){var c=i.props,l=c.rules,u=l===void 0?[]:l,d=c.fieldContext;return u.map(function(h){return typeof h=="function"?h(d):h})}),Le(Yr(i),"refresh",function(){i.mounted&&i.setState(function(c){var l=c.resetCount;return{resetCount:l+1}})}),Le(Yr(i),"metaCache",null),Le(Yr(i),"triggerMetaEvent",function(c){var l=i.props.onMetaChange;if(l){var u=$e($e({},i.getMeta()),{},{destroy:c});S3(i.metaCache,u)||l(u),i.metaCache=u}else i.metaCache=null}),Le(Yr(i),"onStoreChange",function(c,l,u){var d=i.props,h=d.shouldUpdate,f=d.dependencies,p=f===void 0?[]:f,g=d.onReset,m=u.store,v=i.getNamePath(),b=i.getValue(c),S=i.getValue(m),E=l&&zC(l,v);switch(u.type==="valueUpdate"&&u.source==="external"&&!S3(b,S)&&(i.touched=!0,i.dirty=!0,i.validatePromise=null,i.errors=hh,i.warnings=hh,i.triggerMetaEvent()),u.type){case"reset":if(!l||E){i.touched=!1,i.dirty=!1,i.validatePromise=void 0,i.errors=hh,i.warnings=hh,i.triggerMetaEvent(),g==null||g(),i.refresh();return}break;case"remove":{if(h&&OH(h,c,m,b,S,u)){i.reRender();return}break}case"setField":{var w=u.data;if(E){"touched"in w&&(i.touched=w.touched),"validating"in w&&!("originRCField"in w)&&(i.validatePromise=w.validating?Promise.resolve([]):null),"errors"in w&&(i.errors=w.errors||hh),"warnings"in w&&(i.warnings=w.warnings||hh),i.dirty=!0,i.triggerMetaEvent(),i.reRender();return}else if("value"in w&&zC(l,v,!0)){i.reRender();return}if(h&&!v.length&&OH(h,c,m,b,S,u)){i.reRender();return}break}case"dependenciesUpdate":{var C=p.map(Xs);if(C.some(function(I){return zC(u.relatedFields,I)})){i.reRender();return}break}default:if(E||(!p.length||v.length||h)&&OH(h,c,m,b,S,u)){i.reRender();return}break}h===!0&&i.reRender()}),Le(Yr(i),"validateRules",function(c){var l=i.getNamePath(),u=i.getValue(),d=c||{},h=d.triggerName,f=d.validateOnly,p=f===void 0?!1:f,g=Promise.resolve().then(d_(tu().mark(function m(){var v,b,S,E,w,C,I;return tu().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:if(i.mounted){D.next=2;break}return D.abrupt("return",[]);case 2:if(v=i.props,b=v.validateFirst,S=b===void 0?!1:b,E=v.messageVariables,w=v.validateDebounce,C=i.getRules(),h&&(C=C.filter(function(O){return O}).filter(function(O){var M=O.validateTrigger;if(!M)return!0;var R=nZ(M);return R.includes(h)})),!(w&&h)){D.next=10;break}return D.next=8,new Promise(function(O){setTimeout(O,w)});case 8:if(i.validatePromise===g){D.next=10;break}return D.abrupt("return",[]);case 10:return I=zyt(l,u,C,c,S,E),I.catch(function(O){return O}).then(function(){var O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:hh;if(i.validatePromise===g){var M;i.validatePromise=null;var R=[],A=[];(M=O.forEach)===null||M===void 0||M.call(O,function(k){var L=k.rule.warningOnly,j=k.errors,N=j===void 0?hh:j;L?A.push.apply(A,Ht(N)):R.push.apply(R,Ht(N))}),i.errors=R,i.warnings=A,i.triggerMetaEvent(),i.reRender()}}),D.abrupt("return",I);case 13:case"end":return D.stop()}},m)})));return p||(i.validatePromise=g,i.dirty=!0,i.errors=hh,i.warnings=hh,i.triggerMetaEvent(),i.reRender()),g}),Le(Yr(i),"isFieldValidating",function(){return!!i.validatePromise}),Le(Yr(i),"isFieldTouched",function(){return i.touched}),Le(Yr(i),"isFieldDirty",function(){if(i.dirty||i.props.initialValue!==void 0)return!0;var c=i.props.fieldContext,l=c.getInternalHooks(T1),u=l.getInitialValue;return u(i.getNamePath())!==void 0}),Le(Yr(i),"getErrors",function(){return i.errors}),Le(Yr(i),"getWarnings",function(){return i.warnings}),Le(Yr(i),"isListField",function(){return i.props.isListField}),Le(Yr(i),"isList",function(){return i.props.isList}),Le(Yr(i),"isPreserve",function(){return i.props.preserve}),Le(Yr(i),"getMeta",function(){i.prevValidating=i.isFieldValidating();var c={touched:i.isFieldTouched(),validating:i.prevValidating,errors:i.errors,warnings:i.warnings,name:i.getNamePath(),validated:i.validatePromise===null};return c}),Le(Yr(i),"getOnlyChild",function(c){if(typeof c=="function"){var l=i.getMeta();return $e($e({},i.getOnlyChild(c(i.getControlled(),l,i.props.fieldContext))),{},{isFunction:!0})}var u=hg(c);return u.length!==1||!y.isValidElement(u[0])?{child:u,isFunction:!1}:{child:u[0],isFunction:!1}}),Le(Yr(i),"getValue",function(c){var l=i.props.fieldContext.getFieldsValue,u=i.getNamePath();return Gp(c||l(!0),u)}),Le(Yr(i),"getControlled",function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},l=i.props,u=l.name,d=l.trigger,h=l.validateTrigger,f=l.getValueFromEvent,p=l.normalize,g=l.valuePropName,m=l.getValueProps,v=l.fieldContext,b=h!==void 0?h:v.validateTrigger,S=i.getNamePath(),E=v.getInternalHooks,w=v.getFieldsValue,C=E(T1),I=C.dispatch,T=i.getValue(),D=m||function(k){return Le({},g,k)},O=c[d],M=u!==void 0?D(T):{},R=$e($e({},c),M);R[d]=function(){i.touched=!0,i.dirty=!0,i.triggerMetaEvent();for(var k,L=arguments.length,j=new Array(L),N=0;N<L;N++)j[N]=arguments[N];f?k=f.apply(void 0,j):k=Kyt.apply(void 0,[g].concat(j)),p&&(k=p(k,T,w(!0))),I({type:"updateValue",namePath:S,value:k}),O&&O.apply(void 0,j)};var A=nZ(b||[]);return A.forEach(function(k){var L=R[k];R[k]=function(){L&&L.apply(void 0,arguments);var j=i.props.rules;j&&j.length&&I({type:"validateField",namePath:S,triggerName:k})}}),R}),r.fieldContext){var o=r.fieldContext.getInternalHooks,s=o(T1),a=s.initEntityValue;a(Yr(i))}return i}return yc(t,[{key:"componentDidMount",value:function(){var i=this.props,o=i.shouldUpdate,s=i.fieldContext;if(this.mounted=!0,s){var a=s.getInternalHooks,c=a(T1),l=c.registerField;this.cancelRegisterFunc=l(this)}o===!0&&this.reRender()}},{key:"componentWillUnmount",value:function(){this.cancelRegister(),this.triggerMetaEvent(!0),this.mounted=!1}},{key:"reRender",value:function(){this.mounted&&this.forceUpdate()}},{key:"render",value:function(){var i=this.state.resetCount,o=this.props.children,s=this.getOnlyChild(o),a=s.child,c=s.isFunction,l;return c?l=a:y.isValidElement(a)?l=y.cloneElement(a,this.getControlled(a.props)):(Sl(!a,"`children` of Field is not validate ReactElement."),l=a),y.createElement(y.Fragment,{key:i},l)}}]),t}(y.Component);Le(Gne,"contextType",LS);Le(Gne,"defaultProps",{trigger:"onChange",valuePropName:"value"});function Zne(n){var e=n.name,t=jr(n,Gyt),r=y.useContext(LS),i=y.useContext(P3),o=e!==void 0?Xs(e):void 0,s="keep";return t.isListField||(s="_".concat((o||[]).join("_"))),y.createElement(Gne,ln({key:s,name:o,isListField:!!i},t,{fieldContext:r}))}function C4e(n){var e=n.name,t=n.initialValue,r=n.children,i=n.rules,o=n.validateTrigger,s=n.isListField,a=y.useContext(LS),c=y.useContext(P3),l=y.useRef({keys:[],id:0}),u=l.current,d=y.useMemo(function(){var g=Xs(a.prefixName)||[];return[].concat(Ht(g),Ht(Xs(e)))},[a.prefixName,e]),h=y.useMemo(function(){return $e($e({},a),{},{prefixName:d})},[a,d]),f=y.useMemo(function(){return{getKey:function(m){var v=d.length,b=m[v];return[u.keys[b],m.slice(v+1)]}}},[d]);if(typeof r!="function")return Sl(!1,"Form.List only accepts function as children."),null;var p=function(m,v,b){var S=b.source;return S==="internal"?!1:m!==v};return y.createElement(P3.Provider,{value:f},y.createElement(LS.Provider,{value:h},y.createElement(Zne,{name:[],shouldUpdate:p,rules:i,validateTrigger:o,initialValue:t,isList:!0,isListField:s??!!c},function(g,m){var v=g.value,b=v===void 0?[]:v,S=g.onChange,E=a.getFieldValue,w=function(){var D=E(d||[]);return D||[]},C={add:function(D,O){var M=w();O>=0&&O<=M.length?(u.keys=[].concat(Ht(u.keys.slice(0,O)),[u.id],Ht(u.keys.slice(O))),S([].concat(Ht(M.slice(0,O)),[D],Ht(M.slice(O))))):(u.keys=[].concat(Ht(u.keys),[u.id]),S([].concat(Ht(M),[D]))),u.id+=1},remove:function(D){var O=w(),M=new Set(Array.isArray(D)?D:[D]);M.size<=0||(u.keys=u.keys.filter(function(R,A){return!M.has(A)}),S(O.filter(function(R,A){return!M.has(A)})))},move:function(D,O){if(D!==O){var M=w();D<0||D>=M.length||O<0||O>=M.length||(u.keys=vve(u.keys,D,O),S(vve(M,D,O)))}}},I=b||[];return Array.isArray(I)||(I=[]),r(I.map(function(T,D){var O=u.keys[D];return O===void 0&&(u.keys[D]=u.id,O=u.keys[D],u.id+=1),{name:D,key:O,isListField:!0}}),C,m)})))}function Zyt(n){var e=!1,t=n.length,r=[];return n.length?new Promise(function(i,o){n.forEach(function(s,a){s.catch(function(c){return e=!0,c}).then(function(c){t-=1,r[a]=c,!(t>0)&&(e&&o(r),i(r))})})}):Promise.resolve([])}var x4e="__@field_split__";function MH(n){return n.map(function(e){return"".concat(Wn(e),":").concat(e)}).join(x4e)}var tw=function(){function n(){vc(this,n),Le(this,"kvs",new Map)}return yc(n,[{key:"set",value:function(t,r){this.kvs.set(MH(t),r)}},{key:"get",value:function(t){return this.kvs.get(MH(t))}},{key:"update",value:function(t,r){var i=this.get(t),o=r(i);o?this.set(t,o):this.delete(t)}},{key:"delete",value:function(t){this.kvs.delete(MH(t))}},{key:"map",value:function(t){return Ht(this.kvs.entries()).map(function(r){var i=rt(r,2),o=i[0],s=i[1],a=o.split(x4e);return t({key:a.map(function(c){var l=c.match(/^([^:]*):(.*)$/),u=rt(l,3),d=u[1],h=u[2];return d==="number"?Number(h):h}),value:s})})}},{key:"toJSON",value:function(){var t={};return this.map(function(r){var i=r.key,o=r.value;return t[i.join(".")]=o,null}),t}}]),n}(),Xyt=["name"],Yyt=yc(function n(e){var t=this;vc(this,n),Le(this,"formHooked",!1),Le(this,"forceRootUpdate",void 0),Le(this,"subscribable",!0),Le(this,"store",{}),Le(this,"fieldEntities",[]),Le(this,"initialValues",{}),Le(this,"callbacks",{}),Le(this,"validateMessages",null),Le(this,"preserve",null),Le(this,"lastValidatePromise",null),Le(this,"getForm",function(){return{getFieldValue:t.getFieldValue,getFieldsValue:t.getFieldsValue,getFieldError:t.getFieldError,getFieldWarning:t.getFieldWarning,getFieldsError:t.getFieldsError,isFieldsTouched:t.isFieldsTouched,isFieldTouched:t.isFieldTouched,isFieldValidating:t.isFieldValidating,isFieldsValidating:t.isFieldsValidating,resetFields:t.resetFields,setFields:t.setFields,setFieldValue:t.setFieldValue,setFieldsValue:t.setFieldsValue,validateFields:t.validateFields,submit:t.submit,_init:!0,getInternalHooks:t.getInternalHooks}}),Le(this,"getInternalHooks",function(r){return r===T1?(t.formHooked=!0,{dispatch:t.dispatch,initEntityValue:t.initEntityValue,registerField:t.registerField,useSubscribe:t.useSubscribe,setInitialValues:t.setInitialValues,destroyForm:t.destroyForm,setCallbacks:t.setCallbacks,setValidateMessages:t.setValidateMessages,getFields:t.getFields,setPreserve:t.setPreserve,getInitialValue:t.getInitialValue,registerWatch:t.registerWatch}):(Sl(!1,"`getInternalHooks` is internal usage. Should not call directly."),null)}),Le(this,"useSubscribe",function(r){t.subscribable=r}),Le(this,"prevWithoutPreserves",null),Le(this,"setInitialValues",function(r,i){if(t.initialValues=r||{},i){var o,s=eC(r,t.store);(o=t.prevWithoutPreserves)===null||o===void 0||o.map(function(a){var c=a.key;s=_f(s,c,Gp(r,c))}),t.prevWithoutPreserves=null,t.updateStore(s)}}),Le(this,"destroyForm",function(r){if(r)t.updateStore({});else{var i=new tw;t.getFieldEntities(!0).forEach(function(o){t.isMergedPreserve(o.isPreserve())||i.set(o.getNamePath(),!0)}),t.prevWithoutPreserves=i}}),Le(this,"getInitialValue",function(r){var i=Gp(t.initialValues,r);return r.length?eC(i):i}),Le(this,"setCallbacks",function(r){t.callbacks=r}),Le(this,"setValidateMessages",function(r){t.validateMessages=r}),Le(this,"setPreserve",function(r){t.preserve=r}),Le(this,"watchList",[]),Le(this,"registerWatch",function(r){return t.watchList.push(r),function(){t.watchList=t.watchList.filter(function(i){return i!==r})}}),Le(this,"notifyWatch",function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];if(t.watchList.length){var i=t.getFieldsValue(),o=t.getFieldsValue(!0);t.watchList.forEach(function(s){s(i,o,r)})}}),Le(this,"timeoutId",null),Le(this,"warningUnhooked",function(){}),Le(this,"updateStore",function(r){t.store=r}),Le(this,"getFieldEntities",function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return r?t.fieldEntities.filter(function(i){return i.getNamePath().length}):t.fieldEntities}),Le(this,"getFieldsMap",function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,i=new tw;return t.getFieldEntities(r).forEach(function(o){var s=o.getNamePath();i.set(s,o)}),i}),Le(this,"getFieldEntitiesForNamePathList",function(r){if(!r)return t.getFieldEntities(!0);var i=t.getFieldsMap(!0);return r.map(function(o){var s=Xs(o);return i.get(s)||{INVALIDATE_NAME_PATH:Xs(o)}})}),Le(this,"getFieldsValue",function(r,i){t.warningUnhooked();var o,s,a;if(r===!0||Array.isArray(r)?(o=r,s=i):r&&Wn(r)==="object"&&(a=r.strict,s=r.filter),o===!0&&!s)return t.store;var c=t.getFieldEntitiesForNamePathList(Array.isArray(o)?o:null),l=[];return c.forEach(function(u){var d,h,f="INVALIDATE_NAME_PATH"in u?u.INVALIDATE_NAME_PATH:u.getNamePath();if(a){var p,g;if((p=(g=u).isList)!==null&&p!==void 0&&p.call(g))return}else if(!o&&(d=(h=u).isListField)!==null&&d!==void 0&&d.call(h))return;if(!s)l.push(f);else{var m="getMeta"in u?u.getMeta():null;s(m)&&l.push(f)}}),mve(t.store,l.map(Xs))}),Le(this,"getFieldValue",function(r){t.warningUnhooked();var i=Xs(r);return Gp(t.store,i)}),Le(this,"getFieldsError",function(r){t.warningUnhooked();var i=t.getFieldEntitiesForNamePathList(r);return i.map(function(o,s){return o&&!("INVALIDATE_NAME_PATH"in o)?{name:o.getNamePath(),errors:o.getErrors(),warnings:o.getWarnings()}:{name:Xs(r[s]),errors:[],warnings:[]}})}),Le(this,"getFieldError",function(r){t.warningUnhooked();var i=Xs(r),o=t.getFieldsError([i])[0];return o.errors}),Le(this,"getFieldWarning",function(r){t.warningUnhooked();var i=Xs(r),o=t.getFieldsError([i])[0];return o.warnings}),Le(this,"isFieldsTouched",function(){t.warningUnhooked();for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];var s=i[0],a=i[1],c,l=!1;i.length===0?c=null:i.length===1?Array.isArray(s)?(c=s.map(Xs),l=!1):(c=null,l=s):(c=s.map(Xs),l=a);var u=t.getFieldEntities(!0),d=function(m){return m.isFieldTouched()};if(!c)return l?u.every(function(g){return d(g)||g.isList()}):u.some(d);var h=new tw;c.forEach(function(g){h.set(g,[])}),u.forEach(function(g){var m=g.getNamePath();c.forEach(function(v){v.every(function(b,S){return m[S]===b})&&h.update(v,function(b){return[].concat(Ht(b),[g])})})});var f=function(m){return m.some(d)},p=h.map(function(g){var m=g.value;return m});return l?p.every(f):p.some(f)}),Le(this,"isFieldTouched",function(r){return t.warningUnhooked(),t.isFieldsTouched([r])}),Le(this,"isFieldsValidating",function(r){t.warningUnhooked();var i=t.getFieldEntities();if(!r)return i.some(function(s){return s.isFieldValidating()});var o=r.map(Xs);return i.some(function(s){var a=s.getNamePath();return zC(o,a)&&s.isFieldValidating()})}),Le(this,"isFieldValidating",function(r){return t.warningUnhooked(),t.isFieldsValidating([r])}),Le(this,"resetWithFieldInitialValue",function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=new tw,o=t.getFieldEntities(!0);o.forEach(function(c){var l=c.props.initialValue,u=c.getNamePath();if(l!==void 0){var d=i.get(u)||new Set;d.add({entity:c,value:l}),i.set(u,d)}});var s=function(l){l.forEach(function(u){var d=u.props.initialValue;if(d!==void 0){var h=u.getNamePath(),f=t.getInitialValue(h);if(f!==void 0)Sl(!1,"Form already set 'initialValues' with path '".concat(h.join("."),"'. Field can not overwrite it."));else{var p=i.get(h);if(p&&p.size>1)Sl(!1,"Multiple Field with path '".concat(h.join("."),"' set 'initialValue'. Can not decide which one to pick."));else if(p){var g=t.getFieldValue(h),m=u.isListField();!m&&(!r.skipExist||g===void 0)&&t.updateStore(_f(t.store,h,Ht(p)[0].value))}}}})},a;r.entities?a=r.entities:r.namePathList?(a=[],r.namePathList.forEach(function(c){var l=i.get(c);if(l){var u;(u=a).push.apply(u,Ht(Ht(l).map(function(d){return d.entity})))}})):a=o,s(a)}),Le(this,"resetFields",function(r){t.warningUnhooked();var i=t.store;if(!r){t.updateStore(eC(t.initialValues)),t.resetWithFieldInitialValue(),t.notifyObservers(i,null,{type:"reset"}),t.notifyWatch();return}var o=r.map(Xs);o.forEach(function(s){var a=t.getInitialValue(s);t.updateStore(_f(t.store,s,a))}),t.resetWithFieldInitialValue({namePathList:o}),t.notifyObservers(i,o,{type:"reset"}),t.notifyWatch(o)}),Le(this,"setFields",function(r){t.warningUnhooked();var i=t.store,o=[];r.forEach(function(s){var a=s.name,c=jr(s,Xyt),l=Xs(a);o.push(l),"value"in c&&t.updateStore(_f(t.store,l,c.value)),t.notifyObservers(i,[l],{type:"setField",data:s})}),t.notifyWatch(o)}),Le(this,"getFields",function(){var r=t.getFieldEntities(!0),i=r.map(function(o){var s=o.getNamePath(),a=o.getMeta(),c=$e($e({},a),{},{name:s,value:t.getFieldValue(s)});return Object.defineProperty(c,"originRCField",{value:!0}),c});return i}),Le(this,"initEntityValue",function(r){var i=r.props.initialValue;if(i!==void 0){var o=r.getNamePath(),s=Gp(t.store,o);s===void 0&&t.updateStore(_f(t.store,o,i))}}),Le(this,"isMergedPreserve",function(r){var i=r!==void 0?r:t.preserve;return i??!0}),Le(this,"registerField",function(r){t.fieldEntities.push(r);var i=r.getNamePath();if(t.notifyWatch([i]),r.props.initialValue!==void 0){var o=t.store;t.resetWithFieldInitialValue({entities:[r],skipExist:!0}),t.notifyObservers(o,[r.getNamePath()],{type:"valueUpdate",source:"internal"})}return function(s,a){var c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];if(t.fieldEntities=t.fieldEntities.filter(function(d){return d!==r}),!t.isMergedPreserve(a)&&(!s||c.length>1)){var l=s?void 0:t.getInitialValue(i);if(i.length&&t.getFieldValue(i)!==l&&t.fieldEntities.every(function(d){return!w4e(d.getNamePath(),i)})){var u=t.store;t.updateStore(_f(u,i,l,!0)),t.notifyObservers(u,[i],{type:"remove"}),t.triggerDependenciesUpdate(u,i)}}t.notifyWatch([i])}}),Le(this,"dispatch",function(r){switch(r.type){case"updateValue":{var i=r.namePath,o=r.value;t.updateValue(i,o);break}case"validateField":{var s=r.namePath,a=r.triggerName;t.validateFields([s],{triggerName:a});break}}}),Le(this,"notifyObservers",function(r,i,o){if(t.subscribable){var s=$e($e({},o),{},{store:t.getFieldsValue(!0)});t.getFieldEntities().forEach(function(a){var c=a.onStoreChange;c(r,i,s)})}else t.forceRootUpdate()}),Le(this,"triggerDependenciesUpdate",function(r,i){var o=t.getDependencyChildrenFields(i);return o.length&&t.validateFields(o),t.notifyObservers(r,o,{type:"dependenciesUpdate",relatedFields:[i].concat(Ht(o))}),o}),Le(this,"updateValue",function(r,i){var o=Xs(r),s=t.store;t.updateStore(_f(t.store,o,i)),t.notifyObservers(s,[o],{type:"valueUpdate",source:"internal"}),t.notifyWatch([o]);var a=t.triggerDependenciesUpdate(s,o),c=t.callbacks.onValuesChange;if(c){var l=mve(t.store,[o]);c(l,t.getFieldsValue())}t.triggerOnFieldsChange([o].concat(Ht(a)))}),Le(this,"setFieldsValue",function(r){t.warningUnhooked();var i=t.store;if(r){var o=eC(t.store,r);t.updateStore(o)}t.notifyObservers(i,null,{type:"valueUpdate",source:"external"}),t.notifyWatch()}),Le(this,"setFieldValue",function(r,i){t.setFields([{name:r,value:i}])}),Le(this,"getDependencyChildrenFields",function(r){var i=new Set,o=[],s=new tw;t.getFieldEntities().forEach(function(c){var l=c.props.dependencies;(l||[]).forEach(function(u){var d=Xs(u);s.update(d,function(){var h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new Set;return h.add(c),h})})});var a=function c(l){var u=s.get(l)||new Set;u.forEach(function(d){if(!i.has(d)){i.add(d);var h=d.getNamePath();d.isFieldDirty()&&h.length&&(o.push(h),c(h))}})};return a(r),o}),Le(this,"triggerOnFieldsChange",function(r,i){var o=t.callbacks.onFieldsChange;if(o){var s=t.getFields();if(i){var a=new tw;i.forEach(function(l){var u=l.name,d=l.errors;a.set(u,d)}),s.forEach(function(l){l.errors=a.get(l.name)||l.errors})}var c=s.filter(function(l){var u=l.name;return zC(r,u)});c.length&&o(c,s)}}),Le(this,"validateFields",function(r,i){t.warningUnhooked();var o,s;Array.isArray(r)||typeof r=="string"||typeof i=="string"?(o=r,s=i):s=r;var a=!!o,c=a?o.map(Xs):[],l=[],u=String(Date.now()),d=new Set,h=s||{},f=h.recursive,p=h.dirty;t.getFieldEntities(!0).forEach(function(b){if(a||c.push(b.getNamePath()),!(!b.props.rules||!b.props.rules.length)&&!(p&&!b.isFieldDirty())){var S=b.getNamePath();if(d.add(S.join(u)),!a||zC(c,S,f)){var E=b.validateRules($e({validateMessages:$e($e({},_4e),t.validateMessages)},s));l.push(E.then(function(){return{name:S,errors:[],warnings:[]}}).catch(function(w){var C,I=[],T=[];return(C=w.forEach)===null||C===void 0||C.call(w,function(D){var O=D.rule.warningOnly,M=D.errors;O?T.push.apply(T,Ht(M)):I.push.apply(I,Ht(M))}),I.length?Promise.reject({name:S,errors:I,warnings:T}):{name:S,errors:I,warnings:T}}))}}});var g=Zyt(l);t.lastValidatePromise=g,g.catch(function(b){return b}).then(function(b){var S=b.map(function(E){var w=E.name;return w});t.notifyObservers(t.store,S,{type:"validateFinish"}),t.triggerOnFieldsChange(S,b)});var m=g.then(function(){return t.lastValidatePromise===g?Promise.resolve(t.getFieldsValue(c)):Promise.reject([])}).catch(function(b){var S=b.filter(function(E){return E&&E.errors.length});return Promise.reject({values:t.getFieldsValue(c),errorFields:S,outOfDate:t.lastValidatePromise!==g})});m.catch(function(b){return b});var v=c.filter(function(b){return d.has(b.join(u))});return t.triggerOnFieldsChange(v),m}),Le(this,"submit",function(){t.warningUnhooked(),t.validateFields().then(function(r){var i=t.callbacks.onFinish;if(i)try{i(r)}catch(o){console.error(o)}}).catch(function(r){var i=t.callbacks.onFinishFailed;i&&i(r)})}),this.forceRootUpdate=e});function Xne(n){var e=y.useRef(),t=y.useState({}),r=rt(t,2),i=r[1];if(!e.current)if(n)e.current=n;else{var o=function(){i({})},s=new Yyt(o);e.current=s.getForm()}return[e.current]}var dZ=y.createContext({triggerFormChange:function(){},triggerFormFinish:function(){},registerForm:function(){},unregisterForm:function(){}}),E4e=function(e){var t=e.validateMessages,r=e.onFormChange,i=e.onFormFinish,o=e.children,s=y.useContext(dZ),a=y.useRef({});return y.createElement(dZ.Provider,{value:$e($e({},s),{},{validateMessages:$e($e({},s.validateMessages),t),triggerFormChange:function(l,u){r&&r(l,{changedFields:u,forms:a.current}),s.triggerFormChange(l,u)},triggerFormFinish:function(l,u){i&&i(l,{values:u,forms:a.current}),s.triggerFormFinish(l,u)},registerForm:function(l,u){l&&(a.current=$e($e({},a.current),{},Le({},l,u))),s.registerForm(l,u)},unregisterForm:function(l){var u=$e({},a.current);delete u[l],a.current=u,s.unregisterForm(l)}})},o)},Jyt=["name","initialValues","fields","form","preserve","children","component","validateMessages","validateTrigger","onValuesChange","onFieldsChange","onFinish","onFinishFailed","clearOnDestroy"],Qyt=function(e,t){var r=e.name,i=e.initialValues,o=e.fields,s=e.form,a=e.preserve,c=e.children,l=e.component,u=l===void 0?"form":l,d=e.validateMessages,h=e.validateTrigger,f=h===void 0?"onChange":h,p=e.onValuesChange,g=e.onFieldsChange,m=e.onFinish,v=e.onFinishFailed,b=e.clearOnDestroy,S=jr(e,Jyt),E=y.useRef(null),w=y.useContext(dZ),C=Xne(s),I=rt(C,1),T=I[0],D=T.getInternalHooks(T1),O=D.useSubscribe,M=D.setInitialValues,R=D.setCallbacks,A=D.setValidateMessages,k=D.setPreserve,L=D.destroyForm;y.useImperativeHandle(t,function(){return $e($e({},T),{},{nativeElement:E.current})}),y.useEffect(function(){return w.registerForm(r,T),function(){w.unregisterForm(r)}},[w,T,r]),A($e($e({},w.validateMessages),d)),R({onValuesChange:p,onFieldsChange:function(ie){if(w.triggerFormChange(r,ie),g){for(var Q=arguments.length,ge=new Array(Q>1?Q-1:0),_e=1;_e<Q;_e++)ge[_e-1]=arguments[_e];g.apply(void 0,[ie].concat(ge))}},onFinish:function(ie){w.triggerFormFinish(r,ie),m&&m(ie)},onFinishFailed:v}),k(a);var j=y.useRef(null);M(i,!j.current),j.current||(j.current=!0),y.useEffect(function(){return function(){return L(b)}},[]);var N,B=typeof c=="function";if(B){var U=T.getFieldsValue(!0);N=c(U,T)}else N=c;O(!B);var K=y.useRef();y.useEffect(function(){qyt(K.current||[],o||[])||T.setFields(o||[]),K.current=o},[o,T]);var z=y.useMemo(function(){return $e($e({},T),{},{validateTrigger:f})},[T,f]),G=y.createElement(P3.Provider,{value:null},y.createElement(LS.Provider,{value:z},N));return u===!1?G:y.createElement(u,ln({},S,{ref:E,onSubmit:function(ie){ie.preventDefault(),ie.stopPropagation(),T.submit()},onReset:function(ie){var Q;ie.preventDefault(),T.resetFields(),(Q=S.onReset)===null||Q===void 0||Q.call(S,ie)}}),G)};function yve(n){try{return JSON.stringify(n)}catch{return Math.random()}}function I4e(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];var r=e[0],i=e[1],o=i===void 0?{}:i,s=uyt(o)?{form:o}:o,a=s.form,c=y.useState(),l=rt(c,2),u=l[0],d=l[1],h=y.useMemo(function(){return yve(u)},[u]),f=y.useRef(h);f.current=h;var p=y.useContext(LS),g=a||p,m=g&&g._init,v=Xs(r),b=y.useRef(v);return b.current=v,y.useEffect(function(){if(m){var S=g.getFieldsValue,E=g.getInternalHooks,w=E(T1),C=w.registerWatch,I=function(M,R){var A=s.preserve?R:M;return typeof r=="function"?r(A):Gp(A,b.current)},T=C(function(O,M){var R=I(O,M),A=yve(R);f.current!==A&&(f.current=A,d(R))}),D=I(S(),S(!0));return u!==D&&d(D),T}},[m]),u}var ebt=y.forwardRef(Qyt),rE=ebt;rE.FormProvider=E4e;rE.Field=Zne;rE.List=C4e;rE.useForm=Xne;rE.useWatch=I4e;const lv=y.createContext({labelAlign:"right",vertical:!1,itemRef:()=>{}}),P4e=y.createContext(null),k4e=n=>{const e=Yc(n,["prefixCls"]);return y.createElement(E4e,Object.assign({},e))},Yne=y.createContext({prefixCls:""}),nu=y.createContext({}),tbt=n=>{let{children:e,status:t,override:r}=n;const i=y.useContext(nu),o=y.useMemo(()=>{const s=Object.assign({},i);return r&&delete s.isFormItemInput,t&&(delete s.status,delete s.hasFeedback,delete s.feedbackIcon),s},[t,r,i]);return y.createElement(nu.Provider,{value:o},e)},T4e=y.createContext(void 0),k3=n=>{const{space:e,form:t,children:r}=n;if(r==null)return null;let i=r;return t&&(i=Ke.createElement(tbt,{override:!0,status:!0},i)),e&&(i=Ke.createElement(v0t,null,i)),i};function bve(n){if(n)return{closable:n.closable,closeIcon:n.closeIcon}}function Sve(n){const{closable:e,closeIcon:t}=n||{};return Ke.useMemo(()=>{if(!e&&(e===!1||t===!1||t===null))return!1;if(e===void 0&&t===void 0)return null;let r={closeIcon:typeof t!="boolean"&&t!==null?t:void 0};return e&&typeof e=="object"&&(r=Object.assign(Object.assign({},r),e)),r},[e,t])}function _ve(){const n={};for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.forEach(i=>{i&&Object.keys(i).forEach(o=>{i[o]!==void 0&&(n[o]=i[o])})}),n}const nbt={};function rbt(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:nbt;const r=Sve(n),i=Sve(e),o=Ke.useMemo(()=>Object.assign({closeIcon:Ke.createElement(fD,null)},t),[t]),s=Ke.useMemo(()=>r===!1?!1:r?_ve(o,i,r):i===!1?!1:i?_ve(o,i):o.closable?o:!1,[r,i,o]);return Ke.useMemo(()=>{if(s===!1)return[!1,null];const{closeIconRender:a}=o,{closeIcon:c}=s;let l=c;if(l!=null){a&&(l=a(c));const u=pg(s,!0);Object.keys(u).length&&(l=Ke.isValidElement(l)?Ke.cloneElement(l,u):Ke.createElement("span",Object.assign({},u),l))}return[!0,l]},[s,o])}const ibt=()=>eu()&&window.document.documentElement,J7=n=>{const{prefixCls:e,className:t,style:r,size:i,shape:o}=n,s=Ue({[`${e}-lg`]:i==="large",[`${e}-sm`]:i==="small"}),a=Ue({[`${e}-circle`]:o==="circle",[`${e}-square`]:o==="square",[`${e}-round`]:o==="round"}),c=y.useMemo(()=>typeof i=="number"?{width:i,height:i,lineHeight:`${i}px`}:{},[i]);return y.createElement("span",{className:Ue(e,s,a,t),style:Object.assign(Object.assign({},c),r)})},obt=new Oi("ant-skeleton-loading",{"0%":{backgroundPosition:"100% 50%"},"100%":{backgroundPosition:"0 50%"}}),Q7=n=>({height:n,lineHeight:Ct(n)}),VC=n=>Object.assign({width:n},Q7(n)),sbt=n=>({background:n.skeletonLoadingBackground,backgroundSize:"400% 100%",animationName:obt,animationDuration:n.skeletonLoadingMotionDuration,animationTimingFunction:"ease",animationIterationCount:"infinite"}),$H=(n,e)=>Object.assign({width:e(n).mul(5).equal(),minWidth:e(n).mul(5).equal()},Q7(n)),abt=n=>{const{skeletonAvatarCls:e,gradientFromColor:t,controlHeight:r,controlHeightLG:i,controlHeightSM:o}=n;return{[e]:Object.assign({display:"inline-block",verticalAlign:"top",background:t},VC(r)),[`${e}${e}-circle`]:{borderRadius:"50%"},[`${e}${e}-lg`]:Object.assign({},VC(i)),[`${e}${e}-sm`]:Object.assign({},VC(o))}},cbt=n=>{const{controlHeight:e,borderRadiusSM:t,skeletonInputCls:r,controlHeightLG:i,controlHeightSM:o,gradientFromColor:s,calc:a}=n;return{[r]:Object.assign({display:"inline-block",verticalAlign:"top",background:s,borderRadius:t},$H(e,a)),[`${r}-lg`]:Object.assign({},$H(i,a)),[`${r}-sm`]:Object.assign({},$H(o,a))}},wve=n=>Object.assign({width:n},Q7(n)),lbt=n=>{const{skeletonImageCls:e,imageSizeBase:t,gradientFromColor:r,borderRadiusSM:i,calc:o}=n;return{[e]:Object.assign(Object.assign({display:"flex",alignItems:"center",justifyContent:"center",verticalAlign:"top",background:r,borderRadius:i},wve(o(t).mul(2).equal())),{[`${e}-path`]:{fill:"#bfbfbf"},[`${e}-svg`]:Object.assign(Object.assign({},wve(t)),{maxWidth:o(t).mul(4).equal(),maxHeight:o(t).mul(4).equal()}),[`${e}-svg${e}-svg-circle`]:{borderRadius:"50%"}}),[`${e}${e}-circle`]:{borderRadius:"50%"}}},LH=(n,e,t)=>{const{skeletonButtonCls:r}=n;return{[`${t}${r}-circle`]:{width:e,minWidth:e,borderRadius:"50%"},[`${t}${r}-round`]:{borderRadius:e}}},NH=(n,e)=>Object.assign({width:e(n).mul(2).equal(),minWidth:e(n).mul(2).equal()},Q7(n)),ubt=n=>{const{borderRadiusSM:e,skeletonButtonCls:t,controlHeight:r,controlHeightLG:i,controlHeightSM:o,gradientFromColor:s,calc:a}=n;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({[t]:Object.assign({display:"inline-block",verticalAlign:"top",background:s,borderRadius:e,width:a(r).mul(2).equal(),minWidth:a(r).mul(2).equal()},NH(r,a))},LH(n,r,t)),{[`${t}-lg`]:Object.assign({},NH(i,a))}),LH(n,i,`${t}-lg`)),{[`${t}-sm`]:Object.assign({},NH(o,a))}),LH(n,o,`${t}-sm`))},dbt=n=>{const{componentCls:e,skeletonAvatarCls:t,skeletonTitleCls:r,skeletonParagraphCls:i,skeletonButtonCls:o,skeletonInputCls:s,skeletonImageCls:a,controlHeight:c,controlHeightLG:l,controlHeightSM:u,gradientFromColor:d,padding:h,marginSM:f,borderRadius:p,titleHeight:g,blockRadius:m,paragraphLiHeight:v,controlHeightXS:b,paragraphMarginTop:S}=n;return{[e]:{display:"table",width:"100%",[`${e}-header`]:{display:"table-cell",paddingInlineEnd:h,verticalAlign:"top",[t]:Object.assign({display:"inline-block",verticalAlign:"top",background:d},VC(c)),[`${t}-circle`]:{borderRadius:"50%"},[`${t}-lg`]:Object.assign({},VC(l)),[`${t}-sm`]:Object.assign({},VC(u))},[`${e}-content`]:{display:"table-cell",width:"100%",verticalAlign:"top",[r]:{width:"100%",height:g,background:d,borderRadius:m,[`+ ${i}`]:{marginBlockStart:u}},[i]:{padding:0,"> li":{width:"100%",height:v,listStyle:"none",background:d,borderRadius:m,"+ li":{marginBlockStart:b}}},[`${i}> li:last-child:not(:first-child):not(:nth-child(2))`]:{width:"61%"}},[`&-round ${e}-content`]:{[`${r}, ${i} > li`]:{borderRadius:p}}},[`${e}-with-avatar ${e}-content`]:{[r]:{marginBlockStart:f,[`+ ${i}`]:{marginBlockStart:S}}},[`${e}${e}-element`]:Object.assign(Object.assign(Object.assign(Object.assign({display:"inline-block",width:"auto"},ubt(n)),abt(n)),cbt(n)),lbt(n)),[`${e}${e}-block`]:{width:"100%",[o]:{width:"100%"},[s]:{width:"100%"}},[`${e}${e}-active`]:{[`
        ${r},
        ${i} > li,
        ${t},
        ${o},
        ${s},
        ${a}
      `]:Object.assign({},sbt(n))}}},hbt=n=>{const{colorFillContent:e,colorFill:t}=n,r=e,i=t;return{color:r,colorGradientEnd:i,gradientFromColor:r,gradientToColor:i,titleHeight:n.controlHeight/2,blockRadius:n.borderRadiusSM,paragraphMarginTop:n.marginLG+n.marginXXS,paragraphLiHeight:n.controlHeight/2}},iE=Jc("Skeleton",n=>{const{componentCls:e,calc:t}=n,r=oo(n,{skeletonAvatarCls:`${e}-avatar`,skeletonTitleCls:`${e}-title`,skeletonParagraphCls:`${e}-paragraph`,skeletonButtonCls:`${e}-button`,skeletonInputCls:`${e}-input`,skeletonImageCls:`${e}-image`,imageSizeBase:t(n.controlHeight).mul(1.5).equal(),borderRadius:100,skeletonLoadingBackground:`linear-gradient(90deg, ${n.gradientFromColor} 25%, ${n.gradientToColor} 37%, ${n.gradientFromColor} 63%)`,skeletonLoadingMotionDuration:"1.4s"});return[dbt(r)]},hbt,{deprecatedTokens:[["color","gradientFromColor"],["colorGradientEnd","gradientToColor"]]}),fbt=n=>{const{prefixCls:e,className:t,rootClassName:r,active:i,shape:o="circle",size:s="default"}=n,{getPrefixCls:a}=y.useContext(fr),c=a("skeleton",e),[l,u,d]=iE(c),h=Yc(n,["prefixCls","className"]),f=Ue(c,`${c}-element`,{[`${c}-active`]:i},t,r,u,d);return l(y.createElement("div",{className:f},y.createElement(J7,Object.assign({prefixCls:`${c}-avatar`,shape:o,size:s},h))))},pbt=n=>{const{prefixCls:e,className:t,rootClassName:r,active:i,block:o=!1,size:s="default"}=n,{getPrefixCls:a}=y.useContext(fr),c=a("skeleton",e),[l,u,d]=iE(c),h=Yc(n,["prefixCls"]),f=Ue(c,`${c}-element`,{[`${c}-active`]:i,[`${c}-block`]:o},t,r,u,d);return l(y.createElement("div",{className:f},y.createElement(J7,Object.assign({prefixCls:`${c}-button`,size:s},h))))},gbt="M365.714286 329.142857q0 45.714286-32.036571 77.677714t-77.677714 32.036571-77.677714-32.036571-32.036571-77.677714 32.036571-77.677714 77.677714-32.036571 77.677714 32.036571 32.036571 77.677714zM950.857143 548.571429l0 256-804.571429 0 0-109.714286 182.857143-182.857143 91.428571 91.428571 292.571429-292.571429zM1005.714286 146.285714l-914.285714 0q-7.460571 0-12.873143 5.412571t-5.412571 12.873143l0 694.857143q0 7.460571 5.412571 12.873143t12.873143 5.412571l914.285714 0q7.460571 0 12.873143-5.412571t5.412571-12.873143l0-694.857143q0-7.460571-5.412571-12.873143t-12.873143-5.412571zM1097.142857 164.571429l0 694.857143q0 37.741714-26.843429 64.585143t-64.585143 26.843429l-914.285714 0q-37.741714 0-64.585143-26.843429t-26.843429-64.585143l0-694.857143q0-37.741714 26.843429-64.585143t64.585143-26.843429l914.285714 0q37.741714 0 64.585143 26.843429t26.843429 64.585143z",mbt=n=>{const{prefixCls:e,className:t,rootClassName:r,style:i,active:o}=n,{getPrefixCls:s}=y.useContext(fr),a=s("skeleton",e),[c,l,u]=iE(a),d=Ue(a,`${a}-element`,{[`${a}-active`]:o},t,r,l,u);return c(y.createElement("div",{className:d},y.createElement("div",{className:Ue(`${a}-image`,t),style:i},y.createElement("svg",{viewBox:"0 0 1098 1024",xmlns:"http://www.w3.org/2000/svg",className:`${a}-image-svg`},y.createElement("title",null,"Image placeholder"),y.createElement("path",{d:gbt,className:`${a}-image-path`})))))},vbt=n=>{const{prefixCls:e,className:t,rootClassName:r,active:i,block:o,size:s="default"}=n,{getPrefixCls:a}=y.useContext(fr),c=a("skeleton",e),[l,u,d]=iE(c),h=Yc(n,["prefixCls"]),f=Ue(c,`${c}-element`,{[`${c}-active`]:i,[`${c}-block`]:o},t,r,u,d);return l(y.createElement("div",{className:f},y.createElement(J7,Object.assign({prefixCls:`${c}-input`,size:s},h))))};var ybt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M888 792H200V168c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v688c0 4.4 3.6 8 8 8h752c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM288 604a64 64 0 10128 0 64 64 0 10-128 0zm118-224a48 48 0 1096 0 48 48 0 10-96 0zm158 228a96 96 0 10192 0 96 96 0 10-192 0zm148-314a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"dot-chart",theme:"outlined"},bbt=function(e,t){return y.createElement(_a,ln({},e,{ref:t,icon:ybt}))},Sbt=y.forwardRef(bbt);const _bt=n=>{const{prefixCls:e,className:t,rootClassName:r,style:i,active:o,children:s}=n,{getPrefixCls:a}=y.useContext(fr),c=a("skeleton",e),[l,u,d]=iE(c),h=Ue(c,`${c}-element`,{[`${c}-active`]:o},u,t,r,d),f=s??y.createElement(Sbt,null);return l(y.createElement("div",{className:h},y.createElement("div",{className:Ue(`${c}-image`,t),style:i},f)))},wbt=(n,e)=>{const{width:t,rows:r=2}=e;if(Array.isArray(t))return t[n];if(r-1===n)return t},Cbt=n=>{const{prefixCls:e,className:t,style:r,rows:i}=n,o=Ht(Array(i)).map((s,a)=>y.createElement("li",{key:a,style:{width:wbt(a,n)}}));return y.createElement("ul",{className:Ue(e,t),style:r},o)},xbt=n=>{let{prefixCls:e,className:t,width:r,style:i}=n;return y.createElement("h3",{className:Ue(e,t),style:Object.assign({width:r},i)})};function FH(n){return n&&typeof n=="object"?n:{}}function Ebt(n,e){return n&&!e?{size:"large",shape:"square"}:{size:"large",shape:"circle"}}function Ibt(n,e){return!n&&e?{width:"38%"}:n&&e?{width:"50%"}:{}}function Pbt(n,e){const t={};return(!n||!e)&&(t.width="61%"),!n&&e?t.rows=3:t.rows=2,t}const oE=n=>{const{prefixCls:e,loading:t,className:r,rootClassName:i,style:o,children:s,avatar:a=!1,title:c=!0,paragraph:l=!0,active:u,round:d}=n,{getPrefixCls:h,direction:f,skeleton:p}=y.useContext(fr),g=h("skeleton",e),[m,v,b]=iE(g);if(t||!("loading"in n)){const S=!!a,E=!!c,w=!!l;let C;if(S){const D=Object.assign(Object.assign({prefixCls:`${g}-avatar`},Ebt(E,w)),FH(a));C=y.createElement("div",{className:`${g}-header`},y.createElement(J7,Object.assign({},D)))}let I;if(E||w){let D;if(E){const M=Object.assign(Object.assign({prefixCls:`${g}-title`},Ibt(S,w)),FH(c));D=y.createElement(xbt,Object.assign({},M))}let O;if(w){const M=Object.assign(Object.assign({prefixCls:`${g}-paragraph`},Pbt(S,E)),FH(l));O=y.createElement(Cbt,Object.assign({},M))}I=y.createElement("div",{className:`${g}-content`},D,O)}const T=Ue(g,{[`${g}-with-avatar`]:S,[`${g}-active`]:u,[`${g}-rtl`]:f==="rtl",[`${g}-round`]:d},p==null?void 0:p.className,r,i,v,b);return m(y.createElement("div",{className:T,style:Object.assign(Object.assign({},p==null?void 0:p.style),o)},C,I))}return s??null};oE.Button=pbt;oE.Avatar=fbt;oE.Input=vbt;oE.Image=mbt;oE.Node=_bt;function Cve(){}const kbt=y.createContext({add:Cve,remove:Cve});function Tbt(n){const e=y.useContext(kbt),t=y.useRef();return ea(i=>{if(i){const o=n?i.querySelector(n):i;e.add(o),t.current=o}else e.remove(t.current)})}const xve=()=>{const{cancelButtonProps:n,cancelTextLocale:e,onCancel:t}=y.useContext(vD);return Ke.createElement(mg,Object.assign({onClick:t},n),e)},Eve=()=>{const{confirmLoading:n,okButtonProps:e,okType:t,okTextLocale:r,onOk:i}=y.useContext(vD);return Ke.createElement(mg,Object.assign({},s4e(t),{loading:n,onClick:i},e),r)};function D4e(n,e){return Ke.createElement("span",{className:`${n}-close-x`},e||Ke.createElement(fD,{className:`${n}-close-icon`}))}const R4e=n=>{const{okText:e,okType:t="primary",cancelText:r,confirmLoading:i,onOk:o,onCancel:s,okButtonProps:a,cancelButtonProps:c,footer:l}=n,[u]=uD("Modal",pAe()),d=e||(u==null?void 0:u.okText),h=r||(u==null?void 0:u.cancelText),f={confirmLoading:i,okButtonProps:a,cancelButtonProps:c,okTextLocale:d,cancelTextLocale:h,okType:t,onOk:o,onCancel:s},p=Ke.useMemo(()=>f,Ht(Object.values(f)));let g;return typeof l=="function"||typeof l>"u"?(g=Ke.createElement(Ke.Fragment,null,Ke.createElement(xve,null),Ke.createElement(Eve,null)),typeof l=="function"&&(g=l(g,{OkBtn:Eve,CancelBtn:xve})),g=Ke.createElement(f4e,{value:p},g)):g=l,Ke.createElement($ne,{disabled:!1},g)},A4e=n=>({[n.componentCls]:{[`${n.antCls}-motion-collapse-legacy`]:{overflow:"hidden","&-active":{transition:`height ${n.motionDurationMid} ${n.motionEaseInOut},
        opacity ${n.motionDurationMid} ${n.motionEaseInOut} !important`}},[`${n.antCls}-motion-collapse`]:{overflow:"hidden",transition:`height ${n.motionDurationMid} ${n.motionEaseInOut},
        opacity ${n.motionDurationMid} ${n.motionEaseInOut} !important`}}}),Dbt=n=>({animationDuration:n,animationFillMode:"both"}),Rbt=n=>({animationDuration:n,animationFillMode:"both"}),eN=function(n,e,t,r){const o=(arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1)?"&":"";return{[`
      ${o}${n}-enter,
      ${o}${n}-appear
    `]:Object.assign(Object.assign({},Dbt(r)),{animationPlayState:"paused"}),[`${o}${n}-leave`]:Object.assign(Object.assign({},Rbt(r)),{animationPlayState:"paused"}),[`
      ${o}${n}-enter${n}-enter-active,
      ${o}${n}-appear${n}-appear-active
    `]:{animationName:e,animationPlayState:"running"},[`${o}${n}-leave${n}-leave-active`]:{animationName:t,animationPlayState:"running",pointerEvents:"none"}}},Abt=new Oi("antFadeIn",{"0%":{opacity:0},"100%":{opacity:1}}),Obt=new Oi("antFadeOut",{"0%":{opacity:1},"100%":{opacity:0}}),Mbt=function(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{antCls:t}=n,r=`${t}-fade`,i=e?"&":"";return[eN(r,Abt,Obt,n.motionDurationMid,e),{[`
        ${i}${r}-enter,
        ${i}${r}-appear
      `]:{opacity:0,animationTimingFunction:"linear"},[`${i}${r}-leave`]:{animationTimingFunction:"linear"}}]},$bt=new Oi("antMoveDownIn",{"0%":{transform:"translate3d(0, 100%, 0)",transformOrigin:"0 0",opacity:0},"100%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1}}),Lbt=new Oi("antMoveDownOut",{"0%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1},"100%":{transform:"translate3d(0, 100%, 0)",transformOrigin:"0 0",opacity:0}}),Nbt=new Oi("antMoveLeftIn",{"0%":{transform:"translate3d(-100%, 0, 0)",transformOrigin:"0 0",opacity:0},"100%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1}}),Fbt=new Oi("antMoveLeftOut",{"0%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1},"100%":{transform:"translate3d(-100%, 0, 0)",transformOrigin:"0 0",opacity:0}}),jbt=new Oi("antMoveRightIn",{"0%":{transform:"translate3d(100%, 0, 0)",transformOrigin:"0 0",opacity:0},"100%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1}}),Bbt=new Oi("antMoveRightOut",{"0%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1},"100%":{transform:"translate3d(100%, 0, 0)",transformOrigin:"0 0",opacity:0}}),Hbt=new Oi("antMoveUpIn",{"0%":{transform:"translate3d(0, -100%, 0)",transformOrigin:"0 0",opacity:0},"100%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1}}),Ubt=new Oi("antMoveUpOut",{"0%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1},"100%":{transform:"translate3d(0, -100%, 0)",transformOrigin:"0 0",opacity:0}}),zbt={"move-up":{inKeyframes:Hbt,outKeyframes:Ubt},"move-down":{inKeyframes:$bt,outKeyframes:Lbt},"move-left":{inKeyframes:Nbt,outKeyframes:Fbt},"move-right":{inKeyframes:jbt,outKeyframes:Bbt}},E8=(n,e)=>{const{antCls:t}=n,r=`${t}-${e}`,{inKeyframes:i,outKeyframes:o}=zbt[e];return[eN(r,i,o,n.motionDurationMid),{[`
        ${r}-enter,
        ${r}-appear
      `]:{opacity:0,animationTimingFunction:n.motionEaseOutCirc},[`${r}-leave`]:{animationTimingFunction:n.motionEaseInOutCirc}}]},Jne=new Oi("antSlideUpIn",{"0%":{transform:"scaleY(0.8)",transformOrigin:"0% 0%",opacity:0},"100%":{transform:"scaleY(1)",transformOrigin:"0% 0%",opacity:1}}),Qne=new Oi("antSlideUpOut",{"0%":{transform:"scaleY(1)",transformOrigin:"0% 0%",opacity:1},"100%":{transform:"scaleY(0.8)",transformOrigin:"0% 0%",opacity:0}}),ere=new Oi("antSlideDownIn",{"0%":{transform:"scaleY(0.8)",transformOrigin:"100% 100%",opacity:0},"100%":{transform:"scaleY(1)",transformOrigin:"100% 100%",opacity:1}}),tre=new Oi("antSlideDownOut",{"0%":{transform:"scaleY(1)",transformOrigin:"100% 100%",opacity:1},"100%":{transform:"scaleY(0.8)",transformOrigin:"100% 100%",opacity:0}}),Vbt=new Oi("antSlideLeftIn",{"0%":{transform:"scaleX(0.8)",transformOrigin:"0% 0%",opacity:0},"100%":{transform:"scaleX(1)",transformOrigin:"0% 0%",opacity:1}}),Wbt=new Oi("antSlideLeftOut",{"0%":{transform:"scaleX(1)",transformOrigin:"0% 0%",opacity:1},"100%":{transform:"scaleX(0.8)",transformOrigin:"0% 0%",opacity:0}}),qbt=new Oi("antSlideRightIn",{"0%":{transform:"scaleX(0.8)",transformOrigin:"100% 0%",opacity:0},"100%":{transform:"scaleX(1)",transformOrigin:"100% 0%",opacity:1}}),Kbt=new Oi("antSlideRightOut",{"0%":{transform:"scaleX(1)",transformOrigin:"100% 0%",opacity:1},"100%":{transform:"scaleX(0.8)",transformOrigin:"100% 0%",opacity:0}}),Gbt={"slide-up":{inKeyframes:Jne,outKeyframes:Qne},"slide-down":{inKeyframes:ere,outKeyframes:tre},"slide-left":{inKeyframes:Vbt,outKeyframes:Wbt},"slide-right":{inKeyframes:qbt,outKeyframes:Kbt}},Q2=(n,e)=>{const{antCls:t}=n,r=`${t}-${e}`,{inKeyframes:i,outKeyframes:o}=Gbt[e];return[eN(r,i,o,n.motionDurationMid),{[`
      ${r}-enter,
      ${r}-appear
    `]:{transform:"scale(0)",transformOrigin:"0% 0%",opacity:0,animationTimingFunction:n.motionEaseOutQuint,"&-prepare":{transform:"scale(1)"}},[`${r}-leave`]:{animationTimingFunction:n.motionEaseInQuint}}]},nre=new Oi("antZoomIn",{"0%":{transform:"scale(0.2)",opacity:0},"100%":{transform:"scale(1)",opacity:1}}),Zbt=new Oi("antZoomOut",{"0%":{transform:"scale(1)"},"100%":{transform:"scale(0.2)",opacity:0}}),Ive=new Oi("antZoomBigIn",{"0%":{transform:"scale(0.8)",opacity:0},"100%":{transform:"scale(1)",opacity:1}}),Pve=new Oi("antZoomBigOut",{"0%":{transform:"scale(1)"},"100%":{transform:"scale(0.8)",opacity:0}}),Xbt=new Oi("antZoomUpIn",{"0%":{transform:"scale(0.8)",transformOrigin:"50% 0%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"50% 0%"}}),Ybt=new Oi("antZoomUpOut",{"0%":{transform:"scale(1)",transformOrigin:"50% 0%"},"100%":{transform:"scale(0.8)",transformOrigin:"50% 0%",opacity:0}}),Jbt=new Oi("antZoomLeftIn",{"0%":{transform:"scale(0.8)",transformOrigin:"0% 50%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"0% 50%"}}),Qbt=new Oi("antZoomLeftOut",{"0%":{transform:"scale(1)",transformOrigin:"0% 50%"},"100%":{transform:"scale(0.8)",transformOrigin:"0% 50%",opacity:0}}),e1t=new Oi("antZoomRightIn",{"0%":{transform:"scale(0.8)",transformOrigin:"100% 50%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"100% 50%"}}),t1t=new Oi("antZoomRightOut",{"0%":{transform:"scale(1)",transformOrigin:"100% 50%"},"100%":{transform:"scale(0.8)",transformOrigin:"100% 50%",opacity:0}}),n1t=new Oi("antZoomDownIn",{"0%":{transform:"scale(0.8)",transformOrigin:"50% 100%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"50% 100%"}}),r1t=new Oi("antZoomDownOut",{"0%":{transform:"scale(1)",transformOrigin:"50% 100%"},"100%":{transform:"scale(0.8)",transformOrigin:"50% 100%",opacity:0}}),i1t={zoom:{inKeyframes:nre,outKeyframes:Zbt},"zoom-big":{inKeyframes:Ive,outKeyframes:Pve},"zoom-big-fast":{inKeyframes:Ive,outKeyframes:Pve},"zoom-left":{inKeyframes:Jbt,outKeyframes:Qbt},"zoom-right":{inKeyframes:e1t,outKeyframes:t1t},"zoom-up":{inKeyframes:Xbt,outKeyframes:Ybt},"zoom-down":{inKeyframes:n1t,outKeyframes:r1t}},tN=(n,e)=>{const{antCls:t}=n,r=`${t}-${e}`,{inKeyframes:i,outKeyframes:o}=i1t[e];return[eN(r,i,o,e==="zoom-big-fast"?n.motionDurationFast:n.motionDurationMid),{[`
        ${r}-enter,
        ${r}-appear
      `]:{transform:"scale(0)",opacity:0,animationTimingFunction:n.motionEaseOutCirc,"&-prepare":{transform:"none"}},[`${r}-leave`]:{animationTimingFunction:n.motionEaseInOutCirc}}]};function kve(n){return{position:n,inset:0}}const o1t=n=>{const{componentCls:e,antCls:t}=n;return[{[`${e}-root`]:{[`${e}${t}-zoom-enter, ${e}${t}-zoom-appear`]:{transform:"none",opacity:0,animationDuration:n.motionDurationSlow,userSelect:"none"},[`${e}${t}-zoom-leave ${e}-content`]:{pointerEvents:"none"},[`${e}-mask`]:Object.assign(Object.assign({},kve("fixed")),{zIndex:n.zIndexPopupBase,height:"100%",backgroundColor:n.colorBgMask,pointerEvents:"none",[`${e}-hidden`]:{display:"none"}}),[`${e}-wrap`]:Object.assign(Object.assign({},kve("fixed")),{zIndex:n.zIndexPopupBase,overflow:"auto",outline:0,WebkitOverflowScrolling:"touch"})}},{[`${e}-root`]:Mbt(n)}]},s1t=n=>{const{componentCls:e}=n;return[{[`${e}-root`]:{[`${e}-wrap-rtl`]:{direction:"rtl"},[`${e}-centered`]:{textAlign:"center","&::before":{display:"inline-block",width:0,height:"100%",verticalAlign:"middle",content:'""'},[e]:{top:0,display:"inline-block",paddingBottom:0,textAlign:"start",verticalAlign:"middle"}},[`@media (max-width: ${n.screenSMMax}px)`]:{[e]:{maxWidth:"calc(100vw - 16px)",margin:`${Ct(n.marginXS)} auto`},[`${e}-centered`]:{[e]:{flex:1}}}}},{[e]:Object.assign(Object.assign({},gc(n)),{pointerEvents:"none",position:"relative",top:100,width:"auto",maxWidth:`calc(100vw - ${Ct(n.calc(n.margin).mul(2).equal())})`,margin:"0 auto",paddingBottom:n.paddingLG,[`${e}-title`]:{margin:0,color:n.titleColor,fontWeight:n.fontWeightStrong,fontSize:n.titleFontSize,lineHeight:n.titleLineHeight,wordWrap:"break-word"},[`${e}-content`]:{position:"relative",backgroundColor:n.contentBg,backgroundClip:"padding-box",border:0,borderRadius:n.borderRadiusLG,boxShadow:n.boxShadow,pointerEvents:"auto",padding:n.contentPadding},[`${e}-close`]:Object.assign({position:"absolute",top:n.calc(n.modalHeaderHeight).sub(n.modalCloseBtnSize).div(2).equal(),insetInlineEnd:n.calc(n.modalHeaderHeight).sub(n.modalCloseBtnSize).div(2).equal(),zIndex:n.calc(n.zIndexPopupBase).add(10).equal(),padding:0,color:n.modalCloseIconColor,fontWeight:n.fontWeightStrong,lineHeight:1,textDecoration:"none",background:"transparent",borderRadius:n.borderRadiusSM,width:n.modalCloseBtnSize,height:n.modalCloseBtnSize,border:0,outline:0,cursor:"pointer",transition:`color ${n.motionDurationMid}, background-color ${n.motionDurationMid}`,"&-x":{display:"flex",fontSize:n.fontSizeLG,fontStyle:"normal",lineHeight:Ct(n.modalCloseBtnSize),justifyContent:"center",textTransform:"none",textRendering:"auto"},"&:hover":{color:n.modalCloseIconHoverColor,backgroundColor:n.colorBgTextHover,textDecoration:"none"},"&:active":{backgroundColor:n.colorBgTextActive}},S8(n)),[`${e}-header`]:{color:n.colorText,background:n.headerBg,borderRadius:`${Ct(n.borderRadiusLG)} ${Ct(n.borderRadiusLG)} 0 0`,marginBottom:n.headerMarginBottom,padding:n.headerPadding,borderBottom:n.headerBorderBottom},[`${e}-body`]:{fontSize:n.fontSize,lineHeight:n.lineHeight,wordWrap:"break-word",padding:n.bodyPadding,[`${e}-body-skeleton`]:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",margin:`${Ct(n.margin)} auto`}},[`${e}-footer`]:{textAlign:"end",background:n.footerBg,marginTop:n.footerMarginTop,padding:n.footerPadding,borderTop:n.footerBorderTop,borderRadius:n.footerBorderRadius,[`> ${n.antCls}-btn + ${n.antCls}-btn`]:{marginInlineStart:n.marginXS}},[`${e}-open`]:{overflow:"hidden"}})},{[`${e}-pure-panel`]:{top:"auto",padding:0,display:"flex",flexDirection:"column",[`${e}-content,
          ${e}-body,
          ${e}-confirm-body-wrapper`]:{display:"flex",flexDirection:"column",flex:"auto"},[`${e}-confirm-body`]:{marginBottom:"auto"}}}]},a1t=n=>{const{componentCls:e}=n;return{[`${e}-root`]:{[`${e}-wrap-rtl`]:{direction:"rtl",[`${e}-confirm-body`]:{direction:"rtl"}}}}},O4e=n=>{const e=n.padding,t=n.fontSizeHeading5,r=n.lineHeightHeading5;return oo(n,{modalHeaderHeight:n.calc(n.calc(r).mul(t).equal()).add(n.calc(e).mul(2).equal()).equal(),modalFooterBorderColorSplit:n.colorSplit,modalFooterBorderStyle:n.lineType,modalFooterBorderWidth:n.lineWidth,modalCloseIconColor:n.colorIcon,modalCloseIconHoverColor:n.colorIconHover,modalCloseBtnSize:n.controlHeight,modalConfirmIconSize:n.fontHeight,modalTitleHeight:n.calc(n.titleFontSize).mul(n.titleLineHeight).equal()})},M4e=n=>({footerBg:"transparent",headerBg:n.colorBgElevated,titleLineHeight:n.lineHeightHeading5,titleFontSize:n.fontSizeHeading5,contentBg:n.colorBgElevated,titleColor:n.colorTextHeading,contentPadding:n.wireframe?0:`${Ct(n.paddingMD)} ${Ct(n.paddingContentHorizontalLG)}`,headerPadding:n.wireframe?`${Ct(n.padding)} ${Ct(n.paddingLG)}`:0,headerBorderBottom:n.wireframe?`${Ct(n.lineWidth)} ${n.lineType} ${n.colorSplit}`:"none",headerMarginBottom:n.wireframe?0:n.marginXS,bodyPadding:n.wireframe?n.paddingLG:0,footerPadding:n.wireframe?`${Ct(n.paddingXS)} ${Ct(n.padding)}`:0,footerBorderTop:n.wireframe?`${Ct(n.lineWidth)} ${n.lineType} ${n.colorSplit}`:"none",footerBorderRadius:n.wireframe?`0 0 ${Ct(n.borderRadiusLG)} ${Ct(n.borderRadiusLG)}`:0,footerMarginTop:n.wireframe?0:n.marginSM,confirmBodyPadding:n.wireframe?`${Ct(n.padding*2)} ${Ct(n.padding*2)} ${Ct(n.paddingLG)}`:0,confirmIconMarginInlineEnd:n.wireframe?n.margin:n.marginSM,confirmBtnsMarginTop:n.wireframe?n.marginLG:n.marginSM}),$4e=Jc("Modal",n=>{const e=O4e(n);return[s1t(e),a1t(e),o1t(e),tN(e,"zoom")]},M4e,{unitless:{titleLineHeight:!0}});var c1t=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t};let hZ;const l1t=n=>{hZ={x:n.pageX,y:n.pageY},setTimeout(()=>{hZ=null},100)};ibt()&&document.documentElement.addEventListener("click",l1t,!0);const L4e=n=>{var e;const{getPopupContainer:t,getPrefixCls:r,direction:i,modal:o}=y.useContext(fr),s=G=>{const{onCancel:te}=n;te==null||te(G)},a=G=>{const{onOk:te}=n;te==null||te(G)},{prefixCls:c,className:l,rootClassName:u,open:d,wrapClassName:h,centered:f,getContainer:p,focusTriggerAfterClose:g=!0,style:m,visible:v,width:b=520,footer:S,classNames:E,styles:w,children:C,loading:I}=n,T=c1t(n,["prefixCls","className","rootClassName","open","wrapClassName","centered","getContainer","focusTriggerAfterClose","style","visible","width","footer","classNames","styles","children","loading"]),D=r("modal",c),O=r(),M=Qc(D),[R,A,k]=$4e(D,M),L=Ue(h,{[`${D}-centered`]:!!f,[`${D}-wrap-rtl`]:i==="rtl"}),j=S!==null&&!I?y.createElement(R4e,Object.assign({},n,{onOk:a,onCancel:s})):null,[N,B]=rbt(bve(n),bve(o),{closable:!0,closeIcon:y.createElement(fD,{className:`${D}-close-icon`}),closeIconRender:G=>D4e(D,G)}),U=Tbt(`.${D}-content`),[K,z]=pD("Modal",T.zIndex);return R(y.createElement(k3,{form:!0,space:!0},y.createElement(K7.Provider,{value:z},y.createElement(b4e,Object.assign({width:b},T,{zIndex:K,getContainer:p===void 0?t:p,prefixCls:D,rootClassName:Ue(A,u,k,M),footer:j,visible:d??v,mousePosition:(e=T.mousePosition)!==null&&e!==void 0?e:hZ,onClose:s,closable:N,closeIcon:B,focusTriggerAfterClose:g,transitionName:J2(O,"zoom",n.transitionName),maskTransitionName:J2(O,"fade",n.maskTransitionName),className:Ue(A,l,o==null?void 0:o.className),style:Object.assign(Object.assign({},o==null?void 0:o.style),m),classNames:Object.assign(Object.assign(Object.assign({},o==null?void 0:o.classNames),E),{wrapper:Ue(L,E==null?void 0:E.wrapper)}),styles:Object.assign(Object.assign({},o==null?void 0:o.styles),w),panelRef:U}),I?y.createElement(oE,{active:!0,title:!1,paragraph:{rows:4},className:`${D}-body-skeleton`}):C))))},u1t=n=>{const{componentCls:e,titleFontSize:t,titleLineHeight:r,modalConfirmIconSize:i,fontSize:o,lineHeight:s,modalTitleHeight:a,fontHeight:c,confirmBodyPadding:l}=n,u=`${e}-confirm`;return{[u]:{"&-rtl":{direction:"rtl"},[`${n.antCls}-modal-header`]:{display:"none"},[`${u}-body-wrapper`]:Object.assign({},b8()),[`&${e} ${e}-body`]:{padding:l},[`${u}-body`]:{display:"flex",flexWrap:"nowrap",alignItems:"start",[`> ${n.iconCls}`]:{flex:"none",fontSize:i,marginInlineEnd:n.confirmIconMarginInlineEnd,marginTop:n.calc(n.calc(c).sub(i).equal()).div(2).equal()},[`&-has-title > ${n.iconCls}`]:{marginTop:n.calc(n.calc(a).sub(i).equal()).div(2).equal()}},[`${u}-paragraph`]:{display:"flex",flexDirection:"column",flex:"auto",rowGap:n.marginXS},[`${n.iconCls} + ${u}-paragraph`]:{maxWidth:`calc(100% - ${Ct(n.calc(n.modalConfirmIconSize).add(n.marginSM).equal())})`},[`${u}-title`]:{color:n.colorTextHeading,fontWeight:n.fontWeightStrong,fontSize:t,lineHeight:r},[`${u}-content`]:{color:n.colorText,fontSize:o,lineHeight:s},[`${u}-btns`]:{textAlign:"end",marginTop:n.confirmBtnsMarginTop,[`${n.antCls}-btn + ${n.antCls}-btn`]:{marginBottom:0,marginInlineStart:n.marginXS}}},[`${u}-error ${u}-body > ${n.iconCls}`]:{color:n.colorError},[`${u}-warning ${u}-body > ${n.iconCls},
        ${u}-confirm ${u}-body > ${n.iconCls}`]:{color:n.colorWarning},[`${u}-info ${u}-body > ${n.iconCls}`]:{color:n.colorInfo},[`${u}-success ${u}-body > ${n.iconCls}`]:{color:n.colorSuccess}}},d1t=Lne(["Modal","confirm"],n=>{const e=O4e(n);return[u1t(e)]},M4e,{order:-1e3});var h1t=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t};function N4e(n){const{prefixCls:e,icon:t,okText:r,cancelText:i,confirmPrefixCls:o,type:s,okCancel:a,footer:c,locale:l}=n,u=h1t(n,["prefixCls","icon","okText","cancelText","confirmPrefixCls","type","okCancel","footer","locale"]);let d=t;if(!t&&t!==null)switch(s){case"info":d=y.createElement(KAe,null);break;case"success":d=y.createElement(jne,null);break;case"error":d=y.createElement(hD,null);break;default:d=y.createElement(Bne,null)}const h=a??s==="confirm",f=n.autoFocusButton===null?!1:n.autoFocusButton||"ok",[p]=uD("Modal"),g=l||p,m=r||(h?g==null?void 0:g.okText:g==null?void 0:g.justOkText),v=i||(g==null?void 0:g.cancelText),b=Object.assign({autoFocusButton:f,cancelTextLocale:v,okTextLocale:m,mergedOkCancel:h},u),S=y.useMemo(()=>b,Ht(Object.values(b))),E=y.createElement(y.Fragment,null,y.createElement(Qme,null),y.createElement(eve,null)),w=n.title!==void 0&&n.title!==null,C=`${o}-body`;return y.createElement("div",{className:`${o}-body-wrapper`},y.createElement("div",{className:Ue(C,{[`${C}-has-title`]:w})},d,y.createElement("div",{className:`${o}-paragraph`},w&&y.createElement("span",{className:`${o}-title`},n.title),y.createElement("div",{className:`${o}-content`},n.content))),c===void 0||typeof c=="function"?y.createElement(f4e,{value:S},y.createElement("div",{className:`${o}-btns`},typeof c=="function"?c(E,{OkBtn:eve,CancelBtn:Qme}):E)):c,y.createElement(d1t,{prefixCls:e}))}const f1t=n=>{const{close:e,zIndex:t,afterClose:r,open:i,keyboard:o,centered:s,getContainer:a,maskStyle:c,direction:l,prefixCls:u,wrapClassName:d,rootPrefixCls:h,bodyStyle:f,closable:p=!1,closeIcon:g,modalRender:m,focusTriggerAfterClose:v,onConfirm:b,styles:S}=n,E=`${u}-confirm`,w=n.width||416,C=n.style||{},I=n.mask===void 0?!0:n.mask,T=n.maskClosable===void 0?!1:n.maskClosable,D=Ue(E,`${E}-${n.type}`,{[`${E}-rtl`]:l==="rtl"},n.className),[,O]=Gu(),M=y.useMemo(()=>t!==void 0?t:O.zIndexPopupBase+YAe,[t,O]);return y.createElement(L4e,{prefixCls:u,className:D,wrapClassName:Ue({[`${E}-centered`]:!!n.centered},d),onCancel:()=>{e==null||e({triggerCancel:!0}),b==null||b(!1)},open:i,title:"",footer:null,transitionName:J2(h||"","zoom",n.transitionName),maskTransitionName:J2(h||"","fade",n.maskTransitionName),mask:I,maskClosable:T,style:C,styles:Object.assign({body:f,mask:c},S),width:w,zIndex:M,afterClose:r,keyboard:o,centered:s,getContainer:a,closable:p,closeIcon:g,modalRender:m,focusTriggerAfterClose:v},y.createElement(N4e,Object.assign({},n,{confirmPrefixCls:E})))},F4e=n=>{const{rootPrefixCls:e,iconPrefixCls:t,direction:r,theme:i}=n;return y.createElement(Sv,{prefixCls:e,iconPrefixCls:t,direction:r,theme:i},y.createElement(f1t,Object.assign({},n)))},D1=[];let j4e="";function B4e(){return j4e}const p1t=n=>{var e,t;const{prefixCls:r,getContainer:i,direction:o}=n,s=pAe(),a=y.useContext(fr),c=B4e()||a.getPrefixCls(),l=r||`${c}-modal`;let u=i;return u===!1&&(u=void 0),Ke.createElement(F4e,Object.assign({},n,{rootPrefixCls:c,prefixCls:l,iconPrefixCls:a.iconPrefixCls,theme:a.theme,direction:o??a.direction,locale:(t=(e=a.locale)===null||e===void 0?void 0:e.Modal)!==null&&t!==void 0?t:s,getContainer:u}))};function bD(n){const e=Fne(),t=document.createDocumentFragment();let r=Object.assign(Object.assign({},n),{close:a,open:!0}),i;function o(){for(var l,u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];if(d.some(g=>g==null?void 0:g.triggerCancel)){var p;(l=n.onCancel)===null||l===void 0||(p=l).call.apply(p,[n,()=>{}].concat(Ht(d.slice(1))))}for(let g=0;g<D1.length;g++)if(D1[g]===a){D1.splice(g,1);break}n4e(t)}function s(l){clearTimeout(i),i=setTimeout(()=>{const u=e.getPrefixCls(void 0,B4e()),d=e.getIconPrefixCls(),h=e.getTheme(),f=Ke.createElement(p1t,Object.assign({},l));Une(Ke.createElement(Sv,{prefixCls:u,iconPrefixCls:d,theme:h},e.holderRender?e.holderRender(f):f),t)})}function a(){for(var l=arguments.length,u=new Array(l),d=0;d<l;d++)u[d]=arguments[d];r=Object.assign(Object.assign({},r),{open:!1,afterClose:()=>{typeof n.afterClose=="function"&&n.afterClose(),o.apply(this,u)}}),r.visible&&delete r.visible,s(r)}function c(l){typeof l=="function"?r=l(r):r=Object.assign(Object.assign({},r),l),s(r)}return s(r),D1.push(a),{destroy:a,update:c}}function H4e(n){return Object.assign(Object.assign({},n),{type:"warning"})}function U4e(n){return Object.assign(Object.assign({},n),{type:"info"})}function z4e(n){return Object.assign(Object.assign({},n),{type:"success"})}function V4e(n){return Object.assign(Object.assign({},n),{type:"error"})}function W4e(n){return Object.assign(Object.assign({},n),{type:"confirm"})}function g1t(n){let{rootPrefixCls:e}=n;j4e=e}var m1t=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t};const v1t=(n,e)=>{var t,{afterClose:r,config:i}=n,o=m1t(n,["afterClose","config"]);const[s,a]=y.useState(!0),[c,l]=y.useState(i),{direction:u,getPrefixCls:d}=y.useContext(fr),h=d("modal"),f=d(),p=()=>{var b;r(),(b=c.afterClose)===null||b===void 0||b.call(c)},g=function(){var b;a(!1);for(var S=arguments.length,E=new Array(S),w=0;w<S;w++)E[w]=arguments[w];if(E.some(T=>T==null?void 0:T.triggerCancel)){var I;(b=c.onCancel)===null||b===void 0||(I=b).call.apply(I,[c,()=>{}].concat(Ht(E.slice(1))))}};y.useImperativeHandle(e,()=>({destroy:g,update:b=>{l(S=>Object.assign(Object.assign({},S),b))}}));const m=(t=c.okCancel)!==null&&t!==void 0?t:c.type==="confirm",[v]=uD("Modal",xy.Modal);return y.createElement(F4e,Object.assign({prefixCls:h,rootPrefixCls:f},c,{close:g,open:s,afterClose:p,okText:c.okText||(m?v==null?void 0:v.okText:v==null?void 0:v.justOkText),direction:c.direction||u,cancelText:c.cancelText||(v==null?void 0:v.cancelText)},o))},y1t=y.forwardRef(v1t);let Tve=0;const b1t=y.memo(y.forwardRef((n,e)=>{const[t,r]=Yvt();return y.useImperativeHandle(e,()=>({patchElement:r}),[]),y.createElement(y.Fragment,null,t)}));function S1t(){const n=y.useRef(null),[e,t]=y.useState([]);y.useEffect(()=>{e.length&&(Ht(e).forEach(s=>{s()}),t([]))},[e]);const r=y.useCallback(o=>function(a){var c;Tve+=1;const l=y.createRef();let u;const d=new Promise(m=>{u=m});let h=!1,f;const p=y.createElement(y1t,{key:`modal-${Tve}`,config:o(a),ref:l,afterClose:()=>{f==null||f()},isSilent:()=>h,onConfirm:m=>{u(m)}});return f=(c=n.current)===null||c===void 0?void 0:c.patchElement(p),f&&D1.push(f),{destroy:()=>{function m(){var v;(v=l.current)===null||v===void 0||v.destroy()}l.current?m():t(v=>[].concat(Ht(v),[m]))},update:m=>{function v(){var b;(b=l.current)===null||b===void 0||b.update(m)}l.current?v():t(b=>[].concat(Ht(b),[v]))},then:m=>(h=!0,d.then(m))}},[]);return[y.useMemo(()=>({info:r(U4e),success:r(z4e),error:r(V4e),warning:r(H4e),confirm:r(W4e)}),[]),y.createElement(b1t,{key:"modal-holder",ref:n})]}const _1t=Ke.createContext({});function q4e(n){return e=>y.createElement(Sv,{theme:{token:{motion:!1,zIndexPopupBase:0}}},y.createElement(n,Object.assign({},e)))}const K4e=(n,e,t,r)=>q4e(o=>{const{prefixCls:s,style:a}=o,c=y.useRef(null),[l,u]=y.useState(0),[d,h]=y.useState(0),[f,p]=Ql(!1,{value:o.open}),{getPrefixCls:g}=y.useContext(fr),m=g(e||"select",s);y.useEffect(()=>{if(p(!0),typeof ResizeObserver<"u"){const S=new ResizeObserver(w=>{const C=w[0].target;u(C.offsetHeight+8),h(C.offsetWidth)}),E=setInterval(()=>{var w;const C=t?`.${t(m)}`:`.${m}-dropdown`,I=(w=c.current)===null||w===void 0?void 0:w.querySelector(C);I&&(clearInterval(E),S.observe(I))},10);return()=>{clearInterval(E),S.disconnect()}}},[]);let v=Object.assign(Object.assign({},o),{style:Object.assign(Object.assign({},a),{margin:0}),open:f,visible:f,getPopupContainer:()=>c.current});r&&(v=r(v));const b={paddingBottom:l,position:"relative",minWidth:d};return y.createElement("div",{ref:c,style:b},y.createElement(n,Object.assign({},v)))}),G4e=function(){if(typeof navigator>"u"||typeof window>"u")return!1;var n=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(n)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(n==null?void 0:n.substr(0,4))};var nN=function(e){var t=e.className,r=e.customizeIcon,i=e.customizeIconProps,o=e.children,s=e.onMouseDown,a=e.onClick,c=typeof r=="function"?r(i):r;return y.createElement("span",{className:t,onMouseDown:function(u){u.preventDefault(),s==null||s(u)},style:{userSelect:"none",WebkitUserSelect:"none"},unselectable:"on",onClick:a,"aria-hidden":!0},c!==void 0?c:y.createElement("span",{className:Ue(t.split(/\s+/).map(function(l){return"".concat(l,"-icon")}))},o))},w1t=function(e,t,r,i,o){var s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!1,a=arguments.length>6?arguments[6]:void 0,c=arguments.length>7?arguments[7]:void 0,l=Ke.useMemo(function(){if(Wn(i)==="object")return i.clearIcon;if(o)return o},[i,o]),u=Ke.useMemo(function(){return!!(!s&&i&&(r.length||a)&&!(c==="combobox"&&a===""))},[i,s,r.length,a,c]);return{allowClear:u,clearIcon:Ke.createElement(nN,{className:"".concat(e,"-clear"),onMouseDown:t,customizeIcon:l},"×")}},Z4e=y.createContext(null);function C1t(){return y.useContext(Z4e)}function x1t(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:10,e=y.useState(!1),t=rt(e,2),r=t[0],i=t[1],o=y.useRef(null),s=function(){window.clearTimeout(o.current)};y.useEffect(function(){return s},[]);var a=function(l,u){s(),o.current=window.setTimeout(function(){i(l),u&&u()},n)};return[r,a,s]}function X4e(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:250,e=y.useRef(null),t=y.useRef(null);y.useEffect(function(){return function(){window.clearTimeout(t.current)}},[]);function r(i){(i||e.current===null)&&(e.current=i),window.clearTimeout(t.current),t.current=window.setTimeout(function(){e.current=null},n)}return[function(){return e.current},r]}function E1t(n,e,t,r){var i=y.useRef(null);i.current={open:e,triggerOpen:t,customizedTrigger:r},y.useEffect(function(){function o(s){var a;if(!((a=i.current)!==null&&a!==void 0&&a.customizedTrigger)){var c=s.target;c.shadowRoot&&s.composed&&(c=s.composedPath()[0]||c),i.current.open&&n().filter(function(l){return l}).every(function(l){return!l.contains(c)&&l!==c})&&i.current.triggerOpen(!1)}}return window.addEventListener("mousedown",o),function(){return window.removeEventListener("mousedown",o)}},[])}function I1t(n){return![Bt.ESC,Bt.SHIFT,Bt.BACKSPACE,Bt.TAB,Bt.WIN_KEY,Bt.ALT,Bt.META,Bt.WIN_KEY_RIGHT,Bt.CTRL,Bt.SEMICOLON,Bt.EQUALS,Bt.CAPS_LOCK,Bt.CONTEXT_MENU,Bt.F1,Bt.F2,Bt.F3,Bt.F4,Bt.F5,Bt.F6,Bt.F7,Bt.F8,Bt.F9,Bt.F10,Bt.F11,Bt.F12].includes(n)}var P1t=["prefixCls","invalidate","item","renderItem","responsive","responsiveDisabled","registerSize","itemKey","className","style","children","display","order","component"],nw=void 0;function k1t(n,e){var t=n.prefixCls,r=n.invalidate,i=n.item,o=n.renderItem,s=n.responsive,a=n.responsiveDisabled,c=n.registerSize,l=n.itemKey,u=n.className,d=n.style,h=n.children,f=n.display,p=n.order,g=n.component,m=g===void 0?"div":g,v=jr(n,P1t),b=s&&!f;function S(T){c(l,T)}y.useEffect(function(){return function(){S(null)}},[]);var E=o&&i!==nw?o(i):h,w;r||(w={opacity:b?0:1,height:b?0:nw,overflowY:b?"hidden":nw,order:s?p:nw,pointerEvents:b?"none":nw,position:b?"absolute":nw});var C={};b&&(C["aria-hidden"]=!0);var I=y.createElement(m,ln({className:Ue(!r&&t,u),style:$e($e({},w),d)},C,v,{ref:e}),E);return s&&(I=y.createElement(Wy,{onResize:function(D){var O=D.offsetWidth;S(O)},disabled:a},I)),I}var lk=y.forwardRef(k1t);lk.displayName="Item";function T1t(n){if(typeof MessageChannel>"u")no(n);else{var e=new MessageChannel;e.port1.onmessage=function(){return n()},e.port2.postMessage(void 0)}}function D1t(){var n=y.useRef(null),e=function(r){n.current||(n.current=[],T1t(function(){Wu.unstable_batchedUpdates(function(){n.current.forEach(function(i){i()}),n.current=null})})),n.current.push(r)};return e}function uI(n,e){var t=y.useState(e),r=rt(t,2),i=r[0],o=r[1],s=ea(function(a){n(function(){o(a)})});return[i,s]}var I8=Ke.createContext(null),R1t=["component"],A1t=["className"],O1t=["className"],M1t=function(e,t){var r=y.useContext(I8);if(!r){var i=e.component,o=i===void 0?"div":i,s=jr(e,R1t);return y.createElement(o,ln({},s,{ref:t}))}var a=r.className,c=jr(r,A1t),l=e.className,u=jr(e,O1t);return y.createElement(I8.Provider,{value:null},y.createElement(lk,ln({ref:t,className:Ue(a,l)},c,u)))},Y4e=y.forwardRef(M1t);Y4e.displayName="RawItem";var $1t=["prefixCls","data","renderItem","renderRawItem","itemKey","itemWidth","ssr","style","className","maxCount","renderRest","renderRawRest","suffix","component","itemComponent","onVisibleChange"],J4e="responsive",Q4e="invalidate";function L1t(n){return"+ ".concat(n.length," ...")}function N1t(n,e){var t=n.prefixCls,r=t===void 0?"rc-overflow":t,i=n.data,o=i===void 0?[]:i,s=n.renderItem,a=n.renderRawItem,c=n.itemKey,l=n.itemWidth,u=l===void 0?10:l,d=n.ssr,h=n.style,f=n.className,p=n.maxCount,g=n.renderRest,m=n.renderRawRest,v=n.suffix,b=n.component,S=b===void 0?"div":b,E=n.itemComponent,w=n.onVisibleChange,C=jr(n,$1t),I=d==="full",T=D1t(),D=uI(T,null),O=rt(D,2),M=O[0],R=O[1],A=M||0,k=uI(T,new Map),L=rt(k,2),j=L[0],N=L[1],B=uI(T,0),U=rt(B,2),K=U[0],z=U[1],G=uI(T,0),te=rt(G,2),ie=te[0],Q=te[1],ge=uI(T,0),_e=rt(ge,2),Se=_e[0],se=_e[1],ee=y.useState(null),Y=rt(ee,2),ue=Y[0],ye=Y[1],V=y.useState(null),le=rt(V,2),he=le[0],oe=le[1],ne=y.useMemo(function(){return he===null&&I?Number.MAX_SAFE_INTEGER:he||0},[he,M]),ce=y.useState(!1),Ae=rt(ce,2),Ie=Ae[0],be=Ae[1],De="".concat(r,"-item"),Me=Math.max(K,ie),He=p===J4e,Je=o.length&&He,qe=p===Q4e,Ge=Je||typeof p=="number"&&o.length>p,St=y.useMemo(function(){var it=o;return Je?M===null&&I?it=o:it=o.slice(0,Math.min(o.length,A/u)):typeof p=="number"&&(it=o.slice(0,p)),it},[o,u,M,p,Je]),Pt=y.useMemo(function(){return Je?o.slice(ne+1):o.slice(St.length)},[o,St,Je,ne]),on=y.useCallback(function(it,at){var Lt;return typeof c=="function"?c(it):(Lt=c&&(it==null?void 0:it[c]))!==null&&Lt!==void 0?Lt:at},[c]),an=y.useCallback(s||function(it){return it},[s]);function Rt(it,at,Lt){he===it&&(at===void 0||at===ue)||(oe(it),Lt||(be(it<o.length-1),w==null||w(it)),at!==void 0&&ye(at))}function Xt(it,at){R(at.clientWidth)}function yn(it,at){N(function(Lt){var fn=new Map(Lt);return at===null?fn.delete(it):fn.set(it,at),fn})}function bn(it,at){Q(at),z(ie)}function Kn(it,at){se(at)}function lr(it){return j.get(on(St[it],it))}es(function(){if(A&&typeof Me=="number"&&St){var it=Se,at=St.length,Lt=at-1;if(!at){Rt(0,null);return}for(var fn=0;fn<at;fn+=1){var hn=lr(fn);if(I&&(hn=hn||0),hn===void 0){Rt(fn-1,void 0,!0);break}if(it+=hn,Lt===0&&it<=A||fn===Lt-1&&it+lr(Lt)<=A){Rt(Lt,null);break}else if(it+Me>A){Rt(fn-1,it-hn-Se+ie);break}}v&&lr(0)+Se>A&&ye(null)}},[A,j,ie,Se,on,St]);var Rr=Ie&&!!Pt.length,Lr={};ue!==null&&Je&&(Lr={position:"absolute",left:ue,top:0});var er={prefixCls:De,responsive:Je,component:E,invalidate:qe},ke=a?function(it,at){var Lt=on(it,at);return y.createElement(I8.Provider,{key:Lt,value:$e($e({},er),{},{order:at,item:it,itemKey:Lt,registerSize:yn,display:at<=ne})},a(it,at))}:function(it,at){var Lt=on(it,at);return y.createElement(lk,ln({},er,{order:at,key:Lt,item:it,renderItem:an,itemKey:Lt,registerSize:yn,display:at<=ne}))},Qn,Gn={order:Rr?ne:Number.MAX_SAFE_INTEGER,className:"".concat(De,"-rest"),registerSize:bn,display:Rr};if(m)m&&(Qn=y.createElement(I8.Provider,{value:$e($e({},er),Gn)},m(Pt)));else{var J=g||L1t;Qn=y.createElement(lk,ln({},er,Gn),typeof J=="function"?J(Pt):J)}var ze=y.createElement(S,ln({className:Ue(!qe&&r,f),style:h,ref:e},C),St.map(ke),Ge?Qn:null,v&&y.createElement(lk,ln({},er,{responsive:He,responsiveDisabled:!Je,order:ne,className:"".concat(De,"-suffix"),registerSize:Kn,display:!0,style:Lr}),v));return He&&(ze=y.createElement(Wy,{onResize:Xt,disabled:!Je},ze)),ze}var rg=y.forwardRef(N1t);rg.displayName="Overflow";rg.Item=Y4e;rg.RESPONSIVE=J4e;rg.INVALIDATE=Q4e;var F1t=function(e,t){var r,i=e.prefixCls,o=e.id,s=e.inputElement,a=e.disabled,c=e.tabIndex,l=e.autoFocus,u=e.autoComplete,d=e.editable,h=e.activeDescendantId,f=e.value,p=e.maxLength,g=e.onKeyDown,m=e.onMouseDown,v=e.onChange,b=e.onPaste,S=e.onCompositionStart,E=e.onCompositionEnd,w=e.open,C=e.attrs,I=s||y.createElement("input",null),T=I,D=T.ref,O=T.props,M=O.onKeyDown,R=O.onChange,A=O.onMouseDown,k=O.onCompositionStart,L=O.onCompositionEnd,j=O.style;return"maxLength"in I.props,I=y.cloneElement(I,$e($e($e({type:"search"},O),{},{id:o,ref:Gd(t,D),disabled:a,tabIndex:c,autoComplete:u||"off",autoFocus:l,className:Ue("".concat(i,"-selection-search-input"),(r=I)===null||r===void 0||(r=r.props)===null||r===void 0?void 0:r.className),role:"combobox","aria-expanded":w||!1,"aria-haspopup":"listbox","aria-owns":"".concat(o,"_list"),"aria-autocomplete":"list","aria-controls":"".concat(o,"_list"),"aria-activedescendant":w?h:void 0},C),{},{value:d?f:"",maxLength:p,readOnly:!d,unselectable:d?null:"on",style:$e($e({},j),{},{opacity:d?null:0}),onKeyDown:function(B){g(B),M&&M(B)},onMouseDown:function(B){m(B),A&&A(B)},onChange:function(B){v(B),R&&R(B)},onCompositionStart:function(B){S(B),k&&k(B)},onCompositionEnd:function(B){E(B),L&&L(B)},onPaste:b})),I},eOe=y.forwardRef(F1t);function tOe(n){return Array.isArray(n)?n:n!==void 0?[n]:[]}var j1t=typeof window<"u"&&window.document&&window.document.documentElement,B1t=j1t;function H1t(n){return n!=null}function U1t(n){return!n&&n!==0}function Dve(n){return["string","number"].includes(Wn(n))}function nOe(n){var e=void 0;return n&&(Dve(n.title)?e=n.title.toString():Dve(n.label)&&(e=n.label.toString())),e}function z1t(n,e){B1t?y.useLayoutEffect(n,e):y.useEffect(n,e)}function V1t(n){var e;return(e=n.key)!==null&&e!==void 0?e:n.value}var Rve=function(e){e.preventDefault(),e.stopPropagation()},W1t=function(e){var t=e.id,r=e.prefixCls,i=e.values,o=e.open,s=e.searchValue,a=e.autoClearSearchValue,c=e.inputRef,l=e.placeholder,u=e.disabled,d=e.mode,h=e.showSearch,f=e.autoFocus,p=e.autoComplete,g=e.activeDescendantId,m=e.tabIndex,v=e.removeIcon,b=e.maxTagCount,S=e.maxTagTextLength,E=e.maxTagPlaceholder,w=E===void 0?function(ye){return"+ ".concat(ye.length," ...")}:E,C=e.tagRender,I=e.onToggleOpen,T=e.onRemove,D=e.onInputChange,O=e.onInputPaste,M=e.onInputKeyDown,R=e.onInputMouseDown,A=e.onInputCompositionStart,k=e.onInputCompositionEnd,L=y.useRef(null),j=y.useState(0),N=rt(j,2),B=N[0],U=N[1],K=y.useState(!1),z=rt(K,2),G=z[0],te=z[1],ie="".concat(r,"-selection"),Q=o||d==="multiple"&&a===!1||d==="tags"?s:"",ge=d==="tags"||d==="multiple"&&a===!1||h&&(o||G);z1t(function(){U(L.current.scrollWidth)},[Q]);var _e=function(V,le,he,oe,ne){return y.createElement("span",{title:nOe(V),className:Ue("".concat(ie,"-item"),Le({},"".concat(ie,"-item-disabled"),he))},y.createElement("span",{className:"".concat(ie,"-item-content")},le),oe&&y.createElement(nN,{className:"".concat(ie,"-item-remove"),onMouseDown:Rve,onClick:ne,customizeIcon:v},"×"))},Se=function(V,le,he,oe,ne,ce){var Ae=function(be){Rve(be),I(!o)};return y.createElement("span",{onMouseDown:Ae},C({label:le,value:V,disabled:he,closable:oe,onClose:ne,isMaxTag:!!ce}))},se=function(V){var le=V.disabled,he=V.label,oe=V.value,ne=!u&&!le,ce=he;if(typeof S=="number"&&(typeof he=="string"||typeof he=="number")){var Ae=String(ce);Ae.length>S&&(ce="".concat(Ae.slice(0,S),"..."))}var Ie=function(De){De&&De.stopPropagation(),T(V)};return typeof C=="function"?Se(oe,ce,le,ne,Ie):_e(V,ce,le,ne,Ie)},ee=function(V){var le=typeof w=="function"?w(V):w;return typeof C=="function"?Se(void 0,le,!1,!1,void 0,!0):_e({title:le},le,!1)},Y=y.createElement("div",{className:"".concat(ie,"-search"),style:{width:B},onFocus:function(){te(!0)},onBlur:function(){te(!1)}},y.createElement(eOe,{ref:c,open:o,prefixCls:r,id:t,inputElement:null,disabled:u,autoFocus:f,autoComplete:p,editable:ge,activeDescendantId:g,value:Q,onKeyDown:M,onMouseDown:R,onChange:D,onPaste:O,onCompositionStart:A,onCompositionEnd:k,tabIndex:m,attrs:pg(e,!0)}),y.createElement("span",{ref:L,className:"".concat(ie,"-search-mirror"),"aria-hidden":!0},Q," ")),ue=y.createElement(rg,{prefixCls:"".concat(ie,"-overflow"),data:i,renderItem:se,renderRest:ee,suffix:Y,itemKey:V1t,maxCount:b});return y.createElement(y.Fragment,null,ue,!i.length&&!Q&&y.createElement("span",{className:"".concat(ie,"-placeholder")},l))},q1t=function(e){var t=e.inputElement,r=e.prefixCls,i=e.id,o=e.inputRef,s=e.disabled,a=e.autoFocus,c=e.autoComplete,l=e.activeDescendantId,u=e.mode,d=e.open,h=e.values,f=e.placeholder,p=e.tabIndex,g=e.showSearch,m=e.searchValue,v=e.activeValue,b=e.maxLength,S=e.onInputKeyDown,E=e.onInputMouseDown,w=e.onInputChange,C=e.onInputPaste,I=e.onInputCompositionStart,T=e.onInputCompositionEnd,D=e.title,O=y.useState(!1),M=rt(O,2),R=M[0],A=M[1],k=u==="combobox",L=k||g,j=h[0],N=m||"";k&&v&&!R&&(N=v),y.useEffect(function(){k&&A(!1)},[k,v]);var B=u!=="combobox"&&!d&&!g?!1:!!N,U=D===void 0?nOe(j):D,K=y.useMemo(function(){return j?null:y.createElement("span",{className:"".concat(r,"-selection-placeholder"),style:B?{visibility:"hidden"}:void 0},f)},[j,B,f,r]);return y.createElement(y.Fragment,null,y.createElement("span",{className:"".concat(r,"-selection-search")},y.createElement(eOe,{ref:o,prefixCls:r,id:i,open:d,inputElement:t,disabled:s,autoFocus:a,autoComplete:c,editable:L,activeDescendantId:l,value:N,onKeyDown:S,onMouseDown:E,onChange:function(G){A(!0),w(G)},onPaste:C,onCompositionStart:I,onCompositionEnd:T,tabIndex:p,attrs:pg(e,!0),maxLength:k?b:void 0})),!k&&j?y.createElement("span",{className:"".concat(r,"-selection-item"),title:U,style:B?{visibility:"hidden"}:void 0},j.label):null,K)},K1t=function(e,t){var r=y.useRef(null),i=y.useRef(!1),o=e.prefixCls,s=e.open,a=e.mode,c=e.showSearch,l=e.tokenWithEnter,u=e.disabled,d=e.autoClearSearchValue,h=e.onSearch,f=e.onSearchSubmit,p=e.onToggleOpen,g=e.onInputKeyDown,m=e.domRef;y.useImperativeHandle(t,function(){return{focus:function(B){r.current.focus(B)},blur:function(){r.current.blur()}}});var v=X4e(0),b=rt(v,2),S=b[0],E=b[1],w=function(B){var U=B.which;(U===Bt.UP||U===Bt.DOWN)&&B.preventDefault(),g&&g(B),U===Bt.ENTER&&a==="tags"&&!i.current&&!s&&(f==null||f(B.target.value)),I1t(U)&&p(!0)},C=function(){E(!0)},I=y.useRef(null),T=function(B){h(B,!0,i.current)!==!1&&p(!0)},D=function(){i.current=!0},O=function(B){i.current=!1,a!=="combobox"&&T(B.target.value)},M=function(B){var U=B.target.value;if(l&&I.current&&/[\r\n]/.test(I.current)){var K=I.current.replace(/[\r\n]+$/,"").replace(/\r\n/g," ").replace(/[\r\n]/g," ");U=U.replace(K,I.current)}I.current=null,T(U)},R=function(B){var U=B.clipboardData,K=U==null?void 0:U.getData("text");I.current=K||""},A=function(B){var U=B.target;if(U!==r.current){var K=document.body.style.msTouchAction!==void 0;K?setTimeout(function(){r.current.focus()}):r.current.focus()}},k=function(B){var U=S();B.target!==r.current&&!U&&!(a==="combobox"&&u)&&B.preventDefault(),(a!=="combobox"&&(!c||!U)||!s)&&(s&&d!==!1&&h("",!0,!1),p())},L={inputRef:r,onInputKeyDown:w,onInputMouseDown:C,onInputChange:M,onInputPaste:R,onInputCompositionStart:D,onInputCompositionEnd:O},j=a==="multiple"||a==="tags"?y.createElement(W1t,ln({},e,L)):y.createElement(q1t,ln({},e,L));return y.createElement("div",{ref:m,className:"".concat(o,"-selector"),onClick:A,onMouseDown:k},j)},G1t=y.forwardRef(K1t);function Z1t(n){var e=n.prefixCls,t=n.align,r=n.arrow,i=n.arrowPos,o=r||{},s=o.className,a=o.content,c=i.x,l=c===void 0?0:c,u=i.y,d=u===void 0?0:u,h=y.useRef();if(!t||!t.points)return null;var f={position:"absolute"};if(t.autoArrow!==!1){var p=t.points[0],g=t.points[1],m=p[0],v=p[1],b=g[0],S=g[1];m===b||!["t","b"].includes(m)?f.top=d:m==="t"?f.top=0:f.bottom=0,v===S||!["l","r"].includes(v)?f.left=l:v==="l"?f.left=0:f.right=0}return y.createElement("div",{ref:h,className:Ue("".concat(e,"-arrow"),s),style:f},a)}function X1t(n){var e=n.prefixCls,t=n.open,r=n.zIndex,i=n.mask,o=n.motion;return i?y.createElement(bv,ln({},o,{motionAppear:!0,visible:t,removeOnLeave:!0}),function(s){var a=s.className;return y.createElement("div",{style:{zIndex:r},className:Ue("".concat(e,"-mask"),a)})}):null}var Y1t=y.memo(function(n){var e=n.children;return e},function(n,e){return e.cache}),J1t=y.forwardRef(function(n,e){var t=n.popup,r=n.className,i=n.prefixCls,o=n.style,s=n.target,a=n.onVisibleChanged,c=n.open,l=n.keepDom,u=n.fresh,d=n.onClick,h=n.mask,f=n.arrow,p=n.arrowPos,g=n.align,m=n.motion,v=n.maskMotion,b=n.forceRender,S=n.getPopupContainer,E=n.autoDestroy,w=n.portal,C=n.zIndex,I=n.onMouseEnter,T=n.onMouseLeave,D=n.onPointerEnter,O=n.ready,M=n.offsetX,R=n.offsetY,A=n.offsetR,k=n.offsetB,L=n.onAlign,j=n.onPrepare,N=n.stretch,B=n.targetWidth,U=n.targetHeight,K=typeof t=="function"?t():t,z=c||l,G=(S==null?void 0:S.length)>0,te=y.useState(!S||!G),ie=rt(te,2),Q=ie[0],ge=ie[1];if(es(function(){!Q&&G&&s&&ge(!0)},[Q,G,s]),!Q)return null;var _e="auto",Se={left:"-1000vw",top:"-1000vh",right:_e,bottom:_e};if(O||!c){var se,ee=g.points,Y=g.dynamicInset||((se=g._experimental)===null||se===void 0?void 0:se.dynamicInset),ue=Y&&ee[0][1]==="r",ye=Y&&ee[0][0]==="b";ue?(Se.right=A,Se.left=_e):(Se.left=M,Se.right=_e),ye?(Se.bottom=k,Se.top=_e):(Se.top=R,Se.bottom=_e)}var V={};return N&&(N.includes("height")&&U?V.height=U:N.includes("minHeight")&&U&&(V.minHeight=U),N.includes("width")&&B?V.width=B:N.includes("minWidth")&&B&&(V.minWidth=B)),c||(V.pointerEvents="none"),y.createElement(w,{open:b||z,getContainer:S&&function(){return S(s)},autoDestroy:E},y.createElement(X1t,{prefixCls:i,open:c,zIndex:C,mask:h,motion:v}),y.createElement(Wy,{onResize:L,disabled:!c},function(le){return y.createElement(bv,ln({motionAppear:!0,motionEnter:!0,motionLeave:!0,removeOnLeave:!1,forceRender:b,leavedClassName:"".concat(i,"-hidden")},m,{onAppearPrepare:j,onEnterPrepare:j,visible:c,onVisibleChanged:function(oe){var ne;m==null||(ne=m.onVisibleChanged)===null||ne===void 0||ne.call(m,oe),a(oe)}}),function(he,oe){var ne=he.className,ce=he.style,Ae=Ue(i,ne,r);return y.createElement("div",{ref:Gd(le,e,oe),className:Ae,style:$e($e($e($e({"--arrow-x":"".concat(p.x||0,"px"),"--arrow-y":"".concat(p.y||0,"px")},Se),V),ce),{},{boxSizing:"border-box",zIndex:C},o),onMouseEnter:I,onMouseLeave:T,onPointerEnter:D,onClick:d},f&&y.createElement(Z1t,{prefixCls:i,arrow:f,arrowPos:p,align:g}),y.createElement(Y1t,{cache:!c&&!u},K))})}))}),Q1t=y.forwardRef(function(n,e){var t=n.children,r=n.getTriggerDOMNode,i=yv(t),o=y.useCallback(function(a){xne(e,r?r(a):a)},[r]),s=Uy(o,t.ref);return i?y.cloneElement(t,{ref:s}):t}),Ave=y.createContext(null);function Ove(n){return n?Array.isArray(n)?n:[n]:[]}function eSt(n,e,t,r){return y.useMemo(function(){var i=Ove(t??e),o=Ove(r??e),s=new Set(i),a=new Set(o);return n&&(s.has("hover")&&(s.delete("hover"),s.add("click")),a.has("hover")&&(a.delete("hover"),a.add("click"))),[s,a]},[n,e,t,r])}function tSt(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2?arguments[2]:void 0;return t?n[0]===e[0]:n[0]===e[0]&&n[1]===e[1]}function nSt(n,e,t,r){for(var i=t.points,o=Object.keys(n),s=0;s<o.length;s+=1){var a,c=o[s];if(tSt((a=n[c])===null||a===void 0?void 0:a.points,i,r))return"".concat(e,"-placement-").concat(c)}return""}function Mve(n,e,t,r){return e||(t?{motionName:"".concat(n,"-").concat(t)}:r?{motionName:r}:null)}function SD(n){return n.ownerDocument.defaultView}function fZ(n){for(var e=[],t=n==null?void 0:n.parentElement,r=["hidden","scroll","clip","auto"];t;){var i=SD(t).getComputedStyle(t),o=i.overflowX,s=i.overflowY,a=i.overflow;[o,s,a].some(function(c){return r.includes(c)})&&e.push(t),t=t.parentElement}return e}function T3(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return Number.isNaN(n)?e:n}function dI(n){return T3(parseFloat(n),0)}function $ve(n,e){var t=$e({},n);return(e||[]).forEach(function(r){if(!(r instanceof HTMLBodyElement||r instanceof HTMLHtmlElement)){var i=SD(r).getComputedStyle(r),o=i.overflow,s=i.overflowClipMargin,a=i.borderTopWidth,c=i.borderBottomWidth,l=i.borderLeftWidth,u=i.borderRightWidth,d=r.getBoundingClientRect(),h=r.offsetHeight,f=r.clientHeight,p=r.offsetWidth,g=r.clientWidth,m=dI(a),v=dI(c),b=dI(l),S=dI(u),E=T3(Math.round(d.width/p*1e3)/1e3),w=T3(Math.round(d.height/h*1e3)/1e3),C=(p-g-b-S)*E,I=(h-f-m-v)*w,T=m*w,D=v*w,O=b*E,M=S*E,R=0,A=0;if(o==="clip"){var k=dI(s);R=k*E,A=k*w}var L=d.x+O-R,j=d.y+T-A,N=L+d.width+2*R-O-M-C,B=j+d.height+2*A-T-D-I;t.left=Math.max(t.left,L),t.top=Math.max(t.top,j),t.right=Math.min(t.right,N),t.bottom=Math.min(t.bottom,B)}}),t}function Lve(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t="".concat(e),r=t.match(/^(.*)\%$/);return r?n*(parseFloat(r[1])/100):parseFloat(t)}function Nve(n,e){var t=e||[],r=rt(t,2),i=r[0],o=r[1];return[Lve(n.width,i),Lve(n.height,o)]}function Fve(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return[n[0],n[1]]}function rw(n,e){var t=e[0],r=e[1],i,o;return t==="t"?o=n.y:t==="b"?o=n.y+n.height:o=n.y+n.height/2,r==="l"?i=n.x:r==="r"?i=n.x+n.width:i=n.x+n.width/2,{x:i,y:o}}function Xv(n,e){var t={t:"b",b:"t",l:"r",r:"l"};return n.map(function(r,i){return i===e?t[r]||"c":r}).join("")}function rSt(n,e,t,r,i,o,s){var a=y.useState({ready:!1,offsetX:0,offsetY:0,offsetR:0,offsetB:0,arrowX:0,arrowY:0,scaleX:1,scaleY:1,align:i[r]||{}}),c=rt(a,2),l=c[0],u=c[1],d=y.useRef(0),h=y.useMemo(function(){return e?fZ(e):[]},[e]),f=y.useRef({}),p=function(){f.current={}};n||p();var g=ea(function(){if(e&&t&&n){let _c=function(Yh,Jd){var Va=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Me,dp=ie.x+Yh,jg=ie.y+Jd,hp=dp+ye,ib=jg+ue,Bg=Math.max(dp,Va.left),Nn=Math.max(jg,Va.top),qn=Math.min(hp,Va.right),wi=Math.min(ib,Va.bottom);return Math.max(0,(qn-Bg)*(wi-Nn))},Fg=function(){_n=ie.y+Lt,jn=_n+ue,Zn=ie.x+at,Z=Zn+ye};var b,S,E,w,C=e,I=C.ownerDocument,T=SD(C),D=T.getComputedStyle(C),O=D.width,M=D.height,R=D.position,A=C.style.left,k=C.style.top,L=C.style.right,j=C.style.bottom,N=C.style.overflow,B=$e($e({},i[r]),o),U=I.createElement("div");(b=C.parentElement)===null||b===void 0||b.appendChild(U),U.style.left="".concat(C.offsetLeft,"px"),U.style.top="".concat(C.offsetTop,"px"),U.style.position=R,U.style.height="".concat(C.offsetHeight,"px"),U.style.width="".concat(C.offsetWidth,"px"),C.style.left="0",C.style.top="0",C.style.right="auto",C.style.bottom="auto",C.style.overflow="hidden";var K;if(Array.isArray(t))K={x:t[0],y:t[1],width:0,height:0};else{var z,G,te=t.getBoundingClientRect();te.x=(z=te.x)!==null&&z!==void 0?z:te.left,te.y=(G=te.y)!==null&&G!==void 0?G:te.top,K={x:te.x,y:te.y,width:te.width,height:te.height}}var ie=C.getBoundingClientRect();ie.x=(S=ie.x)!==null&&S!==void 0?S:ie.left,ie.y=(E=ie.y)!==null&&E!==void 0?E:ie.top;var Q=I.documentElement,ge=Q.clientWidth,_e=Q.clientHeight,Se=Q.scrollWidth,se=Q.scrollHeight,ee=Q.scrollTop,Y=Q.scrollLeft,ue=ie.height,ye=ie.width,V=K.height,le=K.width,he={left:0,top:0,right:ge,bottom:_e},oe={left:-Y,top:-ee,right:Se-Y,bottom:se-ee},ne=B.htmlRegion,ce="visible",Ae="visibleFirst";ne!=="scroll"&&ne!==Ae&&(ne=ce);var Ie=ne===Ae,be=$ve(oe,h),De=$ve(he,h),Me=ne===ce?De:be,He=Ie?De:Me;C.style.left="auto",C.style.top="auto",C.style.right="0",C.style.bottom="0";var Je=C.getBoundingClientRect();C.style.left=A,C.style.top=k,C.style.right=L,C.style.bottom=j,C.style.overflow=N,(w=C.parentElement)===null||w===void 0||w.removeChild(U);var qe=T3(Math.round(ye/parseFloat(O)*1e3)/1e3),Ge=T3(Math.round(ue/parseFloat(M)*1e3)/1e3);if(qe===0||Ge===0||g3(t)&&!Z7(t))return;var St=B.offset,Pt=B.targetOffset,on=Nve(ie,St),an=rt(on,2),Rt=an[0],Xt=an[1],yn=Nve(K,Pt),bn=rt(yn,2),Kn=bn[0],lr=bn[1];K.x-=Kn,K.y-=lr;var Rr=B.points||[],Lr=rt(Rr,2),er=Lr[0],ke=Lr[1],Qn=Fve(ke),Gn=Fve(er),J=rw(K,Qn),ze=rw(ie,Gn),it=$e({},B),at=J.x-ze.x+Rt,Lt=J.y-ze.y+Xt,fn=_c(at,Lt),hn=_c(at,Lt,De),Ut=rw(K,["t","l"]),sn=rw(ie,["t","l"]),ae=rw(K,["b","r"]),Wt=rw(ie,["b","r"]),un=B.overflow||{},qt=un.adjustX,Ce=un.adjustY,ct=un.shiftX,At=un.shiftY,$t=function(Jd){return typeof Jd=="boolean"?Jd:Jd>=0},_n,jn,Zn,Z;Fg();var ve=$t(Ce),W=Gn[0]===Qn[0];if(ve&&Gn[0]==="t"&&(jn>He.bottom||f.current.bt)){var X=Lt;W?X-=ue-V:X=Ut.y-Wt.y-Xt;var fe=_c(at,X),xt=_c(at,X,De);fe>fn||fe===fn&&(!Ie||xt>=hn)?(f.current.bt=!0,Lt=X,Xt=-Xt,it.points=[Xv(Gn,0),Xv(Qn,0)]):f.current.bt=!1}if(ve&&Gn[0]==="b"&&(_n<He.top||f.current.tb)){var Zt=Lt;W?Zt+=ue-V:Zt=ae.y-sn.y-Xt;var or=_c(at,Zt),tr=_c(at,Zt,De);or>fn||or===fn&&(!Ie||tr>=hn)?(f.current.tb=!0,Lt=Zt,Xt=-Xt,it.points=[Xv(Gn,0),Xv(Qn,0)]):f.current.tb=!1}var vo=$t(qt),fs=Gn[1]===Qn[1];if(vo&&Gn[1]==="l"&&(Z>He.right||f.current.rl)){var ps=at;fs?ps-=ye-le:ps=Ut.x-Wt.x-Rt;var Wo=_c(ps,Lt),Tl=_c(ps,Lt,De);Wo>fn||Wo===fn&&(!Ie||Tl>=hn)?(f.current.rl=!0,at=ps,Rt=-Rt,it.points=[Xv(Gn,1),Xv(Qn,1)]):f.current.rl=!1}if(vo&&Gn[1]==="r"&&(Zn<He.left||f.current.lr)){var rs=at;fs?rs+=ye-le:rs=ae.x-sn.x-Rt;var Dl=_c(rs,Lt),Xh=_c(rs,Lt,De);Dl>fn||Dl===fn&&(!Ie||Xh>=hn)?(f.current.lr=!0,at=rs,Rt=-Rt,it.points=[Xv(Gn,1),Xv(Qn,1)]):f.current.lr=!1}Fg();var Sc=ct===!0?0:ct;typeof Sc=="number"&&(Zn<De.left&&(at-=Zn-De.left-Rt,K.x+le<De.left+Sc&&(at+=K.x-De.left+le-Sc)),Z>De.right&&(at-=Z-De.right-Rt,K.x>De.right-Sc&&(at+=K.x-De.right+Sc)));var oa=At===!0?0:At;typeof oa=="number"&&(_n<De.top&&(Lt-=_n-De.top-Xt,K.y+V<De.top+oa&&(Lt+=K.y-De.top+V-oa)),jn>De.bottom&&(Lt-=jn-De.bottom-Xt,K.y>De.bottom-oa&&(Lt+=K.y-De.bottom+oa)));var zs=ie.x+at,Rl=zs+ye,Ps=ie.y+Lt,pr=Ps+ue,Yn=K.x,xr=Yn+le,sr=K.y,nr=sr+V,Zr=Math.max(zs,Yn),_i=Math.min(Rl,xr),gs=(Zr+_i)/2,Vs=gs-zs,wa=Math.max(Ps,sr),ms=Math.min(pr,nr),Po=(wa+ms)/2,Ca=Po-Ps;s==null||s(e,it);var lu=Je.right-ie.x-(at+ie.width),za=Je.bottom-ie.y-(Lt+ie.height);qe===1&&(at=Math.round(at),lu=Math.round(lu)),Ge===1&&(Lt=Math.round(Lt),za=Math.round(za));var ed={ready:!0,offsetX:at/qe,offsetY:Lt/Ge,offsetR:lu/qe,offsetB:za/Ge,arrowX:Vs/qe,arrowY:Ca/Ge,scaleX:qe,scaleY:Ge,align:it};u(ed)}}),m=function(){d.current+=1;var S=d.current;Promise.resolve().then(function(){d.current===S&&g()})},v=function(){u(function(S){return $e($e({},S),{},{ready:!1})})};return es(v,[r]),es(function(){n||v()},[n]),[l.ready,l.offsetX,l.offsetY,l.offsetR,l.offsetB,l.arrowX,l.arrowY,l.scaleX,l.scaleY,l.align,m]}function iSt(n,e,t,r,i){es(function(){if(n&&e&&t){let d=function(){r(),i()};var o=e,s=t,a=fZ(o),c=fZ(s),l=SD(s),u=new Set([l].concat(Ht(a),Ht(c)));return u.forEach(function(h){h.addEventListener("scroll",d,{passive:!0})}),l.addEventListener("resize",d,{passive:!0}),r(),function(){u.forEach(function(h){h.removeEventListener("scroll",d),l.removeEventListener("resize",d)})}}},[n,e,t])}function oSt(n,e,t,r,i,o,s,a){var c=y.useRef(n);c.current=n,y.useEffect(function(){if(e&&r&&(!i||o)){var l=function(f){var p;c.current&&!s(((p=f.composedPath)===null||p===void 0||(p=p.call(f))===null||p===void 0?void 0:p[0])||f.target)&&a(!1)},u=SD(r);u.addEventListener("mousedown",l,!0),u.addEventListener("contextmenu",l,!0);var d=w8(t);return d&&(d.addEventListener("mousedown",l,!0),d.addEventListener("contextmenu",l,!0)),function(){u.removeEventListener("mousedown",l,!0),u.removeEventListener("contextmenu",l,!0),d&&(d.removeEventListener("mousedown",l,!0),d.removeEventListener("contextmenu",l,!0))}}},[e,t,r,i,o])}var sSt=["prefixCls","children","action","showAction","hideAction","popupVisible","defaultPopupVisible","onPopupVisibleChange","afterPopupVisibleChange","mouseEnterDelay","mouseLeaveDelay","focusDelay","blurDelay","mask","maskClosable","getPopupContainer","forceRender","autoDestroy","destroyPopupOnHide","popup","popupClassName","popupStyle","popupPlacement","builtinPlacements","popupAlign","zIndex","stretch","getPopupClassNameFromAlign","fresh","alignPoint","onPopupClick","onPopupAlign","arrow","popupMotion","maskMotion","popupTransitionName","popupAnimation","maskTransitionName","maskAnimation","className","getTriggerDOMNode"];function aSt(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Kne,e=y.forwardRef(function(t,r){var i=t.prefixCls,o=i===void 0?"rc-trigger-popup":i,s=t.children,a=t.action,c=a===void 0?"hover":a,l=t.showAction,u=t.hideAction,d=t.popupVisible,h=t.defaultPopupVisible,f=t.onPopupVisibleChange,p=t.afterPopupVisibleChange,g=t.mouseEnterDelay,m=t.mouseLeaveDelay,v=m===void 0?.1:m,b=t.focusDelay,S=t.blurDelay,E=t.mask,w=t.maskClosable,C=w===void 0?!0:w,I=t.getPopupContainer,T=t.forceRender,D=t.autoDestroy,O=t.destroyPopupOnHide,M=t.popup,R=t.popupClassName,A=t.popupStyle,k=t.popupPlacement,L=t.builtinPlacements,j=L===void 0?{}:L,N=t.popupAlign,B=t.zIndex,U=t.stretch,K=t.getPopupClassNameFromAlign,z=t.fresh,G=t.alignPoint,te=t.onPopupClick,ie=t.onPopupAlign,Q=t.arrow,ge=t.popupMotion,_e=t.maskMotion,Se=t.popupTransitionName,se=t.popupAnimation,ee=t.maskTransitionName,Y=t.maskAnimation,ue=t.className,ye=t.getTriggerDOMNode,V=jr(t,sSt),le=D||O||!1,he=y.useState(!1),oe=rt(he,2),ne=oe[0],ce=oe[1];es(function(){ce(G4e())},[]);var Ae=y.useRef({}),Ie=y.useContext(Ave),be=y.useMemo(function(){return{registerSubPopup:function(qn,wi){Ae.current[qn]=wi,Ie==null||Ie.registerSubPopup(qn,wi)}}},[Ie]),De=m4e(),Me=y.useState(null),He=rt(Me,2),Je=He[0],qe=He[1],Ge=y.useRef(null),St=ea(function(Nn){Ge.current=Nn,g3(Nn)&&Je!==Nn&&qe(Nn),Ie==null||Ie.registerSubPopup(De,Nn)}),Pt=y.useState(null),on=rt(Pt,2),an=on[0],Rt=on[1],Xt=y.useRef(null),yn=ea(function(Nn){g3(Nn)&&an!==Nn&&(Rt(Nn),Xt.current=Nn)}),bn=y.Children.only(s),Kn=(bn==null?void 0:bn.props)||{},lr={},Rr=function(qn,wi){var ks,Qi;return qn===wi||wi.contains(qn)||((ks=w8(wi))===null||ks===void 0?void 0:ks.host)===qn||wi.contains((Qi=w8(qn))===null||Qi===void 0?void 0:Qi.host)},Lr=ea(function(Nn){var qn=an,wi=Rr.bind(null,Nn);return wi(qn)||wi(Je)||Object.values(Ae.current).some(wi)}),er=Mve(o,ge,se,Se),ke=Mve(o,_e,Y,ee),Qn=y.useState(h||!1),Gn=rt(Qn,2),J=Gn[0],ze=Gn[1],it=d??J,at=ea(function(Nn){d===void 0&&ze(Nn)});es(function(){ze(d||!1)},[d]);var Lt=y.useRef(it);Lt.current=it;var fn=y.useRef([]);fn.current=[];var hn=ea(function(Nn){var qn;at(Nn),((qn=fn.current[fn.current.length-1])!==null&&qn!==void 0?qn:it)!==Nn&&(fn.current.push(Nn),f==null||f(Nn))}),Ut=y.useRef(),sn=function(){clearTimeout(Ut.current)},ae=function(qn){var wi=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;sn(),wi===0?hn(qn):Ut.current=setTimeout(function(){hn(qn)},wi*1e3)};y.useEffect(function(){return sn},[]);var Wt=y.useState(!1),un=rt(Wt,2),qt=un[0],Ce=un[1];es(function(Nn){(!Nn||it)&&Ce(!0)},[it]);var ct=y.useState(null),At=rt(ct,2),$t=At[0],_n=At[1],jn=y.useState(null),Zn=rt(jn,2),Z=Zn[0],ve=Zn[1],W=function(qn){ve([qn.clientX,qn.clientY])},X=rSt(it,Je,G&&Z!==null?Z:an,k,j,N,ie),fe=rt(X,11),xt=fe[0],Zt=fe[1],or=fe[2],tr=fe[3],vo=fe[4],fs=fe[5],ps=fe[6],Wo=fe[7],Tl=fe[8],rs=fe[9],Dl=fe[10],Xh=eSt(ne,c,l,u),Sc=rt(Xh,2),oa=Sc[0],zs=Sc[1],Rl=oa.has("click"),Ps=zs.has("click")||zs.has("contextMenu"),pr=ea(function(){qt||Dl()}),Yn=function(){Lt.current&&G&&Ps&&ae(!1)};iSt(it,an,Je,pr,Yn),es(function(){pr()},[Z,k]),es(function(){it&&!(j!=null&&j[k])&&pr()},[JSON.stringify(N)]);var xr=y.useMemo(function(){var Nn=nSt(j,o,rs,G);return Ue(Nn,K==null?void 0:K(rs))},[rs,K,j,o,G]);y.useImperativeHandle(r,function(){return{nativeElement:Xt.current,popupElement:Ge.current,forceAlign:pr}});var sr=y.useState(0),nr=rt(sr,2),Zr=nr[0],_i=nr[1],gs=y.useState(0),Vs=rt(gs,2),wa=Vs[0],ms=Vs[1],Po=function(){if(U&&an){var qn=an.getBoundingClientRect();_i(qn.width),ms(qn.height)}},Ca=function(){Po(),pr()},lu=function(qn){Ce(!1),Dl(),p==null||p(qn)},za=function(){return new Promise(function(qn){Po(),_n(function(){return qn})})};es(function(){$t&&(Dl(),$t(),_n(null))},[$t]);function ed(Nn,qn,wi,ks){lr[Nn]=function(Qi){var Hg;ks==null||ks(Qi),ae(qn,wi);for(var ob=arguments.length,Ui=new Array(ob>1?ob-1:0),ki=1;ki<ob;ki++)Ui[ki-1]=arguments[ki];(Hg=Kn[Nn])===null||Hg===void 0||Hg.call.apply(Hg,[Kn,Qi].concat(Ui))}}(Rl||Ps)&&(lr.onClick=function(Nn){var qn;Lt.current&&Ps?ae(!1):!Lt.current&&Rl&&(W(Nn),ae(!0));for(var wi=arguments.length,ks=new Array(wi>1?wi-1:0),Qi=1;Qi<wi;Qi++)ks[Qi-1]=arguments[Qi];(qn=Kn.onClick)===null||qn===void 0||qn.call.apply(qn,[Kn,Nn].concat(ks))}),oSt(it,Ps,an,Je,E,C,Lr,ae);var _c=oa.has("hover"),Fg=zs.has("hover"),Yh,Jd;_c&&(ed("onMouseEnter",!0,g,function(Nn){W(Nn)}),ed("onPointerEnter",!0,g,function(Nn){W(Nn)}),Yh=function(qn){(it||qt)&&Je!==null&&Je!==void 0&&Je.contains(qn.target)&&ae(!0,g)},G&&(lr.onMouseMove=function(Nn){var qn;(qn=Kn.onMouseMove)===null||qn===void 0||qn.call(Kn,Nn)})),Fg&&(ed("onMouseLeave",!1,v),ed("onPointerLeave",!1,v),Jd=function(){ae(!1,v)}),oa.has("focus")&&ed("onFocus",!0,b),zs.has("focus")&&ed("onBlur",!1,S),oa.has("contextMenu")&&(lr.onContextMenu=function(Nn){var qn;Lt.current&&zs.has("contextMenu")?ae(!1):(W(Nn),ae(!0)),Nn.preventDefault();for(var wi=arguments.length,ks=new Array(wi>1?wi-1:0),Qi=1;Qi<wi;Qi++)ks[Qi-1]=arguments[Qi];(qn=Kn.onContextMenu)===null||qn===void 0||qn.call.apply(qn,[Kn,Nn].concat(ks))}),ue&&(lr.className=Ue(Kn.className,ue));var Va=$e($e({},Kn),lr),dp={},jg=["onContextMenu","onClick","onMouseDown","onTouchStart","onMouseEnter","onMouseLeave","onFocus","onBlur"];jg.forEach(function(Nn){V[Nn]&&(dp[Nn]=function(){for(var qn,wi=arguments.length,ks=new Array(wi),Qi=0;Qi<wi;Qi++)ks[Qi]=arguments[Qi];(qn=Va[Nn])===null||qn===void 0||qn.call.apply(qn,[Va].concat(ks)),V[Nn].apply(V,ks)})});var hp=y.cloneElement(bn,$e($e({},Va),dp)),ib={x:fs,y:ps},Bg=Q?$e({},Q!==!0?Q:{}):null;return y.createElement(y.Fragment,null,y.createElement(Wy,{disabled:!it,ref:yn,onResize:Ca},y.createElement(Q1t,{getTriggerDOMNode:ye},hp)),y.createElement(Ave.Provider,{value:be},y.createElement(J1t,{portal:n,ref:St,prefixCls:o,popup:M,className:Ue(R,xr),style:A,target:an,onMouseEnter:Yh,onMouseLeave:Jd,onPointerEnter:Yh,zIndex:B,open:it,keepDom:qt,fresh:z,onClick:te,mask:E,motion:er,maskMotion:ke,onVisibleChanged:lu,onPrepare:za,forceRender:T,autoDestroy:le,getPopupContainer:I,align:rs,arrow:Bg,arrowPos:ib,ready:xt,offsetX:Zt,offsetY:or,offsetR:tr,offsetB:vo,onAlign:pr,stretch:U,targetWidth:Zr/Wo,targetHeight:wa/Tl})))});return e}const rN=aSt(Kne);var cSt=["prefixCls","disabled","visible","children","popupElement","animation","transitionName","dropdownStyle","dropdownClassName","direction","placement","builtinPlacements","dropdownMatchSelectWidth","dropdownRender","dropdownAlign","getPopupContainer","empty","getTriggerDOMNode","onPopupVisibleChange","onPopupMouseEnter"],lSt=function(e){var t=e===!0?0:1;return{bottomLeft:{points:["tl","bl"],offset:[0,4],overflow:{adjustX:t,adjustY:1},htmlRegion:"scroll"},bottomRight:{points:["tr","br"],offset:[0,4],overflow:{adjustX:t,adjustY:1},htmlRegion:"scroll"},topLeft:{points:["bl","tl"],offset:[0,-4],overflow:{adjustX:t,adjustY:1},htmlRegion:"scroll"},topRight:{points:["br","tr"],offset:[0,-4],overflow:{adjustX:t,adjustY:1},htmlRegion:"scroll"}}},uSt=function(e,t){var r=e.prefixCls;e.disabled;var i=e.visible,o=e.children,s=e.popupElement,a=e.animation,c=e.transitionName,l=e.dropdownStyle,u=e.dropdownClassName,d=e.direction,h=d===void 0?"ltr":d,f=e.placement,p=e.builtinPlacements,g=e.dropdownMatchSelectWidth,m=e.dropdownRender,v=e.dropdownAlign,b=e.getPopupContainer,S=e.empty,E=e.getTriggerDOMNode,w=e.onPopupVisibleChange,C=e.onPopupMouseEnter,I=jr(e,cSt),T="".concat(r,"-dropdown"),D=s;m&&(D=m(s));var O=y.useMemo(function(){return p||lSt(g)},[p,g]),M=a?"".concat(T,"-").concat(a):c,R=typeof g=="number",A=y.useMemo(function(){return R?null:g===!1?"minWidth":"width"},[g,R]),k=l;R&&(k=$e($e({},k),{},{width:g}));var L=y.useRef(null);return y.useImperativeHandle(t,function(){return{getPopupElement:function(){var N;return(N=L.current)===null||N===void 0?void 0:N.popupElement}}}),y.createElement(rN,ln({},I,{showAction:w?["click"]:[],hideAction:w?["click"]:[],popupPlacement:f||(h==="rtl"?"bottomRight":"bottomLeft"),builtinPlacements:O,prefixCls:T,popupTransitionName:M,popup:y.createElement("div",{onMouseEnter:C},D),ref:L,stretch:A,popupAlign:v,popupVisible:i,getPopupContainer:b,popupClassName:Ue(u,Le({},"".concat(T,"-empty"),S)),popupStyle:k,getTriggerDOMNode:E,onPopupVisibleChange:w}),o)},dSt=y.forwardRef(uSt);function jve(n,e){var t=n.key,r;return"value"in n&&(r=n.value),t??(r!==void 0?r:"rc-index-key-".concat(e))}function pZ(n){return typeof n<"u"&&!Number.isNaN(n)}function rOe(n,e){var t=n||{},r=t.label,i=t.value,o=t.options,s=t.groupLabel,a=r||(e?"children":"label");return{label:a,value:i||"value",options:o||"options",groupLabel:s||a}}function hSt(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=e.fieldNames,r=e.childrenAsData,i=[],o=rOe(t,!1),s=o.label,a=o.value,c=o.options,l=o.groupLabel;function u(d,h){Array.isArray(d)&&d.forEach(function(f){if(h||!(c in f)){var p=f[a];i.push({key:jve(f,i.length),groupOption:h,data:f,label:f[s],value:p})}else{var g=f[l];g===void 0&&r&&(g=f.label),i.push({key:jve(f,i.length),group:!0,data:f,label:g}),u(f[c],!0)}})}return u(n,!1),i}function gZ(n){var e=$e({},n);return"props"in e||Object.defineProperty(e,"props",{get:function(){return Sl(!1,"Return type is option instead of Option instance. Please read value directly instead of reading from `props`."),e}}),e}var fSt=function(e,t,r){if(!t||!t.length)return null;var i=!1,o=function a(c,l){var u=uAe(l),d=u[0],h=u.slice(1);if(!d)return[c];var f=c.split(d);return i=i||f.length>1,f.reduce(function(p,g){return[].concat(Ht(p),Ht(a(g,h)))},[]).filter(Boolean)},s=o(e,t);return i?typeof r<"u"?s.slice(0,r):s:null},rre=y.createContext(null);function pSt(n){var e=n.visible,t=n.values;if(!e)return null;var r=50;return y.createElement("span",{"aria-live":"polite",style:{width:0,height:0,position:"absolute",overflow:"hidden",opacity:0}},"".concat(t.slice(0,r).map(function(i){var o=i.label,s=i.value;return["number","string"].includes(Wn(o))?o:s}).join(", ")),t.length>r?", ...":null)}var gSt=["id","prefixCls","className","showSearch","tagRender","direction","omitDomProps","displayValues","onDisplayValuesChange","emptyOptions","notFoundContent","onClear","mode","disabled","loading","getInputElement","getRawInputElement","open","defaultOpen","onDropdownVisibleChange","activeValue","onActiveValueChange","activeDescendantId","searchValue","autoClearSearchValue","onSearch","onSearchSplit","tokenSeparators","allowClear","suffixIcon","clearIcon","OptionList","animation","transitionName","dropdownStyle","dropdownClassName","dropdownMatchSelectWidth","dropdownRender","dropdownAlign","placement","builtinPlacements","getPopupContainer","showAction","onFocus","onBlur","onKeyUp","onKeyDown","onMouseDown"],mSt=["value","onChange","removeIcon","placeholder","autoFocus","maxTagCount","maxTagTextLength","maxTagPlaceholder","choiceTransitionName","onInputKeyDown","onPopupScroll","tabIndex"],mZ=function(e){return e==="tags"||e==="multiple"},vSt=y.forwardRef(function(n,e){var t,r=n.id,i=n.prefixCls,o=n.className,s=n.showSearch,a=n.tagRender,c=n.direction,l=n.omitDomProps,u=n.displayValues,d=n.onDisplayValuesChange,h=n.emptyOptions,f=n.notFoundContent,p=f===void 0?"Not Found":f,g=n.onClear,m=n.mode,v=n.disabled,b=n.loading,S=n.getInputElement,E=n.getRawInputElement,w=n.open,C=n.defaultOpen,I=n.onDropdownVisibleChange,T=n.activeValue,D=n.onActiveValueChange,O=n.activeDescendantId,M=n.searchValue,R=n.autoClearSearchValue,A=n.onSearch,k=n.onSearchSplit,L=n.tokenSeparators,j=n.allowClear,N=n.suffixIcon,B=n.clearIcon,U=n.OptionList,K=n.animation,z=n.transitionName,G=n.dropdownStyle,te=n.dropdownClassName,ie=n.dropdownMatchSelectWidth,Q=n.dropdownRender,ge=n.dropdownAlign,_e=n.placement,Se=n.builtinPlacements,se=n.getPopupContainer,ee=n.showAction,Y=ee===void 0?[]:ee,ue=n.onFocus,ye=n.onBlur,V=n.onKeyUp,le=n.onKeyDown,he=n.onMouseDown,oe=jr(n,gSt),ne=mZ(m),ce=(s!==void 0?s:ne)||m==="combobox",Ae=$e({},oe);mSt.forEach(function(pr){delete Ae[pr]}),l==null||l.forEach(function(pr){delete Ae[pr]});var Ie=y.useState(!1),be=rt(Ie,2),De=be[0],Me=be[1];y.useEffect(function(){Me(G4e())},[]);var He=y.useRef(null),Je=y.useRef(null),qe=y.useRef(null),Ge=y.useRef(null),St=y.useRef(null),Pt=y.useRef(!1),on=x1t(),an=rt(on,3),Rt=an[0],Xt=an[1],yn=an[2];y.useImperativeHandle(e,function(){var pr,Yn;return{focus:(pr=Ge.current)===null||pr===void 0?void 0:pr.focus,blur:(Yn=Ge.current)===null||Yn===void 0?void 0:Yn.blur,scrollTo:function(sr){var nr;return(nr=St.current)===null||nr===void 0?void 0:nr.scrollTo(sr)},nativeElement:He.current||Je.current}});var bn=y.useMemo(function(){var pr;if(m!=="combobox")return M;var Yn=(pr=u[0])===null||pr===void 0?void 0:pr.value;return typeof Yn=="string"||typeof Yn=="number"?String(Yn):""},[M,m,u]),Kn=m==="combobox"&&typeof S=="function"&&S()||null,lr=typeof E=="function"&&E(),Rr=Uy(Je,lr==null||(t=lr.props)===null||t===void 0?void 0:t.ref),Lr=y.useState(!1),er=rt(Lr,2),ke=er[0],Qn=er[1];es(function(){Qn(!0)},[]);var Gn=Ql(!1,{defaultValue:C,value:w}),J=rt(Gn,2),ze=J[0],it=J[1],at=ke?ze:!1,Lt=!p&&h;(v||Lt&&at&&m==="combobox")&&(at=!1);var fn=Lt?!1:at,hn=y.useCallback(function(pr){var Yn=pr!==void 0?pr:!at;v||(it(Yn),at!==Yn&&(I==null||I(Yn)))},[v,at,it,I]),Ut=y.useMemo(function(){return(L||[]).some(function(pr){return[`
`,`\r
`].includes(pr)})},[L]),sn=y.useContext(rre)||{},ae=sn.maxCount,Wt=sn.rawValues,un=function(Yn,xr,sr){if(!(ne&&pZ(ae)&&(Wt==null?void 0:Wt.size)>=ae)){var nr=!0,Zr=Yn;D==null||D(null);var _i=fSt(Yn,L,pZ(ae)?ae-Wt.size:void 0),gs=sr?null:_i;return m!=="combobox"&&gs&&(Zr="",k==null||k(gs),hn(!1),nr=!1),A&&bn!==Zr&&A(Zr,{source:xr?"typing":"effect"}),nr}},qt=function(Yn){!Yn||!Yn.trim()||A(Yn,{source:"submit"})};y.useEffect(function(){!at&&!ne&&m!=="combobox"&&un("",!1,!1)},[at]),y.useEffect(function(){ze&&v&&it(!1),v&&!Pt.current&&Xt(!1)},[v]);var Ce=X4e(),ct=rt(Ce,2),At=ct[0],$t=ct[1],_n=y.useRef(!1),jn=function(Yn){var xr=At(),sr=Yn.key,nr=sr==="Enter";if(nr&&(m!=="combobox"&&Yn.preventDefault(),at||hn(!0)),$t(!!bn),sr==="Backspace"&&!xr&&ne&&!bn&&u.length){for(var Zr=Ht(u),_i=null,gs=Zr.length-1;gs>=0;gs-=1){var Vs=Zr[gs];if(!Vs.disabled){Zr.splice(gs,1),_i=Vs;break}}_i&&d(Zr,{type:"remove",values:[_i]})}for(var wa=arguments.length,ms=new Array(wa>1?wa-1:0),Po=1;Po<wa;Po++)ms[Po-1]=arguments[Po];if(at&&(!nr||!_n.current)){var Ca;(Ca=St.current)===null||Ca===void 0||Ca.onKeyDown.apply(Ca,[Yn].concat(ms))}nr&&(_n.current=!0),le==null||le.apply(void 0,[Yn].concat(ms))},Zn=function(Yn){for(var xr=arguments.length,sr=new Array(xr>1?xr-1:0),nr=1;nr<xr;nr++)sr[nr-1]=arguments[nr];if(at){var Zr;(Zr=St.current)===null||Zr===void 0||Zr.onKeyUp.apply(Zr,[Yn].concat(sr))}Yn.key==="Enter"&&(_n.current=!1),V==null||V.apply(void 0,[Yn].concat(sr))},Z=function(Yn){var xr=u.filter(function(sr){return sr!==Yn});d(xr,{type:"remove",values:[Yn]})},ve=y.useRef(!1),W=function(){Xt(!0),v||(ue&&!ve.current&&ue.apply(void 0,arguments),Y.includes("focus")&&hn(!0)),ve.current=!0},X=function(){Pt.current=!0,Xt(!1,function(){ve.current=!1,Pt.current=!1,hn(!1)}),!v&&(bn&&(m==="tags"?A(bn,{source:"submit"}):m==="multiple"&&A("",{source:"blur"})),ye&&ye.apply(void 0,arguments))},fe=[];y.useEffect(function(){return function(){fe.forEach(function(pr){return clearTimeout(pr)}),fe.splice(0,fe.length)}},[]);var xt=function(Yn){var xr,sr=Yn.target,nr=(xr=qe.current)===null||xr===void 0?void 0:xr.getPopupElement();if(nr&&nr.contains(sr)){var Zr=setTimeout(function(){var wa=fe.indexOf(Zr);if(wa!==-1&&fe.splice(wa,1),yn(),!De&&!nr.contains(document.activeElement)){var ms;(ms=Ge.current)===null||ms===void 0||ms.focus()}});fe.push(Zr)}for(var _i=arguments.length,gs=new Array(_i>1?_i-1:0),Vs=1;Vs<_i;Vs++)gs[Vs-1]=arguments[Vs];he==null||he.apply(void 0,[Yn].concat(gs))},Zt=y.useState({}),or=rt(Zt,2),tr=or[1];function vo(){tr({})}var fs;lr&&(fs=function(Yn){hn(Yn)}),E1t(function(){var pr;return[He.current,(pr=qe.current)===null||pr===void 0?void 0:pr.getPopupElement()]},fn,hn,!!lr);var ps=y.useMemo(function(){return $e($e({},n),{},{notFoundContent:p,open:at,triggerOpen:fn,id:r,showSearch:ce,multiple:ne,toggleOpen:hn})},[n,p,fn,at,r,ce,ne,hn]),Wo=!!N||b,Tl;Wo&&(Tl=y.createElement(nN,{className:Ue("".concat(i,"-arrow"),Le({},"".concat(i,"-arrow-loading"),b)),customizeIcon:N,customizeIconProps:{loading:b,searchValue:bn,open:at,focused:Rt,showSearch:ce}}));var rs=function(){var Yn;g==null||g(),(Yn=Ge.current)===null||Yn===void 0||Yn.focus(),d([],{type:"clear",values:u}),un("",!1,!1)},Dl=w1t(i,rs,u,j,B,v,bn,m),Xh=Dl.allowClear,Sc=Dl.clearIcon,oa=y.createElement(U,{ref:St}),zs=Ue(i,o,Le(Le(Le(Le(Le(Le(Le(Le(Le(Le({},"".concat(i,"-focused"),Rt),"".concat(i,"-multiple"),ne),"".concat(i,"-single"),!ne),"".concat(i,"-allow-clear"),j),"".concat(i,"-show-arrow"),Wo),"".concat(i,"-disabled"),v),"".concat(i,"-loading"),b),"".concat(i,"-open"),at),"".concat(i,"-customize-input"),Kn),"".concat(i,"-show-search"),ce)),Rl=y.createElement(dSt,{ref:qe,disabled:v,prefixCls:i,visible:fn,popupElement:oa,animation:K,transitionName:z,dropdownStyle:G,dropdownClassName:te,direction:c,dropdownMatchSelectWidth:ie,dropdownRender:Q,dropdownAlign:ge,placement:_e,builtinPlacements:Se,getPopupContainer:se,empty:h,getTriggerDOMNode:function(Yn){return Je.current||Yn},onPopupVisibleChange:fs,onPopupMouseEnter:vo},lr?y.cloneElement(lr,{ref:Rr}):y.createElement(G1t,ln({},n,{domRef:Je,prefixCls:i,inputElement:Kn,ref:Ge,id:r,showSearch:ce,autoClearSearchValue:R,mode:m,activeDescendantId:O,tagRender:a,values:u,open:at,onToggleOpen:hn,activeValue:T,searchValue:bn,onSearch:un,onSearchSubmit:qt,onRemove:Z,tokenWithEnter:Ut}))),Ps;return lr?Ps=Rl:Ps=y.createElement("div",ln({className:zs},Ae,{ref:He,onMouseDown:xt,onKeyDown:jn,onKeyUp:Zn,onFocus:W,onBlur:X}),y.createElement(pSt,{visible:Rt&&!at,values:u}),Rl,Tl,Xh&&Sc),y.createElement(Z4e.Provider,{value:ps},Ps)}),ire=function(){return null};ire.isSelectOptGroup=!0;var ore=function(){return null};ore.isSelectOption=!0;var iOe=y.forwardRef(function(n,e){var t=n.height,r=n.offsetY,i=n.offsetX,o=n.children,s=n.prefixCls,a=n.onInnerResize,c=n.innerProps,l=n.rtl,u=n.extra,d={},h={display:"flex",flexDirection:"column"};return r!==void 0&&(d={height:t,position:"relative",overflow:"hidden"},h=$e($e({},h),{},Le(Le(Le(Le(Le({transform:"translateY(".concat(r,"px)")},l?"marginRight":"marginLeft",-i),"position","absolute"),"left",0),"right",0),"top",0))),y.createElement("div",{style:d},y.createElement(Wy,{onResize:function(p){var g=p.offsetHeight;g&&a&&a()}},y.createElement("div",ln({style:h,className:Ue(Le({},"".concat(s,"-holder-inner"),s)),ref:e},c),o,u)))});iOe.displayName="Filler";function ySt(n){var e=n.children,t=n.setRef,r=y.useCallback(function(i){t(i)},[]);return y.cloneElement(e,{ref:r})}function bSt(n,e,t,r,i,o,s,a){var c=a.getKey;return n.slice(e,t+1).map(function(l,u){var d=e+u,h=s(l,d,{style:{width:r},offsetX:i}),f=c(l);return y.createElement(ySt,{key:f,setRef:function(g){return o(l,g)}},h)})}function SSt(n,e,t){var r=n.length,i=e.length,o,s;if(r===0&&i===0)return null;r<i?(o=n,s=e):(o=e,s=n);var a={__EMPTY_ITEM__:!0};function c(p){return p!==void 0?t(p):a}for(var l=null,u=Math.abs(r-i)!==1,d=0;d<s.length;d+=1){var h=c(o[d]),f=c(s[d]);if(h!==f){l=d,u=u||h!==c(s[d+1]);break}}return l===null?null:{index:l,multiple:u}}function _St(n,e,t){var r=y.useState(n),i=rt(r,2),o=i[0],s=i[1],a=y.useState(null),c=rt(a,2),l=c[0],u=c[1];return y.useEffect(function(){var d=SSt(o||[],n||[],e);(d==null?void 0:d.index)!==void 0&&u(n[d.index]),s(n)},[n]),[l]}var Bve=(typeof navigator>"u"?"undefined":Wn(navigator))==="object"&&/Firefox/i.test(navigator.userAgent);const oOe=function(n,e,t,r){var i=y.useRef(!1),o=y.useRef(null);function s(){clearTimeout(o.current),i.current=!0,o.current=setTimeout(function(){i.current=!1},50)}var a=y.useRef({top:n,bottom:e,left:t,right:r});return a.current.top=n,a.current.bottom=e,a.current.left=t,a.current.right=r,function(c,l){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,d=c?l<0&&a.current.left||l>0&&a.current.right:l<0&&a.current.top||l>0&&a.current.bottom;return u&&d?(clearTimeout(o.current),i.current=!1):(!d||i.current)&&s(),!i.current&&d}};function wSt(n,e,t,r,i,o,s){var a=y.useRef(0),c=y.useRef(null),l=y.useRef(null),u=y.useRef(!1),d=oOe(e,t,r,i);function h(b,S){no.cancel(c.current),a.current+=S,l.current=S,!d(!1,S)&&(Bve||b.preventDefault(),c.current=no(function(){var E=u.current?10:1;s(a.current*E),a.current=0}))}function f(b,S){s(S,!0),Bve||b.preventDefault()}var p=y.useRef(null),g=y.useRef(null);function m(b){if(n){no.cancel(g.current),g.current=no(function(){p.current=null},2);var S=b.deltaX,E=b.deltaY,w=b.shiftKey,C=S,I=E;(p.current==="sx"||!p.current&&w&&E&&!S)&&(C=E,I=0,p.current="sx");var T=Math.abs(C),D=Math.abs(I);p.current===null&&(p.current=o&&T>D?"x":"y"),p.current==="y"?h(b,I):f(b,C)}}function v(b){n&&(u.current=b.detail===l.current)}return[m,v]}function CSt(n,e,t,r){var i=y.useMemo(function(){return[new Map,[]]},[n,t.id,r]),o=rt(i,2),s=o[0],a=o[1],c=function(u){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:u,h=s.get(u),f=s.get(d);if(h===void 0||f===void 0)for(var p=n.length,g=a.length;g<p;g+=1){var m,v=n[g],b=e(v);s.set(b,g);var S=(m=t.get(b))!==null&&m!==void 0?m:r;if(a[g]=(a[g-1]||0)+S,b===u&&(h=g),b===d&&(f=g),h!==void 0&&f!==void 0)break}return{top:a[h-1]||0,bottom:a[f]}};return c}var xSt=function(){function n(){vc(this,n),Le(this,"maps",void 0),Le(this,"id",0),this.maps=Object.create(null)}return yc(n,[{key:"set",value:function(t,r){this.maps[t]=r,this.id+=1}},{key:"get",value:function(t){return this.maps[t]}}]),n}();function ESt(n,e,t){var r=y.useState(0),i=rt(r,2),o=i[0],s=i[1],a=y.useRef(new Map),c=y.useRef(new xSt),l=y.useRef();function u(){no.cancel(l.current)}function d(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;u();var p=function(){a.current.forEach(function(m,v){if(m&&m.offsetParent){var b=ok(m),S=b.offsetHeight;c.current.get(v)!==S&&c.current.set(v,b.offsetHeight)}}),s(function(m){return m+1})};f?p():l.current=no(p)}function h(f,p){var g=n(f);a.current.get(g),p?(a.current.set(g,p),d()):a.current.delete(g)}return y.useEffect(function(){return u},[]),[h,d,c.current,o]}var Hve=14/15;function ISt(n,e,t){var r=y.useRef(!1),i=y.useRef(0),o=y.useRef(0),s=y.useRef(null),a=y.useRef(null),c,l=function(f){if(r.current){var p=Math.ceil(f.touches[0].pageX),g=Math.ceil(f.touches[0].pageY),m=i.current-p,v=o.current-g,b=Math.abs(m)>Math.abs(v);b?i.current=p:o.current=g,t(b,b?m:v)&&f.preventDefault(),clearInterval(a.current),a.current=setInterval(function(){b?m*=Hve:v*=Hve;var S=Math.floor(b?m:v);(!t(b,S,!0)||Math.abs(S)<=.1)&&clearInterval(a.current)},16)}},u=function(){r.current=!1,c()},d=function(f){c(),f.touches.length===1&&!r.current&&(r.current=!0,i.current=Math.ceil(f.touches[0].pageX),o.current=Math.ceil(f.touches[0].pageY),s.current=f.target,s.current.addEventListener("touchmove",l,{passive:!1}),s.current.addEventListener("touchend",u,{passive:!0}))};c=function(){s.current&&(s.current.removeEventListener("touchmove",l),s.current.removeEventListener("touchend",u))},es(function(){return n&&e.current.addEventListener("touchstart",d,{passive:!0}),function(){var h;(h=e.current)===null||h===void 0||h.removeEventListener("touchstart",d),c(),clearInterval(a.current)}},[n])}var PSt=10;function kSt(n,e,t,r,i,o,s,a){var c=y.useRef(),l=y.useState(null),u=rt(l,2),d=u[0],h=u[1];return es(function(){if(d&&d.times<PSt){if(!n.current){h(function(U){return $e({},U)});return}o();var f=d.targetAlign,p=d.originAlign,g=d.index,m=d.offset,v=n.current.clientHeight,b=!1,S=f,E=null;if(v){for(var w=f||p,C=0,I=0,T=0,D=Math.min(e.length-1,g),O=0;O<=D;O+=1){var M=i(e[O]);I=C;var R=t.get(M);T=I+(R===void 0?r:R),C=T}for(var A=w==="top"?m:v-m,k=D;k>=0;k-=1){var L=i(e[k]),j=t.get(L);if(j===void 0){b=!0;break}if(A-=j,A<=0)break}switch(w){case"top":E=I-m;break;case"bottom":E=T-v+m;break;default:{var N=n.current.scrollTop,B=N+v;I<N?S="top":T>B&&(S="bottom")}}E!==null&&s(E),E!==d.lastTop&&(b=!0)}b&&h($e($e({},d),{},{times:d.times+1,targetAlign:S,lastTop:E}))}},[d,n.current]),function(f){if(f==null){a();return}if(no.cancel(c.current),typeof f=="number")s(f);else if(f&&Wn(f)==="object"){var p,g=f.align;"index"in f?p=f.index:p=e.findIndex(function(b){return i(b)===f.key});var m=f.offset,v=m===void 0?0:m;h({times:0,index:p,offset:v,originAlign:g})}}}function Uve(n,e){var t="touches"in n?n.touches[0]:n;return t[e?"pageX":"pageY"]}var zve=y.forwardRef(function(n,e){var t=n.prefixCls,r=n.rtl,i=n.scrollOffset,o=n.scrollRange,s=n.onStartMove,a=n.onStopMove,c=n.onScroll,l=n.horizontal,u=n.spinSize,d=n.containerSize,h=n.style,f=n.thumbStyle,p=y.useState(!1),g=rt(p,2),m=g[0],v=g[1],b=y.useState(null),S=rt(b,2),E=S[0],w=S[1],C=y.useState(null),I=rt(C,2),T=I[0],D=I[1],O=!r,M=y.useRef(),R=y.useRef(),A=y.useState(!1),k=rt(A,2),L=k[0],j=k[1],N=y.useRef(),B=function(){clearTimeout(N.current),j(!0),N.current=setTimeout(function(){j(!1)},3e3)},U=o-d||0,K=d-u||0,z=y.useMemo(function(){if(i===0||U===0)return 0;var ee=i/U;return ee*K},[i,U,K]),G=function(Y){Y.stopPropagation(),Y.preventDefault()},te=y.useRef({top:z,dragging:m,pageY:E,startTop:T});te.current={top:z,dragging:m,pageY:E,startTop:T};var ie=function(Y){v(!0),w(Uve(Y,l)),D(te.current.top),s(),Y.stopPropagation(),Y.preventDefault()};y.useEffect(function(){var ee=function(V){V.preventDefault()},Y=M.current,ue=R.current;return Y.addEventListener("touchstart",ee,{passive:!1}),ue.addEventListener("touchstart",ie,{passive:!1}),function(){Y.removeEventListener("touchstart",ee),ue.removeEventListener("touchstart",ie)}},[]);var Q=y.useRef();Q.current=U;var ge=y.useRef();ge.current=K,y.useEffect(function(){if(m){var ee,Y=function(V){var le=te.current,he=le.dragging,oe=le.pageY,ne=le.startTop;no.cancel(ee);var ce=M.current.getBoundingClientRect(),Ae=d/(l?ce.width:ce.height);if(he){var Ie=(Uve(V,l)-oe)*Ae,be=ne;!O&&l?be-=Ie:be+=Ie;var De=Q.current,Me=ge.current,He=Me?be/Me:0,Je=Math.ceil(He*De);Je=Math.max(Je,0),Je=Math.min(Je,De),ee=no(function(){c(Je,l)})}},ue=function(){v(!1),a()};return window.addEventListener("mousemove",Y,{passive:!0}),window.addEventListener("touchmove",Y,{passive:!0}),window.addEventListener("mouseup",ue,{passive:!0}),window.addEventListener("touchend",ue,{passive:!0}),function(){window.removeEventListener("mousemove",Y),window.removeEventListener("touchmove",Y),window.removeEventListener("mouseup",ue),window.removeEventListener("touchend",ue),no.cancel(ee)}}},[m]),y.useEffect(function(){return B(),function(){clearTimeout(N.current)}},[i]),y.useImperativeHandle(e,function(){return{delayHidden:B}});var _e="".concat(t,"-scrollbar"),Se={position:"absolute",visibility:L?null:"hidden"},se={position:"absolute",background:"rgba(0, 0, 0, 0.5)",borderRadius:99,cursor:"pointer",userSelect:"none"};return l?(Se.height=8,Se.left=0,Se.right=0,Se.bottom=0,se.height="100%",se.width=u,O?se.left=z:se.right=z):(Se.width=8,Se.top=0,Se.bottom=0,O?Se.right=0:Se.left=0,se.width="100%",se.height=u,se.top=z),y.createElement("div",{ref:M,className:Ue(_e,Le(Le(Le({},"".concat(_e,"-horizontal"),l),"".concat(_e,"-vertical"),!l),"".concat(_e,"-visible"),L)),style:$e($e({},Se),h),onMouseDown:G,onMouseMove:B},y.createElement("div",{ref:R,className:Ue("".concat(_e,"-thumb"),Le({},"".concat(_e,"-thumb-moving"),m)),style:$e($e({},se),f),onMouseDown:ie}))}),TSt=20;function Vve(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=n/e*n;return isNaN(t)&&(t=0),t=Math.max(t,TSt),Math.floor(t)}var DSt=["prefixCls","className","height","itemHeight","fullHeight","style","data","children","itemKey","virtual","direction","scrollWidth","component","onScroll","onVirtualScroll","onVisibleChange","innerProps","extraRender","styles"],RSt=[],ASt={overflowY:"auto",overflowAnchor:"none"};function OSt(n,e){var t=n.prefixCls,r=t===void 0?"rc-virtual-list":t,i=n.className,o=n.height,s=n.itemHeight,a=n.fullHeight,c=a===void 0?!0:a,l=n.style,u=n.data,d=n.children,h=n.itemKey,f=n.virtual,p=n.direction,g=n.scrollWidth,m=n.component,v=m===void 0?"div":m,b=n.onScroll,S=n.onVirtualScroll,E=n.onVisibleChange,w=n.innerProps,C=n.extraRender,I=n.styles,T=jr(n,DSt),D=y.useCallback(function(ve){return typeof h=="function"?h(ve):ve==null?void 0:ve[h]},[h]),O=ESt(D),M=rt(O,4),R=M[0],A=M[1],k=M[2],L=M[3],j=!!(f!==!1&&o&&s),N=y.useMemo(function(){return Object.values(k.maps).reduce(function(ve,W){return ve+W},0)},[k.id,k.maps]),B=j&&u&&(Math.max(s*u.length,N)>o||!!g),U=p==="rtl",K=Ue(r,Le({},"".concat(r,"-rtl"),U),i),z=u||RSt,G=y.useRef(),te=y.useRef(),ie=y.useRef(),Q=y.useState(0),ge=rt(Q,2),_e=ge[0],Se=ge[1],se=y.useState(0),ee=rt(se,2),Y=ee[0],ue=ee[1],ye=y.useState(!1),V=rt(ye,2),le=V[0],he=V[1],oe=function(){he(!0)},ne=function(){he(!1)},ce={getKey:D};function Ae(ve){Se(function(W){var X;typeof ve=="function"?X=ve(W):X=ve;var fe=ke(X);return G.current.scrollTop=fe,fe})}var Ie=y.useRef({start:0,end:z.length}),be=y.useRef(),De=_St(z,D),Me=rt(De,1),He=Me[0];be.current=He;var Je=y.useMemo(function(){if(!j)return{scrollHeight:void 0,start:0,end:z.length-1,offset:void 0};if(!B){var ve;return{scrollHeight:((ve=te.current)===null||ve===void 0?void 0:ve.offsetHeight)||0,start:0,end:z.length-1,offset:void 0}}for(var W=0,X,fe,xt,Zt=z.length,or=0;or<Zt;or+=1){var tr=z[or],vo=D(tr),fs=k.get(vo),ps=W+(fs===void 0?s:fs);ps>=_e&&X===void 0&&(X=or,fe=W),ps>_e+o&&xt===void 0&&(xt=or),W=ps}return X===void 0&&(X=0,fe=0,xt=Math.ceil(o/s)),xt===void 0&&(xt=z.length-1),xt=Math.min(xt+1,z.length-1),{scrollHeight:W,start:X,end:xt,offset:fe}},[B,j,_e,z,L,o]),qe=Je.scrollHeight,Ge=Je.start,St=Je.end,Pt=Je.offset;Ie.current.start=Ge,Ie.current.end=St;var on=y.useState({width:0,height:o}),an=rt(on,2),Rt=an[0],Xt=an[1],yn=function(W){Xt({width:W.offsetWidth,height:W.offsetHeight})},bn=y.useRef(),Kn=y.useRef(),lr=y.useMemo(function(){return Vve(Rt.width,g)},[Rt.width,g]),Rr=y.useMemo(function(){return Vve(Rt.height,qe)},[Rt.height,qe]),Lr=qe-o,er=y.useRef(Lr);er.current=Lr;function ke(ve){var W=ve;return Number.isNaN(er.current)||(W=Math.min(W,er.current)),W=Math.max(W,0),W}var Qn=_e<=0,Gn=_e>=Lr,J=Y<=0,ze=Y>=g,it=oOe(Qn,Gn,J,ze),at=function(){return{x:U?-Y:Y,y:_e}},Lt=y.useRef(at()),fn=ea(function(ve){if(S){var W=$e($e({},at()),ve);(Lt.current.x!==W.x||Lt.current.y!==W.y)&&(S(W),Lt.current=W)}});function hn(ve,W){var X=ve;W?(Wu.flushSync(function(){ue(X)}),fn()):Ae(X)}function Ut(ve){var W=ve.currentTarget.scrollTop;W!==_e&&Ae(W),b==null||b(ve),fn()}var sn=function(W){var X=W,fe=g?g-Rt.width:0;return X=Math.max(X,0),X=Math.min(X,fe),X},ae=ea(function(ve,W){W?(Wu.flushSync(function(){ue(function(X){var fe=X+(U?-ve:ve);return sn(fe)})}),fn()):Ae(function(X){var fe=X+ve;return fe})}),Wt=wSt(j,Qn,Gn,J,ze,!!g,ae),un=rt(Wt,2),qt=un[0],Ce=un[1];ISt(j,G,function(ve,W,X){return it(ve,W,X)?!1:(qt({preventDefault:function(){},deltaX:ve?W:0,deltaY:ve?0:W}),!0)}),es(function(){function ve(X){j&&X.preventDefault()}var W=G.current;return W.addEventListener("wheel",qt,{passive:!1}),W.addEventListener("DOMMouseScroll",Ce,{passive:!0}),W.addEventListener("MozMousePixelScroll",ve,{passive:!1}),function(){W.removeEventListener("wheel",qt),W.removeEventListener("DOMMouseScroll",Ce),W.removeEventListener("MozMousePixelScroll",ve)}},[j]),es(function(){if(g){var ve=sn(Y);ue(ve),fn({x:ve})}},[Rt.width,g]);var ct=function(){var W,X;(W=bn.current)===null||W===void 0||W.delayHidden(),(X=Kn.current)===null||X===void 0||X.delayHidden()},At=kSt(G,z,k,s,D,function(){return A(!0)},Ae,ct);y.useImperativeHandle(e,function(){return{nativeElement:ie.current,getScrollInfo:at,scrollTo:function(W){function X(fe){return fe&&Wn(fe)==="object"&&("left"in fe||"top"in fe)}X(W)?(W.left!==void 0&&ue(sn(W.left)),At(W.top)):At(W)}}}),es(function(){if(E){var ve=z.slice(Ge,St+1);E(ve,z)}},[Ge,St,z]);var $t=CSt(z,D,k,s),_n=C==null?void 0:C({start:Ge,end:St,virtual:B,offsetX:Y,offsetY:Pt,rtl:U,getSize:$t}),jn=bSt(z,Ge,St,g,Y,R,d,ce),Zn=null;o&&(Zn=$e(Le({},c?"height":"maxHeight",o),ASt),j&&(Zn.overflowY="hidden",g&&(Zn.overflowX="hidden"),le&&(Zn.pointerEvents="none")));var Z={};return U&&(Z.dir="rtl"),y.createElement("div",ln({ref:ie,style:$e($e({},l),{},{position:"relative"}),className:K},Z,T),y.createElement(Wy,{onResize:yn},y.createElement(v,{className:"".concat(r,"-holder"),style:Zn,ref:G,onScroll:Ut,onMouseEnter:ct},y.createElement(iOe,{prefixCls:r,height:qe,offsetX:Y,offsetY:Pt,scrollWidth:g,onInnerResize:A,ref:te,innerProps:w,rtl:U,extra:_n},jn))),B&&qe>o&&y.createElement(zve,{ref:bn,prefixCls:r,scrollOffset:_e,scrollRange:qe,rtl:U,onScroll:hn,onStartMove:oe,onStopMove:ne,spinSize:Rr,containerSize:Rt.height,style:I==null?void 0:I.verticalScrollBar,thumbStyle:I==null?void 0:I.verticalScrollBarThumb}),B&&g>Rt.width&&y.createElement(zve,{ref:Kn,prefixCls:r,scrollOffset:Y,scrollRange:g,rtl:U,onScroll:hn,onStartMove:oe,onStopMove:ne,spinSize:lr,containerSize:Rt.width,horizontal:!0,style:I==null?void 0:I.horizontalScrollBar,thumbStyle:I==null?void 0:I.horizontalScrollBarThumb}))}var sOe=y.forwardRef(OSt);sOe.displayName="List";function MSt(){return/(mac\sos|macintosh)/i.test(navigator.appVersion)}var $St=["disabled","title","children","style","className"];function Wve(n){return typeof n=="string"||typeof n=="number"}var LSt=function(e,t){var r=C1t(),i=r.prefixCls,o=r.id,s=r.open,a=r.multiple,c=r.mode,l=r.searchValue,u=r.toggleOpen,d=r.notFoundContent,h=r.onPopupScroll,f=y.useContext(rre),p=f.maxCount,g=f.flattenOptions,m=f.onActiveValue,v=f.defaultActiveFirstOption,b=f.onSelect,S=f.menuItemSelectedIcon,E=f.rawValues,w=f.fieldNames,C=f.virtual,I=f.direction,T=f.listHeight,D=f.listItemHeight,O=f.optionRender,M="".concat(i,"-item"),R=cD(function(){return g},[s,g],function(ee,Y){return Y[0]&&ee[1]!==Y[1]}),A=y.useRef(null),k=y.useMemo(function(){return a&&pZ(p)&&(E==null?void 0:E.size)>=p},[a,p,E==null?void 0:E.size]),L=function(Y){Y.preventDefault()},j=function(Y){var ue;(ue=A.current)===null||ue===void 0||ue.scrollTo(typeof Y=="number"?{index:Y}:Y)},N=function(Y){for(var ue=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,ye=R.length,V=0;V<ye;V+=1){var le=(Y+V*ue+ye)%ye,he=R[le]||{},oe=he.group,ne=he.data;if(!oe&&!(ne!=null&&ne.disabled)&&!k)return le}return-1},B=y.useState(function(){return N(0)}),U=rt(B,2),K=U[0],z=U[1],G=function(Y){var ue=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;z(Y);var ye={source:ue?"keyboard":"mouse"},V=R[Y];if(!V){m(null,-1,ye);return}m(V.value,Y,ye)};y.useEffect(function(){G(v!==!1?N(0):-1)},[R.length,l]);var te=y.useCallback(function(ee){return E.has(ee)&&c!=="combobox"},[c,Ht(E).toString(),E.size]);y.useEffect(function(){var ee=setTimeout(function(){if(!a&&s&&E.size===1){var ue=Array.from(E)[0],ye=R.findIndex(function(V){var le=V.data;return le.value===ue});ye!==-1&&(G(ye),j(ye))}});if(s){var Y;(Y=A.current)===null||Y===void 0||Y.scrollTo(void 0)}return function(){return clearTimeout(ee)}},[s,l]);var ie=function(Y){Y!==void 0&&b(Y,{selected:!E.has(Y)}),a||u(!1)};if(y.useImperativeHandle(t,function(){return{onKeyDown:function(Y){var ue=Y.which,ye=Y.ctrlKey;switch(ue){case Bt.N:case Bt.P:case Bt.UP:case Bt.DOWN:{var V=0;if(ue===Bt.UP?V=-1:ue===Bt.DOWN?V=1:MSt()&&ye&&(ue===Bt.N?V=1:ue===Bt.P&&(V=-1)),V!==0){var le=N(K+V,V);j(le),G(le,!0)}break}case Bt.ENTER:{var he,oe=R[K];oe&&!(oe!=null&&(he=oe.data)!==null&&he!==void 0&&he.disabled)&&!k?ie(oe.value):ie(void 0),s&&Y.preventDefault();break}case Bt.ESC:u(!1),s&&Y.stopPropagation()}},onKeyUp:function(){},scrollTo:function(Y){j(Y)}}}),R.length===0)return y.createElement("div",{role:"listbox",id:"".concat(o,"_list"),className:"".concat(M,"-empty"),onMouseDown:L},d);var Q=Object.keys(w).map(function(ee){return w[ee]}),ge=function(Y){return Y.label};function _e(ee,Y){var ue=ee.group;return{role:ue?"presentation":"option",id:"".concat(o,"_list_").concat(Y)}}var Se=function(Y){var ue=R[Y];if(!ue)return null;var ye=ue.data||{},V=ye.value,le=ue.group,he=pg(ye,!0),oe=ge(ue);return ue?y.createElement("div",ln({"aria-label":typeof oe=="string"&&!le?oe:null},he,{key:Y},_e(ue,Y),{"aria-selected":te(V)}),V):null},se={role:"listbox",id:"".concat(o,"_list")};return y.createElement(y.Fragment,null,C&&y.createElement("div",ln({},se,{style:{height:0,width:0,overflow:"hidden"}}),Se(K-1),Se(K),Se(K+1)),y.createElement(sOe,{itemKey:"key",ref:A,data:R,height:T,itemHeight:D,fullHeight:!1,onMouseDown:L,onScroll:h,virtual:C,direction:I,innerProps:C?null:se},function(ee,Y){var ue=ee.group,ye=ee.groupOption,V=ee.data,le=ee.label,he=ee.value,oe=V.key;if(ue){var ne,ce=(ne=V.title)!==null&&ne!==void 0?ne:Wve(le)?le.toString():void 0;return y.createElement("div",{className:Ue(M,"".concat(M,"-group"),V.className),title:ce},le!==void 0?le:oe)}var Ae=V.disabled,Ie=V.title;V.children;var be=V.style,De=V.className,Me=jr(V,$St),He=Yc(Me,Q),Je=te(he),qe=Ae||!Je&&k,Ge="".concat(M,"-option"),St=Ue(M,Ge,De,Le(Le(Le(Le({},"".concat(Ge,"-grouped"),ye),"".concat(Ge,"-active"),K===Y&&!qe),"".concat(Ge,"-disabled"),qe),"".concat(Ge,"-selected"),Je)),Pt=ge(ee),on=!S||typeof S=="function"||Je,an=typeof Pt=="number"?Pt:Pt||he,Rt=Wve(an)?an.toString():void 0;return Ie!==void 0&&(Rt=Ie),y.createElement("div",ln({},pg(He),C?{}:_e(ee,Y),{"aria-selected":Je,className:St,title:Rt,onMouseMove:function(){K===Y||qe||G(Y)},onClick:function(){qe||ie(he)},style:be}),y.createElement("div",{className:"".concat(Ge,"-content")},typeof O=="function"?O(ee,{index:Y}):an),y.isValidElement(S)||Je,on&&y.createElement(nN,{className:"".concat(M,"-option-state"),customizeIcon:S,customizeIconProps:{value:he,disabled:qe,isSelected:Je}},Je?"✓":null))}))},NSt=y.forwardRef(LSt);const FSt=function(n,e){var t=y.useRef({values:new Map,options:new Map}),r=y.useMemo(function(){var o=t.current,s=o.values,a=o.options,c=n.map(function(d){if(d.label===void 0){var h;return $e($e({},d),{},{label:(h=s.get(d.value))===null||h===void 0?void 0:h.label})}return d}),l=new Map,u=new Map;return c.forEach(function(d){l.set(d.value,d),u.set(d.value,e.get(d.value)||a.get(d.value))}),t.current.values=l,t.current.options=u,c},[n,e]),i=y.useCallback(function(o){return e.get(o)||t.current.options.get(o)},[e]);return[r,i]};function jH(n,e){return tOe(n).join("").toUpperCase().includes(e)}const jSt=function(n,e,t,r,i){return y.useMemo(function(){if(!t||r===!1)return n;var o=e.options,s=e.label,a=e.value,c=[],l=typeof r=="function",u=t.toUpperCase(),d=l?r:function(f,p){return i?jH(p[i],u):p[o]?jH(p[s!=="children"?s:"label"],u):jH(p[a],u)},h=l?function(f){return gZ(f)}:function(f){return f};return n.forEach(function(f){if(f[o]){var p=d(t,h(f));if(p)c.push(f);else{var g=f[o].filter(function(m){return d(t,h(m))});g.length&&c.push($e($e({},f),{},Le({},o,g)))}return}d(t,h(f))&&c.push(f)}),c},[n,r,i,t,e])};var qve=0,BSt=eu();function HSt(){var n;return BSt?(n=qve,qve+=1):n="TEST_OR_SSR",n}function USt(n){var e=y.useState(),t=rt(e,2),r=t[0],i=t[1];return y.useEffect(function(){i("rc_select_".concat(HSt()))},[]),n||r}var zSt=["children","value"],VSt=["children"];function WSt(n){var e=n,t=e.key,r=e.props,i=r.children,o=r.value,s=jr(r,zSt);return $e({key:t,value:o!==void 0?o:t,children:i},s)}function aOe(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return hg(n).map(function(t,r){if(!y.isValidElement(t)||!t.type)return null;var i=t,o=i.type.isSelectOptGroup,s=i.key,a=i.props,c=a.children,l=jr(a,VSt);return e||!o?WSt(t):$e($e({key:"__RC_SELECT_GRP__".concat(s===null?r:s,"__"),label:s},l),{},{options:aOe(c)})}).filter(function(t){return t})}var qSt=function(e,t,r,i,o){return y.useMemo(function(){var s=e,a=!e;a&&(s=aOe(t));var c=new Map,l=new Map,u=function(f,p,g){g&&typeof g=="string"&&f.set(p[g],p)},d=function h(f){for(var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,g=0;g<f.length;g+=1){var m=f[g];!m[r.options]||p?(c.set(m[r.value],m),u(l,m,r.label),u(l,m,i),u(l,m,o)):h(m[r.options],!0)}};return d(s),{options:s,valueOptions:c,labelOptions:l}},[e,t,r,i,o])};function Kve(n){var e=y.useRef();e.current=n;var t=y.useCallback(function(){return e.current.apply(e,arguments)},[]);return t}var KSt=["id","mode","prefixCls","backfill","fieldNames","inputValue","searchValue","onSearch","autoClearSearchValue","onSelect","onDeselect","dropdownMatchSelectWidth","filterOption","filterSort","optionFilterProp","optionLabelProp","options","optionRender","children","defaultActiveFirstOption","menuItemSelectedIcon","virtual","direction","listHeight","listItemHeight","labelRender","value","defaultValue","labelInValue","onChange","maxCount"],GSt=["inputValue"];function ZSt(n){return!n||Wn(n)!=="object"}var XSt=y.forwardRef(function(n,e){var t=n.id,r=n.mode,i=n.prefixCls,o=i===void 0?"rc-select":i,s=n.backfill,a=n.fieldNames,c=n.inputValue,l=n.searchValue,u=n.onSearch,d=n.autoClearSearchValue,h=d===void 0?!0:d,f=n.onSelect,p=n.onDeselect,g=n.dropdownMatchSelectWidth,m=g===void 0?!0:g,v=n.filterOption,b=n.filterSort,S=n.optionFilterProp,E=n.optionLabelProp,w=n.options,C=n.optionRender,I=n.children,T=n.defaultActiveFirstOption,D=n.menuItemSelectedIcon,O=n.virtual,M=n.direction,R=n.listHeight,A=R===void 0?200:R,k=n.listItemHeight,L=k===void 0?20:k,j=n.labelRender,N=n.value,B=n.defaultValue,U=n.labelInValue,K=n.onChange,z=n.maxCount,G=jr(n,KSt),te=USt(t),ie=mZ(r),Q=!!(!w&&I),ge=y.useMemo(function(){return v===void 0&&r==="combobox"?!1:v},[v,r]),_e=y.useMemo(function(){return rOe(a,Q)},[JSON.stringify(a),Q]),Se=Ql("",{value:l!==void 0?l:c,postState:function(sn){return sn||""}}),se=rt(Se,2),ee=se[0],Y=se[1],ue=qSt(w,I,_e,S,E),ye=ue.valueOptions,V=ue.labelOptions,le=ue.options,he=y.useCallback(function(Ut){var sn=tOe(Ut);return sn.map(function(ae){var Wt,un,qt,Ce,ct;if(ZSt(ae))Wt=ae;else{var At;qt=ae.key,un=ae.label,Wt=(At=ae.value)!==null&&At!==void 0?At:qt}var $t=ye.get(Wt);if($t){var _n;un===void 0&&(un=$t==null?void 0:$t[E||_e.label]),qt===void 0&&(qt=(_n=$t==null?void 0:$t.key)!==null&&_n!==void 0?_n:Wt),Ce=$t==null?void 0:$t.disabled,ct=$t==null?void 0:$t.title}return{label:un,value:Wt,key:qt,disabled:Ce,title:ct}})},[_e,E,ye]),oe=Ql(B,{value:N}),ne=rt(oe,2),ce=ne[0],Ae=ne[1],Ie=y.useMemo(function(){var Ut,sn=ie&&ce===null?[]:ce,ae=he(sn);return r==="combobox"&&U1t((Ut=ae[0])===null||Ut===void 0?void 0:Ut.value)?[]:ae},[ce,he,r,ie]),be=FSt(Ie,ye),De=rt(be,2),Me=De[0],He=De[1],Je=y.useMemo(function(){if(!r&&Me.length===1){var Ut=Me[0];if(Ut.value===null&&(Ut.label===null||Ut.label===void 0))return[]}return Me.map(function(sn){var ae;return $e($e({},sn),{},{label:(ae=typeof j=="function"?j(sn):sn.label)!==null&&ae!==void 0?ae:sn.value})})},[r,Me,j]),qe=y.useMemo(function(){return new Set(Me.map(function(Ut){return Ut.value}))},[Me]);y.useEffect(function(){if(r==="combobox"){var Ut,sn=(Ut=Me[0])===null||Ut===void 0?void 0:Ut.value;Y(H1t(sn)?String(sn):"")}},[Me]);var Ge=Kve(function(Ut,sn){var ae=sn??Ut;return Le(Le({},_e.value,Ut),_e.label,ae)}),St=y.useMemo(function(){if(r!=="tags")return le;var Ut=Ht(le),sn=function(Wt){return ye.has(Wt)};return Ht(Me).sort(function(ae,Wt){return ae.value<Wt.value?-1:1}).forEach(function(ae){var Wt=ae.value;sn(Wt)||Ut.push(Ge(Wt,ae.label))}),Ut},[Ge,le,ye,Me,r]),Pt=jSt(St,_e,ee,ge,S),on=y.useMemo(function(){return r!=="tags"||!ee||Pt.some(function(Ut){return Ut[S||"value"]===ee})||Pt.some(function(Ut){return Ut[_e.value]===ee})?Pt:[Ge(ee)].concat(Ht(Pt))},[Ge,S,r,Pt,ee,_e]),an=function Ut(sn){var ae=Ht(sn).sort(function(Wt,un){return b(Wt,un,{searchValue:ee})});return ae.map(function(Wt){return Array.isArray(Wt.options)?$e($e({},Wt),{},{options:Wt.options.length>0?Ut(Wt.options):Wt.options}):Wt})},Rt=y.useMemo(function(){return b?an(on):on},[on,b,ee]),Xt=y.useMemo(function(){return hSt(Rt,{fieldNames:_e,childrenAsData:Q})},[Rt,_e,Q]),yn=function(sn){var ae=he(sn);if(Ae(ae),K&&(ae.length!==Me.length||ae.some(function(qt,Ce){var ct;return((ct=Me[Ce])===null||ct===void 0?void 0:ct.value)!==(qt==null?void 0:qt.value)}))){var Wt=U?ae:ae.map(function(qt){return qt.value}),un=ae.map(function(qt){return gZ(He(qt.value))});K(ie?Wt:Wt[0],ie?un:un[0])}},bn=y.useState(null),Kn=rt(bn,2),lr=Kn[0],Rr=Kn[1],Lr=y.useState(0),er=rt(Lr,2),ke=er[0],Qn=er[1],Gn=T!==void 0?T:r!=="combobox",J=y.useCallback(function(Ut,sn){var ae=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},Wt=ae.source,un=Wt===void 0?"keyboard":Wt;Qn(sn),s&&r==="combobox"&&Ut!==null&&un==="keyboard"&&Rr(String(Ut))},[s,r]),ze=function(sn,ae,Wt){var un=function(){var ve,W=He(sn);return[U?{label:W==null?void 0:W[_e.label],value:sn,key:(ve=W==null?void 0:W.key)!==null&&ve!==void 0?ve:sn}:sn,gZ(W)]};if(ae&&f){var qt=un(),Ce=rt(qt,2),ct=Ce[0],At=Ce[1];f(ct,At)}else if(!ae&&p&&Wt!=="clear"){var $t=un(),_n=rt($t,2),jn=_n[0],Zn=_n[1];p(jn,Zn)}},it=Kve(function(Ut,sn){var ae,Wt=ie?sn.selected:!0;Wt?ae=ie?[].concat(Ht(Me),[Ut]):[Ut]:ae=Me.filter(function(un){return un.value!==Ut}),yn(ae),ze(Ut,Wt),r==="combobox"?Rr(""):(!mZ||h)&&(Y(""),Rr(""))}),at=function(sn,ae){yn(sn);var Wt=ae.type,un=ae.values;(Wt==="remove"||Wt==="clear")&&un.forEach(function(qt){ze(qt.value,!1,Wt)})},Lt=function(sn,ae){if(Y(sn),Rr(null),ae.source==="submit"){var Wt=(sn||"").trim();if(Wt){var un=Array.from(new Set([].concat(Ht(qe),[Wt])));yn(un),ze(Wt,!0),Y("")}return}ae.source!=="blur"&&(r==="combobox"&&yn(sn),u==null||u(sn))},fn=function(sn){var ae=sn;r!=="tags"&&(ae=sn.map(function(un){var qt=V.get(un);return qt==null?void 0:qt.value}).filter(function(un){return un!==void 0}));var Wt=Array.from(new Set([].concat(Ht(qe),Ht(ae))));yn(Wt),Wt.forEach(function(un){ze(un,!0)})},hn=y.useMemo(function(){var Ut=O!==!1&&m!==!1;return $e($e({},ue),{},{flattenOptions:Xt,onActiveValue:J,defaultActiveFirstOption:Gn,onSelect:it,menuItemSelectedIcon:D,rawValues:qe,fieldNames:_e,virtual:Ut,direction:M,listHeight:A,listItemHeight:L,childrenAsData:Q,maxCount:z,optionRender:C})},[z,ue,Xt,J,Gn,it,D,qe,_e,O,m,M,A,L,Q,C]);return y.createElement(rre.Provider,{value:hn},y.createElement(vSt,ln({},G,{id:te,prefixCls:o,ref:e,omitDomProps:GSt,mode:r,displayValues:Je,onDisplayValuesChange:at,direction:M,searchValue:ee,onSearch:Lt,autoClearSearchValue:h,onSearchSplit:fn,dropdownMatchSelectWidth:m,OptionList:NSt,emptyOptions:!Xt.length,activeValue:lr,activeDescendantId:"".concat(te,"_list_").concat(ke)})))}),sre=XSt;sre.Option=ore;sre.OptGroup=ire;function P8(n,e,t){return Ue({[`${n}-status-success`]:e==="success",[`${n}-status-warning`]:e==="warning",[`${n}-status-error`]:e==="error",[`${n}-status-validating`]:e==="validating",[`${n}-has-feedback`]:t})}const iN=(n,e)=>e||n,YSt=()=>{const[,n]=Gu(),t=new Fa(n.colorBgBase).toHsl().l<.5?{opacity:.65}:{};return y.createElement("svg",{style:t,width:"184",height:"152",viewBox:"0 0 184 152",xmlns:"http://www.w3.org/2000/svg"},y.createElement("title",null,"empty image"),y.createElement("g",{fill:"none",fillRule:"evenodd"},y.createElement("g",{transform:"translate(24 31.67)"},y.createElement("ellipse",{fillOpacity:".8",fill:"#F5F5F7",cx:"67.797",cy:"106.89",rx:"67.797",ry:"12.668"}),y.createElement("path",{d:"M122.034 69.674L98.109 40.229c-1.148-1.386-2.826-2.225-4.593-2.225h-51.44c-1.766 0-3.444.839-4.592 2.225L13.56 69.674v15.383h108.475V69.674z",fill:"#AEB8C2"}),y.createElement("path",{d:"M101.537 86.214L80.63 61.102c-1.001-1.207-2.507-1.867-4.048-1.867H31.724c-1.54 0-3.047.66-4.048 1.867L6.769 86.214v13.792h94.768V86.214z",fill:"url(#linearGradient-1)",transform:"translate(13.56)"}),y.createElement("path",{d:"M33.83 0h67.933a4 4 0 0 1 4 4v93.344a4 4 0 0 1-4 4H33.83a4 4 0 0 1-4-4V4a4 4 0 0 1 4-4z",fill:"#F5F5F7"}),y.createElement("path",{d:"M42.678 9.953h50.237a2 2 0 0 1 2 2V36.91a2 2 0 0 1-2 2H42.678a2 2 0 0 1-2-2V11.953a2 2 0 0 1 2-2zM42.94 49.767h49.713a2.262 2.262 0 1 1 0 4.524H42.94a2.262 2.262 0 0 1 0-4.524zM42.94 61.53h49.713a2.262 2.262 0 1 1 0 4.525H42.94a2.262 2.262 0 0 1 0-4.525zM121.813 105.032c-.775 3.071-3.497 5.36-6.735 5.36H20.515c-3.238 0-5.96-2.29-6.734-5.36a7.309 7.309 0 0 1-.222-1.79V69.675h26.318c2.907 0 5.25 2.448 5.25 5.42v.04c0 2.971 2.37 5.37 5.277 5.37h34.785c2.907 0 5.277-2.421 5.277-5.393V75.1c0-2.972 2.343-5.426 5.25-5.426h26.318v33.569c0 .617-.077 1.216-.221 1.789z",fill:"#DCE0E6"})),y.createElement("path",{d:"M149.121 33.292l-6.83 2.65a1 1 0 0 1-1.317-1.23l1.937-6.207c-2.589-2.944-4.109-6.534-4.109-10.408C138.802 8.102 148.92 0 161.402 0 173.881 0 184 8.102 184 18.097c0 9.995-10.118 18.097-22.599 18.097-4.528 0-8.744-1.066-12.28-2.902z",fill:"#DCE0E6"}),y.createElement("g",{transform:"translate(149.65 15.383)",fill:"#FFF"},y.createElement("ellipse",{cx:"20.654",cy:"3.167",rx:"2.849",ry:"2.815"}),y.createElement("path",{d:"M5.698 5.63H0L2.898.704zM9.259.704h4.985V5.63H9.259z"}))))},JSt=()=>{const[,n]=Gu(),{colorFill:e,colorFillTertiary:t,colorFillQuaternary:r,colorBgContainer:i}=n,{borderColor:o,shadowColor:s,contentColor:a}=y.useMemo(()=>({borderColor:new Fa(e).onBackground(i).toHexShortString(),shadowColor:new Fa(t).onBackground(i).toHexShortString(),contentColor:new Fa(r).onBackground(i).toHexShortString()}),[e,t,r,i]);return y.createElement("svg",{width:"64",height:"41",viewBox:"0 0 64 41",xmlns:"http://www.w3.org/2000/svg"},y.createElement("title",null,"Simple Empty"),y.createElement("g",{transform:"translate(0 1)",fill:"none",fillRule:"evenodd"},y.createElement("ellipse",{fill:s,cx:"32",cy:"33",rx:"32",ry:"7"}),y.createElement("g",{fillRule:"nonzero",stroke:o},y.createElement("path",{d:"M55 12.76L44.854 1.258C44.367.474 43.656 0 42.907 0H21.093c-.749 0-1.46.474-1.947 1.257L9 12.761V22h46v-9.24z"}),y.createElement("path",{d:"M41.613 15.931c0-1.605.994-2.93 2.227-2.931H55v18.137C55 33.26 53.68 35 52.05 35h-40.1C10.32 35 9 33.259 9 31.137V13h11.16c1.233 0 2.227 1.323 2.227 2.928v.022c0 1.605 1.005 2.901 2.237 2.901h14.752c1.232 0 2.237-1.308 2.237-2.913v-.007z",fill:a}))))},QSt=n=>{const{componentCls:e,margin:t,marginXS:r,marginXL:i,fontSize:o,lineHeight:s}=n;return{[e]:{marginInline:r,fontSize:o,lineHeight:s,textAlign:"center",[`${e}-image`]:{height:n.emptyImgHeight,marginBottom:r,opacity:n.opacityImage,img:{height:"100%"},svg:{maxWidth:"100%",height:"100%",margin:"auto"}},[`${e}-description`]:{color:n.colorTextDescription},[`${e}-footer`]:{marginTop:t},"&-normal":{marginBlock:i,color:n.colorTextDescription,[`${e}-description`]:{color:n.colorTextDescription},[`${e}-image`]:{height:n.emptyImgHeightMD}},"&-small":{marginBlock:r,color:n.colorTextDescription,[`${e}-image`]:{height:n.emptyImgHeightSM}}}}},e_t=Jc("Empty",n=>{const{componentCls:e,controlHeightLG:t,calc:r}=n,i=oo(n,{emptyImgCls:`${e}-img`,emptyImgHeight:r(t).mul(2.5).equal(),emptyImgHeightMD:t,emptyImgHeightSM:r(t).mul(.875).equal()});return[QSt(i)]});var t_t=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t};const cOe=y.createElement(YSt,null),lOe=y.createElement(JSt,null),u1=n=>{var{className:e,rootClassName:t,prefixCls:r,image:i=cOe,description:o,children:s,imageStyle:a,style:c}=n,l=t_t(n,["className","rootClassName","prefixCls","image","description","children","imageStyle","style"]);const{getPrefixCls:u,direction:d,empty:h}=y.useContext(fr),f=u("empty",r),[p,g,m]=e_t(f),[v]=uD("Empty"),b=typeof o<"u"?o:v==null?void 0:v.description,S=typeof b=="string"?b:"empty";let E=null;return typeof i=="string"?E=y.createElement("img",{alt:S,src:i}):E=i,p(y.createElement("div",Object.assign({className:Ue(g,m,f,h==null?void 0:h.className,{[`${f}-normal`]:i===lOe,[`${f}-rtl`]:d==="rtl"},e,t),style:Object.assign(Object.assign({},h==null?void 0:h.style),c)},l),y.createElement("div",{className:`${f}-image`,style:a},E),b&&y.createElement("div",{className:`${f}-description`},b),s&&y.createElement("div",{className:`${f}-footer`},s)))};u1.PRESENTED_IMAGE_DEFAULT=cOe;u1.PRESENTED_IMAGE_SIMPLE=lOe;const n_t=n=>{const{componentName:e}=n,{getPrefixCls:t}=y.useContext(fr),r=t("empty");switch(e){case"Table":case"List":return Ke.createElement(u1,{image:u1.PRESENTED_IMAGE_SIMPLE});case"Select":case"TreeSelect":case"Cascader":case"Transfer":case"Mentions":return Ke.createElement(u1,{image:u1.PRESENTED_IMAGE_SIMPLE,className:`${r}-small`});case"Table.filter":return null;default:return Ke.createElement(u1,null)}},are=function(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0;var r,i;const{variant:o,[n]:s}=y.useContext(fr),a=y.useContext(T4e),c=s==null?void 0:s.variant;let l;typeof e<"u"?l=e:t===!1?l="borderless":l=(i=(r=a??c)!==null&&r!==void 0?r:o)!==null&&i!==void 0?i:"outlined";const u=Vgt.includes(l);return[l,u]},r_t=n=>{const t={overflow:{adjustX:!0,adjustY:!0,shiftY:!0},htmlRegion:n==="scroll"?"scroll":"visible",dynamicInset:!0};return{bottomLeft:Object.assign(Object.assign({},t),{points:["tl","bl"],offset:[0,4]}),bottomRight:Object.assign(Object.assign({},t),{points:["tr","br"],offset:[0,4]}),topLeft:Object.assign(Object.assign({},t),{points:["bl","tl"],offset:[0,-4]}),topRight:Object.assign(Object.assign({},t),{points:["br","tr"],offset:[0,-4]})}};function i_t(n,e){return n||r_t(e)}const Gve=n=>{const{optionHeight:e,optionFontSize:t,optionLineHeight:r,optionPadding:i}=n;return{position:"relative",display:"block",minHeight:e,padding:i,color:n.colorText,fontWeight:"normal",fontSize:t,lineHeight:r,boxSizing:"border-box"}},o_t=n=>{const{antCls:e,componentCls:t}=n,r=`${t}-item`,i=`&${e}-slide-up-enter${e}-slide-up-enter-active`,o=`&${e}-slide-up-appear${e}-slide-up-appear-active`,s=`&${e}-slide-up-leave${e}-slide-up-leave-active`,a=`${t}-dropdown-placement-`;return[{[`${t}-dropdown`]:Object.assign(Object.assign({},gc(n)),{position:"absolute",top:-9999,zIndex:n.zIndexPopup,boxSizing:"border-box",padding:n.paddingXXS,overflow:"hidden",fontSize:n.fontSize,fontVariant:"initial",backgroundColor:n.colorBgElevated,borderRadius:n.borderRadiusLG,outline:"none",boxShadow:n.boxShadowSecondary,[`
          ${i}${a}bottomLeft,
          ${o}${a}bottomLeft
        `]:{animationName:Jne},[`
          ${i}${a}topLeft,
          ${o}${a}topLeft,
          ${i}${a}topRight,
          ${o}${a}topRight
        `]:{animationName:ere},[`${s}${a}bottomLeft`]:{animationName:Qne},[`
          ${s}${a}topLeft,
          ${s}${a}topRight
        `]:{animationName:tre},"&-hidden":{display:"none"},[r]:Object.assign(Object.assign({},Gve(n)),{cursor:"pointer",transition:`background ${n.motionDurationSlow} ease`,borderRadius:n.borderRadiusSM,"&-group":{color:n.colorTextDescription,fontSize:n.fontSizeSM,cursor:"default"},"&-option":{display:"flex","&-content":Object.assign({flex:"auto"},y8),"&-state":{flex:"none",display:"flex",alignItems:"center"},[`&-active:not(${r}-option-disabled)`]:{backgroundColor:n.optionActiveBg},[`&-selected:not(${r}-option-disabled)`]:{color:n.optionSelectedColor,fontWeight:n.optionSelectedFontWeight,backgroundColor:n.optionSelectedBg,[`${r}-option-state`]:{color:n.colorPrimary},[`&:has(+ ${r}-option-selected:not(${r}-option-disabled))`]:{borderEndStartRadius:0,borderEndEndRadius:0,[`& + ${r}-option-selected:not(${r}-option-disabled)`]:{borderStartStartRadius:0,borderStartEndRadius:0}}},"&-disabled":{[`&${r}-option-selected`]:{backgroundColor:n.colorBgContainerDisabled},color:n.colorTextDisabled,cursor:"not-allowed"},"&-grouped":{paddingInlineStart:n.calc(n.controlPaddingHorizontal).mul(2).equal()}},"&-empty":Object.assign(Object.assign({},Gve(n)),{color:n.colorTextDisabled})}),"&-rtl":{direction:"rtl"}})},Q2(n,"slide-up"),Q2(n,"slide-down"),E8(n,"move-up"),E8(n,"move-down")]},s_t=n=>{const{multipleSelectItemHeight:e,paddingXXS:t,lineWidth:r,INTERNAL_FIXED_ITEM_MARGIN:i}=n,o=n.max(n.calc(t).sub(r).equal(),0),s=n.max(n.calc(o).sub(i).equal(),0);return{basePadding:o,containerPadding:s,itemHeight:Ct(e),itemLineHeight:Ct(n.calc(e).sub(n.calc(n.lineWidth).mul(2)).equal())}},a_t=n=>{const{multipleSelectItemHeight:e,selectHeight:t,lineWidth:r}=n;return n.calc(t).sub(e).div(2).sub(r).equal()},c_t=n=>{const{componentCls:e,iconCls:t,borderRadiusSM:r,motionDurationSlow:i,paddingXS:o,multipleItemColorDisabled:s,multipleItemBorderColorDisabled:a,colorIcon:c,colorIconHover:l,INTERNAL_FIXED_ITEM_MARGIN:u}=n;return{[`${e}-selection-overflow`]:{position:"relative",display:"flex",flex:"auto",flexWrap:"wrap",maxWidth:"100%","&-item":{flex:"none",alignSelf:"center",maxWidth:"100%",display:"inline-flex"},[`${e}-selection-item`]:{display:"flex",alignSelf:"center",flex:"none",boxSizing:"border-box",maxWidth:"100%",marginBlock:u,borderRadius:r,cursor:"default",transition:`font-size ${i}, line-height ${i}, height ${i}`,marginInlineEnd:n.calc(u).mul(2).equal(),paddingInlineStart:o,paddingInlineEnd:n.calc(o).div(2).equal(),[`${e}-disabled&`]:{color:s,borderColor:a,cursor:"not-allowed"},"&-content":{display:"inline-block",marginInlineEnd:n.calc(o).div(2).equal(),overflow:"hidden",whiteSpace:"pre",textOverflow:"ellipsis"},"&-remove":Object.assign(Object.assign({},W7()),{display:"inline-flex",alignItems:"center",color:c,fontWeight:"bold",fontSize:10,lineHeight:"inherit",cursor:"pointer",[`> ${t}`]:{verticalAlign:"-0.2em"},"&:hover":{color:l}})}}}},l_t=(n,e)=>{const{componentCls:t,INTERNAL_FIXED_ITEM_MARGIN:r}=n,i=`${t}-selection-overflow`,o=n.multipleSelectItemHeight,s=a_t(n),a=e?`${t}-${e}`:"",c=s_t(n);return{[`${t}-multiple${a}`]:Object.assign(Object.assign({},c_t(n)),{[`${t}-selector`]:{display:"flex",flexWrap:"wrap",alignItems:"center",height:"100%",paddingInline:c.basePadding,paddingBlock:c.containerPadding,borderRadius:n.borderRadius,[`${t}-disabled&`]:{background:n.multipleSelectorBgDisabled,cursor:"not-allowed"},"&:after":{display:"inline-block",width:0,margin:`${Ct(r)} 0`,lineHeight:Ct(o),visibility:"hidden",content:'"\\a0"'}},[`${t}-selection-item`]:{height:c.itemHeight,lineHeight:Ct(c.itemLineHeight)},[`${i}-item + ${i}-item`]:{[`${t}-selection-search`]:{marginInlineStart:0}},[`${i}-item-suffix`]:{height:"100%"},[`${t}-selection-search`]:{display:"inline-flex",position:"relative",maxWidth:"100%",marginInlineStart:n.calc(n.inputPaddingHorizontalBase).sub(s).equal(),"\n          &-input,\n          &-mirror\n        ":{height:o,fontFamily:n.fontFamily,lineHeight:Ct(o),transition:`all ${n.motionDurationSlow}`},"&-input":{width:"100%",minWidth:4.1},"&-mirror":{position:"absolute",top:0,insetInlineStart:0,insetInlineEnd:"auto",zIndex:999,whiteSpace:"pre",visibility:"hidden"}},[`${t}-selection-placeholder`]:{position:"absolute",top:"50%",insetInlineStart:n.inputPaddingHorizontalBase,insetInlineEnd:n.inputPaddingHorizontalBase,transform:"translateY(-50%)",transition:`all ${n.motionDurationSlow}`}})}};function BH(n,e){const{componentCls:t}=n,r=e?`${t}-${e}`:"",i={[`${t}-multiple${r}`]:{fontSize:n.fontSize,[`${t}-selector`]:{[`${t}-show-search&`]:{cursor:"text"}},[`
        &${t}-show-arrow ${t}-selector,
        &${t}-allow-clear ${t}-selector
      `]:{paddingInlineEnd:n.calc(n.fontSizeIcon).add(n.controlPaddingHorizontal).equal()}}};return[l_t(n,e),i]}const u_t=n=>{const{componentCls:e}=n,t=oo(n,{selectHeight:n.controlHeightSM,multipleSelectItemHeight:n.multipleItemHeightSM,borderRadius:n.borderRadiusSM,borderRadiusSM:n.borderRadiusXS}),r=oo(n,{fontSize:n.fontSizeLG,selectHeight:n.controlHeightLG,multipleSelectItemHeight:n.multipleItemHeightLG,borderRadius:n.borderRadiusLG,borderRadiusSM:n.borderRadius});return[BH(n),BH(t,"sm"),{[`${e}-multiple${e}-sm`]:{[`${e}-selection-placeholder`]:{insetInline:n.calc(n.controlPaddingHorizontalSM).sub(n.lineWidth).equal()},[`${e}-selection-search`]:{marginInlineStart:2}}},BH(r,"lg")]};function HH(n,e){const{componentCls:t,inputPaddingHorizontalBase:r,borderRadius:i}=n,o=n.calc(n.controlHeight).sub(n.calc(n.lineWidth).mul(2)).equal(),s=e?`${t}-${e}`:"";return{[`${t}-single${s}`]:{fontSize:n.fontSize,height:n.controlHeight,[`${t}-selector`]:Object.assign(Object.assign({},gc(n,!0)),{display:"flex",borderRadius:i,[`${t}-selection-search`]:{position:"absolute",top:0,insetInlineStart:r,insetInlineEnd:r,bottom:0,"&-input":{width:"100%",WebkitAppearance:"textfield"}},[`
          ${t}-selection-item,
          ${t}-selection-placeholder
        `]:{padding:0,lineHeight:Ct(o),transition:`all ${n.motionDurationSlow}, visibility 0s`,alignSelf:"center"},[`${t}-selection-placeholder`]:{transition:"none",pointerEvents:"none"},[["&:after",`${t}-selection-item:empty:after`,`${t}-selection-placeholder:empty:after`].join(",")]:{display:"inline-block",width:0,visibility:"hidden",content:'"\\a0"'}}),[`
        &${t}-show-arrow ${t}-selection-item,
        &${t}-show-arrow ${t}-selection-placeholder
      `]:{paddingInlineEnd:n.showArrowPaddingInlineEnd},[`&${t}-open ${t}-selection-item`]:{color:n.colorTextPlaceholder},[`&:not(${t}-customize-input)`]:{[`${t}-selector`]:{width:"100%",height:"100%",padding:`0 ${Ct(r)}`,[`${t}-selection-search-input`]:{height:o},"&:after":{lineHeight:Ct(o)}}},[`&${t}-customize-input`]:{[`${t}-selector`]:{"&:after":{display:"none"},[`${t}-selection-search`]:{position:"static",width:"100%"},[`${t}-selection-placeholder`]:{position:"absolute",insetInlineStart:0,insetInlineEnd:0,padding:`0 ${Ct(r)}`,"&:after":{display:"none"}}}}}}}function d_t(n){const{componentCls:e}=n,t=n.calc(n.controlPaddingHorizontalSM).sub(n.lineWidth).equal();return[HH(n),HH(oo(n,{controlHeight:n.controlHeightSM,borderRadius:n.borderRadiusSM}),"sm"),{[`${e}-single${e}-sm`]:{[`&:not(${e}-customize-input)`]:{[`${e}-selection-search`]:{insetInlineStart:t,insetInlineEnd:t},[`${e}-selector`]:{padding:`0 ${Ct(t)}`},[`&${e}-show-arrow ${e}-selection-search`]:{insetInlineEnd:n.calc(t).add(n.calc(n.fontSize).mul(1.5)).equal()},[`
            &${e}-show-arrow ${e}-selection-item,
            &${e}-show-arrow ${e}-selection-placeholder
          `]:{paddingInlineEnd:n.calc(n.fontSize).mul(1.5).equal()}}}},HH(oo(n,{controlHeight:n.singleItemHeightLG,fontSize:n.fontSizeLG,borderRadius:n.borderRadiusLG}),"lg")]}const h_t=n=>{const{fontSize:e,lineHeight:t,lineWidth:r,controlHeight:i,controlHeightSM:o,controlHeightLG:s,paddingXXS:a,controlPaddingHorizontal:c,zIndexPopupBase:l,colorText:u,fontWeightStrong:d,controlItemBgActive:h,controlItemBgHover:f,colorBgContainer:p,colorFillSecondary:g,colorBgContainerDisabled:m,colorTextDisabled:v}=n,b=a*2,S=r*2,E=Math.min(i-b,i-S),w=Math.min(o-b,o-S),C=Math.min(s-b,s-S);return{INTERNAL_FIXED_ITEM_MARGIN:Math.floor(a/2),zIndexPopup:l+50,optionSelectedColor:u,optionSelectedFontWeight:d,optionSelectedBg:h,optionActiveBg:f,optionPadding:`${(i-e*t)/2}px ${c}px`,optionFontSize:e,optionLineHeight:t,optionHeight:i,selectorBg:p,clearBg:p,singleItemHeightLG:s,multipleItemBg:g,multipleItemBorderColor:"transparent",multipleItemHeight:E,multipleItemHeightSM:w,multipleItemHeightLG:C,multipleSelectorBgDisabled:m,multipleItemColorDisabled:v,multipleItemBorderColorDisabled:"transparent",showArrowPaddingInlineEnd:Math.ceil(n.fontSize*1.25)}},uOe=(n,e)=>{const{componentCls:t,antCls:r,controlOutlineWidth:i}=n;return{[`&:not(${t}-customize-input) ${t}-selector`]:{border:`${Ct(n.lineWidth)} ${n.lineType} ${e.borderColor}`,background:n.selectorBg},[`&:not(${t}-disabled):not(${t}-customize-input):not(${r}-pagination-size-changer)`]:{[`&:hover ${t}-selector`]:{borderColor:e.hoverBorderHover},[`${t}-focused& ${t}-selector`]:{borderColor:e.activeBorderColor,boxShadow:`0 0 0 ${Ct(i)} ${e.activeShadowColor}`,outline:0}}}},Zve=(n,e)=>({[`&${n.componentCls}-status-${e.status}`]:Object.assign({},uOe(n,e))}),f_t=n=>({"&-outlined":Object.assign(Object.assign(Object.assign(Object.assign({},uOe(n,{borderColor:n.colorBorder,hoverBorderHover:n.colorPrimaryHover,activeBorderColor:n.colorPrimary,activeShadowColor:n.controlOutline})),Zve(n,{status:"error",borderColor:n.colorError,hoverBorderHover:n.colorErrorHover,activeBorderColor:n.colorError,activeShadowColor:n.colorErrorOutline})),Zve(n,{status:"warning",borderColor:n.colorWarning,hoverBorderHover:n.colorWarningHover,activeBorderColor:n.colorWarning,activeShadowColor:n.colorWarningOutline})),{[`&${n.componentCls}-disabled`]:{[`&:not(${n.componentCls}-customize-input) ${n.componentCls}-selector`]:{background:n.colorBgContainerDisabled,color:n.colorTextDisabled}},[`&${n.componentCls}-multiple ${n.componentCls}-selection-item`]:{background:n.multipleItemBg,border:`${Ct(n.lineWidth)} ${n.lineType} ${n.multipleItemBorderColor}`}})}),dOe=(n,e)=>{const{componentCls:t,antCls:r}=n;return{[`&:not(${t}-customize-input) ${t}-selector`]:{background:e.bg,border:`${Ct(n.lineWidth)} ${n.lineType} transparent`,color:e.color},[`&:not(${t}-disabled):not(${t}-customize-input):not(${r}-pagination-size-changer)`]:{[`&:hover ${t}-selector`]:{background:e.hoverBg},[`${t}-focused& ${t}-selector`]:{background:n.selectorBg,borderColor:e.activeBorderColor,outline:0}}}},Xve=(n,e)=>({[`&${n.componentCls}-status-${e.status}`]:Object.assign({},dOe(n,e))}),p_t=n=>({"&-filled":Object.assign(Object.assign(Object.assign(Object.assign({},dOe(n,{bg:n.colorFillTertiary,hoverBg:n.colorFillSecondary,activeBorderColor:n.colorPrimary,color:n.colorText})),Xve(n,{status:"error",bg:n.colorErrorBg,hoverBg:n.colorErrorBgHover,activeBorderColor:n.colorError,color:n.colorError})),Xve(n,{status:"warning",bg:n.colorWarningBg,hoverBg:n.colorWarningBgHover,activeBorderColor:n.colorWarning,color:n.colorWarning})),{[`&${n.componentCls}-disabled`]:{[`&:not(${n.componentCls}-customize-input) ${n.componentCls}-selector`]:{borderColor:n.colorBorder,background:n.colorBgContainerDisabled,color:n.colorTextDisabled}},[`&${n.componentCls}-multiple ${n.componentCls}-selection-item`]:{background:n.colorBgContainer,border:`${Ct(n.lineWidth)} ${n.lineType} ${n.colorSplit}`}})}),g_t=n=>({"&-borderless":{[`${n.componentCls}-selector`]:{background:"transparent",borderColor:"transparent"},[`&${n.componentCls}-disabled`]:{[`&:not(${n.componentCls}-customize-input) ${n.componentCls}-selector`]:{color:n.colorTextDisabled}},[`&${n.componentCls}-multiple ${n.componentCls}-selection-item`]:{background:n.multipleItemBg,border:`${Ct(n.lineWidth)} ${n.lineType} ${n.multipleItemBorderColor}`},[`&${n.componentCls}-status-error`]:{[`${n.componentCls}-selection-item`]:{color:n.colorError}},[`&${n.componentCls}-status-warning`]:{[`${n.componentCls}-selection-item`]:{color:n.colorWarning}}}}),m_t=n=>({[n.componentCls]:Object.assign(Object.assign(Object.assign({},f_t(n)),p_t(n)),g_t(n))}),v_t=n=>{const{componentCls:e}=n;return{position:"relative",transition:`all ${n.motionDurationMid} ${n.motionEaseInOut}`,input:{cursor:"pointer"},[`${e}-show-search&`]:{cursor:"text",input:{cursor:"auto",color:"inherit",height:"100%"}},[`${e}-disabled&`]:{cursor:"not-allowed",input:{cursor:"not-allowed"}}}},y_t=n=>{const{componentCls:e}=n;return{[`${e}-selection-search-input`]:{margin:0,padding:0,background:"transparent",border:"none",outline:"none",appearance:"none",fontFamily:"inherit","&::-webkit-search-cancel-button":{display:"none","-webkit-appearance":"none"}}}},b_t=n=>{const{antCls:e,componentCls:t,inputPaddingHorizontalBase:r,iconCls:i}=n;return{[t]:Object.assign(Object.assign({},gc(n)),{position:"relative",display:"inline-block",cursor:"pointer",[`&:not(${t}-customize-input) ${t}-selector`]:Object.assign(Object.assign({},v_t(n)),y_t(n)),[`${t}-selection-item`]:Object.assign(Object.assign({flex:1,fontWeight:"normal",position:"relative",userSelect:"none"},y8),{[`> ${e}-typography`]:{display:"inline"}}),[`${t}-selection-placeholder`]:Object.assign(Object.assign({},y8),{flex:1,color:n.colorTextPlaceholder,pointerEvents:"none"}),[`${t}-arrow`]:Object.assign(Object.assign({},W7()),{position:"absolute",top:"50%",insetInlineStart:"auto",insetInlineEnd:r,height:n.fontSizeIcon,marginTop:n.calc(n.fontSizeIcon).mul(-1).div(2).equal(),color:n.colorTextQuaternary,fontSize:n.fontSizeIcon,lineHeight:1,textAlign:"center",pointerEvents:"none",display:"flex",alignItems:"center",transition:`opacity ${n.motionDurationSlow} ease`,[i]:{verticalAlign:"top",transition:`transform ${n.motionDurationSlow}`,"> svg":{verticalAlign:"top"},[`&:not(${t}-suffix)`]:{pointerEvents:"auto"}},[`${t}-disabled &`]:{cursor:"not-allowed"},"> *:not(:last-child)":{marginInlineEnd:8}}),[`${t}-clear`]:{position:"absolute",top:"50%",insetInlineStart:"auto",insetInlineEnd:r,zIndex:1,display:"inline-block",width:n.fontSizeIcon,height:n.fontSizeIcon,marginTop:n.calc(n.fontSizeIcon).mul(-1).div(2).equal(),color:n.colorTextQuaternary,fontSize:n.fontSizeIcon,fontStyle:"normal",lineHeight:1,textAlign:"center",textTransform:"none",cursor:"pointer",opacity:0,transition:`color ${n.motionDurationMid} ease, opacity ${n.motionDurationSlow} ease`,textRendering:"auto","&:before":{display:"block"},"&:hover":{color:n.colorTextTertiary}},[`&:hover ${t}-clear`]:{opacity:1,background:n.colorBgBase}}),[`${t}-has-feedback`]:{[`${t}-clear`]:{insetInlineEnd:n.calc(r).add(n.fontSize).add(n.paddingXS).equal()}}}},S_t=n=>{const{componentCls:e}=n;return[{[e]:{[`&${e}-in-form-item`]:{width:"100%"}}},b_t(n),d_t(n),u_t(n),o_t(n),{[`${e}-rtl`]:{direction:"rtl"}},qne(n,{borderElCls:`${e}-selector`,focusElCls:`${e}-focused`})]},__t=Jc("Select",(n,e)=>{let{rootPrefixCls:t}=e;const r=oo(n,{rootPrefixCls:t,inputPaddingHorizontalBase:n.calc(n.paddingSM).sub(1).equal(),multipleSelectItemHeight:n.multipleItemHeight,selectHeight:n.controlHeight});return[S_t(r),m_t(r)]},h_t,{unitless:{optionLineHeight:!0,optionSelectedFontWeight:!0}});var w_t={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M912 190h-69.9c-9.8 0-19.1 4.5-25.1 12.2L404.7 724.5 207 474a32 32 0 00-25.1-12.2H112c-6.7 0-10.4 7.7-6.3 12.9l273.9 347c12.8 16.2 37.4 16.2 50.3 0l488.4-618.9c4.1-5.1.4-12.8-6.3-12.8z"}}]},name:"check",theme:"outlined"},C_t=function(e,t){return y.createElement(_a,ln({},e,{ref:t,icon:w_t}))},vZ=y.forwardRef(C_t),x_t={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"}}]},name:"down",theme:"outlined"},E_t=function(e,t){return y.createElement(_a,ln({},e,{ref:t,icon:x_t}))},I_t=y.forwardRef(E_t),P_t={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M909.6 854.5L649.9 594.8C690.2 542.7 712 479 712 412c0-80.2-31.3-155.4-87.9-212.1-56.6-56.7-132-87.9-212.1-87.9s-155.5 31.3-212.1 87.9C143.2 256.5 112 331.8 112 412c0 80.1 31.3 155.5 87.9 212.1C256.5 680.8 331.8 712 412 712c67 0 130.6-21.8 182.7-62l259.7 259.6a8.2 8.2 0 0011.6 0l43.6-43.5a8.2 8.2 0 000-11.6zM570.4 570.4C528 612.7 471.8 636 412 636s-116-23.3-158.4-65.6C211.3 528 188 471.8 188 412s23.3-116.1 65.6-158.4C296 211.3 352.2 188 412 188s116.1 23.2 158.4 65.6S636 352.2 636 412s-23.3 116.1-65.6 158.4z"}}]},name:"search",theme:"outlined"},k_t=function(e,t){return y.createElement(_a,ln({},e,{ref:t,icon:P_t}))},hOe=y.forwardRef(k_t);function T_t(n){let{suffixIcon:e,clearIcon:t,menuItemSelectedIcon:r,removeIcon:i,loading:o,multiple:s,hasFeedback:a,prefixCls:c,showSuffixIcon:l,feedbackIcon:u,showArrow:d,componentName:h}=n;const f=t??y.createElement(hD,null),p=b=>e===null&&!a&&!d?null:y.createElement(y.Fragment,null,l!==!1&&b,a&&u);let g=null;if(e!==void 0)g=p(e);else if(o)g=p(y.createElement(q7,{spin:!0}));else{const b=`${c}-suffix`;g=S=>{let{open:E,showSearch:w}=S;return p(E&&w?y.createElement(hOe,{className:b}):y.createElement(I_t,{className:b}))}}let m=null;r!==void 0?m=r:s?m=y.createElement(vZ,null):m=null;let v=null;return i!==void 0?v=i:v=y.createElement(fD,null),{clearIcon:f,suffixIcon:g,itemIcon:m,removeIcon:v}}function D_t(n,e){return e!==void 0?e:n!==null}var R_t=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t};const fOe="SECRET_COMBOBOX_MODE_DO_NOT_USE",A_t=(n,e)=>{var t;const{prefixCls:r,bordered:i,className:o,rootClassName:s,getPopupContainer:a,popupClassName:c,dropdownClassName:l,listHeight:u=256,placement:d,listItemHeight:h,size:f,disabled:p,notFoundContent:g,status:m,builtinPlacements:v,dropdownMatchSelectWidth:b,popupMatchSelectWidth:S,direction:E,style:w,allowClear:C,variant:I,dropdownStyle:T,transitionName:D,tagRender:O,maxCount:M}=n,R=R_t(n,["prefixCls","bordered","className","rootClassName","getPopupContainer","popupClassName","dropdownClassName","listHeight","placement","listItemHeight","size","disabled","notFoundContent","status","builtinPlacements","dropdownMatchSelectWidth","popupMatchSelectWidth","direction","style","allowClear","variant","dropdownStyle","transitionName","tagRender","maxCount"]),{getPopupContainer:A,getPrefixCls:k,renderEmpty:L,direction:j,virtual:N,popupMatchSelectWidth:B,popupOverflow:U,select:K}=y.useContext(fr),[,z]=Gu(),G=h??(z==null?void 0:z.controlHeight),te=k("select",r),ie=k(),Q=E??j,{compactSize:ge,compactItemClassnames:_e}=mD(te,Q),[Se,se]=are("select",I,i),ee=Qc(te),[Y,ue,ye]=__t(te,ee),V=y.useMemo(()=>{const{mode:Kn}=n;if(Kn!=="combobox")return Kn===fOe?"combobox":Kn},[n.mode]),le=V==="multiple"||V==="tags",he=D_t(n.suffixIcon,n.showArrow),oe=(t=S??b)!==null&&t!==void 0?t:B,{status:ne,hasFeedback:ce,isFormItemInput:Ae,feedbackIcon:Ie}=y.useContext(nu),be=iN(ne,m);let De;g!==void 0?De=g:V==="combobox"?De=null:De=(L==null?void 0:L("Select"))||y.createElement(n_t,{componentName:"Select"});const{suffixIcon:Me,itemIcon:He,removeIcon:Je,clearIcon:qe}=T_t(Object.assign(Object.assign({},R),{multiple:le,hasFeedback:ce,feedbackIcon:Ie,showSuffixIcon:he,prefixCls:te,componentName:"Select"})),Ge=C===!0?{clearIcon:qe}:C,St=Yc(R,["suffixIcon","itemIcon"]),Pt=Ue(c||l,{[`${te}-dropdown-${Q}`]:Q==="rtl"},s,ye,ee,ue),on=_v(Kn=>{var lr;return(lr=f??ge)!==null&&lr!==void 0?lr:Kn}),an=y.useContext(fg),Rt=p??an,Xt=Ue({[`${te}-lg`]:on==="large",[`${te}-sm`]:on==="small",[`${te}-rtl`]:Q==="rtl",[`${te}-${Se}`]:se,[`${te}-in-form-item`]:Ae},P8(te,be,ce),_e,K==null?void 0:K.className,o,s,ye,ee,ue),yn=y.useMemo(()=>d!==void 0?d:Q==="rtl"?"bottomRight":"bottomLeft",[d,Q]),[bn]=pD("SelectLike",T==null?void 0:T.zIndex);return Y(y.createElement(sre,Object.assign({ref:e,virtual:N,showSearch:K==null?void 0:K.showSearch},St,{style:Object.assign(Object.assign({},K==null?void 0:K.style),w),dropdownMatchSelectWidth:oe,transitionName:J2(ie,"slide-up",D),builtinPlacements:i_t(v,U),listHeight:u,listItemHeight:G,mode:V,prefixCls:te,placement:yn,direction:Q,suffixIcon:Me,menuItemSelectedIcon:He,removeIcon:Je,allowClear:Ge,notFoundContent:De,className:Xt,getPopupContainer:a||A,dropdownClassName:Pt,disabled:Rt,dropdownStyle:Object.assign(Object.assign({},T),{zIndex:bn}),maxCount:le?M:void 0,tagRender:le?O:void 0})))},Ey=y.forwardRef(A_t),O_t=K4e(Ey);Ey.SECRET_COMBOBOX_MODE_DO_NOT_USE=fOe;Ey.Option=ore;Ey.OptGroup=ire;Ey._InternalPanelDoNotUseOrYouWillBeFired=O_t;const D3=["xxl","xl","lg","md","sm","xs"],M_t=n=>({xs:`(max-width: ${n.screenXSMax}px)`,sm:`(min-width: ${n.screenSM}px)`,md:`(min-width: ${n.screenMD}px)`,lg:`(min-width: ${n.screenLG}px)`,xl:`(min-width: ${n.screenXL}px)`,xxl:`(min-width: ${n.screenXXL}px)`}),$_t=n=>{const e=n,t=[].concat(D3).reverse();return t.forEach((r,i)=>{const o=r.toUpperCase(),s=`screen${o}Min`,a=`screen${o}`;if(!(e[s]<=e[a]))throw new Error(`${s}<=${a} fails : !(${e[s]}<=${e[a]})`);if(i<t.length-1){const c=`screen${o}Max`;if(!(e[a]<=e[c]))throw new Error(`${a}<=${c} fails : !(${e[a]}<=${e[c]})`);const u=`screen${t[i+1].toUpperCase()}Min`;if(!(e[c]<=e[u]))throw new Error(`${c}<=${u} fails : !(${e[c]}<=${e[u]})`)}}),n};function L_t(){const[,n]=Gu(),e=M_t($_t(n));return Ke.useMemo(()=>{const t=new Map;let r=-1,i={};return{matchHandlers:{},dispatch(o){return i=o,t.forEach(s=>s(i)),t.size>=1},subscribe(o){return t.size||this.register(),r+=1,t.set(r,o),o(i),r},unsubscribe(o){t.delete(o),t.size||this.unregister()},unregister(){Object.keys(e).forEach(o=>{const s=e[o],a=this.matchHandlers[s];a==null||a.mql.removeListener(a==null?void 0:a.listener)}),t.clear()},register(){Object.keys(e).forEach(o=>{const s=e[o],a=l=>{let{matches:u}=l;this.dispatch(Object.assign(Object.assign({},i),{[o]:u}))},c=window.matchMedia(s);c.addListener(a),this.matchHandlers[s]={mql:c,listener:a},a(c)})},responsiveMap:e}},[n])}function pOe(n){var e=n.children,t=n.prefixCls,r=n.id,i=n.overlayInnerStyle,o=n.className,s=n.style;return y.createElement("div",{className:Ue("".concat(t,"-content"),o),style:s},y.createElement("div",{className:"".concat(t,"-inner"),id:r,role:"tooltip",style:i},typeof e=="function"?e():e))}var iw={shiftX:64,adjustY:1},ow={adjustX:1,shiftY:!0},fh=[0,0],N_t={left:{points:["cr","cl"],overflow:ow,offset:[-4,0],targetOffset:fh},right:{points:["cl","cr"],overflow:ow,offset:[4,0],targetOffset:fh},top:{points:["bc","tc"],overflow:iw,offset:[0,-4],targetOffset:fh},bottom:{points:["tc","bc"],overflow:iw,offset:[0,4],targetOffset:fh},topLeft:{points:["bl","tl"],overflow:iw,offset:[0,-4],targetOffset:fh},leftTop:{points:["tr","tl"],overflow:ow,offset:[-4,0],targetOffset:fh},topRight:{points:["br","tr"],overflow:iw,offset:[0,-4],targetOffset:fh},rightTop:{points:["tl","tr"],overflow:ow,offset:[4,0],targetOffset:fh},bottomRight:{points:["tr","br"],overflow:iw,offset:[0,4],targetOffset:fh},rightBottom:{points:["bl","br"],overflow:ow,offset:[4,0],targetOffset:fh},bottomLeft:{points:["tl","bl"],overflow:iw,offset:[0,4],targetOffset:fh},leftBottom:{points:["br","bl"],overflow:ow,offset:[-4,0],targetOffset:fh}},F_t=["overlayClassName","trigger","mouseEnterDelay","mouseLeaveDelay","overlayStyle","prefixCls","children","onVisibleChange","afterVisibleChange","transitionName","animation","motion","placement","align","destroyTooltipOnHide","defaultVisible","getTooltipContainer","overlayInnerStyle","arrowContent","overlay","id","showArrow"],j_t=function(e,t){var r=e.overlayClassName,i=e.trigger,o=i===void 0?["hover"]:i,s=e.mouseEnterDelay,a=s===void 0?0:s,c=e.mouseLeaveDelay,l=c===void 0?.1:c,u=e.overlayStyle,d=e.prefixCls,h=d===void 0?"rc-tooltip":d,f=e.children,p=e.onVisibleChange,g=e.afterVisibleChange,m=e.transitionName,v=e.animation,b=e.motion,S=e.placement,E=S===void 0?"right":S,w=e.align,C=w===void 0?{}:w,I=e.destroyTooltipOnHide,T=I===void 0?!1:I,D=e.defaultVisible,O=e.getTooltipContainer,M=e.overlayInnerStyle;e.arrowContent;var R=e.overlay,A=e.id,k=e.showArrow,L=k===void 0?!0:k,j=jr(e,F_t),N=y.useRef(null);y.useImperativeHandle(t,function(){return N.current});var B=$e({},j);"visible"in e&&(B.popupVisible=e.visible);var U=function(){return y.createElement(pOe,{key:"content",prefixCls:h,id:A,overlayInnerStyle:M},R)};return y.createElement(rN,ln({popupClassName:r,prefixCls:h,popup:U,action:o,builtinPlacements:N_t,popupPlacement:E,ref:N,popupAlign:C,getPopupContainer:O,onPopupVisibleChange:p,afterPopupVisibleChange:g,popupTransitionName:m,popupAnimation:v,popupMotion:b,defaultPopupVisible:D,autoDestroy:T,mouseLeaveDelay:l,popupStyle:u,mouseEnterDelay:a,arrow:L},B),f)};const B_t=y.forwardRef(j_t);function gOe(n){const{sizePopupArrow:e,borderRadiusXS:t,borderRadiusOuter:r}=n,i=e/2,o=0,s=i,a=r*1/Math.sqrt(2),c=i-r*(1-1/Math.sqrt(2)),l=i-t*(1/Math.sqrt(2)),u=r*(Math.sqrt(2)-1)+t*(1/Math.sqrt(2)),d=2*i-l,h=u,f=2*i-a,p=c,g=2*i-o,m=s,v=i*Math.sqrt(2)+r*(Math.sqrt(2)-2),b=r*(Math.sqrt(2)-1),S=`polygon(${b}px 100%, 50% ${b}px, ${2*i-b}px 100%, ${b}px 100%)`,E=`path('M ${o} ${s} A ${r} ${r} 0 0 0 ${a} ${c} L ${l} ${u} A ${t} ${t} 0 0 1 ${d} ${h} L ${f} ${p} A ${r} ${r} 0 0 0 ${g} ${m} Z')`;return{arrowShadowWidth:v,arrowPath:E,arrowPolygon:S}}const H_t=(n,e,t)=>{const{sizePopupArrow:r,arrowPolygon:i,arrowPath:o,arrowShadowWidth:s,borderRadiusXS:a,calc:c}=n;return{pointerEvents:"none",width:r,height:r,overflow:"hidden","&::before":{position:"absolute",bottom:0,insetInlineStart:0,width:r,height:c(r).div(2).equal(),background:e,clipPath:{_multi_value_:!0,value:[i,o]},content:'""'},"&::after":{content:'""',position:"absolute",width:s,height:s,bottom:0,insetInline:0,margin:"auto",borderRadius:{_skip_check_:!0,value:`0 0 ${Ct(a)} 0`},transform:"translateY(50%) rotate(-135deg)",boxShadow:t,zIndex:0,background:"transparent"}}},mOe=8;function cre(n){const{contentRadius:e,limitVerticalRadius:t}=n,r=e>12?e+2:12;return{arrowOffsetHorizontal:r,arrowOffsetVertical:t?mOe:r}}function z5(n,e){return n?e:{}}function vOe(n,e,t){const{componentCls:r,boxShadowPopoverArrow:i,arrowOffsetVertical:o,arrowOffsetHorizontal:s}=n,{arrowDistance:a=0,arrowPlacement:c={left:!0,right:!0,top:!0,bottom:!0}}=t||{};return{[r]:Object.assign(Object.assign(Object.assign(Object.assign({[`${r}-arrow`]:[Object.assign(Object.assign({position:"absolute",zIndex:1,display:"block"},H_t(n,e,i)),{"&:before":{background:e}})]},z5(!!c.top,{[[`&-placement-top > ${r}-arrow`,`&-placement-topLeft > ${r}-arrow`,`&-placement-topRight > ${r}-arrow`].join(",")]:{bottom:a,transform:"translateY(100%) rotate(180deg)"},[`&-placement-top > ${r}-arrow`]:{left:{_skip_check_:!0,value:"50%"},transform:"translateX(-50%) translateY(100%) rotate(180deg)"},"&-placement-topLeft":{"--arrow-offset-horizontal":s,[`> ${r}-arrow`]:{left:{_skip_check_:!0,value:s}}},"&-placement-topRight":{"--arrow-offset-horizontal":`calc(100% - ${Ct(s)})`,[`> ${r}-arrow`]:{right:{_skip_check_:!0,value:s}}}})),z5(!!c.bottom,{[[`&-placement-bottom > ${r}-arrow`,`&-placement-bottomLeft > ${r}-arrow`,`&-placement-bottomRight > ${r}-arrow`].join(",")]:{top:a,transform:"translateY(-100%)"},[`&-placement-bottom > ${r}-arrow`]:{left:{_skip_check_:!0,value:"50%"},transform:"translateX(-50%) translateY(-100%)"},"&-placement-bottomLeft":{"--arrow-offset-horizontal":s,[`> ${r}-arrow`]:{left:{_skip_check_:!0,value:s}}},"&-placement-bottomRight":{"--arrow-offset-horizontal":`calc(100% - ${Ct(s)})`,[`> ${r}-arrow`]:{right:{_skip_check_:!0,value:s}}}})),z5(!!c.left,{[[`&-placement-left > ${r}-arrow`,`&-placement-leftTop > ${r}-arrow`,`&-placement-leftBottom > ${r}-arrow`].join(",")]:{right:{_skip_check_:!0,value:a},transform:"translateX(100%) rotate(90deg)"},[`&-placement-left > ${r}-arrow`]:{top:{_skip_check_:!0,value:"50%"},transform:"translateY(-50%) translateX(100%) rotate(90deg)"},[`&-placement-leftTop > ${r}-arrow`]:{top:o},[`&-placement-leftBottom > ${r}-arrow`]:{bottom:o}})),z5(!!c.right,{[[`&-placement-right > ${r}-arrow`,`&-placement-rightTop > ${r}-arrow`,`&-placement-rightBottom > ${r}-arrow`].join(",")]:{left:{_skip_check_:!0,value:a},transform:"translateX(-100%) rotate(-90deg)"},[`&-placement-right > ${r}-arrow`]:{top:{_skip_check_:!0,value:"50%"},transform:"translateY(-50%) translateX(-100%) rotate(-90deg)"},[`&-placement-rightTop > ${r}-arrow`]:{top:o},[`&-placement-rightBottom > ${r}-arrow`]:{bottom:o}}))}}function U_t(n,e,t,r){if(r===!1)return{adjustX:!1,adjustY:!1};const i=r&&typeof r=="object"?r:{},o={};switch(n){case"top":case"bottom":o.shiftX=e.arrowOffsetHorizontal*2+t,o.shiftY=!0,o.adjustY=!0;break;case"left":case"right":o.shiftY=e.arrowOffsetVertical*2+t,o.shiftX=!0,o.adjustX=!0;break}const s=Object.assign(Object.assign({},o),i);return s.shiftX||(s.adjustX=!0),s.shiftY||(s.adjustY=!0),s}const Yve={left:{points:["cr","cl"]},right:{points:["cl","cr"]},top:{points:["bc","tc"]},bottom:{points:["tc","bc"]},topLeft:{points:["bl","tl"]},leftTop:{points:["tr","tl"]},topRight:{points:["br","tr"]},rightTop:{points:["tl","tr"]},bottomRight:{points:["tr","br"]},rightBottom:{points:["bl","br"]},bottomLeft:{points:["tl","bl"]},leftBottom:{points:["br","bl"]}},z_t={topLeft:{points:["bl","tc"]},leftTop:{points:["tr","cl"]},topRight:{points:["br","tc"]},rightTop:{points:["tl","cr"]},bottomRight:{points:["tr","bc"]},rightBottom:{points:["bl","cr"]},bottomLeft:{points:["tl","bc"]},leftBottom:{points:["br","cl"]}},V_t=new Set(["topLeft","topRight","bottomLeft","bottomRight","leftTop","leftBottom","rightTop","rightBottom"]);function yOe(n){const{arrowWidth:e,autoAdjustOverflow:t,arrowPointAtCenter:r,offset:i,borderRadius:o,visibleFirst:s}=n,a=e/2,c={};return Object.keys(Yve).forEach(l=>{const u=r&&z_t[l]||Yve[l],d=Object.assign(Object.assign({},u),{offset:[0,0],dynamicInset:!0});switch(c[l]=d,V_t.has(l)&&(d.autoArrow=!1),l){case"top":case"topLeft":case"topRight":d.offset[1]=-a-i;break;case"bottom":case"bottomLeft":case"bottomRight":d.offset[1]=a+i;break;case"left":case"leftTop":case"leftBottom":d.offset[0]=-a-i;break;case"right":case"rightTop":case"rightBottom":d.offset[0]=a+i;break}const h=cre({contentRadius:o,limitVerticalRadius:!0});if(r)switch(l){case"topLeft":case"bottomLeft":d.offset[0]=-h.arrowOffsetHorizontal-a;break;case"topRight":case"bottomRight":d.offset[0]=h.arrowOffsetHorizontal+a;break;case"leftTop":case"rightTop":d.offset[1]=-h.arrowOffsetHorizontal*2+a;break;case"leftBottom":case"rightBottom":d.offset[1]=h.arrowOffsetHorizontal*2-a;break}d.overflow=U_t(l,h,e,t),s&&(d.htmlRegion="visibleFirst")}),c}const W_t=n=>{const{componentCls:e,tooltipMaxWidth:t,tooltipColor:r,tooltipBg:i,tooltipBorderRadius:o,zIndexPopup:s,controlHeight:a,boxShadowSecondary:c,paddingSM:l,paddingXS:u}=n;return[{[e]:Object.assign(Object.assign(Object.assign(Object.assign({},gc(n)),{position:"absolute",zIndex:s,display:"block",width:"max-content",maxWidth:t,visibility:"visible","--valid-offset-x":"var(--arrow-offset-horizontal, var(--arrow-x))",transformOrigin:["var(--valid-offset-x, 50%)","var(--arrow-y, 50%)"].join(" "),"&-hidden":{display:"none"},"--antd-arrow-background-color":i,[`${e}-inner`]:{minWidth:"1em",minHeight:a,padding:`${Ct(n.calc(l).div(2).equal())} ${Ct(u)}`,color:r,textAlign:"start",textDecoration:"none",wordWrap:"break-word",backgroundColor:i,borderRadius:o,boxShadow:c,boxSizing:"border-box"},[["&-placement-left","&-placement-leftTop","&-placement-leftBottom","&-placement-right","&-placement-rightTop","&-placement-rightBottom"].join(",")]:{[`${e}-inner`]:{borderRadius:n.min(o,mOe)}},[`${e}-content`]:{position:"relative"}}),mmt(n,(d,h)=>{let{darkColor:f}=h;return{[`&${e}-${d}`]:{[`${e}-inner`]:{backgroundColor:f},[`${e}-arrow`]:{"--antd-arrow-background-color":f}}}})),{"&-rtl":{direction:"rtl"}})},vOe(n,"var(--antd-arrow-background-color)"),{[`${e}-pure`]:{position:"relative",maxWidth:"none",margin:n.sizePopupArrow}}]},q_t=n=>Object.assign(Object.assign({zIndexPopup:n.zIndexPopupBase+70},cre({contentRadius:n.borderRadius,limitVerticalRadius:!0})),gOe(oo(n,{borderRadiusOuter:Math.min(n.borderRadiusOuter,4)}))),bOe=function(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return Jc("Tooltip",r=>{const{borderRadius:i,colorTextLightSolid:o,colorBgSpotlight:s}=r,a=oo(r,{tooltipMaxWidth:250,tooltipColor:o,tooltipBorderRadius:i,tooltipBg:s});return[W_t(a),tN(r,"zoom-big-fast")]},q_t,{resetStyle:!1,injectStyle:e})(n)},K_t=v8.map(n=>`${n}-inverse`);function G_t(n){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)?[].concat(Ht(K_t),Ht(v8)).includes(n):v8.includes(n)}function SOe(n,e){const t=G_t(e),r=Ue({[`${n}-${e}`]:e&&t}),i={},o={};return e&&!t&&(i.background=e,o["--antd-arrow-background-color"]=e),{className:r,overlayStyle:i,arrowStyle:o}}const Z_t=n=>{const{prefixCls:e,className:t,placement:r="top",title:i,color:o,overlayInnerStyle:s}=n,{getPrefixCls:a}=y.useContext(fr),c=a("tooltip",e),[l,u,d]=bOe(c),h=SOe(c,o),f=h.arrowStyle,p=Object.assign(Object.assign({},s),h.overlayStyle),g=Ue(u,d,c,`${c}-pure`,`${c}-placement-${r}`,t,h.className);return l(y.createElement("div",{className:g,style:f},y.createElement("div",{className:`${c}-arrow`}),y.createElement(pOe,Object.assign({},n,{className:u,prefixCls:c,overlayInnerStyle:p}),i)))};var X_t=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t};const Y_t=y.forwardRef((n,e)=>{var t,r;const{prefixCls:i,openClassName:o,getTooltipContainer:s,overlayClassName:a,color:c,overlayInnerStyle:l,children:u,afterOpenChange:d,afterVisibleChange:h,destroyTooltipOnHide:f,arrow:p=!0,title:g,overlay:m,builtinPlacements:v,arrowPointAtCenter:b=!1,autoAdjustOverflow:S=!0}=n,E=!!p,[,w]=Gu(),{getPopupContainer:C,getPrefixCls:I,direction:T}=y.useContext(fr),D=lD(),O=y.useRef(null),M=()=>{var De;(De=O.current)===null||De===void 0||De.forceAlign()};y.useImperativeHandle(e,()=>{var De;return{forceAlign:M,forcePopupAlign:()=>{D.deprecated(!1,"forcePopupAlign","forceAlign"),M()},nativeElement:(De=O.current)===null||De===void 0?void 0:De.nativeElement}});const[R,A]=Ql(!1,{value:(t=n.open)!==null&&t!==void 0?t:n.visible,defaultValue:(r=n.defaultOpen)!==null&&r!==void 0?r:n.defaultVisible}),k=!g&&!m&&g!==0,L=De=>{var Me,He;A(k?!1:De),k||((Me=n.onOpenChange)===null||Me===void 0||Me.call(n,De),(He=n.onVisibleChange)===null||He===void 0||He.call(n,De))},j=y.useMemo(()=>{var De,Me;let He=b;return typeof p=="object"&&(He=(Me=(De=p.pointAtCenter)!==null&&De!==void 0?De:p.arrowPointAtCenter)!==null&&Me!==void 0?Me:b),v||yOe({arrowPointAtCenter:He,autoAdjustOverflow:S,arrowWidth:E?w.sizePopupArrow:0,borderRadius:w.borderRadius,offset:w.marginXXS,visibleFirst:!0})},[b,p,v,w]),N=y.useMemo(()=>g===0?g:m||g||"",[m,g]),B=y.createElement(k3,{space:!0},typeof N=="function"?N():N),{getPopupContainer:U,placement:K="top",mouseEnterDelay:z=.1,mouseLeaveDelay:G=.1,overlayStyle:te,rootClassName:ie}=n,Q=X_t(n,["getPopupContainer","placement","mouseEnterDelay","mouseLeaveDelay","overlayStyle","rootClassName"]),ge=I("tooltip",i),_e=I(),Se=n["data-popover-inject"];let se=R;!("open"in n)&&!("visible"in n)&&k&&(se=!1);const ee=y.isValidElement(u)&&!GAe(u)?u:y.createElement("span",null,u),Y=ee.props,ue=!Y.className||typeof Y.className=="string"?Ue(Y.className,o||`${ge}-open`):Y.className,[ye,V,le]=bOe(ge,!Se),he=SOe(ge,c),oe=he.arrowStyle,ne=Object.assign(Object.assign({},l),he.overlayStyle),ce=Ue(a,{[`${ge}-rtl`]:T==="rtl"},he.className,ie,V,le),[Ae,Ie]=pD("Tooltip",Q.zIndex),be=y.createElement(B_t,Object.assign({},Q,{zIndex:Ae,showArrow:E,placement:K,mouseEnterDelay:z,mouseLeaveDelay:G,prefixCls:ge,overlayClassName:ce,overlayStyle:Object.assign(Object.assign({},oe),te),getTooltipContainer:U||s||C,ref:O,builtinPlacements:j,overlay:B,visible:se,onVisibleChange:L,afterVisibleChange:d??h,overlayInnerStyle:ne,arrowContent:y.createElement("span",{className:`${ge}-arrow-content`}),motion:{motionName:J2(_e,"zoom-big-fast",n.transitionName),motionDeadline:1e3},destroyTooltipOnHide:!!f}),se?gg(ee,{className:ue}):ee);return ye(y.createElement(K7.Provider,{value:Ie},be))}),sE=Y_t;sE._InternalPanelDoNotUseOrYouWillBeFired=Z_t;var J_t={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M765.7 486.8L314.9 134.7A7.97 7.97 0 00302 141v77.3c0 4.9 2.3 9.6 6.1 12.6l360 281.1-360 281.1c-3.9 3-6.1 7.7-6.1 12.6V883c0 6.7 7.7 10.4 12.9 6.3l450.8-352.1a31.96 31.96 0 000-50.4z"}}]},name:"right",theme:"outlined"},Q_t=function(e,t){return y.createElement(_a,ln({},e,{ref:t,icon:J_t}))},ewt=y.forwardRef(Q_t),twt=Bt.ESC,nwt=Bt.TAB;function rwt(n){var e=n.visible,t=n.triggerRef,r=n.onVisibleChange,i=n.autoFocus,o=n.overlayRef,s=y.useRef(!1),a=function(){if(e){var d,h;(d=t.current)===null||d===void 0||(h=d.focus)===null||h===void 0||h.call(d),r==null||r(!1)}},c=function(){var d;return(d=o.current)!==null&&d!==void 0&&d.focus?(o.current.focus(),s.current=!0,!0):!1},l=function(d){switch(d.keyCode){case twt:a();break;case nwt:{var h=!1;s.current||(h=c()),h?d.preventDefault():a();break}}};y.useEffect(function(){return e?(window.addEventListener("keydown",l),i&&no(c,3),function(){window.removeEventListener("keydown",l),s.current=!1}):function(){s.current=!1}},[e])}var iwt=y.forwardRef(function(n,e){var t=n.overlay,r=n.arrow,i=n.prefixCls,o=y.useMemo(function(){var a;return typeof t=="function"?a=t():a=t,a},[t]),s=Gd(e,o==null?void 0:o.ref);return Ke.createElement(Ke.Fragment,null,r&&Ke.createElement("div",{className:"".concat(i,"-arrow")}),Ke.cloneElement(o,{ref:yv(o)?s:void 0}))}),sw={adjustX:1,adjustY:1},aw=[0,0],owt={topLeft:{points:["bl","tl"],overflow:sw,offset:[0,-4],targetOffset:aw},top:{points:["bc","tc"],overflow:sw,offset:[0,-4],targetOffset:aw},topRight:{points:["br","tr"],overflow:sw,offset:[0,-4],targetOffset:aw},bottomLeft:{points:["tl","bl"],overflow:sw,offset:[0,4],targetOffset:aw},bottom:{points:["tc","bc"],overflow:sw,offset:[0,4],targetOffset:aw},bottomRight:{points:["tr","br"],overflow:sw,offset:[0,4],targetOffset:aw}},swt=["arrow","prefixCls","transitionName","animation","align","placement","placements","getPopupContainer","showAction","hideAction","overlayClassName","overlayStyle","visible","trigger","autoFocus","overlay","children","onVisibleChange"];function awt(n,e){var t,r=n.arrow,i=r===void 0?!1:r,o=n.prefixCls,s=o===void 0?"rc-dropdown":o,a=n.transitionName,c=n.animation,l=n.align,u=n.placement,d=u===void 0?"bottomLeft":u,h=n.placements,f=h===void 0?owt:h,p=n.getPopupContainer,g=n.showAction,m=n.hideAction,v=n.overlayClassName,b=n.overlayStyle,S=n.visible,E=n.trigger,w=E===void 0?["hover"]:E,C=n.autoFocus,I=n.overlay,T=n.children,D=n.onVisibleChange,O=jr(n,swt),M=Ke.useState(),R=rt(M,2),A=R[0],k=R[1],L="visible"in n?S:A,j=Ke.useRef(null),N=Ke.useRef(null),B=Ke.useRef(null);Ke.useImperativeHandle(e,function(){return j.current});var U=function(Se){k(Se),D==null||D(Se)};rwt({visible:L,triggerRef:B,onVisibleChange:U,autoFocus:C,overlayRef:N});var K=function(Se){var se=n.onOverlayClick;k(!1),se&&se(Se)},z=function(){return Ke.createElement(iwt,{ref:N,overlay:I,prefixCls:s,arrow:i})},G=function(){return typeof I=="function"?z:z()},te=function(){var Se=n.minOverlayWidthMatchTrigger,se=n.alignPoint;return"minOverlayWidthMatchTrigger"in n?Se:!se},ie=function(){var Se=n.openClassName;return Se!==void 0?Se:"".concat(s,"-open")},Q=Ke.cloneElement(T,{className:Ue((t=T.props)===null||t===void 0?void 0:t.className,L&&ie()),ref:yv(T)?Gd(B,T.ref):void 0}),ge=m;return!ge&&w.indexOf("contextMenu")!==-1&&(ge=["click"]),Ke.createElement(rN,ln({builtinPlacements:f},O,{prefixCls:s,ref:j,popupClassName:Ue(v,Le({},"".concat(s,"-show-arrow"),i)),popupStyle:b,action:w,showAction:g,hideAction:ge,popupPlacement:d,popupAlign:l,popupTransitionName:a,popupAnimation:c,popupVisible:L,stretch:te()?"minWidth":"",popup:G(),onPopupVisibleChange:U,onPopupClick:K,getPopupContainer:p}),Q)}const cwt=Ke.forwardRef(awt);var _Oe=y.createContext(null);function wOe(n,e){return n===void 0?null:"".concat(n,"-").concat(e)}function COe(n){var e=y.useContext(_Oe);return wOe(e,n)}var lwt=["children","locked"],Jf=y.createContext(null);function uwt(n,e){var t=$e({},n);return Object.keys(e).forEach(function(r){var i=e[r];i!==void 0&&(t[r]=i)}),t}function R3(n){var e=n.children,t=n.locked,r=jr(n,lwt),i=y.useContext(Jf),o=cD(function(){return uwt(i,r)},[i,r],function(s,a){return!t&&(s[0]!==a[0]||!S3(s[1],a[1],!0))});return y.createElement(Jf.Provider,{value:o},e)}var dwt=[],xOe=y.createContext(null);function oN(){return y.useContext(xOe)}var EOe=y.createContext(dwt);function aE(n){var e=y.useContext(EOe);return y.useMemo(function(){return n!==void 0?[].concat(Ht(e),[n]):e},[e,n])}var IOe=y.createContext(null),lre=y.createContext({});function Jve(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(Z7(n)){var t=n.nodeName.toLowerCase(),r=["input","select","textarea","button"].includes(t)||n.isContentEditable||t==="a"&&!!n.getAttribute("href"),i=n.getAttribute("tabindex"),o=Number(i),s=null;return i&&!Number.isNaN(o)?s=o:r&&s===null&&(s=0),r&&n.disabled&&(s=null),s!==null&&(s>=0||e&&s<0)}return!1}function hwt(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,t=Ht(n.querySelectorAll("*")).filter(function(r){return Jve(r,e)});return Jve(n,e)&&t.unshift(n),t}var yZ=Bt.LEFT,bZ=Bt.RIGHT,SZ=Bt.UP,uO=Bt.DOWN,dO=Bt.ENTER,POe=Bt.ESC,hI=Bt.HOME,fI=Bt.END,Qve=[SZ,uO,yZ,bZ];function fwt(n,e,t,r){var i,o,s,a,c="prev",l="next",u="children",d="parent";if(n==="inline"&&r===dO)return{inlineTrigger:!0};var h=(i={},Le(i,SZ,c),Le(i,uO,l),i),f=(o={},Le(o,yZ,t?l:c),Le(o,bZ,t?c:l),Le(o,uO,u),Le(o,dO,u),o),p=(s={},Le(s,SZ,c),Le(s,uO,l),Le(s,dO,u),Le(s,POe,d),Le(s,yZ,t?u:d),Le(s,bZ,t?d:u),s),g={inline:h,horizontal:f,vertical:p,inlineSub:h,horizontalSub:p,verticalSub:p},m=(a=g["".concat(n).concat(e?"":"Sub")])===null||a===void 0?void 0:a[r];switch(m){case c:return{offset:-1,sibling:!0};case l:return{offset:1,sibling:!0};case d:return{offset:-1,sibling:!1};case u:return{offset:1,sibling:!1};default:return null}}function pwt(n){for(var e=n;e;){if(e.getAttribute("data-menu-list"))return e;e=e.parentElement}return null}function gwt(n,e){for(var t=n||document.activeElement;t;){if(e.has(t))return t;t=t.parentElement}return null}function ure(n,e){var t=hwt(n,!0);return t.filter(function(r){return e.has(r)})}function e0e(n,e,t){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;if(!n)return null;var i=ure(n,e),o=i.length,s=i.findIndex(function(a){return t===a});return r<0?s===-1?s=o-1:s-=1:r>0&&(s+=1),s=(s+o)%o,i[s]}var _Z=function(e,t){var r=new Set,i=new Map,o=new Map;return e.forEach(function(s){var a=document.querySelector("[data-menu-id='".concat(wOe(t,s),"']"));a&&(r.add(a),o.set(a,s),i.set(s,a))}),{elements:r,key2element:i,element2key:o}};function mwt(n,e,t,r,i,o,s,a,c,l){var u=y.useRef(),d=y.useRef();d.current=e;var h=function(){no.cancel(u.current)};return y.useEffect(function(){return function(){h()}},[]),function(f){var p=f.which;if([].concat(Qve,[dO,POe,hI,fI]).includes(p)){var g=o(),m=_Z(g,r),v=m,b=v.elements,S=v.key2element,E=v.element2key,w=S.get(e),C=gwt(w,b),I=E.get(C),T=fwt(n,s(I,!0).length===1,t,p);if(!T&&p!==hI&&p!==fI)return;(Qve.includes(p)||[hI,fI].includes(p))&&f.preventDefault();var D=function(N){if(N){var B=N,U=N.querySelector("a");U!=null&&U.getAttribute("href")&&(B=U);var K=E.get(N);a(K),h(),u.current=no(function(){d.current===K&&B.focus()})}};if([hI,fI].includes(p)||T.sibling||!C){var O;!C||n==="inline"?O=i.current:O=pwt(C);var M,R=ure(O,b);p===hI?M=R[0]:p===fI?M=R[R.length-1]:M=e0e(O,b,C,T.offset),D(M)}else if(T.inlineTrigger)c(I);else if(T.offset>0)c(I,!0),h(),u.current=no(function(){m=_Z(g,r);var j=C.getAttribute("aria-controls"),N=document.getElementById(j),B=e0e(N,m.elements);D(B)},5);else if(T.offset<0){var A=s(I,!0),k=A[A.length-2],L=S.get(k);c(k,!1),D(L)}}l==null||l(f)}}function vwt(n){Promise.resolve().then(n)}var dre="__RC_UTIL_PATH_SPLIT__",t0e=function(e){return e.join(dre)},ywt=function(e){return e.split(dre)},wZ="rc-menu-more";function bwt(){var n=y.useState({}),e=rt(n,2),t=e[1],r=y.useRef(new Map),i=y.useRef(new Map),o=y.useState([]),s=rt(o,2),a=s[0],c=s[1],l=y.useRef(0),u=y.useRef(!1),d=function(){u.current||t({})},h=y.useCallback(function(S,E){var w=t0e(E);i.current.set(w,S),r.current.set(S,w),l.current+=1;var C=l.current;vwt(function(){C===l.current&&d()})},[]),f=y.useCallback(function(S,E){var w=t0e(E);i.current.delete(w),r.current.delete(S)},[]),p=y.useCallback(function(S){c(S)},[]),g=y.useCallback(function(S,E){var w=r.current.get(S)||"",C=ywt(w);return E&&a.includes(C[0])&&C.unshift(wZ),C},[a]),m=y.useCallback(function(S,E){return S.filter(function(w){return w!==void 0}).some(function(w){var C=g(w,!0);return C.includes(E)})},[g]),v=function(){var E=Ht(r.current.keys());return a.length&&E.push(wZ),E},b=y.useCallback(function(S){var E="".concat(r.current.get(S)).concat(dre),w=new Set;return Ht(i.current.keys()).forEach(function(C){C.startsWith(E)&&w.add(i.current.get(C))}),w},[]);return y.useEffect(function(){return function(){u.current=!0}},[]),{registerPath:h,unregisterPath:f,refreshOverflowKeys:p,isSubPathKey:m,getKeyPath:g,getKeys:v,getSubPathKeys:b}}function fP(n){var e=y.useRef(n);e.current=n;var t=y.useCallback(function(){for(var r,i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return(r=e.current)===null||r===void 0?void 0:r.call.apply(r,[e].concat(o))},[]);return n?t:void 0}var Swt=Math.random().toFixed(5).toString().slice(2),n0e=0;function _wt(n){var e=Ql(n,{value:n}),t=rt(e,2),r=t[0],i=t[1];return y.useEffect(function(){n0e+=1;var o="".concat(Swt,"-").concat(n0e);i("rc-menu-uuid-".concat(o))},[]),r}function kOe(n,e,t,r){var i=y.useContext(Jf),o=i.activeKey,s=i.onActive,a=i.onInactive,c={active:o===n};return e||(c.onMouseEnter=function(l){t==null||t({key:n,domEvent:l}),s(n)},c.onMouseLeave=function(l){r==null||r({key:n,domEvent:l}),a(n)}),c}function TOe(n){var e=y.useContext(Jf),t=e.mode,r=e.rtl,i=e.inlineIndent;if(t!=="inline")return null;var o=n;return r?{paddingRight:o*i}:{paddingLeft:o*i}}function DOe(n){var e=n.icon,t=n.props,r=n.children,i;return e===null||e===!1?null:(typeof e=="function"?i=y.createElement(e,$e({},t)):typeof e!="boolean"&&(i=e),i||r||null)}var wwt=["item"];function k8(n){var e=n.item,t=jr(n,wwt);return Object.defineProperty(t,"item",{get:function(){return Sl(!1,"`info.item` is deprecated since we will move to function component that not provides React Node instance in future."),e}}),t}var Cwt=["title","attribute","elementRef"],xwt=["style","className","eventKey","warnKey","disabled","itemIcon","children","role","onMouseEnter","onMouseLeave","onClick","onKeyDown","onFocus"],Ewt=["active"],Iwt=function(n){zy(t,n);var e=Vy(t);function t(){return vc(this,t),e.apply(this,arguments)}return yc(t,[{key:"render",value:function(){var i=this.props,o=i.title,s=i.attribute,a=i.elementRef,c=jr(i,Cwt),l=Yc(c,["eventKey","popupClassName","popupOffset","onTitleClick"]);return Sl(!s,"`attribute` of Menu.Item is deprecated. Please pass attribute directly."),y.createElement(rg.Item,ln({},s,{title:typeof o=="string"?o:void 0},l,{ref:a}))}}]),t}(y.Component),Pwt=y.forwardRef(function(n,e){var t,r=n.style,i=n.className,o=n.eventKey;n.warnKey;var s=n.disabled,a=n.itemIcon,c=n.children,l=n.role,u=n.onMouseEnter,d=n.onMouseLeave,h=n.onClick,f=n.onKeyDown,p=n.onFocus,g=jr(n,xwt),m=COe(o),v=y.useContext(Jf),b=v.prefixCls,S=v.onItemClick,E=v.disabled,w=v.overflowDisabled,C=v.itemIcon,I=v.selectedKeys,T=v.onActive,D=y.useContext(lre),O=D._internalRenderMenuItem,M="".concat(b,"-item"),R=y.useRef(),A=y.useRef(),k=E||s,L=Uy(e,A),j=aE(o),N=function(ee){return{key:o,keyPath:Ht(j).reverse(),item:R.current,domEvent:ee}},B=a||C,U=kOe(o,k,u,d),K=U.active,z=jr(U,Ewt),G=I.includes(o),te=TOe(j.length),ie=function(ee){if(!k){var Y=N(ee);h==null||h(k8(Y)),S(Y)}},Q=function(ee){if(f==null||f(ee),ee.which===Bt.ENTER){var Y=N(ee);h==null||h(k8(Y)),S(Y)}},ge=function(ee){T(o),p==null||p(ee)},_e={};n.role==="option"&&(_e["aria-selected"]=G);var Se=y.createElement(Iwt,ln({ref:R,elementRef:L,role:l===null?"none":l||"menuitem",tabIndex:s?null:-1,"data-menu-id":w&&m?null:m},g,z,_e,{component:"li","aria-disabled":s,style:$e($e({},te),r),className:Ue(M,(t={},Le(t,"".concat(M,"-active"),K),Le(t,"".concat(M,"-selected"),G),Le(t,"".concat(M,"-disabled"),k),t),i),onClick:ie,onKeyDown:Q,onFocus:ge}),c,y.createElement(DOe,{props:$e($e({},n),{},{isSelected:G}),icon:B}));return O&&(Se=O(Se,n,{selected:G})),Se});function kwt(n,e){var t=n.eventKey,r=oN(),i=aE(t);return y.useEffect(function(){if(r)return r.registerPath(t,i),function(){r.unregisterPath(t,i)}},[i]),r?null:y.createElement(Pwt,ln({},n,{ref:e}))}const sN=y.forwardRef(kwt);var Twt=["className","children"],Dwt=function(e,t){var r=e.className,i=e.children,o=jr(e,Twt),s=y.useContext(Jf),a=s.prefixCls,c=s.mode,l=s.rtl;return y.createElement("ul",ln({className:Ue(a,l&&"".concat(a,"-rtl"),"".concat(a,"-sub"),"".concat(a,"-").concat(c==="inline"?"inline":"vertical"),r),role:"menu"},o,{"data-menu-list":!0,ref:t}),i)},hre=y.forwardRef(Dwt);hre.displayName="SubMenuList";function fre(n,e){return hg(n).map(function(t,r){if(y.isValidElement(t)){var i,o,s=t.key,a=(i=(o=t.props)===null||o===void 0?void 0:o.eventKey)!==null&&i!==void 0?i:s,c=a==null;c&&(a="tmp_key-".concat([].concat(Ht(e),[r]).join("-")));var l={key:a,eventKey:a};return y.cloneElement(t,l)}return t})}var dl={adjustX:1,adjustY:1},Rwt={topLeft:{points:["bl","tl"],overflow:dl},topRight:{points:["br","tr"],overflow:dl},bottomLeft:{points:["tl","bl"],overflow:dl},bottomRight:{points:["tr","br"],overflow:dl},leftTop:{points:["tr","tl"],overflow:dl},leftBottom:{points:["br","bl"],overflow:dl},rightTop:{points:["tl","tr"],overflow:dl},rightBottom:{points:["bl","br"],overflow:dl}},Awt={topLeft:{points:["bl","tl"],overflow:dl},topRight:{points:["br","tr"],overflow:dl},bottomLeft:{points:["tl","bl"],overflow:dl},bottomRight:{points:["tr","br"],overflow:dl},rightTop:{points:["tr","tl"],overflow:dl},rightBottom:{points:["br","bl"],overflow:dl},leftTop:{points:["tl","tr"],overflow:dl},leftBottom:{points:["bl","br"],overflow:dl}};function ROe(n,e,t){if(e)return e;if(t)return t[n]||t.other}var Owt={horizontal:"bottomLeft",vertical:"rightTop","vertical-left":"rightTop","vertical-right":"leftTop"};function Mwt(n){var e=n.prefixCls,t=n.visible,r=n.children,i=n.popup,o=n.popupStyle,s=n.popupClassName,a=n.popupOffset,c=n.disabled,l=n.mode,u=n.onVisibleChange,d=y.useContext(Jf),h=d.getPopupContainer,f=d.rtl,p=d.subMenuOpenDelay,g=d.subMenuCloseDelay,m=d.builtinPlacements,v=d.triggerSubMenuAction,b=d.forceSubMenuRender,S=d.rootClassName,E=d.motion,w=d.defaultMotions,C=y.useState(!1),I=rt(C,2),T=I[0],D=I[1],O=$e(f?$e({},Awt):$e({},Rwt),m),M=Owt[l],R=ROe(l,E,w),A=y.useRef(R);l!=="inline"&&(A.current=R);var k=$e($e({},A.current),{},{leavedClassName:"".concat(e,"-hidden"),removeOnLeave:!1,motionAppear:!0}),L=y.useRef();return y.useEffect(function(){return L.current=no(function(){D(t)}),function(){no.cancel(L.current)}},[t]),y.createElement(rN,{prefixCls:e,popupClassName:Ue("".concat(e,"-popup"),Le({},"".concat(e,"-rtl"),f),s,S),stretch:l==="horizontal"?"minWidth":null,getPopupContainer:h,builtinPlacements:O,popupPlacement:M,popupVisible:T,popup:i,popupStyle:o,popupAlign:a&&{offset:a},action:c?[]:[v],mouseEnterDelay:p,mouseLeaveDelay:g,onPopupVisibleChange:u,forceRender:b,popupMotion:k,fresh:!0},r)}function $wt(n){var e=n.id,t=n.open,r=n.keyPath,i=n.children,o="inline",s=y.useContext(Jf),a=s.prefixCls,c=s.forceSubMenuRender,l=s.motion,u=s.defaultMotions,d=s.mode,h=y.useRef(!1);h.current=d===o;var f=y.useState(!h.current),p=rt(f,2),g=p[0],m=p[1],v=h.current?t:!1;y.useEffect(function(){h.current&&m(!1)},[d]);var b=$e({},ROe(o,l,u));r.length>1&&(b.motionAppear=!1);var S=b.onVisibleChanged;return b.onVisibleChanged=function(E){return!h.current&&!E&&m(!0),S==null?void 0:S(E)},g?null:y.createElement(R3,{mode:o,locked:!h.current},y.createElement(bv,ln({visible:v},b,{forceRender:c,removeOnLeave:!1,leavedClassName:"".concat(a,"-hidden")}),function(E){var w=E.className,C=E.style;return y.createElement(hre,{id:e,className:w,style:C},i)}))}var Lwt=["style","className","title","eventKey","warnKey","disabled","internalPopupClose","children","itemIcon","expandIcon","popupClassName","popupOffset","popupStyle","onClick","onMouseEnter","onMouseLeave","onTitleClick","onTitleMouseEnter","onTitleMouseLeave"],Nwt=["active"],Fwt=y.forwardRef(function(n,e){var t,r=n.style,i=n.className,o=n.title,s=n.eventKey;n.warnKey;var a=n.disabled,c=n.internalPopupClose,l=n.children,u=n.itemIcon,d=n.expandIcon,h=n.popupClassName,f=n.popupOffset,p=n.popupStyle,g=n.onClick,m=n.onMouseEnter,v=n.onMouseLeave,b=n.onTitleClick,S=n.onTitleMouseEnter,E=n.onTitleMouseLeave,w=jr(n,Lwt),C=COe(s),I=y.useContext(Jf),T=I.prefixCls,D=I.mode,O=I.openKeys,M=I.disabled,R=I.overflowDisabled,A=I.activeKey,k=I.selectedKeys,L=I.itemIcon,j=I.expandIcon,N=I.onItemClick,B=I.onOpenChange,U=I.onActive,K=y.useContext(lre),z=K._internalRenderSubMenuItem,G=y.useContext(IOe),te=G.isSubPathKey,ie=aE(),Q="".concat(T,"-submenu"),ge=M||a,_e=y.useRef(),Se=y.useRef(),se=u??L,ee=d??j,Y=O.includes(s),ue=!R&&Y,ye=te(k,s),V=kOe(s,ge,S,E),le=V.active,he=jr(V,Nwt),oe=y.useState(!1),ne=rt(oe,2),ce=ne[0],Ae=ne[1],Ie=function(bn){ge||Ae(bn)},be=function(bn){Ie(!0),m==null||m({key:s,domEvent:bn})},De=function(bn){Ie(!1),v==null||v({key:s,domEvent:bn})},Me=y.useMemo(function(){return le||(D!=="inline"?ce||te([A],s):!1)},[D,le,A,ce,s,te]),He=TOe(ie.length),Je=function(bn){ge||(b==null||b({key:s,domEvent:bn}),D==="inline"&&B(s,!Y))},qe=fP(function(yn){g==null||g(k8(yn)),N(yn)}),Ge=function(bn){D!=="inline"&&B(s,bn)},St=function(){U(s)},Pt=C&&"".concat(C,"-popup"),on=y.createElement("div",ln({role:"menuitem",style:He,className:"".concat(Q,"-title"),tabIndex:ge?null:-1,ref:_e,title:typeof o=="string"?o:null,"data-menu-id":R&&C?null:C,"aria-expanded":ue,"aria-haspopup":!0,"aria-controls":Pt,"aria-disabled":ge,onClick:Je,onFocus:St},he),o,y.createElement(DOe,{icon:D!=="horizontal"?ee:void 0,props:$e($e({},n),{},{isOpen:ue,isSubMenu:!0})},y.createElement("i",{className:"".concat(Q,"-arrow")}))),an=y.useRef(D);if(D!=="inline"&&ie.length>1?an.current="vertical":an.current=D,!R){var Rt=an.current;on=y.createElement(Mwt,{mode:Rt,prefixCls:Q,visible:!c&&ue&&D!=="inline",popupClassName:h,popupOffset:f,popupStyle:p,popup:y.createElement(R3,{mode:Rt==="horizontal"?"vertical":Rt},y.createElement(hre,{id:Pt,ref:Se},l)),disabled:ge,onVisibleChange:Ge},on)}var Xt=y.createElement(rg.Item,ln({ref:e,role:"none"},w,{component:"li",style:r,className:Ue(Q,"".concat(Q,"-").concat(D),i,(t={},Le(t,"".concat(Q,"-open"),ue),Le(t,"".concat(Q,"-active"),Me),Le(t,"".concat(Q,"-selected"),ye),Le(t,"".concat(Q,"-disabled"),ge),t)),onMouseEnter:be,onMouseLeave:De}),on,!R&&y.createElement($wt,{id:Pt,open:ue,keyPath:ie},l));return z&&(Xt=z(Xt,n,{selected:ye,active:Me,open:ue,disabled:ge})),y.createElement(R3,{onItemClick:qe,mode:D==="horizontal"?"vertical":D,itemIcon:se,expandIcon:ee},Xt)}),aN=y.forwardRef(function(n,e){var t=n.eventKey,r=n.children,i=aE(t),o=fre(r,i),s=oN();y.useEffect(function(){if(s)return s.registerPath(t,i),function(){s.unregisterPath(t,i)}},[i]);var a;return s?a=o:a=y.createElement(Fwt,ln({ref:e},n),o),y.createElement(EOe.Provider,{value:i},a)});function pre(n){var e=n.className,t=n.style,r=y.useContext(Jf),i=r.prefixCls,o=oN();return o?null:y.createElement("li",{role:"separator",className:Ue("".concat(i,"-item-divider"),e),style:t})}var jwt=["className","title","eventKey","children"],Bwt=y.forwardRef(function(n,e){var t=n.className,r=n.title;n.eventKey;var i=n.children,o=jr(n,jwt),s=y.useContext(Jf),a=s.prefixCls,c="".concat(a,"-item-group");return y.createElement("li",ln({ref:e,role:"presentation"},o,{onClick:function(u){return u.stopPropagation()},className:Ue(c,t)}),y.createElement("div",{role:"presentation",className:"".concat(c,"-title"),title:typeof r=="string"?r:void 0},r),y.createElement("ul",{role:"group",className:"".concat(c,"-list")},i))}),gre=y.forwardRef(function(n,e){var t=n.eventKey,r=n.children,i=aE(t),o=fre(r,i),s=oN();return s?o:y.createElement(Bwt,ln({ref:e},Yc(n,["warnKey"])),o)}),Hwt=["label","children","key","type"];function CZ(n,e){var t=e.item,r=e.group,i=e.submenu,o=e.divider;return(n||[]).map(function(s,a){if(s&&Wn(s)==="object"){var c=s,l=c.label,u=c.children,d=c.key,h=c.type,f=jr(c,Hwt),p=d??"tmp-".concat(a);return u||h==="group"?h==="group"?y.createElement(r,ln({key:p},f,{title:l}),CZ(u,e)):y.createElement(i,ln({key:p},f,{title:l}),CZ(u,e)):h==="divider"?y.createElement(o,ln({key:p},f)):y.createElement(t,ln({key:p},f),l)}return null}).filter(function(s){return s})}function r0e(n,e,t,r){var i=n,o=$e({divider:pre,item:sN,group:gre,submenu:aN},r);return e&&(i=CZ(e,o)),fre(i,t)}var Uwt=["prefixCls","rootClassName","style","className","tabIndex","items","children","direction","id","mode","inlineCollapsed","disabled","disabledOverflow","subMenuOpenDelay","subMenuCloseDelay","forceSubMenuRender","defaultOpenKeys","openKeys","activeKey","defaultActiveFirst","selectable","multiple","defaultSelectedKeys","selectedKeys","onSelect","onDeselect","inlineIndent","motion","defaultMotions","triggerSubMenuAction","builtinPlacements","itemIcon","expandIcon","overflowedIndicator","overflowedIndicatorPopupClassName","getPopupContainer","onClick","onOpenChange","onKeyDown","openAnimation","openTransitionName","_internalRenderMenuItem","_internalRenderSubMenuItem","_internalComponents"],Ab=[],zwt=y.forwardRef(function(n,e){var t,r,i=n,o=i.prefixCls,s=o===void 0?"rc-menu":o,a=i.rootClassName,c=i.style,l=i.className,u=i.tabIndex,d=u===void 0?0:u,h=i.items,f=i.children,p=i.direction,g=i.id,m=i.mode,v=m===void 0?"vertical":m,b=i.inlineCollapsed,S=i.disabled,E=i.disabledOverflow,w=i.subMenuOpenDelay,C=w===void 0?.1:w,I=i.subMenuCloseDelay,T=I===void 0?.1:I,D=i.forceSubMenuRender,O=i.defaultOpenKeys,M=i.openKeys,R=i.activeKey,A=i.defaultActiveFirst,k=i.selectable,L=k===void 0?!0:k,j=i.multiple,N=j===void 0?!1:j,B=i.defaultSelectedKeys,U=i.selectedKeys,K=i.onSelect,z=i.onDeselect,G=i.inlineIndent,te=G===void 0?24:G,ie=i.motion,Q=i.defaultMotions,ge=i.triggerSubMenuAction,_e=ge===void 0?"hover":ge,Se=i.builtinPlacements,se=i.itemIcon,ee=i.expandIcon,Y=i.overflowedIndicator,ue=Y===void 0?"...":Y,ye=i.overflowedIndicatorPopupClassName,V=i.getPopupContainer,le=i.onClick,he=i.onOpenChange,oe=i.onKeyDown;i.openAnimation,i.openTransitionName;var ne=i._internalRenderMenuItem,ce=i._internalRenderSubMenuItem,Ae=i._internalComponents,Ie=jr(i,Uwt),be=y.useMemo(function(){return[r0e(f,h,Ab,Ae),r0e(f,h,Ab,{})]},[f,h,Ae]),De=rt(be,2),Me=De[0],He=De[1],Je=y.useState(!1),qe=rt(Je,2),Ge=qe[0],St=qe[1],Pt=y.useRef(),on=_wt(g),an=p==="rtl",Rt=Ql(O,{value:M,postState:function(sr){return sr||Ab}}),Xt=rt(Rt,2),yn=Xt[0],bn=Xt[1],Kn=function(sr){var nr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;function Zr(){bn(sr),he==null||he(sr)}nr?Wu.flushSync(Zr):Zr()},lr=y.useState(yn),Rr=rt(lr,2),Lr=Rr[0],er=Rr[1],ke=y.useRef(!1),Qn=y.useMemo(function(){return(v==="inline"||v==="vertical")&&b?["vertical",b]:[v,!1]},[v,b]),Gn=rt(Qn,2),J=Gn[0],ze=Gn[1],it=J==="inline",at=y.useState(J),Lt=rt(at,2),fn=Lt[0],hn=Lt[1],Ut=y.useState(ze),sn=rt(Ut,2),ae=sn[0],Wt=sn[1];y.useEffect(function(){hn(J),Wt(ze),ke.current&&(it?bn(Lr):Kn(Ab))},[J,ze]);var un=y.useState(0),qt=rt(un,2),Ce=qt[0],ct=qt[1],At=Ce>=Me.length-1||fn!=="horizontal"||E;y.useEffect(function(){it&&er(yn)},[yn]),y.useEffect(function(){return ke.current=!0,function(){ke.current=!1}},[]);var $t=bwt(),_n=$t.registerPath,jn=$t.unregisterPath,Zn=$t.refreshOverflowKeys,Z=$t.isSubPathKey,ve=$t.getKeyPath,W=$t.getKeys,X=$t.getSubPathKeys,fe=y.useMemo(function(){return{registerPath:_n,unregisterPath:jn}},[_n,jn]),xt=y.useMemo(function(){return{isSubPathKey:Z}},[Z]);y.useEffect(function(){Zn(At?Ab:Me.slice(Ce+1).map(function(xr){return xr.key}))},[Ce,At]);var Zt=Ql(R||A&&((t=Me[0])===null||t===void 0?void 0:t.key),{value:R}),or=rt(Zt,2),tr=or[0],vo=or[1],fs=fP(function(xr){vo(xr)}),ps=fP(function(){vo(void 0)});y.useImperativeHandle(e,function(){return{list:Pt.current,focus:function(sr){var nr,Zr=W(),_i=_Z(Zr,on),gs=_i.elements,Vs=_i.key2element,wa=_i.element2key,ms=ure(Pt.current,gs),Po=tr??(ms[0]?wa.get(ms[0]):(nr=Me.find(function(za){return!za.props.disabled}))===null||nr===void 0?void 0:nr.key),Ca=Vs.get(Po);if(Po&&Ca){var lu;Ca==null||(lu=Ca.focus)===null||lu===void 0||lu.call(Ca,sr)}}}});var Wo=Ql(B||[],{value:U,postState:function(sr){return Array.isArray(sr)?sr:sr==null?Ab:[sr]}}),Tl=rt(Wo,2),rs=Tl[0],Dl=Tl[1],Xh=function(sr){if(L){var nr=sr.key,Zr=rs.includes(nr),_i;N?Zr?_i=rs.filter(function(Vs){return Vs!==nr}):_i=[].concat(Ht(rs),[nr]):_i=[nr],Dl(_i);var gs=$e($e({},sr),{},{selectedKeys:_i});Zr?z==null||z(gs):K==null||K(gs)}!N&&yn.length&&fn!=="inline"&&Kn(Ab)},Sc=fP(function(xr){le==null||le(k8(xr)),Xh(xr)}),oa=fP(function(xr,sr){var nr=yn.filter(function(_i){return _i!==xr});if(sr)nr.push(xr);else if(fn!=="inline"){var Zr=X(xr);nr=nr.filter(function(_i){return!Zr.has(_i)})}S3(yn,nr,!0)||Kn(nr,!0)}),zs=function(sr,nr){var Zr=nr??!yn.includes(sr);oa(sr,Zr)},Rl=mwt(fn,tr,an,on,Pt,W,ve,vo,zs,oe);y.useEffect(function(){St(!0)},[]);var Ps=y.useMemo(function(){return{_internalRenderMenuItem:ne,_internalRenderSubMenuItem:ce}},[ne,ce]),pr=fn!=="horizontal"||E?Me:Me.map(function(xr,sr){return y.createElement(R3,{key:xr.key,overflowDisabled:sr>Ce},xr)}),Yn=y.createElement(rg,ln({id:g,ref:Pt,prefixCls:"".concat(s,"-overflow"),component:"ul",itemComponent:sN,className:Ue(s,"".concat(s,"-root"),"".concat(s,"-").concat(fn),l,(r={},Le(r,"".concat(s,"-inline-collapsed"),ae),Le(r,"".concat(s,"-rtl"),an),r),a),dir:p,style:c,role:"menu",tabIndex:d,data:pr,renderRawItem:function(sr){return sr},renderRawRest:function(sr){var nr=sr.length,Zr=nr?Me.slice(-nr):null;return y.createElement(aN,{eventKey:wZ,title:ue,disabled:At,internalPopupClose:nr===0,popupClassName:ye},Zr)},maxCount:fn!=="horizontal"||E?rg.INVALIDATE:rg.RESPONSIVE,ssr:"full","data-menu-list":!0,onVisibleChange:function(sr){ct(sr)},onKeyDown:Rl},Ie));return y.createElement(lre.Provider,{value:Ps},y.createElement(_Oe.Provider,{value:on},y.createElement(R3,{prefixCls:s,rootClassName:a,mode:fn,openKeys:yn,rtl:an,disabled:S,motion:Ge?ie:null,defaultMotions:Ge?Q:null,activeKey:tr,onActive:fs,onInactive:ps,selectedKeys:rs,inlineIndent:te,subMenuOpenDelay:C,subMenuCloseDelay:T,forceSubMenuRender:D,builtinPlacements:Se,triggerSubMenuAction:_e,getPopupContainer:V,itemIcon:se,expandIcon:ee,onItemClick:Sc,onOpenChange:oa},y.createElement(IOe.Provider,{value:xt},Yn),y.createElement("div",{style:{display:"none"},"aria-hidden":!0},y.createElement(xOe.Provider,{value:fe},He)))))}),_D=zwt;_D.Item=sN;_D.SubMenu=aN;_D.ItemGroup=gre;_D.Divider=pre;const AOe=y.createContext({});var Vwt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M176 511a56 56 0 10112 0 56 56 0 10-112 0zm280 0a56 56 0 10112 0 56 56 0 10-112 0zm280 0a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"ellipsis",theme:"outlined"},Wwt=function(e,t){return y.createElement(_a,ln({},e,{ref:t,icon:Vwt}))},OOe=y.forwardRef(Wwt);const T8=y.createContext({prefixCls:"",firstLevel:!0,inlineCollapsed:!1});var qwt=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t};const MOe=n=>{const{prefixCls:e,className:t,dashed:r}=n,i=qwt(n,["prefixCls","className","dashed"]),{getPrefixCls:o}=y.useContext(fr),s=o("menu",e),a=Ue({[`${s}-item-divider-dashed`]:!!r},t);return y.createElement(pre,Object.assign({className:a},i))},$Oe=n=>{var e;const{className:t,children:r,icon:i,title:o,danger:s}=n,{prefixCls:a,firstLevel:c,direction:l,disableMenuItemTitleTooltip:u,inlineCollapsed:d}=y.useContext(T8),h=b=>{const S=y.createElement("span",{className:`${a}-title-content`},r);return(!i||y.isValidElement(r)&&r.type==="span")&&r&&b&&c&&typeof r=="string"?y.createElement("div",{className:`${a}-inline-collapsed-noicon`},r.charAt(0)):S},{siderCollapsed:f}=y.useContext(AOe);let p=o;typeof o>"u"?p=c?r:"":o===!1&&(p="");const g={title:p};!f&&!d&&(g.title=null,g.open=!1);const m=hg(r).length;let v=y.createElement(sN,Object.assign({},Yc(n,["title","icon","danger"]),{className:Ue({[`${a}-item-danger`]:s,[`${a}-item-only-child`]:(i?m+1:m)===1},t),title:typeof o=="string"?o:void 0}),gg(i,{className:Ue(y.isValidElement(i)?(e=i.props)===null||e===void 0?void 0:e.className:"",`${a}-item-icon`)}),h(d));return u||(v=y.createElement(sE,Object.assign({},g,{placement:l==="rtl"?"left":"right",overlayClassName:`${a}-inline-collapsed-tooltip`}),v)),v};var Kwt=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t};const D8=y.createContext(null),Gwt=y.forwardRef((n,e)=>{const{children:t}=n,r=Kwt(n,["children"]),i=y.useContext(D8),o=y.useMemo(()=>Object.assign(Object.assign({},i),r),[i,r.prefixCls,r.mode,r.selectable,r.rootClassName]),s=Ift(t),a=Uy(e,s?t.ref:null);return y.createElement(D8.Provider,{value:o},y.createElement(k3,{space:!0},s?y.cloneElement(t,{ref:a}):t))}),Zwt=n=>{const{componentCls:e,motionDurationSlow:t,horizontalLineHeight:r,colorSplit:i,lineWidth:o,lineType:s,itemPaddingInline:a}=n;return{[`${e}-horizontal`]:{lineHeight:r,border:0,borderBottom:`${Ct(o)} ${s} ${i}`,boxShadow:"none","&::after":{display:"block",clear:"both",height:0,content:'"\\20"'},[`${e}-item, ${e}-submenu`]:{position:"relative",display:"inline-block",verticalAlign:"bottom",paddingInline:a},[`> ${e}-item:hover,
        > ${e}-item-active,
        > ${e}-submenu ${e}-submenu-title:hover`]:{backgroundColor:"transparent"},[`${e}-item, ${e}-submenu-title`]:{transition:[`border-color ${t}`,`background ${t}`].join(",")},[`${e}-submenu-arrow`]:{display:"none"}}}},Xwt=n=>{let{componentCls:e,menuArrowOffset:t,calc:r}=n;return{[`${e}-rtl`]:{direction:"rtl"},[`${e}-submenu-rtl`]:{transformOrigin:"100% 0"},[`${e}-rtl${e}-vertical,
    ${e}-submenu-rtl ${e}-vertical`]:{[`${e}-submenu-arrow`]:{"&::before":{transform:`rotate(-45deg) translateY(${Ct(r(t).mul(-1).equal())})`},"&::after":{transform:`rotate(45deg) translateY(${Ct(t)})`}}}}},i0e=n=>Object.assign({},dD(n)),o0e=(n,e)=>{const{componentCls:t,itemColor:r,itemSelectedColor:i,groupTitleColor:o,itemBg:s,subMenuItemBg:a,itemSelectedBg:c,activeBarHeight:l,activeBarWidth:u,activeBarBorderWidth:d,motionDurationSlow:h,motionEaseInOut:f,motionEaseOut:p,itemPaddingInline:g,motionDurationMid:m,itemHoverColor:v,lineType:b,colorSplit:S,itemDisabledColor:E,dangerItemColor:w,dangerItemHoverColor:C,dangerItemSelectedColor:I,dangerItemActiveBg:T,dangerItemSelectedBg:D,popupBg:O,itemHoverBg:M,itemActiveBg:R,menuSubMenuBg:A,horizontalItemSelectedColor:k,horizontalItemSelectedBg:L,horizontalItemBorderRadius:j,horizontalItemHoverBg:N}=n;return{[`${t}-${e}, ${t}-${e} > ${t}`]:{color:r,background:s,[`&${t}-root:focus-visible`]:Object.assign({},i0e(n)),[`${t}-item-group-title`]:{color:o},[`${t}-submenu-selected`]:{[`> ${t}-submenu-title`]:{color:i}},[`${t}-item, ${t}-submenu-title`]:{color:r,[`&:not(${t}-item-disabled):focus-visible`]:Object.assign({},i0e(n))},[`${t}-item-disabled, ${t}-submenu-disabled`]:{color:`${E} !important`},[`${t}-item:not(${t}-item-selected):not(${t}-submenu-selected)`]:{[`&:hover, > ${t}-submenu-title:hover`]:{color:v}},[`&:not(${t}-horizontal)`]:{[`${t}-item:not(${t}-item-selected)`]:{"&:hover":{backgroundColor:M},"&:active":{backgroundColor:R}},[`${t}-submenu-title`]:{"&:hover":{backgroundColor:M},"&:active":{backgroundColor:R}}},[`${t}-item-danger`]:{color:w,[`&${t}-item:hover`]:{[`&:not(${t}-item-selected):not(${t}-submenu-selected)`]:{color:C}},[`&${t}-item:active`]:{background:T}},[`${t}-item a`]:{"&, &:hover":{color:"inherit"}},[`${t}-item-selected`]:{color:i,[`&${t}-item-danger`]:{color:I},"a, a:hover":{color:"inherit"}},[`& ${t}-item-selected`]:{backgroundColor:c,[`&${t}-item-danger`]:{backgroundColor:D}},[`&${t}-submenu > ${t}`]:{backgroundColor:A},[`&${t}-popup > ${t}`]:{backgroundColor:O},[`&${t}-submenu-popup > ${t}`]:{backgroundColor:O},[`&${t}-horizontal`]:Object.assign(Object.assign({},e==="dark"?{borderBottom:0}:{}),{[`> ${t}-item, > ${t}-submenu`]:{top:d,marginTop:n.calc(d).mul(-1).equal(),marginBottom:0,borderRadius:j,"&::after":{position:"absolute",insetInline:g,bottom:0,borderBottom:`${Ct(l)} solid transparent`,transition:`border-color ${h} ${f}`,content:'""'},"&:hover, &-active, &-open":{background:N,"&::after":{borderBottomWidth:l,borderBottomColor:k}},"&-selected":{color:k,backgroundColor:L,"&:hover":{backgroundColor:L},"&::after":{borderBottomWidth:l,borderBottomColor:k}}}}),[`&${t}-root`]:{[`&${t}-inline, &${t}-vertical`]:{borderInlineEnd:`${Ct(d)} ${b} ${S}`}},[`&${t}-inline`]:{[`${t}-sub${t}-inline`]:{background:a},[`${t}-item`]:{position:"relative","&::after":{position:"absolute",insetBlock:0,insetInlineEnd:0,borderInlineEnd:`${Ct(u)} solid ${i}`,transform:"scaleY(0.0001)",opacity:0,transition:[`transform ${m} ${p}`,`opacity ${m} ${p}`].join(","),content:'""'},[`&${t}-item-danger`]:{"&::after":{borderInlineEndColor:I}}},[`${t}-selected, ${t}-item-selected`]:{"&::after":{transform:"scaleY(1)",opacity:1,transition:[`transform ${m} ${f}`,`opacity ${m} ${f}`].join(",")}}}}}},s0e=n=>{const{componentCls:e,itemHeight:t,itemMarginInline:r,padding:i,menuArrowSize:o,marginXS:s,itemMarginBlock:a,itemWidth:c,itemPaddingInline:l}=n,u=n.calc(o).add(i).add(s).equal();return{[`${e}-item`]:{position:"relative",overflow:"hidden"},[`${e}-item, ${e}-submenu-title`]:{height:t,lineHeight:Ct(t),paddingInline:l,overflow:"hidden",textOverflow:"ellipsis",marginInline:r,marginBlock:a,width:c},[`> ${e}-item,
            > ${e}-submenu > ${e}-submenu-title`]:{height:t,lineHeight:Ct(t)},[`${e}-item-group-list ${e}-submenu-title,
            ${e}-submenu-title`]:{paddingInlineEnd:u}}},Ywt=n=>{const{componentCls:e,iconCls:t,itemHeight:r,colorTextLightSolid:i,dropdownWidth:o,controlHeightLG:s,motionDurationMid:a,motionEaseOut:c,paddingXL:l,itemMarginInline:u,fontSizeLG:d,motionDurationSlow:h,paddingXS:f,boxShadowSecondary:p,collapsedWidth:g,collapsedIconSize:m}=n,v={height:r,lineHeight:Ct(r),listStylePosition:"inside",listStyleType:"disc"};return[{[e]:{"&-inline, &-vertical":Object.assign({[`&${e}-root`]:{boxShadow:"none"}},s0e(n))},[`${e}-submenu-popup`]:{[`${e}-vertical`]:Object.assign(Object.assign({},s0e(n)),{boxShadow:p})}},{[`${e}-submenu-popup ${e}-vertical${e}-sub`]:{minWidth:o,maxHeight:`calc(100vh - ${Ct(n.calc(s).mul(2.5).equal())})`,padding:"0",overflow:"hidden",borderInlineEnd:0,"&:not([class*='-active'])":{overflowX:"hidden",overflowY:"auto"}}},{[`${e}-inline`]:{width:"100%",[`&${e}-root`]:{[`${e}-item, ${e}-submenu-title`]:{display:"flex",alignItems:"center",transition:[`border-color ${h}`,`background ${h}`,`padding ${a} ${c}`].join(","),[`> ${e}-title-content`]:{flex:"auto",minWidth:0,overflow:"hidden",textOverflow:"ellipsis"},"> *":{flex:"none"}}},[`${e}-sub${e}-inline`]:{padding:0,border:0,borderRadius:0,boxShadow:"none",[`& > ${e}-submenu > ${e}-submenu-title`]:v,[`& ${e}-item-group-title`]:{paddingInlineStart:l}},[`${e}-item`]:v}},{[`${e}-inline-collapsed`]:{width:g,[`&${e}-root`]:{[`${e}-item, ${e}-submenu ${e}-submenu-title`]:{[`> ${e}-inline-collapsed-noicon`]:{fontSize:d,textAlign:"center"}}},[`> ${e}-item,
          > ${e}-item-group > ${e}-item-group-list > ${e}-item,
          > ${e}-item-group > ${e}-item-group-list > ${e}-submenu > ${e}-submenu-title,
          > ${e}-submenu > ${e}-submenu-title`]:{insetInlineStart:0,paddingInline:`calc(50% - ${Ct(n.calc(d).div(2).equal())} - ${Ct(u)})`,textOverflow:"clip",[`
            ${e}-submenu-arrow,
            ${e}-submenu-expand-icon
          `]:{opacity:0},[`${e}-item-icon, ${t}`]:{margin:0,fontSize:m,lineHeight:Ct(r),"+ span":{display:"inline-block",opacity:0}}},[`${e}-item-icon, ${t}`]:{display:"inline-block"},"&-tooltip":{pointerEvents:"none",[`${e}-item-icon, ${t}`]:{display:"none"},"a, a:hover":{color:i}},[`${e}-item-group-title`]:Object.assign(Object.assign({},y8),{paddingInline:f})}}]},a0e=n=>{const{componentCls:e,motionDurationSlow:t,motionDurationMid:r,motionEaseInOut:i,motionEaseOut:o,iconCls:s,iconSize:a,iconMarginInlineEnd:c}=n;return{[`${e}-item, ${e}-submenu-title`]:{position:"relative",display:"block",margin:0,whiteSpace:"nowrap",cursor:"pointer",transition:[`border-color ${t}`,`background ${t}`,`padding ${t} ${i}`].join(","),[`${e}-item-icon, ${s}`]:{minWidth:a,fontSize:a,transition:[`font-size ${r} ${o}`,`margin ${t} ${i}`,`color ${t}`].join(","),"+ span":{marginInlineStart:c,opacity:1,transition:[`opacity ${t} ${i}`,`margin ${t}`,`color ${t}`].join(",")}},[`${e}-item-icon`]:Object.assign({},W7()),[`&${e}-item-only-child`]:{[`> ${s}, > ${e}-item-icon`]:{marginInlineEnd:0}}},[`${e}-item-disabled, ${e}-submenu-disabled`]:{background:"none !important",cursor:"not-allowed","&::after":{borderColor:"transparent !important"},a:{color:"inherit !important"},[`> ${e}-submenu-title`]:{color:"inherit !important",cursor:"not-allowed"}}}},c0e=n=>{const{componentCls:e,motionDurationSlow:t,motionEaseInOut:r,borderRadius:i,menuArrowSize:o,menuArrowOffset:s}=n;return{[`${e}-submenu`]:{"&-expand-icon, &-arrow":{position:"absolute",top:"50%",insetInlineEnd:n.margin,width:o,color:"currentcolor",transform:"translateY(-50%)",transition:`transform ${t} ${r}, opacity ${t}`},"&-arrow":{"&::before, &::after":{position:"absolute",width:n.calc(o).mul(.6).equal(),height:n.calc(o).mul(.15).equal(),backgroundColor:"currentcolor",borderRadius:i,transition:[`background ${t} ${r}`,`transform ${t} ${r}`,`top ${t} ${r}`,`color ${t} ${r}`].join(","),content:'""'},"&::before":{transform:`rotate(45deg) translateY(${Ct(n.calc(s).mul(-1).equal())})`},"&::after":{transform:`rotate(-45deg) translateY(${Ct(s)})`}}}}},Jwt=n=>{const{antCls:e,componentCls:t,fontSize:r,motionDurationSlow:i,motionDurationMid:o,motionEaseInOut:s,paddingXS:a,padding:c,colorSplit:l,lineWidth:u,zIndexPopup:d,borderRadiusLG:h,subMenuItemBorderRadius:f,menuArrowSize:p,menuArrowOffset:g,lineType:m,groupTitleLineHeight:v,groupTitleFontSize:b}=n;return[{"":{[t]:Object.assign(Object.assign({},b8()),{"&-hidden":{display:"none"}})},[`${t}-submenu-hidden`]:{display:"none"}},{[t]:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},gc(n)),b8()),{marginBottom:0,paddingInlineStart:0,fontSize:r,lineHeight:0,listStyle:"none",outline:"none",transition:`width ${i} cubic-bezier(0.2, 0, 0, 1) 0s`,"ul, ol":{margin:0,padding:0,listStyle:"none"},"&-overflow":{display:"flex",[`${t}-item`]:{flex:"none"}},[`${t}-item, ${t}-submenu, ${t}-submenu-title`]:{borderRadius:n.itemBorderRadius},[`${t}-item-group-title`]:{padding:`${Ct(a)} ${Ct(c)}`,fontSize:b,lineHeight:v,transition:`all ${i}`},[`&-horizontal ${t}-submenu`]:{transition:[`border-color ${i} ${s}`,`background ${i} ${s}`].join(",")},[`${t}-submenu, ${t}-submenu-inline`]:{transition:[`border-color ${i} ${s}`,`background ${i} ${s}`,`padding ${o} ${s}`].join(",")},[`${t}-submenu ${t}-sub`]:{cursor:"initial",transition:[`background ${i} ${s}`,`padding ${i} ${s}`].join(",")},[`${t}-title-content`]:{transition:`color ${i}`,[`> ${e}-typography-ellipsis-single-line`]:{display:"inline",verticalAlign:"unset"}},[`${t}-item a`]:{"&::before":{position:"absolute",inset:0,backgroundColor:"transparent",content:'""'}},[`${t}-item-divider`]:{overflow:"hidden",lineHeight:0,borderColor:l,borderStyle:m,borderWidth:0,borderTopWidth:u,marginBlock:u,padding:0,"&-dashed":{borderStyle:"dashed"}}}),a0e(n)),{[`${t}-item-group`]:{[`${t}-item-group-list`]:{margin:0,padding:0,[`${t}-item, ${t}-submenu-title`]:{paddingInline:`${Ct(n.calc(r).mul(2).equal())} ${Ct(c)}`}}},"&-submenu":{"&-popup":{position:"absolute",zIndex:d,borderRadius:h,boxShadow:"none",transformOrigin:"0 0",[`&${t}-submenu`]:{background:"transparent"},"&::before":{position:"absolute",inset:0,zIndex:-1,width:"100%",height:"100%",opacity:0,content:'""'},[`> ${t}`]:Object.assign(Object.assign(Object.assign({borderRadius:h},a0e(n)),c0e(n)),{[`${t}-item, ${t}-submenu > ${t}-submenu-title`]:{borderRadius:f},[`${t}-submenu-title::after`]:{transition:`transform ${i} ${s}`}})},"\n          &-placement-leftTop,\n          &-placement-bottomRight,\n          ":{transformOrigin:"100% 0"},"\n          &-placement-leftBottom,\n          &-placement-topRight,\n          ":{transformOrigin:"100% 100%"},"\n          &-placement-rightBottom,\n          &-placement-topLeft,\n          ":{transformOrigin:"0 100%"},"\n          &-placement-bottomLeft,\n          &-placement-rightTop,\n          ":{transformOrigin:"0 0"},"\n          &-placement-leftTop,\n          &-placement-leftBottom\n          ":{paddingInlineEnd:n.paddingXS},"\n          &-placement-rightTop,\n          &-placement-rightBottom\n          ":{paddingInlineStart:n.paddingXS},"\n          &-placement-topRight,\n          &-placement-topLeft\n          ":{paddingBottom:n.paddingXS},"\n          &-placement-bottomRight,\n          &-placement-bottomLeft\n          ":{paddingTop:n.paddingXS}}}),c0e(n)),{[`&-inline-collapsed ${t}-submenu-arrow,
        &-inline ${t}-submenu-arrow`]:{"&::before":{transform:`rotate(-45deg) translateX(${Ct(g)})`},"&::after":{transform:`rotate(45deg) translateX(${Ct(n.calc(g).mul(-1).equal())})`}},[`${t}-submenu-open${t}-submenu-inline > ${t}-submenu-title > ${t}-submenu-arrow`]:{transform:`translateY(${Ct(n.calc(p).mul(.2).mul(-1).equal())})`,"&::after":{transform:`rotate(-45deg) translateX(${Ct(n.calc(g).mul(-1).equal())})`},"&::before":{transform:`rotate(45deg) translateX(${Ct(g)})`}}})},{[`${e}-layout-header`]:{[t]:{lineHeight:"inherit"}}}]},Qwt=n=>{var e,t,r;const{colorPrimary:i,colorError:o,colorTextDisabled:s,colorErrorBg:a,colorText:c,colorTextDescription:l,colorBgContainer:u,colorFillAlter:d,colorFillContent:h,lineWidth:f,lineWidthBold:p,controlItemBgActive:g,colorBgTextHover:m,controlHeightLG:v,lineHeight:b,colorBgElevated:S,marginXXS:E,padding:w,fontSize:C,controlHeightSM:I,fontSizeLG:T,colorTextLightSolid:D,colorErrorHover:O}=n,M=(e=n.activeBarWidth)!==null&&e!==void 0?e:0,R=(t=n.activeBarBorderWidth)!==null&&t!==void 0?t:f,A=(r=n.itemMarginInline)!==null&&r!==void 0?r:n.marginXXS,k=new Fa(D).setAlpha(.65).toRgbString();return{dropdownWidth:160,zIndexPopup:n.zIndexPopupBase+50,radiusItem:n.borderRadiusLG,itemBorderRadius:n.borderRadiusLG,radiusSubMenuItem:n.borderRadiusSM,subMenuItemBorderRadius:n.borderRadiusSM,colorItemText:c,itemColor:c,colorItemTextHover:c,itemHoverColor:c,colorItemTextHoverHorizontal:i,horizontalItemHoverColor:i,colorGroupTitle:l,groupTitleColor:l,colorItemTextSelected:i,itemSelectedColor:i,colorItemTextSelectedHorizontal:i,horizontalItemSelectedColor:i,colorItemBg:u,itemBg:u,colorItemBgHover:m,itemHoverBg:m,colorItemBgActive:h,itemActiveBg:g,colorSubItemBg:d,subMenuItemBg:d,colorItemBgSelected:g,itemSelectedBg:g,colorItemBgSelectedHorizontal:"transparent",horizontalItemSelectedBg:"transparent",colorActiveBarWidth:0,activeBarWidth:M,colorActiveBarHeight:p,activeBarHeight:p,colorActiveBarBorderSize:f,activeBarBorderWidth:R,colorItemTextDisabled:s,itemDisabledColor:s,colorDangerItemText:o,dangerItemColor:o,colorDangerItemTextHover:o,dangerItemHoverColor:o,colorDangerItemTextSelected:o,dangerItemSelectedColor:o,colorDangerItemBgActive:a,dangerItemActiveBg:a,colorDangerItemBgSelected:a,dangerItemSelectedBg:a,itemMarginInline:A,horizontalItemBorderRadius:0,horizontalItemHoverBg:"transparent",itemHeight:v,groupTitleLineHeight:b,collapsedWidth:v*2,popupBg:S,itemMarginBlock:E,itemPaddingInline:w,horizontalLineHeight:`${v*1.15}px`,iconSize:C,iconMarginInlineEnd:I-C,collapsedIconSize:T,groupTitleFontSize:C,darkItemDisabledColor:new Fa(D).setAlpha(.25).toRgbString(),darkItemColor:k,darkDangerItemColor:o,darkItemBg:"#001529",darkPopupBg:"#001529",darkSubMenuItemBg:"#000c17",darkItemSelectedColor:D,darkItemSelectedBg:i,darkDangerItemSelectedBg:o,darkItemHoverBg:"transparent",darkGroupTitleColor:k,darkItemHoverColor:D,darkDangerItemHoverColor:O,darkDangerItemSelectedColor:D,darkDangerItemActiveBg:o,itemWidth:M?`calc(100% + ${R}px)`:`calc(100% - ${A*2}px)`}},eCt=function(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:n,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;return Jc("Menu",i=>{const{colorBgElevated:o,controlHeightLG:s,fontSize:a,darkItemColor:c,darkDangerItemColor:l,darkItemBg:u,darkSubMenuItemBg:d,darkItemSelectedColor:h,darkItemSelectedBg:f,darkDangerItemSelectedBg:p,darkItemHoverBg:g,darkGroupTitleColor:m,darkItemHoverColor:v,darkItemDisabledColor:b,darkDangerItemHoverColor:S,darkDangerItemSelectedColor:E,darkDangerItemActiveBg:w,popupBg:C,darkPopupBg:I}=i,T=i.calc(a).div(7).mul(5).equal(),D=oo(i,{menuArrowSize:T,menuHorizontalHeight:i.calc(s).mul(1.15).equal(),menuArrowOffset:i.calc(T).mul(.25).equal(),menuSubMenuBg:o,calc:i.calc,popupBg:C}),O=oo(D,{itemColor:c,itemHoverColor:v,groupTitleColor:m,itemSelectedColor:h,itemBg:u,popupBg:I,subMenuItemBg:d,itemActiveBg:"transparent",itemSelectedBg:f,activeBarHeight:0,activeBarBorderWidth:0,itemHoverBg:g,itemDisabledColor:b,dangerItemColor:l,dangerItemHoverColor:S,dangerItemSelectedColor:E,dangerItemActiveBg:w,dangerItemSelectedBg:p,menuSubMenuBg:d,horizontalItemSelectedColor:h,horizontalItemSelectedBg:f});return[Jwt(D),Zwt(D),Ywt(D),o0e(D,"light"),o0e(O,"dark"),Xwt(D),A4e(D),Q2(D,"slide-up"),Q2(D,"slide-down"),tN(D,"zoom-big")]},Qwt,{deprecatedTokens:[["colorGroupTitle","groupTitleColor"],["radiusItem","itemBorderRadius"],["radiusSubMenuItem","subMenuItemBorderRadius"],["colorItemText","itemColor"],["colorItemTextHover","itemHoverColor"],["colorItemTextHoverHorizontal","horizontalItemHoverColor"],["colorItemTextSelected","itemSelectedColor"],["colorItemTextSelectedHorizontal","horizontalItemSelectedColor"],["colorItemTextDisabled","itemDisabledColor"],["colorDangerItemText","dangerItemColor"],["colorDangerItemTextHover","dangerItemHoverColor"],["colorDangerItemTextSelected","dangerItemSelectedColor"],["colorDangerItemBgActive","dangerItemActiveBg"],["colorDangerItemBgSelected","dangerItemSelectedBg"],["colorItemBg","itemBg"],["colorItemBgHover","itemHoverBg"],["colorSubItemBg","subMenuItemBg"],["colorItemBgActive","itemActiveBg"],["colorItemBgSelectedHorizontal","horizontalItemSelectedBg"],["colorActiveBarWidth","activeBarWidth"],["colorActiveBarHeight","activeBarHeight"],["colorActiveBarBorderSize","activeBarBorderWidth"],["colorItemBgSelected","itemSelectedBg"]],injectStyle:t,unitless:{groupTitleLineHeight:!0}})(n,e)},LOe=n=>{var e;const{popupClassName:t,icon:r,title:i,theme:o}=n,s=y.useContext(T8),{prefixCls:a,inlineCollapsed:c,theme:l}=s,u=aE();let d;if(!r)d=c&&!u.length&&i&&typeof i=="string"?y.createElement("div",{className:`${a}-inline-collapsed-noicon`},i.charAt(0)):y.createElement("span",{className:`${a}-title-content`},i);else{const p=y.isValidElement(i)&&i.type==="span";d=y.createElement(y.Fragment,null,gg(r,{className:Ue(y.isValidElement(r)?(e=r.props)===null||e===void 0?void 0:e.className:"",`${a}-item-icon`)}),p?i:y.createElement("span",{className:`${a}-title-content`},i))}const h=y.useMemo(()=>Object.assign(Object.assign({},s),{firstLevel:!1}),[s]),[f]=pD("Menu");return y.createElement(T8.Provider,{value:h},y.createElement(aN,Object.assign({},Yc(n,["icon"]),{title:d,popupClassName:Ue(a,t,`${a}-${o||l}`),popupStyle:{zIndex:f}})))};var tCt=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t};function UH(n){return n===null||n===!1}const nCt={item:$Oe,submenu:LOe,divider:MOe},rCt=y.forwardRef((n,e)=>{var t;const r=y.useContext(D8),i=r||{},{getPrefixCls:o,getPopupContainer:s,direction:a,menu:c}=y.useContext(fr),l=o(),{prefixCls:u,className:d,style:h,theme:f="light",expandIcon:p,_internalDisableMenuItemTitleTooltip:g,inlineCollapsed:m,siderCollapsed:v,rootClassName:b,mode:S,selectable:E,onClick:w,overflowedIndicatorPopupClassName:C}=n,I=tCt(n,["prefixCls","className","style","theme","expandIcon","_internalDisableMenuItemTitleTooltip","inlineCollapsed","siderCollapsed","rootClassName","mode","selectable","onClick","overflowedIndicatorPopupClassName"]),T=Yc(I,["collapsedWidth"]);(t=i.validator)===null||t===void 0||t.call(i,{mode:S});const D=ea(function(){var G;w==null||w.apply(void 0,arguments),(G=i.onClick)===null||G===void 0||G.call(i)}),O=i.mode||S,M=E??i.selectable,R=y.useMemo(()=>v!==void 0?v:m,[m,v]),A={horizontal:{motionName:`${l}-slide-up`},inline:eZ(l),other:{motionName:`${l}-zoom-big`}},k=o("menu",u||i.prefixCls),L=Qc(k),[j,N,B]=eCt(k,L,!r),U=Ue(`${k}-${f}`,c==null?void 0:c.className,d),K=y.useMemo(()=>{var G,te;if(typeof p=="function"||UH(p))return p||null;if(typeof i.expandIcon=="function"||UH(i.expandIcon))return i.expandIcon||null;if(typeof(c==null?void 0:c.expandIcon)=="function"||UH(c==null?void 0:c.expandIcon))return(c==null?void 0:c.expandIcon)||null;const ie=(G=p??(i==null?void 0:i.expandIcon))!==null&&G!==void 0?G:c==null?void 0:c.expandIcon;return gg(ie,{className:Ue(`${k}-submenu-expand-icon`,y.isValidElement(ie)?(te=ie.props)===null||te===void 0?void 0:te.className:void 0)})},[p,i==null?void 0:i.expandIcon,c==null?void 0:c.expandIcon,k]),z=y.useMemo(()=>({prefixCls:k,inlineCollapsed:R||!1,direction:a,firstLevel:!0,theme:f,mode:O,disableMenuItemTitleTooltip:g}),[k,R,a,g,f]);return j(y.createElement(D8.Provider,{value:null},y.createElement(T8.Provider,{value:z},y.createElement(_D,Object.assign({getPopupContainer:s,overflowedIndicator:y.createElement(OOe,null),overflowedIndicatorPopupClassName:Ue(k,`${k}-${f}`,C),mode:O,selectable:M,onClick:D},T,{inlineCollapsed:R,style:Object.assign(Object.assign({},c==null?void 0:c.style),h),className:U,prefixCls:k,direction:a,defaultMotions:A,expandIcon:K,ref:e,rootClassName:Ue(b,N,i.rootClassName,B,L),_internalComponents:nCt})))))}),wD=y.forwardRef((n,e)=>{const t=y.useRef(null),r=y.useContext(AOe);return y.useImperativeHandle(e,()=>({menu:t.current,focus:i=>{var o;(o=t.current)===null||o===void 0||o.focus(i)}})),y.createElement(rCt,Object.assign({ref:t},n,r))});wD.Item=$Oe;wD.SubMenu=LOe;wD.Divider=MOe;wD.ItemGroup=gre;const iCt=n=>{const{componentCls:e,menuCls:t,colorError:r,colorTextLightSolid:i}=n,o=`${t}-item`;return{[`${e}, ${e}-menu-submenu`]:{[`${t} ${o}`]:{[`&${o}-danger:not(${o}-disabled)`]:{color:r,"&:hover":{color:i,backgroundColor:r}}}}}},oCt=n=>{const{componentCls:e,menuCls:t,zIndexPopup:r,dropdownArrowDistance:i,sizePopupArrow:o,antCls:s,iconCls:a,motionDurationMid:c,paddingBlock:l,fontSize:u,dropdownEdgeChildPadding:d,colorTextDisabled:h,fontSizeIcon:f,controlPaddingHorizontal:p,colorBgElevated:g}=n;return[{[e]:{position:"absolute",top:-9999,left:{_skip_check_:!0,value:-9999},zIndex:r,display:"block","&::before":{position:"absolute",insetBlock:n.calc(o).div(2).sub(i).equal(),zIndex:-9999,opacity:1e-4,content:'""'},[`&-trigger${s}-btn`]:{[`& > ${a}-down, & > ${s}-btn-icon > ${a}-down`]:{fontSize:f}},[`${e}-wrap`]:{position:"relative",[`${s}-btn > ${a}-down`]:{fontSize:f},[`${a}-down::before`]:{transition:`transform ${c}`}},[`${e}-wrap-open`]:{[`${a}-down::before`]:{transform:"rotate(180deg)"}},"\n        &-hidden,\n        &-menu-hidden,\n        &-menu-submenu-hidden\n      ":{display:"none"},[`&${s}-slide-down-enter${s}-slide-down-enter-active${e}-placement-bottomLeft,
          &${s}-slide-down-appear${s}-slide-down-appear-active${e}-placement-bottomLeft,
          &${s}-slide-down-enter${s}-slide-down-enter-active${e}-placement-bottom,
          &${s}-slide-down-appear${s}-slide-down-appear-active${e}-placement-bottom,
          &${s}-slide-down-enter${s}-slide-down-enter-active${e}-placement-bottomRight,
          &${s}-slide-down-appear${s}-slide-down-appear-active${e}-placement-bottomRight`]:{animationName:Jne},[`&${s}-slide-up-enter${s}-slide-up-enter-active${e}-placement-topLeft,
          &${s}-slide-up-appear${s}-slide-up-appear-active${e}-placement-topLeft,
          &${s}-slide-up-enter${s}-slide-up-enter-active${e}-placement-top,
          &${s}-slide-up-appear${s}-slide-up-appear-active${e}-placement-top,
          &${s}-slide-up-enter${s}-slide-up-enter-active${e}-placement-topRight,
          &${s}-slide-up-appear${s}-slide-up-appear-active${e}-placement-topRight`]:{animationName:ere},[`&${s}-slide-down-leave${s}-slide-down-leave-active${e}-placement-bottomLeft,
          &${s}-slide-down-leave${s}-slide-down-leave-active${e}-placement-bottom,
          &${s}-slide-down-leave${s}-slide-down-leave-active${e}-placement-bottomRight`]:{animationName:Qne},[`&${s}-slide-up-leave${s}-slide-up-leave-active${e}-placement-topLeft,
          &${s}-slide-up-leave${s}-slide-up-leave-active${e}-placement-top,
          &${s}-slide-up-leave${s}-slide-up-leave-active${e}-placement-topRight`]:{animationName:tre}}},vOe(n,g,{arrowPlacement:{top:!0,bottom:!0}}),{[`${e} ${t}`]:{position:"relative",margin:0},[`${t}-submenu-popup`]:{position:"absolute",zIndex:r,background:"transparent",boxShadow:"none",transformOrigin:"0 0","ul, li":{listStyle:"none",margin:0}},[`${e}, ${e}-menu-submenu`]:Object.assign(Object.assign({},gc(n)),{[t]:Object.assign(Object.assign({padding:d,listStyleType:"none",backgroundColor:g,backgroundClip:"padding-box",borderRadius:n.borderRadiusLG,outline:"none",boxShadow:n.boxShadowSecondary},S8(n)),{"&:empty":{padding:0,boxShadow:"none"},[`${t}-item-group-title`]:{padding:`${Ct(l)} ${Ct(p)}`,color:n.colorTextDescription,transition:`all ${c}`},[`${t}-item`]:{position:"relative",display:"flex",alignItems:"center",whiteSpace:"nowrap"},[`${t}-item-icon`]:{minWidth:u,marginInlineEnd:n.marginXS,fontSize:n.fontSizeSM},[`${t}-title-content`]:{flex:"auto","> a":{color:"inherit",transition:`all ${c}`,"&:hover":{color:"inherit"},"&::after":{position:"absolute",inset:0,content:'""'}}},[`${t}-item, ${t}-submenu-title`]:Object.assign(Object.assign({clear:"both",margin:0,padding:`${Ct(l)} ${Ct(p)}`,color:n.colorText,fontWeight:"normal",fontSize:u,lineHeight:n.lineHeight,cursor:"pointer",transition:`all ${c}`,borderRadius:n.borderRadiusSM,"&:hover, &-active":{backgroundColor:n.controlItemBgHover}},S8(n)),{"&-selected":{color:n.colorPrimary,backgroundColor:n.controlItemBgActive,"&:hover, &-active":{backgroundColor:n.controlItemBgActiveHover}},"&-disabled":{color:h,cursor:"not-allowed","&:hover":{color:h,backgroundColor:g,cursor:"not-allowed"},a:{pointerEvents:"none"}},"&-divider":{height:1,margin:`${Ct(n.marginXXS)} 0`,overflow:"hidden",lineHeight:0,backgroundColor:n.colorSplit},[`${e}-menu-submenu-expand-icon`]:{position:"absolute",insetInlineEnd:n.paddingXS,[`${e}-menu-submenu-arrow-icon`]:{marginInlineEnd:"0 !important",color:n.colorTextDescription,fontSize:f,fontStyle:"normal"}}}),[`${t}-item-group-list`]:{margin:`0 ${Ct(n.marginXS)}`,padding:0,listStyle:"none"},[`${t}-submenu-title`]:{paddingInlineEnd:n.calc(p).add(n.fontSizeSM).equal()},[`${t}-submenu-vertical`]:{position:"relative"},[`${t}-submenu${t}-submenu-disabled ${e}-menu-submenu-title`]:{[`&, ${e}-menu-submenu-arrow-icon`]:{color:h,backgroundColor:g,cursor:"not-allowed"}},[`${t}-submenu-selected ${e}-menu-submenu-title`]:{color:n.colorPrimary}})})},[Q2(n,"slide-up"),Q2(n,"slide-down"),E8(n,"move-up"),E8(n,"move-down"),tN(n,"zoom-big")]]},sCt=n=>Object.assign(Object.assign({zIndexPopup:n.zIndexPopupBase+50,paddingBlock:(n.controlHeight-n.fontSize*n.lineHeight)/2},cre({contentRadius:n.borderRadiusLG,limitVerticalRadius:!0})),gOe(n)),aCt=Jc("Dropdown",n=>{const{marginXXS:e,sizePopupArrow:t,paddingXXS:r,componentCls:i}=n,o=oo(n,{menuCls:`${i}-menu`,dropdownArrowDistance:n.calc(t).div(2).add(e).equal(),dropdownEdgeChildPadding:r});return[oCt(o),iCt(o)]},sCt,{resetStyle:!1}),cN=n=>{var e;const{menu:t,arrow:r,prefixCls:i,children:o,trigger:s,disabled:a,dropdownRender:c,getPopupContainer:l,overlayClassName:u,rootClassName:d,overlayStyle:h,open:f,onOpenChange:p,visible:g,onVisibleChange:m,mouseEnterDelay:v=.15,mouseLeaveDelay:b=.1,autoAdjustOverflow:S=!0,placement:E="",overlay:w,transitionName:C}=n,{getPopupContainer:I,getPrefixCls:T,direction:D,dropdown:O}=y.useContext(fr);lD();const M=y.useMemo(()=>{const ye=T();return C!==void 0?C:E.includes("top")?`${ye}-slide-down`:`${ye}-slide-up`},[T,E,C]),R=y.useMemo(()=>E?E.includes("Center")?E.slice(0,E.indexOf("Center")):E:D==="rtl"?"bottomRight":"bottomLeft",[E,D]),A=T("dropdown",i),k=Qc(A),[L,j,N]=aCt(A,k),[,B]=Gu(),U=y.Children.only(o),K=gg(U,{className:Ue(`${A}-trigger`,{[`${A}-rtl`]:D==="rtl"},U.props.className),disabled:(e=U.props.disabled)!==null&&e!==void 0?e:a}),z=a?[]:s,G=!!(z!=null&&z.includes("contextMenu")),[te,ie]=Ql(!1,{value:f??g}),Q=ea(ye=>{p==null||p(ye,{source:"trigger"}),m==null||m(ye),ie(ye)}),ge=Ue(u,d,j,N,k,O==null?void 0:O.className,{[`${A}-rtl`]:D==="rtl"}),_e=yOe({arrowPointAtCenter:typeof r=="object"&&r.pointAtCenter,autoAdjustOverflow:S,offset:B.marginXXS,arrowWidth:r?B.sizePopupArrow:0,borderRadius:B.borderRadius}),Se=y.useCallback(()=>{t!=null&&t.selectable&&(t!=null&&t.multiple)||(p==null||p(!1,{source:"menu"}),ie(!1))},[t==null?void 0:t.selectable,t==null?void 0:t.multiple]),se=()=>{let ye;return t!=null&&t.items?ye=y.createElement(wD,Object.assign({},t)):typeof w=="function"?ye=w():ye=w,c&&(ye=c(ye)),ye=y.Children.only(typeof ye=="string"?y.createElement("span",null,ye):ye),y.createElement(Gwt,{prefixCls:`${A}-menu`,rootClassName:Ue(N,k),expandIcon:y.createElement("span",{className:`${A}-menu-submenu-arrow`},y.createElement(ewt,{className:`${A}-menu-submenu-arrow-icon`})),mode:"vertical",selectable:!1,onClick:Se,validator:V=>{}},ye)},[ee,Y]=pD("Dropdown",h==null?void 0:h.zIndex);let ue=y.createElement(cwt,Object.assign({alignPoint:G},Yc(n,["rootClassName"]),{mouseEnterDelay:v,mouseLeaveDelay:b,visible:te,builtinPlacements:_e,arrow:!!r,overlayClassName:ge,prefixCls:A,getPopupContainer:l||I,transitionName:M,trigger:z,overlay:se,placement:R,onVisibleChange:Q,overlayStyle:Object.assign(Object.assign(Object.assign({},O==null?void 0:O.style),h),{zIndex:ee})}),K);return ee&&(ue=y.createElement(K7.Provider,{value:Y},ue)),L(ue)};function cCt(n){return Object.assign(Object.assign({},n),{align:{overflow:{adjustX:!1,adjustY:!1}}})}const lCt=K4e(cN,"dropdown",n=>n,cCt),uCt=n=>y.createElement(lCt,Object.assign({},n),y.createElement("span",null));cN._InternalPanelDoNotUseOrYouWillBeFired=uCt;const NOe=y.createContext(null),dCt=NOe.Provider,FOe=y.createContext(null),hCt=FOe.Provider;var fCt=["prefixCls","className","style","checked","disabled","defaultChecked","type","title","onChange"],jOe=y.forwardRef(function(n,e){var t=n.prefixCls,r=t===void 0?"rc-checkbox":t,i=n.className,o=n.style,s=n.checked,a=n.disabled,c=n.defaultChecked,l=c===void 0?!1:c,u=n.type,d=u===void 0?"checkbox":u,h=n.title,f=n.onChange,p=jr(n,fCt),g=y.useRef(null),m=y.useRef(null),v=Ql(l,{value:s}),b=rt(v,2),S=b[0],E=b[1];y.useImperativeHandle(e,function(){return{focus:function(T){var D;(D=g.current)===null||D===void 0||D.focus(T)},blur:function(){var T;(T=g.current)===null||T===void 0||T.blur()},input:g.current,nativeElement:m.current}});var w=Ue(r,i,Le(Le({},"".concat(r,"-checked"),S),"".concat(r,"-disabled"),a)),C=function(T){a||("checked"in n||E(T.target.checked),f==null||f({target:$e($e({},n),{},{type:d,checked:T.target.checked}),stopPropagation:function(){T.stopPropagation()},preventDefault:function(){T.preventDefault()},nativeEvent:T.nativeEvent}))};return y.createElement("span",{className:w,title:h,style:o,ref:m},y.createElement("input",ln({},p,{className:"".concat(r,"-input"),ref:g,onChange:C,disabled:a,checked:!!S,type:d})),y.createElement("span",{className:"".concat(r,"-inner")}))});const pCt=n=>{const{componentCls:e,antCls:t}=n,r=`${e}-group`;return{[r]:Object.assign(Object.assign({},gc(n)),{display:"inline-block",fontSize:0,[`&${r}-rtl`]:{direction:"rtl"},[`${t}-badge ${t}-badge-count`]:{zIndex:1},[`> ${t}-badge:not(:first-child) > ${t}-button-wrapper`]:{borderInlineStart:"none"}})}},gCt=n=>{const{componentCls:e,wrapperMarginInlineEnd:t,colorPrimary:r,radioSize:i,motionDurationSlow:o,motionDurationMid:s,motionEaseInOutCirc:a,colorBgContainer:c,colorBorder:l,lineWidth:u,colorBgContainerDisabled:d,colorTextDisabled:h,paddingXS:f,dotColorDisabled:p,lineType:g,radioColor:m,radioBgColor:v,calc:b}=n,S=`${e}-inner`,w=b(i).sub(b(4).mul(2)),C=b(1).mul(i).equal({unit:!0});return{[`${e}-wrapper`]:Object.assign(Object.assign({},gc(n)),{display:"inline-flex",alignItems:"baseline",marginInlineStart:0,marginInlineEnd:t,cursor:"pointer",[`&${e}-wrapper-rtl`]:{direction:"rtl"},"&-disabled":{cursor:"not-allowed",color:n.colorTextDisabled},"&::after":{display:"inline-block",width:0,overflow:"hidden",content:'"\\a0"'},[`${e}-checked::after`]:{position:"absolute",insetBlockStart:0,insetInlineStart:0,width:"100%",height:"100%",border:`${Ct(u)} ${g} ${r}`,borderRadius:"50%",visibility:"hidden",opacity:0,content:'""'},[e]:Object.assign(Object.assign({},gc(n)),{position:"relative",display:"inline-block",outline:"none",cursor:"pointer",alignSelf:"center",borderRadius:"50%"}),[`${e}-wrapper:hover &,
        &:hover ${S}`]:{borderColor:r},[`${e}-input:focus-visible + ${S}`]:Object.assign({},dD(n)),[`${e}:hover::after, ${e}-wrapper:hover &::after`]:{visibility:"visible"},[`${e}-inner`]:{"&::after":{boxSizing:"border-box",position:"absolute",insetBlockStart:"50%",insetInlineStart:"50%",display:"block",width:C,height:C,marginBlockStart:b(1).mul(i).div(-2).equal({unit:!0}),marginInlineStart:b(1).mul(i).div(-2).equal({unit:!0}),backgroundColor:m,borderBlockStart:0,borderInlineStart:0,borderRadius:C,transform:"scale(0)",opacity:0,transition:`all ${o} ${a}`,content:'""'},boxSizing:"border-box",position:"relative",insetBlockStart:0,insetInlineStart:0,display:"block",width:C,height:C,backgroundColor:c,borderColor:l,borderStyle:"solid",borderWidth:u,borderRadius:"50%",transition:`all ${s}`},[`${e}-input`]:{position:"absolute",inset:0,zIndex:1,cursor:"pointer",opacity:0},[`${e}-checked`]:{[S]:{borderColor:r,backgroundColor:v,"&::after":{transform:`scale(${n.calc(n.dotSize).div(i).equal()})`,opacity:1,transition:`all ${o} ${a}`}}},[`${e}-disabled`]:{cursor:"not-allowed",[S]:{backgroundColor:d,borderColor:l,cursor:"not-allowed","&::after":{backgroundColor:p}},[`${e}-input`]:{cursor:"not-allowed"},[`${e}-disabled + span`]:{color:h,cursor:"not-allowed"},[`&${e}-checked`]:{[S]:{"&::after":{transform:`scale(${b(w).div(i).equal()})`}}}},[`span${e} + *`]:{paddingInlineStart:f,paddingInlineEnd:f}})}},mCt=n=>{const{buttonColor:e,controlHeight:t,componentCls:r,lineWidth:i,lineType:o,colorBorder:s,motionDurationSlow:a,motionDurationMid:c,buttonPaddingInline:l,fontSize:u,buttonBg:d,fontSizeLG:h,controlHeightLG:f,controlHeightSM:p,paddingXS:g,borderRadius:m,borderRadiusSM:v,borderRadiusLG:b,buttonCheckedBg:S,buttonSolidCheckedColor:E,colorTextDisabled:w,colorBgContainerDisabled:C,buttonCheckedBgDisabled:I,buttonCheckedColorDisabled:T,colorPrimary:D,colorPrimaryHover:O,colorPrimaryActive:M,buttonSolidCheckedBg:R,buttonSolidCheckedHoverBg:A,buttonSolidCheckedActiveBg:k,calc:L}=n;return{[`${r}-button-wrapper`]:{position:"relative",display:"inline-block",height:t,margin:0,paddingInline:l,paddingBlock:0,color:e,fontSize:u,lineHeight:Ct(L(t).sub(L(i).mul(2)).equal()),background:d,border:`${Ct(i)} ${o} ${s}`,borderBlockStartWidth:L(i).add(.02).equal(),borderInlineStartWidth:0,borderInlineEndWidth:i,cursor:"pointer",transition:[`color ${c}`,`background ${c}`,`box-shadow ${c}`].join(","),a:{color:e},[`> ${r}-button`]:{position:"absolute",insetBlockStart:0,insetInlineStart:0,zIndex:-1,width:"100%",height:"100%"},"&:not(:first-child)":{"&::before":{position:"absolute",insetBlockStart:L(i).mul(-1).equal(),insetInlineStart:L(i).mul(-1).equal(),display:"block",boxSizing:"content-box",width:1,height:"100%",paddingBlock:i,paddingInline:0,backgroundColor:s,transition:`background-color ${a}`,content:'""'}},"&:first-child":{borderInlineStart:`${Ct(i)} ${o} ${s}`,borderStartStartRadius:m,borderEndStartRadius:m},"&:last-child":{borderStartEndRadius:m,borderEndEndRadius:m},"&:first-child:last-child":{borderRadius:m},[`${r}-group-large &`]:{height:f,fontSize:h,lineHeight:Ct(L(f).sub(L(i).mul(2)).equal()),"&:first-child":{borderStartStartRadius:b,borderEndStartRadius:b},"&:last-child":{borderStartEndRadius:b,borderEndEndRadius:b}},[`${r}-group-small &`]:{height:p,paddingInline:L(g).sub(i).equal(),paddingBlock:0,lineHeight:Ct(L(p).sub(L(i).mul(2)).equal()),"&:first-child":{borderStartStartRadius:v,borderEndStartRadius:v},"&:last-child":{borderStartEndRadius:v,borderEndEndRadius:v}},"&:hover":{position:"relative",color:D},"&:has(:focus-visible)":Object.assign({},dD(n)),[`${r}-inner, input[type='checkbox'], input[type='radio']`]:{width:0,height:0,opacity:0,pointerEvents:"none"},[`&-checked:not(${r}-button-wrapper-disabled)`]:{zIndex:1,color:D,background:S,borderColor:D,"&::before":{backgroundColor:D},"&:first-child":{borderColor:D},"&:hover":{color:O,borderColor:O,"&::before":{backgroundColor:O}},"&:active":{color:M,borderColor:M,"&::before":{backgroundColor:M}}},[`${r}-group-solid &-checked:not(${r}-button-wrapper-disabled)`]:{color:E,background:R,borderColor:R,"&:hover":{color:E,background:A,borderColor:A},"&:active":{color:E,background:k,borderColor:k}},"&-disabled":{color:w,backgroundColor:C,borderColor:s,cursor:"not-allowed","&:first-child, &:hover":{color:w,backgroundColor:C,borderColor:s}},[`&-disabled${r}-button-wrapper-checked`]:{color:T,backgroundColor:I,borderColor:s,boxShadow:"none"}}}},vCt=n=>{const{wireframe:e,padding:t,marginXS:r,lineWidth:i,fontSizeLG:o,colorText:s,colorBgContainer:a,colorTextDisabled:c,controlItemBgActiveDisabled:l,colorTextLightSolid:u,colorPrimary:d,colorPrimaryHover:h,colorPrimaryActive:f,colorWhite:p}=n,g=4,m=o,v=e?m-g*2:m-(g+i)*2;return{radioSize:m,dotSize:v,dotColorDisabled:c,buttonSolidCheckedColor:u,buttonSolidCheckedBg:d,buttonSolidCheckedHoverBg:h,buttonSolidCheckedActiveBg:f,buttonBg:a,buttonCheckedBg:a,buttonColor:s,buttonCheckedBgDisabled:l,buttonCheckedColorDisabled:c,buttonPaddingInline:t-i,wrapperMarginInlineEnd:r,radioColor:e?d:p,radioBgColor:e?a:d}},BOe=Jc("Radio",n=>{const{controlOutline:e,controlOutlineWidth:t}=n,r=`0 0 0 ${Ct(t)} ${e}`,o=oo(n,{radioFocusShadow:r,radioButtonFocusShadow:r});return[pCt(o),gCt(o),mCt(o)]},vCt,{unitless:{radioSize:!0,dotSize:!0}});var yCt=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t};const bCt=(n,e)=>{var t,r;const i=y.useContext(NOe),o=y.useContext(FOe),{getPrefixCls:s,direction:a,radio:c}=y.useContext(fr),l=y.useRef(null),u=Gd(e,l),{isFormItemInput:d}=y.useContext(nu),h=k=>{var L,j;(L=n.onChange)===null||L===void 0||L.call(n,k),(j=i==null?void 0:i.onChange)===null||j===void 0||j.call(i,k)},{prefixCls:f,className:p,rootClassName:g,children:m,style:v,title:b}=n,S=yCt(n,["prefixCls","className","rootClassName","children","style","title"]),E=s("radio",f),w=((i==null?void 0:i.optionType)||o)==="button",C=w?`${E}-button`:E,I=Qc(E),[T,D,O]=BOe(E,I),M=Object.assign({},S),R=y.useContext(fg);i&&(M.name=i.name,M.onChange=h,M.checked=n.value===i.value,M.disabled=(t=M.disabled)!==null&&t!==void 0?t:i.disabled),M.disabled=(r=M.disabled)!==null&&r!==void 0?r:R;const A=Ue(`${C}-wrapper`,{[`${C}-wrapper-checked`]:M.checked,[`${C}-wrapper-disabled`]:M.disabled,[`${C}-wrapper-rtl`]:a==="rtl",[`${C}-wrapper-in-form-item`]:d},c==null?void 0:c.className,p,g,D,O,I);return T(y.createElement(zne,{component:"Radio",disabled:M.disabled},y.createElement("label",{className:A,style:Object.assign(Object.assign({},c==null?void 0:c.style),v),onMouseEnter:n.onMouseEnter,onMouseLeave:n.onMouseLeave,title:b},y.createElement(jOe,Object.assign({},M,{className:Ue(M.className,{[X7]:!w}),type:"radio",prefixCls:C,ref:u})),m!==void 0?y.createElement("span",null,m):null)))},R8=y.forwardRef(bCt),SCt=y.forwardRef((n,e)=>{const{getPrefixCls:t,direction:r}=y.useContext(fr),[i,o]=Ql(n.defaultValue,{value:n.value}),s=k=>{const L=i,j=k.target.value;"value"in n||o(j);const{onChange:N}=n;N&&j!==L&&N(k)},{prefixCls:a,className:c,rootClassName:l,options:u,buttonStyle:d="outline",disabled:h,children:f,size:p,style:g,id:m,onMouseEnter:v,onMouseLeave:b,onFocus:S,onBlur:E}=n,w=t("radio",a),C=`${w}-group`,I=Qc(w),[T,D,O]=BOe(w,I);let M=f;u&&u.length>0&&(M=u.map(k=>typeof k=="string"||typeof k=="number"?y.createElement(R8,{key:k.toString(),prefixCls:w,disabled:h,value:k,checked:i===k},k):y.createElement(R8,{key:`radio-group-value-options-${k.value}`,prefixCls:w,disabled:k.disabled||h,value:k.value,checked:i===k.value,title:k.title,style:k.style,id:k.id,required:k.required},k.label)));const R=_v(p),A=Ue(C,`${C}-${d}`,{[`${C}-${R}`]:R,[`${C}-rtl`]:r==="rtl"},c,l,D,O,I);return T(y.createElement("div",Object.assign({},pg(n,{aria:!0,data:!0}),{className:A,style:g,onMouseEnter:v,onMouseLeave:b,onFocus:S,onBlur:E,id:m,ref:e}),y.createElement(dCt,{value:{onChange:s,value:i,disabled:n.disabled,name:n.name,optionType:n.optionType}},M)))}),_Ct=y.memo(SCt);var wCt=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t};const CCt=(n,e)=>{const{getPrefixCls:t}=y.useContext(fr),{prefixCls:r}=n,i=wCt(n,["prefixCls"]),o=t("radio",r);return y.createElement(hCt,{value:"button"},y.createElement(R8,Object.assign({prefixCls:o},i,{type:"radio",ref:e})))},xCt=y.forwardRef(CCt),ex=R8;ex.Button=xCt;ex.Group=_Ct;ex.__ANT_RADIO=!0;function HOe(n){return oo(n,{inputAffixPadding:n.paddingXXS})}const UOe=n=>{const{controlHeight:e,fontSize:t,lineHeight:r,lineWidth:i,controlHeightSM:o,controlHeightLG:s,fontSizeLG:a,lineHeightLG:c,paddingSM:l,controlPaddingHorizontalSM:u,controlPaddingHorizontal:d,colorFillAlter:h,colorPrimaryHover:f,colorPrimary:p,controlOutlineWidth:g,controlOutline:m,colorErrorOutline:v,colorWarningOutline:b,colorBgContainer:S}=n;return{paddingBlock:Math.max(Math.round((e-t*r)/2*10)/10-i,0),paddingBlockSM:Math.max(Math.round((o-t*r)/2*10)/10-i,0),paddingBlockLG:Math.ceil((s-a*c)/2*10)/10-i,paddingInline:l-i,paddingInlineSM:u-i,paddingInlineLG:d-i,addonBg:h,activeBorderColor:p,hoverBorderColor:f,activeShadow:`0 0 0 ${g}px ${m}`,errorActiveShadow:`0 0 0 ${g}px ${v}`,warningActiveShadow:`0 0 0 ${g}px ${b}`,hoverBg:S,activeBg:S,inputFontSize:t,inputFontSizeLG:a,inputFontSizeSM:t}},ECt=n=>({borderColor:n.hoverBorderColor,backgroundColor:n.hoverBg}),mre=n=>({color:n.colorTextDisabled,backgroundColor:n.colorBgContainerDisabled,borderColor:n.colorBorder,boxShadow:"none",cursor:"not-allowed",opacity:1,"input[disabled], textarea[disabled]":{cursor:"not-allowed"},"&:hover:not([disabled])":Object.assign({},ECt(oo(n,{hoverBorderColor:n.colorBorder,hoverBg:n.colorBgContainerDisabled})))}),zOe=(n,e)=>({background:n.colorBgContainer,borderWidth:n.lineWidth,borderStyle:n.lineType,borderColor:e.borderColor,"&:hover":{borderColor:e.hoverBorderColor,backgroundColor:n.hoverBg},"&:focus, &:focus-within":{borderColor:e.activeBorderColor,boxShadow:e.activeShadow,outline:0,backgroundColor:n.activeBg}}),l0e=(n,e)=>({[`&${n.componentCls}-status-${e.status}:not(${n.componentCls}-disabled)`]:Object.assign(Object.assign({},zOe(n,e)),{[`${n.componentCls}-prefix, ${n.componentCls}-suffix`]:{color:e.affixColor}}),[`&${n.componentCls}-status-${e.status}${n.componentCls}-disabled`]:{borderColor:e.borderColor}}),ICt=(n,e)=>({"&-outlined":Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},zOe(n,{borderColor:n.colorBorder,hoverBorderColor:n.hoverBorderColor,activeBorderColor:n.activeBorderColor,activeShadow:n.activeShadow})),{[`&${n.componentCls}-disabled, &[disabled]`]:Object.assign({},mre(n))}),l0e(n,{status:"error",borderColor:n.colorError,hoverBorderColor:n.colorErrorBorderHover,activeBorderColor:n.colorError,activeShadow:n.errorActiveShadow,affixColor:n.colorError})),l0e(n,{status:"warning",borderColor:n.colorWarning,hoverBorderColor:n.colorWarningBorderHover,activeBorderColor:n.colorWarning,activeShadow:n.warningActiveShadow,affixColor:n.colorWarning})),e)}),u0e=(n,e)=>({[`&${n.componentCls}-group-wrapper-status-${e.status}`]:{[`${n.componentCls}-group-addon`]:{borderColor:e.addonBorderColor,color:e.addonColor}}}),PCt=n=>({"&-outlined":Object.assign(Object.assign(Object.assign({[`${n.componentCls}-group`]:{"&-addon":{background:n.addonBg,border:`${Ct(n.lineWidth)} ${n.lineType} ${n.colorBorder}`},"&-addon:first-child":{borderInlineEnd:0},"&-addon:last-child":{borderInlineStart:0}}},u0e(n,{status:"error",addonBorderColor:n.colorError,addonColor:n.colorErrorText})),u0e(n,{status:"warning",addonBorderColor:n.colorWarning,addonColor:n.colorWarningText})),{[`&${n.componentCls}-group-wrapper-disabled`]:{[`${n.componentCls}-group-addon`]:Object.assign({},mre(n))}})}),kCt=(n,e)=>{const{componentCls:t}=n;return{"&-borderless":Object.assign({background:"transparent",border:"none","&:focus, &:focus-within":{outline:"none"},[`&${t}-disabled, &[disabled]`]:{color:n.colorTextDisabled},[`&${t}-status-error`]:{"&, & input, & textarea":{color:n.colorError}},[`&${t}-status-warning`]:{"&, & input, & textarea":{color:n.colorWarning}}},e)}},VOe=(n,e)=>({background:e.bg,borderWidth:n.lineWidth,borderStyle:n.lineType,borderColor:"transparent","input&, & input, textarea&, & textarea":{color:e==null?void 0:e.inputColor},"&:hover":{background:e.hoverBg},"&:focus, &:focus-within":{outline:0,borderColor:e.activeBorderColor,backgroundColor:n.activeBg}}),d0e=(n,e)=>({[`&${n.componentCls}-status-${e.status}:not(${n.componentCls}-disabled)`]:Object.assign(Object.assign({},VOe(n,e)),{[`${n.componentCls}-prefix, ${n.componentCls}-suffix`]:{color:e.affixColor}})}),TCt=(n,e)=>({"&-filled":Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},VOe(n,{bg:n.colorFillTertiary,hoverBg:n.colorFillSecondary,activeBorderColor:n.activeBorderColor})),{[`&${n.componentCls}-disabled, &[disabled]`]:Object.assign({},mre(n))}),d0e(n,{status:"error",bg:n.colorErrorBg,hoverBg:n.colorErrorBgHover,activeBorderColor:n.colorError,inputColor:n.colorErrorText,affixColor:n.colorError})),d0e(n,{status:"warning",bg:n.colorWarningBg,hoverBg:n.colorWarningBgHover,activeBorderColor:n.colorWarning,inputColor:n.colorWarningText,affixColor:n.colorWarning})),e)}),h0e=(n,e)=>({[`&${n.componentCls}-group-wrapper-status-${e.status}`]:{[`${n.componentCls}-group-addon`]:{background:e.addonBg,color:e.addonColor}}}),DCt=n=>({"&-filled":Object.assign(Object.assign(Object.assign({[`${n.componentCls}-group`]:{"&-addon":{background:n.colorFillTertiary},[`${n.componentCls}-filled:not(:focus):not(:focus-within)`]:{"&:not(:first-child)":{borderInlineStart:`${Ct(n.lineWidth)} ${n.lineType} ${n.colorSplit}`},"&:not(:last-child)":{borderInlineEnd:`${Ct(n.lineWidth)} ${n.lineType} ${n.colorSplit}`}}}},h0e(n,{status:"error",addonBg:n.colorErrorBg,addonColor:n.colorErrorText})),h0e(n,{status:"warning",addonBg:n.colorWarningBg,addonColor:n.colorWarningText})),{[`&${n.componentCls}-group-wrapper-disabled`]:{[`${n.componentCls}-group`]:{"&-addon":{background:n.colorFillTertiary,color:n.colorTextDisabled},"&-addon:first-child":{borderInlineStart:`${Ct(n.lineWidth)} ${n.lineType} ${n.colorBorder}`,borderTop:`${Ct(n.lineWidth)} ${n.lineType} ${n.colorBorder}`,borderBottom:`${Ct(n.lineWidth)} ${n.lineType} ${n.colorBorder}`},"&-addon:last-child":{borderInlineEnd:`${Ct(n.lineWidth)} ${n.lineType} ${n.colorBorder}`,borderTop:`${Ct(n.lineWidth)} ${n.lineType} ${n.colorBorder}`,borderBottom:`${Ct(n.lineWidth)} ${n.lineType} ${n.colorBorder}`}}}})}),RCt=n=>({"&::-moz-placeholder":{opacity:1},"&::placeholder":{color:n,userSelect:"none"},"&:placeholder-shown":{textOverflow:"ellipsis"}}),WOe=n=>{const{paddingBlockLG:e,lineHeightLG:t,borderRadiusLG:r,paddingInlineLG:i}=n;return{padding:`${Ct(e)} ${Ct(i)}`,fontSize:n.inputFontSizeLG,lineHeight:t,borderRadius:r}},qOe=n=>({padding:`${Ct(n.paddingBlockSM)} ${Ct(n.paddingInlineSM)}`,fontSize:n.inputFontSizeSM,borderRadius:n.borderRadiusSM}),KOe=n=>Object.assign(Object.assign({position:"relative",display:"inline-block",width:"100%",minWidth:0,padding:`${Ct(n.paddingBlock)} ${Ct(n.paddingInline)}`,color:n.colorText,fontSize:n.inputFontSize,lineHeight:n.lineHeight,borderRadius:n.borderRadius,transition:`all ${n.motionDurationMid}`},RCt(n.colorTextPlaceholder)),{"textarea&":{maxWidth:"100%",height:"auto",minHeight:n.controlHeight,lineHeight:n.lineHeight,verticalAlign:"bottom",transition:`all ${n.motionDurationSlow}, height 0s`,resize:"vertical"},"&-lg":Object.assign({},WOe(n)),"&-sm":Object.assign({},qOe(n)),"&-rtl, &-textarea-rtl":{direction:"rtl"}}),ACt=n=>{const{componentCls:e,antCls:t}=n;return{position:"relative",display:"table",width:"100%",borderCollapse:"separate",borderSpacing:0,"&[class*='col-']":{paddingInlineEnd:n.paddingXS,"&:last-child":{paddingInlineEnd:0}},[`&-lg ${e}, &-lg > ${e}-group-addon`]:Object.assign({},WOe(n)),[`&-sm ${e}, &-sm > ${e}-group-addon`]:Object.assign({},qOe(n)),[`&-lg ${t}-select-single ${t}-select-selector`]:{height:n.controlHeightLG},[`&-sm ${t}-select-single ${t}-select-selector`]:{height:n.controlHeightSM},[`> ${e}`]:{display:"table-cell","&:not(:first-child):not(:last-child)":{borderRadius:0}},[`${e}-group`]:{"&-addon, &-wrap":{display:"table-cell",width:1,whiteSpace:"nowrap",verticalAlign:"middle","&:not(:first-child):not(:last-child)":{borderRadius:0}},"&-wrap > *":{display:"block !important"},"&-addon":{position:"relative",padding:`0 ${Ct(n.paddingInline)}`,color:n.colorText,fontWeight:"normal",fontSize:n.inputFontSize,textAlign:"center",borderRadius:n.borderRadius,transition:`all ${n.motionDurationSlow}`,lineHeight:1,[`${t}-select`]:{margin:`${Ct(n.calc(n.paddingBlock).add(1).mul(-1).equal())} ${Ct(n.calc(n.paddingInline).mul(-1).equal())}`,[`&${t}-select-single:not(${t}-select-customize-input):not(${t}-pagination-size-changer)`]:{[`${t}-select-selector`]:{backgroundColor:"inherit",border:`${Ct(n.lineWidth)} ${n.lineType} transparent`,boxShadow:"none"}},"&-open, &-focused":{[`${t}-select-selector`]:{color:n.colorPrimary}}},[`${t}-cascader-picker`]:{margin:`-9px ${Ct(n.calc(n.paddingInline).mul(-1).equal())}`,backgroundColor:"transparent",[`${t}-cascader-input`]:{textAlign:"start",border:0,boxShadow:"none"}}}},[e]:{width:"100%",marginBottom:0,textAlign:"inherit","&:focus":{zIndex:1,borderInlineEndWidth:1},"&:hover":{zIndex:1,borderInlineEndWidth:1,[`${e}-search-with-button &`]:{zIndex:0}}},[`> ${e}:first-child, ${e}-group-addon:first-child`]:{borderStartEndRadius:0,borderEndEndRadius:0,[`${t}-select ${t}-select-selector`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`> ${e}-affix-wrapper`]:{[`&:not(:first-child) ${e}`]:{borderStartStartRadius:0,borderEndStartRadius:0},[`&:not(:last-child) ${e}`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`> ${e}:last-child, ${e}-group-addon:last-child`]:{borderStartStartRadius:0,borderEndStartRadius:0,[`${t}-select ${t}-select-selector`]:{borderStartStartRadius:0,borderEndStartRadius:0}},[`${e}-affix-wrapper`]:{"&:not(:last-child)":{borderStartEndRadius:0,borderEndEndRadius:0,[`${e}-search &`]:{borderStartStartRadius:n.borderRadius,borderEndStartRadius:n.borderRadius}},[`&:not(:first-child), ${e}-search &:not(:first-child)`]:{borderStartStartRadius:0,borderEndStartRadius:0}},[`&${e}-group-compact`]:Object.assign(Object.assign({display:"block"},b8()),{[`${e}-group-addon, ${e}-group-wrap, > ${e}`]:{"&:not(:first-child):not(:last-child)":{borderInlineEndWidth:n.lineWidth,"&:hover, &:focus":{zIndex:1}}},"& > *":{display:"inline-flex",float:"none",verticalAlign:"top",borderRadius:0},[`
        & > ${e}-affix-wrapper,
        & > ${e}-number-affix-wrapper,
        & > ${t}-picker-range
      `]:{display:"inline-flex"},"& > *:not(:last-child)":{marginInlineEnd:n.calc(n.lineWidth).mul(-1).equal(),borderInlineEndWidth:n.lineWidth},[e]:{float:"none"},[`& > ${t}-select > ${t}-select-selector,
      & > ${t}-select-auto-complete ${e},
      & > ${t}-cascader-picker ${e},
      & > ${e}-group-wrapper ${e}`]:{borderInlineEndWidth:n.lineWidth,borderRadius:0,"&:hover, &:focus":{zIndex:1}},[`& > ${t}-select-focused`]:{zIndex:1},[`& > ${t}-select > ${t}-select-arrow`]:{zIndex:1},[`& > *:first-child,
      & > ${t}-select:first-child > ${t}-select-selector,
      & > ${t}-select-auto-complete:first-child ${e},
      & > ${t}-cascader-picker:first-child ${e}`]:{borderStartStartRadius:n.borderRadius,borderEndStartRadius:n.borderRadius},[`& > *:last-child,
      & > ${t}-select:last-child > ${t}-select-selector,
      & > ${t}-cascader-picker:last-child ${e},
      & > ${t}-cascader-picker-focused:last-child ${e}`]:{borderInlineEndWidth:n.lineWidth,borderStartEndRadius:n.borderRadius,borderEndEndRadius:n.borderRadius},[`& > ${t}-select-auto-complete ${e}`]:{verticalAlign:"top"},[`${e}-group-wrapper + ${e}-group-wrapper`]:{marginInlineStart:n.calc(n.lineWidth).mul(-1).equal(),[`${e}-affix-wrapper`]:{borderRadius:0}},[`${e}-group-wrapper:not(:last-child)`]:{[`&${e}-search > ${e}-group`]:{[`& > ${e}-group-addon > ${e}-search-button`]:{borderRadius:0},[`& > ${e}`]:{borderStartStartRadius:n.borderRadius,borderStartEndRadius:0,borderEndEndRadius:0,borderEndStartRadius:n.borderRadius}}}})}},OCt=n=>{const{componentCls:e,controlHeightSM:t,lineWidth:r,calc:i}=n,s=i(t).sub(i(r).mul(2)).sub(16).div(2).equal();return{[e]:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},gc(n)),KOe(n)),ICt(n)),TCt(n)),kCt(n)),{'&[type="color"]':{height:n.controlHeight,[`&${e}-lg`]:{height:n.controlHeightLG},[`&${e}-sm`]:{height:t,paddingTop:s,paddingBottom:s}},'&[type="search"]::-webkit-search-cancel-button, &[type="search"]::-webkit-search-decoration':{"-webkit-appearance":"none"}})}},MCt=n=>{const{componentCls:e}=n;return{[`${e}-clear-icon`]:{margin:0,color:n.colorTextQuaternary,fontSize:n.fontSizeIcon,verticalAlign:-1,cursor:"pointer",transition:`color ${n.motionDurationSlow}`,"&:hover":{color:n.colorTextTertiary},"&:active":{color:n.colorText},"&-hidden":{visibility:"hidden"},"&-has-suffix":{margin:`0 ${Ct(n.inputAffixPadding)}`}}}},$Ct=n=>{const{componentCls:e,inputAffixPadding:t,colorTextDescription:r,motionDurationSlow:i,colorIcon:o,colorIconHover:s,iconCls:a}=n;return{[`${e}-affix-wrapper`]:Object.assign(Object.assign(Object.assign(Object.assign({},KOe(n)),{display:"inline-flex",[`&:not(${e}-disabled):hover`]:{zIndex:1,[`${e}-search-with-button &`]:{zIndex:0}},"&-focused, &:focus":{zIndex:1},[`> input${e}`]:{padding:0},[`> input${e}, > textarea${e}`]:{fontSize:"inherit",border:"none",borderRadius:0,outline:"none",background:"transparent",color:"inherit","&::-ms-reveal":{display:"none"},"&:focus":{boxShadow:"none !important"}},"&::before":{display:"inline-block",width:0,visibility:"hidden",content:'"\\a0"'},[e]:{"&-prefix, &-suffix":{display:"flex",flex:"none",alignItems:"center","> *:not(:last-child)":{marginInlineEnd:n.paddingXS}},"&-show-count-suffix":{color:r},"&-show-count-has-suffix":{marginInlineEnd:n.paddingXXS},"&-prefix":{marginInlineEnd:t},"&-suffix":{marginInlineStart:t}}}),MCt(n)),{[`${a}${e}-password-icon`]:{color:o,cursor:"pointer",transition:`all ${i}`,"&:hover":{color:s}}})}},LCt=n=>{const{componentCls:e,borderRadiusLG:t,borderRadiusSM:r}=n;return{[`${e}-group`]:Object.assign(Object.assign(Object.assign({},gc(n)),ACt(n)),{"&-rtl":{direction:"rtl"},"&-wrapper":Object.assign(Object.assign(Object.assign({display:"inline-block",width:"100%",textAlign:"start",verticalAlign:"top","&-rtl":{direction:"rtl"},"&-lg":{[`${e}-group-addon`]:{borderRadius:t,fontSize:n.inputFontSizeLG}},"&-sm":{[`${e}-group-addon`]:{borderRadius:r}}},PCt(n)),DCt(n)),{[`&:not(${e}-compact-first-item):not(${e}-compact-last-item)${e}-compact-item`]:{[`${e}, ${e}-group-addon`]:{borderRadius:0}},[`&:not(${e}-compact-last-item)${e}-compact-first-item`]:{[`${e}, ${e}-group-addon`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`&:not(${e}-compact-first-item)${e}-compact-last-item`]:{[`${e}, ${e}-group-addon`]:{borderStartStartRadius:0,borderEndStartRadius:0}},[`&:not(${e}-compact-last-item)${e}-compact-item`]:{[`${e}-affix-wrapper`]:{borderStartEndRadius:0,borderEndEndRadius:0}}})})}},NCt=n=>{const{componentCls:e,antCls:t}=n,r=`${e}-search`;return{[r]:{[e]:{"&:hover, &:focus":{borderColor:n.colorPrimaryHover,[`+ ${e}-group-addon ${r}-button:not(${t}-btn-primary)`]:{borderInlineStartColor:n.colorPrimaryHover}}},[`${e}-affix-wrapper`]:{borderRadius:0},[`${e}-lg`]:{lineHeight:n.calc(n.lineHeightLG).sub(2e-4).equal()},[`> ${e}-group`]:{[`> ${e}-group-addon:last-child`]:{insetInlineStart:-1,padding:0,border:0,[`${r}-button`]:{marginInlineEnd:-1,paddingTop:0,paddingBottom:0,borderStartStartRadius:0,borderStartEndRadius:n.borderRadius,borderEndEndRadius:n.borderRadius,borderEndStartRadius:0,boxShadow:"none"},[`${r}-button:not(${t}-btn-primary)`]:{color:n.colorTextDescription,"&:hover":{color:n.colorPrimaryHover},"&:active":{color:n.colorPrimaryActive},[`&${t}-btn-loading::before`]:{insetInlineStart:0,insetInlineEnd:0,insetBlockStart:0,insetBlockEnd:0}}}},[`${r}-button`]:{height:n.controlHeight,"&:hover, &:focus":{zIndex:1}},[`&-large ${r}-button`]:{height:n.controlHeightLG},[`&-small ${r}-button`]:{height:n.controlHeightSM},"&-rtl":{direction:"rtl"},[`&${e}-compact-item`]:{[`&:not(${e}-compact-last-item)`]:{[`${e}-group-addon`]:{[`${e}-search-button`]:{marginInlineEnd:n.calc(n.lineWidth).mul(-1).equal(),borderRadius:0}}},[`&:not(${e}-compact-first-item)`]:{[`${e},${e}-affix-wrapper`]:{borderRadius:0}},[`> ${e}-group-addon ${e}-search-button,
        > ${e},
        ${e}-affix-wrapper`]:{"&:hover, &:focus, &:active":{zIndex:2}},[`> ${e}-affix-wrapper-focused`]:{zIndex:2}}}}},FCt=n=>{const{componentCls:e,paddingLG:t}=n,r=`${e}-textarea`;return{[r]:{position:"relative","&-show-count":{[`> ${e}`]:{height:"100%"},[`${e}-data-count`]:{position:"absolute",bottom:n.calc(n.fontSize).mul(n.lineHeight).mul(-1).equal(),insetInlineEnd:0,color:n.colorTextDescription,whiteSpace:"nowrap",pointerEvents:"none"}},[`
        &-allow-clear > ${e},
        &-affix-wrapper${r}-has-feedback ${e}
      `]:{paddingInlineEnd:t},[`&-affix-wrapper${e}-affix-wrapper`]:{padding:0,[`> textarea${e}`]:{fontSize:"inherit",border:"none",outline:"none",background:"transparent","&:focus":{boxShadow:"none !important"}},[`${e}-suffix`]:{margin:0,"> *:not(:last-child)":{marginInline:0},[`${e}-clear-icon`]:{position:"absolute",insetInlineEnd:n.paddingInline,insetBlockStart:n.paddingXS},[`${r}-suffix`]:{position:"absolute",top:0,insetInlineEnd:n.paddingInline,bottom:0,zIndex:1,display:"inline-flex",alignItems:"center",margin:"auto",pointerEvents:"none"}}},[`&-affix-wrapper${e}-affix-wrapper-sm`]:{[`${e}-suffix`]:{[`${e}-clear-icon`]:{insetInlineEnd:n.paddingInlineSM}}}}}},jCt=n=>{const{componentCls:e}=n;return{[`${e}-out-of-range`]:{[`&, & input, & textarea, ${e}-show-count-suffix, ${e}-data-count`]:{color:n.colorError}}}},vre=Jc("Input",n=>{const e=oo(n,HOe(n));return[OCt(e),FCt(e),$Ct(e),LCt(e),NCt(e),jCt(e),qne(e)]},UOe,{resetFont:!1}),BCt=n=>{const{checkboxCls:e}=n,t=`${e}-wrapper`;return[{[`${e}-group`]:Object.assign(Object.assign({},gc(n)),{display:"inline-flex",flexWrap:"wrap",columnGap:n.marginXS,[`> ${n.antCls}-row`]:{flex:1}}),[t]:Object.assign(Object.assign({},gc(n)),{display:"inline-flex",alignItems:"baseline",cursor:"pointer","&:after":{display:"inline-block",width:0,overflow:"hidden",content:"'\\a0'"},[`& + ${t}`]:{marginInlineStart:0},[`&${t}-in-form-item`]:{'input[type="checkbox"]':{width:14,height:14}}}),[e]:Object.assign(Object.assign({},gc(n)),{position:"relative",whiteSpace:"nowrap",lineHeight:1,cursor:"pointer",borderRadius:n.borderRadiusSM,alignSelf:"center",[`${e}-input`]:{position:"absolute",inset:0,zIndex:1,cursor:"pointer",opacity:0,margin:0,[`&:focus-visible + ${e}-inner`]:Object.assign({},dD(n))},[`${e}-inner`]:{boxSizing:"border-box",display:"block",width:n.checkboxSize,height:n.checkboxSize,direction:"ltr",backgroundColor:n.colorBgContainer,border:`${Ct(n.lineWidth)} ${n.lineType} ${n.colorBorder}`,borderRadius:n.borderRadiusSM,borderCollapse:"separate",transition:`all ${n.motionDurationSlow}`,"&:after":{boxSizing:"border-box",position:"absolute",top:"50%",insetInlineStart:"25%",display:"table",width:n.calc(n.checkboxSize).div(14).mul(5).equal(),height:n.calc(n.checkboxSize).div(14).mul(8).equal(),border:`${Ct(n.lineWidthBold)} solid ${n.colorWhite}`,borderTop:0,borderInlineStart:0,transform:"rotate(45deg) scale(0) translate(-50%,-50%)",opacity:0,content:'""',transition:`all ${n.motionDurationFast} ${n.motionEaseInBack}, opacity ${n.motionDurationFast}`}},"& + span":{paddingInlineStart:n.paddingXS,paddingInlineEnd:n.paddingXS}})},{[`
        ${t}:not(${t}-disabled),
        ${e}:not(${e}-disabled)
      `]:{[`&:hover ${e}-inner`]:{borderColor:n.colorPrimary}},[`${t}:not(${t}-disabled)`]:{[`&:hover ${e}-checked:not(${e}-disabled) ${e}-inner`]:{backgroundColor:n.colorPrimaryHover,borderColor:"transparent"},[`&:hover ${e}-checked:not(${e}-disabled):after`]:{borderColor:n.colorPrimaryHover}}},{[`${e}-checked`]:{[`${e}-inner`]:{backgroundColor:n.colorPrimary,borderColor:n.colorPrimary,"&:after":{opacity:1,transform:"rotate(45deg) scale(1) translate(-50%,-50%)",transition:`all ${n.motionDurationMid} ${n.motionEaseOutBack} ${n.motionDurationFast}`}}},[`
        ${t}-checked:not(${t}-disabled),
        ${e}-checked:not(${e}-disabled)
      `]:{[`&:hover ${e}-inner`]:{backgroundColor:n.colorPrimaryHover,borderColor:"transparent"}}},{[e]:{"&-indeterminate":{[`${e}-inner`]:{backgroundColor:`${n.colorBgContainer} !important`,borderColor:`${n.colorBorder} !important`,"&:after":{top:"50%",insetInlineStart:"50%",width:n.calc(n.fontSizeLG).div(2).equal(),height:n.calc(n.fontSizeLG).div(2).equal(),backgroundColor:n.colorPrimary,border:0,transform:"translate(-50%, -50%) scale(1)",opacity:1,content:'""'}},[`&:hover ${e}-inner`]:{backgroundColor:`${n.colorBgContainer} !important`,borderColor:`${n.colorPrimary} !important`}}}},{[`${t}-disabled`]:{cursor:"not-allowed"},[`${e}-disabled`]:{[`&, ${e}-input`]:{cursor:"not-allowed",pointerEvents:"none"},[`${e}-inner`]:{background:n.colorBgContainerDisabled,borderColor:n.colorBorder,"&:after":{borderColor:n.colorTextDisabled}},"&:after":{display:"none"},"& + span":{color:n.colorTextDisabled},[`&${e}-indeterminate ${e}-inner::after`]:{background:n.colorTextDisabled}}}]};function HCt(n,e){const t=oo(e,{checkboxCls:`.${n}`,checkboxSize:e.controlInteractiveSize});return[BCt(t)]}const GOe=Jc("Checkbox",(n,e)=>{let{prefixCls:t}=e;return[HCt(t,n)]}),ZOe=Ke.createContext(null);var UCt=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t};const zCt=(n,e)=>{var t;const{prefixCls:r,className:i,rootClassName:o,children:s,indeterminate:a=!1,style:c,onMouseEnter:l,onMouseLeave:u,skipGroup:d=!1,disabled:h}=n,f=UCt(n,["prefixCls","className","rootClassName","children","indeterminate","style","onMouseEnter","onMouseLeave","skipGroup","disabled"]),{getPrefixCls:p,direction:g,checkbox:m}=y.useContext(fr),v=y.useContext(ZOe),{isFormItemInput:b}=y.useContext(nu),S=y.useContext(fg),E=(t=(v==null?void 0:v.disabled)||h)!==null&&t!==void 0?t:S,w=y.useRef(f.value);y.useEffect(()=>{v==null||v.registerValue(f.value)},[]),y.useEffect(()=>{if(!d)return f.value!==w.current&&(v==null||v.cancelValue(w.current),v==null||v.registerValue(f.value),w.current=f.value),()=>v==null?void 0:v.cancelValue(f.value)},[f.value]);const C=p("checkbox",r),I=Qc(C),[T,D,O]=GOe(C,I),M=Object.assign({},f);v&&!d&&(M.onChange=function(){f.onChange&&f.onChange.apply(f,arguments),v.toggleOption&&v.toggleOption({label:s,value:f.value})},M.name=v.name,M.checked=v.value.includes(f.value));const R=Ue(`${C}-wrapper`,{[`${C}-rtl`]:g==="rtl",[`${C}-wrapper-checked`]:M.checked,[`${C}-wrapper-disabled`]:E,[`${C}-wrapper-in-form-item`]:b},m==null?void 0:m.className,i,o,O,I,D),A=Ue({[`${C}-indeterminate`]:a},X7,D),k=a?"mixed":void 0;return T(y.createElement(zne,{component:"Checkbox",disabled:E},y.createElement("label",{className:R,style:Object.assign(Object.assign({},m==null?void 0:m.style),c),onMouseEnter:l,onMouseLeave:u},y.createElement(jOe,Object.assign({"aria-checked":k},M,{prefixCls:C,className:A,disabled:E,ref:e})),s!==void 0&&y.createElement("span",null,s))))},XOe=y.forwardRef(zCt);var VCt=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t};const WCt=y.forwardRef((n,e)=>{const{defaultValue:t,children:r,options:i=[],prefixCls:o,className:s,rootClassName:a,style:c,onChange:l}=n,u=VCt(n,["defaultValue","children","options","prefixCls","className","rootClassName","style","onChange"]),{getPrefixCls:d,direction:h}=y.useContext(fr),[f,p]=y.useState(u.value||t||[]),[g,m]=y.useState([]);y.useEffect(()=>{"value"in u&&p(u.value||[])},[u.value]);const v=y.useMemo(()=>i.map(L=>typeof L=="string"||typeof L=="number"?{label:L,value:L}:L),[i]),b=L=>{m(j=>j.filter(N=>N!==L))},S=L=>{m(j=>[].concat(Ht(j),[L]))},E=L=>{const j=f.indexOf(L.value),N=Ht(f);j===-1?N.push(L.value):N.splice(j,1),"value"in u||p(N),l==null||l(N.filter(B=>g.includes(B)).sort((B,U)=>{const K=v.findIndex(G=>G.value===B),z=v.findIndex(G=>G.value===U);return K-z}))},w=d("checkbox",o),C=`${w}-group`,I=Qc(w),[T,D,O]=GOe(w,I),M=Yc(u,["value","disabled"]),R=i.length?v.map(L=>y.createElement(XOe,{prefixCls:w,key:L.value.toString(),disabled:"disabled"in L?L.disabled:u.disabled,value:L.value,checked:f.includes(L.value),onChange:L.onChange,className:`${C}-item`,style:L.style,title:L.title,id:L.id,required:L.required},L.label)):r,A={toggleOption:E,value:f,disabled:u.disabled,name:u.name,registerValue:S,cancelValue:b},k=Ue(C,{[`${C}-rtl`]:h==="rtl"},s,a,O,I,D);return T(y.createElement("div",Object.assign({className:k,style:c},M,{ref:e}),y.createElement(ZOe.Provider,{value:A},R)))}),WC=XOe;WC.Group=WCt;WC.__ANT_CHECKBOX=!0;const YOe=y.createContext({}),qCt=n=>{const{componentCls:e}=n;return{[e]:{display:"flex",flexFlow:"row wrap",minWidth:0,"&::before, &::after":{display:"flex"},"&-no-wrap":{flexWrap:"nowrap"},"&-start":{justifyContent:"flex-start"},"&-center":{justifyContent:"center"},"&-end":{justifyContent:"flex-end"},"&-space-between":{justifyContent:"space-between"},"&-space-around":{justifyContent:"space-around"},"&-space-evenly":{justifyContent:"space-evenly"},"&-top":{alignItems:"flex-start"},"&-middle":{alignItems:"center"},"&-bottom":{alignItems:"flex-end"}}}},KCt=n=>{const{componentCls:e}=n;return{[e]:{position:"relative",maxWidth:"100%",minHeight:1}}},GCt=(n,e)=>{const{prefixCls:t,componentCls:r,gridColumns:i}=n,o={};for(let s=i;s>=0;s--)s===0?(o[`${r}${e}-${s}`]={display:"none"},o[`${r}-push-${s}`]={insetInlineStart:"auto"},o[`${r}-pull-${s}`]={insetInlineEnd:"auto"},o[`${r}${e}-push-${s}`]={insetInlineStart:"auto"},o[`${r}${e}-pull-${s}`]={insetInlineEnd:"auto"},o[`${r}${e}-offset-${s}`]={marginInlineStart:0},o[`${r}${e}-order-${s}`]={order:0}):(o[`${r}${e}-${s}`]=[{"--ant-display":"block",display:"block"},{display:"var(--ant-display)",flex:`0 0 ${s/i*100}%`,maxWidth:`${s/i*100}%`}],o[`${r}${e}-push-${s}`]={insetInlineStart:`${s/i*100}%`},o[`${r}${e}-pull-${s}`]={insetInlineEnd:`${s/i*100}%`},o[`${r}${e}-offset-${s}`]={marginInlineStart:`${s/i*100}%`},o[`${r}${e}-order-${s}`]={order:s});return o[`${r}${e}-flex`]={flex:`var(--${t}${e}-flex)`},o},xZ=(n,e)=>GCt(n,e),ZCt=(n,e,t)=>({[`@media (min-width: ${Ct(e)})`]:Object.assign({},xZ(n,t))}),XCt=()=>({}),YCt=()=>({}),JCt=Jc("Grid",qCt,XCt),QCt=Jc("Grid",n=>{const e=oo(n,{gridColumns:24}),t={"-sm":e.screenSMMin,"-md":e.screenMDMin,"-lg":e.screenLGMin,"-xl":e.screenXLMin,"-xxl":e.screenXXLMin};return[KCt(e),xZ(e,""),xZ(e,"-xs"),Object.keys(t).map(r=>ZCt(e,t[r],r)).reduce((r,i)=>Object.assign(Object.assign({},r),i),{})]},YCt);var e2t=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t};function f0e(n){return typeof n=="number"?`${n} ${n} auto`:/^\d+(\.\d+)?(px|em|rem|%)$/.test(n)?`0 0 ${n}`:n}const t2t=["xs","sm","md","lg","xl","xxl"],JOe=y.forwardRef((n,e)=>{const{getPrefixCls:t,direction:r}=y.useContext(fr),{gutter:i,wrap:o}=y.useContext(YOe),{prefixCls:s,span:a,order:c,offset:l,push:u,pull:d,className:h,children:f,flex:p,style:g}=n,m=e2t(n,["prefixCls","span","order","offset","push","pull","className","children","flex","style"]),v=t("col",s),[b,S,E]=QCt(v),w={};let C={};t2t.forEach(D=>{let O={};const M=n[D];typeof M=="number"?O.span=M:typeof M=="object"&&(O=M||{}),delete m[D],C=Object.assign(Object.assign({},C),{[`${v}-${D}-${O.span}`]:O.span!==void 0,[`${v}-${D}-order-${O.order}`]:O.order||O.order===0,[`${v}-${D}-offset-${O.offset}`]:O.offset||O.offset===0,[`${v}-${D}-push-${O.push}`]:O.push||O.push===0,[`${v}-${D}-pull-${O.pull}`]:O.pull||O.pull===0,[`${v}-rtl`]:r==="rtl"}),O.flex&&(C[`${v}-${D}-flex`]=!0,w[`--${v}-${D}-flex`]=f0e(O.flex))});const I=Ue(v,{[`${v}-${a}`]:a!==void 0,[`${v}-order-${c}`]:c,[`${v}-offset-${l}`]:l,[`${v}-push-${u}`]:u,[`${v}-pull-${d}`]:d},h,C,S,E),T={};if(i&&i[0]>0){const D=i[0]/2;T.paddingLeft=D,T.paddingRight=D}return p&&(T.flex=f0e(p),o===!1&&!T.minWidth&&(T.minWidth=0)),b(y.createElement("div",Object.assign({},m,{style:Object.assign(Object.assign(Object.assign({},T),g),w),className:I,ref:e}),f))});var n2t=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t};function p0e(n,e){const[t,r]=y.useState(typeof n=="string"?n:""),i=()=>{if(typeof n=="string"&&r(n),typeof n=="object")for(let o=0;o<D3.length;o++){const s=D3[o];if(!e[s])continue;const a=n[s];if(a!==void 0){r(a);return}}};return y.useEffect(()=>{i()},[JSON.stringify(n),e]),t}const r2t=y.forwardRef((n,e)=>{const{prefixCls:t,justify:r,align:i,className:o,style:s,children:a,gutter:c=0,wrap:l}=n,u=n2t(n,["prefixCls","justify","align","className","style","children","gutter","wrap"]),{getPrefixCls:d,direction:h}=y.useContext(fr),[f,p]=y.useState({xs:!0,sm:!0,md:!0,lg:!0,xl:!0,xxl:!0}),[g,m]=y.useState({xs:!1,sm:!1,md:!1,lg:!1,xl:!1,xxl:!1}),v=p0e(i,g),b=p0e(r,g),S=y.useRef(c),E=L_t();y.useEffect(()=>{const N=E.subscribe(B=>{m(B);const U=S.current||0;(!Array.isArray(U)&&typeof U=="object"||Array.isArray(U)&&(typeof U[0]=="object"||typeof U[1]=="object"))&&p(B)});return()=>E.unsubscribe(N)},[]);const w=()=>{const N=[void 0,void 0];return(Array.isArray(c)?c:[c,void 0]).forEach((U,K)=>{if(typeof U=="object")for(let z=0;z<D3.length;z++){const G=D3[z];if(f[G]&&U[G]!==void 0){N[K]=U[G];break}}else N[K]=U}),N},C=d("row",t),[I,T,D]=JCt(C),O=w(),M=Ue(C,{[`${C}-no-wrap`]:l===!1,[`${C}-${b}`]:b,[`${C}-${v}`]:v,[`${C}-rtl`]:h==="rtl"},o,T,D),R={},A=O[0]!=null&&O[0]>0?O[0]/-2:void 0;A&&(R.marginLeft=A,R.marginRight=A);const[k,L]=O;R.rowGap=L;const j=y.useMemo(()=>({gutter:[k,L],wrap:l}),[k,L,l]);return I(y.createElement(YOe.Provider,{value:j},y.createElement("div",Object.assign({},u,{className:M,style:Object.assign(Object.assign({},R),s),ref:e}),a)))});var i2t={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M890.5 755.3L537.9 269.2c-12.8-17.6-39-17.6-51.7 0L133.5 755.3A8 8 0 00140 768h75c5.1 0 9.9-2.5 12.9-6.6L512 369.8l284.1 391.6c3 4.1 7.8 6.6 12.9 6.6h75c6.5 0 10.3-7.4 6.5-12.7z"}}]},name:"up",theme:"outlined"},o2t=function(e,t){return y.createElement(_a,ln({},e,{ref:t,icon:i2t}))},g0e=y.forwardRef(o2t);function s2t(n){return!!(n.addonBefore||n.addonAfter)}function a2t(n){return!!(n.prefix||n.suffix||n.allowClear)}function m0e(n,e,t){var r=e.cloneNode(!0),i=Object.create(n,{target:{value:r},currentTarget:{value:r}});return r.value=t,typeof e.selectionStart=="number"&&typeof e.selectionEnd=="number"&&(r.selectionStart=e.selectionStart,r.selectionEnd=e.selectionEnd),r.setSelectionRange=function(){e.setSelectionRange.apply(e,arguments)},i}function A8(n,e,t,r){if(t){var i=e;if(e.type==="click"){i=m0e(e,n,""),t(i);return}if(n.type!=="file"&&r!==void 0){i=m0e(e,n,r),t(i);return}t(i)}}function c2t(n,e){if(n){n.focus(e);var t=e||{},r=t.cursor;if(r){var i=n.value.length;switch(r){case"start":n.setSelectionRange(0,0);break;case"end":n.setSelectionRange(i,i);break;default:n.setSelectionRange(0,i)}}}}var QOe=Ke.forwardRef(function(n,e){var t,r,i=n.inputElement,o=n.children,s=n.prefixCls,a=n.prefix,c=n.suffix,l=n.addonBefore,u=n.addonAfter,d=n.className,h=n.style,f=n.disabled,p=n.readOnly,g=n.focused,m=n.triggerFocus,v=n.allowClear,b=n.value,S=n.handleReset,E=n.hidden,w=n.classes,C=n.classNames,I=n.dataAttrs,T=n.styles,D=n.components,O=n.onClear,M=o??i,R=(D==null?void 0:D.affixWrapper)||"span",A=(D==null?void 0:D.groupWrapper)||"span",k=(D==null?void 0:D.wrapper)||"span",L=(D==null?void 0:D.groupAddon)||"span",j=y.useRef(null),N=function(V){var le;(le=j.current)!==null&&le!==void 0&&le.contains(V.target)&&(m==null||m())},B=a2t(n),U=y.cloneElement(M,{value:b,className:Ue(M.props.className,!B&&(C==null?void 0:C.variant))||null}),K=y.useRef(null);if(Ke.useImperativeHandle(e,function(){return{nativeElement:K.current||j.current}}),B){var z=null;if(v){var G=!f&&!p&&b,te="".concat(s,"-clear-icon"),ie=Wn(v)==="object"&&v!==null&&v!==void 0&&v.clearIcon?v.clearIcon:"✖";z=Ke.createElement("span",{onClick:function(V){S==null||S(V),O==null||O()},onMouseDown:function(V){return V.preventDefault()},className:Ue(te,Le(Le({},"".concat(te,"-hidden"),!G),"".concat(te,"-has-suffix"),!!c)),role:"button",tabIndex:-1},ie)}var Q="".concat(s,"-affix-wrapper"),ge=Ue(Q,Le(Le(Le(Le(Le({},"".concat(s,"-disabled"),f),"".concat(Q,"-disabled"),f),"".concat(Q,"-focused"),g),"".concat(Q,"-readonly"),p),"".concat(Q,"-input-with-clear-btn"),c&&v&&b),w==null?void 0:w.affixWrapper,C==null?void 0:C.affixWrapper,C==null?void 0:C.variant),_e=(c||v)&&Ke.createElement("span",{className:Ue("".concat(s,"-suffix"),C==null?void 0:C.suffix),style:T==null?void 0:T.suffix},z,c);U=Ke.createElement(R,ln({className:ge,style:T==null?void 0:T.affixWrapper,onClick:N},I==null?void 0:I.affixWrapper,{ref:j}),a&&Ke.createElement("span",{className:Ue("".concat(s,"-prefix"),C==null?void 0:C.prefix),style:T==null?void 0:T.prefix},a),U,_e)}if(s2t(n)){var Se="".concat(s,"-group"),se="".concat(Se,"-addon"),ee="".concat(Se,"-wrapper"),Y=Ue("".concat(s,"-wrapper"),Se,w==null?void 0:w.wrapper,C==null?void 0:C.wrapper),ue=Ue(ee,Le({},"".concat(ee,"-disabled"),f),w==null?void 0:w.group,C==null?void 0:C.groupWrapper);U=Ke.createElement(A,{className:ue,ref:K},Ke.createElement(k,{className:Y},l&&Ke.createElement(L,{className:se},l),U,u&&Ke.createElement(L,{className:se},u)))}return Ke.cloneElement(U,{className:Ue((t=U.props)===null||t===void 0?void 0:t.className,d)||null,style:$e($e({},(r=U.props)===null||r===void 0?void 0:r.style),h),hidden:E})}),l2t=["show"];function eMe(n,e){return y.useMemo(function(){var t={};e&&(t.show=Wn(e)==="object"&&e.formatter?e.formatter:!!e),t=$e($e({},t),n);var r=t,i=r.show,o=jr(r,l2t);return $e($e({},o),{},{show:!!i,showFormatter:typeof i=="function"?i:void 0,strategy:o.strategy||function(s){return s.length}})},[n,e])}var u2t=["autoComplete","onChange","onFocus","onBlur","onPressEnter","onKeyDown","onKeyUp","prefixCls","disabled","htmlSize","className","maxLength","suffix","showCount","count","type","classes","classNames","styles","onCompositionStart","onCompositionEnd"],d2t=y.forwardRef(function(n,e){var t=n.autoComplete,r=n.onChange,i=n.onFocus,o=n.onBlur,s=n.onPressEnter,a=n.onKeyDown,c=n.onKeyUp,l=n.prefixCls,u=l===void 0?"rc-input":l,d=n.disabled,h=n.htmlSize,f=n.className,p=n.maxLength,g=n.suffix,m=n.showCount,v=n.count,b=n.type,S=b===void 0?"text":b,E=n.classes,w=n.classNames,C=n.styles,I=n.onCompositionStart,T=n.onCompositionEnd,D=jr(n,u2t),O=y.useState(!1),M=rt(O,2),R=M[0],A=M[1],k=y.useRef(!1),L=y.useRef(!1),j=y.useRef(null),N=y.useRef(null),B=function(Me){j.current&&c2t(j.current,Me)},U=Ql(n.defaultValue,{value:n.value}),K=rt(U,2),z=K[0],G=K[1],te=z==null?"":String(z),ie=y.useState(null),Q=rt(ie,2),ge=Q[0],_e=Q[1],Se=eMe(v,m),se=Se.max||p,ee=Se.strategy(te),Y=!!se&&ee>se;y.useImperativeHandle(e,function(){var De;return{focus:B,blur:function(){var He;(He=j.current)===null||He===void 0||He.blur()},setSelectionRange:function(He,Je,qe){var Ge;(Ge=j.current)===null||Ge===void 0||Ge.setSelectionRange(He,Je,qe)},select:function(){var He;(He=j.current)===null||He===void 0||He.select()},input:j.current,nativeElement:((De=N.current)===null||De===void 0?void 0:De.nativeElement)||j.current}}),y.useEffect(function(){A(function(De){return De&&d?!1:De})},[d]);var ue=function(Me,He,Je){var qe=He;if(!k.current&&Se.exceedFormatter&&Se.max&&Se.strategy(He)>Se.max){if(qe=Se.exceedFormatter(He,{max:Se.max}),He!==qe){var Ge,St;_e([((Ge=j.current)===null||Ge===void 0?void 0:Ge.selectionStart)||0,((St=j.current)===null||St===void 0?void 0:St.selectionEnd)||0])}}else if(Je.source==="compositionEnd")return;G(qe),j.current&&A8(j.current,Me,r,qe)};y.useEffect(function(){if(ge){var De;(De=j.current)===null||De===void 0||De.setSelectionRange.apply(De,Ht(ge))}},[ge]);var ye=function(Me){ue(Me,Me.target.value,{source:"change"})},V=function(Me){k.current=!1,ue(Me,Me.currentTarget.value,{source:"compositionEnd"}),T==null||T(Me)},le=function(Me){s&&Me.key==="Enter"&&!L.current&&(L.current=!0,s(Me)),a==null||a(Me)},he=function(Me){Me.key==="Enter"&&(L.current=!1),c==null||c(Me)},oe=function(Me){A(!0),i==null||i(Me)},ne=function(Me){A(!1),o==null||o(Me)},ce=function(Me){G(""),B(),j.current&&A8(j.current,Me,r)},Ae=Y&&"".concat(u,"-out-of-range"),Ie=function(){var Me=Yc(n,["prefixCls","onPressEnter","addonBefore","addonAfter","prefix","suffix","allowClear","defaultValue","showCount","count","classes","htmlSize","styles","classNames","onClear"]);return Ke.createElement("input",ln({autoComplete:t},Me,{onChange:ye,onFocus:oe,onBlur:ne,onKeyDown:le,onKeyUp:he,className:Ue(u,Le({},"".concat(u,"-disabled"),d),w==null?void 0:w.input),style:C==null?void 0:C.input,ref:j,size:h,type:S,onCompositionStart:function(Je){k.current=!0,I==null||I(Je)},onCompositionEnd:V}))},be=function(){var Me=Number(se)>0;if(g||Se.show){var He=Se.showFormatter?Se.showFormatter({value:te,count:ee,maxLength:se}):"".concat(ee).concat(Me?" / ".concat(se):"");return Ke.createElement(Ke.Fragment,null,Se.show&&Ke.createElement("span",{className:Ue("".concat(u,"-show-count-suffix"),Le({},"".concat(u,"-show-count-has-suffix"),!!g),w==null?void 0:w.count),style:$e({},C==null?void 0:C.count)},He),g)}return null};return Ke.createElement(QOe,ln({},D,{prefixCls:u,className:Ue(f,Ae),handleReset:ce,value:te,focused:R,triggerFocus:B,suffix:be(),disabled:d,classes:E,classNames:w,styles:C}),Ie())});const h2t=n=>{const{getPrefixCls:e,direction:t}=y.useContext(fr),{prefixCls:r,className:i}=n,o=e("input-group",r),s=e("input"),[a,c]=vre(s),l=Ue(o,{[`${o}-lg`]:n.size==="large",[`${o}-sm`]:n.size==="small",[`${o}-compact`]:n.compact,[`${o}-rtl`]:t==="rtl"},c,i),u=y.useContext(nu),d=y.useMemo(()=>Object.assign(Object.assign({},u),{isFormItemInput:!1}),[u]);return a(y.createElement("span",{className:l,style:n.style,onMouseEnter:n.onMouseEnter,onMouseLeave:n.onMouseLeave,onFocus:n.onFocus,onBlur:n.onBlur},y.createElement(nu.Provider,{value:d},n.children)))},tMe=n=>{let e;return typeof n=="object"&&(n!=null&&n.clearIcon)?e=n:n&&(e={clearIcon:Ke.createElement(hD,null)}),e};function nMe(n,e){const t=y.useRef([]),r=()=>{t.current.push(setTimeout(()=>{var i,o,s,a;!((i=n.current)===null||i===void 0)&&i.input&&((o=n.current)===null||o===void 0?void 0:o.input.getAttribute("type"))==="password"&&(!((s=n.current)===null||s===void 0)&&s.input.hasAttribute("value"))&&((a=n.current)===null||a===void 0||a.input.removeAttribute("value"))}))};return y.useEffect(()=>(e&&r(),()=>t.current.forEach(i=>{i&&clearTimeout(i)})),[]),r}function f2t(n){return!!(n.prefix||n.suffix||n.allowClear||n.showCount)}var p2t=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t};function g2t(n,e){if(!n)return;n.focus(e);const{cursor:t}=e||{};if(t){const r=n.value.length;switch(t){case"start":n.setSelectionRange(0,0);break;case"end":n.setSelectionRange(r,r);break;default:n.setSelectionRange(0,r)}}}const lN=y.forwardRef((n,e)=>{var t;const{prefixCls:r,bordered:i=!0,status:o,size:s,disabled:a,onBlur:c,onFocus:l,suffix:u,allowClear:d,addonAfter:h,addonBefore:f,className:p,style:g,styles:m,rootClassName:v,onChange:b,classNames:S,variant:E}=n,w=p2t(n,["prefixCls","bordered","status","size","disabled","onBlur","onFocus","suffix","allowClear","addonAfter","addonBefore","className","style","styles","rootClassName","onChange","classNames","variant"]),{getPrefixCls:C,direction:I,input:T}=Ke.useContext(fr),D=C("input",r),O=y.useRef(null),M=Qc(D),[R,A,k]=vre(D,M),{compactSize:L,compactItemClassnames:j}=mD(D,I),N=_v(ye=>{var V;return(V=s??L)!==null&&V!==void 0?V:ye}),B=Ke.useContext(fg),U=a??B,{status:K,hasFeedback:z,feedbackIcon:G}=y.useContext(nu),te=iN(K,o),ie=f2t(n)||!!z;y.useRef(ie);const Q=nMe(O,!0),ge=ye=>{Q(),c==null||c(ye)},_e=ye=>{Q(),l==null||l(ye)},Se=ye=>{Q(),b==null||b(ye)},se=(z||u)&&Ke.createElement(Ke.Fragment,null,u,z&&G),ee=tMe(d??(T==null?void 0:T.allowClear)),[Y,ue]=are("input",E,i);return R(Ke.createElement(d2t,Object.assign({ref:Gd(e,O),prefixCls:D,autoComplete:T==null?void 0:T.autoComplete},w,{disabled:U,onBlur:ge,onFocus:_e,style:Object.assign(Object.assign({},T==null?void 0:T.style),g),styles:Object.assign(Object.assign({},T==null?void 0:T.styles),m),suffix:se,allowClear:ee,className:Ue(p,v,k,M,j,T==null?void 0:T.className),onChange:Se,addonBefore:f&&Ke.createElement(k3,{form:!0,space:!0},f),addonAfter:h&&Ke.createElement(k3,{form:!0,space:!0},h),classNames:Object.assign(Object.assign(Object.assign({},S),T==null?void 0:T.classNames),{input:Ue({[`${D}-sm`]:N==="small",[`${D}-lg`]:N==="large",[`${D}-rtl`]:I==="rtl"},S==null?void 0:S.input,(t=T==null?void 0:T.classNames)===null||t===void 0?void 0:t.input,A),variant:Ue({[`${D}-${Y}`]:ue},P8(D,te)),affixWrapper:Ue({[`${D}-affix-wrapper-sm`]:N==="small",[`${D}-affix-wrapper-lg`]:N==="large",[`${D}-affix-wrapper-rtl`]:I==="rtl"},A),wrapper:Ue({[`${D}-group-rtl`]:I==="rtl"},A),groupWrapper:Ue({[`${D}-group-wrapper-sm`]:N==="small",[`${D}-group-wrapper-lg`]:N==="large",[`${D}-group-wrapper-rtl`]:I==="rtl",[`${D}-group-wrapper-${Y}`]:ue},P8(`${D}-group-wrapper`,te,z),A)})})))}),m2t=n=>{const{componentCls:e,paddingXS:t}=n;return{[e]:{display:"inline-flex",alignItems:"center",flexWrap:"nowrap",columnGap:t,"&-rtl":{direction:"rtl"},[`${e}-input`]:{textAlign:"center",paddingInline:n.paddingXXS},[`&${e}-sm ${e}-input`]:{paddingInline:n.calc(n.paddingXXS).div(2).equal()},[`&${e}-lg ${e}-input`]:{paddingInline:n.paddingXS}}}},v2t=Jc(["Input","OTP"],n=>{const e=oo(n,HOe(n));return[m2t(e)]},UOe);var y2t=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t};const b2t=y.forwardRef((n,e)=>{const{value:t,onChange:r,onActiveChange:i,index:o,mask:s}=n,a=y2t(n,["value","onChange","onActiveChange","index","mask"]),c=t&&typeof s=="string"?s:t,l=p=>{r(o,p.target.value)},u=y.useRef(null);y.useImperativeHandle(e,()=>u.current);const d=()=>{no(()=>{var p;const g=(p=u.current)===null||p===void 0?void 0:p.input;document.activeElement===g&&g&&g.select()})},h=p=>{let{key:g}=p;g==="ArrowLeft"?i(o-1):g==="ArrowRight"&&i(o+1),d()},f=p=>{p.key==="Backspace"&&!t&&i(o-1),d()};return y.createElement(lN,Object.assign({},a,{ref:u,value:c,onInput:l,onFocus:d,onKeyDown:h,onKeyUp:f,onMouseDown:d,onMouseUp:d,type:s===!0?"password":"text"}))});var S2t=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t};function V5(n){return(n||"").split("")}const _2t=y.forwardRef((n,e)=>{const{prefixCls:t,length:r=6,size:i,defaultValue:o,value:s,onChange:a,formatter:c,variant:l,disabled:u,status:d,autoFocus:h,mask:f}=n,p=S2t(n,["prefixCls","length","size","defaultValue","value","onChange","formatter","variant","disabled","status","autoFocus","mask"]),{getPrefixCls:g,direction:m}=y.useContext(fr),v=g("otp",t),b=pg(p,{aria:!0,data:!0,attr:!0}),S=Qc(v),[E,w,C]=v2t(v,S),I=_v(z=>i??z),T=y.useContext(nu),D=iN(T.status,d),O=y.useMemo(()=>Object.assign(Object.assign({},T),{status:D,hasFeedback:!1,feedbackIcon:null}),[T,D]),M=y.useRef(null),R=y.useRef({});y.useImperativeHandle(e,()=>({focus:()=>{var z;(z=R.current[0])===null||z===void 0||z.focus()},blur:()=>{var z;for(let G=0;G<r;G+=1)(z=R.current[G])===null||z===void 0||z.blur()},nativeElement:M.current}));const A=z=>c?c(z):z,[k,L]=y.useState(V5(A(o||"")));y.useEffect(()=>{s!==void 0&&L(V5(s))},[s]);const j=ea(z=>{L(z),a&&z.length===r&&z.every(G=>G)&&z.some((G,te)=>k[te]!==G)&&a(z.join(""))}),N=ea((z,G)=>{let te=Ht(k);for(let Q=0;Q<z;Q+=1)te[Q]||(te[Q]="");G.length<=1?te[z]=G:te=te.slice(0,z).concat(V5(G)),te=te.slice(0,r);for(let Q=te.length-1;Q>=0&&!te[Q];Q-=1)te.pop();const ie=A(te.map(Q=>Q||" ").join(""));return te=V5(ie).map((Q,ge)=>Q===" "&&!te[ge]?te[ge]:Q),te}),B=(z,G)=>{var te;const ie=N(z,G),Q=Math.min(z+G.length,r-1);Q!==z&&((te=R.current[Q])===null||te===void 0||te.focus()),j(ie)},U=z=>{var G;(G=R.current[z])===null||G===void 0||G.focus()},K={variant:l,disabled:u,status:D,mask:f};return E(y.createElement("div",Object.assign({},b,{ref:M,className:Ue(v,{[`${v}-sm`]:I==="small",[`${v}-lg`]:I==="large",[`${v}-rtl`]:m==="rtl"},C,w)}),y.createElement(nu.Provider,{value:O},Array.from({length:r}).map((z,G)=>{const te=`otp-${G}`,ie=k[G]||"";return y.createElement(b2t,Object.assign({ref:Q=>{R.current[G]=Q},key:te,index:G,size:I,htmlSize:1,className:`${v}-input`,onChange:B,value:ie,onActiveChange:U,autoFocus:G===0&&h},K))}))))});var w2t={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M942.2 486.2Q889.47 375.11 816.7 305l-50.88 50.88C807.31 395.53 843.45 447.4 874.7 512 791.5 684.2 673.4 766 512 766q-72.67 0-133.87-22.38L323 798.75Q408 838 512 838q288.3 0 430.2-300.3a60.29 60.29 0 000-51.5zm-63.57-320.64L836 122.88a8 8 0 00-11.32 0L715.31 232.2Q624.86 186 512 186q-288.3 0-430.2 300.3a60.3 60.3 0 000 51.5q56.69 119.4 136.5 191.41L112.48 835a8 8 0 000 11.31L155.17 889a8 8 0 0011.31 0l712.15-712.12a8 8 0 000-11.32zM149.3 512C232.6 339.8 350.7 258 512 258c54.54 0 104.13 9.36 149.12 28.39l-70.3 70.3a176 176 0 00-238.13 238.13l-83.42 83.42C223.1 637.49 183.3 582.28 149.3 512zm246.7 0a112.11 112.11 0 01146.2-106.69L401.31 546.2A112 112 0 01396 512z"}},{tag:"path",attrs:{d:"M508 624c-3.46 0-6.87-.16-10.25-.47l-52.82 52.82a176.09 176.09 0 00227.42-227.42l-52.82 52.82c.31 3.38.47 6.79.47 10.25a111.94 111.94 0 01-112 112z"}}]},name:"eye-invisible",theme:"outlined"},C2t=function(e,t){return y.createElement(_a,ln({},e,{ref:t,icon:w2t}))},x2t=y.forwardRef(C2t),E2t={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M942.2 486.2C847.4 286.5 704.1 186 512 186c-192.2 0-335.4 100.5-430.2 300.3a60.3 60.3 0 000 51.5C176.6 737.5 319.9 838 512 838c192.2 0 335.4-100.5 430.2-300.3 7.7-16.2 7.7-35 0-51.5zM512 766c-161.3 0-279.4-81.8-362.7-254C232.6 339.8 350.7 258 512 258c161.3 0 279.4 81.8 362.7 254C791.5 684.2 673.4 766 512 766zm-4-430c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176zm0 288c-61.9 0-112-50.1-112-112s50.1-112 112-112 112 50.1 112 112-50.1 112-112 112z"}}]},name:"eye",theme:"outlined"},I2t=function(e,t){return y.createElement(_a,ln({},e,{ref:t,icon:E2t}))},P2t=y.forwardRef(I2t),k2t=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t};const T2t=n=>n?y.createElement(P2t,null):y.createElement(x2t,null),D2t={click:"onClick",hover:"onMouseOver"},R2t=y.forwardRef((n,e)=>{const{disabled:t,action:r="click",visibilityToggle:i=!0,iconRender:o=T2t}=n,s=typeof i=="object"&&i.visible!==void 0,[a,c]=y.useState(()=>s?i.visible:!1),l=y.useRef(null);y.useEffect(()=>{s&&c(i.visible)},[s,i]);const u=nMe(l),d=()=>{t||(a&&u(),c(T=>{var D;const O=!T;return typeof i=="object"&&((D=i.onVisibleChange)===null||D===void 0||D.call(i,O)),O}))},h=T=>{const D=D2t[r]||"",O=o(a),M={[D]:d,className:`${T}-icon`,key:"passwordIcon",onMouseDown:R=>{R.preventDefault()},onMouseUp:R=>{R.preventDefault()}};return y.cloneElement(y.isValidElement(O)?O:y.createElement("span",null,O),M)},{className:f,prefixCls:p,inputPrefixCls:g,size:m}=n,v=k2t(n,["className","prefixCls","inputPrefixCls","size"]),{getPrefixCls:b}=y.useContext(fr),S=b("input",g),E=b("input-password",p),w=i&&h(E),C=Ue(E,f,{[`${E}-${m}`]:!!m}),I=Object.assign(Object.assign({},Yc(v,["suffix","iconRender","visibilityToggle"])),{type:a?"text":"password",className:C,prefixCls:S,suffix:w});return m&&(I.size=m),y.createElement(lN,Object.assign({ref:Gd(e,l)},I))});var A2t=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t};const O2t=y.forwardRef((n,e)=>{const{prefixCls:t,inputPrefixCls:r,className:i,size:o,suffix:s,enterButton:a=!1,addonAfter:c,loading:l,disabled:u,onSearch:d,onChange:h,onCompositionStart:f,onCompositionEnd:p}=n,g=A2t(n,["prefixCls","inputPrefixCls","className","size","suffix","enterButton","addonAfter","loading","disabled","onSearch","onChange","onCompositionStart","onCompositionEnd"]),{getPrefixCls:m,direction:v}=y.useContext(fr),b=y.useRef(!1),S=m("input-search",t),E=m("input",r),{compactSize:w}=mD(S,v),C=_v(K=>{var z;return(z=o??w)!==null&&z!==void 0?z:K}),I=y.useRef(null),T=K=>{K!=null&&K.target&&K.type==="click"&&d&&d(K.target.value,K,{source:"clear"}),h==null||h(K)},D=K=>{var z;document.activeElement===((z=I.current)===null||z===void 0?void 0:z.input)&&K.preventDefault()},O=K=>{var z,G;d&&d((G=(z=I.current)===null||z===void 0?void 0:z.input)===null||G===void 0?void 0:G.value,K,{source:"input"})},M=K=>{b.current||l||O(K)},R=typeof a=="boolean"?y.createElement(hOe,null):null,A=`${S}-button`;let k;const L=a||{},j=L.type&&L.type.__ANT_BUTTON===!0;j||L.type==="button"?k=gg(L,Object.assign({onMouseDown:D,onClick:K=>{var z,G;(G=(z=L==null?void 0:L.props)===null||z===void 0?void 0:z.onClick)===null||G===void 0||G.call(z,K),O(K)},key:"enterButton"},j?{className:A,size:C}:{})):k=y.createElement(mg,{className:A,type:a?"primary":void 0,size:C,disabled:u,key:"enterButton",onMouseDown:D,onClick:O,loading:l,icon:R},a),c&&(k=[k,gg(c,{key:"addonAfter"})]);const N=Ue(S,{[`${S}-rtl`]:v==="rtl",[`${S}-${C}`]:!!C,[`${S}-with-button`]:!!a},i),B=K=>{b.current=!0,f==null||f(K)},U=K=>{b.current=!1,p==null||p(K)};return y.createElement(lN,Object.assign({ref:Gd(I,e),onPressEnter:M},g,{size:C,onCompositionStart:B,onCompositionEnd:U,prefixCls:E,addonAfter:k,suffix:s,onChange:T,className:N,disabled:u}))});var M2t=`
  min-height:0 !important;
  max-height:none !important;
  height:0 !important;
  visibility:hidden !important;
  overflow:hidden !important;
  position:absolute !important;
  z-index:-1000 !important;
  top:0 !important;
  right:0 !important;
  pointer-events: none !important;
`,$2t=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","font-variant","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing","word-break","white-space"],zH={},ph;function L2t(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,t=n.getAttribute("id")||n.getAttribute("data-reactid")||n.getAttribute("name");if(e&&zH[t])return zH[t];var r=window.getComputedStyle(n),i=r.getPropertyValue("box-sizing")||r.getPropertyValue("-moz-box-sizing")||r.getPropertyValue("-webkit-box-sizing"),o=parseFloat(r.getPropertyValue("padding-bottom"))+parseFloat(r.getPropertyValue("padding-top")),s=parseFloat(r.getPropertyValue("border-bottom-width"))+parseFloat(r.getPropertyValue("border-top-width")),a=$2t.map(function(l){return"".concat(l,":").concat(r.getPropertyValue(l))}).join(";"),c={sizingStyle:a,paddingSize:o,borderSize:s,boxSizing:i};return e&&t&&(zH[t]=c),c}function N2t(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;ph||(ph=document.createElement("textarea"),ph.setAttribute("tab-index","-1"),ph.setAttribute("aria-hidden","true"),document.body.appendChild(ph)),n.getAttribute("wrap")?ph.setAttribute("wrap",n.getAttribute("wrap")):ph.removeAttribute("wrap");var i=L2t(n,e),o=i.paddingSize,s=i.borderSize,a=i.boxSizing,c=i.sizingStyle;ph.setAttribute("style","".concat(c,";").concat(M2t)),ph.value=n.value||n.placeholder||"";var l=void 0,u=void 0,d,h=ph.scrollHeight;if(a==="border-box"?h+=s:a==="content-box"&&(h-=o),t!==null||r!==null){ph.value=" ";var f=ph.scrollHeight-o;t!==null&&(l=f*t,a==="border-box"&&(l=l+o+s),h=Math.max(l,h)),r!==null&&(u=f*r,a==="border-box"&&(u=u+o+s),d=h>u?"":"hidden",h=Math.min(u,h))}var p={height:h,overflowY:d,resize:"none"};return l&&(p.minHeight=l),u&&(p.maxHeight=u),p}var F2t=["prefixCls","defaultValue","value","autoSize","onResize","className","style","disabled","onChange","onInternalAutoSize"],VH=0,WH=1,qH=2,j2t=y.forwardRef(function(n,e){var t=n,r=t.prefixCls,i=t.defaultValue,o=t.value,s=t.autoSize,a=t.onResize,c=t.className,l=t.style,u=t.disabled,d=t.onChange;t.onInternalAutoSize;var h=jr(t,F2t),f=Ql(i,{value:o,postState:function(ie){return ie??""}}),p=rt(f,2),g=p[0],m=p[1],v=function(ie){m(ie.target.value),d==null||d(ie)},b=y.useRef();y.useImperativeHandle(e,function(){return{textArea:b.current}});var S=y.useMemo(function(){return s&&Wn(s)==="object"?[s.minRows,s.maxRows]:[]},[s]),E=rt(S,2),w=E[0],C=E[1],I=!!s,T=function(){try{if(document.activeElement===b.current){var ie=b.current,Q=ie.selectionStart,ge=ie.selectionEnd,_e=ie.scrollTop;b.current.setSelectionRange(Q,ge),b.current.scrollTop=_e}}catch{}},D=y.useState(qH),O=rt(D,2),M=O[0],R=O[1],A=y.useState(),k=rt(A,2),L=k[0],j=k[1],N=function(){R(VH)};es(function(){I&&N()},[o,w,C,I]),es(function(){if(M===VH)R(WH);else if(M===WH){var te=N2t(b.current,!1,w,C);R(qH),j(te)}else T()},[M]);var B=y.useRef(),U=function(){no.cancel(B.current)},K=function(ie){M===qH&&(a==null||a(ie),s&&(U(),B.current=no(function(){N()})))};y.useEffect(function(){return U},[]);var z=I?L:null,G=$e($e({},l),z);return(M===VH||M===WH)&&(G.overflowY="hidden",G.overflowX="hidden"),y.createElement(Wy,{onResize:K,disabled:!(s||a)},y.createElement("textarea",ln({},h,{ref:b,style:G,className:Ue(r,c,Le({},"".concat(r,"-disabled"),u)),disabled:u,value:g,onChange:v})))}),B2t=["defaultValue","value","onFocus","onBlur","onChange","allowClear","maxLength","onCompositionStart","onCompositionEnd","suffix","prefixCls","showCount","count","className","style","disabled","hidden","classNames","styles","onResize","onClear","onPressEnter","readOnly","autoSize","onKeyDown"],H2t=Ke.forwardRef(function(n,e){var t,r=n.defaultValue,i=n.value,o=n.onFocus,s=n.onBlur,a=n.onChange,c=n.allowClear,l=n.maxLength,u=n.onCompositionStart,d=n.onCompositionEnd,h=n.suffix,f=n.prefixCls,p=f===void 0?"rc-textarea":f,g=n.showCount,m=n.count,v=n.className,b=n.style,S=n.disabled,E=n.hidden,w=n.classNames,C=n.styles,I=n.onResize,T=n.onClear,D=n.onPressEnter,O=n.readOnly,M=n.autoSize,R=n.onKeyDown,A=jr(n,B2t),k=Ql(r,{value:i,defaultValue:r}),L=rt(k,2),j=L[0],N=L[1],B=j==null?"":String(j),U=Ke.useState(!1),K=rt(U,2),z=K[0],G=K[1],te=Ke.useRef(!1),ie=Ke.useState(null),Q=rt(ie,2),ge=Q[0],_e=Q[1],Se=y.useRef(null),se=y.useRef(null),ee=function(){var Xt;return(Xt=se.current)===null||Xt===void 0?void 0:Xt.textArea},Y=function(){ee().focus()};y.useImperativeHandle(e,function(){var Rt;return{resizableTextArea:se.current,focus:Y,blur:function(){ee().blur()},nativeElement:((Rt=Se.current)===null||Rt===void 0?void 0:Rt.nativeElement)||ee()}}),y.useEffect(function(){G(function(Rt){return!S&&Rt})},[S]);var ue=Ke.useState(null),ye=rt(ue,2),V=ye[0],le=ye[1];Ke.useEffect(function(){if(V){var Rt;(Rt=ee()).setSelectionRange.apply(Rt,Ht(V))}},[V]);var he=eMe(m,g),oe=(t=he.max)!==null&&t!==void 0?t:l,ne=Number(oe)>0,ce=he.strategy(B),Ae=!!oe&&ce>oe,Ie=function(Xt,yn){var bn=yn;!te.current&&he.exceedFormatter&&he.max&&he.strategy(yn)>he.max&&(bn=he.exceedFormatter(yn,{max:he.max}),yn!==bn&&le([ee().selectionStart||0,ee().selectionEnd||0])),N(bn),A8(Xt.currentTarget,Xt,a,bn)},be=function(Xt){te.current=!0,u==null||u(Xt)},De=function(Xt){te.current=!1,Ie(Xt,Xt.currentTarget.value),d==null||d(Xt)},Me=function(Xt){Ie(Xt,Xt.target.value)},He=function(Xt){Xt.key==="Enter"&&D&&D(Xt),R==null||R(Xt)},Je=function(Xt){G(!0),o==null||o(Xt)},qe=function(Xt){G(!1),s==null||s(Xt)},Ge=function(Xt){N(""),Y(),A8(ee(),Xt,a)},St=h,Pt;he.show&&(he.showFormatter?Pt=he.showFormatter({value:B,count:ce,maxLength:oe}):Pt="".concat(ce).concat(ne?" / ".concat(oe):""),St=Ke.createElement(Ke.Fragment,null,St,Ke.createElement("span",{className:Ue("".concat(p,"-data-count"),w==null?void 0:w.count),style:C==null?void 0:C.count},Pt)));var on=function(Xt){var yn;I==null||I(Xt),(yn=ee())!==null&&yn!==void 0&&yn.style.height&&_e(!0)},an=!M&&!g&&!c;return Ke.createElement(QOe,{ref:Se,value:B,allowClear:c,handleReset:Ge,suffix:St,prefixCls:p,classNames:$e($e({},w),{},{affixWrapper:Ue(w==null?void 0:w.affixWrapper,Le(Le({},"".concat(p,"-show-count"),g),"".concat(p,"-textarea-allow-clear"),c))}),disabled:S,focused:z,className:Ue(v,Ae&&"".concat(p,"-out-of-range")),style:$e($e({},b),ge&&!an?{height:"auto"}:{}),dataAttrs:{affixWrapper:{"data-count":typeof Pt=="string"?Pt:void 0}},hidden:E,readOnly:O,onClear:T},Ke.createElement(j2t,ln({},A,{autoSize:M,maxLength:l,onKeyDown:He,onChange:Me,onFocus:Je,onBlur:qe,onCompositionStart:be,onCompositionEnd:De,className:Ue(w==null?void 0:w.textarea),style:$e($e({},C==null?void 0:C.textarea),{},{resize:b==null?void 0:b.resize}),disabled:S,prefixCls:p,onResize:on,ref:se,readOnly:O})))}),U2t=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t};const z2t=y.forwardRef((n,e)=>{var t,r;const{prefixCls:i,bordered:o=!0,size:s,disabled:a,status:c,allowClear:l,classNames:u,rootClassName:d,className:h,style:f,styles:p,variant:g}=n,m=U2t(n,["prefixCls","bordered","size","disabled","status","allowClear","classNames","rootClassName","className","style","styles","variant"]),{getPrefixCls:v,direction:b,textArea:S}=y.useContext(fr),E=_v(s),w=y.useContext(fg),C=a??w,{status:I,hasFeedback:T,feedbackIcon:D}=y.useContext(nu),O=iN(I,c),M=y.useRef(null);y.useImperativeHandle(e,()=>{var K;return{resizableTextArea:(K=M.current)===null||K===void 0?void 0:K.resizableTextArea,focus:z=>{var G,te;g2t((te=(G=M.current)===null||G===void 0?void 0:G.resizableTextArea)===null||te===void 0?void 0:te.textArea,z)},blur:()=>{var z;return(z=M.current)===null||z===void 0?void 0:z.blur()}}});const R=v("input",i),A=Qc(R),[k,L,j]=vre(R,A),[N,B]=are("textArea",g,o),U=tMe(l??(S==null?void 0:S.allowClear));return k(y.createElement(H2t,Object.assign({autoComplete:S==null?void 0:S.autoComplete},m,{style:Object.assign(Object.assign({},S==null?void 0:S.style),f),styles:Object.assign(Object.assign({},S==null?void 0:S.styles),p),disabled:C,allowClear:U,className:Ue(j,A,h,d,S==null?void 0:S.className),classNames:Object.assign(Object.assign(Object.assign({},u),S==null?void 0:S.classNames),{textarea:Ue({[`${R}-sm`]:E==="small",[`${R}-lg`]:E==="large"},L,u==null?void 0:u.textarea,(t=S==null?void 0:S.classNames)===null||t===void 0?void 0:t.textarea),variant:Ue({[`${R}-${N}`]:B},P8(R,O)),affixWrapper:Ue(`${R}-textarea-affix-wrapper`,{[`${R}-affix-wrapper-rtl`]:b==="rtl",[`${R}-affix-wrapper-sm`]:E==="small",[`${R}-affix-wrapper-lg`]:E==="large",[`${R}-textarea-show-count`]:n.showCount||((r=n.count)===null||r===void 0?void 0:r.show)},L)}),prefixCls:R,suffix:T&&y.createElement("span",{className:`${R}-textarea-suffix`},D),ref:M})))}),qm=lN;qm.Group=h2t;qm.Search=O2t;qm.TextArea=z2t;qm.Password=R2t;qm.OTP=_2t;function v0e(n){return["small","middle","large"].includes(n)}function y0e(n){return n?typeof n=="number"&&!Number.isNaN(n):!1}const rMe=Ke.createContext({latestIndex:0}),V2t=rMe.Provider,W2t=n=>{let{className:e,index:t,children:r,split:i,style:o}=n;const{latestIndex:s}=y.useContext(rMe);return r==null?null:y.createElement(y.Fragment,null,y.createElement("div",{className:e,style:o},r),t<s&&i&&y.createElement("span",{className:`${e}-split`},i))};var q2t=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t};const K2t=y.forwardRef((n,e)=>{var t,r,i;const{getPrefixCls:o,space:s,direction:a}=y.useContext(fr),{size:c=(t=s==null?void 0:s.size)!==null&&t!==void 0?t:"small",align:l,className:u,rootClassName:d,children:h,direction:f="horizontal",prefixCls:p,split:g,style:m,wrap:v=!1,classNames:b,styles:S}=n,E=q2t(n,["size","align","className","rootClassName","children","direction","prefixCls","split","style","wrap","classNames","styles"]),[w,C]=Array.isArray(c)?c:[c,c],I=v0e(C),T=v0e(w),D=y0e(C),O=y0e(w),M=hg(h,{keepEmpty:!0}),R=l===void 0&&f==="horizontal"?"center":l,A=o("space",p),[k,L,j]=r4e(A),N=Ue(A,s==null?void 0:s.className,L,`${A}-${f}`,{[`${A}-rtl`]:a==="rtl",[`${A}-align-${R}`]:R,[`${A}-gap-row-${C}`]:I,[`${A}-gap-col-${w}`]:T},u,d,j),B=Ue(`${A}-item`,(r=b==null?void 0:b.item)!==null&&r!==void 0?r:(i=s==null?void 0:s.classNames)===null||i===void 0?void 0:i.item);let U=0;const K=M.map((te,ie)=>{var Q,ge;te!=null&&(U=ie);const _e=(te==null?void 0:te.key)||`${B}-${ie}`;return y.createElement(W2t,{className:B,key:_e,index:ie,split:g,style:(Q=S==null?void 0:S.item)!==null&&Q!==void 0?Q:(ge=s==null?void 0:s.styles)===null||ge===void 0?void 0:ge.item},te)}),z=y.useMemo(()=>({latestIndex:U}),[U]);if(M.length===0)return null;const G={};return v&&(G.flexWrap="wrap"),!T&&O&&(G.columnGap=w),!I&&D&&(G.rowGap=C),k(y.createElement("div",Object.assign({ref:e,className:N,style:Object.assign(Object.assign(Object.assign({},G),s==null?void 0:s.style),m)},E),y.createElement(V2t,{value:z},K)))}),iMe=K2t;iMe.Compact=b0t;var G2t=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t};const oMe=n=>{const{getPopupContainer:e,getPrefixCls:t,direction:r}=y.useContext(fr),{prefixCls:i,type:o="default",danger:s,disabled:a,loading:c,onClick:l,htmlType:u,children:d,className:h,menu:f,arrow:p,autoFocus:g,overlay:m,trigger:v,align:b,open:S,onOpenChange:E,placement:w,getPopupContainer:C,href:I,icon:T=y.createElement(OOe,null),title:D,buttonsRender:O=Se=>Se,mouseEnterDelay:M,mouseLeaveDelay:R,overlayClassName:A,overlayStyle:k,destroyPopupOnHide:L,dropdownRender:j}=n,N=G2t(n,["prefixCls","type","danger","disabled","loading","onClick","htmlType","children","className","menu","arrow","autoFocus","overlay","trigger","align","open","onOpenChange","placement","getPopupContainer","href","icon","title","buttonsRender","mouseEnterDelay","mouseLeaveDelay","overlayClassName","overlayStyle","destroyPopupOnHide","dropdownRender"]),B=t("dropdown",i),U=`${B}-button`,K={menu:f,arrow:p,autoFocus:g,align:b,disabled:a,trigger:a?[]:v,onOpenChange:E,getPopupContainer:C||e,mouseEnterDelay:M,mouseLeaveDelay:R,overlayClassName:A,overlayStyle:k,destroyPopupOnHide:L,dropdownRender:j},{compactSize:z,compactItemClassnames:G}=mD(B,r),te=Ue(U,G,h);"overlay"in n&&(K.overlay=m),"open"in n&&(K.open=S),"placement"in n?K.placement=w:K.placement=r==="rtl"?"bottomLeft":"bottomRight";const ie=y.createElement(mg,{type:o,danger:s,disabled:a,loading:c,onClick:l,htmlType:u,href:I,title:D},d),Q=y.createElement(mg,{type:o,danger:s,icon:T}),[ge,_e]=O([ie,Q]);return y.createElement(iMe.Compact,Object.assign({className:te,size:z,block:!0},N),ge,y.createElement(cN,Object.assign({},K),_e))};oMe.__ANT_BUTTON=!0;const sMe=cN;sMe.Button=oMe;function O8(n){const[e,t]=y.useState(n);return y.useEffect(()=>{const r=setTimeout(()=>{t(n)},n.length?0:10);return()=>{clearTimeout(r)}},[n]),e}const Z2t=n=>{const{componentCls:e}=n,t=`${e}-show-help`,r=`${e}-show-help-item`;return{[t]:{transition:`opacity ${n.motionDurationSlow} ${n.motionEaseInOut}`,"&-appear, &-enter":{opacity:0,"&-active":{opacity:1}},"&-leave":{opacity:1,"&-active":{opacity:0}},[r]:{overflow:"hidden",transition:`height ${n.motionDurationSlow} ${n.motionEaseInOut},
                     opacity ${n.motionDurationSlow} ${n.motionEaseInOut},
                     transform ${n.motionDurationSlow} ${n.motionEaseInOut} !important`,[`&${r}-appear, &${r}-enter`]:{transform:"translateY(-5px)",opacity:0,"&-active":{transform:"translateY(0)",opacity:1}},[`&${r}-leave-active`]:{transform:"translateY(-5px)"}}}}},X2t=n=>({legend:{display:"block",width:"100%",marginBottom:n.marginLG,padding:0,color:n.colorTextDescription,fontSize:n.fontSizeLG,lineHeight:"inherit",border:0,borderBottom:`${Ct(n.lineWidth)} ${n.lineType} ${n.colorBorder}`},'input[type="search"]':{boxSizing:"border-box"},'input[type="radio"], input[type="checkbox"]':{lineHeight:"normal"},'input[type="file"]':{display:"block"},'input[type="range"]':{display:"block",width:"100%"},"select[multiple], select[size]":{height:"auto"},"input[type='file']:focus,\n  input[type='radio']:focus,\n  input[type='checkbox']:focus":{outline:0,boxShadow:`0 0 0 ${Ct(n.controlOutlineWidth)} ${n.controlOutline}`},output:{display:"block",paddingTop:15,color:n.colorText,fontSize:n.fontSize,lineHeight:n.lineHeight}}),b0e=(n,e)=>{const{formItemCls:t}=n;return{[t]:{[`${t}-label > label`]:{height:e},[`${t}-control-input`]:{minHeight:e}}}},Y2t=n=>{const{componentCls:e}=n;return{[n.componentCls]:Object.assign(Object.assign(Object.assign({},gc(n)),X2t(n)),{[`${e}-text`]:{display:"inline-block",paddingInlineEnd:n.paddingSM},"&-small":Object.assign({},b0e(n,n.controlHeightSM)),"&-large":Object.assign({},b0e(n,n.controlHeightLG))})}},J2t=n=>{const{formItemCls:e,iconCls:t,componentCls:r,rootPrefixCls:i,antCls:o,labelRequiredMarkColor:s,labelColor:a,labelFontSize:c,labelHeight:l,labelColonMarginInlineStart:u,labelColonMarginInlineEnd:d,itemMarginBottom:h}=n;return{[e]:Object.assign(Object.assign({},gc(n)),{marginBottom:h,verticalAlign:"top","&-with-help":{transition:"none"},[`&-hidden,
        &-hidden${o}-row`]:{display:"none"},"&-has-warning":{[`${e}-split`]:{color:n.colorError}},"&-has-error":{[`${e}-split`]:{color:n.colorWarning}},[`${e}-label`]:{flexGrow:0,overflow:"hidden",whiteSpace:"nowrap",textAlign:"end",verticalAlign:"middle","&-left":{textAlign:"start"},"&-wrap":{overflow:"unset",lineHeight:n.lineHeight,whiteSpace:"unset"},"> label":{position:"relative",display:"inline-flex",alignItems:"center",maxWidth:"100%",height:l,color:a,fontSize:c,[`> ${t}`]:{fontSize:n.fontSize,verticalAlign:"top"},[`&${e}-required:not(${e}-required-mark-optional)::before`]:{display:"inline-block",marginInlineEnd:n.marginXXS,color:s,fontSize:n.fontSize,fontFamily:"SimSun, sans-serif",lineHeight:1,content:'"*"',[`${r}-hide-required-mark &`]:{display:"none"}},[`${e}-optional`]:{display:"inline-block",marginInlineStart:n.marginXXS,color:n.colorTextDescription,[`${r}-hide-required-mark &`]:{display:"none"}},[`${e}-tooltip`]:{color:n.colorTextDescription,cursor:"help",writingMode:"horizontal-tb",marginInlineStart:n.marginXXS},"&::after":{content:'":"',position:"relative",marginBlock:0,marginInlineStart:u,marginInlineEnd:d},[`&${e}-no-colon::after`]:{content:'"\\a0"'}}},[`${e}-control`]:{"--ant-display":"flex",flexDirection:"column",flexGrow:1,[`&:first-child:not([class^="'${i}-col-'"]):not([class*="' ${i}-col-'"])`]:{width:"100%"},"&-input":{position:"relative",display:"flex",alignItems:"center",minHeight:n.controlHeight,"&-content":{flex:"auto",maxWidth:"100%"}}},[e]:{"&-explain, &-extra":{clear:"both",color:n.colorTextDescription,fontSize:n.fontSize,lineHeight:n.lineHeight},"&-explain-connected":{width:"100%"},"&-extra":{minHeight:n.controlHeightSM,transition:`color ${n.motionDurationMid} ${n.motionEaseOut}`},"&-explain":{"&-error":{color:n.colorError},"&-warning":{color:n.colorWarning}}},[`&-with-help ${e}-explain`]:{height:"auto",opacity:1},[`${e}-feedback-icon`]:{fontSize:n.fontSize,textAlign:"center",visibility:"visible",animationName:nre,animationDuration:n.motionDurationMid,animationTimingFunction:n.motionEaseOutBack,pointerEvents:"none","&-success":{color:n.colorSuccess},"&-error":{color:n.colorError},"&-warning":{color:n.colorWarning},"&-validating":{color:n.colorPrimary}}})}},S0e=(n,e)=>{const{formItemCls:t}=n;return{[`${e}-horizontal`]:{[`${t}-label`]:{flexGrow:0},[`${t}-control`]:{flex:"1 1 0",minWidth:0},[`${t}-label[class$='-24'], ${t}-label[class*='-24 ']`]:{[`& + ${t}-control`]:{minWidth:"unset"}}}}},Q2t=n=>{const{componentCls:e,formItemCls:t,inlineItemMarginBottom:r}=n;return{[`${e}-inline`]:{display:"flex",flexWrap:"wrap",[t]:{flex:"none",marginInlineEnd:n.margin,marginBottom:r,"&-row":{flexWrap:"nowrap"},[`> ${t}-label,
        > ${t}-control`]:{display:"inline-block",verticalAlign:"top"},[`> ${t}-label`]:{flex:"none"},[`${e}-text`]:{display:"inline-block"},[`${t}-has-feedback`]:{display:"inline-block"}}}}},Rf=n=>({padding:n.verticalLabelPadding,margin:n.verticalLabelMargin,whiteSpace:"initial",textAlign:"start","> label":{margin:0,"&::after":{visibility:"hidden"}}}),aMe=n=>{const{componentCls:e,formItemCls:t,rootPrefixCls:r}=n;return{[`${t} ${t}-label`]:Rf(n),[`${e}:not(${e}-inline)`]:{[t]:{flexWrap:"wrap",[`${t}-label, ${t}-control`]:{[`&:not([class*=" ${r}-col-xs"])`]:{flex:"0 0 100%",maxWidth:"100%"}}}}}},ext=n=>{const{componentCls:e,formItemCls:t,antCls:r}=n;return{[`${e}-vertical`]:{[`${t}:not(${t}-horizontal)`]:{[`${t}-row`]:{flexDirection:"column"},[`${t}-label > label`]:{height:"auto"},[`${t}-control`]:{width:"100%"},[`${t}-label,
        ${r}-col-24${t}-label,
        ${r}-col-xl-24${t}-label`]:Rf(n)}},[`@media (max-width: ${Ct(n.screenXSMax)})`]:[aMe(n),{[e]:{[`${t}:not(${t}-horizontal)`]:{[`${r}-col-xs-24${t}-label`]:Rf(n)}}}],[`@media (max-width: ${Ct(n.screenSMMax)})`]:{[e]:{[`${t}:not(${t}-horizontal)`]:{[`${r}-col-sm-24${t}-label`]:Rf(n)}}},[`@media (max-width: ${Ct(n.screenMDMax)})`]:{[e]:{[`${t}:not(${t}-horizontal)`]:{[`${r}-col-md-24${t}-label`]:Rf(n)}}},[`@media (max-width: ${Ct(n.screenLGMax)})`]:{[e]:{[`${t}:not(${t}-horizontal)`]:{[`${r}-col-lg-24${t}-label`]:Rf(n)}}}}},txt=n=>{const{formItemCls:e,antCls:t}=n;return{[`${e}-vertical`]:{[`${e}-row`]:{flexDirection:"column"},[`${e}-label > label`]:{height:"auto"},[`${e}-control`]:{width:"100%"}},[`${e}-vertical ${e}-label,
      ${t}-col-24${e}-label,
      ${t}-col-xl-24${e}-label`]:Rf(n),[`@media (max-width: ${Ct(n.screenXSMax)})`]:[aMe(n),{[e]:{[`${t}-col-xs-24${e}-label`]:Rf(n)}}],[`@media (max-width: ${Ct(n.screenSMMax)})`]:{[e]:{[`${t}-col-sm-24${e}-label`]:Rf(n)}},[`@media (max-width: ${Ct(n.screenMDMax)})`]:{[e]:{[`${t}-col-md-24${e}-label`]:Rf(n)}},[`@media (max-width: ${Ct(n.screenLGMax)})`]:{[e]:{[`${t}-col-lg-24${e}-label`]:Rf(n)}}}},nxt=n=>({labelRequiredMarkColor:n.colorError,labelColor:n.colorTextHeading,labelFontSize:n.fontSize,labelHeight:n.controlHeight,labelColonMarginInlineStart:n.marginXXS/2,labelColonMarginInlineEnd:n.marginXS,itemMarginBottom:n.marginLG,verticalLabelPadding:`0 0 ${n.paddingXS}px`,verticalLabelMargin:0,inlineItemMarginBottom:0}),cMe=(n,e)=>oo(n,{formItemCls:`${n.componentCls}-item`,rootPrefixCls:e}),yre=Jc("Form",(n,e)=>{let{rootPrefixCls:t}=e;const r=cMe(n,t);return[Y2t(r),J2t(r),Z2t(r),S0e(r,r.componentCls),S0e(r,r.formItemCls),Q2t(r),ext(r),txt(r),A4e(r),nre]},nxt,{order:-1e3}),_0e=[];function KH(n,e,t){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;return{key:typeof n=="string"?n:`${e}-${r}`,error:n,errorStatus:t}}const lMe=n=>{let{help:e,helpStatus:t,errors:r=_0e,warnings:i=_0e,className:o,fieldId:s,onVisibleChanged:a}=n;const{prefixCls:c}=y.useContext(Yne),l=`${c}-item-explain`,u=Qc(c),[d,h,f]=yre(c,u),p=y.useMemo(()=>eZ(c),[c]),g=O8(r),m=O8(i),v=y.useMemo(()=>e!=null?[KH(e,"help",t)]:[].concat(Ht(g.map((S,E)=>KH(S,"error","error",E))),Ht(m.map((S,E)=>KH(S,"warning","warning",E)))),[e,t,g,m]),b={};return s&&(b.id=`${s}_help`),d(y.createElement(bv,{motionDeadline:p.motionDeadline,motionName:`${c}-show-help`,visible:!!v.length,onVisibleChanged:a},S=>{const{className:E,style:w}=S;return y.createElement("div",Object.assign({},b,{className:Ue(l,E,f,u,o,h),style:w,role:"alert"}),y.createElement(FAe,Object.assign({keys:v},eZ(c),{motionName:`${c}-show-help-item`,component:!1}),C=>{const{key:I,error:T,errorStatus:D,className:O,style:M}=C;return y.createElement("div",{key:I,className:Ue(O,{[`${l}-${D}`]:D}),style:M},T)}))}))},rxt=["parentNode"],ixt="form_item";function uk(n){return n===void 0||n===!1?[]:Array.isArray(n)?n:[n]}function uMe(n,e){if(!n.length)return;const t=n.join("_");return e?`${e}_${t}`:rxt.includes(t)?`${ixt}_${t}`:t}function dMe(n,e,t,r,i,o){let s=r;return o!==void 0?s=o:t.validating?s="validating":n.length?s="error":e.length?s="warning":(t.touched||i&&t.validated)&&(s="success"),s}function w0e(n){return uk(n).join("_")}function oxt(n,e){const t=e.getFieldInstance(n),r=O5e(t);if(r)return r;const i=uMe(uk(n),e.__INTERNAL__.name);if(i)return document.getElementById(i)}function hMe(n){const[e]=Xne(),t=y.useRef({}),r=y.useMemo(()=>n??Object.assign(Object.assign({},e),{__INTERNAL__:{itemRef:i=>o=>{const s=w0e(i);o?t.current[s]=o:delete t.current[s]}},scrollToField:function(i){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s=oxt(i,r);s&&Cvt(s,Object.assign({scrollMode:"if-needed",block:"nearest"},o))},getFieldInstance:i=>{const o=w0e(i);return t.current[o]}}),[n,e]);return[r]}var sxt=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t};const axt=(n,e)=>{const t=y.useContext(fg),{getPrefixCls:r,direction:i,form:o}=y.useContext(fr),{prefixCls:s,className:a,rootClassName:c,size:l,disabled:u=t,form:d,colon:h,labelAlign:f,labelWrap:p,labelCol:g,wrapperCol:m,hideRequiredMark:v,layout:b="horizontal",scrollToFirstError:S,requiredMark:E,onFinishFailed:w,name:C,style:I,feedbackIcons:T,variant:D}=n,O=sxt(n,["prefixCls","className","rootClassName","size","disabled","form","colon","labelAlign","labelWrap","labelCol","wrapperCol","hideRequiredMark","layout","scrollToFirstError","requiredMark","onFinishFailed","name","style","feedbackIcons","variant"]),M=_v(l),R=y.useContext(hAe),A=y.useMemo(()=>E!==void 0?E:v?!1:o&&o.requiredMark!==void 0?o.requiredMark:!0,[v,E,o]),k=h??(o==null?void 0:o.colon),L=r("form",s),j=Qc(L),[N,B,U]=yre(L,j),K=Ue(L,`${L}-${b}`,{[`${L}-hide-required-mark`]:A===!1,[`${L}-rtl`]:i==="rtl",[`${L}-${M}`]:M},U,j,B,o==null?void 0:o.className,a,c),[z]=hMe(d),{__INTERNAL__:G}=z;G.name=C;const te=y.useMemo(()=>({name:C,labelAlign:f,labelCol:g,labelWrap:p,wrapperCol:m,vertical:b==="vertical",colon:k,requiredMark:A,itemRef:G.itemRef,form:z,feedbackIcons:T}),[C,f,g,m,b,k,A,z,T]),ie=y.useRef(null);y.useImperativeHandle(e,()=>{var _e;return Object.assign(Object.assign({},z),{nativeElement:(_e=ie.current)===null||_e===void 0?void 0:_e.nativeElement})});const Q=(_e,Se)=>{if(_e){let se={block:"nearest"};typeof _e=="object"&&(se=_e),z.scrollToField(Se,se)}},ge=_e=>{if(w==null||w(_e),_e.errorFields.length){const Se=_e.errorFields[0].name;if(S!==void 0){Q(S,Se);return}o&&o.scrollToFirstError!==void 0&&Q(o.scrollToFirstError,Se)}};return N(y.createElement(T4e.Provider,{value:D},y.createElement($ne,{disabled:u},y.createElement(MS.Provider,{value:M},y.createElement(k4e,{validateMessages:R},y.createElement(lv.Provider,{value:te},y.createElement(rE,Object.assign({id:C},O,{name:C,onFinishFailed:ge,form:z,ref:ie,style:Object.assign(Object.assign({},o==null?void 0:o.style),I),className:K}))))))))},cxt=y.forwardRef(axt);function lxt(n){if(typeof n=="function")return n;const e=hg(n);return e.length<=1?e[0]:e}const fMe=()=>{const{status:n,errors:e=[],warnings:t=[]}=y.useContext(nu);return{status:n,errors:e,warnings:t}};fMe.Context=nu;function uxt(n){const[e,t]=y.useState(n),r=y.useRef(null),i=y.useRef([]),o=y.useRef(!1);y.useEffect(()=>(o.current=!1,()=>{o.current=!0,no.cancel(r.current),r.current=null}),[]);function s(a){o.current||(r.current===null&&(i.current=[],r.current=no(()=>{r.current=null,t(c=>{let l=c;return i.current.forEach(u=>{l=u(l)}),l})})),i.current.push(a))}return[e,s]}function dxt(){const{itemRef:n}=y.useContext(lv),e=y.useRef({});function t(r,i){const o=i&&typeof i=="object"&&i.ref,s=r.join("_");return(e.current.name!==s||e.current.originRef!==o)&&(e.current.name=s,e.current.originRef=o,e.current.ref=Gd(n(r),o)),e.current.ref}return t}const hxt=n=>{const{formItemCls:e}=n;return{"@media screen and (-ms-high-contrast: active), (-ms-high-contrast: none)":{[`${e}-control`]:{display:"flex"}}}},fxt=Lne(["Form","item-item"],(n,e)=>{let{rootPrefixCls:t}=e;const r=cMe(n,t);return[hxt(r)]}),pxt=n=>{const{prefixCls:e,status:t,wrapperCol:r,children:i,errors:o,warnings:s,_internalItemRender:a,extra:c,help:l,fieldId:u,marginBottom:d,onErrorVisibleChanged:h}=n,f=`${e}-item`,p=y.useContext(lv),g=r||p.wrapperCol||{},m=Ue(`${f}-control`,g.className),v=y.useMemo(()=>Object.assign({},p),[p]);delete v.labelCol,delete v.wrapperCol;const b=y.createElement("div",{className:`${f}-control-input`},y.createElement("div",{className:`${f}-control-input-content`},i)),S=y.useMemo(()=>({prefixCls:e,status:t}),[e,t]),E=d!==null||o.length||s.length?y.createElement("div",{style:{display:"flex",flexWrap:"nowrap"}},y.createElement(Yne.Provider,{value:S},y.createElement(lMe,{fieldId:u,errors:o,warnings:s,help:l,helpStatus:t,className:`${f}-explain-connected`,onVisibleChanged:h})),!!d&&y.createElement("div",{style:{width:0,height:d}})):null,w={};u&&(w.id=`${u}_extra`);const C=c?y.createElement("div",Object.assign({},w,{className:`${f}-extra`}),c):null,I=a&&a.mark==="pro_table_render"&&a.render?a.render(n,{input:b,errorList:E,extra:C}):y.createElement(y.Fragment,null,b,E,C);return y.createElement(lv.Provider,{value:v},y.createElement(JOe,Object.assign({},g,{className:m}),I),y.createElement(fxt,{prefixCls:e}))};var gxt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M623.6 316.7C593.6 290.4 554 276 512 276s-81.6 14.5-111.6 40.7C369.2 344 352 380.7 352 420v7.6c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V420c0-44.1 43.1-80 96-80s96 35.9 96 80c0 31.1-22 59.6-56.1 72.7-21.2 8.1-39.2 22.3-52.1 40.9-13.1 19-19.9 41.8-19.9 64.9V620c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8v-22.7a48.3 48.3 0 0130.9-44.8c59-22.7 97.1-74.7 97.1-132.5.1-39.3-17.1-76-48.3-103.3zM472 732a40 40 0 1080 0 40 40 0 10-80 0z"}}]},name:"question-circle",theme:"outlined"},mxt=function(e,t){return y.createElement(_a,ln({},e,{ref:t,icon:gxt}))},vxt=y.forwardRef(mxt),yxt=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t};function bxt(n){return n?typeof n=="object"&&!y.isValidElement(n)?n:{title:n}:null}const Sxt=n=>{let{prefixCls:e,label:t,htmlFor:r,labelCol:i,labelAlign:o,colon:s,required:a,requiredMark:c,tooltip:l,vertical:u}=n;var d;const[h]=uD("Form"),{labelAlign:f,labelCol:p,labelWrap:g,colon:m}=y.useContext(lv);if(!t)return null;const v=i||p||{},b=o||f,S=`${e}-item-label`,E=Ue(S,b==="left"&&`${S}-left`,v.className,{[`${S}-wrap`]:!!g});let w=t;const C=s===!0||m!==!1&&s!==!1;C&&!u&&typeof t=="string"&&t.trim()&&(w=t.replace(/[:|：]\s*$/,""));const T=bxt(l);if(T){const{icon:R=y.createElement(vxt,null)}=T,A=yxt(T,["icon"]),k=y.createElement(sE,Object.assign({},A),y.cloneElement(R,{className:`${e}-item-tooltip`,title:"",onClick:L=>{L.preventDefault()},tabIndex:null}));w=y.createElement(y.Fragment,null,w,k)}const D=c==="optional",O=typeof c=="function";O?w=c(w,{required:!!a}):D&&!a&&(w=y.createElement(y.Fragment,null,w,y.createElement("span",{className:`${e}-item-optional`,title:""},(h==null?void 0:h.optional)||((d=xy.Form)===null||d===void 0?void 0:d.optional))));const M=Ue({[`${e}-item-required`]:a,[`${e}-item-required-mark-optional`]:D||O,[`${e}-item-no-colon`]:!C});return y.createElement(JOe,Object.assign({},v,{className:E}),y.createElement("label",{htmlFor:r,className:M,title:typeof t=="string"?t:""},w))},_xt={success:jne,warning:Bne,error:hD,validating:q7};function pMe(n){let{children:e,errors:t,warnings:r,hasFeedback:i,validateStatus:o,prefixCls:s,meta:a,noStyle:c}=n;const l=`${s}-item`,{feedbackIcons:u}=y.useContext(lv),d=dMe(t,r,a,null,!!i,o),{isFormItemInput:h,status:f,hasFeedback:p,feedbackIcon:g}=y.useContext(nu),m=y.useMemo(()=>{var v;let b;if(i){const E=i!==!0&&i.icons||u,w=d&&((v=E==null?void 0:E({status:d,errors:t,warnings:r}))===null||v===void 0?void 0:v[d]),C=d&&_xt[d];b=w!==!1&&C?y.createElement("span",{className:Ue(`${l}-feedback-icon`,`${l}-feedback-icon-${d}`)},w||y.createElement(C,null)):null}const S={status:d||"",errors:t,warnings:r,hasFeedback:!!i,feedbackIcon:b,isFormItemInput:!0};return c&&(S.status=(d??f)||"",S.isFormItemInput=h,S.hasFeedback=!!(i??p),S.feedbackIcon=i!==void 0?S.feedbackIcon:g),S},[d,i,c,h,f]);return y.createElement(nu.Provider,{value:m},e)}var wxt=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t};function Cxt(n){const{prefixCls:e,className:t,rootClassName:r,style:i,help:o,errors:s,warnings:a,validateStatus:c,meta:l,hasFeedback:u,hidden:d,children:h,fieldId:f,required:p,isRequired:g,onSubItemMetaChange:m,layout:v}=n,b=wxt(n,["prefixCls","className","rootClassName","style","help","errors","warnings","validateStatus","meta","hasFeedback","hidden","children","fieldId","required","isRequired","onSubItemMetaChange","layout"]),S=`${e}-item`,{requiredMark:E,vertical:w}=y.useContext(lv),C=w||v==="vertical",I=y.useRef(null),T=O8(s),D=O8(a),O=o!=null,M=!!(O||s.length||a.length),R=!!I.current&&Z7(I.current),[A,k]=y.useState(null);es(()=>{if(M&&I.current){const U=getComputedStyle(I.current);k(parseInt(U.marginBottom,10))}},[M,R]);const L=U=>{U||k(null)},N=function(){let U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const K=U?T:l.errors,z=U?D:l.warnings;return dMe(K,z,l,"",!!u,c)}(),B=Ue(S,t,r,{[`${S}-with-help`]:O||T.length||D.length,[`${S}-has-feedback`]:N&&u,[`${S}-has-success`]:N==="success",[`${S}-has-warning`]:N==="warning",[`${S}-has-error`]:N==="error",[`${S}-is-validating`]:N==="validating",[`${S}-hidden`]:d,[`${S}-${v}`]:v});return y.createElement("div",{className:B,style:i,ref:I},y.createElement(r2t,Object.assign({className:`${S}-row`},Yc(b,["_internalItemRender","colon","dependencies","extra","fieldKey","getValueFromEvent","getValueProps","htmlFor","id","initialValue","isListField","label","labelAlign","labelCol","labelWrap","messageVariables","name","normalize","noStyle","preserve","requiredMark","rules","shouldUpdate","trigger","tooltip","validateFirst","validateTrigger","valuePropName","wrapperCol","validateDebounce"])),y.createElement(Sxt,Object.assign({htmlFor:f},n,{requiredMark:E,required:p??g,prefixCls:e,vertical:C})),y.createElement(pxt,Object.assign({},n,l,{errors:T,warnings:D,prefixCls:e,status:N,help:o,marginBottom:A,onErrorVisibleChanged:L}),y.createElement(P4e.Provider,{value:m},y.createElement(pMe,{prefixCls:e,meta:l,errors:l.errors,warnings:l.warnings,hasFeedback:u,validateStatus:N},h)))),!!A&&y.createElement("div",{className:`${S}-margin-offset`,style:{marginBottom:-A}}))}const xxt="__SPLIT__";function Ext(n,e){const t=Object.keys(n),r=Object.keys(e);return t.length===r.length&&t.every(i=>{const o=n[i],s=e[i];return o===s||typeof o=="function"||typeof s=="function"})}const Ixt=y.memo(n=>{let{children:e}=n;return e},(n,e)=>Ext(n.control,e.control)&&n.update===e.update&&n.childProps.length===e.childProps.length&&n.childProps.every((t,r)=>t===e.childProps[r]));function C0e(){return{errors:[],warnings:[],touched:!1,validating:!1,name:[],validated:!1}}function Pxt(n){const{name:e,noStyle:t,className:r,dependencies:i,prefixCls:o,shouldUpdate:s,rules:a,children:c,required:l,label:u,messageVariables:d,trigger:h="onChange",validateTrigger:f,hidden:p,help:g,layout:m}=n,{getPrefixCls:v}=y.useContext(fr),{name:b}=y.useContext(lv),S=lxt(c),E=typeof S=="function",w=y.useContext(P4e),{validateTrigger:C}=y.useContext(LS),I=f!==void 0?f:C,T=e!=null,D=v("form",o),O=Qc(D),[M,R,A]=yre(D,O);lD();const k=y.useContext(P3),L=y.useRef(),[j,N]=uxt({}),[B,U]=$S(()=>C0e()),K=_e=>{const Se=k==null?void 0:k.getKey(_e.name);if(U(_e.destroy?C0e():_e,!0),t&&g!==!1&&w){let se=_e.name;if(_e.destroy)se=L.current||se;else if(Se!==void 0){const[ee,Y]=Se;se=[ee].concat(Ht(Y)),L.current=se}w(_e,se)}},z=(_e,Se)=>{N(se=>{const ee=Object.assign({},se),ue=[].concat(Ht(_e.name.slice(0,-1)),Ht(Se)).join(xxt);return _e.destroy?delete ee[ue]:ee[ue]=_e,ee})},[G,te]=y.useMemo(()=>{const _e=Ht(B.errors),Se=Ht(B.warnings);return Object.values(j).forEach(se=>{_e.push.apply(_e,Ht(se.errors||[])),Se.push.apply(Se,Ht(se.warnings||[]))}),[_e,Se]},[j,B.errors,B.warnings]),ie=dxt();function Q(_e,Se,se){return t&&!p?y.createElement(pMe,{prefixCls:D,hasFeedback:n.hasFeedback,validateStatus:n.validateStatus,meta:B,errors:G,warnings:te,noStyle:!0},_e):y.createElement(Cxt,Object.assign({key:"row"},n,{className:Ue(r,A,O,R),prefixCls:D,fieldId:Se,isRequired:se,errors:G,warnings:te,meta:B,onSubItemMetaChange:z,layout:m}),_e)}if(!T&&!E&&!i)return M(Q(S));let ge={};return typeof u=="string"?ge.label=u:e&&(ge.label=String(e)),d&&(ge=Object.assign(Object.assign({},ge),d)),M(y.createElement(Zne,Object.assign({},n,{messageVariables:ge,trigger:h,validateTrigger:I,onMetaChange:K}),(_e,Se,se)=>{const ee=uk(e).length&&Se?Se.name:[],Y=uMe(ee,b),ue=l!==void 0?l:!!(a!=null&&a.some(le=>{if(le&&typeof le=="object"&&le.required&&!le.warningOnly)return!0;if(typeof le=="function"){const he=le(se);return(he==null?void 0:he.required)&&!(he!=null&&he.warningOnly)}return!1})),ye=Object.assign({},_e);let V=null;if(Array.isArray(S)&&T)V=S;else if(!(E&&(!(s||i)||T))){if(!(i&&!E&&!T))if(y.isValidElement(S)){const le=Object.assign(Object.assign({},S.props),ye);if(le.id||(le.id=Y),g||G.length>0||te.length>0||n.extra){const ne=[];(g||G.length>0)&&ne.push(`${Y}_help`),n.extra&&ne.push(`${Y}_extra`),le["aria-describedby"]=ne.join(" ")}G.length>0&&(le["aria-invalid"]="true"),ue&&(le["aria-required"]="true"),yv(S)&&(le.ref=ie(ee,S)),new Set([].concat(Ht(uk(h)),Ht(uk(I)))).forEach(ne=>{le[ne]=function(){for(var ce,Ae,Ie,be,De,Me=arguments.length,He=new Array(Me),Je=0;Je<Me;Je++)He[Je]=arguments[Je];(Ie=ye[ne])===null||Ie===void 0||(ce=Ie).call.apply(ce,[ye].concat(He)),(De=(be=S.props)[ne])===null||De===void 0||(Ae=De).call.apply(Ae,[be].concat(He))}});const oe=[le["aria-required"],le["aria-invalid"],le["aria-describedby"]];V=y.createElement(Ixt,{control:ye,update:S,childProps:oe},gg(S,le))}else E&&(s||i)&&!T?V=S(se):V=S}return Q(V,Y,ue)}))}const gMe=Pxt;gMe.useStatus=fMe;var kxt=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t};const Txt=n=>{var{prefixCls:e,children:t}=n,r=kxt(n,["prefixCls","children"]);const{getPrefixCls:i}=y.useContext(fr),o=i("form",e),s=y.useMemo(()=>({prefixCls:o,status:"error"}),[o]);return y.createElement(C4e,Object.assign({},r),(a,c,l)=>y.createElement(Yne.Provider,{value:s},t(a.map(u=>Object.assign(Object.assign({},u),{fieldKey:u.key})),c,{errors:l.errors,warnings:l.warnings})))};function Dxt(){const{form:n}=y.useContext(lv);return n}const co=cxt;co.Item=gMe;co.List=Txt;co.ErrorList=lMe;co.useForm=hMe;co.useFormInstance=Dxt;co.useWatch=I4e;co.Provider=k4e;co.create=()=>{};let Sh=null,R1=n=>n(),A3=[],O3={};function x0e(){const{getContainer:n,duration:e,rtl:t,maxCount:r,top:i}=O3,o=(n==null?void 0:n())||document.body;return{getContainer:()=>o,duration:e,rtl:t,maxCount:r,top:i}}const Rxt=Ke.forwardRef((n,e)=>{const{messageConfig:t,sync:r}=n,{getPrefixCls:i}=y.useContext(fr),o=O3.prefixCls||i("message"),s=y.useContext(_1t),[a,c]=t4e(Object.assign(Object.assign(Object.assign({},t),{prefixCls:o}),s.message));return Ke.useImperativeHandle(e,()=>{const l=Object.assign({},a);return Object.keys(l).forEach(u=>{l[u]=function(){return r(),a[u].apply(a,arguments)}}),{instance:l,sync:r}}),c}),Axt=Ke.forwardRef((n,e)=>{const[t,r]=Ke.useState(x0e),i=()=>{r(x0e)};Ke.useEffect(i,[]);const o=Fne(),s=o.getRootPrefixCls(),a=o.getIconPrefixCls(),c=o.getTheme(),l=Ke.createElement(Rxt,{ref:e,sync:i,messageConfig:t});return Ke.createElement(Sv,{prefixCls:s,iconPrefixCls:a,theme:c},o.holderRender?o.holderRender(l):l)});function uN(){if(!Sh){const n=document.createDocumentFragment(),e={fragment:n};Sh=e,R1(()=>{Une(Ke.createElement(Axt,{ref:t=>{const{instance:r,sync:i}=t||{};Promise.resolve().then(()=>{!e.instance&&r&&(e.instance=r,e.sync=i,uN())})}}),n)});return}Sh.instance&&(A3.forEach(n=>{const{type:e,skipped:t}=n;if(!t)switch(e){case"open":{R1(()=>{const r=Sh.instance.open(Object.assign(Object.assign({},O3),n.config));r==null||r.then(n.resolve),n.setCloseFn(r)});break}case"destroy":R1(()=>{Sh==null||Sh.instance.destroy(n.key)});break;default:R1(()=>{var r;const i=(r=Sh.instance)[e].apply(r,Ht(n.args));i==null||i.then(n.resolve),n.setCloseFn(i)})}}),A3=[])}function Oxt(n){O3=Object.assign(Object.assign({},O3),n),R1(()=>{var e;(e=Sh==null?void 0:Sh.sync)===null||e===void 0||e.call(Sh)})}function Mxt(n){const e=Hne(t=>{let r;const i={type:"open",config:n,resolve:t,setCloseFn:o=>{r=o}};return A3.push(i),()=>{r?R1(()=>{r()}):i.skipped=!0}});return uN(),e}function $xt(n,e){Fne();const t=Hne(r=>{let i;const o={type:n,args:e,resolve:r,setCloseFn:s=>{i=s}};return A3.push(o),()=>{i?R1(()=>{i()}):o.skipped=!0}});return uN(),t}const Lxt=n=>{A3.push({type:"destroy",key:n}),uN()},Nxt=["success","info","warning","error","loading"],Fxt={open:Mxt,destroy:Lxt,config:Oxt,useMessage:Xvt,_InternalPanelDoNotUseOrYouWillBeFired:Uvt},M8=Fxt;Nxt.forEach(n=>{M8[n]=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return $xt(n,t)}});var jxt=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t};const Bxt=n=>{const{prefixCls:e,className:t,closeIcon:r,closable:i,type:o,title:s,children:a,footer:c}=n,l=jxt(n,["prefixCls","className","closeIcon","closable","type","title","children","footer"]),{getPrefixCls:u}=y.useContext(fr),d=u(),h=e||u("modal"),f=Qc(d),[p,g,m]=$4e(h,f),v=`${h}-confirm`;let b={};return o?b={closable:i??!1,title:"",footer:"",children:y.createElement(N4e,Object.assign({},n,{prefixCls:h,confirmPrefixCls:v,rootPrefixCls:d,content:a}))}:b={closable:i??!0,title:s,footer:c!==null&&y.createElement(R4e,Object.assign({},n)),children:a},p(y.createElement(v4e,Object.assign({prefixCls:h,className:Ue(g,`${h}-pure-panel`,o&&v,o&&`${v}-${o}`,t,m,f)},l,{closeIcon:D4e(h,r),closable:i},b)))},Hxt=q4e(Bxt);function mMe(n){return bD(H4e(n))}const Zu=L4e;Zu.useModal=S1t;Zu.info=function(e){return bD(U4e(e))};Zu.success=function(e){return bD(z4e(e))};Zu.error=function(e){return bD(V4e(e))};Zu.warning=mMe;Zu.warn=mMe;Zu.confirm=function(e){return bD(W4e(e))};Zu.destroyAll=function(){for(;D1.length;){const e=D1.pop();e&&e()}};Zu.config=g1t;Zu._InternalPanelDoNotUseOrYouWillBeFired=Hxt;var Uxt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M625.9 115c-5.9 0-11.9 1.6-17.4 5.3L254 352H90c-8.8 0-16 7.2-16 16v288c0 8.8 7.2 16 16 16h164l354.5 231.7c5.5 3.6 11.6 5.3 17.4 5.3 16.7 0 32.1-13.3 32.1-32.1V147.1c0-18.8-15.4-32.1-32.1-32.1zM586 803L293.4 611.7l-18-11.7H146V424h129.4l17.9-11.7L586 221v582zm348-327H806c-8.8 0-16 7.2-16 16v40c0 8.8 7.2 16 16 16h128c8.8 0 16-7.2 16-16v-40c0-8.8-7.2-16-16-16zm-41.9 261.8l-110.3-63.7a15.9 15.9 0 00-21.7 5.9l-19.9 34.5c-4.4 7.6-1.8 17.4 5.8 21.8L856.3 800a15.9 15.9 0 0021.7-5.9l19.9-34.5c4.4-7.6 1.7-17.4-5.8-21.8zM760 344a15.9 15.9 0 0021.7 5.9L892 286.2c7.6-4.4 10.2-14.2 5.8-21.8L878 230a15.9 15.9 0 00-21.7-5.9L746 287.8a15.99 15.99 0 00-5.8 21.8L760 344z"}}]},name:"sound",theme:"outlined"},zxt=function(e,t){return y.createElement(_a,ln({},e,{ref:t,icon:Uxt}))},Vxt=y.forwardRef(zxt),Wxt=["className","component","viewBox","spin","rotate","tabIndex","onClick","children"],bre=y.forwardRef(function(n,e){var t=n.className,r=n.component,i=n.viewBox,o=n.spin,s=n.rotate,a=n.tabIndex,c=n.onClick,l=n.children,u=jr(n,Wxt),d=y.useRef(),h=Uy(d,e);XG(!!(r||l),"Should have `component` prop or `children`."),WAe(d);var f=y.useContext(V7),p=f.prefixCls,g=p===void 0?"anticon":p,m=f.rootClassName,v=Ue(m,g,Le({},"".concat(g,"-spin"),!!o&&!!r),t),b=Ue(Le({},"".concat(g,"-spin"),!!o)),S=s?{msTransform:"rotate(".concat(s,"deg)"),transform:"rotate(".concat(s,"deg)")}:void 0,E=$e($e({},Qmt),{},{className:b,style:S,viewBox:i});i||delete E.viewBox;var w=function(){return r?y.createElement(r,E,l):l?(XG(!!i||y.Children.count(l)===1&&y.isValidElement(l)&&y.Children.only(l).type==="use","Make sure that you provide correct `viewBox` prop (default `0 0 1024 1024`) to the icon."),y.createElement("svg",ln({},E,{viewBox:i}),l)):null},C=a;return C===void 0&&c&&(C=-1),y.createElement("span",ln({role:"img"},u,{ref:h,tabIndex:C,onClick:c,className:v}),w())});bre.displayName="AntdIcon";var vMe=Symbol.for("immer-nothing"),E0e=Symbol.for("immer-draftable"),zd=Symbol.for("immer-state");function Af(n,...e){throw new Error(`[Immer] minified error nr: ${n}. Full error at: https://bit.ly/3cXEKWf`)}var tx=Object.getPrototypeOf;function nx(n){return!!n&&!!n[zd]}function NS(n){var e;return n?yMe(n)||Array.isArray(n)||!!n[E0e]||!!((e=n.constructor)!=null&&e[E0e])||hN(n)||fN(n):!1}var qxt=Object.prototype.constructor.toString();function yMe(n){if(!n||typeof n!="object")return!1;const e=tx(n);if(e===null)return!0;const t=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return t===Object?!0:typeof t=="function"&&Function.toString.call(t)===qxt}function $8(n,e){dN(n)===0?Reflect.ownKeys(n).forEach(t=>{e(t,n[t],n)}):n.forEach((t,r)=>e(r,t,n))}function dN(n){const e=n[zd];return e?e.type_:Array.isArray(n)?1:hN(n)?2:fN(n)?3:0}function EZ(n,e){return dN(n)===2?n.has(e):Object.prototype.hasOwnProperty.call(n,e)}function bMe(n,e,t){const r=dN(n);r===2?n.set(e,t):r===3?n.add(t):n[e]=t}function Kxt(n,e){return n===e?n!==0||1/n===1/e:n!==n&&e!==e}function hN(n){return n instanceof Map}function fN(n){return n instanceof Set}function Jb(n){return n.copy_||n.base_}function IZ(n,e){if(hN(n))return new Map(n);if(fN(n))return new Set(n);if(Array.isArray(n))return Array.prototype.slice.call(n);const t=yMe(n);if(e===!0||e==="class_only"&&!t){const r=Object.getOwnPropertyDescriptors(n);delete r[zd];let i=Reflect.ownKeys(r);for(let o=0;o<i.length;o++){const s=i[o],a=r[s];a.writable===!1&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(r[s]={configurable:!0,writable:!0,enumerable:a.enumerable,value:n[s]})}return Object.create(tx(n),r)}else{const r=tx(n);if(r!==null&&t)return{...n};const i=Object.create(r);return Object.assign(i,n)}}function Sre(n,e=!1){return pN(n)||nx(n)||!NS(n)||(dN(n)>1&&(n.set=n.add=n.clear=n.delete=Gxt),Object.freeze(n),e&&Object.entries(n).forEach(([t,r])=>Sre(r,!0))),n}function Gxt(){Af(2)}function pN(n){return Object.isFrozen(n)}var Zxt={};function FS(n){const e=Zxt[n];return e||Af(0,n),e}var M3;function SMe(){return M3}function Xxt(n,e){return{drafts_:[],parent_:n,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function I0e(n,e){e&&(FS("Patches"),n.patches_=[],n.inversePatches_=[],n.patchListener_=e)}function PZ(n){kZ(n),n.drafts_.forEach(Yxt),n.drafts_=null}function kZ(n){n===M3&&(M3=n.parent_)}function P0e(n){return M3=Xxt(M3,n)}function Yxt(n){const e=n[zd];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function k0e(n,e){e.unfinalizedDrafts_=e.drafts_.length;const t=e.drafts_[0];return n!==void 0&&n!==t?(t[zd].modified_&&(PZ(e),Af(4)),NS(n)&&(n=L8(e,n),e.parent_||N8(e,n)),e.patches_&&FS("Patches").generateReplacementPatches_(t[zd].base_,n,e.patches_,e.inversePatches_)):n=L8(e,t,[]),PZ(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),n!==vMe?n:void 0}function L8(n,e,t){if(pN(e))return e;const r=e[zd];if(!r)return $8(e,(i,o)=>T0e(n,r,e,i,o,t)),e;if(r.scope_!==n)return e;if(!r.modified_)return N8(n,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const i=r.copy_;let o=i,s=!1;r.type_===3&&(o=new Set(i),i.clear(),s=!0),$8(o,(a,c)=>T0e(n,r,i,a,c,t,s)),N8(n,i,!1),t&&n.patches_&&FS("Patches").generatePatches_(r,t,n.patches_,n.inversePatches_)}return r.copy_}function T0e(n,e,t,r,i,o,s){if(nx(i)){const a=o&&e&&e.type_!==3&&!EZ(e.assigned_,r)?o.concat(r):void 0,c=L8(n,i,a);if(bMe(t,r,c),nx(c))n.canAutoFreeze_=!1;else return}else s&&t.add(i);if(NS(i)&&!pN(i)){if(!n.immer_.autoFreeze_&&n.unfinalizedDrafts_<1)return;L8(n,i),(!e||!e.scope_.parent_)&&typeof r!="symbol"&&Object.prototype.propertyIsEnumerable.call(t,r)&&N8(n,i)}}function N8(n,e,t=!1){!n.parent_&&n.immer_.autoFreeze_&&n.canAutoFreeze_&&Sre(e,t)}function Jxt(n,e){const t=Array.isArray(n),r={type_:t?1:0,scope_:e?e.scope_:SMe(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:n,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=r,o=_re;t&&(i=[r],o=$3);const{revoke:s,proxy:a}=Proxy.revocable(i,o);return r.draft_=a,r.revoke_=s,a}var _re={get(n,e){if(e===zd)return n;const t=Jb(n);if(!EZ(t,e))return Qxt(n,t,e);const r=t[e];return n.finalized_||!NS(r)?r:r===GH(n.base_,e)?(ZH(n),n.copy_[e]=DZ(r,n)):r},has(n,e){return e in Jb(n)},ownKeys(n){return Reflect.ownKeys(Jb(n))},set(n,e,t){const r=_Me(Jb(n),e);if(r!=null&&r.set)return r.set.call(n.draft_,t),!0;if(!n.modified_){const i=GH(Jb(n),e),o=i==null?void 0:i[zd];if(o&&o.base_===t)return n.copy_[e]=t,n.assigned_[e]=!1,!0;if(Kxt(t,i)&&(t!==void 0||EZ(n.base_,e)))return!0;ZH(n),TZ(n)}return n.copy_[e]===t&&(t!==void 0||e in n.copy_)||Number.isNaN(t)&&Number.isNaN(n.copy_[e])||(n.copy_[e]=t,n.assigned_[e]=!0),!0},deleteProperty(n,e){return GH(n.base_,e)!==void 0||e in n.base_?(n.assigned_[e]=!1,ZH(n),TZ(n)):delete n.assigned_[e],n.copy_&&delete n.copy_[e],!0},getOwnPropertyDescriptor(n,e){const t=Jb(n),r=Reflect.getOwnPropertyDescriptor(t,e);return r&&{writable:!0,configurable:n.type_!==1||e!=="length",enumerable:r.enumerable,value:t[e]}},defineProperty(){Af(11)},getPrototypeOf(n){return tx(n.base_)},setPrototypeOf(){Af(12)}},$3={};$8(_re,(n,e)=>{$3[n]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});$3.deleteProperty=function(n,e){return $3.set.call(this,n,e,void 0)};$3.set=function(n,e,t){return _re.set.call(this,n[0],e,t,n[0])};function GH(n,e){const t=n[zd];return(t?Jb(t):n)[e]}function Qxt(n,e,t){var i;const r=_Me(e,t);return r?"value"in r?r.value:(i=r.get)==null?void 0:i.call(n.draft_):void 0}function _Me(n,e){if(!(e in n))return;let t=tx(n);for(;t;){const r=Object.getOwnPropertyDescriptor(t,e);if(r)return r;t=tx(t)}}function TZ(n){n.modified_||(n.modified_=!0,n.parent_&&TZ(n.parent_))}function ZH(n){n.copy_||(n.copy_=IZ(n.base_,n.scope_.immer_.useStrictShallowCopy_))}var eEt=class{constructor(n){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,t,r)=>{if(typeof e=="function"&&typeof t!="function"){const o=t;t=e;const s=this;return function(c=o,...l){return s.produce(c,u=>t.call(this,u,...l))}}typeof t!="function"&&Af(6),r!==void 0&&typeof r!="function"&&Af(7);let i;if(NS(e)){const o=P0e(this),s=DZ(e,void 0);let a=!0;try{i=t(s),a=!1}finally{a?PZ(o):kZ(o)}return I0e(o,r),k0e(i,o)}else if(!e||typeof e!="object"){if(i=t(e),i===void 0&&(i=e),i===vMe&&(i=void 0),this.autoFreeze_&&Sre(i,!0),r){const o=[],s=[];FS("Patches").generateReplacementPatches_(e,i,o,s),r(o,s)}return i}else Af(1,e)},this.produceWithPatches=(e,t)=>{if(typeof e=="function")return(s,...a)=>this.produceWithPatches(s,c=>e(c,...a));let r,i;return[this.produce(e,t,(s,a)=>{r=s,i=a}),r,i]},typeof(n==null?void 0:n.autoFreeze)=="boolean"&&this.setAutoFreeze(n.autoFreeze),typeof(n==null?void 0:n.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(n.useStrictShallowCopy)}createDraft(n){NS(n)||Af(8),nx(n)&&(n=tEt(n));const e=P0e(this),t=DZ(n,void 0);return t[zd].isManual_=!0,kZ(e),t}finishDraft(n,e){const t=n&&n[zd];(!t||!t.isManual_)&&Af(9);const{scope_:r}=t;return I0e(r,e),k0e(void 0,r)}setAutoFreeze(n){this.autoFreeze_=n}setUseStrictShallowCopy(n){this.useStrictShallowCopy_=n}applyPatches(n,e){let t;for(t=e.length-1;t>=0;t--){const i=e[t];if(i.path.length===0&&i.op==="replace"){n=i.value;break}}t>-1&&(e=e.slice(t+1));const r=FS("Patches").applyPatches_;return nx(n)?r(n,e):this.produce(n,i=>r(i,e))}};function DZ(n,e){const t=hN(n)?FS("MapSet").proxyMap_(n,e):fN(n)?FS("MapSet").proxySet_(n,e):Jxt(n,e);return(e?e.scope_:SMe()).drafts_.push(t),t}function tEt(n){return nx(n)||Af(10,n),wMe(n)}function wMe(n){if(!NS(n)||pN(n))return n;const e=n[zd];let t;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,t=IZ(n,e.scope_.immer_.useStrictShallowCopy_)}else t=IZ(n,!0);return $8(t,(r,i)=>{bMe(t,r,wMe(i))}),e&&(e.finalized_=!1),t}var Vd=new eEt,nEt=Vd.produce;Vd.produceWithPatches.bind(Vd);Vd.setAutoFreeze.bind(Vd);Vd.setUseStrictShallowCopy.bind(Vd);Vd.applyPatches.bind(Vd);Vd.createDraft.bind(Vd);Vd.finishDraft.bind(Vd);const CD=Ke.createContext(null),rEt=n=>y.createElement("svg",{t:1617006067630,className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg","p-id":1903,xmlnsXlink:"http://www.w3.org/1999/xlink",width:200,height:200,...n},y.createElement("defs",null,y.createElement("style",{type:"text/css"})),y.createElement("path",{d:"M512 128a384 384 0 1 0 384 384A384 384 0 0 0 512 128z m0 563.2a179.2 179.2 0 1 1 179.2-179.2 179.2 179.2 0 0 1-179.2 179.2z","p-id":1904}),y.createElement("path",{d:"M614.4 168.448L588.8 0h-153.6L409.6 168.448a358.4 358.4 0 0 1 204.8 0zM409.6 855.552L435.2 1024h153.6l25.6-168.448a358.4 358.4 0 0 1-204.8 0z m417.792-514.048l102.4-137.216L819.2 95.744l-137.216 102.4a358.4 358.4 0 0 1 144.896 144.896zM196.608 682.496L95.744 819.2 204.8 928.256l137.216-102.4a358.4 358.4 0 0 1-144.896-144.896zM855.552 614.4l168.448-25.6v-153.6L855.552 409.6a358.4 358.4 0 0 1 0 204.8zM168.448 409.6L0 435.2v153.6l168.448 25.6a358.4 358.4 0 0 1 0-204.8z m514.048 417.792l137.216 102.4L928.256 819.2l-102.4-137.216a358.4 358.4 0 0 1-144.896 144.896zM341.504 196.608L204.8 95.744 95.744 204.8l102.4 137.216a358.4 358.4 0 0 1 143.36-145.408z","p-id":1905})),iEt=n=>y.createElement("svg",{t:1617006099192,className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg","p-id":2162,xmlnsXlink:"http://www.w3.org/1999/xlink",width:200,height:200,...n},y.createElement("defs",null,y.createElement("style",{type:"text/css"})),y.createElement("path",{d:"M768 384C732.672 384 704 412.672 704 448 704 483.328 732.672 512 768 512 803.328 512 832 483.328 832 448 832 412.672 803.328 384 768 384L768 384ZM512 832C474.624 832 438.528 827.648 403.84 820.256L253.184 910.816 255.2 762.368C139.712 692.928 64 578.112 64 448 64 235.936 264.576 64 512 64 759.424 64 960 235.936 960 448 960 660.096 759.424 832 512 832L512 832ZM512 0C229.248 0 0 200.608 0 448 0 589.408 75.04 715.328 192 797.408L192 1024 416.288 887.904C447.328 893.024 479.264 896 512 896 794.752 896 1024 695.424 1024 448 1024 200.608 794.752 0 512 0L512 0ZM256 384C220.672 384 192 412.672 192 448 192 483.328 220.672 512 256 512 291.328 512 320 483.328 320 448 320 412.672 291.328 384 256 384L256 384ZM512 384C476.672 384 448 412.672 448 448 448 483.328 476.672 512 512 512 547.328 512 576 483.328 576 448 576 412.672 547.328 384 512 384L512 384Z","p-id":2163})),oEt=n=>y.createElement("svg",{t:1617005996895,className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg","p-id":1642,xmlnsXlink:"http://www.w3.org/1999/xlink",width:200,height:200,...n},y.createElement("defs",null,y.createElement("style",{type:"text/css"})),y.createElement("path",{d:"M63.791373 64.325028l319.093479 0 0 320.733838-319.093479 0 0-320.733838Z","p-id":1643}),y.createElement("path",{d:"M640.090818 64.325028l319.093479 0 0 320.733838-319.093479 0 0-320.733838Z","p-id":1644}),y.createElement("path",{d:"M63.791373 638.399805l319.093479 0 0 320.734862-319.093479 0 0-320.734862Z","p-id":1645}),y.createElement("path",{d:"M640.090818 638.399805l319.093479 0 0 320.734862-319.093479 0 0-320.734862Z","p-id":1646})),sEt=n=>y.createElement("svg",{t:1617006266704,className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg","p-id":2954,xmlnsXlink:"http://www.w3.org/1999/xlink",width:200,height:200,...n},y.createElement("defs",null,y.createElement("style",{type:"text/css"})),y.createElement("path",{d:"M256 810.666667 170.666667 810.666667c-93.866667 0-170.666667-76.8-170.666667-170.666667l0-42.666667c0-93.866667 76.8-170.666667 170.666667-170.666667l85.333333 0c25.6 0 42.666667 17.066667 42.666667 42.666667l0 298.666667C298.666667 793.6 281.6 810.666667 256 810.666667zM170.666667 512c-46.933333 0-85.333333 38.4-85.333333 85.333333l0 42.666667c0 46.933333 38.4 85.333333 85.333333 85.333333l42.666667 0 0-213.333333L170.666667 512z","p-id":2955}),y.createElement("path",{d:"M853.333333 810.666667l-85.333333 0c-25.6 0-42.666667-17.066667-42.666667-42.666667l0-298.666667c0-25.6 17.066667-42.666667 42.666667-42.666667l85.333333 0c93.866667 0 170.666667 76.8 170.666667 170.666667l0 42.666667C1024 733.866667 947.2 810.666667 853.333333 810.666667zM810.666667 725.333333l42.666667 0c46.933333 0 85.333333-38.4 85.333333-85.333333l0-42.666667c0-46.933333-38.4-85.333333-85.333333-85.333333l-42.666667 0L810.666667 725.333333z","p-id":2956}),y.createElement("path",{d:"M891.733333 516.266667c-4.266667 0-4.266667 0-8.533333 0-21.333333-4.266667-38.4-25.6-34.133333-46.933333 0-12.8 4.266667-25.6 4.266667-42.666667 0-187.733333-153.6-341.333333-341.333333-341.333333s-341.333333 153.6-341.333333 341.333333c0 17.066667 0 29.866667 4.266667 42.666667 4.266667 21.333333-12.8 46.933333-34.133333 46.933333-21.333333 4.266667-46.933333-12.8-46.933333-34.133333C85.333333 465.066667 85.333333 448 85.333333 426.666667 85.333333 192 277.333333 0 512 0s426.666667 192 426.666667 426.666667c0 21.333333 0 38.4-4.266667 55.466667C930.133333 503.466667 913.066667 516.266667 891.733333 516.266667z","p-id":2957}),y.createElement("path",{d:"M512 1024c-93.866667 0-128-76.8-128-128s34.133333-128 128-128 128 76.8 128 128c0 8.533333 0 17.066667-4.266667 25.6 93.866667-25.6 157.866667-85.333333 192-170.666667 8.533333-21.333333 34.133333-34.133333 55.466667-25.6 21.333333 8.533333 34.133333 34.133333 25.6 55.466667C866.133333 891.733333 759.466667 1024 512 1024zM512 853.333333c-34.133333 0-42.666667 25.6-42.666667 42.666667 0 17.066667 8.533333 42.666667 42.666667 42.666667s42.666667-25.6 42.666667-42.666667C554.666667 878.933333 546.133333 853.333333 512 853.333333z","p-id":2958})),aEt=n=>y.createElement("svg",{t:1617006090996,className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg","p-id":2033,xmlnsXlink:"http://www.w3.org/1999/xlink",width:200,height:200,...n},y.createElement("defs",null,y.createElement("style",{type:"text/css"})),y.createElement("path",{d:"M520.032 176.064a16 16 0 0 1 16 16l-0.016 49.44h227.2a68.832 68.832 0 0 1 68.704 65.552l0.08 3.328v226.192c0 87.568-70.896 158.56-158.368 158.56l-112.688-0.016 111.152 100.224a16 16 0 0 1 1.152 22.624l-10.736 11.872a16 16 0 0 1-22.592 1.152l-103.904-93.712v94.608a16 16 0 0 1-16 16h-16.048a16 16 0 0 1-16-16V737.28l-103.888 93.712a16 16 0 0 1-21.152 0.256l-1.44-1.408-10.736-11.872v-0.016a16 16 0 0 1 1.152-22.608l111.136-100.224h-112.672c-85.984 0-155.952-68.592-158.304-154.112L192 536.576V310.384a68.832 68.832 0 0 1 68.8-68.864l227.168-0.016v-49.44a16 16 0 0 1 16-16h16.064zM763.2 289.568H260.784a20.8 20.8 0 0 0-20.8 20.816v226.192c0 61.024 49.424 110.512 110.384 110.512h323.264c60.96 0 110.384-49.488 110.384-110.512V310.384a20.8 20.8 0 0 0-20.8-20.816z m-100.976 89.344l1.488 1.344 0.016 0.016 11.2 11.44a16 16 0 0 1-0.192 22.608l-132.72 130.432a23.968 23.968 0 0 1-31.792 1.616l-1.808-1.6-59.712-58.592-65.92 64.224a16 16 0 0 1-22.656-0.32l-11.152-11.488a16 16 0 0 1 0.32-22.608l82.752-80.592a23.968 23.968 0 0 1 31.712-1.552l1.808 1.6 59.616 58.48 115.904-113.856a16 16 0 0 1 21.12-1.152z","p-id":2034})),cEt=n=>y.createElement("svg",{t:1617006240027,className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg","p-id":2567,xmlnsXlink:"http://www.w3.org/1999/xlink",width:200,height:200,...n},y.createElement("defs",null,y.createElement("style",{type:"text/css"})),y.createElement("path",{d:"M590.769231 846.769231c0 19.692308 17.723077 39.384615 39.384615 39.384615h78.769231c21.661538 0 39.384615-21.661538 39.384615-39.384615V177.230769c0-19.692308-17.723077-39.384615-39.384615-39.384615h-78.769231c-21.661538 0-39.384615 21.661538-39.384615 39.384615v669.538462z m-315.076923 0c0 19.692308 17.723077 39.384615 39.384615 39.384615h78.769231c21.661538 0 39.384615-21.661538 39.384615-39.384615V177.230769c0-19.692308-17.723077-39.384615-39.384615-39.384615h-78.769231c-21.661538 0-39.384615 21.661538-39.384615 39.384615v669.538462z","p-id":2568})),lEt=n=>y.createElement("svg",{t:1617006205286,className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg","p-id":2291,xmlnsXlink:"http://www.w3.org/1999/xlink",width:200,height:200,...n},y.createElement("defs",null,y.createElement("style",{type:"text/css"})),y.createElement("path",{d:"M853.333333 810.666667h-298.666666a85.333333 85.333333 0 0 1-85.333334-85.333334v-170.666666a85.333333 85.333333 0 0 1 85.333334-85.333334h298.666666a85.333333 85.333333 0 0 1 85.333334 85.333334v170.666666a85.333333 85.333333 0 0 1-85.333334 85.333334z m0-256h-298.666666v170.666666h298.666666v-170.666666z m-42.666666-170.666667a42.666667 42.666667 0 0 1-42.666667-42.666667V298.666667a42.666667 42.666667 0 0 0-42.666667-42.666667h-42.666666a42.666667 42.666667 0 0 1 0-85.333333h85.333333a85.333333 85.333333 0 0 1 85.333333 85.333333v85.333333a42.666667 42.666667 0 0 1-42.666666 42.666667z m-341.333334 42.666667H170.666667a85.333333 85.333333 0 0 1-85.333334-85.333334V170.666667a85.333333 85.333333 0 0 1 85.333334-85.333334h298.666666a85.333333 85.333333 0 0 1 85.333334 85.333334v170.666666a85.333333 85.333333 0 0 1-85.333334 85.333334z m0-256H170.666667v170.666666h298.666666V170.666667zM213.333333 640a42.666667 42.666667 0 0 1 42.666667 42.666667v42.666666a42.666667 42.666667 0 0 0 42.666667 42.666667h42.666666a42.666667 42.666667 0 0 1 0 85.333333H256a85.333333 85.333333 0 0 1-85.333333-85.333333v-85.333333a42.666667 42.666667 0 0 1 42.666666-42.666667z m0-85.333333a42.666667 42.666667 0 0 1 0-85.333334h170.666667a42.666667 42.666667 0 0 1 0 85.333334H213.333333z m384 298.666666h213.333334a42.666667 42.666667 0 0 1 0 85.333334h-213.333334a42.666667 42.666667 0 0 1 0-85.333334z","p-id":2292})),uEt=n=>y.createElement("svg",{t:1617006243764,className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg","p-id":2696,xmlnsXlink:"http://www.w3.org/1999/xlink",width:200,height:200,...n},y.createElement("defs",null,y.createElement("style",{type:"text/css"})),y.createElement("path",{d:"M823.8 603.5l-501.2 336c-50.7 34-119.3 20.4-153.2-30.2-12.2-18.2-18.7-39.6-18.7-61.5v-672c0-61 49.5-110.4 110.4-110.4 21.9 0 43.3 6.5 61.5 18.7l501.1 336c50.7 34 64.2 102.6 30.2 153.2-7.8 11.9-18.1 22.2-30.1 30.2z m0 0","p-id":2697})),dEt=n=>y.createElement("svg",{t:1617006279050,className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg","p-id":3086,xmlnsXlink:"http://www.w3.org/1999/xlink",width:200,height:200,...n},y.createElement("defs",null,y.createElement("style",{type:"text/css"})),y.createElement("path",{d:"M697.15674 422.956522 847.731148 422.956522C884.876874 422.956522 915.087718 452.959788 915.087718 489.801828L915.087718 912.632955 915.087718 1001.739129 937.543859 979.47826 847.939848 979.47826 218.726818 979.47826C181.707983 979.47826 151.578948 949.486546 151.578948 912.632955L151.578948 489.801828C151.578948 472.785796 151.578948 472.785796 151.578948 450.127108 151.578948 442.919656 151.578948 442.919656 151.578948 435.893809 151.578948 408.715613 151.578948 408.715613 151.578948 400.695652L129.122807 422.956522C137.296139 422.956522 137.296139 422.956522 164.865734 422.956522 171.618554 422.956522 171.618554 422.956522 178.53178 422.956522 201.762058 422.956522 201.762058 422.956522 218.906254 422.956522L354.437705 422.956522C366.839887 422.956522 376.893843 412.98999 376.893843 400.695652 376.893843 388.401314 366.839887 378.434781 354.437705 378.434781L218.906254 378.434781C201.762058 378.434781 201.762058 378.434781 178.53178 378.434781 171.618554 378.434781 171.618554 378.434781 164.865734 378.434781 137.296139 378.434781 137.296139 378.434781 129.122807 378.434781 116.720624 378.434781 106.666667 388.401314 106.666667 400.695652 106.666667 408.715613 106.666667 408.715613 106.666667 435.893809 106.666667 442.919656 106.666667 442.919656 106.666667 450.127108 106.666667 472.785796 106.666667 472.785796 106.666667 489.801828L106.666667 912.632955C106.666667 974.033806 156.86164 1023.999999 218.726818 1023.999999L847.939848 1023.999999 937.543859 1023.999999C949.946043 1023.999999 960 1014.033469 960 1001.739129L960 912.632955 960 489.801828C960 428.38942 909.69975 378.434781 847.731148 378.434781L697.15674 378.434781C684.754556 378.434781 674.700599 388.401314 674.700599 400.695652 674.700599 412.98999 684.754556 422.956522 697.15674 422.956522L697.15674 422.956522Z","p-id":3087}),y.createElement("path",{d:"M347.996815 282.764936 548.760439 59.327972 515.337485 59.454466 715.839402 279.198683C724.158863 288.316569 738.359462 289.022466 747.557327 280.775347 756.755193 272.52823 757.467283 258.451114 749.147821 249.333231L548.645903 29.589012 531.863345 11.19582 515.22295 29.715506 314.459326 253.152471C306.210339 262.333062 307.030836 276.404377 316.291958 284.581634 325.55308 292.75889 339.747827 291.945527 347.996815 282.764936L347.996815 282.764936Z","p-id":3088}),y.createElement("path",{d:"M511.087716 78.416783 510.666677 782.242894C510.659322 794.53723 520.707315 804.50967 533.109495 804.516961 545.511678 804.524251 555.571595 794.563632 555.57895 782.269296L555.999989 78.443185C556.007345 66.148848 545.959351 56.176409 533.557171 56.169118 521.154989 56.161828 511.095072 66.122446 511.087716 78.416783L511.087716 78.416783Z","p-id":3089})),hEt=n=>y.createElement("svg",{t:1617006061402,className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg","p-id":1774,xmlnsXlink:"http://www.w3.org/1999/xlink",width:200,height:200,...n},y.createElement("defs",null,y.createElement("style",{type:"text/css"})),y.createElement("path",{d:"M85.333333 256l217.173334 108.8C273.066667 405.333333 256 456.96 256 512s17.066667 106.666667 46.506667 147.2L85.333333 768V256m170.666667-128h512l-108.8 174.506667C618.666667 273.066667 567.04 256 512 256s-106.666667 17.066667-147.2 46.506667L256 128m682.666667 128v512l-217.173334-108.8C750.933333 618.666667 768 567.04 768 512s-17.066667-106.666667-46.506667-147.2L938.666667 256m-170.666667 640H256l108.8-174.506667C405.333333 750.933333 456.96 768 512 768s106.666667-17.066667 147.2-46.506667L768 896M512 341.333333a170.666667 170.666667 0 0 1 170.666667 170.666667 170.666667 170.666667 0 0 1-170.666667 170.666667 170.666667 170.666667 0 0 1-170.666667-170.666667 170.666667 170.666667 0 0 1 170.666667-170.666667m0 85.333334a85.333333 85.333333 0 0 0-85.333333 85.333333 85.333333 85.333333 0 0 0 85.333333 85.333333 85.333333 85.333333 0 0 0 85.333333-85.333333 85.333333 85.333333 0 0 0-85.333333-85.333333z",fill:"","p-id":1775})),fEt=n=>y.createElement("svg",{t:1617006253996,className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg","p-id":2825,xmlnsXlink:"http://www.w3.org/1999/xlink",width:200,height:200,...n},y.createElement("defs",null,y.createElement("style",{type:"text/css"})),y.createElement("path",{d:"M850.2 177.1H173.8c-37.1 0-67 30-67 67v400.4c0 37.1 30 67 67 67H850c37.1 0 67-30 67-67V244.4c0.3-37.1-29.7-67.3-66.8-67.3z m-228 290.7L438.4 574c-15.7 9.1-35.5-2.3-35.5-20.6V341.1c0-18.3 19.8-29.7 35.5-20.6l183.8 106.1c15.8 9.2 15.8 32.1 0 41.2z m62.2 379.1H339.6c-17.5 0-31.7-14.2-31.7-31.7s14.2-31.7 31.7-31.7h344.8c17.5 0 31.7 14.2 31.7 31.7s-14.1 31.7-31.7 31.7z","p-id":2826})),pEt=n=>y.createElement("svg",{t:1617006234540,className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg","p-id":2438,xmlnsXlink:"http://www.w3.org/1999/xlink",width:200,height:200,...n},y.createElement("defs",null,y.createElement("style",{type:"text/css"})),y.createElement("path",{d:"M256 256l512 0 0 512-512 0 0-512z","p-id":2439})),gEt=n=>y.createElement("svg",{t:1645694804889,className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg","p-id":5239,xmlnsXlink:"http://www.w3.org/1999/xlink",width:16,height:16,...n},y.createElement("defs",null,y.createElement("style",{type:"text/css"})),y.createElement("path",{d:"M853.333333 977.066667h-12.8c-136.533333-17.066667-273.066667-64-388.266666-136.533334-106.666667-68.266667-200.533333-162.133333-268.8-268.8-76.8-115.2-123.733333-251.733333-136.533334-388.266666 0-34.133333 8.533333-68.266667 29.866667-93.866667 21.333333-25.6 51.2-42.666667 85.333333-46.933333h140.8c64 0 119.466667 46.933333 128 110.933333 4.266667 38.4 12.8 76.8 25.6 110.933333 17.066667 46.933333 4.266667 98.133333-29.866666 136.533334l-29.866667 29.866666c51.2 76.8 115.2 145.066667 196.266667 196.266667l29.866666-29.866667c34.133333-34.133333 89.6-46.933333 136.533334-29.866666 34.133333 12.8 72.533333 21.333333 110.933333 25.6 64 8.533333 110.933333 64 110.933333 128v128c0 34.133333-12.8 68.266667-38.4 89.6s-55.466667 38.4-89.6 38.4zM302.933333 128h-128c-12.8 0-25.6 8.533333-34.133333 17.066667-4.266667 8.533333-8.533333 17.066667-8.533333 29.866666C145.066667 298.666667 187.733333 418.133333 256 524.8c64 98.133333 145.066667 183.466667 243.2 243.2 106.666667 68.266667 226.133333 110.933333 349.866667 123.733333 17.066667 0 25.6-4.266667 34.133333-12.8 8.533333-8.533333 12.8-17.066667 12.8-29.866666v-128c0-21.333333-17.066667-38.4-38.4-42.666667-42.666667-4.266667-85.333333-17.066667-128-34.133333-17.066667-4.266667-34.133333-4.266667-46.933333 8.533333l-55.466667 55.466667c-12.8 12.8-34.133333 17.066667-51.2 8.533333-115.2-64-209.066667-157.866667-273.066667-273.066667-4.266667-17.066667 0-38.4 12.8-51.2l55.466667-55.466666c8.533333-8.533333 12.8-29.866667 8.533333-42.666667-17.066667-42.666667-25.6-85.333333-34.133333-128 0-21.333333-21.333333-38.4-42.666667-38.4z","p-id":5240})),mEt=n=>y.createElement("svg",{t:1645694780871,className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg","p-id":5044,width:16,height:16,xmlnsXlink:"http://www.w3.org/1999/xlink",...n},y.createElement("defs",null,y.createElement("style",{type:"text/css"})),y.createElement("path",{d:"M853.333333 977.066667h-12.8c-136.533333-17.066667-273.066667-64-388.266666-136.533334-55.466667-34.133333-102.4-72.533333-149.333334-119.466666-17.066667-17.066667-17.066667-42.666667 0-59.733334s42.666667-17.066667 59.733334 0c42.666667 42.666667 85.333333 76.8 136.533333 106.666667 106.666667 68.266667 226.133333 110.933333 349.866667 123.733333 17.066667 0 25.6-4.266667 34.133333-12.8 8.533333-8.533333 12.8-17.066667 12.8-29.866666v-128c0-21.333333-17.066667-38.4-38.4-42.666667-42.666667-4.266667-85.333333-17.066667-128-34.133333-17.066667-4.266667-34.133333-4.266667-46.933333 8.533333l-55.466667 55.466667c-12.8 12.8-34.133333 17.066667-51.2 8.533333C524.8 682.666667 469.333333 644.266667 426.666667 597.333333c-17.066667-17.066667-17.066667-42.666667 0-59.733333 17.066667-17.066667 42.666667-17.066667 59.733333 0 34.133333 34.133333 68.266667 64 106.666667 85.333333l29.866666-29.866666c34.133333-34.133333 89.6-46.933333 136.533334-29.866667 34.133333 12.8 72.533333 21.333333 110.933333 25.6 64 8.533333 110.933333 64 110.933333 128v128c0 34.133333-12.8 68.266667-38.4 89.6s-55.466667 42.666667-89.6 42.666667zM221.866667 588.8c-12.8 0-25.6-8.533333-34.133334-21.333333-76.8-115.2-123.733333-247.466667-136.533333-388.266667-4.266667-29.866667 4.266667-64 25.6-89.6 21.333333-25.6 51.2-42.666667 85.333333-46.933333h140.8c64 0 119.466667 46.933333 128 110.933333 4.266667 38.4 12.8 76.8 25.6 110.933333 17.066667 46.933333 4.266667 98.133333-29.866666 136.533334l-55.466667 55.466666c-17.066667 17.066667-42.666667 17.066667-59.733333 0s-17.066667-42.666667 0-59.733333L366.933333 341.333333c12.8-12.8 17.066667-34.133333 12.8-46.933333-17.066667-42.666667-25.6-85.333333-34.133333-128-4.266667-21.333333-21.333333-38.4-42.666667-38.4h-128c-12.8 0-25.6 8.533333-34.133333 17.066667-4.266667 8.533333-8.533333 17.066667-8.533333 29.866666C145.066667 298.666667 187.733333 418.133333 256 524.8c12.8 21.333333 8.533333 46.933333-12.8 59.733333-4.266667 4.266667-12.8 4.266667-21.333333 4.266667z","p-id":5045}),y.createElement("path",{d:"M42.666667 1024c-12.8 0-21.333333-4.266667-29.866667-12.8-17.066667-17.066667-17.066667-42.666667 0-59.733333l938.666667-938.666667c17.066667-17.066667 42.666667-17.066667 59.733333 0s17.066667 42.666667 0 59.733333l-938.666667 938.666667c-8.533333 8.533333-17.066667 12.8-29.866666 12.8z","p-id":5046})),vEt=n=>y.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...n},y.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M20.5 12C20.5 16.6944 16.6944 20.5 12 20.5C7.30558 20.5 3.5 16.6944 3.5 12C3.5 7.30558 7.30558 3.5 12 3.5C16.6944 3.5 20.5 7.30558 20.5 12ZM22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12ZM12 19C15.866 19 19 15.866 19 12C19 8.13401 15.866 5 12 5C8.13401 5 5 8.13401 5 12C5 15.866 8.13401 19 12 19Z",fill:"white",fillOpacity:.62})),yEt=n=>y.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...n},y.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M20.5 12C20.5 16.6944 16.6944 20.5 12 20.5C7.30558 20.5 3.5 16.6944 3.5 12C3.5 7.30558 7.30558 3.5 12 3.5C16.6944 3.5 20.5 7.30558 20.5 12ZM22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12ZM12 19C15.866 19 19 15.866 19 12C19 8.13401 15.866 5 12 5C8.13401 5 5 8.13401 5 12C5 15.866 8.13401 19 12 19Z",fill:"white",fillOpacity:.8})),bEt=n=>y.createElement("svg",{width:32,height:16,viewBox:"0 0 32 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...n},y.createElement("circle",{cx:3.89062,cy:8,r:3,fill:"#DE2828"},y.createElement("animate",{attributeName:"fill",from:"#DE2828",to:"#FF5C5C",dur:"1.5s",repeatCount:"indefinite",calcMode:"discrete"})),y.createElement("path",{d:"M12.3652 8.94482H13.5713L14.8848 11.5229H16.5547L15.0703 8.7251C15.8809 8.40771 16.3496 7.62646 16.3496 6.72314C16.3496 5.33154 15.3975 4.47705 13.8496 4.47705H10.8906V11.5229H12.3652V8.94482ZM12.3652 5.62939H13.6445C14.377 5.62939 14.8359 6.05908 14.8359 6.74268C14.8359 7.44092 14.4014 7.84619 13.6592 7.84619H12.3652V5.62939Z",fill:"white",fillOpacity:.62}),y.createElement("path",{d:"M22.502 10.3071H19.3086V8.5249H22.3213V7.39209H19.3086V5.69287H22.502V4.47705H17.834V11.5229H22.502V10.3071Z",fill:"white",fillOpacity:.62}),y.createElement("path",{d:"M27.0479 11.7036C28.7471 11.7036 29.9873 10.6733 30.1094 9.16943H28.6738C28.5322 9.9458 27.8975 10.4438 27.0527 10.4438C25.9395 10.4438 25.251 9.50635 25.251 7.99756C25.251 6.48877 25.9395 5.55127 27.0479 5.55127C27.8877 5.55127 28.5273 6.08838 28.6689 6.90381H30.1045C29.9971 5.39014 28.7178 4.29639 27.0479 4.29639C25.002 4.29639 23.7422 5.70752 23.7422 7.99756C23.7422 10.2876 25.0068 11.7036 27.0479 11.7036Z",fill:"white",fillOpacity:.62})),SEt=n=>y.createElement("svg",{width:32,height:16,viewBox:"0 0 32 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...n},y.createElement("circle",{cx:3.89062,cy:8,r:3,fill:"#DE2828"},y.createElement("animate",{attributeName:"fill",from:"#DE2828",to:"#FF5C5C",dur:"1.5s",repeatCount:"indefinite",calcMode:"discrete"})),y.createElement("path",{d:"M12.3652 8.94482H13.5713L14.8848 11.5229H16.5547L15.0703 8.7251C15.8809 8.40771 16.3496 7.62646 16.3496 6.72314C16.3496 5.33154 15.3975 4.47705 13.8496 4.47705H10.8906V11.5229H12.3652V8.94482ZM12.3652 5.62939H13.6445C14.377 5.62939 14.8359 6.05908 14.8359 6.74268C14.8359 7.44092 14.4014 7.84619 13.6592 7.84619H12.3652V5.62939Z",fill:"white",fillOpacity:.8}),y.createElement("path",{d:"M22.502 10.3071H19.3086V8.5249H22.3213V7.39209H19.3086V5.69287H22.502V4.47705H17.834V11.5229H22.502V10.3071Z",fill:"white",fillOpacity:.8}),y.createElement("path",{d:"M27.0479 11.7036C28.7471 11.7036 29.9873 10.6733 30.1094 9.16943H28.6738C28.5322 9.9458 27.8975 10.4438 27.0527 10.4438C25.9395 10.4438 25.251 9.50635 25.251 7.99756C25.251 6.48877 25.9395 5.55127 27.0479 5.55127C27.8877 5.55127 28.5273 6.08838 28.6689 6.90381H30.1045C29.9971 5.39014 28.7178 4.29639 27.0479 4.29639C25.002 4.29639 23.7422 5.70752 23.7422 7.99756C23.7422 10.2876 25.0068 11.7036 27.0479 11.7036Z",fill:"white",fillOpacity:.8})),_Et=n=>y.createElement("svg",{width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...n},y.createElement("rect",{x:3.71875,y:3.5,width:9,height:9,rx:1.5,fill:"white",fillOpacity:.62})),wEt=n=>y.createElement("svg",{width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...n},y.createElement("rect",{x:3.71875,y:3.5,width:9,height:9,rx:1.5,fill:"white",fillOpacity:.8})),CEt=n=>y.createElement("svg",{width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...n},y.createElement("path",{d:"M3.84375 12.601V3.3978C3.84375 2.72248 4.57631 2.30172 5.15964 2.642L13.0481 7.24359C13.6269 7.58123 13.6269 8.41756 13.0481 8.7552L5.15964 13.3568C4.57631 13.6971 3.84375 13.2763 3.84375 12.601Z",fill:"white",fillOpacity:.62})),xEt=n=>y.createElement("svg",{width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...n},y.createElement("path",{d:"M3.84375 12.601V3.3978C3.84375 2.72248 4.57631 2.30172 5.15964 2.642L13.0481 7.24359C13.6269 7.58123 13.6269 8.41756 13.0481 8.7552L5.15964 13.3568C4.57631 13.6971 3.84375 13.2763 3.84375 12.601Z",fill:"white",fillOpacity:.8})),EEt=n=>y.createElement("svg",{width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...n},y.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5.21875 3.5C4.80454 3.5 4.46875 3.83579 4.46875 4.25V11.75C4.46875 12.1642 4.80454 12.5 5.21875 12.5C5.63296 12.5 5.96875 12.1642 5.96875 11.75V4.25C5.96875 3.83579 5.63296 3.5 5.21875 3.5ZM11.2188 3.5C10.8045 3.5 10.4688 3.83579 10.4688 4.25V11.75C10.4688 12.1642 10.8045 12.5 11.2188 12.5C11.633 12.5 11.9688 12.1642 11.9688 11.75V4.25C11.9688 3.83579 11.633 3.5 11.2188 3.5Z",fill:"white",fillOpacity:.62})),IEt=n=>y.createElement("svg",{width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...n},y.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5.21875 3.5C4.80454 3.5 4.46875 3.83579 4.46875 4.25V11.75C4.46875 12.1642 4.80454 12.5 5.21875 12.5C5.63296 12.5 5.96875 12.1642 5.96875 11.75V4.25C5.96875 3.83579 5.63296 3.5 5.21875 3.5ZM11.2188 3.5C10.8045 3.5 10.4688 3.83579 10.4688 4.25V11.75C10.4688 12.1642 10.8045 12.5 11.2188 12.5C11.633 12.5 11.9688 12.1642 11.9688 11.75V4.25C11.9688 3.83579 11.633 3.5 11.2188 3.5Z",fill:"white",fillOpacity:.8})),PEt=n=>y.createElement("svg",{viewBox:"64 64 896 896",focusable:"false","data-icon":"copyright",width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true",...n},y.createElement("path",{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372zm5.6-532.7c53 0 89 33.8 93 83.4.3 4.2 3.8 7.4 8 7.4h56.7c2.6 0 4.7-2.1 4.7-4.7 0-86.7-68.4-147.4-162.7-147.4C407.4 290 344 364.2 344 486.8v52.3C344 660.8 407.4 734 517.3 734c94 0 162.7-58.8 162.7-141.4 0-2.6-2.1-4.7-4.7-4.7h-56.8c-4.2 0-7.6 3.2-8 7.3-4.2 46.1-40.1 77.8-93 77.8-65.3 0-102.1-47.9-102.1-133.6v-52.6c.1-87 37-135.5 102.2-135.5z"})),kEt=n=>y.createElement("svg",{t:1691032372900,className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg","p-id":3198,width:200,height:200,...n},y.createElement("path",{d:"M768 470.016l0-43.989333q0-18.005333-11.989333-29.994667t-29.994667-11.989333l-128 0q-18.005333 0-31.018667 11.989333t-13.013333 29.994667l0 171.989333q0 18.005333 13.013333 29.994667t31.018667 11.989333l128 0q18.005333 0 29.994667-11.989333t11.989333-29.994667l0-43.989333-64 0 0 22.016-86.016 0 0-128 86.016 0 0 22.016 64 0zM470.016 470.016l0-43.989333q0-18.005333-13.013333-29.994667t-31.018667-11.989333l-128 0q-18.005333 0-29.994667 11.989333t-11.989333 29.994667l0 171.989333q0 18.005333 11.989333 29.994667t29.994667 11.989333l128 0q18.005333 0 31.018667-11.989333t13.013333-29.994667l0-43.989333-64 0 0 22.016-86.016 0 0-128 86.016 0 0 22.016 64 0zM809.984 169.984q34.005333 0 59.989333 25.984t25.984 59.989333l0 512q0 34.005333-25.984 59.989333t-59.989333 25.984l-596.010667 0q-36.010667 0-61.013333-25.984t-25.002667-59.989333l0-512q0-34.005333 25.002667-59.989333t61.013333-25.984l596.010667 0z","p-id":3199})),TEt=n=>y.createElement("svg",{viewBox:"64 64 896 896",focusable:"false","data-icon":"logout",width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true",...n},y.createElement("path",{d:"M868 732h-70.3c-4.8 0-9.3 2.1-12.3 5.8-7 8.5-14.5 16.7-22.4 24.5a353.84 353.84 0 01-112.7 75.9A352.8 352.8 0 01512.4 866c-47.9 0-94.3-9.4-137.9-27.8a353.84 353.84 0 01-112.7-75.9 353.28 353.28 0 01-76-112.5C167.3 606.2 158 559.9 158 512s9.4-94.2 27.8-137.8c17.8-42.1 43.4-80 76-112.5s70.5-58.1 112.7-75.9c43.6-18.4 90-27.8 137.9-27.8 47.9 0 94.3 9.3 137.9 27.8 42.2 17.8 80.1 43.4 112.7 75.9 7.9 7.9 15.3 16.1 22.4 24.5 3 3.7 7.6 5.8 12.3 5.8H868c6.3 0 10.2-7 6.7-12.3C798 160.5 663.8 81.6 511.3 82 271.7 82.6 79.6 277.1 82 516.4 84.4 751.9 276.2 942 512.4 942c152.1 0 285.7-78.8 362.3-197.7 3.4-5.3-.4-12.3-6.7-12.3zm88.9-226.3L815 393.7c-5.3-4.2-13-.4-13 6.3v76H488c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h314v76c0 6.7 7.8 10.5 13 6.3l141.9-112a8 8 0 000-12.6z"})),DEt=n=>y.createElement("svg",{viewBox:"64 64 896 896",focusable:"false","data-icon":"close",width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true",...n},y.createElement("path",{d:"M563.8 512l262.5-312.9c4.4-5.2.7-13.1-6.1-13.1h-79.8c-4.7 0-9.2 2.1-12.3 5.7L511.6 449.8 295.1 191.7c-3-3.6-7.5-5.7-12.3-5.7H203c-6.8 0-10.5 7.9-6.1 13.1L459.4 512 196.9 824.9A7.95 7.95 0 00203 838h79.8c4.7 0 9.2-2.1 12.3-5.7l216.5-258.1 216.5 258.1c3 3.6 7.5 5.7 12.3 5.7h79.8c6.8 0 10.5-7.9 6.1-13.1L563.8 512z"})),REt=n=>y.createElement("svg",{t:1669859616067,className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg","p-id":2687,xmlnsXlink:"http://www.w3.org/1999/xlink",width:200,height:200,...n},y.createElement("path",{d:"M932.571429 54.857143H91.428571c-20.228571 0-36.571429 16.342857-36.571428 36.571428v841.142858c0 20.228571 16.342857 36.571429 36.571428 36.571428h841.142858c20.228571 0 36.571429-16.342857 36.571428-36.571428V91.428571c0-20.228571-16.342857-36.571429-36.571428-36.571428z m-45.714286 832H137.142857V137.142857h749.714286v749.714286zM315.428571 707.428571v88c0 5.028571 4.114286 9.142857 9.142858 9.142858h54.857142c5.028571 0 9.142857-4.114286 9.142858-9.142858v-88c-11.542857 3.771429-23.771429 5.714286-36.571429 5.714286s-25.028571-2.057143-36.571429-5.714286z m73.142858-226.285714V228.571429c0-5.028571-4.114286-9.142857-9.142858-9.142858h-54.857142c-5.028571 0-9.142857 4.114286-9.142858 9.142858v252.571428c11.542857-3.771429 23.771429-5.714286 36.571429-5.714286s25.028571 2.057143 36.571429 5.714286z m-73.142858 226.285714c11.542857 3.771429 23.771429 5.714286 36.571429 5.714286s25.028571-2.057143 36.571429-5.714286c47.771429-15.428571 82.285714-60.228571 82.285714-113.142857s-34.514286-97.714286-82.285714-113.142857c-11.542857-3.771429-23.771429-5.714286-36.571429-5.714286s-25.028571 2.057143-36.571429 5.714286c-47.771429 15.428571-82.285714 60.228571-82.285714 113.142857s34.514286 97.714286 82.285714 113.142857z m0.114286-132.228571c0.342857-0.685714 0.8-1.371429 1.142857-2.057143v-0.114286l1.371429-2.057142c0.114286-0.228571 0.228571-0.342857 0.342857-0.571429 0.342857-0.571429 0.8-1.028571 1.142857-1.6 0.114286-0.114286 0.228571-0.342857 0.342857-0.457143 0.571429-0.685714 1.028571-1.257143 1.6-1.828571l0.342857-0.342857 1.371429-1.371429 0.457143-0.457143c0.571429-0.571429 1.142857-1.028571 1.828571-1.6 0.685714-0.571429 1.257143-1.028571 1.942857-1.485714 0.228571-0.114286 0.342857-0.228571 0.571429-0.342857 0.571429-0.342857 1.028571-0.8 1.6-1.142857 0.114286-0.114286 0.342857-0.228571 0.457143-0.342858 0.685714-0.457143 1.371429-0.8 2.171428-1.257142 0.114286-0.114286 0.342857-0.114286 0.457143-0.228572 0.571429-0.342857 1.142857-0.571429 1.828572-0.914286l0.685714-0.342857c0.8-0.342857 1.485714-0.685714 2.285714-0.914285 0.8-0.342857 1.6-0.571429 2.4-0.8 0.228571-0.114286 0.457143-0.114286 0.685715-0.228572 0.685714-0.228571 1.257143-0.342857 1.942857-0.457143 0.228571 0 0.342857-0.114286 0.571428-0.114285 0.8-0.228571 1.714286-0.342857 2.514286-0.457143 0.228571 0 0.342857 0 0.571429-0.114286 0.685714-0.114286 1.371429-0.114286 2.057142-0.228571h0.685715c0.914286 0 1.714286-0.114286 2.628571-0.114286s1.714286 0 2.628572 0.114286h0.685714c0.685714 0 1.371429 0.114286 2.057143 0.228571 0.228571 0 0.342857 0 0.571428 0.114286 0.8 0.114286 1.714286 0.228571 2.514286 0.457143 0.228571 0 0.342857 0.114286 0.571429 0.114285 0.685714 0.114286 1.371429 0.342857 1.942857 0.457143 0.228571 0.114286 0.457143 0.114286 0.685714 0.228572 0.8 0.228571 1.6 0.457143 2.4 0.8 0.8 0.228571 1.485714 0.571429 2.285714 0.914285l0.685715 0.342857c0.571429 0.228571 1.257143 0.571429 1.828571 0.914286 0.114286 0.114286 0.342857 0.114286 0.457143 0.228572 0.685714 0.342857 1.485714 0.8 2.171428 1.257142 0.114286 0.114286 0.342857 0.228571 0.457143 0.342858 0.571429 0.342857 1.142857 0.685714 1.6 1.142857 0.228571 0.114286 0.342857 0.228571 0.571429 0.342857 0.685714 0.457143 1.371429 1.028571 1.942857 1.485714s1.257143 1.028571 1.828571 1.6l0.457143 0.457143 1.371429 1.371429 0.342857 0.342857c0.571429 0.571429 1.142857 1.257143 1.6 1.828571 0.114286 0.114286 0.228571 0.342857 0.342857 0.457143 0.457143 0.457143 0.8 1.028571 1.142857 1.6 0.114286 0.228571 0.228571 0.342857 0.342857 0.571429l1.371429 2.057142s0 0.114286 0.114286 0.114286a41.348571 41.348571 0 0 1 5.828571 21.142857c0 6.857143-1.714286 13.371429-4.685714 19.085715-0.342857 0.685714-0.8 1.371429-1.142857 2.057142 0 0 0 0.114286-0.114286 0.114286l-1.371429 2.057143c-0.114286 0.228571-0.228571 0.342857-0.342857 0.571429-0.342857 0.571429-0.8 1.028571-1.142857 1.6-0.114286 0.114286-0.228571 0.342857-0.342857 0.457142-0.571429 0.685714-1.028571 1.257143-1.6 1.828572l-0.342857 0.342857-1.371429 1.371429-0.457143 0.457142c-0.571429 0.571429-1.142857 1.028571-1.828571 1.6-0.685714 0.571429-1.257143 1.028571-1.942857 1.485715-0.228571 0.114286-0.342857 0.228571-0.571429 0.342857-0.571429 0.342857-1.028571 0.8-1.6 1.142857-0.114286 0.114286-0.342857 0.228571-0.457143 0.342857-0.685714 0.457143-1.371429 0.8-2.171428 1.257143-0.114286 0.114286-0.342857 0.114286-0.457143 0.228571-0.571429 0.342857-1.142857 0.571429-1.828571 0.914286l-0.685715 0.342857c-0.8 0.342857-1.485714 0.685714-2.285714 0.914286-0.8 0.342857-1.6 0.571429-2.4 0.8-0.228571 0.114286-0.457143 0.114286-0.685714 0.228571-0.685714 0.228571-1.257143 0.342857-1.942857 0.457143-0.228571 0-0.342857 0.114286-0.571429 0.114286-0.8 0.228571-1.714286 0.342857-2.514286 0.457143-0.228571 0-0.342857 0-0.571428 0.114286-0.685714 0.114286-1.371429 0.114286-2.057143 0.228571h-0.685714c-0.914286 0-1.714286 0.114286-2.628572 0.114286s-1.714286 0-2.628571-0.114286h-0.685715c-0.685714 0-1.371429-0.114286-2.057142-0.228571-0.228571 0-0.342857 0-0.571429-0.114286-0.8-0.114286-1.714286-0.228571-2.514286-0.457143-0.228571 0-0.342857-0.114286-0.571428-0.114286-0.685714-0.114286-1.371429-0.342857-1.942857-0.457143-0.228571-0.114286-0.457143-0.114286-0.685715-0.228571-0.8-0.228571-1.6-0.457143-2.4-0.8-0.8-0.228571-1.485714-0.571429-2.285714-0.914286l-0.685714-0.342857c-0.571429-0.228571-1.257143-0.571429-1.828572-0.914286-0.114286-0.114286-0.342857-0.114286-0.457143-0.228571-0.685714-0.342857-1.485714-0.8-2.171428-1.257143-0.114286-0.114286-0.342857-0.228571-0.457143-0.342857-0.571429-0.342857-1.142857-0.685714-1.6-1.142857-0.228571-0.114286-0.342857-0.228571-0.571429-0.342857-0.685714-0.457143-1.371429-1.028571-1.942857-1.485715s-1.257143-1.028571-1.828571-1.6l-0.457143-0.457142-1.371429-1.371429-0.342857-0.342857c-0.571429-0.571429-1.142857-1.257143-1.6-1.828572-0.114286-0.114286-0.228571-0.342857-0.342857-0.457142-0.457143-0.457143-0.8-1.028571-1.142857-1.6-0.114286-0.228571-0.228571-0.342857-0.342857-0.571429l-1.371429-2.057143v-0.114286c-0.457143-0.685714-0.8-1.371429-1.142857-2.057142-2.971429-5.714286-4.685714-12.228571-4.685714-19.085715s1.714286-13.371429 4.685714-19.085714zM635.428571 542.857143v252.571428c0 5.028571 4.114286 9.142857 9.142858 9.142858h54.857142c5.028571 0 9.142857-4.114286 9.142858-9.142858V542.857143c-11.542857 3.771429-23.771429 5.714286-36.571429 5.714286s-25.028571-2.057143-36.571429-5.714286z m73.142858-226.285714v-88c0-5.028571-4.114286-9.142857-9.142858-9.142858h-54.857142c-5.028571 0-9.142857 4.114286-9.142858 9.142858v88c11.542857-3.771429 23.771429-5.714286 36.571429-5.714286s25.028571 2.057143 36.571429 5.714286z m-73.142858 226.285714c11.542857 3.771429 23.771429 5.714286 36.571429 5.714286s25.028571-2.057143 36.571429-5.714286c47.771429-15.428571 82.285714-60.228571 82.285714-113.142857s-34.514286-97.714286-82.285714-113.142857c-11.542857-3.771429-23.771429-5.714286-36.571429-5.714286s-25.028571 2.057143-36.571429 5.714286c-47.771429 15.428571-82.285714 60.228571-82.285714 113.142857s34.514286 97.714286 82.285714 113.142857z m0.114286-132.228572c0.342857-0.685714 0.8-1.371429 1.142857-2.057142v-0.114286l1.371429-2.057143c0.114286-0.228571 0.228571-0.342857 0.342857-0.571429 0.342857-0.571429 0.8-1.028571 1.142857-1.6 0.114286-0.114286 0.228571-0.342857 0.342857-0.457142 0.571429-0.685714 1.028571-1.257143 1.6-1.828572l0.342857-0.342857 1.371429-1.371429 0.457143-0.457142c0.571429-0.571429 1.142857-1.028571 1.828571-1.6 0.685714-0.571429 1.257143-1.028571 1.942857-1.485715 0.228571-0.114286 0.342857-0.228571 0.571429-0.342857 0.571429-0.342857 1.028571-0.8 1.6-1.142857 0.114286-0.114286 0.342857-0.228571 0.457143-0.342857 0.685714-0.457143 1.371429-0.8 2.171428-1.257143 0.114286-0.114286 0.342857-0.114286 0.457143-0.228571 0.571429-0.342857 1.142857-0.571429 1.828572-0.914286l0.685714-0.342857c0.8-0.342857 1.485714-0.685714 2.285714-0.914286 0.8-0.342857 1.6-0.571429 2.4-0.8 0.228571-0.114286 0.457143-0.114286 0.685715-0.228571 0.685714-0.228571 1.257143-0.342857 1.942857-0.457143 0.228571 0 0.342857-0.114286 0.571428-0.114286 0.8-0.228571 1.714286-0.342857 2.514286-0.457143 0.228571 0 0.342857 0 0.571429-0.114286 0.685714-0.114286 1.371429-0.114286 2.057142-0.228571h0.685715c0.914286 0 1.714286-0.114286 2.628571-0.114286s1.714286 0 2.628572 0.114286h0.685714c0.685714 0 1.371429 0.114286 2.057143 0.228571 0.228571 0 0.342857 0 0.571428 0.114286 0.8 0.114286 1.714286 0.228571 2.514286 0.457143 0.228571 0 0.342857 0.114286 0.571429 0.114286 0.685714 0.114286 1.371429 0.342857 1.942857 0.457143 0.228571 0.114286 0.457143 0.114286 0.685714 0.228571 0.8 0.228571 1.6 0.457143 2.4 0.8 0.8 0.228571 1.485714 0.571429 2.285714 0.914286l0.685715 0.342857c0.571429 0.228571 1.257143 0.571429 1.828571 0.914286 0.114286 0.114286 0.342857 0.114286 0.457143 0.228571 0.685714 0.342857 1.485714 0.8 2.171428 1.257143 0.114286 0.114286 0.342857 0.228571 0.457143 0.342857 0.571429 0.342857 1.142857 0.685714 1.6 1.142857 0.228571 0.114286 0.342857 0.228571 0.571429 0.342857 0.685714 0.457143 1.371429 1.028571 1.942857 1.485715s1.257143 1.028571 1.828571 1.6l0.457143 0.457142 1.371429 1.371429 0.342857 0.342857c0.571429 0.571429 1.142857 1.257143 1.6 1.828572 0.114286 0.114286 0.228571 0.342857 0.342857 0.457142 0.457143 0.457143 0.8 1.028571 1.142857 1.6 0.114286 0.228571 0.228571 0.342857 0.342857 0.571429l1.371429 2.057143v0.114286a41.348571 41.348571 0 0 1 5.828571 21.142857c0 6.857143-1.714286 13.371429-4.685714 19.085714-0.342857 0.685714-0.8 1.371429-1.142857 2.057143v0.114286l-1.371429 2.057142c-0.114286 0.228571-0.228571 0.342857-0.342857 0.571429-0.342857 0.571429-0.8 1.028571-1.142857 1.6-0.114286 0.114286-0.228571 0.342857-0.342857 0.457143-0.571429 0.685714-1.028571 1.257143-1.6 1.828571l-0.342857 0.342857-1.371429 1.371429-0.457143 0.457143c-0.571429 0.571429-1.142857 1.028571-1.828571 1.6-0.685714 0.571429-1.257143 1.028571-1.942857 1.485714-0.228571 0.114286-0.342857 0.228571-0.571429 0.342857-0.571429 0.342857-1.028571 0.8-1.6 1.142857-0.114286 0.114286-0.342857 0.228571-0.457143 0.342858-0.685714 0.457143-1.371429 0.8-2.171428 1.257142-0.114286 0.114286-0.342857 0.114286-0.457143 0.228572-0.571429 0.342857-1.142857 0.571429-1.828571 0.914286l-0.685715 0.342857c-0.8 0.342857-1.485714 0.685714-2.285714 0.914285-0.8 0.342857-1.6 0.571429-2.4 0.8-0.228571 0.114286-0.457143 0.114286-0.685714 0.228572-0.685714 0.228571-1.257143 0.342857-1.942857 0.457143-0.228571 0-0.342857 0.114286-0.571429 0.114285-0.8 0.228571-1.714286 0.342857-2.514286 0.457143-0.228571 0-0.342857 0-0.571428 0.114286-0.685714 0.114286-1.371429 0.114286-2.057143 0.228571h-0.685714c-0.914286 0-1.714286 0.114286-2.628572 0.114286s-1.714286 0-2.628571-0.114286h-0.685715c-0.685714 0-1.371429-0.114286-2.057142-0.228571-0.228571 0-0.342857 0-0.571429-0.114286-0.8-0.114286-1.714286-0.228571-2.514286-0.457143-0.228571 0-0.342857-0.114286-0.571428-0.114285-0.685714-0.114286-1.371429-0.342857-1.942857-0.457143-0.228571-0.114286-0.457143-0.114286-0.685715-0.228572-0.8-0.228571-1.6-0.457143-2.4-0.8-0.8-0.228571-1.485714-0.571429-2.285714-0.914285l-0.685714-0.342857c-0.571429-0.228571-1.257143-0.571429-1.828572-0.914286-0.114286-0.114286-0.342857-0.114286-0.457143-0.228572-0.685714-0.342857-1.485714-0.8-2.171428-1.257142-0.114286-0.114286-0.342857-0.228571-0.457143-0.342858-0.571429-0.342857-1.142857-0.685714-1.6-1.142857-0.228571-0.114286-0.342857-0.228571-0.571429-0.342857-0.685714-0.457143-1.371429-1.028571-1.942857-1.485714s-1.257143-1.028571-1.828571-1.6l-0.457143-0.457143-1.371429-1.371429-0.342857-0.342857c-0.571429-0.571429-1.142857-1.257143-1.6-1.828571-0.114286-0.114286-0.228571-0.342857-0.342857-0.457143-0.457143-0.457143-0.8-1.028571-1.142857-1.6-0.114286-0.228571-0.228571-0.342857-0.342857-0.571429l-1.371429-2.057142v-0.114286c-0.457143-0.685714-0.8-1.371429-1.142857-2.057143-2.971429-5.714286-4.685714-12.228571-4.685714-19.085714s1.714286-13.371429 4.685714-19.085715z","p-id":2688})),AEt=n=>y.createElement("svg",{t:1669865626712,className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg","p-id":3670,xmlnsXlink:"http://www.w3.org/1999/xlink",width:200,height:200,...n},y.createElement("path",{d:"M128 522.666667c17.066667 0 32-14.933333 32-32v-170.666667c0-6.4 4.266667-10.666667 10.666667-10.666667h652.8l-83.2 83.2c-12.8 12.8-12.8 34.133333 0 46.933334 6.4 6.4 14.933333 10.666667 23.466666 10.666666s17.066667-4.266667 23.466667-10.666666l145.066667-145.066667c12.8-12.8 12.8-34.133333 0-46.933333l-145.066667-145.066667c-12.8-12.8-34.133333-12.8-46.933333 0-12.8 12.8-12.8 34.133333 0 46.933333l93.866666 93.866667H170.666667c-40.533333 0-74.666667 34.133333-74.666667 74.666667v170.666666c0 19.2 14.933333 34.133333 32 34.133334zM906.666667 501.333333c-17.066667 0-32 14.933333-32 32v170.666667c0 6.4-4.266667 10.666667-10.666667 10.666667H211.2l83.2-83.2c12.8-12.8 12.8-34.133333 0-46.933334-12.8-12.8-34.133333-12.8-46.933333 0l-145.066667 145.066667c-12.8 12.8-12.8 34.133333 0 46.933333l145.066667 145.066667c6.4 6.4 14.933333 10.666667 23.466666 10.666667s17.066667-4.266667 23.466667-10.666667c12.8-12.8 12.8-34.133333 0-46.933333l-93.866667-93.866667h663.466667c40.533333 0 74.666667-34.133333 74.666667-74.666667v-170.666666c0-19.2-12.8-34.133333-32-34.133334z","p-id":3671})),OEt=n=>y.createElement("svg",{width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...n},y.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M13.75 2C13.3358 2 13 2.33579 13 2.75V13.25C13 13.6642 13.3358 14 13.75 14H14.25C14.6642 14 15 13.6642 15 13.25V2.75C15 2.33579 14.6642 2 14.25 2H13.75ZM9.75 4C9.33579 4 9 4.33579 9 4.75V13.25C9 13.6642 9.33579 14 9.75 14H10.25C10.6642 14 11 13.6642 11 13.25V4.75C11 4.33579 10.6642 4 10.25 4H9.75ZM5.75 7C5.33579 7 5 7.33579 5 7.75V13.25C5 13.6642 5.33579 14 5.75 14H6.25C6.66421 14 7 13.6642 7 13.25V7.75C7 7.33579 6.66421 7 6.25 7H5.75ZM1 10.75C1 10.3358 1.33579 10 1.75 10H2.25C2.66421 10 3 10.3358 3 10.75V13.25C3 13.6642 2.66421 14 2.25 14H1.75C1.33579 14 1 13.6642 1 13.25V10.75Z",fill:"white"})),MEt=n=>y.createElement("svg",{width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...n},y.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M13.75 2C13.3358 2 13 2.33579 13 2.75V13.25C13 13.6642 13.3358 14 13.75 14H14.25C14.6642 14 15 13.6642 15 13.25V2.75C15 2.33579 14.6642 2 14.25 2H13.75ZM9.75 4C9.33579 4 9 4.33579 9 4.75V13.25C9 13.6642 9.33579 14 9.75 14H10.25C10.6642 14 11 13.6642 11 13.25V4.75C11 4.33579 10.6642 4 10.25 4H9.75ZM5.75 7C5.33579 7 5 7.33579 5 7.75V13.25C5 13.6642 5.33579 14 5.75 14H6.25C6.66421 14 7 13.6642 7 13.25V7.75C7 7.33579 6.66421 7 6.25 7H5.75ZM1 10.75C1 10.3358 1.33579 10 1.75 10H2.25C2.66421 10 3 10.3358 3 10.75V13.25C3 13.6642 2.66421 14 2.25 14H1.75C1.33579 14 1 13.6642 1 13.25V10.75Z",fill:"#FEDD0F"})),$Et=n=>y.createElement("svg",{width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...n},y.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M13.75 2C13.3358 2 13 2.33579 13 2.75V13.25C13 13.6642 13.3358 14 13.75 14H14.25C14.6642 14 15 13.6642 15 13.25V2.75C15 2.33579 14.6642 2 14.25 2H13.75ZM9.75 4C9.33579 4 9 4.33579 9 4.75V13.25C9 13.6642 9.33579 14 9.75 14H10.25C10.6642 14 11 13.6642 11 13.25V4.75C11 4.33579 10.6642 4 10.25 4H9.75ZM5.75 7C5.33579 7 5 7.33579 5 7.75V13.25C5 13.6642 5.33579 14 5.75 14H6.25C6.66421 14 7 13.6642 7 13.25V7.75C7 7.33579 6.66421 7 6.25 7H5.75ZM1 10.75C1 10.3358 1.33579 10 1.75 10H2.25C2.66421 10 3 10.3358 3 10.75V13.25C3 13.6642 2.66421 14 2.25 14H1.75C1.33579 14 1 13.6642 1 13.25V10.75Z",fill:"#FF5C5C"})),LEt=n=>y.createElement("svg",{t:1690960726197,className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg","p-id":2305,width:200,height:200,...n},y.createElement("path",{d:"M895.957442 170.920521h-135.033586l49.277659-85.115957c15.99924-27.518693 6.399696-62.077051-21.118996-77.436321a55.99734 55.99734 0 0 0-77.436322 21.118996L629.730088 170.920521H394.221274L312.305166 28.2073A56.509316 56.509316 0 0 0 234.868844 7.728273c-27.518693 15.35927-36.478267 50.557599-21.118997 77.436322l49.277659 85.115957H127.99392c-70.396656 0-127.99392 57.597264-127.99392 127.99392V896.00608c0 70.396656 57.597264 127.99392 127.99392 127.99392h767.963522c70.396656 0 127.99392-57.597264 127.99392-127.99392V298.914442a127.99392 127.99392 0 0 0-127.99392-127.993921zM639.329632 630.418695a56.957295 56.957295 0 0 1-19.199088 19.839058L463.977961 748.813071c-0.63997 0-0.63997 0.63997-1.279939 0.63997-28.158662 15.99924-63.356991 5.759726-79.356231-21.758966-5.119757-9.599544-7.679635-19.839058-7.679635-30.718541V497.305018c-0.63997-32.63845 25.598784-59.517173 57.597264-60.157143 10.879483 0 21.758966 3.199848 30.718541 9.599544l157.432522 99.835258c27.518693 18.559118 35.198328 55.677355 17.919149 83.836018z","p-id":2306})),NEt=n=>y.createElement("svg",{t:1690961018889,className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg","p-id":5973,width:200,height:200,...n},y.createElement("path",{d:"M255.573333 210.304a32 32 0 0 1 0 45.226667 362.666667 362.666667 0 0 0 0 512.896 32 32 0 0 1-45.269333 45.269333c-166.613333-166.613333-166.613333-436.778667 0-603.392a32 32 0 0 1 45.226667 0z m558.122667 0c166.613333 166.613333 166.613333 436.778667 0 603.392a32 32 0 0 1-45.226667-45.226667 362.666667 362.666667 0 0 0 0-512.896 32 32 0 1 1 45.226667-45.269333zM376.234667 330.965333a32 32 0 0 1 0 45.269334 192 192 0 0 0 0 271.530666 32 32 0 0 1-45.226667 45.226667 256 256 0 0 1 0-362.026667 32 32 0 0 1 45.226667 0z m316.8 0a256 256 0 0 1 0 362.069334 32 32 0 1 1-45.269334-45.269334 192 192 0 0 0 0-271.530666 32 32 0 0 1 45.226667-45.226667zM512 448a64 64 0 1 1 0 128 64 64 0 0 1 0-128z","p-id":5974})),FEt=n=>y.createElement("svg",{width:17,height:16,viewBox:"0 0 17 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...n},y.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6.5 5C7.05228 5 7.5 4.55228 7.5 4C7.5 3.44772 7.05228 3 6.5 3C5.94772 3 5.5 3.44772 5.5 4C5.5 4.55228 5.94772 5 6.5 5ZM10.5 5C11.0523 5 11.5 4.55228 11.5 4C11.5 3.44772 11.0523 3 10.5 3C9.94772 3 9.5 3.44772 9.5 4C9.5 4.55228 9.94772 5 10.5 5ZM7.5 8C7.5 8.55228 7.05228 9 6.5 9C5.94772 9 5.5 8.55228 5.5 8C5.5 7.44772 5.94772 7 6.5 7C7.05228 7 7.5 7.44772 7.5 8ZM10.5 9C11.0523 9 11.5 8.55228 11.5 8C11.5 7.44772 11.0523 7 10.5 7C9.94772 7 9.5 7.44772 9.5 8C9.5 8.55228 9.94772 9 10.5 9ZM7.5 12C7.5 12.5523 7.05228 13 6.5 13C5.94772 13 5.5 12.5523 5.5 12C5.5 11.4477 5.94772 11 6.5 11C7.05228 11 7.5 11.4477 7.5 12ZM10.5 13C11.0523 13 11.5 12.5523 11.5 12C11.5 11.4477 11.0523 11 10.5 11C9.94772 11 9.5 11.4477 9.5 12C9.5 12.5523 9.94772 13 10.5 13Z",fill:"white",fillOpacity:.62})),jEt=n=>y.createElement("svg",{width:17,height:17,viewBox:"0 0 17 17",fill:"none",xmlns:"http://www.w3.org/2000/svg",...n},y.createElement("g",{clipPath:"url(#clip0_122_8061)"},y.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.22 1.25618C10.05 1.17618 9.85 1.19618 9.7 1.30618L5.83 4.20618H3C1.62 4.20618 0.5 5.32618 0.5 6.70618V9.70618C0.5 11.0862 1.62 12.2062 3 12.2062H5.83L9.7 15.1062C9.79 15.1762 9.89 15.2062 10 15.2062C10.08 15.2062 10.15 15.1862 10.22 15.1562C10.39 15.0662 10.5 14.8962 10.5 14.7062V1.70618C10.5 1.51618 10.39 1.34618 10.22 1.25618ZM16.5 8.20618C16.5 10.2252 15.749 12.0672 14.522 13.4772C14.333 13.6942 13.996 13.7022 13.792 13.4982C13.604 13.3102 13.597 13.0122 13.771 12.8122C14.851 11.5812 15.5 9.97718 15.5 8.20618C15.5 6.43518 14.851 4.83118 13.771 3.59918C13.597 3.40018 13.604 3.10218 13.792 2.91418C13.996 2.71018 14.333 2.71818 14.522 2.93518C15.749 4.34518 16.5 6.18718 16.5 8.20618ZM12.399 11.3422C13.087 10.4812 13.5 9.39217 13.5 8.20617C13.5 7.02017 13.087 5.93117 12.399 5.07017C12.219 4.84417 11.884 4.82217 11.68 5.02617L11.649 5.05617C11.474 5.23217 11.467 5.51017 11.621 5.70517C12.169 6.39417 12.5 7.26317 12.5 8.20617C12.5 9.14917 12.169 10.0182 11.621 10.7072C11.467 10.9022 11.474 11.1802 11.649 11.3552L11.68 11.3862C11.884 11.5902 12.219 11.5672 12.399 11.3422Z",fill:"#F5F5F5"})),y.createElement("defs",null,y.createElement("clipPath",{id:"clip0_122_8061"},y.createElement("rect",{width:16,height:16,fill:"white",transform:"translate(0.5 0.20752)"})))),BEt=n=>y.createElement("svg",{width:17,height:17,viewBox:"0 0 17 17",fill:"none",xmlns:"http://www.w3.org/2000/svg",...n},y.createElement("g",{clipPath:"url(#clip0_122_7950)"},y.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.22 1.25624C10.05 1.17624 9.85 1.19624 9.7 1.30624L5.83 4.20624H3C1.62 4.20624 0.5 5.32624 0.5 6.70624V9.70624C0.5 11.0862 1.62 12.2062 3 12.2062H5.83L9.7 15.1062C9.79 15.1762 9.89 15.2062 10 15.2062C10.08 15.2062 10.15 15.1862 10.22 15.1562C10.39 15.0662 10.5 14.8962 10.5 14.7062V1.70624C10.5 1.51624 10.39 1.34624 10.22 1.25624ZM11.6464 5.85397C11.8417 5.6587 12.1583 5.6587 12.3536 5.85397L14 7.50041L15.6464 5.85397C15.8417 5.6587 16.1583 5.6587 16.3536 5.85397C16.5488 6.04923 16.5488 6.36581 16.3536 6.56107L14.7071 8.20752L16.3536 9.85397C16.5488 10.0492 16.5488 10.3658 16.3536 10.5611C16.1583 10.7563 15.8417 10.7563 15.6464 10.5611L14 8.91463L12.3536 10.5611C12.1583 10.7563 11.8417 10.7563 11.6464 10.5611C11.4512 10.3658 11.4512 10.0492 11.6464 9.85397L13.2929 8.20752L11.6464 6.56107C11.4512 6.36581 11.4512 6.04923 11.6464 5.85397Z",fill:"#F5F5F5"})),y.createElement("defs",null,y.createElement("clipPath",{id:"clip0_122_7950"},y.createElement("rect",{width:16,height:16,fill:"white",transform:"translate(0.5 0.20752)"})))),HEt=n=>y.createElement("svg",{t:1701074038557,className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg","p-id":4060,xmlnsXlink:"http://www.w3.org/1999/xlink",width:200,height:200,...n},y.createElement("path",{d:"M904 540.032c4.48 0 8.064 3.648 8 8.192a419.904 419.904 0 0 1-750.72 250.24l-56.384 44.16a7.936 7.936 0 0 1-12.928-6.336l32.704-184.32c1.792-9.728 11.968-10.88 15.936-6.592 3.904 4.288 8.96 10.496 25.536 36.096 16.512 25.6 27.712 38.4 48.768 64.512 21.12 26.112 24.192 27.328 34.048 37.248a341.504 341.504 0 0 0 243.136 100.8 342.208 342.208 0 0 0 243.264-100.8 343.232 343.232 0 0 0 100.608-235.456 8 8 0 0 1 8-7.744zM372.416 439.04a5.184 5.184 0 0 1 7.36 0l25.792 25.792a5.184 5.184 0 0 1 0 7.296l-75.328 75.328a93.12 93.12 0 0 0 0 132.224 93.12 93.12 0 0 0 132.224 0l75.328-75.328a5.184 5.184 0 0 1 7.296 0l25.664 25.664a5.184 5.184 0 0 1 0 7.36l-75.328 75.328a140.16 140.16 0 0 1-198.272 0 140.16 140.16 0 0 1 0-198.4z m188.8-24.64a5.184 5.184 0 0 1 7.296 0l25.6 25.6a5.184 5.184 0 0 1 0 7.36L447.36 594.112a5.184 5.184 0 0 1-7.296 0l-25.664-25.6a5.184 5.184 0 0 1 0-7.36z m-46.848-117.248a140.352 140.352 0 0 1 198.336 198.4l-75.328 75.328a5.184 5.184 0 0 1-7.296 0l-25.792-25.856a5.184 5.184 0 0 1 0-7.296l75.264-75.328a93.12 93.12 0 0 0 0-132.224 93.12 93.12 0 0 0-132.16 0l-75.328 75.328a5.184 5.184 0 0 1-7.36 0l-25.728-25.728a5.184 5.184 0 0 1 0-7.36zM511.808 64c134.4 0 254.016 63.104 330.88 161.472l56.384-44.096A7.936 7.936 0 0 1 912 187.712a403619.2 403619.2 0 0 1-32.704 184.32c-1.728 9.728-11.968 10.88-15.872 6.592-3.968-4.288-9.024-10.496-25.6-36.096-16.512-25.6-27.712-38.4-48.768-64.512-21.12-26.112-24.128-27.328-34.048-37.248a341.504 341.504 0 0 0-243.136-100.8 342.208 342.208 0 0 0-243.264 100.864A343.232 343.232 0 0 0 168 476.16a8 8 0 0 1-8 7.808H99.968a8 8 0 0 1-8-8.256A419.904 419.904 0 0 1 511.808 64z","p-id":4061})),UEt=n=>y.createElement("svg",{width:16,height:16,viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg",...n},y.createElement("mask",{id:"mask0_400_366947",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:0,y:0,width:18,height:18},y.createElement("path",{d:"M13.9459 5.96792C14.1353 5.72168 14.0892 5.36852 13.843 5.17911C13.5967 4.9897 13.2436 5.03576 13.0541 5.282L7.81975 12.0867L4.89775 9.16471C4.67808 8.94504 4.32192 8.94504 4.10225 9.16471C3.88258 9.38438 3.88258 9.74054 4.10225 9.96021L7.47725 13.3352C7.59171 13.4497 7.74993 13.5093 7.91145 13.4988C8.07298 13.4883 8.22216 13.4087 8.32085 13.2804L13.9459 5.96792Z",fill:"#000001"}),y.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M18 9C18 13.9706 13.9706 18 9 18C4.02944 18 0 13.9706 0 9C0 4.02944 4.02944 0 9 0C13.9706 0 18 4.02944 18 9ZM16.875 9C16.875 13.3492 13.3492 16.875 9 16.875C4.65076 16.875 1.125 13.3492 1.125 9C1.125 4.65076 4.65076 1.125 9 1.125C13.3492 1.125 16.875 4.65076 16.875 9Z",fill:"#000001"})),y.createElement("g",{mask:"url(#mask0_400_366947)"},y.createElement("rect",{width:18,height:18,fill:"#268543"}))),zEt=n=>y.createElement("svg",{width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",...n},y.createElement("circle",{cx:10,cy:10,r:9,fill:"#0E72ED",stroke:"white",strokeWidth:2}),y.createElement("path",{d:"M9.5 12.2929V6.5C9.5 6.22388 9.72388 6 10 6C10.2761 6 10.5 6.22388 10.5 6.5V12.2929L12.6465 10.1464C12.8418 9.95117 13.1582 9.95117 13.3535 10.1464C13.5488 10.3417 13.5488 10.6583 13.3535 10.8536L10.3535 13.8536C10.1582 14.0488 9.8418 14.0488 9.64648 13.8536L6.64648 10.8536C6.45117 10.6583 6.45117 10.3417 6.64648 10.1464C6.8418 9.95117 7.1582 9.95117 7.35352 10.1464L9.5 12.2929Z",fill:"white"})),VEt=n=>y.createElement("svg",{width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",...n},y.createElement("circle",{cx:10,cy:10,r:9,fill:"#0E72ED",stroke:"white",strokeWidth:2}),y.createElement("path",{d:"M10.5 7.70709V13.5C10.5 13.7761 10.2761 14 10 14C9.72388 14 9.5 13.7761 9.5 13.5V7.70709L7.35352 9.85358C7.1582 10.0488 6.8418 10.0488 6.64648 9.85358C6.45117 9.65826 6.45117 9.34174 6.64648 9.14642L9.64648 6.14642C9.8418 5.95117 10.1582 5.95117 10.3535 6.14642L13.3535 9.14642C13.5488 9.34174 13.5488 9.65826 13.3535 9.85358C13.1582 10.0488 12.8418 10.0488 12.6465 9.85358L10.5 7.70709Z",fill:"white"})),WEt=n=>y.createElement("svg",{width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",...n},y.createElement("circle",{cx:10,cy:10,r:9,fill:"#0E72ED",stroke:"white",strokeWidth:2}),y.createElement("path",{d:"M10.0005 14.5C9.724 14.5 9.50032 14.2763 9.50032 13.9998C9.50032 13.7243 9.724 13.4997 10.0005 13.4997C11.933 13.4997 13.4997 11.933 13.4997 10.0005C13.4997 8.06704 11.933 6.50032 10.0005 6.50032C8.06704 6.50032 6.50032 8.06704 6.50032 10.0005C6.50032 10.276 6.27568 10.4997 6.00016 10.4997C5.72368 10.4997 5.5 10.276 5.5 10.0005C5.5 7.51504 7.51504 5.5 10.0005 5.5C12.485 5.5 14.5 7.51504 14.5 10.0005C14.5 12.485 12.485 14.5 10.0005 14.5Z",fill:"white"})),qEt=n=>y.createElement("svg",{width:32,height:33,viewBox:"0 0 32 33",fill:"none",xmlns:"http://www.w3.org/2000/svg",...n},y.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M16 32.5C24.8366 32.5 32 25.3366 32 16.5C32 7.66344 24.8366 0.5 16 0.5C7.16344 0.5 0 7.66344 0 16.5C0 25.3366 7.16344 32.5 16 32.5ZM14.5 17C14.5 17.8284 15.1716 18.5 16 18.5C16.8284 18.5 17.5 17.8284 17.5 17V10C17.5 9.17163 16.8284 8.5 16 8.5C15.1716 8.5 14.5 9.17163 14.5 10V17ZM14.5 22.5C14.5 23.3284 15.1716 24 16 24C16.8284 24 17.5 23.3284 17.5 22.5C17.5 21.6716 16.8284 21 16 21C15.1716 21 14.5 21.6716 14.5 22.5Z",fill:"#DE2828"})),KEt=n=>y.createElement("svg",{width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...n},y.createElement("g",{clipPath:"url(#clip0)"},y.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8.00033 -0.000152588C3.58214 -0.000152588 0.000488281 3.5815 0.000488281 7.99968C0.000488281 12.4179 3.58214 15.9995 8.00033 15.9995C12.4185 15.9995 16.0002 12.4179 16.0002 7.99968C16.0002 3.5815 12.4185 -0.000152588 8.00033 -0.000152588ZM11.3535 6.35312C11.5487 6.15785 11.5487 5.84127 11.3535 5.64601C11.1582 5.45075 10.8416 5.45075 10.6464 5.64601L6.99999 9.29237L5.35358 7.64597C5.15832 7.45071 4.84174 7.45071 4.64648 7.64597C4.45121 7.84123 4.45121 8.15781 4.64648 8.35308L6.64643 10.353C6.8417 10.5483 7.15828 10.5483 7.35354 10.353L11.3535 6.35312Z",fill:"#00A832"})),y.createElement("defs",null,y.createElement("clipPath",{id:"clip0"},y.createElement("rect",{width:16,height:16,fill:"white"})))),GEt=n=>y.createElement("svg",{width:17,height:16,viewBox:"0 0 17 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...n},y.createElement("g",{clipPath:"url(#clip0)"},y.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.88458 0.615385C7.88458 0.275517 8.1601 0 8.49997 0C8.83983 0 9.11535 0.275517 9.11535 0.615385V3.69231C9.11535 4.03218 8.83983 4.30769 8.49997 4.30769C8.1601 4.30769 7.88458 4.03218 7.88458 3.69231V0.615385Z",fill:"#F5F5F5"}),y.createElement("path",{opacity:.4,fillRule:"evenodd",clipRule:"evenodd",d:"M7.88458 12.3077C7.88458 11.9678 8.1601 11.6923 8.49997 11.6923C8.83983 11.6923 9.11535 11.9678 9.11535 12.3077V15.3846C9.11535 15.7245 8.83983 16 8.49997 16C8.1601 16 7.88458 15.7245 7.88458 15.3846V12.3077Z",fill:"#F5F5F5"}),y.createElement("path",{opacity:.2,fillRule:"evenodd",clipRule:"evenodd",d:"M15.8846 7.38462C16.2245 7.38462 16.5 7.66014 16.5 8.00001C16.5 8.33987 16.2245 8.61539 15.8846 8.61539H12.8077C12.4678 8.61539 12.1923 8.33987 12.1923 8.00001C12.1923 7.66014 12.4678 7.38462 12.8077 7.38462L15.8846 7.38462Z",fill:"#F5F5F5"}),y.createElement("path",{opacity:.7,fillRule:"evenodd",clipRule:"evenodd",d:"M4.19229 7.38462C4.53216 7.38462 4.80768 7.66014 4.80768 8.00001C4.80768 8.33987 4.53216 8.61539 4.19229 8.61539H1.11537C0.775503 8.61539 0.499986 8.33987 0.499986 8.00001C0.499986 7.66014 0.775503 7.38462 1.11537 7.38462L4.19229 7.38462Z",fill:"#F5F5F5"}),y.createElement("path",{opacity:.2,fillRule:"evenodd",clipRule:"evenodd",d:"M14.5876 3.77476C14.8819 3.60482 15.2583 3.70567 15.4282 4C15.5982 4.29434 15.4973 4.6707 15.203 4.84063L12.5383 6.3791C12.244 6.54903 11.8676 6.44818 11.6977 6.15385C11.5277 5.85951 11.6286 5.48315 11.9229 5.31322L14.5876 3.77476Z",fill:"#F5F5F5"}),y.createElement("path",{opacity:.6,fillRule:"evenodd",clipRule:"evenodd",d:"M4.46175 9.6209C4.75609 9.45097 5.13245 9.55181 5.30238 9.84615C5.47232 10.1405 5.37147 10.5168 5.07714 10.6868L2.41244 12.2252C2.11811 12.3952 1.74175 12.2943 1.57181 12C1.40188 11.7057 1.50272 11.3293 1.79706 11.1594L4.46175 9.6209Z",fill:"#F5F5F5"}),y.createElement("path",{opacity:.2,fillRule:"evenodd",clipRule:"evenodd",d:"M11.6593 1.29706C11.8293 1.00273 12.2056 0.90188 12.5 1.07181C12.7943 1.24175 12.8952 1.61811 12.7252 1.91245L11.1868 4.57714C11.0168 4.87147 10.6405 4.97232 10.3461 4.80239C10.0518 4.63245 9.95095 4.25609 10.1209 3.96175L11.6593 1.29706Z",fill:"#F5F5F5"}),y.createElement("path",{opacity:.5,fillRule:"evenodd",clipRule:"evenodd",d:"M5.81322 11.4229C5.98315 11.1286 6.35952 11.0277 6.65385 11.1976C6.94818 11.3676 7.04903 11.7439 6.8791 12.0383L5.34063 14.703C5.1707 14.9973 4.79434 15.0982 4.5 14.9282C4.20567 14.7583 4.10482 14.3819 4.27476 14.0876L5.81322 11.4229Z",fill:"#F5F5F5"}),y.createElement("path",{opacity:.3,fillRule:"evenodd",clipRule:"evenodd",d:"M12.7253 14.0875C12.8952 14.3819 12.7944 14.7582 12.5 14.9282C12.2057 15.0981 11.8293 14.9973 11.6594 14.7029L10.1209 12.0382C9.95099 11.7439 10.0518 11.3675 10.3462 11.1976C10.6405 11.0277 11.0169 11.1285 11.1868 11.4229L12.7253 14.0875Z",fill:"#F5F5F5"}),y.createElement("path",{opacity:.9,fillRule:"evenodd",clipRule:"evenodd",d:"M6.87908 3.96173C7.04901 4.25606 6.94816 4.63243 6.65383 4.80236C6.35949 4.97229 5.98313 4.87145 5.8132 4.57711L4.27474 1.91242C4.1048 1.61809 4.20565 1.24172 4.49998 1.07179C4.79432 0.901855 5.17068 1.0027 5.34061 1.29704L6.87908 3.96173Z",fill:"#F5F5F5"}),y.createElement("path",{opacity:.3,fillRule:"evenodd",clipRule:"evenodd",d:"M15.203 11.1594C15.4973 11.3293 15.5981 11.7057 15.4282 12C15.2583 12.2943 14.8819 12.3952 14.5876 12.2252L11.9229 10.6868C11.6286 10.5169 11.5277 10.1405 11.6976 9.84616C11.8676 9.55182 12.2439 9.45098 12.5383 9.62091L15.203 11.1594Z",fill:"#F5F5F5"}),y.createElement("path",{opacity:.8,fillRule:"evenodd",clipRule:"evenodd",d:"M5.07711 5.31322C5.37144 5.48315 5.47229 5.85952 5.30235 6.15385C5.13242 6.44818 4.75606 6.54903 4.46172 6.3791L1.79703 4.84063C1.5027 4.6707 1.40185 4.29434 1.57178 4C1.74172 3.70567 2.11808 3.60482 2.41241 3.77476L5.07711 5.31322Z",fill:"#F5F5F5"})),y.createElement("defs",null,y.createElement("clipPath",{id:"clip0"},y.createElement("rect",{width:16,height:16,fill:"white",transform:"translate(0.5)"})))),ZEt=n=>y.createElement("svg",{width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...n},y.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.57277 9.30628L3.81388 10.0652C3.50625 9.44267 3.33337 8.74169 3.33337 8.00033C3.33337 7.72418 3.55723 7.50033 3.83337 7.50033C4.10952 7.50033 4.33337 7.72418 4.33337 8.00033C4.33337 8.46035 4.41809 8.90058 4.57277 9.30628ZM6.33337 7.54567L5.37994 8.4991C5.34937 8.33753 5.33337 8.17079 5.33337 8.00033V3.33366C5.33337 1.8609 6.52728 0.666992 8.00004 0.666992C9.43302 0.666992 10.602 1.79727 10.6641 3.21493L9.66671 4.21234V3.33366C9.66671 2.41318 8.92052 1.66699 8.00004 1.66699C7.07957 1.66699 6.33337 2.41318 6.33337 3.33366V7.54567ZM5.9352 12.1865L6.69409 11.4276C7.09979 11.5823 7.54002 11.667 8.00004 11.667C10.0251 11.667 11.6667 10.0254 11.6667 8.00033C11.6667 7.72418 11.8906 7.50033 12.1667 7.50033C12.4429 7.50033 12.6667 7.72418 12.6667 8.00033C12.6667 10.4087 10.8423 12.391 8.50004 12.6405V14.3337H10C10.2762 14.3337 10.5 14.5575 10.5 14.8337C10.5 15.1098 10.2762 15.3337 10 15.3337L9.99743 15.3337H8.50004H7.50004H6.00004C5.7239 15.3337 5.50004 15.1098 5.50004 14.8337C5.50004 14.5575 5.7239 14.3337 6.00004 14.3337H7.50004V12.6405C6.94333 12.5812 6.41587 12.424 5.9352 12.1865ZM7.50126 10.6204C7.66284 10.651 7.82957 10.667 8.00004 10.667C9.4728 10.667 10.6667 9.47308 10.6667 8.00033V7.45498L9.57514 8.54655C9.40833 9.02763 9.02734 9.40862 8.54626 9.57542L7.50126 10.6204Z",fill:"#DE2828"}),y.createElement("path",{d:"M15.5 0.5L0.5 15.5",stroke:"#DE2828",strokeLinecap:"round"})),XEt=n=>y.createElement("svg",{width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...n},y.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.66665 7.99984V3.33317C9.66665 2.4127 8.92045 1.6665 7.99998 1.6665C7.0795 1.6665 6.33331 2.4127 6.33331 3.33317V7.99984C6.33331 8.92031 7.07951 9.6665 7.99998 9.6665C8.92045 9.6665 9.66665 8.92031 9.66665 7.99984ZM7.99998 0.666504C6.52722 0.666504 5.33331 1.86041 5.33331 3.33317V7.99984C5.33331 9.4726 6.52722 10.6665 7.99998 10.6665C9.47274 10.6665 10.6666 9.4726 10.6666 7.99984V3.33317C10.6666 1.86041 9.47274 0.666504 7.99998 0.666504ZM8.49998 12.64C10.8422 12.3905 12.6666 10.4083 12.6666 7.99984C12.6666 7.7237 12.4428 7.49984 12.1666 7.49984C11.8905 7.49984 11.6666 7.7237 11.6666 7.99984C11.6666 10.0249 10.025 11.6665 7.99998 11.6665C5.97494 11.6665 4.33331 10.0249 4.33331 7.99984C4.33331 7.7237 4.10946 7.49984 3.83331 7.49984C3.55717 7.49984 3.33331 7.7237 3.33331 7.99984C3.33331 10.4083 5.15776 12.3905 7.49998 12.64V14.3332H5.99998C5.72384 14.3332 5.49998 14.557 5.49998 14.8332C5.49998 15.1093 5.72384 15.3332 5.99998 15.3332L6.00259 15.3332H7.49998H8.49998H9.99998C10.2761 15.3332 10.5 15.1093 10.5 14.8332C10.5 14.557 10.2761 14.3332 9.99998 14.3332H8.49998V12.64Z",fill:"#6E6E76"})),YEt=n=>y.createElement("svg",{width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...n},y.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.66665 7.99984V3.33317C9.66665 2.4127 8.92045 1.6665 7.99998 1.6665C7.0795 1.6665 6.33331 2.4127 6.33331 3.33317V7.99984C6.33331 8.92031 7.07951 9.6665 7.99998 9.6665C8.92045 9.6665 9.66665 8.92031 9.66665 7.99984ZM7.99998 0.666504C6.52722 0.666504 5.33331 1.86041 5.33331 3.33317V7.99984C5.33331 9.4726 6.52722 10.6665 7.99998 10.6665C9.47274 10.6665 10.6666 9.4726 10.6666 7.99984V3.33317C10.6666 1.86041 9.47274 0.666504 7.99998 0.666504ZM8.49998 12.64C10.8422 12.3905 12.6666 10.4083 12.6666 7.99984C12.6666 7.7237 12.4428 7.49984 12.1666 7.49984C11.8905 7.49984 11.6666 7.7237 11.6666 7.99984C11.6666 10.0249 10.025 11.6665 7.99998 11.6665C5.97494 11.6665 4.33331 10.0249 4.33331 7.99984C4.33331 7.7237 4.10946 7.49984 3.83331 7.49984C3.55717 7.49984 3.33331 7.7237 3.33331 7.99984C3.33331 10.4083 5.15776 12.3905 7.49998 12.64V14.3332H5.99998C5.72384 14.3332 5.49998 14.557 5.49998 14.8332C5.49998 15.1093 5.72384 15.3332 5.99998 15.3332L6.00259 15.3332H7.49998H8.49998H9.99998C10.2761 15.3332 10.5 15.1093 10.5 14.8332C10.5 14.557 10.2761 14.3332 9.99998 14.3332H8.49998V12.64Z",fill:"#6E6E76"}),y.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8.99915 9.3335C8.72003 9.54478 8.37224 9.67012 7.99518 9.67012C7.61812 9.67012 7.27033 9.54478 6.99121 9.3335H8.99915Z",fill:"#6E6E76"},y.createElement("animate",{attributeName:"d",values:"M8.99915 9.3335C8.72003 9.54478 8.37224 9.67012 7.99518 9.67012C7.61812 9.67012 7.27033 9.54478 6.99121 9.3335H8.99915Z;M8.99915 9.3335C8.72003 9.54478 8.37224 9.67012 7.99518 9.67012C7.61812 9.67012 7.27033 9.54478 6.99121 9.3335H8.99915Z;M10.5828 8.6665C10.2868 9.81665 9.24269 10.6665 8.00014 10.6665C6.75758 10.6665 5.71351 9.81665 5.41748 8.6665H10.5828Z;M7.9956 10.6667C6.52487 10.6643 5.33334 9.47129 5.33334 8V8H10.6666V8.02325C10.6541 9.48384 9.4674 10.6643 8.00442 10.6667H7.9956Z;M10.6664 7.3335V8.00016C10.6664 9.47292 9.47245 10.6668 7.99969 10.6668C6.53498 10.6668 5.34608 9.48593 5.33313 8.02427V7.3335H10.6664Z;M10.6665 6.6665V7.99982C10.6665 9.47258 9.47255 10.6665 7.99979 10.6665C6.53348 10.6665 5.34358 9.48301 5.33319 8.01915V6.6665H10.6665Z;M7.9837 10.6667C6.5185 10.6578 5.33347 9.46733 5.33347 8.00005V6H10.6663V8.05015C10.6397 9.49433 9.46505 10.6579 8.01657 10.6667H7.9837Z;M10.6668 8.00661C10.6633 9.4764 9.47077 10.6668 8.00016 10.6668C6.5274 10.6668 5.3335 9.47292 5.3335 8.00016V5.3335H10.6668V8.00661Z;M10.6666 8.01563C10.6581 9.48112 9.46747 10.6665 7.99998 10.6665C6.52722 10.6665 5.33331 9.4726 5.33331 7.99984V4.6665H10.6666V8.01563Z;M7.99545 10.6667C6.52479 10.6642 5.33334 9.47124 5.33334 8V4H10.6666V8.02151C10.6551 9.48285 9.46806 10.6642 8.00457 10.6667H7.99545Z;M5.33325 3.3335C5.33325 3.3335 5.33325 3.3335 5.33325 3.3335V8.00017C5.33325 9.47059 6.52336 10.663 7.99289 10.6668H8.00694C9.46787 10.6631 10.6526 9.4845 10.6665 8.02596V3.3335H5.33325Z;M5.41742 2.6665C5.36257 2.87959 5.3334 3.10298 5.3334 3.33318V7.99985C5.3334 9.46967 6.52254 10.6617 7.99124 10.6665H8.0089C9.46551 10.6618 10.6471 9.48921 10.6665 8.0361V3.29694C10.6636 3.07952 10.6347 2.86839 10.5827 2.6665H5.41742Z;M5.6902 2C5.46331 2.39223 5.33345 2.84762 5.33345 3.33334V8C5.33345 9.47106 6.5246 10.6639 7.99502 10.6667H8.00521C9.46055 10.6639 10.6423 9.4954 10.6664 8.04517V3.28817C10.6586 2.81939 10.5299 2.38005 10.31 2H5.6902Z;M9.76435 1.3335C10.3176 1.82211 10.6665 2.53679 10.6665 3.33297V7.99964C10.6665 9.4724 9.47263 10.6663 7.99988 10.6663C6.53223 10.6663 5.34151 9.48068 5.33325 8.01498V3.31763C5.3377 2.52762 5.68569 1.81897 6.2354 1.3335H9.76435Z;M9.76435 1.3335C10.3176 1.82211 10.6665 2.53679 10.6665 3.33297V7.99964C10.6665 9.4724 9.47263 10.6663 7.99988 10.6663C6.53223 10.6663 5.34151 9.48068 5.33325 8.01498V3.31763C5.3377 2.52762 5.68569 1.81897 6.2354 1.3335H9.76435Z;M5.6902 2C5.46331 2.39223 5.33345 2.84762 5.33345 3.33334V8C5.33345 9.47106 6.5246 10.6639 7.99502 10.6667H8.00521C9.46055 10.6639 10.6423 9.4954 10.6664 8.04517V3.28817C10.6586 2.81939 10.5299 2.38005 10.31 2H5.6902Z;M5.41742 2.6665C5.36257 2.87959 5.3334 3.10298 5.3334 3.33318V7.99985C5.3334 9.46967 6.52254 10.6617 7.99124 10.6665H8.0089C9.46551 10.6618 10.6471 9.48921 10.6665 8.0361V3.29694C10.6636 3.07952 10.6347 2.86839 10.5827 2.6665H5.41742Z;M5.33325 3.3335C5.33325 3.3335 5.33325 3.3335 5.33325 3.3335V8.00017C5.33325 9.47059 6.52336 10.663 7.99289 10.6668H8.00694C9.46787 10.6631 10.6526 9.4845 10.6665 8.02596V3.3335H5.33325Z;M7.99545 10.6667C6.52479 10.6642 5.33334 9.47124 5.33334 8V4H10.6666V8.02151C10.6551 9.48285 9.46806 10.6642 8.00457 10.6667H7.99545Z;M10.6666 8.01563C10.6581 9.48112 9.46747 10.6665 7.99998 10.6665C6.52722 10.6665 5.33331 9.4726 5.33331 7.99984V4.6665H10.6666V8.01563Z;M10.6668 8.00661C10.6633 9.4764 9.47077 10.6668 8.00016 10.6668C6.5274 10.6668 5.3335 9.47292 5.3335 8.00016V5.3335H10.6668V8.00661Z;M7.9837 10.6667C6.5185 10.6578 5.33347 9.46733 5.33347 8.00005V6H10.6663V8.05015C10.6397 9.49433 9.46505 10.6579 8.01657 10.6667H7.9837Z;M10.6665 6.6665V7.99982C10.6665 9.47258 9.47255 10.6665 7.99979 10.6665C6.53348 10.6665 5.34358 9.48301 5.33319 8.01915V6.6665H10.6665Z;M10.6664 7.3335V8.00016C10.6664 9.47292 9.47245 10.6668 7.99969 10.6668C6.53498 10.6668 5.34608 9.48593 5.33313 8.02427V7.3335H10.6664Z;M7.9956 10.6667C6.52487 10.6643 5.33334 9.47129 5.33334 8V8H10.6666V8.02325C10.6541 9.48384 9.4674 10.6643 8.00442 10.6667H7.9956Z;M10.5828 8.6665C10.2868 9.81665 9.24269 10.6665 8.00014 10.6665C6.75758 10.6665 5.71351 9.81665 5.41748 8.6665H10.5828Z;M8.99915 9.3335C8.72003 9.54478 8.37224 9.67012 7.99518 9.67012C7.61812 9.67012 7.27033 9.54478 6.99121 9.3335H8.99915Z;M8.99915 9.3335C8.72003 9.54478 8.37224 9.67012 7.99518 9.67012C7.61812 9.67012 7.27033 9.54478 6.99121 9.3335H8.99915Z",calcMode:"linear",dur:"1s",repeatCount:"indefinite"}))),JEt=n=>y.createElement("svg",{width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...n},y.createElement("path",{d:"M10.8083 4.68061C10.6464 4.40001 10.7425 4.04123 11.023 3.87924L12.5649 3.10555C12.8454 2.94356 13.2043 3.03968 13.3662 3.32027C13.5282 3.60087 13.4321 3.95966 13.1515 4.12165L11.6097 4.89533C11.3291 5.05733 10.9702 4.96121 10.8083 4.68061Z",fill:"#0E72ED"}),y.createElement("path",{d:"M11.2121 7.75802C11.2121 7.49027 11.4292 7.27317 11.697 7.27317H13.8788C14.1466 7.27317 14.3636 7.49027 14.3636 7.75802C14.3636 8.02578 14.1466 8.24287 13.8788 8.24287H11.697C11.4292 8.24287 11.2121 8.02578 11.2121 7.75802Z",fill:"#0E72ED"}),y.createElement("path",{d:"M11.6097 10.539C11.3291 10.377 10.9702 10.4731 10.8083 10.7537C10.6464 11.0343 10.7425 11.393 11.023 11.555L12.5649 12.4105C12.8454 12.5725 13.2043 12.4764 13.3662 12.1958C13.5282 11.9152 13.4321 11.5564 13.1515 11.3944L11.6097 10.539Z",fill:"#0E72ED"}),y.createElement("path",{d:"M2.72727 5.33323C2.32561 5.33323 2 5.65884 2 6.0605V9.93923C2 10.3409 2.32561 10.6665 2.72727 10.6665H4.21961C4.35343 10.6665 4.48466 10.7034 4.59885 10.7732L7.68137 12.657C8.16599 12.9531 8.78788 12.6044 8.78788 12.0364V3.96329C8.78788 3.39534 8.16599 3.04656 7.68137 3.34272L4.59885 5.22652C4.48466 5.29631 4.35343 5.33323 4.21961 5.33323H2.72727Z",fill:"#0E72ED"})),QEt=n=>y.createElement("svg",{width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...n},y.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M0 5.2C0 4.0799 0 3.51984 0.217987 3.09202C0.409734 2.71569 0.715695 2.40973 1.09202 2.21799C1.51984 2 2.0799 2 3.2 2H12.8C13.9201 2 14.4802 2 14.908 2.21799C15.2843 2.40973 15.5903 2.71569 15.782 3.09202C16 3.51984 16 4.0799 16 5.2V10.8C16 11.9201 16 12.4802 15.782 12.908C15.5903 13.2843 15.2843 13.5903 14.908 13.782C14.4802 14 13.9201 14 12.8 14H3.2C2.0799 14 1.51984 14 1.09202 13.782C0.715695 13.5903 0.409734 13.2843 0.217987 12.908C0 12.4802 0 11.9201 0 10.8V5.2ZM8.625 7.00888L9.55806 7.94194C9.80214 8.18602 10.1979 8.18602 10.4419 7.94194C10.686 7.69786 10.686 7.30214 10.4419 7.05806L8.44194 5.05806C8.19786 4.81398 7.80214 4.81398 7.55806 5.05806L5.55806 7.05806C5.31398 7.30214 5.31398 7.69786 5.55806 7.94194C5.80214 8.18602 6.19786 8.18602 6.44194 7.94194L7.375 7.00888V10.5C7.375 10.8452 7.65482 11.125 8 11.125C8.34518 11.125 8.625 10.8452 8.625 10.5V7.00888Z",fill:"#00A832"})),eIt=n=>y.createElement("svg",{width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...n},y.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.4856 3.39307C10.0476 3.14294 9.5405 3 9 3H1.5C0.671573 3 0 3.67157 0 4.5V10C0 11.0532 0.542725 11.9796 1.36376 12.5149L2.09478 11.7839C1.4451 11.4536 1 10.7788 1 10V4.5C1 4.22386 1.22386 4 1.5 4H9C9.26068 4 9.50972 4.04987 9.73808 4.1406L10.4856 3.39307ZM11 7.12132L12.4853 5.63604L14.8 3.9C15.2944 3.52918 16 3.88197 16 4.5V11.5C16 12.118 15.2944 12.4708 14.8 12.1L12 10V11.5C12 12.3284 11.3284 13 10.5 13H5.12132L6.12132 12H10.5C10.7761 12 11 11.7761 11 11.5V9V7.12132ZM15 11L12 8.75V7.25L15 5V11Z",fill:"#E02828"}),y.createElement("path",{d:"M15.5 0.5L0.5 15.5",stroke:"#DE2828",strokeLinecap:"round"})),tIt=n=>y.createElement("svg",{width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...n},y.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M1.5 4H9C10.1046 4 11 4.89543 11 6V7V9V11.5C11 11.7761 10.7761 12 10.5 12H3C1.89543 12 1 11.1046 1 10V4.5C1 4.22386 1.22386 4 1.5 4ZM12 10V11.5C12 12.3284 11.3284 13 10.5 13H3C1.34315 13 0 11.6569 0 10V4.5C0 3.67157 0.671573 3 1.5 3H9C10.6569 3 12 4.34315 12 6L14.8 3.9C15.2944 3.52918 16 3.88197 16 4.5V11.5C16 12.118 15.2944 12.4708 14.8 12.1L12 10ZM12 8.75L15 11V5L12 7.25V8.75Z",fill:"#747487"})),nIt=n=>y.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...n},y.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M16.1447 3.81608C16.3051 3.65564 16.3771 3.42377 16.3122 3.20635C15.758 1.34928 14.0401 0 12 0C9.51 0 7.5 2.01 7.5 4.5V11.625C7.5 11.9088 7.83922 12.0552 8.04571 11.8605L8.7645 11.1828C8.9148 11.0411 9 10.8437 9 10.6371V4.5C9 2.85 10.35 1.5 12 1.5C13.65 1.5 15 2.85 15 4.5C15 4.67004 15.2056 4.7552 15.3258 4.63496L16.1447 3.81608ZM16.5 6.28922L15 7.78922V12C15 13.65 13.65 15 12 15C10.8653 15 9.8725 14.3616 9.36304 13.4262L8.26884 14.5204C9.07676 15.7159 10.4447 16.5 12 16.5C14.49 16.5 16.5 14.49 16.5 12V6.28922ZM5.91515 14.0456C6.12014 13.8406 6.19217 13.5407 6.13178 13.2571C6.04543 12.8518 6 12.4312 6 12C6 11.58 5.67 11.25 5.25 11.25C4.83 11.25 4.5 11.58 4.5 12C4.5 12.045 4.5 12.105 4.515 12.15C4.5237 12.7027 4.59271 13.241 4.71579 13.7584C4.84602 14.3059 5.51719 14.4436 5.91515 14.0456ZM6.12908 16.6601L7.19467 15.5945C8.2888 17.0552 10.0336 18 12 18C15.315 18 18 15.315 18 12C18 11.58 18.33 11.25 18.75 11.25C19.17 11.25 19.5 11.58 19.5 12C19.5 12.045 19.5 12.105 19.485 12.15C19.425 15.96 16.5 19.08 12.75 19.455V22.5H15.75C16.17 22.5 16.5 22.83 16.5 23.25C16.5 23.67 16.17 24 15.75 24H8.25C7.83 24 7.5 23.67 7.5 23.25C7.5 22.83 7.83 22.5 8.25 22.5H11.25V19.455C9.17538 19.2475 7.35327 18.1999 6.12908 16.6601Z",fill:"white"}),y.createElement("path",{d:"M3.375 19.875L20.625 2.625",stroke:"#FF0055",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"})),rIt=n=>y.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...n},y.createElement("path",{d:"M7.5 4.5C7.5 2.01 9.51 0 12 0C14.49 0 16.5 2.01 16.5 4.5V12C16.5 14.49 14.49 16.5 12 16.5C9.51 16.5 7.5 14.49 7.5 12V4.5ZM12 15C13.65 15 15 13.65 15 12V4.5C15 2.85 13.65 1.5 12 1.5C10.35 1.5 9 2.85 9 4.5V12C9 13.65 10.35 15 12 15Z",fill:"white"}),y.createElement("path",{d:"M19.485 12.15C19.5 12.105 19.5 12.045 19.5 12C19.5 11.58 19.17 11.25 18.75 11.25C18.33 11.25 18 11.58 18 12C18 15.315 15.315 18 12 18C8.685 18 6 15.315 6 12C6 11.58 5.67 11.25 5.25 11.25C4.83 11.25 4.5 11.58 4.5 12C4.5 12.045 4.5 12.105 4.515 12.15C4.575 15.96 7.5 19.08 11.25 19.455V22.5H8.25C7.83 22.5 7.5 22.83 7.5 23.25C7.5 23.67 7.83 24 8.25 24H15.75C16.17 24 16.5 23.67 16.5 23.25C16.5 22.83 16.17 22.5 15.75 22.5H12.75V19.455C16.5 19.08 19.425 15.96 19.485 12.15Z",fill:"white"})),iIt=n=>y.createElement("svg",{width:32,height:24,viewBox:"0 0 32 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...n},y.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M16.1447 3.81608C16.3051 3.65564 16.3771 3.42377 16.3122 3.20635C15.758 1.34928 14.0401 0 12 0C9.51 0 7.5 2.01 7.5 4.5V11.625C7.5 11.9088 7.83922 12.0552 8.04571 11.8605L8.7645 11.1828C8.9148 11.0411 9 10.8437 9 10.6371V4.5C9 2.85 10.35 1.5 12 1.5C13.65 1.5 15 2.85 15 4.5C15 4.67004 15.2056 4.7552 15.3258 4.63496L16.1447 3.81608ZM16.5 6.28922L15 7.78922V12C15 13.65 13.65 15 12 15C10.8653 15 9.8725 14.3616 9.36304 13.4262L8.26884 14.5204C9.07676 15.7159 10.4447 16.5 12 16.5C14.49 16.5 16.5 14.49 16.5 12V6.28922ZM5.91515 14.0456C6.12014 13.8406 6.19217 13.5407 6.13178 13.2571C6.04543 12.8518 6 12.4312 6 12C6 11.58 5.67 11.25 5.25 11.25C4.83 11.25 4.5 11.58 4.5 12C4.5 12.045 4.5 12.105 4.515 12.15C4.5237 12.7027 4.59271 13.241 4.71579 13.7584C4.84602 14.3059 5.51719 14.4436 5.91515 14.0456ZM6.12908 16.6601L7.19467 15.5945C8.2888 17.0552 10.0336 18 12 18C15.315 18 18 15.315 18 12C18 11.58 18.33 11.25 18.75 11.25C19.17 11.25 19.5 11.58 19.5 12C19.5 12.045 19.5 12.105 19.485 12.15C19.425 15.96 16.5 19.08 12.75 19.455V22.5H15.75C16.17 22.5 16.5 22.83 16.5 23.25C16.5 23.67 16.17 24 15.75 24H8.25C7.83 24 7.5 23.67 7.5 23.25C7.5 22.83 7.83 22.5 8.25 22.5H11.25V19.455C9.17538 19.2475 7.35327 18.1999 6.12908 16.6601Z",fill:"white"}),y.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M17.2574 20.7646C16.695 21.7646 17.4176 23 18.5648 23L29.4353 23C30.5825 23 31.3051 21.7646 30.7426 20.7646L25.3074 11.102C24.7339 10.0825 23.2661 10.0825 22.6927 11.102L17.2574 20.7646ZM23.3501 17.6L23.3501 14.65C23.3501 14.2911 23.6411 14 24.0001 14C24.359 14 24.6501 14.2911 24.6501 14.65V17.6C24.6501 17.959 24.359 18.25 24.0001 18.25C23.6411 18.25 23.3501 17.959 23.3501 17.6ZM23.25 20.25C23.25 19.8358 23.5858 19.5 24 19.5C24.4142 19.5 24.75 19.8358 24.75 20.25C24.75 20.6642 24.4142 21 24 21C23.5858 21 23.25 20.6642 23.25 20.25Z",fill:"#FAAC2A"}),y.createElement("path",{d:"M3.375 19.875L20.625 2.625",stroke:"#FF0055",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),y.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M17.2574 20.7646C16.695 21.7646 17.4176 23 18.5648 23L29.4353 23C30.5825 23 31.3051 21.7646 30.7426 20.7646L25.3074 11.102C24.7339 10.0825 23.2661 10.0825 22.6927 11.102L17.2574 20.7646ZM23.3501 17.6L23.3501 14.65C23.3501 14.2911 23.6411 14 24.0001 14C24.359 14 24.6501 14.2911 24.6501 14.65V17.6C24.6501 17.959 24.359 18.25 24.0001 18.25C23.6411 18.25 23.3501 17.959 23.3501 17.6ZM23.25 20.25C23.25 19.8358 23.5858 19.5 24 19.5C24.4142 19.5 24.75 19.8358 24.75 20.25C24.75 20.6642 24.4142 21 24 21C23.5858 21 23.25 20.6642 23.25 20.25Z",fill:"#FAAC2A"})),oIt=n=>y.createElement("svg",{width:32,height:24,viewBox:"0 0 32 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...n},y.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M16.1447 3.81608C16.3051 3.65564 16.3771 3.42377 16.3122 3.20635C15.758 1.34928 14.0401 0 12 0C9.51 0 7.5 2.01 7.5 4.5V11.625C7.5 11.9088 7.83922 12.0552 8.04571 11.8605L8.7645 11.1828C8.9148 11.0411 9 10.8437 9 10.6371V4.5C9 2.85 10.35 1.5 12 1.5C13.65 1.5 15 2.85 15 4.5C15 4.67004 15.2056 4.7552 15.3258 4.63496L16.1447 3.81608ZM16.5 6.28922L15 7.78922V12C15 13.65 13.65 15 12 15C10.8653 15 9.8725 14.3616 9.36304 13.4262L8.26884 14.5204C9.07676 15.7159 10.4447 16.5 12 16.5C14.49 16.5 16.5 14.49 16.5 12V6.28922ZM5.91515 14.0456C6.12014 13.8406 6.19217 13.5407 6.13178 13.2571C6.04543 12.8518 6 12.4312 6 12C6 11.58 5.67 11.25 5.25 11.25C4.83 11.25 4.5 11.58 4.5 12C4.5 12.045 4.5 12.105 4.515 12.15C4.5237 12.7027 4.59271 13.241 4.71579 13.7584C4.84602 14.3059 5.51719 14.4436 5.91515 14.0456ZM6.12908 16.6601L7.19467 15.5945C8.2888 17.0552 10.0336 18 12 18C15.315 18 18 15.315 18 12C18 11.58 18.33 11.25 18.75 11.25C19.17 11.25 19.5 11.58 19.5 12C19.5 12.045 19.5 12.105 19.485 12.15C19.425 15.96 16.5 19.08 12.75 19.455V22.5H15.75C16.17 22.5 16.5 22.83 16.5 23.25C16.5 23.67 16.17 24 15.75 24H8.25C7.83 24 7.5 23.67 7.5 23.25C7.5 22.83 7.83 22.5 8.25 22.5H11.25V19.455C9.17538 19.2475 7.35327 18.1999 6.12908 16.6601Z",fill:"white"}),y.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M17.2574 20.7646C16.695 21.7646 17.4176 23 18.5648 23L29.4353 23C30.5825 23 31.3051 21.7646 30.7426 20.7646L25.3074 11.102C24.7339 10.0825 23.2661 10.0825 22.6927 11.102L17.2574 20.7646ZM23.3501 17.6L23.3501 14.65C23.3501 14.2911 23.6411 14 24.0001 14C24.359 14 24.6501 14.2911 24.6501 14.65V17.6C24.6501 17.959 24.359 18.25 24.0001 18.25C23.6411 18.25 23.3501 17.959 23.3501 17.6ZM23.25 20.25C23.25 19.8358 23.5858 19.5 24 19.5C24.4142 19.5 24.75 19.8358 24.75 20.25C24.75 20.6642 24.4142 21 24 21C23.5858 21 23.25 20.6642 23.25 20.25Z",fill:"#FF0055"}),y.createElement("path",{d:"M3.375 19.875L20.625 2.625",stroke:"#FF0055",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),y.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M17.2574 20.7646C16.695 21.7646 17.4176 23 18.5648 23L29.4353 23C30.5825 23 31.3051 21.7646 30.7426 20.7646L25.3074 11.102C24.7339 10.0825 23.2661 10.0825 22.6927 11.102L17.2574 20.7646ZM23.3501 17.6L23.3501 14.65C23.3501 14.2911 23.6411 14 24.0001 14C24.359 14 24.6501 14.2911 24.6501 14.65V17.6C24.6501 17.959 24.359 18.25 24.0001 18.25C23.6411 18.25 23.3501 17.959 23.3501 17.6ZM23.25 20.25C23.25 19.8358 23.5858 19.5 24 19.5C24.4142 19.5 24.75 19.8358 24.75 20.25C24.75 20.6642 24.4142 21 24 21C23.5858 21 23.25 20.6642 23.25 20.25Z",fill:"#FF0055"})),sIt={"icon-advanced":rEt,"icon-chat":iEt,"icon-group":oEt,"icon-headset":sEt,"icon-meeting":aEt,"icon-pause":cEt,"icon-remote-control":lEt,"icon-resume":uEt,"icon-share":dEt,"icon-spotlight":hEt,"icon-start":fEt,"icon-stop":pEt,"icon-recording":vEt,"icon-recording-hover":yEt,"icon-recording-stop":_Et,"icon-recording-stop-hover":wEt,"icon-recording-resume":CEt,"icon-recording-resume-hover":xEt,"icon-recording-pause":EEt,"icon-recording-pause-hover":IEt,"icon-recording-animated":bEt,"icon-recording-animated-hover":SEt,"icon-phone":gEt,"icon-phone-off":mEt,"icon-lt":PEt,"icon-subtitle":kEt,"icon-leave":TEt,"icon-stop-leave":DEt,"icon-control":REt,"icon-switch":AEt,"icon-network-good":OEt,"icon-network-normal":MEt,"icon-network-bad":$Et,"icon-live-stream":LEt,"icon-live":NEt,"icon-move":FEt,"icon-audio-on":jEt,"icon-audio-off":BEt,"icon-reconnect":HEt,"icon-correct-circle":UEt,"icon-download":zEt,"icon-chat-upload":VEt,"icon-pendding-circle":WEt,"icon-warning-circle":qEt,"icon-correct":KEt,"icon-loading":GEt,"icon-participant-audio-muted":ZEt,"icon-participant-audio-unmuted":XEt,"icon-participant-audio-unmuted-animated":YEt,"icon-participant-sharing-desktop-audio":JEt,"icon-participant-sharing-screen":QEt,"icon-participant-video-off":eIt,"icon-participant-video-on":tIt,"icon-audio-muted":nIt,"icon-audio-unmuted":rIt,"icon-audio-disallow":iIt,"icon-audio-no-devices":oIt},CMe=n=>{const{type:e,style:t}=n,r=sIt[e];return r?x.jsx(bre,{component:r,style:{...t||{}}}):null},aIt=n=>{const{visible:e,phoneCountryList:t,phoneCallStatus:r,onPhoneCallClick:i,onPhoneCallCancel:o,setVisible:s}=n,[a]=co.useForm();return x.jsxs(Zu,{open:e,className:"join-by-phone-dialog",title:"Invite by phone",okText:"Call",onOk:async()=>{try{const c=await a.validateFields(),{phone:{countryCode:l,phoneNumber:u},callme:d,name:h,greeting:f,press:p}=c,[,g]=l.split("&&");d?i==null||i(g,u,"",{callMe:!0}):i==null||i(g,u,h,{callMe:!1,greeting:f,pressingOne:p})}catch(c){console.log(c)}},onCancel:async()=>{const{phone:{countryCode:c,phoneNumber:l},callme:u}=a.getFieldsValue();if(c){const[,d]=c.split("&&");await(o==null?void 0:o(d||"",l,{callMe:u}))}s(!1)},destroyOnClose:!0,children:[x.jsxs(co,{form:a,name:"call-out-form",children:[x.jsx(co.Item,{label:"Phone Number",required:!0,children:x.jsxs(qm.Group,{compact:!0,className:"phone-number",children:[x.jsx(co.Item,{name:["phone","countryCode"],noStyle:!0,rules:[{required:!0,message:"Country code is required"}],children:x.jsx(Ey,{placeholder:"select a country",className:"country-code",showSearch:!0,optionFilterProp:"children",children:t==null?void 0:t.map(c=>x.jsx(Ey.Option,{value:`${c.id}&&${c.code}`,children:`${c.name} (${c.code})`},c.id))})}),x.jsx(co.Item,{name:["phone","phoneNumber"],noStyle:!0,children:x.jsx(qm,{className:"number",placeholder:"phone number"})})]})}),x.jsx(co.Item,{name:"callme",valuePropName:"checked",children:x.jsx(WC,{children:"Call me"})}),x.jsx(co.Item,{noStyle:!0,shouldUpdate:(c,l)=>c.callme!==l.callme,children:({getFieldValue:c})=>c("callme")?null:x.jsx(co.Item,{name:"name",label:"Name",required:!0,rules:[{required:!0,message:"Please input the name"}],children:x.jsx(qm,{placeholder:"name"})})}),x.jsx(co.Item,{noStyle:!0,shouldUpdate:(c,l)=>c.callme!==l.callme,children:({getFieldValue:c})=>c("callme")?null:x.jsx(co.Item,{name:"greeting",valuePropName:"checked",children:x.jsx(WC,{children:"Require greeting before being connected"})})}),x.jsx(co.Item,{noStyle:!0,shouldUpdate:(c,l)=>c.callme!==l.callme,children:({getFieldValue:c})=>c("callme")?null:x.jsx(co.Item,{name:"press",valuePropName:"checked",children:x.jsx(WC,{children:"Require pressing 1 before being connected"})})})]}),r&&x.jsxs("div",{className:"phone-call-status",children:["Phone call status:",x.jsx("span",{className:Ue("status-text",r.type),children:r.text})]})]})},gh=(n,e,t,r,i)=>({key:e,icon:t,children:r,label:n,type:i}),D0e=(n,e,t)=>({items:n,onClick:e,theme:"dark",className:t??"vc-dropdown-menu"}),wre=Ke.createContext(null),cIt={[Ss.Calling]:{text:"Calling",type:"pending"},[Ss.Ringing]:{text:"Ringing",type:"pending"},[Ss.Accepted]:{text:"Accepted",type:"pending"},[Ss.Canceling]:{text:"Cencelling",type:"pending"},[Ss.Busy]:{text:"Busy",type:"fail"},[Ss.Fail]:{text:"Fail",type:"fail"},[Ss.CancelFailed]:{text:"Cancel failed",type:"fail"},[Ss.NotAvailable]:{text:"NotAvailable",type:"fail"},[Ss.Success]:{text:"Success",type:"success"},[Ss.Canceled]:{text:"Canceled",type:"success"}},lIt={[Np.Ringing]:{text:"Ringing",type:"pending"},[Np.Busy]:{text:"Busy",type:"fail"},[Np.Fail]:{text:"Fail",type:"fail"},[Np.Success]:{text:"Success",type:"success"},[Np.Timeout]:{text:"Timeout",type:"fail"}},uIt=n=>{if(n!==void 0)return cIt[n]},R0e=n=>{if(n!==void 0)return lIt[n]},{Group:dIt}=ex,hIt=n=>{var l,u;const{visible:e,setVisible:t}=n,r=y.useContext(CD),{mediaStream:i}=y.useContext(wre),[o]=co.useForm(),[s,a]=y.useState(-1),c=y.useCallback(d=>{const{code:h,ip:f,protocol:p,uuid:g}=d;a(h)},[]);return y.useEffect(()=>(r.on("crc-call-out-state-change",c),()=>{r.off("crc-call-out-state-change",c)}),[r,c]),x.jsxs(Zu,{open:e,className:"join-by-phone-dialog",title:"Call a H.323/SIP Room System",okText:"Call",onOk:async()=>{try{const d=await o.validateFields(),{ip:h,protocol:f}=d;i==null||i.callCRCDevice(h,f)}catch(d){console.warn(d)}},onCancel:async()=>{if(s===Np.Ringing){const{ip:d,protocol:h}=await o.validateFields();i==null||i.cancelCallCRCDevice(d,h)}t(!1)},destroyOnClose:!0,children:[x.jsxs(co,{form:o,name:"call-out-form",children:[x.jsx(co.Item,{label:"H.323/SIP Room System",name:"ip",required:!0,children:x.jsx(qm,{className:"ip",placeholder:"IP Address"})}),x.jsx(co.Item,{name:"protocol",valuePropName:"checked",required:!0,children:x.jsxs(dIt,{defaultValue:1,children:[x.jsx(ex,{value:1,children:"H323"}),x.jsx(ex,{value:2,children:"SIP"})]})})]}),s!==-1&&x.jsxs("div",{className:"phone-call-status",children:["CRC call status:",x.jsx("span",{className:Ue("status-text",(l=R0e(s))==null?void 0:l.type),children:(u=R0e(s))==null?void 0:u.text})]})]})},fIt=n=>y.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...n},y.createElement("defs",null,y.createElement("filter",{id:"filter0_i",x:9,y:12,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},y.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),y.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),y.createElement("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),y.createElement("feOffset",{dy:1}),y.createElement("feComposite",{in2:"hardAlpha",operator:"arithmetic",k2:-1,k3:1}),y.createElement("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.15 0"}),y.createElement("feBlend",{mode:"normal",in2:"shape",result:"effect1_innerShadow"}))),y.createElement("path",{d:"M7.5 4.5C7.5 2.01 9.51 0 12 0C14.49 0 16.5 2.01 16.5 4.5V12C16.5 14.49 14.49 16.5 12 16.5C9.51 16.5 7.5 14.49 7.5 12V4.5ZM12 15C13.65 15 15 13.65 15 12V4.5C15 2.85 13.65 1.5 12 1.5C10.35 1.5 9 2.85 9 4.5V12C9 13.65 10.35 15 12 15Z",fill:"white"}),y.createElement("path",{d:"M19.485 12.15C19.5 12.105 19.5 12.045 19.5 12C19.5 11.58 19.17 11.25 18.75 11.25C18.33 11.25 18 11.58 18 12C18 15.315 15.315 18 12 18C8.685 18 6 15.315 6 12C6 11.58 5.67 11.25 5.25 11.25C4.83 11.25 4.5 11.58 4.5 12C4.5 12.045 4.5 12.105 4.515 12.15C4.575 15.96 7.5 19.08 11.25 19.455V22.5H8.25C7.83 22.5 7.5 22.83 7.5 23.25C7.5 23.67 7.83 24 8.25 24H15.75C16.17 24 16.5 23.67 16.5 23.25C16.5 22.83 16.17 22.5 15.75 22.5H12.75V19.455C16.5 19.08 19.425 15.96 19.485 12.15Z",fill:"white"}),y.createElement("g",{filter:"url(#filter0_i)",style:{}},y.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M 12 15 C 13.65 15 15 13.65 15 12 V 4.5 C 15 2.85 13.65 1.5 12 1.5 C 10.35 1.5 9 2.85 9 4.5 V 12 C 9 13.65 10.35 15 12 15 Z",fill:"#23D959"}))),pIt=n=>y.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...n},y.createElement("defs",null,y.createElement("filter",{id:"filter0_i",x:9,y:10.5,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},y.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),y.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),y.createElement("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),y.createElement("feOffset",{dy:1}),y.createElement("feComposite",{in2:"hardAlpha",operator:"arithmetic",k2:-1,k3:1}),y.createElement("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.15 0"}),y.createElement("feBlend",{mode:"normal",in2:"shape",result:"effect1_innerShadow"}))),y.createElement("path",{d:"M7.5 4.5C7.5 2.01 9.51 0 12 0C14.49 0 16.5 2.01 16.5 4.5V12C16.5 14.49 14.49 16.5 12 16.5C9.51 16.5 7.5 14.49 7.5 12V4.5ZM12 15C13.65 15 15 13.65 15 12V4.5C15 2.85 13.65 1.5 12 1.5C10.35 1.5 9 2.85 9 4.5V12C9 13.65 10.35 15 12 15Z",fill:"white"}),y.createElement("path",{d:"M19.485 12.15C19.5 12.105 19.5 12.045 19.5 12C19.5 11.58 19.17 11.25 18.75 11.25C18.33 11.25 18 11.58 18 12C18 15.315 15.315 18 12 18C8.685 18 6 15.315 6 12C6 11.58 5.67 11.25 5.25 11.25C4.83 11.25 4.5 11.58 4.5 12C4.5 12.045 4.5 12.105 4.515 12.15C4.575 15.96 7.5 19.08 11.25 19.455V22.5H8.25C7.83 22.5 7.5 22.83 7.5 23.25C7.5 23.67 7.83 24 8.25 24H15.75C16.17 24 16.5 23.67 16.5 23.25C16.5 22.83 16.17 22.5 15.75 22.5H12.75V19.455C16.5 19.08 19.425 15.96 19.485 12.15Z",fill:"white"}),y.createElement("g",{filter:"url(#filter0_i)",style:{}},y.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M 12 15 C 13.65 15 15 13.65 15 12 V 4.5 C 15 2.85 13.65 1.5 12 1.5 C 10.35 1.5 9 2.85 9 4.5 V 12 C 9 13.65 10.35 15 12 15 Z",fill:"#23D959"}))),gIt=n=>y.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...n},y.createElement("defs",null,y.createElement("filter",{id:"filter0_i",x:9,y:9,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},y.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),y.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),y.createElement("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),y.createElement("feOffset",{dy:1}),y.createElement("feComposite",{in2:"hardAlpha",operator:"arithmetic",k2:-1,k3:1}),y.createElement("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.15 0"}),y.createElement("feBlend",{mode:"normal",in2:"shape",result:"effect1_innerShadow"}))),y.createElement("path",{d:"M7.5 4.5C7.5 2.01 9.51 0 12 0C14.49 0 16.5 2.01 16.5 4.5V12C16.5 14.49 14.49 16.5 12 16.5C9.51 16.5 7.5 14.49 7.5 12V4.5ZM12 15C13.65 15 15 13.65 15 12V4.5C15 2.85 13.65 1.5 12 1.5C10.35 1.5 9 2.85 9 4.5V12C9 13.65 10.35 15 12 15Z",fill:"white"}),y.createElement("path",{d:"M19.485 12.15C19.5 12.105 19.5 12.045 19.5 12C19.5 11.58 19.17 11.25 18.75 11.25C18.33 11.25 18 11.58 18 12C18 15.315 15.315 18 12 18C8.685 18 6 15.315 6 12C6 11.58 5.67 11.25 5.25 11.25C4.83 11.25 4.5 11.58 4.5 12C4.5 12.045 4.5 12.105 4.515 12.15C4.575 15.96 7.5 19.08 11.25 19.455V22.5H8.25C7.83 22.5 7.5 22.83 7.5 23.25C7.5 23.67 7.83 24 8.25 24H15.75C16.17 24 16.5 23.67 16.5 23.25C16.5 22.83 16.17 22.5 15.75 22.5H12.75V19.455C16.5 19.08 19.425 15.96 19.485 12.15Z",fill:"white"}),y.createElement("g",{filter:"url(#filter0_i)",style:{}},y.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M 12 15 C 13.65 15 15 13.65 15 12 V 4.5 C 15 2.85 13.65 1.5 12 1.5 C 10.35 1.5 9 2.85 9 4.5 V 12 C 9 13.65 10.35 15 12 15 Z",fill:"#23D959"}))),mIt=n=>y.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...n},y.createElement("defs",null,y.createElement("filter",{id:"filter0_i",x:9,y:8,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},y.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),y.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),y.createElement("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),y.createElement("feOffset",{dy:1}),y.createElement("feComposite",{in2:"hardAlpha",operator:"arithmetic",k2:-1,k3:1}),y.createElement("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.15 0"}),y.createElement("feBlend",{mode:"normal",in2:"shape",result:"effect1_innerShadow"}))),y.createElement("path",{d:"M7.5 4.5C7.5 2.01 9.51 0 12 0C14.49 0 16.5 2.01 16.5 4.5V12C16.5 14.49 14.49 16.5 12 16.5C9.51 16.5 7.5 14.49 7.5 12V4.5ZM12 15C13.65 15 15 13.65 15 12V4.5C15 2.85 13.65 1.5 12 1.5C10.35 1.5 9 2.85 9 4.5V12C9 13.65 10.35 15 12 15Z",fill:"white"}),y.createElement("path",{d:"M19.485 12.15C19.5 12.105 19.5 12.045 19.5 12C19.5 11.58 19.17 11.25 18.75 11.25C18.33 11.25 18 11.58 18 12C18 15.315 15.315 18 12 18C8.685 18 6 15.315 6 12C6 11.58 5.67 11.25 5.25 11.25C4.83 11.25 4.5 11.58 4.5 12C4.5 12.045 4.5 12.105 4.515 12.15C4.575 15.96 7.5 19.08 11.25 19.455V22.5H8.25C7.83 22.5 7.5 22.83 7.5 23.25C7.5 23.67 7.83 24 8.25 24H15.75C16.17 24 16.5 23.67 16.5 23.25C16.5 22.83 16.17 22.5 15.75 22.5H12.75V19.455C16.5 19.08 19.425 15.96 19.485 12.15Z",fill:"white"}),y.createElement("g",{filter:"url(#filter0_i)",style:{}},y.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M 12 15 C 13.65 15 15 13.65 15 12 V 4.5 C 15 2.85 13.65 1.5 12 1.5 C 10.35 1.5 9 2.85 9 4.5 V 12 C 9 13.65 10.35 15 12 15 Z",fill:"#23D959"}))),vIt=n=>y.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...n},y.createElement("defs",null,y.createElement("filter",{id:"filter0_i",x:9,y:7,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},y.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),y.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),y.createElement("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),y.createElement("feOffset",{dy:1}),y.createElement("feComposite",{in2:"hardAlpha",operator:"arithmetic",k2:-1,k3:1}),y.createElement("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.15 0"}),y.createElement("feBlend",{mode:"normal",in2:"shape",result:"effect1_innerShadow"}))),y.createElement("path",{d:"M7.5 4.5C7.5 2.01 9.51 0 12 0C14.49 0 16.5 2.01 16.5 4.5V12C16.5 14.49 14.49 16.5 12 16.5C9.51 16.5 7.5 14.49 7.5 12V4.5ZM12 15C13.65 15 15 13.65 15 12V4.5C15 2.85 13.65 1.5 12 1.5C10.35 1.5 9 2.85 9 4.5V12C9 13.65 10.35 15 12 15Z",fill:"white"}),y.createElement("path",{d:"M19.485 12.15C19.5 12.105 19.5 12.045 19.5 12C19.5 11.58 19.17 11.25 18.75 11.25C18.33 11.25 18 11.58 18 12C18 15.315 15.315 18 12 18C8.685 18 6 15.315 6 12C6 11.58 5.67 11.25 5.25 11.25C4.83 11.25 4.5 11.58 4.5 12C4.5 12.045 4.5 12.105 4.515 12.15C4.575 15.96 7.5 19.08 11.25 19.455V22.5H8.25C7.83 22.5 7.5 22.83 7.5 23.25C7.5 23.67 7.83 24 8.25 24H15.75C16.17 24 16.5 23.67 16.5 23.25C16.5 22.83 16.17 22.5 15.75 22.5H12.75V19.455C16.5 19.08 19.425 15.96 19.485 12.15Z",fill:"white"}),y.createElement("g",{filter:"url(#filter0_i)",style:{}},y.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M 12 15 C 13.65 15 15 13.65 15 12 V 4.5 C 15 2.85 13.65 1.5 12 1.5 C 10.35 1.5 9 2.85 9 4.5 V 12 C 9 13.65 10.35 15 12 15 Z",fill:"#23D959"}))),yIt=n=>y.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...n},y.createElement("defs",null,y.createElement("filter",{id:"filter0_i",x:9,y:6,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},y.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),y.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),y.createElement("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),y.createElement("feOffset",{dy:1}),y.createElement("feComposite",{in2:"hardAlpha",operator:"arithmetic",k2:-1,k3:1}),y.createElement("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.15 0"}),y.createElement("feBlend",{mode:"normal",in2:"shape",result:"effect1_innerShadow"}))),y.createElement("path",{d:"M7.5 4.5C7.5 2.01 9.51 0 12 0C14.49 0 16.5 2.01 16.5 4.5V12C16.5 14.49 14.49 16.5 12 16.5C9.51 16.5 7.5 14.49 7.5 12V4.5ZM12 15C13.65 15 15 13.65 15 12V4.5C15 2.85 13.65 1.5 12 1.5C10.35 1.5 9 2.85 9 4.5V12C9 13.65 10.35 15 12 15Z",fill:"white"}),y.createElement("path",{d:"M19.485 12.15C19.5 12.105 19.5 12.045 19.5 12C19.5 11.58 19.17 11.25 18.75 11.25C18.33 11.25 18 11.58 18 12C18 15.315 15.315 18 12 18C8.685 18 6 15.315 6 12C6 11.58 5.67 11.25 5.25 11.25C4.83 11.25 4.5 11.58 4.5 12C4.5 12.045 4.5 12.105 4.515 12.15C4.575 15.96 7.5 19.08 11.25 19.455V22.5H8.25C7.83 22.5 7.5 22.83 7.5 23.25C7.5 23.67 7.83 24 8.25 24H15.75C16.17 24 16.5 23.67 16.5 23.25C16.5 22.83 16.17 22.5 15.75 22.5H12.75V19.455C16.5 19.08 19.425 15.96 19.485 12.15Z",fill:"white"}),y.createElement("g",{filter:"url(#filter0_i)",style:{}},y.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M 12 15 C 13.65 15 15 13.65 15 12 V 4.5 C 15 2.85 13.65 1.5 12 1.5 C 10.35 1.5 9 2.85 9 4.5 V 12 C 9 13.65 10.35 15 12 15 Z",fill:"#23D959"}))),bIt=n=>y.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...n},y.createElement("defs",null,y.createElement("filter",{id:"filter0_i",x:9,y:5,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},y.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),y.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),y.createElement("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),y.createElement("feOffset",{dy:1}),y.createElement("feComposite",{in2:"hardAlpha",operator:"arithmetic",k2:-1,k3:1}),y.createElement("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.15 0"}),y.createElement("feBlend",{mode:"normal",in2:"shape",result:"effect1_innerShadow"}))),y.createElement("path",{d:"M7.5 4.5C7.5 2.01 9.51 0 12 0C14.49 0 16.5 2.01 16.5 4.5V12C16.5 14.49 14.49 16.5 12 16.5C9.51 16.5 7.5 14.49 7.5 12V4.5ZM12 15C13.65 15 15 13.65 15 12V4.5C15 2.85 13.65 1.5 12 1.5C10.35 1.5 9 2.85 9 4.5V12C9 13.65 10.35 15 12 15Z",fill:"white"}),y.createElement("path",{d:"M19.485 12.15C19.5 12.105 19.5 12.045 19.5 12C19.5 11.58 19.17 11.25 18.75 11.25C18.33 11.25 18 11.58 18 12C18 15.315 15.315 18 12 18C8.685 18 6 15.315 6 12C6 11.58 5.67 11.25 5.25 11.25C4.83 11.25 4.5 11.58 4.5 12C4.5 12.045 4.5 12.105 4.515 12.15C4.575 15.96 7.5 19.08 11.25 19.455V22.5H8.25C7.83 22.5 7.5 22.83 7.5 23.25C7.5 23.67 7.83 24 8.25 24H15.75C16.17 24 16.5 23.67 16.5 23.25C16.5 22.83 16.17 22.5 15.75 22.5H12.75V19.455C16.5 19.08 19.425 15.96 19.485 12.15Z",fill:"white"}),y.createElement("g",{filter:"url(#filter0_i)",style:{}},y.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M 12 15 C 13.65 15 15 13.65 15 12 V 4.5 C 15 2.85 13.65 1.5 12 1.5 C 10.35 1.5 9 2.85 9 4.5 V 12 C 9 13.65 10.35 15 12 15 Z",fill:"#23D959"}))),SIt=n=>y.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...n},y.createElement("defs",null,y.createElement("filter",{id:"filter0_i",x:9,y:4,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},y.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),y.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),y.createElement("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),y.createElement("feOffset",{dy:1}),y.createElement("feComposite",{in2:"hardAlpha",operator:"arithmetic",k2:-1,k3:1}),y.createElement("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.15 0"}),y.createElement("feBlend",{mode:"normal",in2:"shape",result:"effect1_innerShadow"}))),y.createElement("path",{d:"M7.5 4.5C7.5 2.01 9.51 0 12 0C14.49 0 16.5 2.01 16.5 4.5V12C16.5 14.49 14.49 16.5 12 16.5C9.51 16.5 7.5 14.49 7.5 12V4.5ZM12 15C13.65 15 15 13.65 15 12V4.5C15 2.85 13.65 1.5 12 1.5C10.35 1.5 9 2.85 9 4.5V12C9 13.65 10.35 15 12 15Z",fill:"white"}),y.createElement("path",{d:"M19.485 12.15C19.5 12.105 19.5 12.045 19.5 12C19.5 11.58 19.17 11.25 18.75 11.25C18.33 11.25 18 11.58 18 12C18 15.315 15.315 18 12 18C8.685 18 6 15.315 6 12C6 11.58 5.67 11.25 5.25 11.25C4.83 11.25 4.5 11.58 4.5 12C4.5 12.045 4.5 12.105 4.515 12.15C4.575 15.96 7.5 19.08 11.25 19.455V22.5H8.25C7.83 22.5 7.5 22.83 7.5 23.25C7.5 23.67 7.83 24 8.25 24H15.75C16.17 24 16.5 23.67 16.5 23.25C16.5 22.83 16.17 22.5 15.75 22.5H12.75V19.455C16.5 19.08 19.425 15.96 19.485 12.15Z",fill:"white"}),y.createElement("g",{filter:"url(#filter0_i)",style:{}},y.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M 12 15 C 13.65 15 15 13.65 15 12 V 4.5 C 15 2.85 13.65 1.5 12 1.5 C 10.35 1.5 9 2.85 9 4.5 V 12 C 9 13.65 10.35 15 12 15 Z",fill:"#23D959"}))),_It=n=>y.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...n},y.createElement("path",{d:"M7.5 4.5C7.5 2.01 9.51 0 12 0C14.49 0 16.5 2.01 16.5 4.5V12C16.5 14.49 14.49 16.5 12 16.5C9.51 16.5 7.5 14.49 7.5 12V4.5ZM12 15C13.65 15 15 13.65 15 12V4.5C15 2.85 13.65 1.5 12 1.5C10.35 1.5 9 2.85 9 4.5V12C9 13.65 10.35 15 12 15Z",fill:"white"}),y.createElement("path",{d:"M19.485 12.15C19.5 12.105 19.5 12.045 19.5 12C19.5 11.58 19.17 11.25 18.75 11.25C18.33 11.25 18 11.58 18 12C18 15.315 15.315 18 12 18C8.685 18 6 15.315 6 12C6 11.58 5.67 11.25 5.25 11.25C4.83 11.25 4.5 11.58 4.5 12C4.5 12.045 4.5 12.105 4.515 12.15C4.575 15.96 7.5 19.08 11.25 19.455V22.5H8.25C7.83 22.5 7.5 22.83 7.5 23.25C7.5 23.67 7.83 24 8.25 24H15.75C16.17 24 16.5 23.67 16.5 23.25C16.5 22.83 16.17 22.5 15.75 22.5H12.75V19.455C16.5 19.08 19.425 15.96 19.485 12.15Z",fill:"white"}),y.createElement("g",{style:{}},y.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M 12 15 C 13.65 15 15 13.65 15 12 V 4.5 C 15 2.85 13.65 1.5 12 1.5 C 10.35 1.5 9 2.85 9 4.5 V 12 C 9 13.65 10.35 15 12 15 Z",fill:"#23D959"}))),wIt={"icon-audio-playing-step1":fIt,"icon-audio-playing-step2":pIt,"icon-audio-playing-step3":gIt,"icon-audio-playing-step4":mIt,"icon-audio-playing-step5":vIt,"icon-audio-playing-step6":yIt,"icon-audio-playing-step7":bIt,"icon-audio-playing-step8":SIt,"icon-audio-playing-step9":_It},CIt=n=>{const{className:e,style:t,level:r}=n,i={pointerEvents:"none"};return t&&Object.assign(i,t),x.jsx(bre,{className:e,component:wIt[`icon-audio-playing-step${r}`],viewBox:"0 0 24 24",style:i})};function xIt(){const n=y.useContext(CD),[e,t]=y.useState(0),r=y.useCallback(({level:i})=>{t(i)},[]);return y.useEffect(()=>(n.on("current-audio-level-change",r),()=>{n.off("current-audio-level-change",r)}),[n,r]),e}const{Button:A0e}=sMe,EIt=n=>{const{isStartedAudio:e,isSupportPhone:t,isMuted:r,audio:i,className:o,microphoneList:s,speakerList:a,phoneCountryList:c,activeMicrophone:l,activeSpeaker:u,phoneCallStatus:d,disabled:h,isMicrophoneForbidden:f,isSecondaryAudioStarted:p,onMicrophoneClick:g,onMicrophoneMenuClick:m,onPhoneCallClick:v,onPhoneCallCancel:b}=n,[S,E]=y.useState(!1),[w,C]=y.useState(!1),I=xIt(),T=e?r?"unmute":"mute":"start audio",D=[];s!=null&&s.length&&i!=="phone"&&(D.push(gh("Select a Microphone","microphone",void 0,s.map(A=>gh(A.label,`microphone|${A.deviceId}`,l===A.deviceId&&x.jsx(vZ,{}))),"group")),D.push(gh("","d1",void 0,void 0,"divider"))),a!=null&&a.length&&i!=="phone"&&(D.push(gh("Select a speaker","speaker",void 0,a.map(A=>gh(A.label,`speaker|${A.deviceId}`,u===A.deviceId&&x.jsx(vZ,{}))),"group")),D.push(gh("","d2",void 0,void 0,"divider"))),D.push(gh(p?"Stop secondary audio":"Start secondary audio","secondary audio")),D.push(gh("","d3",void 0,void 0,"divider")),i!=="phone"&&D.push(gh("Audio Statistic","statistic")),D.push(gh(i==="phone"?"Hang Up":"Leave Audio","leave audio"));const O=A=>{m(A.key)},M=A=>{A.key==="phone"?E(!0):A.key==="crc"&&C(!0)},R=y.useMemo(()=>{let A="";if(e)if(r)i==="phone"?A="icon-phone-off":A="icon-audio-muted";else if(i==="phone")A="icon-phone";else{if(I!==0)return x.jsx(CIt,{level:I});A="icon-audio-unmuted"}else f?A="icon-audio-disallow":A="icon-headset";if(A)return x.jsx(CMe,{type:A})},[I,i,r,f,e]);return y.useEffect(()=>{e&&E(!1)},[e]),x.jsxs("div",{className:Ue("microphone-footer",o),children:[e?x.jsx(A0e,{className:"vc-dropdown-button",size:"large",menu:D0e(D,O),onClick:g,trigger:["click"],type:"ghost",icon:x.jsx(g0e,{}),placement:"topRight",disabled:h,children:R}):x.jsx(sE,{title:T,children:x.jsx("div",{children:t?x.jsx(A0e,{className:"vc-dropdown-button",size:"large",menu:D0e([gh("Invite by phone","phone"),gh("Invite H323/SIP Room","crc")],M),onClick:g,trigger:["click"],type:"ghost",icon:x.jsx(g0e,{}),placement:"topRight",children:R}):x.jsx(mg,{className:"vc-button",icon:R,size:"large",ghost:!0,shape:"circle",onClick:g})})}),x.jsx(aIt,{visible:S,setVisible:A=>E(A),phoneCallStatus:d,phoneCountryList:c,onPhoneCallCancel:b,onPhoneCallClick:v}),x.jsx(hIt,{visible:w,setVisible:A=>C(A)})]})};function IIt(n){const e=y.useRef(n);e.current=n,y.useEffect(()=>()=>{e.current&&e.current()},[])}function PIt(n){y.useEffect(()=>{n()},[])}var F8={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */F8.exports;(function(n,e){(function(){var t,r="4.17.21",i=200,o="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",s="Expected a function",a="Invalid `variable` option passed into `_.template`",c="__lodash_hash_undefined__",l=500,u="__lodash_placeholder__",d=1,h=2,f=4,p=1,g=2,m=1,v=2,b=4,S=8,E=16,w=32,C=64,I=128,T=256,D=512,O=30,M="...",R=800,A=16,k=1,L=2,j=3,N=1/0,B=9007199254740991,U=17976931348623157e292,K=NaN,z=4294967295,G=z-1,te=z>>>1,ie=[["ary",I],["bind",m],["bindKey",v],["curry",S],["curryRight",E],["flip",D],["partial",w],["partialRight",C],["rearg",T]],Q="[object Arguments]",ge="[object Array]",_e="[object AsyncFunction]",Se="[object Boolean]",se="[object Date]",ee="[object DOMException]",Y="[object Error]",ue="[object Function]",ye="[object GeneratorFunction]",V="[object Map]",le="[object Number]",he="[object Null]",oe="[object Object]",ne="[object Promise]",ce="[object Proxy]",Ae="[object RegExp]",Ie="[object Set]",be="[object String]",De="[object Symbol]",Me="[object Undefined]",He="[object WeakMap]",Je="[object WeakSet]",qe="[object ArrayBuffer]",Ge="[object DataView]",St="[object Float32Array]",Pt="[object Float64Array]",on="[object Int8Array]",an="[object Int16Array]",Rt="[object Int32Array]",Xt="[object Uint8Array]",yn="[object Uint8ClampedArray]",bn="[object Uint16Array]",Kn="[object Uint32Array]",lr=/\b__p \+= '';/g,Rr=/\b(__p \+=) '' \+/g,Lr=/(__e\(.*?\)|\b__t\)) \+\n'';/g,er=/&(?:amp|lt|gt|quot|#39);/g,ke=/[&<>"']/g,Qn=RegExp(er.source),Gn=RegExp(ke.source),J=/<%-([\s\S]+?)%>/g,ze=/<%([\s\S]+?)%>/g,it=/<%=([\s\S]+?)%>/g,at=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Lt=/^\w*$/,fn=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,hn=/[\\^$.*+?()[\]{}|]/g,Ut=RegExp(hn.source),sn=/^\s+/,ae=/\s/,Wt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,un=/\{\n\/\* \[wrapped with (.+)\] \*/,qt=/,? & /,Ce=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ct=/[()=,{}\[\]\/\s]/,At=/\\(\\)?/g,$t=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,_n=/\w*$/,jn=/^[-+]0x[0-9a-f]+$/i,Zn=/^0b[01]+$/i,Z=/^\[object .+?Constructor\]$/,ve=/^0o[0-7]+$/i,W=/^(?:0|[1-9]\d*)$/,X=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,fe=/($^)/,xt=/['\n\r\u2028\u2029\\]/g,Zt="\\ud800-\\udfff",or="\\u0300-\\u036f",tr="\\ufe20-\\ufe2f",vo="\\u20d0-\\u20ff",fs=or+tr+vo,ps="\\u2700-\\u27bf",Wo="a-z\\xdf-\\xf6\\xf8-\\xff",Tl="\\xac\\xb1\\xd7\\xf7",rs="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Dl="\\u2000-\\u206f",Xh=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Sc="A-Z\\xc0-\\xd6\\xd8-\\xde",oa="\\ufe0e\\ufe0f",zs=Tl+rs+Dl+Xh,Rl="['’]",Ps="["+Zt+"]",pr="["+zs+"]",Yn="["+fs+"]",xr="\\d+",sr="["+ps+"]",nr="["+Wo+"]",Zr="[^"+Zt+zs+xr+ps+Wo+Sc+"]",_i="\\ud83c[\\udffb-\\udfff]",gs="(?:"+Yn+"|"+_i+")",Vs="[^"+Zt+"]",wa="(?:\\ud83c[\\udde6-\\uddff]){2}",ms="[\\ud800-\\udbff][\\udc00-\\udfff]",Po="["+Sc+"]",Ca="\\u200d",lu="(?:"+nr+"|"+Zr+")",za="(?:"+Po+"|"+Zr+")",ed="(?:"+Rl+"(?:d|ll|m|re|s|t|ve))?",_c="(?:"+Rl+"(?:D|LL|M|RE|S|T|VE))?",Fg=gs+"?",Yh="["+oa+"]?",Jd="(?:"+Ca+"(?:"+[Vs,wa,ms].join("|")+")"+Yh+Fg+")*",Va="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",dp="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",jg=Yh+Fg+Jd,hp="(?:"+[sr,wa,ms].join("|")+")"+jg,ib="(?:"+[Vs+Yn+"?",Yn,wa,ms,Ps].join("|")+")",Bg=RegExp(Rl,"g"),Nn=RegExp(Yn,"g"),qn=RegExp(_i+"(?="+_i+")|"+ib+jg,"g"),wi=RegExp([Po+"?"+nr+"+"+ed+"(?="+[pr,Po,"$"].join("|")+")",za+"+"+_c+"(?="+[pr,Po+lu,"$"].join("|")+")",Po+"?"+lu+"+"+ed,Po+"+"+_c,dp,Va,xr,hp].join("|"),"g"),ks=RegExp("["+Ca+Zt+fs+oa+"]"),Qi=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Hg=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],ob=-1,Ui={};Ui[St]=Ui[Pt]=Ui[on]=Ui[an]=Ui[Rt]=Ui[Xt]=Ui[yn]=Ui[bn]=Ui[Kn]=!0,Ui[Q]=Ui[ge]=Ui[qe]=Ui[Se]=Ui[Ge]=Ui[se]=Ui[Y]=Ui[ue]=Ui[V]=Ui[le]=Ui[oe]=Ui[Ae]=Ui[Ie]=Ui[be]=Ui[He]=!1;var ki={};ki[Q]=ki[ge]=ki[qe]=ki[Ge]=ki[Se]=ki[se]=ki[St]=ki[Pt]=ki[on]=ki[an]=ki[Rt]=ki[V]=ki[le]=ki[oe]=ki[Ae]=ki[Ie]=ki[be]=ki[De]=ki[Xt]=ki[yn]=ki[bn]=ki[Kn]=!0,ki[Y]=ki[ue]=ki[He]=!1;var xe={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},Xe={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Ot={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},wn={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},yo=parseFloat,Ar=parseInt,qo=typeof Ir=="object"&&Ir&&Ir.Object===Object&&Ir,sa=typeof self=="object"&&self&&self.Object===Object&&self,vi=qo||sa||Function("return this")(),bo=e&&!e.nodeType&&e,Ws=bo&&!0&&n&&!n.nodeType&&n,uu=Ws&&Ws.exports===bo,aa=uu&&qo.process,Ko=function(){try{var Ze=Ws&&Ws.require&&Ws.require("util").types;return Ze||aa&&aa.binding&&aa.binding("util")}catch{}}(),Al=Ko&&Ko.isArrayBuffer,Jh=Ko&&Ko.isDate,Qd=Ko&&Ko.isMap,fp=Ko&&Ko.isRegExp,TE=Ko&&Ko.isSet,sb=Ko&&Ko.isTypedArray;function Wa(Ze,wt,dt){switch(dt.length){case 0:return Ze.call(wt);case 1:return Ze.call(wt,dt[0]);case 2:return Ze.call(wt,dt[0],dt[1]);case 3:return Ze.call(wt,dt[0],dt[1],dt[2])}return Ze.apply(wt,dt)}function OHe(Ze,wt,dt,In){for(var kr=-1,Fi=Ze==null?0:Ze.length;++kr<Fi;){var xa=Ze[kr];wt(In,xa,dt(xa),Ze)}return In}function eh(Ze,wt){for(var dt=-1,In=Ze==null?0:Ze.length;++dt<In&&wt(Ze[dt],dt,Ze)!==!1;);return Ze}function MHe(Ze,wt){for(var dt=Ze==null?0:Ze.length;dt--&&wt(Ze[dt],dt,Ze)!==!1;);return Ze}function Lse(Ze,wt){for(var dt=-1,In=Ze==null?0:Ze.length;++dt<In;)if(!wt(Ze[dt],dt,Ze))return!1;return!0}function Mv(Ze,wt){for(var dt=-1,In=Ze==null?0:Ze.length,kr=0,Fi=[];++dt<In;){var xa=Ze[dt];wt(xa,dt,Ze)&&(Fi[kr++]=xa)}return Fi}function sR(Ze,wt){var dt=Ze==null?0:Ze.length;return!!dt&&w_(Ze,wt,0)>-1}function _9(Ze,wt,dt){for(var In=-1,kr=Ze==null?0:Ze.length;++In<kr;)if(dt(wt,Ze[In]))return!0;return!1}function is(Ze,wt){for(var dt=-1,In=Ze==null?0:Ze.length,kr=Array(In);++dt<In;)kr[dt]=wt(Ze[dt],dt,Ze);return kr}function $v(Ze,wt){for(var dt=-1,In=wt.length,kr=Ze.length;++dt<In;)Ze[kr+dt]=wt[dt];return Ze}function w9(Ze,wt,dt,In){var kr=-1,Fi=Ze==null?0:Ze.length;for(In&&Fi&&(dt=Ze[++kr]);++kr<Fi;)dt=wt(dt,Ze[kr],kr,Ze);return dt}function $He(Ze,wt,dt,In){var kr=Ze==null?0:Ze.length;for(In&&kr&&(dt=Ze[--kr]);kr--;)dt=wt(dt,Ze[kr],kr,Ze);return dt}function C9(Ze,wt){for(var dt=-1,In=Ze==null?0:Ze.length;++dt<In;)if(wt(Ze[dt],dt,Ze))return!0;return!1}var LHe=x9("length");function NHe(Ze){return Ze.split("")}function FHe(Ze){return Ze.match(Ce)||[]}function Nse(Ze,wt,dt){var In;return dt(Ze,function(kr,Fi,xa){if(wt(kr,Fi,xa))return In=Fi,!1}),In}function aR(Ze,wt,dt,In){for(var kr=Ze.length,Fi=dt+(In?1:-1);In?Fi--:++Fi<kr;)if(wt(Ze[Fi],Fi,Ze))return Fi;return-1}function w_(Ze,wt,dt){return wt===wt?XHe(Ze,wt,dt):aR(Ze,Fse,dt)}function jHe(Ze,wt,dt,In){for(var kr=dt-1,Fi=Ze.length;++kr<Fi;)if(In(Ze[kr],wt))return kr;return-1}function Fse(Ze){return Ze!==Ze}function jse(Ze,wt){var dt=Ze==null?0:Ze.length;return dt?I9(Ze,wt)/dt:K}function x9(Ze){return function(wt){return wt==null?t:wt[Ze]}}function E9(Ze){return function(wt){return Ze==null?t:Ze[wt]}}function Bse(Ze,wt,dt,In,kr){return kr(Ze,function(Fi,xa,So){dt=In?(In=!1,Fi):wt(dt,Fi,xa,So)}),dt}function BHe(Ze,wt){var dt=Ze.length;for(Ze.sort(wt);dt--;)Ze[dt]=Ze[dt].value;return Ze}function I9(Ze,wt){for(var dt,In=-1,kr=Ze.length;++In<kr;){var Fi=wt(Ze[In]);Fi!==t&&(dt=dt===t?Fi:dt+Fi)}return dt}function P9(Ze,wt){for(var dt=-1,In=Array(Ze);++dt<Ze;)In[dt]=wt(dt);return In}function HHe(Ze,wt){return is(wt,function(dt){return[dt,Ze[dt]]})}function Hse(Ze){return Ze&&Ze.slice(0,Wse(Ze)+1).replace(sn,"")}function td(Ze){return function(wt){return Ze(wt)}}function k9(Ze,wt){return is(wt,function(dt){return Ze[dt]})}function DE(Ze,wt){return Ze.has(wt)}function Use(Ze,wt){for(var dt=-1,In=Ze.length;++dt<In&&w_(wt,Ze[dt],0)>-1;);return dt}function zse(Ze,wt){for(var dt=Ze.length;dt--&&w_(wt,Ze[dt],0)>-1;);return dt}function UHe(Ze,wt){for(var dt=Ze.length,In=0;dt--;)Ze[dt]===wt&&++In;return In}var zHe=E9(xe),VHe=E9(Xe);function WHe(Ze){return"\\"+wn[Ze]}function qHe(Ze,wt){return Ze==null?t:Ze[wt]}function C_(Ze){return ks.test(Ze)}function KHe(Ze){return Qi.test(Ze)}function GHe(Ze){for(var wt,dt=[];!(wt=Ze.next()).done;)dt.push(wt.value);return dt}function T9(Ze){var wt=-1,dt=Array(Ze.size);return Ze.forEach(function(In,kr){dt[++wt]=[kr,In]}),dt}function Vse(Ze,wt){return function(dt){return Ze(wt(dt))}}function Lv(Ze,wt){for(var dt=-1,In=Ze.length,kr=0,Fi=[];++dt<In;){var xa=Ze[dt];(xa===wt||xa===u)&&(Ze[dt]=u,Fi[kr++]=dt)}return Fi}function cR(Ze){var wt=-1,dt=Array(Ze.size);return Ze.forEach(function(In){dt[++wt]=In}),dt}function ZHe(Ze){var wt=-1,dt=Array(Ze.size);return Ze.forEach(function(In){dt[++wt]=[In,In]}),dt}function XHe(Ze,wt,dt){for(var In=dt-1,kr=Ze.length;++In<kr;)if(Ze[In]===wt)return In;return-1}function YHe(Ze,wt,dt){for(var In=dt+1;In--;)if(Ze[In]===wt)return In;return In}function x_(Ze){return C_(Ze)?QHe(Ze):LHe(Ze)}function Qh(Ze){return C_(Ze)?eUe(Ze):NHe(Ze)}function Wse(Ze){for(var wt=Ze.length;wt--&&ae.test(Ze.charAt(wt)););return wt}var JHe=E9(Ot);function QHe(Ze){for(var wt=qn.lastIndex=0;qn.test(Ze);)++wt;return wt}function eUe(Ze){return Ze.match(qn)||[]}function tUe(Ze){return Ze.match(wi)||[]}var nUe=function Ze(wt){wt=wt==null?vi:E_.defaults(vi.Object(),wt,E_.pick(vi,Hg));var dt=wt.Array,In=wt.Date,kr=wt.Error,Fi=wt.Function,xa=wt.Math,So=wt.Object,D9=wt.RegExp,rUe=wt.String,th=wt.TypeError,lR=dt.prototype,iUe=Fi.prototype,I_=So.prototype,uR=wt["__core-js_shared__"],dR=iUe.toString,eo=I_.hasOwnProperty,oUe=0,qse=function(){var _=/[^.]+$/.exec(uR&&uR.keys&&uR.keys.IE_PROTO||"");return _?"Symbol(src)_1."+_:""}(),hR=I_.toString,sUe=dR.call(So),aUe=vi._,cUe=D9("^"+dR.call(eo).replace(hn,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),fR=uu?wt.Buffer:t,Nv=wt.Symbol,pR=wt.Uint8Array,Kse=fR?fR.allocUnsafe:t,gR=Vse(So.getPrototypeOf,So),Gse=So.create,Zse=I_.propertyIsEnumerable,mR=lR.splice,Xse=Nv?Nv.isConcatSpreadable:t,RE=Nv?Nv.iterator:t,ab=Nv?Nv.toStringTag:t,vR=function(){try{var _=hb(So,"defineProperty");return _({},"",{}),_}catch{}}(),lUe=wt.clearTimeout!==vi.clearTimeout&&wt.clearTimeout,uUe=In&&In.now!==vi.Date.now&&In.now,dUe=wt.setTimeout!==vi.setTimeout&&wt.setTimeout,yR=xa.ceil,bR=xa.floor,R9=So.getOwnPropertySymbols,hUe=fR?fR.isBuffer:t,Yse=wt.isFinite,fUe=lR.join,pUe=Vse(So.keys,So),Ea=xa.max,tl=xa.min,gUe=In.now,mUe=wt.parseInt,Jse=xa.random,vUe=lR.reverse,A9=hb(wt,"DataView"),AE=hb(wt,"Map"),O9=hb(wt,"Promise"),P_=hb(wt,"Set"),OE=hb(wt,"WeakMap"),ME=hb(So,"create"),SR=OE&&new OE,k_={},yUe=fb(A9),bUe=fb(AE),SUe=fb(O9),_Ue=fb(P_),wUe=fb(OE),_R=Nv?Nv.prototype:t,$E=_R?_R.valueOf:t,Qse=_R?_R.toString:t;function de(_){if(Ts(_)&&!Or(_)&&!(_ instanceof li)){if(_ instanceof nh)return _;if(eo.call(_,"__wrapped__"))return ece(_)}return new nh(_)}var T_=function(){function _(){}return function(P){if(!vs(P))return{};if(Gse)return Gse(P);_.prototype=P;var F=new _;return _.prototype=t,F}}();function wR(){}function nh(_,P){this.__wrapped__=_,this.__actions__=[],this.__chain__=!!P,this.__index__=0,this.__values__=t}de.templateSettings={escape:J,evaluate:ze,interpolate:it,variable:"",imports:{_:de}},de.prototype=wR.prototype,de.prototype.constructor=de,nh.prototype=T_(wR.prototype),nh.prototype.constructor=nh;function li(_){this.__wrapped__=_,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=z,this.__views__=[]}function CUe(){var _=new li(this.__wrapped__);return _.__actions__=du(this.__actions__),_.__dir__=this.__dir__,_.__filtered__=this.__filtered__,_.__iteratees__=du(this.__iteratees__),_.__takeCount__=this.__takeCount__,_.__views__=du(this.__views__),_}function xUe(){if(this.__filtered__){var _=new li(this);_.__dir__=-1,_.__filtered__=!0}else _=this.clone(),_.__dir__*=-1;return _}function EUe(){var _=this.__wrapped__.value(),P=this.__dir__,F=Or(_),q=P<0,re=F?_.length:0,pe=Nze(0,re,this.__views__),Oe=pe.start,We=pe.end,Ye=We-Oe,It=q?We:Oe-1,kt=this.__iteratees__,Nt=kt.length,vn=0,Bn=tl(Ye,this.__takeCount__);if(!F||!q&&re==Ye&&Bn==Ye)return Cae(_,this.__actions__);var gr=[];e:for(;Ye--&&vn<Bn;){It+=P;for(var Wr=-1,mr=_[It];++Wr<Nt;){var ai=kt[Wr],yi=ai.iteratee,id=ai.type,$l=yi(mr);if(id==L)mr=$l;else if(!$l){if(id==k)continue e;break e}}gr[vn++]=mr}return gr}li.prototype=T_(wR.prototype),li.prototype.constructor=li;function cb(_){var P=-1,F=_==null?0:_.length;for(this.clear();++P<F;){var q=_[P];this.set(q[0],q[1])}}function IUe(){this.__data__=ME?ME(null):{},this.size=0}function PUe(_){var P=this.has(_)&&delete this.__data__[_];return this.size-=P?1:0,P}function kUe(_){var P=this.__data__;if(ME){var F=P[_];return F===c?t:F}return eo.call(P,_)?P[_]:t}function TUe(_){var P=this.__data__;return ME?P[_]!==t:eo.call(P,_)}function DUe(_,P){var F=this.__data__;return this.size+=this.has(_)?0:1,F[_]=ME&&P===t?c:P,this}cb.prototype.clear=IUe,cb.prototype.delete=PUe,cb.prototype.get=kUe,cb.prototype.has=TUe,cb.prototype.set=DUe;function Ug(_){var P=-1,F=_==null?0:_.length;for(this.clear();++P<F;){var q=_[P];this.set(q[0],q[1])}}function RUe(){this.__data__=[],this.size=0}function AUe(_){var P=this.__data__,F=CR(P,_);if(F<0)return!1;var q=P.length-1;return F==q?P.pop():mR.call(P,F,1),--this.size,!0}function OUe(_){var P=this.__data__,F=CR(P,_);return F<0?t:P[F][1]}function MUe(_){return CR(this.__data__,_)>-1}function $Ue(_,P){var F=this.__data__,q=CR(F,_);return q<0?(++this.size,F.push([_,P])):F[q][1]=P,this}Ug.prototype.clear=RUe,Ug.prototype.delete=AUe,Ug.prototype.get=OUe,Ug.prototype.has=MUe,Ug.prototype.set=$Ue;function zg(_){var P=-1,F=_==null?0:_.length;for(this.clear();++P<F;){var q=_[P];this.set(q[0],q[1])}}function LUe(){this.size=0,this.__data__={hash:new cb,map:new(AE||Ug),string:new cb}}function NUe(_){var P=$R(this,_).delete(_);return this.size-=P?1:0,P}function FUe(_){return $R(this,_).get(_)}function jUe(_){return $R(this,_).has(_)}function BUe(_,P){var F=$R(this,_),q=F.size;return F.set(_,P),this.size+=F.size==q?0:1,this}zg.prototype.clear=LUe,zg.prototype.delete=NUe,zg.prototype.get=FUe,zg.prototype.has=jUe,zg.prototype.set=BUe;function lb(_){var P=-1,F=_==null?0:_.length;for(this.__data__=new zg;++P<F;)this.add(_[P])}function HUe(_){return this.__data__.set(_,c),this}function UUe(_){return this.__data__.has(_)}lb.prototype.add=lb.prototype.push=HUe,lb.prototype.has=UUe;function ef(_){var P=this.__data__=new Ug(_);this.size=P.size}function zUe(){this.__data__=new Ug,this.size=0}function VUe(_){var P=this.__data__,F=P.delete(_);return this.size=P.size,F}function WUe(_){return this.__data__.get(_)}function qUe(_){return this.__data__.has(_)}function KUe(_,P){var F=this.__data__;if(F instanceof Ug){var q=F.__data__;if(!AE||q.length<i-1)return q.push([_,P]),this.size=++F.size,this;F=this.__data__=new zg(q)}return F.set(_,P),this.size=F.size,this}ef.prototype.clear=zUe,ef.prototype.delete=VUe,ef.prototype.get=WUe,ef.prototype.has=qUe,ef.prototype.set=KUe;function eae(_,P){var F=Or(_),q=!F&&pb(_),re=!F&&!q&&Uv(_),pe=!F&&!q&&!re&&O_(_),Oe=F||q||re||pe,We=Oe?P9(_.length,rUe):[],Ye=We.length;for(var It in _)(P||eo.call(_,It))&&!(Oe&&(It=="length"||re&&(It=="offset"||It=="parent")||pe&&(It=="buffer"||It=="byteLength"||It=="byteOffset")||Kg(It,Ye)))&&We.push(It);return We}function tae(_){var P=_.length;return P?_[V9(0,P-1)]:t}function GUe(_,P){return LR(du(_),ub(P,0,_.length))}function ZUe(_){return LR(du(_))}function M9(_,P,F){(F!==t&&!tf(_[P],F)||F===t&&!(P in _))&&Vg(_,P,F)}function LE(_,P,F){var q=_[P];(!(eo.call(_,P)&&tf(q,F))||F===t&&!(P in _))&&Vg(_,P,F)}function CR(_,P){for(var F=_.length;F--;)if(tf(_[F][0],P))return F;return-1}function XUe(_,P,F,q){return Fv(_,function(re,pe,Oe){P(q,re,F(re),Oe)}),q}function nae(_,P){return _&&gp(P,qa(P),_)}function YUe(_,P){return _&&gp(P,fu(P),_)}function Vg(_,P,F){P=="__proto__"&&vR?vR(_,P,{configurable:!0,enumerable:!0,value:F,writable:!0}):_[P]=F}function $9(_,P){for(var F=-1,q=P.length,re=dt(q),pe=_==null;++F<q;)re[F]=pe?t:gj(_,P[F]);return re}function ub(_,P,F){return _===_&&(F!==t&&(_=_<=F?_:F),P!==t&&(_=_>=P?_:P)),_}function rh(_,P,F,q,re,pe){var Oe,We=P&d,Ye=P&h,It=P&f;if(F&&(Oe=re?F(_,q,re,pe):F(_)),Oe!==t)return Oe;if(!vs(_))return _;var kt=Or(_);if(kt){if(Oe=jze(_),!We)return du(_,Oe)}else{var Nt=nl(_),vn=Nt==ue||Nt==ye;if(Uv(_))return Iae(_,We);if(Nt==oe||Nt==Q||vn&&!re){if(Oe=Ye||vn?{}:Wae(_),!We)return Ye?kze(_,YUe(Oe,_)):Pze(_,nae(Oe,_))}else{if(!ki[Nt])return re?_:{};Oe=Bze(_,Nt,We)}}pe||(pe=new ef);var Bn=pe.get(_);if(Bn)return Bn;pe.set(_,Oe),Sce(_)?_.forEach(function(mr){Oe.add(rh(mr,P,F,mr,_,pe))}):yce(_)&&_.forEach(function(mr,ai){Oe.set(ai,rh(mr,P,F,ai,_,pe))});var gr=It?Ye?tj:ej:Ye?fu:qa,Wr=kt?t:gr(_);return eh(Wr||_,function(mr,ai){Wr&&(ai=mr,mr=_[ai]),LE(Oe,ai,rh(mr,P,F,ai,_,pe))}),Oe}function JUe(_){var P=qa(_);return function(F){return rae(F,_,P)}}function rae(_,P,F){var q=F.length;if(_==null)return!q;for(_=So(_);q--;){var re=F[q],pe=P[re],Oe=_[re];if(Oe===t&&!(re in _)||!pe(Oe))return!1}return!0}function iae(_,P,F){if(typeof _!="function")throw new th(s);return zE(function(){_.apply(t,F)},P)}function NE(_,P,F,q){var re=-1,pe=sR,Oe=!0,We=_.length,Ye=[],It=P.length;if(!We)return Ye;F&&(P=is(P,td(F))),q?(pe=_9,Oe=!1):P.length>=i&&(pe=DE,Oe=!1,P=new lb(P));e:for(;++re<We;){var kt=_[re],Nt=F==null?kt:F(kt);if(kt=q||kt!==0?kt:0,Oe&&Nt===Nt){for(var vn=It;vn--;)if(P[vn]===Nt)continue e;Ye.push(kt)}else pe(P,Nt,q)||Ye.push(kt)}return Ye}var Fv=Rae(pp),oae=Rae(N9,!0);function QUe(_,P){var F=!0;return Fv(_,function(q,re,pe){return F=!!P(q,re,pe),F}),F}function xR(_,P,F){for(var q=-1,re=_.length;++q<re;){var pe=_[q],Oe=P(pe);if(Oe!=null&&(We===t?Oe===Oe&&!rd(Oe):F(Oe,We)))var We=Oe,Ye=pe}return Ye}function eze(_,P,F,q){var re=_.length;for(F=Br(F),F<0&&(F=-F>re?0:re+F),q=q===t||q>re?re:Br(q),q<0&&(q+=re),q=F>q?0:wce(q);F<q;)_[F++]=P;return _}function sae(_,P){var F=[];return Fv(_,function(q,re,pe){P(q,re,pe)&&F.push(q)}),F}function wc(_,P,F,q,re){var pe=-1,Oe=_.length;for(F||(F=Uze),re||(re=[]);++pe<Oe;){var We=_[pe];P>0&&F(We)?P>1?wc(We,P-1,F,q,re):$v(re,We):q||(re[re.length]=We)}return re}var L9=Aae(),aae=Aae(!0);function pp(_,P){return _&&L9(_,P,qa)}function N9(_,P){return _&&aae(_,P,qa)}function ER(_,P){return Mv(P,function(F){return Gg(_[F])})}function db(_,P){P=Bv(P,_);for(var F=0,q=P.length;_!=null&&F<q;)_=_[mp(P[F++])];return F&&F==q?_:t}function cae(_,P,F){var q=P(_);return Or(_)?q:$v(q,F(_))}function Ol(_){return _==null?_===t?Me:he:ab&&ab in So(_)?Lze(_):Zze(_)}function F9(_,P){return _>P}function tze(_,P){return _!=null&&eo.call(_,P)}function nze(_,P){return _!=null&&P in So(_)}function rze(_,P,F){return _>=tl(P,F)&&_<Ea(P,F)}function j9(_,P,F){for(var q=F?_9:sR,re=_[0].length,pe=_.length,Oe=pe,We=dt(pe),Ye=1/0,It=[];Oe--;){var kt=_[Oe];Oe&&P&&(kt=is(kt,td(P))),Ye=tl(kt.length,Ye),We[Oe]=!F&&(P||re>=120&&kt.length>=120)?new lb(Oe&&kt):t}kt=_[0];var Nt=-1,vn=We[0];e:for(;++Nt<re&&It.length<Ye;){var Bn=kt[Nt],gr=P?P(Bn):Bn;if(Bn=F||Bn!==0?Bn:0,!(vn?DE(vn,gr):q(It,gr,F))){for(Oe=pe;--Oe;){var Wr=We[Oe];if(!(Wr?DE(Wr,gr):q(_[Oe],gr,F)))continue e}vn&&vn.push(gr),It.push(Bn)}}return It}function ize(_,P,F,q){return pp(_,function(re,pe,Oe){P(q,F(re),pe,Oe)}),q}function FE(_,P,F){P=Bv(P,_),_=Zae(_,P);var q=_==null?_:_[mp(oh(P))];return q==null?t:Wa(q,_,F)}function lae(_){return Ts(_)&&Ol(_)==Q}function oze(_){return Ts(_)&&Ol(_)==qe}function sze(_){return Ts(_)&&Ol(_)==se}function jE(_,P,F,q,re){return _===P?!0:_==null||P==null||!Ts(_)&&!Ts(P)?_!==_&&P!==P:aze(_,P,F,q,jE,re)}function aze(_,P,F,q,re,pe){var Oe=Or(_),We=Or(P),Ye=Oe?ge:nl(_),It=We?ge:nl(P);Ye=Ye==Q?oe:Ye,It=It==Q?oe:It;var kt=Ye==oe,Nt=It==oe,vn=Ye==It;if(vn&&Uv(_)){if(!Uv(P))return!1;Oe=!0,kt=!1}if(vn&&!kt)return pe||(pe=new ef),Oe||O_(_)?Uae(_,P,F,q,re,pe):Mze(_,P,Ye,F,q,re,pe);if(!(F&p)){var Bn=kt&&eo.call(_,"__wrapped__"),gr=Nt&&eo.call(P,"__wrapped__");if(Bn||gr){var Wr=Bn?_.value():_,mr=gr?P.value():P;return pe||(pe=new ef),re(Wr,mr,F,q,pe)}}return vn?(pe||(pe=new ef),$ze(_,P,F,q,re,pe)):!1}function cze(_){return Ts(_)&&nl(_)==V}function B9(_,P,F,q){var re=F.length,pe=re,Oe=!q;if(_==null)return!pe;for(_=So(_);re--;){var We=F[re];if(Oe&&We[2]?We[1]!==_[We[0]]:!(We[0]in _))return!1}for(;++re<pe;){We=F[re];var Ye=We[0],It=_[Ye],kt=We[1];if(Oe&&We[2]){if(It===t&&!(Ye in _))return!1}else{var Nt=new ef;if(q)var vn=q(It,kt,Ye,_,P,Nt);if(!(vn===t?jE(kt,It,p|g,q,Nt):vn))return!1}}return!0}function uae(_){if(!vs(_)||Vze(_))return!1;var P=Gg(_)?cUe:Z;return P.test(fb(_))}function lze(_){return Ts(_)&&Ol(_)==Ae}function uze(_){return Ts(_)&&nl(_)==Ie}function dze(_){return Ts(_)&&UR(_.length)&&!!Ui[Ol(_)]}function dae(_){return typeof _=="function"?_:_==null?pu:typeof _=="object"?Or(_)?pae(_[0],_[1]):fae(_):Oce(_)}function H9(_){if(!UE(_))return pUe(_);var P=[];for(var F in So(_))eo.call(_,F)&&F!="constructor"&&P.push(F);return P}function hze(_){if(!vs(_))return Gze(_);var P=UE(_),F=[];for(var q in _)q=="constructor"&&(P||!eo.call(_,q))||F.push(q);return F}function U9(_,P){return _<P}function hae(_,P){var F=-1,q=hu(_)?dt(_.length):[];return Fv(_,function(re,pe,Oe){q[++F]=P(re,pe,Oe)}),q}function fae(_){var P=rj(_);return P.length==1&&P[0][2]?Kae(P[0][0],P[0][1]):function(F){return F===_||B9(F,_,P)}}function pae(_,P){return oj(_)&&qae(P)?Kae(mp(_),P):function(F){var q=gj(F,_);return q===t&&q===P?mj(F,_):jE(P,q,p|g)}}function IR(_,P,F,q,re){_!==P&&L9(P,function(pe,Oe){if(re||(re=new ef),vs(pe))fze(_,P,Oe,F,IR,q,re);else{var We=q?q(aj(_,Oe),pe,Oe+"",_,P,re):t;We===t&&(We=pe),M9(_,Oe,We)}},fu)}function fze(_,P,F,q,re,pe,Oe){var We=aj(_,F),Ye=aj(P,F),It=Oe.get(Ye);if(It){M9(_,F,It);return}var kt=pe?pe(We,Ye,F+"",_,P,Oe):t,Nt=kt===t;if(Nt){var vn=Or(Ye),Bn=!vn&&Uv(Ye),gr=!vn&&!Bn&&O_(Ye);kt=Ye,vn||Bn||gr?Or(We)?kt=We:qs(We)?kt=du(We):Bn?(Nt=!1,kt=Iae(Ye,!0)):gr?(Nt=!1,kt=Pae(Ye,!0)):kt=[]:VE(Ye)||pb(Ye)?(kt=We,pb(We)?kt=Cce(We):(!vs(We)||Gg(We))&&(kt=Wae(Ye))):Nt=!1}Nt&&(Oe.set(Ye,kt),re(kt,Ye,q,pe,Oe),Oe.delete(Ye)),M9(_,F,kt)}function gae(_,P){var F=_.length;if(F)return P+=P<0?F:0,Kg(P,F)?_[P]:t}function mae(_,P,F){P.length?P=is(P,function(pe){return Or(pe)?function(Oe){return db(Oe,pe.length===1?pe[0]:pe)}:pe}):P=[pu];var q=-1;P=is(P,td(ur()));var re=hae(_,function(pe,Oe,We){var Ye=is(P,function(It){return It(pe)});return{criteria:Ye,index:++q,value:pe}});return BHe(re,function(pe,Oe){return Ize(pe,Oe,F)})}function pze(_,P){return vae(_,P,function(F,q){return mj(_,q)})}function vae(_,P,F){for(var q=-1,re=P.length,pe={};++q<re;){var Oe=P[q],We=db(_,Oe);F(We,Oe)&&BE(pe,Bv(Oe,_),We)}return pe}function gze(_){return function(P){return db(P,_)}}function z9(_,P,F,q){var re=q?jHe:w_,pe=-1,Oe=P.length,We=_;for(_===P&&(P=du(P)),F&&(We=is(_,td(F)));++pe<Oe;)for(var Ye=0,It=P[pe],kt=F?F(It):It;(Ye=re(We,kt,Ye,q))>-1;)We!==_&&mR.call(We,Ye,1),mR.call(_,Ye,1);return _}function yae(_,P){for(var F=_?P.length:0,q=F-1;F--;){var re=P[F];if(F==q||re!==pe){var pe=re;Kg(re)?mR.call(_,re,1):K9(_,re)}}return _}function V9(_,P){return _+bR(Jse()*(P-_+1))}function mze(_,P,F,q){for(var re=-1,pe=Ea(yR((P-_)/(F||1)),0),Oe=dt(pe);pe--;)Oe[q?pe:++re]=_,_+=F;return Oe}function W9(_,P){var F="";if(!_||P<1||P>B)return F;do P%2&&(F+=_),P=bR(P/2),P&&(_+=_);while(P);return F}function Xr(_,P){return cj(Gae(_,P,pu),_+"")}function vze(_){return tae(M_(_))}function yze(_,P){var F=M_(_);return LR(F,ub(P,0,F.length))}function BE(_,P,F,q){if(!vs(_))return _;P=Bv(P,_);for(var re=-1,pe=P.length,Oe=pe-1,We=_;We!=null&&++re<pe;){var Ye=mp(P[re]),It=F;if(Ye==="__proto__"||Ye==="constructor"||Ye==="prototype")return _;if(re!=Oe){var kt=We[Ye];It=q?q(kt,Ye,We):t,It===t&&(It=vs(kt)?kt:Kg(P[re+1])?[]:{})}LE(We,Ye,It),We=We[Ye]}return _}var bae=SR?function(_,P){return SR.set(_,P),_}:pu,bze=vR?function(_,P){return vR(_,"toString",{configurable:!0,enumerable:!1,value:yj(P),writable:!0})}:pu;function Sze(_){return LR(M_(_))}function ih(_,P,F){var q=-1,re=_.length;P<0&&(P=-P>re?0:re+P),F=F>re?re:F,F<0&&(F+=re),re=P>F?0:F-P>>>0,P>>>=0;for(var pe=dt(re);++q<re;)pe[q]=_[q+P];return pe}function _ze(_,P){var F;return Fv(_,function(q,re,pe){return F=P(q,re,pe),!F}),!!F}function PR(_,P,F){var q=0,re=_==null?q:_.length;if(typeof P=="number"&&P===P&&re<=te){for(;q<re;){var pe=q+re>>>1,Oe=_[pe];Oe!==null&&!rd(Oe)&&(F?Oe<=P:Oe<P)?q=pe+1:re=pe}return re}return q9(_,P,pu,F)}function q9(_,P,F,q){var re=0,pe=_==null?0:_.length;if(pe===0)return 0;P=F(P);for(var Oe=P!==P,We=P===null,Ye=rd(P),It=P===t;re<pe;){var kt=bR((re+pe)/2),Nt=F(_[kt]),vn=Nt!==t,Bn=Nt===null,gr=Nt===Nt,Wr=rd(Nt);if(Oe)var mr=q||gr;else It?mr=gr&&(q||vn):We?mr=gr&&vn&&(q||!Bn):Ye?mr=gr&&vn&&!Bn&&(q||!Wr):Bn||Wr?mr=!1:mr=q?Nt<=P:Nt<P;mr?re=kt+1:pe=kt}return tl(pe,G)}function Sae(_,P){for(var F=-1,q=_.length,re=0,pe=[];++F<q;){var Oe=_[F],We=P?P(Oe):Oe;if(!F||!tf(We,Ye)){var Ye=We;pe[re++]=Oe===0?0:Oe}}return pe}function _ae(_){return typeof _=="number"?_:rd(_)?K:+_}function nd(_){if(typeof _=="string")return _;if(Or(_))return is(_,nd)+"";if(rd(_))return Qse?Qse.call(_):"";var P=_+"";return P=="0"&&1/_==-N?"-0":P}function jv(_,P,F){var q=-1,re=sR,pe=_.length,Oe=!0,We=[],Ye=We;if(F)Oe=!1,re=_9;else if(pe>=i){var It=P?null:Aze(_);if(It)return cR(It);Oe=!1,re=DE,Ye=new lb}else Ye=P?[]:We;e:for(;++q<pe;){var kt=_[q],Nt=P?P(kt):kt;if(kt=F||kt!==0?kt:0,Oe&&Nt===Nt){for(var vn=Ye.length;vn--;)if(Ye[vn]===Nt)continue e;P&&Ye.push(Nt),We.push(kt)}else re(Ye,Nt,F)||(Ye!==We&&Ye.push(Nt),We.push(kt))}return We}function K9(_,P){return P=Bv(P,_),_=Zae(_,P),_==null||delete _[mp(oh(P))]}function wae(_,P,F,q){return BE(_,P,F(db(_,P)),q)}function kR(_,P,F,q){for(var re=_.length,pe=q?re:-1;(q?pe--:++pe<re)&&P(_[pe],pe,_););return F?ih(_,q?0:pe,q?pe+1:re):ih(_,q?pe+1:0,q?re:pe)}function Cae(_,P){var F=_;return F instanceof li&&(F=F.value()),w9(P,function(q,re){return re.func.apply(re.thisArg,$v([q],re.args))},F)}function G9(_,P,F){var q=_.length;if(q<2)return q?jv(_[0]):[];for(var re=-1,pe=dt(q);++re<q;)for(var Oe=_[re],We=-1;++We<q;)We!=re&&(pe[re]=NE(pe[re]||Oe,_[We],P,F));return jv(wc(pe,1),P,F)}function xae(_,P,F){for(var q=-1,re=_.length,pe=P.length,Oe={};++q<re;){var We=q<pe?P[q]:t;F(Oe,_[q],We)}return Oe}function Z9(_){return qs(_)?_:[]}function X9(_){return typeof _=="function"?_:pu}function Bv(_,P){return Or(_)?_:oj(_,P)?[_]:Qae(zi(_))}var wze=Xr;function Hv(_,P,F){var q=_.length;return F=F===t?q:F,!P&&F>=q?_:ih(_,P,F)}var Eae=lUe||function(_){return vi.clearTimeout(_)};function Iae(_,P){if(P)return _.slice();var F=_.length,q=Kse?Kse(F):new _.constructor(F);return _.copy(q),q}function Y9(_){var P=new _.constructor(_.byteLength);return new pR(P).set(new pR(_)),P}function Cze(_,P){var F=P?Y9(_.buffer):_.buffer;return new _.constructor(F,_.byteOffset,_.byteLength)}function xze(_){var P=new _.constructor(_.source,_n.exec(_));return P.lastIndex=_.lastIndex,P}function Eze(_){return $E?So($E.call(_)):{}}function Pae(_,P){var F=P?Y9(_.buffer):_.buffer;return new _.constructor(F,_.byteOffset,_.length)}function kae(_,P){if(_!==P){var F=_!==t,q=_===null,re=_===_,pe=rd(_),Oe=P!==t,We=P===null,Ye=P===P,It=rd(P);if(!We&&!It&&!pe&&_>P||pe&&Oe&&Ye&&!We&&!It||q&&Oe&&Ye||!F&&Ye||!re)return 1;if(!q&&!pe&&!It&&_<P||It&&F&&re&&!q&&!pe||We&&F&&re||!Oe&&re||!Ye)return-1}return 0}function Ize(_,P,F){for(var q=-1,re=_.criteria,pe=P.criteria,Oe=re.length,We=F.length;++q<Oe;){var Ye=kae(re[q],pe[q]);if(Ye){if(q>=We)return Ye;var It=F[q];return Ye*(It=="desc"?-1:1)}}return _.index-P.index}function Tae(_,P,F,q){for(var re=-1,pe=_.length,Oe=F.length,We=-1,Ye=P.length,It=Ea(pe-Oe,0),kt=dt(Ye+It),Nt=!q;++We<Ye;)kt[We]=P[We];for(;++re<Oe;)(Nt||re<pe)&&(kt[F[re]]=_[re]);for(;It--;)kt[We++]=_[re++];return kt}function Dae(_,P,F,q){for(var re=-1,pe=_.length,Oe=-1,We=F.length,Ye=-1,It=P.length,kt=Ea(pe-We,0),Nt=dt(kt+It),vn=!q;++re<kt;)Nt[re]=_[re];for(var Bn=re;++Ye<It;)Nt[Bn+Ye]=P[Ye];for(;++Oe<We;)(vn||re<pe)&&(Nt[Bn+F[Oe]]=_[re++]);return Nt}function du(_,P){var F=-1,q=_.length;for(P||(P=dt(q));++F<q;)P[F]=_[F];return P}function gp(_,P,F,q){var re=!F;F||(F={});for(var pe=-1,Oe=P.length;++pe<Oe;){var We=P[pe],Ye=q?q(F[We],_[We],We,F,_):t;Ye===t&&(Ye=_[We]),re?Vg(F,We,Ye):LE(F,We,Ye)}return F}function Pze(_,P){return gp(_,ij(_),P)}function kze(_,P){return gp(_,zae(_),P)}function TR(_,P){return function(F,q){var re=Or(F)?OHe:XUe,pe=P?P():{};return re(F,_,ur(q,2),pe)}}function D_(_){return Xr(function(P,F){var q=-1,re=F.length,pe=re>1?F[re-1]:t,Oe=re>2?F[2]:t;for(pe=_.length>3&&typeof pe=="function"?(re--,pe):t,Oe&&Ml(F[0],F[1],Oe)&&(pe=re<3?t:pe,re=1),P=So(P);++q<re;){var We=F[q];We&&_(P,We,q,pe)}return P})}function Rae(_,P){return function(F,q){if(F==null)return F;if(!hu(F))return _(F,q);for(var re=F.length,pe=P?re:-1,Oe=So(F);(P?pe--:++pe<re)&&q(Oe[pe],pe,Oe)!==!1;);return F}}function Aae(_){return function(P,F,q){for(var re=-1,pe=So(P),Oe=q(P),We=Oe.length;We--;){var Ye=Oe[_?We:++re];if(F(pe[Ye],Ye,pe)===!1)break}return P}}function Tze(_,P,F){var q=P&m,re=HE(_);function pe(){var Oe=this&&this!==vi&&this instanceof pe?re:_;return Oe.apply(q?F:this,arguments)}return pe}function Oae(_){return function(P){P=zi(P);var F=C_(P)?Qh(P):t,q=F?F[0]:P.charAt(0),re=F?Hv(F,1).join(""):P.slice(1);return q[_]()+re}}function R_(_){return function(P){return w9(Rce(Dce(P).replace(Bg,"")),_,"")}}function HE(_){return function(){var P=arguments;switch(P.length){case 0:return new _;case 1:return new _(P[0]);case 2:return new _(P[0],P[1]);case 3:return new _(P[0],P[1],P[2]);case 4:return new _(P[0],P[1],P[2],P[3]);case 5:return new _(P[0],P[1],P[2],P[3],P[4]);case 6:return new _(P[0],P[1],P[2],P[3],P[4],P[5]);case 7:return new _(P[0],P[1],P[2],P[3],P[4],P[5],P[6])}var F=T_(_.prototype),q=_.apply(F,P);return vs(q)?q:F}}function Dze(_,P,F){var q=HE(_);function re(){for(var pe=arguments.length,Oe=dt(pe),We=pe,Ye=A_(re);We--;)Oe[We]=arguments[We];var It=pe<3&&Oe[0]!==Ye&&Oe[pe-1]!==Ye?[]:Lv(Oe,Ye);if(pe-=It.length,pe<F)return Fae(_,P,DR,re.placeholder,t,Oe,It,t,t,F-pe);var kt=this&&this!==vi&&this instanceof re?q:_;return Wa(kt,this,Oe)}return re}function Mae(_){return function(P,F,q){var re=So(P);if(!hu(P)){var pe=ur(F,3);P=qa(P),F=function(We){return pe(re[We],We,re)}}var Oe=_(P,F,q);return Oe>-1?re[pe?P[Oe]:Oe]:t}}function $ae(_){return qg(function(P){var F=P.length,q=F,re=nh.prototype.thru;for(_&&P.reverse();q--;){var pe=P[q];if(typeof pe!="function")throw new th(s);if(re&&!Oe&&MR(pe)=="wrapper")var Oe=new nh([],!0)}for(q=Oe?q:F;++q<F;){pe=P[q];var We=MR(pe),Ye=We=="wrapper"?nj(pe):t;Ye&&sj(Ye[0])&&Ye[1]==(I|S|w|T)&&!Ye[4].length&&Ye[9]==1?Oe=Oe[MR(Ye[0])].apply(Oe,Ye[3]):Oe=pe.length==1&&sj(pe)?Oe[We]():Oe.thru(pe)}return function(){var It=arguments,kt=It[0];if(Oe&&It.length==1&&Or(kt))return Oe.plant(kt).value();for(var Nt=0,vn=F?P[Nt].apply(this,It):kt;++Nt<F;)vn=P[Nt].call(this,vn);return vn}})}function DR(_,P,F,q,re,pe,Oe,We,Ye,It){var kt=P&I,Nt=P&m,vn=P&v,Bn=P&(S|E),gr=P&D,Wr=vn?t:HE(_);function mr(){for(var ai=arguments.length,yi=dt(ai),id=ai;id--;)yi[id]=arguments[id];if(Bn)var $l=A_(mr),od=UHe(yi,$l);if(q&&(yi=Tae(yi,q,re,Bn)),pe&&(yi=Dae(yi,pe,Oe,Bn)),ai-=od,Bn&&ai<It){var Ks=Lv(yi,$l);return Fae(_,P,DR,mr.placeholder,F,yi,Ks,We,Ye,It-ai)}var nf=Nt?F:this,Xg=vn?nf[_]:_;return ai=yi.length,We?yi=Xze(yi,We):gr&&ai>1&&yi.reverse(),kt&&Ye<ai&&(yi.length=Ye),this&&this!==vi&&this instanceof mr&&(Xg=Wr||HE(Xg)),Xg.apply(nf,yi)}return mr}function Lae(_,P){return function(F,q){return ize(F,_,P(q),{})}}function RR(_,P){return function(F,q){var re;if(F===t&&q===t)return P;if(F!==t&&(re=F),q!==t){if(re===t)return q;typeof F=="string"||typeof q=="string"?(F=nd(F),q=nd(q)):(F=_ae(F),q=_ae(q)),re=_(F,q)}return re}}function J9(_){return qg(function(P){return P=is(P,td(ur())),Xr(function(F){var q=this;return _(P,function(re){return Wa(re,q,F)})})})}function AR(_,P){P=P===t?" ":nd(P);var F=P.length;if(F<2)return F?W9(P,_):P;var q=W9(P,yR(_/x_(P)));return C_(P)?Hv(Qh(q),0,_).join(""):q.slice(0,_)}function Rze(_,P,F,q){var re=P&m,pe=HE(_);function Oe(){for(var We=-1,Ye=arguments.length,It=-1,kt=q.length,Nt=dt(kt+Ye),vn=this&&this!==vi&&this instanceof Oe?pe:_;++It<kt;)Nt[It]=q[It];for(;Ye--;)Nt[It++]=arguments[++We];return Wa(vn,re?F:this,Nt)}return Oe}function Nae(_){return function(P,F,q){return q&&typeof q!="number"&&Ml(P,F,q)&&(F=q=t),P=Zg(P),F===t?(F=P,P=0):F=Zg(F),q=q===t?P<F?1:-1:Zg(q),mze(P,F,q,_)}}function OR(_){return function(P,F){return typeof P=="string"&&typeof F=="string"||(P=sh(P),F=sh(F)),_(P,F)}}function Fae(_,P,F,q,re,pe,Oe,We,Ye,It){var kt=P&S,Nt=kt?Oe:t,vn=kt?t:Oe,Bn=kt?pe:t,gr=kt?t:pe;P|=kt?w:C,P&=~(kt?C:w),P&b||(P&=~(m|v));var Wr=[_,P,re,Bn,Nt,gr,vn,We,Ye,It],mr=F.apply(t,Wr);return sj(_)&&Xae(mr,Wr),mr.placeholder=q,Yae(mr,_,P)}function Q9(_){var P=xa[_];return function(F,q){if(F=sh(F),q=q==null?0:tl(Br(q),292),q&&Yse(F)){var re=(zi(F)+"e").split("e"),pe=P(re[0]+"e"+(+re[1]+q));return re=(zi(pe)+"e").split("e"),+(re[0]+"e"+(+re[1]-q))}return P(F)}}var Aze=P_&&1/cR(new P_([,-0]))[1]==N?function(_){return new P_(_)}:_j;function jae(_){return function(P){var F=nl(P);return F==V?T9(P):F==Ie?ZHe(P):HHe(P,_(P))}}function Wg(_,P,F,q,re,pe,Oe,We){var Ye=P&v;if(!Ye&&typeof _!="function")throw new th(s);var It=q?q.length:0;if(It||(P&=~(w|C),q=re=t),Oe=Oe===t?Oe:Ea(Br(Oe),0),We=We===t?We:Br(We),It-=re?re.length:0,P&C){var kt=q,Nt=re;q=re=t}var vn=Ye?t:nj(_),Bn=[_,P,F,q,re,kt,Nt,pe,Oe,We];if(vn&&Kze(Bn,vn),_=Bn[0],P=Bn[1],F=Bn[2],q=Bn[3],re=Bn[4],We=Bn[9]=Bn[9]===t?Ye?0:_.length:Ea(Bn[9]-It,0),!We&&P&(S|E)&&(P&=~(S|E)),!P||P==m)var gr=Tze(_,P,F);else P==S||P==E?gr=Dze(_,P,We):(P==w||P==(m|w))&&!re.length?gr=Rze(_,P,F,q):gr=DR.apply(t,Bn);var Wr=vn?bae:Xae;return Yae(Wr(gr,Bn),_,P)}function Bae(_,P,F,q){return _===t||tf(_,I_[F])&&!eo.call(q,F)?P:_}function Hae(_,P,F,q,re,pe){return vs(_)&&vs(P)&&(pe.set(P,_),IR(_,P,t,Hae,pe),pe.delete(P)),_}function Oze(_){return VE(_)?t:_}function Uae(_,P,F,q,re,pe){var Oe=F&p,We=_.length,Ye=P.length;if(We!=Ye&&!(Oe&&Ye>We))return!1;var It=pe.get(_),kt=pe.get(P);if(It&&kt)return It==P&&kt==_;var Nt=-1,vn=!0,Bn=F&g?new lb:t;for(pe.set(_,P),pe.set(P,_);++Nt<We;){var gr=_[Nt],Wr=P[Nt];if(q)var mr=Oe?q(Wr,gr,Nt,P,_,pe):q(gr,Wr,Nt,_,P,pe);if(mr!==t){if(mr)continue;vn=!1;break}if(Bn){if(!C9(P,function(ai,yi){if(!DE(Bn,yi)&&(gr===ai||re(gr,ai,F,q,pe)))return Bn.push(yi)})){vn=!1;break}}else if(!(gr===Wr||re(gr,Wr,F,q,pe))){vn=!1;break}}return pe.delete(_),pe.delete(P),vn}function Mze(_,P,F,q,re,pe,Oe){switch(F){case Ge:if(_.byteLength!=P.byteLength||_.byteOffset!=P.byteOffset)return!1;_=_.buffer,P=P.buffer;case qe:return!(_.byteLength!=P.byteLength||!pe(new pR(_),new pR(P)));case Se:case se:case le:return tf(+_,+P);case Y:return _.name==P.name&&_.message==P.message;case Ae:case be:return _==P+"";case V:var We=T9;case Ie:var Ye=q&p;if(We||(We=cR),_.size!=P.size&&!Ye)return!1;var It=Oe.get(_);if(It)return It==P;q|=g,Oe.set(_,P);var kt=Uae(We(_),We(P),q,re,pe,Oe);return Oe.delete(_),kt;case De:if($E)return $E.call(_)==$E.call(P)}return!1}function $ze(_,P,F,q,re,pe){var Oe=F&p,We=ej(_),Ye=We.length,It=ej(P),kt=It.length;if(Ye!=kt&&!Oe)return!1;for(var Nt=Ye;Nt--;){var vn=We[Nt];if(!(Oe?vn in P:eo.call(P,vn)))return!1}var Bn=pe.get(_),gr=pe.get(P);if(Bn&&gr)return Bn==P&&gr==_;var Wr=!0;pe.set(_,P),pe.set(P,_);for(var mr=Oe;++Nt<Ye;){vn=We[Nt];var ai=_[vn],yi=P[vn];if(q)var id=Oe?q(yi,ai,vn,P,_,pe):q(ai,yi,vn,_,P,pe);if(!(id===t?ai===yi||re(ai,yi,F,q,pe):id)){Wr=!1;break}mr||(mr=vn=="constructor")}if(Wr&&!mr){var $l=_.constructor,od=P.constructor;$l!=od&&"constructor"in _&&"constructor"in P&&!(typeof $l=="function"&&$l instanceof $l&&typeof od=="function"&&od instanceof od)&&(Wr=!1)}return pe.delete(_),pe.delete(P),Wr}function qg(_){return cj(Gae(_,t,rce),_+"")}function ej(_){return cae(_,qa,ij)}function tj(_){return cae(_,fu,zae)}var nj=SR?function(_){return SR.get(_)}:_j;function MR(_){for(var P=_.name+"",F=k_[P],q=eo.call(k_,P)?F.length:0;q--;){var re=F[q],pe=re.func;if(pe==null||pe==_)return re.name}return P}function A_(_){var P=eo.call(de,"placeholder")?de:_;return P.placeholder}function ur(){var _=de.iteratee||bj;return _=_===bj?dae:_,arguments.length?_(arguments[0],arguments[1]):_}function $R(_,P){var F=_.__data__;return zze(P)?F[typeof P=="string"?"string":"hash"]:F.map}function rj(_){for(var P=qa(_),F=P.length;F--;){var q=P[F],re=_[q];P[F]=[q,re,qae(re)]}return P}function hb(_,P){var F=qHe(_,P);return uae(F)?F:t}function Lze(_){var P=eo.call(_,ab),F=_[ab];try{_[ab]=t;var q=!0}catch{}var re=hR.call(_);return q&&(P?_[ab]=F:delete _[ab]),re}var ij=R9?function(_){return _==null?[]:(_=So(_),Mv(R9(_),function(P){return Zse.call(_,P)}))}:wj,zae=R9?function(_){for(var P=[];_;)$v(P,ij(_)),_=gR(_);return P}:wj,nl=Ol;(A9&&nl(new A9(new ArrayBuffer(1)))!=Ge||AE&&nl(new AE)!=V||O9&&nl(O9.resolve())!=ne||P_&&nl(new P_)!=Ie||OE&&nl(new OE)!=He)&&(nl=function(_){var P=Ol(_),F=P==oe?_.constructor:t,q=F?fb(F):"";if(q)switch(q){case yUe:return Ge;case bUe:return V;case SUe:return ne;case _Ue:return Ie;case wUe:return He}return P});function Nze(_,P,F){for(var q=-1,re=F.length;++q<re;){var pe=F[q],Oe=pe.size;switch(pe.type){case"drop":_+=Oe;break;case"dropRight":P-=Oe;break;case"take":P=tl(P,_+Oe);break;case"takeRight":_=Ea(_,P-Oe);break}}return{start:_,end:P}}function Fze(_){var P=_.match(un);return P?P[1].split(qt):[]}function Vae(_,P,F){P=Bv(P,_);for(var q=-1,re=P.length,pe=!1;++q<re;){var Oe=mp(P[q]);if(!(pe=_!=null&&F(_,Oe)))break;_=_[Oe]}return pe||++q!=re?pe:(re=_==null?0:_.length,!!re&&UR(re)&&Kg(Oe,re)&&(Or(_)||pb(_)))}function jze(_){var P=_.length,F=new _.constructor(P);return P&&typeof _[0]=="string"&&eo.call(_,"index")&&(F.index=_.index,F.input=_.input),F}function Wae(_){return typeof _.constructor=="function"&&!UE(_)?T_(gR(_)):{}}function Bze(_,P,F){var q=_.constructor;switch(P){case qe:return Y9(_);case Se:case se:return new q(+_);case Ge:return Cze(_,F);case St:case Pt:case on:case an:case Rt:case Xt:case yn:case bn:case Kn:return Pae(_,F);case V:return new q;case le:case be:return new q(_);case Ae:return xze(_);case Ie:return new q;case De:return Eze(_)}}function Hze(_,P){var F=P.length;if(!F)return _;var q=F-1;return P[q]=(F>1?"& ":"")+P[q],P=P.join(F>2?", ":" "),_.replace(Wt,`{
/* [wrapped with `+P+`] */
`)}function Uze(_){return Or(_)||pb(_)||!!(Xse&&_&&_[Xse])}function Kg(_,P){var F=typeof _;return P=P??B,!!P&&(F=="number"||F!="symbol"&&W.test(_))&&_>-1&&_%1==0&&_<P}function Ml(_,P,F){if(!vs(F))return!1;var q=typeof P;return(q=="number"?hu(F)&&Kg(P,F.length):q=="string"&&P in F)?tf(F[P],_):!1}function oj(_,P){if(Or(_))return!1;var F=typeof _;return F=="number"||F=="symbol"||F=="boolean"||_==null||rd(_)?!0:Lt.test(_)||!at.test(_)||P!=null&&_ in So(P)}function zze(_){var P=typeof _;return P=="string"||P=="number"||P=="symbol"||P=="boolean"?_!=="__proto__":_===null}function sj(_){var P=MR(_),F=de[P];if(typeof F!="function"||!(P in li.prototype))return!1;if(_===F)return!0;var q=nj(F);return!!q&&_===q[0]}function Vze(_){return!!qse&&qse in _}var Wze=uR?Gg:Cj;function UE(_){var P=_&&_.constructor,F=typeof P=="function"&&P.prototype||I_;return _===F}function qae(_){return _===_&&!vs(_)}function Kae(_,P){return function(F){return F==null?!1:F[_]===P&&(P!==t||_ in So(F))}}function qze(_){var P=BR(_,function(q){return F.size===l&&F.clear(),q}),F=P.cache;return P}function Kze(_,P){var F=_[1],q=P[1],re=F|q,pe=re<(m|v|I),Oe=q==I&&F==S||q==I&&F==T&&_[7].length<=P[8]||q==(I|T)&&P[7].length<=P[8]&&F==S;if(!(pe||Oe))return _;q&m&&(_[2]=P[2],re|=F&m?0:b);var We=P[3];if(We){var Ye=_[3];_[3]=Ye?Tae(Ye,We,P[4]):We,_[4]=Ye?Lv(_[3],u):P[4]}return We=P[5],We&&(Ye=_[5],_[5]=Ye?Dae(Ye,We,P[6]):We,_[6]=Ye?Lv(_[5],u):P[6]),We=P[7],We&&(_[7]=We),q&I&&(_[8]=_[8]==null?P[8]:tl(_[8],P[8])),_[9]==null&&(_[9]=P[9]),_[0]=P[0],_[1]=re,_}function Gze(_){var P=[];if(_!=null)for(var F in So(_))P.push(F);return P}function Zze(_){return hR.call(_)}function Gae(_,P,F){return P=Ea(P===t?_.length-1:P,0),function(){for(var q=arguments,re=-1,pe=Ea(q.length-P,0),Oe=dt(pe);++re<pe;)Oe[re]=q[P+re];re=-1;for(var We=dt(P+1);++re<P;)We[re]=q[re];return We[P]=F(Oe),Wa(_,this,We)}}function Zae(_,P){return P.length<2?_:db(_,ih(P,0,-1))}function Xze(_,P){for(var F=_.length,q=tl(P.length,F),re=du(_);q--;){var pe=P[q];_[q]=Kg(pe,F)?re[pe]:t}return _}function aj(_,P){if(!(P==="constructor"&&typeof _[P]=="function")&&P!="__proto__")return _[P]}var Xae=Jae(bae),zE=dUe||function(_,P){return vi.setTimeout(_,P)},cj=Jae(bze);function Yae(_,P,F){var q=P+"";return cj(_,Hze(q,Yze(Fze(q),F)))}function Jae(_){var P=0,F=0;return function(){var q=gUe(),re=A-(q-F);if(F=q,re>0){if(++P>=R)return arguments[0]}else P=0;return _.apply(t,arguments)}}function LR(_,P){var F=-1,q=_.length,re=q-1;for(P=P===t?q:P;++F<P;){var pe=V9(F,re),Oe=_[pe];_[pe]=_[F],_[F]=Oe}return _.length=P,_}var Qae=qze(function(_){var P=[];return _.charCodeAt(0)===46&&P.push(""),_.replace(fn,function(F,q,re,pe){P.push(re?pe.replace(At,"$1"):q||F)}),P});function mp(_){if(typeof _=="string"||rd(_))return _;var P=_+"";return P=="0"&&1/_==-N?"-0":P}function fb(_){if(_!=null){try{return dR.call(_)}catch{}try{return _+""}catch{}}return""}function Yze(_,P){return eh(ie,function(F){var q="_."+F[0];P&F[1]&&!sR(_,q)&&_.push(q)}),_.sort()}function ece(_){if(_ instanceof li)return _.clone();var P=new nh(_.__wrapped__,_.__chain__);return P.__actions__=du(_.__actions__),P.__index__=_.__index__,P.__values__=_.__values__,P}function Jze(_,P,F){(F?Ml(_,P,F):P===t)?P=1:P=Ea(Br(P),0);var q=_==null?0:_.length;if(!q||P<1)return[];for(var re=0,pe=0,Oe=dt(yR(q/P));re<q;)Oe[pe++]=ih(_,re,re+=P);return Oe}function Qze(_){for(var P=-1,F=_==null?0:_.length,q=0,re=[];++P<F;){var pe=_[P];pe&&(re[q++]=pe)}return re}function eVe(){var _=arguments.length;if(!_)return[];for(var P=dt(_-1),F=arguments[0],q=_;q--;)P[q-1]=arguments[q];return $v(Or(F)?du(F):[F],wc(P,1))}var tVe=Xr(function(_,P){return qs(_)?NE(_,wc(P,1,qs,!0)):[]}),nVe=Xr(function(_,P){var F=oh(P);return qs(F)&&(F=t),qs(_)?NE(_,wc(P,1,qs,!0),ur(F,2)):[]}),rVe=Xr(function(_,P){var F=oh(P);return qs(F)&&(F=t),qs(_)?NE(_,wc(P,1,qs,!0),t,F):[]});function iVe(_,P,F){var q=_==null?0:_.length;return q?(P=F||P===t?1:Br(P),ih(_,P<0?0:P,q)):[]}function oVe(_,P,F){var q=_==null?0:_.length;return q?(P=F||P===t?1:Br(P),P=q-P,ih(_,0,P<0?0:P)):[]}function sVe(_,P){return _&&_.length?kR(_,ur(P,3),!0,!0):[]}function aVe(_,P){return _&&_.length?kR(_,ur(P,3),!0):[]}function cVe(_,P,F,q){var re=_==null?0:_.length;return re?(F&&typeof F!="number"&&Ml(_,P,F)&&(F=0,q=re),eze(_,P,F,q)):[]}function tce(_,P,F){var q=_==null?0:_.length;if(!q)return-1;var re=F==null?0:Br(F);return re<0&&(re=Ea(q+re,0)),aR(_,ur(P,3),re)}function nce(_,P,F){var q=_==null?0:_.length;if(!q)return-1;var re=q-1;return F!==t&&(re=Br(F),re=F<0?Ea(q+re,0):tl(re,q-1)),aR(_,ur(P,3),re,!0)}function rce(_){var P=_==null?0:_.length;return P?wc(_,1):[]}function lVe(_){var P=_==null?0:_.length;return P?wc(_,N):[]}function uVe(_,P){var F=_==null?0:_.length;return F?(P=P===t?1:Br(P),wc(_,P)):[]}function dVe(_){for(var P=-1,F=_==null?0:_.length,q={};++P<F;){var re=_[P];q[re[0]]=re[1]}return q}function ice(_){return _&&_.length?_[0]:t}function hVe(_,P,F){var q=_==null?0:_.length;if(!q)return-1;var re=F==null?0:Br(F);return re<0&&(re=Ea(q+re,0)),w_(_,P,re)}function fVe(_){var P=_==null?0:_.length;return P?ih(_,0,-1):[]}var pVe=Xr(function(_){var P=is(_,Z9);return P.length&&P[0]===_[0]?j9(P):[]}),gVe=Xr(function(_){var P=oh(_),F=is(_,Z9);return P===oh(F)?P=t:F.pop(),F.length&&F[0]===_[0]?j9(F,ur(P,2)):[]}),mVe=Xr(function(_){var P=oh(_),F=is(_,Z9);return P=typeof P=="function"?P:t,P&&F.pop(),F.length&&F[0]===_[0]?j9(F,t,P):[]});function vVe(_,P){return _==null?"":fUe.call(_,P)}function oh(_){var P=_==null?0:_.length;return P?_[P-1]:t}function yVe(_,P,F){var q=_==null?0:_.length;if(!q)return-1;var re=q;return F!==t&&(re=Br(F),re=re<0?Ea(q+re,0):tl(re,q-1)),P===P?YHe(_,P,re):aR(_,Fse,re,!0)}function bVe(_,P){return _&&_.length?gae(_,Br(P)):t}var SVe=Xr(oce);function oce(_,P){return _&&_.length&&P&&P.length?z9(_,P):_}function _Ve(_,P,F){return _&&_.length&&P&&P.length?z9(_,P,ur(F,2)):_}function wVe(_,P,F){return _&&_.length&&P&&P.length?z9(_,P,t,F):_}var CVe=qg(function(_,P){var F=_==null?0:_.length,q=$9(_,P);return yae(_,is(P,function(re){return Kg(re,F)?+re:re}).sort(kae)),q});function xVe(_,P){var F=[];if(!(_&&_.length))return F;var q=-1,re=[],pe=_.length;for(P=ur(P,3);++q<pe;){var Oe=_[q];P(Oe,q,_)&&(F.push(Oe),re.push(q))}return yae(_,re),F}function lj(_){return _==null?_:vUe.call(_)}function EVe(_,P,F){var q=_==null?0:_.length;return q?(F&&typeof F!="number"&&Ml(_,P,F)?(P=0,F=q):(P=P==null?0:Br(P),F=F===t?q:Br(F)),ih(_,P,F)):[]}function IVe(_,P){return PR(_,P)}function PVe(_,P,F){return q9(_,P,ur(F,2))}function kVe(_,P){var F=_==null?0:_.length;if(F){var q=PR(_,P);if(q<F&&tf(_[q],P))return q}return-1}function TVe(_,P){return PR(_,P,!0)}function DVe(_,P,F){return q9(_,P,ur(F,2),!0)}function RVe(_,P){var F=_==null?0:_.length;if(F){var q=PR(_,P,!0)-1;if(tf(_[q],P))return q}return-1}function AVe(_){return _&&_.length?Sae(_):[]}function OVe(_,P){return _&&_.length?Sae(_,ur(P,2)):[]}function MVe(_){var P=_==null?0:_.length;return P?ih(_,1,P):[]}function $Ve(_,P,F){return _&&_.length?(P=F||P===t?1:Br(P),ih(_,0,P<0?0:P)):[]}function LVe(_,P,F){var q=_==null?0:_.length;return q?(P=F||P===t?1:Br(P),P=q-P,ih(_,P<0?0:P,q)):[]}function NVe(_,P){return _&&_.length?kR(_,ur(P,3),!1,!0):[]}function FVe(_,P){return _&&_.length?kR(_,ur(P,3)):[]}var jVe=Xr(function(_){return jv(wc(_,1,qs,!0))}),BVe=Xr(function(_){var P=oh(_);return qs(P)&&(P=t),jv(wc(_,1,qs,!0),ur(P,2))}),HVe=Xr(function(_){var P=oh(_);return P=typeof P=="function"?P:t,jv(wc(_,1,qs,!0),t,P)});function UVe(_){return _&&_.length?jv(_):[]}function zVe(_,P){return _&&_.length?jv(_,ur(P,2)):[]}function VVe(_,P){return P=typeof P=="function"?P:t,_&&_.length?jv(_,t,P):[]}function uj(_){if(!(_&&_.length))return[];var P=0;return _=Mv(_,function(F){if(qs(F))return P=Ea(F.length,P),!0}),P9(P,function(F){return is(_,x9(F))})}function sce(_,P){if(!(_&&_.length))return[];var F=uj(_);return P==null?F:is(F,function(q){return Wa(P,t,q)})}var WVe=Xr(function(_,P){return qs(_)?NE(_,P):[]}),qVe=Xr(function(_){return G9(Mv(_,qs))}),KVe=Xr(function(_){var P=oh(_);return qs(P)&&(P=t),G9(Mv(_,qs),ur(P,2))}),GVe=Xr(function(_){var P=oh(_);return P=typeof P=="function"?P:t,G9(Mv(_,qs),t,P)}),ZVe=Xr(uj);function XVe(_,P){return xae(_||[],P||[],LE)}function YVe(_,P){return xae(_||[],P||[],BE)}var JVe=Xr(function(_){var P=_.length,F=P>1?_[P-1]:t;return F=typeof F=="function"?(_.pop(),F):t,sce(_,F)});function ace(_){var P=de(_);return P.__chain__=!0,P}function QVe(_,P){return P(_),_}function NR(_,P){return P(_)}var eWe=qg(function(_){var P=_.length,F=P?_[0]:0,q=this.__wrapped__,re=function(pe){return $9(pe,_)};return P>1||this.__actions__.length||!(q instanceof li)||!Kg(F)?this.thru(re):(q=q.slice(F,+F+(P?1:0)),q.__actions__.push({func:NR,args:[re],thisArg:t}),new nh(q,this.__chain__).thru(function(pe){return P&&!pe.length&&pe.push(t),pe}))});function tWe(){return ace(this)}function nWe(){return new nh(this.value(),this.__chain__)}function rWe(){this.__values__===t&&(this.__values__=_ce(this.value()));var _=this.__index__>=this.__values__.length,P=_?t:this.__values__[this.__index__++];return{done:_,value:P}}function iWe(){return this}function oWe(_){for(var P,F=this;F instanceof wR;){var q=ece(F);q.__index__=0,q.__values__=t,P?re.__wrapped__=q:P=q;var re=q;F=F.__wrapped__}return re.__wrapped__=_,P}function sWe(){var _=this.__wrapped__;if(_ instanceof li){var P=_;return this.__actions__.length&&(P=new li(this)),P=P.reverse(),P.__actions__.push({func:NR,args:[lj],thisArg:t}),new nh(P,this.__chain__)}return this.thru(lj)}function aWe(){return Cae(this.__wrapped__,this.__actions__)}var cWe=TR(function(_,P,F){eo.call(_,F)?++_[F]:Vg(_,F,1)});function lWe(_,P,F){var q=Or(_)?Lse:QUe;return F&&Ml(_,P,F)&&(P=t),q(_,ur(P,3))}function uWe(_,P){var F=Or(_)?Mv:sae;return F(_,ur(P,3))}var dWe=Mae(tce),hWe=Mae(nce);function fWe(_,P){return wc(FR(_,P),1)}function pWe(_,P){return wc(FR(_,P),N)}function gWe(_,P,F){return F=F===t?1:Br(F),wc(FR(_,P),F)}function cce(_,P){var F=Or(_)?eh:Fv;return F(_,ur(P,3))}function lce(_,P){var F=Or(_)?MHe:oae;return F(_,ur(P,3))}var mWe=TR(function(_,P,F){eo.call(_,F)?_[F].push(P):Vg(_,F,[P])});function vWe(_,P,F,q){_=hu(_)?_:M_(_),F=F&&!q?Br(F):0;var re=_.length;return F<0&&(F=Ea(re+F,0)),zR(_)?F<=re&&_.indexOf(P,F)>-1:!!re&&w_(_,P,F)>-1}var yWe=Xr(function(_,P,F){var q=-1,re=typeof P=="function",pe=hu(_)?dt(_.length):[];return Fv(_,function(Oe){pe[++q]=re?Wa(P,Oe,F):FE(Oe,P,F)}),pe}),bWe=TR(function(_,P,F){Vg(_,F,P)});function FR(_,P){var F=Or(_)?is:hae;return F(_,ur(P,3))}function SWe(_,P,F,q){return _==null?[]:(Or(P)||(P=P==null?[]:[P]),F=q?t:F,Or(F)||(F=F==null?[]:[F]),mae(_,P,F))}var _We=TR(function(_,P,F){_[F?0:1].push(P)},function(){return[[],[]]});function wWe(_,P,F){var q=Or(_)?w9:Bse,re=arguments.length<3;return q(_,ur(P,4),F,re,Fv)}function CWe(_,P,F){var q=Or(_)?$He:Bse,re=arguments.length<3;return q(_,ur(P,4),F,re,oae)}function xWe(_,P){var F=Or(_)?Mv:sae;return F(_,HR(ur(P,3)))}function EWe(_){var P=Or(_)?tae:vze;return P(_)}function IWe(_,P,F){(F?Ml(_,P,F):P===t)?P=1:P=Br(P);var q=Or(_)?GUe:yze;return q(_,P)}function PWe(_){var P=Or(_)?ZUe:Sze;return P(_)}function kWe(_){if(_==null)return 0;if(hu(_))return zR(_)?x_(_):_.length;var P=nl(_);return P==V||P==Ie?_.size:H9(_).length}function TWe(_,P,F){var q=Or(_)?C9:_ze;return F&&Ml(_,P,F)&&(P=t),q(_,ur(P,3))}var DWe=Xr(function(_,P){if(_==null)return[];var F=P.length;return F>1&&Ml(_,P[0],P[1])?P=[]:F>2&&Ml(P[0],P[1],P[2])&&(P=[P[0]]),mae(_,wc(P,1),[])}),jR=uUe||function(){return vi.Date.now()};function RWe(_,P){if(typeof P!="function")throw new th(s);return _=Br(_),function(){if(--_<1)return P.apply(this,arguments)}}function uce(_,P,F){return P=F?t:P,P=_&&P==null?_.length:P,Wg(_,I,t,t,t,t,P)}function dce(_,P){var F;if(typeof P!="function")throw new th(s);return _=Br(_),function(){return--_>0&&(F=P.apply(this,arguments)),_<=1&&(P=t),F}}var dj=Xr(function(_,P,F){var q=m;if(F.length){var re=Lv(F,A_(dj));q|=w}return Wg(_,q,P,F,re)}),hce=Xr(function(_,P,F){var q=m|v;if(F.length){var re=Lv(F,A_(hce));q|=w}return Wg(P,q,_,F,re)});function fce(_,P,F){P=F?t:P;var q=Wg(_,S,t,t,t,t,t,P);return q.placeholder=fce.placeholder,q}function pce(_,P,F){P=F?t:P;var q=Wg(_,E,t,t,t,t,t,P);return q.placeholder=pce.placeholder,q}function gce(_,P,F){var q,re,pe,Oe,We,Ye,It=0,kt=!1,Nt=!1,vn=!0;if(typeof _!="function")throw new th(s);P=sh(P)||0,vs(F)&&(kt=!!F.leading,Nt="maxWait"in F,pe=Nt?Ea(sh(F.maxWait)||0,P):pe,vn="trailing"in F?!!F.trailing:vn);function Bn(Ks){var nf=q,Xg=re;return q=re=t,It=Ks,Oe=_.apply(Xg,nf),Oe}function gr(Ks){return It=Ks,We=zE(ai,P),kt?Bn(Ks):Oe}function Wr(Ks){var nf=Ks-Ye,Xg=Ks-It,Mce=P-nf;return Nt?tl(Mce,pe-Xg):Mce}function mr(Ks){var nf=Ks-Ye,Xg=Ks-It;return Ye===t||nf>=P||nf<0||Nt&&Xg>=pe}function ai(){var Ks=jR();if(mr(Ks))return yi(Ks);We=zE(ai,Wr(Ks))}function yi(Ks){return We=t,vn&&q?Bn(Ks):(q=re=t,Oe)}function id(){We!==t&&Eae(We),It=0,q=Ye=re=We=t}function $l(){return We===t?Oe:yi(jR())}function od(){var Ks=jR(),nf=mr(Ks);if(q=arguments,re=this,Ye=Ks,nf){if(We===t)return gr(Ye);if(Nt)return Eae(We),We=zE(ai,P),Bn(Ye)}return We===t&&(We=zE(ai,P)),Oe}return od.cancel=id,od.flush=$l,od}var AWe=Xr(function(_,P){return iae(_,1,P)}),OWe=Xr(function(_,P,F){return iae(_,sh(P)||0,F)});function MWe(_){return Wg(_,D)}function BR(_,P){if(typeof _!="function"||P!=null&&typeof P!="function")throw new th(s);var F=function(){var q=arguments,re=P?P.apply(this,q):q[0],pe=F.cache;if(pe.has(re))return pe.get(re);var Oe=_.apply(this,q);return F.cache=pe.set(re,Oe)||pe,Oe};return F.cache=new(BR.Cache||zg),F}BR.Cache=zg;function HR(_){if(typeof _!="function")throw new th(s);return function(){var P=arguments;switch(P.length){case 0:return!_.call(this);case 1:return!_.call(this,P[0]);case 2:return!_.call(this,P[0],P[1]);case 3:return!_.call(this,P[0],P[1],P[2])}return!_.apply(this,P)}}function $We(_){return dce(2,_)}var LWe=wze(function(_,P){P=P.length==1&&Or(P[0])?is(P[0],td(ur())):is(wc(P,1),td(ur()));var F=P.length;return Xr(function(q){for(var re=-1,pe=tl(q.length,F);++re<pe;)q[re]=P[re].call(this,q[re]);return Wa(_,this,q)})}),hj=Xr(function(_,P){var F=Lv(P,A_(hj));return Wg(_,w,t,P,F)}),mce=Xr(function(_,P){var F=Lv(P,A_(mce));return Wg(_,C,t,P,F)}),NWe=qg(function(_,P){return Wg(_,T,t,t,t,P)});function FWe(_,P){if(typeof _!="function")throw new th(s);return P=P===t?P:Br(P),Xr(_,P)}function jWe(_,P){if(typeof _!="function")throw new th(s);return P=P==null?0:Ea(Br(P),0),Xr(function(F){var q=F[P],re=Hv(F,0,P);return q&&$v(re,q),Wa(_,this,re)})}function BWe(_,P,F){var q=!0,re=!0;if(typeof _!="function")throw new th(s);return vs(F)&&(q="leading"in F?!!F.leading:q,re="trailing"in F?!!F.trailing:re),gce(_,P,{leading:q,maxWait:P,trailing:re})}function HWe(_){return uce(_,1)}function UWe(_,P){return hj(X9(P),_)}function zWe(){if(!arguments.length)return[];var _=arguments[0];return Or(_)?_:[_]}function VWe(_){return rh(_,f)}function WWe(_,P){return P=typeof P=="function"?P:t,rh(_,f,P)}function qWe(_){return rh(_,d|f)}function KWe(_,P){return P=typeof P=="function"?P:t,rh(_,d|f,P)}function GWe(_,P){return P==null||rae(_,P,qa(P))}function tf(_,P){return _===P||_!==_&&P!==P}var ZWe=OR(F9),XWe=OR(function(_,P){return _>=P}),pb=lae(function(){return arguments}())?lae:function(_){return Ts(_)&&eo.call(_,"callee")&&!Zse.call(_,"callee")},Or=dt.isArray,YWe=Al?td(Al):oze;function hu(_){return _!=null&&UR(_.length)&&!Gg(_)}function qs(_){return Ts(_)&&hu(_)}function JWe(_){return _===!0||_===!1||Ts(_)&&Ol(_)==Se}var Uv=hUe||Cj,QWe=Jh?td(Jh):sze;function eqe(_){return Ts(_)&&_.nodeType===1&&!VE(_)}function tqe(_){if(_==null)return!0;if(hu(_)&&(Or(_)||typeof _=="string"||typeof _.splice=="function"||Uv(_)||O_(_)||pb(_)))return!_.length;var P=nl(_);if(P==V||P==Ie)return!_.size;if(UE(_))return!H9(_).length;for(var F in _)if(eo.call(_,F))return!1;return!0}function nqe(_,P){return jE(_,P)}function rqe(_,P,F){F=typeof F=="function"?F:t;var q=F?F(_,P):t;return q===t?jE(_,P,t,F):!!q}function fj(_){if(!Ts(_))return!1;var P=Ol(_);return P==Y||P==ee||typeof _.message=="string"&&typeof _.name=="string"&&!VE(_)}function iqe(_){return typeof _=="number"&&Yse(_)}function Gg(_){if(!vs(_))return!1;var P=Ol(_);return P==ue||P==ye||P==_e||P==ce}function vce(_){return typeof _=="number"&&_==Br(_)}function UR(_){return typeof _=="number"&&_>-1&&_%1==0&&_<=B}function vs(_){var P=typeof _;return _!=null&&(P=="object"||P=="function")}function Ts(_){return _!=null&&typeof _=="object"}var yce=Qd?td(Qd):cze;function oqe(_,P){return _===P||B9(_,P,rj(P))}function sqe(_,P,F){return F=typeof F=="function"?F:t,B9(_,P,rj(P),F)}function aqe(_){return bce(_)&&_!=+_}function cqe(_){if(Wze(_))throw new kr(o);return uae(_)}function lqe(_){return _===null}function uqe(_){return _==null}function bce(_){return typeof _=="number"||Ts(_)&&Ol(_)==le}function VE(_){if(!Ts(_)||Ol(_)!=oe)return!1;var P=gR(_);if(P===null)return!0;var F=eo.call(P,"constructor")&&P.constructor;return typeof F=="function"&&F instanceof F&&dR.call(F)==sUe}var pj=fp?td(fp):lze;function dqe(_){return vce(_)&&_>=-B&&_<=B}var Sce=TE?td(TE):uze;function zR(_){return typeof _=="string"||!Or(_)&&Ts(_)&&Ol(_)==be}function rd(_){return typeof _=="symbol"||Ts(_)&&Ol(_)==De}var O_=sb?td(sb):dze;function hqe(_){return _===t}function fqe(_){return Ts(_)&&nl(_)==He}function pqe(_){return Ts(_)&&Ol(_)==Je}var gqe=OR(U9),mqe=OR(function(_,P){return _<=P});function _ce(_){if(!_)return[];if(hu(_))return zR(_)?Qh(_):du(_);if(RE&&_[RE])return GHe(_[RE]());var P=nl(_),F=P==V?T9:P==Ie?cR:M_;return F(_)}function Zg(_){if(!_)return _===0?_:0;if(_=sh(_),_===N||_===-N){var P=_<0?-1:1;return P*U}return _===_?_:0}function Br(_){var P=Zg(_),F=P%1;return P===P?F?P-F:P:0}function wce(_){return _?ub(Br(_),0,z):0}function sh(_){if(typeof _=="number")return _;if(rd(_))return K;if(vs(_)){var P=typeof _.valueOf=="function"?_.valueOf():_;_=vs(P)?P+"":P}if(typeof _!="string")return _===0?_:+_;_=Hse(_);var F=Zn.test(_);return F||ve.test(_)?Ar(_.slice(2),F?2:8):jn.test(_)?K:+_}function Cce(_){return gp(_,fu(_))}function vqe(_){return _?ub(Br(_),-B,B):_===0?_:0}function zi(_){return _==null?"":nd(_)}var yqe=D_(function(_,P){if(UE(P)||hu(P)){gp(P,qa(P),_);return}for(var F in P)eo.call(P,F)&&LE(_,F,P[F])}),xce=D_(function(_,P){gp(P,fu(P),_)}),VR=D_(function(_,P,F,q){gp(P,fu(P),_,q)}),bqe=D_(function(_,P,F,q){gp(P,qa(P),_,q)}),Sqe=qg($9);function _qe(_,P){var F=T_(_);return P==null?F:nae(F,P)}var wqe=Xr(function(_,P){_=So(_);var F=-1,q=P.length,re=q>2?P[2]:t;for(re&&Ml(P[0],P[1],re)&&(q=1);++F<q;)for(var pe=P[F],Oe=fu(pe),We=-1,Ye=Oe.length;++We<Ye;){var It=Oe[We],kt=_[It];(kt===t||tf(kt,I_[It])&&!eo.call(_,It))&&(_[It]=pe[It])}return _}),Cqe=Xr(function(_){return _.push(t,Hae),Wa(Ece,t,_)});function xqe(_,P){return Nse(_,ur(P,3),pp)}function Eqe(_,P){return Nse(_,ur(P,3),N9)}function Iqe(_,P){return _==null?_:L9(_,ur(P,3),fu)}function Pqe(_,P){return _==null?_:aae(_,ur(P,3),fu)}function kqe(_,P){return _&&pp(_,ur(P,3))}function Tqe(_,P){return _&&N9(_,ur(P,3))}function Dqe(_){return _==null?[]:ER(_,qa(_))}function Rqe(_){return _==null?[]:ER(_,fu(_))}function gj(_,P,F){var q=_==null?t:db(_,P);return q===t?F:q}function Aqe(_,P){return _!=null&&Vae(_,P,tze)}function mj(_,P){return _!=null&&Vae(_,P,nze)}var Oqe=Lae(function(_,P,F){P!=null&&typeof P.toString!="function"&&(P=hR.call(P)),_[P]=F},yj(pu)),Mqe=Lae(function(_,P,F){P!=null&&typeof P.toString!="function"&&(P=hR.call(P)),eo.call(_,P)?_[P].push(F):_[P]=[F]},ur),$qe=Xr(FE);function qa(_){return hu(_)?eae(_):H9(_)}function fu(_){return hu(_)?eae(_,!0):hze(_)}function Lqe(_,P){var F={};return P=ur(P,3),pp(_,function(q,re,pe){Vg(F,P(q,re,pe),q)}),F}function Nqe(_,P){var F={};return P=ur(P,3),pp(_,function(q,re,pe){Vg(F,re,P(q,re,pe))}),F}var Fqe=D_(function(_,P,F){IR(_,P,F)}),Ece=D_(function(_,P,F,q){IR(_,P,F,q)}),jqe=qg(function(_,P){var F={};if(_==null)return F;var q=!1;P=is(P,function(pe){return pe=Bv(pe,_),q||(q=pe.length>1),pe}),gp(_,tj(_),F),q&&(F=rh(F,d|h|f,Oze));for(var re=P.length;re--;)K9(F,P[re]);return F});function Bqe(_,P){return Ice(_,HR(ur(P)))}var Hqe=qg(function(_,P){return _==null?{}:pze(_,P)});function Ice(_,P){if(_==null)return{};var F=is(tj(_),function(q){return[q]});return P=ur(P),vae(_,F,function(q,re){return P(q,re[0])})}function Uqe(_,P,F){P=Bv(P,_);var q=-1,re=P.length;for(re||(re=1,_=t);++q<re;){var pe=_==null?t:_[mp(P[q])];pe===t&&(q=re,pe=F),_=Gg(pe)?pe.call(_):pe}return _}function zqe(_,P,F){return _==null?_:BE(_,P,F)}function Vqe(_,P,F,q){return q=typeof q=="function"?q:t,_==null?_:BE(_,P,F,q)}var Pce=jae(qa),kce=jae(fu);function Wqe(_,P,F){var q=Or(_),re=q||Uv(_)||O_(_);if(P=ur(P,4),F==null){var pe=_&&_.constructor;re?F=q?new pe:[]:vs(_)?F=Gg(pe)?T_(gR(_)):{}:F={}}return(re?eh:pp)(_,function(Oe,We,Ye){return P(F,Oe,We,Ye)}),F}function qqe(_,P){return _==null?!0:K9(_,P)}function Kqe(_,P,F){return _==null?_:wae(_,P,X9(F))}function Gqe(_,P,F,q){return q=typeof q=="function"?q:t,_==null?_:wae(_,P,X9(F),q)}function M_(_){return _==null?[]:k9(_,qa(_))}function Zqe(_){return _==null?[]:k9(_,fu(_))}function Xqe(_,P,F){return F===t&&(F=P,P=t),F!==t&&(F=sh(F),F=F===F?F:0),P!==t&&(P=sh(P),P=P===P?P:0),ub(sh(_),P,F)}function Yqe(_,P,F){return P=Zg(P),F===t?(F=P,P=0):F=Zg(F),_=sh(_),rze(_,P,F)}function Jqe(_,P,F){if(F&&typeof F!="boolean"&&Ml(_,P,F)&&(P=F=t),F===t&&(typeof P=="boolean"?(F=P,P=t):typeof _=="boolean"&&(F=_,_=t)),_===t&&P===t?(_=0,P=1):(_=Zg(_),P===t?(P=_,_=0):P=Zg(P)),_>P){var q=_;_=P,P=q}if(F||_%1||P%1){var re=Jse();return tl(_+re*(P-_+yo("1e-"+((re+"").length-1))),P)}return V9(_,P)}var Qqe=R_(function(_,P,F){return P=P.toLowerCase(),_+(F?Tce(P):P)});function Tce(_){return vj(zi(_).toLowerCase())}function Dce(_){return _=zi(_),_&&_.replace(X,zHe).replace(Nn,"")}function eKe(_,P,F){_=zi(_),P=nd(P);var q=_.length;F=F===t?q:ub(Br(F),0,q);var re=F;return F-=P.length,F>=0&&_.slice(F,re)==P}function tKe(_){return _=zi(_),_&&Gn.test(_)?_.replace(ke,VHe):_}function nKe(_){return _=zi(_),_&&Ut.test(_)?_.replace(hn,"\\$&"):_}var rKe=R_(function(_,P,F){return _+(F?"-":"")+P.toLowerCase()}),iKe=R_(function(_,P,F){return _+(F?" ":"")+P.toLowerCase()}),oKe=Oae("toLowerCase");function sKe(_,P,F){_=zi(_),P=Br(P);var q=P?x_(_):0;if(!P||q>=P)return _;var re=(P-q)/2;return AR(bR(re),F)+_+AR(yR(re),F)}function aKe(_,P,F){_=zi(_),P=Br(P);var q=P?x_(_):0;return P&&q<P?_+AR(P-q,F):_}function cKe(_,P,F){_=zi(_),P=Br(P);var q=P?x_(_):0;return P&&q<P?AR(P-q,F)+_:_}function lKe(_,P,F){return F||P==null?P=0:P&&(P=+P),mUe(zi(_).replace(sn,""),P||0)}function uKe(_,P,F){return(F?Ml(_,P,F):P===t)?P=1:P=Br(P),W9(zi(_),P)}function dKe(){var _=arguments,P=zi(_[0]);return _.length<3?P:P.replace(_[1],_[2])}var hKe=R_(function(_,P,F){return _+(F?"_":"")+P.toLowerCase()});function fKe(_,P,F){return F&&typeof F!="number"&&Ml(_,P,F)&&(P=F=t),F=F===t?z:F>>>0,F?(_=zi(_),_&&(typeof P=="string"||P!=null&&!pj(P))&&(P=nd(P),!P&&C_(_))?Hv(Qh(_),0,F):_.split(P,F)):[]}var pKe=R_(function(_,P,F){return _+(F?" ":"")+vj(P)});function gKe(_,P,F){return _=zi(_),F=F==null?0:ub(Br(F),0,_.length),P=nd(P),_.slice(F,F+P.length)==P}function mKe(_,P,F){var q=de.templateSettings;F&&Ml(_,P,F)&&(P=t),_=zi(_),P=VR({},P,q,Bae);var re=VR({},P.imports,q.imports,Bae),pe=qa(re),Oe=k9(re,pe),We,Ye,It=0,kt=P.interpolate||fe,Nt="__p += '",vn=D9((P.escape||fe).source+"|"+kt.source+"|"+(kt===it?$t:fe).source+"|"+(P.evaluate||fe).source+"|$","g"),Bn="//# sourceURL="+(eo.call(P,"sourceURL")?(P.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++ob+"]")+`
`;_.replace(vn,function(mr,ai,yi,id,$l,od){return yi||(yi=id),Nt+=_.slice(It,od).replace(xt,WHe),ai&&(We=!0,Nt+=`' +
__e(`+ai+`) +
'`),$l&&(Ye=!0,Nt+=`';
`+$l+`;
__p += '`),yi&&(Nt+=`' +
((__t = (`+yi+`)) == null ? '' : __t) +
'`),It=od+mr.length,mr}),Nt+=`';
`;var gr=eo.call(P,"variable")&&P.variable;if(!gr)Nt=`with (obj) {
`+Nt+`
}
`;else if(ct.test(gr))throw new kr(a);Nt=(Ye?Nt.replace(lr,""):Nt).replace(Rr,"$1").replace(Lr,"$1;"),Nt="function("+(gr||"obj")+`) {
`+(gr?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(We?", __e = _.escape":"")+(Ye?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Nt+`return __p
}`;var Wr=Ace(function(){return Fi(pe,Bn+"return "+Nt).apply(t,Oe)});if(Wr.source=Nt,fj(Wr))throw Wr;return Wr}function vKe(_){return zi(_).toLowerCase()}function yKe(_){return zi(_).toUpperCase()}function bKe(_,P,F){if(_=zi(_),_&&(F||P===t))return Hse(_);if(!_||!(P=nd(P)))return _;var q=Qh(_),re=Qh(P),pe=Use(q,re),Oe=zse(q,re)+1;return Hv(q,pe,Oe).join("")}function SKe(_,P,F){if(_=zi(_),_&&(F||P===t))return _.slice(0,Wse(_)+1);if(!_||!(P=nd(P)))return _;var q=Qh(_),re=zse(q,Qh(P))+1;return Hv(q,0,re).join("")}function _Ke(_,P,F){if(_=zi(_),_&&(F||P===t))return _.replace(sn,"");if(!_||!(P=nd(P)))return _;var q=Qh(_),re=Use(q,Qh(P));return Hv(q,re).join("")}function wKe(_,P){var F=O,q=M;if(vs(P)){var re="separator"in P?P.separator:re;F="length"in P?Br(P.length):F,q="omission"in P?nd(P.omission):q}_=zi(_);var pe=_.length;if(C_(_)){var Oe=Qh(_);pe=Oe.length}if(F>=pe)return _;var We=F-x_(q);if(We<1)return q;var Ye=Oe?Hv(Oe,0,We).join(""):_.slice(0,We);if(re===t)return Ye+q;if(Oe&&(We+=Ye.length-We),pj(re)){if(_.slice(We).search(re)){var It,kt=Ye;for(re.global||(re=D9(re.source,zi(_n.exec(re))+"g")),re.lastIndex=0;It=re.exec(kt);)var Nt=It.index;Ye=Ye.slice(0,Nt===t?We:Nt)}}else if(_.indexOf(nd(re),We)!=We){var vn=Ye.lastIndexOf(re);vn>-1&&(Ye=Ye.slice(0,vn))}return Ye+q}function CKe(_){return _=zi(_),_&&Qn.test(_)?_.replace(er,JHe):_}var xKe=R_(function(_,P,F){return _+(F?" ":"")+P.toUpperCase()}),vj=Oae("toUpperCase");function Rce(_,P,F){return _=zi(_),P=F?t:P,P===t?KHe(_)?tUe(_):FHe(_):_.match(P)||[]}var Ace=Xr(function(_,P){try{return Wa(_,t,P)}catch(F){return fj(F)?F:new kr(F)}}),EKe=qg(function(_,P){return eh(P,function(F){F=mp(F),Vg(_,F,dj(_[F],_))}),_});function IKe(_){var P=_==null?0:_.length,F=ur();return _=P?is(_,function(q){if(typeof q[1]!="function")throw new th(s);return[F(q[0]),q[1]]}):[],Xr(function(q){for(var re=-1;++re<P;){var pe=_[re];if(Wa(pe[0],this,q))return Wa(pe[1],this,q)}})}function PKe(_){return JUe(rh(_,d))}function yj(_){return function(){return _}}function kKe(_,P){return _==null||_!==_?P:_}var TKe=$ae(),DKe=$ae(!0);function pu(_){return _}function bj(_){return dae(typeof _=="function"?_:rh(_,d))}function RKe(_){return fae(rh(_,d))}function AKe(_,P){return pae(_,rh(P,d))}var OKe=Xr(function(_,P){return function(F){return FE(F,_,P)}}),MKe=Xr(function(_,P){return function(F){return FE(_,F,P)}});function Sj(_,P,F){var q=qa(P),re=ER(P,q);F==null&&!(vs(P)&&(re.length||!q.length))&&(F=P,P=_,_=this,re=ER(P,qa(P)));var pe=!(vs(F)&&"chain"in F)||!!F.chain,Oe=Gg(_);return eh(re,function(We){var Ye=P[We];_[We]=Ye,Oe&&(_.prototype[We]=function(){var It=this.__chain__;if(pe||It){var kt=_(this.__wrapped__),Nt=kt.__actions__=du(this.__actions__);return Nt.push({func:Ye,args:arguments,thisArg:_}),kt.__chain__=It,kt}return Ye.apply(_,$v([this.value()],arguments))})}),_}function $Ke(){return vi._===this&&(vi._=aUe),this}function _j(){}function LKe(_){return _=Br(_),Xr(function(P){return gae(P,_)})}var NKe=J9(is),FKe=J9(Lse),jKe=J9(C9);function Oce(_){return oj(_)?x9(mp(_)):gze(_)}function BKe(_){return function(P){return _==null?t:db(_,P)}}var HKe=Nae(),UKe=Nae(!0);function wj(){return[]}function Cj(){return!1}function zKe(){return{}}function VKe(){return""}function WKe(){return!0}function qKe(_,P){if(_=Br(_),_<1||_>B)return[];var F=z,q=tl(_,z);P=ur(P),_-=z;for(var re=P9(q,P);++F<_;)P(F);return re}function KKe(_){return Or(_)?is(_,mp):rd(_)?[_]:du(Qae(zi(_)))}function GKe(_){var P=++oUe;return zi(_)+P}var ZKe=RR(function(_,P){return _+P},0),XKe=Q9("ceil"),YKe=RR(function(_,P){return _/P},1),JKe=Q9("floor");function QKe(_){return _&&_.length?xR(_,pu,F9):t}function eGe(_,P){return _&&_.length?xR(_,ur(P,2),F9):t}function tGe(_){return jse(_,pu)}function nGe(_,P){return jse(_,ur(P,2))}function rGe(_){return _&&_.length?xR(_,pu,U9):t}function iGe(_,P){return _&&_.length?xR(_,ur(P,2),U9):t}var oGe=RR(function(_,P){return _*P},1),sGe=Q9("round"),aGe=RR(function(_,P){return _-P},0);function cGe(_){return _&&_.length?I9(_,pu):0}function lGe(_,P){return _&&_.length?I9(_,ur(P,2)):0}return de.after=RWe,de.ary=uce,de.assign=yqe,de.assignIn=xce,de.assignInWith=VR,de.assignWith=bqe,de.at=Sqe,de.before=dce,de.bind=dj,de.bindAll=EKe,de.bindKey=hce,de.castArray=zWe,de.chain=ace,de.chunk=Jze,de.compact=Qze,de.concat=eVe,de.cond=IKe,de.conforms=PKe,de.constant=yj,de.countBy=cWe,de.create=_qe,de.curry=fce,de.curryRight=pce,de.debounce=gce,de.defaults=wqe,de.defaultsDeep=Cqe,de.defer=AWe,de.delay=OWe,de.difference=tVe,de.differenceBy=nVe,de.differenceWith=rVe,de.drop=iVe,de.dropRight=oVe,de.dropRightWhile=sVe,de.dropWhile=aVe,de.fill=cVe,de.filter=uWe,de.flatMap=fWe,de.flatMapDeep=pWe,de.flatMapDepth=gWe,de.flatten=rce,de.flattenDeep=lVe,de.flattenDepth=uVe,de.flip=MWe,de.flow=TKe,de.flowRight=DKe,de.fromPairs=dVe,de.functions=Dqe,de.functionsIn=Rqe,de.groupBy=mWe,de.initial=fVe,de.intersection=pVe,de.intersectionBy=gVe,de.intersectionWith=mVe,de.invert=Oqe,de.invertBy=Mqe,de.invokeMap=yWe,de.iteratee=bj,de.keyBy=bWe,de.keys=qa,de.keysIn=fu,de.map=FR,de.mapKeys=Lqe,de.mapValues=Nqe,de.matches=RKe,de.matchesProperty=AKe,de.memoize=BR,de.merge=Fqe,de.mergeWith=Ece,de.method=OKe,de.methodOf=MKe,de.mixin=Sj,de.negate=HR,de.nthArg=LKe,de.omit=jqe,de.omitBy=Bqe,de.once=$We,de.orderBy=SWe,de.over=NKe,de.overArgs=LWe,de.overEvery=FKe,de.overSome=jKe,de.partial=hj,de.partialRight=mce,de.partition=_We,de.pick=Hqe,de.pickBy=Ice,de.property=Oce,de.propertyOf=BKe,de.pull=SVe,de.pullAll=oce,de.pullAllBy=_Ve,de.pullAllWith=wVe,de.pullAt=CVe,de.range=HKe,de.rangeRight=UKe,de.rearg=NWe,de.reject=xWe,de.remove=xVe,de.rest=FWe,de.reverse=lj,de.sampleSize=IWe,de.set=zqe,de.setWith=Vqe,de.shuffle=PWe,de.slice=EVe,de.sortBy=DWe,de.sortedUniq=AVe,de.sortedUniqBy=OVe,de.split=fKe,de.spread=jWe,de.tail=MVe,de.take=$Ve,de.takeRight=LVe,de.takeRightWhile=NVe,de.takeWhile=FVe,de.tap=QVe,de.throttle=BWe,de.thru=NR,de.toArray=_ce,de.toPairs=Pce,de.toPairsIn=kce,de.toPath=KKe,de.toPlainObject=Cce,de.transform=Wqe,de.unary=HWe,de.union=jVe,de.unionBy=BVe,de.unionWith=HVe,de.uniq=UVe,de.uniqBy=zVe,de.uniqWith=VVe,de.unset=qqe,de.unzip=uj,de.unzipWith=sce,de.update=Kqe,de.updateWith=Gqe,de.values=M_,de.valuesIn=Zqe,de.without=WVe,de.words=Rce,de.wrap=UWe,de.xor=qVe,de.xorBy=KVe,de.xorWith=GVe,de.zip=ZVe,de.zipObject=XVe,de.zipObjectDeep=YVe,de.zipWith=JVe,de.entries=Pce,de.entriesIn=kce,de.extend=xce,de.extendWith=VR,Sj(de,de),de.add=ZKe,de.attempt=Ace,de.camelCase=Qqe,de.capitalize=Tce,de.ceil=XKe,de.clamp=Xqe,de.clone=VWe,de.cloneDeep=qWe,de.cloneDeepWith=KWe,de.cloneWith=WWe,de.conformsTo=GWe,de.deburr=Dce,de.defaultTo=kKe,de.divide=YKe,de.endsWith=eKe,de.eq=tf,de.escape=tKe,de.escapeRegExp=nKe,de.every=lWe,de.find=dWe,de.findIndex=tce,de.findKey=xqe,de.findLast=hWe,de.findLastIndex=nce,de.findLastKey=Eqe,de.floor=JKe,de.forEach=cce,de.forEachRight=lce,de.forIn=Iqe,de.forInRight=Pqe,de.forOwn=kqe,de.forOwnRight=Tqe,de.get=gj,de.gt=ZWe,de.gte=XWe,de.has=Aqe,de.hasIn=mj,de.head=ice,de.identity=pu,de.includes=vWe,de.indexOf=hVe,de.inRange=Yqe,de.invoke=$qe,de.isArguments=pb,de.isArray=Or,de.isArrayBuffer=YWe,de.isArrayLike=hu,de.isArrayLikeObject=qs,de.isBoolean=JWe,de.isBuffer=Uv,de.isDate=QWe,de.isElement=eqe,de.isEmpty=tqe,de.isEqual=nqe,de.isEqualWith=rqe,de.isError=fj,de.isFinite=iqe,de.isFunction=Gg,de.isInteger=vce,de.isLength=UR,de.isMap=yce,de.isMatch=oqe,de.isMatchWith=sqe,de.isNaN=aqe,de.isNative=cqe,de.isNil=uqe,de.isNull=lqe,de.isNumber=bce,de.isObject=vs,de.isObjectLike=Ts,de.isPlainObject=VE,de.isRegExp=pj,de.isSafeInteger=dqe,de.isSet=Sce,de.isString=zR,de.isSymbol=rd,de.isTypedArray=O_,de.isUndefined=hqe,de.isWeakMap=fqe,de.isWeakSet=pqe,de.join=vVe,de.kebabCase=rKe,de.last=oh,de.lastIndexOf=yVe,de.lowerCase=iKe,de.lowerFirst=oKe,de.lt=gqe,de.lte=mqe,de.max=QKe,de.maxBy=eGe,de.mean=tGe,de.meanBy=nGe,de.min=rGe,de.minBy=iGe,de.stubArray=wj,de.stubFalse=Cj,de.stubObject=zKe,de.stubString=VKe,de.stubTrue=WKe,de.multiply=oGe,de.nth=bVe,de.noConflict=$Ke,de.noop=_j,de.now=jR,de.pad=sKe,de.padEnd=aKe,de.padStart=cKe,de.parseInt=lKe,de.random=Jqe,de.reduce=wWe,de.reduceRight=CWe,de.repeat=uKe,de.replace=dKe,de.result=Uqe,de.round=sGe,de.runInContext=Ze,de.sample=EWe,de.size=kWe,de.snakeCase=hKe,de.some=TWe,de.sortedIndex=IVe,de.sortedIndexBy=PVe,de.sortedIndexOf=kVe,de.sortedLastIndex=TVe,de.sortedLastIndexBy=DVe,de.sortedLastIndexOf=RVe,de.startCase=pKe,de.startsWith=gKe,de.subtract=aGe,de.sum=cGe,de.sumBy=lGe,de.template=mKe,de.times=qKe,de.toFinite=Zg,de.toInteger=Br,de.toLength=wce,de.toLower=vKe,de.toNumber=sh,de.toSafeInteger=vqe,de.toString=zi,de.toUpper=yKe,de.trim=bKe,de.trimEnd=SKe,de.trimStart=_Ke,de.truncate=wKe,de.unescape=CKe,de.uniqueId=GKe,de.upperCase=xKe,de.upperFirst=vj,de.each=cce,de.eachRight=lce,de.first=ice,Sj(de,function(){var _={};return pp(de,function(P,F){eo.call(de.prototype,F)||(_[F]=P)}),_}(),{chain:!1}),de.VERSION=r,eh(["bind","bindKey","curry","curryRight","partial","partialRight"],function(_){de[_].placeholder=de}),eh(["drop","take"],function(_,P){li.prototype[_]=function(F){F=F===t?1:Ea(Br(F),0);var q=this.__filtered__&&!P?new li(this):this.clone();return q.__filtered__?q.__takeCount__=tl(F,q.__takeCount__):q.__views__.push({size:tl(F,z),type:_+(q.__dir__<0?"Right":"")}),q},li.prototype[_+"Right"]=function(F){return this.reverse()[_](F).reverse()}}),eh(["filter","map","takeWhile"],function(_,P){var F=P+1,q=F==k||F==j;li.prototype[_]=function(re){var pe=this.clone();return pe.__iteratees__.push({iteratee:ur(re,3),type:F}),pe.__filtered__=pe.__filtered__||q,pe}}),eh(["head","last"],function(_,P){var F="take"+(P?"Right":"");li.prototype[_]=function(){return this[F](1).value()[0]}}),eh(["initial","tail"],function(_,P){var F="drop"+(P?"":"Right");li.prototype[_]=function(){return this.__filtered__?new li(this):this[F](1)}}),li.prototype.compact=function(){return this.filter(pu)},li.prototype.find=function(_){return this.filter(_).head()},li.prototype.findLast=function(_){return this.reverse().find(_)},li.prototype.invokeMap=Xr(function(_,P){return typeof _=="function"?new li(this):this.map(function(F){return FE(F,_,P)})}),li.prototype.reject=function(_){return this.filter(HR(ur(_)))},li.prototype.slice=function(_,P){_=Br(_);var F=this;return F.__filtered__&&(_>0||P<0)?new li(F):(_<0?F=F.takeRight(-_):_&&(F=F.drop(_)),P!==t&&(P=Br(P),F=P<0?F.dropRight(-P):F.take(P-_)),F)},li.prototype.takeRightWhile=function(_){return this.reverse().takeWhile(_).reverse()},li.prototype.toArray=function(){return this.take(z)},pp(li.prototype,function(_,P){var F=/^(?:filter|find|map|reject)|While$/.test(P),q=/^(?:head|last)$/.test(P),re=de[q?"take"+(P=="last"?"Right":""):P],pe=q||/^find/.test(P);re&&(de.prototype[P]=function(){var Oe=this.__wrapped__,We=q?[1]:arguments,Ye=Oe instanceof li,It=We[0],kt=Ye||Or(Oe),Nt=function(ai){var yi=re.apply(de,$v([ai],We));return q&&vn?yi[0]:yi};kt&&F&&typeof It=="function"&&It.length!=1&&(Ye=kt=!1);var vn=this.__chain__,Bn=!!this.__actions__.length,gr=pe&&!vn,Wr=Ye&&!Bn;if(!pe&&kt){Oe=Wr?Oe:new li(this);var mr=_.apply(Oe,We);return mr.__actions__.push({func:NR,args:[Nt],thisArg:t}),new nh(mr,vn)}return gr&&Wr?_.apply(this,We):(mr=this.thru(Nt),gr?q?mr.value()[0]:mr.value():mr)})}),eh(["pop","push","shift","sort","splice","unshift"],function(_){var P=lR[_],F=/^(?:push|sort|unshift)$/.test(_)?"tap":"thru",q=/^(?:pop|shift)$/.test(_);de.prototype[_]=function(){var re=arguments;if(q&&!this.__chain__){var pe=this.value();return P.apply(Or(pe)?pe:[],re)}return this[F](function(Oe){return P.apply(Or(Oe)?Oe:[],re)})}}),pp(li.prototype,function(_,P){var F=de[P];if(F){var q=F.name+"";eo.call(k_,q)||(k_[q]=[]),k_[q].push({name:P,func:F})}}),k_[DR(t,v).name]=[{name:"wrapper",func:t}],li.prototype.clone=CUe,li.prototype.reverse=xUe,li.prototype.value=EUe,de.prototype.at=eWe,de.prototype.chain=tWe,de.prototype.commit=nWe,de.prototype.next=rWe,de.prototype.plant=oWe,de.prototype.reverse=sWe,de.prototype.toJSON=de.prototype.valueOf=de.prototype.value=aWe,de.prototype.first=de.prototype.head,RE&&(de.prototype[RE]=iWe),de},E_=nUe();Ws?((Ws.exports=E_)._=E_,bo._=E_):vi._=E_}).call(Ir)})(F8,F8.exports);F8.exports;const kIt=typeof AudioWorklet=="function",TIt=n=>{var _e,Se,se;const{className:e}=n,t=y.useContext(CD),{mediaStream:r}=y.useContext(wre),[i,o]=y.useState(t.getCurrentUserInfo()&&t.getCurrentUserInfo().audio!==""),[s,a]=y.useState((_e=t.getCurrentUserInfo())==null?void 0:_e.bVideoOn),[c,l]=y.useState((Se=t.getCurrentUserInfo())==null?void 0:Se.audio),[u,d]=y.useState(!1),[h,f]=y.useState([]),[p,g]=y.useState(),[m,v]=y.useState(!!((se=t.getCurrentUserInfo())!=null&&se.muted)),[b,S]=y.useState(r==null?void 0:r.getActiveMicrophone()),[E,w]=y.useState(r==null?void 0:r.getActiveSpeaker()),[C,I]=y.useState((r==null?void 0:r.getMicList())??[]),[T,D]=y.useState((r==null?void 0:r.getSpeakerList())??[]),[O,M]=y.useState(!1),[R,A]=y.useState(!1),[k,L]=y.useState(!1),[j]=co.useForm(),N=y.useCallback(async()=>{if(i)m?await(r==null?void 0:r.unmuteAudio()):await(r==null?void 0:r.muteAudio());else try{await(r==null?void 0:r.startAudio({highBitrate:!0}))}catch(ee){ee.type==="INSUFFICIENT_PRIVILEGES"&&ee.reason==="USER_FORBIDDEN_MICROPHONE"&&A(!0),console.warn(ee)}},[r,i,m]),B=async ee=>{if(r){const[Y,ue]=ee.split("|");Y==="microphone"?ue!==b&&(await r.switchMicrophone(ue),S(r.getActiveMicrophone())):Y==="speaker"?ue!==E&&(await r.switchSpeaker(ue),w(r.getActiveSpeaker())):Y==="leave audio"?c==="computer"?await r.stopAudio():c==="phone"&&(await r.hangup(),g(void 0)):Y==="statistic"||Y==="secondary audio"&&(k?(await r.stopSecondaryAudio(),L(!1)):Zu.confirm({title:"Start secondary audio",content:x.jsxs(co,{form:j,children:[x.jsx(co.Item,{label:"Microphone",name:"mic",required:!0,children:x.jsx(Ey,{options:r.getMicList().map(ye=>({value:ye.deviceId,label:ye.label,disabled:ye.deviceId===r.getActiveMicrophone()}))})}),x.jsx(co.Item,{label:"Contraintes",name:"constraints",children:x.jsx(WC.Group,{options:[{label:"AGC",value:"autoGainControl"},{label:"ANC",value:"noiseSuppression"},{label:"AEC",value:"echoCancellation"}]})})]}),onOk:async()=>{try{const ye=await j.validateFields(),{mic:V,constraints:le}=ye,he={};le&&le.forEach(oe=>{Object.assign(he,{[`${oe}`]:!0})}),await r.startSecondaryAudio(V,he),L(!0)}catch(ye){console.warn(ye)}}}))}},U=async(ee,Y,ue,ye)=>{await(r==null?void 0:r.inviteByPhone(ee,Y,ue,ye))},K=async(ee,Y,ue)=>([Ss.Calling,Ss.Ringing,Ss.Accepted].includes(p)&&(await(r==null?void 0:r.cancelInviteByPhone(ee,Y,ue)),await new Promise(ye=>{setTimeout(()=>{ye(!0)},3e3)})),Promise.resolve()),z=y.useCallback(ee=>{const{action:Y,source:ue,type:ye}=ee;Y===km.Join?(o(!0),l(ye),setTimeout(()=>{var V;v(!!((V=t.getCurrentUserInfo())!=null&&V.muted))},1e3)):Y===km.Leave?o(!1):Y===km.Muted?(v(!0),ue===Sf.PassiveByMuteOne&&M8.info("Host muted you")):Y===km.Unmuted&&(v(!1),ue==="passive"&&M8.info("Host unmuted you"))},[t]),G=y.useCallback(({reason:ee})=>{console.log("passively stop reason:",ee)},[]),te=y.useCallback(()=>{r&&(I(r.getMicList()),D(r.getSpeakerList()),S(r.getActiveMicrophone()),w(r.getActiveSpeaker()))},[r]),ie=y.useCallback(ee=>{g(ee.code)},[]),Q=y.useCallback(ee=>{ee.state===k4.Started?a(!0):a(!1)},[]),ge=y.useCallback(ee=>{const{state:Y}=ee;Y==="on"?r!=null&&r.isSupportMicrophoneAndShareAudioSimultaneously()||M(!0):Y==="off"&&M(!1)},[r]);return y.useEffect(()=>(t.on("current-audio-change",z),t.on("passively-stop-share",G),t.on("device-change",te),t.on("dialout-state-change",ie),t.on("video-capturing-change",Q),t.on("share-audio-change",ge),()=>{t.off("current-audio-change",z),t.off("passively-stop-share",G),t.off("device-change",te),t.off("dialout-state-change",ie),t.off("video-capturing-change",Q),t.off("share-audio-change",ge)}),[t,z,G,te,ie,Q,ge]),IIt(()=>{t.getSessionInfo().isInMeeting&&(i&&(r==null||r.stopAudio()),s&&(r==null||r.stopVideo()),r==null||r.stopShareScreen())}),PIt(()=>{r&&(d(!!r.isSupportPhoneFeature()),f(r.getSupportCountryInfo()||[]))}),x.jsxs("div",{className:Ue("video-footer",e),children:[kIt&&x.jsx(EIt,{isStartedAudio:i,isMuted:m,isSupportPhone:u,audio:c,phoneCountryList:h,onPhoneCallClick:U,onPhoneCallCancel:K,phoneCallStatus:uIt(p),onMicrophoneClick:N,onMicrophoneMenuClick:B,microphoneList:C,speakerList:T,activeMicrophone:b,activeSpeaker:E,disabled:O,isMicrophoneForbidden:R,isSecondaryAudioStarted:k}),k&&x.jsx(sE,{title:"Secondary audio on",children:x.jsx(Vxt,{style:{position:"fixed",top:"45px",left:"10px",color:"#f60",fontSize:"24px"}})})]})},DIt=n=>{const{content:e}=n;return x.jsx("div",{className:"loading-layer",children:x.jsx("p",{className:"loading-text",children:e})})},RZ={audio:{encode:!1,decode:!1},video:{encode:!1,decode:!1},share:{encode:!1,decode:!1}},RIt=nEt((n,e)=>{switch(e.type){case"audio-encode":{n.audio.encode=e.payload;break}case"audio-decode":{n.audio.decode=e.payload;break}case"video-encode":{n.video.encode=e.payload;break}case"video-decode":{n.video.decode=e.payload;break}case"share-encode":{n.share.encode=e.payload;break}case"share-decode":{n.share.decode=e.payload;break}case"reset-media":{Object.assign(n,{...RZ});break}}},RZ);function AIt(n){const{meetingArgs:{topic:e,signature:t,name:r,password:i,webEndpoint:o,enforceGalleryView:s,enforceVB:a,customerJoinId:c,lang:l,useVideoPlayer:u,onJoin:d}}=n,[h,f]=y.useState(!0),[p,g]=y.useState(""),[m,v]=y.useState(!1),[b,S]=y.useState("closed"),[E,w]=y.useReducer(RIt,RZ),[C,I]=y.useState(null),[T,D]=y.useState(!1),O=y.useContext(CD);let M;o?M=o:M=(window==null?void 0:window.webEndpoint)??"zoom.us";const R=y.useMemo(()=>({...E,mediaStream:C}),[E,C]),A=Number(s)===1&&!window.crossOriginIsolated,k=Number(a)===1&&!window.crossOriginIsolated,L=Number(u)===1&&(window.crossOriginIsolated||A);console.log(L?{galleryViewWithAttach:L,use:"<video-player-container> video tag render video",doc:"https://marketplacefront.zoom.us/sdk/custom/web/modules/Stream.html#attachVideo"}:{galleryViewWithAttach:L,use:"<canvas>",doc:"https://marketplacefront.zoom.us/sdk/custom/web/modules/Stream.html#startVideo"}),y.useEffect(()=>((async()=>{await O.init("en-US","Global",{webEndpoint:M,enforceMultipleVideos:A,enforceVirtualBackground:k,stayAwake:!0,patchJsMedia:!0,leaveOnPageUnload:!1});try{g("Joining the session..."),await O.join(e,t,r,i).then(d).catch(K=>{console.log(K)});const U=O.getMediaStream();I(U),D(U.isSupportMultipleVideos()),f(!1)}catch(U){f(!1),M8.error(U.reason)}})(),()=>{p3.destroyClient()}),[t,O,e,r,i,M,A,c,l,k]);const j=y.useCallback(B=>{if(B.state===Lm.Reconnecting){f(!0),v(!0),S("connecting");const{reason:U,subsessionName:K}=B;U===Qw.Failover?g("Session Disconnected,Try to reconnect"):U===Qw.JoinSubsession||U===Qw.MoveToSubsession?g(`Joining ${K}...`):U===Qw.BackToMainSession&&g("Returning to Main Session...")}else B.state===Lm.Connected?(S("connected"),m&&f(!1),window.zmClient=O,window.mediaStream=O.getMediaStream(),console.log("getSessionInfo",O.getSessionInfo())):B.state===Lm.Closed&&(S("closed"),w({type:"reset-media"}),B.reason==="ended by host"&&Zu.warning({title:"Meeting ended",content:"This meeting has been ended by host"}))},[m,O]),N=y.useCallback(B=>{const{action:U,type:K,result:z}=B;w({type:`${K}-${U}`,payload:z==="success"})},[]);return y.useEffect(()=>(O.on("connection-change",j),O.on("media-sdk-change",N),()=>{O.off("connection-change",j),O.off("media-sdk-change",N)}),[O,j,N]),console.log({isSupportGalleryView:T,galleryViewWithAttach:L}),x.jsxs("div",{className:"App",children:[h&&x.jsx(DIt,{content:p}),!h&&x.jsx(wre.Provider,{value:R,children:x.jsx(TIt,{className:"video-operations"})})]})}const OIt=n=>{const{client:e,meetingArgs:t}=n;return x.jsx(CD.Provider,{value:e,children:x.jsx(AIt,{meetingArgs:t})})},MIt=n=>x.jsx(sE,{title:"disconnect",children:x.jsx(mg,{className:Ue("vc-button"),icon:x.jsx(CMe,{type:"icon-leave"}),ghost:!0,shape:"circle",size:"large",onClick:n.onClick,title:"Leave session"})});function $It(n){let e,t,r,i,o,s,a,c;const l=[n[0]];let u={};for(let f=0;f<l.length;f+=1)u=KV(u,l[f]);r=new n[2]({props:u});const d=[n[1]];let h={};for(let f=0;f<d.length;f+=1)h=KV(h,d[f]);return s=new n[3]({props:h}),{c(){e=Ne("div"),t=Ne("div"),Bo(r.$$.fragment),i=Kt(),o=Ne("div"),Bo(s.$$.fragment),this.h()},l(f){e=Fe(f,"DIV",{class:!0});var p=tt(e);t=Fe(p,"DIV",{});var g=tt(t);Ho(r.$$.fragment,g),g.forEach(Ee),i=Gt(p),o=Fe(p,"DIV",{});var m=tt(o);Ho(s.$$.fragment,m),m.forEach(Ee),p.forEach(Ee),this.h()},h(){Re(e,"class","w-full h-full items-center justify-center flex flex-row")},m(f,p){Ft(f,e,p),we(e,t),Uo(r,t,null),we(e,i),we(e,o),Uo(s,o,null),c=!0},p(f,[p]){const g=p&1?aW(l,[cW(f[0])]):{};r.$set(g);const m=p&2?aW(d,[cW(f[1])]):{};s.$set(m)},i(f){c||(cn(r.$$.fragment,f),cn(s.$$.fragment,f),f&&ov(()=>{c&&(a||(a=yy(e,w2,{},!0)),a.run(1))}),c=!0)},o(f){Sn(r.$$.fragment,f),Sn(s.$$.fragment,f),f&&(a||(a=yy(e,w2,{},!1)),a.run(0)),c=!1},d(f){f&&Ee(e),zo(r),zo(s),f&&a&&a.end()}}}function LIt(n,e,t){let{userEmail:r}=e,{roomID:i}=e,{signature:o}=e,{record:s=!1}=e,{onDisconnect:a}=e,c,l=!1;const u=v=>{},d=p3.createClient(),h={client:p3.createClient(),meetingArgs:{signature:o,name:r,topic:i,onJoin:()=>{l=!0,d.getLiveTranscriptionClient(),d.on("caption-message",u),s&&(c=d.getRecordingClient(),c.getCloudRecordingStatus()==="Stopped"&&c.startCloudRecording())}}},f=async()=>{if(l){if(d.off("caption-message",u),s){const v=await d.getAllUser(),b=c.getCloudRecordingStatus(),S=v.filter(E=>E.displayName!==r);b==="Recording"&&S.length===0&&c.stopCloudRecording()}d.leave(),l=!1}},p={onClick:()=>{f(),a()}};w2e(f);const g=lW(OIt,Wu.createPortal,dW,uW),m=lW(MIt,Wu.createPortal,dW,uW);return n.$$set=v=>{"userEmail"in v&&t(4,r=v.userEmail),"roomID"in v&&t(5,i=v.roomID),"signature"in v&&t(6,o=v.signature),"record"in v&&t(7,s=v.record),"onDisconnect"in v&&t(8,a=v.onDisconnect)},[h,p,g,m,r,i,o,s,a]}class NIt extends fo{constructor(e){super(),po(this,e,LIt,$It,Hi,{userEmail:4,roomID:5,signature:6,record:7,onDisconnect:8})}}function O0e(n){let e,t,r="Join",i,o;return{c(){e=Ne("div"),t=Ne("button"),t.textContent=r,this.h()},l(s){e=Fe(s,"DIV",{class:!0});var a=tt(e);t=Fe(a,"BUTTON",{class:!0,"data-svelte-h":!0}),Fr(t)!=="svelte-7waz9f"&&(t.textContent=r),a.forEach(Ee),this.h()},h(){Re(t,"class","btn"),Re(e,"class","h-full w-full flex items-center justify-center")},m(s,a){Ft(s,e,a),we(e,t),i||(o=_r(t,"click",n[2]),i=!0)},p:Dt,d(s){s&&Ee(e),i=!1,o()}}}function FIt(n){let e,t=!n[0]&&O0e(n);return{c(){e=Ne("div"),t&&t.c(),this.h()},l(r){e=Fe(r,"DIV",{class:!0});var i=tt(e);t&&t.l(i),i.forEach(Ee),this.h()},h(){Re(e,"class","h-full w-full bg-neutral-medium text-white")},m(r,i){Ft(r,e,i),t&&t.m(e,null),n[5](e)},p(r,[i]){r[0]?t&&(t.d(1),t=null):t?t.p(r,i):(t=O0e(r),t.c(),t.m(e,null))},i:Dt,o:Dt,d(r){r&&Ee(e),t&&t.d(),n[5](null)}}}function jIt(n,e,t){let{userEmail:r}=e,{roomID:i}=e,o=!1,s;const a=async()=>{const l=await Ra("zoomAuth","body",{role:1,session_name:i});t(0,o=!0);let u=new NIt({target:s,props:{userEmail:r,roomID:i,signature:l.signature,onDisconnect:()=>{t(0,o=!1),u.$destroy()}}})};function c(l){na[l?"unshift":"push"](()=>{s=l,t(1,s)})}return n.$$set=l=>{"userEmail"in l&&t(3,r=l.userEmail),"roomID"in l&&t(4,i=l.roomID)},[o,s,a,r,i,c]}class BIt extends fo{constructor(e){super(),po(this,e,jIt,FIt,Hi,{userEmail:3,roomID:4})}}var pI=function(n){return n&&n.Math===Math&&n},Xu=pI(typeof globalThis=="object"&&globalThis)||pI(typeof window=="object"&&window)||pI(typeof self=="object"&&self)||pI(typeof Ir=="object"&&Ir)||pI(typeof Ir=="object"&&Ir)||function(){return this}()||Function("return this")(),Cre={},ou=function(n){try{return!!n()}catch{return!0}},HIt=ou,qy=!HIt(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),UIt=ou,gN=!UIt(function(){var n=(function(){}).bind();return typeof n!="function"||n.hasOwnProperty("prototype")}),zIt=gN,W5=Function.prototype.call,wv=zIt?W5.bind(W5):function(){return W5.apply(W5,arguments)},xMe={},EMe={}.propertyIsEnumerable,IMe=Object.getOwnPropertyDescriptor,VIt=IMe&&!EMe.call({1:2},1);xMe.f=VIt?function(e){var t=IMe(this,e);return!!t&&t.enumerable}:EMe;var PMe=function(n,e){return{enumerable:!(n&1),configurable:!(n&2),writable:!(n&4),value:e}},kMe=gN,TMe=Function.prototype,AZ=TMe.call,WIt=kMe&&TMe.bind.bind(AZ,AZ),bc=kMe?WIt:function(n){return function(){return AZ.apply(n,arguments)}},DMe=bc,qIt=DMe({}.toString),KIt=DMe("".slice),cE=function(n){return KIt(qIt(n),8,-1)},GIt=bc,ZIt=ou,XIt=cE,XH=Object,YIt=GIt("".split),JIt=ZIt(function(){return!XH("z").propertyIsEnumerable(0)})?function(n){return XIt(n)==="String"?YIt(n,""):XH(n)}:XH,mN=function(n){return n==null},QIt=mN,ePt=TypeError,lE=function(n){if(QIt(n))throw new ePt("Can't call method on "+n);return n},tPt=JIt,nPt=lE,vN=function(n){return tPt(nPt(n))},YH=typeof document=="object"&&document.all,su=typeof YH>"u"&&YH!==void 0?function(n){return typeof n=="function"||n===YH}:function(n){return typeof n=="function"},rPt=su,h_=function(n){return typeof n=="object"?n!==null:rPt(n)},JH=Xu,iPt=su,oPt=function(n){return iPt(n)?n:void 0},yN=function(n,e){return arguments.length<2?oPt(JH[n]):JH[n]&&JH[n][e]},sPt=bc,RMe=sPt({}.isPrototypeOf),aPt=typeof navigator<"u"&&String(navigator.userAgent)||"",AMe=Xu,QH=aPt,M0e=AMe.process,$0e=AMe.Deno,L0e=M0e&&M0e.versions||$0e&&$0e.version,N0e=L0e&&L0e.v8,Pf,j8;N0e&&(Pf=N0e.split("."),j8=Pf[0]>0&&Pf[0]<4?1:+(Pf[0]+Pf[1]));!j8&&QH&&(Pf=QH.match(/Edge\/(\d+)/),(!Pf||Pf[1]>=74)&&(Pf=QH.match(/Chrome\/(\d+)/),Pf&&(j8=+Pf[1])));var cPt=j8,F0e=cPt,lPt=ou,uPt=Xu,dPt=uPt.String,OMe=!!Object.getOwnPropertySymbols&&!lPt(function(){var n=Symbol("symbol detection");return!dPt(n)||!(Object(n)instanceof Symbol)||!Symbol.sham&&F0e&&F0e<41}),hPt=OMe,MMe=hPt&&!Symbol.sham&&typeof Symbol.iterator=="symbol",fPt=yN,pPt=su,gPt=RMe,mPt=MMe,vPt=Object,$Me=mPt?function(n){return typeof n=="symbol"}:function(n){var e=fPt("Symbol");return pPt(e)&&gPt(e.prototype,vPt(n))},yPt=String,bPt=function(n){try{return yPt(n)}catch{return"Object"}},SPt=su,_Pt=bPt,wPt=TypeError,xre=function(n){if(SPt(n))return n;throw new wPt(_Pt(n)+" is not a function")},CPt=xre,xPt=mN,Ere=function(n,e){var t=n[e];return xPt(t)?void 0:CPt(t)},eU=wv,tU=su,nU=h_,EPt=TypeError,IPt=function(n,e){var t,r;if(e==="string"&&tU(t=n.toString)&&!nU(r=eU(t,n))||tU(t=n.valueOf)&&!nU(r=eU(t,n))||e!=="string"&&tU(t=n.toString)&&!nU(r=eU(t,n)))return r;throw new EPt("Can't convert object to primitive value")},LMe={exports:{}},j0e=Xu,PPt=Object.defineProperty,Ire=function(n,e){try{PPt(j0e,n,{value:e,configurable:!0,writable:!0})}catch{j0e[n]=e}return e},kPt=Xu,TPt=Ire,B0e="__core-js_shared__",H0e=LMe.exports=kPt[B0e]||TPt(B0e,{});(H0e.versions||(H0e.versions=[])).push({version:"3.37.1",mode:"global",copyright:"© 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.37.1/LICENSE",source:"https://github.com/zloirock/core-js"});var Pre=LMe.exports,U0e=Pre,kre=function(n,e){return U0e[n]||(U0e[n]=e||{})},DPt=lE,RPt=Object,xD=function(n){return RPt(DPt(n))},APt=bc,OPt=xD,MPt=APt({}.hasOwnProperty),Ky=Object.hasOwn||function(e,t){return MPt(OPt(e),t)},$Pt=bc,LPt=0,NPt=Math.random(),FPt=$Pt(1 .toString),NMe=function(n){return"Symbol("+(n===void 0?"":n)+")_"+FPt(++LPt+NPt,36)},jPt=Xu,BPt=kre,z0e=Ky,HPt=NMe,UPt=OMe,zPt=MMe,rC=jPt.Symbol,rU=BPt("wks"),VPt=zPt?rC.for||rC:rC&&rC.withoutSetter||HPt,Cv=function(n){return z0e(rU,n)||(rU[n]=UPt&&z0e(rC,n)?rC[n]:VPt("Symbol."+n)),rU[n]},WPt=wv,V0e=h_,W0e=$Me,qPt=Ere,KPt=IPt,GPt=Cv,ZPt=TypeError,XPt=GPt("toPrimitive"),YPt=function(n,e){if(!V0e(n)||W0e(n))return n;var t=qPt(n,XPt),r;if(t){if(e===void 0&&(e="default"),r=WPt(t,n,e),!V0e(r)||W0e(r))return r;throw new ZPt("Can't convert object to primitive value")}return e===void 0&&(e="number"),KPt(n,e)},JPt=YPt,QPt=$Me,FMe=function(n){var e=JPt(n,"string");return QPt(e)?e:e+""},ekt=Xu,q0e=h_,OZ=ekt.document,tkt=q0e(OZ)&&q0e(OZ.createElement),jMe=function(n){return tkt?OZ.createElement(n):{}},nkt=qy,rkt=ou,ikt=jMe,BMe=!nkt&&!rkt(function(){return Object.defineProperty(ikt("div"),"a",{get:function(){return 7}}).a!==7}),okt=qy,skt=wv,akt=xMe,ckt=PMe,lkt=vN,ukt=FMe,dkt=Ky,hkt=BMe,K0e=Object.getOwnPropertyDescriptor;Cre.f=okt?K0e:function(e,t){if(e=lkt(e),t=ukt(t),hkt)try{return K0e(e,t)}catch{}if(dkt(e,t))return ckt(!skt(akt.f,e,t),e[t])};var uE={},fkt=qy,pkt=ou,HMe=fkt&&pkt(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),gkt=h_,mkt=String,vkt=TypeError,f_=function(n){if(gkt(n))return n;throw new vkt(mkt(n)+" is not an object")},ykt=qy,bkt=BMe,Skt=HMe,q5=f_,G0e=FMe,_kt=TypeError,iU=Object.defineProperty,wkt=Object.getOwnPropertyDescriptor,oU="enumerable",sU="configurable",aU="writable";uE.f=ykt?Skt?function(e,t,r){if(q5(e),t=G0e(t),q5(r),typeof e=="function"&&t==="prototype"&&"value"in r&&aU in r&&!r[aU]){var i=wkt(e,t);i&&i[aU]&&(e[t]=r.value,r={configurable:sU in r?r[sU]:i[sU],enumerable:oU in r?r[oU]:i[oU],writable:!1})}return iU(e,t,r)}:iU:function(e,t,r){if(q5(e),t=G0e(t),q5(r),bkt)try{return iU(e,t,r)}catch{}if("get"in r||"set"in r)throw new _kt("Accessors not supported");return"value"in r&&(e[t]=r.value),e};var Ckt=qy,xkt=uE,Ekt=PMe,Tre=Ckt?function(n,e,t){return xkt.f(n,e,Ekt(1,t))}:function(n,e,t){return n[e]=t,n},UMe={exports:{}},MZ=qy,Ikt=Ky,zMe=Function.prototype,Pkt=MZ&&Object.getOwnPropertyDescriptor,Dre=Ikt(zMe,"name"),kkt=Dre&&(function(){}).name==="something",Tkt=Dre&&(!MZ||MZ&&Pkt(zMe,"name").configurable),Dkt={EXISTS:Dre,PROPER:kkt,CONFIGURABLE:Tkt},Rkt=bc,Akt=su,$Z=Pre,Okt=Rkt(Function.toString);Akt($Z.inspectSource)||($Z.inspectSource=function(n){return Okt(n)});var VMe=$Z.inspectSource,Mkt=Xu,$kt=su,Z0e=Mkt.WeakMap,Lkt=$kt(Z0e)&&/native code/.test(String(Z0e)),Nkt=kre,Fkt=NMe,X0e=Nkt("keys"),WMe=function(n){return X0e[n]||(X0e[n]=Fkt(n))},Rre={},jkt=Lkt,qMe=Xu,Bkt=h_,Hkt=Tre,cU=Ky,lU=Pre,Ukt=WMe,zkt=Rre,Y0e="Object already initialized",LZ=qMe.TypeError,Vkt=qMe.WeakMap,B8,L3,H8,Wkt=function(n){return H8(n)?L3(n):B8(n,{})},qkt=function(n){return function(e){var t;if(!Bkt(e)||(t=L3(e)).type!==n)throw new LZ("Incompatible receiver, "+n+" required");return t}};if(jkt||lU.state){var Sp=lU.state||(lU.state=new Vkt);Sp.get=Sp.get,Sp.has=Sp.has,Sp.set=Sp.set,B8=function(n,e){if(Sp.has(n))throw new LZ(Y0e);return e.facade=n,Sp.set(n,e),e},L3=function(n){return Sp.get(n)||{}},H8=function(n){return Sp.has(n)}}else{var cw=Ukt("state");zkt[cw]=!0,B8=function(n,e){if(cU(n,cw))throw new LZ(Y0e);return e.facade=n,Hkt(n,cw,e),e},L3=function(n){return cU(n,cw)?n[cw]:{}},H8=function(n){return cU(n,cw)}}var KMe={set:B8,get:L3,has:H8,enforce:Wkt,getterFor:qkt},Are=bc,Kkt=ou,Gkt=su,K5=Ky,NZ=qy,Zkt=Dkt.CONFIGURABLE,Xkt=VMe,GMe=KMe,Ykt=GMe.enforce,Jkt=GMe.get,J0e=String,hO=Object.defineProperty,Qkt=Are("".slice),e3t=Are("".replace),t3t=Are([].join),n3t=NZ&&!Kkt(function(){return hO(function(){},"length",{value:8}).length!==8}),r3t=String(String).split("String"),i3t=UMe.exports=function(n,e,t){Qkt(J0e(e),0,7)==="Symbol("&&(e="["+e3t(J0e(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),t&&t.getter&&(e="get "+e),t&&t.setter&&(e="set "+e),(!K5(n,"name")||Zkt&&n.name!==e)&&(NZ?hO(n,"name",{value:e,configurable:!0}):n.name=e),n3t&&t&&K5(t,"arity")&&n.length!==t.arity&&hO(n,"length",{value:t.arity});try{t&&K5(t,"constructor")&&t.constructor?NZ&&hO(n,"prototype",{writable:!1}):n.prototype&&(n.prototype=void 0)}catch{}var r=Ykt(n);return K5(r,"source")||(r.source=t3t(r3t,typeof e=="string"?e:"")),n};Function.prototype.toString=i3t(function(){return Gkt(this)&&Jkt(this).source||Xkt(this)},"toString");var o3t=UMe.exports,s3t=su,a3t=uE,c3t=o3t,l3t=Ire,ZMe=function(n,e,t,r){r||(r={});var i=r.enumerable,o=r.name!==void 0?r.name:e;if(s3t(t)&&c3t(t,o,r),r.global)i?n[e]=t:l3t(e,t);else{try{r.unsafe?n[e]&&(i=!0):delete n[e]}catch{}i?n[e]=t:a3t.f(n,e,{value:t,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return n},XMe={},u3t=Math.ceil,d3t=Math.floor,h3t=Math.trunc||function(e){var t=+e;return(t>0?d3t:u3t)(t)},f3t=h3t,p_=function(n){var e=+n;return e!==e||e===0?0:f3t(e)},p3t=p_,g3t=Math.max,m3t=Math.min,v3t=function(n,e){var t=p3t(n);return t<0?g3t(t+e,0):m3t(t,e)},y3t=p_,b3t=Math.min,YMe=function(n){var e=y3t(n);return e>0?b3t(e,9007199254740991):0},S3t=YMe,ED=function(n){return S3t(n.length)},_3t=vN,w3t=v3t,C3t=ED,Q0e=function(n){return function(e,t,r){var i=_3t(e),o=C3t(i);if(o===0)return!n&&-1;var s=w3t(r,o),a;if(n&&t!==t){for(;o>s;)if(a=i[s++],a!==a)return!0}else for(;o>s;s++)if((n||s in i)&&i[s]===t)return n||s||0;return!n&&-1}},x3t={includes:Q0e(!0),indexOf:Q0e(!1)},E3t=bc,uU=Ky,I3t=vN,P3t=x3t.indexOf,k3t=Rre,eye=E3t([].push),JMe=function(n,e){var t=I3t(n),r=0,i=[],o;for(o in t)!uU(k3t,o)&&uU(t,o)&&eye(i,o);for(;e.length>r;)uU(t,o=e[r++])&&(~P3t(i,o)||eye(i,o));return i},Ore=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],T3t=JMe,D3t=Ore,R3t=D3t.concat("length","prototype");XMe.f=Object.getOwnPropertyNames||function(e){return T3t(e,R3t)};var QMe={};QMe.f=Object.getOwnPropertySymbols;var A3t=yN,O3t=bc,M3t=XMe,$3t=QMe,L3t=f_,N3t=O3t([].concat),F3t=A3t("Reflect","ownKeys")||function(e){var t=M3t.f(L3t(e)),r=$3t.f;return r?N3t(t,r(e)):t},tye=Ky,j3t=F3t,B3t=Cre,H3t=uE,U3t=function(n,e,t){for(var r=j3t(e),i=H3t.f,o=B3t.f,s=0;s<r.length;s++){var a=r[s];!tye(n,a)&&!(t&&tye(t,a))&&i(n,a,o(e,a))}},z3t=ou,V3t=su,W3t=/#|\.prototype\./,ID=function(n,e){var t=K3t[q3t(n)];return t===Z3t?!0:t===G3t?!1:V3t(e)?z3t(e):!!e},q3t=ID.normalize=function(n){return String(n).replace(W3t,".").toLowerCase()},K3t=ID.data={},G3t=ID.NATIVE="N",Z3t=ID.POLYFILL="P",X3t=ID,G5=Xu,Y3t=Cre.f,J3t=Tre,Q3t=ZMe,eTt=Ire,tTt=U3t,nTt=X3t,dE=function(n,e){var t=n.target,r=n.global,i=n.stat,o,s,a,c,l,u;if(r?s=G5:i?s=G5[t]||eTt(t,{}):s=G5[t]&&G5[t].prototype,s)for(a in e){if(l=e[a],n.dontCallGetSet?(u=Y3t(s,a),c=u&&u.value):c=s[a],o=nTt(r?a:t+(i?".":"#")+a,n.forced),!o&&c!==void 0){if(typeof l==typeof c)continue;tTt(l,c)}(n.sham||c&&c.sham)&&J3t(l,"sham",!0),Q3t(s,a,l,n)}},e6e={},rTt=JMe,iTt=Ore,oTt=Object.keys||function(e){return rTt(e,iTt)},sTt=qy,aTt=HMe,cTt=uE,lTt=f_,uTt=vN,dTt=oTt;e6e.f=sTt&&!aTt?Object.defineProperties:function(e,t){lTt(e);for(var r=uTt(t),i=dTt(t),o=i.length,s=0,a;o>s;)cTt.f(e,a=i[s++],r[a]);return e};var hTt=yN,fTt=hTt("document","documentElement"),pTt=f_,gTt=e6e,nye=Ore,mTt=Rre,vTt=fTt,yTt=jMe,bTt=WMe,rye=">",iye="<",FZ="prototype",jZ="script",t6e=bTt("IE_PROTO"),dU=function(){},n6e=function(n){return iye+jZ+rye+n+iye+"/"+jZ+rye},oye=function(n){n.write(n6e("")),n.close();var e=n.parentWindow.Object;return n=null,e},STt=function(){var n=yTt("iframe"),e="java"+jZ+":",t;return n.style.display="none",vTt.appendChild(n),n.src=String(e),t=n.contentWindow.document,t.open(),t.write(n6e("document.F=Object")),t.close(),t.F},Z5,fO=function(){try{Z5=new ActiveXObject("htmlfile")}catch{}fO=typeof document<"u"?document.domain&&Z5?oye(Z5):STt():oye(Z5);for(var n=nye.length;n--;)delete fO[FZ][nye[n]];return fO()};mTt[t6e]=!0;var r6e=Object.create||function(e,t){var r;return e!==null?(dU[FZ]=pTt(e),r=new dU,dU[FZ]=null,r[t6e]=e):r=fO(),t===void 0?r:gTt.f(r,t)},_Tt=Cv,wTt=r6e,CTt=uE.f,BZ=_Tt("unscopables"),HZ=Array.prototype;HZ[BZ]===void 0&&CTt(HZ,BZ,{configurable:!0,value:wTt(null)});var Mre=function(n){HZ[BZ][n]=!0},xTt=dE,ETt=xD,ITt=ED,PTt=p_,kTt=Mre;xTt({target:"Array",proto:!0},{at:function(e){var t=ETt(this),r=ITt(t),i=PTt(e),o=i>=0?i:r+i;return o<0||o>=r?void 0:t[o]}});kTt("at");var TTt=Xu,DTt=bc,PD=function(n,e){return DTt(TTt[n].prototype[e])},RTt=PD;RTt("Array","at");var ATt=cE,i6e=Array.isArray||function(e){return ATt(e)==="Array"},OTt=TypeError,MTt=9007199254740991,$Tt=function(n){if(n>MTt)throw OTt("Maximum allowed index exceeded");return n},LTt=cE,NTt=bc,FTt=function(n){if(LTt(n)==="Function")return NTt(n)},sye=FTt,jTt=xre,BTt=gN,HTt=sye(sye.bind),UTt=function(n,e){return jTt(n),e===void 0?n:BTt?HTt(n,e):function(){return n.apply(e,arguments)}},zTt=i6e,VTt=ED,WTt=$Tt,qTt=UTt,o6e=function(n,e,t,r,i,o,s,a){for(var c=i,l=0,u=s?qTt(s,a):!1,d,h;l<r;)l in t&&(d=u?u(t[l],l,e):t[l],o>0&&zTt(d)?(h=VTt(d),c=o6e(n,e,d,h,c,o-1)-1):(WTt(c+1),n[c]=d),c++),l++;return c},s6e=o6e,KTt=Cv,GTt=KTt("toStringTag"),a6e={};a6e[GTt]="z";var ZTt=String(a6e)==="[object z]",XTt=ZTt,YTt=su,pO=cE,JTt=Cv,QTt=JTt("toStringTag"),eDt=Object,tDt=pO(function(){return arguments}())==="Arguments",nDt=function(n,e){try{return n[e]}catch{}},c6e=XTt?pO:function(n){var e,t,r;return n===void 0?"Undefined":n===null?"Null":typeof(t=nDt(e=eDt(n),QTt))=="string"?t:tDt?pO(e):(r=pO(e))==="Object"&&YTt(e.callee)?"Arguments":r},rDt=bc,iDt=ou,l6e=su,oDt=c6e,sDt=yN,aDt=VMe,u6e=function(){},d6e=sDt("Reflect","construct"),$re=/^\s*(?:class|function)\b/,cDt=rDt($re.exec),lDt=!$re.test(u6e),gI=function(e){if(!l6e(e))return!1;try{return d6e(u6e,[],e),!0}catch{return!1}},h6e=function(e){if(!l6e(e))return!1;switch(oDt(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return lDt||!!cDt($re,aDt(e))}catch{return!0}};h6e.sham=!0;var uDt=!d6e||iDt(function(){var n;return gI(gI.call)||!gI(Object)||!gI(function(){n=!0})||n})?h6e:gI,aye=i6e,dDt=uDt,hDt=h_,fDt=Cv,pDt=fDt("species"),cye=Array,gDt=function(n){var e;return aye(n)&&(e=n.constructor,dDt(e)&&(e===cye||aye(e.prototype))?e=void 0:hDt(e)&&(e=e[pDt],e===null&&(e=void 0))),e===void 0?cye:e},mDt=gDt,f6e=function(n,e){return new(mDt(n))(e===0?0:e)},vDt=dE,yDt=s6e,bDt=xre,SDt=xD,_Dt=ED,wDt=f6e;vDt({target:"Array",proto:!0},{flatMap:function(e){var t=SDt(this),r=_Dt(t),i;return bDt(e),i=wDt(t,0),i.length=yDt(i,t,t,r,0,1,e,arguments.length>1?arguments[1]:void 0),i}});var CDt=Mre;CDt("flatMap");var xDt=PD;xDt("Array","flatMap");var EDt=dE,IDt=s6e,PDt=xD,kDt=ED,TDt=p_,DDt=f6e;EDt({target:"Array",proto:!0},{flat:function(){var e=arguments.length?arguments[0]:void 0,t=PDt(this),r=kDt(t),i=DDt(t,0);return i.length=IDt(i,t,t,r,0,e===void 0?1:TDt(e)),i}});var RDt=Mre;RDt("flat");var ADt=PD;ADt("Array","flat");var ODt=c6e,MDt=String,kD=function(n){if(ODt(n)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return MDt(n)},$Dt=dE,LDt=bc,NDt=lE,FDt=p_,jDt=kD,BDt=ou,HDt=LDt("".charAt),UDt=BDt(function(){return"𠮷".at(-2)!=="\uD842"});$Dt({target:"String",proto:!0,forced:UDt},{at:function(e){var t=jDt(NDt(this)),r=t.length,i=FDt(e),o=i>=0?i:r+i;return o<0||o>=r?void 0:HDt(t,o)}});var zDt=PD;zDt("String","at");var VDt=f_,p6e=function(){var n=VDt(this),e="";return n.hasIndices&&(e+="d"),n.global&&(e+="g"),n.ignoreCase&&(e+="i"),n.multiline&&(e+="m"),n.dotAll&&(e+="s"),n.unicode&&(e+="u"),n.unicodeSets&&(e+="v"),n.sticky&&(e+="y"),e},Lre=ou,WDt=Xu,Nre=WDt.RegExp,Fre=Lre(function(){var n=Nre("a","y");return n.lastIndex=2,n.exec("abcd")!==null}),qDt=Fre||Lre(function(){return!Nre("a","y").sticky}),KDt=Fre||Lre(function(){var n=Nre("^r","gy");return n.lastIndex=2,n.exec("str")!==null}),GDt={BROKEN_CARET:KDt,MISSED_STICKY:qDt,UNSUPPORTED_Y:Fre},ZDt=ou,XDt=Xu,YDt=XDt.RegExp,JDt=ZDt(function(){var n=YDt(".","s");return!(n.dotAll&&n.test(`
`)&&n.flags==="s")}),QDt=ou,eRt=Xu,tRt=eRt.RegExp,nRt=QDt(function(){var n=tRt("(?<a>b)","g");return n.exec("b").groups.a!=="b"||"b".replace(n,"$<a>c")!=="bc"}),iC=wv,bN=bc,rRt=kD,iRt=p6e,oRt=GDt,sRt=kre,aRt=r6e,cRt=KMe.get,lRt=JDt,uRt=nRt,dRt=sRt("native-string-replace",String.prototype.replace),U8=RegExp.prototype.exec,UZ=U8,hRt=bN("".charAt),fRt=bN("".indexOf),pRt=bN("".replace),hU=bN("".slice),zZ=function(){var n=/a/,e=/b*/g;return iC(U8,n,"a"),iC(U8,e,"a"),n.lastIndex!==0||e.lastIndex!==0}(),g6e=oRt.BROKEN_CARET,VZ=/()??/.exec("")[1]!==void 0,gRt=zZ||VZ||g6e||lRt||uRt;gRt&&(UZ=function(e){var t=this,r=cRt(t),i=rRt(e),o=r.raw,s,a,c,l,u,d,h;if(o)return o.lastIndex=t.lastIndex,s=iC(UZ,o,i),t.lastIndex=o.lastIndex,s;var f=r.groups,p=g6e&&t.sticky,g=iC(iRt,t),m=t.source,v=0,b=i;if(p&&(g=pRt(g,"y",""),fRt(g,"g")===-1&&(g+="g"),b=hU(i,t.lastIndex),t.lastIndex>0&&(!t.multiline||t.multiline&&hRt(i,t.lastIndex-1)!==`
`)&&(m="(?: "+m+")",b=" "+b,v++),a=new RegExp("^(?:"+m+")",g)),VZ&&(a=new RegExp("^"+m+"$(?!\\s)",g)),zZ&&(c=t.lastIndex),l=iC(U8,p?a:t,b),p?l?(l.input=hU(l.input,v),l[0]=hU(l[0],v),l.index=t.lastIndex,t.lastIndex+=l[0].length):t.lastIndex=0:zZ&&l&&(t.lastIndex=t.global?l.index+l[0].length:c),VZ&&l&&l.length>1&&iC(dRt,l[0],a,function(){for(u=1;u<arguments.length-2;u++)arguments[u]===void 0&&(l[u]=void 0)}),l&&f)for(l.groups=d=aRt(null),u=0;u<f.length;u++)h=f[u],d[h[0]]=l[h[1]];return l});var jre=UZ,mRt=dE,lye=jre;mRt({target:"RegExp",proto:!0,forced:/./.exec!==lye},{exec:lye});var vRt=gN,m6e=Function.prototype,uye=m6e.apply,dye=m6e.call,yRt=typeof Reflect=="object"&&Reflect.apply||(vRt?dye.bind(uye):function(){return dye.apply(uye,arguments)}),hye=wv,fye=ZMe,bRt=jre,pye=ou,v6e=Cv,SRt=Tre,_Rt=v6e("species"),fU=RegExp.prototype,wRt=function(n,e,t,r){var i=v6e(n),o=!pye(function(){var l={};return l[i]=function(){return 7},""[n](l)!==7}),s=o&&!pye(function(){var l=!1,u=/a/;return n==="split"&&(u={},u.constructor={},u.constructor[_Rt]=function(){return u},u.flags="",u[i]=/./[i]),u.exec=function(){return l=!0,null},u[i](""),!l});if(!o||!s||t){var a=/./[i],c=e(i,""[n],function(l,u,d,h,f){var p=u.exec;return p===bRt||p===fU.exec?o&&!f?{done:!0,value:hye(a,u,d,h)}:{done:!0,value:hye(l,d,u,h)}:{done:!1}});fye(String.prototype,n,c[0]),fye(fU,i,c[1])}r&&SRt(fU[i],"sham",!0)},Bre=bc,CRt=p_,xRt=kD,ERt=lE,IRt=Bre("".charAt),gye=Bre("".charCodeAt),PRt=Bre("".slice),mye=function(n){return function(e,t){var r=xRt(ERt(e)),i=CRt(t),o=r.length,s,a;return i<0||i>=o?n?"":void 0:(s=gye(r,i),s<55296||s>56319||i+1===o||(a=gye(r,i+1))<56320||a>57343?n?IRt(r,i):s:n?PRt(r,i,i+2):(s-55296<<10)+(a-56320)+65536)}},kRt={codeAt:mye(!1),charAt:mye(!0)},TRt=kRt.charAt,DRt=function(n,e,t){return e+(t?TRt(n,e).length:1)},Hre=bc,RRt=xD,ARt=Math.floor,pU=Hre("".charAt),ORt=Hre("".replace),gU=Hre("".slice),MRt=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,$Rt=/\$([$&'`]|\d{1,2})/g,y6e=function(n,e,t,r,i,o){var s=t+n.length,a=r.length,c=$Rt;return i!==void 0&&(i=RRt(i),c=MRt),ORt(o,c,function(l,u){var d;switch(pU(u,0)){case"$":return"$";case"&":return n;case"`":return gU(e,0,t);case"'":return gU(e,s);case"<":d=i[gU(u,1,-1)];break;default:var h=+u;if(h===0)return l;if(h>a){var f=ARt(h/10);return f===0?l:f<=a?r[f-1]===void 0?pU(u,1):r[f-1]+pU(u,1):l}d=r[h-1]}return d===void 0?"":d})},vye=wv,LRt=f_,NRt=su,FRt=cE,jRt=jre,BRt=TypeError,HRt=function(n,e){var t=n.exec;if(NRt(t)){var r=vye(t,n,e);return r!==null&&LRt(r),r}if(FRt(n)==="RegExp")return vye(jRt,n,e);throw new BRt("RegExp#exec called on incompatible receiver")},URt=yRt,yye=wv,SN=bc,zRt=wRt,VRt=ou,WRt=f_,qRt=su,KRt=mN,GRt=p_,ZRt=YMe,lw=kD,XRt=lE,YRt=DRt,JRt=Ere,QRt=y6e,e5t=HRt,t5t=Cv,WZ=t5t("replace"),n5t=Math.max,r5t=Math.min,i5t=SN([].concat),mU=SN([].push),bye=SN("".indexOf),Sye=SN("".slice),o5t=function(n){return n===void 0?n:String(n)},s5t=function(){return"a".replace(/./,"$0")==="$0"}(),_ye=function(){return/./[WZ]?/./[WZ]("a","$0")==="":!1}(),a5t=!VRt(function(){var n=/./;return n.exec=function(){var e=[];return e.groups={a:"7"},e},"".replace(n,"$<a>")!=="7"});zRt("replace",function(n,e,t){var r=_ye?"$":"$0";return[function(o,s){var a=XRt(this),c=KRt(o)?void 0:JRt(o,WZ);return c?yye(c,o,a,s):yye(e,lw(a),o,s)},function(i,o){var s=WRt(this),a=lw(i);if(typeof o=="string"&&bye(o,r)===-1&&bye(o,"$<")===-1){var c=t(e,s,a,o);if(c.done)return c.value}var l=qRt(o);l||(o=lw(o));var u=s.global,d;u&&(d=s.unicode,s.lastIndex=0);for(var h=[],f;f=e5t(s,a),!(f===null||(mU(h,f),!u));){var p=lw(f[0]);p===""&&(s.lastIndex=YRt(a,ZRt(s.lastIndex),d))}for(var g="",m=0,v=0;v<h.length;v++){f=h[v];for(var b=lw(f[0]),S=n5t(r5t(GRt(f.index),a.length),0),E=[],w,C=1;C<f.length;C++)mU(E,o5t(f[C]));var I=f.groups;if(l){var T=i5t([b],E,S,a);I!==void 0&&mU(T,I),w=lw(URt(o,void 0,T))}else w=QRt(b,a,S,E,I,o);S>=m&&(g+=Sye(a,m,S)+w,m=S+b.length)}return g+Sye(a,m)}]},!a5t||!s5t||_ye);var c5t=h_,l5t=cE,u5t=Cv,d5t=u5t("match"),h5t=function(n){var e;return c5t(n)&&((e=n[d5t])!==void 0?!!e:l5t(n)==="RegExp")},f5t=wv,p5t=Ky,g5t=RMe,m5t=p6e,wye=RegExp.prototype,v5t=function(n){var e=n.flags;return e===void 0&&!("flags"in wye)&&!p5t(n,"flags")&&g5t(wye,n)?f5t(m5t,n):e},y5t=dE,b5t=wv,Ure=bc,Cye=lE,S5t=su,_5t=mN,w5t=h5t,mI=kD,C5t=Ere,x5t=v5t,E5t=y6e,I5t=Cv,P5t=I5t("replace"),k5t=TypeError,vU=Ure("".indexOf);Ure("".replace);var xye=Ure("".slice),T5t=Math.max;y5t({target:"String",proto:!0},{replaceAll:function(e,t){var r=Cye(this),i,o,s,a,c,l,u,d,h,f=0,p=0,g="";if(!_5t(e)){if(i=w5t(e),i&&(o=mI(Cye(x5t(e))),!~vU(o,"g")))throw new k5t("`.replaceAll` does not allow non-global regexes");if(s=C5t(e,P5t),s)return b5t(s,e,r,t)}for(a=mI(r),c=mI(e),l=S5t(t),l||(t=mI(t)),u=c.length,d=T5t(1,u),f=vU(a,c);f!==-1;)h=l?mI(t(c,f,a)):E5t(c,a,f,[],void 0,t),g+=xye(a,p,f)+h,p=f+u,f=f+d>a.length?-1:vU(a,c,f+d);return p<a.length&&(g+=xye(a,p)),g}});var D5t=PD;D5t("String","replaceAll");class gO{constructor(e){$(this,"nextValue");$(this,"diff");this.previousValue=e}get(){var r,i,o,s;const e=((i=(r=this.diff)==null?void 0:r.removed)==null?void 0:i.size)??0,t=((s=(o=this.diff)==null?void 0:o.added)==null?void 0:s.size)??0;if(!(e===0&&t===0))return{value:this.nextValue,diff:this.diff}}_add(e,t){var r,i;this.nextValue??(this.nextValue=new Set(this.previousValue)),this.nextValue.add(e),this.diff??(this.diff={}),t?(r=this.diff.removed)==null||r.delete(e):((i=this.diff).added??(i.added=new Set),this.diff.added.add(e))}add(e){var i,o,s;const t=this.previousValue.has(e);if(t)return((o=(i=this.diff)==null?void 0:i.removed)==null?void 0:o.has(e))?this._add(e,t):void 0;(s=this.nextValue)!=null&&s.has(e)||this._add(e,t)}_remove(e,t){var r,i;this.nextValue??(this.nextValue=new Set(this.previousValue)),this.nextValue.delete(e),this.diff??(this.diff={}),t?((r=this.diff).removed??(r.removed=new Set),this.diff.removed.add(e)):(i=this.diff.added)==null||i.delete(e)}remove(e){var i,o,s,a;const t=this.previousValue.has(e);if(!t)return((o=(i=this.diff)==null?void 0:i.added)==null?void 0:o.has(e))?this._remove(e,t):void 0;(a=(s=this.diff)==null?void 0:s.removed)!=null&&a.has(e)||this._remove(e,t)}}var b6e="Expected a function",Eye=NaN,R5t="[object Symbol]",A5t=/^\s+|\s+$/g,O5t=/^[-+]0x[0-9a-f]+$/i,M5t=/^0b[01]+$/i,$5t=/^0o[0-7]+$/i,L5t=parseInt,N5t=typeof Ir=="object"&&Ir&&Ir.Object===Object&&Ir,F5t=typeof self=="object"&&self&&self.Object===Object&&self,j5t=N5t||F5t||Function("return this")(),B5t=Object.prototype,H5t=B5t.toString,U5t=Math.max,z5t=Math.min,yU=function(){return j5t.Date.now()};function V5t(n,e,t){var r,i,o,s,a,c,l=0,u=!1,d=!1,h=!0;if(typeof n!="function")throw new TypeError(b6e);e=Iye(e)||0,z8(t)&&(u=!!t.leading,d="maxWait"in t,o=d?U5t(Iye(t.maxWait)||0,e):o,h="trailing"in t?!!t.trailing:h);function f(C){var I=r,T=i;return r=i=void 0,l=C,s=n.apply(T,I),s}function p(C){return l=C,a=setTimeout(v,e),u?f(C):s}function g(C){var I=C-c,T=C-l,D=e-I;return d?z5t(D,o-T):D}function m(C){var I=C-c,T=C-l;return c===void 0||I>=e||I<0||d&&T>=o}function v(){var C=yU();if(m(C))return b(C);a=setTimeout(v,g(C))}function b(C){return a=void 0,h&&r?f(C):(r=i=void 0,s)}function S(){a!==void 0&&clearTimeout(a),l=0,r=c=i=a=void 0}function E(){return a===void 0?s:b(yU())}function w(){var C=yU(),I=m(C);if(r=arguments,i=this,c=C,I){if(a===void 0)return p(c);if(d)return a=setTimeout(v,e),f(c)}return a===void 0&&(a=setTimeout(v,e)),s}return w.cancel=S,w.flush=E,w}function W5t(n,e,t){var r=!0,i=!0;if(typeof n!="function")throw new TypeError(b6e);return z8(t)&&(r="leading"in t?!!t.leading:r,i="trailing"in t?!!t.trailing:i),V5t(n,e,{leading:r,maxWait:e,trailing:i})}function z8(n){var e=typeof n;return!!n&&(e=="object"||e=="function")}function q5t(n){return!!n&&typeof n=="object"}function K5t(n){return typeof n=="symbol"||q5t(n)&&H5t.call(n)==R5t}function Iye(n){if(typeof n=="number")return n;if(K5t(n))return Eye;if(z8(n)){var e=typeof n.valueOf=="function"?n.valueOf():n;n=z8(e)?e+"":e}if(typeof n!="string")return n===0?n:+n;n=n.replace(A5t,"");var t=M5t.test(n);return t||$5t.test(n)?L5t(n.slice(2),t?2:8):O5t.test(n)?Eye:+n}var G5t=W5t;const S6e=Fy(G5t);var Z5t=200,zre="__lodash_hash_undefined__",X5t=1/0,Y5t="[object Function]",J5t="[object GeneratorFunction]",Q5t=/[\\^$.*+?()[\]{}|]/g,eAt=/^\[object .+?Constructor\]$/,tAt=typeof Ir=="object"&&Ir&&Ir.Object===Object&&Ir,nAt=typeof self=="object"&&self&&self.Object===Object&&self,Vre=tAt||nAt||Function("return this")();function rAt(n,e){var t=n?n.length:0;return!!t&&oAt(n,e,0)>-1}function iAt(n,e,t,r){for(var i=n.length,o=t+-1;++o<i;)if(e(n[o],o,n))return o;return-1}function oAt(n,e,t){if(e!==e)return iAt(n,sAt,t);for(var r=t-1,i=n.length;++r<i;)if(n[r]===e)return r;return-1}function sAt(n){return n!==n}function aAt(n,e){return n.has(e)}function cAt(n,e){return n==null?void 0:n[e]}function lAt(n){var e=!1;if(n!=null&&typeof n.toString!="function")try{e=!!(n+"")}catch{}return e}function _6e(n){var e=-1,t=Array(n.size);return n.forEach(function(r){t[++e]=r}),t}var uAt=Array.prototype,dAt=Function.prototype,w6e=Object.prototype,bU=Vre["__core-js_shared__"],Pye=function(){var n=/[^.]+$/.exec(bU&&bU.keys&&bU.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}(),C6e=dAt.toString,Wre=w6e.hasOwnProperty,hAt=w6e.toString,fAt=RegExp("^"+C6e.call(Wre).replace(Q5t,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),pAt=uAt.splice,gAt=qre(Vre,"Map"),SU=qre(Vre,"Set"),N3=qre(Object,"create");function jS(n){var e=-1,t=n?n.length:0;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}function mAt(){this.__data__=N3?N3(null):{}}function vAt(n){return this.has(n)&&delete this.__data__[n]}function yAt(n){var e=this.__data__;if(N3){var t=e[n];return t===zre?void 0:t}return Wre.call(e,n)?e[n]:void 0}function bAt(n){var e=this.__data__;return N3?e[n]!==void 0:Wre.call(e,n)}function SAt(n,e){var t=this.__data__;return t[n]=N3&&e===void 0?zre:e,this}jS.prototype.clear=mAt;jS.prototype.delete=vAt;jS.prototype.get=yAt;jS.prototype.has=bAt;jS.prototype.set=SAt;function hE(n){var e=-1,t=n?n.length:0;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}function _At(){this.__data__=[]}function wAt(n){var e=this.__data__,t=_N(e,n);if(t<0)return!1;var r=e.length-1;return t==r?e.pop():pAt.call(e,t,1),!0}function CAt(n){var e=this.__data__,t=_N(e,n);return t<0?void 0:e[t][1]}function xAt(n){return _N(this.__data__,n)>-1}function EAt(n,e){var t=this.__data__,r=_N(t,n);return r<0?t.push([n,e]):t[r][1]=e,this}hE.prototype.clear=_At;hE.prototype.delete=wAt;hE.prototype.get=CAt;hE.prototype.has=xAt;hE.prototype.set=EAt;function fE(n){var e=-1,t=n?n.length:0;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}function IAt(){this.__data__={hash:new jS,map:new(gAt||hE),string:new jS}}function PAt(n){return wN(this,n).delete(n)}function kAt(n){return wN(this,n).get(n)}function TAt(n){return wN(this,n).has(n)}function DAt(n,e){return wN(this,n).set(n,e),this}fE.prototype.clear=IAt;fE.prototype.delete=PAt;fE.prototype.get=kAt;fE.prototype.has=TAt;fE.prototype.set=DAt;function V8(n){var e=-1,t=n?n.length:0;for(this.__data__=new fE;++e<t;)this.add(n[e])}function RAt(n){return this.__data__.set(n,zre),this}function AAt(n){return this.__data__.has(n)}V8.prototype.add=V8.prototype.push=RAt;V8.prototype.has=AAt;function _N(n,e){for(var t=n.length;t--;)if(BAt(n[t][0],e))return t;return-1}function OAt(n){if(!x6e(n)||NAt(n))return!1;var e=HAt(n)||lAt(n)?fAt:eAt;return e.test(FAt(n))}function MAt(n,e,t){var r=-1,i=rAt,o=n.length,s=!0,a=[],c=a;if(o>=Z5t){var l=$At(n);if(l)return _6e(l);s=!1,i=aAt,c=new V8}else c=a;e:for(;++r<o;){var u=n[r],d=u;if(u=u!==0?u:0,s&&d===d){for(var h=c.length;h--;)if(c[h]===d)continue e;a.push(u)}else i(c,d,t)||(c!==a&&c.push(d),a.push(u))}return a}var $At=SU&&1/_6e(new SU([,-0]))[1]==X5t?function(n){return new SU(n)}:UAt;function wN(n,e){var t=n.__data__;return LAt(e)?t[typeof e=="string"?"string":"hash"]:t.map}function qre(n,e){var t=cAt(n,e);return OAt(t)?t:void 0}function LAt(n){var e=typeof n;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?n!=="__proto__":n===null}function NAt(n){return!!Pye&&Pye in n}function FAt(n){if(n!=null){try{return C6e.call(n)}catch{}try{return n+""}catch{}}return""}function jAt(n){return n&&n.length?MAt(n):[]}function BAt(n,e){return n===e||n!==n&&e!==e}function HAt(n){var e=x6e(n)?hAt.call(n):"";return e==Y5t||e==J5t}function x6e(n){var e=typeof n;return!!n&&(e=="object"||e=="function")}function UAt(){}var zAt=jAt;const VAt=Fy(zAt),pP={Good:"#40C057",Mid:"#FFC078",Poor:"#E03131"},WAt=pP.Good;class E6e{constructor(){$(this,"startTime",0);$(this,"name","");$(this,"frames",0);$(this,"started",!1);$(this,"frame",null);$(this,"recordFrame",()=>{this.frames++,this.started&&(this.frame=requestAnimationFrame(this.recordFrame))})}start(e){this.name=e,this.frames=0,this.started=!0,this.frame!==null&&cancelAnimationFrame(this.frame),this.frame=requestAnimationFrame(this.recordFrame),this.startTime=performance.now()}stop(){this.started=!1,this.frame!==null&&cancelAnimationFrame(this.frame);const e=(performance.now()-this.startTime)/1e3,t=e===0?0:Math.floor(this.frames/e),r=t>55?pP.Good:t>30?pP.Mid:pP.Poor,i=r===pP.Mid?"black":"white",o=this.name[0].toUpperCase()+this.name.slice(1);console.debug(`%cPerf%c ${o} %c${t}%c fps`,`color: white; background: ${WAt};padding: 2px;border-radius: 3px;`,"font-weight: normal",`font-weight: bold; padding: 2px; background: ${r};color: ${i};`,"font-weight: normal")}isStarted(){return this.started}}function Kre(n,e){const t=[];e:for(const r of n){for(const i of t)if(e?e(r,i):r===i)continue e;t.push(r)}return t}function qr(n){return n.filter(e=>e!=null)}function Mc(n){return n[n.length-1]}function qAt(n,e){let t,r=1/0;for(const i of n){const o=e(i);o<r&&(t=i,r=o)}return t}function KAt(n,e){if(n===e)return!0;if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(!Object.is(n[t],e[t]))return!1;return!0}class uv{constructor(){$(this,"items",new WeakMap)}get(e,t){return this.items.has(e)||this.items.set(e,t(e)),this.items.get(e)}}function I6e(n){const e=(...t)=>{try{return n(...t)}catch(r){throw r instanceof Error&&Error.captureStackTrace&&Error.captureStackTrace(r,e),r}};return e}const W8=()=>{},iy={ok(n){return{ok:!0,value:n}},err(n){return{ok:!1,error:n}}};function vl(n,e){const t=e&&n&&typeof n=="object"&&e in n?n[e]:n;throw new Error(`Unknown switch case ${t}`)}const ds=I6e((n,e)=>{if(!n)throw new Error(e||"Assertion Error")}),xh=I6e((n,e)=>{if(n==null)throw new Error(e??"value must be defined");return n});function P6e(n,e){let t;const r=(...i)=>(t||(t={},t.promise=new Promise((o,s)=>{t.resolve=o,t.reject=s})),clearTimeout(t.timeout),t.latestArgs=i,t.timeout=setTimeout(()=>{const o=t;t=void 0;try{o.resolve(n(...o.latestArgs))}catch(s){o.reject(s)}},e),t.promise);return r.cancel=()=>{t&&clearTimeout(t.timeout)},r}const kye=new WeakMap;function Gre(n,e){if(typeof n!="object"||n===null)return;let t=kye.get(n);t||(t={tags:{},extras:{}},kye.set(n,t)),e.tags&&(t.tags={...t.tags,...e.tags}),e.extras&&(t.extras={...t.extras,...e.extras})}async function vg(n,e){return window.fetch(n,{referrerPolicy:"strict-origin-when-cross-origin",...e})}const rx=(n,e)=>{const t=new window.Image(n,e);return t.referrerPolicy="strict-origin-when-cross-origin",t};class dS{static async dataUrlToArrayBuffer(e){return vg(e).then(function(t){return t.arrayBuffer()})}static async blobToDataUrl(e){return await new Promise((t,r)=>{if(e){const i=new FileReader;i.onload=()=>t(i.result),i.onerror=o=>r(o),i.onabort=o=>r(o),i.readAsDataURL(e)}})}static async blobToText(e){return await new Promise((t,r)=>{if(e){const i=new FileReader;i.onload=()=>t(i.result),i.onerror=o=>r(o),i.onabort=o=>r(o),i.readAsText(e)}})}}function qZ(n){let e=0;for(let t=0;t<n.length;t++)e=(e<<5)-e+n.charCodeAt(t),e|=0;return e+""}function GAt(n){const e=new DataView(n);let t=0;for(let r=0;r<e.byteLength;r++)t=(t<<5)-t+e.getUint8(r),t|=0;return t+""}/*!
 * MIT License: https://github.com/vHeemstra/is-apng/blob/main/license
 * Copyright (c) Philip van Heemstra
 */function ZAt(n){const e=new Uint8Array(n);if(!e||!(typeof Buffer<"u"&&Buffer.isBuffer(e)||e instanceof Uint8Array)||e.length<16||!(e[0]===137&&e[1]===80&&e[2]===78&&e[3]===71&&e[4]===13&&e[5]===10&&e[6]===26&&e[7]===10))return!1;function r(o,s,a,c,l=1024){if(!s)return-1;s=new RegExp(s,"g");const u=s.source.length,d=new TextDecoder,h=o.length;if(typeof c>"u"&&(c=h),a>=h||c<=0||a>=c)return-1;o=o.subarray(a,c);let f=-1,p=0,g=0,m="";e:for(;p<o.length;){const v=p+l,b=o.subarray(p,v),S=d.decode(b,{stream:!0}),E=m+S;let w,C=-1;for(;(w=s.exec(E))!==null;){C=w.index-m.length,f=g+C;break e}p=v,g+=S.length;const I=C>-1?C+u:S.length-u;m=S.slice(I)}return f>=0&&(f+=a>=0?a:h+a),f}const i=r(e,"IDAT",12);return i>=12?r(e,"acTL",8,i)>=8:!1}const XAt=n=>new Uint8Array(n)[3]===44;/*!
 * MIT License
 * Modified code originally from <https://github.com/qzb/is-animated>
 * Copyright (c) 2016 Józef Sokołowski <j.k.sokolowski@gmail.com>
 */function Tye(n,e){let t=0;for(;n[e+t];)t+=n[e+t]+1;return t+1}function YAt(n){return new TextDecoder("ascii").decode(n.slice(0,3))==="GIF"}function JAt(n){const e=new Uint8Array(n);let t,r,i=0,o=0;if(!YAt(n))return!1;for(t=e[10]&128,r=e[10]&7,i+=6,i+=7,i+=t?3*Math.pow(2,r+1):0;o<2&&i<e.length;)switch(e[i]){case 44:o+=1,t=e[i+9]&128,r=e[i+9]&7,i+=10,i+=t?3*Math.pow(2,r+1):0,i+=Tye(e,i+1)+1;break;case 33:i+=2,i+=Tye(e,i);break;case 59:i=e.length;break;default:i=e.length;break}return o>1}let KZ=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];typeof Int32Array<"u"&&(KZ=new Int32Array(KZ));/*!
 * MIT License: https://github.com/alexgorbatchev/crc/blob/master/LICENSE
 * Copyright: 2014 Alex Gorbatchev
 * Code: crc32, https://github.com/alexgorbatchev/crc/blob/master/src/calculators/crc32.ts
 */const QAt=(n,e)=>{let t=~~e^-1;for(let r=0;r<n.length;r++)t=KZ[(t^n[r])&255]^t>>>8;return t^-1},Dye=4,Rye=4;class Bp{static isPng(e,t){return e.getUint8(t+0)===137&&e.getUint8(t+1)===80&&e.getUint8(t+2)===78&&e.getUint8(t+3)===71&&e.getUint8(t+4)===13&&e.getUint8(t+5)===10&&e.getUint8(t+6)===26&&e.getUint8(t+7)===10}static getChunkType(e,t){return[String.fromCharCode(e.getUint8(t)),String.fromCharCode(e.getUint8(t+1)),String.fromCharCode(e.getUint8(t+2)),String.fromCharCode(e.getUint8(t+3))].join("")}static readChunks(e,t=0){const r={};if(!Bp.isPng(e,t))throw new Error("Not a PNG");for(t+=8;t<=e.buffer.byteLength;){const i=t,o=e.getInt32(t);t+=4;const s=Bp.getChunkType(e,t);if(s==="IDAT"&&r[s]){t+=o+Dye+Rye;continue}if(s==="IEND")break;r[s]={start:i,dataOffset:t+4,size:o},t+=o+Dye+Rye}return r}static parsePhys(e,t){return{ppux:e.getUint32(t),ppuy:e.getUint32(t+4),unit:e.getUint8(t+4)}}static findChunk(e,t){return Bp.readChunks(e)[t]}static setPhysChunk(e,t=1,r){let i=46,o=0;const s=Bp.findChunk(e,"pHYs");s&&(i=s.start,o=s.size);const a=Bp.findChunk(e,"IDAT");a&&(i=a.start,o=0);const c=new ArrayBuffer(21),l=new DataView(c);l.setUint32(0,9),l.setUint8(4,112),l.setUint8(5,72),l.setUint8(6,89),l.setUint8(7,115);const u=2835.5;l.setInt32(8,u*t),l.setInt32(12,u*t),l.setInt8(16,1);const d=new Uint8Array(c.slice(4,17));l.setInt32(17,QAt(d));const h=e.buffer.slice(0,i),f=e.buffer.slice(i+o);return new Blob([h,c,f],r)}}/*!
 * MIT License: https://github.com/sindresorhus/is-webp/blob/main/license
 * Copyright (c) Sindre Sorhus <sindresorhus@gmail.com> (https://sindresorhus.com)
 */function e4t(n){return!n||n.length<12?!1:n[8]===87&&n[9]===69&&n[10]===66&&n[11]===80}function t4t(n){const e=new Uint8Array(n);return!e4t(e)||!e||e.length<21?!1:(e[20]>>1&1)===1}const k6e=Object.freeze(["image/svg+xml"]),T6e=Object.freeze(["image/jpeg","image/png","image/webp"]),D6e=Object.freeze(["image/gif","image/apng","image/avif"]),Zre=Object.freeze([...T6e,...k6e,...D6e]),R6e=Object.freeze(["video/mp4","video/webm","video/quicktime"]),n4t=[...Zre,...R6e].join(",");class Zp{static loadVideo(e){return new Promise((t,r)=>{const i=document.createElement("video");i.onloadeddata=()=>t(i),i.onerror=o=>{console.error(o),r(new Error("Could not load video"))},i.crossOrigin="anonymous",i.src=e})}static loadImage(e){return new Promise((t,r)=>{const i=rx();i.onload=()=>t(i),i.onerror=o=>{console.error(o),r(new Error("Could not load image"))},i.crossOrigin="anonymous",i.referrerPolicy="strict-origin-when-cross-origin",i.src=e})}static async getVideoSize(e){return Zp.usingObjectURL(e,async t=>{const r=await Zp.loadVideo(t);return{w:r.videoWidth,h:r.videoHeight}})}static async getImageSize(e){const t=await Zp.usingObjectURL(e,Zp.loadImage);try{if(e.type==="image/png"){const r=new DataView(await e.arrayBuffer());if(Bp.isPng(r,0)){const i=Bp.findChunk(r,"pHYs");if(i){const o=Bp.parsePhys(r,i.dataOffset);if(o.unit===0&&o.ppux===o.ppuy){const s=Math.max(o.ppux/2834.5,1);return{w:Math.round(t.naturalWidth/s),h:Math.round(t.naturalHeight/s)}}}}}}catch(r){return console.error(r),{w:t.naturalWidth,h:t.naturalHeight}}return{w:t.naturalWidth,h:t.naturalHeight}}static async isAnimated(e){return e.type==="image/gif"?JAt(await e.arrayBuffer()):e.type==="image/avif"?XAt(await e.arrayBuffer()):e.type==="image/webp"?t4t(await e.arrayBuffer()):e.type==="image/apng"?ZAt(await e.arrayBuffer()):!1}static isAnimatedImageType(e){return D6e.includes(e||"")}static isStaticImageType(e){return T6e.includes(e||"")}static isVectorImageType(e){return k6e.includes(e||"")}static isImageType(e){return Zre.includes(e)}static async usingObjectURL(e,t){const r=URL.createObjectURL(e);try{return await t(r)}finally{URL.revokeObjectURL(r)}}}function X5(n,e,t){return n+(e-n)*t}function ip(n=""){let e=0,t=0,r=0,i=0;function o(){const s=e^e<<11;return e=t,t=r,r=i,i^=(i>>>19^s^s>>>8)>>>0,i/4294967296*2}for(let s=0;s<n.length+64;s++)e^=n.charCodeAt(s)|0,o();return o}function ix(n,e,t,r=!1){const[i,o]=e,[s,a]=t,c=s+(n-i)/(o-i)*(a-s);return r?s<a?Math.max(Math.min(c,a),s):Math.max(Math.min(c,s),a):c}function ig(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function ju(n,e){if(ig(n,e))return n[e]}function Aye(n){return Object.keys(n)}function Rs(n){return Object.values(n)}function Uu(n){return Object.entries(n)}function A6e(n){return Object.fromEntries(n)}function dk(n,e){const t={};let r=!1;for(const[i,o]of Uu(n))e(i,o)?t[i]=o:r=!0;return r?t:n}function TD(n,e){const t={};for(const[r,i]of Uu(n)){const o=e(r,i);t[r]=o}return t}function O6e(n,e){if(n===e)return!0;const t=new Set(Object.keys(n)),r=new Set(Object.keys(e));if(t.size!==r.size)return!1;for(const i of t)if(!r.has(i)||!Object.is(n[i],e[i]))return!1;return!0}const Pd="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",M6e="a0",$6e="A00000000000000000000000000";function L6e(n){if(n>="a"&&n<="z")return n.charCodeAt(0)-97+2;if(n>="A"&&n<="Z")return 90-n.charCodeAt(0)+2;throw new Error("Invalid index key head: "+n)}function N6e(n){if(n.length!==L6e(n.charAt(0)))throw new Error("invalid integer part of index key: "+n)}function Oye(n){if(n===void 0)throw Error("n is undefined")}function Mye(n){N6e(n);const[e,...t]=n.split("");let r=!0;for(let i=t.length-1;r&&i>=0;i--){const o=Pd.indexOf(t[i])+1;o===Pd.length?t[i]="0":(t[i]=Pd.charAt(o),r=!1)}if(r){if(e==="Z")return"a0";if(e==="z")return;const i=String.fromCharCode(e.charCodeAt(0)+1);return i>"a"?t.push("0"):t.pop(),i+t.join("")}else return e+t.join("")}function r4t(n){N6e(n);const[e,...t]=n.split("");let r=!0;for(let i=t.length-1;r&&i>=0;i--){const o=Pd.indexOf(t[i])-1;o===-1?t[i]=Pd.slice(-1):(t[i]=Pd.charAt(o),r=!1)}if(r){if(e==="a")return"Z"+Pd.slice(-1);if(e==="A")return;const i=String.fromCharCode(e.charCodeAt(0)-1);return i<"Z"?t.push(Pd.slice(-1)):t.pop(),i+t.join("")}else return e+t.join("")}function oC(n,e){if(e!==void 0&&n>=e)throw new Error(n+" >= "+e);if(n.slice(-1)==="0"||e&&e.slice(-1)==="0")throw new Error("trailing zero");if(e){let i=0;for(;(n.charAt(i)||"0")===e.charAt(i);)i++;if(i>0)return e.slice(0,i)+oC(n.slice(i),e.slice(i))}const t=n?Pd.indexOf(n.charAt(0)):0,r=e!==void 0?Pd.indexOf(e.charAt(0)):Pd.length;if(r-t>1){const i=Math.round(.5*(t+r));return Pd.charAt(i)}else return e&&e.length>1?e.slice(0,1):Pd.charAt(t)+oC(n.slice(1),void 0)}function gP(n){const e=L6e(n.charAt(0));if(e>n.length)throw new Error("invalid index: "+n);return n.slice(0,e)}function GZ(n){if(n===$6e)throw new Error("invalid index: "+n);const e=gP(n);if(n.slice(e.length).slice(-1)==="0")throw new Error("invalid index: "+n)}function uw(n,e){if(n!==void 0&&GZ(n),e!==void 0&&GZ(e),n!==void 0&&e!==void 0&&n>=e)throw new Error(n+" >= "+e);if(n===void 0&&e===void 0)return M6e;if(n===void 0){if(e===void 0)throw Error("b is undefined");const a=gP(e),c=e.slice(a.length);if(a===$6e)return a+oC("",c);if(a<e)return a;const l=r4t(a);return Oye(l),l}if(e===void 0){const a=gP(n),c=n.slice(a.length),l=Mye(a);return l===void 0?a+oC(c,void 0):l}const t=gP(n),r=n.slice(t.length),i=gP(e),o=e.slice(i.length);if(t===i)return t+oC(r,o);const s=Mye(t);return Oye(s),s<e?s:t+oC(r,void 0)}function Iy(n,e,t){if(t===0)return[];if(t===1)return[uw(n,e)];if(e===void 0){let o=uw(n,e);const s=[o];for(let a=0;a<t-1;a++)o=uw(o,e),s.push(o);return s}if(n===void 0){let o=uw(n,e);const s=[o];for(let a=0;a<t-1;a++)o=uw(n,o),s.push(o);return s.reverse(),s}const r=Math.floor(t/2),i=uw(n,e);return[...Iy(n,i,r),i,...Iy(i,e,t-r-1)]}const i4t=M6e;function o4t(n){GZ(n)}function ox(n,e,t){return Iy(n,e,t)}function _U(n,e){return Iy(n,void 0,e)}function F3(n,e){return Iy(n,e,1)[0]}function Om(n){return Iy(n,void 0,1)[0]}function s4t(n){return Iy(void 0,n,1)[0]}function j3(n,e="a1"){return[e,...Iy(e,void 0,n)]}function ml(n,e){return n.index<e.index?-1:n.index>e.index?1:0}function a4t(n,e){return n.id>e.id?1:-1}function Xre(n){try{return localStorage.getItem(n)}catch{return null}}function Yre(n,e){try{localStorage.setItem(n,e)}catch{}}function c4t(){try{localStorage.clear()}catch{}}function F6e(n){try{return sessionStorage.getItem(n)}catch{return null}}function Jre(n,e){try{sessionStorage.setItem(n,e)}catch{}}function j6e(n){try{sessionStorage.removeItem(n)}catch{}}function l4t(){try{sessionStorage.clear()}catch{}}const u4t=()=>typeof process<"u"&&!1,sC=[],d4t=60,mO=Math.ceil(1e3/d4t);let vI,wU=0,ZZ=0;const h4t=()=>{const n=sC.splice(0,sC.length);for(const e of n)e()};function B6e(){if(vI)return;const n=Date.now(),e=n-ZZ;if(wU+e<mO){vI=requestAnimationFrame(()=>{vI=void 0,B6e()});return}vI=requestAnimationFrame(()=>{vI=void 0,ZZ=n,wU=Math.min(wU+e-mO,mO*10),h4t()})}let $ye=!1;function H6e(n){return u4t()?(n(),()=>{}):(sC.includes(n)||(sC.push(n),$ye||($ye=!0,ZZ=Date.now()-mO-1),B6e()),()=>{const e=sC.indexOf(n);e>-1&&sC.splice(e,1)})}class f4t{constructor(){$(this,"timeouts",[]);$(this,"intervals",[]);$(this,"rafs",[])}setTimeout(e,t,...r){const i=window.setTimeout(e,t,r);return this.timeouts.push(i),i}setInterval(e,t,...r){const i=window.setInterval(e,t,r);return this.intervals.push(i),i}requestAnimationFrame(e){const t=window.requestAnimationFrame(e);return this.rafs.push(t),t}dispose(){this.timeouts.forEach(e=>clearTimeout(e)),this.intervals.forEach(e=>clearInterval(e)),this.rafs.forEach(e=>cancelAnimationFrame(e)),this.timeouts.length=0,this.intervals.length=0,this.rafs.length=0}}function p4t(n){return n!==null}function g4t(){return typeof globalThis<"u"&&globalThis.structuredClone?[globalThis.structuredClone,!0]:typeof global<"u"&&global.structuredClone?[global.structuredClone,!0]:typeof window<"u"&&window.structuredClone?[window.structuredClone,!0]:[n=>n&&JSON.parse(JSON.stringify(n)),!1]}const U6e=g4t(),ls=U6e[0];U6e[1];const m4t=Object.getPrototypeOf(ls({}));let z6e=(n=21)=>crypto.getRandomValues(new Uint8Array(n)).reduce((e,t)=>(t&=63,t<36?e+=t.toString(36):t<62?e+=(t-26).toString(36).toUpperCase():t>62?e+="-":e+="_",e),"");class CN{constructor(e,t){$(this,"createDefaultProperties");$(this,"validator");$(this,"ephemeralKeys");$(this,"ephemeralKeySet");$(this,"scope");$(this,"isInstance",e=>(e==null?void 0:e.typeName)===this.typeName);this.typeName=e,this.createDefaultProperties=t.createDefaultProperties,this.validator=t.validator??{validate:i=>i},this.scope=t.scope??"document",this.ephemeralKeys=t.ephemeralKeys;const r=new Set;if(t.ephemeralKeys)for(const[i,o]of Uu(t.ephemeralKeys))o&&r.add(i);this.ephemeralKeySet=r}create(e){const t={...this.createDefaultProperties(),id:this.createId()};for(const[r,i]of Object.entries(e))i!==void 0&&(t[r]=i);return t.typeName=this.typeName,t}clone(e){return{...ls(e),id:this.createId()}}createId(e){return this.typeName+":"+(e??z6e())}createCustomId(e){return this.typeName+":"+e}parseId(e){if(!this.isId(e))throw new Error(`ID "${e}" is not a valid ID for type "${this.typeName}"`);return e.slice(this.typeName.length+1)}isId(e){if(!e)return!1;for(let t=0;t<this.typeName.length;t++)if(e[t]!==this.typeName[t])return!1;return e[this.typeName.length]===":"}withDefaultProperties(e){return new CN(this.typeName,{createDefaultProperties:e,validator:this.validator,scope:this.scope,ephemeralKeys:this.ephemeralKeys})}validate(e,t){return t&&this.validator.validateUsingKnownGoodVersion?this.validator.validateUsingKnownGoodVersion(t,e):this.validator.validate(e)}}function Mg(n,e){return new CN(n,{createDefaultProperties:()=>({}),validator:e.validator,scope:e.scope,ephemeralKeys:e.ephemeralKeys})}function q8(){return{added:{},updated:{},removed:{}}}function XZ(n){const e={added:n.removed,removed:n.added,updated:{}};for(const[t,r]of Object.values(n.updated))e.updated[t.id]=[r,t];return e}function V6e(n){return Object.keys(n.added).length===0&&Object.keys(n.updated).length===0&&Object.keys(n.removed).length===0}function Qre(n){const e={added:{},removed:{},updated:{}};return hk(e,n),e}function hk(n,e){for(const t of e){for(const[r,i]of Uu(t.added))if(n.removed[r]){const o=n.removed[r];delete n.removed[r],o!==i&&(n.updated[r]=[o,i])}else n.added[r]=i;for(const[r,[i,o]]of Uu(t.updated)){if(n.added[r]){n.added[r]=o,delete n.updated[r],delete n.removed[r];continue}if(n.updated[r]){n.updated[r]=[n.updated[r][0],o],delete n.removed[r];continue}n.updated[r]=t.updated[r],delete n.removed[r]}for(const[r,i]of Uu(t.removed))n.added[r]?delete n.added[r]:n.updated[r]?(n.removed[r]=n.updated[r][0],delete n.updated[r]):n.removed[r]=i}}function W6e(n){return n&&typeof n=="object"&&"parents"in n}function q6e(n){for(let e=0,t=n.parents.length;e<t;e++)if(n.parents[e].__unsafe__getWithoutCapture(!0),n.parents[e].lastChangedEpoch!==n.parentEpochs[e])return!0;return!1}const K8=(n,e)=>{if(n.children.remove(e)&&n.children.isEmpty&&W6e(n))for(let t=0,r=n.parents.length;t<r;t++)K8(n.parents[t],n)},eie=(n,e)=>{if(n.children.add(e)&&W6e(n))for(let t=0,r=n.parents.length;t<r;t++)eie(n.parents[t],n)};function K6e(n,e){return n===e||Object.is(n,e)||!!(n&&e&&typeof n.equals=="function"&&n.equals(e))}function Gy(n,e){const t=Symbol.for(`com.tldraw.state/${n}`),r=globalThis;return r[t]??(r[t]=e()),r[t]}const Km=Gy("empty_array",()=>Object.freeze([])),Lye=8;class G8{constructor(){$(this,"arraySize",0);$(this,"array",Array(Lye));$(this,"set",null)}get isEmpty(){if(this.array)return this.arraySize===0;if(this.set)return this.set.size===0;throw new Error("no set or array")}add(e){if(this.array)return this.array.indexOf(e)!==-1?!1:this.arraySize<Lye?(this.array[this.arraySize]=e,this.arraySize++,!0):(this.set=new Set(this.array),this.array=null,this.set.add(e),!0);if(this.set)return this.set.has(e)?!1:(this.set.add(e),!0);throw new Error("no set or array")}remove(e){if(this.array){const t=this.array.indexOf(e);return t===-1?!1:(this.array[t]=void 0,this.arraySize--,t!==this.arraySize&&(this.array[t]=this.array[this.arraySize],this.array[this.arraySize]=void 0),!0)}if(this.set)return this.set.has(e)?(this.set.delete(e),!0):!1;throw new Error("no set or array")}visit(e){if(this.array){for(let t=0;t<this.arraySize;t++){const r=this.array[t];typeof r<"u"&&e(r)}return}if(this.set){this.set.forEach(e);return}throw new Error("no set or array")}has(e){return this.array?this.array.indexOf(e)!==-1:this.set.has(e)}clear(){this.set?this.set.clear():(this.arraySize=0,this.array=[])}size(){return this.set?this.set.size:this.arraySize}}const Ld=Symbol.for("com.tldraw.state/RESET_VALUE");class G6e{constructor(e){$(this,"index",0);$(this,"buffer");this.capacity=e,this.buffer=new Array(e)}pushEntry(e,t,r){if(r!==void 0){if(r===Ld){this.clear();return}this.buffer[this.index]=[e,t,r],this.index=(this.index+1)%this.capacity}}clear(){this.index=0,this.buffer.fill(void 0)}getChangesSince(e){const{index:t,capacity:r,buffer:i}=this;for(let o=0;o<r;o++){const s=(t-1+r-o)%r,a=i[s];if(!a)return Ld;const[c,l]=a;if(o===0&&e>=l)return[];if(c<=e&&e<l){const u=o+1,d=new Array(u);for(let h=0;h<u;h++)d[h]=i[(s+h)%r][2];return d}}return Ld}}class v4t{constructor(e,t){$(this,"offset",0);$(this,"maybeRemoved");this.below=e,this.child=t}}const ss=Gy("capture",()=>({stack:null}));function CU(n){const e=ss.stack;ss.stack=null;try{return n()}finally{ss.stack=e}}function Z6e(n){ss.stack=new v4t(ss.stack,n),n.parentSet.clear()}function X6e(){const n=ss.stack;if(ss.stack=n.below,n.offset<n.child.parents.length){for(let e=n.offset;e<n.child.parents.length;e++){const t=n.child.parents[e];n.child.parentSet.has(t)||K8(t,n.child)}n.child.parents.length=n.offset,n.child.parentEpochs.length=n.offset}if(n.maybeRemoved)for(let e=0;e<n.maybeRemoved.length;e++){const t=n.maybeRemoved[e];n.child.parentSet.has(t)||K8(t,n.child)}}function Z8(n){if(ss.stack){if(ss.stack.child.parentSet.has(n))return;if(ss.stack.child.parentSet.add(n),ss.stack.child.isActivelyListening&&eie(n,ss.stack.child),ss.stack.offset<ss.stack.child.parents.length){const t=ss.stack.child.parents[ss.stack.offset];t!==n&&(ss.stack.maybeRemoved?ss.stack.maybeRemoved.push(t):ss.stack.maybeRemoved=[t])}ss.stack.child.parents[ss.stack.offset]=n,ss.stack.child.parentEpochs[ss.stack.offset]=n.lastChangedEpoch,ss.stack.offset++}}const W0=-1;class y4t{constructor(e,t,r){$(this,"_isActivelyListening",!1);$(this,"lastTraversedEpoch",W0);$(this,"lastReactedEpoch",W0);$(this,"_scheduleCount",0);$(this,"parentSet",new G8);$(this,"parentEpochs",[]);$(this,"parents",[]);$(this,"_scheduleEffect");$(this,"maybeExecute",()=>{this._isActivelyListening&&this.execute()});this.name=e,this.runEffect=t,this._scheduleEffect=r==null?void 0:r.scheduleEffect}get isActivelyListening(){return this._isActivelyListening}get scheduleCount(){return this._scheduleCount}maybeScheduleEffect(){if(this._isActivelyListening&&this.lastReactedEpoch!==Pu()){if(this.parents.length&&!q6e(this)){this.lastReactedEpoch=Pu();return}this.scheduleEffect()}}scheduleEffect(){this._scheduleCount++,this._scheduleEffect?this._scheduleEffect(this.maybeExecute):this.execute()}attach(){this._isActivelyListening=!0;for(let e=0,t=this.parents.length;e<t;e++)eie(this.parents[e],this)}detach(){this._isActivelyListening=!1;for(let e=0,t=this.parents.length;e<t;e++)K8(this.parents[e],this)}execute(){try{Z6e(this);const e=Pu(),t=this.runEffect(this.lastReactedEpoch);return this.lastReactedEpoch=e,t}finally{X6e()}}}const pE=Gy("EffectScheduler",()=>y4t);function Zy(n,e,t){const r=new pE(n,e,t);return r.attach(),r.scheduleEffect(),()=>{r.detach()}}function b4t(n,e,t){const r=new pE(n,e,t);return{scheduler:r,start:i=>{const o=(i==null?void 0:i.force)??!1;r.attach(),o?r.scheduleEffect():r.maybeScheduleEffect()},stop:()=>{r.detach()}}}let S4t=class{constructor(e){$(this,"initialAtomValues",new Map);this.parent=e}get isRoot(){return this.parent===null}commit(){this.isRoot?Y6e(this.initialAtomValues.keys()):this.initialAtomValues.forEach((e,t)=>{this.parent.initialAtomValues.has(t)||this.parent.initialAtomValues.set(t,e)})}abort(){lo.globalEpoch++,this.initialAtomValues.forEach((e,t)=>{var r;t.set(e),(r=t.historyBuffer)==null||r.clear()}),this.commit()}};const lo=Gy("transactions",()=>({globalEpoch:W0+1,globalIsReacting:!1,currentTransaction:null,cleanupReactors:null,reactionEpoch:W0+1}));function _4t(){return lo.reactionEpoch}function Pu(){return lo.globalEpoch}function w4t(){return lo.globalIsReacting}function tie(n,e){e.lastTraversedEpoch!==lo.globalEpoch&&(e.lastTraversedEpoch=lo.globalEpoch,e instanceof pE?n.add(e):e.children.visit(t=>tie(n,t)))}function Y6e(n){var e;if(lo.globalIsReacting)throw new Error("cannot change atoms during reaction cycle");try{lo.globalIsReacting=!0,lo.reactionEpoch=lo.globalEpoch;const t=new Set;for(const i of n)i.children.visit(o=>tie(t,o));for(const i of t)i.maybeScheduleEffect();let r=0;for(;(e=lo.cleanupReactors)!=null&&e.size;){if(r++>1e3)throw new Error("Reaction update depth limit exceeded");const i=lo.cleanupReactors;lo.cleanupReactors=null;for(const o of i)o.maybeScheduleEffect()}}finally{lo.cleanupReactors=null,lo.globalIsReacting=!1}}function C4t(n,e){if(lo.globalIsReacting){const t=lo.cleanupReactors??(lo.cleanupReactors=new Set);n.children.visit(r=>tie(t,r))}else lo.currentTransaction?lo.currentTransaction.initialAtomValues.has(n)||lo.currentTransaction.initialAtomValues.set(n,e):Y6e([n])}function x4t(){lo.globalEpoch++}function E4t(n){const e=new S4t(lo.currentTransaction);lo.currentTransaction=e;try{let t,r=!1;try{t=n(()=>r=!0)}catch(i){throw e.abort(),i}return r?e.abort():e.commit(),t}finally{lo.currentTransaction=lo.currentTransaction.parent}}function Gm(n){return lo.currentTransaction?n():E4t(n)}class I4t{constructor(e,t,r){$(this,"isEqual");$(this,"computeDiff");$(this,"lastChangedEpoch",Pu());$(this,"children",new G8);$(this,"historyBuffer");this.name=e,this.current=t,this.isEqual=(r==null?void 0:r.isEqual)??null,r&&(r.historyLength&&(this.historyBuffer=new G6e(r.historyLength)),this.computeDiff=r.computeDiff)}__unsafe__getWithoutCapture(e){return this.current}get(){return Z8(this),this.current}set(e,t){var i,o;if(((i=this.isEqual)==null?void 0:i.call(this,this.current,e))??K6e(this.current,e))return this.current;x4t(),this.historyBuffer&&this.historyBuffer.pushEntry(this.lastChangedEpoch,Pu(),t??((o=this.computeDiff)==null?void 0:o.call(this,this.current,e,this.lastChangedEpoch,Pu()))??Ld),this.lastChangedEpoch=Pu();const r=this.current;return this.current=e,C4t(this,r),e}update(e){return this.set(e(this.current))}getDiffSince(e){var t;return Z8(this),e>=this.lastChangedEpoch?Km:((t=this.historyBuffer)==null?void 0:t.getChangesSince(e))??Ld}}const P4t=Gy("Atom",()=>I4t);function lc(n,e,t){return new P4t(n,e,t)}let Nye=!1;function k4t(){Nye||(Nye=!0,console.warn(`Using \`@computed\` as a decorator for getters is deprecated and will be removed in the near future. Please refactor to use \`@computed\` as a decorator for methods.

// Before
@computed
get foo() {
	return 'foo'
}

// After
@computed
getFoo() {
	return 'foo'
}
`))}const mP=Symbol.for("com.tldraw.state/UNINITIALIZED"),hS=n=>n===mP,YZ=Gy("WithDiff",()=>class{constructor(e,t){this.value=e,this.diff=t}});function vP(n,e){return new YZ(n,e)}class T4t{constructor(e,t,r){$(this,"lastChangedEpoch",W0);$(this,"lastTraversedEpoch",W0);$(this,"lastCheckedEpoch",W0);$(this,"parentSet",new G8);$(this,"parents",[]);$(this,"parentEpochs",[]);$(this,"children",new G8);$(this,"historyBuffer");$(this,"state",mP);$(this,"error",null);$(this,"computeDiff");$(this,"isEqual");this.name=e,this.derive=t,r!=null&&r.historyLength&&(this.historyBuffer=new G6e(r.historyLength)),this.computeDiff=r==null?void 0:r.computeDiff,this.isEqual=(r==null?void 0:r.isEqual)??K6e}get isActivelyListening(){return!this.children.isEmpty}__unsafe__getWithoutCapture(e){var i;const t=this.lastChangedEpoch===W0,r=Pu();if(!t&&(this.lastCheckedEpoch===r||this.isActivelyListening&&w4t()&&this.lastTraversedEpoch<_4t()||!q6e(this)))if(this.lastCheckedEpoch=r,this.error){if(e)return this.state;throw this.error.thrownValue}else return this.state;try{Z6e(this);const o=this.derive(this.state,this.lastCheckedEpoch),s=o instanceof YZ?o.value:o,a=this.state===mP;if(a||!this.isEqual(s,this.state)){if(this.historyBuffer&&!a){const c=o instanceof YZ?o.diff:void 0;this.historyBuffer.pushEntry(this.lastChangedEpoch,Pu(),c??((i=this.computeDiff)==null?void 0:i.call(this,this.state,s,this.lastCheckedEpoch,Pu()))??Ld)}this.lastChangedEpoch=Pu(),this.state=s}return this.error=null,this.lastCheckedEpoch=Pu(),this.state}catch(o){if(this.state!==mP&&(this.state=mP,this.lastChangedEpoch=Pu()),this.lastCheckedEpoch=Pu(),this.historyBuffer&&this.historyBuffer.clear(),this.error={thrownValue:o},!e)throw o;return this.state}finally{X6e()}}get(){try{return this.__unsafe__getWithoutCapture()}finally{Z8(this)}}getDiffSince(e){var t;return this.__unsafe__getWithoutCapture(!0),Z8(this),e>=this.lastChangedEpoch?Km:((t=this.historyBuffer)==null?void 0:t.getChangesSince(e))??Ld}}const nie=Gy("Computed",()=>T4t);function D4t(n={},e,t,r){const i=r.value,o=Symbol.for("__@tldraw/state__computed__"+t);return r.value=function(){let s=this[o];return s||(s=new nie(t,i.bind(this),n),Object.defineProperty(this,o,{enumerable:!1,configurable:!1,writable:!1,value:s})),s.get()},r.value[A4t]=!0,r}function Fye(n={},e,t,r){return r.get?(k4t(),R4t(n,e,t,r)):D4t(n,e,t,r)}function R4t(n={},e,t,r){const i=r.get,o=Symbol.for("__@tldraw/state__computed__"+t);return r.get=function(){let s=this[o];return s||(s=new nie(t,i.bind(this),n),Object.defineProperty(this,o,{enumerable:!1,configurable:!1,writable:!1,value:s})),s.get()},r}const A4t="@@__isComputedMethod__@@";function Et(){if(arguments.length===1){const n=arguments[0];return(e,t,r)=>Fye(n,e,t,r)}else return typeof arguments[0]=="string"?new nie(arguments[0],arguments[1],arguments[2]):Fye(void 0,arguments[0],arguments[1],arguments[2])}const J6e=1,O4t=Gy("apiVersion",()=>J6e);if(O4t!==J6e)throw new Error("You have multiple incompatible versions of @tldraw/state in your app. Please deduplicate the package.");function xN(n,e){const t=Ke.useRef(e);t.current=e;const[r,i,o]=Ke.useMemo(()=>{let s=null;const a=u=>(s=u,()=>{s=null}),c=new pE(`useStateTracking(${n})`,()=>{var u;return(u=t.current)==null?void 0:u.call(t)},{scheduleEffect(){s==null||s()}});return[c,a,()=>c.scheduleCount]},[n]);return Ke.useSyncExternalStore(i,o,o),Ke.useEffect(()=>(r.attach(),r.maybeScheduleEffect(),()=>{r.detach()}),[r]),r.execute()}const jye={apply(n,e,t){return xN(n.displayName??n.name??"tracked(???)",()=>n.apply(e,t))}},M4t=Symbol.for("react.memo"),$4t=Symbol.for("react.forward_ref");function Zd(n){let e=null;const t=n.$$typeof;return t===M4t&&(n=n.type,e=n.compare),t===$4t?y.memo(y.forwardRef(new Proxy(n.render,jye))):y.memo(new Proxy(n,jye),e)}function L4t(){const n=arguments[0],e=arguments[1],t=arguments.length===3?void 0:arguments[2],r=arguments.length===3?arguments[2]:arguments[3];return y.useMemo(()=>Et(`useComputed(${n})`,e,t),r)}function oy(n,e,t=Km){y.useEffect(()=>{const r=new pE(n,e);return r.attach(),r.execute(),()=>{r.detach()}},t)}function _t(){const n=arguments,e=n.length===3?n[2]:[n[0]],t=n.length===3?n[0]:`useValue(${n[0].name})`,r=y.useRef(!0);r.current=!0;const i=y.useMemo(()=>n.length===1?n[0]:Et(t,()=>{if(r.current)return n[1]();try{return n[1]()}catch{return{}}}),e);try{const{subscribe:o,getSnapshot:s}=y.useMemo(()=>({subscribe:a=>Zy(`useValue(${t})`,()=>{i.get(),a()}),getSnapshot:()=>i.get()}),[i]);return y.useSyncExternalStore(o,s,s)}finally{r.current=!1}}var X8={exports:{}};X8.exports;(function(n,e){var t=200,r="__lodash_hash_undefined__",i=1,o=2,s=9007199254740991,a="[object Arguments]",c="[object Array]",l="[object AsyncFunction]",u="[object Boolean]",d="[object Date]",h="[object Error]",f="[object Function]",p="[object GeneratorFunction]",g="[object Map]",m="[object Number]",v="[object Null]",b="[object Object]",S="[object Promise]",E="[object Proxy]",w="[object RegExp]",C="[object Set]",I="[object String]",T="[object Symbol]",D="[object Undefined]",O="[object WeakMap]",M="[object ArrayBuffer]",R="[object DataView]",A="[object Float32Array]",k="[object Float64Array]",L="[object Int8Array]",j="[object Int16Array]",N="[object Int32Array]",B="[object Uint8Array]",U="[object Uint8ClampedArray]",K="[object Uint16Array]",z="[object Uint32Array]",G=/[\\^$.*+?()[\]{}|]/g,te=/^\[object .+?Constructor\]$/,ie=/^(?:0|[1-9]\d*)$/,Q={};Q[A]=Q[k]=Q[L]=Q[j]=Q[N]=Q[B]=Q[U]=Q[K]=Q[z]=!0,Q[a]=Q[c]=Q[M]=Q[u]=Q[R]=Q[d]=Q[h]=Q[f]=Q[g]=Q[m]=Q[b]=Q[w]=Q[C]=Q[I]=Q[O]=!1;var ge=typeof Ir=="object"&&Ir&&Ir.Object===Object&&Ir,_e=typeof self=="object"&&self&&self.Object===Object&&self,Se=ge||_e||Function("return this")(),se=e&&!e.nodeType&&e,ee=se&&!0&&n&&!n.nodeType&&n,Y=ee&&ee.exports===se,ue=Y&&ge.process,ye=function(){try{return ue&&ue.binding&&ue.binding("util")}catch{}}(),V=ye&&ye.isTypedArray;function le(xe,Xe){for(var Ot=-1,wn=xe==null?0:xe.length,yo=0,Ar=[];++Ot<wn;){var qo=xe[Ot];Xe(qo,Ot,xe)&&(Ar[yo++]=qo)}return Ar}function he(xe,Xe){for(var Ot=-1,wn=Xe.length,yo=xe.length;++Ot<wn;)xe[yo+Ot]=Xe[Ot];return xe}function oe(xe,Xe){for(var Ot=-1,wn=xe==null?0:xe.length;++Ot<wn;)if(Xe(xe[Ot],Ot,xe))return!0;return!1}function ne(xe,Xe){for(var Ot=-1,wn=Array(xe);++Ot<xe;)wn[Ot]=Xe(Ot);return wn}function ce(xe){return function(Xe){return xe(Xe)}}function Ae(xe,Xe){return xe.has(Xe)}function Ie(xe,Xe){return xe==null?void 0:xe[Xe]}function be(xe){var Xe=-1,Ot=Array(xe.size);return xe.forEach(function(wn,yo){Ot[++Xe]=[yo,wn]}),Ot}function De(xe,Xe){return function(Ot){return xe(Xe(Ot))}}function Me(xe){var Xe=-1,Ot=Array(xe.size);return xe.forEach(function(wn){Ot[++Xe]=wn}),Ot}var He=Array.prototype,Je=Function.prototype,qe=Object.prototype,Ge=Se["__core-js_shared__"],St=Je.toString,Pt=qe.hasOwnProperty,on=function(){var xe=/[^.]+$/.exec(Ge&&Ge.keys&&Ge.keys.IE_PROTO||"");return xe?"Symbol(src)_1."+xe:""}(),an=qe.toString,Rt=RegExp("^"+St.call(Pt).replace(G,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Xt=Y?Se.Buffer:void 0,yn=Se.Symbol,bn=Se.Uint8Array,Kn=qe.propertyIsEnumerable,lr=He.splice,Rr=yn?yn.toStringTag:void 0,Lr=Object.getOwnPropertySymbols,er=Xt?Xt.isBuffer:void 0,ke=De(Object.keys,Object),Qn=Po(Se,"DataView"),Gn=Po(Se,"Map"),J=Po(Se,"Promise"),ze=Po(Se,"Set"),it=Po(Se,"WeakMap"),at=Po(Object,"create"),Lt=Va(Qn),fn=Va(Gn),hn=Va(J),Ut=Va(ze),sn=Va(it),ae=yn?yn.prototype:void 0,Wt=ae?ae.valueOf:void 0;function un(xe){var Xe=-1,Ot=xe==null?0:xe.length;for(this.clear();++Xe<Ot;){var wn=xe[Xe];this.set(wn[0],wn[1])}}function qt(){this.__data__=at?at(null):{},this.size=0}function Ce(xe){var Xe=this.has(xe)&&delete this.__data__[xe];return this.size-=Xe?1:0,Xe}function ct(xe){var Xe=this.__data__;if(at){var Ot=Xe[xe];return Ot===r?void 0:Ot}return Pt.call(Xe,xe)?Xe[xe]:void 0}function At(xe){var Xe=this.__data__;return at?Xe[xe]!==void 0:Pt.call(Xe,xe)}function $t(xe,Xe){var Ot=this.__data__;return this.size+=this.has(xe)?0:1,Ot[xe]=at&&Xe===void 0?r:Xe,this}un.prototype.clear=qt,un.prototype.delete=Ce,un.prototype.get=ct,un.prototype.has=At,un.prototype.set=$t;function _n(xe){var Xe=-1,Ot=xe==null?0:xe.length;for(this.clear();++Xe<Ot;){var wn=xe[Xe];this.set(wn[0],wn[1])}}function jn(){this.__data__=[],this.size=0}function Zn(xe){var Xe=this.__data__,Ot=zs(Xe,xe);if(Ot<0)return!1;var wn=Xe.length-1;return Ot==wn?Xe.pop():lr.call(Xe,Ot,1),--this.size,!0}function Z(xe){var Xe=this.__data__,Ot=zs(Xe,xe);return Ot<0?void 0:Xe[Ot][1]}function ve(xe){return zs(this.__data__,xe)>-1}function W(xe,Xe){var Ot=this.__data__,wn=zs(Ot,xe);return wn<0?(++this.size,Ot.push([xe,Xe])):Ot[wn][1]=Xe,this}_n.prototype.clear=jn,_n.prototype.delete=Zn,_n.prototype.get=Z,_n.prototype.has=ve,_n.prototype.set=W;function X(xe){var Xe=-1,Ot=xe==null?0:xe.length;for(this.clear();++Xe<Ot;){var wn=xe[Xe];this.set(wn[0],wn[1])}}function fe(){this.size=0,this.__data__={hash:new un,map:new(Gn||_n),string:new un}}function xt(xe){var Xe=ms(this,xe).delete(xe);return this.size-=Xe?1:0,Xe}function Zt(xe){return ms(this,xe).get(xe)}function or(xe){return ms(this,xe).has(xe)}function tr(xe,Xe){var Ot=ms(this,xe),wn=Ot.size;return Ot.set(xe,Xe),this.size+=Ot.size==wn?0:1,this}X.prototype.clear=fe,X.prototype.delete=xt,X.prototype.get=Zt,X.prototype.has=or,X.prototype.set=tr;function vo(xe){var Xe=-1,Ot=xe==null?0:xe.length;for(this.__data__=new X;++Xe<Ot;)this.add(xe[Xe])}function fs(xe){return this.__data__.set(xe,r),this}function ps(xe){return this.__data__.has(xe)}vo.prototype.add=vo.prototype.push=fs,vo.prototype.has=ps;function Wo(xe){var Xe=this.__data__=new _n(xe);this.size=Xe.size}function Tl(){this.__data__=new _n,this.size=0}function rs(xe){var Xe=this.__data__,Ot=Xe.delete(xe);return this.size=Xe.size,Ot}function Dl(xe){return this.__data__.get(xe)}function Xh(xe){return this.__data__.has(xe)}function Sc(xe,Xe){var Ot=this.__data__;if(Ot instanceof _n){var wn=Ot.__data__;if(!Gn||wn.length<t-1)return wn.push([xe,Xe]),this.size=++Ot.size,this;Ot=this.__data__=new X(wn)}return Ot.set(xe,Xe),this.size=Ot.size,this}Wo.prototype.clear=Tl,Wo.prototype.delete=rs,Wo.prototype.get=Dl,Wo.prototype.has=Xh,Wo.prototype.set=Sc;function oa(xe,Xe){var Ot=hp(xe),wn=!Ot&&jg(xe),yo=!Ot&&!wn&&Bg(xe),Ar=!Ot&&!wn&&!yo&&Hg(xe),qo=Ot||wn||yo||Ar,sa=qo?ne(xe.length,String):[],vi=sa.length;for(var bo in xe)Pt.call(xe,bo)&&!(qo&&(bo=="length"||yo&&(bo=="offset"||bo=="parent")||Ar&&(bo=="buffer"||bo=="byteLength"||bo=="byteOffset")||ed(bo,vi)))&&sa.push(bo);return sa}function zs(xe,Xe){for(var Ot=xe.length;Ot--;)if(dp(xe[Ot][0],Xe))return Ot;return-1}function Rl(xe,Xe,Ot){var wn=Xe(xe);return hp(xe)?wn:he(wn,Ot(xe))}function Ps(xe){return xe==null?xe===void 0?D:v:Rr&&Rr in Object(xe)?Ca(xe):Jd(xe)}function pr(xe){return Qi(xe)&&Ps(xe)==a}function Yn(xe,Xe,Ot,wn,yo){return xe===Xe?!0:xe==null||Xe==null||!Qi(xe)&&!Qi(Xe)?xe!==xe&&Xe!==Xe:xr(xe,Xe,Ot,wn,Yn,yo)}function xr(xe,Xe,Ot,wn,yo,Ar){var qo=hp(xe),sa=hp(Xe),vi=qo?c:za(xe),bo=sa?c:za(Xe);vi=vi==a?b:vi,bo=bo==a?b:bo;var Ws=vi==b,uu=bo==b,aa=vi==bo;if(aa&&Bg(xe)){if(!Bg(Xe))return!1;qo=!0,Ws=!1}if(aa&&!Ws)return Ar||(Ar=new Wo),qo||Hg(xe)?_i(xe,Xe,Ot,wn,yo,Ar):gs(xe,Xe,vi,Ot,wn,yo,Ar);if(!(Ot&i)){var Ko=Ws&&Pt.call(xe,"__wrapped__"),Al=uu&&Pt.call(Xe,"__wrapped__");if(Ko||Al){var Jh=Ko?xe.value():xe,Qd=Al?Xe.value():Xe;return Ar||(Ar=new Wo),yo(Jh,Qd,Ot,wn,Ar)}}return aa?(Ar||(Ar=new Wo),Vs(xe,Xe,Ot,wn,yo,Ar)):!1}function sr(xe){if(!ks(xe)||Fg(xe))return!1;var Xe=qn(xe)?Rt:te;return Xe.test(Va(xe))}function nr(xe){return Qi(xe)&&wi(xe.length)&&!!Q[Ps(xe)]}function Zr(xe){if(!Yh(xe))return ke(xe);var Xe=[];for(var Ot in Object(xe))Pt.call(xe,Ot)&&Ot!="constructor"&&Xe.push(Ot);return Xe}function _i(xe,Xe,Ot,wn,yo,Ar){var qo=Ot&i,sa=xe.length,vi=Xe.length;if(sa!=vi&&!(qo&&vi>sa))return!1;var bo=Ar.get(xe);if(bo&&Ar.get(Xe))return bo==Xe;var Ws=-1,uu=!0,aa=Ot&o?new vo:void 0;for(Ar.set(xe,Xe),Ar.set(Xe,xe);++Ws<sa;){var Ko=xe[Ws],Al=Xe[Ws];if(wn)var Jh=qo?wn(Al,Ko,Ws,Xe,xe,Ar):wn(Ko,Al,Ws,xe,Xe,Ar);if(Jh!==void 0){if(Jh)continue;uu=!1;break}if(aa){if(!oe(Xe,function(Qd,fp){if(!Ae(aa,fp)&&(Ko===Qd||yo(Ko,Qd,Ot,wn,Ar)))return aa.push(fp)})){uu=!1;break}}else if(!(Ko===Al||yo(Ko,Al,Ot,wn,Ar))){uu=!1;break}}return Ar.delete(xe),Ar.delete(Xe),uu}function gs(xe,Xe,Ot,wn,yo,Ar,qo){switch(Ot){case R:if(xe.byteLength!=Xe.byteLength||xe.byteOffset!=Xe.byteOffset)return!1;xe=xe.buffer,Xe=Xe.buffer;case M:return!(xe.byteLength!=Xe.byteLength||!Ar(new bn(xe),new bn(Xe)));case u:case d:case m:return dp(+xe,+Xe);case h:return xe.name==Xe.name&&xe.message==Xe.message;case w:case I:return xe==Xe+"";case g:var sa=be;case C:var vi=wn&i;if(sa||(sa=Me),xe.size!=Xe.size&&!vi)return!1;var bo=qo.get(xe);if(bo)return bo==Xe;wn|=o,qo.set(xe,Xe);var Ws=_i(sa(xe),sa(Xe),wn,yo,Ar,qo);return qo.delete(xe),Ws;case T:if(Wt)return Wt.call(xe)==Wt.call(Xe)}return!1}function Vs(xe,Xe,Ot,wn,yo,Ar){var qo=Ot&i,sa=wa(xe),vi=sa.length,bo=wa(Xe),Ws=bo.length;if(vi!=Ws&&!qo)return!1;for(var uu=vi;uu--;){var aa=sa[uu];if(!(qo?aa in Xe:Pt.call(Xe,aa)))return!1}var Ko=Ar.get(xe);if(Ko&&Ar.get(Xe))return Ko==Xe;var Al=!0;Ar.set(xe,Xe),Ar.set(Xe,xe);for(var Jh=qo;++uu<vi;){aa=sa[uu];var Qd=xe[aa],fp=Xe[aa];if(wn)var TE=qo?wn(fp,Qd,aa,Xe,xe,Ar):wn(Qd,fp,aa,xe,Xe,Ar);if(!(TE===void 0?Qd===fp||yo(Qd,fp,Ot,wn,Ar):TE)){Al=!1;break}Jh||(Jh=aa=="constructor")}if(Al&&!Jh){var sb=xe.constructor,Wa=Xe.constructor;sb!=Wa&&"constructor"in xe&&"constructor"in Xe&&!(typeof sb=="function"&&sb instanceof sb&&typeof Wa=="function"&&Wa instanceof Wa)&&(Al=!1)}return Ar.delete(xe),Ar.delete(Xe),Al}function wa(xe){return Rl(xe,ob,lu)}function ms(xe,Xe){var Ot=xe.__data__;return _c(Xe)?Ot[typeof Xe=="string"?"string":"hash"]:Ot.map}function Po(xe,Xe){var Ot=Ie(xe,Xe);return sr(Ot)?Ot:void 0}function Ca(xe){var Xe=Pt.call(xe,Rr),Ot=xe[Rr];try{xe[Rr]=void 0;var wn=!0}catch{}var yo=an.call(xe);return wn&&(Xe?xe[Rr]=Ot:delete xe[Rr]),yo}var lu=Lr?function(xe){return xe==null?[]:(xe=Object(xe),le(Lr(xe),function(Xe){return Kn.call(xe,Xe)}))}:Ui,za=Ps;(Qn&&za(new Qn(new ArrayBuffer(1)))!=R||Gn&&za(new Gn)!=g||J&&za(J.resolve())!=S||ze&&za(new ze)!=C||it&&za(new it)!=O)&&(za=function(xe){var Xe=Ps(xe),Ot=Xe==b?xe.constructor:void 0,wn=Ot?Va(Ot):"";if(wn)switch(wn){case Lt:return R;case fn:return g;case hn:return S;case Ut:return C;case sn:return O}return Xe});function ed(xe,Xe){return Xe=Xe??s,!!Xe&&(typeof xe=="number"||ie.test(xe))&&xe>-1&&xe%1==0&&xe<Xe}function _c(xe){var Xe=typeof xe;return Xe=="string"||Xe=="number"||Xe=="symbol"||Xe=="boolean"?xe!=="__proto__":xe===null}function Fg(xe){return!!on&&on in xe}function Yh(xe){var Xe=xe&&xe.constructor,Ot=typeof Xe=="function"&&Xe.prototype||qe;return xe===Ot}function Jd(xe){return an.call(xe)}function Va(xe){if(xe!=null){try{return St.call(xe)}catch{}try{return xe+""}catch{}}return""}function dp(xe,Xe){return xe===Xe||xe!==xe&&Xe!==Xe}var jg=pr(function(){return arguments}())?pr:function(xe){return Qi(xe)&&Pt.call(xe,"callee")&&!Kn.call(xe,"callee")},hp=Array.isArray;function ib(xe){return xe!=null&&wi(xe.length)&&!qn(xe)}var Bg=er||ki;function Nn(xe,Xe){return Yn(xe,Xe)}function qn(xe){if(!ks(xe))return!1;var Xe=Ps(xe);return Xe==f||Xe==p||Xe==l||Xe==E}function wi(xe){return typeof xe=="number"&&xe>-1&&xe%1==0&&xe<=s}function ks(xe){var Xe=typeof xe;return xe!=null&&(Xe=="object"||Xe=="function")}function Qi(xe){return xe!=null&&typeof xe=="object"}var Hg=V?ce(V):nr;function ob(xe){return ib(xe)?oa(xe):Zr(xe)}function Ui(){return[]}function ki(){return!1}n.exports=Nn})(X8,X8.exports);var N4t=X8.exports;const F4t=Fy(N4t);function j4t(n){if(n.length===0)return new Set;const e=n[0],t=n.slice(1),r=new Set;for(const i of e)t.every(o=>o.has(i))&&r.add(i);return r}function B4t(n,e){const t={};for(const r of e)n.has(r)||(t.added??(t.added=new Set),t.added.add(r));for(const r of n)e.has(r)||(t.removed??(t.removed=new Set),t.removed.add(r));return t.added||t.removed?t:void 0}function Bye(n,e){for(const[t,r]of Object.entries(n)){const i=r,o=e[t];if("eq"in i&&o!==i.eq||"neq"in i&&o===i.neq||"gt"in i&&(typeof o!="number"||o<=i.gt))return!1}return!0}function Hye(n,e,t){const r=Object.fromEntries(Object.keys(t).map(i=>[i,new Set]));for(const[i,o]of Object.entries(t))if("eq"in o){const a=n.index(e,i).get().get(o.eq);if(a)for(const c of a)r[i].add(c)}else if("neq"in o){const s=n.index(e,i);for(const[a,c]of s.get())if(a!==o.neq)for(const l of c)r[i].add(l)}else if("gt"in o){const s=n.index(e,i);for(const[a,c]of s.get())if(a>o.gt)for(const l of c)r[i].add(l)}return j4t(Object.values(r))}class H4t{constructor(e,t){$(this,"indexCache",new Map);$(this,"historyCache",new Map);this.atoms=e,this.history=t}filterHistory(e){if(this.historyCache.has(e))return this.historyCache.get(e);const t=Et("filterHistory:"+e,(r,i)=>{if(hS(r))return this.history.get();const o=this.history.getDiffSince(i);if(o===Ld)return this.history.get();const s={added:{},removed:{},updated:{}};let a=0,c=0,l=0;for(const u of o){for(const d of Rs(u.added))if(d.typeName===e)if(s.removed[d.id]){const h=s.removed[d.id];delete s.removed[d.id],c--,h!==d&&(s.updated[d.id]=[h,d],l++)}else s.added[d.id]=d,a++;for(const[d,h]of Rs(u.updated))h.typeName===e&&(s.added[h.id]?s.added[h.id]=h:s.updated[h.id]?s.updated[h.id]=[s.updated[h.id][0],h]:(s.updated[h.id]=[d,h],l++));for(const d of Rs(u.removed))d.typeName===e&&(s.added[d.id]?(delete s.added[d.id],a--):s.updated[d.id]?(s.removed[d.id]=s.updated[d.id][0],delete s.updated[d.id],l--,c++):(s.removed[d.id]=d,c++))}return a||c||l?vP(this.history.get(),s):r},{historyLength:100});return this.historyCache.set(e,t),t}index(e,t){const r=e+":"+t;if(this.indexCache.has(r))return this.indexCache.get(r);const i=this.__uncached_createIndex(e,t);return this.indexCache.set(r,i),i}__uncached_createIndex(e,t){const r=this.filterHistory(e),i=()=>{r.get();const o=new Map;for(const s of Rs(this.atoms.get())){const a=s.get();if(a.typeName===e){const c=a[t];o.has(c)||o.set(c,new Set),o.get(c).add(a.id)}}return o};return Et("index:"+e+":"+t,(o,s)=>{if(hS(o))return i();const a=r.getDiffSince(s);if(a===Ld)return i();const c=new Map,l=(f,p)=>{let g=c.get(f);g||(g=new gO(o.get(f)??new Set)),g.add(p),c.set(f,g)},u=(f,p)=>{let g=c.get(f);g||(g=new gO(o.get(f)??new Set)),g.remove(p),c.set(f,g)};for(const f of a){for(const p of Rs(f.added))if(p.typeName===e){const g=p[t];l(g,p.id)}for(const[p,g]of Rs(f.updated))if(g.typeName===e){const m=p[t],v=g[t];m!==v&&(u(m,g.id),l(v,g.id))}for(const p of Rs(f.removed))if(p.typeName===e){const g=p[t];u(g,p.id)}}let d,h;for(const[f,p]of c){const g=p.get();g&&(d||(d=new Map(o)),h||(h=new Map),g.value.size===0?d.delete(f):d.set(f,g.value),h.set(f,g.diff))}return d&&h?vP(d,h):o},{historyLength:100})}record(e,t=()=>({}),r="record:"+e+(t?":"+t.toString():"")){const i=this.ids(e,t,r);return Et(r,()=>{var o;for(const s of i.get())return(o=this.atoms.get()[s])==null?void 0:o.get()})}records(e,t=()=>({}),r="records:"+e+(t?":"+t.toString():"")){const i=this.ids(e,t,"ids:"+r);return Et(r,()=>[...i.get()].map(o=>{const s=this.atoms.get()[o];if(!s)throw new Error("no atom found for record id: "+o);return s.get()}))}ids(e,t=()=>({}),r="ids:"+e+(t?":"+t.toString():"")){const i=this.filterHistory(e),o=()=>{i.get();const c=t();return Object.keys(c).length===0?new Set(Rs(this.atoms.get()).flatMap(l=>{const u=l.get();return u.typeName===e?u.id:[]})):Hye(this,e,c)},s=c=>{const l=o(),u=B4t(c,l);return u?vP(l,u):c},a=Et("ids_query:"+r,t,{isEqual:F4t});return Et("query:"+r,(c,l)=>{const u=a.get();if(hS(c))return o();if(l<a.lastChangedEpoch)return s(c);const d=i.getDiffSince(l);if(d===Ld)return s(c);const h=new gO(c);for(const p of d){for(const g of Rs(p.added))g.typeName===e&&Bye(u,g)&&h.add(g.id);for(const[g,m]of Rs(p.updated))m.typeName===e&&(Bye(u,m)?h.add(m.id):h.remove(m.id));for(const g of Rs(p.removed))g.typeName===e&&h.remove(g.id)}const f=h.get();return f?vP(f.value,f.diff):c},{historyLength:50})}exec(e,t){const r=Hye(this,e,t);if(r.size===0)return Km;const i=this.atoms.get();return[...r].map(o=>i[o].get())}}class U4t{constructor(e){$(this,"_beforeCreateHandlers",{});$(this,"_afterCreateHandlers",{});$(this,"_beforeChangeHandlers",{});$(this,"_afterChangeHandlers",{});$(this,"_beforeDeleteHandlers",{});$(this,"_afterDeleteHandlers",{});$(this,"_operationCompleteHandlers",[]);$(this,"_isEnabled",!0);this.store=e}isEnabled(){return this._isEnabled}setIsEnabled(e){this._isEnabled=e}handleBeforeCreate(e,t){if(!this._isEnabled)return e;const r=this._beforeCreateHandlers[e.typeName];if(r){let i=e;for(const o of r)i=o(i,t);return i}return e}handleAfterCreate(e,t){if(!this._isEnabled)return;const r=this._afterCreateHandlers[e.typeName];if(r)for(const i of r)i(e,t)}handleBeforeChange(e,t,r){if(!this._isEnabled)return t;const i=this._beforeChangeHandlers[t.typeName];if(i){let o=t;for(const s of i)o=s(e,o,r);return o}return t}handleAfterChange(e,t,r){if(!this._isEnabled)return;const i=this._afterChangeHandlers[t.typeName];if(i)for(const o of i)o(e,t,r)}handleBeforeDelete(e,t){if(!this._isEnabled)return!0;const r=this._beforeDeleteHandlers[e.typeName];if(r){for(const i of r)if(i(e,t)===!1)return!1}return!0}handleAfterDelete(e,t){if(!this._isEnabled)return;const r=this._afterDeleteHandlers[e.typeName];if(r)for(const i of r)i(e,t)}handleOperationComplete(e){if(this._isEnabled)for(const t of this._operationCompleteHandlers)t(e)}register(e){const t=[];for(const[r,i]of Object.entries(e))i!=null&&i.beforeCreate&&t.push(this.registerBeforeCreateHandler(r,i.beforeCreate)),i!=null&&i.afterCreate&&t.push(this.registerAfterCreateHandler(r,i.afterCreate)),i!=null&&i.beforeChange&&t.push(this.registerBeforeChangeHandler(r,i.beforeChange)),i!=null&&i.afterChange&&t.push(this.registerAfterChangeHandler(r,i.afterChange)),i!=null&&i.beforeDelete&&t.push(this.registerBeforeDeleteHandler(r,i.beforeDelete)),i!=null&&i.afterDelete&&t.push(this.registerAfterDeleteHandler(r,i.afterDelete));return()=>{for(const r of t)r()}}registerBeforeCreateHandler(e,t){return this._beforeCreateHandlers[e]||(this._beforeCreateHandlers[e]=[]),this._beforeCreateHandlers[e].push(t),()=>Ob(this._beforeCreateHandlers[e],t)}registerAfterCreateHandler(e,t){return this._afterCreateHandlers[e]||(this._afterCreateHandlers[e]=[]),this._afterCreateHandlers[e].push(t),()=>Ob(this._afterCreateHandlers[e],t)}registerBeforeChangeHandler(e,t){return this._beforeChangeHandlers[e]||(this._beforeChangeHandlers[e]=[]),this._beforeChangeHandlers[e].push(t),()=>Ob(this._beforeChangeHandlers[e],t)}registerAfterChangeHandler(e,t){return this._afterChangeHandlers[e]||(this._afterChangeHandlers[e]=[]),this._afterChangeHandlers[e].push(t),()=>Ob(this._afterChangeHandlers[e],t)}registerBeforeDeleteHandler(e,t){return this._beforeDeleteHandlers[e]||(this._beforeDeleteHandlers[e]=[]),this._beforeDeleteHandlers[e].push(t),()=>Ob(this._beforeDeleteHandlers[e],t)}registerAfterDeleteHandler(e,t){return this._afterDeleteHandlers[e]||(this._afterDeleteHandlers[e]=[]),this._afterDeleteHandlers[e].push(t),()=>Ob(this._afterDeleteHandlers[e],t)}registerOperationCompleteHandler(e){return this._operationCompleteHandlers.push(e),()=>Ob(this._operationCompleteHandlers,e)}}function Ob(n,e){const t=n.indexOf(e);t>=0&&n.splice(t,1)}class rie{constructor(e){$(this,"id");$(this,"atoms",lc("store_atoms",{}));$(this,"history",lc("history",0,{historyLength:1e3}));$(this,"query",new H4t(this.atoms,this.history));$(this,"listeners",new Set);$(this,"historyAccumulator",new V4t);$(this,"historyReactor");$(this,"cancelHistoryReactor",()=>{});$(this,"schema");$(this,"props");$(this,"scopedTypes");$(this,"sideEffects",new U4t(this));$(this,"put",(e,t)=>{this.atomic(()=>{const r={},i={},o=this.atoms.__unsafe__getWithoutCapture();let s=null,a,c=!1;const l=this.isMergingRemoteChanges?"remote":"user";for(let u=0,d=e.length;u<d;u++){a=e[u];const h=(s??o)[a.id];if(h){const f=h.__unsafe__getWithoutCapture();if(a=this.sideEffects.handleBeforeChange(f,a,l),this.schema.validateRecord(this,a,t??"updateRecord",f)===f)continue;h.set(a),c=!0;const g=h.__unsafe__getWithoutCapture();r[a.id]=[f,g],this.addDiffForAfterEvent(f,g)}else a=this.sideEffects.handleBeforeCreate(a,l),c=!0,a=this.schema.validateRecord(this,a,t??"createRecord",null),i[a.id]=a,this.addDiffForAfterEvent(null,a),s||(s={...o}),s[a.id]=lc("atom:"+a.id,a)}s&&this.atoms.set(s),c&&this.updateHistory({added:i,updated:r,removed:{}})})});$(this,"remove",e=>{this.atomic(()=>{const t=new Set,r=this.isMergingRemoteChanges?"remote":"user";if(this.sideEffects.isEnabled())for(const o of e){const s=this.atoms.__unsafe__getWithoutCapture()[o];s&&this.sideEffects.handleBeforeDelete(s.get(),r)===!1&&t.add(o)}let i;this.atoms.update(o=>{let s;for(const a of e){if(t.has(a)||!(a in o))continue;s||(s={...o}),i||(i={}),delete s[a];const c=o[a].get();i[a]=c,this.addDiffForAfterEvent(c,null)}return s??o}),i&&this.updateHistory({added:{},updated:{},removed:i})})});$(this,"get",e=>{var t;return(t=this.atoms.get()[e])==null?void 0:t.get()});$(this,"unsafeGetWithoutCapture",e=>{var t;return(t=this.atoms.get()[e])==null?void 0:t.__unsafe__getWithoutCapture()});$(this,"serialize",(e="document")=>{const t={};for(const[r,i]of Uu(this.atoms.get())){const o=i.get();(e==="all"||this.scopedTypes[e].has(o.typeName))&&(t[r]=o)}return t});$(this,"allRecords",()=>Rs(this.atoms.get()).map(e=>e.get()));$(this,"clear",()=>{this.remove(Aye(this.atoms.get()))});$(this,"update",(e,t)=>{const r=this.atoms.get()[e];if(!r){console.error(`Record ${e} not found. This is probably an error`);return}this.put([t(r.__unsafe__getWithoutCapture())])});$(this,"has",e=>!!this.atoms.get()[e]);$(this,"listen",(e,t)=>{this._flushHistory();const r={onHistory:e,filters:{source:(t==null?void 0:t.source)??"all",scope:(t==null?void 0:t.scope)??"all"}};return this.listeners.add(r),this.historyReactor.scheduler.isActivelyListening||this.historyReactor.start(),()=>{this.listeners.delete(r),this.listeners.size===0&&this.historyReactor.stop()}});$(this,"isMergingRemoteChanges",!1);$(this,"mergeRemoteChanges",e=>{if(this.isMergingRemoteChanges)return e();if(this._isInAtomicOp)throw new Error("Cannot merge remote changes while in atomic operation");try{this.isMergingRemoteChanges=!0,Gm(e)}finally{this.isMergingRemoteChanges=!1}});$(this,"createComputedCache",(e,t,r)=>{const i=new uv;return{get:o=>{const s=this.atoms.get()[o];if(s)return i.get(s,()=>{const a=r?Et(s.name+":equals",()=>s.get(),{isEqual:r}):s;return Et(e+":"+o,()=>t(a.get()))}).get()}}});$(this,"createSelectedComputedCache",(e,t,r)=>{const i=new uv;return{get:o=>{const s=this.atoms.get()[o];if(s)return i.get(s,()=>{const a=Et(e+":"+o+":selector",()=>t(s.get()));return Et(e+":"+o,()=>r(a.get()))}).get()}}});$(this,"_integrityChecker");$(this,"_isPossiblyCorrupted",!1);$(this,"pendingAfterEvents",null);$(this,"_isInAtomicOp",!1);const{initialData:t,schema:r,id:i}=e;this.id=i??z6e(),this.schema=r,this.props=e.props,t&&this.atoms.set(A6e(Uu(t).map(([o,s])=>[o,lc("atom:"+o,this.schema.validateRecord(this,s,"initialize",null))]))),this.historyReactor=b4t("Store.historyReactor",()=>{this.history.get(),this._flushHistory()},{scheduleEffect:o=>this.cancelHistoryReactor=H6e(o)}),this.scopedTypes={document:new Set(Rs(this.schema.types).filter(o=>o.scope==="document").map(o=>o.typeName)),session:new Set(Rs(this.schema.types).filter(o=>o.scope==="session").map(o=>o.typeName)),presence:new Set(Rs(this.schema.types).filter(o=>o.scope==="presence").map(o=>o.typeName))}}_flushHistory(){if(this.historyAccumulator.hasChanges()){const e=this.historyAccumulator.flush();for(const{changes:t,source:r}of e){let i=null,o=null,s=null;for(const{onHistory:a,filters:c}of this.listeners)if(!(c.source!=="all"&&c.source!==r))if(c.scope!=="all")if(c.scope==="document"){if(o??(o=this.filterChangesByScope(t,"document")),!o)continue;a({changes:o,source:r})}else if(c.scope==="session"){if(i??(i=this.filterChangesByScope(t,"session")),!i)continue;a({changes:i,source:r})}else{if(s??(s=this.filterChangesByScope(t,"presence")),!s)continue;a({changes:s,source:r})}else a({changes:t,source:r})}}}dispose(){this.cancelHistoryReactor()}filterChangesByScope(e,t){const r={added:dk(e.added,(i,o)=>this.scopedTypes[t].has(o.typeName)),updated:dk(e.updated,(i,o)=>this.scopedTypes[t].has(o[1].typeName)),removed:dk(e.removed,(i,o)=>this.scopedTypes[t].has(o.typeName))};return Object.keys(r.added).length===0&&Object.keys(r.updated).length===0&&Object.keys(r.removed).length===0?null:r}updateHistory(e){this.historyAccumulator.add({changes:e,source:this.isMergingRemoteChanges?"remote":"user"}),this.listeners.size===0&&this.historyAccumulator.clear(),this.history.set(this.history.get()+1,e)}validate(e){this.allRecords().forEach(t=>this.schema.validateRecord(this,t,e,null))}getStoreSnapshot(e="document"){return{store:this.serialize(e),schema:this.schema.serialize()}}getSnapshot(e="document"){return console.warn("[tldraw] `Store.getSnapshot` is deprecated and will be removed in a future release. Use `getSnapshot` from the `tldraw` package instead."),this.getStoreSnapshot(e)}migrateSnapshot(e){const t=this.schema.migrateStoreSnapshot(e);if(t.type==="error")throw new Error(`Failed to migrate snapshot: ${t.reason}`);return{store:t.value,schema:this.schema.serialize()}}loadStoreSnapshot(e){const t=this.schema.migrateStoreSnapshot(e);if(t.type==="error")throw new Error(`Failed to migrate snapshot: ${t.reason}`);const r=this.sideEffects.isEnabled();try{this.sideEffects.setIsEnabled(!1),this.atomic(()=>{this.clear(),this.put(Object.values(t.value)),this.ensureStoreIsUsable()})}finally{this.sideEffects.setIsEnabled(r)}}loadSnapshot(e){console.warn("[tldraw] `Store.loadSnapshot` is deprecated and will be removed in a future release. Use `loadSnapshot` from the 'tldraw' package instead."),this.loadStoreSnapshot(e)}extractingChanges(e){const t=[],r=this.historyAccumulator.addInterceptor(i=>t.push(i.changes));try{return Gm(e),Qre(t)}finally{r()}}applyDiff(e,{runCallbacks:t=!0,ignoreEphemeralKeys:r=!1}={}){this.atomic(()=>{const i=Rs(e.added);for(const[s,a]of Rs(e.updated)){const c=this.schema.getType(a.typeName);if(r&&c.ephemeralKeySet.size){const l=this.get(a.id);if(!l){i.push(a);continue}let u=null;for(const[d,h]of Object.entries(a))c.ephemeralKeySet.has(d)||Object.is(h,ju(l,d))||(u||(u={...l}),u[d]=h);u&&i.push(u)}else i.push(a)}const o=Aye(e.removed);i.length&&this.put(i),o.length&&this.remove(o)},t)}ensureStoreIsUsable(){this.atomic(()=>{var e;this._integrityChecker??(this._integrityChecker=this.schema.createIntegrityChecker(this)),(e=this._integrityChecker)==null||e.call(this)})}markAsPossiblyCorrupted(){this._isPossiblyCorrupted=!0}isPossiblyCorrupted(){return this._isPossiblyCorrupted}addDiffForAfterEvent(e,t){if(ds(this.pendingAfterEvents,"must be in event operation"),e===t||(e&&t&&ds(e.id===t.id),!e&&!t))return;const r=(e||t).id,i=this.pendingAfterEvents.get(r);i?i.after=t:this.pendingAfterEvents.set(r,{before:e,after:t})}flushAtomicCallbacks(){let e=0;const t=this.isMergingRemoteChanges?"remote":"user";for(;this.pendingAfterEvents;){const r=this.pendingAfterEvents;if(this.pendingAfterEvents=null,!!this.sideEffects.isEnabled()){if(e++,e>100)throw new Error("Maximum store update depth exceeded, bailing out");for(const{before:i,after:o}of r.values())i&&o?this.sideEffects.handleAfterChange(i,o,t):i&&!o?this.sideEffects.handleAfterDelete(i,t):!i&&o&&this.sideEffects.handleAfterCreate(o,t);this.pendingAfterEvents||this.sideEffects.handleOperationComplete(t)}}}atomic(e,t=!0){return Gm(()=>{if(this._isInAtomicOp)return this.pendingAfterEvents||(this.pendingAfterEvents=new Map),e();this.pendingAfterEvents=new Map;const r=this.sideEffects.isEnabled();this.sideEffects.setIsEnabled(t??r),this._isInAtomicOp=!0;try{const i=e();return this.flushAtomicCallbacks(),i}finally{this.pendingAfterEvents=null,this.sideEffects.setIsEnabled(r),this._isInAtomicOp=!1}})}addHistoryInterceptor(e){return this.historyAccumulator.addInterceptor(t=>e(t,this.isMergingRemoteChanges?"remote":"user"))}}function z4t(n){if(n.length===0)return[];const e=[];let t=[n[0]],r;for(let i=1,o=n.length;i<o;i++)r=n[i],t[0].source!==r.source&&(e.push(t),t=[]),t.push(r);return e.push(t),e.map(i=>({source:i[0].source,changes:Qre(i.map(o=>o.changes))}))}class V4t{constructor(){$(this,"_history",[]);$(this,"_interceptors",new Set)}addInterceptor(e){return this._interceptors.add(e),()=>{this._interceptors.delete(e)}}add(e){this._history.push(e);for(const t of this._interceptors)t(e)}flush(){const e=z4t(this._history);return this._history=[],e}clear(){this._history=[]}hasChanges(){return this._history.length>0}}function W4t(n,e,t){const r=new uv;return{get(i,o){return r.get(i,()=>(i instanceof rie?i:i.store).createComputedCache(n,c=>e(i,c),t)).get(o)}}}function q4t(n){const e=[];for(let t=n.length-1;t>=0;t--){const r=n[t];if("id"in r)e.unshift(r);else{const i=r.dependsOn,o=e[0];o&&(e[0]={...o,dependsOn:i.concat(o.dependsOn??[])})}}return e}function qC({sequence:n,sequenceId:e,retroactive:t=!0}){const r={sequenceId:e,retroactive:t,sequence:q4t(n)};return Q6e(r),r}function Yu(n,e){return Object.fromEntries(Uu(e).map(([t,r])=>[t,`${n}/${r}`]))}function Xd(n){const e=n.sequenceId;return qC({sequenceId:e,retroactive:n.retroactive??!0,sequence:n.sequence.map(t=>"id"in t?{...t,scope:"record",filter:r=>{var i,o;return r.typeName===n.recordType&&(((i=t.filter)==null?void 0:i.call(t,r))??!0)&&(((o=n.filter)==null?void 0:o.call(n,r))??!0)}}:t)})}function K4t(n){const e=new Map(n.map(o=>[o.id,o])),t=new Set,r=[];function i(o){ds(!t.has(o.id),`Circular dependency in migrations: ${o.id}`),t.add(o.id);const{version:s,sequenceId:a}=Y8(o.id),c=e.get(`${a}/${s-1}`);if(c&&i(c),o.dependsOn)for(const l of o.dependsOn){const u=e.get(l);u&&i(u)}e.delete(o.id),r.push(o)}for(const o of e.values())i(o);return r}function Y8(n){const[e,t]=n.split("/");return{sequenceId:e,version:parseInt(t)}}function Uye(n,e){e&&ds(n.startsWith(e+"/"),`Every migration in sequence '${e}' must have an id starting with '${e}/'. Got invalid id: '${n}'`),ds(n.match(/^(.*?)\/(0|[1-9]\d*)$/),`Invalid migration id: '${n}'`)}function Q6e(n){if(ds(!n.sequenceId.includes("/"),`sequenceId cannot contain a '/', got ${n.sequenceId}`),ds(n.sequenceId.length,"sequenceId must be a non-empty string"),n.sequence.length===0)return;Uye(n.sequence[0].id,n.sequenceId);let e=Y8(n.sequence[0].id).version;ds(e===1,`Expected the first migrationId to be '${n.sequenceId}/1' but got '${n.sequence[0].id}'`);for(let t=1;t<n.sequence.length;t++){const r=n.sequence[t].id;Uye(r,n.sequenceId);const i=Y8(r).version;ds(i===e+1,`Migration id numbers must increase in increments of 1, expected ${n.sequenceId}/${e+1} but got '${n.sequence[t].id}'`),e=i}}var i0=(n=>(n.IncompatibleSubtype="incompatible-subtype",n.UnknownType="unknown-type",n.TargetVersionTooNew="target-version-too-new",n.TargetVersionTooOld="target-version-too-old",n.MigrationError="migration-error",n.UnrecognizedSubtype="unrecognized-subtype",n))(i0||{});function G4t(n){if(n.schemaVersion>2||n.schemaVersion<1)return iy.err("Bad schema version");if(n.schemaVersion===2)return iy.ok(n);const e={schemaVersion:2,sequences:{}};for(const[t,r]of Object.entries(n.recordVersions))if(e.sequences[`com.tldraw.${t}`]=r.version,"subTypeKey"in r)for(const[i,o]of Object.entries(r.subTypeVersions))e.sequences[`com.tldraw.${t}.${i}`]=o;return iy.ok(e)}class iie{constructor(e,t){$(this,"migrations",{});$(this,"sortedMigrations");var i;this.types=e,this.options=t;for(const o of t.migrations??[])ds(!this.migrations[o.sequenceId],`Duplicate migration sequenceId ${o.sequenceId}`),Q6e(o),this.migrations[o.sequenceId]=o;const r=Object.values(this.migrations).flatMap(o=>o.sequence);this.sortedMigrations=K4t(r);for(const o of this.sortedMigrations)if((i=o.dependsOn)!=null&&i.length)for(const s of o.dependsOn){const a=r.find(c=>c.id===s);ds(a,`Migration '${o.id}' depends on missing migration '${s}'`)}}static create(e,t){return new iie(e,t??{})}validateRecord(e,t,r,i){try{const o=ju(this.types,t.typeName);if(!o)throw new Error(`Missing definition for record type ${t.typeName}`);return o.validate(t,i??void 0)}catch(o){if(this.options.onValidationFailure)return this.options.onValidationFailure({store:e,record:t,phase:r,recordBefore:i,error:o});throw o}}getMigrationsSince(e){const t=G4t(e);if(!t.ok)return t;const r=t.value,i=new Set(Object.keys(r.sequences).filter(s=>this.migrations[s]));for(const s in this.migrations)r.sequences[s]===void 0&&this.migrations[s].retroactive&&i.add(s);if(i.size===0)return iy.ok([]);const o=new Set;for(const s of i){const a=r.sequences[s];if(typeof a!="number"&&this.migrations[s].retroactive||a===0){for(const u of this.migrations[s].sequence)o.add(u.id);continue}const c=`${s}/${a}`,l=this.migrations[s].sequence.findIndex(u=>u.id===c);if(l===-1)return iy.err("Incompatible schema?");for(const u of this.migrations[s].sequence.slice(l+1))o.add(u.id)}return iy.ok(this.sortedMigrations.filter(({id:s})=>o.has(s)))}migratePersistedRecord(e,t,r="up"){const i=this.getMigrationsSince(t);if(!i.ok)return console.error("Error migrating record",i.error),{type:"error",reason:i0.MigrationError};let o=i.value;if(o.length===0)return{type:"success",value:e};if(o.some(s=>s.scope==="store"))return{type:"error",reason:r==="down"?i0.TargetVersionTooOld:i0.TargetVersionTooNew};if(r==="down"){if(!o.every(s=>s.down))return{type:"error",reason:i0.TargetVersionTooOld};o=o.slice().reverse()}e=ls(e);try{for(const s of o){if(s.scope==="store")throw new Error;if(!(s.filter?s.filter(e):!0))continue;const c=s[r](e);c&&(e=ls(c))}}catch(s){return console.error("Error migrating record",s),{type:"error",reason:i0.MigrationError}}return{type:"success",value:e}}migrateStoreSnapshot(e){let{store:t}=e;const r=this.getMigrationsSince(e.schema);if(!r.ok)return console.error("Error migrating store",r.error),{type:"error",reason:i0.MigrationError};const i=r.value;if(i.length===0)return{type:"success",value:t};t=ls(t);try{for(const o of i)if(o.scope==="record")for(const[s,a]of Object.entries(t)){if(!(o.filter?o.filter(a):!0))continue;const l=o.up(a);l&&(t[s]=ls(l))}else if(o.scope==="store"){const s=o.up(t);s&&(t=ls(s))}else vl(o)}catch(o){return console.error("Error migrating store",o),{type:"error",reason:i0.MigrationError}}return{type:"success",value:t}}createIntegrityChecker(e){var t,r;return((r=(t=this.options).createIntegrityChecker)==null?void 0:r.call(t,e))??void 0}serialize(){return{schemaVersion:2,sequences:Object.fromEntries(Object.values(this.migrations).map(({sequenceId:e,sequence:t})=>[e,t.length?Y8(t.at(-1).id).version:0]))}}serializeEarliestVersion(){return{schemaVersion:2,sequences:Object.fromEntries(Object.values(this.migrations).map(({sequenceId:e})=>[e,0]))}}getType(e){const t=ju(this.types,e);return ds(t,"record type does not exists"),t}}function Z4t(n){if(!n.length)return null;let e="";for(const t of n)typeof t=="number"?e+=`.${t}`:t.startsWith("(")?e.endsWith(")")?e=`${e.slice(0,-1)}, ${t.slice(1)}`:e+=t:e+=`.${t}`;return e=e.replace(/id = [^,]+, /,"").replace(/id = [^)]+/,""),e.startsWith(".")?e.slice(1):e}class Ei extends Error{constructor(t,r=[]){const i=Z4t(r),o=t.split(`
`).map((s,a)=>a===0?s:`  ${s}`).join(`
`);super(r?`At ${i}: ${o}`:o);$(this,"name","ValidationError");this.rawMessage=t,this.path=r}}function zu(n,e){try{return e()}catch(t){throw t instanceof Ei?new Ei(t.rawMessage,[n,...t.path]):new Ei(t.toString(),[n])}}function Py(n){if(n===null)return"null";if(Array.isArray(n))return"an array";const e=typeof n;switch(e){case"bigint":case"boolean":case"function":case"number":case"string":case"symbol":return`a ${e}`;case"object":return`an ${e}`;case"undefined":return"undefined";default:vl(e)}}class au{constructor(e,t){this.validationFn=e,this.validateUsingKnownGoodVersionFn=t}validate(e){return this.validationFn(e)}validateUsingKnownGoodVersion(e,t){return Object.is(e,t)?e:this.validateUsingKnownGoodVersionFn?this.validateUsingKnownGoodVersionFn(e,t):this.validate(t)}isValid(e){try{return this.validate(e),!0}catch{return!1}}nullable(){return tOt(this)}optional(){return t8e(this)}refine(e){return new au(t=>e(this.validate(t)),(t,r)=>{const i=this.validateUsingKnownGoodVersion(t,r);return Object.is(t,i)?t:e(i)})}check(e,t){return typeof e=="string"?this.refine(r=>(zu(`(check ${e})`,()=>t(r)),r)):this.refine(r=>(e(r),r))}}class X4t extends au{constructor(e){super(t=>{const r=zye.validate(t);for(let i=0;i<r.length;i++)zu(i,()=>e.validate(r[i]));return r},(t,r)=>{if(!e.validateUsingKnownGoodVersion)return this.validate(r);const i=zye.validate(r);let o=t.length!==i.length;for(let s=0;s<i.length;s++){const a=i[s];if(s>=t.length){o=!0,zu(s,()=>e.validate(a));continue}if(Object.is(t[s],a))continue;const c=zu(s,()=>e.validateUsingKnownGoodVersion(t[s],a));Object.is(c,t[s])||(o=!0)}return o?r:t}),this.itemValidator=e}nonEmpty(){return this.check(e=>{if(e.length===0)throw new Ei("Expected a non-empty array")})}lengthGreaterThan1(){return this.check(e=>{if(e.length<=1)throw new Ei("Expected an array with length greater than 1")})}}class J8 extends au{constructor(e,t=!1){super(r=>{if(typeof r!="object"||r===null)throw new Ei(`Expected object, got ${Py(r)}`);for(const[i,o]of Object.entries(e))zu(i,()=>{o.validate(ju(r,i))});if(!t){for(const i of Object.keys(r))if(!ig(e,i))throw new Ei("Unexpected property",[i])}return r},(r,i)=>{if(typeof i!="object"||i===null)throw new Ei(`Expected object, got ${Py(i)}`);let o=!1;for(const[s,a]of Object.entries(e)){const c=ju(r,s),l=ju(i,s);if(Object.is(c,l))continue;const u=zu(s,()=>{const d=a;return d.validateUsingKnownGoodVersion?d.validateUsingKnownGoodVersion(c,l):d.validate(l)});Object.is(u,c)||(o=!0)}if(!t){for(const s of Object.keys(i))if(!ig(e,s))throw new Ei("Unexpected property",[s])}for(const s of Object.keys(r))if(!ig(i,s)){o=!0;break}return o?i:r}),this.config=e,this.shouldAllowUnknownProperties=t}allowUnknownProperties(){return new J8(this.config,!0)}extend(e){return new J8({...this.config,...e})}}class EN extends au{constructor(e,t,r,i){super(o=>{this.expectObject(o);const{matchingSchema:s,variant:a}=this.getMatchingSchemaAndVariant(o);return s===void 0?this.unknownValueValidation(o,a):zu(`(${e} = ${a})`,()=>s.validate(o))},(o,s)=>{this.expectObject(s),this.expectObject(o);const{matchingSchema:a,variant:c}=this.getMatchingSchemaAndVariant(s);return a===void 0?this.unknownValueValidation(s,c):ju(o,e)!==ju(s,e)?zu(`(${e} = ${c})`,()=>a.validate(s)):zu(`(${e} = ${c})`,()=>a.validateUsingKnownGoodVersion?a.validateUsingKnownGoodVersion(o,s):a.validate(s))}),this.key=e,this.config=t,this.unknownValueValidation=r,this.useNumberKeys=i}expectObject(e){if(typeof e!="object"||e===null)throw new Ei(`Expected an object, got ${Py(e)}`,[])}getMatchingSchemaAndVariant(e){const t=ju(e,this.key);if(!this.useNumberKeys&&typeof t!="string")throw new Ei(`Expected a string for key "${this.key}", got ${Py(t)}`);if(this.useNumberKeys&&!Number.isFinite(Number(t)))throw new Ei(`Expected a number for key "${this.key}", got "${t}"`);return{matchingSchema:ig(this.config,t)?this.config[t]:void 0,variant:t}}validateUnknownVariants(e){return new EN(this.key,this.config,e,this.useNumberKeys)}}class Y4t extends au{constructor(e,t){super(r=>{if(typeof r!="object"||r===null)throw new Ei(`Expected object, got ${Py(r)}`);for(const[i,o]of Object.entries(r))zu(i,()=>{e.validate(i),t.validate(o)});return r},(r,i)=>{if(typeof i!="object"||i===null)throw new Ei(`Expected object, got ${Py(i)}`);let o=!1;for(const[s,a]of Object.entries(i)){if(!ig(r,s)){o=!0,zu(s,()=>{e.validate(s),t.validate(a)});continue}const c=ju(r,s),l=a;if(Object.is(c,l))continue;const u=zu(s,()=>t.validateUsingKnownGoodVersion?t.validateUsingKnownGoodVersion(c,l):t.validate(l));Object.is(u,c)||(o=!0)}for(const s of Object.keys(r))if(!ig(i,s)){o=!0;break}return o?i:r}),this.keyValidator=e,this.valueValidator=t}}function oie(n){return new au(e=>{if(typeof e!==n)throw new Ei(`Expected ${n}, got ${Py(e)}`);return e})}const J4t=new au(n=>n),$r=oie("string"),cr=oie("number").check(n=>{if(Number.isNaN(n))throw new Ei("Expected a number, got NaN");if(!Number.isFinite(n))throw new Ei(`Expected a finite number, got ${n}`)}),Q8=cr.check(n=>{if(n<0)throw new Ei(`Expected a positive number, got ${n}`)}),ya=cr.check(n=>{if(n<=0)throw new Ei(`Expected a non-zero positive number, got ${n}`)}),e8e=cr.check(n=>{if(!Number.isInteger(n))throw new Ei(`Expected an integer, got ${n}`)}),vO=e8e.check(n=>{if(n<0)throw new Ei(`Expected a positive integer, got ${n}`)}),Q4t=e8e.check(n=>{if(n<=0)throw new Ei(`Expected a non-zero positive integer, got ${n}`)}),Si=oie("boolean");function wl(n){return new au(e=>{if(e!==n)throw new Ei(`Expected ${n}, got ${JSON.stringify(e)}`);return n})}const zye=new au(n=>{if(!Array.isArray(n))throw new Ei(`Expected an array, got ${Py(n)}`);return n});function Nc(n){return new X4t(n)}function oi(n){return new J8(n)}function JZ(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null||Object.getPrototypeOf(n)===m4t)}function QZ(n){return n===null||typeof n=="number"||typeof n=="string"||typeof n=="boolean"?!0:Array.isArray(n)?n.every(QZ):JZ(n)?Object.values(n).every(QZ):!1}const Fc=new au(n=>{if(QZ(n))return n;throw new Ei(`Expected json serializable value, got ${typeof n}`)},(n,e)=>{if(Array.isArray(n)&&Array.isArray(e)){let t=n.length!==e.length;for(let r=0;r<e.length;r++){if(r>=n.length){t=!0,Fc.validate(e[r]);continue}const i=n[r],o=e[r];if(Object.is(i,o))continue;const s=Fc.validateUsingKnownGoodVersion(i,o);Object.is(s,i)||(t=!0)}return t?e:n}else if(JZ(n)&&JZ(e)){let t=!1;for(const r of Object.keys(e)){if(!ig(n,r)){t=!0,Fc.validate(e[r]);continue}const i=n[r],o=e[r];if(Object.is(i,o))continue;const s=Fc.validateUsingKnownGoodVersion(i,o);Object.is(s,i)||(t=!0)}for(const r of Object.keys(n))if(!ig(e,r)){t=!0;break}return t?e:n}else return Fc.validate(e)});function e$(n,e){return new Y4t(n,e)}function sie(n,e){return new EN(n,e,(t,r)=>{throw new Ei(`Expected one of ${Object.keys(e).map(i=>JSON.stringify(i)).join(" or ")}, got ${JSON.stringify(r)}`,[n])},!1)}function eOt(n,e){return new EN(n,e,(t,r)=>{throw new Ei(`Expected one of ${Object.keys(e).map(i=>JSON.stringify(i)).join(" or ")}, got ${JSON.stringify(r)}`,[n])},!0)}function $g(n,e){return new au(t=>zu(n,()=>e.validate(t)),(t,r)=>zu(n,()=>e.validateUsingKnownGoodVersion?e.validateUsingKnownGoodVersion(t,r):e.validate(r)))}function IN(n){return new au(e=>{if(!n.has(e)){const t=Array.from(n,r=>JSON.stringify(r)).join(" or ");throw new Ei(`Expected ${t}, got ${e}`)}return e})}function t8e(n){return new au(e=>{if(e!==void 0)return n.validate(e)},(e,t)=>{if(!(e===void 0&&t===void 0)&&t!==void 0)return n.validateUsingKnownGoodVersion&&e!==void 0?n.validateUsingKnownGoodVersion(e,t):n.validate(t)})}function tOt(n){return new au(e=>e===null?null:n.validate(e),(e,t)=>t===null?null:n.validateUsingKnownGoodVersion&&e!==null?n.validateUsingKnownGoodVersion(e,t):n.validate(t))}function PN(...n){return IN(new Set(n))}function n8e(n){try{return new URL(n)}catch{if(n.startsWith("/")||n.startsWith("./"))try{return new URL(n,"http://example.com")}catch{throw new Ei(`Expected a valid url, got ${JSON.stringify(n)}`)}throw new Ei(`Expected a valid url, got ${JSON.stringify(n)}`)}}const nOt=new Set(["http:","https:","mailto:"]),Wd=$r.check(n=>{if(n==="")return;const e=n8e(n);if(!nOt.has(e.protocol.toLowerCase()))throw new Ei(`Expected a valid url, got ${JSON.stringify(n)} (invalid protocol)`)}),rOt=new Set(["http:","https:","data:","asset:"]),BS=$r.check(n=>{if(n==="")return;const e=n8e(n);if(!rOt.has(e.protocol.toLowerCase()))throw new Ei(`Expected a valid url, got ${JSON.stringify(n)} (invalid protocol)`)}),aie=$r.refine(n=>{try{return o4t(n),n}catch{throw new Ei(`Expected an index key, got ${JSON.stringify(n)}`)}});function Nd(n){return $r.refine(e=>{if(!e.startsWith(`${n}:`))throw new Error(`${n} ID must start with "${n}:"`);return e})}const kN=Nd("asset");function cie(n,e){return oi({id:kN,typeName:wl("asset"),type:wl(n),props:e,meta:Fc})}const HS=oi({x:cr,y:cr,z:cr.optional()}),fk=oi({x:cr,y:cr,w:cr,h:cr});let r8e=(n=21)=>crypto.getRandomValues(new Uint8Array(n)).reduce((e,t)=>(t&=63,t<36?e+=t.toString(36):t<62?e+=(t-26).toString(36).toUpperCase():t>62?e+="-":e+="_",e),"");const i8e=cr.check(n=>{if(n<0||n>1)throw new Ei("Opacity must be between 0 and 1")}),iOt=$r.refine(n=>{if(!n.startsWith("page:")&&!n.startsWith("shape:"))throw new Error('Parent ID must start with "page:" or "shape:"');return n}),_h=Nd("shape");function oOt(n,e,t){return oi({id:_h,typeName:wl("shape"),x:cr,y:cr,rotation:cr,index:aie,parentId:iOt,type:wl(n),isLocked:Si,opacity:i8e,props:e?oi(e):Fc,meta:t?oi(t):Fc})}const sOt=Nd("binding");function aOt(n,e,t){return oi({id:sOt,typeName:wl("binding"),type:wl(n),fromId:_h,toId:_h,props:e?oi(e):Fc,meta:t?oi(t):Fc})}Yu("com.tldraw.binding",{});Xd({sequenceId:"com.tldraw.binding",recordType:"binding",sequence:[]});function fS(n){return`binding:${r8e()}`}function cOt(n){return Mg("binding",{scope:"document",validator:$g("binding",sie("type",TD(n,(e,{props:t,meta:r})=>aOt(e,t,r))))}).withDefaultProperties(()=>({meta:{}}))}class el{constructor(e,t,r){this.id=e,this.defaultValue=t,this.type=r}static define(e,t){const{defaultValue:r,type:i=J4t}=t;return new el(e,r,i)}static defineEnum(e,t){const{defaultValue:r,values:i}=t;return new lOt(e,r,i)}validate(e){return this.type.validate(e)}validateUsingKnownGoodVersion(e,t){return this.type.validateUsingKnownGoodVersion?this.type.validateUsingKnownGoodVersion(e,t):this.validate(t)}}class lOt extends el{constructor(e,t,r){super(e,t,PN(...r)),this.values=r}}const Y5=Yu("com.tldraw.shape",{AddIsLocked:1,HoistOpacity:2,AddMeta:3,AddWhite:4}),uOt=Xd({sequenceId:"com.tldraw.shape",recordType:"shape",sequence:[{id:Y5.AddIsLocked,up:n=>{n.isLocked=!1},down:n=>{delete n.isLocked}},{id:Y5.HoistOpacity,up:n=>{n.opacity=Number(n.props.opacity??"1"),delete n.props.opacity},down:n=>{const e=n.opacity;delete n.opacity,n.props.opacity=e<.175?"0.1":e<.375?"0.25":e<.625?"0.5":e<.875?"0.75":"1"}},{id:Y5.AddMeta,up:n=>{n.meta={}}},{id:Y5.AddWhite,up:n=>{},down:n=>{n.props.color==="white"&&(n.props.color="black")}}]});function aC(n){return n?n.typeName==="shape":!1}function ku(n){return n?n.startsWith("shape:"):!1}function ro(n){return`shape:${n??r8e()}`}function o8e(n){const e=new Map;for(const[t,r]of Object.entries(n))if(r instanceof el){if(e.has(r))throw new Error(`Duplicate style prop ${r.id}. Each style prop can only be used once within a shape.`);e.set(r,t)}return e}function op(n,e){return TD(e,(t,r)=>`com.tldraw.shape.${n}/${r}`)}function dOt(n){return Mg("shape",{scope:"document",validator:$g("shape",sie("type",TD(n,(e,{props:t,meta:r})=>oOt(e,t,r))))}).withDefaultProperties(()=>({x:0,y:0,rotation:0,isLocked:!1,opacity:1,meta:{}}))}function Vye(n,e){const t=[];for(const[r,{migrations:i}]of Object.entries(e)){const o=`com.tldraw.${n}.${r}`;i?"sequenceId"in i?(ds(o===i.sequenceId,`sequenceId mismatch for ${r} ${CN} migrations. Expected '${o}', got '${i.sequenceId}'`),t.push(i)):"sequence"in i?t.push(qC({sequenceId:o,retroactive:!1,sequence:i.sequence.map(s=>"id"in s?s8e(n,r,s):s)})):t.push(qC({sequenceId:o,retroactive:!1,sequence:Object.keys(i.migrators).map(s=>Number(s)).sort((s,a)=>s-a).map(s=>({id:`${o}/${s}`,scope:"record",filter:a=>a.typeName===n&&a.type===r,up:a=>{const c=i.migrators[s].up(a);if(c)return c},down:a=>{const c=i.migrators[s].down(a);if(c)return c}}))})):t.push(qC({sequenceId:o,retroactive:!1,sequence:[]}))}return t}function s8e(n,e,t){return{id:t.id,dependsOn:t.dependsOn,scope:"record",filter:r=>r.typeName===n&&r.type===e,up:r=>{const i=t.up(r.props);i&&(r.props=i)},down:typeof t.down=="function"?r=>{const i=t.down(r.props);i&&(r.props=i)}:void 0}}const a8e=["black","grey","light-violet","violet","blue","light-blue","yellow","orange","green","light-green","light-red","red","white"],t$={lightMode:{id:"light",text:"#000000",background:"rgb(249, 250, 251)",solid:"#fcfffe",black:{solid:"#1d1d1d",fill:"#1d1d1d",note:{fill:"#FCE19C",text:"#000000"},semi:"#e8e8e8",pattern:"#494949",highlight:{srgb:"#fddd00",p3:"color(display-p3 0.972 0.8705 0.05)"}},blue:{solid:"#4465e9",fill:"#4465e9",note:{fill:"#8AA3FF",text:"#000000"},semi:"#dce1f8",pattern:"#6681ee",highlight:{srgb:"#10acff",p3:"color(display-p3 0.308 0.6632 0.9996)"}},green:{solid:"#099268",fill:"#099268",note:{fill:"#6FC896",text:"#000000"},semi:"#d3e9e3",pattern:"#39a785",highlight:{srgb:"#00ffc8",p3:"color(display-p3 0.2536 0.984 0.7981)"}},grey:{solid:"#9fa8b2",fill:"#9fa8b2",note:{fill:"#C0CAD3",text:"#000000"},semi:"#eceef0",pattern:"#bcc3c9",highlight:{srgb:"#cbe7f1",p3:"color(display-p3 0.8163 0.9023 0.9416)"}},"light-blue":{solid:"#4ba1f1",fill:"#4ba1f1",note:{fill:"#9BC4FD",text:"#000000"},semi:"#ddedfa",pattern:"#6fbbf8",highlight:{srgb:"#00f4ff",p3:"color(display-p3 0.1512 0.9414 0.9996)"}},"light-green":{solid:"#4cb05e",fill:"#4cb05e",note:{fill:"#98D08A",text:"#000000"},semi:"#dbf0e0",pattern:"#65cb78",highlight:{srgb:"#65f641",p3:"color(display-p3 0.563 0.9495 0.3857)"}},"light-red":{solid:"#f87777",fill:"#f87777",note:{fill:"#F7A5A1",text:"#000000"},semi:"#f4dadb",pattern:"#fe9e9e",highlight:{srgb:"#ff7fa3",p3:"color(display-p3 0.9988 0.5301 0.6397)"}},"light-violet":{solid:"#e085f4",fill:"#e085f4",note:{fill:"#DFB0F9",text:"#000000"},semi:"#f5eafa",pattern:"#e9acf8",highlight:{srgb:"#ff88ff",p3:"color(display-p3 0.9676 0.5652 0.9999)"}},orange:{solid:"#e16919",fill:"#e16919",note:{fill:"#FAA475",text:"#000000"},semi:"#f8e2d4",pattern:"#f78438",highlight:{srgb:"#ffa500",p3:"color(display-p3 0.9988 0.6905 0.266)"}},red:{solid:"#e03131",fill:"#e03131",note:{fill:"#FC8282",text:"#000000"},semi:"#f4dadb",pattern:"#e55959",highlight:{srgb:"#ff636e",p3:"color(display-p3 0.9992 0.4376 0.45)"}},violet:{solid:"#ae3ec9",fill:"#ae3ec9",note:{fill:"#DB91FD",text:"#000000"},semi:"#ecdcf2",pattern:"#bd63d3",highlight:{srgb:"#c77cff",p3:"color(display-p3 0.7469 0.5089 0.9995)"}},yellow:{solid:"#f1ac4b",fill:"#f1ac4b",note:{fill:"#FED49A",text:"#000000"},semi:"#f9f0e6",pattern:"#fecb92",highlight:{srgb:"#fddd00",p3:"color(display-p3 0.972 0.8705 0.05)"}},white:{solid:"#FFFFFF",fill:"#FFFFFF",semi:"#f5f5f5",pattern:"#f9f9f9",note:{fill:"#FFFFFF",text:"#000000"},highlight:{srgb:"#ffffff",p3:"color(display-p3 1 1 1)"}}},darkMode:{id:"dark",text:"hsl(210, 17%, 98%)",background:"hsl(240, 5%, 6.5%)",solid:"#010403",black:{solid:"#f2f2f2",fill:"#f2f2f2",note:{fill:"#2c2c2c",text:"#f2f2f2"},semi:"#2c3036",pattern:"#989898",highlight:{srgb:"#d2b700",p3:"color(display-p3 0.8078 0.7225 0.0312)"}},blue:{solid:"#4f72fc",fill:"#4f72fc",note:{fill:"#2A3F98",text:"#f2f2f2"},semi:"#262d40",pattern:"#3a4b9e",highlight:{srgb:"#0079d2",p3:"color(display-p3 0.0032 0.4655 0.7991)"}},green:{solid:"#099268",fill:"#099268",note:{fill:"#014429",text:"#f2f2f2"},semi:"#253231",pattern:"#366a53",highlight:{srgb:"#009774",p3:"color(display-p3 0.0085 0.582 0.4604)"}},grey:{solid:"#9398b0",fill:"#9398b0",note:{fill:"#56595F",text:"#f2f2f2"},semi:"#33373c",pattern:"#7c8187",highlight:{srgb:"#9cb4cb",p3:"color(display-p3 0.6299 0.7012 0.7856)"}},"light-blue":{solid:"#4dabf7",fill:"#4dabf7",note:{fill:"#1F5495",text:"#f2f2f2"},semi:"#2a3642",pattern:"#4d7aa9",highlight:{srgb:"#00bdc8",p3:"color(display-p3 0.0023 0.7259 0.7735)"}},"light-green":{solid:"#40c057",fill:"#40c057",note:{fill:"#21581D",text:"#f2f2f2"},semi:"#2a3830",pattern:"#4e874e",highlight:{srgb:"#00a000",p3:"color(display-p3 0.2711 0.6172 0.0195)"}},"light-red":{solid:"#ff8787",fill:"#ff8787",note:{fill:"#923632",text:"#f2f2f2"},semi:"#3b3235",pattern:"#a56767",highlight:{srgb:"#db005b",p3:"color(display-p3 0.7849 0.0585 0.3589)"}},"light-violet":{solid:"#e599f7",fill:"#e599f7",note:{fill:"#762F8E",text:"#f2f2f2"},semi:"#383442",pattern:"#9770a9",highlight:{srgb:"#c400c7",p3:"color(display-p3 0.7024 0.0403 0.753)"}},orange:{solid:"#f76707",fill:"#f76707",note:{fill:"#843906",text:"#f2f2f2"},semi:"#3a2e2a",pattern:"#9f552d",highlight:{srgb:"#d07a00",p3:"color(display-p3 0.7699 0.4937 0.0085)"}},red:{solid:"#e03131",fill:"#e03131",note:{fill:"#89231A",text:"#f2f2f2"},semi:"#36292b",pattern:"#8f3734",highlight:{srgb:"#de002c",p3:"color(display-p3 0.7978 0.0509 0.2035)"}},violet:{solid:"#ae3ec9",fill:"#ae3ec9",note:{fill:"#681683",text:"#f2f2f2"},semi:"#31293c",pattern:"#763a8b",highlight:{srgb:"#9e00ee",p3:"color(display-p3 0.5651 0.0079 0.8986)"}},yellow:{solid:"#ffc034",fill:"#ffc034",note:{fill:"#98571B",text:"#f2f2f2"},semi:"#3c3934",pattern:"#fecb92",highlight:{srgb:"#d2b700",p3:"color(display-p3 0.8078 0.7225 0.0312)"}},white:{solid:"#f3f3f3",fill:"#f3f3f3",semi:"#f5f5f5",pattern:"#f9f9f9",note:{fill:"#eaeaea",text:"#1d1d1d"},highlight:{srgb:"#ffffff",p3:"color(display-p3 1 1 1)"}}}};function xv(n){return n.isDarkMode?t$.darkMode:t$.lightMode}const qd=el.defineEnum("tldraw:color",{defaultValue:"black",values:a8e}),c8e=el.defineEnum("tldraw:labelColor",{defaultValue:"black",values:a8e}),US=el.defineEnum("tldraw:dash",{defaultValue:"draw",values:["draw","solid","dashed","dotted"]}),zS=el.defineEnum("tldraw:fill",{defaultValue:"none",values:["none","semi","solid","pattern","fill"]}),yg=el.defineEnum("tldraw:font",{defaultValue:"draw",values:["draw","sans","serif","mono"]}),l8e={draw:"'tldraw_draw', sans-serif",sans:"'tldraw_sans', sans-serif",serif:"'tldraw_serif', serif",mono:"'tldraw_mono', monospace"},bg=el.defineEnum("tldraw:size",{defaultValue:"m",values:["s","m","l","xl"]}),u8e=["arrow","triangle","square","dot","pipe","diamond","inverted","bar","none"],n$=el.defineEnum("tldraw:arrowheadStart",{defaultValue:"none",values:u8e}),r$=el.defineEnum("tldraw:arrowheadEnd",{defaultValue:"arrow",values:u8e}),d8e={labelColor:c8e,color:qd,fill:zS,dash:US,size:bg,arrowheadStart:n$,arrowheadEnd:r$,font:yg,start:HS,end:HS,bend:cr,text:$r,labelPosition:cr,scale:ya},Lw=op("arrow",{AddLabelColor:1,AddIsPrecise:2,AddLabelPosition:3,ExtractBindings:4,AddScale:5});function J5(n){return s8e("shape","arrow",n)}const h8e=qC({sequenceId:"com.tldraw.shape.arrow",sequence:[J5({id:Lw.AddLabelColor,up:n=>{n.labelColor="black"},down:"retired"}),J5({id:Lw.AddIsPrecise,up:({start:n,end:e})=>{n.type==="binding"&&(n.isPrecise=!(n.normalizedAnchor.x===.5&&n.normalizedAnchor.y===.5)),e.type==="binding"&&(e.isPrecise=!(e.normalizedAnchor.x===.5&&e.normalizedAnchor.y===.5))},down:({start:n,end:e})=>{n.type==="binding"&&(n.isPrecise||(n.normalizedAnchor={x:.5,y:.5}),delete n.isPrecise),e.type==="binding"&&(e.isPrecise||(e.normalizedAnchor={x:.5,y:.5}),delete e.isPrecise)}}),J5({id:Lw.AddLabelPosition,up:n=>{n.labelPosition=.5},down:n=>{delete n.labelPosition}}),{id:Lw.ExtractBindings,scope:"store",up:n=>{const e=Object.values(n).filter(t=>t.typeName==="shape"&&t.type==="arrow");for(const t of e){const{start:r,end:i}=t.props;if(r.type==="binding"){const o=fS(),s={typeName:"binding",id:o,type:"arrow",fromId:t.id,toId:r.boundShapeId,meta:{},props:{terminal:"start",normalizedAnchor:r.normalizedAnchor,isExact:r.isExact,isPrecise:r.isPrecise}};n[o]=s,t.props.start={x:0,y:0}}else delete t.props.start.type;if(i.type==="binding"){const o=fS(),s={typeName:"binding",id:o,type:"arrow",fromId:t.id,toId:i.boundShapeId,meta:{},props:{terminal:"end",normalizedAnchor:i.normalizedAnchor,isExact:i.isExact,isPrecise:i.isPrecise}};n[o]=s,t.props.end={x:0,y:0}}else delete t.props.end.type}}},J5({id:Lw.AddScale,up:n=>{n.scale=1},down:n=>{delete n.scale}})]}),f8e={terminal:PN("start","end"),normalizedAnchor:HS,isExact:Si,isPrecise:Si},p8e={sequence:[{dependsOn:[Lw.ExtractBindings]}]},hOt=$g("camera",oi({typeName:wl("camera"),id:Nd("camera"),x:cr,y:cr,z:cr,meta:Fc})),fOt=Yu("com.tldraw.camera",{AddMeta:1}),pOt=Xd({sequenceId:"com.tldraw.camera",recordType:"camera",sequence:[{id:fOt.AddMeta,up:n=>{n.meta={}}}]}),Ff=Mg("camera",{validator:hOt,scope:"session"}).withDefaultProperties(()=>({x:0,y:0,z:1,meta:{}})),gOt=new Set(["none","default","pointer","cross","grab","rotate","grabbing","resize-edge","resize-corner","text","move","ew-resize","ns-resize","nesw-resize","nwse-resize","nesw-rotate","nwse-rotate","swne-rotate","senw-rotate","zoom-in","zoom-out"]),g8e=IN(gOt),mOt=oi({type:g8e,rotation:cr}),vOt=new Set(["accent","white","black","selection-stroke","selection-fill","laser","muted-1"]),yOt=IN(vOt),bOt=new Set(["starting","paused","active","stopping"]),m8e=oi({id:$r,points:Nc(HS),size:Q8,color:yOt,opacity:cr,state:IN(bOt),delay:cr,shrink:cr,taper:Si}),B3=Nd("page"),SOt=$g("page",oi({typeName:wl("page"),id:B3,name:$r,index:aie,meta:Fc})),_Ot=Yu("com.tldraw.page",{AddMeta:1}),wOt=Xd({sequenceId:"com.tldraw.page",recordType:"page",sequence:[{id:_Ot.AddMeta,up:n=>{n.meta={}}}]}),dv=Mg("page",{validator:SOt,scope:"document"}).withDefaultProperties(()=>({meta:{}}));function Cu(n){return dv.isId(n)}const COt={id:!1,typeName:!1,currentPageId:!1,opacityForNextShape:!1,stylesForNextShape:!1,followingUserId:!1,highlightedUserIds:!1,brush:!1,cursor:!1,scribbles:!1,isFocusMode:!0,isDebugMode:!0,isToolLocked:!0,exportBackground:!0,screenBounds:!0,insets:!0,zoomBrush:!1,chatMessage:!1,isChatting:!1,isPenMode:!1,isGridMode:!0,isFocused:!0,devicePixelRatio:!0,isCoarsePointer:!0,isHoveringCanvas:!1,openMenus:!1,isChangingStyle:!1,isReadonly:!0,meta:!1,duplicateProps:!1},v8e=n=>n?dk(n,e=>COt[e]):null;Nd("instance");function xOt(n){const e={};for(const[r,i]of n)e[r]=t8e(i);const t=$g("instance",oi({typeName:wl("instance"),id:Nd("instance"),currentPageId:B3,followingUserId:$r.nullable(),brush:fk.nullable(),opacityForNextShape:i8e,stylesForNextShape:oi(e),cursor:mOt,scribbles:Nc(m8e),isFocusMode:Si,isDebugMode:Si,isToolLocked:Si,exportBackground:Si,screenBounds:fk,insets:Nc(Si),zoomBrush:fk.nullable(),isPenMode:Si,isGridMode:Si,chatMessage:$r,isChatting:Si,highlightedUserIds:Nc($r),isFocused:Si,devicePixelRatio:cr,isCoarsePointer:Si,isHoveringCanvas:Si.nullable(),openMenus:Nc($r),isChangingStyle:Si,isReadonly:Si,meta:Fc,duplicateProps:oi({shapeIds:Nc(Nd("shape")),offset:oi({x:cr,y:cr})}).nullable()}));return Mg("instance",{validator:t,scope:"session",ephemeralKeys:{currentPageId:!1,meta:!1,followingUserId:!0,opacityForNextShape:!0,stylesForNextShape:!0,brush:!0,cursor:!0,scribbles:!0,isFocusMode:!0,isDebugMode:!0,isToolLocked:!0,exportBackground:!0,screenBounds:!0,insets:!0,zoomBrush:!0,isPenMode:!0,isGridMode:!0,chatMessage:!0,isChatting:!0,highlightedUserIds:!0,isFocused:!0,devicePixelRatio:!0,isCoarsePointer:!0,isHoveringCanvas:!0,openMenus:!0,isChangingStyle:!0,isReadonly:!0,duplicateProps:!0}}).withDefaultProperties(()=>({followingUserId:null,opacityForNextShape:1,stylesForNextShape:{},brush:null,scribbles:[],cursor:{type:"default",rotation:0},isFocusMode:!1,exportBackground:!1,isDebugMode:!1,isToolLocked:!1,screenBounds:{x:0,y:0,w:1080,h:720},insets:[!1,!1,!1,!1],zoomBrush:null,isGridMode:!1,isPenMode:!1,chatMessage:"",isChatting:!1,highlightedUserIds:[],isFocused:!1,devicePixelRatio:typeof window>"u"?1:window.devicePixelRatio,isCoarsePointer:!1,isHoveringCanvas:null,openMenus:[],isChangingStyle:!1,isReadonly:!1,meta:{},duplicateProps:null}))}const Zo=Yu("com.tldraw.instance",{AddTransparentExportBgs:1,RemoveDialog:2,AddToolLockMode:3,RemoveExtraPropsForNextShape:4,AddLabelColor:5,AddFollowingUserId:6,RemoveAlignJustify:7,AddZoom:8,AddVerticalAlign:9,AddScribbleDelay:10,RemoveUserId:11,AddIsPenModeAndIsGridMode:12,HoistOpacity:13,AddChat:14,AddHighlightedUserIds:15,ReplacePropsForNextShapeWithStylesForNextShape:16,AddMeta:17,RemoveCursorColor:18,AddLonelyProperties:19,ReadOnlyReadonly:20,AddHoveringCanvas:21,AddScribbles:22,AddInset:23,AddDuplicateProps:24,RemoveCanMoveCamera:25}),EOt=Xd({sequenceId:"com.tldraw.instance",recordType:"instance",sequence:[{id:Zo.AddTransparentExportBgs,up:n=>({...n,exportBackground:!0})},{id:Zo.RemoveDialog,up:({dialog:n,...e})=>e},{id:Zo.AddToolLockMode,up:n=>({...n,isToolLocked:!1})},{id:Zo.RemoveExtraPropsForNextShape,up:({propsForNextShape:n,...e})=>({...e,propsForNextShape:Object.fromEntries(Object.entries(n).filter(([t])=>["color","labelColor","dash","fill","size","font","align","verticalAlign","icon","geo","arrowheadStart","arrowheadEnd","spline"].includes(t)))})},{id:Zo.AddLabelColor,up:({propsForNextShape:n,...e})=>({...e,propsForNextShape:{...n,labelColor:"black"}})},{id:Zo.AddFollowingUserId,up:n=>({...n,followingUserId:null})},{id:Zo.RemoveAlignJustify,up:n=>{let e=n.propsForNextShape.align;return e==="justify"&&(e="start"),{...n,propsForNextShape:{...n.propsForNextShape,align:e}}}},{id:Zo.AddZoom,up:n=>({...n,zoomBrush:null})},{id:Zo.AddVerticalAlign,up:n=>({...n,propsForNextShape:{...n.propsForNextShape,verticalAlign:"middle"}})},{id:Zo.AddScribbleDelay,up:n=>n.scribble!==null?{...n,scribble:{...n.scribble,delay:0}}:{...n}},{id:Zo.RemoveUserId,up:({userId:n,...e})=>e},{id:Zo.AddIsPenModeAndIsGridMode,up:n=>({...n,isPenMode:!1,isGridMode:!1})},{id:Zo.HoistOpacity,up:({propsForNextShape:{opacity:n,...e},...t})=>({...t,opacityForNextShape:Number(n??"1"),propsForNextShape:e})},{id:Zo.AddChat,up:n=>({...n,chatMessage:"",isChatting:!1})},{id:Zo.AddHighlightedUserIds,up:n=>({...n,highlightedUserIds:[]})},{id:Zo.ReplacePropsForNextShapeWithStylesForNextShape,up:({propsForNextShape:n,...e})=>({...e,stylesForNextShape:{}})},{id:Zo.AddMeta,up:n=>({...n,meta:{}})},{id:Zo.RemoveCursorColor,up:n=>{const{color:e,...t}=n.cursor;return{...n,cursor:t}}},{id:Zo.AddLonelyProperties,up:n=>({...n,canMoveCamera:!0,isFocused:!1,devicePixelRatio:1,isCoarsePointer:!1,openMenus:[],isChangingStyle:!1,isReadOnly:!1})},{id:Zo.ReadOnlyReadonly,up:({isReadOnly:n,...e})=>({...e,isReadonly:n})},{id:Zo.AddHoveringCanvas,up:n=>({...n,isHoveringCanvas:null})},{id:Zo.AddScribbles,up:({scribble:n,...e})=>({...e,scribbles:[]})},{id:Zo.AddInset,up:n=>({...n,insets:[!1,!1,!1,!1]}),down:({insets:n,...e})=>({...e})},{id:Zo.AddDuplicateProps,up:n=>({...n,duplicateProps:null}),down:({duplicateProps:n,...e})=>({...e})},{id:Zo.RemoveCanMoveCamera,up:({canMoveCamera:n,...e})=>({...e}),down:n=>({...n,canMoveCamera:!0})}]}),fl="instance:instance",IOt=$g("instance_page_state",oi({typeName:wl("instance_page_state"),id:Nd("instance_page_state"),pageId:B3,selectedShapeIds:Nc(_h),hintingShapeIds:Nc(_h),erasingShapeIds:Nc(_h),hoveredShapeId:_h.nullable(),editingShapeId:_h.nullable(),croppingShapeId:_h.nullable(),focusedGroupId:_h.nullable(),meta:Fc})),yI=Yu("com.tldraw.instance_page_state",{AddCroppingId:1,RemoveInstanceIdAndCameraId:2,AddMeta:3,RenameProperties:4,RenamePropertiesAgain:5}),POt=Xd({sequenceId:"com.tldraw.instance_page_state",recordType:"instance_page_state",sequence:[{id:yI.AddCroppingId,up(n){n.croppingShapeId=null}},{id:yI.RemoveInstanceIdAndCameraId,up(n){delete n.instanceId,delete n.cameraId}},{id:yI.AddMeta,up:n=>{n.meta={}}},{id:yI.RenameProperties,up:n=>{},down:n=>{}},{id:yI.RenamePropertiesAgain,up:n=>{n.selectedShapeIds=n.selectedIds,delete n.selectedIds,n.hintingShapeIds=n.hintingIds,delete n.hintingIds,n.erasingShapeIds=n.erasingIds,delete n.erasingIds,n.hoveredShapeId=n.hoveredId,delete n.hoveredId,n.editingShapeId=n.editingId,delete n.editingId,n.croppingShapeId=n.croppingShapeId??n.croppingId??null,delete n.croppingId,n.focusedGroupId=n.focusLayerId,delete n.focusLayerId},down:n=>{n.selectedIds=n.selectedShapeIds,delete n.selectedShapeIds,n.hintingIds=n.hintingShapeIds,delete n.hintingShapeIds,n.erasingIds=n.erasingShapeIds,delete n.erasingShapeIds,n.hoveredId=n.hoveredShapeId,delete n.hoveredShapeId,n.editingId=n.editingShapeId,delete n.editingShapeId,n.croppingId=n.croppingShapeId,delete n.croppingShapeId,n.focusLayerId=n.focusedGroupId,delete n.focusedGroupId}}]}),Oh=Mg("instance_page_state",{validator:IOt,scope:"session",ephemeralKeys:{pageId:!1,selectedShapeIds:!1,editingShapeId:!1,croppingShapeId:!1,meta:!1,hintingShapeIds:!0,erasingShapeIds:!0,hoveredShapeId:!0,focusedGroupId:!0}}).withDefaultProperties(()=>({editingShapeId:null,croppingShapeId:null,selectedShapeIds:[],hoveredShapeId:null,erasingShapeIds:[],hintingShapeIds:[],focusedGroupId:null,meta:{}})),kOt=$g("pointer",oi({typeName:wl("pointer"),id:Nd("pointer"),x:cr,y:cr,lastActivityTimestamp:cr,meta:Fc})),TOt=Yu("com.tldraw.pointer",{AddMeta:1}),DOt=Xd({sequenceId:"com.tldraw.pointer",recordType:"pointer",sequence:[{id:TOt.AddMeta,up:n=>{n.meta={}}}]}),lie=Mg("pointer",{validator:kOt,scope:"session"}).withDefaultProperties(()=>({x:0,y:0,lastActivityTimestamp:0,meta:{}})),H3=lie.createId("pointer"),ROt=$g("instance_presence",oi({typeName:wl("instance_presence"),id:Nd("instance_presence"),userId:$r,userName:$r,lastActivityTimestamp:cr,followingUserId:$r.nullable(),cursor:oi({x:cr,y:cr,type:g8e,rotation:cr}),color:$r,camera:oi({x:cr,y:cr,z:cr}),screenBounds:fk,selectedShapeIds:Nc(Nd("shape")),currentPageId:Nd("page"),brush:fk.nullable(),scribbles:Nc(m8e),chatMessage:$r,meta:Fc})),bI=Yu("com.tldraw.instance_presence",{AddScribbleDelay:1,RemoveInstanceId:2,AddChatMessage:3,AddMeta:4,RenameSelectedShapeIds:5}),AOt=Xd({sequenceId:"com.tldraw.instance_presence",recordType:"instance_presence",sequence:[{id:bI.AddScribbleDelay,up:n=>{n.scribble!==null&&(n.scribble.delay=0)}},{id:bI.RemoveInstanceId,up:n=>{delete n.instanceId}},{id:bI.AddChatMessage,up:n=>{n.chatMessage=""}},{id:bI.AddMeta,up:n=>{n.meta={}}},{id:bI.RenameSelectedShapeIds,up:n=>{}}]}),U3=Mg("instance_presence",{validator:ROt,scope:"presence"}).withDefaultProperties(()=>({lastActivityTimestamp:0,followingUserId:null,color:"#FF0000",camera:{x:0,y:0,z:1},cursor:{x:0,y:0,type:"default",rotation:0},screenBounds:{x:0,y:0,w:1,h:1},selectedShapeIds:[],brush:null,scribbles:[],chatMessage:"",meta:{}})),OOt=(n,e)=>t=>Et("instancePresence",()=>{const r=t.get(fl),i=t.get(Oh.createId(r==null?void 0:r.currentPageId)),o=t.get(Ff.createId(r==null?void 0:r.currentPageId)),s=t.get(H3),a=n.get();return!i||!r||!o||!s||!a?null:U3.create({id:U3.createId(t.id),selectedShapeIds:i.selectedShapeIds,brush:r.brush,scribbles:r.scribbles,userId:a.id,userName:a.name,followingUserId:r.followingUserId,camera:{x:o.x,y:o.y,z:o.z},color:a.color,currentPageId:r.currentPageId,cursor:{x:s.x,y:s.y,rotation:r.cursor.rotation,type:r.cursor.type},lastActivityTimestamp:s.lastActivityTimestamp,screenBounds:r.screenBounds,chatMessage:r.chatMessage,meta:{}})}),MOt=$g("document",oi({typeName:wl("document"),id:wl("document:document"),gridSize:cr,name:$r,meta:Fc})),Wye=Yu("com.tldraw.document",{AddName:1,AddMeta:2}),$Ot=Xd({sequenceId:"com.tldraw.document",recordType:"document",sequence:[{id:Wye.AddName,up:n=>{n.name=""},down:n=>{delete n.name}},{id:Wye.AddMeta,up:n=>{n.meta={}}}]}),uie=Mg("document",{validator:MOt,scope:"document"}).withDefaultProperties(()=>({gridSize:10,name:"",meta:{}})),eX=uie.createId("document");function LOt(n,e){return n.index<e.index?-1:n.index>e.index?1:0}function qye(n){n.typeName==="asset"&&("src"in n&&(n.src="<redacted>"),"src"in n.props&&(n.props.src="<redacted>"))}const NOt=({error:n,phase:e,record:t,recordBefore:r})=>{throw Gre(n,{tags:{origin:"store.validateRecord",storePhase:e,isExistingValidationIssue:e==="initialize"},extras:{recordBefore:r?qye(ls(r)):void 0,recordAfter:qye(ls(t))}}),n};function FOt(){return[dv.create({id:"page:page",name:"Page 1",index:"a1",meta:{}})]}function jOt(n){const e=n.query.ids("page"),t=()=>{if(!n.has(eX))return n.put([uie.create({id:eX,name:n.props.defaultName})]),t();if(!n.has(H3))return n.put([lie.create({id:H3})]),t();const r=e.get();if(r.size===0)return n.put(FOt()),t();const i=()=>[...r].map(c=>n.get(c)).sort(LOt)[0].id,o=n.get(fl);if(o){if(!r.has(o.currentPageId))return n.put([{...o,currentPageId:i()}]),t()}else return n.put([n.schema.types.instance.create({id:fl,currentPageId:i(),exportBackground:!0})]),t();const s=new Set,a=new Set;for(const c of r){const l=Oh.createId(c);n.has(l)||s.add(l);const u=Ff.createId(c);n.has(u)||a.add(u)}s.size>0&&n.put([...s].map(c=>Oh.create({id:c,pageId:Oh.parseId(c)}))),a.size>0&&n.put([...a].map(c=>Ff.create({id:c})))};return t}const BOt=cie("bookmark",oi({title:$r,description:$r,image:$r,favicon:$r,src:BS.nullable()})),Kye=Yu("com.tldraw.asset.bookmark",{MakeUrlsValid:1,AddFavicon:2}),HOt=Xd({sequenceId:"com.tldraw.asset.bookmark",recordType:"asset",filter:n=>n.type==="bookmark",sequence:[{id:Kye.MakeUrlsValid,up:n=>{BS.isValid(n.props.src)||(n.props.src="")},down:n=>{}},{id:Kye.AddFavicon,up:n=>{BS.isValid(n.props.favicon)||(n.props.favicon="")},down:n=>{delete n.props.favicon}}]}),UOt=cie("image",oi({w:cr,h:cr,fileSize:cr,name:$r,isAnimated:Si,mimeType:$r.nullable(),src:BS.nullable()})),Q5=Yu("com.tldraw.asset.image",{AddIsAnimated:1,RenameWidthHeight:2,MakeUrlsValid:3,AddFileSize:4}),zOt=Xd({sequenceId:"com.tldraw.asset.image",recordType:"asset",filter:n=>n.type==="image",sequence:[{id:Q5.AddIsAnimated,up:n=>{n.props.isAnimated=!1},down:n=>{delete n.props.isAnimated}},{id:Q5.RenameWidthHeight,up:n=>{n.props.w=n.props.width,n.props.h=n.props.height,delete n.props.width,delete n.props.height},down:n=>{n.props.width=n.props.w,n.props.height=n.props.h,delete n.props.w,delete n.props.h}},{id:Q5.MakeUrlsValid,up:n=>{BS.isValid(n.props.src)||(n.props.src="")},down:n=>{}},{id:Q5.AddFileSize,up:n=>{n.props.fileSize=-1},down:n=>{delete n.props.fileSize}}]}),VOt=cie("video",oi({w:cr,h:cr,fileSize:cr,name:$r,isAnimated:Si,mimeType:$r.nullable(),src:BS.nullable()})),eA=Yu("com.tldraw.asset.video",{AddIsAnimated:1,RenameWidthHeight:2,MakeUrlsValid:3,AddFileSize:4}),WOt=Xd({sequenceId:"com.tldraw.asset.video",recordType:"asset",filter:n=>n.type==="video",sequence:[{id:eA.AddIsAnimated,up:n=>{n.props.isAnimated=!1},down:n=>{delete n.props.isAnimated}},{id:eA.RenameWidthHeight,up:n=>{n.props.w=n.props.width,n.props.h=n.props.height,delete n.props.width,delete n.props.height},down:n=>{n.props.width=n.props.w,n.props.height=n.props.h,delete n.props.w,delete n.props.h}},{id:eA.MakeUrlsValid,up:n=>{BS.isValid(n.props.src)||(n.props.src="")},down:n=>{}},{id:eA.AddFileSize,up:n=>{n.props.fileSize=-1},down:n=>{delete n.props.fileSize}}]}),qOt=$g("asset",sie("type",{image:UOt,video:VOt,bookmark:BOt})),KOt=Yu("com.tldraw.asset",{AddMeta:1}),GOt=Xd({sequenceId:"com.tldraw.asset",recordType:"asset",sequence:[{id:KOt.AddMeta,up:n=>{n.meta={}}}]}),A1=Mg("asset",{validator:qOt,scope:"document"}).withDefaultProperties(()=>({meta:{}})),y8e={w:ya,h:ya,assetId:kN.nullable(),url:Wd},Gye=op("bookmark",{NullAssetId:1,MakeUrlsValid:2}),b8e={sequence:[{id:Gye.NullAssetId,up:n=>{n.assetId===void 0&&(n.assetId=null)},down:"retired"},{id:Gye.MakeUrlsValid,up:n=>{Wd.isValid(n.url)||(n.url="")},down:n=>{}}]},S8e=oi({type:PN("free","straight"),points:Nc(HS)}),_8e={color:qd,fill:zS,dash:US,size:bg,segments:Nc(S8e),isComplete:Si,isClosed:Si,isPen:Si,scale:ya},Zye=op("draw",{AddInPen:1,AddScale:2}),w8e={sequence:[{id:Zye.AddInPen,up:n=>{const{points:e}=n.segments[0];if(e.length===0){n.isPen=!1;return}let t=!(e[0].z===0||e[0].z===.5);e[1]&&(t=t&&!(e[1].z===0||e[1].z===.5)),n.isPen=t},down:"retired"},{id:Zye.AddScale,up:n=>{n.scale=1},down:n=>{delete n.scale}}]};var ZOt={};const Xye=/(^\/r\/[^/]+\/?$)/,Vi=n=>{try{return new URL(n)}catch{return}},DD=[{type:"tldraw",title:"tldraw",hostnames:["beta.tldraw.com","tldraw.com","localhost:3000"],minWidth:300,minHeight:300,width:720,height:500,doesResize:!0,overridePermissions:{"allow-top-navigation":!0},toEmbedUrl:n=>{const e=Vi(n);if(e&&e.pathname.match(Xye))return n},fromEmbedUrl:n=>{const e=Vi(n);if(e&&e.pathname.match(Xye))return n}},{type:"figma",title:"Figma",hostnames:["figma.com"],width:720,height:500,doesResize:!0,toEmbedUrl:n=>{if(n.match(/https:\/\/([\w\.-]+\.)?figma.com\/(file|proto)\/([0-9a-zA-Z]{22,128})(?:\/.*)?$/)&&!n.includes("figma.com/embed"))return`https://www.figma.com/embed?embed_host=share&url=${n}`},fromEmbedUrl:n=>{const e=Vi(n);if(e&&e.pathname.match(/^\/embed\/?$/)){const t=e.searchParams.get("url");if(t)return t}}},{type:"google_maps",title:"Google Maps",hostnames:["google.*"],width:720,height:500,doesResize:!0,overridePermissions:{"allow-presentation":!0},toEmbedUrl:n=>{if(n.includes("/maps/")){const e=n.match(/@(.*),(.*),(.*)z/);let t;if(e){const[,r,i,o]=e;t=`https://${new URL(n).host.replace("www.","")}/maps/embed/v1/view?key=${ZOt.NEXT_PUBLIC_GC_API_KEY}&center=${r},${i}&zoom=${o}`}else t="";return t}},fromEmbedUrl:n=>{const e=Vi(n);if(!e)return;if(e.pathname.match(/^\/maps\/embed\/v1\/view\/?$/)&&e.searchParams.has("center")&&e.searchParams.get("zoom")){const r=e.searchParams.get("zoom"),[i,o]=e.searchParams.get("center").split(",");return`https://www.google.com/maps/@${i},${o},${r}z`}}},{type:"val_town",title:"Val Town",hostnames:["val.town"],minWidth:260,minHeight:100,width:720,height:500,doesResize:!0,toEmbedUrl:n=>{const e=Vi(n),t=e&&e.pathname.match(/\/v\/(.+)\/?/);if(t)return`https://www.val.town/embed/${t[1]}`},fromEmbedUrl:n=>{const e=Vi(n),t=e&&e.pathname.match(/\/embed\/(.+)\/?/);if(t)return`https://www.val.town/v/${t[1]}`}},{type:"codesandbox",title:"CodeSandbox",hostnames:["codesandbox.io"],minWidth:300,minHeight:300,width:720,height:500,doesResize:!0,toEmbedUrl:n=>{const e=Vi(n),t=e&&e.pathname.match(/\/s\/([^/]+)\/?/);if(t)return`https://codesandbox.io/embed/${t[1]}`},fromEmbedUrl:n=>{const e=Vi(n),t=e&&e.pathname.match(/\/embed\/([^/]+)\/?/);if(t)return`https://codesandbox.io/s/${t[1]}`}},{type:"codepen",title:"Codepen",hostnames:["codepen.io"],minWidth:300,minHeight:300,width:520,height:400,doesResize:!0,toEmbedUrl:n=>{const e=/https:\/\/codepen.io\/([^/]+)\/pen\/([^/]+)/,t=n.match(e);if(t){const[r,i,o]=t;return`https://codepen.io/${i}/embed/${o}`}},fromEmbedUrl:n=>{const e=/https:\/\/codepen.io\/([^/]+)\/embed\/([^/]+)/,t=n.match(e);if(t){const[r,i,o]=t;return`https://codepen.io/${i}/pen/${o}`}}},{type:"scratch",title:"Scratch",hostnames:["scratch.mit.edu"],width:520,height:400,doesResize:!1,toEmbedUrl:n=>{const e=/https?:\/\/scratch.mit.edu\/projects\/([^/]+)/,t=n.match(e);if(t){const[r,i]=t;return`https://scratch.mit.edu/projects/embed/${i}`}},fromEmbedUrl:n=>{const e=/https:\/\/scratch.mit.edu\/projects\/embed\/([^/]+)/,t=n.match(e);if(t){const[r,i]=t;return`https://scratch.mit.edu/projects/${i}`}}},{type:"youtube",title:"YouTube",hostnames:["*.youtube.com","youtube.com","youtu.be"],width:800,height:450,doesResize:!0,overridePermissions:{"allow-presentation":!0,"allow-popups-to-escape-sandbox":!0},isAspectRatioLocked:!0,toEmbedUrl:n=>{const e=Vi(n);if(!e)return;const t=e.hostname.replace(/^www./,"");if(t==="youtu.be")return`https://www.youtube.com/embed/${e.pathname.split("/").filter(Boolean)[0]}`;if((t==="youtube.com"||t==="m.youtube.com")&&e.pathname.match(/^\/watch/))return`https://www.youtube.com/embed/${e.searchParams.get("v")}`},fromEmbedUrl:n=>{const e=Vi(n);if(!e)return;if(e.hostname.replace(/^www./,"")==="youtube.com"){const r=e.pathname.match(/^\/embed\/([^/]+)\/?/);if(r)return`https://www.youtube.com/watch?v=${r[1]}`}}},{type:"google_calendar",title:"Google Calendar",hostnames:["calendar.google.*"],width:720,height:500,minWidth:460,minHeight:360,doesResize:!0,instructionLink:"https://support.google.com/calendar/answer/41207?hl=en",overridePermissions:{"allow-popups-to-escape-sandbox":!0},toEmbedUrl:n=>{const e=Vi(n),t=e==null?void 0:e.searchParams.get("cid");if(e!=null&&e.pathname.match(/\/calendar\/u\/0/)&&t){e.pathname="/calendar/embed";const r=Array.from(e.searchParams.keys());for(const i of r)e.searchParams.delete(i);return e.searchParams.set("src",t),e.href}},fromEmbedUrl:n=>{const e=Vi(n),t=e==null?void 0:e.searchParams.get("src");if(e!=null&&e.pathname.match(/\/calendar\/embed/)&&t){e.pathname="/calendar/u/0";const r=Array.from(e.searchParams.keys());for(const i of r)e.searchParams.delete(i);return e.searchParams.set("cid",t),e.href}}},{type:"google_slides",title:"Google Slides",hostnames:["docs.google.*"],width:720,height:500,minWidth:460,minHeight:360,doesResize:!0,overridePermissions:{"allow-popups-to-escape-sandbox":!0},toEmbedUrl:n=>{const e=Vi(n);if(e!=null&&e.pathname.match(/^\/presentation/)&&(e!=null&&e.pathname.match(/\/pub\/?$/))){e.pathname=e.pathname.replace(/\/pub$/,"/embed");const t=Array.from(e.searchParams.keys());for(const r of t)e.searchParams.delete(r);return e.href}},fromEmbedUrl:n=>{const e=Vi(n);if(e!=null&&e.pathname.match(/^\/presentation/)&&(e!=null&&e.pathname.match(/\/embed\/?$/))){e.pathname=e.pathname.replace(/\/embed$/,"/pub");const t=Array.from(e.searchParams.keys());for(const r of t)e.searchParams.delete(r);return e.href}}},{type:"github_gist",title:"GitHub Gist",hostnames:["gist.github.com"],width:720,height:500,doesResize:!0,toEmbedUrl:n=>{const e=Vi(n);if(e&&e.pathname.match(/\/([^/]+)\/([^/]+)/))return n.split("/").pop()?n:void 0},fromEmbedUrl:n=>{const e=Vi(n);if(e&&e.pathname.match(/\/([^/]+)\/([^/]+)/))return n.split("/").pop()?n:void 0}},{type:"replit",title:"Replit",hostnames:["replit.com"],width:720,height:500,doesResize:!0,toEmbedUrl:n=>{const e=Vi(n);if(e&&e.pathname.match(/\/@([^/]+)\/([^/]+)/))return`${n}?embed=true`},fromEmbedUrl:n=>{const e=Vi(n);if(e&&e.pathname.match(/\/@([^/]+)\/([^/]+)/)&&e.searchParams.has("embed"))return e.searchParams.delete("embed"),e.href}},{type:"felt",title:"Felt",hostnames:["felt.com"],width:720,height:500,doesResize:!0,toEmbedUrl:n=>{const e=Vi(n);if(e&&e.pathname.match(/^\/map\//))return e.origin+"/embed"+e.pathname},fromEmbedUrl:n=>{const e=Vi(n);if(e&&e.pathname.match(/^\/embed\/map\//))return e.pathname=e.pathname.replace(/^\/embed/,""),e.href}},{type:"spotify",title:"Spotify",hostnames:["open.spotify.com"],width:720,height:500,minHeight:500,overrideOutlineRadius:12,doesResize:!0,toEmbedUrl:n=>{const e=Vi(n);if(e&&e.pathname.match(/^\/(artist|album)\//))return e.origin+"/embed"+e.pathname},fromEmbedUrl:n=>{const e=Vi(n);if(e&&e.pathname.match(/^\/embed\/(artist|album)\//))return e.origin+e.pathname.replace(/^\/embed/,"")}},{type:"vimeo",title:"Vimeo",hostnames:["vimeo.com","player.vimeo.com"],width:640,height:360,doesResize:!0,isAspectRatioLocked:!0,toEmbedUrl:n=>{const e=Vi(n);if(e&&e.hostname==="vimeo.com"&&e.pathname.match(/^\/[0-9]+/))return"https://player.vimeo.com/video/"+e.pathname.split("/")[1]+"?title=0&byline=0"},fromEmbedUrl:n=>{const e=Vi(n);if(e&&e.hostname==="player.vimeo.com"){const t=e.pathname.match(/^\/video\/([^/]+)\/?$/);if(t)return"https://vimeo.com/"+t[1]}}},{type:"excalidraw",title:"Excalidraw",hostnames:["excalidraw.com"],width:720,height:500,doesResize:!0,isAspectRatioLocked:!0,toEmbedUrl:n=>{const e=Vi(n);if(e&&e.hash.match(/#room=/))return n},fromEmbedUrl:n=>{const e=Vi(n);if(e&&e.hash.match(/#room=/))return n}},{type:"observable",title:"Observable",hostnames:["observablehq.com"],width:720,height:500,doesResize:!0,isAspectRatioLocked:!1,backgroundColor:"#fff",toEmbedUrl:n=>{const e=Vi(n);if(e&&e.pathname.match(/^\/@([^/]+)\/([^/]+)\/?$/))return`${e.origin}/embed${e.pathname}?cell=*`;if(e&&e.pathname.match(/^\/d\/([^/]+)\/?$/)){const t=e.pathname.replace(/^\/d/,"");return`${e.origin}/embed${t}?cell=*`}},fromEmbedUrl:n=>{const e=Vi(n);if(e&&e.pathname.match(/^\/embed\/@([^/]+)\/([^/]+)\/?$/))return`${e.origin}${e.pathname.replace("/embed","")}#cell-*`;if(e&&e.pathname.match(/^\/embed\/([^/]+)\/?$/))return`${e.origin}${e.pathname.replace("/embed","/d")}#cell-*`}},{type:"desmos",title:"Desmos",hostnames:["desmos.com"],width:700,height:450,doesResize:!0,toEmbedUrl:n=>{const e=Vi(n);if(e&&e.hostname==="www.desmos.com"&&e.pathname.match(/^\/calculator\/([^/]+)\/?$/)&&e.search===""&&e.hash==="")return`${n}?embed`},fromEmbedUrl:n=>{const e=Vi(n);if(e&&e.hostname==="www.desmos.com"&&e.pathname.match(/^\/calculator\/([^/]+)\/?$/)&&e.search==="?embed"&&e.hash==="")return n.replace("?embed","")}}],XOt={"allow-downloads-without-user-activation":!1,"allow-downloads":!1,"allow-modals":!1,"allow-orientation-lock":!1,"allow-pointer-lock":!1,"allow-popups":!0,"allow-popups-to-escape-sandbox":!1,"allow-presentation":!1,"allow-storage-access-by-user-activation":!1,"allow-top-navigation":!1,"allow-top-navigation-by-user-activation":!1,"allow-scripts":!0,"allow-same-origin":!0,"allow-forms":!0},C8e={w:ya,h:ya,url:$r},tA=op("embed",{GenOriginalUrlInEmbed:1,RemoveDoesResize:2,RemoveTmpOldUrl:3,RemovePermissionOverrides:4}),x8e={sequence:[{id:tA.GenOriginalUrlInEmbed,up:n=>{try{const e=n.url,t=new URL(e).host.replace("www.","");let r;for(const i of DD)if(i.hostnames.includes(t))try{r=i.fromEmbedUrl(e)}catch(o){console.warn(o)}n.tmpOldUrl=n.url,n.url=r??""}catch{n.url="",n.tmpOldUrl=n.url}},down:"retired"},{id:tA.RemoveDoesResize,up:n=>{delete n.doesResize},down:"retired"},{id:tA.RemoveTmpOldUrl,up:n=>{delete n.tmpOldUrl},down:"retired"},{id:tA.RemovePermissionOverrides,up:n=>{delete n.overridePermissions},down:"retired"}]},E8e={w:ya,h:ya,name:$r},I8e={sequence:[]},i$=el.defineEnum("tldraw:horizontalAlign",{defaultValue:"middle",values:["start","middle","end","start-legacy","end-legacy","middle-legacy"]}),o$=el.defineEnum("tldraw:verticalAlign",{defaultValue:"middle",values:["start","middle","end"]}),jf=el.defineEnum("tldraw:geo",{defaultValue:"rectangle",values:["cloud","rectangle","ellipse","triangle","diamond","pentagon","hexagon","octagon","star","rhombus","rhombus-2","oval","trapezoid","arrow-right","arrow-left","arrow-up","arrow-down","x-box","check-box","heart"]}),P8e={geo:jf,labelColor:c8e,color:qd,fill:zS,dash:US,size:bg,font:yg,align:i$,verticalAlign:o$,url:Wd,w:ya,h:ya,growY:Q8,text:$r,scale:ya},lm=op("geo",{AddUrlProp:1,AddLabelColor:2,RemoveJustify:3,AddCheckBox:4,AddVerticalAlign:5,MigrateLegacyAlign:6,AddCloud:7,MakeUrlsValid:8,AddScale:9}),k8e={sequence:[{id:lm.AddUrlProp,up:n=>{n.url=""},down:"retired"},{id:lm.AddLabelColor,up:n=>{n.labelColor="black"},down:"retired"},{id:lm.RemoveJustify,up:n=>{n.align==="justify"&&(n.align="start")},down:"retired"},{id:lm.AddCheckBox,up:n=>{},down:"retired"},{id:lm.AddVerticalAlign,up:n=>{n.verticalAlign="middle"},down:"retired"},{id:lm.MigrateLegacyAlign,up:n=>{let e;switch(n.align){case"start":e="start-legacy";break;case"end":e="end-legacy";break;default:e="middle-legacy";break}n.align=e},down:"retired"},{id:lm.AddCloud,up:n=>{},down:"retired"},{id:lm.MakeUrlsValid,up:n=>{Wd.isValid(n.url)||(n.url="")},down:n=>{}},{id:lm.AddScale,up:n=>{n.scale=1},down:n=>{delete n.scale}}]},T8e={},D8e={sequence:[]},R8e={color:qd,size:bg,segments:Nc(S8e),isComplete:Si,isPen:Si,scale:ya},YOt=op("highlight",{AddScale:1}),A8e={sequence:[{id:YOt.AddScale,up:n=>{n.scale=1},down:n=>{delete n.scale}}]},JOt=oi({topLeft:HS,bottomRight:HS}),O8e={w:ya,h:ya,playing:Si,url:Wd,assetId:kN.nullable(),crop:JOt.nullable()},xU=op("image",{AddUrlProp:1,AddCropProp:2,MakeUrlsValid:3}),M8e={sequence:[{id:xU.AddUrlProp,up:n=>{n.url=""},down:"retired"},{id:xU.AddCropProp,up:n=>{n.crop=null},down:n=>{delete n.crop}},{id:xU.MakeUrlsValid,up:n=>{Wd.isValid(n.url)||(n.url="")},down:n=>{}}]},s$=el.defineEnum("tldraw:spline",{defaultValue:"line",values:["cubic","line"]}),QOt=oi({id:$r,index:aie,x:cr,y:cr}),$8e={color:qd,dash:US,size:bg,spline:s$,points:e$($r,QOt),scale:ya},SI=op("line",{AddSnapHandles:1,RemoveExtraHandleProps:2,HandlesToPoints:3,PointIndexIds:4,AddScale:5}),L8e={sequence:[{id:SI.AddSnapHandles,up:n=>{for(const e of Object.values(n.handles))e.canSnap=!0},down:"retired"},{id:SI.RemoveExtraHandleProps,up:n=>{n.handles=A6e(Object.values(n.handles).map(e=>[e.index,{x:e.x,y:e.y}]))},down:n=>{const e=Object.entries(n.handles).map(([t,r])=>({index:t,...r})).sort(ml);n.handles=Object.fromEntries(e.map((t,r)=>{const i=r===0?"start":r===e.length-1?"end":`handle:${t.index}`;return[i,{id:i,type:"vertex",canBind:!1,canSnap:!0,index:t.index,x:t.x,y:t.y}]}))}},{id:SI.HandlesToPoints,up:n=>{const e=Object.entries(n.handles).map(([t,{x:r,y:i}])=>({x:r,y:i,index:t})).sort(ml);n.points=e.map(({x:t,y:r})=>({x:t,y:r})),delete n.handles},down:n=>{const e=j3(n.points.length);n.handles=Object.fromEntries(n.points.map((t,r)=>[e[r],{x:t.x,y:t.y}])),delete n.points}},{id:SI.PointIndexIds,up:n=>{const e=j3(n.points.length);n.points=Object.fromEntries(n.points.map((t,r)=>{const i=e[r];return[i,{id:i,index:i,x:t.x,y:t.y}]}))},down:n=>{const e=Object.values(n.points).sort(ml);n.points=e.map(({x:t,y:r})=>({x:t,y:r}))}},{id:SI.AddScale,up:n=>{n.scale=1},down:n=>{delete n.scale}}]},N8e={color:qd,size:bg,font:yg,fontSizeAdjustment:Q8,align:i$,verticalAlign:o$,growY:Q8,url:Wd,text:$r,scale:ya},Mb=op("note",{AddUrlProp:1,RemoveJustify:2,MigrateLegacyAlign:3,AddVerticalAlign:4,MakeUrlsValid:5,AddFontSizeAdjustment:6,AddScale:7}),F8e={sequence:[{id:Mb.AddUrlProp,up:n=>{n.url=""},down:"retired"},{id:Mb.RemoveJustify,up:n=>{n.align==="justify"&&(n.align="start")},down:"retired"},{id:Mb.MigrateLegacyAlign,up:n=>{switch(n.align){case"start":n.align="start-legacy";return;case"end":n.align="end-legacy";return;default:n.align="middle-legacy";return}},down:"retired"},{id:Mb.AddVerticalAlign,up:n=>{n.verticalAlign="middle"},down:"retired"},{id:Mb.MakeUrlsValid,up:n=>{Wd.isValid(n.url)||(n.url="")},down:n=>{}},{id:Mb.AddFontSizeAdjustment,up:n=>{n.fontSizeAdjustment=0},down:n=>{delete n.fontSizeAdjustment}},{id:Mb.AddScale,up:n=>{n.scale=1},down:n=>{delete n.scale}}]},tX=el.defineEnum("tldraw:textAlign",{defaultValue:"start",values:["start","middle","end"]}),j8e={color:qd,size:bg,font:yg,textAlign:tX,w:ya,text:$r,scale:ya,autoSize:Si},Yye=op("text",{RemoveJustify:1,AddTextAlign:2}),B8e={sequence:[{id:Yye.RemoveJustify,up:n=>{n.align==="justify"&&(n.align="start")},down:"retired"},{id:Yye.AddTextAlign,up:n=>{n.textAlign=n.align,delete n.align},down:n=>{n.align=n.textAlign,delete n.textAlign}}]},H8e={w:ya,h:ya,time:cr,playing:Si,url:Wd,assetId:kN.nullable()},Jye=op("video",{AddUrlProp:1,MakeUrlsValid:2}),U8e={sequence:[{id:Jye.AddUrlProp,up:n=>{n.url=""},down:"retired"},{id:Jye.MakeUrlsValid,up:n=>{Wd.isValid(n.url)||(n.url="")},down:n=>{}}]},nA=Yu("com.tldraw.store",{RemoveCodeAndIconShapeTypes:1,AddInstancePresenceType:2,RemoveTLUserAndPresenceAndAddPointer:3,RemoveUserDocument:4}),eMt=qC({sequenceId:"com.tldraw.store",retroactive:!1,sequence:[{id:nA.RemoveCodeAndIconShapeTypes,scope:"store",up:n=>{for(const[e,t]of Uu(n))t.typeName==="shape"&&(t.type==="icon"||t.type==="code")&&delete n[e]}},{id:nA.AddInstancePresenceType,scope:"store",up(n){}},{id:nA.RemoveTLUserAndPresenceAndAddPointer,scope:"store",up:n=>{for(const[e,t]of Uu(n))t.typeName.match(/^(user|user_presence)$/)&&delete n[e]}},{id:nA.RemoveUserDocument,scope:"store",up:n=>{for(const[e,t]of Uu(n))t.typeName.match("user_document")&&delete n[e]}}]}),tMt={arrow:{migrations:h8e,props:d8e},bookmark:{migrations:b8e,props:y8e},draw:{migrations:w8e,props:_8e},embed:{migrations:x8e,props:C8e},frame:{migrations:I8e,props:E8e},geo:{migrations:k8e,props:P8e},group:{migrations:D8e,props:T8e},highlight:{migrations:A8e,props:R8e},image:{migrations:M8e,props:O8e},line:{migrations:L8e,props:$8e},note:{migrations:F8e,props:N8e},text:{migrations:B8e,props:j8e},video:{migrations:U8e,props:H8e}},nMt={arrow:{migrations:p8e,props:f8e}};function rMt({shapes:n=tMt,bindings:e=nMt,migrations:t}={}){const r=new Map;for(const a of Rs(n))for(const c of o8e(a.props??{}).keys()){if(r.has(c.id)&&r.get(c.id)!==c)throw new Error(`Multiple StyleProp instances with the same id: ${c.id}`);r.set(c.id,c)}const i=dOt(n),o=cOt(e),s=xOt(r);return iie.create({asset:A1,binding:o,camera:Ff,document:uie,instance:s,instance_page_state:Oh,page:dv,instance_presence:U3,pointer:lie,shape:i},{migrations:[eMt,GOt,pOt,$Ot,EOt,POt,wOt,AOt,DOt,uOt,HOt,zOt,WOt,...Vye("shape",n),...Vye("binding",e),...t??[]],onValidationFailure:NOt,createIntegrityChecker:jOt})}const z3=[{locale:"id",label:"Bahasa Indonesia"},{locale:"ca",label:"Català"},{locale:"cs",label:"Čeština"},{locale:"da",label:"Danish"},{locale:"de",label:"Deutsch"},{locale:"en",label:"English"},{locale:"es",label:"Español"},{locale:"fr",label:"Français"},{locale:"gl",label:"Galego"},{locale:"hr",label:"Hrvatski"},{locale:"it",label:"Italiano"},{locale:"hu",label:"Magyar"},{locale:"no",label:"Norwegian"},{locale:"pl",label:"Polski"},{locale:"pt-br",label:"Português - Brasil"},{locale:"pt-pt",label:"Português - Europeu"},{locale:"ro",label:"Română"},{locale:"ru",label:"Russian"},{locale:"sl",label:"Slovenščina"},{locale:"fi",label:"Suomi"},{locale:"sv",label:"Svenska"},{locale:"vi",label:"Tiếng Việt"},{locale:"tr",label:"Türkçe"},{locale:"uk",label:"Ukrainian"},{locale:"he",label:"עברית"},{locale:"ar",label:"عربي"},{locale:"fa",label:"فارسی"},{locale:"ku",label:"کوردی"},{locale:"ne",label:"नेपाली"},{locale:"hi-in",label:"हिन्दी"},{locale:"te",label:"తెలుగు"},{locale:"th",label:"ภาษาไทย"},{locale:"my",label:"မြန်မာစာ"},{locale:"ko-kr",label:"한국어"},{locale:"ja",label:"日本語"},{locale:"zh-cn",label:"简体中文"},{locale:"zh-tw",label:"繁體中文 (台灣)"}];function iMt(){const n=typeof window<"u"?window.navigator.languages??["en"]:["en"];return oMt(n)}function oMt(n){for(const e of n){const t=sMt(e);if(t)return t}return"en"}const Qye={zh:"zh-cn",pt:"pt-br",ko:"ko-kr",hi:"hi-in"};function sMt(n){const e=z3.find(i=>i.locale===n.toLowerCase());if(e)return e.locale;const[t,r]=n.split(/[-_]/).map(i=>i.toLowerCase());if(r){const i=z3.find(o=>o.locale===t);if(i)return i.locale}return t in Qye?Qye[t]:null}const aMt={error:null};class z8e extends y.Component{constructor(){super(...arguments);$(this,"state",aMt)}static getDerivedStateFromError(t){return{error:t}}componentDidCatch(t){var r,i;(i=(r=this.props).onError)==null||i.call(r,t)}render(){const{error:t}=this.state;if(t!==null){const{fallback:r}=this.props;return x.jsx(r,{error:t})}return this.props.children}}function V3({children:n,fallback:e,...t}){return e===null?x.jsx(x.Fragment,{children:n}):x.jsx(z8e,{fallback:e,...t,children:n})}const TN=Ke.createContext(null);function ot(){const n=Ke.useContext(TN);if(!n)throw new Error("useEditor must be used inside of the <Tldraw /> or <TldrawEditor /> components");return n}function cMt(){return x.jsx("div",{className:"tl-background"})}function gE(n,e,t,r,i,o){y.useLayoutEffect(()=>{const s=n.current;if(!s||e===void 0)return;let a=`translate(${e}px, ${t}px)`;r!==void 0&&(a+=` scale(${r})`),i!==void 0&&(a+=` rotate(${i}rad)`),o&&(a+=` translate(${o.x}px, ${o.y}px)`),s.style.transform=a})}const uc={linear:n=>n,easeInQuad:n=>n*n,easeOutQuad:n=>n*(2-n),easeInOutQuad:n=>n<.5?2*n*n:-1+(4-2*n)*n,easeInCubic:n=>n*n*n,easeOutCubic:n=>--n*n*n+1,easeInOutCubic:n=>n<.5?4*n*n*n:(n-1)*(2*n-2)*(2*n-2)+1,easeInQuart:n=>n*n*n*n,easeOutQuart:n=>1- --n*n*n*n,easeInOutQuart:n=>n<.5?8*n*n*n*n:1-8*--n*n*n*n,easeInQuint:n=>n*n*n*n*n,easeOutQuint:n=>1+--n*n*n*n*n,easeInOutQuint:n=>n<.5?16*n*n*n*n*n:1+16*--n*n*n*n*n,easeInSine:n=>1-Math.cos(n*Math.PI/2),easeOutSine:n=>Math.sin(n*Math.PI/2),easeInOutSine:n=>-(Math.cos(Math.PI*n)-1)/2,easeInExpo:n=>n<=0?0:Math.pow(2,10*n-10),easeOutExpo:n=>n>=1?1:1-Math.pow(2,-10*n),easeInOutExpo:n=>n<=0?0:n>=1?1:n<.5?Math.pow(2,20*n-10)/2:(2-Math.pow(2,-20*n+10))/2};class H{constructor(e=0,t=0,r=1){this.x=e,this.y=t,this.z=r}get pressure(){return this.z}set(e=this.x,t=this.y,r=this.z){return this.x=e,this.y=t,this.z=r,this}setTo({x:e=0,y:t=0,z:r=1}){return this.x=e,this.y=t,this.z=r,this}rot(e){if(e===0)return this;const{x:t,y:r}=this,i=Math.sin(e),o=Math.cos(e);return this.x=t*o-r*i,this.y=t*i+r*o,this}rotWith(e,t){if(t===0)return this;const r=this.x-e.x,i=this.y-e.y,o=Math.sin(t),s=Math.cos(t);return this.x=e.x+(r*s-i*o),this.y=e.y+(r*o+i*s),this}clone(){const{x:e,y:t,z:r}=this;return new H(e,t,r)}sub(e){return this.x-=e.x,this.y-=e.y,this}subXY(e,t){return this.x-=e,this.y-=t,this}subScalar(e){return this.x-=e,this.y-=e,this}add(e){return this.x+=e.x,this.y+=e.y,this}addXY(e,t){return this.x+=e,this.y+=t,this}addScalar(e){return this.x+=e,this.y+=e,this}clamp(e,t){return this.x=Math.max(this.x,e),this.y=Math.max(this.y,e),t!==void 0&&(this.x=Math.min(this.x,t),this.y=Math.min(this.y,t)),this}div(e){return this.x/=e,this.y/=e,this}divV(e){return this.x/=e.x,this.y/=e.y,this}mul(e){return this.x*=e,this.y*=e,this}mulV(e){return this.x*=e.x,this.y*=e.y,this}abs(){return this.x=Math.abs(this.x),this.y=Math.abs(this.y),this}nudge(e,t){const r=H.Tan(e,this);return this.add(r.mul(t))}neg(){return this.x*=-1,this.y*=-1,this}cross(e){return this.x=this.y*e.z-this.z*e.y,this.y=this.z*e.x-this.x*e.z,this}dpr(e){return H.Dpr(this,e)}cpr(e){return H.Cpr(this,e)}len2(){return H.Len2(this)}len(){return H.Len(this)}pry(e){return H.Pry(this,e)}per(){const{x:e,y:t}=this;return this.x=t,this.y=-e,this}uni(){return H.Uni(this)}tan(e){return H.Tan(this,e)}dist(e){return H.Dist(this,e)}distanceToLineSegment(e,t){return H.DistanceToLineSegment(e,t,this)}slope(e){return H.Slope(this,e)}snapToGrid(e){return this.x=Math.round(this.x/e)*e,this.y=Math.round(this.y/e)*e,this}angle(e){return H.Angle(this,e)}toAngle(){return H.ToAngle(this)}lrp(e,t){return this.x=this.x+(e.x-this.x)*t,this.y=this.y+(e.y-this.y)*t,this}equals(e){return H.Equals(this,e)}equalsXY(e,t){return H.EqualsXY(this,e,t)}norm(){const e=this.len();return this.x=e===0?0:this.x/e,this.y=e===0?0:this.y/e,this}toFixed(){return H.ToFixed(this)}toString(){return H.ToString(H.ToFixed(this))}toJson(){return H.ToJson(this)}toArray(){return H.ToArray(this)}static Add(e,t){return new H(e.x+t.x,e.y+t.y)}static AddXY(e,t,r){return new H(e.x+t,e.y+r)}static Sub(e,t){return new H(e.x-t.x,e.y-t.y)}static SubXY(e,t,r){return new H(e.x-t,e.y-r)}static AddScalar(e,t){return new H(e.x+t,e.y+t)}static SubScalar(e,t){return new H(e.x-t,e.y-t)}static Div(e,t){return new H(e.x/t,e.y/t)}static Mul(e,t){return new H(e.x*t,e.y*t)}static DivV(e,t){return new H(e.x/t.x,e.y/t.y)}static MulV(e,t){return new H(e.x*t.x,e.y*t.y)}static Neg(e){return new H(-e.x,-e.y)}static Per(e){return new H(e.y,-e.x)}static Abs(e){return new H(Math.abs(e.x),Math.abs(e.y))}static Dist(e,t){return((e.y-t.y)**2+(e.x-t.x)**2)**.5}static DistMin(e,t,r){return(e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y)<r**2}static Dist2(e,t){return(e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y)}static Dpr(e,t){return e.x*t.x+e.y*t.y}static Cross(e,t){return new H(e.y*t.z-e.z*t.y,e.z*t.x-e.x*t.z)}static Cpr(e,t){return e.x*t.y-t.x*e.y}static Len2(e){return e.x*e.x+e.y*e.y}static Len(e){return(e.x*e.x+e.y*e.y)**.5}static Pry(e,t){return H.Dpr(e,t)/H.Len(t)}static Uni(e){return H.Div(e,H.Len(e))}static Tan(e,t){return H.Uni(H.Sub(e,t))}static Min(e,t){return new H(Math.min(e.x,t.x),Math.min(e.y,t.y))}static Max(e,t){return new H(Math.max(e.x,t.x),Math.max(e.y,t.y))}static From({x:e,y:t,z:r=1}){return new H(e,t,r)}static FromArray(e){return new H(e[0],e[1])}static Rot(e,t=0){const r=Math.sin(t),i=Math.cos(t);return new H(e.x*i-e.y*r,e.x*r+e.y*i)}static RotWith(e,t,r){const i=e.x-t.x,o=e.y-t.y,s=Math.sin(r),a=Math.cos(r);return new H(t.x+(i*a-o*s),t.y+(i*s+o*a))}static NearestPointOnLineThroughPoint(e,t,r){return H.Mul(t,H.Sub(r,e).pry(t)).add(e)}static NearestPointOnLineSegment(e,t,r,i=!0){if(H.Equals(e,r)||H.Equals(t,r))return H.From(r);const o=H.Tan(t,e),s=H.Add(e,H.Mul(o,H.Sub(r,e).pry(o)));if(i){if(s.x<Math.min(e.x,t.x))return H.Cast(e.x<t.x?e:t);if(s.x>Math.max(e.x,t.x))return H.Cast(e.x>t.x?e:t);if(s.y<Math.min(e.y,t.y))return H.Cast(e.y<t.y?e:t);if(s.y>Math.max(e.y,t.y))return H.Cast(e.y>t.y?e:t)}return s}static DistanceToLineThroughPoint(e,t,r){return H.Dist(r,H.NearestPointOnLineThroughPoint(e,t,r))}static DistanceToLineSegment(e,t,r,i=!0){return H.Dist(r,H.NearestPointOnLineSegment(e,t,r,i))}static Snap(e,t=1){return new H(Math.round(e.x/t)*t,Math.round(e.y/t)*t)}static Cast(e){return e instanceof H?e:H.From(e)}static Slope(e,t){return e.x===t.y?NaN:(e.y-t.y)/(e.x-t.x)}static IsNaN(e){return isNaN(e.x)||isNaN(e.y)}static Angle(e,t){return Math.atan2(t.y-e.y,t.x-e.x)}static Lrp(e,t,r){return H.Sub(t,e).mul(r).add(e)}static Med(e,t){return new H((e.x+t.x)/2,(e.y+t.y)/2)}static Equals(e,t){return Math.abs(e.x-t.x)<1e-4&&Math.abs(e.y-t.y)<1e-4}static EqualsXY(e,t,r){return e.x===t&&e.y===r}static Clockwise(e,t,r){return(r.x-e.x)*(t.y-e.y)-(t.x-e.x)*(r.y-e.y)<0}static Rescale(e,t){const r=H.Len(e);return new H(t*e.x/r,t*e.y/r)}static ScaleWithOrigin(e,t,r){return H.Sub(e,r).mul(t).add(r)}static ToFixed(e){return new H(Mm(e.x),Mm(e.y))}static ToInt(e){return new H(parseInt(e.x.toFixed(0)),parseInt(e.y.toFixed(0)),parseInt((e.z??0).toFixed(0)))}static ToCss(e){return`${e.x},${e.y}`}static Nudge(e,t,r){return H.Add(e,H.Tan(t,e).mul(r))}static ToString(e){return`${e.x}, ${e.y}`}static ToAngle(e){let t=Math.atan2(e.y,e.x);return t<0&&(t+=Math.PI*2),t}static FromAngle(e,t=1){return new H(Math.cos(e)*t,Math.sin(e)*t)}static ToArray(e){return[e.x,e.y,e.z]}static ToJson(e){const{x:t,y:r,z:i}=e;return{x:t,y:r,z:i}}static Average(e){const t=e.length,r=new H(0,0);if(t===0)return r;for(let i=0;i<t;i++)r.add(e[i]);return r.div(t)}static Clamp(e,t,r){return r===void 0?new H(Math.min(Math.max(e.x,t)),Math.min(Math.max(e.y,t))):new H(Math.min(Math.max(e.x,t),r),Math.min(Math.max(e.y,t),r))}static PointsBetween(e,t,r=6){const i=[];for(let o=0;o<r;o++){const s=uc.easeInQuad(o/(r-1)),a=H.Lrp(e,t,s);a.z=Math.min(1,.5+Math.abs(.5-lMt(s))*.65),i.push(a)}return i}static SnapToGrid(e,t=8){return new H(Math.round(e.x/t)*t,Math.round(e.y/t)*t)}}const lMt=n=>n<.5?2*n*n:-1+(4-2*n)*n;function Di(n){return`${et(n.x)},${et(n.y)} `}function Du(n,e){return`${et((n.x+e.x)/2)},${et((n.y+e.y)/2)} `}const Ai=Math.PI,Fo=Ai/2,Xi=Ai*2,uMt=Math.sin;function Ja(n,e,t){return Math.max(e,typeof t<"u"?Math.min(n,t):n)}function rA(n,e=1e10){return n?Math.round(n*e)/e:0}function sy(n,e,t=1e-6){return Math.abs(n-e)<=t}function V8e(n,e){const t=Math.pow(n-e,2)/Math.pow(n+e,2);return Ai*(n+e)*(1+3*t/(10+Math.sqrt(4-3*t)))}function ay(n){return n=n%Xi,n<0?n=n+Xi:n===0&&(n=0),n}function RD(n,e){return n=ay(n),e=ay(e),n>e&&(e+=Xi),e-n}function W8e(n,e){return Xi-RD(n,e)}function yO(n,e){const t=(e-n)%Xi;return 2*t%Xi-t}function nX(n){return(Xi+n)%Xi}function a$(n,e){const t=Xi/e;let r=Math.floor((nX(n)+t/2)/t)*t%Xi;return r<Ai&&(r+=Xi),r>Ai&&(r-=Xi),r}function q8e(n,e){return n===e||sy(n%(Math.PI/2)-e%(Math.PI/2),0)}function dMt(n){return n*Ai/180}function hMt(n){return n*180/Ai}function VS(n,e,t){return new H(n.x,n.y).add(H.FromAngle(t,e))}function EU(n,e,t){const r=n/2,i=e/2,o=[];let s=1/0,a=-1/0,c=1/0,l=-1/0;for(let p=0;p<t;p++){const g=Xi/t,m=-Fo+p*g,v=r+r*Math.cos(m),b=i+i*Math.sin(m);v<s&&(s=v),b<c&&(c=b),v>a&&(a=v),b>l&&(l=b),o.push(new H(v,b))}const u=a-s,d=l-c,h=n-u,f=e-d;if(h!==0||f!==0)for(let p=0;p<o.length;p++){const g=o[p];g.x=(g.x-s)/u*n,g.y=(g.y-c)/d*e}return o}function _I(n,e,t,r){return n<r&&t<e}function Cf(n,e,t,r){const i=Math.max(n,t),o=Math.min(e,r);return i<=o?[i,o]:null}function ebe(n,e,t){return(e.x-n.x)*(t.y-n.y)-(t.x-n.x)*(e.y-n.y)}function Fd(n,e){let t=0,r,i;for(let o=0;o<e.length;o++){if(r=e[o],r.x===n.x&&r.y===n.y||(i=e[(o+1)%e.length],H.Dist(n,r)+H.Dist(n,i)===H.Dist(r,i)))return!0;r.y<=n.y?i.y>n.y&&ebe(r,i,n)>0&&(t+=1):i.y<=n.y&&ebe(r,i,n)<0&&(t-=1)}return t!==0}function et(n){return Math.round(n*1e4)/1e4}function Mm(n){return Math.round(n*100)/100}const tbe=n=>Math.abs(n)<Number.MAX_SAFE_INTEGER;function _0(n,e,t){return t<0?RD(n,e):W8e(n,e)}function rX(n,e,t,r){let i;if(Math.abs(n)>Ai){i=yO(e,r);const o=yO(r,t);return Math.abs(i)<Math.abs(o)?i/n:(n-o)/n}else{i=yO(e,r);const o=i/n;return Math.sign(i)!==Math.sign(n)?Math.abs(o)>.5?1:0:o}}function fMt(n,e,t,r){const i=2*((e-n)%Xi)%Xi-(e-n)%Xi;return r?(Xi-Math.abs(i))*(t?1:-1):i}function die(n,e,t){const r=-2*(n.x*(e.y-t.y)-n.y*(e.x-t.x)+e.x*t.y-t.x*e.y);return new H(((n.x*n.x+n.y*n.y)*(t.y-e.y)+(e.x*e.x+e.y*e.y)*(n.y-t.y)+(t.x*t.x+t.y*t.y)*(e.y-n.y))/r,((n.x*n.x+n.y*n.y)*(e.x-t.x)+(e.x*e.x+e.y*e.y)*(t.x-n.x)+(t.x*t.x+t.y*t.y)*(n.x-e.x))/r)}function pMt(n,e,t,r,i){if(t===null)return[H.From(n),H.From(e)];const o=[],s=H.Angle(t,n),a=H.Angle(t,e),c=RD(s,a);for(let l=0;l<i;l++){const u=l/(i-1),d=s+c*u,h=VS(t,r,d);o.push(h)}return o}const IU=({brush:n,color:e,opacity:t,className:r})=>{const i=y.useRef(null);gE(i,n.x,n.y);const o=et(Math.max(1,n.w)),s=et(Math.max(1,n.h));return x.jsx("svg",{className:"tl-overlays__item",ref:i,children:e?x.jsxs("g",{className:"tl-brush",opacity:t,children:[x.jsx("rect",{width:o,height:s,fill:e,opacity:.75}),x.jsx("rect",{width:o,height:s,fill:"none",stroke:e,opacity:.1})]}):x.jsx("rect",{className:`tl-brush tl-brush__default ${r}`,width:o,height:s})})},nbe={isLocked:!1,wheelBehavior:"pan",panSpeed:1,zoomSpeed:1,zoomSteps:[.1,.25,.5,1,2,4,8]},rbe={onResolveAsset:async n=>(n==null?void 0:n.props.src)||""},PU={duration:0,easing:uc.easeInOutCubic},ibe={CAMERA_MOVE:-10},gMt=["top","right","bottom","left"],obe=0,hie=2,iA=1,sbe=5,mMt=128;var kU={};const vMt={},K8e=wu("pointerCaptureTrackingObject",{defaults:{all:new Map},shouldStoreForSession:!1}),ta={logPreventDefaults:wu("logPreventDefaults",{defaults:{all:!1}}),logPointerCaptures:wu("logPointerCaptures",{defaults:{all:!1}}),logElementRemoves:wu("logElementRemoves",{defaults:{all:!1}}),debugSvg:wu("debugSvg",{defaults:{all:!1}}),showFps:wu("showFps",{defaults:{all:!1}}),measurePerformance:wu("measurePerformance",{defaults:{all:!1}}),throwToBlob:wu("throwToBlob",{defaults:{all:!1}}),reconnectOnPing:wu("reconnectOnPing",{defaults:{all:!1}}),debugCursors:wu("debugCursors",{defaults:{all:!1}}),forceSrgb:wu("forceSrgbColors",{defaults:{all:!1}}),debugGeometry:wu("debugGeometry",{defaults:{all:!1}}),hideShapes:wu("hideShapes",{defaults:{all:!1}}),editOnType:wu("editOnType",{defaults:{all:!1}})};if(typeof Element<"u"){const n=Element.prototype.removeChild;Zy("element removal logging",()=>{ta.logElementRemoves.get()?Element.prototype.removeChild=function(e){return console.warn("[tldraw] removing child:",e),n.call(this,e)}:Element.prototype.removeChild=n})}function wu(n,{defaults:e,shouldStoreForSession:t=!0}){return yMt({name:n,defaults:e,shouldStoreForSession:t})}function yMt(n){const e=SMt(n),t=n.shouldStoreForSession?bMt(n.name):null,r=lc(`debug:${n.name}`,t??e);return typeof window<"u"&&(n.shouldStoreForSession&&Zy(`debug:${n.name}`,()=>{const i=r.get();i===e?j6e(`tldraw_debug:${n.name}`):Jre(`tldraw_debug:${n.name}`,JSON.stringify(i))}),Object.defineProperty(window,`tldraw${n.name.replace(/^[a-z]/,i=>i.toUpperCase())}`,{get(){return r.get()},set(i){r.set(i)},configurable:!0})),Object.assign(r,n)}function bMt(n){try{return JSON.parse(F6e(`tldraw_debug:${n}`)??"null")}catch{return null}}function TU(n){try{return n()}catch{return null}}function SMt(n){switch(TU(()=>kU.TLDRAW_ENV)??TU(()=>kU.VERCEL_PUBLIC_TLDRAW_ENV)??TU(()=>kU.NEXT_PUBLIC_TLDRAW_ENV)??"production"){case"production":return n.defaults.production??n.defaults.all;case"preview":case"staging":return n.defaults.staging??n.defaults.all;default:return n.defaults.development??n.defaults.all}}function c$(n){if(n instanceof HTMLElement)return n;if(n.parentElement)return c$(n.parentElement);throw Error("Could not find a parent element of an HTML type!")}function Ri(n){n.preventDefault(),ta.logPreventDefaults.get()&&console.warn("preventDefault called on event:",n)}function AD(n,e){if(n.setPointerCapture(e.pointerId),ta.logPointerCaptures.get()){const t=K8e.get();t.set(n,(t.get(n)??0)+1),console.warn("setPointerCapture called on element:",n,e)}}function OD(n,e){if(n.hasPointerCapture(e.pointerId)&&(n.releasePointerCapture(e.pointerId),ta.logPointerCaptures.get())){const t=K8e.get();t.get(n)===1?t.delete(n):t.has(n)?t.set(n,t.get(n)-1):console.warn("Release without capture"),console.warn("releasePointerCapture called on element:",n,e)}}const Wc=n=>n.stopPropagation(),rl=(n,e,t)=>{n&&n.style.setProperty(e,t)};function Bu(n){return n.isKilled=!0,{point:{x:n.clientX,y:n.clientY,z:n.pressure},shiftKey:n.shiftKey,altKey:n.altKey,ctrlKey:n.metaKey||n.ctrlKey,pointerId:n.pointerId,button:n.button,isPen:n.pointerType==="pen"}}function _Mt(){const n=ot();return y.useMemo(function(){let r,i;function o(g){if(!g.isKilled){if(g.button===hie){n.dispatch({type:"pointer",target:"canvas",name:"right_click",...Bu(g)});return}g.button!==0&&g.button!==1&&g.button!==5||(AD(g.currentTarget,g),n.dispatch({type:"pointer",target:"canvas",name:"pointer_down",...Bu(g)}))}}function s(g){g.isKilled||g.clientX===r&&g.clientY===i||(r=g.clientX,i=g.clientY,n.dispatch({type:"pointer",target:"canvas",name:"pointer_move",...Bu(g)}))}function a(g){g.isKilled||g.button!==0&&g.button!==1&&g.button!==2&&g.button!==5||(r=g.clientX,i=g.clientY,OD(g.currentTarget,g),n.dispatch({type:"pointer",target:"canvas",name:"pointer_up",...Bu(g)}))}function c(g){if(g.isKilled||n.getInstanceState().isPenMode&&g.pointerType!=="pen")return;const m=g.pointerType==="mouse"||g.pointerType==="pen";n.updateInstanceState({isHoveringCanvas:m?!0:null})}function l(g){if(g.isKilled||n.getInstanceState().isPenMode&&g.pointerType!=="pen")return;const m=g.pointerType==="mouse"||g.pointerType==="pen";n.updateInstanceState({isHoveringCanvas:m?!1:null})}function u(g){g.isKilled=!0,Ri(g)}function d(g){g.isKilled=!0,g.target instanceof HTMLElement&&g.target.tagName!=="A"&&g.target.tagName!=="TEXTAREA"&&!(n.getEditingShape()&&g.target.className.includes("tl-text-content"))&&Ri(g)}function h(g){Ri(g)}async function f(g){var v,b;if(Ri(g),!((b=(v=g.dataTransfer)==null?void 0:v.files)!=null&&b.length))return;const m=Array.from(g.dataTransfer.files);await n.putExternalContent({type:"files",files:m,point:n.screenToPage({x:g.clientX,y:g.clientY}),ignoreParent:!1})}function p(g){Wc(g)}return{onPointerDown:o,onPointerMove:s,onPointerUp:a,onPointerEnter:c,onPointerLeave:l,onDragOver:h,onDrop:f,onTouchStart:u,onTouchEnd:d,onClick:p}},[n])}function wMt(){const n=ot();y.useEffect(()=>{let e=n.getInstanceState().isCoarsePointer;const t=s=>{const a=s.pointerType!=="mouse";e!==a&&(e=a,n.updateInstanceState({isCoarsePointer:a}))};window.addEventListener("pointerdown",t,{capture:!0});const r=window.matchMedia&&window.matchMedia("(any-pointer: coarse)"),i=n.environment.isFirefox&&!n.environment.isAndroid&&!n.environment.isIos,o=()=>{const s=i?!1:r.matches;e===s&&(e=s,n.updateInstanceState({isCoarsePointer:s}))};return r&&(r.addEventListener("change",o),o()),()=>{window.removeEventListener("pointerdown",t,{capture:!0}),r&&r.removeEventListener("change",o)}},[n])}const G8e=y.createContext(null);function CMt({container:n,children:e}){return x.jsx(G8e.Provider,{value:n,children:e})}function Il(){return xh(y.useContext(G8e),"useContainer used outside of <Tldraw />")}function xMt(){const n=ot(),e=Il(),t=_t("isFocused",()=>n.getInstanceState().isFocused,[n]);y.useEffect(()=>{if(typeof matchMedia===void 0)return;let r=null;const i=()=>{r!=null&&r();const o=`(resolution: ${window.devicePixelRatio}dppx)`,s=matchMedia(o),a=c=>{c.type==="change"&&i()};s.addEventListener?s.addEventListener("change",i):s.addListener&&s.addListener(a),r=()=>{s.removeEventListener?s.removeEventListener("change",i):s.removeListener&&s.removeListener(a)},n.updateInstanceState({devicePixelRatio:window.devicePixelRatio})};return i(),()=>{r==null||r()}},[n]),y.useEffect(()=>{if(!t)return;const r=a=>{if(a.altKey&&(n.isIn("zoom")||!n.getPath().endsWith(".idle"))&&!oA()&&Ri(a),a.isKilled)return;switch(a.isKilled=!0,a.key){case"=":case"-":case"0":{if(a.metaKey||a.ctrlKey){Ri(a);return}break}case"Tab":{if(oA()||n.getIsMenuOpen())return;break}case",":return;case"Escape":{if((n.getEditingShape()||n.getSelectedShapeIds().length>0)&&a.preventDefault(),n.getOpenMenus().length>0)return;n.inputs.keys.has("Escape")||(n.inputs.keys.add("Escape"),n.cancel(),n.focus());return}default:if(oA()||n.getIsMenuOpen())return}const c={type:"keyboard",name:a.repeat?"key_repeat":"key_down",key:a.key,code:a.code,shiftKey:a.shiftKey,altKey:a.altKey,ctrlKey:a.metaKey||a.ctrlKey};n.dispatch(c)},i=a=>{if(a.isKilled||(a.isKilled=!0,oA()||n.getIsMenuOpen())||a.key===",")return;const c={type:"keyboard",name:"key_up",key:a.key,code:a.code,shiftKey:a.shiftKey,altKey:a.altKey,ctrlKey:a.metaKey||a.ctrlKey};n.dispatch(c)};function o(a){var c,l;if(e.contains(a.target)){const u=a.touches[0].pageX,d=a.touches[0].radiusX||0;(u-d<10||u+d>n.getViewportScreenBounds().width-10)&&(((c=a.target)==null?void 0:c.tagName)==="BUTTON"&&((l=a.target)==null||l.click()),Ri(a))}}const s=a=>{e.contains(a.target)&&(a.ctrlKey||a.metaKey)&&Ri(a)};return e.addEventListener("touchstart",o,{passive:!1}),e.addEventListener("wheel",s,{passive:!1}),document.addEventListener("gesturestart",Ri),document.addEventListener("gesturechange",Ri),document.addEventListener("gestureend",Ri),e.addEventListener("keydown",r),e.addEventListener("keyup",i),()=>{e.removeEventListener("touchstart",o),e.removeEventListener("wheel",s),document.removeEventListener("gesturestart",Ri),document.removeEventListener("gesturechange",Ri),document.removeEventListener("gestureend",Ri),e.removeEventListener("keydown",r),e.removeEventListener("keyup",i)}},[n,e,t])}const EMt=["input","select","button","textarea"];function oA(){const{activeElement:n}=document;return!!(n&&(n.getAttribute("contenteditable")||EMt.indexOf(n.tagName.toLowerCase())>-1))}const IMt=["textarea","input"];function PMt(n){const e=ot();y.useEffect(()=>{const t=n.current;if(!t)return;const r=i=>{var o;if(i instanceof PointerEvent&&i.pointerType==="pen"){i.isKilled=!0;const{target:s}=i;if(IMt.includes((o=s.tagName)==null?void 0:o.toLocaleLowerCase())||e.isIn("select.editing_shape"))return;Ri(i)}};return t.addEventListener("touchstart",r),t.addEventListener("touchend",r),()=>{t.removeEventListener("touchstart",r),t.removeEventListener("touchend",r)}},[e,n])}function kMt(n,e,t){return Math.max(e,Math.min(n,t))}const Hc={toVector(n,e){return n===void 0&&(n=e),Array.isArray(n)?n:[n,n]},add(n,e){return[n[0]+e[0],n[1]+e[1]]},sub(n,e){return[n[0]-e[0],n[1]-e[1]]},addTo(n,e){n[0]+=e[0],n[1]+=e[1]},subTo(n,e){n[0]-=e[0],n[1]-=e[1]}};function abe(n,e,t){return e===0||Math.abs(e)===1/0?Math.pow(n,t*5):n*e*t/(e+t*n)}function cbe(n,e,t,r=.15){return r===0?kMt(n,e,t):n<e?-abe(e-n,t-e,r)+e:n>t?+abe(n-t,t-e,r)+t:n}function TMt(n,[e,t],[r,i]){const[[o,s],[a,c]]=n;return[cbe(e,o,s,r),cbe(t,a,c,i)]}function DMt(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function RMt(n){var e=DMt(n,"string");return typeof e=="symbol"?e:String(e)}function cl(n,e,t){return e=RMt(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function lbe(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function Cs(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?lbe(Object(t),!0).forEach(function(r){cl(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):lbe(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}const Z8e={pointer:{start:"down",change:"move",end:"up"},mouse:{start:"down",change:"move",end:"up"},touch:{start:"start",change:"move",end:"end"},gesture:{start:"start",change:"change",end:"end"}};function ube(n){return n?n[0].toUpperCase()+n.slice(1):""}const AMt=["enter","leave"];function OMt(n=!1,e){return n&&!AMt.includes(e)}function MMt(n,e="",t=!1){const r=Z8e[n],i=r&&r[e]||e;return"on"+ube(n)+ube(i)+(OMt(t,i)?"Capture":"")}const $Mt=["gotpointercapture","lostpointercapture"];function LMt(n){let e=n.substring(2).toLowerCase();const t=!!~e.indexOf("passive");t&&(e=e.replace("passive",""));const r=$Mt.includes(e)?"capturecapture":"capture",i=!!~e.indexOf(r);return i&&(e=e.replace("capture","")),{device:e,capture:i,passive:t}}function NMt(n,e=""){const t=Z8e[n],r=t&&t[e]||e;return n+r}function X8e(n){return"touches"in n}function FMt(n){return X8e(n)?"touch":"pointerType"in n?n.pointerType:"mouse"}function jMt(n){return Array.from(n.touches).filter(e=>{var t,r;return e.target===n.currentTarget||((t=n.currentTarget)===null||t===void 0||(r=t.contains)===null||r===void 0?void 0:r.call(t,e.target))})}function iX(n,e){try{const t=e.clientX-n.clientX,r=e.clientY-n.clientY,i=(e.clientX+n.clientX)/2,o=(e.clientY+n.clientY)/2,s=Math.hypot(t,r);return{angle:-(Math.atan2(t,r)*180)/Math.PI,distance:s,origin:[i,o]}}catch{}return null}function BMt(n){return jMt(n).map(e=>e.identifier)}function dbe(n,e){const[t,r]=Array.from(n.touches).filter(i=>e.includes(i.identifier));return iX(t,r)}const hbe=40,fbe=800;function Y8e(n){let{deltaX:e,deltaY:t,deltaMode:r}=n;return r===1?(e*=hbe,t*=hbe):r===2&&(e*=fbe,t*=fbe),[e,t]}function HMt(n){const e={};if("buttons"in n&&(e.buttons=n.buttons),"shiftKey"in n){const{shiftKey:t,altKey:r,metaKey:i,ctrlKey:o}=n;Object.assign(e,{shiftKey:t,altKey:r,metaKey:i,ctrlKey:o})}return e}function l$(n,...e){return typeof n=="function"?n(...e):n}function UMt(){}function zMt(...n){return n.length===0?UMt:n.length===1?n[0]:function(){let e;for(const t of n)e=t.apply(this,arguments)||e;return e}}function pbe(n,e){return Object.assign({},e,n||{})}const VMt=32;class J8e{constructor(e,t,r){this.ctrl=e,this.args=t,this.key=r,this.state||(this.state={},this.computeValues([0,0]),this.computeInitial(),this.init&&this.init(),this.reset())}get state(){return this.ctrl.state[this.key]}set state(e){this.ctrl.state[this.key]=e}get shared(){return this.ctrl.state.shared}get eventStore(){return this.ctrl.gestureEventStores[this.key]}get timeoutStore(){return this.ctrl.gestureTimeoutStores[this.key]}get config(){return this.ctrl.config[this.key]}get sharedConfig(){return this.ctrl.config.shared}get handler(){return this.ctrl.handlers[this.key]}reset(){const{state:e,shared:t,ingKey:r,args:i}=this;t[r]=e._active=e.active=e._blocked=e._force=!1,e._step=[!1,!1],e.intentional=!1,e._movement=[0,0],e._distance=[0,0],e._direction=[0,0],e._delta=[0,0],e._bounds=[[-1/0,1/0],[-1/0,1/0]],e.args=i,e.axis=void 0,e.memo=void 0,e.elapsedTime=e.timeDelta=0,e.direction=[0,0],e.distance=[0,0],e.overflow=[0,0],e._movementBound=[!1,!1],e.velocity=[0,0],e.movement=[0,0],e.delta=[0,0],e.timeStamp=0}start(e){const t=this.state,r=this.config;t._active||(this.reset(),this.computeInitial(),t._active=!0,t.target=e.target,t.currentTarget=e.currentTarget,t.lastOffset=r.from?l$(r.from,t):t.offset,t.offset=t.lastOffset,t.startTime=t.timeStamp=e.timeStamp)}computeValues(e){const t=this.state;t._values=e,t.values=this.config.transform(e)}computeInitial(){const e=this.state;e._initial=e._values,e.initial=e.values}compute(e){const{state:t,config:r,shared:i}=this;t.args=this.args;let o=0;if(e&&(t.event=e,r.preventDefault&&e.cancelable&&t.event.preventDefault(),t.type=e.type,i.touches=this.ctrl.pointerIds.size||this.ctrl.touchIds.size,i.locked=!!document.pointerLockElement,Object.assign(i,HMt(e)),i.down=i.pressed=i.buttons%2===1||i.touches>0,o=e.timeStamp-t.timeStamp,t.timeStamp=e.timeStamp,t.elapsedTime=t.timeStamp-t.startTime),t._active){const C=t._delta.map(Math.abs);Hc.addTo(t._distance,C)}this.axisIntent&&this.axisIntent(e);const[s,a]=t._movement,[c,l]=r.threshold,{_step:u,values:d}=t;if(r.hasCustomTransform?(u[0]===!1&&(u[0]=Math.abs(s)>=c&&d[0]),u[1]===!1&&(u[1]=Math.abs(a)>=l&&d[1])):(u[0]===!1&&(u[0]=Math.abs(s)>=c&&Math.sign(s)*c),u[1]===!1&&(u[1]=Math.abs(a)>=l&&Math.sign(a)*l)),t.intentional=u[0]!==!1||u[1]!==!1,!t.intentional)return;const h=[0,0];if(r.hasCustomTransform){const[C,I]=d;h[0]=u[0]!==!1?C-u[0]:0,h[1]=u[1]!==!1?I-u[1]:0}else h[0]=u[0]!==!1?s-u[0]:0,h[1]=u[1]!==!1?a-u[1]:0;this.restrictToAxis&&!t._blocked&&this.restrictToAxis(h);const f=t.offset,p=t._active&&!t._blocked||t.active;p&&(t.first=t._active&&!t.active,t.last=!t._active&&t.active,t.active=i[this.ingKey]=t._active,e&&(t.first&&("bounds"in r&&(t._bounds=l$(r.bounds,t)),this.setup&&this.setup()),t.movement=h,this.computeOffset()));const[g,m]=t.offset,[[v,b],[S,E]]=t._bounds;t.overflow=[g<v?-1:g>b?1:0,m<S?-1:m>E?1:0],t._movementBound[0]=t.overflow[0]?t._movementBound[0]===!1?t._movement[0]:t._movementBound[0]:!1,t._movementBound[1]=t.overflow[1]?t._movementBound[1]===!1?t._movement[1]:t._movementBound[1]:!1;const w=t._active?r.rubberband||[0,0]:[0,0];if(t.offset=TMt(t._bounds,t.offset,w),t.delta=Hc.sub(t.offset,f),this.computeMovement(),p&&(!t.last||o>VMt)){t.delta=Hc.sub(t.offset,f);const C=t.delta.map(Math.abs);Hc.addTo(t.distance,C),t.direction=t.delta.map(Math.sign),t._direction=t._delta.map(Math.sign),!t.first&&o>0&&(t.velocity=[C[0]/o,C[1]/o],t.timeDelta=o)}}emit(){const e=this.state,t=this.shared,r=this.config;if(e._active||this.clean(),(e._blocked||!e.intentional)&&!e._force&&!r.triggerAllEvents)return;const i=this.handler(Cs(Cs(Cs({},t),e),{},{[this.aliasKey]:e.values}));i!==void 0&&(e.memo=i)}clean(){this.eventStore.clean(),this.timeoutStore.clean()}}function WMt([n,e],t){const r=Math.abs(n),i=Math.abs(e);if(r>i&&r>t)return"x";if(i>r&&i>t)return"y"}class qMt extends J8e{constructor(...e){super(...e),cl(this,"aliasKey","xy")}reset(){super.reset(),this.state.axis=void 0}init(){this.state.offset=[0,0],this.state.lastOffset=[0,0]}computeOffset(){this.state.offset=Hc.add(this.state.lastOffset,this.state.movement)}computeMovement(){this.state.movement=Hc.sub(this.state.offset,this.state.lastOffset)}axisIntent(e){const t=this.state,r=this.config;if(!t.axis&&e){const i=typeof r.axisThreshold=="object"?r.axisThreshold[FMt(e)]:r.axisThreshold;t.axis=WMt(t._movement,i)}t._blocked=(r.lockDirection||!!r.axis)&&!t.axis||!!r.axis&&r.axis!==t.axis}restrictToAxis(e){if(this.config.axis||this.config.lockDirection)switch(this.state.axis){case"x":e[1]=0;break;case"y":e[0]=0;break}}}const KMt=n=>n,gbe=.15,Q8e={enabled(n=!0){return n},eventOptions(n,e,t){return Cs(Cs({},t.shared.eventOptions),n)},preventDefault(n=!1){return n},triggerAllEvents(n=!1){return n},rubberband(n=0){switch(n){case!0:return[gbe,gbe];case!1:return[0,0];default:return Hc.toVector(n)}},from(n){if(typeof n=="function")return n;if(n!=null)return Hc.toVector(n)},transform(n,e,t){const r=n||t.shared.transform;return this.hasCustomTransform=!!r,r||KMt},threshold(n){return Hc.toVector(n,0)}},GMt=0,MD=Cs(Cs({},Q8e),{},{axis(n,e,{axis:t}){if(this.lockDirection=t==="lock",!this.lockDirection)return t},axisThreshold(n=GMt){return n},bounds(n={}){if(typeof n=="function")return o=>MD.bounds(n(o));if("current"in n)return()=>n.current;if(typeof HTMLElement=="function"&&n instanceof HTMLElement)return n;const{left:e=-1/0,right:t=1/0,top:r=-1/0,bottom:i=1/0}=n;return[[e,t],[r,i]]}}),$D=typeof window<"u"&&window.document&&window.document.createElement;function e$e(){return $D&&"ontouchstart"in window}function ZMt(){return e$e()||$D&&window.navigator.maxTouchPoints>1}function XMt(){return $D&&"onpointerdown"in window}function YMt(){return $D&&"exitPointerLock"in window.document}function JMt(){try{return"constructor"in GestureEvent}catch{return!1}}const Eh={isBrowser:$D,gesture:JMt(),touch:e$e(),touchscreen:ZMt(),pointer:XMt(),pointerLock:YMt()},QMt=250,e6t=180,t6t=.5,n6t=50,r6t=250,i6t=10,mbe={mouse:0,touch:0,pen:8};Cs(Cs({},MD),{},{device(n,e,{pointer:{touch:t=!1,lock:r=!1,mouse:i=!1}={}}){return this.pointerLock=r&&Eh.pointerLock,Eh.touch&&t?"touch":this.pointerLock?"mouse":Eh.pointer&&!i?"pointer":Eh.touch?"touch":"mouse"},preventScrollAxis(n,e,{preventScroll:t}){if(this.preventScrollDelay=typeof t=="number"?t:t||t===void 0&&n?QMt:void 0,!(!Eh.touchscreen||t===!1))return n||(t!==void 0?"y":void 0)},pointerCapture(n,e,{pointer:{capture:t=!0,buttons:r=1,keys:i=!0}={}}){return this.pointerButtons=r,this.keys=i,!this.pointerLock&&this.device==="pointer"&&t},threshold(n,e,{filterTaps:t=!1,tapsThreshold:r=3,axis:i=void 0}){const o=Hc.toVector(n,t?r:i?1:0);return this.filterTaps=t,this.tapsThreshold=r,o},swipe({velocity:n=t6t,distance:e=n6t,duration:t=r6t}={}){return{velocity:this.transform(Hc.toVector(n)),distance:this.transform(Hc.toVector(e)),duration:t}},delay(n=0){switch(n){case!0:return e6t;case!1:return 0;default:return n}},axisThreshold(n){return n?Cs(Cs({},mbe),n):mbe},keyboardDisplacement(n=i6t){return n}});function t$e(n){const[e,t]=n.overflow,[r,i]=n._delta,[o,s]=n._direction;(e<0&&r>0&&o<0||e>0&&r<0&&o>0)&&(n._movement[0]=n._movementBound[0]),(t<0&&i>0&&s<0||t>0&&i<0&&s>0)&&(n._movement[1]=n._movementBound[1])}const o6t=30,s6t=100;class a6t extends J8e{constructor(...e){super(...e),cl(this,"ingKey","pinching"),cl(this,"aliasKey","da")}init(){this.state.offset=[1,0],this.state.lastOffset=[1,0],this.state._pointerEvents=new Map}reset(){super.reset();const e=this.state;e._touchIds=[],e.canceled=!1,e.cancel=this.cancel.bind(this),e.turns=0}computeOffset(){const{type:e,movement:t,lastOffset:r}=this.state;e==="wheel"?this.state.offset=Hc.add(t,r):this.state.offset=[(1+t[0])*r[0],t[1]+r[1]]}computeMovement(){const{offset:e,lastOffset:t}=this.state;this.state.movement=[e[0]/t[0],e[1]-t[1]]}axisIntent(){const e=this.state,[t,r]=e._movement;if(!e.axis){const i=Math.abs(t)*o6t-Math.abs(r);i<0?e.axis="angle":i>0&&(e.axis="scale")}}restrictToAxis(e){this.config.lockDirection&&(this.state.axis==="scale"?e[1]=0:this.state.axis==="angle"&&(e[0]=0))}cancel(){const e=this.state;e.canceled||setTimeout(()=>{e.canceled=!0,e._active=!1,this.compute(),this.emit()},0)}touchStart(e){this.ctrl.setEventIds(e);const t=this.state,r=this.ctrl.touchIds;if(t._active&&t._touchIds.every(o=>r.has(o))||r.size<2)return;this.start(e),t._touchIds=Array.from(r).slice(0,2);const i=dbe(e,t._touchIds);i&&this.pinchStart(e,i)}pointerStart(e){if(e.buttons!=null&&e.buttons%2!==1)return;this.ctrl.setEventIds(e),e.target.setPointerCapture(e.pointerId);const t=this.state,r=t._pointerEvents,i=this.ctrl.pointerIds;if(t._active&&Array.from(r.keys()).every(s=>i.has(s))||(r.size<2&&r.set(e.pointerId,e),t._pointerEvents.size<2))return;this.start(e);const o=iX(...Array.from(r.values()));o&&this.pinchStart(e,o)}pinchStart(e,t){const r=this.state;r.origin=t.origin,this.computeValues([t.distance,t.angle]),this.computeInitial(),this.compute(e),this.emit()}touchMove(e){if(!this.state._active)return;const t=dbe(e,this.state._touchIds);t&&this.pinchMove(e,t)}pointerMove(e){const t=this.state._pointerEvents;if(t.has(e.pointerId)&&t.set(e.pointerId,e),!this.state._active)return;const r=iX(...Array.from(t.values()));r&&this.pinchMove(e,r)}pinchMove(e,t){const r=this.state,i=r._values[1],o=t.angle-i;let s=0;Math.abs(o)>270&&(s+=Math.sign(o)),this.computeValues([t.distance,t.angle-360*s]),r.origin=t.origin,r.turns=s,r._movement=[r._values[0]/r._initial[0]-1,r._values[1]-r._initial[1]],this.compute(e),this.emit()}touchEnd(e){this.ctrl.setEventIds(e),this.state._active&&this.state._touchIds.some(t=>!this.ctrl.touchIds.has(t))&&(this.state._active=!1,this.compute(e),this.emit())}pointerEnd(e){const t=this.state;this.ctrl.setEventIds(e);try{e.target.releasePointerCapture(e.pointerId)}catch{}t._pointerEvents.has(e.pointerId)&&t._pointerEvents.delete(e.pointerId),t._active&&t._pointerEvents.size<2&&(t._active=!1,this.compute(e),this.emit())}gestureStart(e){e.cancelable&&e.preventDefault();const t=this.state;t._active||(this.start(e),this.computeValues([e.scale,e.rotation]),t.origin=[e.clientX,e.clientY],this.compute(e),this.emit())}gestureMove(e){if(e.cancelable&&e.preventDefault(),!this.state._active)return;const t=this.state;this.computeValues([e.scale,e.rotation]),t.origin=[e.clientX,e.clientY];const r=t._movement;t._movement=[e.scale-1,e.rotation],t._delta=Hc.sub(t._movement,r),this.compute(e),this.emit()}gestureEnd(e){this.state._active&&(this.state._active=!1,this.compute(e),this.emit())}wheel(e){const t=this.config.modifierKey;t&&(Array.isArray(t)?!t.find(r=>e[r]):!e[t])||(this.state._active?this.wheelChange(e):this.wheelStart(e),this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this)))}wheelStart(e){this.start(e),this.wheelChange(e)}wheelChange(e){"uv"in e||e.cancelable&&e.preventDefault();const r=this.state;r._delta=[-Y8e(e)[1]/s6t*r.offset[0],0],Hc.addTo(r._movement,r._delta),t$e(r),this.state.origin=[e.clientX,e.clientY],this.compute(e),this.emit()}wheelEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(e){const t=this.config.device;t&&(e(t,"start",this[t+"Start"].bind(this)),e(t,"change",this[t+"Move"].bind(this)),e(t,"end",this[t+"End"].bind(this)),e(t,"cancel",this[t+"End"].bind(this)),e("lostPointerCapture","",this[t+"End"].bind(this))),this.config.pinchOnWheel&&e("wheel","",this.wheel.bind(this),{passive:!1})}}const c6t=Cs(Cs({},Q8e),{},{device(n,e,{shared:t,pointer:{touch:r=!1}={}}){if(t.target&&!Eh.touch&&Eh.gesture)return"gesture";if(Eh.touch&&r)return"touch";if(Eh.touchscreen){if(Eh.pointer)return"pointer";if(Eh.touch)return"touch"}},bounds(n,e,{scaleBounds:t={},angleBounds:r={}}){const i=s=>{const a=pbe(l$(t,s),{min:-1/0,max:1/0});return[a.min,a.max]},o=s=>{const a=pbe(l$(r,s),{min:-1/0,max:1/0});return[a.min,a.max]};return typeof t!="function"&&typeof r!="function"?[i(),o()]:s=>[i(s),o(s)]},threshold(n,e,t){return this.lockDirection=t.axis==="lock",Hc.toVector(n,this.lockDirection?[.1,3]:0)},modifierKey(n){return n===void 0?"ctrlKey":n},pinchOnWheel(n=!0){return n}});Cs(Cs({},MD),{},{mouseOnly:(n=!0)=>n});class l6t extends qMt{constructor(...e){super(...e),cl(this,"ingKey","wheeling")}wheel(e){this.state._active||this.start(e),this.wheelChange(e),this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this))}wheelChange(e){const t=this.state;t._delta=Y8e(e),Hc.addTo(t._movement,t._delta),t$e(t),this.compute(e),this.emit()}wheelEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(e){e("wheel","",this.wheel.bind(this))}}const u6t=MD;Cs(Cs({},MD),{},{mouseOnly:(n=!0)=>n});const fie=new Map,oX=new Map;function d6t(n){fie.set(n.key,n.engine),oX.set(n.key,n.resolver)}const h6t={key:"pinch",engine:a6t,resolver:c6t},f6t={key:"wheel",engine:l6t,resolver:u6t};function p6t(n,e){if(n==null)return{};var t={},r=Object.keys(n),i,o;for(o=0;o<r.length;o++)i=r[o],!(e.indexOf(i)>=0)&&(t[i]=n[i]);return t}function g6t(n,e){if(n==null)return{};var t=p6t(n,e),r,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);for(i=0;i<o.length;i++)r=o[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(n,r)&&(t[r]=n[r])}return t}const m6t={target(n){if(n)return()=>"current"in n?n.current:n},enabled(n=!0){return n},window(n=Eh.isBrowser?window:void 0){return n},eventOptions({passive:n=!0,capture:e=!1}={}){return{passive:n,capture:e}},transform(n){return n}},v6t=["target","eventOptions","window","enabled","transform"];function bO(n={},e){const t={};for(const[r,i]of Object.entries(e))switch(typeof i){case"function":t[r]=i.call(t,n[r],r,n);break;case"object":t[r]=bO(n[r],i);break;case"boolean":i&&(t[r]=n[r]);break}return t}function y6t(n,e,t={}){const r=n,{target:i,eventOptions:o,window:s,enabled:a,transform:c}=r,l=g6t(r,v6t);if(t.shared=bO({target:i,eventOptions:o,window:s,enabled:a,transform:c},m6t),e){const u=oX.get(e);t[e]=bO(Cs({shared:t.shared},l),u)}else for(const u in l){const d=oX.get(u);d&&(t[u]=bO(Cs({shared:t.shared},l[u]),d))}return t}class n$e{constructor(e,t){cl(this,"_listeners",new Set),this._ctrl=e,this._gestureKey=t}add(e,t,r,i,o){const s=this._listeners,a=NMt(t,r),c=this._gestureKey?this._ctrl.config[this._gestureKey].eventOptions:{},l=Cs(Cs({},c),o);e.addEventListener(a,i,l);const u=()=>{e.removeEventListener(a,i,l),s.delete(u)};return s.add(u),u}clean(){this._listeners.forEach(e=>e()),this._listeners.clear()}}class b6t{constructor(){cl(this,"_timeouts",new Map)}add(e,t,r=140,...i){this.remove(e),this._timeouts.set(e,window.setTimeout(t,r,...i))}remove(e){const t=this._timeouts.get(e);t&&window.clearTimeout(t)}clean(){this._timeouts.forEach(e=>void window.clearTimeout(e)),this._timeouts.clear()}}class S6t{constructor(e){cl(this,"gestures",new Set),cl(this,"_targetEventStore",new n$e(this)),cl(this,"gestureEventStores",{}),cl(this,"gestureTimeoutStores",{}),cl(this,"handlers",{}),cl(this,"config",{}),cl(this,"pointerIds",new Set),cl(this,"touchIds",new Set),cl(this,"state",{shared:{shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1}}),_6t(this,e)}setEventIds(e){if(X8e(e))return this.touchIds=new Set(BMt(e)),this.touchIds;if("pointerId"in e)return e.type==="pointerup"||e.type==="pointercancel"?this.pointerIds.delete(e.pointerId):e.type==="pointerdown"&&this.pointerIds.add(e.pointerId),this.pointerIds}applyHandlers(e,t){this.handlers=e,this.nativeHandlers=t}applyConfig(e,t){this.config=y6t(e,t,this.config)}clean(){this._targetEventStore.clean();for(const e of this.gestures)this.gestureEventStores[e].clean(),this.gestureTimeoutStores[e].clean()}effect(){return this.config.shared.target&&this.bind(),()=>this._targetEventStore.clean()}bind(...e){const t=this.config.shared,r={};let i;if(!(t.target&&(i=t.target(),!i))){if(t.enabled){for(const s of this.gestures){const a=this.config[s],c=vbe(r,a.eventOptions,!!i);if(a.enabled){const l=fie.get(s);new l(this,e,s).bind(c)}}const o=vbe(r,t.eventOptions,!!i);for(const s in this.nativeHandlers)o(s,"",a=>this.nativeHandlers[s](Cs(Cs({},this.state.shared),{},{event:a,args:e})),void 0,!0)}for(const o in r)r[o]=zMt(...r[o]);if(!i)return r;for(const o in r){const{device:s,capture:a,passive:c}=LMt(o);this._targetEventStore.add(i,s,"",r[o],{capture:a,passive:c})}}}}function dw(n,e){n.gestures.add(e),n.gestureEventStores[e]=new n$e(n,e),n.gestureTimeoutStores[e]=new b6t}function _6t(n,e){e.drag&&dw(n,"drag"),e.wheel&&dw(n,"wheel"),e.scroll&&dw(n,"scroll"),e.move&&dw(n,"move"),e.pinch&&dw(n,"pinch"),e.hover&&dw(n,"hover")}const vbe=(n,e,t)=>(r,i,o,s={},a=!1)=>{var c,l;const u=(c=s.capture)!==null&&c!==void 0?c:e.capture,d=(l=s.passive)!==null&&l!==void 0?l:e.passive;let h=a?r:MMt(r,i,u);t&&d&&(h+="Passive"),n[h]=n[h]||[],n[h].push(o)},w6t=/^on(Drag|Wheel|Scroll|Move|Pinch|Hover)/;function C6t(n){const e={},t={},r=new Set;for(let i in n)w6t.test(i)?(r.add(RegExp.lastMatch),t[i]=n[i]):e[i]=n[i];return[t,e,r]}function hw(n,e,t,r,i,o){if(!n.has(t)||!fie.has(r))return;const s=t+"Start",a=t+"End",c=l=>{let u;return l.first&&s in e&&e[s](l),t in e&&(u=e[t](l)),l.last&&a in e&&e[a](l),u};i[r]=c,o[r]=o[r]||{}}function x6t(n,e){const[t,r,i]=C6t(n),o={};return hw(i,t,"onDrag","drag",o,e),hw(i,t,"onWheel","wheel",o,e),hw(i,t,"onScroll","scroll",o,e),hw(i,t,"onPinch","pinch",o,e),hw(i,t,"onMove","move",o,e),hw(i,t,"onHover","hover",o,e),{handlers:o,config:e,nativeHandlers:r}}function E6t(n,e={},t,r){const i=Ke.useMemo(()=>new S6t(n),[]);if(i.applyHandlers(n,r),i.applyConfig(e,t),Ke.useEffect(i.effect.bind(i)),Ke.useEffect(()=>i.clean.bind(i),[]),e.target===void 0)return i.bind.bind(i)}function I6t(n){return n.forEach(d6t),function(t,r){const{handlers:i,nativeHandlers:o,config:s}=x6t(t,r||{});return E6t(i,s,void 0,o)}}const ybe=10,P6t=/Mac|iPod|iPhone|iPad/.test(typeof window>"u"?"node":window.navigator.platform);function r$e(n){let{deltaY:e,deltaX:t}=n,r=0;return n.ctrlKey||n.altKey||n.metaKey?r=(Math.abs(e)>ybe?ybe*Math.sign(e):e)/100:n.shiftKey&&!P6t&&(t=e,e=0),{x:-t,y:-e,z:-r}}const k6t=I6t([f6t,h6t]);let fw;const T6t=n=>fw===void 0?(fw=n,!1):n-fw>120&&n-fw<160?(fw=n,!0):(fw=n,!1);function D6t(n){const e=ot(),t=y.useMemo(()=>{let r="not sure";const i=({event:g})=>{if(!e.getInstanceState().isFocused||(r="not sure",T6t(Date.now())))return;const m=e.getEditingShapeId();if(m){const S=e.getShape(m);if(S&&e.getShapeUtil(S).canScroll(S)){const w=e.getShapePageBounds(m);if(w!=null&&w.containsPoint(e.inputs.currentPagePoint))return}}Ri(g),Wc(g);const v=r$e(g);if(v.x===0&&v.y===0)return;const b={type:"wheel",name:"wheel",delta:v,point:new H(g.clientX,g.clientY),shiftKey:g.shiftKey,altKey:g.altKey,ctrlKey:g.metaKey||g.ctrlKey};e.dispatch(b)};let o=1,s=1,a=1,c=0;const l=new H,u=new H,d=g=>{const m=n.current;r="not sure";const{event:v,origin:b,da:S}=g;v instanceof WheelEvent||(v.target===m||m!=null&&m.contains(v.target))&&(u.x=b[0],u.y=b[1],l.x=b[0],l.y=b[1],o=S[0],s=e.getZoomLevel(),e.dispatch({type:"pinch",name:"pinch_start",point:{x:b[0],y:b[1],z:e.getZoomLevel()},delta:{x:0,y:0},shiftKey:v.shiftKey,altKey:v.altKey,ctrlKey:v.metaKey||v.ctrlKey}))},h=g=>{if(g&&(r="zooming"),r==="zooming")return;const m=Math.abs(c-o),v=H.Dist(l,u);switch(r){case"not sure":{m>24?r="zooming":v>16&&(r="panning");break}case"panning":{m>64&&(r="zooming");break}}};return{onWheel:i,onPinchStart:d,onPinchEnd:g=>{const m=n.current,{event:v,origin:b,offset:S}=g;if(v instanceof WheelEvent||!(v.target===m||m!=null&&m.contains(v.target)))return;const E=S[0];r="not sure",e.timers.requestAnimationFrame(()=>{e.dispatch({type:"pinch",name:"pinch_end",point:{x:b[0],y:b[1],z:E},delta:{x:b[0],y:b[1]},shiftKey:v.shiftKey,altKey:v.altKey,ctrlKey:v.metaKey||v.ctrlKey})})},onPinch:g=>{const m=n.current,{event:v,origin:b,offset:S,da:E}=g;if(v instanceof WheelEvent||!(v.target===m||m!=null&&m.contains(v.target)))return;const w=g.type==="gesturechange"||g.type==="gestureend";c=E[0];const C=b[0]-u.x,I=b[1]-u.y;switch(u.x=b[0],u.y=b[1],h(w),r){case"zooming":{a=S[0],e.dispatch({type:"pinch",name:"pinch",point:{x:b[0],y:b[1],z:a},delta:{x:C,y:I},shiftKey:v.shiftKey,altKey:v.altKey,ctrlKey:v.metaKey||v.ctrlKey});break}case"panning":{e.dispatch({type:"pinch",name:"pinch",point:{x:b[0],y:b[1],z:s},delta:{x:C,y:I},shiftKey:v.shiftKey,altKey:v.altKey,ctrlKey:v.metaKey||v.ctrlKey});break}}}}},[e,n]);k6t(t,{target:n,eventOptions:{passive:!1},pinch:{from:()=>[e.getZoomLevel(),0],scaleBounds:()=>({from:e.getZoomLevel(),max:8,min:.05})}})}function DU(n,e,t){const r=n.getShape(e),i=n.getShapeHandles(r);return{shape:r,handle:i.find(o=>o.id===t)}}function R6t(n,e){const t=ot();return y.useMemo(()=>{const r=c=>{if(c.isKilled)return;const l=c$(c.currentTarget);AD(l,c);const{shape:u,handle:d}=DU(t,n,e);d&&t.dispatch({type:"pointer",target:"handle",handle:d,shape:u,name:"pointer_down",...Bu(c)})};let i,o;return{onPointerDown:r,onPointerMove:c=>{if(c.isKilled||c.clientX===i&&c.clientY===o)return;i=c.clientX,o=c.clientY;const{shape:l,handle:u}=DU(t,n,e);u&&t.dispatch({type:"pointer",target:"handle",handle:u,shape:l,name:"pointer_move",...Bu(c)})},onPointerUp:c=>{if(c.isKilled)return;const l=c$(c.currentTarget);OD(l,c);const{shape:u,handle:d}=DU(t,n,e);d&&t.dispatch({type:"pointer",target:"handle",handle:d,shape:u,name:"pointer_up",...Bu(c)})}}},[t,n,e])}const Yo=class Yo{constructor(e=0,t=0,r=0,i=0){$(this,"x",0);$(this,"y",0);$(this,"w",0);$(this,"h",0);this.x=e,this.y=t,this.w=r,this.h=i}get point(){return new H(this.x,this.y)}set point(e){this.x=e.x,this.y=e.y}get minX(){return this.x}set minX(e){this.x=e}get midX(){return this.x+this.w/2}get maxX(){return this.x+this.w}get minY(){return this.y}set minY(e){this.y=e}get midY(){return this.y+this.h/2}get maxY(){return this.y+this.h}get width(){return this.w}set width(e){this.w=e}get height(){return this.h}set height(e){this.h=e}get aspectRatio(){return this.width/this.height}get center(){return new H(this.midX,this.midY)}set center(e){this.minX=e.x-this.width/2,this.minY=e.y-this.height/2}get corners(){return[new H(this.minX,this.minY),new H(this.maxX,this.minY),new H(this.maxX,this.maxY),new H(this.minX,this.maxY)]}get cornersAndCenter(){return[new H(this.minX,this.minY),new H(this.maxX,this.minY),new H(this.maxX,this.maxY),new H(this.minX,this.maxY),this.center]}get sides(){const{corners:e}=this;return[[e[0],e[1]],[e[1],e[2]],[e[2],e[3]],[e[3],e[0]]]}get size(){return new H(this.w,this.h)}toFixed(){return this.x=rA(this.x),this.y=rA(this.y),this.w=rA(this.w),this.h=rA(this.h),this}setTo(e){return this.x=e.x,this.y=e.y,this.w=e.w,this.h=e.h,this}set(e=0,t=0,r=0,i=0){return this.x=e,this.y=t,this.w=r,this.h=i,this}expand(e){const t=Math.min(this.minX,e.minX),r=Math.min(this.minY,e.minY),i=Math.max(this.maxX,e.maxX),o=Math.max(this.maxY,e.maxY);return this.x=t,this.y=r,this.w=i-t,this.h=o-r,this}expandBy(e){return this.x-=e,this.y-=e,this.w+=e*2,this.h+=e*2,this}scale(e){return this.x/=e,this.y/=e,this.w/=e,this.h/=e,this}clone(){const{x:e,y:t,w:r,h:i}=this;return new Yo(e,t,r,i)}translate(e){return this.x+=e.x,this.y+=e.y,this}snapToGrid(e){const t=Math.round(this.minX/e)*e,r=Math.round(this.minY/e)*e,i=Math.round(this.maxX/e)*e,o=Math.round(this.maxY/e)*e;this.minX=t,this.minY=r,this.width=Math.max(1,i-t),this.height=Math.max(1,o-r)}collides(e){return Yo.Collides(this,e)}contains(e){return Yo.Contains(this,e)}includes(e){return Yo.Includes(this,e)}containsPoint(e,t=0){return Yo.ContainsPoint(this,e,t)}getHandlePoint(e){switch(e){case"top_left":return new H(this.minX,this.minY);case"top_right":return new H(this.maxX,this.minY);case"bottom_left":return new H(this.minX,this.maxY);case"bottom_right":return new H(this.maxX,this.maxY);case"top":return new H(this.midX,this.minY);case"right":return new H(this.maxX,this.midY);case"bottom":return new H(this.midX,this.maxY);case"left":return new H(this.minX,this.midY)}}toJson(){return{x:this.minX,y:this.minY,w:this.w,h:this.h}}resize(e,t,r){const{minX:i,minY:o,maxX:s,maxY:a}=this;let{minX:c,minY:l,maxX:u,maxY:d}=this;switch(e){case"left":case"top_left":case"bottom_left":{c+=t;break}case"right":case"top_right":case"bottom_right":{u+=t;break}}switch(e){case"top":case"top_left":case"top_right":{l+=r;break}case"bottom":case"bottom_left":case"bottom_right":{d+=r;break}}const h=(u-c)/(s-i),f=(d-l)/(a-o),p=h<0,g=f<0;if(p){const m=u;u=c,c=m}if(g){const m=d;d=l,l=m}this.minX=c,this.minY=l,this.width=Math.abs(u-c),this.height=Math.abs(d-l)}union(e){const t=Math.min(this.minX,e.x),r=Math.min(this.minY,e.y),i=Math.max(this.maxX,e.w+e.x),o=Math.max(this.maxY,e.h+e.y);return this.x=t,this.y=r,this.width=i-t,this.height=o-r,this}static From(e){return new Yo(e.x,e.y,e.w,e.h)}static FromCenter(e,t){return new Yo(e.x-t.x/2,e.y-t.y/2,t.x,t.y)}static FromPoints(e){if(e.length===0)return new Yo;let t=1/0,r=1/0,i=-1/0,o=-1/0,s;for(let a=0,c=e.length;a<c;a++)s=e[a],t=Math.min(s.x,t),r=Math.min(s.y,r),i=Math.max(s.x,i),o=Math.max(s.y,o);return new Yo(t,r,i-t,o-r)}static Expand(e,t){const r=Math.min(t.minX,e.minX),i=Math.min(t.minY,e.minY),o=Math.max(t.maxX,e.maxX),s=Math.max(t.maxY,e.maxY);return new Yo(r,i,o-r,s-i)}static ExpandBy(e,t){return new Yo(e.minX-t,e.minY-t,e.width+t*2,e.height+t*2)}static Resize(e,t,r,i,o=!1){const{minX:s,minY:a,maxX:c,maxY:l}=e;let{minX:u,minY:d,maxX:h,maxY:f}=e;switch(t){case"left":case"top_left":case"bottom_left":{u+=r;break}case"right":case"top_right":case"bottom_right":{h+=r;break}}switch(t){case"top":case"top_left":case"top_right":{d+=i;break}case"bottom":case"bottom_left":case"bottom_right":{f+=i;break}}const p=(h-u)/(c-s),g=(f-d)/(l-a),m=p<0,v=g<0;if(o){const S=(c-s)/(l-a),E=Math.abs(h-u),w=Math.abs(f-d),C=E*(g<0?1:-1)*(1/S),I=w*(p<0?1:-1)*S,T=S<E/w;switch(t){case"top_left":{T?d=f+C:u=h+I;break}case"top_right":{T?d=f+C:h=u-I;break}case"bottom_right":{T?f=d-C:h=u-I;break}case"bottom_left":{T?f=d-C:u=h+I;break}case"bottom":case"top":{const D=(u+h)/2,O=w*S;u=D-O/2,h=D+O/2;break}case"left":case"right":{const D=(d+f)/2,O=E/S;d=D-O/2,f=D+O/2;break}}}if(m){const S=h;h=u,u=S}if(v){const S=f;f=d,d=S}const b=new Yo(u,d,Math.abs(h-u),Math.abs(f-d));return{box:b,scaleX:+(b.width/e.width*(p>0?1:-1)).toFixed(5),scaleY:+(b.height/e.height*(g>0?1:-1)).toFixed(5)}}equals(e){return Yo.Equals(this,e)}static Equals(e,t){return t.x===e.x&&t.y===e.y&&t.w===e.w&&t.h===e.h}zeroFix(){return this.w=Math.max(1,this.w),this.h=Math.max(1,this.h),this}static ZeroFix(e){return new Yo(e.x,e.y,Math.max(1,e.w),Math.max(1,e.h))}};$(Yo,"Collides",(e,t)=>!(e.maxX<t.minX||e.minX>t.maxX||e.maxY<t.minY||e.minY>t.maxY)),$(Yo,"Contains",(e,t)=>e.minX<t.minX&&e.minY<t.minY&&e.maxY>t.maxY&&e.maxX>t.maxX),$(Yo,"Includes",(e,t)=>Yo.Collides(e,t)||Yo.Contains(e,t)),$(Yo,"ContainsPoint",(e,t,r=0)=>!(t.x<e.minX-r||t.y<e.minY-r||t.x>e.maxX+r||t.y>e.maxY+r)),$(Yo,"Common",e=>{let t=1/0,r=1/0,i=-1/0,o=-1/0;for(let s=0;s<e.length;s++){const a=e[s];t=Math.min(t,a.minX),r=Math.min(r,a.minY),i=Math.max(i,a.maxX),o=Math.max(o,a.maxY)}return new Yo(t,r,i-t,o-r)}),$(Yo,"Sides",(e,t=0)=>{const{corners:r}=e;return[[r[0],r[1]],[r[1],r[2]],[r[2],r[3]],[r[3],r[0]]]});let xn=Yo;function A6t(n){switch(n){case"top":return"bottom";case"bottom":return"top";case"top_left":return"bottom_left";case"top_right":return"bottom_right";case"bottom_left":return"top_left";case"bottom_right":return"top_right";default:return n}}function O6t(n){switch(n){case"left":return"right";case"right":return"left";case"top_left":return"top_right";case"top_right":return"top_left";case"bottom_left":return"bottom_right";case"bottom_right":return"bottom_left";default:return n}}function M6t(n){return n==="top_left"||n==="top_right"||n==="bottom_right"||n==="bottom_left"}function $6t(n){const e=ot();y.useLayoutEffect(()=>{let t=new xn;function r(){const l=n.current;if(!l)return null;const u=l.getBoundingClientRect(),d=new xn(u.left||u.x,u.top||u.y,Math.max(u.width,1),Math.max(u.height,1));t.equals(d)||(e.updateViewportScreenBounds(d),t=d)}r();const i=S6e(r,200,{trailing:!0}),o=e.timers.setInterval(i,1e3);window.addEventListener("resize",i);const s=new ResizeObserver(l=>{l[0].contentRect&&i()}),a=n.current;let c=null;return a&&(s.observe(a),c=L6t(a),c.addEventListener("scroll",i)),()=>{clearInterval(o),window.removeEventListener("resize",i),s.disconnect(),c==null||c.removeEventListener("scroll",i),i.cancel()}},[e,n])}/*!
 * Author: excalidraw
 * MIT License: https://github.com/excalidraw/excalidraw/blob/master/LICENSE
 * https://github.com/excalidraw/excalidraw/blob/48c3465b19f10ec755b3eb84e21a01a468e96e43/packages/excalidraw/utils.ts#L600
 */const L6t=n=>{let e=n.parentElement;for(;e;){if(e===document.body)return document;const{overflowY:t}=window.getComputedStyle(e);if(e.scrollHeight>e.clientHeight&&(t==="auto"||t==="scroll"||t==="overlay"))return e;e=e.parentElement}return document},Ki=class Ki{constructor(e,t,r,i,o,s){$(this,"a",1);$(this,"b",0);$(this,"c",0);$(this,"d",1);$(this,"e",0);$(this,"f",0);this.a=e,this.b=t,this.c=r,this.d=i,this.e=o,this.f=s}equals(e){return this===e||this.a===e.a&&this.b===e.b&&this.c===e.c&&this.d===e.d&&this.e===e.e&&this.f===e.f}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0,this}multiply(e){const t=e,{a:r,b:i,c:o,d:s,e:a,f:c}=this;return this.a=r*t.a+o*t.b,this.c=r*t.c+o*t.d,this.e=r*t.e+o*t.f+a,this.b=i*t.a+s*t.b,this.d=i*t.c+s*t.d,this.f=i*t.e+s*t.f+c,this}rotate(e,t,r){return e===0?this:t===void 0?this.multiply(Ki.Rotate(e)):this.translate(t,r).multiply(Ki.Rotate(e)).translate(-t,-r)}translate(e,t){return this.multiply(Ki.Translate(e,t))}scale(e,t){return this.multiply(Ki.Scale(e,t))}invert(){const{a:e,b:t,c:r,d:i,e:o,f:s}=this,a=e*i-t*r;return this.a=i/a,this.b=t/-a,this.c=r/-a,this.d=e/a,this.e=(i*o-r*s)/-a,this.f=(t*o-e*s)/a,this}applyToPoint(e){return Ki.applyToPoint(this,e)}applyToPoints(e){return Ki.applyToPoints(this,e)}rotation(){return Ki.Rotation(this)}point(){return Ki.Point(this)}decomposed(){return Ki.Decompose(this)}toCssString(){return Ki.toCssString(this)}setTo(e){return Object.assign(this,e),this}decompose(){return Ki.Decompose(this)}clone(){return new Ki(this.a,this.b,this.c,this.d,this.e,this.f)}static Identity(){return new Ki(1,0,0,1,0,0)}static Translate(e,t){return new Ki(1,0,0,1,e,t)}static Rotate(e,t,r){if(e===0)return Ki.Identity();const i=Math.cos(e),o=Math.sin(e),s=new Ki(i,o,-o,i,0,0);return t===void 0?s:Ki.Compose(Ki.Translate(t,r),s,Ki.Translate(-t,-r))}static Multiply(e,t){return{a:e.a*t.a+e.c*t.b,c:e.a*t.c+e.c*t.d,e:e.a*t.e+e.c*t.f+e.e,b:e.b*t.a+e.d*t.b,d:e.b*t.c+e.d*t.d,f:e.b*t.e+e.d*t.f+e.f}}static Inverse(e){const t=e.a*e.d-e.b*e.c;return{a:e.d/t,b:e.b/-t,c:e.c/-t,d:e.a/t,e:(e.d*e.e-e.c*e.f)/-t,f:(e.b*e.e-e.a*e.f)/t}}static Absolute(e){const t=e.a*e.d-e.b*e.c;return{a:e.d/t,b:e.b/-t,c:e.c/-t,d:e.a/t,e:(e.d*e.e-e.c*e.f)/t,f:(e.b*e.e-e.a*e.f)/-t}}static Compose(...e){const t=Ki.Identity();for(let r=0,i=e.length;r<i;r++)t.multiply(e[r]);return t}static Point(e){return new H(e.e,e.f)}static Rotation(e){let t;if(e.a!==0||e.c!==0){const r=(e.a*e.a+e.c*e.c)**.5;t=Math.acos(e.a/r)*(e.c>0?-1:1)}else if(e.b!==0||e.d!==0){const r=(e.b*e.b+e.d*e.d)**.5;t=Fo+Math.acos(e.b/r)*(e.d>0?-1:1)}else t=0;return nX(t)}static Decompose(e){let t,r,i;if(e.a!==0||e.c!==0){const o=(e.a*e.a+e.c*e.c)**.5;t=o,r=(e.a*e.d-e.b*e.c)/o,i=Math.acos(e.a/o)*(e.c>0?-1:1)}else if(e.b!==0||e.d!==0){const o=(e.b*e.b+e.d*e.d)**.5;t=(e.a*e.d-e.b*e.c)/o,r=o,i=Fo+Math.acos(e.b/o)*(e.d>0?-1:1)}else t=0,r=0,i=0;return{x:e.e,y:e.f,scaleX:t,scaleY:r,rotation:nX(i)}}static Smooth(e,t=1e10){return e.a=Math.round(e.a*t)/t,e.b=Math.round(e.b*t)/t,e.c=Math.round(e.c*t)/t,e.d=Math.round(e.d*t)/t,e.e=Math.round(e.e*t)/t,e.f=Math.round(e.f*t)/t,e}static toCssString(e){return`matrix(${et(e.a)}, ${et(e.b)}, ${et(e.c)}, ${et(e.d)}, ${et(e.e)}, ${et(e.f)})`}static applyToPoint(e,t){return new H(e.a*t.x+e.c*t.y+e.e,e.b*t.x+e.d*t.y+e.f,t.z)}static applyToXY(e,t,r){return[e.a*t+e.c*r+e.e,e.b*t+e.d*r+e.f]}static applyToPoints(e,t){return t.map(r=>new H(e.a*r.x+e.c*r.y+e.e,e.b*r.x+e.d*r.y+e.f,r.z))}static applyToBounds(e,t){return new xn(e.e+t.minX,e.f+t.minY,t.width,t.height)}static From(e){return new Ki(e.a,e.b,e.c,e.d,e.e,e.f)}static Cast(e){return e instanceof Ki?e:Ki.From(e)}};$(Ki,"Scale",(e,t,r,i)=>{const o=new Ki(e,0,0,t,0,0);return r===void 0?o:Ki.Compose(Ki.Translate(r,i),o,Ki.Translate(-r,-i))});let Mn=Ki;function i$e(n,e){return e===0?n:i$e(e,n%e)}function o$e(n){const e=n.toString().split(".")[1];if(!e)return 1;const t=Math.pow(10,e.length),r=parseInt(e,10);return t/i$e(r,t)}class Xy{constructor(e){$(this,"isFilled",!1);$(this,"isClosed",!0);$(this,"isLabel",!1);$(this,"debugColor");$(this,"ignore");$(this,"_vertices");$(this,"_bounds");$(this,"_area");$(this,"_length");this.isFilled=e.isFilled,this.isClosed=e.isClosed,this.isLabel=e.isLabel??!1,this.debugColor=e.debugColor,this.ignore=e.ignore}hitTestPoint(e,t=0,r=!1){return this.isClosed&&(this.isFilled||r)&&Fd(e,this.vertices)?!0:H.Dist2(e,this.nearestPoint(e))<=t*t}distanceToPoint(e,t=!1){return e.dist(this.nearestPoint(e))*(this.isClosed&&(this.isFilled||t)&&Fd(e,this.vertices)?-1:1)}distanceToLineSegment(e,t){if(e.equals(t))return this.distanceToPoint(e);const{vertices:r}=this;let i,o=1/0,s,a,c;for(let l=0;l<r.length;l++)a=r[l],c=H.NearestPointOnLineSegment(e,t,a,!0),s=H.Dist2(a,c),s<o&&(o=s,i=c);if(!i)throw Error("nearest point not found");return this.isClosed&&this.isFilled&&Fd(i,this.vertices)?-o:o}hitTestLineSegment(e,t,r=0){return this.distanceToLineSegment(e,t)<=r}nearestPointOnLineSegment(e,t){const{vertices:r}=this;let i,o=1/0,s,a,c;for(let l=0;l<r.length;l++)a=r[l],c=H.NearestPointOnLineSegment(e,t,a,!0),s=H.Dist2(a,c),s<o&&(o=s,i=c);if(!i)throw Error("nearest point not found");return i}isPointInBounds(e,t=0){const{bounds:r}=this;return!(e.x<r.minX-t||e.y<r.minY-t||e.x>r.maxX+t||e.y>r.maxY+t)}get vertices(){return this._vertices||(this._vertices=this.getVertices()),this._vertices}getBounds(){return xn.FromPoints(this.vertices)}get bounds(){return this._bounds||(this._bounds=this.getBounds()),this._bounds}get center(){return this.bounds.center}get area(){return this._area||(this._area=this.getArea()),this._area}getArea(){if(!this.isClosed)return 0;const{vertices:e}=this;let t=0;for(let r=0,i=e.length;r<i;r++){const o=e[r],s=e[(r+1)%i];t+=o.x*s.y-s.x*o.y}return t/2}toSimpleSvgPath(){let e="";const{vertices:t}=this,r=t.length;if(r===0)return e;e+=`M${t[0].x},${t[0].y}`;for(let i=1;i<r;i++)e+=`L${t[i].x},${t[i].y}`;return this.isClosed&&(e+="Z"),e}get length(){return this._length?this._length:(this._length=this.getLength(),this._length)}getLength(){const{vertices:e}=this;let t,r=e[0],i=0;for(let o=1;o<e.length;o++)t=e[o],i+=H.Dist2(r,t),r=t;return Math.sqrt(i)}}class Qf extends Xy{constructor(t){super({...t,isClosed:!0,isFilled:!1});$(this,"children",[]);$(this,"ignoredChildren",[]);for(const r of t.children)r.ignore?this.ignoredChildren.push(r):this.children.push(r);if(this.children.length===0)throw Error("Group2d must have at least one child")}getVertices(){return this.children.filter(t=>!t.isLabel).flatMap(t=>t.vertices)}nearestPoint(t){let r=1/0,i;const{children:o}=this;if(o.length===0)throw Error("no children");let s,a;for(const c of o)s=c.nearestPoint(t),a=H.Dist2(s,t),a<r&&(r=a,i=s);if(!i)throw Error("nearest point not found");return i}distanceToPoint(t,r=!1){return Math.min(...this.children.map((i,o)=>i.distanceToPoint(t,r||o>0)))}hitTestPoint(t,r,i){return!!this.children.filter(o=>!o.isLabel).find(o=>o.hitTestPoint(t,r,i))}hitTestLineSegment(t,r,i){return!!this.children.filter(o=>!o.isLabel).find(o=>o.hitTestLineSegment(t,r,i))}getArea(){return this.children[0].area}toSimpleSvgPath(){let t="";for(const i of this.children)t+=i.toSimpleSvgPath();const r=xn.FromPoints(this.vertices).corners;for(let i=0,o=r.length;i<o;i++){const s=r[i],a=r[(i-1+o)%o],c=s.dist(a),l=r[(i+1)%o],u=s.dist(l),d=s.clone().lrp(a,4/c),h=s,f=s.clone().lrp(l,4/u);t+=`M${d.x},${d.y} L${h.x},${h.y} L${f.x},${f.y} `}return t}getLength(){return this.children.reduce((t,r)=>r.isLabel?t:t+r.length,0)}getSvgPathData(){return this.children.map((t,r)=>t.isLabel?"":t.getSvgPathData(r===0)).join(" ")}}function N6t(n=!0){const[e,t]=y.useState(0),r=ot();y.useEffect(()=>{if(!n)return;const i=()=>t(o=>o+1);return r.on("tick",i),()=>{r.off("tick",i)}},[r,n])}const F6t=Zd(function({showStroke:e=!0,showVertices:t=!0,showClosestPointOnOutline:r=!0}){const i=ot();N6t(r);const o=i.getZoomLevel(),s=i.getRenderingShapes(),{inputs:{currentPagePoint:a}}=i;return x.jsx("svg",{style:{position:"absolute",pointerEvents:"none",zIndex:999999999,top:0,left:0,overflow:"visible"},children:s.map(c=>{const l=i.getShape(c.id);if(l.type==="group")return null;const u=i.getShapeGeometry(l),d=i.getShapePageTransform(l),h=i.getPointInShapeSpace(l,a),f=u.nearestPoint(h),p=u.distanceToPoint(h,!0),g=Math.abs(p)*o,m=p<0,{vertices:v}=u;return x.jsxs("g",{transform:d.toCssString(),strokeLinecap:"round",strokeLinejoin:"round",children:[e&&x.jsx("g",{stroke:u.debugColor??"red",opacity:"1",strokeWidth:2/o,fill:"none",children:x.jsx(s$e,{geometry:u})}),t&&v.map((b,S)=>x.jsx("circle",{cx:b.x,cy:b.y,r:2/o,fill:`hsl(${ix(S,[0,v.length-1],[120,200])}, 100%, 50%)`,stroke:"black",strokeWidth:1/o},`v${S}`)),r&&g<150&&x.jsx("line",{x1:f.x,y1:f.y,x2:h.x,y2:h.y,opacity:1-g/150,stroke:m?"goldenrod":"dodgerblue",strokeWidth:2/o})]},c.id+"_outline")})})});function s$e({geometry:n}){return n instanceof Qf?x.jsx(x.Fragment,{children:[...n.children,...n.ignoredChildren].map((e,t)=>x.jsx(s$e,{geometry:e},t))}):x.jsx("path",{d:n.toSimpleSvgPath()})}function a$e(n){return VAt(n)}function j6t(){const n=ot(),e=L4t("userIds",()=>a$e(n.getCollaborators().map(t=>t.userId)).sort(),{isEqual:(t,r)=>{var i;return t.join(",")===((i=r.join)==null?void 0:i.call(r,","))}},[n]);return _t(e)}function c$e(n){const e=ot();return _t(`latestPresence:${n}`,()=>e.getCollaborators().find(r=>r.userId===n),[e,n])??null}const B6t=Zd(function(){const e=j6t();return x.jsx(x.Fragment,{children:e.map(t=>x.jsx(H6t,{collaboratorId:t},t))})}),H6t=Zd(function({collaboratorId:e}){const t=ot(),r=c$e(e),i=z6t(t,r);if(!(r&&r.currentPageId===t.getCurrentPageId()))return null;switch(i){case"inactive":{const{followingUserId:o,highlightedUserIds:s}=t.getInstanceState();if(!(o===r.userId||s.includes(r.userId)))return null;break}case"idle":{const{highlightedUserIds:o}=t.getInstanceState();if(r.followingUserId===t.user.getId()&&!(r.chatMessage||o.includes(r.userId)))return null;break}}return x.jsx(U6t,{latestPresence:r})}),U6t=Zd(function({latestPresence:e}){const t=ot(),{CollaboratorBrush:r,CollaboratorScribble:i,CollaboratorCursor:o,CollaboratorHint:s,CollaboratorShapeIndicator:a}=hs(),c=t.getZoomLevel(),l=t.getViewportPageBounds(),{userId:u,chatMessage:d,brush:h,scribbles:f,selectedShapeIds:p,userName:g,cursor:m,color:v}=e,b=!(m.x<l.minX-12/c||m.y<l.minY-16/c||m.x>l.maxX-12/c||m.y>l.maxY-16/c);return x.jsxs(x.Fragment,{children:[h&&r?x.jsx(r,{className:"tl-collaborator__brush",brush:h,color:v,opacity:.1},u+"_brush"):null,b&&o?x.jsx(o,{className:"tl-collaborator__cursor",point:m,color:v,zoom:c,name:g!=="New User"?g:null,chatMessage:d},u+"_cursor"):s?x.jsx(s,{className:"tl-collaborator__cursor-hint",point:m,color:v,zoom:c,viewport:l},u+"_cursor_hint"):null,i&&f.length?x.jsx(x.Fragment,{children:f.map(S=>x.jsx(i,{className:"tl-collaborator__scribble",scribble:S,color:v,zoom:c,opacity:S.color==="laser"?.5:.1},u+"_scribble_"+S.id))}):null,a&&p.map(S=>x.jsx(a,{className:"tl-collaborator__shape-indicator",shapeId:S,color:v,opacity:.5},u+"_"+S))]})});function bbe(n,e){return e>n.options.collaboratorInactiveTimeoutMs?"inactive":e>n.options.collaboratorIdleTimeoutMs?"idle":"active"}function z6t(n,e){const t=y.useRef((e==null?void 0:e.lastActivityTimestamp)??-1),[r,i]=y.useState(()=>bbe(n,Date.now()-t.current));return y.useEffect(()=>{const o=n.timers.setInterval(()=>{i(bbe(n,Date.now()-t.current))},n.options.collaboratorCheckIntervalMs);return()=>clearInterval(o)},[n]),e&&(t.current=e.lastActivityTimestamp),r}const l$e=y.memo(function({id:e,shape:t,util:r,index:i,backgroundIndex:o,opacity:s,dprMultiple:a}){const c=ot(),{ShapeErrorFallback:l}=hs(),u=y.useRef(null),d=y.useRef(null),h=y.useRef({transform:"",clipPath:"none",width:0,height:0,x:0,y:0,isCulled:!1});oy("set shape stuff",()=>{const g=c.getShape(e);if(!g)return;const m=h.current,v=c.getShapeClipPath(e)??"none";v!==m.clipPath&&(rl(u.current,"clip-path",v),rl(d.current,"clip-path",v),m.clipPath=v);const b=c.getShapePageTransform(e),S=Mn.toCssString(b),E=c.getShapeGeometry(g).bounds;S!==m.transform&&(rl(u.current,"transform",S),rl(d.current,"transform",S),m.transform=S);const w=E.w%a,C=E.h%a,I=w===0?E.w:E.w+(a-w),T=C===0?E.h:E.h+(a-C);(I!==m.width||T!==m.height)&&(rl(u.current,"width",Math.max(I,a)+"px"),rl(u.current,"height",Math.max(T,a)+"px"),rl(d.current,"width",Math.max(I,a)+"px"),rl(d.current,"height",Math.max(T,a)+"px"),m.width=I,m.height=T)},[c]),oy("set opacity and z-index",()=>{const g=u.current,m=d.current;rl(g,"opacity",s),rl(m,"opacity",s),rl(g,"z-index",i),rl(m,"z-index",o)},[s,i,o]),oy("set display",()=>{if(!c.getShape(e))return;const v=c.getCulledShapes().has(e);v!==h.current.isCulled&&(rl(u.current,"display",v?"none":"block"),rl(d.current,"display",v?"none":"block"),h.current.isCulled=v)},[c]);const f=y.useCallback(g=>c.annotateError(g,{origin:"shape",willCrashApp:!1}),[c]);if(!t)return null;const p="fill"in t.props&&t.props.fill!=="none";return x.jsxs(x.Fragment,{children:[r.backgroundComponent&&x.jsx("div",{ref:d,className:"tl-shape tl-shape-background","data-shape-type":t.type,draggable:!1,children:x.jsx(V3,{fallback:l,onError:f,children:x.jsx(W6t,{shape:t,util:r})})}),x.jsx("div",{ref:u,className:"tl-shape","data-shape-type":t.type,"data-shape-is-filled":p,draggable:!1,children:x.jsx(V3,{fallback:l,onError:f,children:x.jsx(V6t,{shape:t,util:r})})})]})}),V6t=y.memo(function({shape:e,util:t}){return xN("InnerShape:"+e.type,()=>t.component(t.editor.store.unsafeGetWithoutCapture(e.id)))},(n,e)=>n.shape.props===e.shape.props&&n.shape.meta===e.shape.meta),W6t=y.memo(function({shape:e,util:t}){return xN("InnerShape:"+e.type,()=>{var r;return(r=t.backgroundComponent)==null?void 0:r.call(t,t.editor.store.unsafeGetWithoutCapture(e.id))})},(n,e)=>n.shape.props===e.shape.props&&n.shape.meta===e.shape.meta);function q6t({className:n}){const e=ot(),{Background:t,SvgDefs:r}=hs(),i=y.useRef(null),o=y.useRef(null),s=y.useRef(null),a=Il();$6t(i),xMt(),wMt(),D6t(i),PMt(i);const c=y.useRef({lodDisableTextOutline:!1,allowTextOutline:!0});oy("position layers",function(){const{x:v,y:b,z:S}=e.getCamera();if(c.current.allowTextOutline&&e.environment.isSafari&&(a.style.setProperty("--tl-text-outline","none"),c.current.allowTextOutline=!1),c.current.allowTextOutline&&S<e.options.textShadowLod!==c.current.lodDisableTextOutline){const C=S<e.options.textShadowLod;a.style.setProperty("--tl-text-outline",C?"none":"var(--tl-text-outline-reference)"),c.current.lodDisableTextOutline=C}const E=S>=1?ix(S,[1,8],[.125,.5],!0):ix(S,[.1,1],[-2,.125],!0),w=`scale(${et(S)}) translate(${et(v+E)}px,${et(b+E)}px)`;rl(o.current,"transform",w),rl(s.current,"transform",w)},[e,a]);const l=_Mt(),u=_t("shapeSvgDefs",()=>{const m=new Map;for(const v of Rs(e.shapeUtils)){if(!v)return;const b=v.getCanvasSvgDefs();for(const{key:S,component:E}of b)m.has(S)||m.set(S,x.jsx(E,{},S))}return[...m.values()]},[e]),d=_t("debug_shapes",()=>ta.hideShapes.get(),[ta]),h=_t("debug_svg",()=>ta.debugSvg.get(),[ta]),f=_t("debug_geometry",()=>ta.debugGeometry.get(),[ta]),p=_t("isEditingAnything",()=>e.getEditingShapeId()!==null,[e]),g=_t("isSelectingAnything",()=>!!e.getSelectedShapeIds().length,[e]);return x.jsxs("div",{ref:i,draggable:!1,"data-iseditinganything":p,"data-isselectinganything":g,className:Ue("tl-canvas",n),"data-testid":"canvas",...l,children:[x.jsx("svg",{className:"tl-svg-context",children:x.jsxs("defs",{children:[u,x.jsx(s8t,{}),x.jsx(a8t,{}),r&&x.jsx(r,{})]})}),t&&x.jsx("div",{className:"tl-background__wrapper",children:x.jsx(t,{})}),x.jsx(K6t,{}),x.jsxs("div",{ref:o,className:"tl-html-layer tl-shapes",draggable:!1,children:[x.jsx(d8t,{}),x.jsx(u8t,{}),d?null:h?x.jsx(t8t,{}):x.jsx(r8t,{})]}),x.jsx("div",{className:"tl-overlays",children:x.jsxs("div",{ref:s,className:"tl-html-layer",children:[f?x.jsx(F6t,{}):null,x.jsx(J6t,{}),x.jsx(Z6t,{}),x.jsx(G6t,{}),x.jsx(X6t,{}),x.jsx(i8t,{}),x.jsx(o8t,{}),x.jsx(Y6t,{}),x.jsx(l8t,{}),x.jsx(B6t,{})]})}),x.jsx(h8t,{})]})}function K6t(){const n=ot(),e=_t("gridSize",()=>n.getDocumentSettings().gridSize,[n]),{x:t,y:r,z:i}=_t("camera",()=>n.getCamera(),[n]),o=_t("isGridMode",()=>n.getInstanceState().isGridMode,[n]),{Grid:s}=hs();return s&&o?x.jsx(s,{x:t,y:r,z:i,size:e}):null}function G6t(){const n=ot(),e=_t("scribbles",()=>n.getInstanceState().scribbles,[n]),t=_t("zoomLevel",()=>n.getZoomLevel(),[n]),{Scribble:r}=hs();return r&&e.length?x.jsx(x.Fragment,{children:e.map(i=>x.jsx(r,{className:"tl-user-scribble",scribble:i,zoom:t},i.id))}):null}function Z6t(){const n=ot(),e=_t("brush",()=>n.getInstanceState().brush,[n]),{Brush:t}=hs();return t&&e?x.jsx(t,{className:"tl-user-brush",brush:e}):null}function X6t(){const n=ot(),e=_t("zoomBrush",()=>n.getInstanceState().zoomBrush,[n]),{ZoomBrush:t}=hs();return t&&e?x.jsx(t,{className:"tl-user-brush tl-zoom-brush",brush:e}):null}function Y6t(){const n=ot(),e=_t("snapLines",()=>n.snaps.getIndicators(),[n]),t=_t("zoomLevel",()=>n.getZoomLevel(),[n]),{SnapIndicator:r}=hs();return r&&e.length>0?x.jsx(x.Fragment,{children:e.map(i=>x.jsx(r,{className:"tl-user-snapline",line:i,zoom:t},i.id))}):null}function J6t(){const n=ot(),e=_t("handles shapeIdWithHandles",()=>{const{isReadonly:t,isChangingStyle:r}=n.getInstanceState();if(t||r)return!1;const i=n.getOnlySelectedShape();return!i||!n.getShapeHandles(i)?!1:i.id},[n]);return e?x.jsx(Q6t,{shapeId:e}):null}function Q6t({shapeId:n}){const e=ot(),{Handles:t}=hs(),r=_t("zoomLevel",()=>e.getZoomLevel(),[e]),i=_t("coarse pointer",()=>e.getInstanceState().isCoarsePointer,[e]),o=_t("handles transform",()=>e.getShapePageTransform(n),[e,n]),s=_t("handles",()=>{const a=e.getShapeHandles(n);if(!a)return null;const c=(i?e.options.coarseHandleRadius:e.options.handleRadius)/r*2;return a.filter(l=>l.type!=="virtual"||!a.some(u=>u!==l&&u.type==="vertex"&&H.Dist(l,u)<c)).sort(l=>l.type==="vertex"?1:-1)},[e,r,i,n]);return!t||!s||!o?null:x.jsx(t,{children:x.jsx("g",{transform:Mn.toCssString(o),children:s.map(a=>x.jsx(e8t,{shapeId:n,handle:a,zoom:r,isCoarse:i},a.id))})})}function e8t({shapeId:n,handle:e,zoom:t,isCoarse:r}){const i=R6t(n,e.id),{Handle:o}=hs();return o?x.jsx("g",{"aria-label":"handle",transform:`translate(${e.x}, ${e.y})`,...i,children:x.jsx(o,{shapeId:n,handle:e,zoom:t,isCoarse:r})}):null}function t8t(){const n=ot(),e=_t("rendering shapes",()=>n.getRenderingShapes(),[n]),t=_t("dpr multiple",()=>o$e(Math.floor(n.getInstanceState().devicePixelRatio*100)/100),[n]);return x.jsx(x.Fragment,{children:e.map(r=>x.jsxs(y.Fragment,{children:[x.jsx(l$e,{...r,dprMultiple:t}),x.jsx(c8t,{id:r.id})]},r.id+"_fragment"))})}function n8t(){const n=ot(),e=y.useRef(new Set);return oy("reflow for culled shapes",()=>{const t=n.getCulledShapes();if(e.current.size===t.size&&[...t].every(i=>e.current.has(i)))return;e.current=t;const r=document.getElementsByClassName("tl-canvas");r.length!==0&&r[0].offsetHeight},[n]),null}function r8t(){const n=ot(),e=_t("rendering shapes",()=>n.getRenderingShapes(),[n]),t=_t("dpr multiple",()=>o$e(Math.floor(n.getInstanceState().devicePixelRatio*100)/100),[n]);return x.jsxs(x.Fragment,{children:[e.map(r=>x.jsx(l$e,{...r,dprMultiple:t},r.id+"_shape")),n.environment.isSafari&&x.jsx(n8t,{})]})}function i8t(){const n=ot(),e=_t("rendering shapes",()=>n.getRenderingShapes(),[n]),t=y.useRef(new Set),r=_t("should display selected ids",()=>{const o=t.current,s=new Set;if(n.isInAny("select.idle","select.brushing","select.scribble_brushing","select.editing_shape","select.pointing_shape","select.pointing_selection","select.pointing_handle")&&!n.getInstanceState().isChangingStyle){const a=n.getSelectedShapeIds();for(const c of a)s.add(c);if(n.isInAny("select.idle","select.editing_shape")){const c=n.getInstanceState();if(c.isHoveringCanvas&&!c.isCoarsePointer){const l=n.getHoveredShapeId();l&&s.add(l)}}}if(o.size!==s.size)return t.current=s,s;for(const a of s)if(!o.has(a))return t.current=s,s;return o},[n]),{ShapeIndicator:i}=hs();return i?x.jsx(x.Fragment,{children:e.map(({id:o})=>x.jsx(i,{shapeId:o,hidden:!r.has(o)},o+"_indicator"))}):null}function o8t(){const n=ot(),{ShapeIndicator:e}=hs(),t=_t("hinting shape ids",()=>Kre(n.getHintingShapeIds()),[n]);return!t.length||!e?null:x.jsx(x.Fragment,{children:t.map(r=>x.jsx(e,{className:"tl-user-indicator__hint",shapeId:r},r+"_hinting"))})}function s8t(){return x.jsxs("g",{id:"cursor",children:[x.jsxs("g",{fill:"rgba(0,0,0,.2)",transform:"translate(-11,-11)",children:[x.jsx("path",{d:"m12 24.4219v-16.015l11.591 11.619h-6.781l-.411.124z"}),x.jsx("path",{d:"m21.0845 25.0962-3.605 1.535-4.682-11.089 3.686-1.553z"})]}),x.jsxs("g",{fill:"white",transform:"translate(-12,-12)",children:[x.jsx("path",{d:"m12 24.4219v-16.015l11.591 11.619h-6.781l-.411.124z"}),x.jsx("path",{d:"m21.0845 25.0962-3.605 1.535-4.682-11.089 3.686-1.553z"})]}),x.jsxs("g",{fill:"currentColor",transform:"translate(-12,-12)",children:[x.jsx("path",{d:"m19.751 24.4155-1.844.774-3.1-7.374 1.841-.775z"}),x.jsx("path",{d:"m13 10.814v11.188l2.969-2.866.428-.139h4.768z"})]})]})}function a8t(){return x.jsx("path",{id:"cursor_hint",fill:"currentColor",d:"M -2,-5 2,0 -2,5 Z"})}function c8t({id:n}){const e=ot(),[t,r]=y.useState(null),i=_t("is in root",()=>{const o=e.getShape(n);return(o==null?void 0:o.parentId)===e.getCurrentPageId()},[e,n]);return y.useEffect(()=>{if(!i)return;let o=null;const s=Zy("shape to svg",async()=>{const a=Math.random();o=a;const l=e.isShapeOfType(n,"frame")?0:10;let u=e.getShapePageBounds(n);if(!u)return;u=u.clone().expandBy(l);const d=await e.getSvgString([n],{padding:l,background:e.getInstanceState().exportBackground});if(o!==a||!d)return;const h=`data:image/svg+xml;utf8,${encodeURIComponent(d.svg)}`;r({src:h,bounds:u})});return()=>{o=null,s()}},[e,n,i]),!i||!t?null:x.jsx("img",{src:t.src,width:t.bounds.width,height:t.bounds.height,referrerPolicy:"no-referrer",style:{position:"absolute",top:0,left:0,transform:`translate(${t.bounds.x}px, ${t.bounds.maxY+12}px)`,outline:"1px solid black",maxWidth:"none"}})}function l8t(){const n=ot(),e=_t("selection rotation",()=>n.getSelectionRotation(),[n]),t=_t("selection bounds",()=>n.getSelectionRotatedPageBounds(),[n]),{SelectionForeground:r}=hs();return!t||!r?null:x.jsx(r,{bounds:t,rotation:e})}function u8t(){const n=ot(),e=_t("selection rotation",()=>n.getSelectionRotation(),[n]),t=_t("selection bounds",()=>n.getSelectionRotatedPageBounds(),[n]),{SelectionBackground:r}=hs();return!t||!r?null:x.jsx(r,{bounds:t,rotation:e})}function d8t(){const{OnTheCanvas:n}=hs();return n?x.jsx(n,{}):null}function h8t(){const n=ot(),e=_t("camera state",()=>n.getCameraState(),[n]);return x.jsx("div",{className:Ue("tl-hit-test-blocker",{"tl-hit-test-blocker__hidden":e==="idle"})})}function f8t({className:n,zoom:e,point:t,color:r,viewport:i,opacity:o=1}){const s=y.useRef(null);return gE(s,Ja(t.x,i.minX+5/e,i.maxX-5/e),Ja(t.y,i.minY+5/e,i.maxY-5/e),1/e,H.Angle(i.center,t)),x.jsxs("svg",{ref:s,className:Ue("tl-overlays__item",n),children:[x.jsx("use",{href:"#cursor_hint",color:r,strokeWidth:3,stroke:"var(--color-background)"}),x.jsx("use",{href:"#cursor_hint",color:r,opacity:o})]})}const Sbe=y.memo(function({className:e,zoom:t,point:r,color:i,name:o,chatMessage:s}){const a=y.useRef(null);return gE(a,r==null?void 0:r.x,r==null?void 0:r.y,1/t),r?x.jsxs("div",{ref:a,className:Ue("tl-overlays__item",e),children:[x.jsx("svg",{className:"tl-cursor",children:x.jsx("use",{href:"#cursor",color:i})}),s?x.jsxs(x.Fragment,{children:[o&&x.jsx("div",{className:"tl-nametag-title",style:{color:i},children:o}),x.jsx("div",{className:"tl-nametag-chat",style:{backgroundColor:i},children:s})]}):o&&x.jsx("div",{className:"tl-nametag",style:{backgroundColor:i},children:o})]}):null});function p8t({x:n,y:e,z:t,size:r}){const i=ot(),{gridSteps:o}=i.options;return x.jsxs("svg",{className:"tl-grid",version:"1.1",xmlns:"http://www.w3.org/2000/svg",children:[x.jsx("defs",{children:o.map(({min:s,mid:a,step:c},l)=>{const u=c*r*t,d=.5+n*t,h=.5+e*t,f=d>0?d%u:u+d%u,p=h>0?h%u:u+h%u,g=t<a?ix(t,[s,a],[0,1]):1;return x.jsx("pattern",{id:`grid-${c}`,width:u,height:u,patternUnits:"userSpaceOnUse",children:x.jsx("circle",{className:"tl-grid-dot",cx:f,cy:p,r:1,opacity:g})},`grid-pattern-${l}`)})}),o.map(({step:s},a)=>x.jsx("rect",{width:"100%",height:"100%",fill:`url(#grid-${s})`},`grid-rect-${a}`))]})}function g8t({handle:n,isCoarse:e,className:t,zoom:r}){const i=ot(),o=(e?i.options.coarseHandleRadius:i.options.handleRadius)/r;if(n.type==="clone"){const a=3/r,c=`M0,${-a} A${a},${a} 0 0,1 0,${a}`,l=gMt.indexOf(n.id);return x.jsxs("g",{className:Ue(`tl-handle tl-handle__${n.type}`,t),children:[x.jsx("circle",{className:"tl-handle__bg",r:o}),x.jsx("path",{className:"tl-handle__fg",d:c,transform:`rotate(${-90+90*l})`})]})}const s=(n.type==="create"&&e?3:4)/Math.max(r,.25);return x.jsxs("g",{className:Ue(`tl-handle tl-handle__${n.type}`,t),children:[x.jsx("circle",{className:"tl-handle__bg",r:o}),x.jsx("circle",{className:"tl-handle__fg",r:s})]})}const m8t=({children:n})=>x.jsx("svg",{className:"tl-user-handles tl-overlays__item",children:n}),v8t=()=>{const{Spinner:n}=hs();return x.jsx(Pie,{children:n?x.jsx(n,{}):null})};function pie(n,e=!0){const t=n.length;if(t<2)return"";let r=n[0],i=n[1];if(t===2)return`M${Di(r)}L${Di(i)}`;let o="";for(let s=2,a=t-1;s<a;s++)r=n[s],i=n[s+1],o+=Du(r,i);return e?`M${Du(n[0],n[1])}Q${Di(n[1])}${Du(n[1],n[2])}T${o}${Du(n[t-1],n[0])}${Du(n[0],n[1])}Z`:`M${Di(n[0])}Q${Di(n[1])}${Du(n[1],n[2])}${n.length>3?"T":""}${o}L${Di(n[t-1])}`}function _be({scribble:n,zoom:e,color:t,opacity:r,className:i}){return n.points.length?x.jsx("svg",{className:i&&Ue("tl-overlays__item",i),children:x.jsx("path",{className:"tl-scribble",d:pie(n.points,!1),stroke:t??`var(--color-${n.color})`,fill:"none",strokeWidth:8/e,opacity:r??n.opacity})}):null}function u$e({bounds:n,rotation:e}){const t=y.useRef(null);return gE(t,n.x,n.y,1,e),y.useLayoutEffect(()=>{const r=t.current;r&&(r.style.width=et(Math.max(1,n.width))+"px",r.style.height=et(Math.max(1,n.height))+"px")},[n.width,n.height]),x.jsx("div",{ref:t,className:"tl-selection__bg",draggable:!1})}function y8t({bounds:n,rotation:e}){const t=ot(),r=y.useRef(null),i=_t("only selected shape",()=>t.getOnlySelectedShape(),[t]),o=i?t.getShapeUtil(i).expandSelectionOutlinePx(i):0;return gE(r,n==null?void 0:n.x,n==null?void 0:n.y,1,e,{x:-o,y:-o}),n=n.clone().expandBy(o).zeroFix(),x.jsx("svg",{ref:r,className:"tl-overlays__item tl-selection__fg","data-testid":"selection-foreground",children:x.jsx("rect",{className:Ue("tl-selection__fg__outline"),width:et(n.width),height:et(n.height)})})}const b8t=()=>x.jsx("div",{className:"tl-shape-error-boundary"}),S8t=({shape:n,util:e})=>xN("Indicator: "+n.type,()=>e.indicator(e.editor.store.unsafeGetWithoutCapture(n.id))),_8t=({editor:n,id:e})=>{const t=_t("shape for indicator",()=>n.store.get(e),[n,e]),{ShapeIndicatorErrorFallback:r}=hs();return!t||t.isLocked?null:x.jsx(V3,{fallback:r,onError:i=>n.annotateError(i,{origin:"react.shapeIndicator",willCrashApp:!1}),children:x.jsx(S8t,{shape:t,util:n.getShapeUtil(t)},t.id)})},wbe=y.memo(function({shapeId:e,className:t,color:r,hidden:i,opacity:o}){const s=ot(),a=y.useRef(null);return oy("indicator transform",()=>{const c=a.current;if(!c)return;const l=s.getShapePageTransform(e);l&&c.style.setProperty("transform",l.toCssString())},[s,e]),y.useLayoutEffect(()=>{const c=a.current;c&&c.style.setProperty("display",i?"none":"block")},[i]),x.jsx("svg",{ref:a,className:Ue("tl-overlays__item",t),children:x.jsx("g",{className:"tl-shape-indicator",stroke:r??"var(--color-selected)",opacity:o,children:x.jsx(_8t,{editor:s,id:e})})})}),w8t=()=>x.jsx("circle",{cx:4,cy:4,r:8,strokeWidth:"1",stroke:"red"});function C8t({points:n,zoom:e}){const t=2.5/e,r=n.reduce((h,f)=>Math.min(h,f.x),1/0),i=n.reduce((h,f)=>Math.max(h,f.x),-1/0),o=n.reduce((h,f)=>Math.min(h,f.y),1/0),s=n.reduce((h,f)=>Math.max(h,f.y),-1/0),a=n.some(h=>h.x===r&&h.y===o);let c,l,u,d;return a?(c=r,l=o,u=i,d=s):(c=r,l=s,u=i,d=o),x.jsxs("g",{className:"tl-snap-indicator",stroke:"lime",children:[x.jsx("line",{x1:c,y1:l,x2:u,y2:d}),n.map((h,f)=>x.jsx("g",{transform:`translate(${h.x},${h.y})`,children:x.jsx("path",{className:"tl-snap-point",d:`M ${-t},${-t} L ${t},${t} M ${-t},${t} L ${t},${-t}`})},f))]})}function x8t({gaps:n,direction:e,zoom:t}){const r=3.5/t;let i=[-1/0,1/0],o=null;const s=e==="horizontal";for(const c of n){if(o=Cf(i[0],i[1],s?c.startEdge[0].y:c.startEdge[0].x,s?c.startEdge[1].y:c.startEdge[1].x),o)i=o;else continue;if(o=Cf(i[0],i[1],s?c.endEdge[0].y:c.endEdge[0].x,s?c.endEdge[1].y:c.endEdge[1].x),o)i=o;else continue}if(i===null)return null;const a=(i[0]+i[1])/2;return x.jsx("g",{className:"tl-snap-indicator",stroke:"cyan",children:n.map(({startEdge:c,endEdge:l},u)=>x.jsx(y.Fragment,{children:s?x.jsxs(x.Fragment,{children:[x.jsx("line",{x1:c[0].x,y1:a-2*r,x2:c[1].x,y2:a+2*r}),x.jsx("line",{x1:l[0].x,y1:a-2*r,x2:l[1].x,y2:a+2*r}),x.jsx("line",{x1:c[0].x,y1:a,x2:l[0].x,y2:a}),x.jsx("line",{x1:(c[0].x+l[0].x)/2,y1:a-r,x2:(c[0].x+l[0].x)/2,y2:a+r})]}):x.jsxs(x.Fragment,{children:[x.jsx("line",{x1:a-2*r,y1:c[0].y,x2:a+2*r,y2:c[1].y}),x.jsx("line",{x1:a-2*r,y1:l[0].y,x2:a+2*r,y2:l[1].y}),x.jsx("line",{x1:a,y1:c[0].y,x2:a,y2:l[0].y}),x.jsx("line",{x1:a-r,y1:(c[0].y+l[0].y)/2,x2:a+r,y2:(c[0].y+l[0].y)/2})]})},u))})}function E8t({className:n,line:e,zoom:t}){return x.jsx("svg",{className:Ue("tl-overlays__item",n),children:e.type==="points"?x.jsx(C8t,{...e,zoom:t}):e.type==="gaps"?x.jsx(x8t,{...e,zoom:t}):null})}function gie(){return x.jsx("svg",{width:16,height:16,viewBox:"0 0 16 16",children:x.jsxs("g",{strokeWidth:2,fill:"none",fillRule:"evenodd",children:[x.jsx("circle",{strokeOpacity:.25,cx:8,cy:8,r:7,stroke:"currentColor"}),x.jsx("path",{strokeLinecap:"round",d:"M15 8c0-4.5-4.5-7-7-7",stroke:"currentColor",children:x.jsx("animateTransform",{attributeName:"transform",type:"rotate",from:"0 8 8",to:"360 8 8",dur:"1s",repeatCount:"indefinite"})})]})})}const I8t=()=>null;function d$e(n,e){const t=y.useRef(n);return e(n,t.current)?t.current:(t.current=n,n)}function pk(n){return d$e(n,KAt)}function mie(n){return d$e(n,O6e)}const h$e=y.createContext(null);function P8t({overrides:n={},children:e}){const t=mie(n);return x.jsx(h$e.Provider,{value:y.useMemo(()=>({Background:cMt,SvgDefs:I8t,Brush:IU,ZoomBrush:IU,CollaboratorBrush:IU,Cursor:Sbe,CollaboratorCursor:Sbe,CollaboratorHint:f8t,CollaboratorShapeIndicator:wbe,Grid:p8t,Scribble:_be,SnapIndicator:E8t,Handles:m8t,Handle:g8t,CollaboratorScribble:_be,ErrorFallback:p$e,ShapeErrorFallback:b8t,ShapeIndicatorErrorFallback:w8t,Spinner:gie,SelectionBackground:u$e,SelectionForeground:y8t,ShapeIndicator:wbe,OnTheCanvas:null,InFrontOfTheCanvas:null,Canvas:q6t,LoadingScreen:v8t,...t}),[t]),children:e})}function hs(){const n=y.useContext(h$e);if(!n)throw new Error("useEditorComponents must be used inside of <EditorComponentsProvider />");return n}const vie={openWindow:(n,e)=>window.open(n,e,"noopener noreferrer"),refreshPage:()=>window.location.reload(),hardReset:async()=>{var n;return await((n=window.__tldraw__hardReset)==null?void 0:n.call(window))}};function f$e(){vie.hardReset()}function k8t(){vie.refreshPage()}const T8t="https://github.com/tldraw/tldraw/issues/new",p$e=({error:n,editor:e})=>{const t=y.useRef(null),[r,i]=y.useState(!1),[o,s]=y.useState(!1),[a,c]=y.useState(!1);let l=null;try{l=hs().Canvas??null}catch{}const u=n instanceof Error?n.message:String(n),d=n instanceof Error?n.stack:null,h=_t("isDarkMode",()=>{try{if(e)return e.user.getIsDarkMode()}catch{}return null},[e]),[f,p]=y.useState(null);y.useLayoutEffect(()=>{var w;h!==null&&p(h);let S=(w=t.current)==null?void 0:w.parentElement,E=!1;for(;S;){if(S.classList.contains("tl-theme__dark")||S.classList.contains("tl-theme__light")){E=!0;break}S=S.parentElement}if(E){p(null);return}p(window.matchMedia("(prefers-color-scheme: dark)").matches)},[h]),y.useEffect(()=>{if(o){const S=e==null?void 0:e.timers.setTimeout(()=>{s(!1)},2e3);return()=>clearTimeout(S)}},[o,e]);const g=()=>{const S=document.createElement("textarea");S.value=d??u,document.body.appendChild(S),S.select(),document.execCommand("copy"),S.remove(),s(!0)},m=()=>{k8t()},v=async()=>{f$e()},b=new URL(T8t);return b.searchParams.set("title",u),b.searchParams.set("labels","bug"),b.searchParams.set("body",`Hey, I ran into an error while using tldraw:

\`\`\`js
${d??u}
\`\`\`

My browser: ${navigator.userAgent}`),x.jsxs("div",{ref:t,className:Ue("tl-container tl-error-boundary",f===null?"":f?"tl-theme__dark":"tl-theme__light"),children:[x.jsx("div",{className:"tl-error-boundary__overlay"}),e&&x.jsx(z8e,{onError:W8,fallback:()=>null,children:x.jsx(TN.Provider,{value:e,children:x.jsx("div",{className:"tl-overlay tl-error-boundary__canvas",children:l?x.jsx(l,{}):null})})}),x.jsx("div",{className:Ue("tl-modal","tl-error-boundary__content",{"tl-error-boundary__content__expanded":r&&!a}),children:a?x.jsxs(x.Fragment,{children:[x.jsx("h2",{children:"Are you sure?"}),x.jsx("p",{children:"Resetting your data will delete your drawing and cannot be undone."}),x.jsxs("div",{className:"tl-error-boundary__content__actions",children:[x.jsx("button",{onClick:()=>c(!1),children:"Cancel"}),x.jsx("button",{className:"tl-error-boundary__reset",onClick:v,children:"Reset data"})]})]}):x.jsxs(x.Fragment,{children:[x.jsx("h2",{children:"Something's gone wrong."}),x.jsxs("p",{children:["Sorry, we encountered an error. Please refresh the page to continue. If you keep seeing this error, you can ",x.jsx("a",{href:b.toString(),children:"create a GitHub issue"})," or"," ",x.jsx("a",{href:"https://discord.gg/Cq6cPsTfNy",children:"ask for help on Discord"}),"."]}),r&&x.jsxs(x.Fragment,{children:["Message:",x.jsx("h4",{children:x.jsx("code",{children:u})}),"Stack trace:",x.jsxs("div",{className:"tl-error-boundary__content__error",children:[x.jsx("pre",{children:x.jsx("code",{children:d??u})}),x.jsx("button",{onClick:g,children:o?"Copied!":"Copy"})]})]}),x.jsxs("div",{className:"tl-error-boundary__content__actions",children:[x.jsx("button",{onClick:()=>i(!r),children:r?"Hide details":"Show details"}),x.jsxs("div",{className:"tl-error-boundary__content__actions__group",children:[x.jsx("button",{className:"tl-error-boundary__reset",onClick:()=>c(!0),children:"Reset data"}),x.jsx("button",{className:"tl-error-boundary__refresh",onClick:m,children:"Refresh Page"})]})]})]})})]})};let D8t=(n=21)=>crypto.getRandomValues(new Uint8Array(n)).reduce((e,t)=>(t&=63,t<36?e+=t.toString(36):t<62?e+=(t-26).toString(36).toUpperCase():t>62?e+="-":e+="_",e),"");function us(){return D8t()}const g$e="TLDRAW_USER_DATA_v3",m$e=oi({id:$r,name:$r.nullable().optional(),locale:$r.nullable().optional(),color:$r.nullable().optional(),colorScheme:PN("light","dark","system").optional(),animationSpeed:cr.nullable().optional(),edgeScrollSpeed:cr.nullable().optional(),isSnapMode:Si.nullable().optional(),isWrapMode:Si.nullable().optional(),isDynamicSizeMode:Si.nullable().optional()}),o0={AddAnimationSpeed:1,AddIsSnapMode:2,MakeFieldsNullable:3,AddEdgeScrollSpeed:4,AddExcalidrawSelectMode:5,AddDynamicSizeMode:6,AllowSystemColorScheme:7},yie=Math.max(...Object.values(o0));function R8t(n){n.version<o0.AddAnimationSpeed&&(n.user.animationSpeed=1),n.version<o0.AddIsSnapMode&&(n.user.isSnapMode=!1),n.version<o0.MakeFieldsNullable,n.version<o0.AddEdgeScrollSpeed&&(n.user.edgeScrollSpeed=1),n.version<o0.AddExcalidrawSelectMode&&(n.user.isWrapMode=!1),n.version<o0.AllowSystemColorScheme&&(n.user.isDarkMode===!0?n.user.colorScheme="dark":n.user.isDarkMode===!1&&(n.user.colorScheme="light"),delete n.user.isDarkMode),n.version<o0.AddDynamicSizeMode&&(n.user.isDynamicSizeMode=!1),n.version=yie}const Cbe=["#FF802B","#EC5E41","#F2555A","#F04F88","#E34BA9","#BD54C6","#9D5BD2","#7B66DC","#02B1CC","#11B3A3","#39B178","#55B467"];function A8t(){return Cbe[Math.floor(Math.random()*Cbe.length)]}function O8t(){var n,e;return typeof window>"u"?!1:((e=(n=window.matchMedia)==null?void 0:n.call(window,"(prefers-reduced-motion: reduce)"))==null?void 0:e.matches)??!1}const Yv=Object.freeze({name:"New User",locale:iMt(),color:A8t(),edgeScrollSpeed:1,animationSpeed:O8t()?0:1,isSnapMode:!1,isWrapMode:!1,isDynamicSizeMode:!1});function RU(){return{id:us()}}function v$e(n){if(n===null||typeof n!="object"||!("version"in n)||!("user"in n)||typeof n.version!="number")return RU();const e=ls(n);R8t(e);try{return m$e.validate(e.user)}catch{return RU()}}function M8t(){const n=JSON.parse(Xre(g$e)||"null")??null;return v$e(n)}const W3=lc("globalUserData",null);function $8t(){Yre(g$e,JSON.stringify({version:yie,user:W3.get()}))}function L8t(n){m$e.validate(n),W3.set(n),$8t(),F8t()}const N8t=typeof process<"u"&&!1,KC=typeof BroadcastChannel<"u"&&!N8t?new BroadcastChannel("tldraw-user-sync"):null;KC==null||KC.addEventListener("message",n=>{const e=n.data;(e==null?void 0:e.type)===b$e&&(e==null?void 0:e.origin)!==y$e()&&W3.set(v$e(e.data))});let AU=null;function y$e(){return AU===null&&(AU=us()),AU}const b$e="tldraw-user-preferences-change";function F8t(){KC==null||KC.postMessage({type:b$e,origin:y$e(),data:{user:S$e(),version:yie}})}function S$e(){let n=W3.get();return n||(n=M8t(),W3.set(n)),n}function _$e(n={}){return{derivePresenceState:n.derivePresenceState??(()=>Et("presence",()=>null)),userPreferences:n.userPreferences??Et("userPreferences",()=>S$e()),setUserPreferences:n.setUserPreferences??L8t}}var w$e={exports:{}};(function(n){var e=Object.prototype.hasOwnProperty,t="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(t=!1));function i(c,l,u){this.fn=c,this.context=l,this.once=u||!1}function o(c,l,u,d,h){if(typeof u!="function")throw new TypeError("The listener must be a function");var f=new i(u,d||c,h),p=t?t+l:l;return c._events[p]?c._events[p].fn?c._events[p]=[c._events[p],f]:c._events[p].push(f):(c._events[p]=f,c._eventsCount++),c}function s(c,l){--c._eventsCount===0?c._events=new r:delete c._events[l]}function a(){this._events=new r,this._eventsCount=0}a.prototype.eventNames=function(){var l=[],u,d;if(this._eventsCount===0)return l;for(d in u=this._events)e.call(u,d)&&l.push(t?d.slice(1):d);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(u)):l},a.prototype.listeners=function(l){var u=t?t+l:l,d=this._events[u];if(!d)return[];if(d.fn)return[d.fn];for(var h=0,f=d.length,p=new Array(f);h<f;h++)p[h]=d[h].fn;return p},a.prototype.listenerCount=function(l){var u=t?t+l:l,d=this._events[u];return d?d.fn?1:d.length:0},a.prototype.emit=function(l,u,d,h,f,p){var g=t?t+l:l;if(!this._events[g])return!1;var m=this._events[g],v=arguments.length,b,S;if(m.fn){switch(m.once&&this.removeListener(l,m.fn,void 0,!0),v){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,u),!0;case 3:return m.fn.call(m.context,u,d),!0;case 4:return m.fn.call(m.context,u,d,h),!0;case 5:return m.fn.call(m.context,u,d,h,f),!0;case 6:return m.fn.call(m.context,u,d,h,f,p),!0}for(S=1,b=new Array(v-1);S<v;S++)b[S-1]=arguments[S];m.fn.apply(m.context,b)}else{var E=m.length,w;for(S=0;S<E;S++)switch(m[S].once&&this.removeListener(l,m[S].fn,void 0,!0),v){case 1:m[S].fn.call(m[S].context);break;case 2:m[S].fn.call(m[S].context,u);break;case 3:m[S].fn.call(m[S].context,u,d);break;case 4:m[S].fn.call(m[S].context,u,d,h);break;default:if(!b)for(w=1,b=new Array(v-1);w<v;w++)b[w-1]=arguments[w];m[S].fn.apply(m[S].context,b)}}return!0},a.prototype.on=function(l,u,d){return o(this,l,u,d,!1)},a.prototype.once=function(l,u,d){return o(this,l,u,d,!0)},a.prototype.removeListener=function(l,u,d,h){var f=t?t+l:l;if(!this._events[f])return this;if(!u)return s(this,f),this;var p=this._events[f];if(p.fn)p.fn===u&&(!h||p.once)&&(!d||p.context===d)&&s(this,f);else{for(var g=0,m=[],v=p.length;g<v;g++)(p[g].fn!==u||h&&!p[g].once||d&&p[g].context!==d)&&m.push(p[g]);m.length?this._events[f]=m.length===1?m[0]:m:s(this,f)}return this},a.prototype.removeAllListeners=function(l){var u;return l?(u=t?t+l:l,this._events[u]&&s(this,u)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=t,a.EventEmitter=a,n.exports=a})(w$e);var j8t=w$e.exports;const B8t=Fy(j8t),GC="TLDRAW_TAB_ID_v2",og=globalThis.window;function H8t(){return og?["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(og.navigator.platform)||og.navigator.userAgent.includes("Mac")&&"ontouchend"in document:!1}const u$=og?og[GC]??F6e(GC)??"TLDRAW_INSTANCE_STATE_V1_"+us():"<error>";og&&(og[GC]=u$,H8t()?Jre(GC,u$):j6e(GC));og==null||og.addEventListener("beforeunload",()=>{Jre(GC,u$)});const C$e={Initial:0},DN=Math.max(...Object.values(C$e));function U8t(n){n.version<C$e.Initial,n.version=DN}const x$e=oi({version:cr,currentPageId:B3,isFocusMode:Si,exportBackground:Si,isDebugMode:Si,isToolLocked:Si,isGridMode:Si,pageStates:Nc(oi({pageId:B3,camera:oi({x:cr,y:cr,z:cr}),selectedShapeIds:Nc(_h),focusedGroupId:_h.nullable()}))});function z8t(n){if(!n||typeof n!="object")return console.warn("Invalid instance state"),null;if(!("version"in n)||typeof n.version!="number")return console.warn("No version in instance state"),null;n.version!==DN&&(n=ls(n),U8t(n));try{return x$e.validate(n)}catch(e){return console.warn(e),null}}function E$e(n){const e=n.query.ids("page");return Et("sessionStateSnapshot",()=>{const t=n.get(fl);if(!t)return null;const r=[...e.get()];return{version:DN,currentPageId:t.currentPageId,exportBackground:t.exportBackground,isFocusMode:t.isFocusMode,isDebugMode:t.isDebugMode,isToolLocked:t.isToolLocked,isGridMode:t.isGridMode,pageStates:r.map(i=>{const o=n.get(Oh.createId(i)),s=n.get(Ff.createId(i));return{pageId:i,camera:{x:(s==null?void 0:s.x)??0,y:(s==null?void 0:s.y)??0,z:(s==null?void 0:s.z)??1},selectedShapeIds:(o==null?void 0:o.selectedShapeIds)??[],focusedGroupId:(o==null?void 0:o.focusedGroupId)??null}})}})}function I$e(n,e){const t=z8t(e);if(!t)return;const r=n.schema.types.instance.create({id:fl,...v8e(n.get(fl)),currentPageId:t.currentPageId,isDebugMode:t.isDebugMode,isFocusMode:t.isFocusMode,isToolLocked:t.isToolLocked,isGridMode:t.isGridMode,exportBackground:t.exportBackground}),i=n.allRecords().filter(o=>o.typeName==="instance_page_state"||o.typeName==="camera");n.atomic(()=>{n.remove(i.map(o=>o.id));for(const o of t.pageStates)n.put([Ff.create({id:Ff.createId(o.pageId),x:o.camera.x,y:o.camera.y,z:o.camera.z}),Oh.create({id:Oh.createId(o.pageId),pageId:o.pageId,selectedShapeIds:o.selectedShapeIds,focusedGroupId:o.focusedGroupId})]);n.put([r]),n.ensureStoreIsUsable()})}function V8t(n){var i;const e=[];for(const o of Object.values(n))(i=o.typeName)!=null&&i.match(/^(instance.*|pointer|camera)$/)&&e.push(o);const t=e.filter(o=>o.typeName==="instance"&&o.id!==fl)[0];if(!t)return null;const r={version:DN,currentPageId:t.currentPageId,exportBackground:!!t.exportBackground,isFocusMode:!!t.isFocusMode,isDebugMode:!!t.isDebugMode,isToolLocked:!!t.isToolLocked,isGridMode:!1,pageStates:e.filter(o=>o.typeName==="instance_page_state"&&o.instanceId===t.id).map(o=>{const s=n[o.cameraId]??{x:0,y:0,z:1};return{pageId:o.pageId,camera:{x:s.x,y:s.y,z:s.z},selectedShapeIds:o.selectedShapeIds,focusedGroupId:o.focusedGroupId}})};try{return x$e.validate(r),r}catch{return null}}function P$e(n,e){let t={};if("store"in e){const i=n.schema.migrateStoreSnapshot(e);if(i.type!=="success")throw new Error("Failed to migrate store snapshot: "+i.reason);t.document={schema:n.schema.serialize(),store:dk(i.value,(o,{typeName:s})=>n.scopedTypes.document.has(s))}}else t=e;const r=v8e(n.get(fl));n.atomic(()=>{t.document&&n.loadStoreSnapshot(t.document),r&&n.update(fl,i=>({...i,...r})),t.session&&I$e(n,t.session)})}const W8t=new uv;function q8t(n){const t=W8t.get(n,E$e).get();if(!t)throw new Error("Session state is not ready yet");return{document:n.getStoreSnapshot(),session:t}}function k$e(n){const e=[],t=new Set;for(const r of n){if(t.has(r.type))throw new Error(`Binding type "${r.type}" is defined more than once`);e.push(r),t.add(r.type)}return e}function ky({children:n,className:e="",...t}){return x.jsx("svg",{...t,className:Ue("tl-svg-container",e),children:n})}function bie(n,e,t,r){const i=n.x-t.x,o=n.y-t.y,s=r.x-t.x,a=r.y-t.y,c=e.x-n.x,l=e.y-n.y,u=s*o-a*i,d=c*o-l*i,h=a*c-s*l;if(u===0||d===0||h===0)return null;if(h!==0){const f=u/h,p=d/h;if(0<=f&&f<=1&&0<=p&&p<=1)return H.AddXY(n,f*c,f*l)}return null}function LD(n,e,t,r){const i=(e.x-n.x)*(e.x-n.x)+(e.y-n.y)*(e.y-n.y),o=2*((e.x-n.x)*(n.x-t.x)+(e.y-n.y)*(n.y-t.y)),s=t.x*t.x+t.y*t.y+n.x*n.x+n.y*n.y-2*(t.x*n.x+t.y*n.y)-r*r,a=o*o-4*i*s;if(a<0||a===0)return null;const c=Math.sqrt(a),l=(-o+c)/(2*i),u=(-o-c)/(2*i);if((l<0||l>1)&&(u<0||u>1))return null;const d=[];return 0<=l&&l<=1&&d.push(H.Lrp(n,e,l)),0<=u&&u<=1&&d.push(H.Lrp(n,e,u)),d.length===0?null:d}function K8t(n,e,t){const r=[];let i;for(let o=0,s=t.length-1;o<s;o++)i=bie(n,e,t[o],t[o+1]),i&&r.push(i);return r.length===0?null:r}function Sie(n,e,t){const r=[];let i;for(let o=1,s=t.length;o<s+1;o++)i=bie(n,e,t[o-1],t[o%t.length]),i&&r.push(i);return r.length===0?null:r}function G8t(n,e,t,r){let i=t.x-n.x,o=t.y-n.y;const s=Math.sqrt(i*i+o*o),a=(s*s-r*r+e*e)/(2*s),c=Math.sqrt(e*e-a*a);return i/=s,o/=s,[new H(n.x+i*a-o*c,n.y+o*a+i*c),new H(n.x+i*a+o*c,n.y+o*a-i*c)]}function sX(n,e,t){const r=[];let i,o,s;for(let a=0,c=t.length;a<c;a++)i=t[a],o=t[(a+1)%t.length],s=LD(i,o,n,e),s&&r.push(...s);return r.length===0?null:r}function xbe(n,e,t){const r=[];let i,o,s;for(let a=1,c=t.length;a<c;a++)i=t[a-1],o=t[a],s=LD(i,o,n,e),s&&r.push(...s);return r.length===0?null:r}function sA(n,e,t){return(t.y-n.y)*(e.x-n.x)>(e.y-n.y)*(t.x-n.x)}function _ie(n,e,t,r){return sA(n,t,r)!==sA(e,t,r)&&sA(n,e,t)!==sA(n,e,r)}function Ebe(n,e){const t=new Map;let r,i,o,s;for(let a=0,c=n.length;a<c;a++)if(r=n[a],Fd(r,e)){const l=OU(r);t.has(l)||t.set(l,r)}for(let a=0,c=e.length;a<c;a++)if(r=e[a],Fd(r,n)){const l=OU(r);t.has(l)||t.set(l,r)}for(let a=0,c=n.length;a<c;a++){r=n[a],i=n[(a+1)%n.length];for(let l=0,u=e.length;l<u;l++){o=e[l],s=e[(l+1)%e.length];const d=bie(r,i,o,s);if(d!==null){const h=OU(d);t.has(h)||t.set(h,d)}}}return t.size===0?null:Z8t([...t.values()])}function OU(n){return`${n.x},${n.y}`}function Z8t(n){const e=H.Average(n);return n.sort((t,r)=>H.Angle(e,t)-H.Angle(e,r))}function T$e(n,e){let t,r,i,o;for(let s=0,a=n.length;s<a;s++){t=n[s],r=n[(s+1)%a];for(let c=0,l=e.length;c<l;c++)if(i=e[c],o=e[(c+1)%l],_ie(t,r,i,o))return!0}return!1}function X8t(n,e){let t,r,i,o;for(let s=0,a=n.length;s<a;s++){t=n[s],r=n[(s+1)%a];for(let c=1,l=e.length;c<l;c++)if(i=e[c-1],o=e[c],_ie(t,r,i,o))return!0}return!1}class Nm extends Xy{constructor(t){super({...t,isClosed:!1,isFilled:!1});$(this,"start");$(this,"end");$(this,"d");$(this,"u");$(this,"ul");const{start:r,end:i}=t;this.start=r,this.end=i,this.d=r.clone().sub(i),this.u=this.d.clone().uni(),this.ul=this.u.len()}getLength(){return this.d.len()}midPoint(){return this.start.lrp(this.end,.5)}getVertices(){return[this.start,this.end]}nearestPoint(t){const{start:r,end:i,u:o,ul:s}=this;if(s===0)return r;const a=H.Sub(t,r).dpr(o)/s,c=r.x+o.x*a;if(c<Math.min(r.x,i.x))return r.x<i.x?r:i;if(c>Math.max(r.x,i.x))return r.x>i.x?r:i;const l=r.y+o.y*a;return l<Math.min(r.y,i.y)?r.y<i.y?r:i:l>Math.max(r.y,i.y)?r.y>i.y?r:i:new H(c,l)}hitTestLineSegment(t,r,i=0){return _ie(t,r,this.start,this.end)||this.distanceToLineSegment(t,r)<=i}getSvgPathData(t=!0){const{start:r,end:i}=this;return`${t?`M${r.toFixed()}`:""} L${i.toFixed()}`}}class mE extends Xy{constructor(t){super({isClosed:!1,isFilled:!1,...t});$(this,"points");$(this,"_segments");const{points:r}=t;this.points=r}get segments(){if(!this._segments){this._segments=[];const{vertices:t}=this;for(let r=0,i=t.length-1;r<i;r++){const o=t[r],s=t[r+1];this._segments.push(new Nm({start:o,end:s}))}this.isClosed&&this._segments.push(new Nm({start:t[t.length-1],end:t[0]}))}return this._segments}getLength(){return this.segments.reduce((t,r)=>t+r.length,0)}getVertices(){return this.points}nearestPoint(t){const{segments:r}=this;let i=this.points[0],o=1/0,s,a;for(let c=0;c<r.length;c++)s=r[c].nearestPoint(t),a=H.Dist2(s,t),a<o&&(i=s,o=a);if(!i)throw Error("nearest point not found");return i}hitTestLineSegment(t,r,i=0){const{segments:o}=this;for(let s=0,a=o.length;s<a;s++)if(o[s].hitTestLineSegment(t,r,i))return!0;return!1}getSvgPathData(){const{vertices:t}=this;return t.length<2?"":t.reduce((r,i,o)=>o===0?`M ${i.x} ${i.y}`:`${r} L ${i.x} ${i.y}`,"")}}class Ys extends mE{constructor(e){super({...e}),this.isClosed=!0}}class hv extends Ys{constructor(t){const{x:r=0,y:i=0,width:o,height:s}=t;super({...t,points:[new H(r,i),new H(r+o,i),new H(r+o,i+s),new H(r,i+s)]});$(this,"x");$(this,"y");$(this,"w");$(this,"h");this.x=r,this.y=i,this.w=o,this.h=s}getBounds(){return new xn(this.x,this.y,this.w,this.h)}getSvgPathData(){const{x:t,y:r,w:i,h:o}=this;return`M${t},${r} h${i} v${o} h-${i}z`}}class qf{constructor(e){$(this,"canSnap",()=>!0);$(this,"canScroll",()=>!1);$(this,"canEdit",()=>!1);$(this,"canResize",()=>!0);$(this,"canEditInReadOnly",()=>!1);$(this,"canCrop",()=>!1);$(this,"canBeLaidOut",()=>!0);$(this,"hideResizeHandles",()=>!1);$(this,"hideRotateHandle",()=>!1);$(this,"hideSelectionBoundsBg",()=>!1);$(this,"hideSelectionBoundsFg",()=>!1);$(this,"isAspectRatioLocked",()=>!1);$(this,"onBeforeCreate");$(this,"onBeforeUpdate");$(this,"onDragShapesOver");$(this,"onDragShapesOut");$(this,"onDropShapesOver");$(this,"onResizeStart");$(this,"onResize");$(this,"onResizeEnd");$(this,"onTranslateStart");$(this,"onTranslate");$(this,"onTranslateEnd");$(this,"onHandleDrag");$(this,"onRotateStart");$(this,"onRotate");$(this,"onRotateEnd");$(this,"onBindingChange");$(this,"onChildrenChange");$(this,"onDoubleClickHandle");$(this,"onDoubleClickEdge");$(this,"onDoubleClick");$(this,"onClick");$(this,"onEditEnd");this.editor=e}canBind(e){return!0}providesBackgroundForChildren(e){return!1}canReceiveNewChildrenOfType(e,t){return!1}canDropShapes(e,t){return!1}expandSelectionOutlinePx(e){return 0}getCanvasSvgDefs(){return[]}getBoundsSnapGeometry(e){return{}}getHandleSnapGeometry(e){return{}}}$(qf,"props"),$(qf,"migrations"),$(qf,"type");function Y8t(n,e,t={}){const{closed:r=!1,snap:i=1,start:o="outset",end:s="outset",lengthRatio:a=2,style:c="dashed"}=t;let l=0,u=0,d=1,h=0,f=0;switch(c){case"dashed":{d=1,l=Math.min(e*a,n/4);break}case"dotted":{d=100,l=e/d;break}default:return{strokeDasharray:"none",strokeDashoffset:"none"}}return r||(o==="outset"?(n+=l/2,f+=l/2):o==="skip"&&(n-=l,f-=l),s==="outset"?n+=l/2:s==="skip"&&(n-=l)),u=Math.floor(n/l/(2*d)),u-=u%i,u<3&&c==="dashed"?n/e<5?(l=n,u=1,h=0):(l=n*.333,h=n*.333):(u=Math.max(u,3),l=n/u/(2*d),r?(f=l/2,h=(n-u*l)/u):h=(n-u*l)/Math.max(1,u-1)),{strokeDasharray:[l,h].join(" "),strokeDashoffset:f.toString()}}function Ibe({bounds:n,className:e}){const t=ot(),r=_t("zoom level",()=>t.getZoomLevel(),[t]);return x.jsx("g",{className:e,pointerEvents:"none",strokeLinecap:"round",strokeLinejoin:"round",children:n.sides.map((i,o)=>{const{strokeDasharray:s,strokeDashoffset:a}=Y8t(i[0].dist(i[1]),1/r,{style:"dashed",lengthRatio:4});return x.jsx("line",{x1:i[0].x,y1:i[0].y,x2:i[1].x,y2:i[1].y,strokeDasharray:s,strokeDashoffset:a},o)})})}class SO extends qf{constructor(){super(...arguments);$(this,"hideSelectionBoundsFg",()=>!0);$(this,"canBind",()=>!1);$(this,"onChildrenChange",t=>{const r=this.editor.getSortedChildIdsForParent(t.id);if(r.length===0){this.editor.getCurrentPageState().focusedGroupId===t.id&&this.editor.popFocusedGroupId(),this.editor.deleteShapes([t.id]);return}else if(r.length===1){this.editor.getCurrentPageState().focusedGroupId===t.id&&this.editor.popFocusedGroupId(),this.editor.reparentShapes(r,t.parentId),this.editor.deleteShapes([t.id]);return}})}getDefaultProps(){return{}}getGeometry(t){const r=this.editor.getSortedChildIdsForParent(t.id);return r.length===0?new hv({width:1,height:1,isFilled:!1}):new Qf({children:r.map(i=>{const o=this.editor.getShape(i),s=this.editor.getShapeGeometry(i),a=this.editor.getShapeLocalTransform(o).applyToPoints(s.vertices);return s.isClosed?new Ys({points:a,isFilled:!0}):new mE({points:a})})})}component(t){const r=this.editor.getErasingShapeIds().includes(t.id),{hintingShapeIds:i}=this.editor.getCurrentPageState(),o=i.length>0&&i.some(c=>c!==t.id&&this.editor.isShapeOfType(this.editor.getShape(c),"group")),s=this.editor.getCurrentPageState().focusedGroupId!==t.id;if(!r&&(s||o))return null;const a=this.editor.getShapeGeometry(t).bounds;return x.jsx(ky,{id:t.id,children:x.jsx(Ibe,{className:"tl-group",bounds:a})})}indicator(t){const r=this.editor.getShapeGeometry(t).bounds;return x.jsx(Ibe,{className:"",bounds:r})}}$(SO,"type","group"),$(SO,"props",T8e),$(SO,"migrations",D8e);const D$e=[SO],J8t=new Set(D$e.map(n=>n.type));function R$e(n){const e=[...D$e],t=new Set;for(const r of n){if(J8t.has(r.type))throw new Error(`Shape type "${r.type}" is a core shapes type and cannot be overridden`);if(t.has(r.type))throw new Error(`Shape type "${r.type}" is defined more than once`);e.push(r),t.add(r.type)}return e}const Q8t={maxShapesPerPage:4e3,maxPages:40,animationMediumMs:320,followChaseViewportSnap:2,doubleClickDurationMs:450,multiClickDurationMs:200,coarseDragDistanceSquared:36,dragDistanceSquared:16,defaultSvgPadding:32,cameraSlideFriction:.09,maxPointsPerDrawShape:500,gridSteps:[{min:-1,mid:.15,step:64},{min:.05,mid:.375,step:16},{min:.15,mid:1,step:4},{min:.7,mid:2.5,step:1}],collaboratorInactiveTimeoutMs:6e4,collaboratorIdleTimeoutMs:3e3,collaboratorCheckIntervalMs:1200,cameraMovingTimeoutMs:64,hitTestMargin:8,edgeScrollDelay:200,edgeScrollEaseDuration:200,edgeScrollSpeed:25,edgeScrollDistance:8,coarsePointerWidth:12,coarseHandleRadius:20,handleRadius:12,longPressDurationMs:500,textShadowLod:.35,adjacentShapeMargin:10,flattenImageBoundsExpand:64,flattenImageBoundsPadding:16};function Pbe(n,e){if(!e)return!1;switch(n.type){case"mixed":return e.type==="mixed";case"shared":return e.type==="shared"&&n.value===e.value;default:throw vl(n)}}class e$t{constructor(e){$(this,"map");this.map=new Map(e)}get(e){return this.map.get(e)}getAsKnownValue(e){const t=this.get(e);if(t&&t.type!=="mixed")return t.value}get size(){return this.map.size}equals(e){if(this.size!==e.size)return!1;const t=new Set;for(const[r,i]of this){if(!Pbe(i,e.get(r)))return!1;t.add(r)}for(const[r,i]of e)if(!t.has(r)&&!Pbe(i,this.get(r)))return!1;return!0}keys(){return this.map.keys()}values(){return this.map.values()}entries(){return this.map.entries()}[Symbol.iterator](){return this.map[Symbol.iterator]()}}class aX extends e$t{set(e,t){this.map.set(e,t)}applyValue(e,t){const r=this.get(e);if(!r){this.set(e,{type:"shared",value:t});return}switch(r.type){case"mixed":return;case"shared":r.value!==t&&this.set(e,{type:"mixed"});return;default:vl(r,"type")}}}function t$t(n,e,t){return vg(n).then(function(r){return r.arrayBuffer()}).then(function(r){return new File([r],e,{type:t})})}function n$t(n,e){var i;let t=n;const r=new Set(e);for(;r.has(t);)t=(i=/^.*(\d+)$/.exec(t))!=null&&i[1]?t.replace(/(\d+)(?=\D?)$/,o=>(+o+1).toString()):`${t} 1`;return t}function aA(n,e,t){if(t.length===0)return[];const r=new Map;for(const o of qr(t.map(s=>n.getShape(s)))){const{parentId:s}=o;r.has(s)||r.set(s,{children:qr(n.getSortedChildIdsForParent(s).map(a=>n.getShape(a))),moving:new Set}),r.get(s).moving.add(o)}const i=[];switch(e){case"toBack":{r.forEach(({moving:o,children:s})=>r$t(o,s,i));break}case"toFront":{r.forEach(({moving:o,children:s})=>i$t(o,s,i));break}case"forward":{r.forEach(({moving:o,children:s})=>o$t(o,s,i));break}case"backward":{r.forEach(({moving:o,children:s})=>s$t(o,s,i));break}}return i}function r$t(n,e,t){const r=e.length;if(n.size===r)return;let i,o;for(let s=0;s<r;s++){const a=e[s];if(n.has(a))i=a.index,n.delete(a);else{o=a.index;break}}if(n.size!==0){const s=ox(i,o,n.size);t.push(...Array.from(n.values()).sort(ml).map((a,c)=>({...a,index:s[c]})))}}function i$t(n,e,t){const r=e.length;if(n.size===r)return;let i,o;for(let s=r-1;s>-1;s--){const a=e[s];if(n.has(a))o=a.index,n.delete(a);else{i=a.index;break}}if(n.size!==0){const s=ox(i,o,n.size);t.push(...Array.from(n.values()).sort(ml).map((a,c)=>({...a,index:s[c]})))}}function o$t(n,e,t){var o;const r=e.length;if(n.size===r)return;let i={name:"skipping"};for(let s=0;s<r;s++){const a=n.has(e[s]);switch(i.name){case"skipping":{if(!a)continue;i={name:"selecting",selectIndex:s};break}case"selecting":{if(a)continue;const{selectIndex:c}=i;ox(e[s].index,(o=e[s+1])==null?void 0:o.index,s-c).forEach((l,u)=>t.push({...e[c+u],index:l})),i={name:"skipping"};break}}}}function s$t(n,e,t){var o;const r=e.length;if(n.size===r)return;let i={name:"skipping"};for(let s=r-1;s>-1;s--){const a=n.has(e[s]);switch(i.name){case"skipping":{if(!a)continue;i={name:"selecting",selectIndex:s};break}case"selecting":{if(a)continue;ox((o=e[s-1])==null?void 0:o.index,e[s].index,i.selectIndex-s).forEach((c,l)=>{t.push({...e[s+l+1],index:c})}),i={name:"skipping"};break}}}}function A$e({editor:n}){const e=n.getSelectedShapes(),t=n.getSelectionRotation(),r=n.getSelectionRotatedPageBounds(),{inputs:{originPagePoint:i}}=n;if(!r)return null;const o=r.center.clone().rotWith(r.point,t);return{selectionPageCenter:o,initialCursorAngle:o.angle(i),initialSelectionRotation:t,shapeSnapshots:e.map(s=>({shape:ls(s),initialPagePoint:n.getShapePageTransform(s.id).point()}))}}function _O({delta:n,editor:e,snapshot:t,stage:r}){const{selectionPageCenter:i,shapeSnapshots:o}=t;e.updateShapes(o.map(({shape:a,initialPagePoint:c})=>{const l=ku(a.parentId)?e.getShapePageTransform(a.parentId):Mn.Identity(),u=H.RotWith(c,i,n),d=Mn.applyToPoint(Mn.Inverse(l),u),h=ay(a.rotation+n);return{id:a.id,type:a.type,x:d.x,y:d.y,rotation:h}}));const s=[];o.forEach(({shape:a})=>{var d,h,f;const c=e.getShape(a.id);if(!c)return;const l=e.getShapeUtil(a);if(r==="start"||r==="one-off"){const p=(d=l.onRotateStart)==null?void 0:d.call(l,a);p&&s.push(p)}const u=(h=l.onRotate)==null?void 0:h.call(l,a,c);if(u&&s.push(u),r==="end"||r==="one-off"){const p=(f=l.onRotateEnd)==null?void 0:f.call(l,a,c);p&&s.push(p)}}),s.length>0&&e.updateShapes(s)}const a$t=n=>{const{store:e}=n,t=e.query.filterHistory("binding"),r=e.query.records("binding");function i(){const o=r.get(),s=new Map;for(const a of o){const{fromId:c,toId:l}=a,u=s.get(c);u?u.push(a):s.set(c,[a]);const d=s.get(l);d?d.push(a):s.set(l,[a])}return s}return Et("arrowBindingsIndex",(o,s)=>{if(hS(o))return i();const a=o,c=t.getDiffSince(s);if(c===Ld)return i();let l;function u(f){l??(l=new Map(a));const p=l.get(f.fromId),g=p==null?void 0:p.filter(b=>b.id!==f.id);g!=null&&g.length?l.set(f.fromId,g):l.delete(f.fromId);const m=l.get(f.toId),v=m==null?void 0:m.filter(b=>b.id!==f.id);v!=null&&v.length?l.set(f.toId,v):l.delete(f.toId)}function d(f){l??(l=new Map(a));let p=l.get(f);return p?p===a.get(f)&&(p=p.slice(0),l.set(f,p)):(p=[],l.set(f,p)),p}function h(f){d(f.fromId).push(f),d(f.toId).push(f)}for(const f of c){for(const p of Rs(f.added))h(p);for(const[p,g]of Rs(f.updated))u(p),h(g);for(const p of Rs(f.removed))u(p)}return l??a})};function c$t(n,e,t){const r=n.getShapeMaskedPageBounds(e);return r===void 0?!0:!t.includes(r)}const l$t=n=>{function e(t){const r=t.getCurrentPageShapeIds(),i=t.getViewportPageBounds(),o=new Set;return r.forEach(s=>{c$t(t,s,i)&&o.add(s)}),o}return Et("getCulledShapes",t=>{if(hS(t))return e(n);const r=e(n);if(t.size!==r.size)return r;for(const i of t)if(!r.has(i))return r;return t})},u$t=n=>{const e=n.query.ids("shape"),t=n.query.filterHistory("shape");function r(){const i={},o=e.get(),s=Array(o.size);return o.forEach(a=>s.push(n.get(a))),s.sort(ml),s.forEach(a=>{i[a.parentId]||(i[a.parentId]=[]),i[a.parentId].push(a.id)}),i}return Et("parentsToChildrenWithIndexes",(i,o)=>{if(hS(i))return r();const s=t.getDiffSince(o);if(s===Ld)return r();if(s.length===0)return i;let a=null;const c=d=>{a||(a={...i}),a[d]?a[d]===i[d]&&(a[d]=[...a[d]]):a[d]=[]},l=new Set;let u;for(let d=0,h=s.length;d<h;d++){u=s[d];for(const f of Object.values(u.added))aC(f)&&(c(f.parentId),a[f.parentId].push(f.id),l.add(a[f.parentId]));for(const[f,p]of Object.values(u.updated))if(aC(p)&&aC(f)){if(f.parentId!==p.parentId)c(f.parentId),c(p.parentId),a[f.parentId].splice(a[f.parentId].indexOf(p.id),1),a[p.parentId].push(p.id),l.add(a[p.parentId]);else if(f.index!==p.index){c(p.parentId);const g=a[p.parentId].indexOf(p.id);a[p.parentId][g]=p.id,l.add(a[p.parentId])}}for(const f of Object.values(u.removed))aC(f)&&(c(f.parentId),a[f.parentId].splice(a[f.parentId].indexOf(f.id),1))}for(const d of l){const h=qr(d.map(f=>n.get(f)));h.sort(ml),d.splice(0,d.length,...h.map(f=>f.id))}return a??i})},MU=(n,e,t)=>{for(;!Cu(t.parentId);){const r=n.get(t.parentId);if(!r)return!1;t=r}return t.parentId===e},d$t=(n,e)=>{const t=n.query.ids("shape");let r=null;function i(){const o=e();return r=o,new Set([...t.get()].filter(s=>MU(n,o,n.get(s))))}return Et("_shapeIdsInCurrentPage",(o,s)=>{if(hS(o))return i();const a=e();if(a!==r)return i();const c=n.history.getDiffSince(s);if(c===Ld)return i();const l=new gO(o);for(const d of c){for(const h of Object.values(d.added))aC(h)&&MU(n,a,h)&&l.add(h.id);for(const[h,f]of Object.values(d.updated))aC(f)&&(MU(n,a,f)?l.add(f.id):l.remove(f.id));for(const h of Object.keys(d.removed))ku(h)&&l.remove(h)}const u=l.get();return u?vP(u.value,u.diff):o})},O$e=y.createContext(null);function h$t({context:n,editor:e,children:t}){return x.jsx(TN.Provider,{value:e,children:x.jsx(O$e.Provider,{value:n,children:t})})}function M$e(){const n=y.useContext(O$e);return n?{isDarkMode:n.isDarkMode}:null}async function f$t(n,e,t={}){var w,C;const r=typeof e[0]=="string"?e:e.map(I=>I.id);if(r.length===0)return;if(!window.document)throw Error("No document");const{scale:i=1,background:o=!1,padding:s=n.options.defaultSvgPadding,preserveAspectRatio:a=!1}=t,c=t.darkMode??n.user.getIsDarkMode(),l=xv({isDarkMode:c}),u=n.getShapeAndDescendantIds(r),d=n.getUnorderedRenderingShapes(!1).filter(({id:I})=>u.has(I));let h=null;if(t.bounds)h=t.bounds;else for(const{id:I}of d){const T=n.getShapeMaskedPageBounds(I);T&&(h?h.union(T):h=T.clone())}if(!h)return;const f=r.length===1&&n.isShapeOfType(n.getShape(r[0]),"frame")?r[0]:null;f||h.expandBy(s);const p=h.width*i,g=h.height*i;try{(C=(w=document.body).focus)==null||C.call(w)}catch{}const m=[],v=new Map,b={isDarkMode:c,addExportDef:I=>{if(v.has(I.key))return;const T=(async()=>{const D=await I.getElement();D&&m.push(x.jsx(y.Fragment,{children:D},m.length))})();v.set(I.key,T)}},S=(await Promise.all(d.map(async({id:I,opacity:T,index:D,backgroundIndex:O})=>{var B,U;if(I===f)return[];const M=n.getShape(I);if(n.isShapeOfType(M,"group"))return[];const R=n.getShapeUtil(M);let A=await((B=R.toSvg)==null?void 0:B.call(R,M,b)),k=await((U=R.toBackgroundSvg)==null?void 0:U.call(R,M,b));if(!A&&!k){const K=n.getShapePageBounds(M);A=x.jsx("rect",{width:K.w,height:K.h,fill:l.solid,stroke:l.grey.pattern,strokeWidth:1})}let L=n.getShapePageTransform(M).toCssString();"scale"in M.props&&M.props.scale!==1&&(L=`${L} scale(${M.props.scale}, ${M.props.scale})`),A&&(A=x.jsx("g",{transform:L,opacity:T,children:A},M.id)),k&&(k=x.jsx("g",{transform:L,opacity:T,children:k},`bg_${M.id}`));const j=n.getShapeMask(M.id);if(j){const K=`mask_${M.id.replace(":","_")}`;m.push(x.jsx("clipPath",{id:K,children:x.jsx("path",{d:`M${j.map(({x:z,y:G})=>`${z},${G}`).join("L")}Z`})},m.length)),A&&(A=x.jsx("g",{clipPath:`url(#${K})`,children:A},M.id)),k&&(k=x.jsx("g",{clipPath:`url(#${K})`,children:k},`bg_${M.id}`))}const N=[];return A&&N.push({zIndex:D,element:A}),k&&N.push({zIndex:O,element:k}),N}))).flat();return await Promise.all(v.values()),{jsx:x.jsx(h$t,{editor:n,context:b,children:x.jsxs("svg",{preserveAspectRatio:a||void 0,direction:"ltr",width:p,height:g,viewBox:`${h.minX} ${h.minY} ${h.width} ${h.height}`,strokeLinecap:"round",strokeLinejoin:"round",style:{backgroundColor:o?f?l.solid:l.background:"transparent"},children:[x.jsx("defs",{children:m}),S.sort((I,T)=>I.zIndex-T.zIndex).map(({element:I})=>I)]})}),width:p,height:g}}const p$t=40;class g$t{constructor(e){$(this,"_clickId","");$(this,"_clickTimeout");$(this,"_clickScreenPoint");$(this,"_previousScreenPoint");$(this,"_getClickTimeout",(e,t=us())=>{this._clickId=t,clearTimeout(this._clickTimeout),this._clickTimeout=this.editor.timers.setTimeout(()=>{if(this._clickState===e&&this._clickId===t){switch(this._clickState){case"pendingTriple":{this.editor.dispatch({...this.lastPointerInfo,type:"click",name:"double_click",phase:"settle"});break}case"pendingQuadruple":{this.editor.dispatch({...this.lastPointerInfo,type:"click",name:"triple_click",phase:"settle"});break}case"pendingOverflow":{this.editor.dispatch({...this.lastPointerInfo,type:"click",name:"quadruple_click",phase:"settle"});break}}this._clickState="idle"}},e==="idle"||e==="pendingDouble"?this.editor.options.doubleClickDurationMs:this.editor.options.multiClickDurationMs)});$(this,"_clickState","idle");$(this,"lastPointerInfo",{});$(this,"handlePointerEvent",e=>{switch(e.name){case"pointer_down":{if(!this._clickState)return e;switch(this._clickScreenPoint=H.From(e.point),this._previousScreenPoint&&H.Dist2(this._previousScreenPoint,this._clickScreenPoint)>p$t**2&&(this._clickState="idle"),this._previousScreenPoint=this._clickScreenPoint,this.lastPointerInfo=e,this._clickState){case"pendingDouble":return this._clickState="pendingTriple",this._clickTimeout=this._getClickTimeout(this._clickState),{...e,type:"click",name:"double_click",phase:"down"};case"pendingTriple":return this._clickState="pendingQuadruple",this._clickTimeout=this._getClickTimeout(this._clickState),{...e,type:"click",name:"triple_click",phase:"down"};case"pendingQuadruple":return this._clickState="pendingOverflow",this._clickTimeout=this._getClickTimeout(this._clickState),{...e,type:"click",name:"quadruple_click",phase:"down"};case"idle":{this._clickState="pendingDouble";break}case"pendingOverflow":{this._clickState="overflow";break}}return this._clickTimeout=this._getClickTimeout(this._clickState),e}case"pointer_up":{if(!this._clickState)return e;switch(this._clickScreenPoint=H.From(e.point),this._clickState){case"pendingTriple":return{...this.lastPointerInfo,type:"click",name:"double_click",phase:"up"};case"pendingQuadruple":return{...this.lastPointerInfo,type:"click",name:"triple_click",phase:"up"};case"pendingOverflow":return{...this.lastPointerInfo,type:"click",name:"quadruple_click",phase:"up"}}return e}case"pointer_move":return this._clickState!=="idle"&&this._clickScreenPoint&&H.Dist2(this._clickScreenPoint,this.editor.inputs.currentScreenPoint)>(this.editor.getInstanceState().isCoarsePointer?this.editor.options.coarseDragDistanceSquared:this.editor.options.dragDistanceSquared)&&this.cancelDoubleClickTimeout(),e}return e});$(this,"cancelDoubleClickTimeout",()=>{this._clickTimeout=clearTimeout(this._clickTimeout),this._clickState="idle"});this.editor=e}get clickState(){return this._clickState}}class m$t{constructor(e){$(this,"_isEdgeScrolling",!1);$(this,"_edgeScrollDuration",-1);this.editor=e}updateEdgeScrolling(e){const{editor:t}=this,r=this.getEdgeScroll();if(r.x===0&&r.y===0)this._isEdgeScrolling&&(this._isEdgeScrolling=!1,this._edgeScrollDuration=0);else if(this._isEdgeScrolling||(this._isEdgeScrolling=!0,this._edgeScrollDuration=0),this._edgeScrollDuration+=e,this._edgeScrollDuration>t.options.edgeScrollDelay){const i=t.options.edgeScrollEaseDuration>0?uc.easeInCubic(Math.min(1,this._edgeScrollDuration/(t.options.edgeScrollDelay+t.options.edgeScrollEaseDuration))):1;this.moveCameraWhenCloseToEdge({x:r.x*i,y:r.y*i})}}getEdgeProximityFactors(e,t,r,i,o){const{editor:s}=this,a=s.options.edgeScrollDistance,c=r?s.options.coarsePointerWidth:0,l=e-c,u=e+c,d=i?0:a,h=o?t:t-a;return l<d?Math.min(1,(d-l)/a):u>h?-Math.min(1,(u-h)/a):0}getEdgeScroll(){const{editor:e}=this,{inputs:{currentScreenPoint:{x:t,y:r}}}=e,i=e.getViewportScreenBounds(),{isCoarsePointer:o,insets:[s,a,c,l]}=e.getInstanceState(),u=this.getEdgeProximityFactors(t,i.w,o,l,a),d=this.getEdgeProximityFactors(r,i.h,o,s,c);return{x:u,y:d}}moveCameraWhenCloseToEdge(e){const{editor:t}=this;if(!t.inputs.isDragging||t.inputs.isPanning||t.getCameraOptions().isLocked||e.x===0&&e.y===0)return;const r=t.getViewportScreenBounds(),i=r.w<1e3?.612:1,o=r.h<1e3?.612:1,s=t.getZoomLevel(),a=t.user.getEdgeScrollSpeed()*t.options.edgeScrollSpeed,c=a*e.x*i/s,l=a*e.y*o/s,{x:u,y:d,z:h}=t.getCamera();t.setCamera(new H(u+c,d+l,h))}}class v$t{constructor(e){$(this,"isSafari");$(this,"isIos");$(this,"isChromeForIos");$(this,"isFirefox");$(this,"isAndroid");this.editor=e,typeof window<"u"&&"navigator"in window?(this.isSafari=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),this.isIos=!!navigator.userAgent.match(/iPad/i)||!!navigator.userAgent.match(/iPhone/i),this.isChromeForIos=/crios.*safari/i.test(navigator.userAgent),this.isFirefox=/firefox/i.test(navigator.userAgent),this.isAndroid=/android/i.test(navigator.userAgent)):(this.isSafari=!1,this.isIos=!1,this.isChromeForIos=!1,this.isFirefox=!1,this.isAndroid=!1)}}class y$t{constructor(e,t){$(this,"disposeSideEffectListener");this.editor=e,this.disposeSideEffectListener=e.sideEffects.registerAfterChangeHandler("instance",(i,o)=>{i.isFocused!==o.isFocused&&(o.isFocused?this.focus():this.blur(),this.updateContainerClass())});const r=e.getInstanceState().isFocused;t!==r&&e.updateInstanceState({isFocused:!!t}),this.updateContainerClass()}updateContainerClass(){const e=this.editor.getContainer();this.editor.getInstanceState().isFocused?e.classList.add("tl-container__focused"):e.classList.remove("tl-container__focused")}focus(){this.editor.getContainer().focus()}blur(){this.editor.complete(),this.editor.getContainer().blur()}dispose(){var e;(e=this.disposeSideEffectListener)==null||e.call(this)}}function wI(n){return S$t}class b$t{constructor(){$(this,"length",0);$(this,"head",null);$(this,"tail",this)}push(e){return new wie(e,this)}toArray(){return Km}[Symbol.iterator](){return{next(){return{value:void 0,done:!0}}}}}const S$t=new b$t;class wie{constructor(e,t){$(this,"length");this.head=e,this.tail=t,this.length=t.length+1}push(e){return new wie(e,this)}toArray(){return Array.from(this)}[Symbol.iterator](){let e=this;return{next(){if(e.length){const t=e.head;return e=e.tail,{value:t,done:!1}}else return{value:void 0,done:!0}}}}}class _$t{constructor(e){$(this,"store");$(this,"dispose");$(this,"state","recording");$(this,"pendingDiff",new C$t);$(this,"stacks",lc("HistoryManager.stacks",{undos:wI(),redos:wI()},{isEqual:(e,t)=>e.undos===t.undos&&e.redos===t.redos}));$(this,"annotateError");$(this,"onBatchComplete",()=>{});$(this,"_isInBatch",!1);$(this,"batch",(e,t)=>{const r=this.state;r!=="paused"&&(t!=null&&t.history)&&(this.state=w$t[t.history]);try{if(this._isInBatch)return e(),this;this._isInBatch=!0;try{Gm(()=>{e(),this.onBatchComplete()})}catch(i){throw this.annotateError(i),i}finally{this._isInBatch=!1}return this}finally{this.state=r}});$(this,"_undo",({pushToRedoStack:e,toMark:t=void 0})=>{var i;const r=this.state;this.state="paused";try{let{undos:o,redos:s}=this.stacks.get();const a=this.pendingDiff.clear(),c=V6e(a),l=XZ(a);e&&!c&&(s=s.push({type:"diff",diff:a}));let u=!1;if(c)for(;((i=o.head)==null?void 0:i.type)==="stop";){const d=o.head;if(o=o.tail,e&&(s=s.push(d)),d.id===t){u=!0;break}}if(!u)e:for(;o.head;){const d=o.head;switch(o=o.tail,e&&(s=s.push(d)),d.type){case"diff":hk(l,[XZ(d.diff)]);break;case"stop":if(!t||d.id===t)break e;break;default:vl(d)}}this.store.applyDiff(l,{ignoreEphemeralKeys:!0}),this.store.ensureStoreIsUsable(),this.stacks.set({undos:o,redos:s})}finally{this.state=r}return this});$(this,"undo",()=>(this._undo({pushToRedoStack:!0}),this));$(this,"redo",()=>{var t;const e=this.state;this.state="paused";try{this.flushPendingDiff();let{undos:r,redos:i}=this.stacks.get();if(i.length===0)return this;for(;((t=i.head)==null?void 0:t.type)==="stop";)r=r.push(i.head),i=i.tail;const o=q8();for(;i.head;){const s=i.head;if(r=r.push(s),i=i.tail,s.type==="diff")hk(o,[s.diff]);else break}this.store.applyDiff(o,{ignoreEphemeralKeys:!0}),this.store.ensureStoreIsUsable(),this.stacks.set({undos:r,redos:i})}finally{this.state=e}return this});$(this,"bail",()=>(this._undo({pushToRedoStack:!1}),this));$(this,"bailToMark",e=>(this._undo({pushToRedoStack:!1,toMark:e}),this));$(this,"squashToMark",e=>{var o;let t=this.stacks.get().undos;const r=[];for(;t.head&&!(t.head.type==="stop"&&t.head.id===e);)t.head.type==="diff"&&r.push(t.head.diff),t=t.tail;if(!t.head||((o=t.head)==null?void 0:o.id)!==e)return console.error("Could not find mark to squash to: ",e),this;if(r.length===0)return this;const i=q8();return hk(i,r.reverse()),this.stacks.update(({redos:s})=>({undos:t.push({type:"diff",diff:i}),redos:s})),this});$(this,"mark",(e=us())=>(Gm(()=>{this.flushPendingDiff(),this.stacks.update(({undos:t,redos:r})=>({undos:t.push({type:"stop",id:e}),redos:r}))}),e));this.store=e.store,this.annotateError=e.annotateError??W8,this.dispose=this.store.addHistoryInterceptor((t,r)=>{if(r==="user")switch(this.state){case"recording":this.pendingDiff.apply(t.changes),this.stacks.update(({undos:i})=>({undos:i,redos:wI()}));break;case"recordingPreserveRedoStack":this.pendingDiff.apply(t.changes);break;case"paused":break;default:vl(this.state)}})}flushPendingDiff(){if(this.pendingDiff.isEmpty())return;const e=this.pendingDiff.clear();this.stacks.update(({undos:t,redos:r})=>({undos:t.push({type:"diff",diff:e}),redos:r}))}getNumUndos(){return this.stacks.get().undos.length+(this.pendingDiff.isEmpty()?0:1)}getNumRedos(){return this.stacks.get().redos.length}ignore(e){return this.batch(e,{history:"ignore"})}clear(){this.stacks.set({undos:wI(),redos:wI()}),this.pendingDiff.clear()}debug(){const{undos:e,redos:t}=this.stacks.get();return{undos:e.toArray(),redos:t.toArray(),pendingDiff:this.pendingDiff.debug(),state:this.state}}}const w$t={record:"recording","record-preserveRedoStack":"recordingPreserveRedoStack",ignore:"paused"};class C$t{constructor(){$(this,"diff",q8());$(this,"isEmptyAtom",lc("PendingDiff.isEmpty",!0))}clear(){const e=this.diff;return this.diff=q8(),this.isEmptyAtom.set(!0),e}isEmpty(){return this.isEmptyAtom.get()}apply(e){hk(this.diff,[e]),this.isEmptyAtom.set(V6e(this.diff))}debug(){return{diff:this.diff,isEmpty:this.isEmpty()}}}class x$t{constructor(e){$(this,"scribbleItems",new Map);$(this,"state","paused");$(this,"addScribble",(e,t=us())=>{const r={id:t,scribble:{id:t,size:20,color:"accent",opacity:.8,delay:0,points:[],shrink:.1,taper:!0,...e,state:"starting"},timeoutMs:0,delayRemaining:e.delay??0,prev:null,next:null};return this.scribbleItems.set(t,r),r});$(this,"stop",e=>{const t=this.scribbleItems.get(e);if(!t)throw Error(`Scribble with id ${e} not found`);return t.delayRemaining=Math.min(t.delayRemaining,200),t.scribble.state="stopping",t});$(this,"addPoint",(e,t,r)=>{const i=this.scribbleItems.get(e);if(!i)throw Error(`Scribble with id ${e} not found`);const{prev:o}=i,s={x:t,y:r,z:.5};return(!o||H.Dist(o,s)>=1)&&(i.next=s),i});$(this,"tick",e=>{this.scribbleItems.size!==0&&this.editor.batch(()=>{this.scribbleItems.forEach(t=>{if(t.scribble.state==="starting"){const{next:c,prev:l}=t;c&&c!==l&&(t.prev=c,t.scribble.points.push(c)),t.scribble.points.length>8&&(t.scribble.state="active");return}t.delayRemaining>0&&(t.delayRemaining=Math.max(0,t.delayRemaining-e)),t.timeoutMs+=e,t.timeoutMs>=16&&(t.timeoutMs=0);const{delayRemaining:r,timeoutMs:i,prev:o,next:s,scribble:a}=t;switch(a.state){case"active":{s&&s!==o?(t.prev=s,a.points.push(s),r===0&&a.points.length>8&&a.points.shift()):i===0&&(a.points.length>1?a.points.shift():t.delayRemaining=a.delay);break}case"stopping":{if(t.delayRemaining===0&&i===0){if(a.points.length===1){this.scribbleItems.delete(t.id);return}a.shrink&&(a.size=Math.max(1,a.size*(1-a.shrink))),a.points.shift()}break}}}),this.editor.updateInstanceState({scribbles:Array.from(this.scribbleItems.values()).map(({scribble:t})=>({...t,points:[...t.points]})).slice(-5)})})});this.editor=e}reset(){this.editor.updateInstanceState({scribbles:[]}),this.scribbleItems.clear()}}var E$t=Object.defineProperty,I$t=Object.getOwnPropertyDescriptor,RN=(n,e,t,r)=>{for(var i=I$t(e,t),o=n.length-1,s;o>=0;o--)(s=n[o])&&(i=s(e,t,i)||i);return i&&E$t(e,t,i),i};const ar=n=>Math.round(n*10**8)/10**8;function gm(n,e,t,r,i){const o=n.filter(a=>(r==="forward"?a.startNode.id===e:a.endNode.id===e)&&ar(a.length)===ar(t)&&Cf(a.breadthIntersection[0],a.breadthIntersection[1],i[0],i[1]));if(o.length===0)return[];const s=new Set;return o.forEach(a=>{const c=r==="forward"?a.endNode.id:a.startNode.id;if(!s.has(c)){s.add(c);const l=gm(n,c,t,r,Cf(a.breadthIntersection[0],a.breadthIntersection[1],i[0],i[1]));o.push(...l)}}),o}function P$t(n){n.sort((e,t)=>t.gaps.length-e.gaps.length);for(let e=n.length-1;e>0;e--){const t=n[e];for(let r=e-1;r>=0;r--){const i=n[r];if(i.direction===t.direction&&t.gaps.every(o=>i.gaps.some(s=>ar(o.startEdge[0].x)===ar(s.startEdge[0].x)&&ar(o.startEdge[0].y)===ar(s.startEdge[0].y)&&ar(o.startEdge[1].x)===ar(s.startEdge[1].x)&&ar(o.startEdge[1].y)===ar(s.startEdge[1].y))&&i.gaps.some(s=>ar(o.endEdge[0].x)===ar(s.endEdge[0].x)&&ar(o.endEdge[0].y)===ar(s.endEdge[0].y)&&ar(o.endEdge[1].x)===ar(s.endEdge[1].x)&&ar(o.endEdge[1].y)===ar(s.endEdge[1].y)))){n.splice(e,1);break}}}}class ND{constructor(e){$(this,"editor");this.manager=e,this.editor=e.editor}getSnapPointsCache(){const{editor:e}=this;return e.store.createComputedCache("snapPoints",t=>{const r=e.getShapePageTransform(t.id);if(!r)return;const o=e.getShapeUtil(t).getBoundsSnapGeometry(t).points??e.getShapeGeometry(t).bounds.cornersAndCenter;if(!(!r||!o))return o.map((s,a)=>{const{x:c,y:l}=Mn.applyToPoint(r,s);return{x:c,y:l,id:`${t.id}:${a}`}})})}getSnapPoints(e){return this.getSnapPointsCache().get(e)??[]}getSnappablePoints(){const e=this.getSnapPointsCache(),t=this.manager.getSnappableShapes(),r=[];for(const i of t){const o=e.get(i);o&&r.push(...o)}return r}getSnappableGapNodes(){return Array.from(this.manager.getSnappableShapes(),e=>({id:e,pageBounds:xh(this.editor.getShapePageBounds(e))}))}getVisibleGaps(){const e=[],t=[];let r,i;const o=this.getSnappableGapNodes().sort((a,c)=>a.pageBounds.minX-c.pageBounds.minX);for(let a=0;a<o.length;a++){r=o[a];for(let c=a+1;c<o.length;c++)i=o[c],r.pageBounds.maxX<i.pageBounds.minX&&_I(r.pageBounds.minY,r.pageBounds.maxY,i.pageBounds.minY,i.pageBounds.maxY)&&e.push({startNode:r,endNode:i,startEdge:[new H(r.pageBounds.maxX,r.pageBounds.minY),new H(r.pageBounds.maxX,r.pageBounds.maxY)],endEdge:[new H(i.pageBounds.minX,i.pageBounds.minY),new H(i.pageBounds.minX,i.pageBounds.maxY)],length:i.pageBounds.minX-r.pageBounds.maxX,breadthIntersection:Cf(r.pageBounds.minY,r.pageBounds.maxY,i.pageBounds.minY,i.pageBounds.maxY)})}const s=o.sort((a,c)=>a.pageBounds.minY-c.pageBounds.minY);for(let a=0;a<s.length;a++){r=s[a];for(let c=a+1;c<s.length;c++)i=s[c],r.pageBounds.maxY<i.pageBounds.minY&&_I(r.pageBounds.minX,r.pageBounds.maxX,i.pageBounds.minX,i.pageBounds.maxX)&&t.push({startNode:r,endNode:i,startEdge:[new H(r.pageBounds.minX,r.pageBounds.maxY),new H(r.pageBounds.maxX,r.pageBounds.maxY)],endEdge:[new H(i.pageBounds.minX,i.pageBounds.minY),new H(i.pageBounds.maxX,i.pageBounds.minY)],length:i.pageBounds.minY-r.pageBounds.maxY,breadthIntersection:Cf(r.pageBounds.minX,r.pageBounds.maxX,i.pageBounds.minX,i.pageBounds.maxX)})}return{horizontal:e,vertical:t}}snapTranslateShapes({lockedAxis:e,initialSelectionPageBounds:t,initialSelectionSnapPoints:r,dragDelta:i}){var m,v;const o=this.manager.getSnapThreshold(),s=this.getSnappablePoints(),a=t.clone().translate(i),c=r.map(({x:b,y:S},E)=>({id:"selection:"+E,x:b+i.x,y:S+i.y})),l=s,u=[],d=[],h=new H(o,o);this.collectPointSnaps({minOffset:h,nearestSnapsX:u,nearestSnapsY:d,otherNodeSnapPoints:l,selectionSnapPoints:c}),this.collectGapSnaps({selectionPageBounds:a,nearestSnapsX:u,nearestSnapsY:d,minOffset:h});const f=new H(e==="x"?0:((m=u[0])==null?void 0:m.nudge)??0,e==="y"?0:((v=d[0])==null?void 0:v.nudge)??0);h.x=0,h.y=0,u.length=0,d.length=0,c.forEach(b=>{b.x+=f.x,b.y+=f.y}),a.translate(f),this.collectPointSnaps({minOffset:h,nearestSnapsX:u,nearestSnapsY:d,otherNodeSnapPoints:l,selectionSnapPoints:c}),this.collectGapSnaps({selectionPageBounds:a,nearestSnapsX:u,nearestSnapsY:d,minOffset:h});const p=this.getPointSnapLines({nearestSnapsX:u,nearestSnapsY:d}),g=this.getGapSnapLines({selectionPageBounds:a,nearestSnapsX:u,nearestSnapsY:d});return this.manager.setIndicators([...g,...p]),{nudge:f}}snapResizeShapes({initialSelectionPageBounds:e,dragDelta:t,handle:r,isAspectRatioLocked:i,isResizingFromCenter:o}){var I,T;const s=this.manager.getSnapThreshold(),{box:a,scaleX:c,scaleY:l}=xn.Resize(e,r,o?t.x*2:t.x,o?t.y*2:t.y,i);let u=r;c<0&&(u=O6t(u)),l<0&&(u=A6t(u)),o&&(a.center=e.center);const d=u==="top"||u==="bottom",h=u==="left"||u==="right",f=kbe(u,a),p=this.getSnappablePoints(),g=[],m=[],v=new H(s,s);this.collectPointSnaps({minOffset:v,nearestSnapsX:g,nearestSnapsY:m,otherNodeSnapPoints:p,selectionSnapPoints:f});const b=new H(d?0:((I=g[0])==null?void 0:I.nudge)??0,h?0:((T=m[0])==null?void 0:T.nudge)??0);if(i&&M6t(u)&&b.len()!==0){const D=g.length&&m.length?Math.abs(b.x)<Math.abs(b.y)?"x":"y":g.length?"x":"y",O=e.aspectRatio;D==="x"?(m.length=0,b.y=b.x/O,(u==="bottom_left"||u==="top_right")&&(b.y=-b.y)):(g.length=0,b.x=b.y*O,(u==="bottom_left"||u==="top_right")&&(b.x=-b.x))}const S=H.Add(t,b),{box:E}=xn.Resize(e,r,o?S.x*2:S.x,o?S.y*2:S.y,i);o&&(E.center=e.center);const w=kbe("any",E);g.length=0,m.length=0,v.x=0,v.y=0,this.collectPointSnaps({minOffset:v,nearestSnapsX:g,nearestSnapsY:m,otherNodeSnapPoints:p,selectionSnapPoints:w});const C=this.getPointSnapLines({nearestSnapsX:g,nearestSnapsY:m});return this.manager.setIndicators([...C]),{nudge:b}}collectPointSnaps({selectionSnapPoints:e,otherNodeSnapPoints:t,minOffset:r,nearestSnapsX:i,nearestSnapsY:o}){for(const s of e)for(const a of t){const c=H.Sub(s,a),l=Math.abs(c.x),u=Math.abs(c.y);ar(l)<=ar(r.x)&&(ar(l)<ar(r.x)&&(i.length=0),i.push({type:"points",points:{thisPoint:s,otherPoint:a},nudge:a.x-s.x}),r.x=l),ar(u)<=ar(r.y)&&(ar(u)<ar(r.y)&&(o.length=0),o.push({type:"points",points:{thisPoint:s,otherPoint:a},nudge:a.y-s.y}),r.y=u)}}collectGapSnaps({selectionPageBounds:e,minOffset:t,nearestSnapsX:r,nearestSnapsY:i}){const{horizontal:o,vertical:s}=this.getVisibleGaps();for(const a of o){if(!_I(a.breadthIntersection[0],a.breadthIntersection[1],e.minY,e.maxY))continue;const l=a.startEdge[0].x+a.length/2-e.center.x;if(a.length>e.width&&ar(Math.abs(l))<=ar(t.x)){ar(Math.abs(l))<ar(t.x)&&(r.length=0),t.x=Math.abs(l);const v={type:"gap_center",gap:a,nudge:l},b=r.find(({type:E})=>E==="gap_center"),S=b&&Cf(a.breadthIntersection[0],a.breadthIntersection[1],b.gap.breadthIntersection[0],b.gap.breadthIntersection[1]);b&&b.gap.length>a.length&&S?r[r.indexOf(b)]=v:(!b||!S)&&r.push(v)}const d=a.startNode.pageBounds.minX-a.length,h=e.maxX,f=d-h;ar(Math.abs(f))<=ar(t.x)&&(ar(Math.abs(f))<ar(t.x)&&(r.length=0),t.x=Math.abs(f),r.push({type:"gap_duplicate",gap:a,protrusionDirection:"left",nudge:f}));const p=a.endNode.pageBounds.maxX+a.length,g=e.minX,m=p-g;ar(Math.abs(m))<=ar(t.x)&&(ar(Math.abs(m))<ar(t.x)&&(r.length=0),t.x=Math.abs(m),r.push({type:"gap_duplicate",gap:a,protrusionDirection:"right",nudge:m}))}for(const a of s){if(!_I(a.breadthIntersection[0],a.breadthIntersection[1],e.minX,e.maxX))continue;const l=a.startEdge[0].y+a.length/2-e.center.y;if(a.length>e.height&&ar(Math.abs(l))<=ar(t.y)){ar(Math.abs(l))<ar(t.y)&&(i.length=0),t.y=Math.abs(l);const v={type:"gap_center",gap:a,nudge:l},b=i.find(({type:E})=>E==="gap_center"),S=b&&_I(b.gap.breadthIntersection[0],b.gap.breadthIntersection[1],a.breadthIntersection[0],a.breadthIntersection[1]);b&&b.gap.length>a.length&&S?i[i.indexOf(b)]=v:(!b||!S)&&i.push(v);continue}const d=a.startNode.pageBounds.minY-a.length,h=e.maxY,f=d-h;ar(Math.abs(f))<=ar(t.y)&&(ar(Math.abs(f))<ar(t.y)&&(i.length=0),t.y=Math.abs(f),i.push({type:"gap_duplicate",gap:a,protrusionDirection:"top",nudge:f}));const p=a.endNode.pageBounds.maxY+a.length,g=e.minY,m=p-g;ar(Math.abs(m))<=ar(t.y)&&(ar(Math.abs(m))<ar(t.y)&&(i.length=0),t.y=Math.abs(m),i.push({type:"gap_duplicate",gap:a,protrusionDirection:"bottom",nudge:m}))}}getPointSnapLines({nearestSnapsX:e,nearestSnapsY:t}){const r={},i={};if(e.length>0){for(const o of e)if(o.type==="points"){const s=ar(o.points.otherPoint.x);r[s]||(r[s]=[]),r[s].push(o.points)}}if(t.length>0){for(const o of t)if(o.type==="points"){const s=ar(o.points.otherPoint.y);i[s]||(i[s]=[]),i[s].push(o.points)}}return Object.values(r).concat(Object.values(i)).map(o=>({id:us(),type:"points",points:Kre(o.map(s=>H.From(s.otherPoint)).concat(o.map(s=>H.From(s.thisPoint))),(s,a)=>s.equals(a))}))}getGapSnapLines({selectionPageBounds:e,nearestSnapsX:t,nearestSnapsY:r}){const{vertical:i,horizontal:o}=this.getVisibleGaps(),s={top:e.sides[0],right:e.sides[1],bottom:[e.corners[3],e.corners[2]],left:[e.corners[0],e.corners[3]]},a=[];if(t.length>0)for(const c of t){if(c.type==="points")continue;const{gap:{breadthIntersection:l,startEdge:u,startNode:d,endNode:h,length:f,endEdge:p}}=c;switch(c.type){case"gap_center":{const g=(f-e.width)/2,m=Cf(l[0],l[1],e.minY,e.maxY);a.push({type:"gaps",direction:"horizontal",id:us(),gaps:[...gm(o,d.id,g,"backward",m),{startEdge:u,endEdge:s.left},{startEdge:s.right,endEdge:p},...gm(o,h.id,g,"forward",m)]});break}case"gap_duplicate":{const g=Cf(l[0],l[1],e.minY,e.maxY);a.push({type:"gaps",direction:"horizontal",id:us(),gaps:c.protrusionDirection==="left"?[{startEdge:s.right,endEdge:u.map(m=>m.clone().addXY(-d.pageBounds.width,0))},{startEdge:u,endEdge:p},...gm(o,h.id,f,"forward",g)]:[...gm(o,d.id,f,"backward",g),{startEdge:u,endEdge:p},{startEdge:p.map(m=>m.clone().addXY(c.gap.endNode.pageBounds.width,0)),endEdge:s.left}]});break}}}if(r.length>0)for(const c of r){if(c.type==="points")continue;const{gap:{breadthIntersection:l,startEdge:u,startNode:d,endNode:h,length:f,endEdge:p}}=c;switch(c.type){case"gap_center":{const g=(f-e.height)/2,m=Cf(l[0],l[1],e.minX,e.maxX);a.push({type:"gaps",direction:"vertical",id:us(),gaps:[...gm(i,d.id,g,"backward",m),{startEdge:u,endEdge:s.top},{startEdge:s.bottom,endEdge:p},...gm(i,c.gap.endNode.id,g,"forward",m)]});break}case"gap_duplicate":{const g=Cf(l[0],l[1],e.minX,e.maxX);a.push({type:"gaps",direction:"vertical",id:us(),gaps:c.protrusionDirection==="top"?[{startEdge:s.bottom,endEdge:u.map(m=>m.clone().addXY(0,-d.pageBounds.height))},{startEdge:u,endEdge:p},...gm(i,h.id,f,"forward",g)]:[...gm(i,d.id,f,"backward",g),{startEdge:u,endEdge:p},{startEdge:p.map(m=>m.clone().addXY(0,h.pageBounds.height)),endEdge:s.top}]})}break}}return P$t(a),a}}RN([Et],ND.prototype,"getSnapPointsCache");RN([Et],ND.prototype,"getSnappablePoints");RN([Et],ND.prototype,"getSnappableGapNodes");RN([Et],ND.prototype,"getVisibleGaps");function kbe(n,e){const{minX:t,maxX:r,minY:i,maxY:o}=e,s=[];switch(n){case"top":case"left":case"top_left":case"any":s.push({id:"top_left",handle:"top_left",x:t,y:i})}switch(n){case"top":case"right":case"top_right":case"any":s.push({id:"top_right",handle:"top_right",x:r,y:i})}switch(n){case"bottom":case"right":case"bottom_right":case"any":s.push({id:"bottom_right",handle:"bottom_right",x:r,y:o})}switch(n){case"bottom":case"left":case"bottom_left":case"any":s.push({id:"bottom_left",handle:"bottom_left",x:t,y:o})}return s}var k$t=Object.defineProperty,T$t=Object.getOwnPropertyDescriptor,D$t=(n,e,t,r)=>{for(var i=T$t(e,t),o=n.length-1,s;o>=0;o--)(s=n[o])&&(i=s(e,t,i)||i);return i&&k$t(e,t,i),i};const R$t=()=>null,A$t=()=>[];class $$e{constructor(e){$(this,"editor");this.manager=e,this.editor=e.editor}getSnapGeometryCache(){const{editor:e}=this;return e.store.createComputedCache("handle snap geometry",t=>{const r=e.getShapeUtil(t).getHandleSnapGeometry(t);return{outline:r.outline===void 0?e.getShapeGeometry(t):r.outline,points:r.points??[],getSelfSnapOutline:r.getSelfSnapOutline??R$t,getSelfSnapPoints:r.getSelfSnapPoints??A$t}})}*iterateSnapPointsInPageSpace(e,t){var i,o;const r=(i=this.getSnapGeometryCache().get(e))==null?void 0:i.getSelfSnapPoints(t);if(r&&r.length){const s=xh(this.editor.getShapePageTransform(e));for(const a of r)yield s.applyToPoint(a)}for(const s of this.manager.getSnappableShapes()){if(s===e)continue;const a=(o=this.getSnapGeometryCache().get(s))==null?void 0:o.points;if(!a||!a.length)continue;const c=xh(this.editor.getShapePageTransform(s));for(const l of a)yield c.applyToPoint(l)}}*iterateSnapOutlines(e,t){var i,o;const r=(i=this.getSnapGeometryCache().get(e))==null?void 0:i.getSelfSnapOutline(t);r&&(yield{shapeId:e,outline:r});for(const s of this.manager.getSnappableShapes()){if(s===e)continue;const a=(o=this.getSnapGeometryCache().get(s))==null?void 0:o.outline;a&&(yield{shapeId:s,outline:a})}}getHandleSnapPosition({currentShapeId:e,handle:t,handleInPageSpace:r}){const i=this.manager.getSnapThreshold();let o=i,s=null;for(const l of this.iterateSnapPointsInPageSpace(e,t))H.DistMin(r,l,o)&&(o=H.Dist(r,l),s=l);if(s)return s;let a=i,c=null;for(const{shapeId:l,outline:u}of this.iterateSnapOutlines(e,t)){const d=xh(this.editor.getShapePageTransform(l)),h=this.editor.getPointInShapeSpace(l,r),f=u.nearestPoint(h),p=d.applyToPoint(f);H.DistMin(r,p,a)&&(a=H.Dist(r,p),c=p)}return c||null}snapHandle({currentShapeId:e,handle:t}){const i=xh(this.editor.getShapePageTransform(e)).applyToPoint(t),o=this.getHandleSnapPosition({currentShapeId:e,handle:t,handleInPageSpace:i});return o?(this.manager.setIndicators([{id:us(),type:"points",points:[o]}]),{nudge:H.Sub(o,i)}):null}}D$t([Et],$$e.prototype,"getSnapGeometryCache");var O$t=Object.defineProperty,M$t=Object.getOwnPropertyDescriptor,Cie=(n,e,t,r)=>{for(var i=M$t(e,t),o=n.length-1,s;o>=0;o--)(s=n[o])&&(i=s(e,t,i)||i);return i&&O$t(e,t,i),i};class AN{constructor(e){$(this,"shapeBounds");$(this,"handles");$(this,"_snapIndicators",lc("snapLines",void 0));this.editor=e,this.shapeBounds=new ND(this),this.handles=new $$e(this)}getIndicators(){return this._snapIndicators.get()??Km}clearIndicators(){this.getIndicators().length&&this._snapIndicators.set(void 0)}setIndicators(e){this._snapIndicators.set(e)}getSnapThreshold(){return 8/this.editor.getZoomLevel()}getSnappableShapes(){const{editor:e}=this,t=e.getViewportPageBounds(),r=e.getSelectedShapeIds(),i=new Set,o=s=>{if(ku(s)){const c=e.getShape(s);c&&e.isShapeOfType(c,"frame")&&i.add(s)}const a=e.getSortedChildIdsForParent(s);for(const c of a){if(r.includes(c))continue;const l=e.getShape(c);if(!l||!e.getShapeUtil(l).canSnap(l))continue;const d=e.getShapePageBounds(c);if(d&&t.includes(d)){if(e.isShapeOfType(l,"group")){o(c);continue}i.add(c)}}};return o(this.getCurrentCommonAncestor()??e.getCurrentPageId()),i}getCurrentCommonAncestor(){return this.editor.findCommonAncestor(this.editor.getSelectedShapes())}}Cie([Et],AN.prototype,"getSnapThreshold");Cie([Et],AN.prototype,"getSnappableShapes");Cie([Et],AN.prototype,"getCurrentCommonAncestor");const $$t=/\r?\n|\r/g;function Tbe(n){return n.replace($$t,`
`).split(`
`).map(e=>e||" ").join(`
`)}const L$t={start:"left","start-legacy":"left",middle:"center","middle-legacy":"center",end:"right","end-legacy":"right"},N$t=/\s/;class F$t{constructor(e){$(this,"baseElm");$(this,"measureText",(e,t)=>{var s;const r=(s=this.baseElm)==null?void 0:s.cloneNode();this.baseElm.insertAdjacentElement("afterend",r),r.setAttribute("dir","auto"),r.style.setProperty("unicode-bidi","plaintext"),r.style.setProperty("font-family",t.fontFamily),r.style.setProperty("font-style",t.fontStyle),r.style.setProperty("font-weight",t.fontWeight),r.style.setProperty("font-size",t.fontSize+"px"),r.style.setProperty("line-height",t.lineHeight*t.fontSize+"px"),r.style.setProperty("max-width",t.maxWidth===null?null:t.maxWidth+"px"),r.style.setProperty("min-width",t.minWidth===null?null:t.minWidth+"px"),r.style.setProperty("padding",t.padding),r.style.setProperty("overflow-wrap",t.disableOverflowWrapBreaking?"normal":"break-word"),r.textContent=Tbe(e);const i=r.scrollWidth,o=r.getBoundingClientRect();return r.remove(),{x:0,y:0,w:o.width,h:o.height,scrollWidth:i}});this.editor=e;const t=this.editor.getContainer(),r=document.createElement("div");r.classList.add("tl-text"),r.classList.add("tl-text-measure"),r.tabIndex=-1,t.appendChild(r),this.baseElm=r,e.disposables.add(()=>{r.remove()})}measureElementTextNodeSpans(e,{shouldTruncateToFirstLine:t=!1}={}){const r=[],i=e.getBoundingClientRect(),o=-i.left,s=-i.top,a=new Range,c=e.childNodes[0];let l=0,u=null,d=null,h=0,f=0,p=!1;for(const g of e.childNodes)if(g.nodeType===Node.TEXT_NODE)for(const m of g.textContent??""){a.setStart(c,l),a.setEnd(c,l+m.length);const v=a.getClientRects(),b=v[v.length-1],S=b.top+s,E=b.left+o,w=b.right+o,C=E<f,I=N$t.test(m);if(I!==d||S!==h||!u){if(u){if(t&&S!==h){p=!0;break}r.push(u)}u={box:{x:E,y:S,w:b.width,h:b.height},text:m},f=E}else C&&(u.box.x=E),u.box.w=C?u.box.w+b.width:w-u.box.x,u.text+=m;m===`
`&&(f=0),d=I,h=S,l+=m.length}return u&&r.push(u),{spans:r,didTruncate:p}}measureTextSpans(e,t){var l;if(e==="")return[];const r=(l=this.baseElm)==null?void 0:l.cloneNode();this.baseElm.insertAdjacentElement("afterend",r);const i=Math.ceil(t.width-t.padding*2);r.setAttribute("dir","auto"),r.style.setProperty("unicode-bidi","plaintext"),r.style.setProperty("width",`${i}px`),r.style.setProperty("height","min-content"),r.style.setProperty("font-size",`${t.fontSize}px`),r.style.setProperty("font-family",t.fontFamily),r.style.setProperty("font-weight",t.fontWeight),r.style.setProperty("line-height",`${t.lineHeight*t.fontSize}px`),r.style.setProperty("text-align",L$t[t.textAlign]);const o=t.overflow==="truncate-ellipsis"||t.overflow==="truncate-clip";o&&(r.style.setProperty("overflow-wrap","anywhere"),r.style.setProperty("word-break","break-all"));const s=Tbe(e);r.textContent=s;const{spans:a,didTruncate:c}=this.measureElementTextNodeSpans(r,{shouldTruncateToFirstLine:o});if(t.overflow==="truncate-ellipsis"&&c){r.textContent="…";const u=Math.ceil(this.measureElementTextNodeSpans(r).spans[0].box.w);r.style.setProperty("width",`${i-u}px`),r.textContent=s;const d=this.measureElementTextNodeSpans(r,{shouldTruncateToFirstLine:!0}).spans,h=d[d.length-1];return d.push({text:"…",box:{x:Math.min(h.box.x+h.box.w,t.width-t.padding-u),y:h.box.y,w:u,h:h.box.h}}),d}return r.remove(),a}}const Dbe=(typeof process<"u",H6e);class j$t{constructor(e){$(this,"cancelRaf");$(this,"isPaused",!0);$(this,"now",0);$(this,"start",()=>{var e;this.isPaused=!1,(e=this.cancelRaf)==null||e.call(this),this.cancelRaf=Dbe(this.tick),this.now=Date.now()});$(this,"tick",()=>{if(this.isPaused)return;const e=Date.now(),t=e-this.now;this.now=e,this.updatePointerVelocity(t),this.editor.emit("frame",t),this.editor.emit("tick",t),this.cancelRaf=Dbe(this.tick)});$(this,"dispose",()=>{var e;this.isPaused=!0,(e=this.cancelRaf)==null||e.call(this)});$(this,"prevPoint",new H);$(this,"updatePointerVelocity",e=>{const{prevPoint:t,editor:{inputs:{currentScreenPoint:r,pointerVelocity:i}}}=this;if(e===0)return;const o=H.Sub(r,t);this.prevPoint=r.clone();const s=o.len(),a=s?o.div(s):new H(0,0),c=i.clone().lrp(a.mul(s/e),.5);Math.abs(c.x)<.01&&(c.x=0),Math.abs(c.y)<.01&&(c.y=0),i.equals(c)||(this.editor.inputs.pointerVelocity=c)});this.editor=e,this.editor.disposables.add(this.dispose),this.start()}}var B$t=Object.defineProperty,H$t=Object.getOwnPropertyDescriptor,sp=(n,e,t,r)=>{for(var i=H$t(e,t),o=n.length-1,s;o>=0;o--)(s=n[o])&&(i=s(e,t,i)||i);return i&&B$t(e,t,i),i};class Gh{constructor(e,t){$(this,"systemColorScheme",lc("systemColorScheme","light"));$(this,"updateUserPreferences",e=>{this.user.setUserPreferences({...this.user.userPreferences.get(),...e})});var r;if(this.user=e,this.inferDarkMode=t,window){const i=(r=window.matchMedia)==null?void 0:r.call(window,"(prefers-color-scheme: dark)");i!=null&&i.matches&&this.systemColorScheme.set("dark"),i==null||i.addEventListener("change",o=>{o.matches?this.systemColorScheme.set("dark"):this.systemColorScheme.set("light")})}}getUserPreferences(){return{id:this.getId(),name:this.getName(),locale:this.getLocale(),color:this.getColor(),animationSpeed:this.getAnimationSpeed(),isSnapMode:this.getIsSnapMode(),colorScheme:this.user.userPreferences.get().colorScheme,isDarkMode:this.getIsDarkMode(),isWrapMode:this.getIsWrapMode(),isDynamicResizeMode:this.getIsDynamicResizeMode()}}getIsDarkMode(){switch(this.user.userPreferences.get().colorScheme){case"dark":return!0;case"light":return!1;case"system":return this.systemColorScheme.get()==="dark";default:return this.inferDarkMode?this.systemColorScheme.get()==="dark":!1}}getEdgeScrollSpeed(){return this.user.userPreferences.get().edgeScrollSpeed??Yv.edgeScrollSpeed}getAnimationSpeed(){return this.user.userPreferences.get().animationSpeed??Yv.animationSpeed}getId(){return this.user.userPreferences.get().id}getName(){return this.user.userPreferences.get().name??Yv.name}getLocale(){return this.user.userPreferences.get().locale??Yv.locale}getColor(){return this.user.userPreferences.get().color??Yv.color}getIsSnapMode(){return this.user.userPreferences.get().isSnapMode??Yv.isSnapMode}getIsWrapMode(){return this.user.userPreferences.get().isWrapMode??Yv.isWrapMode}getIsDynamicResizeMode(){return this.user.userPreferences.get().isDynamicSizeMode??Yv.isDynamicSizeMode}}sp([Et],Gh.prototype,"getUserPreferences");sp([Et],Gh.prototype,"getIsDarkMode");sp([Et],Gh.prototype,"getEdgeScrollSpeed");sp([Et],Gh.prototype,"getAnimationSpeed");sp([Et],Gh.prototype,"getId");sp([Et],Gh.prototype,"getName");sp([Et],Gh.prototype,"getLocale");sp([Et],Gh.prototype,"getColor");sp([Et],Gh.prototype,"getIsSnapMode");sp([Et],Gh.prototype,"getIsWrapMode");sp([Et],Gh.prototype,"getIsDynamicResizeMode");const U$t={wheel:"onWheel",pointer_down:"onPointerDown",pointer_move:"onPointerMove",long_press:"onLongPress",pointer_up:"onPointerUp",right_click:"onRightClick",middle_click:"onMiddleClick",key_down:"onKeyDown",key_up:"onKeyUp",key_repeat:"onKeyRepeat",cancel:"onCancel",complete:"onComplete",interrupt:"onInterrupt",double_click:"onDoubleClick",triple_click:"onTripleClick",quadruple_click:"onQuadrupleClick",tick:"onTick"},z$t=["brushing","cropping","dragging","dragging_handle","drawing","erasing","lasering","resizing","rotating","scribble_brushing","translating"];class Ln{constructor(e,t){$(this,"performanceTracker");$(this,"id");$(this,"type");$(this,"shapeType");$(this,"initial");$(this,"children");$(this,"parent");$(this,"_path");$(this,"_current");$(this,"_isActive");$(this,"transition",(e,t={})=>{var o;const r=e.split(".");let i=this;for(let s=0;s<r.length;s++){const a=r[s],c=i.getCurrent(),l=(o=i.children)==null?void 0:o[a];if(!l)throw Error(`${i.id} - no child state exists with the id ${a}.`);if((c==null?void 0:c.id)!==l.id&&(c==null||c.exit(t,a),i._current.set(l),l.enter(t,(c==null?void 0:c.id)||"initial"),!l.getIsActive()))break;i=l}return this});$(this,"handleEvent",e=>{var i;const t=U$t[e.name],r=this._current.__unsafe__getWithoutCapture();(i=this[t])==null||i.call(this,e),this._isActive.__unsafe__getWithoutCapture()&&r&&r===this._current.__unsafe__getWithoutCapture()&&r.handleEvent(e)});$(this,"enter",(e,t)=>{var r;if(ta.measurePerformance.get()&&z$t.includes(this.id)&&this.performanceTracker.start(this.id),this._isActive.set(!0),(r=this.onEnter)==null||r.call(this,e,t),this.children&&this.initial&&this.getIsActive()){const i=this.children[this.initial];this._current.set(i),i.enter(e,t)}});$(this,"exit",(e,t)=>{var r,i;ta.measurePerformance.get()&&this.performanceTracker.isStarted()&&this.performanceTracker.stop(),this._isActive.set(!1),(r=this.onExit)==null||r.call(this,e,t),this.getIsActive()||(i=this.getCurrent())==null||i.exit(e,t)});$(this,"_currentToolIdMask",lc("curent tool id mask",void 0));$(this,"onWheel");$(this,"onPointerDown");$(this,"onPointerMove");$(this,"onLongPress");$(this,"onPointerUp");$(this,"onDoubleClick");$(this,"onTripleClick");$(this,"onQuadrupleClick");$(this,"onRightClick");$(this,"onMiddleClick");$(this,"onKeyDown");$(this,"onKeyUp");$(this,"onKeyRepeat");$(this,"onCancel");$(this,"onComplete");$(this,"onInterrupt");$(this,"onTick");$(this,"onEnter");$(this,"onExit");this.editor=e;const{id:r,children:i,initial:o}=this.constructor;this.id=r,this._isActive=lc("toolIsActive"+this.id,!1),this._current=lc("toolState"+this.id,void 0),this._path=Et("toolPath"+this.id,()=>{const s=this.getCurrent();return this.id+(s?`.${s.getPath()}`:"")}),this.parent=t??{},this.parent?i&&o?(this.type="branch",this.initial=o,this.children=Object.fromEntries(i().map(s=>[s.id,new s(this.editor,this)])),this._current.set(this.children[this.initial])):this.type="leaf":(this.type="root",i&&o&&(this.initial=o,this.children=Object.fromEntries(i().map(s=>[s.id,new s(this.editor,this)])),this._current.set(this.children[this.initial]))),this.performanceTracker=new E6e}getPath(){return this._path.get()}getCurrent(){return this._current.get()}getIsActive(){return this._isActive.get()}getCurrentToolIdMask(){return this._currentToolIdMask.get()}setCurrentToolIdMask(e){this._currentToolIdMask.set(e)}}$(Ln,"id"),$(Ln,"initial"),$(Ln,"children");class wO extends Ln{constructor(){super(...arguments);$(this,"onKeyDown",t=>{var r;switch(t.code){case"KeyZ":{if(!(t.shiftKey||t.ctrlKey)){const i=this.getCurrent();i&&((r=i.getCurrent())==null?void 0:r.id)==="idle"&&this.children.zoom&&this.editor.setCurrentTool("zoom",{...t,onInteractionEnd:i.id})}break}}})}}$(wO,"id","root"),$(wO,"initial",""),$(wO,"children",()=>[]);var V$t=Object.defineProperty,W$t=Object.getOwnPropertyDescriptor,kn=(n,e,t,r)=>{for(var i=W$t(e,t),o=n.length-1,s;o>=0;o--)(s=n[o])&&(i=s(e,t,i)||i);return i&&V$t(e,t,i),i};let En=class extends B8t{constructor({store:t,user:r,shapeUtils:i,bindingUtils:o,tools:s,getContainer:a,cameraOptions:c,assetOptions:l,initialState:u,autoFocus:d,inferDarkMode:h,options:f}){super();$(this,"options");$(this,"store");$(this,"root");$(this,"disposables",new Set);$(this,"isDisposed",!1);$(this,"_tickManager");$(this,"snaps");$(this,"timers");$(this,"user");$(this,"textMeasure");$(this,"environment");$(this,"scribbles");$(this,"sideEffects");$(this,"edgeScrollManager");$(this,"focusManager");$(this,"getContainer");$(this,"shapeUtils");$(this,"styleProps");$(this,"bindingUtils");$(this,"history");$(this,"_crashingError",null);$(this,"_updateInstanceState",(t,r)=>{this.batch(()=>{this.store.put([{...this.getInstanceState(),...t}])},r)});$(this,"_isChangingStyleTimeout",-1);$(this,"setCursor",t=>(this.updateInstanceState({cursor:{...this.getInstanceState().cursor,...t}}),this));$(this,"_updateCurrentPageState",(t,r)=>{this.batch(()=>{this.store.update(t.id??this.getCurrentPageState().id,i=>({...i,...t}))},{history:"ignore",...r})});$(this,"_cameraOptions",lc("camera options",nbe));$(this,"_viewportAnimation",null);$(this,"_willSetInitialBounds",!0);$(this,"_isLockedOnFollowingUser",lc("isLockedOnFollowingUser",!1));$(this,"_cameraState",lc("camera state","idle"));$(this,"_cameraStateTimeoutRemaining",0);$(this,"_decayCameraStateTimeout",t=>{this._cameraStateTimeoutRemaining-=t,!(this._cameraStateTimeoutRemaining>0)&&(this.off("tick",this._decayCameraStateTimeout),this._cameraState.set("idle"))});$(this,"_tickCameraState",()=>{this._cameraStateTimeoutRemaining=this.options.cameraMovingTimeoutMs,this._cameraState.__unsafe__getWithoutCapture()==="idle"&&(this._cameraState.set("moving"),this.on("tick",this._decayCameraStateTimeout))});$(this,"_currentPageShapeIds");$(this,"_assetOptions",lc("asset options",rbe));$(this,"_parentIdsToChildIds");$(this,"animatingShapes",new Map);$(this,"_updateShapes",t=>{this.getInstanceState().isReadonly||this.batch(()=>{var s,a;const r=[];let i,o;for(let c=0,l=t.length;c<l;c++){const u=t[c];u&&(i=this.getShape(u.id),i&&(o=um(i,u),o!==i&&(o=((a=(s=this.getShapeUtil(i)).onBeforeUpdate)==null?void 0:a.call(s,i,o))??o,r.push(o))))}this.store.put(r)})});$(this,"externalAssetContentHandlers",{file:null,url:null});$(this,"externalContentHandlers",{text:null,files:null,embed:null,"svg-text":null,url:null});$(this,"inputs",{originPagePoint:new H,originScreenPoint:new H,previousPagePoint:new H,previousScreenPoint:new H,currentPagePoint:new H,currentScreenPoint:new H,keys:new Set,buttons:new Set,isPen:!1,shiftKey:!1,ctrlKey:!1,altKey:!1,isDragging:!1,isPointing:!1,isPinching:!1,isEditing:!1,isPanning:!1,pointerVelocity:new H});$(this,"_clickManager",new g$t(this));$(this,"_prevCursor","default");$(this,"_shiftKeyTimeout",-1);$(this,"_setShiftKeyTimeout",()=>{this.inputs.shiftKey=!1,this.dispatch({type:"keyboard",name:"key_up",key:"Shift",shiftKey:this.inputs.shiftKey,ctrlKey:this.inputs.ctrlKey,altKey:this.inputs.altKey,code:"ShiftLeft"})});$(this,"_altKeyTimeout",-1);$(this,"_setAltKeyTimeout",()=>{this.inputs.altKey=!1,this.dispatch({type:"keyboard",name:"key_up",key:"Alt",shiftKey:this.inputs.shiftKey,ctrlKey:this.inputs.ctrlKey,altKey:this.inputs.altKey,code:"AltLeft"})});$(this,"_ctrlKeyTimeout",-1);$(this,"_setCtrlKeyTimeout",()=>{this.inputs.ctrlKey=!1,this.dispatch({type:"keyboard",name:"key_up",key:"Ctrl",shiftKey:this.inputs.shiftKey,ctrlKey:this.inputs.ctrlKey,altKey:this.inputs.altKey,code:"ControlLeft"})});$(this,"_restoreToolId","select");$(this,"_pinchStart",1);$(this,"_didPinch",!1);$(this,"_selectedShapeIdsAtPointerDown",[]);$(this,"_longPressTimeout",-1);$(this,"capturedPointerId",null);$(this,"performanceTracker");$(this,"performanceTrackerTimeout",-1);$(this,"dispatch",t=>(this._pendingEventsForNextTick.push(t),t.type==="pointer"&&t.name==="pointer_move"||t.type==="wheel"||t.type==="pinch"||this._flushEventsForTick(0),this));$(this,"_pendingEventsForNextTick",[]);$(this,"_flushEventForTick",t=>{if(this.getCrashingError())return this;const{inputs:r}=this,{type:i}=t;if(t.type==="misc"){(t.name==="cancel"||t.name==="complete")&&(this.inputs.isDragging=!1,this.inputs.isPanning&&(this.inputs.isPanning=!1,this.setCursor({type:this._prevCursor,rotation:0}))),this.root.handleEvent(t);return}t.shiftKey?(clearTimeout(this._shiftKeyTimeout),this._shiftKeyTimeout=-1,r.shiftKey=!0):!t.shiftKey&&r.shiftKey&&this._shiftKeyTimeout===-1&&(this._shiftKeyTimeout=this.timers.setTimeout(this._setShiftKeyTimeout,150)),t.altKey?(clearTimeout(this._altKeyTimeout),this._altKeyTimeout=-1,r.altKey=!0):!t.altKey&&r.altKey&&this._altKeyTimeout===-1&&(this._altKeyTimeout=this.timers.setTimeout(this._setAltKeyTimeout,150)),t.ctrlKey?(clearTimeout(this._ctrlKeyTimeout),this._ctrlKeyTimeout=-1,r.ctrlKey=!0):!t.ctrlKey&&r.ctrlKey&&this._ctrlKeyTimeout===-1&&(this._ctrlKeyTimeout=this.timers.setTimeout(this._setCtrlKeyTimeout,150));const{originPagePoint:o,currentPagePoint:s}=r;r.isPointing||(r.isDragging=!1);const a=this.store.unsafeGetWithoutCapture(fl),c=this.store.get(this._getCurrentPageStateId()),l=this._cameraOptions.__unsafe__getWithoutCapture();switch(i){case"pinch":{if(l.isLocked)return;switch(clearTimeout(this._longPressTimeout),this._updateInputsFromEvent(t),t.name){case"pinch_start":{if(r.isPinching)return;r.isEditing||(this._pinchStart=this.getCamera().z,this._selectedShapeIdsAtPointerDown.length||(this._selectedShapeIdsAtPointerDown=[...c.selectedShapeIds]),this._didPinch=!0,r.isPinching=!0,this.interrupt());return}case"pinch":{if(!r.isPinching)return;const{point:{z:u=1},delta:{x:d,y:h}}=t,{x:f,y:p}=H.SubXY(t.point,a.screenBounds.x,a.screenBounds.y);this.stopCameraAnimation(),a.followingUserId&&this.stopFollowingUser();const{x:g,y:m,z:v}=CU(()=>this.getCamera()),{panSpeed:b,zoomSpeed:S}=l;this._setCamera(new H(g+d*b/v-f/v+f/(u*S),m+h*b/v-p/v+p/(u*S),u*S),{immediate:!0});return}case"pinch_end":{if(!r.isPinching)return this;r.isPinching=!1;const{_selectedShapeIdsAtPointerDown:u}=this;this.setSelectedShapes(this._selectedShapeIdsAtPointerDown),this._selectedShapeIdsAtPointerDown=[],this._didPinch&&(this._didPinch=!1,u.length>0&&this.once("tick",()=>{this._didPinch||this.setSelectedShapes(u)}));return}}}case"wheel":{if(l.isLocked)return;if(this._updateInputsFromEvent(t),!this.getIsMenuOpen()){const{panSpeed:u,zoomSpeed:d,wheelBehavior:h}=l;if(h!=="none"){this.stopCameraAnimation(),a.followingUserId&&this.stopFollowingUser();const{x:f,y:p,z:g}=CU(()=>this.getCamera()),{x:m,y:v,z:b=0}=t.delta;let S=h;switch(r.ctrlKey&&(S=h==="pan"?"zoom":"pan"),S){case"zoom":{const{x:E,y:w}=this.inputs.currentScreenPoint;let C=b;h==="zoom"&&(Math.abs(v)>10?C=10*Math.sign(v)/100:C=v/100);const I=g+(C??0)*d*g;this._setCamera(new H(f+(E/I-E)-(E/g-E),p+(w/I-w)-(w/g-w),I),{immediate:!0}),this.maybeTrackPerformance("Zooming");return}case"pan":{this._setCamera(new H(f+m*u/g,p+v*u/g,g),{immediate:!0}),this.maybeTrackPerformance("Panning");return}}}}break}case"pointer":{if(r.isPinching)return;this._updateInputsFromEvent(t);const{isPen:u}=t,{isPenMode:d}=a;switch(t.name){case"pointer_down":{if(d&&!u)return;if(this.clearOpenMenus(),this.inputs.isPanning||(this._longPressTimeout=this.timers.setTimeout(()=>{this.dispatch({...t,point:this.inputs.currentScreenPoint,name:"long_press"})},this.options.longPressDurationMs)),this._selectedShapeIdsAtPointerDown=this.getSelectedShapeIds(),t.button===obe&&(this.capturedPointerId=t.pointerId),r.buttons.add(t.button),r.isPointing=!0,r.isDragging=!1,!d&&u&&this.updateInstanceState({isPenMode:!0}),t.button===sbe?(this._restoreToolId=this.getCurrentToolId(),this.complete(),this.setCurrentTool("eraser")):t.button===iA&&(this.inputs.isPanning||(this._prevCursor=this.getInstanceState().cursor.type),this.inputs.isPanning=!0,clearTimeout(this._longPressTimeout)),this.inputs.isPanning)return this.stopCameraAnimation(),this.setCursor({type:"grabbing",rotation:0}),this;break}case"pointer_move":{if(!u&&d)return;const{x:h,y:f,z:p}=CU(()=>this.getCamera());if(this.inputs.isPanning&&this.inputs.isPointing){const{currentScreenPoint:g,previousScreenPoint:m}=this.inputs,{panSpeed:v}=l,b=H.Sub(g,m);this.setCamera(new H(h+b.x*v/p,f+b.y*v/p,p),{immediate:!0}),this.maybeTrackPerformance("Panning");return}r.isPointing&&!r.isDragging&&H.Dist2(o,s)*this.getZoomLevel()>(a.isCoarsePointer?this.options.coarseDragDistanceSquared:this.options.dragDistanceSquared)/p&&(r.isDragging=!0,clearTimeout(this._longPressTimeout));break}case"pointer_up":{if(r.isDragging=!1,r.isPointing=!1,clearTimeout(this._longPressTimeout),r.buttons.delete(t.button),this.getIsMenuOpen()||a.isPenMode&&!u)return;if(this.capturedPointerId===t.pointerId&&(this.capturedPointerId=null,t.button=0),r.isPanning){r.keys.has("Space")||(r.isPanning=!1);const h=this.inputs.pointerVelocity,f=Math.min(2,h.len());switch(t.button){case obe:{this.setCursor({type:"grab",rotation:0});break}case iA:this.inputs.keys.has(" ")?this.setCursor({type:"grab",rotation:0}):this.setCursor({type:this._prevCursor,rotation:0})}f>0&&this.slideCamera({speed:f,direction:h})}else t.button===sbe&&(this.complete(),this.setCurrentTool(this._restoreToolId));break}}break}case"keyboard":{switch(t.key==="ShiftRight"&&(t.key="ShiftLeft"),t.key==="AltRight"&&(t.key="AltLeft"),t.code==="ControlRight"&&(t.code="ControlLeft"),t.name){case"key_down":{r.keys.add(t.code),t.code==="Space"&&!t.ctrlKey&&(this.inputs.isPanning||(this._prevCursor=a.cursor.type),this.inputs.isPanning=!0,clearTimeout(this._longPressTimeout),this.setCursor({type:this.inputs.isPointing?"grabbing":"grab",rotation:0}));break}case"key_up":{r.keys.delete(t.code),t.code==="Space"&&(this.inputs.buttons.has(iA)||(this.inputs.isPanning=!1,this.setCursor({type:this._prevCursor,rotation:0})));break}}break}}if(t.type==="pointer"){t.button===iA?t.name="middle_click":t.button===hie&&(t.name="right_click");const{isPenMode:u}=this.store.unsafeGetWithoutCapture(fl);if(t.isPen===u){const d=this._clickManager.handlePointerEvent(t);if(t.name!==d.name){this.root.handleEvent(t),this.emit("event",t),this.root.handleEvent(d),this.emit("event",d);return}}}return this.root.handleEvent(t),this.emit("event",t),this});this.options={...Q8t,...f},this.store=t,this.disposables.add(this.store.dispose.bind(this.store)),this.history=new _$t({store:t,annotateError:O=>{this.annotateError(O,{origin:"history.batch",willCrashApp:!0}),this.crash(O)}}),this.snaps=new AN(this),this.timers=new f4t,this.disposables.add(this.timers.dispose.bind(this.timers)),this._cameraOptions.set({...nbe,...c}),this._assetOptions.set({...rbe,...l}),this.user=new Gh(r??_$e(),h??!1),this.getContainer=a??(()=>document.body),this.textMeasure=new F$t(this),this._tickManager=new j$t(this);class p extends wO{}$(p,"initial",u??""),this.root=new p(this),this.root.children={};const g=R$e(i),m={},v={},b=new Map;for(const O of g){const M=new O(this);m[O.type]=M;const R=o8e(O.props??{});v[O.type]=R;for(const A of R.keys())if(!b.has(A.id))b.set(A.id,A);else if(b.get(A.id)!==A)throw Error(`Multiple style props with id "${A.id}" in use. Style prop IDs must be unique.`)}this.shapeUtils=m,this.styleProps=v;const S=k$e(o),E={};for(const O of S){const M=new O(this);E[O.type]=M}this.bindingUtils=E;for(const O of[...s]){if(ig(this.root.children,O.id))throw Error(`Can't override tool with id "${O.id}"`);this.root.children[O.id]=new O(this,this.root)}this.environment=new v$t(this),this.scribbles=new x$t(this);const w=(O,M)=>{let R=null;const A=O.selectedShapeIds.filter(j=>!M.has(j));A.length!==O.selectedShapeIds.length&&(R||(R={...O}),R.selectedShapeIds=A);const k=O.erasingShapeIds.filter(j=>!M.has(j));k.length!==O.erasingShapeIds.length&&(R||(R={...O}),R.erasingShapeIds=k),O.hoveredShapeId&&M.has(O.hoveredShapeId)&&(R||(R={...O}),R.hoveredShapeId=null),O.editingShapeId&&M.has(O.editingShapeId)&&(R||(R={...O}),R.editingShapeId=null);const L=O.hintingShapeIds.filter(j=>!M.has(j));return L.length!==O.hintingShapeIds.length&&(R||(R={...O}),R.hintingShapeIds=L),O.focusedGroupId&&M.has(O.focusedGroupId)&&(R||(R={...O}),R.focusedGroupId=null),R};this.sideEffects=this.store.sideEffects;let C=new Map;const I=new Set,T=new Set;let D=new Set;if(this.disposables.add(this.sideEffects.registerOperationCompleteHandler(()=>{var O,M,R,A;I.clear();for(const k of T){T.delete(k);const L=this.getShape(k);if(!L)continue;const j=this.getShapeUtil(L),N=(O=j.onChildrenChange)==null?void 0:O.call(j,L);N!=null&&N.length&&this.updateShapes(N)}if(D.size){const k=D;D=new Set;for(const L of k){const j=this.getBindingUtil(L);(M=j.onOperationComplete)==null||M.call(j)}}if(C.size){const k=C;C=new Map;for(const L of k.values())(A=(R=this.getBindingUtil(L.binding)).onAfterDelete)==null||A.call(R,L)}this.emit("update")})),this.disposables.add(this.sideEffects.register({shape:{afterChange:(O,M)=>{var R,A,k,L;for(const j of this.getBindingsInvolvingShape(M))D.add(j.type),j.fromId===M.id&&((A=(R=this.getBindingUtil(j)).onAfterChangeFromShape)==null||A.call(R,{binding:j,shapeBefore:O,shapeAfter:M})),j.toId===M.id&&((L=(k=this.getBindingUtil(j)).onAfterChangeToShape)==null||L.call(k,{binding:j,shapeBefore:O,shapeAfter:M}));if(O.parentId!==M.parentId){const j=N=>{var U,K,z,G;const B=this.getShape(N);if(B)for(const te of this.getBindingsInvolvingShape(B))D.add(te.type),te.fromId===B.id&&((K=(U=this.getBindingUtil(te)).onAfterChangeFromShape)==null||K.call(U,{binding:te,shapeBefore:B,shapeAfter:B})),te.toId===B.id&&((G=(z=this.getBindingUtil(te)).onAfterChangeToShape)==null||G.call(z,{binding:te,shapeBefore:B,shapeAfter:B}))};j(M.id),this.visitDescendants(M.id,j)}if(O.parentId!==M.parentId&&Cu(M.parentId)){const j=new Set([O.id]);this.visitDescendants(O.id,N=>{j.add(N)});for(const N of this.getPageStates()){if(N.pageId===M.parentId)continue;const B=w(N,j);B&&this.store.put([B])}}O.parentId&&ku(O.parentId)&&T.add(O.parentId),M.parentId!==O.parentId&&ku(M.parentId)&&T.add(M.parentId)},beforeDelete:O=>{var k,L,j,N;if(I.has(O.id))return;O.parentId&&ku(O.parentId)&&T.add(O.parentId),I.add(O.id);const M=[];for(const B of this.getBindingsInvolvingShape(O)){D.add(B.type),M.push(B.id);const U=this.getBindingUtil(B);B.fromId===O.id?((k=U.onBeforeIsolateToShape)==null||k.call(U,{binding:B,removedShape:O}),(L=U.onBeforeDeleteFromShape)==null||L.call(U,{binding:B,shape:O})):((j=U.onBeforeIsolateFromShape)==null||j.call(U,{binding:B,removedShape:O}),(N=U.onBeforeDeleteToShape)==null||N.call(U,{binding:B,shape:O}))}M.length&&this.deleteBindings(M);const R=new Set([O.id]),A=qr(this.getPageStates().map(B=>w(B,R)));A.length&&this.store.put(A)}},binding:{beforeCreate:O=>{var R,A;const M=(A=(R=this.getBindingUtil(O)).onBeforeCreate)==null?void 0:A.call(R,{binding:O});return M||O},afterCreate:O=>{var M,R;D.add(O.type),(R=(M=this.getBindingUtil(O)).onAfterCreate)==null||R.call(M,{binding:O})},beforeChange:(O,M)=>{var A,k;const R=(k=(A=this.getBindingUtil(M)).onBeforeChange)==null?void 0:k.call(A,{bindingBefore:O,bindingAfter:M});return R||M},afterChange:(O,M)=>{var R,A;D.add(M.type),(A=(R=this.getBindingUtil(M)).onAfterChange)==null||A.call(R,{bindingBefore:O,bindingAfter:M})},beforeDelete:O=>{var M,R;(R=(M=this.getBindingUtil(O)).onBeforeDelete)==null||R.call(M,{binding:O})},afterDelete:O=>{var M,R;(R=(M=this.getBindingUtil(O)).onAfterDelete)==null||R.call(M,{binding:O}),D.add(O.type)}},page:{afterCreate:O=>{const M=Ff.createId(O.id),R=Oh.createId(O.id);this.store.has(M)||this.store.put([Ff.create({id:M})]),this.store.has(R)||this.store.put([Oh.create({id:R,pageId:O.id})])},afterDelete:(O,M)=>{var k,L;if(((k=this.getInstanceState())==null?void 0:k.currentPageId)===O.id){const j=(L=this.getPages().find(N=>N.id!==O.id))==null?void 0:L.id;j?this.store.put([{...this.getInstanceState(),currentPageId:j}]):M==="user"&&this.store.ensureStoreIsUsable()}const R=Ff.createId(O.id),A=Oh.createId(O.id);this.store.remove([R,A])}},instance:{afterChange:(O,M,R)=>{var A;if(!this.store.has(M.currentPageId)){const k=this.store.has(O.currentPageId)?O.currentPageId:(A=this.getPages()[0])==null?void 0:A.id;k?this.store.update(M.id,L=>({...L,currentPageId:k})):R==="user"&&this.store.ensureStoreIsUsable()}}},instance_page_state:{afterChange:(O,M)=>{if((O==null?void 0:O.selectedShapeIds)!==(M==null?void 0:M.selectedShapeIds)){const R=M.selectedShapeIds.filter(k=>{var j,N;let L=(j=this.getShape(k))==null?void 0:j.parentId;for(;ku(L);){if(M.selectedShapeIds.includes(L))return!1;L=(N=this.getShape(L))==null?void 0:N.parentId}return!0});let A=null;if(R.length>0){const k=this.findCommonAncestor(qr(R.map(L=>this.getShape(L))),L=>this.isShapeOfType(L,"group"));k&&(A=k)}else M!=null&&M.focusedGroupId&&(A=M.focusedGroupId);(R.length!==M.selectedShapeIds.length||A!==M.focusedGroupId)&&this.store.put([{...M,selectedShapeIds:R,focusedGroupId:A??null}])}}}})),this._currentPageShapeIds=d$t(this.store,()=>this.getCurrentPageId()),this._parentIdsToChildIds=u$t(this.store),this.disposables.add(this.store.listen(O=>{this.emit("change",O)})),this.disposables.add(this.history.dispose),this.history.ignore(()=>{this.store.ensureStoreIsUsable(),this._updateCurrentPageState({editingShapeId:null,hoveredShapeId:null,erasingShapeIds:[]})}),u&&this.root.children[u]===void 0)throw Error(`No state found for initialState "${u}".`);this.root.enter(void 0,"initial"),this.edgeScrollManager=new m$t(this),this.focusManager=new y$t(this,d),this.disposables.add(this.focusManager.dispose.bind(this.focusManager)),this.getInstanceState().followingUserId&&this.stopFollowingUser(),this.on("tick",this._flushEventsForTick),this.timers.requestAnimationFrame(()=>{this._tickManager.start()}),this.performanceTracker=new E6e}dispose(){this.disposables.forEach(t=>t()),this.disposables.clear(),this.isDisposed=!0}getShapeUtil(t){const r=typeof t=="string"?t:t.type,i=ju(this.shapeUtils,r);return ds(i,`No shape util found for type "${r}"`),i}getBindingUtil(t){const r=typeof t=="string"?t:t.type,i=ju(this.bindingUtils,r);return ds(i,`No binding util found for type "${r}"`),i}undo(){return this._flushEventsForTick(0),this.complete(),this.history.undo(),this}getCanUndo(){return this.history.getNumUndos()>0}redo(){return this._flushEventsForTick(0),this.complete(),this.history.redo(),this}getCanRedo(){return this.history.getNumRedos()>0}mark(t){return this.history.mark(t),this}bail(){return this.history.bail(),this}bailToMark(t){return this.history.bailToMark(t),this}batch(t,r){return this.history.batch(t,r),this}annotateError(t,{origin:r,willCrashApp:i,tags:o,extras:s}){const a=this.createErrorAnnotations(r,i);return Gre(t,{tags:{...a.tags,...o},extras:{...a.extras,...s}}),i&&this.store.markAsPossiblyCorrupted(),this}createErrorAnnotations(t,r){try{const i=this.getEditingShapeId();return{tags:{origin:t,willCrashApp:r},extras:{activeStateNode:this.root.getPath(),selectedShapes:this.getSelectedShapes(),editingShape:i?this.getShape(i):void 0,inputs:this.inputs}}}catch{return{tags:{origin:t,willCrashApp:r},extras:{}}}}getCrashingError(){return this._crashingError}crash(t){return this._crashingError=t,this.store.markAsPossiblyCorrupted(),this.emit("crash",{error:t}),this}getPath(){return this.root.getPath().split("root.")[1]}isIn(t){const r=t.split(".").reverse();let i=this.root;for(;r.length>0;){const o=r.pop();if(!o)return!0;const s=i.getCurrent();if((s==null?void 0:s.id)===o){if(r.length===0)return!0;i=s;continue}else return!1}return!1}isInAny(...t){return t.some(r=>this.isIn(r))}setCurrentTool(t,r={}){return this.root.transition(t,r),this}getCurrentTool(){return this.root.getCurrent()}getCurrentToolId(){const t=this.getCurrentTool();return t?t.getCurrentToolIdMask()??t.id:""}getStateDescendant(t){var o;const r=t.split(".").reverse();let i=this.root;for(;r.length>0;){const s=r.pop();if(!s)return i;const a=(o=i.children)==null?void 0:o[s];if(!a)return;i=a}return i}getDocumentSettings(){return this.store.get(eX)}updateDocumentSettings(t){return this.history.ignore(()=>{this.store.put([{...this.getDocumentSettings(),...t}])}),this}getInstanceState(){return this.store.get(fl)}updateInstanceState(t,r){return this._updateInstanceState(t,{history:"ignore",...r}),t.isChangingStyle!==void 0&&(clearTimeout(this._isChangingStyleTimeout),t.isChangingStyle===!0&&(this._isChangingStyleTimeout=this.timers.setTimeout(()=>{this._updateInstanceState({isChangingStyle:!1},{history:"ignore"})},2e3))),this}getOpenMenus(){return this.getInstanceState().openMenus}addOpenMenu(t){const r=new Set(this.getOpenMenus());return r.has(t)||(r.add(t),this.updateInstanceState({openMenus:[...r]})),this}deleteOpenMenu(t){const r=new Set(this.getOpenMenus());return r.has(t)&&(r.delete(t),this.updateInstanceState({openMenus:[...r]})),this}clearOpenMenus(){return this.getOpenMenus().length&&this.updateInstanceState({openMenus:[]}),this}getIsMenuOpen(){return this.getOpenMenus().length>0}getPageStates(){return this._getPageStatesQuery().get()}_getPageStatesQuery(){return this.store.query.records("instance_page_state")}getCurrentPageState(){return this.store.get(this._getCurrentPageStateId())}_getCurrentPageStateId(){return Oh.createId(this.getCurrentPageId())}updateCurrentPageState(t,r){return this._updateCurrentPageState(t,r),this}getSelectedShapeIds(){return this.getCurrentPageState().selectedShapeIds}getSelectedShapes(){const{selectedShapeIds:t}=this.getCurrentPageState();return qr(t.map(r=>this.store.get(r)))}setSelectedShapes(t){return this.batch(()=>{const r=t.map(s=>typeof s=="string"?s:s.id),{selectedShapeIds:i}=this.getCurrentPageState(),o=new Set(i);if(r.length===o.size&&r.every(s=>o.has(s)))return null;this.store.put([{...this.getCurrentPageState(),selectedShapeIds:r}])},{history:"record-preserveRedoStack"})}isAncestorSelected(t){const r=typeof t=="string"?t:(t==null?void 0:t.id)??null,i=this.getShape(r);if(!i)return!1;const o=this.getSelectedShapeIds();return!!this.findShapeAncestor(i,s=>o.includes(s.id))}select(...t){const r=typeof t[0]=="string"?t:t.map(i=>i.id);return this.setSelectedShapes(r),this}deselect(...t){const r=typeof t[0]=="string"?t:t.map(o=>o.id),i=this.getSelectedShapeIds();return i.length>0&&r.length>0&&this.setSelectedShapes(i.filter(o=>!r.includes(o))),this}selectAll(){const t=this.getSortedChildIdsForParent(this.getCurrentPageId());return t.length<=0?this:(this.setSelectedShapes(this._getUnlockedShapeIds(t)),this)}selectNone(){return this.getSelectedShapeIds().length>0&&this.setSelectedShapes([]),this}getOnlySelectedShapeId(){var t;return((t=this.getOnlySelectedShape())==null?void 0:t.id)??null}getOnlySelectedShape(){const t=this.getSelectedShapes();return t.length===1?t[0]:null}getSelectionPageBounds(){const t=this.getCurrentPageState().selectedShapeIds;return t.length===0?null:xn.Common(qr(t.map(r=>this.getShapePageBounds(r))))}getSelectionRotation(){const t=this.getSelectedShapeIds();let r=!1,i=0;for(let o=0,s=t.length;o<s;o++){const a=this.getShapePageTransform(t[o]);if(a)if(r){if(a.rotation()!==i)return 0}else r=!0,i=a.rotation()}return i}getSelectionRotatedPageBounds(){const t=this.getSelectedShapeIds();if(t.length===0)return;const r=this.getSelectionRotation();if(r===0)return this.getSelectionPageBounds();if(t.length===1){const o=this.getShapeGeometry(t[0]).bounds.clone(),s=this.getShapePageTransform(t[0]);return o.point=s.applyToPoint(o.point),o}const i=xn.FromPoints(this.getSelectedShapeIds().flatMap(o=>{const s=this.getShapePageTransform(o);return s?s.applyToPoints(this.getShapeGeometry(o).bounds.corners):[]}).map(o=>o.rot(-r)));return i.point=i.point.rot(r),i}getSelectionRotatedScreenBounds(){const t=this.getSelectionRotatedPageBounds();if(!t)return;const{x:r,y:i}=this.pageToScreen(t.point),o=this.getZoomLevel();return new xn(r,i,t.width*o,t.height*o)}getFocusedGroupId(){return this.getCurrentPageState().focusedGroupId??this.getCurrentPageId()}getFocusedGroup(){const t=this.getFocusedGroupId();return t?this.getShape(t):void 0}setFocusedGroup(t){const r=typeof t=="string"?t:(t==null?void 0:t.id)??null;if(r!==null){const i=this.getShape(r);if(!i)throw Error(`Editor.setFocusedGroup: Shape with id ${r} does not exist`);if(!this.isShapeOfType(i,"group"))throw Error(`Editor.setFocusedGroup: Cannot set focused group to shape of type ${i.type}`)}return r===this.getFocusedGroupId()?this:this.batch(()=>{this.store.update(this.getCurrentPageState().id,i=>({...i,focusedGroupId:r}))},{history:"record-preserveRedoStack"})}popFocusedGroupId(){const t=this.getFocusedGroup();if(t){const r=this.findShapeAncestor(t,i=>this.isShapeOfType(i,"group"));this.setFocusedGroup((r==null?void 0:r.id)??null),this.select(t.id)}else this.setFocusedGroup(null),this.selectNone();return this}getEditingShapeId(){return this.getCurrentPageState().editingShapeId}getEditingShape(){const t=this.getEditingShapeId();return t?this.getShape(t):void 0}setEditingShape(t){const r=typeof t=="string"?t:(t==null?void 0:t.id)??null;if(r!==this.getEditingShapeId()){if(r){const i=this.getShape(r);if(i&&this.getShapeUtil(i).canEdit(i))return this._updateCurrentPageState({editingShapeId:r}),this}this._updateCurrentPageState({editingShapeId:null})}return this}getHoveredShapeId(){return this.getCurrentPageState().hoveredShapeId}getHoveredShape(){const t=this.getHoveredShapeId();return t?this.getShape(t):void 0}setHoveredShape(t){const r=typeof t=="string"?t:(t==null?void 0:t.id)??null;return r===this.getHoveredShapeId()?this:(this.updateCurrentPageState({hoveredShapeId:r},{history:"ignore"}),this)}getHintingShapeIds(){return this.getCurrentPageState().hintingShapeIds}getHintingShape(){const t=this.getHintingShapeIds();return qr(t.map(r=>this.getShape(r)))}setHintingShapes(t){const r=typeof t[0]=="string"?t:t.map(i=>i.id);return this.updateCurrentPageState({hintingShapeIds:Kre(r)},{history:"ignore"}),this}getErasingShapeIds(){return this.getCurrentPageState().erasingShapeIds}getErasingShapes(){const t=this.getErasingShapeIds();return qr(t.map(r=>this.getShape(r)))}setErasingShapes(t){const r=typeof t[0]=="string"?t:t.map(o=>o.id);r.sort();const i=this.getErasingShapeIds();return this.history.ignore(()=>{if(r.length===i.length){for(let o=0;o<r.length;o++)if(r[o]!==i[o]){this._updateCurrentPageState({erasingShapeIds:r});break}}else this._updateCurrentPageState({erasingShapeIds:r})}),this}getCroppingShapeId(){return this.getCurrentPageState().croppingShapeId}setCroppingShape(t){const r=typeof t=="string"?t:(t==null?void 0:t.id)??null;if(r!==this.getCroppingShapeId())if(!r)this.updateCurrentPageState({croppingShapeId:null});else{const i=this.getShape(r),o=this.getShapeUtil(i);i&&o.canCrop(i)&&this.updateCurrentPageState({croppingShapeId:r})}return this}getCameraId(){return Ff.createId(this.getCurrentPageId())}getCamera(){const t=this.store.get(this.getCameraId());if(this._isLockedOnFollowingUser.get()){const r=this.getCameraForFollowing();if(r)return{...t,...r}}return t}getViewportPageBoundsForFollowing(){const t=this.getInstanceState().followingUserId;if(!t)return null;const r=this.getCollaborators().find(h=>h.userId===t);if(!r)return null;const{w:i,h:o}=r.screenBounds,{x:s,y:a,z:c}=r.camera,l=new xn(-s,-a,i/c,o/c),u=this.getViewportScreenBounds().clone(),d=u.width/u.height;return u.width=l.width,u.height=u.width/d,u.height<l.height&&(u.height=l.height,u.width=u.height*d),u.center=l.center,u}getCameraForFollowing(){const t=this.getViewportPageBoundsForFollowing();return t?{x:-t.x,y:-t.y,z:this.getViewportScreenBounds().w/t.width}:null}getZoomLevel(){return this.getCamera().z}getInitialZoom(){const t=this.getCameraOptions();if(!t.constraints||t.constraints.initialZoom==="default")return 1;const{zx:r,zy:i}=Abe(this,t);switch(t.constraints.initialZoom){case"fit-min":return Math.max(r,i);case"fit-max":return Math.min(r,i);case"fit-x":return r;case"fit-y":return i;case"fit-min-100":return Math.min(1,Math.max(r,i));case"fit-max-100":return Math.min(1,Math.min(r,i));case"fit-x-100":return Math.min(1,r);case"fit-y-100":return Math.min(1,i);default:throw vl(t.constraints.initialZoom)}}getBaseZoom(){const t=this.getCameraOptions();if(!t.constraints||t.constraints.baseZoom==="default")return 1;const{zx:r,zy:i}=Abe(this,t);switch(t.constraints.baseZoom){case"fit-min":return Math.max(r,i);case"fit-max":return Math.min(r,i);case"fit-x":return r;case"fit-y":return i;case"fit-min-100":return Math.min(1,Math.max(r,i));case"fit-max-100":return Math.min(1,Math.min(r,i));case"fit-x-100":return Math.min(1,r);case"fit-y-100":return Math.min(1,i);default:throw vl(t.constraints.baseZoom)}}getCameraOptions(){return this._cameraOptions.get()}setCameraOptions(t){var i;const r=ls({...this._cameraOptions.__unsafe__getWithoutCapture(),...t});return((i=r.zoomSteps)==null?void 0:i.length)<1&&(r.zoomSteps=[1]),this._cameraOptions.set(r),this}getConstrainedCamera(t,r){const i=this.getCamera();let{x:o,y:s,z:a=i.z}=t;if(!(r!=null&&r.force)){const c=this.getCameraOptions(),l=c.zoomSteps[0],u=Mc(c.zoomSteps),d=this.getViewportScreenBounds();if(c.constraints){const{constraints:h}=c,f=Math.min(h.padding.y,d.w/2),p=Math.min(h.padding.x,d.h/2),g=xn.From(c.constraints.bounds),m=(d.w-p*2)/g.w,v=(d.h-f*2)/g.h,b=this.getBaseZoom(),S=u*b,E=l*b;if(r!=null&&r.reset&&(a=this.getInitialZoom()),a<E||a>S){const{x:A,y:k,z:L}=i,j=-A+d.w/L/2,N=-k+d.h/L/2;a=Ja(a,E,S);const B=-A+d.w/a/2,U=-k+d.h/a/2;o=A+B-j,s=k+U-N}const w=p/a-g.x,C=f/a-g.y,I=(d.w-p*2)/a-g.w,T=(d.h-f*2)/a-g.h,D=w+I*h.origin.x,O=C+T*h.origin.y,M=typeof h.behavior=="string"?h.behavior:h.behavior.x,R=typeof h.behavior=="string"?h.behavior:h.behavior.y;if(r!=null&&r.reset)o=D,s=O;else{switch(M){case"fixed":{o=D;break}case"contain":{a<m?o=D:o=Ja(o,w+I,w);break}case"inside":{a<m?o=Ja(o,w,(d.w-p)/a-g.w):o=Ja(o,w+I,w);break}case"outside":{o=Ja(o,p/a-g.w,(d.w-p)/a);break}case"free":break;default:throw vl(M)}switch(R){case"fixed":{s=O;break}case"contain":{a<v?s=O:s=Ja(s,C+T,C);break}case"inside":{a<v?s=Ja(s,C,(d.h-f)/a-g.h):s=Ja(s,C+T,C);break}case"outside":{s=Ja(s,f/a-g.h,(d.h-f)/a);break}case"free":break;default:throw vl(R)}}}else if(a>u||a<l){const{x:h,y:f,z:p}=i;a=Ja(a,l,u),o=h+(-h+d.w/a/2)-(-h+d.w/p/2),s=f+(-f+d.h/a/2)-(-f+d.h/p/2)}}return{x:o,y:s,z:a}}_setCamera(t,r){const i=this.getCamera(),{x:o,y:s,z:a}=this.getConstrainedCamera(t,r);return i.x===o&&i.y===s&&i.z===a?this:(this.batch(()=>{const c={...i,x:o,y:s,z:a};this.history.ignore(()=>{this.store.put([c])});const{currentScreenPoint:l,currentPagePoint:u}=this.inputs,{screenBounds:d}=this.store.unsafeGetWithoutCapture(fl);if(l.x/a-o!==u.x||l.y/a-s!==u.y){const h={type:"pointer",target:"canvas",name:"pointer_move",point:H.AddXY(l,d.x,d.y),pointerId:ibe.CAMERA_MOVE,ctrlKey:this.inputs.ctrlKey,altKey:this.inputs.altKey,shiftKey:this.inputs.shiftKey,button:0,isPen:this.getInstanceState().isPenMode??!1};r!=null&&r.immediate?this._flushEventForTick(h):this.dispatch(h)}this._tickCameraState()}),this)}setCamera(t,r){const{isLocked:i}=this._cameraOptions.__unsafe__getWithoutCapture();if(i&&!(r!=null&&r.force))return this;this.stopCameraAnimation(),this.getInstanceState().followingUserId&&this.stopFollowingUser();const o=H.Cast(t);Number.isFinite(o.x)||(o.x=0),Number.isFinite(o.y)||(o.y=0),(o.z===void 0||!Number.isFinite(o.z))&&(t.z=this.getZoomLevel());const s=this.getConstrainedCamera(o,r);if(r!=null&&r.animation){const{width:a,height:c}=this.getViewportScreenBounds();this._animateToViewport(new xn(-s.x,-s.y,a/s.z,c/s.z),r)}else this._setCamera(s,{...r,force:!0});return this}centerOnPoint(t,r){if(this.getCameraOptions().isLocked)return this;const{width:i,height:o}=this.getViewportPageBounds();return this.setCamera(new H(-(t.x-i/2),-(t.y-o/2),this.getCamera().z),r),this}zoomToFit(t){const r=[...this.getCurrentPageShapeIds()];if(r.length<=0)return this;const i=xn.Common(qr(r.map(o=>this.getShapePageBounds(o))));return this.zoomToBounds(i,t),this}resetZoom(t=this.getViewportScreenCenter(),r){const{isLocked:i,constraints:o}=this.getCameraOptions();if(i)return this;const s=this.getCamera(),{x:a,y:c,z:l}=s,{x:u,y:d}=t;let h=1;if(o){const f=this.getInitialZoom();l!==f&&(h=f)}return this.setCamera(new H(a+(u/h-u)-(u/l-u),c+(d/h-d)-(d/l-d),h),r),this}zoomIn(t=this.getViewportScreenCenter(),r){if(this.getCameraOptions().isLocked)return this;const{x:i,y:o,z:s}=this.getCamera(),{zoomSteps:a}=this.getCameraOptions();if(a!==null&&a.length>1){const c=this.getBaseZoom();let l=Mc(a)*c;for(let u=1;u<a.length;u++){const d=a[u-1]*c,h=a[u]*c;if(!(h-s<=(h-d)/2)){l=h;break}}this.setCamera(new H(i+(t.x/l-t.x)-(t.x/s-t.x),o+(t.y/l-t.y)-(t.y/s-t.y),l),r)}return this}zoomOut(t=this.getViewportScreenCenter(),r){if(this.getCameraOptions().isLocked)return this;const{zoomSteps:i}=this.getCameraOptions();if(i!==null&&i.length>1){const o=this.getBaseZoom(),{x:s,y:a,z:c}=this.getCamera();let l=i[0]*o;for(let u=i.length-1;u>0;u--){const d=i[u-1]*o,h=i[u]*o;if(!(h-c>=(h-d)/2)){l=d;break}}this.setCamera(new H(s+(t.x/l-t.x)-(t.x/c-t.x),a+(t.y/l-t.y)-(t.y/c-t.y),l),r)}return this}zoomToSelection(t){if(this.getCameraOptions().isLocked)return this;const r=this.getSelectionPageBounds();return r&&this.zoomToBounds(r,{targetZoom:Math.max(1,this.getZoomLevel()),...t}),this}zoomToBounds(t,r){const i=this._cameraOptions.__unsafe__getWithoutCapture();if(i.isLocked)return this;const o=this.getViewportScreenBounds(),s=(r==null?void 0:r.inset)??Math.min(mMt,o.width*.28),a=this.getBaseZoom(),c=i.zoomSteps[0],l=Mc(i.zoomSteps);let u=Ja(Math.min((o.width-s)/t.w,(o.height-s)/t.h),c*a,l*a);return(r==null?void 0:r.targetZoom)!==void 0&&(u=Math.min(r.targetZoom,u)),this.setCamera(new H(-t.x+(o.width-t.w*u)/2/u,-t.y+(o.height-t.h*u)/2/u,u),r),this}stopCameraAnimation(){return this.emit("stop-camera-animation"),this}_animateViewport(t){if(!this._viewportAnimation)return;this._viewportAnimation.elapsed+=t;const{elapsed:r,easing:i,duration:o,start:s,end:a}=this._viewportAnimation;if(r>o){this.off("tick",this._animateViewport),this._viewportAnimation=null,this._setCamera(new H(-a.x,-a.y,this.getViewportScreenBounds().width/a.width));return}const c=o-r,l=i(1-c/o),u=s.minX+(a.minX-s.minX)*l,d=s.minY+(a.minY-s.minY)*l,h=s.maxX+(a.maxX-s.maxX)*l;this._setCamera(new H(-u,-d,this.getViewportScreenBounds().width/(h-u)),{force:!0})}_animateToViewport(t,r={animation:PU}){const{animation:i,...o}=r;if(!i)return;const{duration:s=0,easing:a=uc.easeInOutCubic}=i,c=this.user.getAnimationSpeed(),l=this.getViewportPageBounds();return this.stopCameraAnimation(),this.getInstanceState().followingUserId&&this.stopFollowingUser(),s===0||c===0?this._setCamera(new H(-t.x,-t.y,this.getViewportScreenBounds().width/t.width),{...o}):(this._viewportAnimation={elapsed:0,duration:s/c,easing:a,start:l.clone(),end:t.clone()},this.once("stop-camera-animation",()=>{this.off("tick",this._animateViewport),this._viewportAnimation=null}),this.on("tick",this._animateViewport),this)}slideCamera(t={}){if(this.getCameraOptions().isLocked)return this;if(this.user.getAnimationSpeed()===0)return this;this.stopCameraAnimation();const{speed:i,friction:o=this.options.cameraSlideFriction,direction:s,speedThreshold:a=.01}=t;let c=Math.min(i,1);const l=()=>{this.off("tick",u),this.off("stop-camera-animation",l)};this.once("stop-camera-animation",l);const u=d=>{const{x:h,y:f,z:p}=this.getCamera(),g=H.Mul(s,c*d/p);c*=1-o,c<a?l():this._setCamera(new H(h+g.x,f+g.y,p))};return this.on("tick",u),this}zoomToUser(t,r={animation:{duration:500}}){const i=this.getCollaborators().find(o=>o.userId===t);return i?(this.batch(()=>{this.getInstanceState().followingUserId!==null&&this.stopFollowingUser();const o=i.currentPageId===this.getCurrentPageId();o||this.setCurrentPage(i.currentPageId),r&&r.animation&&!o&&(r.animation=void 0),this.centerOnPoint(i.cursor,r);const{highlightedUserIds:s}=this.getInstanceState();this.updateInstanceState({highlightedUserIds:[...s,t]}),this.timers.setTimeout(()=>{const a=[...this.getInstanceState().highlightedUserIds],c=a.indexOf(t);c<0||(a.splice(c,1),this.updateInstanceState({highlightedUserIds:a}))},this.options.collaboratorIdleTimeoutMs)}),this):this}updateViewportScreenBounds(t,r=!1){t.width=Math.max(t.width,1),t.height=Math.max(t.height,1);const i=[t.minY!==0,!sy(document.body.scrollWidth,t.maxX,1),!sy(document.body.scrollHeight,t.maxY,1),t.minX!==0],{screenBounds:o,insets:s}=this.getInstanceState();if(t.equals(o)&&i.every((c,l)=>c===s[l]))return this;const{_willSetInitialBounds:a}=this;if(this._willSetInitialBounds=!1,a)this.updateInstanceState({screenBounds:t.toJson(),insets:i}),this.setCamera(this.getCamera());else if(r&&!this.getInstanceState().followingUserId){const c=this.getViewportPageBounds().center;this.updateInstanceState({screenBounds:t.toJson(),insets:i}),this.centerOnPoint(c)}else this.updateInstanceState({screenBounds:t.toJson(),insets:i}),this._setCamera(H.From({...this.getCamera()}));return this._tickCameraState(),this}getViewportScreenBounds(){const{x:t,y:r,w:i,h:o}=this.getInstanceState().screenBounds;return new xn(t,r,i,o)}getViewportScreenCenter(){const t=this.getViewportScreenBounds();return new H(t.midX-t.minX,t.midY-t.minY)}getViewportPageBounds(){const{w:t,h:r}=this.getViewportScreenBounds(),{x:i,y:o,z:s}=this.getCamera();return new xn(-i,-o,t/s,r/s)}screenToPage(t){const{screenBounds:r}=this.store.unsafeGetWithoutCapture(fl),{x:i,y:o,z:s=1}=this.getCamera();return new H((t.x-r.x)/s-i,(t.y-r.y)/s-o,t.z??.5)}pageToScreen(t){const{screenBounds:r}=this.store.unsafeGetWithoutCapture(fl),{x:i,y:o,z:s=1}=this.getCamera();return new H((t.x+i)*s+r.x,(t.y+o)*s+r.y,t.z??.5)}pageToViewport(t){const{x:r,y:i,z:o=1}=this.getCamera();return new H((t.x+r)*o,(t.y+i)*o,t.z??.5)}_getCollaboratorsQuery(){return this.store.query.records("instance_presence",()=>({userId:{neq:this.user.getId()}}))}getCollaborators(){const t=this._getCollaboratorsQuery().get();return t.length?[...new Set(t.map(i=>i.userId))].sort().map(i=>t.filter(s=>s.userId===i).sort((s,a)=>a.lastActivityTimestamp-s.lastActivityTimestamp)[0]):Km}getCollaboratorsOnCurrentPage(){const t=this.getCurrentPageId();return this.getCollaborators().filter(r=>r.currentPageId===t)}startFollowingUser(t){this.stopFollowingUser();const r=this._getCollaboratorsQuery().get().filter(s=>s.userId===t);if(!r.length)return console.warn("User not found"),this;const i=this.user.getId();if(i||console.warn("You should set the userId for the current instance before following a user"),r.some(s=>s.followingUserId===i))return this;const o=Et("latestLeaderPresence",()=>this.getCollaborators().find(s=>s.userId===t));return Gm(()=>{this.updateInstanceState({followingUserId:t},{history:"ignore"});const s=Zy("update current page",()=>{const l=o.get();if(!l){this.stopFollowingUser();return}l.currentPageId!==this.getCurrentPageId()&&this.getPage(l.currentPageId)&&this.history.ignore(()=>{this.store.put([{...this.getInstanceState(),currentPageId:l.currentPageId}]),this._isLockedOnFollowingUser.set(!0)})}),a=()=>{s(),this._isLockedOnFollowingUser.set(!1),this.off("frame",c),this.off("stop-following",a)},c=()=>{if(!o.get()){this.stopFollowingUser();return}if(this._isLockedOnFollowingUser.get())return;const u=this.user.getAnimationSpeed();if(u===0){this._isLockedOnFollowingUser.set(!0);return}const d=this.getViewportPageBoundsForFollowing();if(!d){this.stopFollowingUser();return}const h=this.getViewportPageBounds(),f=Math.abs(d.minX-h.minX)+Math.abs(d.maxX-h.maxX),p=Math.abs(d.minY-h.minY)+Math.abs(d.maxY-h.maxY);if(f<this.options.followChaseViewportSnap&&p<this.options.followChaseViewportSnap){this._isLockedOnFollowingUser.set(!0);return}const g=Ja(u*.5,.1,.8),m=new xn(X5(h.minX,d.minX,g),X5(h.minY,d.minY,g),X5(h.width,d.width,g),X5(h.height,d.height,g)),v=new H(-m.x,-m.y,this.getViewportScreenBounds().width/m.width);this.stopCameraAnimation(),this._setCamera(v)};this.once("stop-following",a),this.addListener("frame",c),c()}),this}stopFollowingUser(){return this.history.ignore(()=>{this.store.put([this.getCamera()]),this._isLockedOnFollowingUser.set(!1),this.updateInstanceState({followingUserId:null}),this.emit("stop-following")}),this}getUnorderedRenderingShapes(t){const r=[];let i=this.options.maxShapesPerPage*2,o=this.options.maxShapesPerPage;const s=this.getErasingShapeIds(),a=(l,u,d)=>{const h=this.getShape(l);if(!h)return;u*=h.opacity;let f=!1;const p=this.getShapeUtil(h);t&&(f=!d&&s.includes(l),f&&(u*=.32)),r.push({id:l,shape:h,util:p,index:i,backgroundIndex:o,opacity:u}),i+=1,o+=1;const g=this.getSortedChildIdsForParent(l);if(!g.length)return;let m=null;p.providesBackgroundForChildren(h)&&(m=o,o=i,i+=this.options.maxShapesPerPage);for(const v of g)a(v,u,d||f);m!==null&&(o=m)},c=t?[this.getCurrentPage()]:this.getPages();for(const l of c)for(const u of this.getSortedChildIdsForParent(l.id))a(u,1,!1);return r}getCameraState(){return this._cameraState.get()}getRenderingShapes(){return this.getUnorderedRenderingShapes(!0).sort(a4t)}_getAllPagesQuery(){return this.store.query.records("page")}getPages(){return this._getAllPagesQuery().get().sort(ml)}getCurrentPage(){return this.getPage(this.getCurrentPageId())}getCurrentPageId(){return this.getInstanceState().currentPageId}getPage(t){return this.store.get(typeof t=="string"?t:t.id)}getCurrentPageShapeIds(){return this._currentPageShapeIds.get()}getCurrentPageShapeIdsSorted(){return Array.from(this.getCurrentPageShapeIds()).sort()}getPageShapeIds(t){const r=typeof t=="string"?t:t.id,i=this.store.query.exec("shape",{parentId:{eq:r}});return this.getShapeAndDescendantIds(i.map(o=>o.id))}setCurrentPage(t){const r=typeof t=="string"?t:t.id;return this.store.has(r)?(this.stopFollowingUser(),this.complete(),this.batch(()=>this.store.put([{...this.getInstanceState(),currentPageId:r}]),{history:"record-preserveRedoStack"})):(console.error("Tried to set the current page id to a page that doesn't exist."),this)}updatePage(t){return this.getInstanceState().isReadonly?this:this.getPage(t.id)?this.batch(()=>this.store.update(t.id,i=>({...i,...t}))):this}createPage(t){return this.history.batch(()=>{if(this.getInstanceState().isReadonly||this.getPages().length>=this.options.maxPages)return;const r=this.getPages(),i=n$t(t.name??"Page 1",r.map(a=>a.name));let o=t.index;(!o||r.some(a=>a.index===o))&&(o=Om(r[r.length-1].index));const s=dv.create({meta:{},...t,name:i,index:o});this.store.put([s])}),this}deletePage(t){const r=typeof t=="string"?t:t.id;return this.batch(()=>{if(this.getInstanceState().isReadonly)return;const i=this.getPages();if(i.length===1)return;const o=this.getPage(r);if(o){if(r===this.getCurrentPageId()){const s=i.findIndex(c=>c.id===r),a=i[s-1]??i[s+1];this.setCurrentPage(a.id)}this.store.remove([o.id])}}),this}duplicatePage(t,r=dv.createId()){if(this.getPages().length>=this.options.maxPages)return this;const i=typeof t=="string"?t:t.id,o=this.getPage(i);if(!o)return this;const s={...this.getCamera()},a=this.getContentFromCurrentPage(this.getSortedChildIdsForParent(o.id));return this.batch(()=>{var u;const c=this.getPages(),l=F3(o.index,(u=c[c.indexOf(o)+1])==null?void 0:u.index);if(this.createPage({name:o.name+" Copy",id:r,index:l}),this.setCurrentPage(r),this.setCamera(s),a)return this.putContentOntoCurrentPage(a)}),this}renamePage(t,r){const i=typeof t=="string"?t:t.id;return this.getInstanceState().isReadonly?this:(this.updatePage({id:i,name:r}),this)}_getAllAssetsQuery(){return this.store.query.records("asset")}getAssets(){return this._getAllAssetsQuery().get()}createAssets(t){return this.getInstanceState().isReadonly?this:t.length<=0?this:(this.history.ignore(()=>this.store.put(t)),this)}updateAssets(t){return this.getInstanceState().isReadonly?this:t.length<=0?this:(this.history.ignore(()=>{this.store.put(t.map(r=>({...this.store.get(r.id),...r})))}),this)}deleteAssets(t){if(this.getInstanceState().isReadonly)return this;const r=typeof t[0]=="string"?t:t.map(i=>i.id);return r.length<=0?this:(this.history.ignore(()=>this.store.remove(r)),this)}getAsset(t){return this.store.get(typeof t=="string"?t:t.id)}async resolveAssetUrl(t,r){if(!t)return"";const i=this.getAsset(t);if(!i)return"";const{screenScale:o,shouldResolveToOriginalImage:s}=r,c=Math.max(.125,(d=>Math.pow(2,Math.ceil(Math.log2(d))))(o||1)),l="connection"in navigator?navigator.connection.effectiveType:null,u=this.getInstanceState().devicePixelRatio;return await this._assetOptions.get().onResolveAsset(i,{screenScale:o||1,steppedScreenScale:c,dpr:u,networkEffectiveType:l,shouldResolveToOriginalImage:s})}_getShapeGeometryCache(){return this.store.createComputedCache("bounds",t=>this.getShapeUtil(t).getGeometry(t),(t,r)=>t.props===r.props)}getShapeGeometry(t){return this._getShapeGeometryCache().get(typeof t=="string"?t:t.id)}_getShapeHandlesCache(){return this.store.createComputedCache("handles",t=>{var r,i;return(i=(r=this.getShapeUtil(t)).getHandles)==null?void 0:i.call(r,t)})}getShapeHandles(t){return this._getShapeHandlesCache().get(typeof t=="string"?t:t.id)}getShapeLocalTransform(t){const r=typeof t=="string"?t:t.id,i=this.getShape(r);if(!i)throw Error("Editor.getTransform: shape not found");return Mn.Identity().translate(i.x,i.y).rotate(i.rotation)}_getShapePageTransformCache(){return this.store.createComputedCache("pageTransformCache",t=>{if(Cu(t.parentId))return this.getShapeLocalTransform(t);const r=this._getShapePageTransformCache().get(t.parentId)??Mn.Identity();return Mn.Compose(r,this.getShapeLocalTransform(t))})}getShapeParentTransform(t){const r=typeof t=="string"?t:t.id,i=this.getShape(r);return!i||Cu(i.parentId)?Mn.Identity():this._getShapePageTransformCache().get(i.parentId)??Mn.Identity()}getShapePageTransform(t){const r=typeof t=="string"?t:t.id;return this._getShapePageTransformCache().get(r)??Mn.Identity()}_getShapePageBoundsCache(){return this.store.createComputedCache("pageBoundsCache",t=>{const r=this._getShapePageTransformCache().get(t.id);return r?xn.FromPoints(Mn.applyToPoints(r,this.getShapeGeometry(t).vertices)):new xn})}getShapePageBounds(t){return this._getShapePageBoundsCache().get(typeof t=="string"?t:t.id)}_getShapeClipPathCache(){return this.store.createComputedCache("clipPathCache",t=>{const r=this._getShapeMaskCache().get(t.id);if(!r)return;if(r.length===0)return"polygon(0px 0px, 0px 0px, 0px 0px)";const i=this._getShapePageTransformCache().get(t.id);return i?`polygon(${Mn.applyToPoints(Mn.Inverse(i),r).map(s=>`${s.x}px ${s.y}px`).join(",")})`:void 0})}getShapeClipPath(t){return this._getShapeClipPathCache().get(typeof t=="string"?t:t.id)}_getShapeMaskCache(){return this.store.createComputedCache("pageMaskCache",t=>{if(Cu(t.parentId))return;const r=this.getShapeAncestors(t.id).filter(o=>this.isShapeOfType(o,"frame"));return r.length===0?void 0:r.map(o=>this._getShapePageTransformCache().get(o.id).applyToPoints(this.getShapeGeometry(o).vertices)).reduce((o,s)=>{if(!(s&&o))return;const a=Ebe(o,s);return a?a.map(H.Cast):[]})})}getShapeMask(t){return this._getShapeMaskCache().get(typeof t=="string"?t:t.id)}getShapeMaskedPageBounds(t){return typeof t!="string"&&(t=t.id),this._getShapeMaskedPageBoundsCache().get(t)}_getShapeMaskedPageBoundsCache(){return this.store.createComputedCache("shapeMaskedPageBoundsCache",t=>{const r=this._getShapePageBoundsCache().get(t.id);if(!r)return;const i=this._getShapeMaskCache().get(t.id);if(i){if(i.length===0)return;const{corners:o}=r;if(o.every((a,c)=>a&&H.Equals(a,i[c])))return r.clone();const s=Ebe(i,o);return s?xn.FromPoints(s):void 0}return r})}getShapeAncestors(t,r=[]){const i=typeof t=="string"?t:t.id,o=this.getShape(i);if(!o)return r;const s=o.parentId;if(Cu(s))return r.reverse(),r;const a=this.store.get(s);return a?(r.push(a),this.getShapeAncestors(a,r)):r}findShapeAncestor(t,r){const i=typeof t=="string"?t:t.id,o=this.getShape(i);if(!o)return;const s=o.parentId;if(Cu(s))return;const a=this.getShape(s);if(a)return r(a)?a:this.findShapeAncestor(a,r)}hasAncestor(t,r){const i=typeof t=="string"?t:t==null?void 0:t.id,o=i&&this.getShape(i);return o?o.parentId===r?!0:this.hasAncestor(this.getShapeParent(o),r):!1}findCommonAncestor(t,r){var l;if(t.length===0)return;const i=typeof t[0]=="string"?t:t.map(u=>u.id),o=qr(i.map(u=>this.getShape(u)));if(o.length===1){const u=o[0].parentId;return Cu(u)?void 0:r?(l=this.findShapeAncestor(o[0],r))==null?void 0:l.id:u}const[s,...a]=o;let c=this.getShapeParent(s);for(;c;){if(r&&!r(c)){c=this.getShapeParent(c);continue}if(a.every(u=>this.hasAncestor(u,c.id)))return c.id;c=this.getShapeParent(c)}}isShapeOrAncestorLocked(t){const r=typeof t=="string"?this.getShape(t):t;return r===void 0?!1:r.isLocked?!0:this.isShapeOrAncestorLocked(this.getShapeParent(r))}_notVisibleShapes(){return l$t(this)}getCulledShapes(){const t=this._notVisibleShapes().get(),r=this.getSelectedShapeIds(),i=this.getEditingShapeId(),o=new Set(t);return i&&o.delete(i),r.forEach(s=>{o.delete(s)}),o}getCurrentPageBounds(){let t;return this.getCurrentPageShapeIdsSorted().forEach(r=>{const i=this.getShapeMaskedPageBounds(r);i&&(t?t=t.expand(i):t=i.clone())}),t}getSelectedShapeAtPoint(t){const r=this.getSelectedShapeIds();return this.getCurrentPageShapesSorted().filter(i=>i.type!=="group"&&r.includes(i.id)).reverse().find(i=>this.isPointInShape(i,t,{hitInside:!0,margin:0}))}getShapeAtPoint(t,r={}){const i=this.getZoomLevel(),o=this.getViewportPageBounds(),{filter:s,margin:a=0,hitLocked:c=!1,hitLabels:l=!1,hitInside:u=!1,hitFrameInside:d=!1}=r;let h=1/0,f=null,p=1/0,g=null;const m=(r.renderingOnly?this.getCurrentPageRenderingShapesSorted():this.getCurrentPageShapesSorted()).filter(v=>{if(v.isLocked&&!c||this.isShapeOfType(v,"group"))return!1;const b=this.getShapeMask(v);return b&&!Fd(t,b)?!1:s?s(v):!0});for(let v=m.length-1;v>=0;v--){const b=m[v],S=this.getShapeGeometry(b),E=S instanceof Qf,w=this.getPointInShapeSpace(b,t);if((this.isShapeOfType(b,"arrow")||this.isShapeOfType(b,"geo")&&b.props.fill==="none")&&b.props.text.trim()){for(const I of S.children)if(I.isLabel&&I.isPointInBounds(w))return b}if(this.isShapeOfType(b,"frame")){const I=S.distanceToPoint(w,u);if(Math.abs(I)<=a)return g||b;if(S.hitTestPoint(w,0,!0))return g||f||(d?b:void 0);continue}let C;if(E){let I=1/0;for(const T of S.children){if(T.isLabel&&!l)continue;const D=T.distanceToPoint(w,u);D<I&&(I=D)}C=I}else a===0&&(S.bounds.w<1||S.bounds.h<1)||S.bounds.containsPoint(w,a)?C=S.distanceToPoint(w,u):C=1/0;if(S.isClosed){if(C<=a){if(S.isFilled||E&&S.children[0].isFilled)return g||b;if(this.getShapePageBounds(b).contains(o))continue;if(Math.abs(C)<a)Math.abs(C)<p&&(p=Math.abs(C),g=b);else if(!g){const{area:I}=S;I<h&&(h=I,f=b)}}}else if(C<this.options.hitTestMargin/i)return b}return g||f||void 0}getShapesAtPoint(t,r={}){return this.getCurrentPageShapes().filter(i=>this.isPointInShape(i,t,r))}isPointInShape(t,r,i={}){const{hitInside:o=!1,margin:s=0}=i,a=typeof t=="string"?t:t.id,c=this.getShapeMask(a);return c&&!Fd(r,c)?!1:this.getShapeGeometry(a).hitTestPoint(this.getPointInShapeSpace(t,r),s,o)}getPointInShapeSpace(t,r){const i=typeof t=="string"?t:t.id;return this._getShapePageTransformCache().get(i).clone().invert().applyToPoint(r)}getPointInParentSpace(t,r){const i=typeof t=="string"?t:t.id,o=this.getShape(i);if(!o)return new H(0,0);if(Cu(o.parentId))return H.From(r);const s=this.getShapePageTransform(o.parentId);return s?s.clone().invert().applyToPoint(r):H.From(r)}getCurrentPageShapes(){return Array.from(this.getCurrentPageShapeIds(),t=>this.store.get(t))}getCurrentPageShapesSorted(){const t=[],r=this.getSortedChildIdsForParent(this.getCurrentPageId());for(let i=0,o=r.length;i<o;i++)L$e(this,r[i],t);return t}getCurrentPageRenderingShapesSorted(){const t=this.getCulledShapes();return this.getCurrentPageShapesSorted().filter(({id:r})=>!t.has(r))}isShapeOfType(t,r){const i=typeof t=="string"?this.getShape(t):t;return i?i.type===r:!1}getShape(t){const r=typeof t=="string"?t:t.id;if(ku(r))return this.store.get(r)}getShapeParent(t){const r=typeof t=="string"?t:t==null?void 0:t.id;if(!r)return;const i=this.getShape(r);if(!(i===void 0||!ku(i.parentId)))return this.store.get(i.parentId)}getShapeNearestSibling(t,r){return r?r.parentId===t.parentId?r:this.findShapeAncestor(r,o=>o.parentId===t.parentId):void 0}isShapeInPage(t,r=this.getCurrentPageId()){const i=typeof t=="string"?t:t.id,o=this.getShape(i);if(!o)return!1;let s=!1;if(o.parentId===r)s=!0;else{let a=this.getShape(o.parentId);e:for(;a;){if(a.parentId===r){s=!0;break e}a=this.getShape(a.parentId)}}return s}getAncestorPageId(t){const r=typeof t=="string"?t:t==null?void 0:t.id,i=r&&this.getShape(r);if(i)return Cu(i.parentId)?i.parentId:this.getAncestorPageId(this.getShape(i.parentId))}reparentShapes(t,r,i){const o=typeof t[0]=="string"?t:t.map(p=>p.id);if(o.length===0)return this;const s=[],a=Cu(r)?Mn.Identity():this.getShapePageTransform(r),c=a.rotation();let l=[];const u=qr(this.getSortedChildIdsForParent(r).map(p=>this.getShape(p)));if(i){const p=u.find(g=>g.index===i);if(p){const g=u[u.indexOf(p)+1];g?l=ox(i,g.index,o.length):l=_U(i,o.length)}else{const g=u.sort(ml).find(m=>m.index>i);g?l=ox(i,g.index,o.length):l=_U(i,o.length)}}else{const p=u.length&&u[u.length-1];l=p?_U(p.index,o.length):j3(o.length)}const d=a.clone().invert(),h=qr(o.map(p=>this.getShape(p))),f=h.filter(p=>p.isLocked);f.length&&this.updateShapes(f.map(({id:p,type:g})=>({id:p,type:g,isLocked:!1})));for(let p=0;p<h.length;p++){const g=h[p],m=this.getShapePageTransform(g);if(!m)continue;const v=m.point();if(!v)continue;const b=d.applyToPoint(v),S=m.rotation()-c;s.push({id:g.id,type:g.type,parentId:r,x:b.x,y:b.y,rotation:S,index:l[p],isLocked:g.isLocked})}return this.updateShapes(s),this}getHighestIndexForParent(t){const r=typeof t=="string"?t:t.id,i=this._parentIdsToChildIds.get()[r];if(!i||i.length===0)return"a1";const o=this.getShape(i[i.length-1]);return Om(o.index)}getSortedChildIdsForParent(t){const r=typeof t=="string"?t:t.id,i=this._parentIdsToChildIds.get()[r];return i||Km}visitDescendants(t,r){const i=typeof t=="string"?t:t.id,o=this.getSortedChildIdsForParent(i);for(const s of o)r(s)!==!1&&this.visitDescendants(s,r);return this}getShapeAndDescendantIds(t){const r=new Set;for(const i of t.map(o=>this.getShape(o)).sort(ml))r.add(i.id),this.visitDescendants(i,o=>{r.add(o)});return r}getDroppingOverShape(t,r=[]){const i=this.getCurrentPageShapesSorted();for(let o=i.length-1;o>=0;o--){const s=i[o];if(this.getSelectedShapeIds().includes(s.id)||!this.getShapeUtil(s).canDropShapes(s,r)||r.find(c=>c.id===s.id||this.hasAncestor(s,c.id)))continue;const a=this.getShapeMaskedPageBounds(s.id);if(a&&a.containsPoint(t)&&this.getShapeGeometry(s).hitTestPoint(this.getPointInShapeSpace(s,t),0,!0))return s}}getOutermostSelectableShape(t,r){const i=typeof t=="string"?t:t.id,o=this.getShape(i);let s=o,a=o;const c=this.getFocusedGroup();for(;a;){if(this.isShapeOfType(a,"group")&&(c==null?void 0:c.id)!==a.id&&!this.hasAncestor(c,a.id)&&((r==null?void 0:r(a))??!0))s=a;else if((c==null?void 0:c.id)===a.id)break;a=this.getShapeParent(a)}return s}_getBindingsIndexCache(){const t=a$t(this);return this.store.createComputedCache("bindingsIndex",r=>t.get().get(r.id))}getBinding(t){return this.store.get(t)}getBindingsFromShape(t,r){const i=typeof t=="string"?t:t.id;return this.getBindingsInvolvingShape(i).filter(o=>o.fromId===i&&o.type===r)}getBindingsToShape(t,r){const i=typeof t=="string"?t:t.id;return this.getBindingsInvolvingShape(i).filter(o=>o.toId===i&&o.type===r)}getBindingsInvolvingShape(t,r){const i=typeof t=="string"?t:t.id,o=this._getBindingsIndexCache().get(i)??Km;return r?o.filter(s=>s.type===r):o}createBindings(t){const r=[];for(const i of t){const o=this.getShape(i.fromId),s=this.getShape(i.toId);if(!o||!s||!this.canBindShapes({fromShape:o,toShape:s,binding:i}))continue;const c=this.getBindingUtil(i.type).getDefaultProps(),l=this.store.schema.types.binding.create({...i,id:i.id??fS(),props:{...c,...i.props}});r.push(l)}return this.store.put(r),this}createBinding(t){return this.createBindings([t])}updateBindings(t){const r=[];for(const i of t){if(!i)continue;const o=this.getBinding(i.id);if(!o)continue;const s=um(o,i);if(s===o)continue;const a=this.getShape(s.fromId),c=this.getShape(s.toId);!a||!c||this.canBindShapes({fromShape:a,toShape:c,binding:s})&&r.push(s)}return this.store.put(r),this}updateBinding(t){return this.updateBindings([t])}deleteBindings(t,{isolateShapes:r=!1}={}){const i=t.map(o=>typeof o=="string"?o:o.id);return r?this.store.atomic(()=>{var o,s;for(const a of i){const c=this.getBinding(a);if(!c)continue;const l=this.getBindingUtil(c);(o=l.onBeforeIsolateFromShape)==null||o.call(l,{binding:c,removedShape:this.getShape(c.toId)}),(s=l.onBeforeIsolateToShape)==null||s.call(l,{binding:c,removedShape:this.getShape(c.fromId)}),this.store.remove([a])}}):this.store.remove(i),this}deleteBinding(t,r){return this.deleteBindings([t],r)}canBindShapes({fromShape:t,toShape:r,binding:i}){const o=typeof t=="string"?t:t.type,s=typeof r=="string"?r:r.type,a=typeof i=="string"?i:i.type,c={fromShapeType:o,toShapeType:s,bindingType:a};return o===s?this.getShapeUtil(o).canBind(c):this.getShapeUtil(o).canBind(c)&&this.getShapeUtil(s).canBind(c)}rotateShapesBy(t,r){if((typeof t[0]=="string"?t:t.map(s=>s.id)).length<=0)return this;const o=A$e({editor:this});return o?(_O({delta:r,snapshot:o,editor:this,stage:"one-off"}),this):this}getChangesToTranslateShape(t,r){var s,a,c;let i=t;const o=this.getShapeUtil(t);return i=um(i,((s=o.onTranslateStart)==null?void 0:s.call(o,i))??void 0),i=um(i,{id:t.id,type:t.type,x:r.x,y:r.y}),i=um(i,((a=o.onTranslate)==null?void 0:a.call(o,t,i))??void 0),i=um(i,((c=o.onTranslateEnd)==null?void 0:c.call(o,t,i))??void 0),i}nudgeShapes(t,r){const i=typeof t[0]=="string"?t:t.map(s=>s.id);if(i.length<=0)return this;const o=[];for(const s of i){const a=this.getShape(s),c=H.From(r),l=this.getShapeParentTransform(a);l&&c.rot(-l.rotation()),o.push(this.getChangesToTranslateShape(a,c.add(a)))}return this.updateShapes(o),this}duplicateShapes(t,r){return this.history.batch(()=>{const i=typeof t[0]=="string"?t:t.map(h=>h.id);if(i.length<=0)return this;const o=new Set(i),s=this.getShapeAndDescendantIds(i),a=[...s].reverse(),c=new Map;for(const h of s)c.set(h,ro());const{shapesToCreate:l,bindingsToCreate:u}=Rbe(this,s,h=>{const f=[];for(const g of h){const m=this.getBinding(g);if(!m)continue;const v=fS();f.push({...m,id:v,fromId:xh(c.get(m.fromId)),toId:xh(c.get(m.toId))})}const p=[];for(const g of a){const m=xh(c.get(g)),v=this.getShape(g);if(!v)continue;let b=0,S=0;if(r&&o.has(g)){const O=this.getShapeParentTransform(v),M=new H(r.x,r.y).rot(-O.rotation());b=M.x,S=M.y}const E=v.parentId,w=this.getSortedChildIdsForParent(E),C=w.indexOf(v.id),I=w[C+1],T=I?this.getShape(I):null,D=T?F3(v.index,T.index):Om(v.index);p.push({...v,id:m,x:v.x+b,y:v.y+S,index:D,parentId:c.get(v.parentId)??v.parentId})}return{shapesToCreate:p,bindingsToCreate:f}});if(l.length+this.getCurrentPageShapeIds().size>this.options.maxShapesPerPage){cA(this);return}if(this.createShapes(l),this.createBindings(u),this.setSelectedShapes(qr(i.map(h=>c.get(h)))),r!==void 0){const h=this.getSelectionPageBounds(),f=this.getViewportPageBounds();h&&!f.contains(h)&&this.centerOnPoint(h.center,{animation:{duration:this.options.animationMediumMs}})}}),this}moveShapesToPage(t,r){const i=typeof t[0]=="string"?t:t.map(c=>c.id);if(i.length===0)return this;if(this.getInstanceState().isReadonly)return this;const o=this.getCurrentPageId();if(r===o)return this;if(!this.store.has(r))return this;const s=this.getContentFromCurrentPage(i);if(!s)return this;if(this.getPageShapeIds(r).size+s.shapes.length>this.options.maxShapesPerPage)return cA(this,r),this;const a=this.getCamera().z;return this.history.batch(()=>{this.deleteShapes(i),this.setCurrentPage(r),this.setFocusedGroup(null),this.selectNone(),this.putContentOntoCurrentPage(s,{select:!0,preserveIds:!0,preservePosition:!0}),this.setCamera({...this.getCamera(),z:a}),this.centerOnPoint(this.getSelectionRotatedPageBounds().center)}),this}toggleLock(t){const r=typeof t[0]=="string"?t:t.map(a=>a.id);if(this.getInstanceState().isReadonly||r.length===0)return this;let i=!0,o=!0;const s=[];for(const a of r){const c=this.getShape(a);c&&(s.push(c),c.isLocked?o=!1:i=!1)}return this.batch(()=>{o?(this.updateShapes(s.map(a=>({id:a.id,type:a.type,isLocked:!0}))),this.setSelectedShapes([])):i?this.updateShapes(s.map(a=>({id:a.id,type:a.type,isLocked:!1}))):this.updateShapes(s.map(a=>({id:a.id,type:a.type,isLocked:!0})))}),this}sendToBack(t){const r=typeof t[0]=="string"?t:t.map(o=>o.id),i=aA(this,"toBack",r);return i&&this.updateShapes(i),this}sendBackward(t){const r=typeof t[0]=="string"?t:t.map(o=>o.id),i=aA(this,"backward",r);return i&&this.updateShapes(i),this}bringForward(t){const r=typeof t[0]=="string"?t:t.map(o=>o.id),i=aA(this,"forward",r);return i&&this.updateShapes(i),this}bringToFront(t){const r=typeof t[0]=="string"?t:t.map(o=>o.id),i=aA(this,"toFront",r);return i&&this.updateShapes(i),this}flipShapes(t,r){const i=typeof t[0]=="string"?t:t.map(a=>a.id);if(this.getInstanceState().isReadonly)return this;let o=qr(i.map(a=>this.getShape(a)));if(!o.length)return this;o=qr(o.map(a=>this.isShapeOfType(a,"group")?this.getSortedChildIdsForParent(a.id).map(c=>this.getShape(c)):a).flat());const s=xn.Common(qr(o.map(a=>this.getShapePageBounds(a)))).center;return this.batch(()=>{for(const a of o){const c=this.getShapeGeometry(a).bounds,l=this.getShapePageTransform(a.id);l&&this.resizeShape(a.id,{x:r==="horizontal"?-1:1,y:r==="vertical"?-1:1},{initialBounds:c,initialPageTransform:l,initialShape:a,mode:"scale_shape",isAspectRatioLocked:this.getShapeUtil(a).isAspectRatioLocked(a),scaleOrigin:s,scaleAxisRotation:0})}}),this}stackShapes(t,r,i){const o=typeof t[0]=="string"?t:t.map(m=>m.id);if(this.getInstanceState().isReadonly)return this;const s=o.map(m=>this.getShape(m)).filter(m=>m?this.getShapeUtil(m).canBeLaidOut(m):!1),a=s.length;if(i===0&&a<3||a<2)return this;const c=Object.fromEntries(s.map(m=>[m.id,this.getShapePageBounds(m)]));let l,u,d,h;r==="horizontal"?(l="x",u="minX",d="maxX",h="width"):(l="y",u="minY",d="maxY",h="height");let f;if(i===0){const m=[];s.sort((b,S)=>c[b.id][u]-c[S.id][u]);for(let b=0;b<a-1;b++){const S=s[b],E=s[b+1],w=c[S.id],I=c[E.id][u]-w[d],T=m.find(D=>D.gap===I);T?T.count++:m.push({gap:I,count:1})}let v=0;m.forEach(b=>{b.count>v&&(v=b.count,f=b.gap)}),v===1&&(f=Math.max(0,m.reduce((b,S)=>b+S.gap*S.count,0)/(a-1)))}else f=i;const p=[];let g=c[s[0].id][d];return s.forEach((m,v)=>{var C,I;if(v===0)return;const b={x:0,y:0};b[l]=g+f-c[m.id][l];const S=this.getShapeParent(m),E=S?H.Rot(b,-this.getShapePageTransform(S).decompose().rotation):b,w=(I=(C=this.getShapeUtil(m)).onTranslateStart)==null?void 0:I.call(C,m);p.push(w?{...w,[l]:m[l]+E[l]}:{id:m.id,type:m.type,[l]:m[l]+E[l]}),g+=c[m.id][h]+f}),this.updateShapes(p),this}packShapes(t,r){var I,T;const i=typeof t[0]=="string"?t:t.map(D=>D.id);if(this.getInstanceState().isReadonly)return this;if(i.length<2)return this;const o=i.map(D=>this.getShape(D)).filter(D=>D?this.getShapeUtil(D).canBeLaidOut(D):!1),s={},a={};let c,l,u=0;for(let D=0;D<o.length;D++)c=o[D],l=this.getShapePageBounds(c),s[c.id]=l,a[c.id]=l.clone(),u+=l.width*l.height;const d=xn.Common(qr(Object.values(s))),h=d.width;o.sort((D,O)=>s[O.id].height-s[D.id].height);const f=Math.max(Math.ceil(Math.sqrt(u/.95)),h),p=[new xn(d.x,d.y,f,1/0)];let g=0,m=0,v,b;for(let D=0;D<o.length;D++){c=o[D],l=a[c.id];for(let O=p.length-1;O>=0;O--)if(v=p[O],!(l.width>v.width||l.height>v.height)){l.x=v.x,l.y=v.y,m=Math.max(m,l.maxY),g=Math.max(g,l.maxX),l.width===v.width&&l.height===v.height?(b=p.pop(),O<p.length&&(p[O]=b)):l.height===v.height?(v.x+=l.width+r,v.width-=l.width+r):l.width===v.width?(v.y+=l.height+r,v.height-=l.height+r):(p.push(new xn(v.x+(l.width+r),v.y,v.width-(l.width+r),l.height)),v.y+=l.height+r,v.height-=l.height+r);break}}const S=xn.Common(Object.values(a)),E=H.Sub(d.center,S.center);let w;const C=[];for(let D=0;D<o.length;D++){c=o[D],l=s[c.id],w=a[c.id];const O=H.Sub(w.point,l.point).add(E),M=this.getShapeParentTransform(c);M&&O.rot(-M.rotation());const R={id:c.id,type:c.type,x:c.x+O.x,y:c.y+O.y},A=(T=(I=this.getShapeUtil(c)).onTranslateStart)==null?void 0:T.call(I,{...c,...R});A?C.push({...R,...A}):C.push(R)}return C.length&&this.updateShapes(C),this}alignShapes(t,r){const i=typeof t[0]=="string"?t:t.map(l=>l.id);if(this.getInstanceState().isReadonly)return this;if(i.length<2)return this;const o=qr(i.map(l=>this.getShape(l))),s=Object.fromEntries(o.map(l=>[l.id,this.getShapePageBounds(l)])),a=xn.Common(qr(Object.values(s))),c=[];return o.forEach(l=>{const u=s[l.id];if(!u)return;const d={x:0,y:0};switch(r){case"top":{d.y=a.minY-u.minY;break}case"center-vertical":{d.y=a.midY-u.minY-u.height/2;break}case"bottom":{d.y=a.maxY-u.minY-u.height;break}case"left":{d.x=a.minX-u.minX;break}case"center-horizontal":{d.x=a.midX-u.minX-u.width/2;break}case"right":{d.x=a.maxX-u.minX-u.width;break}}const h=this.getShapeParent(l),f=h?H.Rot(d,-this.getShapePageTransform(h).decompose().rotation):d;c.push(this.getChangesToTranslateShape(l,H.Add(l,f)))}),this.updateShapes(c),this}distributeShapes(t,r){const i=typeof t[0]=="string"?t:t.map(S=>S.id);if(this.getInstanceState().isReadonly)return this;if(i.length<3)return this;const o=i.length,s=qr(i.map(S=>this.getShape(S))),a=Object.fromEntries(s.map(S=>[S.id,this.getShapePageBounds(S)]));let c,l,u,d,h;r==="horizontal"?(c="x",l="minX",u="maxX",d="midX",h="width"):(c="y",l="minY",u="maxY",d="midY",h="height");const f=[],p=s.sort((S,E)=>a[S.id][l]-a[E.id][l])[0],g=s.sort((S,E)=>a[E.id][u]-a[S.id][u])[0],m=a[p.id][d],v=(a[g.id][d]-m)/(o-1),b=m+v;return s.filter(S=>S!==p&&S!==g).sort((S,E)=>a[S.id][d]-a[E.id][d]).forEach((S,E)=>{const w={x:0,y:0};w[c]=b+v*E-a[S.id][h]/2-a[S.id][c];const C=this.getShapeParent(S),I=C?H.Rot(w,-this.getShapePageTransform(C).rotation()):w;f.push(this.getChangesToTranslateShape(S,H.Add(S,I)))}),this.updateShapes(f),this}stretchShapes(t,r){const i=typeof t[0]=="string"?t:t.map(l=>l.id);if(this.getInstanceState().isReadonly)return this;if(i.length<2)return this;const o=qr(i.map(l=>this.getShape(l))),s=Object.fromEntries(i.map(l=>[l,this.getShapeGeometry(l).bounds])),a=Object.fromEntries(i.map(l=>[l,this.getShapePageBounds(l)])),c=xn.Common(qr(Object.values(a)));switch(r){case"vertical":{this.batch(()=>{for(const l of o){if(this.getShapePageTransform(l).rotation()%Xi)continue;const d=s[l.id],h=a[l.id],f=new H(0,c.minY-h.minY),p=this.getShapeParentTransform(l);p&&f.rot(-p.rotation());const{x:g,y:m}=H.Add(f,l);this.updateShapes([{id:l.id,type:l.type,x:g,y:m}]);const v=new H(1,c.height/h.height);this.resizeShape(l.id,v,{initialBounds:d,scaleOrigin:new H(h.center.x,c.minY),isAspectRatioLocked:this.getShapeUtil(l).isAspectRatioLocked(l),scaleAxisRotation:0})}});break}case"horizontal":{this.batch(()=>{for(const l of o){const u=s[l.id],d=a[l.id];if(this.getShapePageTransform(l).rotation()%Xi)continue;const f=new H(c.minX-d.minX,0),p=this.getShapeParentTransform(l);p&&f.rot(-p.rotation());const{x:g,y:m}=H.Add(f,l);this.updateShapes([{id:l.id,type:l.type,x:g,y:m}]);const v=new H(c.width/d.width,1);this.resizeShape(l.id,v,{initialBounds:u,scaleOrigin:new H(c.minX,d.center.y),isAspectRatioLocked:this.getShapeUtil(l).isAspectRatioLocked(l),scaleAxisRotation:0})}});break}}return this}resizeShape(t,r,i={}){var p,g,m;const o=typeof t=="string"?t:t.id;if(this.getInstanceState().isReadonly)return this;Number.isFinite(r.x)||(r=new H(1,r.y)),Number.isFinite(r.y)||(r=new H(r.x,1));const s=i.initialShape??this.getShape(o);if(!s)return this;const a=i.scaleOrigin??((p=this.getShapePageBounds(o))==null?void 0:p.center);if(!a)return this;const c=i.initialPageTransform?Mn.Cast(i.initialPageTransform):this.getShapePageTransform(o);if(!c)return this;const l=c.rotation();if(l==null)return this;const u=i.scaleAxisRotation??l,d=i.initialBounds??this.getShapeGeometry(o).bounds;if(!d)return this;const h=i.isAspectRatioLocked??this.getShapeUtil(s).isAspectRatioLocked(s);if(!q8e(l,u))return this._resizeUnalignedShape(o,r,{...i,initialBounds:d,scaleOrigin:a,scaleAxisRotation:u,initialPageTransform:c,isAspectRatioLocked:h,initialShape:s});const f=this.getShapeUtil(s);if(h&&(Math.abs(r.x)>Math.abs(r.y)?r=new H(r.x,Math.sign(r.y)*Math.abs(r.x)):r=new H(Math.sign(r.x)*Math.abs(r.y),r.y)),f.onResize&&f.canResize(s)){const v=this._scalePagePoint(Mn.applyToPoint(c,new H(0,0)),a,r,u),b=this.getPointInParentSpace(s.id,v),S=new H(r.x,r.y),E=sy((l-u)%Math.PI,0);S.x=E?r.x:r.y,S.y=E?r.y:r.x;const w=Mn.applyToPoint(c,new H),{x:C,y:I}=this.getPointInParentSpace(s.id,w);let T=s;i.skipStartAndEndCallbacks||(T=um(s,((g=f.onResizeStart)==null?void 0:g.call(f,s))??void 0)),T=um(T,{id:o,type:s.type,x:b.x,y:b.y,...f.onResize({...s,x:C,y:I},{newPoint:b,handle:i.dragHandle??"bottom_right",mode:i.mode??"scale_shape",scaleX:S.x,scaleY:S.y,initialBounds:d,initialShape:s})}),i.skipStartAndEndCallbacks||(T=um(T,((m=f.onResizeEnd)==null?void 0:m.call(f,s,T))??void 0)),this.updateShapes([T])}else{const v=Mn.applyToPoint(c,d.center),b=this._scalePagePoint(v,a,r,u),S=this.getPointInParentSpace(s.id,v),E=this.getPointInParentSpace(s.id,b),w=H.Sub(E,S);this.updateShapes([{id:o,type:s.type,x:s.x+w.x,y:s.y+w.y}])}return this}_scalePagePoint(t,r,i,o){const s=H.RotWith(t,r,-o).sub(r),a=H.MulV(s,i);return H.Add(a,r).rotWith(r,o)}_resizeUnalignedShape(t,r,i){const{type:o}=i.initialShape,s=new H(r.x,r.y);if(Math.abs(r.x)>Math.abs(r.y)?s.x=Math.sign(r.x)*Math.abs(r.y):s.y=Math.sign(r.y)*Math.abs(r.x),this.resizeShape(t,s,{initialShape:i.initialShape,initialBounds:i.initialBounds,isAspectRatioLocked:i.isAspectRatioLocked}),Math.sign(r.x)*Math.sign(r.y)<0){let{rotation:v}=Mn.Decompose(i.initialPageTransform);v-=2*v,this.updateShapes([{id:t,type:o,rotation:v}])}const a=Mn.applyToPoint(i.initialPageTransform,i.initialBounds.center),c=this._scalePagePoint(a,i.scaleOrigin,r,i.scaleAxisRotation),l=this.getShapePageBounds(t),u=this.getShapePageTransform(t),d=l.center,h=u.point();if(!d||!h)return this;const f=H.Sub(c,d),p=H.Add(h,f),{x:g,y:m}=this.getPointInParentSpace(t,p);return this.updateShapes([{id:t,type:o,x:g,y:m}]),this}getInitialMetaForShape(t){return{}}createShape(t){return this.createShapes([t]),this}createShapes(t){if(!Array.isArray(t))throw Error("Editor.createShapes: must provide an array of shapes or shape partials");if(this.getInstanceState().isReadonly)return this;if(t.length<=0)return this;const r=this.getCurrentPageShapeIds();if(t.length+r.size>this.options.maxShapesPerPage)return cA(this),this;const o=this.getFocusedGroupId();return this.batch(()=>{var d,h;const s=this.getCurrentPageShapesSorted(),a=t.map(f=>{if(f.id||(f={id:ro(),...f}),!f.parentId||!(this.store.has(f.parentId)||t.some(p=>p.id===f.parentId))){let p=this.getFocusedGroupId();for(let m=s.length-1;m>=0;m--){const v=s[m];if(this.getShapeUtil(v).canReceiveNewChildrenOfType(v,f.type)&&this.isPointInShape(v,{x:f.x??0,y:f.y??0},{margin:0,hitInside:!0})){p=v.id;break}}const g=f.parentId;if(p===f.id&&(p=o),p!==g&&(f={...f},f.parentId=p,ku(p))){const m=this.getPointInShapeSpace(this.getShape(p),{x:f.x??0,y:f.y??0});f.x=m.x,f.y=m.y,f.rotation=-this.getShapePageTransform(p).rotation()+(f.rotation??0)}}return f}),c=new Map,l=[],{opacityForNextShape:u}=this.getInstanceState();for(const f of a){const p=this.getShapeUtil(f);let g=f.index;if(!g){const S=f.parentId??o;c.has(S)||c.set(S,this.getHighestIndexForParent(S)),g=c.get(S),c.set(S,Om(g))}const m=p.getDefaultProps();for(const[S,E]of this.styleProps[f.type])m[E]=this.getStyleForNextShape(S);let v=this.store.schema.types.shape.create({...f,index:g,opacity:f.opacity??u,parentId:f.parentId??o,props:"props"in f?{...m,...f.props}:m});if(v.index===void 0)throw Error("no index!");const b=(h=(d=this.getShapeUtil(v)).onBeforeCreate)==null?void 0:h.call(d,v);b&&(v=b),l.push(v)}l.forEach(f=>{f.meta={...this.getInitialMetaForShape(f),...f.meta}}),this.store.put(l)})}animateShape(t,r={animation:PU}){return this.animateShapes([t],r)}animateShapes(t,r={animation:PU}){if(!r.animation)return this;const{duration:i=500,easing:o=uc.linear}=r.animation,s=us();let a=i,c;const l=[];let u,d;for(let p=0,g=t.length;p<g;p++){if(u=t[p],!u)continue;d={partial:u,values:[]};const m=this.getShape(u.id);if(m){for(const v of["x","y","rotation"])u[v]!==void 0&&m[v]!==u[v]&&d.values.push({prop:v,from:m[v],to:u[v]});l.push(d),this.animatingShapes.set(m.id,s)}}let h;const f=p=>{if(a-=p,a<0){const{animatingShapes:b}=this,S=t.filter(E=>E&&b.get(E.id)===s);S.length&&this.updateShapes(S),this.off("tick",f);return}c=o(1-a/i);const{animatingShapes:g}=this,m=[];let v;for(let b=0,S=l.length;b<S;b++)h=l[b],v=g.get(h.partial.id),v===s&&m.push({id:h.partial.id,type:h.partial.type,...h.values.reduce((E,{prop:w,from:C,to:I})=>(E[w]=C+(I-C)*c,E),{})});this._updateShapes(m)};return this.on("tick",f),this}groupShapes(t,r={}){var g;const{groupId:i=ro(),select:o=!0}=r;if(!Array.isArray(t))throw Error("Editor.groupShapes: must provide an array of shapes or shape ids");if(this.getInstanceState().isReadonly)return this;const s=typeof t[0]=="string"?t:t.map(m=>m.id);if(s.length<=1)return this;const a=qr(this._getUnlockedShapeIds(s).map(m=>this.getShape(m))),c=a.sort(ml).map(m=>m.id),l=xn.Common(qr(a.map(m=>this.getShapePageBounds(m)))),{x:u,y:d}=l.point,h=this.findCommonAncestor(a)??this.getCurrentPageId();if(this.getCurrentToolId()!=="select")return this;this.isIn("select.idle")||this.cancel();const f=a.filter(m=>m.parentId===h).sort(ml),p=(g=f[f.length-1])==null?void 0:g.index;return this.batch(()=>{this.createShapes([{id:i,type:"group",parentId:h,index:p,x:u,y:d,opacity:1,props:{}}]),this.reparentShapes(c,i),o&&this.select(i)}),this}ungroupShapes(t,r={}){const{select:i=!0}=r,o=typeof t[0]=="string"?t:t.map(c=>c.id);if(this.getInstanceState().isReadonly)return this;if(o.length===0)return this;if(this.getCurrentToolId()!=="select")return this;this.isIn("select.idle")||this.cancel();const s=new Set,a=[];return qr(o.map(c=>this.getShape(c))).forEach(c=>{this.isShapeOfType(c,"group")?a.push(c):s.add(c.id)}),a.length===0?this:(this.batch(()=>{let c;for(let l=0,u=a.length;l<u;l++){c=a[l];const d=this.getSortedChildIdsForParent(c.id);for(let h=0,f=d.length;h<f;h++)s.add(d[h]);this.reparentShapes(d,c.parentId,c.index)}this.deleteShapes(a.map(l=>l.id)),i&&this.select(...s)}),this)}updateShape(t){return this.updateShapes([t]),this}updateShapes(t){const r=Array(t.length);for(let i=0,o=t.length;i<o;i++){const s=t[i];if(!s)continue;const a=this.getShape(s.id);a&&(this.isShapeOrAncestorLocked(a)&&!Object.hasOwn(s,"isLocked")||(this.animatingShapes.delete(s.id),r.push(s)))}return this._updateShapes(r),this}_getUnlockedShapeIds(t){return t.filter(r=>{var i;return!((i=this.getShape(r))!=null&&i.isLocked)})}deleteShapes(t){if(!Array.isArray(t))throw Error("Editor.deleteShapes: must provide an array of shapes or shapeIds");const r=this._getUnlockedShapeIds(typeof t[0]=="string"?t:t.map(s=>s.id));if(this.getInstanceState().isReadonly)return this;if(r.length===0)return this;const i=new Set(r);for(const s of r)this.visitDescendants(s,a=>{i.add(a)});const o=[...i];return this.batch(()=>this.store.remove(o))}deleteShape(t){return this.deleteShapes([typeof t=="string"?t:t.id]),this}_extractSharedStyles(t,r){if(this.isShapeOfType(t,"group")){const i=this._parentIdsToChildIds.get()[t.id];if(!i)return;for(let o=0,s=i.length;o<s;o++)this._extractSharedStyles(this.getShape(i[o]),r)}else for(const[i,o]of this.styleProps[t.type])r.applyValue(i,ju(t.props,o))}_getSelectionSharedStyles(){const t=this.getSelectedShapes(),r=new aX;for(const i of t)this._extractSharedStyles(i,r);return r}getStyleForNextShape(t){const r=this.getInstanceState().stylesForNextShape[t.id];return r===void 0?t.defaultValue:r}getShapeStyleIfExists(t,r){const i=this.styleProps[t.type].get(r);if(i!==void 0)return ju(t.props,i)}getSharedStyles(){if(this.isIn("select")&&this.getSelectedShapeIds().length>0)return this._getSelectionSharedStyles();const t=this.root.getCurrent(),r=new aX;if(!t)return r;if(t.shapeType)for(const i of this.styleProps[t.shapeType].keys())r.applyValue(i,this.getStyleForNextShape(i));return r}getSharedOpacity(){if(this.isIn("select")&&this.getSelectedShapeIds().length>0){const t=[],r=o=>{const s=this.getShape(o);if(s)if(this.isShapeOfType(s,"group"))for(const a of this.getSortedChildIdsForParent(s.id))r(a);else t.push(s)};for(const o of this.getSelectedShapeIds())r(o);let i=null;for(const o of t)if(i===null)i=o.opacity;else if(i!==o.opacity)return{type:"mixed"};if(i!==null)return{type:"shared",value:i}}return{type:"shared",value:this.getInstanceState().opacityForNextShape}}setOpacityForNextShapes(t,r){return this.updateInstanceState({opacityForNextShape:t},r),this}setOpacityForSelectedShapes(t){const r=this.getSelectedShapes();if(r.length>0){const i=[],o=s=>{if(this.isShapeOfType(s,"group")){const a=this.getSortedChildIdsForParent(s);for(const c of a)o(this.getShape(c))}else i.push(s)};for(const s of r)o(s);this.updateShapes(i.map(s=>({id:s.id,type:s.type,opacity:t})))}return this}setStyleForNextShapes(t,r,i){const o=this.getInstanceState().stylesForNextShape;return this.updateInstanceState({stylesForNextShape:{...o,[t.id]:r}},i),this}setStyleForSelectedShapes(t,r){const i=this.getSelectedShapes();if(i.length>0){const o=[],s=a=>{if(this.isShapeOfType(a,"group")){const c=this.getSortedChildIdsForParent(a.id);for(const l of c)s(this.getShape(l))}else{const c=this.getShapeUtil(a),l=this.styleProps[a.type].get(t);if(l){const u={id:a.id,type:a.type,props:{[l]:r}};o.push({util:c,originalShape:a,updatePartial:u})}}};for(const a of i)s(a);this.updateShapes(o.map(({updatePartial:a})=>a))}return this}registerExternalAssetHandler(t,r){return this.externalAssetContentHandlers[t]=r,this}async getAssetForExternalContent(t){var r,i;return await((i=(r=this.externalAssetContentHandlers)[t.type])==null?void 0:i.call(r,t))}hasExternalAssetHandler(t){return!!this.externalAssetContentHandlers[t]}registerExternalContentHandler(t,r){return this.externalContentHandlers[t]=r,this}async putExternalContent(t){var r,i;return(i=(r=this.externalContentHandlers)[t.type])==null?void 0:i.call(r,t)}getContentFromCurrentPage(t){const r=typeof t[0]=="string"?t:t.map(o=>o.id);if(!r||r.length===0)return;const i=this.getShapeAndDescendantIds(r);return Rbe(this,i,o=>{const s=[];for(const d of o){const h=this.getBinding(d);h&&s.push(h)}const a=[],c=[];for(const d of i){const h=this.getShape(d);if(!h)continue;if(!i.has(h.parentId)){const p=this.getShapePageTransform(h.id),g=p.point();c.push({...h,x:g.x,y:g.y,rotation:p.rotation(),parentId:this.getCurrentPageId()}),a.push(h.id)}else c.push(h)}const l=[],u=new Set;for(const d of c){if(!("assetId"in d.props))continue;const h=d.props.assetId;if(!h||u.has(h))continue;u.add(h);const f=this.getAsset(h);f&&l.push(f)}return{schema:this.store.schema.serialize(),shapes:c,rootShapeIds:a,bindings:s,assets:l}})}async resolveAssetsInContent(t){if(!t)return;const r=[];return await Promise.allSettled(t.assets.map(async i=>{var o,s;if((i.type==="image"||i.type==="video")&&!((o=i.props.src)!=null&&o.startsWith("data:image"))&&!((s=i.props.src)!=null&&s.startsWith("http"))){const a=ls(i),c=await this._assetOptions.get().onResolveAsset(i,{screenScale:1,steppedScreenScale:1,dpr:1,networkEffectiveType:null,shouldResolveToOriginalImage:!0});a.props.src=await dS.blobToDataUrl(await vg(c).then(l=>l.blob())),r.push(a)}else r.push(i)})),t.assets=r,t}putContentOntoCurrentPage(t,r={}){var M,R;if(this.getInstanceState().isReadonly)return this;if(!t.schema)throw Error(`Could not put content:
content is missing a schema.`);const{select:i=!1,preserveIds:o=!1,preservePosition:s=!1}=r;let{point:a=void 0}=r;const c=this.getCurrentPageId(),{rootShapeIds:l}=t,u=[],d=[],h=[],f={store:{...Object.fromEntries(t.assets.map(A=>[A.id,A])),...Object.fromEntries(t.shapes.map(A=>[A.id,A])),...Object.fromEntries(((M=t.bindings)==null?void 0:M.map(A=>[A.id,A]))??[])},schema:t.schema},p=this.store.schema.migrateStoreSnapshot(f);if(p.type==="error")throw Error("Could not put content: could not migrate content");for(const A of Object.values(p.value))switch(A.typeName){case"asset":{u.push(A);break}case"shape":{d.push(A);break}case"binding":{h.push(A);break}}const g=new Map(o?d.map(A=>[A.id,A.id]):d.map(A=>[A.id,ro()])),m=new Map(o?h.map(A=>[A.id,A.id]):h.map(A=>[A.id,fS()]));let v=this.getCurrentPageId(),b=1/0,S=[];for(const A of this.getSelectedShapes()){if(b===0)break;const k=this.isShapeOfType(A,"frame"),L=this.getShapeAncestors(A);k&&L.push(A);const j=k?L.length+1:L.length;if(j<b)b=j,S=L,v=k?A.id:A.parentId;else if(j===b){if(S.length!==L.length)throw Error(`Ancestors: ${S.length} !== ${L.length}`);if(S.length===0){v=c;break}else{v=c;for(let N=0;N<S.length&&L[N]===S[N];N++)v=L[N].id}}}let E=!1;if(!Cu(v)){const A=this.getShape(v);if(A){if(!this.getViewportPageBounds().includes(this.getShapePageBounds(A)))v=c;else if(l.length===1){const k=d.find(L=>L.id===l[0]);this.isShapeOfType(A,"frame")&&this.isShapeOfType(k,"frame")&&k.props.w===(A==null?void 0:A.props.w)&&k.props.h===(A==null?void 0:A.props.h)&&(E=!0)}}else v=c}E||(E=g.has(v)),E&&(v=this.getShape(v).parentId);let w=this.getHighestIndexForParent(v);const C=[],I=d.map(A=>{const k=g.get(A.id),L={...A,id:k};return l.includes(A.id)&&(L.parentId=c,C.push(L)),g.has(L.parentId)?L.parentId=g.get(A.parentId):(l.push(L.id),L.index=w,w=Om(w)),L});if(I.length+this.getCurrentPageShapeIds().size>this.options.maxShapesPerPage)return cA(this),this;const T=h.map(A=>({...A,id:xh(m.get(A.id)),fromId:xh(g.get(A.fromId)),toId:xh(g.get(A.toId))})),D=[],O=[];for(const A of u)this.store.has(A.id)||((A.type==="image"||A.type==="video")&&((R=A.props.src)!=null&&R.startsWith("data:image"))&&(O.push(ls(A)),A.props.src=null),D.push(A));return Promise.allSettled(O.map(async A=>{const k=await t$t(A.props.src,A.props.name,A.props.mimeType??"image/png"),L=await this.getAssetForExternalContent({type:"file",file:k});if(!L){this.deleteAssets([A.id]);return}this.updateAssets([{...L,id:A.id}])})),this.batch(()=>{D.length>0&&this.createAssets(D),this.createShapes(I),this.createBindings(T),i&&this.select(...C.map(N=>N.id)),v!==c&&this.reparentShapes(C.map(N=>N.id),v);const A=I.map(N=>this.getShape(N.id)),k=xn.Common(A.map(N=>this.getShapePageBounds(N)));if(a===void 0)if(Cu(v)){const N=this.getViewportPageBounds();s||N.includes(xn.From(k))?a=k.center:a=N.center}else{const N=this.getShape(v);a=Mn.applyToPoint(this.getShapePageTransform(N),this.getShapeGeometry(N).bounds.center)}if(C.length===1){const N=C[0];if(this.isShapeOfType(N,"frame"))for(;this.getShapesAtPoint(a).some(B=>this.isShapeOfType(B,"frame")&&B.props.w===N.props.w&&B.props.h===N.props.h);)a.x+=k.w+16}const L=xn.Common(qr(C.map(({id:N})=>this.getShapePageBounds(N)))).center,j=H.Sub(a,L);this.updateShapes(C.map(({id:N})=>{const B=this.getShape(N),U=this.getShapeParentTransform(N).decompose().rotation,K=H.Rot(j,-U);return{id:B.id,type:B.type,x:B.x+K.x,y:B.y+K.y}}))}),this}async getSvgElement(t,r={}){const i=await f$t(this,t,r);if(!i)return;const o=document.createDocumentFragment(),s=fZe(o);Wu.flushSync(()=>{s.render(i.jsx)});const a=o.firstElementChild;return ds(a instanceof SVGSVGElement,"Expected an SVG element"),s.unmount(),{svg:a,width:i.width,height:i.height}}async getSvgString(t,r={}){const i=await this.getSvgElement(t,r);return i?{svg:new XMLSerializer().serializeToString(i.svg),width:i.width,height:i.height}:void 0}async getSvg(t,r={}){const i=await this.getSvgElement(t,r);if(i)return i.svg}_updateInputsFromEvent(t){const{pointerVelocity:r,previousScreenPoint:i,previousPagePoint:o,currentScreenPoint:s,currentPagePoint:a}=this.inputs,{screenBounds:c}=this.store.unsafeGetWithoutCapture(fl),{x:l,y:u,z:d}=this.store.unsafeGetWithoutCapture(this.getCameraId()),h=t.point.x-c.x,f=t.point.y-c.y,p=t.point.z??.5;i.setTo(s),o.setTo(a),s.set(h,f);const g=h/d-l,m=f/d-u;isFinite(g)&&isFinite(m)&&a.set(g,m,p),this.inputs.isPen=t.type==="pointer"&&t.isPen,(t.name==="pointer_down"||this.inputs.isPinching)&&(r.set(0,0),this.inputs.originScreenPoint.setTo(s),this.inputs.originPagePoint.setTo(a)),this.history.ignore(()=>{var v;this.store.put([{id:H3,typeName:"pointer",x:a.x,y:a.y,lastActivityTimestamp:t.type==="pointer"&&t.pointerId===ibe.CAMERA_MOVE?((v=this.store.unsafeGetWithoutCapture(H3))==null?void 0:v.lastActivityTimestamp)??this._tickManager.now:this._tickManager.now,meta:{}}])})}cancel(){return this.dispatch({type:"misc",name:"cancel"}),this}interrupt(){return this.dispatch({type:"misc",name:"interrupt"}),this}complete(){return this.dispatch({type:"misc",name:"complete"}),this}focus({focusContainer:t=!0}={}){return t&&this.focusManager.focus(),this.updateInstanceState({isFocused:!0}),this}blur({blurContainer:t=!0}={}){return this.getIsFocused()?(t?this.focusManager.blur():this.complete(),this.updateInstanceState({isFocused:!1}),this):this}getIsFocused(){return this.getInstanceState().isFocused}getSnapshot(){return q8t(this.store)}loadSnapshot(t){return P$e(this.store,t),this}cancelDoubleClick(){this._clickManager.cancelDoubleClickTimeout()}_flushEventsForTick(t){this.batch(()=>{if(this._pendingEventsForNextTick.length>0){const r=[...this._pendingEventsForNextTick];this._pendingEventsForNextTick.length=0;for(const i of r)this._flushEventForTick(i)}t>0&&this.root.handleEvent({type:"misc",name:"tick",elapsed:t}),this.scribbles.tick(t)})}maybeTrackPerformance(t){ta.measurePerformance.get()&&(this.performanceTracker.isStarted()?clearTimeout(this.performanceTrackerTimeout):this.performanceTracker.start(t),this.performanceTrackerTimeout=this.timers.setTimeout(()=>{this.performanceTracker.stop()},50))}};kn([Et],En.prototype,"getCanUndo");kn([Et],En.prototype,"getCanRedo");kn([Et],En.prototype,"getPath");kn([Et],En.prototype,"getCurrentTool");kn([Et],En.prototype,"getCurrentToolId");kn([Et],En.prototype,"getDocumentSettings");kn([Et],En.prototype,"getInstanceState");kn([Et],En.prototype,"getOpenMenus");kn([Et],En.prototype,"getIsMenuOpen");kn([Et],En.prototype,"getPageStates");kn([Et],En.prototype,"_getPageStatesQuery");kn([Et],En.prototype,"getCurrentPageState");kn([Et],En.prototype,"_getCurrentPageStateId");kn([Et],En.prototype,"getSelectedShapeIds");kn([Et],En.prototype,"getSelectedShapes");kn([Et],En.prototype,"getOnlySelectedShapeId");kn([Et],En.prototype,"getOnlySelectedShape");kn([Et],En.prototype,"getSelectionPageBounds");kn([Et],En.prototype,"getSelectionRotation");kn([Et],En.prototype,"getSelectionRotatedPageBounds");kn([Et],En.prototype,"getSelectionRotatedScreenBounds");kn([Et],En.prototype,"getFocusedGroupId");kn([Et],En.prototype,"getFocusedGroup");kn([Et],En.prototype,"getEditingShapeId");kn([Et],En.prototype,"getEditingShape");kn([Et],En.prototype,"getHoveredShapeId");kn([Et],En.prototype,"getHoveredShape");kn([Et],En.prototype,"getHintingShapeIds");kn([Et],En.prototype,"getHintingShape");kn([Et],En.prototype,"getErasingShapeIds");kn([Et],En.prototype,"getErasingShapes");kn([Et],En.prototype,"getCameraId");kn([Et],En.prototype,"getCamera");kn([Et],En.prototype,"getViewportPageBoundsForFollowing");kn([Et],En.prototype,"getCameraForFollowing");kn([Et],En.prototype,"getZoomLevel");kn([Et],En.prototype,"getViewportScreenBounds");kn([Et],En.prototype,"getViewportScreenCenter");kn([Et],En.prototype,"getViewportPageBounds");kn([Et],En.prototype,"_getCollaboratorsQuery");kn([Et],En.prototype,"getCollaborators");kn([Et],En.prototype,"getCollaboratorsOnCurrentPage");kn([Et],En.prototype,"getRenderingShapes");kn([Et],En.prototype,"_getAllPagesQuery");kn([Et],En.prototype,"getPages");kn([Et],En.prototype,"getCurrentPageId");kn([Et],En.prototype,"getCurrentPageShapeIdsSorted");kn([Et],En.prototype,"_getAllAssetsQuery");kn([Et],En.prototype,"_getShapeGeometryCache");kn([Et],En.prototype,"_getShapeHandlesCache");kn([Et],En.prototype,"_getShapePageTransformCache");kn([Et],En.prototype,"_getShapePageBoundsCache");kn([Et],En.prototype,"_getShapeClipPathCache");kn([Et],En.prototype,"_getShapeMaskCache");kn([Et],En.prototype,"_getShapeMaskedPageBoundsCache");kn([Et],En.prototype,"_notVisibleShapes");kn([Et],En.prototype,"getCulledShapes");kn([Et],En.prototype,"getCurrentPageBounds");kn([Et],En.prototype,"getCurrentPageShapes");kn([Et],En.prototype,"getCurrentPageShapesSorted");kn([Et],En.prototype,"getCurrentPageRenderingShapesSorted");kn([Et],En.prototype,"_getBindingsIndexCache");kn([Et],En.prototype,"_getSelectionSharedStyles");kn([Et({isEqual:(n,e)=>n.equals(e)})],En.prototype,"getSharedStyles");kn([Et],En.prototype,"getSharedOpacity");kn([Et],En.prototype,"getIsFocused");function cA(n,e=n.getCurrentPageId()){const t=n.getPage(e).name;n.emit("max-shapes",{name:t,pageId:e,count:n.options.maxShapesPerPage})}function um(n,e){if(!e)return n;let t=null;const r=Object.entries(e);for(let i=0,o=r.length;i<o;i++){const[s,a]=r[i];if(a!==void 0&&!(s==="id"||s==="type"||s==="typeName")&&a!==n[s]){if(t||(t={...n}),s==="props"||s==="meta"){t[s]={...n[s]};for(const[c,l]of Object.entries(a))l!==void 0&&(t[s][c]=l);continue}t[s]=a}}return t||n}function L$e(n,e,t){const r=n.getShape(e);if(!r)return;t.push(r);const i=n.getSortedChildIdsForParent(e);for(let o=0,s=i.length;o<s;o++)L$e(n,i[o],t)}function Rbe(n,e,t){let r;if(n.history.ignore(()=>{const i=n.store.extractingChanges(()=>{const o=new Set,s=new Set;for(const a of e)if(n.getShape(a))for(const l of n.getBindingsInvolvingShape(a)){const u=e.has(l.fromId),d=e.has(l.toId);if(u&&d){o.add(l.id);continue}(!u||!d)&&s.add(l.id)}n.deleteBindings([...s],{isolateShapes:!0});try{r=iy.ok(t(o))}catch(a){r=iy.err(a)}});n.store.applyDiff(XZ(i))}),r.ok)return r.value;throw r.error}function Abe(n,e){if(!e.constraints)throw Error("Should have constraints here");const{padding:{x:t,y:r}}=e.constraints,i=n.getViewportScreenBounds(),o=xn.From(e.constraints.bounds),s=(i.w-t*2)/o.w,a=(i.h-r*2)/o.h;return{zx:s,zy:a}}function FD(){const n=ot(),e=M$e();return _t("isDarkMode",()=>(e==null?void 0:e.isDarkMode)??n.user.getIsDarkMode(),[e,n])}const Obe="<path d='m19.7432 17.0869-4.072 4.068 2.829 2.828-8.473-.013-.013-8.47 2.841 2.842 4.075-4.068 1.414-1.415-2.844-2.842h8.486v8.484l-2.83-2.827z' fill='%23fff'/><path d='m18.6826 16.7334-4.427 4.424 1.828 1.828-5.056-.016-.014-5.054 1.842 1.841 4.428-4.422 2.474-2.475-1.844-1.843h5.073v5.071l-1.83-1.828z' fill='%23000'/>",Mbe="<path d='m9 17.9907v.005l5.997 5.996.001-3.999h1.999 2.02v4l5.98-6.001-5.98-5.999.001 4.019-2.021.002h-2l.001-4.022zm1.411.003 3.587-3.588-.001 2.587h3.5 2.521v-2.585l3.565 3.586-3.564 3.585-.001-2.585h-2.521l-3.499-.001-.001 2.586z' fill='%23fff'/><path d='m17.4971 18.9932h2.521v2.586l3.565-3.586-3.565-3.585v2.605h-2.521-3.5v-2.607l-3.586 3.587 3.586 3.586v-2.587z' fill='%23000'/>",lA='<path d="M22.4789 9.45728L25.9935 12.9942L22.4789 16.5283V14.1032C18.126 14.1502 14.6071 17.6737 14.5675 22.0283H17.05L13.513 25.543L9.97889 22.0283H12.5674C12.6071 16.5691 17.0214 12.1503 22.4789 12.1031L22.4789 9.45728Z" fill="black"/><path fill-rule="evenodd" clip-rule="evenodd" d="M21.4789 7.03223L27.4035 12.9945L21.4789 18.9521V15.1868C18.4798 15.6549 16.1113 18.0273 15.649 21.0284H19.475L13.5128 26.953L7.55519 21.0284H11.6189C12.1243 15.8155 16.2679 11.6677 21.4789 11.1559L21.4789 7.03223ZM22.4789 12.1031C17.0214 12.1503 12.6071 16.5691 12.5674 22.0284H9.97889L13.513 25.543L17.05 22.0284H14.5675C14.5705 21.6896 14.5947 21.3558 14.6386 21.0284C15.1157 17.4741 17.9266 14.6592 21.4789 14.1761C21.8063 14.1316 22.1401 14.1069 22.4789 14.1032V16.5284L25.9935 12.9942L22.4789 9.45729L22.4789 12.1031Z" fill="white"/>';function Jv(n,e,t,r,i,o=16,s=16){const a=(-t-e)*(Ai/180),c=Math.sin(a),l=Math.cos(a),u=1*l-1*c,d=1*c+1*l;return`url("data:image/svg+xml,<svg height='32' width='32' viewBox='0 0 32 32' xmlns='http://www.w3.org/2000/svg' style='color: ${i};'><defs><filter id='shadow' y='-40%' x='-40%' width='180px' height='180%' color-interpolation-filters='sRGB'><feDropShadow dx='${u}' dy='${d}' stdDeviation='1.2' flood-opacity='.5'/></filter></defs><g fill='none' transform='rotate(${e+t} 16 16)${r?" scale(-1,-1) translate(0, -32)":""}' filter='url(%23shadow)'>`+n.replaceAll('"',"'")+`</g></svg>") ${o} ${s}, pointer`}const q$t=["default","pointer","cross","move","grab","grabbing","text","zoom-in","zoom-out"],K$t={none:()=>"none","ew-resize":(n,e,t)=>Jv(Mbe,n,0,e,t),"ns-resize":(n,e,t)=>Jv(Mbe,n,90,e,t),"nesw-resize":(n,e,t)=>Jv(Obe,n,0,e,t),"nwse-resize":(n,e,t)=>Jv(Obe,n,90,e,t),"nwse-rotate":(n,e,t)=>Jv(lA,n,0,e,t),"nesw-rotate":(n,e,t)=>Jv(lA,n,90,e,t),"senw-rotate":(n,e,t)=>Jv(lA,n,180,e,t),"swne-rotate":(n,e,t)=>Jv(lA,n,270,e,t)};function pd(n,e=0,t="black"){return K$t[n](hMt(e),!1,t)}function G$t(){const n=ot(),e=Il(),t=FD();oy("useCursor",()=>{const{type:r,rotation:i}=n.getInstanceState().cursor;if(q$t.includes(r)){e.style.setProperty("--tl-cursor",`var(--tl-cursor-${r})`);return}e.style.setProperty("--tl-cursor",pd(r,i,t?"white":"black"))},[n,e,t])}function Z$t(){const n=ot(),e=Il(),t=FD(),r=_t(ta.forceSrgb);Ke.useEffect(()=>{t?(e.setAttribute("data-color-mode","dark"),e.classList.remove("tl-theme__light"),e.classList.add("tl-theme__dark")):(e.setAttribute("data-color-mode","light"),e.classList.remove("tl-theme__dark"),e.classList.add("tl-theme__light")),r?e.classList.add("tl-theme__force-sRGB"):e.classList.remove("tl-theme__force-sRGB")},[n,e,r,t])}function xie(n){const e=y.useRef();return y.useLayoutEffect(()=>{e.current=n}),y.useDebugValue(n),y.useCallback((...t)=>{const r=e.current;return ds(r,"fn does not exist"),r(...t)},[])}function X$t(){const[n,e]=y.useState(0);y.useEffect(()=>e(t=>t+1),[])}function Y$t(){window.alert(`Oops! We could not save changes to your browser's storage. We now need to reload the page and try again.

Keep seeing this message?
• If you're using tldraw in a private or "incognito" window, try loading tldraw in a regular window or in a different browser.
• If your hard disk is full, try clearing up some space and then reload the page.`)}function J$t(){window.alert(`Oops! We could not access your browser's storage—and the app won't work correctly without that. We now need to reload the page and try again.

Keep seeing this message?
• If you're using tldraw in a private or "incognito" window, try loading tldraw in a regular window or in a different browser.`)}const Q$t=(n,e)=>e.some(t=>n instanceof t);let $be,Lbe;function eLt(){return $be||($be=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function tLt(){return Lbe||(Lbe=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const N$e=new WeakMap,cX=new WeakMap,F$e=new WeakMap,$U=new WeakMap,Eie=new WeakMap;function nLt(n){const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("success",o),n.removeEventListener("error",s)},o=()=>{t(Zm(n.result)),i()},s=()=>{r(n.error),i()};n.addEventListener("success",o),n.addEventListener("error",s)});return e.then(t=>{t instanceof IDBCursor&&N$e.set(t,n)}).catch(()=>{}),Eie.set(e,n),e}function rLt(n){if(cX.has(n))return;const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",s),n.removeEventListener("abort",s)},o=()=>{t(),i()},s=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",o),n.addEventListener("error",s),n.addEventListener("abort",s)});cX.set(n,e)}let lX={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return cX.get(n);if(e==="objectStoreNames")return n.objectStoreNames||F$e.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Zm(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function iLt(n){lX=n(lX)}function oLt(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(LU(this),e,...t);return F$e.set(r,e.sort?e.sort():[e]),Zm(r)}:tLt().includes(n)?function(...e){return n.apply(LU(this),e),Zm(N$e.get(this))}:function(...e){return Zm(n.apply(LU(this),e))}}function sLt(n){return typeof n=="function"?oLt(n):(n instanceof IDBTransaction&&rLt(n),Q$t(n,eLt())?new Proxy(n,lX):n)}function Zm(n){if(n instanceof IDBRequest)return nLt(n);if($U.has(n))return $U.get(n);const e=sLt(n);return e!==n&&($U.set(n,e),Eie.set(e,n)),e}const LU=n=>Eie.get(n);function j$e(n,e,{blocked:t,upgrade:r,blocking:i,terminated:o}={}){const s=indexedDB.open(n,e),a=Zm(s);return r&&s.addEventListener("upgradeneeded",c=>{r(Zm(s.result),c.oldVersion,c.newVersion,Zm(s.transaction),c)}),t&&s.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),a.then(c=>{o&&c.addEventListener("close",()=>o()),i&&c.addEventListener("versionchange",l=>i(l.oldVersion,l.newVersion,l))}).catch(()=>{}),a}function aLt(n,{blocked:e}={}){const t=indexedDB.deleteDatabase(n);return e&&t.addEventListener("blocked",r=>e(r.oldVersion,r)),Zm(t).then(()=>{})}const cLt=["get","getKey","getAll","getAllKeys","count"],lLt=["put","add","delete","clear"],NU=new Map;function Nbe(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(NU.get(e))return NU.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=lLt.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||cLt.includes(t)))return;const o=async function(s,...a){const c=this.transaction(s,i?"readwrite":"readonly");let l=c.store;return r&&(l=l.index(a.shift())),(await Promise.all([l[t](...a),i&&c.done]))[0]};return NU.set(e,o),o}iLt(n=>({...n,get:(e,t,r)=>Nbe(e,t)||n.get(e,t,r),has:(e,t)=>!!Nbe(e,t)||n.has(e,t)}));const ON="TLDRAW_DOCUMENT_v2",B$e="TLDRAW_DB_NAME_INDEX_v2",to={Records:"records",Schema:"schema",SessionState:"session_state"};async function MN(n,e){pLt(n);const t=await j$e(n,3,{upgrade(r){r.objectStoreNames.contains(to.Records)||r.createObjectStore(to.Records),r.objectStoreNames.contains(to.Schema)||r.createObjectStore(to.Schema),r.objectStoreNames.contains(to.SessionState)||r.createObjectStore(to.SessionState)}});try{return await e(t)}finally{t.close()}}async function uLt({persistenceKey:n,sessionId:e,didCancel:t}){const r=ON+n;if(Iie().includes(r))return await fLt({persistenceKey:n,didCancel:t}),await MN(r,async i=>{var d,h;if(t!=null&&t())return;const o=i.transaction([to.Records,to.Schema,to.SessionState],"readonly"),s=o.objectStore(to.Records),a=o.objectStore(to.Schema),c=o.objectStore(to.SessionState);let l=e?(d=await c.get(e))==null?void 0:d.snapshot:null;l||(l=(h=(await c.getAll()).sort((p,g)=>p.updatedAt-g.updatedAt).pop())==null?void 0:h.snapshot);const u={records:await s.getAll(),schema:await a.get(to.Schema),sessionStateSnapshot:l};if(t!=null&&t()){o.abort();return}return await o.done,u})}async function dLt({persistenceKey:n,schema:e,changes:t,sessionId:r,sessionStateSnapshot:i,didCancel:o}){const s=ON+n;await MN(s,async a=>{const c=a.transaction([to.Records,to.Schema,to.SessionState],"readwrite"),l=c.objectStore(to.Records),u=c.objectStore(to.Schema),d=c.objectStore(to.SessionState);for(const[h,f]of Object.entries(t.added))await l.put(f,h);for(const[h,f]of Object.values(t.updated))await l.put(f,f.id);for(const h of Object.keys(t.removed))await l.delete(h);if(u.put(e.serialize(),to.Schema),i&&r?d.put({snapshot:i,updatedAt:Date.now(),id:r},r):(i||r)&&console.error("sessionStateSnapshot and instanceId must be provided together"),o!=null&&o())return c.abort();await c.done})}async function hLt({persistenceKey:n,schema:e,snapshot:t,sessionId:r,sessionStateSnapshot:i,didCancel:o}){const s=ON+n;await MN(s,async a=>{const c=a.transaction([to.Records,to.Schema,to.SessionState],"readwrite"),l=c.objectStore(to.Records),u=c.objectStore(to.Schema),d=c.objectStore(to.SessionState);await l.clear();for(const[h,f]of Object.entries(t))await l.put(f,h);if(u.put(e.serialize(),to.Schema),i&&r?d.put({snapshot:i,updatedAt:Date.now(),id:r},r):(i||r)&&console.error("sessionStateSnapshot and instanceId must be provided together"),o!=null&&o())return c.abort();await c.done})}async function fLt({persistenceKey:n,didCancel:e}){await MN(ON+n,async t=>{const r=t.transaction([to.SessionState],"readwrite"),i=r.objectStore(to.SessionState),o=(await i.getAll()).sort((a,c)=>a.updatedAt-c.updatedAt);if(o.length<10){await r.done;return}const s=o.slice(0,o.length-10);for(const{id:a}of s)await i.delete(a);if(e!=null&&e())return r.abort();await r.done})}function Iie(){const n=JSON.parse(Xre(B$e)||"[]")??[];return Array.isArray(n)?n:[]}function pLt(n){const e=new Set(Iie());e.add(n),Yre(B$e,JSON.stringify([...e]))}const gLt=350,mLt=1e4,Fbe=Symbol("UPDATE_INSTANCE_STATE"),vLt=n=>n;class yLt{constructor(e){$(this,"onmessage")}postMessage(e){}close(){}}const bLt=typeof BroadcastChannel>"u"?yLt:BroadcastChannel;class SLt{constructor(e,{persistenceKey:t,sessionId:r=u$,onLoad:i,onLoadError:o},s=new bLt(`tldraw-tab-sync-${t}`)){$(this,"disposables",new Set);$(this,"diffQueue",[]);$(this,"didDispose",!1);$(this,"shouldDoFullDBWrite",!0);$(this,"isReloading",!1);$(this,"persistenceKey");$(this,"sessionId");$(this,"serializedSchema");$(this,"isDebugging",!1);$(this,"documentTypes");$(this,"$sessionStateSnapshot");$(this,"initTime",Date.now());$(this,"isPersisting",!1);$(this,"didLastWriteError",!1);$(this,"scheduledPersistTimeout",null);this.store=e,this.channel=s,typeof window<"u"&&(window.tlsync=this),this.persistenceKey=t,this.sessionId=r,this.serializedSchema=this.store.schema.serialize(),this.$sessionStateSnapshot=E$e(this.store),this.disposables.add(e.listen(({changes:a})=>{this.diffQueue.push(a),this.channel.postMessage(vLt({type:"diff",storeId:this.store.id,changes:a,schema:this.serializedSchema})),this.schedulePersist()},{source:"user",scope:"document"})),this.disposables.add(e.listen(()=>{this.diffQueue.push(Fbe),this.schedulePersist()},{scope:"session"})),this.connect(i,o),this.documentTypes=new Set(Object.values(this.store.schema.types).filter(a=>a.scope==="document").map(a=>a.typeName))}debug(...e){this.isDebugging&&console.debug(...e)}async connect(e,t){this.debug("connecting");let r;try{r=await uLt({persistenceKey:this.persistenceKey,sessionId:this.sessionId,didCancel:()=>this.didDispose})}catch(i){t(i),J$t(),typeof window<"u"&&window.location.reload();return}if(this.debug("loaded data from store",r,"didDispose",this.didDispose),!this.didDispose)try{if(r){const i=Object.fromEntries(r.records.map(a=>[a.id,a])),o=r.sessionStateSnapshot??V8t(i),s=this.store.schema.migrateStoreSnapshot({store:i,schema:r.schema??this.store.schema.serializeEarliestVersion()});if(s.type==="error"){console.error("failed to migrate store",s),t(new Error(`Failed to migrate store: ${s.reason}`));return}this.store.mergeRemoteChanges(()=>{this.store.put(Object.values(s.value).filter(a=>this.documentTypes.has(a.typeName)),"initialize")}),o&&I$e(this.store,o)}this.channel.onmessage=({data:i})=>{var a,c;this.debug("got message",i);const o=i,s=this.store.schema.getMigrationsSince(o.schema);if(s.ok){if(s.value.length>0){this.debug("telling them to reload"),this.channel.postMessage({type:"announce",schema:this.serializedSchema}),this.shouldDoFullDBWrite=!0,this.persistIfNeeded();return}}else{if(Date.now()-this.initTime<5e3){t(new Error("Schema mismatch, please close other tabs and reload the page"));return}this.debug("reloading"),this.isReloading=!0,(c=(a=window==null?void 0:window.location)==null?void 0:a.reload)==null||c.call(a);return}o.type==="diff"&&(this.debug("applying diff"),Gm(()=>{this.store.mergeRemoteChanges(()=>{this.store.applyDiff(o.changes),this.store.ensureStoreIsUsable()})}))},this.channel.postMessage({type:"announce",schema:this.serializedSchema}),this.disposables.add(()=>{this.channel.close()}),e(this)}catch(i){if(this.debug("error loading data from store",i),this.didDispose)return;t(i);return}}close(){this.debug("closing"),this.didDispose=!0,this.disposables.forEach(e=>e())}schedulePersist(){this.debug("schedulePersist",this.scheduledPersistTimeout),!this.scheduledPersistTimeout&&(this.scheduledPersistTimeout=setTimeout(()=>{this.scheduledPersistTimeout=null,this.persistIfNeeded()},this.didLastWriteError?mLt:gLt))}persistIfNeeded(){this.debug("persistIfNeeded",{isPersisting:this.isPersisting,isReloading:this.isReloading,shouldDoFullDBWrite:this.shouldDoFullDBWrite,diffQueueLength:this.diffQueue.length,storeIsPossiblyCorrupt:this.store.isPossiblyCorrupted()}),this.scheduledPersistTimeout&&(clearTimeout(this.scheduledPersistTimeout),this.scheduledPersistTimeout=null),!this.isPersisting&&(this.isReloading||this.store.isPossiblyCorrupted()||(this.shouldDoFullDBWrite||this.diffQueue.length>0)&&this.doPersist())}async doPersist(){ds(!this.isPersisting,"persist already in progress"),this.isPersisting=!0,this.debug("doPersist start");const e=this.diffQueue;this.diffQueue=[];try{if(this.shouldDoFullDBWrite)this.shouldDoFullDBWrite=!1,await hLt({persistenceKey:this.persistenceKey,schema:this.store.schema,snapshot:this.store.serialize(),didCancel:()=>this.didDispose,sessionId:this.sessionId,sessionStateSnapshot:this.$sessionStateSnapshot.get()});else{const t=Qre(e.filter(r=>r!==Fbe));await dLt({persistenceKey:this.persistenceKey,changes:t,schema:this.store.schema,didCancel:()=>this.didDispose,sessionId:this.sessionId,sessionStateSnapshot:this.$sessionStateSnapshot.get()})}this.didLastWriteError=!1}catch(t){this.shouldDoFullDBWrite=!0,this.didLastWriteError=!0,console.error("failed to store changes in indexed db",t),Y$t(),typeof window<"u"&&window.location.reload()}this.isPersisting=!1,this.debug("doPersist end"),this.schedulePersist()}}function H$e({initialData:n,defaultName:e="",id:t,...r}={}){const i="schema"in r&&r.schema?r.schema:rMt({shapes:"shapeUtils"in r&&r.shapeUtils?jbe(R$e(r.shapeUtils)):void 0,bindings:"bindingUtils"in r&&r.bindingUtils?jbe(k$e(r.bindingUtils)):void 0,migrations:"migrations"in r?r.migrations:void 0});return new rie({id:t,schema:i,initialData:n,props:{defaultName:e}})}function jbe(n){return Object.fromEntries(n.map(e=>[e.type,{props:e.props,migrations:e.migrations}]))}function Bbe(n){const e=H$e(n);return n.snapshot&&P$e(e,n.snapshot),{store:e,opts:n}}function U$e(n){const[e,t]=y.useState(()=>Bbe(n));if(!O6e(e.opts,n)){const r=Bbe(n);return t(r),r.store}return e.store}function _Lt({persistenceKey:n,sessionId:e,...t}){const[r,i]=y.useState(null),o=U$e(t);return y.useEffect(()=>{const s=us();if(!n){i({id:s,storeWithStatus:{status:"not-synced",store:o}});return}i({id:s,storeWithStatus:{status:"loading"}});const a=l=>{i(u=>(u==null?void 0:u.id)===s?{id:s,storeWithStatus:l}:u)},c=new SLt(o,{sessionId:e,persistenceKey:n,onLoad(){a({store:o,status:"synced-local"})},onLoadError(l){a({status:"error",error:l})}});return()=>{i(l=>(l==null?void 0:l.id)===s?null:l),c.close()}},[n,o,e]),(r==null?void 0:r.storeWithStatus)??{status:"loading"}}function wLt(){const n=ot(),e=Il();y.useEffect(()=>{const t=o=>e.style.setProperty("--tl-zoom",o.toString()),r=P6e(t,100),i=new pE("useZoomCss",()=>{n.getCurrentPageShapeIds().size<300?t(n.getZoomLevel()):r(n.getZoomLevel())});return i.attach(),i.execute(),()=>{i.detach(),r.cancel()}},[n,e])}const CLt=[],xLt=[],ELt=[],ILt=y.memo(function({store:e,components:t,className:r,user:i,...o}){const[s,a]=Ke.useState(null),c=y.useMemo(()=>i??_$e(),[i]),l=(t==null?void 0:t.ErrorFallback)===void 0?p$e:t==null?void 0:t.ErrorFallback,u={...o,shapeUtils:o.shapeUtils??CLt,bindingUtils:o.bindingUtils??xLt,tools:o.tools??ELt,components:t};return x.jsx("div",{ref:a,draggable:!1,className:Ue("tl-container tl-theme__light",r),onPointerDown:Wc,tabIndex:-1,children:x.jsx(V3,{fallback:l,onError:d=>Gre(d,{tags:{origin:"react.tldraw-before-app"}}),children:s&&x.jsx(CMt,{container:s,children:x.jsx(P8t,{overrides:t,children:e?e instanceof rie?x.jsx(V$e,{...u,store:e,user:c}):x.jsx(z$e,{...u,store:e,user:c}):x.jsx(PLt,{...u,store:e,user:c})})})})})});function PLt(n){const{defaultName:e,snapshot:t,initialData:r,shapeUtils:i,bindingUtils:o,persistenceKey:s,sessionId:a,user:c}=n,l=_Lt({shapeUtils:i,bindingUtils:o,initialData:r,persistenceKey:s,sessionId:a,defaultName:e,snapshot:t});return x.jsx(z$e,{...n,store:l,user:c})}const z$e=y.memo(function({store:e,user:t,...r}){const i=Il();y.useLayoutEffect(()=>{t.userPreferences.get().colorScheme==="dark"&&(i.classList.remove("tl-theme__light"),i.classList.add("tl-theme__dark"))},[i,t]);const{LoadingScreen:o}=hs();switch(e.status){case"error":throw e.error;case"loading":return o?x.jsx(o,{}):null}return x.jsx(V$e,{...r,store:e.store,user:t})});function V$e({onMount:n,children:e,store:t,tools:r,shapeUtils:i,bindingUtils:o,user:s,initialState:a,autoFocus:c=!0,inferDarkMode:l,cameraOptions:u,assetOptions:d,options:h}){const{ErrorFallback:f}=hs(),p=Il(),g=y.useRef(null),[m,v]=y.useState(null),b=g.current;m!==b&&v(b);const[S]=y.useState(c);y.useLayoutEffect(()=>{const C=new En({store:t,shapeUtils:i,bindingUtils:o,tools:r,getContainer:()=>p,user:s,initialState:a,autoFocus:S,inferDarkMode:l,cameraOptions:u,assetOptions:d,options:h});return g.current=C,v(C),()=>{C.dispose()}},[p,i,o,r,t,s,a,S,l,u,d,h]);const E=y.useSyncExternalStore(y.useCallback(C=>b?(b.on("crash",C),()=>b.off("crash",C)):()=>{},[b]),()=>(b==null?void 0:b.getCrashingError())??null),{Canvas:w}=hs();return b?x.jsx(V3,{fallback:f,onError:C=>b.annotateError(C,{origin:"react.tldraw",willCrashApp:!0}),children:E?x.jsx(TLt,{crashingError:E}):x.jsx(TN.Provider,{value:b,children:x.jsx(kLt,{onMount:n,children:e??(w?x.jsx(w,{}):null)})})}):null}function kLt({children:n,onMount:e}){return wLt(),G$t(),Z$t(),X$t(),DLt(e),x.jsx(x.Fragment,{children:n})}function TLt({crashingError:n}){throw n}function Pie({children:n}){return x.jsx("div",{className:"tl-loading",children:n})}function W$e({children:n}){return x.jsx("div",{className:"tl-loading",children:n})}function DLt(n){const e=ot(),t=xie(r=>{let i;return r.history.ignore(()=>{i=n==null?void 0:n(r),r.emit("mount")}),window.tldrawReady=!0,i});Ke.useLayoutEffect(()=>{if(e)return t==null?void 0:t(e)},[e,t])}function WS({children:n,className:e="",...t}){return x.jsx("div",{...t,className:Ue("tl-html-container",e),children:n})}class CO{constructor(e){this.editor=e}}$(CO,"props"),$(CO,"migrations"),$(CO,"type");function q$e(n,e,t={}){const{newPoint:r,handle:i,scaleX:o,scaleY:s}=e,{minWidth:a=1,maxWidth:c=1/0,minHeight:l=1,maxHeight:u=1/0}=t;let d=n.props.w*o,h=n.props.h*s;const f=new H(0,0);if(d>0){if(d<a){switch(i){case"top_left":case"left":case"bottom_left":{f.x=d-a;break}case"top":case"bottom":{f.x=(d-a)/2;break}default:f.x=0}d=a}}else if(f.x=d,d=-d,d<a){switch(i){case"top_left":case"left":case"bottom_left":{f.x=-d;break}default:f.x=-a}d=a}if(h>0){if(h<l){switch(i){case"top_left":case"top":case"top_right":{f.y=h-l;break}case"right":case"left":{f.y=(h-l)/2;break}default:f.y=0}h=l}}else if(f.y=h,h=-h,h<l){switch(i){case"top_left":case"top":case"top_right":{f.y=-h;break}default:f.y=-l}h=l}const{x:p,y:g}=f.rot(n.rotation).add(r);return{x:p,y:g,props:{w:Math.min(c,d),h:Math.min(u,h)}}}class vE extends qf{constructor(){super(...arguments);$(this,"onResize",(t,r)=>q$e(t,r))}getGeometry(t){return new hv({width:t.props.w,height:t.props.h,isFilled:!0})}getHandleSnapGeometry(t){return{points:this.getGeometry(t).bounds.cornersAndCenter}}}var IV;let RLt=(IV=class extends Ln{constructor(){super(...arguments);$(this,"onPointerDown",t=>{this.parent.transition("pointing",t)});$(this,"onEnter",()=>{this.editor.setCursor({type:"cross",rotation:0})});$(this,"onCancel",()=>{this.editor.setCurrentTool("select")})}},$(IV,"id","idle"),IV);var PV;let ALt=(PV=class extends Ln{constructor(){super(...arguments);$(this,"markId","");$(this,"wasFocusedOnEnter",!1);$(this,"onEnter",()=>{this.wasFocusedOnEnter=!this.editor.getIsMenuOpen()});$(this,"onPointerMove",t=>{if(this.editor.inputs.isDragging){const{originPagePoint:r}=this.editor.inputs,i=this.parent.shapeType,o=ro();this.markId=`creating:${o}`,this.editor.mark(this.markId),this.editor.createShapes([{id:o,type:i,x:r.x,y:r.y,props:{w:1,h:1}}]).select(o),this.editor.setCurrentTool("select.resizing",{...t,target:"selection",handle:"bottom_right",isCreating:!0,creationCursorOffset:{x:1,y:1},onInteractionEnd:this.parent.id,onCreate:this.parent.onCreate})}});$(this,"onPointerUp",()=>{this.complete()});$(this,"onCancel",()=>{this.cancel()});$(this,"onComplete",()=>{this.complete()});$(this,"onInterrupt",()=>{this.cancel()})}complete(){const{originPagePoint:t}=this.editor.inputs;if(!this.wasFocusedOnEnter)return;this.editor.mark(this.markId);const r=this.parent.shapeType,i=ro();this.editor.mark(this.markId),this.editor.createShapes([{id:i,type:r,x:t.x,y:t.y}]);const o=this.editor.getShape(i);if(!o){this.cancel();return}let{w:s,h:a}=o.props;const c=new H(s/2,a/2),l=this.editor.getShapeParentTransform(o);l&&c.rot(-l.rotation());let u=1;this.editor.user.getIsDynamicResizeMode()&&(u=1/this.editor.getZoomLevel(),s*=u,a*=u,c.mul(u));const d=ls(o);d.x=o.x-c.x,d.y=o.y-c.y,d.props.w=s,d.props.h=a,"scale"in o.props&&(d.props.scale=u),this.editor.updateShape(d),this.editor.setSelectedShapes([i]),this.editor.getInstanceState().isToolLocked?this.parent.transition("idle"):this.editor.setCurrentTool("select.idle")}cancel(){this.parent.transition("idle")}},$(PV,"id","pointing"),PV);class xO extends Ln{constructor(){super(...arguments);$(this,"onCreate")}}$(xO,"id","box"),$(xO,"initial","idle"),$(xO,"children",()=>[RLt,ALt]);function $N(n){const e=ot();return _t("isEditing",()=>e.getEditingShapeId()===n,[e,n])}function OLt(){return y.useId().replace(/:/g,"_")}function Ip(n){const e=ot();return y.useMemo(function(){const i=l=>{if(l.isKilled)return;if(l.button===hie){e.dispatch({type:"pointer",target:"selection",handle:n,name:"right_click",...Bu(l)});return}if(l.button!==0)return;const u=c$(l.currentTarget);function d(){u.removeEventListener("pointerup",d),OD(u,l)}AD(u,l),u.addEventListener("pointerup",d),e.dispatch({name:"pointer_down",type:"pointer",target:"selection",handle:n,...Bu(l)}),Wc(l)};let o,s;function a(l){l.isKilled||l.button===0&&(l.clientX===o&&l.clientY===s||(o=l.clientX,s=l.clientY,e.dispatch({name:"pointer_move",type:"pointer",target:"selection",handle:n,...Bu(l)})))}return{onPointerDown:i,onPointerMove:a,onPointerUp:l=>{l.isKilled||l.button===0&&e.dispatch({name:"pointer_up",type:"pointer",target:"selection",handle:n,...Bu(l)})}}},[e,n])}const MLt=20,$Lt=8;function kie(n,e=MLt){return Math.max($Lt,Math.ceil(n/e))}class cC extends Xy{constructor(t){super({...t,isFilled:!1,isClosed:!1});$(this,"_center");$(this,"radius");$(this,"start");$(this,"end");$(this,"largeArcFlag");$(this,"sweepFlag");$(this,"measure");$(this,"angleStart");$(this,"angleEnd");const{center:r,sweepFlag:i,largeArcFlag:o,start:s,end:a}=t;if(s.equals(a))throw Error("Arc must have different start and end points.");this.angleStart=H.Angle(r,s),this.angleEnd=H.Angle(r,a),this.radius=H.Dist(r,s),this.measure=fMt(this.angleStart,this.angleEnd,i,o),this.start=s,this.end=a,this.sweepFlag=i,this.largeArcFlag=o,this._center=r}nearestPoint(t){const{_center:r,measure:i,radius:o,angleEnd:s,angleStart:a,start:c,end:l}=this,u=rX(i,a,s,r.angle(t));if(u<=0)return c;if(u>=1)return l;const d=r.clone().add(t.clone().sub(r).uni().mul(o));let h,f=1/0,p;for(const g of[c,l,d])p=H.Dist2(t,g),p<f&&(h=g,f=p);if(!h)throw Error("nearest point not found");return h}hitTestLineSegment(t,r){const{_center:i,radius:o,measure:s,angleStart:a,angleEnd:c}=this,l=LD(t,r,i,o);return l===null?!1:l.some(u=>{const d=rX(s,a,c,i.angle(u));return d>=0&&d<=1})}getVertices(){const{_center:t,measure:r,length:i,radius:o,angleStart:s}=this,a=[];for(let c=0,l=kie(Math.abs(i));c<l+1;c++){const u=c/l*r,d=s+u;a.push(VS(t,o,d))}return a}getSvgPathData(t=!0){const{start:r,end:i,radius:o,largeArcFlag:s,sweepFlag:a}=this;return`${t?`M${r.toFixed()}`:""} A${o} ${o} 0 ${s} ${a} ${i.toFixed()}`}getLength(){return this.measure*this.radius}}class Tie extends Xy{constructor(t){super({isClosed:!0,...t});$(this,"_center");$(this,"radius");$(this,"x");$(this,"y");this.config=t;const{x:r=0,y:i=0,radius:o}=t;this.x=r,this.y=i,this._center=new H(o+r,o+i),this.radius=o}getBounds(){return new xn(this.x,this.y,this.radius*2,this.radius*2)}getVertices(){const{_center:t,radius:r}=this,i=Xi*r,o=[];for(let s=0,a=kie(i);s<a;s++){const c=s/a*Xi;o.push(VS(t,r,c))}return o}nearestPoint(t){const{_center:r,radius:i}=this;return r.equals(t)?H.AddXY(r,i,0):r.clone().add(t.clone().sub(r).uni().mul(i))}hitTestLineSegment(t,r,i=0){const{_center:o,radius:s}=this;return LD(t,r,o,s+i)!==null}getSvgPathData(){const{_center:t,radius:r}=this;return`M${t.x+r},${t.y} a${r},${r} 0 1,0 ${r*2},0a${r},${r} 0 1,0 -${r*2},0`}}class hl extends mE{constructor(t){const{start:r,cp1:i,cp2:o,end:s}=t;super({...t,points:[r,s]});$(this,"a");$(this,"b");$(this,"c");$(this,"d");this.a=r,this.b=i,this.c=o,this.d=s}getVertices(){const t=[],{a:r,b:i,c:o,d:s}=this;for(let a=0,c=10;a<=c;a++){const l=a/c;t.push(new H((1-l)*(1-l)*(1-l)*r.x+3*((1-l)*(1-l))*l*i.x+3*(1-l)*(l*l)*o.x+l*l*l*s.x,(1-l)*(1-l)*(1-l)*r.y+3*((1-l)*(1-l))*l*i.y+3*(1-l)*(l*l)*o.y+l*l*l*s.y))}return t}midPoint(){return hl.GetAtT(this,.5)}nearestPoint(t){let r,i=1/0,o,s;for(const a of this.segments)s=a.nearestPoint(t),o=H.Dist2(s,t),o<i&&(r=s,i=o);if(!r)throw Error("nearest point not found");return r}getSvgPathData(t=!0){const{a:r,b:i,c:o,d:s}=this;return`${t?`M ${r.toFixed()} `:""} C${i.toFixed()} ${o.toFixed()} ${s.toFixed()}`}static GetAtT(t,r){const{a:i,b:o,c:s,d:a}=t;return new H((1-r)*(1-r)*(1-r)*i.x+3*((1-r)*(1-r))*r*o.x+3*(1-r)*(r*r)*s.x+r*r*r*a.x,(1-r)*(1-r)*(1-r)*i.y+3*((1-r)*(1-r))*r*o.y+3*(1-r)*(r*r)*s.y+r*r*r*a.y)}getLength(t=32){let r,i=this.a,o=0;for(let s=1;s<=t;s++)r=hl.GetAtT(this,s/t),o+=H.Dist(i,r),i=r;return o}}class LLt extends Xy{constructor(t){super({...t,isClosed:!1,isFilled:!1});$(this,"points");$(this,"_segments");const{points:r}=t;this.points=r}get segments(){if(!this._segments){this._segments=[];const{points:t}=this,r=t.length,i=r-2,o=1.25;for(let s=0;s<r-1;s++){const a=s===0?t[0]:t[s-1],c=t[s],l=t[s+1],u=s===i?l:t[s+2],d=c,h=s===0?a:new H(c.x+(l.x-a.x)/6*o,c.y+(l.y-a.y)/6*o),f=s===i?l:new H(l.x-(u.x-c.x)/6*o,l.y-(u.y-c.y)/6*o),p=l;this._segments.push(new hl({start:d,cp1:h,cp2:f,end:p}))}}return this._segments}getLength(){return this.segments.reduce((t,r)=>t+r.length,0)}getVertices(){const t=this.segments.reduce((r,i)=>r.concat(i.vertices),[]);return t.push(this.points[this.points.length-1]),t}nearestPoint(t){let r,i=1/0,o,s;for(const a of this.segments)s=a.nearestPoint(t),o=H.Dist2(s,t),o<i&&(r=s,i=o);if(!r)throw Error("nearest point not found");return r}hitTestLineSegment(t,r){return this.segments.some(i=>i.hitTestLineSegment(t,r))}getSvgPathData(){let t=this.segments.reduce((r,i,o)=>r+i.getSvgPathData(o===0),"");return this.isClosed&&(t+="Z"),t}}class NLt extends Xy{constructor(t){super({...t,isClosed:!0});$(this,"w");$(this,"h");$(this,"_edges");this.config=t;const{width:r,height:i}=t;this.w=r,this.h=i}get edges(){if(!this._edges){const{vertices:t}=this;this._edges=[];for(let r=0,i=t.length;r<i;r++){const o=t[r],s=t[(r+1)%i];this._edges.push(new Nm({start:o,end:s}))}}return this._edges}getVertices(){const t=Math.max(1,this.w),r=Math.max(1,this.h),i=t/2,o=r/2,s=Math.pow(i-o,2)/Math.pow(i+o,2),a=Ai*(i+o)*(1+3*s/(10+Math.sqrt(4-3*s))),c=kie(a),l=Xi/c,u=Math.cos(l),d=Math.sin(l);let h=0,f=1,p=0,g=1;const m=Array(c);for(let v=0;v<c;v++)m[v]=new H(i+i*f,o+o*h),p=d*f+u*h,g=u*f-d*h,h=p,f=g;return m}nearestPoint(t){let r,i=1/0,o,s;for(const a of this.edges)s=a.nearestPoint(t),o=H.Dist2(s,t),o<i&&(r=s,i=o);if(!r)throw Error("nearest point not found");return r}hitTestLineSegment(t,r){return this.edges.some(i=>i.hitTestLineSegment(t,r))}getBounds(){return new xn(0,0,this.w,this.h)}getLength(){const{w:t,h:r}=this,i=t/2,o=r/2,s=Math.max(0,i),a=Math.max(0,o);return V8e(s,a)}getSvgPathData(t=!1){const{w:r,h:i}=this,o=r/2,s=i/2,a=Math.max(0,o),c=Math.max(0,s);return`${t?`M${o-a},${s}`:""} a${a},${c},0,1,1,${a*2},0a${a},${c},0,1,1,-${a*2},0`}}class FLt extends Xy{constructor(t){super({...t,isClosed:!0});$(this,"w");$(this,"h");$(this,"a");$(this,"b");$(this,"c");$(this,"d");this.config=t;const{width:r,height:i}=t;if(this.w=r,this.h=i,i>r){const o=r/2;this.a=new cC({start:new H(0,o),end:new H(r,o),center:new H(r/2,o),sweepFlag:1,largeArcFlag:1}),this.b=new Nm({start:new H(r,o),end:new H(r,i-o)}),this.c=new cC({start:new H(r,i-o),end:new H(0,i-o),center:new H(r/2,i-o),sweepFlag:1,largeArcFlag:1}),this.d=new Nm({start:new H(0,i-o),end:new H(0,o)})}else{const o=i/2;this.a=new cC({start:new H(o,i),end:new H(o,0),center:new H(o,o),sweepFlag:1,largeArcFlag:1}),this.b=new Nm({start:new H(o,0),end:new H(r-o,0)}),this.c=new cC({start:new H(r-o,0),end:new H(r-o,i),center:new H(r-o,o),sweepFlag:1,largeArcFlag:1}),this.d=new Nm({start:new H(r-o,i),end:new H(o,i)})}}nearestPoint(t){let r,i=1/0,o,s;const{a,b:c,c:l,d:u}=this;for(const d of[a,c,l,u])s=d.nearestPoint(t),o=H.Dist2(s,t),o<i&&(r=s,i=o);if(!r)throw Error("nearest point not found");return r}hitTestLineSegment(t,r){const{a:i,b:o,c:s,d:a}=this;return[i,o,s,a].some(c=>c.hitTestLineSegment(t,r))}getVertices(){const{a:t,b:r,c:i,d:o}=this;return[t,r,i,o].reduce((s,a)=>(s.push(...a.vertices),s),[])}getBounds(){return new xn(0,0,this.w,this.h)}getLength(){const{h:t,w:r}=this;return t>r?(Ai*(r/2)+(t-r))*2:(Ai*(t/2)+(r-t))*2}getSvgPathData(){const{a:t,b:r,c:i,d:o}=this;return[t,r,i,o].map((s,a)=>s.getSvgPathData(a===0)).join(" ")+" Z"}}async function jLt({shouldReload:n=!0}={}){l4t(),await Promise.all(Iie().map(e=>aLt(e))),c4t(),n&&window.location.reload()}typeof window<"u"&&(window.__tldraw__hardReset=jLt);function BLt(n,e="_blank"){vie.openWindow(n,e)}const K$e="TLDRAW_ASSET_STORE_v1",sx={Assets:"assets"};async function G$e(n,e){const t=await j$e(n,1,{upgrade(r){r.objectStoreNames.contains(sx.Assets)||r.createObjectStore(sx.Assets)}});try{return await e(t)}finally{t.close()}}async function HLt({persistenceKey:n,assetId:e}){const t=K$e+n;return await G$e(t,async r=>await r.transaction([sx.Assets],"readwrite").objectStore(sx.Assets).get(e))}async function ULt({persistenceKey:n,assetId:e,blob:t}){const r=K$e+n;await G$e(r,async i=>{const o=i.transaction([sx.Assets],"readwrite");await o.objectStore(sx.Assets).put(t,e),await o.done})}function zLt({children:n}){const e=ot();return _t("shouldDisplayHandles",()=>{if(e.isInAny("select.idle","select.pointing_handle","select.pointing_shape"))return!0;if(e.isInAny("select.editing_shape")){const r=e.getOnlySelectedShape();return r&&e.isShapeOfType(r,"note")}return!1},[e])?x.jsx("svg",{className:"tl-user-handles tl-overlays__item",children:n}):null}const{PI:VLt}=Math,ZC=VLt+1e-4;function Z$e(n,e={}){const{size:t=16,smoothing:r=.5}=e;if(n.length===0||t<=0)return{left:[],right:[]};const i=n[0],o=n[n.length-1],s=o.runningLength,a=Math.pow(t*r,2),c=[],l=[];let u=n[0].vector,d=n[0].point,h=d,f=d,p=h,g=!1,m;for(let v=0;v<n.length;v++){m=n[v];const{point:b,vector:S}=n[v],E=m.vector.dpr(u),w=(v<n.length-1?n[v+1]:n[v]).vector,C=v<n.length-1?w.dpr(m.vector):1,I=E<0&&!g,T=C!==null&&C<.2;if(I||T){if(C>-.62&&s-m.runningLength>m.radius){const O=u.clone().mul(m.radius);u.clone().cpr(w)<0?(f=H.Add(b,O),p=H.Sub(b,O)):(f=H.Sub(b,O),p=H.Add(b,O)),c.push(f),l.push(p)}else{const O=u.clone().mul(m.radius).per(),M=H.Sub(m.input,O);for(let R=1/13,A=0;A<1;A+=R)f=H.RotWith(M,m.input,ZC*A),c.push(f),p=H.RotWith(M,m.input,ZC+ZC*-A),l.push(p)}d=f,h=p,T&&(g=!0);continue}if(g=!1,m===i||m===o){const O=H.Per(S).mul(m.radius);c.push(H.Sub(b,O)),l.push(H.Add(b,O));continue}const D=H.Lrp(w,S,C).per().mul(m.radius);f=H.Sub(b,D),(v<=1||H.Dist2(d,f)>a)&&(c.push(f),d=f),p=H.Add(b,D),(v<=1||H.Dist2(h,p)>a)&&(l.push(p),h=p),u=S}return{left:c,right:l}}function Die(n,e={}){const{size:t=16,start:r={},end:i={},last:o=!1}=e,{cap:s=!0}=r,{cap:a=!0}=i;if(n.length===0||t<=0)return[];const c=n[0],l=n[n.length-1],u=l.runningLength,d=r.taper===!1?0:r.taper===!0?Math.max(t,u):r.taper,h=i.taper===!1?0:i.taper===!0?Math.max(t,u):i.taper,{left:f,right:p}=Z$e(n,e),g=c.point,m=n.length>1?n[n.length-1].point:H.AddXY(c.point,1,1);if(n.length===1&&(!(d||h)||o)){const E=H.Add(g,H.Sub(g,m).uni().per().mul(-c.radius)),w=[];for(let C=1/13,I=C;I<=1;I+=C)w.push(H.RotWith(E,g,ZC*2*I));return w}const v=[];if(!(d||h&&n.length===1))if(s)for(let E=1/8,w=E;w<=1;w+=E){const C=H.RotWith(p[0],g,ZC*w);v.push(C)}else{const E=H.Sub(f[0],p[0]),w=H.Mul(E,.5),C=H.Mul(E,.51);v.push(H.Sub(g,w),H.Sub(g,C),H.Add(g,C),H.Add(g,w))}const b=[],S=l.vector.clone().per().neg();if(h||d&&n.length===1)b.push(m);else if(a){const E=H.Add(m,H.Mul(S,l.radius));for(let w=1/29,C=w;C<1;C+=w)b.push(H.RotWith(E,m,ZC*3*C))}else b.push(H.Add(m,H.Mul(S,l.radius)),H.Add(m,H.Mul(S,l.radius*.99)),H.Sub(m,H.Mul(S,l.radius*.99)),H.Sub(m,H.Mul(S,l.radius)));return f.concat(b,p.reverse(),v)}const WLt=.025,qLt=.01;function Sg(n,e={}){var m;const{streamline:t=.5,size:r=16,simulatePressure:i=!1}=e;if(n.length===0)return[];const o=.15+(1-t)*.85;let s=n.map(H.From),a=0;if(!i){let v=s[0];for(;v&&!(v.z>=WLt);)s.shift(),v=s[0]}if(!i){let v=s[s.length-1];for(;v&&!(v.z>=qLt);)s.pop(),v=s[s.length-1]}if(s.length===0)return[{point:H.From(n[0]),input:H.From(n[0]),pressure:i?.5:.15,vector:new H(1,1),distance:0,runningLength:0,radius:1}];let c=s[1];for(;c&&!(H.Dist2(c,s[0])>(r/3)**2);)s[0].z=Math.max(s[0].z,c.z),s.splice(1,1),c=s[1];const l=s.pop();for(c=s[s.length-1];c&&!(H.Dist2(c,l)>(r/3)**2);)s.pop(),c=s[s.length-1],a++;s.push(l);const u=e.last||!e.simulatePressure||s.length>1&&H.Dist2(s[s.length-1],s[s.length-2])<r**2||a>0;if(s.length===2&&e.simulatePressure){const v=s[1];s=s.slice(0,-1);for(let b=1;b<5;b++){const S=H.Lrp(s[0],v,b/4);S.z=(s[0].z+(v.z-s[0].z))*b/4,s.push(S)}}const d=[{point:s[0],input:s[0],pressure:i?.5:s[0].z,vector:new H(1,1),distance:0,runningLength:0,radius:1}];let h=0,f=d[0],p,g;u&&t>0&&s.push(s[s.length-1].clone());for(let v=1,b=s.length;v<b;v++)p=!o||e.last&&v===b-1?s[v].clone():s[v].clone().lrp(f.point,1-o),!f.point.equals(p)&&(g=H.Dist(p,f.point),h+=g,!(v<4&&h<r)&&(f={input:s[v],point:p,pressure:i?.5:s[v].z,vector:H.Sub(f.point,p).uni(),distance:g,runningLength:h,radius:1},d.push(f)));if((m=d[1])!=null&&m.vector&&(d[0].vector=d[1].vector.clone()),h<1){const v=Math.max(.5,...d.map(b=>b.pressure));d.forEach(b=>b.pressure=v)}return d}const{min:Qv}=Math,FU=.275;function LN(n,e){const{size:t=16,thinning:r=.5,simulatePressure:i=!0,easing:o=m=>m,start:s={},end:a={}}=e,{easing:c=uc.easeOutQuad}=s,{easing:l=uc.easeOutCubic}=a,u=n[n.length-1].runningLength;let d,h=n[0].pressure,f;if(!i&&u<t){const m=n.reduce((v,b)=>Math.max(v,b.pressure),.5);return n.forEach(v=>{v.pressure=m,v.radius=t*o(.5-r*(.5-v.pressure))}),n}else{let m;for(let v=0,b=n.length;v<b&&(f=n[v],!(f.runningLength>t*5));v++){const S=Qv(1,f.distance/t);if(i){const E=Qv(1,1-S);m=Qv(1,h+(E-h)*(S*FU))}else m=Qv(1,h+(f.pressure-h)*.5);h=h+(m-h)*.5}for(let v=0;v<n.length;v++){if(f=n[v],r){let{pressure:b}=f;const S=Qv(1,f.distance/t);if(i){const E=Qv(1,1-S);b=Qv(1,h+(E-h)*(S*FU))}else b=Qv(1,h+(b-h)*(S*FU));f.radius=t*o(.5-r*(.5-b)),h=b}else f.radius=t/2;d===void 0&&(d=f.radius)}}const p=s.taper===!1?0:s.taper===!0?Math.max(t,u):s.taper,g=a.taper===!1?0:a.taper===!0?Math.max(t,u):a.taper;if(p||g)for(let m=0;m<n.length;m++){f=n[m];const{runningLength:v}=f,b=v<p?c(v/p):1,S=u-v<g?l((u-v)/g):1;f.radius=Math.max(.01,f.radius*Math.min(b,S))}return n}function KLt(n,e={}){return Die(LN(Sg(n,e),e),e)}function Hbe({scribble:n,zoom:e,color:t,opacity:r,className:i}){if(!n.points.length)return null;const o=KLt(n.points,{size:n.size/e,start:{taper:n.taper,easing:uc.linear},last:n.state==="stopping",simulatePressure:!1,streamline:.32});let s;if(o.length<4){const a=n.size/e/2,{x:c,y:l}=n.points[n.points.length-1];s=`M ${c-a},${l} a ${a},${a} 0 1,0 ${a*2},0 a ${a},${a} 0 1,0 ${-a*2},0`}else s=pie(o);return x.jsx("svg",{className:i&&Ue("tl-overlays__item",i),children:x.jsx("path",{className:"tl-scribble",d:s,fill:t??`var(--color-${n.color})`,opacity:r??n.opacity})})}const GLt=({bounds:n,rotation:e})=>{const t=ot();return _t("should display",()=>t.isInAny("select.idle","select.brushing","select.scribble_brushing","select.pointing_shape","select.pointing_selection","text.resizing"),[t])?x.jsx(u$e,{bounds:n,rotation:e}):null};function Ev(){const n=ot();return _t("isReadonlyMode",()=>n.getInstanceState().isReadonly,[n])}function ZLt({size:n,width:e,height:t,hideAlternateHandles:r}){const i=et(n/3),o=i/2;return x.jsxs("svg",{className:"tl-overlays__item",children:[x.jsx("polyline",{className:"tl-corner-crop-handle",points:`
						${et(0-o)},${et(n)} 
						${et(0-o)},${et(0-o)} 
						${et(n)},${et(0-o)}`,strokeWidth:i,"data-testid":"selection.crop.top_left","aria-label":"top_left handle"}),x.jsx("line",{className:Ue("tl-corner-crop-edge-handle",{"tl-hidden":r}),x1:et(e/2-n),y1:et(0-o),x2:et(e/2+n),y2:et(0-o),strokeWidth:i,"data-testid":"selection.crop.top","aria-label":"top handle"}),x.jsx("polyline",{className:Ue("tl-corner-crop-handle",{"tl-hidden":r}),points:`
						${et(e-n)},${et(0-o)} 
						${et(e+o)},${et(0-o)} 
						${et(e+o)},${et(n)}`,strokeWidth:i,"data-testid":"selection.crop.top_right","aria-label":"top_right handle"}),x.jsx("line",{className:Ue("tl-corner-crop-edge-handle",{"tl-hidden":r}),x1:et(e+o),y1:et(t/2-n),x2:et(e+o),y2:et(t/2+n),strokeWidth:i,"data-testid":"selection.crop.right","aria-label":"right handle"}),x.jsx("polyline",{className:"tl-corner-crop-handle",points:`
						${et(e+o)},${et(t-n)} 
						${et(e+o)},${et(t+o)}
						${et(e-n)},${et(t+o)}`,strokeWidth:i,"data-testid":"selection.crop.bottom_right","aria-label":"bottom_right handle"}),x.jsx("line",{className:Ue("tl-corner-crop-edge-handle",{"tl-hidden":r}),x1:et(e/2-n),y1:et(t+o),x2:et(e/2+n),y2:et(t+o),strokeWidth:i,"data-testid":"selection.crop.bottom","aria-label":"bottom handle"}),x.jsx("polyline",{className:Ue("tl-corner-crop-handle",{"tl-hidden":r}),points:`
						${et(0+n)},${et(t+o)} 
						${et(0-o)},${et(t+o)}
						${et(0-o)},${et(t-n)}`,strokeWidth:i,"data-testid":"selection.crop.bottom_left","aria-label":"bottom_left handle"}),x.jsx("line",{className:Ue("tl-corner-crop-edge-handle",{"tl-hidden":r}),x1:et(0-o),y1:et(t/2-n),x2:et(0-o),y2:et(t/2+n),strokeWidth:i,"data-testid":"selection.crop.left","aria-label":"left handle"})]})}const XLt=Zd(function({bounds:e,rotation:t}){const r=ot(),i=y.useRef(null),o=Ev(),s=Ip("top"),a=Ip("right"),c=Ip("bottom"),l=Ip("left"),u=Ip("top_left"),d=Ip("top_right"),h=Ip("bottom_right"),f=Ip("bottom_left"),p=!r.getIsMenuOpen()&&r.getInstanceState().cursor.type==="default",g=r.getInstanceState().isCoarsePointer,m=r.getOnlySelectedShape(),v=m&&r.isShapeOrAncestorLocked(m),b=m?r.getShapeUtil(m).expandSelectionOutlinePx(m):0;if(gE(i,e==null?void 0:e.x,e==null?void 0:e.y,1,r.getSelectionRotation(),{x:-b,y:-b}),!e)return null;e=e.clone().expandBy(b).zeroFix();const S=r.getZoomLevel(),E=r.getInstanceState().isChangingStyle,w=e.width,C=e.height,I=8/S,T=w<I*2,D=C<I*2,O=w<I*4,M=C<I*4,R=w<I*5,A=C<I*5,k=g?1.75:1,L=6/S*k,j=(O?L/2:L)*(k*.75),N=(M?L/2:L)*(k*.75),B=(m?!r.getShapeUtil(m).hideSelectionBoundsFg(m):!0)&&!E;let U=B&&r.isInAny("select.idle","select.brushing","select.scribble_brushing","select.pointing_canvas","select.pointing_selection","select.pointing_shape","select.crop.idle","select.crop.pointing_crop","select.crop.pointing_crop_handle","select.pointing_resize_handle")||B&&r.isIn("select.resizing")&&m&&r.isShapeOfType(m,"text");m&&U&&r.environment.isFirefox&&r.isShapeOfType(m,"embed")&&(U=!1);const K=r.isInAny("select.crop.idle","select.crop.pointing_crop","select.crop.pointing_crop_handle")&&!E&&!o,z=r.isInAny("select.idle","select.pointing_selection","select.pointing_shape","select.crop.idle")&&!E&&!o,G=!g&&!(T||D)&&(z||K)&&(m?!r.getShapeUtil(m).hideRotateHandle(m):!0)&&!v,te=g&&(!O||!M)&&(z||K)&&(m?!r.getShapeUtil(m).hideRotateHandle(m):!0)&&!v,ie=z&&(m?r.getShapeUtil(m).canResize(m)&&!r.getShapeUtil(m).hideResizeHandles(m):!0)&&!K&&!v,Q=T||D,ge=T&&D,_e=R||A,Se=ie||K,se=!G,ee=!z||!te,Y=!z||!Se,ue=!z||!Se||Q,ye=!z||!Se||Q,V=!z||!Se||ge&&!K;let le=!0,he=!0;if(K)le=_e,he=_e;else if(ie){le=Q||ge||g;const ce=g&&m&&m.type==="text";he=le&&!ce}const oe=Math.min(24/S,C-N*3),ne=z&&g&&m&&r.isShapeOfType(m,"text")&&oe*S>=4;return x.jsx("svg",{className:"tl-overlays__item tl-selection__fg","data-testid":"selection-foreground",children:x.jsxs("g",{ref:i,children:[U&&x.jsx("rect",{className:"tl-selection__fg__outline",width:et(w),height:et(C)}),x.jsx(uA,{"data-testid":"selection.rotate.top-left",cx:0,cy:0,targetSize:L,corner:"top_left_rotate",cursor:p?pd("nwse-rotate",t):void 0,isHidden:se}),x.jsx(uA,{"data-testid":"selection.rotate.top-right",cx:w+L*3,cy:0,targetSize:L,corner:"top_right_rotate",cursor:p?pd("nesw-rotate",t):void 0,isHidden:se}),x.jsx(uA,{"data-testid":"selection.rotate.bottom-left",cx:0,cy:C+L*3,targetSize:L,corner:"bottom_left_rotate",cursor:p?pd("swne-rotate",t):void 0,isHidden:se}),x.jsx(uA,{"data-testid":"selection.rotate.bottom-right",cx:w+L*3,cy:C+L*3,targetSize:L,corner:"bottom_right_rotate",cursor:p?pd("senw-rotate",t):void 0,isHidden:se}),x.jsx(JLt,{"data-testid":"selection.rotate.mobile",cx:O?-L*1.5:w/2,cy:O?C/2:-L*1.5,size:I,isHidden:ee}),x.jsx("rect",{className:Ue("tl-transparent",{"tl-hidden":le}),"data-testid":"selection.resize.top","aria-label":"top target",pointerEvents:"all",x:0,y:et(0-(M?N*2:N)),width:et(w),height:et(Math.max(1,N*2)),style:p?{cursor:pd("ns-resize",t)}:void 0,...s}),x.jsx("rect",{className:Ue("tl-transparent",{"tl-hidden":he}),"data-testid":"selection.resize.right","aria-label":"right target",pointerEvents:"all",x:et(w-(O?0:j)),y:0,height:et(C),width:et(Math.max(1,j*2)),style:p?{cursor:pd("ew-resize",t)}:void 0,...a}),x.jsx("rect",{className:Ue("tl-transparent",{"tl-hidden":le}),"data-testid":"selection.resize.bottom","aria-label":"bottom target",pointerEvents:"all",x:0,y:et(C-(M?0:N)),width:et(w),height:et(Math.max(1,N*2)),style:p?{cursor:pd("ns-resize",t)}:void 0,...c}),x.jsx("rect",{className:Ue("tl-transparent",{"tl-hidden":he}),"data-testid":"selection.resize.left","aria-label":"left target",pointerEvents:"all",x:et(0-(O?j*2:j)),y:0,height:et(C),width:et(Math.max(1,j*2)),style:p?{cursor:pd("ew-resize",t)}:void 0,...l}),x.jsx("rect",{className:Ue("tl-transparent",{"tl-hidden":Y}),"data-testid":"selection.target.top-left","aria-label":"top-left target",pointerEvents:"all",x:et(0-(O?j*2:j*1.5)),y:et(0-(M?N*2:N*1.5)),width:et(j*3),height:et(N*3),style:p?{cursor:pd("nwse-resize",t)}:void 0,...u}),x.jsx("rect",{className:Ue("tl-transparent",{"tl-hidden":ue}),"data-testid":"selection.target.top-right","aria-label":"top-right target",pointerEvents:"all",x:et(w-(O?0:j*1.5)),y:et(0-(M?N*2:N*1.5)),width:et(j*3),height:et(N*3),style:p?{cursor:pd("nesw-resize",t)}:void 0,...d}),x.jsx("rect",{className:Ue("tl-transparent",{"tl-hidden":V}),"data-testid":"selection.target.bottom-right","aria-label":"bottom-right target",pointerEvents:"all",x:et(w-(O?j:j*1.5)),y:et(C-(M?N:N*1.5)),width:et(j*3),height:et(N*3),style:p?{cursor:pd("nwse-resize",t)}:void 0,...h}),x.jsx("rect",{className:Ue("tl-transparent",{"tl-hidden":ye}),"data-testid":"selection.target.bottom-left","aria-label":"bottom-left target",pointerEvents:"all",x:et(0-(O?j*3:j*1.5)),y:et(C-(M?0:N*1.5)),width:et(j*3),height:et(N*3),style:p?{cursor:pd("nesw-resize",t)}:void 0,...f}),ie&&x.jsxs(x.Fragment,{children:[x.jsx("rect",{"data-testid":"selection.resize.top-left",className:Ue("tl-corner-handle",{"tl-hidden":Y}),"aria-label":"top_left handle",x:et(0-I/2),y:et(0-I/2),width:et(I),height:et(I)}),x.jsx("rect",{"data-testid":"selection.resize.top-right",className:Ue("tl-corner-handle",{"tl-hidden":ue}),"aria-label":"top_right handle",x:et(w-I/2),y:et(0-I/2),width:et(I),height:et(I)}),x.jsx("rect",{"data-testid":"selection.resize.bottom-right",className:Ue("tl-corner-handle",{"tl-hidden":V}),"aria-label":"bottom_right handle",x:et(w-I/2),y:et(C-I/2),width:et(I),height:et(I)}),x.jsx("rect",{"data-testid":"selection.resize.bottom-left",className:Ue("tl-corner-handle",{"tl-hidden":ye}),"aria-label":"bottom_left handle",x:et(0-I/2),y:et(C-I/2),width:et(I),height:et(I)})]}),ne&&x.jsxs(x.Fragment,{children:[x.jsx("rect",{"data-testid":"selection.text-resize.left.handle",className:"tl-text-handle","aria-label":"bottom_left handle",x:et(0-I/4),y:et(C/2-oe/2),rx:I/4,width:et(I/2),height:et(oe)}),x.jsx("rect",{"data-testid":"selection.text-resize.right.handle",className:"tl-text-handle","aria-label":"bottom_left handle",rx:I/4,x:et(w-I/4),y:et(C/2-oe/2),width:et(I/2),height:et(oe)})]}),K&&x.jsx(ZLt,{size:I,width:w,height:C,hideAlternateHandles:_e})]})})}),uA=function({cx:e,cy:t,targetSize:r,corner:i,cursor:o,isHidden:s,"data-testid":a}){const c=Ip(i);return x.jsx("rect",{className:Ue("tl-transparent","tl-rotate-corner",{"tl-hidden":s}),"data-testid":a,"aria-label":`${i} target`,pointerEvents:"all",x:et(e-r*3),y:et(t-r*3),width:et(Math.max(1,r*3)),height:et(Math.max(1,r*3)),cursor:o,...c})},YLt=Math.sqrt(Math.PI),JLt=function({cx:e,cy:t,size:r,isHidden:i,"data-testid":o}){const s=Ip("mobile_rotate"),a=ot(),c=_t("zoom level",()=>a.getZoomLevel(),[a]),l=Math.max(14*(1/c),20/Math.max(1,c));return x.jsxs("g",{children:[x.jsx("circle",{"data-testid":o,pointerEvents:"all",className:Ue("tl-transparent","tl-mobile-rotate__bg",{"tl-hidden":i}),cx:e,cy:t,r:l,...s}),x.jsx("circle",{className:Ue("tl-mobile-rotate__fg",{"tl-hidden":i}),cx:e,cy:t,r:r/YLt})]})};function uX(n,e,t){const{arrowheadStart:r,arrowheadEnd:i}=e.props,o=lC(n,e,t),s=o.start.clone(),a=o.end.clone(),c=H.Med(s,a);if(H.Equals(s,a))return{bindings:t,isStraight:!0,start:{handle:s,point:s,arrowhead:e.props.arrowheadStart},end:{handle:a,point:a,arrowhead:e.props.arrowheadEnd},middle:c,isValid:!1,length:0};const l=H.Sub(a,s).uni(),u=d$(n,e,"start"),d=d$(n,e,"end"),h=n.getShapePageTransform(e);Ube(a,o.start,h,d),Ube(s,o.end,h,u);let f=0,p=0,g=0,m=0,v=uC*e.props.scale;const b=u&&d&&u.shape===d.shape,S=u&&d?Rie(n,u.shape.id,d.shape.id):"safe";S==="safe"&&u&&d&&!b&&!u.isExact&&!d.isExact&&(d.didIntersect&&!u.didIntersect?u.isClosed&&s.setTo(a.clone().add(l.clone().mul(uC*e.props.scale))):d.didIntersect||d.isClosed&&a.setTo(s.clone().sub(l.clone().mul(uC*e.props.scale))));const E=H.Sub(a,s),w=H.Len(E)?E.uni():H.From(E),C=!H.Equals(w,l);b||(S!=="start-contains-end"&&u&&r!=="none"&&!u.isExact&&(g=q0[e.props.size]/2+("size"in u.shape.props?q0[u.shape.props.size]/2:0),f=(h$+g)*e.props.scale,v+=g*e.props.scale),S!=="end-contains-start"&&d&&i!=="none"&&!d.isExact&&(m=q0[e.props.size]/2+("size"in d.shape.props?q0[d.shape.props.size]/2:0),p=(h$+m)*e.props.scale,v+=m*e.props.scale));const I=s.clone().add(w.clone().mul(f*(C?-1:1))),T=a.clone().sub(w.clone().mul(p*(C?-1:1)));H.DistMin(I,T,v)&&(f!==0&&p!==0?(f*=-1.5,p*=-1.5):f!==0?f*=-1:p!==0&&(p*=-1)),s.add(w.clone().mul(f*(C?-1:1))),a.sub(w.clone().mul(p*(C?-1:1))),C?(u&&d&&a.setTo(H.Add(s,w.clone().mul(-uC*e.props.scale))),c.setTo(H.Med(o.start,o.end))):c.setTo(H.Med(s,a));const D=H.Dist(s,a);return{bindings:t,isStraight:!0,start:{handle:o.start,point:s,arrowhead:e.props.arrowheadStart},end:{handle:o.end,point:a,arrowhead:e.props.arrowheadEnd},middle:c,isValid:D>0,length:D}}function Ube(n,e,t,r){if(r===void 0||r.isExact)return;const i=Mn.applyToPoint(t,e),o=Mn.applyToPoint(t,n),s=Mn.applyToPoint(Mn.Inverse(r.transform),i),a=Mn.applyToPoint(Mn.Inverse(r.transform),o),c=r.isClosed,u=(c?Sie:K8t)(s,a,r.outline);let d;if(u!==null&&(d=u.sort((p,g)=>H.Dist2(p,s)-H.Dist2(g,s))[0]??(c?void 0:a)),d===void 0)return;const h=Mn.applyToPoint(r.transform,d),f=Mn.applyToPoint(Mn.Inverse(t),h);n.setTo(f),r.didIntersect=!0}function QLt(n,e,t){const{arrowheadEnd:r,arrowheadStart:i}=e.props,o=e.props.bend;if(Math.abs(o)>Math.abs(e.props.bend*(i7t*e.props.scale)))return uX(n,e,t);const s=lC(n,e,t),a=H.Med(s.start,s.end),c=H.Sub(s.end,s.start),l=H.Len(c)?c.uni():H.From(c),u=H.Add(a,l.per().mul(-o)),d=d$(n,e,"start"),h=d$(n,e,"end"),f=s.start.clone(),p=s.end.clone(),g=u.clone();if(H.Equals(f,p))return{bindings:t,isStraight:!0,start:{handle:f,point:f,arrowhead:e.props.arrowheadStart},end:{handle:p,point:p,arrowhead:e.props.arrowheadEnd},middle:g,isValid:!1,length:0};const m=e.props.bend<0,v=m?RD:W8e,b=zbe(f,p,g),S=H.Angle(b.center,f),E=H.Angle(b.center,p),w=v(S,E);if(b.length===0||b.size===0||!tbe(b.length)||!tbe(b.size))return uX(n,e,t);const C=f.clone(),I=p.clone(),T=g.clone(),D=n.getShapePageTransform(e);let O=0,M=0,R=uC*e.props.scale;if(d&&!d.isExact){const K=Mn.applyToPoint(D,C),z=Mn.applyToPoint(D,b.center),G=Mn.applyToPoint(D,I),te=Mn.Inverse(d.transform),ie=Mn.applyToPoint(te,K),Q=Mn.applyToPoint(te,z),ge=Mn.applyToPoint(te,G),{isClosed:_e}=d,Se=_e?sX:xbe;let se,ee=Se(Q,b.radius,d.outline);if(ee){const Y=Q.angle(ie),ue=Q.angle(ge),ye=v(Y,ue);ee=ee.filter(le=>v(Y,Q.angle(le))<=ye);const V=ye*.25;ee.sort(_e?(le,he)=>Math.abs(v(Y,Q.angle(le))-V)<Math.abs(v(Y,Q.angle(he))-V)?-1:1:(le,he)=>v(Y,Q.angle(le))<v(Y,Q.angle(he))?-1:1),se=ee[0]??(_e?void 0:ie)}else se=_e?void 0:ie;if(se&&(C.setTo(n.getPointInShapeSpace(e,Mn.applyToPoint(d.transform,se))),d.didIntersect=!0,i!=="none")){const Y=q0[e.props.size]/2+("size"in d.shape.props?q0[d.shape.props.size]/2:0);O=(h$+Y)*e.props.scale,R+=Y*e.props.scale}}if(h&&!h.isExact){const K=Mn.applyToPoint(D,C),z=Mn.applyToPoint(D,I),G=Mn.applyToPoint(D,b.center),te=Mn.Inverse(h.transform),ie=Mn.applyToPoint(te,K),Q=Mn.applyToPoint(te,G),ge=Mn.applyToPoint(te,z),_e=h.isClosed,Se=_e?sX:xbe;let se,ee=Se(Q,b.radius,h.outline);if(ee){const Y=Q.angle(ie),ue=Q.angle(ge),ye=v(Y,ue),V=ye*.75;ee=ee.filter(le=>v(Y,Q.angle(le))<=ye),ee.sort(_e?(le,he)=>Math.abs(v(Y,Q.angle(le))-V)<Math.abs(v(Y,Q.angle(he))-V)?-1:1:(le,he)=>v(Y,Q.angle(le))<v(Y,Q.angle(he))?-1:1),ee[0]?se=ee[0]:se=_e?void 0:ge}else se=_e?void 0:ge;if(se&&(I.setTo(n.getPointInShapeSpace(e,Mn.applyToPoint(h.transform,se))),h.didIntersect=!0,r!=="none")){const Y=q0[e.props.size]/2+("size"in h.shape.props?q0[h.shape.props.size]/2:0);M=(h$+Y)*e.props.scale,R+=Y*e.props.scale}}let A=H.Angle(b.center,C),k=H.Angle(b.center,I),L=v(A,k),j=L*b.radius;const N=C.clone(),B=I.clone();if(O!==0&&N.setTo(b.center).add(H.FromAngle(A+L*(O/j*(m?1:-1))).mul(b.radius)),M!==0&&B.setTo(b.center).add(H.FromAngle(k+L*(M/j*(m?-1:1))).mul(b.radius)),H.DistMin(N,B,R)&&(O!==0&&M!==0?(O*=-1.5,M*=-1.5):O!==0?O*=-2:M!==0&&(M*=-2)),O!==0&&C.setTo(b.center).add(H.FromAngle(A+L*(O/j*(m?1:-1))).mul(b.radius)),M!==0&&I.setTo(b.center).add(H.FromAngle(k+L*(M/j*(m?-1:1))).mul(b.radius)),d&&h&&!d.isExact&&!h.isExact){A=H.Angle(b.center,C),k=H.Angle(b.center,I),L=v(A,k),j=L*b.radius;const K=Rie(n,d.shape.id,h.shape.id);K==="double-bound"&&j<30?(C.setTo(f),I.setTo(p),T.setTo(g)):K==="safe"&&(d&&!d.didIntersect&&C.setTo(f),(h&&!h.didIntersect||v(S,A)>v(S,k))&&I.setTo(b.center).add(H.FromAngle(A+L*(Math.min(.9,uC*e.props.scale/j)*(m?1:-1))).mul(b.radius)))}e7t(b.center,b.radius,C,I,T,w,m),C.equals(I)&&(C.setTo(T.clone().addXY(1,1)),I.setTo(T.clone().subXY(1,1))),f.setTo(C),p.setTo(I),g.setTo(T);const U=zbe(f,p,g);return{bindings:t,isStraight:!1,start:{point:f,handle:s.start,arrowhead:e.props.arrowheadStart},end:{point:p,handle:s.end,arrowhead:e.props.arrowheadEnd},middle:g,handleArc:b,bodyArc:U,isValid:U.length!==0&&isFinite(U.center.x)&&isFinite(U.center.y)}}function zbe(n,e,t){const r=die(n,e,t),i=H.Dist(r,n),o=+H.Clockwise(n,t,e),s=((n.y-e.y)**2+(n.x-e.x)**2)**.5,a=((e.y-t.y)**2+(e.x-t.x)**2)**.5,c=((t.y-n.y)**2+(t.x-n.x)**2)**.5,l=Math.acos((a*a+c*c-s*s)/(2*a*c))*2,u=+(Ai>l),d=(Xi-l)*(o?1:-1),h=d*i;return{center:r,radius:i,size:d,length:h,largeArcFlag:u,sweepFlag:o}}function e7t(n,e,t,r,i,o,s){const a=H.Angle(n,t),c=H.Angle(n,r);let l=RD(a,c);if(s||(l=Xi-l),i.setTo(n).add(H.FromAngle(a+l*(.5*(s?1:-1))).mul(e)),l>o){i.rotWith(n,Ai);const u=r.clone();r.setTo(t),t.setTo(u)}}const t7t=8;function n7t(n){return Math.abs(n.props.bend)<t7t*n.props.scale}function d$(n,e,t){const r=n.getBindingsFromShape(e,"arrow").find(c=>c.props.terminal===t);if(!r)return;const i=n.getShape(r.toId);if(!i)return;const o=n.getShapePageTransform(i),s=n.getShapeGeometry(i),a=s instanceof Qf?s.children[0].vertices:s.vertices;return{shape:i,transform:o,isClosed:s.isClosed,isExact:r.props.isExact,didIntersect:!1,outline:a}}function Vbe(n,e,t,r){const i=n.getShape(t.toId);if(i){const{point:o,size:s}=n.getShapeGeometry(i).bounds,a=H.Add(o,H.MulV(t.props.isPrecise||r?t.props.normalizedAnchor:{x:.5,y:.5},s)),c=Mn.applyToPoint(n.getShapePageTransform(i),a);return Mn.applyToPoint(Mn.Inverse(e),c)}else return new H(0,0)}function Mu(n,e){const t=n.getBindingsFromShape(e,"arrow");return{start:t.find(r=>r.props.terminal==="start"),end:t.find(r=>r.props.terminal==="end")}}const r7t=W4t("arrow info",(n,e)=>{const t=Mu(n,e);return n7t(e)?uX(n,e,t):QLt(n,e,t)});function Xp(n,e){const t=typeof e=="string"?e:e.id;return r7t.get(n,t)}function lC(n,e,t){var a,c;const r=n.getShapePageTransform(e),i=Rie(n,(a=t.start)==null?void 0:a.toId,(c=t.end)==null?void 0:c.toId),o=t.start?Vbe(n,r,t.start,i==="double-bound"||i==="start-contains-end"):H.From(e.props.start),s=t.end?Vbe(n,r,t.end,i==="double-bound"||i==="end-contains-start"):H.From(e.props.end);return{start:o,end:s}}function CI(n,e,t,r){const i=typeof e=="string"?e:e.id,o=typeof t=="string"?t:t.id,s=n.getBindingsFromShape(i,"arrow").filter(c=>c.props.terminal===r.terminal);s.length>1&&n.deleteBindings(s.slice(1));const a=s[0];a?n.updateBinding({...a,toId:o,props:r}):n.createBinding({type:"arrow",fromId:i,toId:o,props:r})}function EO(n,e,t){const r=n.getBindingsFromShape(e,"arrow").filter(i=>i.props.terminal===t);n.deleteBindings(r)}const uC=10,h$=10,i7t=10,q0={s:2,m:3.5,l:5,xl:10};function Rie(n,e,t){if(!e||!t)return"safe";if(e===t)return"double-bound";const r=n.getShapePageBounds(e),i=n.getShapePageBounds(t);if(r&&i){if(r.contains(i))return"start-contains-end";if(i.contains(r))return"end-contains-start"}return"safe"}class IO extends CO{getDefaultProps(){return{isPrecise:!1,isExact:!1,normalizedAnchor:{x:.5,y:.5}}}onAfterCreate({binding:e}){jU(this.editor,this.editor.getShape(e.fromId))}onAfterChange({bindingAfter:e}){jU(this.editor,this.editor.getShape(e.fromId))}onAfterChangeFromShape({shapeAfter:e}){jU(this.editor,e)}onAfterChangeToShape({binding:e}){X$e(this.editor,e.fromId)}onBeforeIsolateFromShape({binding:e}){const t=this.editor.getShape(e.fromId);t&&f$({editor:this.editor,arrow:t,terminal:e.props.terminal})}}$(IO,"type","arrow"),$(IO,"props",f8e),$(IO,"migrations",p8e);function X$e(n,e){var m;const t=n.getShape(e);if(!t)return;const r=Mu(n,t),{start:i,end:o}=r,s=i?n.getShape(i.toId):void 0,a=o?n.getShape(o.toId):void 0,c=n.getAncestorPageId(t);if(!c)return;let l;if(s&&a)l=n.findCommonAncestor([s,a])??c;else if(s||a){const v=(m=s||a)==null?void 0:m.parentId;v&&v===t.parentId?l=t.parentId:l=c}else return;l&&l!==t.parentId&&n.reparentShapes([e],l);const u=n.getShape(e);if(!u)throw Error("no reparented arrow");const d=n.getShapeNearestSibling(u,s),h=n.getShapeNearestSibling(u,a);let f;if(d&&h)f=d.index>h.index?d:h;else if(d&&!h)f=d;else if(h&&!d)f=h;else return;let p;const g=n.getSortedChildIdsForParent(f.parentId).map(v=>n.getShape(v)).filter(v=>v.index>f.index);if(g.length){const v=g.find(b=>b.type!=="arrow");if(u.index>f.index&&(!v||u.index<v.index))return;p=F3(f.index,g[0].index)}else p=Om(f.index);p!==u.index&&n.updateShapes([{id:e,type:"arrow",index:p}])}function jU(n,e){const t=Mu(n,e);for(const r of["start","end"]){const i=t[r];if(!i)continue;const o=n.getShape(i.toId),s=n.getAncestorPageId(e)===n.getAncestorPageId(o);(!o||!s)&&f$({editor:n,arrow:e,terminal:r,unbind:!0})}X$e(n,e.id)}function f$({editor:n,arrow:e,terminal:t,unbind:r=!1,useHandle:i=!1}){const o=Xp(n,e);if(!o)throw new Error("expected arrow info");const s=i?o.start.handle:o.start.point,a=i?o.end.handle:o.end.point,c=t==="start"?s:a,l={id:e.id,type:"arrow",props:{[t]:{x:c.x,y:c.y},bend:e.props.bend}};if(!o.isStraight){const u=t==="start"?s:o.start.handle,d=t==="end"?a:o.end.handle,h=H.Med(u,d),f=H.Sub(u,d).per().uni().mul(o.handleArc.radius*2*Math.sign(e.props.bend)),p=LD(o.handleArc.center,H.Add(h,f),o.handleArc.center,o.handleArc.radius);ds((p==null?void 0:p.length)===1);const g=H.Dist(h,p[0])*Math.sign(e.props.bend);sy(g,l.props.bend)||(l.props.bend=g)}n.updateShape(l),r&&EO(n,e,t)}const Y$e=[IO],qc={lineHeight:1.35,fontWeight:"normal",fontVariant:"normal",fontStyle:"normal",padding:"0px"},dc={s:2,m:3.5,l:5,xl:10},ax={s:18,m:24,l:36,xl:44},Xm={s:18,m:22,l:26,xl:32},o7t={s:18,m:20,l:24,xl:28},sg={draw:"var(--tl-font-draw)",sans:"var(--tl-font-sans)",serif:"var(--tl-font-serif)",mono:"var(--tl-font-mono)"},s7t=20,a7t=4.25,xf=16;/*!
 * canvas-size
 * v1.2.6
 * https://github.com/jhildenbiddle/canvas-size
 * (c) 2015-2023 John Hildenbiddle <http://hildenbiddle.com>
 * MIT license
 */function c7t(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var r,i,o,s,a=[],c=!0,l=!1;try{if(o=(t=t.call(n)).next,e===0){if(Object(t)!==t)return;c=!1}else for(;!(c=(r=o.call(t)).done)&&(a.push(r.value),a.length!==e);c=!0);}catch(u){l=!0,i=u}finally{try{if(!c&&t.return!=null&&(s=t.return(),Object(s)!==s))return}finally{if(l)throw i}}return a}}function Wbe(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function gd(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Wbe(Object(t),!0).forEach(function(r){l7t(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Wbe(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function l7t(n,e,t){return e=y7t(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function u7t(n,e){if(n==null)return{};var t={},r=Object.keys(n),i,o;for(o=0;o<r.length;o++)i=r[o],!(e.indexOf(i)>=0)&&(t[i]=n[i]);return t}function d7t(n,e){if(n==null)return{};var t=u7t(n,e),r,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);for(i=0;i<o.length;i++)r=o[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(n,r)&&(t[r]=n[r])}return t}function qbe(n,e){return f7t(n)||c7t(n,e)||J$e(n,e)||m7t()}function dA(n){return h7t(n)||p7t(n)||J$e(n)||g7t()}function h7t(n){if(Array.isArray(n))return dX(n)}function f7t(n){if(Array.isArray(n))return n}function p7t(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function J$e(n,e){if(n){if(typeof n=="string")return dX(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return dX(n,e)}}function dX(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function g7t(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function m7t(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function v7t(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function y7t(n){var e=v7t(n,"string");return typeof e=="symbol"?e:String(e)}function gk(n){var e=n.sizes.shift(),t=Math.max(Math.ceil(e[0]),1),r=Math.max(Math.ceil(e[1]),1),i=[t-1,r-1,1,1],o=Date.now(),s=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,a,c;s?(a=new OffscreenCanvas(1,1),c=new OffscreenCanvas(t,r)):(a=document.createElement("canvas"),a.width=1,a.height=1,c=document.createElement("canvas"),c.width=t,c.height=r);var l=a.getContext("2d"),u=c.getContext("2d");u&&(u.fillRect.apply(u,i),l.drawImage(c,t-1,r-1,1,1,0,0,1,1));var d=l&&l.getImageData(0,0,1,1).data[3]!==0,h=Date.now()-o;return[a,c].forEach(function(f){f.height=0,f.width=0}),s?(postMessage({width:t,height:r,benchmark:h,isTestPass:d}),!d&&n.sizes.length&&gk(n)):d?n.onSuccess(t,r,h):(n.onError(t,r,h),n.sizes.length&&gk(n)),d}var BU={area:[16384,14188,11402,11180,10836,8192,4096,1],height:[8388607,65535,32767,16384,8192,4096,1],width:[4194303,65535,32767,16384,8192,4096,1]},b7t=["onError","onSuccess"],dC={max:null,min:1,sizes:[],step:1024,usePromise:!1,useWorker:!1,onError:Function.prototype,onSuccess:Function.prototype},xI={};function HU(n){var e=n.width===n.height,t=n.height===1,r=n.width===1,i=[];if(!n.width||!n.height)n.sizes.forEach(function(u){var d=e||t?u:1,h=e||r?u:1;i.push([d,h])});else for(var o=n.min||dC.min,s=n.step||dC.step,a=Math.max(n.width,n.height);a>=o;){var c=e||t?a:1,l=e||r?a:1;i.push([c,l]),a-=s}return i}function hA(n){var e=window&&"HTMLCanvasElement"in window,t=window&&"OffscreenCanvas"in window,r=Date.now(),i=n.onError,o=n.onSuccess,s=d7t(n,b7t),a=null;if(!e)return!1;if(n.useWorker&&t){var c=`
            var canvasTest = `.concat(gk.toString(),`;
            onmessage = function(e) {
                canvasTest(e.data);
            };
        `),l=new Blob([c],{type:"application/javascript"}),u=URL.createObjectURL(l);a=new Worker(u),URL.revokeObjectURL(u),a.onmessage=function(d){var h=d.data,f=h.width,p=h.height,g=h.benchmark,m=h.isTestPass;m?(xI[r].onSuccess(f,p,g),delete xI[r]):xI[r].onError(f,p,g)}}if(n.usePromise)return new Promise(function(d,h){var f=gd(gd({},n),{},{onError:function(v,b,S){var E;if(n.sizes.length===0)E=!0;else{var w=n.sizes.slice(-1),C=qbe(w,1),I=qbe(C[0],2),T=I[0],D=I[1];E=v===T&&b===D}i(v,b,S),E&&h({width:v,height:b,benchmark:S})},onSuccess:function(v,b,S){o(v,b,S),d({width:v,height:b,benchmark:S})}});if(a){var p=f.onError,g=f.onSuccess;xI[r]={onError:p,onSuccess:g},a.postMessage(s)}else gk(f)});if(a)xI[r]={onError:i,onSuccess:o},a.postMessage(s);else return gk(n)}var UU={maxArea:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=HU({width:e.max,height:e.max,min:e.min,step:e.step,sizes:dA(BU.area)}),r=gd(gd(gd({},dC),e),{},{sizes:t});return hA(r)},maxHeight:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=HU({width:1,height:e.max,min:e.min,step:e.step,sizes:dA(BU.height)}),r=gd(gd(gd({},dC),e),{},{sizes:t});return hA(r)},maxWidth:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=HU({width:e.max,height:1,min:e.min,step:e.step,sizes:dA(BU.width)}),r=gd(gd(gd({},dC),e),{},{sizes:t});return hA(r)},test:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=gd(gd({},dC),e);return t.sizes=dA(t.sizes),t.width&&t.height&&(t.sizes=[[t.width,t.height]]),hA(t)}};let zU=null;function S7t(){return zU||(zU=_7t()),zU}async function _7t(){const n=await UU.maxWidth({usePromise:!0}),e=await UU.maxHeight({usePromise:!0}),t=await UU.maxArea({usePromise:!0});return{maxWidth:n.width,maxHeight:e.height,maxArea:t.width*t.height}}const Kbe=8192,w7t=4096*4096;async function C7t(n,e){if(n<=Kbe&&e<=Kbe&&n*e<=w7t)return[n,e];const{maxWidth:t,maxHeight:r,maxArea:i}=await S7t(),o=n/e;if(n>t&&(n=t,e=n/o),e>r&&(e=r,n=e*o),n*e>i){const s=Math.sqrt(i/(n*e));n*=s,e*=s}return[n,e]}function x7t(n,e){const t=n.w/e.w,r=n.h/e.h;return t<=1&&r<=1?n:t>r?{w:n.w/t,h:n.h/t}:{w:n.w/r,h:n.h/r}}function E7t(n){if(typeof n!="string")throw new TypeError("Expected a string");return n.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function I7t(n){const e=new URL(n).host.replace("www.","");for(const t of DD)if(Q$e(t.hostnames,e)){const r=t.fromEmbedUrl(n);if(r)return{definition:t,url:r,embedUrl:n}}}const P7t=n=>n.split("*").map(e=>E7t(e)).join(".+"),Q$e=(n,e)=>!!n.find(t=>{const r=new RegExp(P7t(t));return e.match(r)});function k7t(n){const e=new URL(n).host.replace("www.","");for(const t of DD)if(Q$e(t.hostnames,e)){const r=t.toEmbedUrl(n);if(r)return{definition:t,embedUrl:r,url:n}}}function eLe(n){return k7t(n)??I7t(n)}function K0(n){try{return eLe(n)}catch(e){console.error(e)}}/*!
 * MIT License
 * Adapted (mostly copied) the work of https://github.com/fregante/text-field-edit
 * Copyright (c) Federico Brigante <opensource@bfred.it> (bfred.it)
 */const hC="  ",Hl=class Hl{static insertTextFirefox(e,t){e.setRangeText(t,e.selectionStart||0,e.selectionEnd||0,"end"),e.dispatchEvent(new InputEvent("input",{data:t,inputType:"insertText",isComposing:!1}))}static insert(e,t){const r=e.ownerDocument,i=r.activeElement;i!==e&&e.focus(),r.execCommand("insertText",!1,t)||Hl.insertTextFirefox(e,t),i===r.body?e.blur():i instanceof HTMLElement&&i!==e&&i.focus()}static set(e,t){e.select(),Hl.insert(e,t)}static getSelection(e){const{selectionStart:t,selectionEnd:r}=e;return e.value.slice(t||void 0,r||void 0)}static wrapSelection(e,t,r){const{selectionStart:i,selectionEnd:o}=e,s=Hl.getSelection(e);Hl.insert(e,t+s+(r??t)),e.selectionStart=(i||0)+t.length,e.selectionEnd=(o||0)+t.length}static replace(e,t,r){let i=0;e.value.replace(t,(...o)=>{const s=i+o[o.length-2],a=o[0].length;e.selectionStart=s,e.selectionEnd=s+a;const c=typeof r=="string"?r:r(...o);return Hl.insert(e,c),e.selectionStart=s,i+=c.length-a,c})}static findLineEnd(e,t){const r=e.lastIndexOf(`
`,t-1)+1;return e.charAt(r)!=="	"?t:r+1}static indent(e){var a;const{selectionStart:t,selectionEnd:r,value:i}=e,o=i.slice(t,r),s=(a=/\n/g.exec(o))==null?void 0:a.length;if(s&&s>0){const c=i.lastIndexOf(`
`,t-1)+1,l=e.value.slice(c,r-1),u=l.replace(/^|\n/g,`$&${hC}`),d=u.length-l.length;e.setSelectionRange(c,r-1),Hl.insert(e,u),e.setSelectionRange(t+1,r+d)}else Hl.insert(e,hC)}static unindent(e){const{selectionStart:t,selectionEnd:r,value:i}=e,o=i.lastIndexOf(`
`,t-1)+1,s=Hl.findLineEnd(i,r),a=e.value.slice(o,s),c=a.replace(/(^|\n)(\t| {1,2})/g,"$1"),l=a.length-c.length;e.setSelectionRange(o,s),Hl.insert(e,c);const u=/\t| {1,2}/.exec(i.slice(o,t)),d=u?u[0].length:0,h=t-d;e.setSelectionRange(t-d,Math.max(h,r-l))}static indentCE(e){var c;const t=window.getSelection(),r=e.innerText,i=fA(e)??0,o=fA(e)??0,s=r.slice(i,o),a=(c=/\n/g.exec(s))==null?void 0:c.length;if(a&&a>0){const l=r.lastIndexOf(`
`,i-1)+1,u=r.slice(l,o-1),h=u.replace(/^|\n/g,`$&${hC}`).length-u.length;t&&t.setBaseAndExtent(e,i+1,e,o+h)}else{const l=window.getSelection();e.innerText=r.slice(0,i)+hC+r.slice(i),l==null||l.setBaseAndExtent(e,i+1,e,i+2)}}static unindentCE(e){const t=window.getSelection(),r=e.innerText,i=fA(e)??0,o=fA(e)??0,s=r.lastIndexOf(`
`,i-1)+1,a=Hl.findLineEnd(r,o),c=r.slice(s,a),l=c.replace(/(^|\n)(\t| {1,2})/g,"$1"),u=c.length-l.length;if(t){t.setBaseAndExtent(e,s,e,a);const d=/\t| {1,2}/.exec(r.slice(s,i)),h=d?d[0].length:0,f=i-h;t.setBaseAndExtent(e,i-h,e,Math.max(f,o-u))}}static normalizeText(e){return e.replace(Hl.fixNewLines,`
`)}static normalizeTextForDom(e){return e.replace(Hl.fixNewLines,`
`).split(`
`).map(t=>t||" ").join(`
`)}};$(Hl,"fixNewLines",/\r?\n|\r/g);let cx=Hl;function fA(n){if(typeof window.getSelection>"u")return;const e=window.getSelection();if(!e)return;let t=0;if(e.rangeCount!==0){const r=e.getRangeAt(0),i=r.cloneRange();i.selectNodeContents(n),i.setEnd(r.endContainer,r.endOffset),t=i.toString().length}return t}const T7t=/[\u0590-\u05FF\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]/;function tLe(n){return T7t.test(n)}function D7t(n){return n.replace(/\t/g,hC)}function R7t(n){const e=n.split(`
`);for(;e[0]&&e[0].trim().length===0;)e.shift();let t=1/0;for(const r of e)if(r.trim().length>0){const i=r.length-r.trimStart().length;t=Math.min(t,i)}return e.map(r=>r.slice(t)).join(`
`)}function A7t(n){return n.replace(/[ \t]+$/gm,"").replace(/\n+$/,"")}function O7t(n){return A7t(R7t(D7t(n)))}function M7t(n,{maxImageDimension:e,maxAssetSize:t,acceptedImageMimeTypes:r,acceptedVideoMimeTypes:i},{toasts:o,msg:s},a){n.registerExternalAssetHandler("file",async({file:c})=>{const l=c.name;let u=c;const d=r.includes(u.type),h=i.includes(u.type);ds(d||h,`File type not allowed: ${u.type}`),ds(u.size<=t,`File size too big: ${(u.size/1024).toFixed()}kb > ${(t/1024).toFixed()}kb`),u.type==="video/quicktime"&&(u=new Blob([u],{type:"video/mp4"}));let f=d?await Zp.getImageSize(u):await Zp.getVideoSize(u);const p=await Zp.isAnimated(u)||h,g=await GAt(await u.arrayBuffer());if(isFinite(e)){const b=x7t(f,{w:e,h:e});f!==b&&Zp.isStaticImageType(u.type)&&(f=b)}const m=A1.createId(g),v={id:m,type:d?"image":"video",typeName:"asset",props:{name:l,src:"",w:f.w,h:f.h,fileSize:u.size,mimeType:u.type,isAnimated:p}};return a?(v.props.src=m,await ULt({persistenceKey:a,assetId:m,blob:u})):v.props.src=await dS.blobToDataUrl(u),A1.create(v)}),n.registerExternalAssetHandler("url",async({url:c})=>{var u,d,h,f,p;let l;try{const m=await(await vg(c,{method:"GET",mode:"no-cors"})).text(),v=new DOMParser().parseFromString(m,"text/html");l={image:((u=v.head.querySelector('meta[property="og:image"]'))==null?void 0:u.getAttribute("content"))??"",favicon:((d=v.head.querySelector('link[rel="apple-touch-icon"]'))==null?void 0:d.getAttribute("href"))??((h=v.head.querySelector('link[rel="icon"]'))==null?void 0:h.getAttribute("href"))??"",title:((f=v.head.querySelector('meta[property="og:title"]'))==null?void 0:f.getAttribute("content"))??c,description:((p=v.head.querySelector('meta[property="og:description"]'))==null?void 0:p.getAttribute("content"))??""},l.image.startsWith("/")&&(l.image=new URL(l.image,c).href),l.favicon.startsWith("/")&&(l.favicon=new URL(l.favicon,c).href)}catch(g){console.error(g),o.addToast({title:s("assets.url.failed"),severity:"error"}),l={image:"",favicon:"",title:"",description:""}}return{id:A1.createId(qZ(c)),typeName:"asset",type:"bookmark",props:{src:c,description:l.description,image:l.image,favicon:l.favicon,title:l.title},meta:{}}}),n.registerExternalContentHandler("svg-text",async({point:c,text:l})=>{const u=c??(n.inputs.shiftKey?n.inputs.currentPagePoint:n.getViewportPageBounds().center),d=new DOMParser().parseFromString(l,"image/svg+xml").querySelector("svg");if(!d)throw new Error("No <svg/> element present");let h=parseFloat(d.getAttribute("width")||"0"),f=parseFloat(d.getAttribute("height")||"0");if(!(h&&f)){document.body.appendChild(d);const g=d.getBoundingClientRect();document.body.removeChild(d),h=g.width,f=g.height}const p=await n.getAssetForExternalContent({type:"file",file:new File([l],"asset.svg",{type:"image/svg+xml"})});if(!p)throw Error("Could not create an asset");Gbe(n,[p],u)}),n.registerExternalContentHandler("embed",({point:c,url:l,embed:u})=>{const d=c??(n.inputs.shiftKey?n.inputs.currentPagePoint:n.getViewportPageBounds().center),{width:h,height:f}=u,p=ro(),g={id:p,type:"embed",x:d.x-(h||450)/2,y:d.y-(f||450)/2,props:{w:h,h:f,url:l}};n.createShapes([g]).select(p)}),n.registerExternalContentHandler("files",async({point:c,files:l})=>{const u=c??(n.inputs.shiftKey?n.inputs.currentPagePoint:n.getViewportPageBounds().center),d=new H(u.x,u.y),h=[];await Promise.all(l.map(async(f,p)=>{if(f.size>t)return console.warn(`File size too big: ${(f.size/1024).toFixed()}kb > ${(t/1024).toFixed()}kb`),null;if(!f.type)throw new Error("No mime type");if(!r.concat(i).includes(f.type))return console.warn(`${f.name} not loaded - Extension not allowed.`),null;try{const g=await n.getAssetForExternalContent({type:"file",file:f});if(!g)throw Error("Could not create an asset");h[p]=g}catch(g){return o.addToast({title:s("assets.files.upload-failed"),severity:"error"}),console.error(g),null}})),Gbe(n,qr(h),d)}),n.registerExternalContentHandler("text",async({point:c,text:l})=>{const u=c??(n.inputs.shiftKey?n.inputs.currentPagePoint:n.getViewportPageBounds().center),d=n.getShapeUtil("text").getDefaultProps(),h=O7t(l),f=n.getOnlySelectedShape();if(f&&"text"in f.props){n.updateShapes([{id:f.id,type:f.type,props:{text:h}}]);return}let p,g,m,v="middle";const b=h.split(`
`).length>1,S=tLe(h);b&&(v=b?S?"end":"start":"middle");const E=n.textMeasure.measureText(h,{...qc,fontFamily:sg[d.font],fontSize:ax[d.size],maxWidth:null}),w=Math.min(b?n.getViewportPageBounds().width*.9:920,Math.max(200,n.getViewportPageBounds().width*.9));if(E.w>w){const C=n.textMeasure.measureText(h,{...qc,fontFamily:sg[d.font],fontSize:ax[d.size],maxWidth:w});p=C.w,g=C.h,m=!1,v=S?"end":"start"}else p=E.w,g=E.h,m=!0;u.y-g/2<n.getViewportPageBounds().minY+40&&(u.y=n.getViewportPageBounds().minY+40+g/2),n.createShapes([{id:ro(),type:"text",x:u.x-p/2,y:u.y-g/2,props:{text:h,textAlign:v,autoSize:m,w:p}}])}),n.registerExternalContentHandler("url",async({point:c,url:l})=>{const u=K0(l);if(u)return n.putExternalContent({type:"embed",url:u.url,point:c,embed:u.definition});const d=c??(n.inputs.shiftKey?n.inputs.currentPagePoint:n.getViewportPageBounds().center),h=A1.createId(qZ(l)),f=$7t(n,l,d);let p=n.getAsset(h),g=!1;if(!p){g=!0;try{const m=await n.getAssetForExternalContent({type:"url",url:l});if(!m)throw Error("Could not create an asset");p=m}catch{o.addToast({title:s("assets.url.failed"),severity:"error"});return}}n.batch(()=>{g&&n.createAssets([p]),n.updateShapes([{id:f.id,type:f.type,props:{assetId:p.id}}])})})}async function Gbe(n,e,t){if(!e.length)return[];const r=H.From(t),i=[];for(let o=0;o<e.length;o++){const s=e[o];switch(s.type){case"bookmark":{i.push({id:ro(),type:"bookmark",x:r.x,y:r.y,opacity:1,props:{assetId:s.id,url:s.props.src}}),r.x+=300;break}case"image":{i.push({id:ro(),type:"image",x:r.x,y:r.y,opacity:1,props:{assetId:s.id,w:s.props.w,h:s.props.h}}),r.x+=s.props.w;break}case"video":i.push({id:ro(),type:"video",x:r.x,y:r.y,opacity:1,props:{assetId:s.id,w:s.props.w,h:s.props.h}}),r.x+=s.props.w}}return n.batch(()=>{const o=e.filter(s=>!n.getAsset(s.id));o.length&&n.createAssets(o),n.createShapes(i).select(...i.map(s=>s.id)),nLe(n,t)}),i.map(o=>o.id)}function nLe(n,e){const t=n.getViewportPageBounds();let r=n.getSelectionPageBounds();if(r){const i=r.center.sub(e);n.updateShapes(n.getSelectedShapes().map(o=>{const s=n.getShapeParentTransform(o).decompose().rotation,a=H.Rot(i,-s);return{id:o.id,type:o.type,x:o.x-a.x,y:o.y-a.y}}))}r=n.getSelectionPageBounds(),r&&!t.contains(r)&&n.zoomToSelection()}function $7t(n,e,t){const r={id:ro(),type:"bookmark",x:t.x-150,y:t.y-160,opacity:1,props:{assetId:null,url:e}};return n.batch(()=>{n.createShapes([r]).select(r.id),nLe(n,t)}),n.getShape(r.id)}const L7t=new uv,N7t=n=>async e=>!e||!e.props.src?null:n&&e.props.src.startsWith("asset:")?await L7t.get(e,async()=>await F7t(n,e.id)):e.type==="video"?e.props.src:e.type!=="image"?null:e.props.src;async function F7t(n,e){const t=await HLt({assetId:e,persistenceKey:n});return t?URL.createObjectURL(t):null}var kV;let j7t=(kV=class extends Ln{constructor(){super(...arguments);$(this,"onPointerDown",t=>{this.parent.transition("pointing",t)});$(this,"onEnter",()=>{this.editor.setCursor({type:"cross",rotation:0})});$(this,"onCancel",()=>{this.editor.setCurrentTool("select")});$(this,"onKeyUp",t=>{var r;if(t.key==="Enter"){if(this.editor.getInstanceState().isReadonly)return null;const i=this.editor.getOnlySelectedShape();i&&this.editor.getShapeUtil(i).canEdit(i)&&(this.editor.setCurrentTool("select"),this.editor.setEditingShape(i.id),(r=this.editor.root.getCurrent())==null||r.transition("editing_shape",{...t,target:"shape",shape:i}))}})}},$(kV,"id","idle"),kV);var TV;let B7t=(TV=class extends Ln{constructor(){super(...arguments);$(this,"shape");$(this,"markId","");$(this,"onEnter",()=>{this.didTimeout=!1;const t=this.editor.getShapeAtPoint(this.editor.inputs.currentPagePoint,{filter:r=>!r.isLocked&&this.editor.canBindShapes({fromShape:"arrow",toShape:r,binding:"arrow"}),margin:0,hitInside:!0,renderingOnly:!0});t?this.editor.setHintingShapes([t.id]):this.createArrowShape(),this.startPreciseTimeout()});$(this,"onExit",()=>{this.shape=void 0,this.editor.setHintingShapes([]),this.clearPreciseTimeout()});$(this,"onPointerMove",()=>{if(this.editor.inputs.isDragging){if(this.shape||this.createArrowShape(),!this.shape)throw Error("expected shape");this.updateArrowShapeEndHandle(),this.editor.setCurrentTool("select.dragging_handle",{shape:this.shape,handle:{id:"end",type:"vertex",index:"a3",x:0,y:0},isCreating:!0,onInteractionEnd:"arrow"})}});$(this,"onPointerUp",()=>{this.cancel()});$(this,"onCancel",()=>{this.cancel()});$(this,"onComplete",()=>{this.cancel()});$(this,"onInterrupt",()=>{this.cancel()});$(this,"preciseTimeout",-1);$(this,"didTimeout",!1)}cancel(){this.shape&&this.editor.bailToMark(this.markId),this.editor.setHintingShapes([]),this.parent.transition("idle")}createArrowShape(){var u;const{originPagePoint:t}=this.editor.inputs,r=ro();this.markId=`creating:${r}`,this.editor.mark(this.markId),this.editor.createShape({id:r,type:"arrow",x:t.x,y:t.y,props:{scale:this.editor.user.getIsDynamicResizeMode()?1/this.editor.getZoomLevel():1}});const i=this.editor.getShape(r);if(!i)throw Error("expected shape");const o=this.editor.getShapeHandles(i);if(!o)throw Error("expected handles for arrow");const s=this.editor.getShapeUtil("arrow"),a=this.shape,c=o.find(d=>d.id==="start"),l=(u=s.onHandleDrag)==null?void 0:u.call(s,i,{handle:{...c,x:0,y:0},isPrecise:!0,initial:a});l&&this.editor.updateShapes([l]),this.shape=this.editor.getShape(r),this.editor.select(r)}updateArrowShapeEndHandle(){var i,o;const t=this.shape;if(!t)throw Error("expected shape");const r=this.editor.getShapeHandles(t);if(!r)throw Error("expected handles for arrow");{const s=this.editor.getShapeUtil("arrow"),a=this.shape,c=r.find(u=>u.id==="start"),l=(i=s.onHandleDrag)==null?void 0:i.call(s,t,{handle:{...c,x:0,y:0},isPrecise:this.didTimeout,initial:a});l&&this.editor.updateShapes([l])}{const s=this.editor.getShapeUtil("arrow"),a=this.shape,c=this.editor.getPointInShapeSpace(t,this.editor.inputs.currentPagePoint),l=r.find(d=>d.id==="end"),u=(o=s.onHandleDrag)==null?void 0:o.call(s,this.editor.getShape(t),{handle:{...l,x:c.x,y:c.y},isPrecise:!1,initial:a});u&&this.editor.updateShapes([u])}this.shape=this.editor.getShape(t.id)}startPreciseTimeout(){this.preciseTimeout=this.editor.timers.setTimeout(()=>{this.getIsActive()&&(this.didTimeout=!0)},320)}clearPreciseTimeout(){clearTimeout(this.preciseTimeout)}},$(TV,"id","pointing"),TV);class PO extends Ln{constructor(){super(...arguments);$(this,"shapeType","arrow")}}$(PO,"id","arrow"),$(PO,"initial","idle"),$(PO,"children",()=>[j7t,B7t]);class Aie extends Ln{constructor(){super(...arguments);$(this,"info",{});$(this,"initialShape");$(this,"shapeType",this.parent.id==="highlight"?"highlight":"draw");$(this,"util",this.editor.getShapeUtil(this.shapeType));$(this,"isPen",!1);$(this,"isPenOrStylus",!1);$(this,"segmentMode","free");$(this,"didJustShiftClickToExtendPreviousShapeLine",!1);$(this,"pagePointWhereCurrentSegmentChanged",{});$(this,"pagePointWhereNextSegmentChanged",null);$(this,"lastRecordedPoint",{});$(this,"mergeNextPoint",!1);$(this,"currentLineLength",0);$(this,"canDraw",!1);$(this,"markId",null);$(this,"onEnter",t=>{this.markId=null,this.info=t,this.canDraw=!this.editor.getIsMenuOpen(),this.lastRecordedPoint=this.editor.inputs.currentPagePoint.clone(),this.canDraw&&this.startShape()});$(this,"onPointerMove",()=>{const{inputs:t}=this.editor;if(this.isPen&&!t.isPen){if(this.markId){this.editor.bailToMark(this.markId),this.startShape();return}}else!this.canDraw&&t.isDragging&&(this.startShape(),this.canDraw=!0);this.canDraw&&(this.isPenOrStylus?H.Dist(t.currentPagePoint,this.lastRecordedPoint)>=1/this.editor.getZoomLevel()?(this.lastRecordedPoint=t.currentPagePoint.clone(),this.mergeNextPoint=!1):this.mergeNextPoint=!0:this.mergeNextPoint=!1,this.updateDrawingShape())});$(this,"onKeyDown",t=>{if(t.key==="Shift")switch(this.segmentMode){case"free":{this.segmentMode="starting_straight",this.pagePointWhereNextSegmentChanged=this.editor.inputs.currentPagePoint.clone();break}case"starting_free":this.segmentMode="starting_straight"}this.updateDrawingShape()});$(this,"onKeyUp",t=>{if(t.key==="Shift")switch(this.editor.snaps.clearIndicators(),this.segmentMode){case"straight":{this.segmentMode="starting_free",this.pagePointWhereNextSegmentChanged=this.editor.inputs.currentPagePoint.clone();break}case"starting_straight":{this.pagePointWhereNextSegmentChanged=null,this.segmentMode="free";break}}this.updateDrawingShape()});$(this,"onExit",()=>{this.editor.snaps.clearIndicators(),this.pagePointWhereCurrentSegmentChanged=this.editor.inputs.currentPagePoint.clone()});$(this,"onPointerUp",()=>{this.complete()});$(this,"onCancel",()=>{this.cancel()});$(this,"onComplete",()=>{this.complete()});$(this,"onInterrupt",()=>{this.editor.inputs.isDragging||(this.markId&&this.editor.bailToMark(this.markId),this.cancel())})}canClose(){return this.shapeType!=="highlight"}getIsClosed(t,r){if(!this.canClose())return!1;const i=dc[r],o=t[0].points[0],s=t[t.length-1],a=s.points[s.points.length-1];return o!==a&&this.currentLineLength>i*4&&H.DistMin(o,a,i*2)}startShape(){const{inputs:{originPagePoint:t,isPen:r}}=this.editor;this.markId="draw start "+us(),this.editor.mark(this.markId);const{z:i=.5}=this.info.point;this.isPen=r,this.isPenOrStylus=r||i>0&&i<.5||i>.5&&i<1;const o=this.isPenOrStylus?i*1.25:.5;if(this.segmentMode=this.editor.inputs.shiftKey?"straight":"free",this.didJustShiftClickToExtendPreviousShapeLine=!1,this.lastRecordedPoint=t.clone(),this.initialShape){const a=this.editor.getShape(this.initialShape.id);if(a&&this.segmentMode==="straight"){this.didJustShiftClickToExtendPreviousShapeLine=!0;const c=Mc(a.props.segments);if(!c)throw Error("Expected a previous segment!");const l=Mc(c.points);if(!l)throw Error("Expected a previous point!");const{x:u,y:d}=this.editor.getPointInShapeSpace(a,t).toFixed(),h={type:this.segmentMode,points:[{x:l.x,y:l.y,z:+o.toFixed(2)},{x:u,y:d,z:+o.toFixed(2)}]},f=Mn.applyToPoint(this.editor.getShapePageTransform(a.id),l);this.pagePointWhereCurrentSegmentChanged=f,this.pagePointWhereNextSegmentChanged=null;const p=[...a.props.segments,h];this.currentLineLength<dc[a.props.size]*4&&(this.currentLineLength=this.getLineLength(p));const g={id:a.id,type:this.shapeType,props:{segments:p}};this.canClose()&&(g.props.isClosed=this.getIsClosed(p,a.props.size)),this.editor.updateShapes([g]);return}}this.pagePointWhereCurrentSegmentChanged=t.clone();const s=ro();this.editor.createShapes([{id:s,type:this.shapeType,x:t.x,y:t.y,props:{isPen:this.isPenOrStylus,scale:this.editor.user.getIsDynamicResizeMode()?1/this.editor.getZoomLevel():1,segments:[{type:this.segmentMode,points:[{x:0,y:0,z:+o.toFixed(2)}]}]}}]),this.currentLineLength=0,this.initialShape=this.editor.getShape(s)}updateDrawingShape(){const{initialShape:t}=this,{inputs:r}=this.editor;if(!t)return;const{id:i,props:{size:o}}=t,s=this.editor.getShape(i);if(!s)return;const{segments:a}=s.props,{x:c,y:l,z:u}=this.editor.getPointInShapeSpace(s,r.currentPagePoint).toFixed(),d=this.isPenOrStylus?+(r.currentPagePoint.z*1.25).toFixed(2):.5,h={x:c,y:l,z:d};switch(this.segmentMode){case"starting_straight":{const{pagePointWhereNextSegmentChanged:f}=this;if(f===null)throw Error("We should have a point where the segment changed");if(H.Dist2(f,r.currentPagePoint)>this.editor.options.dragDistanceSquared){this.pagePointWhereCurrentSegmentChanged=this.pagePointWhereNextSegmentChanged.clone(),this.pagePointWhereNextSegmentChanged=null,this.segmentMode="straight";const g=Mc(a);if(!g)throw Error("Expected a previous segment!");const m=Mc(g.points);if(!m)throw Error("Expected a previous last point!");let v;const b=this.editor.getPointInShapeSpace(s,this.pagePointWhereCurrentSegmentChanged).toFixed().toJson();if(g.type==="straight"){this.currentLineLength+=H.Dist(m,b),v={type:"straight",points:[{...m},b]};const E=this.editor.getShapePageTransform(s);this.pagePointWhereCurrentSegmentChanged=Mn.applyToPoint(E,m)}else v={type:"straight",points:[b,h]};const S={id:i,type:this.shapeType,props:{segments:[...a,v]}};this.canClose()&&(S.props.isClosed=this.getIsClosed(a,o)),this.editor.updateShapes([S])}break}case"starting_free":{const{pagePointWhereNextSegmentChanged:f}=this;if(f===null)throw Error("We should have a point where the segment changed");if(H.Dist2(f,r.currentPagePoint)>this.editor.options.dragDistanceSquared){this.pagePointWhereCurrentSegmentChanged=this.pagePointWhereNextSegmentChanged.clone(),this.pagePointWhereNextSegmentChanged=null,this.segmentMode="free";const g=a.slice(),m=g[g.length-1],v=Mc(m.points);if(!v)throw Error("No previous point!");const b={type:"free",points:[...H.PointsBetween(v,h,6).map(w=>({x:Mm(w.x),y:Mm(w.y),z:Mm(w.z)}))]},S=[...g,b];this.currentLineLength<dc[s.props.size]*4&&(this.currentLineLength=this.getLineLength(S));const E={id:i,type:this.shapeType,props:{segments:S}};this.canClose()&&(E.props.isClosed=this.getIsClosed(S,o)),this.editor.updateShapes([E])}break}case"straight":{const f=a.slice(),p=f[f.length-1],{pagePointWhereCurrentSegmentChanged:g}=this,{ctrlKey:m,currentPagePoint:v}=this.editor.inputs;if(!g)throw Error("We should have a point where the segment changed");let b,S=!1;this.didJustShiftClickToExtendPreviousShapeLine?this.editor.inputs.isDragging&&(S=!m,this.didJustShiftClickToExtendPreviousShapeLine=!1):S=!m;let E=this.editor.getPointInShapeSpace(s,v).toFixed().toJson(),w=!1,C;if((this.editor.user.getIsSnapMode()?!m:m)&&f.length>2){let D,O=8/this.editor.getZoomLevel();for(let M=0,R=a.length-2;M<R;M++){const A=a[M];if(!A)break;if(A.type==="free")continue;const k=A.points[0],L=Mc(A.points);if(!(k&&L))continue;const j=H.NearestPointOnLineSegment(k,L,E);if(H.DistMin(j,E,O)){D=j.toFixed().toJson(),O=H.Dist(j,E),C=A;break}}D&&(w=!0,E=D)}if(w&&C){const D=this.editor.getShapePageTransform(s),O=C.points[0],M=Mc(C.points);if(!M)throw Error("Expected a last point!");const R=Mn.applyToPoint(D,O),A=Mn.applyToPoint(D,M),k=Mn.applyToPoint(D,E);this.editor.snaps.setIndicators([{id:us(),type:"points",points:[R,k,A]}])}else{if(this.editor.snaps.clearIndicators(),S){const D=H.Angle(g,v),M=a$(D,24)-D;b=H.RotWith(v,g,M)}else b=v;E=this.editor.getPointInShapeSpace(s,b).toFixed().toJson()}this.currentLineLength+=H.Dist(p.points[0],E),f[f.length-1]={...p,type:"straight",points:[p.points[0],E]};const T={id:i,type:this.shapeType,props:{segments:f}};this.canClose()&&(T.props.isClosed=this.getIsClosed(a,o)),this.editor.updateShapes([T]);break}case"free":{const f=a.slice(),p=f[f.length-1],g=[...p.points];if(g.length&&this.mergeNextPoint){const{z:v}=g[g.length-1];g[g.length-1]={x:h.x,y:h.y,z:v?Math.max(v,h.z):h.z}}else this.currentLineLength+=H.Dist(g[g.length-1],h),g.push(h);f[f.length-1]={...p,points:g},this.currentLineLength<dc[s.props.size]*4&&(this.currentLineLength=this.getLineLength(f));const m={id:i,type:this.shapeType,props:{segments:f}};if(this.canClose()&&(m.props.isClosed=this.getIsClosed(f,o)),this.editor.updateShapes([m]),g.length>this.editor.options.maxPointsPerDrawShape){this.editor.updateShapes([{id:i,type:this.shapeType,props:{isComplete:!0}}]);const v=ro(),b=this.editor.getShape(i).props;this.editor.createShapes([{id:v,type:this.shapeType,x:Mm(r.currentPagePoint.x),y:Mm(r.currentPagePoint.y),props:{isPen:this.isPenOrStylus,scale:b.scale,segments:[{type:"free",points:[{x:0,y:0,z:this.isPenOrStylus?+(u*1.25).toFixed():.5}]}]}}]),this.initialShape=ls(this.editor.getShape(v)),this.mergeNextPoint=!1,this.lastRecordedPoint=r.currentPagePoint.clone(),this.currentLineLength=0}break}}}getLineLength(t){let r=0;for(const i of t)for(let o=0;o<i.points.length-1;o++){const s=i.points[o],a=i.points[o+1];r+=H.Dist2(a,s)}return Math.sqrt(r)}complete(){if(!this.canDraw){this.cancel();return}const{initialShape:t}=this;t&&(this.editor.updateShapes([{id:t.id,type:t.type,props:{isComplete:!0}}]),this.parent.transition("idle"))}cancel(){this.parent.transition("idle",this.info)}}$(Aie,"id","drawing");var DV;let rLe=(DV=class extends Ln{constructor(){super(...arguments);$(this,"onPointerDown",t=>{this.parent.transition("drawing",t)});$(this,"onEnter",()=>{this.editor.setCursor({type:"cross",rotation:0})});$(this,"onCancel",()=>{this.editor.setCurrentTool("select")})}},$(DV,"id","idle"),DV);class kO extends Ln{constructor(){super(...arguments);$(this,"shapeType","draw");$(this,"onExit",()=>{const t=this.children.drawing;t.initialShape=void 0})}}$(kO,"id","draw"),$(kO,"initial","idle"),$(kO,"children",()=>[rLe,Aie]);class hX extends xO{constructor(){super(...arguments);$(this,"shapeType","frame");$(this,"onCreate",t=>{if(!t)return;const r=this.editor.getShapePageBounds(t),i=[],o=this.editor.getShapeAncestors(t).map(s=>s.id);this.editor.getSortedChildIdsForParent(t.parentId).map(s=>{const a=this.editor.getShape(s);if(!a||a.id===t.id||a.isLocked)return;const c=this.editor.getShapePageBounds(a);c&&r.contains(c)&&H7t(a,o,t)&&i.push(a.id)}),this.editor.reparentShapes(i,t.id),this.editor.getInstanceState().isToolLocked?this.editor.setCurrentTool("frame"):this.editor.setCurrentTool("select.idle")})}}$(hX,"id","frame"),$(hX,"initial","idle");function H7t(n,e,t){return e.includes(n.id)?!1:n.parentId===t.parentId}var RV;let U7t=(RV=class extends Ln{constructor(){super(...arguments);$(this,"onPointerDown",t=>{this.parent.transition("pointing",t)});$(this,"onEnter",()=>{this.editor.setCursor({type:"cross",rotation:0})});$(this,"onKeyUp",t=>{var r;if(t.key==="Enter"){if(this.editor.getInstanceState().isReadonly)return null;const i=this.editor.getOnlySelectedShape();i&&this.editor.getShapeUtil(i).canEdit(i)&&(this.editor.setCurrentTool("select"),this.editor.setEditingShape(i.id),(r=this.editor.root.getCurrent())==null||r.transition("editing_shape",{...t,target:"shape",shape:i}))}});$(this,"onCancel",()=>{this.editor.setCurrentTool("select")})}},$(RV,"id","idle"),RV);var AV;let z7t=(AV=class extends Ln{constructor(){super(...arguments);$(this,"markId","");$(this,"onPointerUp",()=>{this.complete()});$(this,"onPointerMove",t=>{if(this.editor.inputs.isDragging){const{originPagePoint:r}=this.editor.inputs,i=ro();this.markId=`creating:${i}`,this.editor.mark(this.markId),this.editor.createShapes([{id:i,type:"geo",x:r.x,y:r.y,props:{w:1,h:1,geo:this.editor.getStyleForNextShape(jf),scale:this.editor.user.getIsDynamicResizeMode()?1/this.editor.getZoomLevel():1}}]).select(i).setCurrentTool("select.resizing",{...t,target:"selection",handle:"bottom_right",isCreating:!0,creationCursorOffset:{x:1,y:1},onInteractionEnd:"geo"})}});$(this,"onCancel",()=>{this.cancel()});$(this,"onComplete",()=>{this.complete()});$(this,"onInterrupt",()=>{this.cancel()})}complete(){const{originPagePoint:t}=this.editor.inputs,r=ro();this.markId=`creating:${r}`,this.editor.mark(this.markId);const i=this.editor.user.getIsDynamicResizeMode()?1/this.editor.getZoomLevel():1,o=this.editor.getStyleForNextShape(jf),s=o==="star"?{w:200,h:190}:o==="cloud"?{w:300,h:180}:{w:200,h:200};this.editor.createShapes([{id:r,type:"geo",x:t.x,y:t.y,props:{geo:this.editor.getStyleForNextShape(jf),scale:i,...s}}]);const a=this.editor.getShape(r);if(!a)return;const{w:c,h:l}=a.props,u=new H(c/2,l/2).mul(i),d=this.editor.getShapeParentTransform(a);d&&u.rot(-d.rotation()),this.editor.select(r),this.editor.updateShape({id:a.id,type:"geo",x:a.x-u.x,y:a.y-u.y,props:{geo:this.editor.getStyleForNextShape(jf),w:c*i,h:l*i}}),this.editor.getInstanceState().isToolLocked?this.parent.transition("idle"):this.editor.setCurrentTool("select",{})}cancel(){this.parent.transition("idle")}},$(AV,"id","pointing"),AV);class TO extends Ln{constructor(){super(...arguments);$(this,"shapeType","geo")}}$(TO,"id","geo"),$(TO,"initial","idle"),$(TO,"children",()=>[U7t,z7t]);class DO extends Ln{constructor(){super(...arguments);$(this,"shapeType","highlight");$(this,"onExit",()=>{const t=this.children.drawing;t.initialShape=void 0})}}$(DO,"id","highlight"),$(DO,"initial","idle"),$(DO,"children",()=>[rLe,Aie]);var OV;let V7t=(OV=class extends Ln{constructor(){super(...arguments);$(this,"shapeId","");$(this,"onEnter",t=>{this.shapeId=t.shapeId,this.editor.setCursor({type:"cross",rotation:0})});$(this,"onPointerDown",()=>{this.parent.transition("pointing",{shapeId:this.shapeId})});$(this,"onCancel",()=>{this.editor.setCurrentTool("select")})}},$(OV,"id","idle"),OV);const Zbe=2;var MV;let W7t=(MV=class extends Ln{constructor(){super(...arguments);$(this,"shape",{});$(this,"markId");$(this,"onEnter",t=>{const{inputs:r}=this.editor,{currentPagePoint:i}=r;this.markId=void 0;const o=t.shapeId&&this.editor.getShape(t.shapeId);if(o&&r.shiftKey){this.markId=`creating:${o.id}`,this.editor.mark(this.markId),this.shape=o;const s=this.editor.getShapeHandles(this.shape);if(!s)return;const a=s.filter(f=>f.type==="vertex").sort(ml),c=a[a.length-1],l=a[a.length-2],u=Mn.applyToPoint(this.editor.getShapeParentTransform(this.shape),new H(this.shape.x,this.shape.y)),d=H.Sub(i,u).addXY(.1,.1),h=ls(this.shape.props.points);if(H.DistMin(c,l,Zbe)||H.DistMin(d,c,Zbe))h[c.id]={id:c.id,index:c.index,x:d.x,y:d.y};else{const f=Om(c.index);h[f]={id:f,index:f,x:d.x,y:d.y}}this.editor.updateShapes([{id:this.shape.id,type:this.shape.type,props:{points:h}}])}else{const s=ro();this.markId=`creating:${s}`,this.editor.mark(this.markId),this.editor.createShapes([{id:s,type:"line",x:i.x,y:i.y,props:{scale:this.editor.user.getIsDynamicResizeMode()?1/this.editor.getZoomLevel():1}}]),this.editor.select(s),this.shape=this.editor.getShape(s)}});$(this,"onPointerMove",()=>{if(this.shape&&this.editor.inputs.isDragging){const t=this.editor.getShapeHandles(this.shape);if(!t)throw this.markId&&this.editor.bailToMark(this.markId),Error("No handles found");const r=Mc(t);this.editor.setCurrentTool("select.dragging_handle",{shape:this.shape,isCreating:!0,handle:{...r,x:r.x-.1,y:r.y-.1},onInteractionEnd:"line"})}});$(this,"onPointerUp",()=>{this.complete()});$(this,"onCancel",()=>{this.cancel()});$(this,"onComplete",()=>{this.complete()});$(this,"onInterrupt",()=>{this.parent.transition("idle"),this.markId&&this.editor.bailToMark(this.markId),this.editor.snaps.clearIndicators()})}complete(){this.parent.transition("idle",{shapeId:this.shape.id}),this.editor.snaps.clearIndicators()}cancel(){this.markId&&this.editor.bailToMark(this.markId),this.parent.transition("idle",{shapeId:this.shape.id}),this.editor.snaps.clearIndicators()}},$(MV,"id","pointing"),MV);class RO extends Ln{constructor(){super(...arguments);$(this,"shapeType","line")}}$(RO,"id","line"),$(RO,"initial","idle"),$(RO,"children",()=>[V7t,W7t]);var $V;let q7t=($V=class extends Ln{constructor(){super(...arguments);$(this,"onPointerDown",t=>{this.parent.transition("pointing",t)});$(this,"onEnter",()=>{this.editor.setCursor({type:"cross",rotation:0})});$(this,"onCancel",()=>{this.editor.setCurrentTool("select")})}},$($V,"id","idle"),$V);function Ao(n,e){var i;const t=new Set;for(const o of e){const s=n.getShape(o);if(!s)continue;n.getShapeUtil(s).onDragShapesOut&&t.add(s);const a=n.getShape(s.parentId);a&&n.getShapeUtil(a).onDragShapesOut&&t.add(a)}const r=new Map;for(const o of t){const s=iLe(n,o);s.length&&r.set(o,s)}for(const[o,s]of r){const a=n.getShapeUtil(o),c=qr(s.map(l=>n.getShape(l)));(i=a.onDragShapesOut)==null||i.call(a,o,c)}}function iLe(n,e){const t=n.getSortedChildIdsForParent(e.id);if(t.length===0)return[];const r=n.getShapePageBounds(e);if(!r)return[];let i,o,s;const a=[];for(const c of t){const l=n.getShapePageBounds(c);if(!l)continue;if(!r.includes(l)){a.push(c);continue}i??(i=n.getShapeGeometry(e)),o??(o=n.getShapePageTransform(e)),s??(s=o.applyToPoints(i.vertices));const u=n.getShapePageTransform(c).clone().invert().applyToPoints(s),{vertices:d,isClosed:h}=n.getShapeGeometry(c);if(!d.some(f=>Fd(f,u))){if(h){if(T$e(u,d))continue}else if(X8t(u,d))continue;a.push(c)}}return a}function p$(n,e,t=!1){n.select(e),n.setEditingShape(e),n.setCurrentTool("select.editing_shape",{target:"shape",shape:e}),t&&n.emit("select-all-text",{shapeId:e.id}),oLe(n)}const K7t=16;function oLe(n){const e=n.getSelectionPageBounds(),t=n.getViewportPageBounds();if(e&&!t.contains(e)){const r=e.clone().expandBy(K7t/n.getZoomLevel()).expand(t),i=t.clone().translate({x:(r.center.x-t.center.x)*2,y:(r.center.y-t.center.y)*2});n.zoomToBounds(i,{animation:{duration:n.options.animationMediumMs},inset:0})}}const O1=20,G7t=0,uo=200,NN=new H(uo/2,uo/2),sLe=10,Z7t=[[["a1"],new H(uo*.5,uo*-.5-O1)],[["a2"],new H(uo*1.5+O1,uo*.5)],[["a3"],new H(uo*.5,uo*1.5+O1)],[["a4"],new H(uo*-.5-O1,uo*.5)]];function X7t(n){if(n===1)return Z7t;const e=uo*n,t=O1*n;return[[["a1"],new H(e*.5,e*-.5-t)],[["a2"],new H(e*1.5+t,e*.5)],[["a3"],new H(e*.5,e*1.5+t)],[["a4"],new H(e*-.5-t,e*.5)]]}function aLe(n,e,t,r,i){return Object.fromEntries(X7t(i).map(([o,s],a)=>{const c=s.clone();return a===0&&r?c.y-=r:a===2&&t&&(c.y+=t),[o,c.rot(e).add(n)]}))}function cLe(n,e,t,r){const i=new Set(n.getSelectedShapeIds()),o=(uo+O1+r)**2,s=new Map,a=[];for(const u of n.getCurrentPageShapes()){if(!n.isShapeOfType(u,"note")||t!==u.props.scale||i.has(u.id))continue;const d=n.getShapePageTransform(u.id);e===d.rotation()&&(s.set(u,n.getShapePageBounds(u).center),a.push(...Object.values(aLe(d.point(),e,u.props.growY,r,t))))}const c=a.length;let l;for(const[u,d]of s)for(let h=0;h<c;h++)l=a[h],l&&(H.Dist2(d,l)>o||n.isPointInShape(u,l)&&(a[h]=void 0));return qr(a)}function lLe(n,e,t,r,i=!1){let o;const s=n.getCurrentPageShapesSorted(),a=(uo+O1**2)**e.props.scale;for(let c=s.length-1;c>=0;c--){const l=s[c];if(l.type==="note"&&l.id!==e.id){const u=n.getShapePageBounds(l);if(u&&H.Dist2(u.center,t)<a&&n.isPointInShape(l,t)){o=l;break}}}if(n.complete(),!o||i){n.mark("creating note shape");const c=ro();n.createShape({id:c,type:"note",x:t.x,y:t.y,rotation:r,opacity:e.opacity,props:{...e.props,text:"",growY:0,fontSizeAdjustment:0,url:""}});const l=n.getShape(c);if(!l)return;const u=n.getPointInParentSpace(l,H.Sub(t,H.Rot(NN.clone().mul(l.props.scale),r)));n.updateShape({id:c,type:"note",x:u.x,y:u.y}),o=n.getShape(c)}return oLe(n),o}var LV;let Y7t=(LV=class extends Ln{constructor(){super(...arguments);$(this,"dragged",!1);$(this,"info",{});$(this,"wasFocusedOnEnter",!1);$(this,"markId","");$(this,"shape",{});$(this,"onEnter",()=>{const{editor:t}=this;if(this.wasFocusedOnEnter=!t.getIsMenuOpen(),this.wasFocusedOnEnter){const r=ro();this.markId=`creating:${r}`,t.mark(this.markId);const i=this.editor.inputs.originPagePoint.clone(),o=Xbe(this.editor,i,this.editor.user.getIsDynamicResizeMode()?1/this.editor.getZoomLevel():1);o&&i.sub(o),this.shape=Ybe(this.editor,r,i)}});$(this,"onPointerMove",t=>{if(this.editor.inputs.isDragging){if(!this.wasFocusedOnEnter){const r=ro(),i=this.editor.inputs.originPagePoint.clone(),o=Xbe(this.editor,i,this.editor.user.getIsDynamicResizeMode()?1/this.editor.getZoomLevel():1);o&&i.sub(o),this.shape=Ybe(this.editor,r,i)}this.editor.setCurrentTool("select.translating",{...t,target:"shape",shape:this.shape,onInteractionEnd:"note",isCreating:!0,onCreate:()=>{this.editor.setEditingShape(this.shape.id),this.editor.setCurrentTool("select.editing_shape")}})}});$(this,"onPointerUp",()=>{this.complete()});$(this,"onInterrupt",()=>{this.cancel()});$(this,"onComplete",()=>{this.complete()});$(this,"onCancel",()=>{this.cancel()})}complete(){this.wasFocusedOnEnter&&(this.editor.getInstanceState().isToolLocked?this.parent.transition("idle"):(this.editor.setEditingShape(this.shape.id),this.editor.setCurrentTool("select.editing_shape",{...this.info,target:"shape",shape:this.shape})))}cancel(){this.editor.bailToMark(this.markId),this.parent.transition("idle",this.info)}},$(LV,"id","pointing"),LV);function Xbe(n,e,t){let r=sLe/n.getZoomLevel(),i;for(const o of cLe(n,0,t,0)){const s=H.Sub(e,o),a=s.len();a<r&&(r=a,i=s)}return i}function Ybe(n,e,t){n.createShape({id:e,type:"note",x:t.x,y:t.y,props:{scale:n.user.getIsDynamicResizeMode()?1/n.getZoomLevel():1}}).select(e);const r=n.getShape(e),i=n.getShapeGeometry(r).bounds;return n.updateShapes([{id:e,type:"note",x:r.x-i.width/2,y:r.y-i.height/2}]),n.getShape(e)}class AO extends Ln{constructor(){super(...arguments);$(this,"shapeType","note")}}$(AO,"id","note"),$(AO,"initial","idle"),$(AO,"children",()=>[q7t,Y7t]);function J7t(n){const e=n.getShapeAtPoint(n.inputs.currentPagePoint,{hitInside:!1,hitLabels:!1,margin:n.options.hitTestMargin/n.getZoomLevel(),renderingOnly:!0});if(!e)return n.setHoveredShape(null);let t;const r=n.getOutermostSelectableShape(e);return r===e||r.id===n.getFocusedGroupId()||n.getSelectedShapeIds().includes(r.id)?t=e:t=r,n.setHoveredShape(t.id)}const Fm=S6e(J7t,32);var NV;let Q7t=(NV=class extends Ln{constructor(){super(...arguments);$(this,"onPointerMove",t=>{switch(t.target){case"shape":case"canvas":Fm(this.editor)}});$(this,"onPointerDown",t=>{this.parent.transition("pointing",t)});$(this,"onEnter",()=>{this.editor.setCursor({type:"cross",rotation:0})});$(this,"onExit",()=>{Fm.cancel()});$(this,"onKeyDown",t=>{var r;if(t.key==="Enter"){if(this.editor.getInstanceState().isReadonly)return null;const i=this.editor.getOnlySelectedShape();i&&this.editor.getShapeUtil(i).canEdit(i)&&(this.editor.setCurrentTool("select"),this.editor.setEditingShape(i.id),(r=this.editor.root.getCurrent())==null||r.transition("editing_shape",{...t,target:"shape",shape:i}))}});$(this,"onCancel",()=>{this.editor.setCurrentTool("select")})}},$(NV,"id","idle"),NV);var FV;let eNt=(FV=class extends Ln{constructor(){super(...arguments);$(this,"shape");$(this,"markId","");$(this,"onExit",()=>{this.editor.setHintingShapes([])});$(this,"onPointerMove",t=>{if(this.editor.inputs.isDragging){const{inputs:{originPagePoint:r}}=this.editor,i=ro();this.markId=`creating:${i}`,this.editor.mark(this.markId);const o=this.createTextShape(i,r,!1);if(!o){this.cancel();return}this.shape=this.editor.getShape(o),this.editor.select(i),this.editor.setCurrentTool("select.resizing",{...t,target:"selection",handle:"right",isCreating:!0,creationCursorOffset:{x:18,y:1},onInteractionEnd:"text",onCreate:()=>{this.editor.setEditingShape(o.id),this.editor.setCurrentTool("select.editing_shape")}})}});$(this,"onPointerUp",()=>{this.complete()});$(this,"onComplete",()=>{this.cancel()});$(this,"onCancel",()=>{this.cancel()});$(this,"onInterrupt",()=>{this.cancel()})}complete(){var o;this.editor.mark("creating text shape");const t=ro(),{currentPagePoint:r}=this.editor.inputs;this.createTextShape(t,r,!0)&&(this.editor.select(t),this.editor.setEditingShape(t),this.editor.setCurrentTool("select"),(o=this.editor.root.getCurrent())==null||o.transition("editing_shape"))}cancel(){this.parent.transition("idle"),this.editor.bailToMark(this.markId)}createTextShape(t,r,i){this.editor.createShape({id:t,type:"text",x:r.x,y:r.y,props:{text:"",autoSize:i,w:20,scale:this.editor.user.getIsDynamicResizeMode()?1/this.editor.getZoomLevel():1}});const o=this.editor.getShape(t);if(!o){this.cancel();return}const s=this.editor.getShapePageBounds(o),a=new H;if(i)switch(o.props.textAlign){case"start":{a.x=0;break}case"middle":{a.x=-s.width/2;break}case"end":{a.x=-s.width;break}}else a.x=0;if(a.y=-s.height/2,ku(o.parentId)){const c=this.editor.getShapeParentTransform(o);a.rot(-c.rotation())}return this.editor.updateShape({...o,x:o.x+a.x,y:o.y+a.y}),o}},$(FV,"id","pointing"),FV);class OO extends Ln{constructor(){super(...arguments);$(this,"shapeType","text")}}$(OO,"id","text"),$(OO,"initial","idle"),$(OO,"children",()=>[Q7t,eNt]);const tNt=[OO,kO,TO,AO,RO,hX,PO,DO];function Zh(){return xv({isDarkMode:FD()})}function lx(n){return{key:`${yg.id}:${n}`,getElement:async()=>{const e=nNt(n);if(!e)return null;const t=e.$$_url,r=e.$$_fontface;if(!t||!r)return null;const i=await(await vg(t)).blob(),o=await dS.blobToDataUrl(i),s=r.replace(t,o);return x.jsx("style",{children:s})}}}function nNt(n){const e=l8e[n];for(const t of document.fonts)if(e.includes(t.family))return t;return null}function Oie(n){return{key:`${yg.id}:${n}`,getElement:async()=>n!=="pattern"?null:x.jsx(rNt,{})}}function rNt(){const n=Zh(),e=8/12;return x.jsxs(x.Fragment,{children:[x.jsxs("mask",{id:"hash_pattern_mask",children:[x.jsx("rect",{x:"0",y:"0",width:"8",height:"8",fill:"white"}),x.jsxs("g",{strokeLinecap:"round",stroke:"black",children:[x.jsx("line",{x1:e*1,y1:e*3,x2:e*3,y2:e*1}),x.jsx("line",{x1:e*5,y1:e*7,x2:e*7,y2:e*5}),x.jsx("line",{x1:e*9,y1:e*11,x2:e*11,y2:e*9})]})]}),x.jsx("pattern",{id:g$(1,n.id),width:"8",height:"8",patternUnits:"userSpaceOnUse",children:x.jsx("rect",{x:"0",y:"0",width:"8",height:"8",fill:n.solid,mask:"url(#hash_pattern_mask)"})})]})}function Mie(){return{key:`${yg.id}:pattern`,component:aNt}}const yP=8,Jbe=(n,e,t)=>new Promise((r,i)=>{const o=yP*e*n,s=document.createElement("canvas");s.width=o,s.height=o;const a=s.getContext("2d");if(!a)return;a.fillStyle=t?t$.darkMode.solid:t$.lightMode.solid,a.fillRect(0,0,o,o),a.globalCompositeOperation="destination-out",a.lineCap="round",a.lineWidth=1.25*e*n;const c=8/12,l=u=>u*e*n;a.beginPath(),a.moveTo(l(c*1),l(c*3)),a.lineTo(l(c*3),l(c*1)),a.moveTo(l(c*5),l(c*7)),a.lineTo(l(c*7),l(c*5)),a.moveTo(l(c*9),l(c*11)),a.lineTo(l(c*11),l(c*9)),a.stroke(),s.toBlob(u=>{!u||ta.throwToBlob.get()?i():r(u)})}),Qbe=(n,e)=>{const t=document.createElement("canvas");t.width=n[0],t.height=n[1];const r=t.getContext("2d");return r?(e(r),t.toDataURL()):""};let VU=null;function iNt(){return VU||(VU={white:Qbe([1,1],n=>{n.fillStyle="#f8f9fa",n.fillRect(0,0,1,1)}),black:Qbe([1,1],n=>{n.fillStyle="#212529",n.fillRect(0,0,1,1)})}),VU}function uLe(n){return Math.ceil(Math.log2(Math.max(1,n)))}function g$(n,e){const t=uLe(n);return`tldraw_hash_pattern_${e}_${t}`}function dLe(n){const e=[],r=uLe(n);for(let i=0;i<=r;i++)e.push(Math.pow(2,i));return e}function oNt(n){const e=iNt();return dLe(n).flatMap(t=>[{zoom:t,url:e.white,theme:"light"},{zoom:t,url:e.black,theme:"dark"}])}function sNt(){const n=ot(),e=_t("devicePixelRatio",()=>n.getInstanceState().devicePixelRatio,[n]),t=_t("maxZoom",()=>Math.ceil(Mc(n.getCameraOptions().zoomSteps)),[n]),[r,i]=y.useState(!1),[o,s]=y.useState(()=>oNt(t));return y.useEffect(()=>{const c=Promise.all(dLe(t).flatMap(u=>[Jbe(e,u,!1).then(d=>({zoom:u,theme:"light",url:URL.createObjectURL(d)})),Jbe(e,u,!0).then(d=>({zoom:u,theme:"dark",url:URL.createObjectURL(d)}))]));let l=!1;return c.then(u=>{l||(s(u),i(!0))}),()=>{l=!0,i(!1),c.then(u=>{for(const{url:d}of u)URL.revokeObjectURL(d)})}},[e,t]),{defs:x.jsx(x.Fragment,{children:o.map(c=>{const l=g$(c.zoom,c.theme);return x.jsx("pattern",{id:l,width:yP,height:yP,patternUnits:"userSpaceOnUse",children:x.jsx("image",{href:c.url,width:yP,height:yP})},l)})}),isReady:r}}function aNt(){const n=ot(),e=y.useRef(null),{defs:t,isReady:r}=sNt();return y.useEffect(()=>{if(r&&n.environment.isSafari){const i=hLe(e.current);i&&n.timers.requestAnimationFrame(()=>{i.style.display="none",n.timers.requestAnimationFrame(()=>{i.style.display=""})})}},[n,r]),x.jsx("g",{ref:e,"data-testid":r?"ready-pattern-fill-defs":void 0,children:t})}function hLe(n){return n.classList.contains("tl-html-layer")?n:n.parentElement?hLe(n.parentElement):null}const sl=Ke.memo(function({theme:e,d:t,color:r,fill:i,scale:o}){switch(i){case"none":return null;case"solid":return x.jsx("path",{fill:e[r].semi,d:t});case"semi":return x.jsx("path",{fill:e.solid,d:t});case"fill":return x.jsx("path",{fill:e[r].fill,d:t});case"pattern":return x.jsx(cNt,{theme:e,color:r,fill:i,d:t,scale:o})}});function cNt({d:n,color:e,theme:t}){const r=ot(),i=M$e(),o=_t("zoomLevel",()=>r.getZoomLevel(),[r]),s=r.getZoomLevel()<=.18;return x.jsxs(x.Fragment,{children:[x.jsx("path",{fill:t[e].pattern,d:n}),x.jsx("path",{fill:i?`url(#${g$(1,t.id)})`:s?t[e].semi:`url(#${g$(o,t.id)})`,d:n})]})}function lNt(n){return n.replace(/\s/g," ")}function fX(n,e,t){const{padding:r=0}=t;if(e.length===0)return null;const i=xn.From(e[0].box);for(const{box:l}of e)i.union(l);const o=r+(t.offsetX??0),s=(t.offsetY??0)+t.fontSize/2+(t.verticalTextAlign==="start"?r:t.verticalTextAlign==="end"?t.height-r-i.height:(Math.ceil(t.height)-i.height)/2);let a=null;const c=[];for(const{text:l,box:u}of e)a!==null&&u.y>a&&c.push(x.jsx("tspan",{alignmentBaseline:"mathematical",x:o,y:u.y+s,children:`
`},c.length)),c.push(x.jsx("tspan",{alignmentBaseline:"mathematical",x:u.x+o,y:u.y+s,unicodeBidi:"plaintext",children:lNt(l)},c.length)),a=u.y;return x.jsx("text",{fontSize:t.fontSize,fontFamily:t.fontFamily,fontStyle:t.fontFamily,fontWeight:t.fontWeight,dominantBaseline:"mathematical",alignmentBaseline:"mathematical",stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill,children:c})}function uNt(n,e,t,r){if((n==="start-legacy"||n==="end-legacy")&&t.length!==0){const i=xn.From(t[0].box);for(const{box:o}of t)i.union(o);if(n==="start-legacy")return(r-2*e-i.width)/2;if(n==="end-legacy")return-(r-2*e-i.width)/2}}function dNt(n){return n==="start-legacy"||n==="middle-legacy"||n==="end-legacy"}function FN({fontSize:n,font:e,align:t,verticalAlign:r,text:i,labelColor:o,bounds:s,padding:a=16,stroke:c=!0}){const l=ot(),u=Zh(),d={fontSize:n,fontFamily:l8e[e],textAlign:t,verticalTextAlign:r,width:Math.ceil(s.width),height:Math.ceil(s.height),padding:a,lineHeight:qc.lineHeight,fontStyle:"normal",fontWeight:"normal",overflow:"wrap",offsetX:0,offsetY:0,fill:o,stroke:void 0,strokeWidth:void 0},h=l.textMeasure.measureTextSpans(i,d),f=uNt(t,a,h,s.width);f&&(d.offsetX=f),d.offsetX+=s.x,d.offsetY+=s.y;const p=fX(l,h,d);let g=null;return c&&(d.fill=u.background,d.stroke=u.background,d.strokeWidth=2,g=fX(l,h,d)),x.jsxs(x.Fragment,{children:[g,p]})}const hNt=y.forwardRef(function({isEditing:e,text:t,handleFocus:r,handleChange:i,handleKeyDown:o,handleBlur:s,handleInputPointerDown:a,handleDoubleClick:c},l){return x.jsx("textarea",{ref:l,className:"tl-text tl-text-input",name:"text",tabIndex:-1,readOnly:!e,autoComplete:"off",autoCapitalize:"off",autoCorrect:"off",autoSave:"off",placeholder:"",spellCheck:"true",wrap:"off",dir:"auto",defaultValue:t,onFocus:r,onChange:i,onKeyDown:o,onBlur:s,onTouchEnd:Wc,onContextMenu:e?Wc:void 0,onPointerDown:a,onDoubleClick:c,onDragStart:Ri})});function fNt(n,e,t){const r=ot(),i=y.useRef(null),o=_t("isEditing",()=>r.getEditingShapeId()===n,[r]),s=_t("isEditingAnything",()=>!!r.getEditingShapeId(),[r]);y.useEffect(()=>{function u({shapeId:d}){var h;d===n&&((h=i.current)==null||h.select())}return r.on("select-all-text",u),()=>{r.off("select-all-text",u)}},[r,n,o]),y.useEffect(()=>{var u,d,h,f;o&&(document.activeElement!==i.current&&((u=i.current)==null||u.focus()),r.getInstanceState().isCoarsePointer&&((d=i.current)==null||d.select()),r.environment.isSafari&&((h=i.current)==null||h.blur(),(f=i.current)==null||f.focus()))},[r,o]);const a=y.useCallback(u=>{if(r.getEditingShapeId()===n)switch(u.key){case"Enter":{(u.ctrlKey||u.metaKey)&&r.complete();break}}},[r,n]),c=y.useCallback(u=>{if(r.getEditingShapeId()!==n)return;let d=cx.normalizeText(u.currentTarget.value);const h=d.replace(/\t/g,hC);if(h!==d){const f=u.currentTarget.selectionStart;u.currentTarget.value=h,u.currentTarget.selectionStart=f+(h.length-d.length),u.currentTarget.selectionEnd=f+(h.length-d.length),d=h}r.updateShape({id:n,type:e,props:{text:d}})},[r,n,e]),l=y.useCallback(u=>{r.dispatch({...Bu(u),type:"pointer",name:"pointer_down",target:"shape",shape:r.getShape(n)}),Wc(u)},[r,n]);return{rInput:i,handleFocus:W8,handleBlur:W8,handleKeyDown:a,handleChange:c,handleInputPointerDown:l,handleDoubleClick:Wc,isEmpty:t.trim().length===0,isEditing:o,isEditingAnything:s}}const jN=Ke.memo(function({id:e,type:t,text:r,labelColor:i,font:o,fontSize:s,lineHeight:a,align:c,verticalAlign:l,wrap:u,isSelected:d,padding:h=0,onKeyDown:f,classNamePrefix:p,style:g,textWidth:m,textHeight:v}){const{rInput:b,isEmpty:S,isEditing:E,isEditingAnything:w,...C}=fNt(e,t,r),[I,T]=y.useState(r);y.useEffect(()=>{E||T(r)},[E,r]);const D=cx.normalizeTextForDom(r),O=D.length>0,M=dNt(c);if(!E&&!O)return null;const R=p||"tl-text";return x.jsx("div",{className:`${R}-label tl-text-wrapper`,"data-font":o,"data-align":c,"data-hastext":!S,"data-isediting":E,"data-iseditinganything":w,"data-textwrap":!!u,"data-isselected":d,style:{justifyContent:c==="middle"||M?"center":c,alignItems:l==="middle"?"center":l,padding:h,...g},children:x.jsxs("div",{className:`${R}-label__inner tl-text-content__wrapper`,style:{fontSize:s,lineHeight:Math.floor(s*a)+"px",minHeight:Math.floor(s*a)+"px",minWidth:Math.ceil(m||0),color:i,width:m?Math.ceil(m):void 0,height:v?Math.ceil(v):void 0},children:[x.jsx("div",{className:`${R} tl-text tl-text-content`,dir:"auto",children:D.split(`
`).map((A,k)=>x.jsx("div",{dir:"auto",children:A},k))}),(w||d)&&x.jsx(hNt,{ref:b,text:r,isEditing:E,...C,handleKeyDown:f??C.handleKeyDown},I)]})})});function Lp(n,e,t={}){const{closed:r=!1,snap:i=1,start:o="outset",end:s="outset",lengthRatio:a=2,style:c="dashed"}=t;let l=0,u=0,d=1,h=0,f=0;switch(c){case"dashed":{d=1,l=Math.min(e*a,n/4);break}case"dotted":{d=100,l=e/d;break}default:return{strokeDasharray:"none",strokeDashoffset:"none"}}return r||(o==="outset"?(n+=l/2,f+=l/2):o==="skip"&&(n-=l,f-=l),s==="outset"?n+=l/2:s==="skip"&&(n-=l)),u=Math.floor(n/l/(2*d)),u-=u%i,u<3&&c==="dashed"?n/e<4?(l=n,u=1,h=0):(l=n*(1/3),h=n*(1/3)):(l=n/u/(2*d),r?(f=l/2,h=(n-u*l)/u):h=(n-u*l)/Math.max(1,u-1)),{strokeDasharray:[l,h].join(" "),strokeDashoffset:f.toString()}}const e1e=new WeakMap;function $ie(n,e){const t=e1e.get(e);if(t)return t;const r=Xp(n,e);let i=0,o=0;const s=r.isStraight?new Nm({start:H.From(r.start.point),end:H.From(r.end.point)}):new cC({center:H.Cast(r.handleArc.center),start:H.Cast(r.start.point),end:H.Cast(r.end.point),sweepFlag:r.bodyArc.sweepFlag,largeArcFlag:r.bodyArc.largeArcFlag});if(e.props.text.trim()){const c=s.bounds,l=pX(e),{w:u,h:d}=n.textMeasure.measureText(e.props.text,{...qc,fontFamily:sg[e.props.font],fontSize:l,maxWidth:null});if(i=u,o=d,c.width>c.height){i=Math.max(Math.min(u,64),Math.min(c.width-64,u));const{w:h,h:f}=n.textMeasure.measureText(e.props.text,{...qc,fontFamily:sg[e.props.font],fontSize:l,maxWidth:i});i=h,o=f}if(i>16*l){i=16*l;const{w:h,h:f}=n.textMeasure.measureText(e.props.text,{...qc,fontFamily:sg[e.props.font],fontSize:l,maxWidth:i});i=h,o=f}}const a=new H(i,o).addScalar(a7t*2*e.props.scale);return e1e.set(e,a),a}function fLe(n){const e=dc[n.props.size];return(s7t+(e-dc.s)*2+(e===dc.xl?20:0))*n.props.scale}function pNt(n,e,t){const r=$ie(n,e),i=fLe(e),o=H.Nudge(t.start.point,t.end.point,i),s=H.Nudge(t.end.point,t.start.point,i),a=Sie(o,s,xn.FromCenter(t.middle,r).corners);if(!a||a.length!==2)return{start:.5,end:.5};let[c,l]=a;H.Dist2(c,o)>H.Dist2(l,o)&&([l,c]=a);const u=o.add(H.Sub(t.middle,c)),d=s.add(H.Sub(t.middle,l)),h=H.Dist(t.start.point,u)/t.length,f=H.Dist(t.start.point,d)/t.length;return{start:h,end:f}}function gNt(n,e,t){const r=$ie(n,e),i=fLe(e),o=Math.sign(e.props.bend),s=i/t.handleArc.radius*o,a=H.Angle(t.bodyArc.center,t.start.point)-s,c=H.Angle(t.bodyArc.center,t.end.point)+s,l=VS(t.bodyArc.center,t.bodyArc.radius,a),u=VS(t.bodyArc.center,t.bodyArc.radius,c),d=[],h=t1e(t.bodyArc.center,t.bodyArc.radius,a,c,o,xn.FromCenter(l,r).corners);d.push(new Ys({points:xn.FromCenter(l,r).corners,debugColor:"lime",isFilled:!1,ignore:!0}));const f=t1e(t.bodyArc.center,t.bodyArc.radius,a,c,o,xn.FromCenter(u,r).corners);d.push(new Ys({points:xn.FromCenter(u,r).corners,debugColor:"lime",isFilled:!1,ignore:!0}));for(const I of[...h??[],...f??[],l,u])d.push(new Tie({x:I.x-3,y:I.y-3,radius:3,isFilled:!1,debugColor:"magenta",ignore:!0}));const p=(h&&n1e(t.start.point,h))??t.middle,g=(f&&n1e(t.end.point,f))??t.middle,m=H.Angle(t.bodyArc.center,t.start.point),v=H.Angle(t.bodyArc.center,t.end.point),b=H.Angle(t.bodyArc.center,p),S=H.Angle(t.bodyArc.center,g);if(_0(m,b,o)>_0(m,S,o))return{start:.5,end:.5,dbg:d};const E=_0(m,v,o),w=_0(m,b,o)/E,C=_0(m,S,o)/E;return{start:w,end:C,dbg:d}}function MO(n,e){let t;const r=[],i=Xp(n,e),o=!!i.bindings.start,s=!!i.bindings.end,a=i.start.arrowhead!=="none",c=i.end.arrowhead!=="none";if(i.isStraight){const u=pNt(n,e,i);let d=Ja(e.props.labelPosition,a||o?u.start:0,c||s?u.end:1);d=d>=.48&&d<=.52?.5:d,t=H.Lrp(i.start.point,i.end.point,d)}else{const u=gNt(n,e,i);u.dbg&&r.push(...u.dbg);let d=Ja(e.props.labelPosition,a||o?u.start:0,c||s?u.end:1);d=d>=.48&&d<=.52?.5:d;const h=mNt(H.Angle(i.bodyArc.center,i.start.point),H.Angle(i.bodyArc.center,i.end.point),Math.sign(e.props.bend),d);t=VS(i.bodyArc.center,i.bodyArc.radius,h)}const l=$ie(n,e);return{box:xn.FromCenter(t,l),debugGeom:r}}function t1e(n,e,t,r,i,o){const s=sX(n,e,o),a=_0(t,r,i);return s==null?void 0:s.filter(c=>{const l=_0(t,H.Angle(n,c),i);return l>=0&&l<=a})}function n1e(n,e){let t=null,r=-1/0;for(const i of e){const o=H.Dist2(n,i);o>r&&(t=i,r=o)}return t}function mNt(n,e,t,r){const i=_0(n,e,t);return n+i*r*t*-1}function pX(n){return o7t[n.props.size]*n.props.scale}function vNt(n,e,t){const r=e==="end"?n.end.point:n.start.point,i=e==="end"?n.start.point:n.end.point,o=n.isStraight?H.Dist(i,r):Math.abs(n.bodyArc.length),s=Math.max(Math.min(o/5,t*3),t);let a;if(n.isStraight)a=H.Nudge(r,i,s);else{const c=G8t(r,s,n.handleArc.center,n.handleArc.radius);a=e==="end"?n.handleArc.sweepFlag?c[0]:c[1]:n.handleArc.sweepFlag?c[1]:c[0]}return H.IsNaN(a)&&(a=n.start.point),{point:r,int:a}}function yNt({point:n,int:e}){const t=H.RotWith(e,n,Ai/6),r=H.RotWith(e,n,-Ai/6);return`M ${t.x} ${t.y} L ${n.x} ${n.y} L ${r.x} ${r.y}`}function bNt({point:n,int:e}){const t=H.RotWith(e,n,Ai/6),r=H.RotWith(e,n,-Ai/6);return`M ${t.x} ${t.y} L ${n.x} ${n.y} L ${r.x} ${r.y} Z`}function SNt({point:n,int:e}){const t=H.Sub(e,n).div(2),r=H.Add(n,H.Rot(t,Fo)),i=H.Sub(n,H.Rot(t,Fo));return`M ${r.x} ${r.y} L ${e.x} ${e.y} L ${i.x} ${i.y} Z`}function _Nt({point:n,int:e}){const t=H.Lrp(n,e,.45),r=H.Dist(t,n);return`M ${t.x-r},${t.y}
  a ${r},${r} 0 1,0 ${r*2},0
  a ${r},${r} 0 1,0 -${r*2},0 `}function wNt({point:n,int:e}){const t=H.Lrp(n,e,.75),r=H.RotWith(t,n,Ai/4),i=H.RotWith(t,n,-Ai/4),o=H.Lrp(r,i,.5);return o.add(H.Sub(o,n)),`M ${o.x} ${o.y} L ${r.x} ${r.y} ${n.x} ${n.y} L ${i.x} ${i.y} Z`}function CNt({int:n,point:e}){const t=H.Lrp(e,n,.85),r=H.Sub(t,e).div(2),i=H.Add(e,H.Rot(r,Fo)),o=H.Sub(e,H.Rot(r,Fo)),s=H.Add(t,H.Rot(r,Fo)),a=H.Sub(t,H.Rot(r,Fo));return`M ${i.x} ${i.y} L ${s.x} ${s.y} L ${a.x} ${a.y} L ${o.x} ${o.y} Z`}function xNt({int:n,point:e}){const t=H.Sub(n,e).div(2),r=H.Add(e,H.Rot(t,Fo)),i=H.Sub(e,H.Rot(t,Fo));return`M ${r.x} ${r.y} L ${i.x} ${i.y}`}function m$(n,e,t){const r=e==="end"?n.end.arrowhead:n.start.arrowhead;if(r==="none")return;const i=vNt(n,e,t);if(i){switch(r){case"bar":return xNt(i);case"square":return CNt(i);case"diamond":return wNt(i);case"dot":return _Nt(i);case"inverted":return SNt(i);case"arrow":return yNt(i);case"triangle":return bNt(i)}return""}}function ENt(n){const{start:e,end:t,handleArc:{radius:r,largeArcFlag:i,sweepFlag:o}}=n;return`M${e.handle.x},${e.handle.y} A${r} ${r} 0 ${i} ${o} ${t.handle.x},${t.handle.y}`}function pLe(n){const{start:e,end:t,bodyArc:{radius:r,largeArcFlag:i,sweepFlag:o}}=n;return`M${e.point.x},${e.point.y} A${r} ${r} 0 ${i} ${o} ${t.point.x},${t.point.y}`}function gLe(n,e){return`M${n.x},${n.y}L${e.x},${e.y}`}function INt(n){return gLe(n.start.handle,n.end.handle)}function mLe(n){return gLe(n.start.point,n.end.point)}let PNt=0;class $O extends qf{constructor(){super(...arguments);$(this,"canEdit",()=>!0);$(this,"canSnap",()=>!1);$(this,"hideResizeHandles",()=>!0);$(this,"hideRotateHandle",()=>!0);$(this,"hideSelectionBoundsBg",()=>!0);$(this,"hideSelectionBoundsFg",()=>!0);$(this,"canBeLaidOut",t=>{const r=Mu(this.editor,t);return!r.start&&!r.end});$(this,"onHandleDrag",(t,{handle:r,isPrecise:i})=>{const o=r.id,s=Mu(this.editor,t);if(o==="middle"){const{start:C,end:I}=lC(this.editor,t,s),T=H.Sub(I,C),D=H.Per(T),O=H.Med(I,C),M=H.Sub(O,D),R=H.Add(O,D),A=H.NearestPointOnLineSegment(M,R,r,!1);let k=H.Dist(A,O);return H.Clockwise(A,I,O)&&(k*=-1),{id:t.id,type:t.type,props:{bend:k}}}const a={id:t.id,type:"arrow",props:{}},c=s[o],u=s[o==="start"?"end":"start"];if(this.editor.inputs.ctrlKey)return EO(this.editor,t,o),a.props[o]={x:r.x,y:r.y},a;const d=this.editor.getShapePageTransform(t.id).applyToPoint(r),h=this.editor.getShapeAtPoint(d,{hitInside:!0,hitFrameInside:!0,margin:0,filter:C=>!C.isLocked&&this.editor.canBindShapes({fromShape:t,toShape:C,binding:"arrow"})});if(!h)return EO(this.editor,t,o),a.props[o]={x:r.x,y:r.y},a;const f=this.editor.getShapeGeometry(h),p=xn.ZeroFix(f.bounds),m=this.editor.getShapePageTransform(a.id).applyToPoint(r),v=this.editor.getPointInShapeSpace(h,m);let b=i;b||(!c||c&&h.id!==c.toId)&&(b=this.editor.inputs.pointerVelocity.len()<.5),i||(f.isClosed||(b=!0),u&&h.id===u.toId&&u.props.isPrecise&&(b=!0));const S={x:(v.x-p.minX)/p.width,y:(v.y-p.minY)/p.height};b&&H.Dist(v,p.center)<Math.max(4,Math.min(Math.min(p.width,p.height)*.15,16))/this.editor.getZoomLevel()&&(S.x=.5,S.y=.5);const E={terminal:o,normalizedAnchor:S,isPrecise:b,isExact:this.editor.inputs.altKey};CI(this.editor,t,h.id,E),this.editor.setHintingShapes([h.id]);const w=Mu(this.editor,t);return w.start&&w.end&&w.start.toId===w.end.toId&&H.Equals(w.start.props.normalizedAnchor,w.end.props.normalizedAnchor)&&CI(this.editor,t,w.end.toId,{...w.end.props,normalizedAnchor:{x:w.end.props.normalizedAnchor.x+.05,y:w.end.props.normalizedAnchor.y}}),a});$(this,"onTranslateStart",t=>{const r=Mu(this.editor,t),i=lC(this.editor,t,r),o=this.editor.getShapePageTransform(t.id),s=this.editor.getSelectedShapeIds();if(!(r.start&&(s.includes(r.start.toId)||this.editor.isAncestorSelected(r.start.toId))||r.end&&(s.includes(r.end.toId)||this.editor.isAncestorSelected(r.end.toId)))){i1e.set(t,{pagePosition:o.applyToPoint(t),terminalBindings:TD(i,(a,c)=>{const l=r[a];return l?{binding:l,shapePosition:c,pagePosition:o.applyToPoint(c)}:null})}),r.start&&(f$({editor:this.editor,arrow:t,terminal:"start",useHandle:!0}),t=this.editor.getShape(t.id)),r.end&&f$({editor:this.editor,arrow:t,terminal:"end",useHandle:!0});for(const a of["start","end"]){const c=r[a];c&&this.editor.updateBinding({...c,props:{...c.props,isPrecise:!0}})}}});$(this,"onTranslate",(t,r)=>{const i=i1e.get(t);if(!i)return;const o=this.editor.getShapePageTransform(r.id),s=H.Sub(o.applyToPoint(r),i.pagePosition);for(const a of Object.values(i.terminalBindings)){if(!a)continue;const c=H.Add(a.pagePosition,H.Mul(s,.5)),l=this.editor.getShapeAtPoint(c,{hitInside:!0,hitFrameInside:!0,margin:0,filter:u=>!u.isLocked&&this.editor.canBindShapes({fromShape:r,toShape:u,binding:"arrow"})});if((l==null?void 0:l.id)===a.binding.toId){const u=xn.ZeroFix(this.editor.getShapeGeometry(l).bounds),d=this.editor.getPointInShapeSpace(l,c),h={x:(d.x-u.minX)/u.width,y:(d.y-u.minY)/u.height};CI(this.editor,r,l.id,{...a.binding.props,normalizedAnchor:h,isPrecise:!0})}else EO(this.editor,r,a.binding.props.terminal)}});$(this,"_resizeInitialBindings",new uv);$(this,"onResize",(t,r)=>{const{scaleX:i,scaleY:o}=r,s=this._resizeInitialBindings.get(t,()=>Mu(this.editor,t)),a=lC(this.editor,t,s),{start:c,end:l}=ls(t.props);let{bend:u}=t.props;s.start||(c.x=a.start.x*i,c.y=a.start.y*o),s.end||(l.x=a.end.x*i,l.y=a.end.y*o);const d=Math.abs(i),h=Math.abs(o),f=s!=null&&s.start?H.From(s.start.props.normalizedAnchor):null,p=s!=null&&s.end?H.From(s.end.props.normalizedAnchor):null;return i<0&&o>=0?(u!==0&&(u*=-1,u*=Math.max(d,h)),f&&(f.x=1-f.x),p&&(p.x=1-p.x)):i>=0&&o<0?(u!==0&&(u*=-1,u*=Math.max(d,h)),f&&(f.y=1-f.y),p&&(p.y=1-p.y)):i>=0&&o>=0?u!==0&&(u*=Math.max(d,h)):i<0&&o<0&&(u!==0&&(u*=Math.max(d,h)),f&&(f.x=1-f.x,f.y=1-f.y),p&&(p.x=1-p.x,p.y=1-p.y)),s.start&&f&&CI(this.editor,t,s.start.toId,{...s.start.props,normalizedAnchor:f.toJson()}),s.end&&p&&CI(this.editor,t,s.end.toId,{...s.end.props,normalizedAnchor:p.toJson()}),{props:{start:c,end:l,bend:u}}});$(this,"onDoubleClickHandle",(t,r)=>{switch(r.id){case"start":return{id:t.id,type:t.type,props:{...t.props,arrowheadStart:t.props.arrowheadStart==="none"?"arrow":"none"}};case"end":return{id:t.id,type:t.type,props:{...t.props,arrowheadEnd:t.props.arrowheadEnd==="none"?"arrow":"none"}}}});$(this,"onEditEnd",t=>{const{id:r,type:i,props:{text:o}}=t;o.trimEnd()!==t.props.text&&this.editor.updateShapes([{id:r,type:i,props:{text:o.trimEnd()}}])})}canBind({toShapeType:t}){return t!=="arrow"}getDefaultProps(){return{dash:"draw",size:"m",fill:"none",color:"black",labelColor:"black",bend:0,start:{x:0,y:0},end:{x:2,y:0},arrowheadStart:"none",arrowheadEnd:"arrow",text:"",labelPosition:.5,font:"draw",scale:1}}getGeometry(t){const r=Xp(this.editor,t),i=[],o=r.isStraight?new Nm({start:H.From(r.start.point),end:H.From(r.end.point)}):new cC({center:H.Cast(r.handleArc.center),start:H.Cast(r.start.point),end:H.Cast(r.end.point),sweepFlag:r.bodyArc.sweepFlag,largeArcFlag:r.bodyArc.largeArcFlag});let s;if(t.props.text.trim()){const a=MO(this.editor,t);i.push(...a.debugGeom),s=new hv({x:a.box.x,y:a.box.y,width:a.box.w,height:a.box.h,isFilled:!0,isLabel:!0})}return new Qf({children:[...s?[o,s]:[o],...i]})}getHandles(t){const r=Xp(this.editor,t);return[{id:"start",type:"vertex",index:"a0",x:r.start.handle.x,y:r.start.handle.y},{id:"middle",type:"virtual",index:"a2",x:r.middle.x,y:r.middle.y},{id:"end",type:"vertex",index:"a3",x:r.end.handle.x,y:r.end.handle.y}].filter(Boolean)}component(t){const r=Zh(),i=this.editor.getOnlySelectedShape(),o=this.editor.isInAny("select.idle","select.pointing_handle","select.dragging_handle","select.translating","arrow.dragging")&&!this.editor.getInstanceState().isReadonly,s=Xp(this.editor,t);if(!(s!=null&&s.isValid))return null;const a=MO(this.editor,t),c=t.id===this.editor.getOnlySelectedShapeId(),u=this.editor.getEditingShapeId()===t.id||t.props.text;return x.jsxs(x.Fragment,{children:[x.jsx(ky,{id:t.id,style:{minWidth:50,minHeight:50},children:x.jsx(r1e,{shape:t,shouldDisplayHandles:o&&(i==null?void 0:i.id)===t.id})}),u&&x.jsx(jN,{id:t.id,classNamePrefix:"tl-arrow",type:"arrow",font:t.props.font,fontSize:pX(t),lineHeight:qc.lineHeight,align:"middle",verticalAlign:"middle",text:t.props.text,labelColor:r[t.props.labelColor].solid,textWidth:a.box.w,isSelected:c,padding:0,style:{transform:`translate(${a.box.center.x}px, ${a.box.center.y}px)`}})]})}indicator(t){const r=$N(t.id),i=Xp(this.editor,t);if(!i)return null;const{start:o,end:s}=lC(this.editor,t,i==null?void 0:i.bindings),a=this.editor.getShapeGeometry(t),c=a.bounds,l=t.props.text.trim()?a.children[1]:null;if(H.Equals(o,s))return null;const u=dc[t.props.size]*t.props.scale,d=i.start.arrowhead&&m$(i,"start",u),h=i.end.arrowhead&&m$(i,"end",u),f=i.isStraight?mLe(i):pLe(i),p=d&&i.start.arrowhead!=="arrow"||h&&i.end.arrowhead!=="arrow"||!!l,g=(t.id+"_clip").replace(":","_");return r&&l?x.jsx("rect",{x:et(l.x),y:et(l.y),width:l.w,height:l.h,rx:3.5*t.props.scale,ry:3.5*t.props.scale}):x.jsxs("g",{children:[p&&x.jsx("defs",{children:x.jsxs("mask",{id:g,children:[x.jsx("rect",{x:c.minX-100,y:c.minY-100,width:c.w+200,height:c.h+200,fill:"white"}),l&&x.jsx("rect",{x:et(l.x),y:et(l.y),width:l.w,height:l.h,fill:"black",rx:3.5*t.props.scale,ry:3.5*t.props.scale}),d&&x.jsx("path",{d,fill:i.start.arrowhead==="arrow"?"none":"black",stroke:"none"}),h&&x.jsx("path",{d:h,fill:i.end.arrowhead==="arrow"?"none":"black",stroke:"none"})]})}),x.jsxs("g",{...p?{mask:`url(#${g})`}:void 0,children:[p&&x.jsx("rect",{x:c.minX-100,y:c.minY-100,width:c.width+200,height:c.height+200,opacity:0}),x.jsx("path",{d:f})]}),d&&x.jsx("path",{d}),h&&x.jsx("path",{d:h}),l&&x.jsx("rect",{x:et(l.x),y:et(l.y),width:l.w,height:l.h,rx:3.5,ry:3.5})]})}toSvg(t,r){r.addExportDef(Oie(t.props.fill)),t.props.text&&r.addExportDef(lx(t.props.font));const i=xv(r),o=1/t.props.scale;return x.jsxs("g",{transform:`scale(${o})`,children:[x.jsx(r1e,{shape:t,shouldDisplayHandles:!1}),x.jsx(FN,{fontSize:pX(t),font:t.props.font,align:"middle",verticalAlign:"middle",text:t.props.text,labelColor:i[t.props.labelColor].solid,bounds:MO(this.editor,t).box,padding:4*t.props.scale})]})}getCanvasSvgDefs(){return[Mie(),{key:"arrow:dot",component:TNt},{key:"arrow:cross",component:DNt}]}}$($O,"type","arrow"),$($O,"props",d8e),$($O,"migrations",h8e);function kNt(n,e){const t=Xp(n,e);return t.isStraight?H.Dist(t.start.handle,t.end.handle):Math.abs(t.handleArc.length)}const r1e=Zd(function({shape:e,shouldDisplayHandles:t}){const r=ot(),i=Zh(),o=Xp(r,e),s=xn.ZeroFix(r.getShapeGeometry(e).bounds),a=Mu(r,e),c=Ke.useMemo(()=>r.environment.isSafari?PNt+=1:0,[e]);if(!(o!=null&&o.isValid))return null;const l=dc[e.props.size]*e.props.scale,u=o.start.arrowhead&&m$(o,"start",l),d=o.end.arrowhead&&m$(o,"end",l),h=o.isStraight?mLe(o):pLe(o);let f=null;if(t){const E=2/r.getZoomLevel(),{strokeDasharray:w,strokeDashoffset:C}=Lp(kNt(r,e),E,{end:"skip",start:"skip",lengthRatio:2.5});f=a.start||a.end?x.jsx("path",{className:"tl-arrow-hint",d:o.isStraight?INt(o):ENt(o),strokeDasharray:w,strokeDashoffset:C,strokeWidth:E,markerStart:a.start?a.start.props.isExact?"":a.start.props.isPrecise?"url(#arrowhead-cross)":"url(#arrowhead-dot)":"",markerEnd:a.end?a.end.props.isExact?"":a.end.props.isPrecise?"url(#arrowhead-cross)":"url(#arrowhead-dot)":"",opacity:.16}):null}const{strokeDasharray:p,strokeDashoffset:g}=Lp(o.isStraight?o.length:Math.abs(o.bodyArc.length),l,{style:e.props.dash}),m=MO(r,e),v=!(o.start.arrowhead==="none"||o.start.arrowhead==="arrow"),b=!(o.end.arrowhead==="none"||o.end.arrowhead==="arrow"),S=(e.id+"_clip_"+c).replace(":","_");return x.jsxs(x.Fragment,{children:[x.jsx("defs",{children:x.jsxs("mask",{id:S,children:[x.jsx("rect",{x:et(-100+s.minX),y:et(-100+s.minY),width:et(s.width+200),height:et(s.height+200),fill:"white"}),e.props.text.trim()&&x.jsx("rect",{x:m.box.x,y:m.box.y,width:m.box.w,height:m.box.h,fill:"black",rx:4,ry:4}),u&&v&&x.jsx("path",{d:u,fill:o.start.arrowhead==="arrow"?"none":"black",stroke:"none"}),d&&b&&x.jsx("path",{d,fill:o.end.arrowhead==="arrow"?"none":"black",stroke:"none"})]})}),x.jsxs("g",{fill:"none",stroke:i[e.props.color].solid,strokeWidth:l,strokeLinejoin:"round",strokeLinecap:"round",pointerEvents:"none",children:[f,x.jsxs("g",{mask:`url(#${S})`,children:[x.jsx("rect",{x:et(s.minX-100),y:et(s.minY-100),width:et(s.width+200),height:et(s.height+200),opacity:0}),x.jsx("path",{d:h,strokeDasharray:p,strokeDashoffset:g})]}),u&&v&&e.props.fill!=="none"&&x.jsx(sl,{theme:i,d:u,color:e.props.color,fill:e.props.fill,scale:e.props.scale}),d&&b&&e.props.fill!=="none"&&x.jsx(sl,{theme:i,d,color:e.props.color,fill:e.props.fill,scale:e.props.scale}),u&&x.jsx("path",{d:u}),d&&x.jsx("path",{d})]})]})}),i1e=new WeakMap;function TNt(){return x.jsx("marker",{id:"arrowhead-dot",className:"tl-arrow-hint",refX:"3.0",refY:"3.0",orient:"0",children:x.jsx("circle",{cx:"3",cy:"3",r:"2",strokeDasharray:"100%"})})}function DNt(){return x.jsxs("marker",{id:"arrowhead-cross",className:"tl-arrow-hint",refX:"3.0",refY:"3.0",orient:"auto",children:[x.jsx("line",{x1:"1.5",y1:"1.5",x2:"4.5",y2:"4.5",strokeDasharray:"100%"}),x.jsx("line",{x1:"1.5",y1:"4.5",x2:"4.5",y2:"1.5",strokeDasharray:"100%"})]})}const o1e="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='30' height='30' fill='none'%3E%3Cpath stroke='%23000' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M13 5H7a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6M19 5h6m0 0v6m0-6L13 17'/%3E%3C/svg%3E";function ux({url:n,zoomLevel:e}){return x.jsx("a",{className:Ue("tl-hyperlink-button",{"tl-hyperlink-button__hidden":e<.32}),href:n,target:"_blank",rel:"noopener noreferrer",onPointerDown:Wc,onPointerUp:Wc,title:n,draggable:!1,children:x.jsx("div",{className:"tl-hyperlink__icon",style:{mask:`url("${o1e}") center 100% / 100% no-repeat`,WebkitMask:`url("${o1e}") center 100% / 100% no-repeat`}})})}const s1e="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='30' height='30' fill='none'%3E%3Cpath stroke='%23000' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M13 5H7a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6M19 5h6m0 0v6m0-6L13 17'/%3E%3C/svg%3E",RNt=[{offsetX:0,offsetY:2,blur:4,spread:0,color:"#00000029"},{offsetX:0,offsetY:3,blur:6,spread:0,color:"#0000001f"}];function Lie(n){return RNt.map(t=>{const{offsetX:r,offsetY:i,blur:o,spread:s,color:a}=t,c=new H(r,i),{x:l,y:u}=c.rot(-n);return`${l}px ${u}px ${o}px ${s}px ${a}`}).join(", ")}const ANt=300,vLe=320,ONt=46,MNt=101;class LO extends vE{constructor(){super(...arguments);$(this,"canResize",()=>!1);$(this,"hideSelectionBoundsFg",()=>!0);$(this,"onBeforeCreate",t=>a1e(this.editor,t));$(this,"onBeforeUpdate",(t,r)=>{if(t.props.url!==r.props.url)if(Wd.isValid(r.props.url))LNt(this.editor,r);else return{...r,props:{...r.props,url:t.props.url}};if(t.props.assetId!==r.props.assetId)return a1e(this.editor,r)})}getDefaultProps(){return{url:"",w:ANt,h:vLe,assetId:null}}component(t){const r=t.props.assetId?this.editor.getAsset(t.props.assetId):null,i=this.editor.getShapePageTransform(t).rotation(),o=$Nt(t);return x.jsx(WS,{children:x.jsxs("div",{className:"tl-bookmark__container",style:{boxShadow:Lie(i)},children:[(!r||r.props.image)&&x.jsxs("div",{className:"tl-bookmark__image_container",children:[r?x.jsx("img",{className:"tl-bookmark__image",draggable:!1,referrerPolicy:"strict-origin-when-cross-origin",src:r==null?void 0:r.props.image,alt:(r==null?void 0:r.props.title)||""}):x.jsx("div",{className:"tl-bookmark__placeholder"}),(r==null?void 0:r.props.image)&&x.jsx(ux,{url:t.props.url,zoomLevel:this.editor.getZoomLevel()})]}),x.jsxs("div",{className:"tl-bookmark__copy_container",children:[r!=null&&r.props.title?x.jsx("h2",{className:"tl-bookmark__heading",children:r.props.title}):null,r!=null&&r.props.description&&(r!=null&&r.props.image)?x.jsx("p",{className:"tl-bookmark__description",children:r.props.description}):null,x.jsxs("a",{className:"tl-bookmark__link",href:t.props.url||"",target:"_blank",rel:"noopener noreferrer",onPointerDown:Wc,onPointerUp:Wc,onClick:Wc,children:[r!=null&&r.props.favicon?x.jsx("img",{className:"tl-bookmark__favicon",src:r==null?void 0:r.props.favicon,referrerPolicy:"strict-origin-when-cross-origin",alt:`favicon of ${o}`}):x.jsx("div",{className:"tl-hyperlink__icon",style:{mask:`url("${s1e}") center 100% / 100% no-repeat`,WebkitMask:`url("${s1e}") center 100% / 100% no-repeat`}}),x.jsx("span",{children:o})]})]})]})})}indicator(t){return x.jsx("rect",{width:et(t.props.w),height:et(t.props.h),rx:"6",ry:"6"})}}$(LO,"type","bookmark"),$(LO,"props",y8e),$(LO,"migrations",b8e);function a1e(n,e){const t=e.props.assetId?n.getAsset(e.props.assetId):null;let r=vLe;return t&&(t.props.image||(t.props.title?r=MNt:r=ONt)),{...e,props:{...e.props,h:r}}}const $Nt=n=>{try{return new URL(n.props.url).hostname.replace(/^www\./,"")}catch{return n.props.url}};function LNt(n,e){const{url:t}=e.props,r=A1.createId(qZ(t));n.getAsset(r)?e.props.assetId!==r&&n.updateShapes([{id:e.id,type:e.type,props:{assetId:r}}]):(n.updateShapes([{id:e.id,type:e.type,props:{assetId:null}}]),NNt(n,e))}const NNt=P6e(async(n,e)=>{if(n.isDisposed)return;const{url:t}=e.props,r=await n.getAssetForExternalContent({type:"url",url:t});r&&n.batch(()=>{n.createAssets([r]),n.updateShapes([{id:e.id,type:e.type,props:{assetId:r.id}}])})},500);function qS(n,e=!1){const t=n.length;if(t<2)return"";let r=n[0].point,i=n[1].point;if(t===2)return`M${Di(r)}L${Di(i)}`;let o="";for(let s=2,a=t-1;s<a;s++)r=n[s].point,i=n[s+1].point,o+=Du(r,i);return e?`M${Du(n[0].point,n[1].point)}Q${Di(n[1].point)}${Du(n[1].point,n[2].point)}T${o}${Du(n[t-1].point,n[0].point)}${Du(n[0].point,n[1].point)}Z`:`M${Di(n[0].point)}Q${Di(n[1].point)}${Du(n[1].point,n[2].point)}${n.length>3?"T":""}${o}L${Di(n[t-1].point)}`}function FNt(n,e={}){const{start:t={},end:r={}}=e,{cap:i=!0}=t,{cap:o=!0}=r;ds(!t.taper&&!r.taper,"cap taper not supported here"),ds(!t.easing&&!r.easing,"cap easing not supported here"),ds(i&&o,"cap must be true");const s=Sg(n,e);LN(s,e);const a=jNt(s);let c="";for(const l of a)c+=HNt(l,e);return c}function jNt(n){if(n.length<=2)return[n];const e=[];let t=[n[0]],r=H.Sub(n[1].point,n[0].point).uni(),i,o,s,a,c;for(let l=1,u=n.length;l<u-1;l++){if(s=n[l-1],a=n[l],c=n[l+1],i=H.Sub(c.point,a.point).uni(),o=H.Dpr(r,i),r=i,o<-.8){const d={...a,point:a.input};t.push(d),e.push(WU(t)),t=[d];continue}if(t.push(a),!(o>.7)&&(H.Dist2(s.point,a.point)+H.Dist2(a.point,c.point))/((s.radius+a.radius+c.radius)/3)**2<1.5){t.push(a),e.push(WU(t)),t=[a];continue}}return t.push(n[n.length-1]),e.push(WU(t)),e}function WU(n){const e=n[0];let t;for(;n.length>2&&(t=n[1],H.Dist2(e.point,t.point)<((e.radius+t.radius)/2*.5)**2);)n.splice(1,1);const r=n[n.length-1];let i;for(;n.length>2&&(i=n[n.length-2],H.Dist2(r.point,i.point)<((r.radius+i.radius)/2*.5)**2);)n.splice(n.length-2,1);return n.length>1&&(n[0]={...n[0],vector:H.Sub(n[0].point,n[1].point).uni()},n[n.length-1]={...n[n.length-1],vector:H.Sub(n[n.length-2].point,n[n.length-1].point).uni()}),n}function BNt(n,e,t){return"M "+n+" "+e+" m -"+t+", 0 a "+t+","+t+" 0 1,1 "+t*2+",0 a "+t+","+t+" 0 1,1 -"+t*2+",0"}function HNt(n,e={}){if(n.length===0)return"";if(n.length===1)return BNt(n[0].point.x,n[0].point.y,n[0].radius);const{left:t,right:r}=Z$e(n,e);r.reverse();let i=`M${Di(t[0])}T`;for(let o=1;o<t.length;o++)i+=Du(t[o-1],t[o]);{const o=n[n.length-1],s=o.radius,a=o.vector.clone().per().neg(),c=H.Add(o.point,H.Mul(a,s)),l=H.Add(o.point,H.Mul(a,-s));i+=`${Di(c)}A${et(s)},${et(s)} 0 0 1 ${Di(l)}T`}for(let o=1;o<r.length;o++)i+=Du(r[o-1],r[o]);{const o=n[0],s=o.radius,a=o.vector.clone().per(),c=H.Add(o.point,H.Mul(a,s)),l=H.Add(o.point,H.Mul(a,-s));i+=`${Di(c)}A${et(s)},${et(s)} 0 0 1 ${Di(l)}Z`}return i}const UNt=n=>n*.65+uMt(n*Ai/2)*.35,zNt=n=>({size:n,thinning:.5,streamline:ix(n,[9,16],[.64,.74],!0),smoothing:.62,easing:uc.easeOutSine,simulatePressure:!0}),VNt=n=>({size:1+n*1.2,thinning:.62,streamline:.62,smoothing:.62,simulatePressure:!1,easing:UNt}),c1e=n=>({size:n,thinning:0,streamline:ix(n,[9,16],[.68,.74],!0),smoothing:.62,simulatePressure:!1,easing:uc.linear}),WNt=n=>({size:n,thinning:0,streamline:.62,smoothing:.62,simulatePressure:!1,easing:uc.linear});function Nie({strokeWidth:n,showAsComplete:e}){return{size:1+n,thinning:0,streamline:.5,smoothing:.5,simulatePressure:!1,easing:uc.easeOutSine,last:e}}function gX(n,e,t,r){const i=n.isComplete||t;return r?n.isPen?{...WNt(e),last:i}:{...c1e(e),last:i}:n.dash==="draw"?n.isPen?{...VNt(e),last:i}:{...zNt(e),last:i}:{...c1e(e),last:i}}function dx(n){const e=[];for(const t of n)if(t.type==="free"||t.points.length<2)e.push(...t.points.map(H.Cast));else{const r=Math.max(4,Math.floor(H.Dist(t.points[0],t.points[1])/16));e.push(...H.PointsBetween(t.points[0],t.points[1],r))}return e}function qNt(n,e){return{draw:"none",solid:"none",dotted:`0.1 ${e*2}`,dashed:`${e*2} ${e*2}`}[n.props.dash]}class NO extends qf{constructor(){super(...arguments);$(this,"hideResizeHandles",t=>qU(t));$(this,"hideRotateHandle",t=>qU(t));$(this,"hideSelectionBoundsFg",t=>qU(t));$(this,"onResize",(t,r)=>{const{scaleX:i,scaleY:o}=r,s=[];for(const a of t.props.segments)s.push({...a,points:a.points.map(({x:c,y:l,z:u})=>({x:Mm(i*c),y:Mm(o*l),z:u}))});return{props:{segments:s}}})}getDefaultProps(){return{segments:[],color:"black",fill:"none",dash:"draw",size:"m",isComplete:!1,isClosed:!1,isPen:!1,scale:1}}getGeometry(t){const r=dx(t.props.segments),i=(dc[t.props.size]+1)*t.props.scale;if(t.props.segments.length===1){const s=xn.FromPoints(r);if(s.width<i*2&&s.height<i*2)return new Tie({x:-i,y:-i,radius:i,isFilled:!0})}const o=Sg(r,gX(t.props,i,t.props.isPen,!0)).map(s=>s.point);return t.props.isClosed?new Ys({points:o,isFilled:t.props.fill!=="none"}):new mE({points:o})}component(t){return x.jsx(ky,{id:t.id,children:x.jsx(l1e,{shape:t,zoomLevel:this.editor.getZoomLevel()})})}indicator(t){var d;const r=dx(t.props.segments);let i=(dc[t.props.size]+1)*t.props.scale;const o=this.editor.getZoomLevel();!(o<.5&&o<1.5/i)&&!t.props.isPen&&t.props.dash==="draw"&&r.length===1&&(i+=ip(t.id)()*(i/6));const a=t.props.isComplete||((d=Mc(t.props.segments))==null?void 0:d.type)==="straight",c=gX(t.props,i,a,!0),l=Sg(r,c),u=l.length>1?qS(l,t.props.isClosed):yLe(r[0],i);return x.jsx("path",{d:u})}toSvg(t,r){r.addExportDef(Oie(t.props.fill));const i=1/t.props.scale;return x.jsx("g",{transform:`scale(${i})`,children:x.jsx(l1e,{shape:t,zoomLevel:1})})}getCanvasSvgDefs(){return[Mie()]}expandSelectionOutlinePx(t){const r=t.props.dash==="draw"?1.6:1;return dc[t.props.size]*r/2*t.props.scale}}$(NO,"type","draw"),$(NO,"props",_8e),$(NO,"migrations",w8e);function yLe(n,e){const t=(e+1)*.5;return`M ${n.x} ${n.y} m -${t}, 0 a ${t},${t} 0 1,0 ${t*2},0 a ${t},${t} 0 1,0 -${t*2},0`}function qU(n){return n.props.segments.length===1&&n.props.segments[0].points.length<2}function l1e({shape:n,zoomLevel:e}){var d;const t=Zh(),r=dx(n.props.segments),i=n.props.isComplete||((d=Mc(n.props.segments))==null?void 0:d.type)==="straight";let o=(dc[n.props.size]+1)*n.props.scale;const s=e<.5&&e<1.5/o;!s&&!n.props.isPen&&n.props.dash==="draw"&&r.length===1&&(o+=ip(n.id)()*(o/6));const a=gX(n.props,o,i,s);if(!s&&n.props.dash==="draw")return x.jsxs(x.Fragment,{children:[n.props.isClosed&&n.props.fill&&r.length>1?x.jsx(sl,{d:qS(Sg(r,a),n.props.isClosed),theme:t,color:n.props.color,fill:n.props.isClosed?n.props.fill:"none",scale:n.props.scale}):null,x.jsx("path",{d:FNt(r,a),strokeLinecap:"round",fill:t[n.props.color].solid})]});const c=Sg(r,a),l=c.length<2,u=l?yLe(r[0],0):qS(c,n.props.isClosed);return x.jsxs(x.Fragment,{children:[x.jsx(sl,{d:u,theme:t,color:n.props.color,fill:l||n.props.isClosed?n.props.fill:"none",scale:n.props.scale}),x.jsx("path",{d:u,strokeLinecap:"round",fill:l?t[n.props.color].solid:"none",stroke:t[n.props.color].solid,strokeWidth:o,strokeDasharray:l?"none":qNt(n,o),strokeDashoffset:"0"})]})}function KNt(n,e,t={}){const{newPoint:r,handle:i,scaleX:o,scaleY:s}=e,{minWidth:a=1,maxWidth:c=1/0,minHeight:l=1,maxHeight:u=1/0}=t;let d=n.props.w*o,h=n.props.h*s;const f=new H(0,0);if(d>0){if(d<a){switch(i){case"top_left":case"left":case"bottom_left":{f.x=d-a;break}case"top":case"bottom":{f.x=(d-a)/2;break}default:f.x=0}d=a}}else if(f.x=d,d=-d,d<a){switch(i){case"top_left":case"left":case"bottom_left":{f.x=-d;break}default:f.x=-a}d=a}if(h>0){if(h<l){switch(i){case"top_left":case"top":case"top_right":{f.y=h-l;break}case"right":case"left":{f.y=(h-l)/2;break}default:f.y=0}h=l}}else if(f.y=h,h=-h,h<l){switch(i){case"top_left":case"top":case"top_right":{f.y=-h;break}default:f.y=-l}h=l}const{x:p,y:g}=f.rot(n.rotation).add(r);return{x:p,y:g,props:{w:Math.min(c,d),h:Math.min(u,h)}}}const GNt=n=>Object.entries(n).filter(([e,t])=>t).map(([e])=>e).join(" ");class FO extends vE{constructor(){super(...arguments);$(this,"hideSelectionBoundsFg",t=>!this.canResize(t));$(this,"canEdit",()=>!0);$(this,"canResize",t=>{var r,i;return!!((i=(r=K0(t.props.url))==null?void 0:r.definition)!=null&&i.doesResize)});$(this,"canEditInReadOnly",()=>!0);$(this,"isAspectRatioLocked",t=>{const r=K0(t.props.url);return(r==null?void 0:r.definition.isAspectRatioLocked)??!1});$(this,"onResize",(t,r)=>{const i=this.isAspectRatioLocked(t),o=K0(t.props.url);let s=(o==null?void 0:o.definition.minWidth)??200,a=(o==null?void 0:o.definition.minHeight)??200;if(i){const c=t.props.w/t.props.h;c>1?s*=c:a/=c}return KNt(t,r,{minWidth:s,minHeight:a})})}getDefaultProps(){return{w:300,h:300,url:""}}component(t){const{w:r,h:i,url:o}=t.props,s=$N(t.id),a=y.useMemo(()=>eLe(o),[o]),c=_t("is hovering",()=>{const{editingShapeId:f,hoveredShapeId:p}=this.editor.getCurrentPageState();if(f&&p!==f){const g=this.editor.getShape(f);if(g&&this.editor.isShapeOfType(g,"embed"))return!0}return!1},[]),l=this.editor.getShapePageTransform(t).rotation(),u=s||c;if(typeof window<"u"&&(window!==window.top||window.self!==window.parent)&&(a==null?void 0:a.definition.type)==="tldraw")return null;if((a==null?void 0:a.definition.type)==="github_gist"){const f=a.url.split("/").pop();if(!f)throw Error("No gist id!");return x.jsx(WS,{className:"tl-embed-container",id:t.id,children:x.jsx(ZNt,{id:f,width:et(r),height:et(i),isInteractive:u,pageRotation:l})})}const h=GNt({...XOt,...(a==null?void 0:a.definition.overridePermissions)??{}});return x.jsx(WS,{className:"tl-embed-container",id:t.id,children:a!=null&&a.definition?x.jsx("iframe",{className:"tl-embed",sandbox:h,src:a.embedUrl,width:et(r),height:et(i),draggable:!1,frameBorder:"0",referrerPolicy:"no-referrer-when-downgrade",style:{border:0,pointerEvents:u?"auto":"none",zIndex:u?"":"-1",boxShadow:Lie(l),borderRadius:(a==null?void 0:a.definition.overrideOutlineRadius)??8,background:a==null?void 0:a.definition.backgroundColor}}):null})}indicator(t){const r=y.useMemo(()=>K0(t.props.url),[t.props.url]);return x.jsx("rect",{width:et(t.props.w),height:et(t.props.h),rx:(r==null?void 0:r.definition.overrideOutlineRadius)??8,ry:(r==null?void 0:r.definition.overrideOutlineRadius)??8})}}$(FO,"type","embed"),$(FO,"props",C8e),$(FO,"migrations",x8e);function ZNt({id:n,file:e,isInteractive:t,width:r,height:i,style:o,pageRotation:s}){return x.jsx("iframe",{className:"tl-embed",draggable:!1,width:et(r),height:et(i),frameBorder:"0",scrolling:"no",seamless:!0,referrerPolicy:"no-referrer-when-downgrade",style:{...o,pointerEvents:t?"all":"none",zIndex:t?"":"-1",boxShadow:Lie(s)},srcDoc:`
			<html>
				<head>
					<base target="_blank">
				</head>
				<body>
					<script src=${`https://gist.github.com/${n}.js${e?`?file=${e}`:""}`}><\/script>
					<style type="text/css">
						* { margin: 0px; }
						table { height: 100%; background-color: red; }
						.gist { background-color: none; height: 100%;  }
						.gist .gist-file { height: calc(100vh - 2px); padding: 0px; display: grid; grid-template-rows: 1fr auto; }
					</style>
				</body>
			</html>`})}const XNt=y.forwardRef(({id:n,name:e,isEditing:t},r)=>{const i=ot(),o=y.useCallback(c=>{c.key==="Enter"&&!c.nativeEvent.isComposing&&(Wc(c),c.currentTarget.blur(),i.setEditingShape(null))},[i]),s=y.useCallback(c=>{const l=i.getShape(n);if(!l)return;const u=l.props.name,d=c.currentTarget.value.trim();u!==d&&i.updateShapes([{id:n,type:"frame",props:{name:d}}])},[n,i]),a=y.useCallback(c=>{const l=i.getShape(n);if(!l)return;const u=l.props.name,d=c.currentTarget.value;u!==d&&i.updateShapes([{id:n,type:"frame",props:{name:d}}])},[n,i]);return x.jsxs("div",{className:`tl-frame-label ${t?"tl-frame-label__editing":""}`,children:[x.jsx("input",{className:"tl-frame-name-input",ref:r,style:{display:t?void 0:"none"},value:e,autoFocus:!0,onKeyDown:o,onBlur:s,onChange:a}),bLe(e,"Frame")+"​"]})}),YNt=function({id:e,name:t,width:r,height:i}){const o=ot(),s=_t("shape rotation",()=>ay(o.getShapePageTransform(e).rotation()),[o,e]),a=$N(e),c=y.useRef(null),l=y.useCallback(p=>{const g=Bu(p);o.getEditingShapeId()!==e&&(o.dispatch({type:"pointer",name:"pointer_down",target:"shape",shape:o.getShape(e),...g}),p.preventDefault())},[o,e]);y.useEffect(()=>{const p=c.current;p&&a&&(p.focus(),p.select())},[c,a]);const d=((s+Math.PI/4)*(2/Math.PI)+4)%4,h=["top","left","bottom","right"][Math.floor(d)];let f;switch(h){case"top":f="";break;case"right":f=`translate(${et(r)}px, 0px) rotate(90deg)`;break;case"bottom":f=`translate(${et(r)}px, ${et(i)}px) rotate(180deg)`;break;case"left":f=`translate(0px, ${et(i)}px) rotate(270deg)`;break}return x.jsx("div",{className:"tl-frame-heading",style:{overflow:a?"visible":"hidden",maxWidth:`calc(var(--tl-zoom) * ${Math.ceil(h==="top"||h==="bottom"?r:i)}px + var(--space-5))`,bottom:"100%",transform:`${f} scale(var(--tl-scale)) translateX(calc(-1 * var(--space-3))`},onPointerDown:l,children:x.jsx("div",{className:"tl-frame-heading-hit-area",children:x.jsx(XNt,{ref:c,id:e,name:t,isEditing:a})})})};function bLe(n,e){return n.match(/^\s*$/)?e:n}class jO extends vE{constructor(){super(...arguments);$(this,"canEdit",()=>!0);$(this,"canReceiveNewChildrenOfType",(t,r)=>!t.isLocked);$(this,"canDropShapes",(t,r)=>!t.isLocked);$(this,"onDragShapesOver",(t,r)=>{r.every(i=>i.parentId===t.id)||this.editor.reparentShapes(r,t.id)});$(this,"onDragShapesOut",(t,r)=>{const i=this.editor.getShape(t.parentId);i&&this.editor.isShapeOfType(i,"group")?this.editor.reparentShapes(r,i.id):this.editor.reparentShapes(r,this.editor.getCurrentPageId())});$(this,"onResize",(t,r)=>q$e(t,r))}getDefaultProps(){return{w:160*2,h:90*2,name:""}}getGeometry(t){return new hv({width:t.props.w,height:t.props.h,isFilled:!1})}component(t){const r=this.editor.getShapeGeometry(t).bounds,i=Zh(),o=_t("is creating this shape",()=>{const s=this.editor.getStateDescendant("select.resizing");if(!s||!s.getIsActive())return!1;const a=s==null?void 0:s.info;return a?a.isCreating&&this.editor.getOnlySelectedShapeId()===t.id:!1},[t.id]);return x.jsxs(x.Fragment,{children:[x.jsx(ky,{children:x.jsx("rect",{className:Ue("tl-frame__body",{"tl-frame__creating":o}),width:r.width,height:r.height,fill:i.solid,stroke:i.text})}),o?null:x.jsx(YNt,{id:t.id,name:t.props.name,width:r.width,height:r.height})]})}toSvg(t,r){const i=xv({isDarkMode:r.isDarkMode}),a=((ay(this.editor.getShapePageTransform(t.id).rotation())+Math.PI/4)*(2/Math.PI)+4)%4,c=Math.floor(a);let l;switch(c){case 0:l="";break;case 3:l=`translate(${et(t.props.w)}, 0) rotate(90)`;break;case 2:l=`translate(${et(t.props.w)}, ${et(t.props.h)}) rotate(180)`;break;case 1:l=`translate(0, ${et(t.props.h)}) rotate(270)`;break;default:throw Error("labelSide out of bounds")}const u={fontSize:12,fontFamily:"Inter, sans-serif",textAlign:"start",width:t.props.w,height:32,padding:0,lineHeight:1,fontStyle:"normal",fontWeight:"normal",overflow:"truncate-ellipsis",verticalTextAlign:"middle"},d=this.editor.textMeasure.measureTextSpans(bLe(t.props.name,"Frame")+"​",u),h=d[0],f=Mc(d),p=f.box.w+f.box.x-h.box.x,g=fX(this.editor,d,{offsetY:-u.height-2,...u});return x.jsxs(x.Fragment,{children:[x.jsx("rect",{width:t.props.w,height:t.props.h,fill:i.solid,stroke:i.black.solid,strokeWidth:1,rx:1,ry:1}),x.jsxs("g",{transform:l,children:[x.jsx("rect",{x:-8,y:-u.height-4,width:p+16,height:u.height,fill:i.background,rx:4,ry:4}),g]})]})}indicator(t){const r=this.editor.getShapeGeometry(t).bounds;return x.jsx("rect",{width:et(r.width),height:et(r.height),className:"tl-frame-indicator"})}providesBackgroundForChildren(){return!0}}$(jO,"type","frame"),$(jO,"props",E8e),$(jO,"migrations",I8e);function u1e(n,e){return n>e?(Ai*(e/2)+(n-e))*2:(Ai*(n/2)+(e-n))*2}function SLe(n,e){return Fie(n,e).map((t,r)=>t.getSvgPathData(r===0)).join(" ")+" Z"}function JNt(n,e,t,r){const i=n/4,o=e/4,s=ip(r),a=t*.75,c=b=>b.addXY(s()*a,s()*a),l=new H(n/2,e),u=new H(0,o*1.2),d=new H(n/2,o*.9),h=new H(n,o*1.2),f=c(new H(n/2,e)),p=c(new H(0,o*1.2)),g=c(new H(n/2,o*.9)),m=c(new H(n,o*1.2));return[new hl({start:l,cp1:new H(i*1.5,o*3),cp2:new H(0,o*2.5),end:u}),new hl({start:u,cp1:new H(0,-o*.32),cp2:new H(i*1.85,-o*.32),end:d}),new hl({start:d,cp1:new H(i*2.15,-o*.32),cp2:new H(n,-o*.32),end:h}),new hl({start:h,cp1:new H(n,o*2.5),cp2:new H(i*2.5,o*3),end:f}),new hl({start:f,cp1:new H(i*1.5,o*3),cp2:new H(0,o*2.5),end:p}),new hl({start:p,cp1:new H(0,-o*.32),cp2:new H(i*1.85,-o*.32),end:g}),new hl({start:g,cp1:new H(i*2.15,-o*.32),cp2:new H(n,-o*.32),end:m}),new hl({start:m,cp1:new H(n,o*2.5),cp2:new H(i*2.5,o*3),end:l})].map((b,S)=>b.getSvgPathData(S===0)).join(" ")+" Z"}function Fie(n,e){const t=n/4,r=e/4;return[new hl({start:new H(n/2,e),cp1:new H(t*1.5,r*3),cp2:new H(0,r*2.5),end:new H(0,r*1.2)}),new hl({start:new H(0,r*1.2),cp1:new H(0,-r*.32),cp2:new H(t*1.85,-r*.32),end:new H(n/2,r*.9)}),new hl({start:new H(n/2,r*.9),cp1:new H(t*2.15,-r*.32),cp2:new H(n,-r*.32),end:new H(n,r*1.2)}),new hl({start:new H(n,r*1.2),cp1:new H(n,r*2.5),cp2:new H(t*2.5,r*3),end:new H(n/2,e)})]}function QNt(n){return{size:1+n,thinning:.25,end:{taper:n},start:{taper:n},streamline:0,smoothing:1,simulatePressure:!1}}function eFt(n,e,t,r){const i=ip(n),o=e/2,s=t/2,a=V8e(o,s),c=[],l=Xi*i(),u=Xi+Fo/2+Math.abs(i())*Fo,d=Math.max(16,a/10);for(let h=0;h<d;h++){const f=h/(d-1),p=l+f*u,g=Math.cos(p),m=Math.sin(p);c.push(new H(o*g+e*.5+.05*i(),s*m+t/2+.05*i(),Math.min(1,.5+Math.abs(.5-(i()>0?uc.easeInOutSine(f):uc.easeInExpo(f)))/2)))}return Sg(c,QNt(r))}function tFt(n,e,t,r){return qS(eFt(n,e,t,r))}function mX(n){let e="M";const t=n.length;let r,i,o;for(let s=0,a=t;s<a;s+=3)r=n[s],i=n[s+1],o=n[s+2],e+=`${Di(r)}L${Di(i)}Q${Di(o)}`;return e+=`${Di(n[0])}`,e}function vX(n,e,t,r,i){const o=[],s=ip(n);let a=e[0],c;const l=e.length;for(let u=0,d=l*i;u<d;u++){c=H.AddXY(e[(u+1)%l],s()*t,s()*t);const h=H.Sub(c,a),f=H.Len(h),p=H.Div(h,f).mul(Math.min(f/4,r));o.push(H.Add(a,p),H.Add(c,p.neg()),c),a=c}return o}function nFt(n,e,t){const r=Math.min(n,e)/2,i=Math.max(n,e)-r*2,s=(Math.PI*(r*2)+2*i)/t,a=n>e?[{type:"straight",start:new H(r,0),delta:new H(1,0)},{type:"arc",center:new H(n-r,r),startAngle:-Ai/2},{type:"straight",start:new H(n-r,e),delta:new H(-1,0)},{type:"arc",center:new H(r,r),startAngle:Ai/2}]:[{type:"straight",start:new H(n,r),delta:new H(0,1)},{type:"arc",center:new H(r,e-r),startAngle:0},{type:"straight",start:new H(0,e-r),delta:new H(0,-1)},{type:"arc",center:new H(r,r),startAngle:Ai}];let c=0;const l=[];for(let u=0;u<t;u++){const d=a[0];d.type==="straight"?l.push(H.Add(d.start,H.Mul(d.delta,c))):l.push(VS(d.center,r,d.startAngle+c/r)),c+=s;let h=d.type==="straight"?i:Ai*r;for(;c>h;)c-=h,a.push(a.shift()),h=a[0].type==="straight"?i:Ai*r}return l}const rFt={s:50,m:70,l:100,xl:130},iFt=.2;function BN(n,e,t,r){const i=ip(t),o=u1e(n,e),s=Math.max(Math.ceil(o/rFt[r]),6,Math.ceil(o/Math.min(n,e))),a=o/s*iFt,c=Math.max(n-a*2,1),l=Math.max(e-a*2,1),d=u1e(c,l)/s,h=(n-c)/2,f=(e-l)/2,p=nFt(c,l,s).map(S=>S.addXY(h,f)),g=n<20?0:a*.3,m=e<20?0:a*.3,v=p.slice(0);for(let S=0;S<Math.floor(s/2);S++)v[S]=H.AddXY(v[S],i()*g,i()*m),v[s-S-1]=H.AddXY(v[s-S-1],i()*g,i()*m);const b=[];for(let S=0;S<v.length;S++){const E=S===v.length-1?0:S+1,w=v[S],C=v[E],I=p[S],T=p[E],D=H.Dist(I,T),O=d-D,R=H.Dist(w,C)/D,A=(Math.max(h,f)+O)*R,k=H.Lrp(I,T,.5).add(H.Sub(T,I).uni().per().mul(A));k.x<0?k.x=0:k.x>n&&(k.x=n),k.y<0?k.y=0:k.y>e&&(k.y=e);const L=die(w,C,k),j=H.Dist(L||H.Average([w,C]),w);b.push({leftPoint:w,rightPoint:C,arcPoint:k,center:L,radius:j})}return b}function oFt(n,e,t,r){const i=[],o=BN(n,e,t,r);for(const{center:s,radius:a,leftPoint:c,rightPoint:l}of o)i.push(...pMt(c,l,s,a,10));return i}function yX(n,e,t,r){const i=BN(n,e,t,r);let o=`M${i[0].leftPoint.toFixed()}`;for(const{leftPoint:s,rightPoint:a,radius:c,center:l}of i){if(l===null){o+=` L${a.toFixed()}`;continue}const u=H.Clockwise(s,a,l)?"0":"1";o+=` A${et(c)},${et(c)} 0 ${u},1 ${a.toFixed()}`}return o+=" Z",o}const sFt={s:.5,m:.7,l:.9,xl:1.6};function aFt(n,e,t,r){const i=ip(t),o=sFt[r],s=BN(n,e,t,r),l=s.reduce((f,p)=>f+H.Dist2(p.leftPoint,p.rightPoint),0)/s.length>(o*15)**2?f=>f.addXY(i()*o*2,i()*o*2):f=>f;let u=`M${s[0].leftPoint.toFixed()}`,d=l(s[0].leftPoint),h=`M${d.toFixed()}`;for(const{leftPoint:f,center:p,rightPoint:g,radius:m,arcPoint:v}of s){if(p===null){u+=` L${g.toFixed()}`;const I=l(g);h+=` L${I.toFixed()}`,d=I;continue}const b=H.Clockwise(f,g,p)?"0":"1";u+=` A${et(m)},${et(m)} 0 ${b},1 ${g.toFixed()}`;const S=l(g),E=l(v),w=die(d,S,E);if(!Number.isFinite(w.x)||!Number.isFinite(w.y)){h+=` L${S.toFixed()}`,d=S;continue}const C=Math.abs(H.Dist(w,d));h+=` A${et(C)},${et(C)} 0 ${b},1 ${S.toFixed()}`,d=S}return u+h+" Z"}function bX(n,e){switch(n.geo){case"x-box":return cFt(n.w,n.h,e,n.dash);case"check-box":return lFt(n.w,n.h);default:return}}function cFt(n,e,t,r){const i=r==="draw"?.62:0;if(r==="dashed")return[[new H(0,0),new H(n/2,e/2)],[new H(n,e),new H(n/2,e/2)],[new H(0,e),new H(n/2,e/2)],[new H(n,0),new H(n/2,e/2)]];const o=a=>Math.max(0,Math.min(n,a)),s=a=>Math.max(0,Math.min(e,a));return[[new H(o(t*i),s(t*i)),new H(o(n-t*i),s(e-t*i))],[new H(o(t*i),s(e-t*i)),new H(o(n-t*i),s(t*i))]]}function lFt(n,e){const t=Math.min(n,e)*.82,r=(n-t)/2,i=(e-t)/2,o=a=>Math.max(0,Math.min(n,a)),s=a=>Math.max(0,Math.min(e,a));return[[new H(o(r+t*.25),s(i+t*.52)),new H(o(r+t*.45),s(i+t*.82))],[new H(o(r+t*.45),s(i+t*.82)),new H(o(r+t*.82),s(i+t*.22))]]}function d1e({shape:n,shouldScale:e}){const t=e?n.props.scale:1,r=ot(),i=Zh(),{id:o,props:s}=n,{w:a,color:c,fill:l,dash:u,growY:d,size:h}=s,f=dc[h]*t,p=s.h+d;switch(s.geo){case"cloud":if(u==="solid"){const g=yX(a,p,o,h);return x.jsxs(x.Fragment,{children:[x.jsx(sl,{theme:i,d:g,color:c,fill:l,scale:t}),x.jsx("path",{d:g,stroke:i[c].solid,strokeWidth:f,fill:"none"})]})}else if(u==="draw"){const g=aFt(a,p,o,h);return x.jsxs(x.Fragment,{children:[x.jsx(sl,{theme:i,d:g,color:c,fill:l,scale:t}),x.jsx("path",{d:g,stroke:i[c].solid,strokeWidth:f,fill:"none"})]})}else{const g=yX(a,p,o,h),m=BN(a,p,o,h);return x.jsxs(x.Fragment,{children:[x.jsx(sl,{theme:i,d:g,color:c,fill:l,scale:t}),x.jsx("g",{strokeWidth:f,stroke:i[c].solid,fill:"none",pointerEvents:"all",children:m.map(({leftPoint:v,rightPoint:b,center:S,radius:E},w)=>{const C=S?E*ay(ay(H.Angle(S,b))-ay(H.Angle(S,v))):H.Dist(v,b),{strokeDasharray:I,strokeDashoffset:T}=Lp(C,f,{style:u,start:"outset",end:"outset"});return x.jsx("path",{d:S?`M${v.x},${v.y}A${E},${E},0,0,1,${b.x},${b.y}`:`M${v.x},${v.y}L${b.x},${b.y}`,strokeDasharray:I,strokeDashoffset:T},w)})})]})}case"ellipse":{const g=e?r.getShapeGeometry(n):r.getShapeUtil(n).getGeometry(n),m=g.getSvgPathData(!0);if(u==="dashed"||u==="dotted"){const v=g.length,{strokeDasharray:b,strokeDashoffset:S}=Lp(v<64?v*2:v,f,{style:u,snap:4,closed:!0});return x.jsxs(x.Fragment,{children:[x.jsx(sl,{theme:i,d:m,color:c,fill:l,scale:t}),x.jsx("path",{d:m,strokeWidth:f,fill:"none",stroke:i[c].solid,strokeDasharray:b,strokeDashoffset:S})]})}else{const b=(e?r.getShapeGeometry(n):r.getShapeUtil(n).getGeometry(n)).getSvgPathData(!0);return x.jsxs(x.Fragment,{children:[x.jsx(sl,{theme:i,d:b,color:c,fill:l,scale:t}),x.jsx("path",{d:b,stroke:i[c].solid,strokeWidth:f,fill:"none"})]})}}case"oval":{const g=e?r.getShapeGeometry(n):r.getShapeUtil(n).getGeometry(n),m=g.getSvgPathData(!0);if(u==="dashed"||u==="dotted"){const v=g.getLength(),{strokeDasharray:b,strokeDashoffset:S}=Lp(v<64?v*2:v,f,{style:u,snap:4,start:"outset",end:"outset",closed:!0});return x.jsxs(x.Fragment,{children:[x.jsx(sl,{theme:i,d:m,color:c,fill:l,scale:t}),x.jsx("path",{d:m,strokeWidth:f,fill:"none",stroke:i[c].solid,strokeDasharray:b,strokeDashoffset:S})]})}else return x.jsxs(x.Fragment,{children:[x.jsx(sl,{theme:i,d:m,color:c,fill:l,scale:t}),x.jsx("path",{d:m,stroke:i[c].solid,strokeWidth:f,fill:"none"})]})}case"heart":if(u==="dashed"||u==="dotted"||u==="solid"){const g=SLe(a,p),m=Fie(a,p);return x.jsxs(x.Fragment,{children:[x.jsx(sl,{theme:i,d:g,color:c,fill:l,scale:t}),m.map((v,b)=>{const{strokeDasharray:S,strokeDashoffset:E}=Lp(v.length,f,{style:u,snap:1,start:"outset",end:"outset",closed:!0});return x.jsx("path",{d:v.getSvgPathData(),strokeWidth:f,fill:"none",stroke:i[c].solid,strokeDasharray:S,strokeDashoffset:E,pointerEvents:"all"},`curve_${b}`)})]})}else{const g=JNt(a,p,f,n.id);return x.jsxs(x.Fragment,{children:[x.jsx(sl,{theme:i,d:g,color:c,fill:l,scale:t}),x.jsx("path",{d:g,stroke:i[c].solid,strokeWidth:f,fill:"none"})]})}default:{const g=e?r.getShapeGeometry(n):r.getShapeUtil(n).getGeometry(n),m=g instanceof Qf?g.children[0].vertices:g.vertices,v=bX(n.props,f);if(u==="solid"){let b="M"+m[0]+"L"+m.slice(1)+"Z";if(v)for(const[S,E]of v)b+=`M${S.x},${S.y}L${E.x},${E.y}`;return x.jsxs(x.Fragment,{children:[x.jsx(sl,{theme:i,d:b,color:c,fill:l,scale:t}),x.jsx("path",{d:b,stroke:i[c].solid,strokeWidth:f,fill:"none"})]})}else if(u==="dashed"||u==="dotted"){const b="M"+m[0]+"L"+m.slice(1)+"Z";return x.jsxs(x.Fragment,{children:[x.jsx(sl,{theme:i,d:b,color:c,fill:l,scale:t}),x.jsxs("g",{strokeWidth:f,stroke:i[c].solid,fill:"none",pointerEvents:"all",children:[Array.from(Array(m.length)).map((S,E)=>{const w=H.ToFixed(m[E]),C=H.ToFixed(m[(E+1)%m.length]),I=H.Dist(w,C),{strokeDasharray:T,strokeDashoffset:D}=Lp(I,f,{style:u,start:"outset",end:"outset"});return x.jsx("line",{x1:w.x,y1:w.y,x2:C.x,y2:C.y,strokeDasharray:T,strokeDashoffset:D},E)}),v&&v.map(([S,E],w)=>{const C=H.Dist(S,E),{strokeDasharray:I,strokeDashoffset:T}=Lp(C,f,{style:u,start:"skip",end:"skip",snap:u==="dotted"?4:void 0});return x.jsx("path",{d:`M${S.x},${S.y}L${E.x},${E.y}`,stroke:i[c].solid,strokeWidth:f,fill:"none",strokeDasharray:I,strokeDashoffset:T},`line_fg_${w}`)})]})]})}else if(u==="draw"){let b=mX(vX(o,m,f/3,f*2,2));if(v)for(const[E,w]of v)b+=`M${E.toFixed()}L${w.toFixed()}`;const S=mX(vX(o,m,0,f*2,1));return x.jsxs(x.Fragment,{children:[x.jsx(sl,{theme:i,d:S,color:c,fill:l,scale:t}),x.jsx("path",{d:b,stroke:i[c].solid,strokeWidth:f,fill:"none"})]})}}}}const mh=17*3;class BO extends vE{constructor(){super(...arguments);$(this,"canEdit",()=>!0);$(this,"onEditEnd",t=>{const{id:r,type:i,props:{text:o}}=t;o.trimEnd()!==t.props.text&&this.editor.updateShapes([{id:r,type:i,props:{text:o.trimEnd()}}])});$(this,"onResize",(t,{handle:r,newPoint:i,scaleX:o,scaleY:s,initialShape:a})=>{let c=a.props.w*o,l=(a.props.h+a.props.growY)*s,u=0,d=0;if(t.props.text.trim()){let g=Math.max(Math.abs(c),mh),m=Math.max(Math.abs(l),mh);g<mh&&m===mh&&(g=mh),g===mh&&m<mh&&(m=mh);const v=pA(this.editor,{...t,props:{...t.props,w:g,h:m}}),b=Math.max(Math.abs(c),v.w)*Math.sign(c),S=Math.max(Math.abs(l),v.h)*Math.sign(l);u=Math.abs(b)-Math.abs(c),d=Math.abs(S)-Math.abs(l),c=b,l=S}const h=new H(0,0);o<0&&(h.x+=c),(r==="left"||r==="top_left"||r==="bottom_left")&&(h.x+=o<0?u:-u),s<0&&(h.y+=l),(r==="top"||r==="top_left"||r==="top_right")&&(h.y+=s<0?d:-d);const{x:f,y:p}=h.rot(t.rotation).add(i);return{x:f,y:p,props:{w:Math.max(Math.abs(c),1),h:Math.max(Math.abs(l),1),growY:0}}});$(this,"onBeforeCreate",t=>{if(!t.props.text)return t.props.growY?{...t,props:{...t.props,growY:0}}:void 0;const r=t.props.h,i=pA(this.editor,t).h;let o=null;if(i>r?o=i-r:t.props.growY&&(o=0),o!==null)return{...t,props:{...t.props,growY:o}}});$(this,"onBeforeUpdate",(t,r)=>{const i=t.props.text,o=r.props.text;if(i===o&&t.props.font===r.props.font&&t.props.size===r.props.size)return;if(i&&!o)return{...r,props:{...r.props,growY:0}};const s=t.props.w,a=t.props.h,c=pA(this.editor,r),l=c.w,u=c.h;if(!i&&o&&o.length===1){let h=Math.max(s,l),f=Math.max(a,u);return t.props.w<mh&&t.props.h<mh&&(h=Math.max(h,mh),f=Math.max(f,mh),h=Math.max(h,f),f=Math.max(h,f)),{...r,props:{...r.props,w:h,h:f,growY:0}}}let d=null;if(u>a?d=u-a:t.props.growY&&(d=0),d!==null)return{...r,props:{...r.props,growY:d,w:Math.max(r.props.w,l)}};if(l>t.props.w)return{...r,props:{...r.props,w:l}}});$(this,"onDoubleClick",t=>{if(this.editor.inputs.altKey)switch(t.props.geo){case"rectangle":return{...t,props:{geo:"check-box"}};case"check-box":return{...t,props:{geo:"rectangle"}}}})}getDefaultProps(){return{w:100,h:100,geo:"rectangle",color:"black",labelColor:"black",fill:"none",dash:"draw",size:"m",font:"draw",text:"",align:"middle",verticalAlign:"middle",growY:0,url:"",scale:1}}getGeometry(t){const r=Math.max(1,t.props.w),i=Math.max(1,t.props.h+t.props.growY),o=r/2,s=i/2,a=dc[t.props.size]*t.props.scale,c=t.props.fill!=="none";let l;switch(t.props.geo){case"cloud":{l=new Ys({points:oFt(r,i,t.id,t.props.size),isFilled:c});break}case"triangle":{l=new Ys({points:[new H(o,0),new H(r,i),new H(0,i)],isFilled:c});break}case"diamond":{l=new Ys({points:[new H(o,0),new H(r,s),new H(o,i),new H(0,s)],isFilled:c});break}case"pentagon":{l=new Ys({points:EU(r,i,5),isFilled:c});break}case"hexagon":{l=new Ys({points:EU(r,i,6),isFilled:c});break}case"octagon":{l=new Ys({points:EU(r,i,8),isFilled:c});break}case"ellipse":{l=new NLt({width:r,height:i,isFilled:c});break}case"oval":{l=new FLt({width:r,height:i,isFilled:c});break}case"star":{const b=Xi/5/2,S=Math.floor(5/4)*2,E=5*2-S,w=0,C=Math.floor(5/2)*2,I=Math.cos(-Fo+S*b)*r/2,T=Math.cos(-Fo+E*b)*r/2,D=Math.sin(-Fo+w*b)*i/2,O=Math.sin(-Fo+C*b)*i/2,M=r-Math.abs(I-T),R=i-Math.abs(O-D),A=r/2+T-(r/2-I),k=i/2+D-(i/2-O),L=1,j=(r-A)/2,N=(i-k)/2,B=(r+M)/2,U=(i+R)/2,K=B*L/2,z=U*L/2;l=new Ys({points:Array.from(Array(5*2)).map((G,te)=>{const ie=-Fo+te*b;return new H(j+(te%2?K:B)*Math.cos(ie),N+(te%2?z:U)*Math.sin(ie))}),isFilled:c});break}case"rhombus":{const v=Math.min(r*.38,i*.38);l=new Ys({points:[new H(v,0),new H(r,0),new H(r-v,i),new H(0,i)],isFilled:c});break}case"rhombus-2":{const v=Math.min(r*.38,i*.38);l=new Ys({points:[new H(0,0),new H(r-v,0),new H(r,i),new H(v,i)],isFilled:c});break}case"trapezoid":{const v=Math.min(r*.38,i*.38);l=new Ys({points:[new H(v,0),new H(r-v,0),new H(r,i),new H(0,i)],isFilled:c});break}case"arrow-right":{const v=Math.min(r,i)*.38,b=i*.16;l=new Ys({points:[new H(0,b),new H(r-v,b),new H(r-v,0),new H(r,i/2),new H(r-v,i),new H(r-v,i-b),new H(0,i-b)],isFilled:c});break}case"arrow-left":{const v=Math.min(r,i)*.38,b=i*.16;l=new Ys({points:[new H(v,0),new H(v,b),new H(r,b),new H(r,i-b),new H(v,i-b),new H(v,i),new H(0,i/2)],isFilled:c});break}case"arrow-up":{const v=r*.16,b=Math.min(r,i)*.38;l=new Ys({points:[new H(r/2,0),new H(r,b),new H(r-v,b),new H(r-v,i),new H(v,i),new H(v,b),new H(0,b)],isFilled:c});break}case"arrow-down":{const v=r*.16,b=Math.min(r,i)*.38;l=new Ys({points:[new H(v,0),new H(r-v,0),new H(r-v,i-b),new H(r,i-b),new H(r/2,i),new H(0,i-b),new H(v,i-b)],isFilled:c});break}case"check-box":case"x-box":case"rectangle":{l=new hv({width:r,height:i,isFilled:c});break}case"heart":{const b=Fie(r,i).reduce((S,E)=>(S.push(...E.vertices),S),[]);l=new Ys({points:b,isFilled:c});break}default:vl(t.props.geo)}const u=pA(this.editor,t),d=Math.min(100,r/2),h=Math.min(Xm[t.props.size]*t.props.scale*qc.lineHeight+xf*2,i/2),f=Math.min(r,Math.max(u.w,Math.min(d,Math.max(1,r-8)))),p=Math.min(i,Math.max(u.h,Math.min(h,Math.max(1,r-8)))),g=bX(t.props,a),m=g?g.map(v=>new mE({points:v})):[];return new Qf({children:[l,new hv({x:t.props.align==="start"?0:t.props.align==="end"?r-f:(r-f)/2,y:t.props.verticalAlign==="start"?0:t.props.verticalAlign==="end"?i-p:(i-p)/2,width:f,height:p,isFilled:!0,isLabel:!0}),...m]})}getHandleSnapGeometry(t){const r=this.getGeometry(t),i=r.children[0];switch(t.props.geo){case"arrow-down":case"arrow-left":case"arrow-right":case"arrow-up":case"check-box":case"diamond":case"hexagon":case"octagon":case"pentagon":case"rectangle":case"rhombus":case"rhombus-2":case"star":case"trapezoid":case"triangle":case"x-box":return{outline:i,points:[...i.getVertices(),r.bounds.center]};case"cloud":case"ellipse":case"heart":case"oval":return{outline:i,points:[r.bounds.center]};default:vl(t.props.geo)}}component(t){const{id:r,type:i,props:o}=t,{fill:s,font:a,align:c,verticalAlign:l,size:u,text:d}=o,h=t.id===this.editor.getOnlySelectedShapeId(),f=Zh(),g=this.editor.getEditingShapeId()!==null||t.props.text;return x.jsxs(x.Fragment,{children:[x.jsx(ky,{id:r,children:x.jsx(d1e,{shape:t,shouldScale:!0})}),g&&x.jsx(WS,{style:{overflow:"hidden",width:t.props.w,height:t.props.h+o.growY},children:x.jsx(jN,{id:r,type:i,font:a,fontSize:Xm[u]*t.props.scale,lineHeight:qc.lineHeight,padding:16*t.props.scale,fill:s,align:c,verticalAlign:l,text:d,isSelected:h,labelColor:f[o.labelColor].solid,wrap:!0})}),t.props.url&&x.jsx(ux,{url:t.props.url,zoomLevel:this.editor.getZoomLevel()})]})}indicator(t){const{id:r,props:i}=t,{w:o,size:s}=i,a=i.h+i.growY,c=dc[s],l=this.editor.getShapeGeometry(t);switch(i.geo){case"ellipse":return i.dash==="draw"?x.jsx("path",{d:tFt(r,o,a,c)}):x.jsx("path",{d:l.getSvgPathData(!0)});case"heart":return x.jsx("path",{d:SLe(o,a)});case"oval":return x.jsx("path",{d:l.getSvgPathData(!0)});case"cloud":return x.jsx("path",{d:yX(o,a,r,s)});default:{const u=this.editor.getShapeGeometry(t),d=u instanceof Qf?u.children[0].vertices:u.vertices;let h;if(i.dash==="draw"){const p=vX(r,d,0,c*2*t.props.scale,1);h=mX(p)}else h="M"+d[0]+"L"+d.slice(1)+"Z";const f=bX(t.props,c);if(f)for(const[p,g]of f)h+=`M${p.x},${p.y}L${g.x},${g.y}`;return x.jsx("path",{d:h})}}}toSvg(t,r){const i={...t,props:{...t.props,w:t.props.w/t.props.scale,h:t.props.h/t.props.scale}},o=i.props;r.addExportDef(Oie(o.fill));let s;if(o.text){r.addExportDef(lx(o.font));const a=xv(r),c=new xn(0,0,o.w,o.h+o.growY);s=x.jsx(FN,{fontSize:Xm[o.size],font:o.font,align:o.align,verticalAlign:o.verticalAlign,text:o.text,labelColor:a[o.labelColor].solid,bounds:c,padding:16})}return x.jsxs(x.Fragment,{children:[x.jsx(d1e,{shouldScale:!1,shape:i}),s]})}getCanvasSvgDefs(){return[Mie()]}}$(BO,"type","geo"),$(BO,"props",P8e),$(BO,"migrations",k8e);function pA(n,e){const t=e.props.text;if(!t)return{w:0,h:0};const r=n.textMeasure.measureText("w",{...qc,fontFamily:sg[e.props.font],fontSize:Xm[e.props.size]*e.props.scale,maxWidth:100}),i={s:2,m:3.5,l:5,xl:10},o=n.textMeasure.measureText(t,{...qc,fontFamily:sg[e.props.font],fontSize:Xm[e.props.size]*e.props.scale,minWidth:r.w,maxWidth:Math.max(0,Math.ceil(r.w+i[e.props.size]),Math.ceil(e.props.w-xf*2))});return{w:o.w+xf*2,h:o.h+xf*2}}function uFt(){const[n,e]=y.useState(!1);return y.useEffect(()=>{const r=CSS.supports("color","color(display-p3 1 1 1)"),i=matchMedia("(color-gamut: p3)");e(r&&i.matches);const o=()=>e(r&&i.matches);return i.addEventListener("change",o),()=>i.removeEventListener("change",o)},[]),_t(ta.forceSrgb)||!n?"srgb":"p3"}const h1e=.35,f1e=.82;class HO extends qf{constructor(){super(...arguments);$(this,"hideResizeHandles",t=>gA(t));$(this,"hideRotateHandle",t=>gA(t));$(this,"hideSelectionBoundsFg",t=>gA(t));$(this,"onResize",(t,r)=>{const{scaleX:i,scaleY:o}=r,s=[];for(const a of t.props.segments)s.push({...a,points:a.points.map(({x:c,y:l,z:u})=>({x:i*c,y:o*l,z:u}))});return{props:{segments:s}}})}getDefaultProps(){return{segments:[],color:"black",size:"m",isComplete:!1,isPen:!1,scale:1}}getGeometry(t){const r=Qb(t);if(gA(t))return new Tie({x:-r/2,y:-r/2,radius:r/2,isFilled:!0});const{strokePoints:i,sw:o}=p1e(t,r,!0),s=Nie({strokeWidth:o,showAsComplete:!0});return LN(i,s),new Ys({points:Die(i,s),isFilled:!0})}component(t){const r=KU(this.editor,t),i=Qb(t);return x.jsx(ky,{id:t.id,children:x.jsx(mA,{shape:t,forceSolid:r,strokeWidth:i,opacity:h1e})})}backgroundComponent(t){const r=KU(this.editor,t),i=Qb(t);return x.jsx(ky,{id:t.id,children:x.jsx(mA,{shape:t,forceSolid:r,strokeWidth:i,opacity:f1e})})}indicator(t){const r=KU(this.editor,t),i=Qb(t),{strokePoints:o,sw:s}=p1e(t,i,r),a=dx(t.props.segments);let c;return o.length<2?c=hFt(a[0],s):c=qS(o,!1),x.jsx("path",{d:c})}toSvg(t){const r=Qb(t),i=r<1.5,o=1/t.props.scale;return x.jsx("g",{transform:`scale(${o})`,children:x.jsx(mA,{forceSolid:i,strokeWidth:r,shape:t,opacity:h1e})})}toBackgroundSvg(t){const r=Qb(t),i=r<1.5,o=1/t.props.scale;return x.jsx("g",{transform:`scale(${o})`,children:x.jsx(mA,{forceSolid:i,strokeWidth:r,shape:t,opacity:f1e})})}}$(HO,"type","highlight"),$(HO,"props",R8e),$(HO,"migrations",A8e);function dFt(n){return`M ${n.x} ${n.y} m -${.1}, 0 a ${.1},${.1} 0 1,0 ${.1*2},0 a ${.1},${.1} 0 1,0 -${.1*2},0`}function hFt(n,e){const t=e/2;return`M ${n.x} ${n.y} m -${t}, 0 a ${t},${t} 0 1,0 ${t*2},0 a ${t},${t} 0 1,0 -${t*2},0`}function p1e(n,e,t){var c;const r=dx(n.props.segments),i=n.props.isComplete||((c=Mc(n.props.segments))==null?void 0:c.type)==="straight";let o=e;!t&&!n.props.isPen&&r.length===1&&(o+=ip(n.id)()*(e/6));const s=Nie({strokeWidth:o,showAsComplete:i});return{strokePoints:Sg(r,s),sw:o}}function Qb(n){return ax[n.props.size]*1.12*n.props.scale}function gA(n){return n.props.segments.length===1&&n.props.segments[0].points.length<2}function mA({strokeWidth:n,forceSolid:e,shape:t,opacity:r}){var h;const i=Zh(),o=dx(t.props.segments);let s=n;!e&&!t.props.isPen&&o.length===1&&(s+=ip(t.id)()*(s/6));const a=Nie({strokeWidth:s,showAsComplete:t.props.isComplete||((h=Mc(t.props.segments))==null?void 0:h.type)==="straight"}),c=Sg(o,a),l=c.length>1?qS(c,!1):dFt(t.props.segments[0].points[0]),u=uFt(),d=i[t.props.color].highlight[u];return x.jsx("path",{d:l,strokeLinecap:"round",fill:"none",pointerEvents:"all",stroke:d,strokeWidth:s,opacity:r})}function KU(n,e){return _t("forceSolid",()=>{const t=Qb(e),r=n.getZoomLevel();return t/r<1.5},[n])}function _Le(){return x.jsxs("svg",{width:"15",height:"15",viewBox:"0 0 30 30",xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",children:[x.jsx("path",{d:"M3,11 L3,3 11,3",strokeWidth:"2"}),x.jsx("path",{d:"M19,27 L27,27 L27,19",strokeWidth:"2"}),x.jsx("path",{d:"M27,3 L3,27",strokeWidth:"2"})]})}function wLe(n,e,t){const r=ot(),[i,o]=y.useState(null),s=e?r.getAsset(e):null,c=r.getCulledShapes().has(n),l=s&&"w"in s.props?t/s.props.w:1,u=_t("zoom level",()=>r.getZoomLevel()*l,[r,l]);return y.useEffect(()=>{if(c)return;let d=!1;const h=r.timers.setTimeout(async()=>{const f=await r.resolveAssetUrl(e,{screenScale:u});d||o(f)},500);return()=>{clearTimeout(h),d=!0}},[e,s==null?void 0:s.props.src,c,u,r]),{asset:s,url:i}}function CLe(){const[n,e]=y.useState(!1);return y.useEffect(()=>{const t=window.matchMedia("(prefers-reduced-motion: reduce)"),r=()=>{e(t.matches)};return r(),t.addEventListener("change",r),()=>t.removeEventListener("change",r)},[]),n}async function fFt(n){const t=await(await vg(n)).blob();return dS.blobToDataUrl(t)}class UO extends vE{constructor(){super(...arguments);$(this,"isAspectRatioLocked",()=>!0);$(this,"canCrop",()=>!0);$(this,"onDoubleClick",t=>{const r=t.props.assetId?this.editor.getAsset(t.props.assetId):void 0;!r||!(r.props.src&&this.isAnimated(t))||this.editor.updateShapes([{type:"image",id:t.id,props:{playing:!t.props.playing}}])});$(this,"onDoubleClickEdge",t=>{const r=t.props;if(!r||this.editor.getCroppingShapeId()!==t.id)return;const i=ls(r.crop)||{topLeft:{x:0,y:0},bottomRight:{x:1,y:1}},o=1/(i.bottomRight.x-i.topLeft.x)*t.props.w,s=1/(i.bottomRight.y-i.topLeft.y)*t.props.h,a=new H(i.topLeft.x*o,i.topLeft.y*s).rot(t.rotation),c={id:t.id,type:t.type,x:t.x-a.x,y:t.y-a.y,props:{crop:{topLeft:{x:0,y:0},bottomRight:{x:1,y:1}},w:o,h:s}};this.editor.updateShapes([c])})}getDefaultProps(){return{w:100,h:100,assetId:null,playing:!0,url:"",crop:null}}isAnimated(t){const r=t.props.assetId?this.editor.getAsset(t.props.assetId):void 0;return r?"mimeType"in r.props&&Zp.isAnimatedImageType(r==null?void 0:r.props.mimeType)||"isAnimated"in r.props&&r.props.isAnimated:!1}component(t){var g;const r=this.editor.getCroppingShapeId()===t.id,i=CLe(),[o,s]=y.useState(""),[a,c]=y.useState(""),l=t.id===this.editor.getOnlySelectedShapeId(),{asset:u,url:d}=wLe(t.id,t.props.assetId,t.props.w);if(y.useEffect(()=>{if(d){let m=!1;const v=rx();return v.onload=()=>{m||c(d)},v.src=d,()=>{m=!0}}},[d,t]),y.useEffect(()=>{if(d&&this.isAnimated(t)){let m=!1;const v=rx();return v.onload=()=>{if(m)return;const b=document.createElement("canvas");b.width=v.width,b.height=v.height;const S=b.getContext("2d");S&&(S.drawImage(v,0,0),s(b.toDataURL()),c(d))},v.crossOrigin="anonymous",v.src=d,()=>{m=!0}}},[i,d,t]),(u==null?void 0:u.type)==="bookmark")throw Error("Bookmark assets can't be rendered as images");const h=l&&r&&this.editor.isIn("select.crop"),f=i&&(((g=u==null?void 0:u.props.mimeType)==null?void 0:g.includes("video"))||this.isAnimated(t)),p=g1e(t);return u!=null&&u.props.src?a?x.jsxs(x.Fragment,{children:[h&&x.jsx("div",{style:p,children:x.jsx("img",{className:"tl-image",crossOrigin:this.isAnimated(t)?"anonymous":void 0,src:!t.props.playing||f?o:a,referrerPolicy:"strict-origin-when-cross-origin",style:{opacity:.1},draggable:!1})}),x.jsxs(WS,{id:t.id,style:{overflow:"hidden",width:t.props.w,height:t.props.h},children:[x.jsxs("div",{className:"tl-image-container",style:p,children:[x.jsx("img",{className:"tl-image",crossOrigin:this.isAnimated(t)?"anonymous":void 0,src:!t.props.playing||f?o:a,referrerPolicy:"strict-origin-when-cross-origin",draggable:!1}),this.isAnimated(t)&&!t.props.playing&&x.jsx("div",{className:"tl-image__tg",children:"GIF"})]}),t.props.url&&x.jsx(ux,{url:t.props.url,zoomLevel:this.editor.getZoomLevel()})]})]}):null:x.jsxs(WS,{id:t.id,style:{overflow:"hidden",width:t.props.w,height:t.props.h,color:"var(--color-text-3)",backgroundColor:u?"transparent":"var(--color-low)",border:u?"none":"1px solid var(--color-low-border)"},children:[x.jsx("div",{className:"tl-image-container",style:p,children:u?null:x.jsx(_Le,{})}),"url"in t.props&&t.props.url&&x.jsx(ux,{url:t.props.url,zoomLevel:this.editor.getZoomLevel()})]})}indicator(t){return this.editor.getCroppingShapeId()===t.id?null:x.jsx("rect",{width:et(t.props.w),height:et(t.props.h)})}async toSvg(t){if(!t.props.assetId||!this.editor.getAsset(t.props.assetId))return null;let i=await this.editor.resolveAssetUrl(t.props.assetId,{shouldResolveToOriginalImage:!0});if(!i)return null;(i.startsWith("blob:")||i.startsWith("http")||i.startsWith("/")||i.startsWith("./"))&&(i=await fFt(i)||"");const o=g1e(t),s=t.props.crop;if(o.transform&&s){const{transform:a,width:c,height:l}=o,u=(s.bottomRight.x-s.topLeft.x)*c,d=(s.bottomRight.y-s.topLeft.y)*l,h=[new H(0,0),new H(u,0),new H(u,d),new H(0,d)],f=`cropClipPath_${t.id.replace(":","_")}`;return x.jsxs(x.Fragment,{children:[x.jsx("defs",{children:x.jsx("clipPath",{id:f,children:x.jsx("polygon",{points:h.map(p=>`${p.x},${p.y}`).join(" ")})})}),x.jsx("g",{clipPath:`url(#${f})`,children:x.jsx("image",{href:i,width:c,height:l,style:{transform:a}})})]})}else return x.jsx("image",{href:i,width:t.props.w,height:t.props.h})}}$(UO,"type","image"),$(UO,"props",O8e),$(UO,"migrations",M8e);function g1e(n){const e=n.props.crop,t=e==null?void 0:e.topLeft;if(!t)return{width:n.props.w,height:n.props.h};const r=1/(e.bottomRight.x-e.topLeft.x)*n.props.w,i=1/(e.bottomRight.y-e.topLeft.y)*n.props.h,o=-t.x*r,s=-t.y*i;return{transform:`translate(${o}px, ${s}px)`,width:r,height:i}}function xLe(n){return{size:n,thinning:.4,streamline:0,smoothing:.5,simulatePressure:!0,last:!0}}function ELe(n,e,t){const r=e.vertices,i=xLe(t);return Sg(r,i)}function pFt(n,e,t){const r=xLe(t);return Die(LN(ELe(n,e,t),r),r)}function gFt(n,e,t){const r=pFt(n,e,t);return pie(r)}function mFt(n,e,t){if(n.props.dash==="draw"){const r=ELe(n,e,t);return qS(r)}return e.getSvgPathData()}function ILe(n,e,t){let r=`M ${Di(e[0])}L`,i=`M ${Di(e[0])}L`;const o=t/3,s=t*2,a=ip(n);let c=e[0],l,u=e[0],d;const h=e.length;for(let f=0,p=h-1;f<p;f++){l=e[f+1],d=H.AddXY(e[f+1],a()*o,a()*o);const g=H.Sub(l,c),m=H.Len(g),v=H.Div(g,m).mul(Math.min(m/4,s)),b=H.Add(c,v),S=H.Add(l,v.neg()),E=H.Sub(d,u),w=H.Len(E),C=H.Div(E,w).mul(Math.min(w/4,s)),I=H.Add(u,C),T=H.Add(d,C.neg());f===p-1?(r+=`${Di(b)}L ${Di(l)}`,i+=`${Di(I)}L ${Di(d)}`):(r+=`${Di(b)}L ${Di(S)}Q ${Di(l)}`,i+=`${Di(I)}L ${Di(T)}Q ${Di(d)}`,c=l,u=d)}return[r,r+i]}const vFt=new uv;class zO extends qf{constructor(){super(...arguments);$(this,"hideResizeHandles",()=>!0);$(this,"hideRotateHandle",()=>!0);$(this,"hideSelectionBoundsFg",()=>!0);$(this,"hideSelectionBoundsBg",()=>!0);$(this,"onResize",(t,r)=>{const{scaleX:i,scaleY:o}=r;return{props:{points:TD(t.props.points,(s,{id:a,index:c,x:l,y:u})=>({id:a,index:c,x:l*i,y:u*o}))}}});$(this,"onHandleDrag",(t,{handle:r})=>{if(r.type==="vertex")return{...t,props:{...t.props,points:{...t.props.points,[r.id]:{id:r.id,index:r.index,x:r.x,y:r.y}}}}})}getDefaultProps(){const[t,r]=j3(2);return{dash:"draw",size:"m",color:"black",spline:"line",points:{[t]:{id:t,index:t,x:0,y:0},[r]:{id:r,index:r,x:.1,y:.1}},scale:1}}getGeometry(t){return bP(t)}getHandles(t){return vFt.get(t.props,()=>{const r=bP(t),i=SX(t),o=i.map(s=>({...s,id:s.index,type:"vertex",canSnap:!0}));for(let s=0;s<i.length-1;s++){const a=F3(i[s].index,i[s+1].index),l=r.segments[s].midPoint();o.push({id:a,type:"create",index:a,x:l.x,y:l.y,canSnap:!0})}return o.sort(ml)})}component(t){return x.jsx(ky,{id:t.id,children:x.jsx(m1e,{shape:t})})}indicator(t){const r=dc[t.props.size]*t.props.scale,i=bP(t),{dash:o}=t.props;let s;if(t.props.spline==="line"){const a=i.points;if(o==="solid"||o==="dotted"||o==="dashed")s="M"+a[0]+"L"+a.slice(1);else{const[c]=ILe(t.id,a,r);s=c}}else s=mFt(t,i,r);return x.jsx("path",{d:s})}toSvg(t){return x.jsx(m1e,{shouldScale:!0,shape:t})}getHandleSnapGeometry(t){const r=SX(t);return{points:r,getSelfSnapPoints:i=>{const o=this.getHandles(t).filter(s=>s.type==="vertex").findIndex(s=>s.id===i.id);return r.filter((s,a)=>Math.abs(a-o)>1).map(H.From)},getSelfSnapOutline:i=>{const o=this.getHandles(t).filter(a=>a.type==="vertex").findIndex(a=>a.id===i.id),s=bP(t).segments.filter((a,c)=>c!==o-1&&c!==o);return s.length?new Qf({children:s}):null}}}}$(zO,"type","line"),$(zO,"props",$8e),$(zO,"migrations",L8e);function SX(n){return Object.values(n.props.points).sort(ml)}function bP(n){const e=SX(n).map(H.From);switch(n.props.spline){case"cubic":return new LLt({points:e});case"line":return new mE({points:e})}}function m1e({shape:n,shouldScale:e=!1}){const t=Zh(),r=bP(n),{dash:i,color:o,size:s}=n.props,a=1/n.props.scale,c=e?a:1,l=dc[s]*n.props.scale;if(n.props.spline==="line"){if(i==="solid"){const u=r.points,d="M"+u[0]+"L"+u.slice(1);return x.jsx("path",{d,stroke:t[o].solid,strokeWidth:l,fill:"none",transform:`scale(${c})`})}if(i==="dashed"||i==="dotted")return x.jsx("g",{stroke:t[o].solid,strokeWidth:l,transform:`scale(${c})`,children:r.segments.map((u,d)=>{const{strokeDasharray:h,strokeDashoffset:f}=Lp(u.length,l,{style:i,start:d>0?"outset":"none",end:d<r.segments.length-1?"outset":"none"});return x.jsx("path",{strokeDasharray:h,strokeDashoffset:f,d:u.getSvgPathData(!0),fill:"none"},d)})});if(i==="draw"){const u=r.points,[d,h]=ILe(n.id,u,l);return x.jsx("path",{d:h,stroke:t[o].solid,strokeWidth:l,fill:"none",transform:`scale(${c})`})}}if(n.props.spline==="cubic"){const u=r.getSvgPathData();if(i==="solid")return x.jsx("path",{strokeWidth:l,stroke:t[o].solid,fill:"none",d:u,transform:`scale(${c})`});if(i==="dashed"||i==="dotted")return x.jsx("g",{stroke:t[o].solid,strokeWidth:l,transform:`scale(${c})`,children:r.segments.map((d,h)=>{const{strokeDasharray:f,strokeDashoffset:p}=Lp(d.length,l,{style:i,start:h>0?"outset":"none",end:h<r.segments.length-1?"outset":"none"});return x.jsx("path",{strokeDasharray:f,strokeDashoffset:p,d:d.getSvgPathData(),fill:"none"},h)})});if(i==="draw")return x.jsx("path",{d:gFt(n,r,l),strokeWidth:1,stroke:t[o].solid,fill:t[o].solid,transform:`scale(${c})`})}}const PLe=y.createContext(null);function yFt({assetUrls:n,children:e}){return y.useEffect(()=>{for(const t of Object.values(n.icons)){const r=rx();r.src=t,r.decode()}for(const t of Object.values(n.embedIcons)){const r=rx();r.src=t,r.decode()}},[n]),x.jsx(PLe.Provider,{value:n,children:e})}function jie(){const n=y.useContext(PLe);if(!n)throw new Error("useAssetUrls must be used within an AssetUrlsProvider");return n}const _X={"action.convert-to-bookmark":"Convert to Bookmark","action.convert-to-embed":"Convert to Embed","action.open-embed-link":"Open link","action.align-bottom":"Align bottom","action.align-center-horizontal":"Align horizontally","action.align-center-vertical":"Align vertically","action.align-center-horizontal.short":"Align H","action.align-center-vertical.short":"Align V","action.align-left":"Align left","action.align-right":"Align right","action.align-top":"Align top","action.back-to-content":"Back to content","action.bring-forward":"Bring forward","action.bring-to-front":"Bring to front","action.copy-as-json.short":"JSON","action.copy-as-json":"Copy as JSON","action.copy-as-png.short":"PNG","action.copy-as-png":"Copy as PNG","action.copy-as-svg.short":"SVG","action.copy-as-svg":"Copy as SVG","action.copy":"Copy","action.cut":"Cut","action.delete":"Delete","action.unlock-all":"Unlock all","action.distribute-horizontal":"Distribute horizontally","action.distribute-vertical":"Distribute vertically","action.distribute-horizontal.short":"Distribute H","action.distribute-vertical.short":"Distribute V","action.duplicate":"Duplicate","action.edit-link":"Edit link","action.exit-pen-mode":"Exit pen mode","action.export-as-json.short":"JSON","action.export-as-json":"Export as JSON","action.export-as-png.short":"PNG","action.export-as-png":"Export as PNG","action.export-as-svg.short":"SVG","action.export-as-svg":"Export as SVG","action.export-all-as-json.short":"JSON","action.export-all-as-json":"Export as JSON","action.export-all-as-png.short":"PNG","action.export-all-as-png":"Export as PNG","action.export-all-as-svg.short":"SVG","action.export-all-as-svg":"Export as SVG","action.fit-frame-to-content":"Fit to content","action.flip-horizontal":"Flip horizontally","action.flip-vertical":"Flip vertically","action.flip-horizontal.short":"Flip H","action.flip-vertical.short":"Flip V","action.fork-project":"Fork this project","action.fork-project-on-tldraw":"Fork project on tldraw","action.group":"Group","action.insert-embed":"Insert embed","action.insert-media":"Upload media","action.leave-shared-project":"Leave shared project","action.new-project":"New project","action.new-shared-project":"New shared project","action.open-cursor-chat":"Cursor chat","action.open-file":"Open file","action.pack":"Pack","action.paste":"Paste","action.print":"Print","action.redo":"Redo","action.remove-frame":"Remove frame","action.rename":"Rename","action.rotate-ccw":"Rotate counterclockwise","action.rotate-cw":"Rotate clockwise","action.save-copy":"Save a copy","action.select-all":"Select all","action.select-none":"Select none","action.send-backward":"Send backward","action.send-to-back":"Send to back","action.share-project":"Share this project","action.stack-horizontal":"Stack horizontally","action.stack-vertical":"Stack vertically","action.stack-horizontal.short":"Stack H","action.stack-vertical.short":"Stack V","action.stop-following":"Stop following","action.stretch-horizontal":"Stretch horizontally","action.stretch-vertical":"Stretch vertically","action.stretch-horizontal.short":"Stretch H","action.stretch-vertical.short":"Stretch V","action.toggle-auto-size":"Toggle auto size","action.toggle-dark-mode.menu":"Dark mode","action.toggle-dark-mode":"Toggle dark mode","action.toggle-wrap-mode.menu":"Select on wrap","action.toggle-wrap-mode":"Toggle Select on wrap","action.toggle-reduce-motion.menu":"Reduce motion","action.toggle-reduce-motion":"Toggle reduce motion","action.toggle-edge-scrolling.menu":"Edge scrolling","action.toggle-edge-scrolling":"Toggle edge scrolling","action.toggle-debug-mode.menu":"Debug mode","action.toggle-debug-mode":"Toggle debug mode","action.toggle-focus-mode.menu":"Focus mode","action.toggle-focus-mode":"Toggle focus mode","action.toggle-dynamic-size-mode.menu":"Dynamic size","action.toggle-dynamic-size-mode":"Toggle dynamic size","action.toggle-grid.menu":"Show grid","action.toggle-grid":"Toggle grid","action.toggle-lock":"Toggle locked","action.flatten-to-image":"Flatten","action.toggle-snap-mode.menu":"Always snap","action.toggle-snap-mode":"Toggle always snap","action.toggle-tool-lock.menu":"Tool lock","action.toggle-tool-lock":"Toggle tool lock","action.toggle-transparent.context-menu":"Transparent","action.toggle-transparent.menu":"Transparent","action.toggle-transparent":"Toggle transparent background","action.undo":"Undo","action.ungroup":"Ungroup","action.zoom-in":"Zoom in","action.zoom-out":"Zoom out","action.zoom-to-100":"Zoom to 100%","action.zoom-to-fit":"Zoom to fit","action.zoom-to-selection":"Zoom to selection","assets.files.upload-failed":"Upload failed","assets.url.failed":"Couldn't load URL preview","theme.dark":"Dark","theme.light":"Light","theme.system":"System","color-style.white":"White","color-style.black":"Black","color-style.blue":"Blue","color-style.green":"Green","color-style.grey":"Grey","color-style.light-blue":"Light blue","color-style.light-green":"Light green","color-style.light-red":"Light red","color-style.light-violet":"Light violet","color-style.orange":"Orange","color-style.red":"Red","color-style.violet":"Violet","color-style.yellow":"Yellow","fill-style.none":"None","document.default-name":"Untitled","fill-style.semi":"Semi","fill-style.solid":"Solid","fill-style.pattern":"Pattern","fill-style.fill":"Fill","dash-style.dashed":"Dashed","dash-style.dotted":"Dotted","dash-style.draw":"Draw","dash-style.solid":"Solid","size-style.s":"Small","size-style.m":"Medium","size-style.l":"Large","size-style.xl":"Extra large","opacity-style.0.1":"10%","opacity-style.0.25":"25%","opacity-style.0.5":"50%","opacity-style.0.75":"75%","opacity-style.1":"100%","font-style.draw":"Draw","font-style.sans":"Sans","font-style.serif":"Serif","font-style.mono":"Mono","align-style.start":"Start","align-style.middle":"Middle","align-style.end":"End","align-style.justify":"Justify","verticalAlign-style.start":"Top","verticalAlign-style.middle":"Middle","verticalAlign-style.end":"Bottom","geo-style.arrow-down":"Arrow down","geo-style.arrow-left":"Arrow left","geo-style.arrow-right":"Arrow right","geo-style.arrow-up":"Arrow up","geo-style.diamond":"Diamond","geo-style.ellipse":"Ellipse","geo-style.hexagon":"Hexagon","geo-style.octagon":"Octagon","geo-style.oval":"Oval","geo-style.cloud":"Cloud","geo-style.pentagon":"Pentagon","geo-style.rectangle":"Rectangle","geo-style.rhombus-2":"Rhombus 2","geo-style.rhombus":"Rhombus","geo-style.star":"Star","geo-style.trapezoid":"Trapezoid","geo-style.triangle":"Triangle","geo-style.x-box":"X box","geo-style.check-box":"Check box","arrowheadStart-style.none":"None","arrowheadStart-style.arrow":"Arrow","arrowheadStart-style.bar":"Bar","arrowheadStart-style.diamond":"Diamond","arrowheadStart-style.dot":"Dot","arrowheadStart-style.inverted":"Inverted","arrowheadStart-style.pipe":"Pipe","arrowheadStart-style.square":"Square","arrowheadStart-style.triangle":"Triangle","arrowheadEnd-style.none":"None","arrowheadEnd-style.arrow":"Arrow","arrowheadEnd-style.bar":"Bar","arrowheadEnd-style.diamond":"Diamond","arrowheadEnd-style.dot":"Dot","arrowheadEnd-style.inverted":"Inverted","arrowheadEnd-style.pipe":"Pipe","arrowheadEnd-style.square":"Square","arrowheadEnd-style.triangle":"Triangle","spline-style.line":"Line","spline-style.cubic":"Cubic","tool.select":"Select","tool.hand":"Hand","tool.draw":"Draw","tool.eraser":"Eraser","tool.arrow-down":"Arrow down","tool.arrow-left":"Arrow left","tool.arrow-right":"Arrow right","tool.arrow-up":"Arrow up","tool.arrow":"Arrow","tool.cloud":"Cloud","tool.diamond":"Diamond","tool.ellipse":"Ellipse","tool.hexagon":"Hexagon","tool.highlight":"Highlight","tool.line":"Line","tool.octagon":"Octagon","tool.oval":"Oval","tool.pentagon":"Pentagon","tool.rectangle":"Rectangle","tool.rhombus":"Rhombus","tool.star":"Star","tool.trapezoid":"Trapezoid","tool.triangle":"Triangle","tool.x-box":"X box","tool.check-box":"Check box","tool.asset":"Asset","tool.frame":"Frame","tool.note":"Note","tool.laser":"Laser","tool.embed":"Embed","tool.text":"Text","menu.title":"Menu","menu.theme":"Theme","menu.copy-as":"Copy as","menu.edit":"Edit","menu.export-as":"Export as","menu.file":"File","menu.language":"Language","menu.preferences":"Preferences","menu.view":"View","context-menu.edit":"Edit","context-menu.arrange":"Arrange","context-menu.copy-as":"Copy as","context-menu.export-as":"Export as","context-menu.export-all-as":"Export","context-menu.move-to-page":"Move to page","context-menu.reorder":"Reorder","page-menu.title":"Pages","page-menu.create-new-page":"Create new page","page-menu.max-page-count-reached":"Max pages reached","page-menu.new-page-initial-name":"Page 1","page-menu.edit-start":"Edit","page-menu.edit-done":"Done","page-menu.go-to-page":"Go to page","page-menu.submenu.rename":"Rename","page-menu.submenu.duplicate-page":"Duplicate","page-menu.submenu.title":"Menu","page-menu.submenu.move-down":"Move down","page-menu.submenu.move-up":"Move up","page-menu.submenu.delete":"Delete","share-menu.title":"Share","share-menu.save-note":"Download this project to your computer as a .tldr file.","share-menu.fork-note":"Create a new shared project based on this snapshot.","share-menu.share-project":"Share this project","share-menu.default-project-name":"Shared Project","share-menu.copy-link":"Copy editor link","share-menu.readonly-link":"Read-only","share-menu.create-snapshot-link":"Copy snapshot link","share-menu.snapshot-link-note":"Capture and share this project as a read-only snapshot link.","share-menu.copy-readonly-link":"Copy viewer link","share-menu.offline-note":"Create a new shared project based on your current project.","share-menu.copy-link-note":"Anyone with the link will be able to view and edit this project.","share-menu.copy-readonly-link-note":"Anyone with the link will be able to access this project.","share-menu.project-too-large":"Sorry, this project can't be shared because it's too large. We're working on it!","share-menu.upload-failed":"Sorry, we couldn't upload your project at the moment. Please try again or let us know if the problem persists.","share-menu.creating-project":"Creating the new project…","share-menu.copied":"Copied link","status.offline":"Offline","status.online":"Online","people-menu.title":"People","people-menu.change-name":"Change name","people-menu.change-color":"Change color","people-menu.follow":"Following","people-menu.following":"Following","people-menu.leading":"Following You","people-menu.user":"(You)","people-menu.invite":"Invite others","help-menu.title":"Help and resources","help-menu.about":"About","help-menu.discord":"Discord","help-menu.github":"GitHub","help-menu.keyboard-shortcuts":"Keyboard shortcuts","help-menu.twitter":"Twitter","actions-menu.title":"Actions","edit-link-dialog.title":"Edit link","edit-link-dialog.invalid-url":"A link must be a valid URL.","edit-link-dialog.detail":"Links will open in a new tab.","edit-link-dialog.url":"URL","edit-link-dialog.clear":"Clear","edit-link-dialog.save":"Continue","edit-link-dialog.cancel":"Cancel","embed-dialog.title":"Insert embed","embed-dialog.back":"Back","embed-dialog.create":"Create","embed-dialog.cancel":"Cancel","embed-dialog.url":"URL","embed-dialog.instruction":"Paste in the site's URL to create the embed.","embed-dialog.invalid-url":"We could not create an embed from that URL.","edit-pages-dialog.move-down":"Move down","edit-pages-dialog.move-up":"Move up","shortcuts-dialog.title":"Keyboard shortcuts","shortcuts-dialog.edit":"Edit","shortcuts-dialog.file":"File","shortcuts-dialog.preferences":"Preferences","shortcuts-dialog.tools":"Tools","shortcuts-dialog.transform":"Transform","shortcuts-dialog.view":"View","shortcuts-dialog.collaboration":"Collaboration","home-project-dialog.title":"Home project","home-project-dialog.description":"This is your local home project. It's just for you!","rename-project-dialog.title":"Rename project","rename-project-dialog.cancel":"Cancel","rename-project-dialog.rename":"Rename","home-project-dialog.ok":"Ok","style-panel.title":"Styles","style-panel.align":"Align","style-panel.vertical-align":"Vertical align","style-panel.position":"Position","style-panel.arrowheads":"Arrows","style-panel.arrowhead-start":"Start","style-panel.arrowhead-end":"End","style-panel.color":"Color","style-panel.dash":"Dash","style-panel.fill":"Fill","style-panel.font":"Font","style-panel.geo":"Shape","style-panel.mixed":"Mixed","style-panel.opacity":"Opacity","style-panel.size":"Size","style-panel.spline":"Spline","tool-panel.drawing":"Drawing","tool-panel.shapes":"Shapes","tool-panel.more":"More","debug-panel.more":"More","navigation-zone.toggle-minimap":"Toggle minimap","navigation-zone.zoom":"Zoom","focus-mode.toggle-focus-mode":"Toggle focus mode","toast.close":"Close","file-system.file-open-error.title":"Could not open file","file-system.file-open-error.not-a-tldraw-file":"The file you tried to open doesn't look like a tldraw file.","file-system.file-open-error.file-format-version-too-new":"The file you tried to open is from a newer version of tldraw. Please reload the page and try again.","file-system.file-open-error.generic-corrupted-file":"The file you tried to open is corrupted.","file-system.confirm-open.title":"Overwrite current project?","file-system.confirm-open.description":"Opening a file will replace your current project and any unsaved changes will be lost. Are you sure you want to continue?","file-system.confirm-open.cancel":"Cancel","file-system.confirm-open.open":"Open file","file-system.confirm-open.dont-show-again":"Don't ask again","file-system.confirm-clear.title":"Clear current project?","file-system.confirm-clear.description":"Creating a new project will clear your current project and any unsaved changes will be lost. Are you sure you want to continue?","file-system.confirm-clear.cancel":"Cancel","file-system.confirm-clear.continue":"Continue","file-system.confirm-clear.dont-show-again":"Don't ask again","file-system.shared-document-file-open-error.title":"Could not open file","file-system.shared-document-file-open-error.description":"Opening files from shared projects is not supported.","sharing.confirm-leave.title":"Leave current project?","sharing.confirm-leave.description":"Are you sure you want to leave this shared project? You can return to it by navigating to its URL.","sharing.confirm-leave.cancel":"Cancel","sharing.confirm-leave.leave":"Leave","sharing.confirm-leave.dont-show-again":"Don't ask again","toast.error.export-fail.title":"Failed export","toast.error.export-fail.desc":"Failed to export image","toast.error.copy-fail.title":"Failed copy","toast.error.copy-fail.desc":"Failed to copy image","context.pages.new-page":"New page","vscode.file-open.desc":"We've updated this document to work with the current version of tldraw. If you'd like to keep the original version (which will work on old.tldraw.com), click below to create a backup.","vscode.file-open.open":"Continue","vscode.file-open.backup":"Backup","vscode.file-open.backup-saved":"Backup saved","vscode.file-open.backup-failed":"Backup failed: this is not a .tldr file.","vscode.file-open.dont-show-again":"Don't ask again","cursor-chat.type-to-chat":"Type to chat..."},bFt=new Set(["ar","fa","he","ur","ku"]),pw={locale:"en",label:"English",messages:_X,dir:"ltr"};async function SFt(n,e){if(!(await vg(e.translations.en)).ok)return console.warn("No main translations found."),pw;if(n==="en")return pw;const r=z3.find(a=>a.locale===n);if(!r)return console.warn(`No translation found for locale ${n}`),pw;const o=await(await vg(e.translations[r.locale])).json();if(!o)return console.warn(`No messages found for locale ${n}`),pw;const s=[];for(const a in pw.messages)o[a]||s.push(a);return s.length>0,{locale:n,label:r.label,dir:bFt.has(r.locale)?"rtl":"ltr",messages:{...pw.messages,...o}}}const kLe=y.createContext(null);function TLe(){const n=y.useContext(kLe);if(!n)throw new Error("useCurrentTranslation must be used inside of <TldrawUiContextProvider />");return n}const _Ft=Zd(function({overrides:e,children:t}){const i=ot().user.getLocale(),o=jie(),[s,a]=y.useState(()=>e&&e.en?{locale:"en",label:"English",dir:"ltr",messages:{..._X,...e.en}}:{locale:"en",label:"English",dir:"ltr",messages:_X});return y.useEffect(()=>{let c=!1;async function l(){const u=await SFt(i,o);u&&!c&&(e&&e[i]?a({...u,messages:{...u.messages,...e[i]}}):a(u))}return l(),()=>{c=!0}},[o,i,e]),x.jsx(kLe.Provider,{value:s,children:t})});function Ni(){const n=TLe();return y.useCallback(function(t){return n.messages[t]??t},[n])}class VO extends qf{constructor(){super(...arguments);$(this,"canEdit",()=>!0);$(this,"hideResizeHandles",()=>!0);$(this,"hideSelectionBoundsFg",()=>!1);$(this,"onBeforeCreate",t=>v1e(this.editor,t));$(this,"onBeforeUpdate",(t,r)=>{if(!(t.props.text===r.props.text&&t.props.font===r.props.font&&t.props.size===r.props.size))return v1e(this.editor,r)});$(this,"onEditEnd",t=>{const{id:r,type:i,props:{text:o}}=t;o.trimEnd()!==t.props.text&&this.editor.updateShapes([{id:r,type:i,props:{text:o.trimEnd()}}])})}getDefaultProps(){return{color:"black",size:"m",text:"",font:"draw",align:"middle",verticalAlign:"middle",growY:0,fontSizeAdjustment:0,url:"",scale:1}}getGeometry(t){const{labelHeight:r,labelWidth:i}=DLe(this.editor,t),{scale:o}=t.props,s=r*o,a=i*o,c=uo*o,l=vA(t);return new Qf({children:[new hv({width:c,height:l,isFilled:!0}),new hv({x:t.props.align==="start"?0:t.props.align==="end"?c-a:(c-a)/2,y:t.props.verticalAlign==="start"?0:t.props.verticalAlign==="end"?l-s:(l-s)/2,width:a,height:s,isFilled:!0,isLabel:!0})]})}getHandles(t){const{scale:r}=t.props;if(this.editor.getInstanceState().isCoarsePointer)return[];const o=this.editor.getZoomLevel();if(o*r<.25)return[];const s=vA(t),a=uo*r,c=G7t/o*r;return o*r<.5?[{id:"bottom",index:"a3",type:"clone",x:a/2,y:s+c}]:[{id:"top",index:"a1",type:"clone",x:a/2,y:-c},{id:"right",index:"a2",type:"clone",x:a+c,y:s/2},{id:"bottom",index:"a3",type:"clone",x:a/2,y:s+c},{id:"left",index:"a4",type:"clone",x:-c,y:s/2}]}component(t){const{id:r,type:i,props:{scale:o,color:s,font:a,size:c,align:l,text:u,verticalAlign:d,fontSizeAdjustment:h}}=t,f=xFt(r),p=Zh(),g=uo*o,m=vA(t),v=_t("shape rotation",()=>{var E;return((E=this.editor.getShapePageTransform(r))==null?void 0:E.rotation())??0},[this.editor]),b=_t("zoom",()=>this.editor.getZoomLevel()<.35/o,[o,this.editor]),S=t.id===this.editor.getOnlySelectedShapeId();return x.jsxs(x.Fragment,{children:[x.jsx("div",{id:r,className:"tl-note__container",style:{width:g,height:m,backgroundColor:p[s].note.fill,borderBottom:b?`${3*o}px solid rgb(15, 23, 31, .2)`:"none",boxShadow:b?"none":EFt(t.id,v,o)},children:x.jsx(jN,{id:r,type:i,font:a,fontSize:(h||Xm[c])*o,lineHeight:qc.lineHeight,align:l,verticalAlign:d,text:u,isNote:!0,isSelected:S,labelColor:p[s].note.text,wrap:!0,padding:16*o,onKeyDown:f})}),"url"in t.props&&t.props.url&&x.jsx(ux,{url:t.props.url,zoomLevel:this.editor.getZoomLevel()})]})}indicator(t){const{scale:r}=t.props;return x.jsx("rect",{rx:r,width:et(uo*r),height:et(vA(t))})}toSvg(t,r){r.addExportDef(lx(t.props.font)),t.props.text&&r.addExportDef(lx(t.props.font));const i=xv({isDarkMode:r.isDarkMode}),o=IFt(t);return x.jsxs(x.Fragment,{children:[x.jsx("rect",{x:5,y:5,rx:1,width:uo-10,height:o.h,fill:"rgba(0,0,0,.1)"}),x.jsx("rect",{rx:1,width:uo,height:o.h,fill:i[t.props.color].note.fill}),x.jsx(FN,{fontSize:t.props.fontSizeAdjustment||Xm[t.props.size],font:t.props.font,align:t.props.align,verticalAlign:t.props.verticalAlign,text:t.props.text,labelColor:i[t.props.color].note.text,bounds:o,stroke:!1})]})}}$(VO,"type","note"),$(VO,"props",N8e),$(VO,"migrations",F8e);function v1e(n,e){const{labelHeight:t,fontSizeAdjustment:r}=DLe(n,e),i=Math.max(0,t-uo);if(i!==e.props.growY||r!==e.props.fontSizeAdjustment)return{...e,props:{...e.props,growY:i,fontSizeAdjustment:r}}}function wFt(n,e){const{text:t}=e.props;if(!t)return{labelHeight:Xm[e.props.size]*qc.lineHeight+xf*2,labelWidth:100,fontSizeAdjustment:0};const r=Xm[e.props.size];let i=0,o=0,s=uo,a=uo;const c=1;do{i=Math.min(r,r-o);const l=n.textMeasure.measureText(t,{...qc,fontFamily:sg[e.props.font],fontSize:i,maxWidth:uo-xf*2-c,disableOverflowWrapBreaking:!0});if(s=l.h+xf*2,a=l.w+xf*2,i<=14){const u=n.textMeasure.measureText(t,{...qc,fontFamily:sg[e.props.font],fontSize:i,maxWidth:uo-xf*2-c});s=u.h+xf*2,a=u.w+xf*2;break}if(l.scrollWidth.toFixed(0)===l.w.toFixed(0))break}while(o++<50);return{labelHeight:s,labelWidth:a,fontSizeAdjustment:i}}const CFt=new uv;function DLe(n,e){return CFt.get(e,()=>wFt(n,e))}function xFt(n){const e=ot(),t=TLe();return y.useCallback(r=>{const i=e.getShape(n);if(!i)return;const o=r.key==="Tab",s=(r.metaKey||r.ctrlKey)&&r.key==="Enter";if(o||s){r.preventDefault();const a=e.getShapePageTransform(n),c=a.rotation(),l=!!(t.dir==="rtl"||tLe(i.props.text)),u=(uo+e.options.adjacentShapeMargin+(s&&!r.shiftKey?i.props.growY:0))*i.props.scale,d=new H(o?r.shiftKey!=l?-1:1:0,s?r.shiftKey?-1:1:0).mul(u).add(NN.clone().mul(i.props.scale)).rot(c).add(a.point()),h=lLe(e,i,d,c);h&&(e.mark("editing adjacent shape"),p$(e,h,!0))}},[n,e,t.dir])}function vA(n){return(uo+n.props.growY)*n.props.scale}function EFt(n,e,t){const r=ip(n),i=Math.abs(r())+.5,o=Math.cos(e),s=5*t,a=4*t,c=6*t,l=7*t;return`0px ${s-i}px ${s}px -${s}px rgba(15, 23, 31, .6),
	0px ${(a+i*l)*Math.max(0,o)}px ${c+i*l}px -${a+i*c}px rgba(15, 23, 31, ${(.3+i*.1).toFixed(2)}), 
	0px ${48*t}px ${10*t}px -${10*t}px inset rgba(15, 23, 44, ${((.022+r()*.005)*((1+o)/2)).toFixed(2)})`}function IFt(n){return new xn(0,0,uo,uo+n.props.growY)}function PFt(n,{initialBounds:e,scaleX:t,scaleY:r,newPoint:i}){const o=Math.max(.01,Math.min(Math.abs(t),Math.abs(r))),s=new H(0,0);t<0&&(s.x=-(e.width*o)),r<0&&(s.y=-(e.height*o));const{x:a,y:c}=H.Add(i,s.rot(n.rotation));return{x:a,y:c,props:{scale:o*n.props.scale}}}const kFt=new uv;class WO extends qf{constructor(){super(...arguments);$(this,"canEdit",()=>!0);$(this,"isAspectRatioLocked",()=>!0);$(this,"onResize",(t,r)=>{const{newPoint:i,initialBounds:o,initialShape:s,scaleX:a,handle:c}=r;if(r.mode==="scale_shape"||c!=="right"&&c!=="left")return{id:t.id,type:t.type,...PFt(t,r)};{const l=Math.max(1,Math.abs(o.width*a)),{x:u,y:d}=a<0?H.Sub(i,H.FromAngle(t.rotation).mul(l)):i;return{id:t.id,type:t.type,x:u,y:d,props:{w:l/s.props.scale,autoSize:!1}}}});$(this,"onEditEnd",t=>{const{id:r,type:i,props:{text:o}}=t,s=t.props.text.trimEnd();s.length===0?this.editor.deleteShapes([t.id]):s!==t.props.text&&this.editor.updateShapes([{id:r,type:i,props:{text:o.trimEnd()}}])});$(this,"onBeforeUpdate",(t,r)=>{if(!r.props.autoSize)return;const i=t.props.size!==r.props.size||t.props.textAlign!==r.props.textAlign||t.props.font!==r.props.font||t.props.scale!==1&&r.props.scale===1,o=t.props.text!==r.props.text;if(!i&&!o)return;const s=this.getMinDimensions(t),a=y1e(this.editor,r.props),c=s.width*t.props.scale,l=s.height*t.props.scale,u=a.width*r.props.scale,d=a.height*r.props.scale;let h;switch(r.props.textAlign){case"middle":{h=new H((u-c)/2,o?0:(d-l)/2);break}case"end":{h=new H(u-c,o?0:(d-l)/2);break}default:{if(o)break;h=new H(0,(d-l)/2);break}}if(h){h.rot(r.rotation);const{x:f,y:p}=r;return{...r,x:f-h.x,y:p-h.y,props:{...r.props,w:u}}}else return{...r,props:{...r.props,w:u}}})}getDefaultProps(){return{color:"black",size:"m",w:8,text:"",font:"draw",textAlign:"start",autoSize:!0,scale:1}}getMinDimensions(t){return kFt.get(t.props,r=>y1e(this.editor,r))}getGeometry(t){const{scale:r}=t.props,{width:i,height:o}=this.getMinDimensions(t);return new hv({width:i*r,height:o*r,isFilled:!0,isLabel:!0})}component(t){const{id:r,props:{font:i,size:o,text:s,color:a,scale:c,textAlign:l}}=t,{width:u,height:d}=this.getMinDimensions(t),h=t.id===this.editor.getOnlySelectedShapeId(),f=Zh(),p=TFt(r);return x.jsx(jN,{id:r,classNamePrefix:"tl-text-shape",type:"text",font:i,fontSize:ax[o],lineHeight:qc.lineHeight,align:l,verticalAlign:"middle",text:s,labelColor:f[a].solid,isSelected:h,textWidth:u,textHeight:d,style:{transform:`scale(${c})`,transformOrigin:"top left"},wrap:!0,onKeyDown:p})}indicator(t){const r=this.editor.getShapeGeometry(t).bounds,i=ot();return t.props.autoSize&&i.getEditingShapeId()===t.id?null:x.jsx("rect",{width:et(r.width),height:et(r.height)})}toSvg(t,r){r.addExportDef(lx(t.props.font)),t.props.text&&r.addExportDef(lx(t.props.font));const i=this.editor.getShapeGeometry(t).bounds,o=i.width/(t.props.scale??1),s=i.height/(t.props.scale??1),a=xv(r);return x.jsx(FN,{fontSize:ax[t.props.size],font:t.props.font,align:t.props.textAlign,verticalAlign:"middle",text:t.props.text,labelColor:a[t.props.color].solid,bounds:new xn(0,0,o,s),padding:0})}}$(WO,"type","text"),$(WO,"props",j8e),$(WO,"migrations",B8e);function y1e(n,e){const{font:t,text:r,autoSize:i,size:o,w:s}=e,a=i?16:Math.max(16,s),c=ax[o],l=i?null:Math.floor(Math.max(a,s)),u=n.textMeasure.measureText(r,{...qc,fontFamily:sg[t],fontSize:c,maxWidth:l});return i&&(u.w+=1),{width:Math.max(a,u.w),height:Math.max(c,u.h)}}function TFt(n){const e=ot();return y.useCallback(t=>{if(e.getEditingShapeId()===n)switch(t.key){case"Enter":{(t.ctrlKey||t.metaKey)&&e.complete();break}case"Tab":{Ri(t),t.shiftKey?cx.unindent(t.currentTarget):cx.indent(t.currentTarget);break}}},[e,n])}class qO extends vE{constructor(){super(...arguments);$(this,"canEdit",()=>!0);$(this,"isAspectRatioLocked",()=>!0)}getDefaultProps(){return{w:100,h:100,assetId:null,time:0,playing:!0,url:""}}component(t){const{editor:r}=this,i=r.getShapeGeometry(t).bounds.w*r.getZoomLevel()>=110,{asset:o,url:s}=wLe(t.id,t.props.assetId,t.props.w),{time:a,playing:c}=t.props,l=$N(t.id),u=CLe(),d=y.useRef(null),h=y.useCallback(b=>{const S=b.currentTarget;S&&r.updateShapes([{type:"video",id:t.id,props:{playing:!0,time:S.currentTime}}])},[t.id,r]),f=y.useCallback(b=>{const S=b.currentTarget;S&&r.updateShapes([{type:"video",id:t.id,props:{playing:!1,time:S.currentTime}}])},[t.id,r]),p=y.useCallback(b=>{const S=b.currentTarget;S&&l&&r.updateShapes([{type:"video",id:t.id,props:{time:S.currentTime}}])},[l,t.id,r]),[g,m]=y.useState(!1),v=y.useCallback(b=>{const S=b.currentTarget;S&&(a!==S.currentTime&&(S.currentTime=a),c||S.pause(),m(!0))},[c,a]);return y.useEffect(()=>{const b=d.current;b&&(g&&!l&&a!==b.currentTime&&(b.currentTime=a),l&&document.activeElement!==b&&b.focus())},[l,g,a]),y.useEffect(()=>{if(u){const b=d.current;if(!b)return;b.pause(),b.currentTime=0}},[d,u]),x.jsxs(x.Fragment,{children:[x.jsx(WS,{id:t.id,style:{color:"var(--color-text-3)",backgroundColor:o?"transparent":"var(--color-low)",border:o?"none":"1px solid var(--color-low-border)"},children:x.jsx("div",{className:"tl-counter-scaled",children:x.jsx("div",{className:"tl-video-container",children:o!=null&&o.props.src?s?x.jsx("video",{ref:d,style:l?{pointerEvents:"all"}:void 0,className:`tl-video tl-video-shape-${t.id.split(":")[1]}`,width:"100%",height:"100%",draggable:!1,playsInline:!0,autoPlay:!0,muted:!0,loop:!0,disableRemotePlayback:!0,disablePictureInPicture:!0,controls:l&&i,onPlay:h,onPause:f,onTimeUpdate:p,onLoadedData:v,hidden:!g,children:x.jsx("source",{src:s})}):null:x.jsx(_Le,{})})})}),"url"in t.props&&t.props.url&&x.jsx(ux,{url:t.props.url,zoomLevel:r.getZoomLevel()})]})}indicator(t){return x.jsx("rect",{width:et(t.props.w),height:et(t.props.h)})}toSvg(t){return x.jsx("image",{href:DFt(t.id),width:t.props.w,height:t.props.h})}}$(qO,"type","video"),$(qO,"props",H8e),$(qO,"migrations",U8e);function DFt(n){const e=n.split(":")[1],t=document.querySelector(`.tl-video-shape-${e}`);if(t){const r=document.createElement("canvas");return r.width=t.videoWidth,r.height=t.videoHeight,r.getContext("2d").drawImage(t,0,0),r.toDataURL("image/png")}else throw new Error("Video with not found when attempting serialization.")}const Bie=[WO,LO,NO,BO,VO,zO,jO,$O,HO,FO,UO,qO];function RFt(n){return[n.sideEffects.registerAfterChangeHandler("instance_page_state",(e,t)=>{if(e.croppingShapeId!==t.croppingShapeId){const r=n.isIn("select.crop");!e.croppingShapeId&&t.croppingShapeId?r||n.setCurrentTool("select.crop.idle"):e.croppingShapeId&&!t.croppingShapeId&&r&&n.setCurrentTool("select.idle")}e.editingShapeId!==t.editingShapeId&&(!e.editingShapeId&&t.editingShapeId?n.isIn("select.editing_shape")||n.setCurrentTool("select.editing_shape"):e.editingShapeId&&!t.editingShapeId&&n.isIn("select.editing_shape")&&n.setCurrentTool("select.idle"))})]}class RLe extends Ln{constructor(){super(...arguments);$(this,"info",{});$(this,"scribbleId","id");$(this,"markId","");$(this,"excludedShapeIds",new Set);$(this,"onEnter",t=>{this.markId="erase scribble begin",this.editor.mark(this.markId),this.info=t;const{originPagePoint:r}=this.editor.inputs;this.excludedShapeIds=new Set(this.editor.getCurrentPageShapes().filter(o=>{if(this.editor.isShapeOrAncestorLocked(o))return!0;if(this.editor.isShapeOfType(o,"group")||this.editor.isShapeOfType(o,"frame")){const s=this.editor.getPointInShapeSpace(o,r);return this.editor.getShapeGeometry(o).bounds.containsPoint(s)}return!1}).map(o=>o.id));const i=this.editor.scribbles.addScribble({color:"muted-1",size:12});this.scribbleId=i.id,this.update()});$(this,"pushPointToScribble",()=>{const{x:t,y:r}=this.editor.inputs.currentPagePoint;this.editor.scribbles.addPoint(this.scribbleId,t,r)});$(this,"onExit",()=>{this.editor.scribbles.stop(this.scribbleId)});$(this,"onPointerMove",()=>{this.update()});$(this,"onPointerUp",()=>{this.complete()});$(this,"onCancel",()=>{this.cancel()});$(this,"onComplete",()=>{this.complete()})}update(){const{editor:t,excludedShapeIds:r}=this,i=t.getErasingShapeIds(),o=t.getZoomLevel(),s=t.getCurrentPageShapes(),{inputs:{currentPagePoint:a,previousPagePoint:c}}=t;this.pushPointToScribble();const l=new Set(i),u=this.editor.options.hitTestMargin/o;for(const d of s){if(t.isShapeOfType(d,"group"))continue;const h=t.getShapeMask(d.id);if(h&&!Fd(a,h))continue;const f=t.getShapeGeometry(d),p=t.getShapePageTransform(d);if(!f||!p)continue;const g=p.clone().invert(),m=g.applyToPoint(c),v=g.applyToPoint(a),{bounds:b}=f;b.minX-u>Math.max(m.x,v.x)||b.minY-u>Math.max(m.y,v.y)||b.maxX+u<Math.min(m.x,v.x)||b.maxY+u<Math.min(m.y,v.y)||f.hitTestLineSegment(m,v,u)&&l.add(t.getOutermostSelectableShape(d).id)}this.editor.setErasingShapes([...l].filter(d=>!r.has(d)))}complete(){const{editor:t}=this;t.deleteShapes(t.getCurrentPageState().erasingShapeIds),t.setErasingShapes([]),this.parent.transition("idle")}cancel(){const{editor:t}=this;t.setErasingShapes([]),t.bailToMark(this.markId),this.parent.transition("idle",this.info)}}$(RLe,"id","erasing");var jV;let AFt=(jV=class extends Ln{constructor(){super(...arguments);$(this,"onPointerDown",t=>{this.parent.transition("pointing",t)});$(this,"onCancel",()=>{this.editor.setCurrentTool("select")})}},$(jV,"id","idle"),jV);var BV;let OFt=(BV=class extends Ln{constructor(){super(...arguments);$(this,"onEnter",()=>{const t=this.editor.getZoomLevel(),r=this.editor.getCurrentPageShapesSorted(),{inputs:{currentPagePoint:i}}=this.editor,o=new Set,s=o.size;for(let a=r.length,c=a-1;c>=0;c--){const l=r[c];if(!(this.editor.isShapeOrAncestorLocked(l)||this.editor.isShapeOfType(l,"group"))&&this.editor.isPointInShape(l,i,{hitInside:!1,margin:this.editor.options.hitTestMargin/t})){const u=this.editor.getOutermostSelectableShape(l);if(this.editor.isShapeOfType(u,"frame")&&o.size>s)break;o.add(u.id)}}this.editor.setErasingShapes([...o])});$(this,"onLongPress",t=>{this.startErasing(t)});$(this,"onPointerMove",t=>{this.editor.inputs.isDragging&&this.startErasing(t)});$(this,"onPointerUp",()=>{this.complete()});$(this,"onCancel",()=>{this.cancel()});$(this,"onComplete",()=>{this.complete()});$(this,"onInterrupt",()=>{this.cancel()})}startErasing(t){this.parent.transition("erasing",t)}complete(){const t=this.editor.getErasingShapeIds();t.length&&(this.editor.mark("erase end"),this.editor.deleteShapes(t)),this.editor.setErasingShapes([]),this.parent.transition("idle")}cancel(){this.editor.setErasingShapes([]),this.parent.transition("idle")}},$(BV,"id","pointing"),BV);class KO extends Ln{constructor(){super(...arguments);$(this,"onEnter",()=>{this.editor.setCursor({type:"cross",rotation:0})})}}$(KO,"id","eraser"),$(KO,"initial","idle"),$(KO,"children",()=>[AFt,OFt,RLe]);class ALe extends Ln{constructor(){super(...arguments);$(this,"initialCamera",new H);$(this,"onEnter",()=>{this.initialCamera=H.From(this.editor.getCamera()),this.update()});$(this,"onPointerMove",()=>{this.update()});$(this,"onPointerUp",()=>{this.complete()});$(this,"onCancel",()=>{this.parent.transition("idle")});$(this,"onComplete",()=>{this.complete()})}update(){const{initialCamera:t,editor:r}=this,{currentScreenPoint:i,originScreenPoint:o}=r.inputs,s=H.Sub(i,o).div(r.getZoomLevel());s.len2()!==0&&r.setCamera(t.clone().add(s))}complete(){const{editor:t}=this,{pointerVelocity:r}=t.inputs,i=Math.min(r.len(),2);i>.1&&this.editor.slideCamera({speed:i,direction:r}),this.parent.transition("idle")}}$(ALe,"id","dragging");var HV;let MFt=(HV=class extends Ln{constructor(){super(...arguments);$(this,"onEnter",()=>{this.editor.setCursor({type:"grab",rotation:0})});$(this,"onPointerDown",t=>{this.parent.transition("pointing",t)});$(this,"onCancel",()=>{this.editor.setCurrentTool("select")})}},$(HV,"id","idle"),HV);var UV;let $Ft=(UV=class extends Ln{constructor(){super(...arguments);$(this,"onEnter",()=>{this.editor.stopCameraAnimation(),this.editor.setCursor({type:"grabbing",rotation:0})});$(this,"onLongPress",()=>{this.startDragging()});$(this,"onPointerMove",()=>{this.editor.inputs.isDragging&&this.startDragging()});$(this,"onPointerUp",()=>{this.complete()});$(this,"onCancel",()=>{this.complete()});$(this,"onComplete",()=>{this.complete()});$(this,"onInterrupt",()=>{this.complete()})}startDragging(){this.parent.transition("dragging")}complete(){this.parent.transition("idle")}},$(UV,"id","pointing"),UV);class GO extends Ln{constructor(){super(...arguments);$(this,"onDoubleClick",t=>{if(t.phase==="settle"){const{currentScreenPoint:r}=this.editor.inputs;this.editor.zoomIn(r,{animation:{duration:220,easing:uc.easeOutQuint}})}});$(this,"onTripleClick",t=>{if(t.phase==="settle"){const{currentScreenPoint:r}=this.editor.inputs;this.editor.zoomOut(r,{animation:{duration:320,easing:uc.easeOutQuint}})}});$(this,"onQuadrupleClick",t=>{if(t.phase==="settle"){const r=this.editor.getZoomLevel(),{inputs:{currentScreenPoint:i}}=this.editor;r===1?this.editor.zoomToFit({animation:{duration:400,easing:uc.easeOutQuint}}):this.editor.resetZoom(i,{animation:{duration:320,easing:uc.easeOutQuint}})}})}}$(GO,"id","hand"),$(GO,"initial","idle"),$(GO,"children",()=>[MFt,$Ft,ALe]);var zV;let LFt=(zV=class extends Ln{constructor(){super(...arguments);$(this,"onPointerDown",t=>{this.parent.transition("lasering",t)})}},$(zV,"id","idle"),zV);class OLe extends Ln{constructor(){super(...arguments);$(this,"scribbleId","id");$(this,"onEnter",()=>{const t=this.editor.scribbles.addScribble({color:"laser",opacity:.7,size:4,delay:1200,shrink:.05,taper:!0});this.scribbleId=t.id,this.pushPointToScribble()});$(this,"onExit",()=>{this.editor.scribbles.stop(this.scribbleId)});$(this,"onPointerMove",()=>{this.pushPointToScribble()});$(this,"onPointerUp",()=>{this.complete()});$(this,"pushPointToScribble",()=>{const{x:t,y:r}=this.editor.inputs.currentPagePoint;this.editor.scribbles.addPoint(this.scribbleId,t,r)});$(this,"onCancel",()=>{this.cancel()});$(this,"onComplete",()=>{this.complete()})}complete(){this.parent.transition("idle")}cancel(){this.parent.transition("idle")}}$(OLe,"id","lasering");class ZO extends Ln{constructor(){super(...arguments);$(this,"onEnter",()=>{this.editor.setCursor({type:"cross",rotation:0})})}}$(ZO,"id","laser"),$(ZO,"initial","idle"),$(ZO,"children",()=>[LFt,OLe]);class MLe extends Ln{constructor(){super(...arguments);$(this,"info",{});$(this,"initialSelectedShapeIds",[]);$(this,"excludedShapeIds",new Set);$(this,"isWrapMode",!1);$(this,"initialStartShape",null);$(this,"onEnter",t=>{const{altKey:r,currentPagePoint:i}=this.editor.inputs;if(this.isWrapMode=this.editor.user.getIsWrapMode(),r){this.parent.transition("scribble_brushing",t);return}this.excludedShapeIds=new Set(this.editor.getCurrentPageShapes().filter(o=>this.editor.isShapeOfType(o,"group")||this.editor.isShapeOrAncestorLocked(o)).map(o=>o.id)),this.info=t,this.initialSelectedShapeIds=this.editor.getSelectedShapeIds().slice(),this.initialStartShape=this.editor.getShapesAtPoint(i)[0],this.hitTestShapes()});$(this,"onExit",()=>{this.initialSelectedShapeIds=[],this.editor.updateInstanceState({brush:null})});$(this,"onTick",({elapsed:t})=>{const{editor:r}=this;r.edgeScrollManager.updateEdgeScrolling(t)});$(this,"onPointerMove",()=>{this.hitTestShapes()});$(this,"onPointerUp",()=>{this.complete()});$(this,"onComplete",()=>{this.complete()});$(this,"onCancel",t=>{this.editor.setSelectedShapes(this.initialSelectedShapeIds),this.parent.transition("idle",t)});$(this,"onKeyDown",t=>{this.editor.inputs.altKey?this.parent.transition("scribble_brushing",t):this.hitTestShapes()});$(this,"onKeyUp",()=>{this.hitTestShapes()});$(this,"onInterrupt",()=>{this.editor.updateInstanceState({brush:null})})}complete(){this.hitTestShapes(),this.parent.transition("idle")}hitTestShapes(){const{editor:t,excludedShapeIds:r,isWrapMode:i}=this,{inputs:{originPagePoint:o,currentPagePoint:s,shiftKey:a,ctrlKey:c}}=t,l=new Set(a?this.initialSelectedShapeIds:[]),u=i?!c:c,d=xn.FromPoints([o,s]),{corners:h}=d;let f,p,g,m,v,b;const S=t.getCurrentPageShapes(),E=t.getCurrentPageId();e:for(let I=0,T=S.length;I<T;I++){if(g=S[I],r.has(g.id)||l.has(g.id)||(m=t.getShapePageBounds(g),!m))continue e;if(d.contains(m)){this.handleHit(g,s,E,l,h);continue e}if(u||t.isShapeOfType(g,"frame"))continue e;if(d.collides(m)){if(v=t.getShapePageTransform(g),!v)continue e;b=v.clone().invert().applyToPoints(h);const D=t.getShapeGeometry(g);t:for(let O=0;O<4;O++)if(f=b[O],p=b[(O+1)%4],D.hitTestLineSegment(f,p,0)){this.handleHit(g,s,E,l,h);break t}}}t.getInstanceState().isCoarsePointer;const w=t.getInstanceState().brush;(!w||!d.equals(w))&&t.updateInstanceState({brush:{...d.toJson()}});const C=t.getSelectedShapeIds();(C.length!==l.size||C.some(I=>!l.has(I)))&&t.setSelectedShapes(Array.from(l))}handleHit(t,r,i,o,s){if(t.parentId===i){o.add(t.id);return}const a=this.editor.getOutermostSelectableShape(t),c=this.editor.getShapeMask(a.id);c&&!T$e(c,s)&&!Fd(r,c)||o.add(a.id)}}$(MLe,"id","brushing");const hx={bottom:"ns-resize",top:"ns-resize",left:"ew-resize",right:"ew-resize",bottom_left:"nesw-resize",bottom_right:"nwse-resize",top_left:"nwse-resize",top_right:"nesw-resize",bottom_left_rotate:"swne-rotate",bottom_right_rotate:"senw-rotate",top_left_rotate:"nwse-rotate",top_right_rotate:"nesw-rotate",mobile_rotate:"grabbing"};class $Le extends Ln{constructor(){super(...arguments);$(this,"info",{});$(this,"onEnter",t=>{this.info=t,this.updateCursor()});$(this,"onPointerMove",()=>{this.editor.inputs.isDragging&&this.startResizing()});$(this,"onLongPress",()=>{this.startResizing()});$(this,"onPointerUp",()=>{this.complete()});$(this,"onCancel",()=>{this.cancel()});$(this,"onComplete",()=>{this.cancel()});$(this,"onInterrupt",()=>{this.cancel()})}updateCursor(){const t=this.editor.getSelectedShapes(),r=hx[this.info.handle];this.editor.setCursor({type:r,rotation:t.length===1?this.editor.getSelectionRotation():0})}startResizing(){this.editor.getInstanceState().isReadonly||this.parent.transition("resizing",this.info)}complete(){this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,{}):this.parent.transition("idle")}cancel(){this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,{}):this.parent.transition("idle")}}$($Le,"id","pointing_resize_handle");const vh=8;class Hie extends Ln{constructor(){super(...arguments);$(this,"info",{});$(this,"markId","");$(this,"snapshot",{});$(this,"onEnter",t=>{this.info=t,this.markId="cropping",this.editor.mark(this.markId),this.snapshot=this.createSnapshot(),this.updateShapes()});$(this,"onPointerMove",()=>{this.updateShapes()});$(this,"onPointerUp",()=>{this.complete()});$(this,"onComplete",()=>{this.complete()});$(this,"onCancel",()=>{this.cancel()});$(this,"getDefaultCrop",()=>({topLeft:{x:0,y:0},bottomRight:{x:1,y:1}}))}updateCursor(){if(!this.editor.getSelectedShapes()[0])return;const r=hx[this.info.handle];this.editor.setCursor({type:r,rotation:this.editor.getSelectionRotation()})}updateShapes(){const{shape:t,cursorHandleOffset:r}=this.snapshot;if(!t||!this.editor.getShapeUtil("image"))return;const o=t.props,s=this.editor.inputs.currentPagePoint.clone().sub(r),a=this.editor.inputs.originPagePoint.clone().sub(r),c=s.clone().sub(a).rot(-t.rotation),l=o.crop??this.getDefaultCrop(),u=ls(l),d=new H(t.x,t.y),h=new H(0,0),f=1/(l.bottomRight.x-l.topLeft.x)*o.w,p=1/(l.bottomRight.y-l.topLeft.y)*o.h;let g=!1;switch(this.info.handle){case"top":case"top_left":case"top_right":{if(p<vh)break;g=!0,u.topLeft.y=u.topLeft.y+c.y/p,p*(u.bottomRight.y-u.topLeft.y)<vh?(u.topLeft.y=u.bottomRight.y-vh/p,h.y=(u.topLeft.y-l.topLeft.y)*p):u.topLeft.y<=0?(u.topLeft.y=0,h.y=(u.topLeft.y-l.topLeft.y)*p):h.y=c.y;break}case"bottom":case"bottom_left":case"bottom_right":{if(p<vh)break;g=!0,u.bottomRight.y=Math.min(1,u.bottomRight.y+c.y/p),p*(u.bottomRight.y-u.topLeft.y)<vh&&(u.bottomRight.y=u.topLeft.y+vh/p);break}}switch(this.info.handle){case"left":case"top_left":case"bottom_left":{if(f<vh)break;g=!0,u.topLeft.x=u.topLeft.x+c.x/f,f*(u.bottomRight.x-u.topLeft.x)<vh?(u.topLeft.x=u.bottomRight.x-vh/f,h.x=(u.topLeft.x-l.topLeft.x)*f):u.topLeft.x<=0?(u.topLeft.x=0,h.x=(u.topLeft.x-l.topLeft.x)*f):h.x=c.x;break}case"right":case"top_right":case"bottom_right":{if(f<vh)break;g=!0,u.bottomRight.x=Math.min(1,u.bottomRight.x+c.x/f),f*(u.bottomRight.x-u.topLeft.x)<vh&&(u.bottomRight.x=u.topLeft.x+vh/f);break}}if(!g)return;d.add(h.rot(t.rotation));const m={id:t.id,type:t.type,x:d.x,y:d.y,props:{crop:u,w:(u.bottomRight.x-u.topLeft.x)*f,h:(u.bottomRight.y-u.topLeft.y)*p}};this.editor.updateShapes([m]),this.updateCursor()}complete(){this.updateShapes(),Ao(this.editor,[this.snapshot.shape.id]),this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):(this.editor.setCroppingShape(null),this.editor.setCurrentTool("select.idle"))}cancel(){this.editor.bailToMark(this.markId),this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):(this.editor.setCroppingShape(null),this.editor.setCurrentTool("select.idle"))}createSnapshot(){const t=this.editor.getSelectionRotation(),{inputs:{originPagePoint:r}}=this.editor,i=this.editor.getOnlySelectedShape(),o=this.editor.getSelectionRotatedPageBounds(),s=H.RotWith(o.getHandlePoint(this.info.handle),o.point,t),a=H.Sub(r,s);return{shape:i,cursorHandleOffset:a}}}$(Hie,"id","cropping");function Uie(n,e=!1){const t=n.getZoomLevel(),{inputs:{currentPagePoint:r}}=n;return n.getShapeAtPoint(r,{hitInside:!1,hitLabels:e,margin:n.options.hitTestMargin/t,renderingOnly:!0})??n.getSelectedShapeAtPoint(r)}function LLe(n,e,t){if(!e)throw Error("Needs to translate a cropped shape!");const{crop:r}=e.props;if(!r)return;const i=n.inputs.shiftKey?Math.abs(t.x)<Math.abs(t.y)?"x":"y":null;i==="x"?t.x=0:i==="y"&&(t.y=0),t.rot(-e.rotation);const o=1/(r.bottomRight.x-r.topLeft.x)*e.props.w,s=1/(r.bottomRight.y-r.topLeft.y)*e.props.h,a=r.bottomRight.y-r.topLeft.y,c=r.bottomRight.x-r.topLeft.x,l=ls(r);return l.topLeft.x=Math.min(1-c,Math.max(0,l.topLeft.x-t.x/o)),l.topLeft.y=Math.min(1-a,Math.max(0,l.topLeft.y-t.y/s)),l.bottomRight.x=l.topLeft.x+c,l.bottomRight.y=l.topLeft.y+a,{id:e.id,type:e.type,props:{crop:l}}}var VV;let NFt=(VV=class extends Ln{constructor(){super(...arguments);$(this,"onEnter",()=>{this.editor.setCursor({type:"default",rotation:0});const t=this.editor.getOnlySelectedShape();t&&this.editor.setCroppingShape(t.id)});$(this,"onExit",()=>{this.editor.setCursor({type:"default",rotation:0})});$(this,"onCancel",()=>{this.editor.setCroppingShape(null),this.editor.setCurrentTool("select.idle",{})});$(this,"onPointerDown",t=>{var r;if(!this.editor.getIsMenuOpen()){if(t.ctrlKey){this.cancel(),this.editor.root.handleEvent(t);return}switch(t.target){case"canvas":{const i=Uie(this.editor);if(i&&!this.editor.isShapeOfType(i,"group")){this.onPointerDown({...t,shape:i,target:"shape"});return}this.cancel(),this.editor.root.handleEvent(t);break}case"shape":{if(t.shape.id===this.editor.getCroppingShapeId()){this.editor.setCurrentTool("select.crop.pointing_crop",t);return}else(r=this.editor.getShapeUtil(t.shape))!=null&&r.canCrop(t.shape)?(this.editor.setCroppingShape(t.shape.id),this.editor.setSelectedShapes([t.shape.id]),this.editor.setCurrentTool("select.crop.pointing_crop",t)):(this.cancel(),this.editor.root.handleEvent(t));break}case"selection":{switch(t.handle){case"mobile_rotate":case"top_left_rotate":case"top_right_rotate":case"bottom_left_rotate":case"bottom_right_rotate":{this.editor.setCurrentTool("select.pointing_rotate_handle",{...t,onInteractionEnd:"select.crop.idle"});break}case"top":case"right":case"bottom":case"left":case"top_left":case"top_right":case"bottom_left":case"bottom_right":{this.editor.setCurrentTool("select.crop.pointing_crop_handle",{...t,onInteractionEnd:"select.crop.idle"});break}default:this.cancel()}break}}}});$(this,"onDoubleClick",t=>{var s;if(this.editor.inputs.shiftKey||t.phase!=="up")return;const r=this.editor.getCroppingShapeId();if(!r)return;const i=this.editor.getShape(r);if(!i)return;const o=this.editor.getShapeUtil(i);if(o){if(t.target==="selection"){(s=o.onDoubleClickEdge)==null||s.call(o,i);return}this.cancel(),this.editor.root.handleEvent(t)}});$(this,"onKeyDown",()=>{this.nudgeCroppingImage(!1)});$(this,"onKeyRepeat",()=>{this.nudgeCroppingImage(!0)});$(this,"onKeyUp",t=>{switch(t.code){case"Enter":{this.editor.setCroppingShape(null),this.editor.setCurrentTool("select.idle",{});break}}})}cancel(){this.editor.setCroppingShape(null),this.editor.setCurrentTool("select.idle",{})}nudgeCroppingImage(t=!1){const{editor:{inputs:{keys:r}}}=this,i=r.has("ShiftLeft"),o=new H(0,0);if(r.has("ArrowLeft")&&(o.x+=1),r.has("ArrowRight")&&(o.x-=1),r.has("ArrowUp")&&(o.y+=1),r.has("ArrowDown")&&(o.y-=1),o.equals(new H(0,0)))return;i&&o.mul(10);const s=this.editor.getShape(this.editor.getCroppingShapeId());if(!s)return;const a=LLe(this.editor,s,o);a&&(t||this.editor.mark("translate crop"),this.editor.updateShapes([a]))}},$(VV,"id","idle"),VV);class NLe extends Ln{constructor(){super(...arguments);$(this,"onCancel",()=>{this.editor.setCurrentTool("select.crop.idle",{})});$(this,"onPointerMove",t=>{this.editor.inputs.isDragging&&this.editor.setCurrentTool("select.crop.translating_crop",t)});$(this,"onPointerUp",t=>{this.editor.setCurrentTool("select.crop.idle",t)})}}$(NLe,"id","pointing_crop");class zie extends Ln{constructor(){super(...arguments);$(this,"info",{});$(this,"onEnter",t=>{this.info=t,this.parent.setCurrentToolIdMask(t.onInteractionEnd);const r=this.editor.getSelectedShapes()[0];if(!r)return;const i=hx[this.info.handle];this.editor.setCursor({type:i,rotation:this.editor.getSelectionRotation()}),this.editor.setCroppingShape(r.id)});$(this,"onExit",()=>{this.editor.setCursor({type:"default",rotation:0}),this.parent.setCurrentToolIdMask(void 0)});$(this,"onPointerMove",()=>{this.editor.inputs.isDragging&&this.startCropping()});$(this,"onLongPress",()=>{this.startCropping()});$(this,"onPointerUp",()=>{this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):(this.editor.setCroppingShape(null),this.editor.setCurrentTool("select.idle"))});$(this,"onCancel",()=>{this.cancel()});$(this,"onComplete",()=>{this.cancel()});$(this,"onInterrupt",()=>{this.cancel()})}startCropping(){this.editor.getInstanceState().isReadonly||this.parent.transition("cropping",{...this.info,onInteractionEnd:this.info.onInteractionEnd})}cancel(){this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):(this.editor.setCroppingShape(null),this.editor.setCurrentTool("select.idle"))}}$(zie,"id","pointing_crop_handle");class FLe extends Ln{constructor(){super(...arguments);$(this,"info",{});$(this,"markId","translating crop");$(this,"snapshot",{});$(this,"onEnter",t=>{this.info=t,this.snapshot=this.createSnapshot(),this.editor.mark(this.markId),this.editor.setCursor({type:"move",rotation:0}),this.updateShapes()});$(this,"onExit",()=>{this.editor.setCursor({type:"default",rotation:0})});$(this,"onPointerMove",()=>{this.updateShapes()});$(this,"onPointerUp",()=>{this.complete()});$(this,"onComplete",()=>{this.complete()});$(this,"onCancel",()=>{this.cancel()});$(this,"onKeyDown",t=>{switch(t.key){case"Alt":case"Shift":{this.updateShapes();return}}});$(this,"onKeyUp",t=>{switch(t.key){case"Enter":{this.complete();return}case"Alt":case"Shift":this.updateShapes()}})}complete(){this.updateShapes(),this.editor.setCurrentTool("select.crop.idle",this.info)}cancel(){this.editor.bailToMark(this.markId),this.editor.setCurrentTool("select.crop.idle",this.info)}createSnapshot(){return{shape:this.editor.getOnlySelectedShape()}}updateShapes(){const t=this.snapshot.shape;if(!t)return;const{originPagePoint:r,currentPagePoint:i}=this.editor.inputs,o=i.clone().sub(r),s=LLe(this.editor,t,o);s&&this.editor.updateShapes([s])}}$(FLe,"id","translating_crop");class XO extends Ln{constructor(){super(...arguments);$(this,"markId","");$(this,"onEnter",()=>{this.didCancel=!1,this.markId=this.editor.history.mark()});$(this,"didCancel",!1);$(this,"onExit",()=>{this.didCancel?this.editor.bailToMark(this.markId):this.editor.history.squashToMark(this.markId)});$(this,"onCancel",()=>{this.didCancel=!0})}}$(XO,"id","crop"),$(XO,"initial","idle"),$(XO,"children",()=>[NFt,FLe,NLe,zie,Hie]);class jLe extends Ln{constructor(){super(...arguments);$(this,"shapeId","");$(this,"initialHandle",{});$(this,"initialAdjacentHandle",null);$(this,"initialPagePoint",{});$(this,"markId","");$(this,"initialPageTransform");$(this,"initialPageRotation");$(this,"info",{});$(this,"isPrecise",!1);$(this,"isPreciseId",null);$(this,"pointingId",null);$(this,"onEnter",t=>{const{shape:r,isCreating:i,handle:o}=t;if(this.info=t,this.parent.setCurrentToolIdMask(t.onInteractionEnd),this.shapeId=r.id,this.markId=i?`creating:${r.id}`:"dragging handle",i||this.editor.mark(this.markId),this.initialHandle=ls(o),this.editor.isShapeOfType(r,"line")&&this.initialHandle.type==="create"){this.editor.updateShape({...r,props:{points:{...r.props.points,[o.index]:{id:o.index,index:o.index,x:o.x,y:o.y}}}});const l=this.editor.getShapeHandles(r).find(u=>u.index===o.index);this.initialHandle=ls(l)}this.initialPageTransform=this.editor.getShapePageTransform(r),this.initialPageRotation=this.initialPageTransform.rotation(),this.initialPagePoint=this.editor.inputs.originPagePoint.clone(),this.editor.setCursor({type:i?"cross":"grabbing",rotation:0});const s=this.editor.getShapeHandles(r).sort(ml),a=s.findIndex(c=>c.id===t.handle.id);this.initialAdjacentHandle=null;for(let c=a+1;c<s.length;c++){const l=s[c];if(l.type==="vertex"&&l.id!=="middle"&&l.id!==t.handle.id){this.initialAdjacentHandle=l;break}}if(!this.initialAdjacentHandle)for(let c=s.length-1;c>=0;c--){const l=s[c];if(l.type==="vertex"&&l.id!=="middle"&&l.id!==t.handle.id){this.initialAdjacentHandle=l;break}}if(this.editor.isShapeOfType(r,"arrow")){const c=Mu(this.editor,r)[t.handle.id];this.isPrecise=!1,c?(this.editor.setHintingShapes([c.toId]),this.isPrecise=c.props.isPrecise,this.isPrecise?this.isPreciseId=c.toId:this.resetExactTimeout()):this.editor.setHintingShapes([])}this.update(),this.editor.select(this.shapeId)});$(this,"exactTimeout",-1);$(this,"onPointerMove",()=>{this.update()});$(this,"onKeyDown",()=>{this.update()});$(this,"onKeyUp",()=>{this.update()});$(this,"onPointerUp",()=>{this.complete()});$(this,"onComplete",()=>{this.update(),this.complete()});$(this,"onCancel",()=>{this.cancel()});$(this,"onExit",()=>{this.parent.setCurrentToolIdMask(void 0),this.editor.setHintingShapes([]),this.editor.snaps.clearIndicators(),this.editor.setCursor({type:"default",rotation:0})})}resetExactTimeout(){this.exactTimeout!==-1&&this.clearExactTimeout(),this.exactTimeout=this.editor.timers.setTimeout(()=>{this.getIsActive()&&!this.isPrecise&&(this.isPrecise=!0,this.isPreciseId=this.pointingId,this.update()),this.exactTimeout=-1},750)}clearExactTimeout(){this.exactTimeout!==-1&&(clearTimeout(this.exactTimeout),this.exactTimeout=-1)}complete(){this.editor.snaps.clearIndicators(),Ao(this.editor,[this.shapeId]);const{onInteractionEnd:t}=this.info;if(this.editor.getInstanceState().isToolLocked&&t){this.editor.setCurrentTool(t,{shapeId:this.shapeId});return}this.parent.transition("idle")}cancel(){this.editor.bailToMark(this.markId),this.editor.snaps.clearIndicators();const{onInteractionEnd:t}=this.info;if(t){this.editor.setCurrentTool(t,{shapeId:this.shapeId});return}this.parent.transition("idle")}update(){var I;const{editor:t,shapeId:r,initialPagePoint:i}=this,{initialHandle:o,initialPageRotation:s,initialAdjacentHandle:a}=this,c=this.editor.getHintingShapeIds(),l=this.editor.user.getIsSnapMode(),{snaps:u,inputs:{currentPagePoint:d,shiftKey:h,ctrlKey:f,altKey:p,pointerVelocity:g}}=t,m=this.info.shape,v=t.getShape(r);if(!v)return;const b=t.getShapeUtil(v);let S=d.clone().sub(i).rot(-s).add(o);if(h&&a&&o.id!=="middle"){const T=H.Angle(a,S),O=a$(T,24)-T;S=H.RotWith(S,a,O)}t.snaps.clearIndicators();let E={...o,x:S.x,y:S.y};if(o.canSnap&&(l?!f:f)){if(!t.getShapePageTransform(v.id))throw Error("Expected a page transform");const D=u.handles.snapHandle({currentShapeId:r,handle:E});D&&(D.nudge.rot(-t.getShapeParentTransform(v).rotation()),S.add(D.nudge),E={...o,x:S.x,y:S.y})}const w=(I=b.onHandleDrag)==null?void 0:I.call(b,v,{handle:E,isPrecise:this.isPrecise||p,initial:m}),C={id:v.id,type:v.type,...w};if(o.type==="vertex"&&this.editor.isShapeOfType(v,"arrow")){const T=Mu(t,v)[o.id];T?c[0]!==T.toId&&(t.setHintingShapes([T.toId]),this.pointingId=T.toId,this.isPrecise=g.len()<.5||p,this.isPreciseId=this.isPrecise?T.toId:null,this.resetExactTimeout()):c.length>0&&(t.setHintingShapes([]),this.pointingId=null,this.isPrecise=!1,this.isPreciseId=null,this.resetExactTimeout())}w&&t.updateShapes([C])}}$(jLe,"id","dragging_handle");function BLe(n){return n.isLabel?[n]:n instanceof Qf?n.children.filter(e=>e.isLabel):[]}class HLe extends Ln{constructor(){super(...arguments);$(this,"hitShapeForPointerUp",null);$(this,"onEnter",()=>{const t=this.editor.getEditingShape();if(!t)throw Error("Entered editing state without an editing shape");this.hitShapeForPointerUp=null,Fm(this.editor),this.editor.select(t)});$(this,"onExit",()=>{var o;const{editingShapeId:t}=this.editor.getCurrentPageState();if(!t)return;this.editor.setEditingShape(null),Fm.cancel();const r=this.editor.getShape(t),i=this.editor.getShapeUtil(r);(o=i.onEditEnd)==null||o.call(i,r)});$(this,"onPointerMove",t=>{if(this.hitShapeForPointerUp&&this.editor.inputs.isDragging){if(this.editor.getInstanceState().isReadonly||this.hitShapeForPointerUp.isLocked)return;this.editor.select(this.hitShapeForPointerUp),this.parent.transition("translating",t),this.hitShapeForPointerUp=null;return}switch(t.target){case"shape":case"canvas":{Fm(this.editor);return}}});$(this,"onPointerDown",t=>{switch(this.hitShapeForPointerUp=null,t.target){case"canvas":{const r=Uie(this.editor,!0);if(r){this.onPointerDown({...t,shape:r,target:"shape"});return}break}case"shape":{const{shape:r}=t,i=this.editor.getEditingShape();if(!i)throw Error("Expected an editing shape!");const o=this.editor.getShapeUtil(r).getGeometry(r),s=BLe(o),a=s.length===1?s[0]:void 0,c=this.editor.isShapeOfType(i,"text")&&i.props.text.trim()==="";if(a&&!c){const l=this.editor.getPointInShapeSpace(r,this.editor.inputs.currentPagePoint);if(a.bounds.containsPoint(l,0)&&a.hitTestPoint(l)){if(r.id===i.id)return;this.hitShapeForPointerUp=r,this.editor.mark("editing on pointer up"),this.editor.select(r.id);return}}else{if(r.id===i.id)this.editor.isShapeOfType(r,"frame")&&this.editor.setEditingShape(null);else{this.parent.transition("pointing_shape",t);return}return}break}}this.parent.transition("idle",t),this.editor.root.handleEvent(t)});$(this,"onPointerUp",t=>{const r=this.hitShapeForPointerUp;if(!r)return;this.hitShapeForPointerUp=null;const i=this.editor.getShapeUtil(r);if(!r.isLocked){if(this.editor.getInstanceState().isReadonly&&!i.canEditInReadOnly(r)){this.parent.transition("pointing_shape",t);return}this.editor.select(r.id),this.editor.setEditingShape(r.id),Fm(this.editor)}});$(this,"onComplete",t=>{this.parent.transition("idle",t)});$(this,"onCancel",t=>{this.parent.transition("idle",t)})}}$(HLe,"id","editing_shape");function b1e(n){const e=n.getOnlySelectedShape();return!!(e&&!n.isShapeOrAncestorLocked(e)&&n.getShapeUtil(e).canCrop(e))}function v$(n){const e=n.getSelectedShapeIds(),{shiftKey:t,altKey:r,currentPagePoint:i}=n.inputs,o=n.getShapeAtPoint(i,{hitInside:!1,margin:n.options.hitTestMargin/n.getZoomLevel(),hitLabels:!0,renderingOnly:!0,filter:s=>!s.isLocked});if(o){const s=n.getOutermostSelectableShape(o);if(t&&!r)n.cancelDoubleClick(),e.includes(s.id)?(n.mark("deselecting shape"),n.deselect(s)):(n.mark("shift selecting shape"),n.setSelectedShapes([...e,s.id]));else{let a;s===o||s.id===n.getFocusedGroupId()||e.includes(s.id)?a=o:a=s,a&&!e.includes(a.id)&&(n.mark("selecting shape"),n.select(a.id))}}else{if(t)return;{e.length>0&&(n.mark("selecting none"),n.selectNone());const s=n.getFocusedGroupId();if(ku(s)){const a=n.getShape(s);n.isPointInShape(a,i,{margin:0,hitInside:!0})||n.setFocusedGroup(null)}}}}const FFt=["Delete","Backspace","[","]","Enter"," ","Shift","Tab"];var WV;let jFt=(WV=class extends Ln{constructor(){super(...arguments);$(this,"onEnter",()=>{this.parent.setCurrentToolIdMask(void 0),Fm(this.editor),this.editor.setCursor({type:"default",rotation:0})});$(this,"onExit",()=>{Fm.cancel()});$(this,"onPointerMove",()=>{Fm(this.editor)});$(this,"onPointerDown",t=>{if(this.editor.getIsMenuOpen())return;const r=t.ctrlKey&&b1e(this.editor);if(t.ctrlKey&&!r){if(t.target==="shape"&&this.isDarwin&&this.editor.inputs.keys.has("ControlLeft")&&!this.editor.isShapeOrAncestorLocked(t.shape)){this.parent.transition("pointing_shape",t);return}this.parent.transition("brushing",t);return}switch(t.target){case"canvas":{const i=Uie(this.editor);if(i&&!i.isLocked){this.onPointerDown({...t,shape:i,target:"shape"});return}const o=this.editor.getSelectedShapeIds(),s=this.editor.getOnlySelectedShape(),{inputs:{currentPagePoint:a}}=this.editor;if((o.length>1||s&&!this.editor.getShapeUtil(s).hideSelectionBoundsBg(s))&&S1e(this.editor,a)){this.onPointerDown({...t,target:"selection"});return}this.parent.transition("pointing_canvas",t);break}case"shape":{const{shape:i}=t;if(this.isOverArrowLabelTest(i)){this.parent.transition("pointing_arrow_label",t);break}if(this.editor.isShapeOrAncestorLocked(i)){this.parent.transition("pointing_canvas",t);break}this.parent.transition("pointing_shape",t);break}case"handle":{if(this.editor.getInstanceState().isReadonly)break;this.editor.inputs.altKey?this.parent.transition("pointing_shape",t):this.parent.transition("pointing_handle",t);break}case"selection":{switch(t.handle){case"mobile_rotate":case"top_left_rotate":case"top_right_rotate":case"bottom_left_rotate":case"bottom_right_rotate":{this.parent.transition("pointing_rotate_handle",t);break}case"top":case"right":case"bottom":case"left":case"top_left":case"top_right":case"bottom_left":case"bottom_right":{r?this.parent.transition("crop.pointing_crop_handle",t):this.parent.transition("pointing_resize_handle",t);break}default:{const i=this.editor.getHoveredShape();if(i&&!this.editor.getSelectedShapeIds().includes(i.id)&&!i.isLocked){this.onPointerDown({...t,shape:i,target:"shape"});return}this.parent.transition("pointing_selection",t)}}break}}});$(this,"onDoubleClick",t=>{var r,i,o,s;if(!(this.editor.inputs.shiftKey||t.phase!=="up"))switch(t.target){case"canvas":{const a=this.editor.getHoveredShape(),c=a&&!this.editor.isShapeOfType(a,"group")?a:this.editor.getSelectedShapeAtPoint(this.editor.inputs.currentPagePoint)??this.editor.getShapeAtPoint(this.editor.inputs.currentPagePoint,{margin:this.editor.options.hitTestMargin/this.editor.getZoomLevel(),hitInside:!1}),l=this.editor.getFocusedGroupId();if(c){if(this.editor.isShapeOfType(c,"group")){v$(this.editor);return}else{const u=this.editor.getShape(c.parentId);if(u&&this.editor.isShapeOfType(u,"group")&&!(l&&u.id===l)){v$(this.editor);return}}this.onDoubleClick({...t,shape:c,target:"shape"});return}this.editor.inputs.shiftKey||this.handleDoubleClickOnCanvas(t);break}case"selection":{if(this.editor.getInstanceState().isReadonly)break;const a=this.editor.getOnlySelectedShape();if(a){const c=this.editor.getShapeUtil(a);if(!this.canInteractWithShapeInReadOnly(a))return;if(t.handle==="right"||t.handle==="left"||t.handle==="top"||t.handle==="bottom"){const l=(r=c.onDoubleClickEdge)==null?void 0:r.call(c,a);if(l){this.editor.mark("double click edge"),this.editor.updateShapes([l]),Ao(this.editor,[a.id]);return}}if(c.canCrop(a)&&!this.editor.isShapeOrAncestorLocked(a)){this.parent.transition("crop",t);return}this.shouldStartEditingShape(a)&&this.startEditingShape(a,t,!0)}break}case"shape":{const{shape:a}=t,c=this.editor.getShapeUtil(a);if(a.type!=="video"&&a.type!=="embed"&&this.editor.getInstanceState().isReadonly)break;if(c.onDoubleClick){const l=(i=c.onDoubleClick)==null?void 0:i.call(c,a);if(l){this.editor.updateShapes([l]);return}else if(c.canCrop(a)&&!this.editor.isShapeOrAncestorLocked(a)){this.editor.mark("select and crop"),this.editor.select((o=t.shape)==null?void 0:o.id),this.parent.transition("crop",t);return}}this.shouldStartEditingShape(a)?this.startEditingShape(a,t,!0):this.handleDoubleClickOnCanvas(t);break}case"handle":{if(this.editor.getInstanceState().isReadonly)break;const{shape:a,handle:c}=t,l=this.editor.getShapeUtil(a),u=(s=l.onDoubleClickHandle)==null?void 0:s.call(l,a,c);u?this.editor.updateShapes([u]):this.shouldStartEditingShape(a)&&this.startEditingShape(a,t,!0)}}});$(this,"onRightClick",t=>{switch(t.target){case"canvas":{const r=this.editor.getHoveredShape(),i=r&&!this.editor.isShapeOfType(r,"group")?r:this.editor.getShapeAtPoint(this.editor.inputs.currentPagePoint,{margin:this.editor.options.hitTestMargin/this.editor.getZoomLevel(),hitInside:!1,hitLabels:!0,hitLocked:!0,hitFrameInside:!1,renderingOnly:!0});if(i){this.onRightClick({...t,shape:i,target:"shape"});return}const o=this.editor.getSelectedShapeIds(),s=this.editor.getOnlySelectedShape(),{inputs:{currentPagePoint:a}}=this.editor;if((o.length>1||s&&!this.editor.getShapeUtil(s).hideSelectionBoundsBg(s))&&S1e(this.editor,a)){this.onRightClick({...t,target:"selection"});return}this.editor.selectNone();break}case"shape":{const{selectedShapeIds:r}=this.editor.getCurrentPageState(),{shape:i}=t,o=this.editor.getOutermostSelectableShape(i,s=>!r.includes(s.id));r.includes(o.id)||(this.editor.mark("selecting shape"),this.editor.setSelectedShapes([o.id]));break}}});$(this,"onCancel",()=>{this.editor.getFocusedGroupId()!==this.editor.getCurrentPageId()&&this.editor.getSelectedShapeIds().length>0?this.editor.popFocusedGroupId():(this.editor.mark("clearing selection"),this.editor.selectNone())});$(this,"onKeyDown",t=>{switch(t.code){case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"ArrowDown":{this.nudgeSelectedShapes(!1);return}}if(ta.editOnType.get()&&!FFt.includes(t.key)&&!t.altKey&&!t.ctrlKey){const r=this.editor.getOnlySelectedShape();if(r&&this.editor.isShapeOfType(r,"note")&&this.shouldStartEditingShape(r)){this.startEditingShape(r,{...t,target:"shape",shape:r},!0);return}}});$(this,"onKeyRepeat",t=>{switch(t.code){case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"ArrowDown":{this.nudgeSelectedShapes(!0);break}}});$(this,"onKeyUp",t=>{switch(t.code){case"Enter":{const r=this.editor.getSelectedShapes();if(r.every(o=>this.editor.isShapeOfType(o,"group"))){this.editor.setSelectedShapes(r.flatMap(o=>this.editor.getSortedChildIdsForParent(o.id)));return}const i=this.editor.getOnlySelectedShape();if(i&&this.shouldStartEditingShape(i)){this.startEditingShape(i,{...t,target:"shape",shape:i},!0);return}b1e(this.editor)&&this.parent.transition("crop",t);break}}});$(this,"isDarwin",window.navigator.userAgent.toLowerCase().indexOf("mac")>-1)}shouldStartEditingShape(t=this.editor.getOnlySelectedShape()){return!t||this.editor.isShapeOrAncestorLocked(t)&&t.type!=="embed"||!this.canInteractWithShapeInReadOnly(t)?!1:this.editor.getShapeUtil(t).canEdit(t)}startEditingShape(t,r,i){this.editor.isShapeOrAncestorLocked(t)&&t.type!=="embed"||(this.editor.mark("editing shape"),p$(this.editor,t,i),this.parent.transition("editing_shape",r))}isOverArrowLabelTest(t){if(!t)return!1;const r=this.editor.getPointInShapeSpace(t,this.editor.inputs.currentPagePoint);if(this.editor.isShapeOfType(t,"arrow")){const i=this.editor.getShapeGeometry(t).children[1];if(i&&Fd(r,i.vertices))return!0}return!1}handleDoubleClickOnCanvas(t){if(this.editor.getInstanceState().isReadonly)return;this.editor.mark("creating text shape");const r=ro(),{x:i,y:o}=this.editor.inputs.currentPagePoint;this.editor.createShapes([{id:r,type:"text",x:i,y:o,props:{text:"",autoSize:!0}}]);const s=this.editor.getShape(r);if(!s)return;const a=this.editor.getShapeUtil(s);this.editor.getInstanceState().isReadonly&&!a.canEditInReadOnly(s)||(this.editor.setEditingShape(r),this.editor.select(r),this.parent.transition("editing_shape",t))}nudgeSelectedShapes(t=!1){const{editor:{inputs:{keys:r}}}=this,i=r.has("ShiftLeft"),o=new H(0,0);if(r.has("ArrowLeft")&&(o.x-=1),r.has("ArrowRight")&&(o.x+=1),r.has("ArrowUp")&&(o.y-=1),r.has("ArrowDown")&&(o.y+=1),o.equals(new H(0,0)))return;t||this.editor.mark("nudge shapes");const{gridSize:s}=this.editor.getDocumentSettings(),a=this.editor.getInstanceState().isGridMode?i?s*UFt:s:i?BFt:HFt,c=this.editor.getSelectedShapeIds();this.editor.nudgeShapes(c,o.mul(a)),Ao(this.editor,c)}canInteractWithShapeInReadOnly(t){return!!(!this.editor.getInstanceState().isReadonly||this.editor.getShapeUtil(t).canEditInReadOnly(t))}},$(WV,"id","idle"),WV);const BFt=10,HFt=1,UFt=5;function S1e(n,e){const t=n.getSelectionRotatedPageBounds();if(!t)return!1;const r=n.getSelectionRotation();return r?Fd(e,t.corners.map(i=>H.RotWith(i,t.point,r))):t.containsPoint(e)}class ULe extends Ln{constructor(){super(...arguments);$(this,"shapeId","");$(this,"markId","");$(this,"wasAlreadySelected",!1);$(this,"didDrag",!1);$(this,"info",{});$(this,"onEnter",t=>{const{shape:r}=t;this.parent.setCurrentToolIdMask(t.onInteractionEnd),this.info=t,this.shapeId=r.id,this.didDrag=!1,this.wasAlreadySelected=this.editor.getOnlySelectedShapeId()===r.id,this.updateCursor();const o=this.editor.getShapeGeometry(r).children[1];if(!o)throw Error(`Expected to find an arrow label geometry for shape: ${r.id}`);const{currentPagePoint:s}=this.editor.inputs,a=this.editor.getPointInShapeSpace(r,s);this._labelDragOffset=H.Sub(o.center,a),this.markId="label-drag start",this.editor.mark(this.markId),this.editor.setSelectedShapes([this.shapeId])});$(this,"onExit",()=>{this.parent.setCurrentToolIdMask(void 0),this.editor.setCursor({type:"default",rotation:0})});$(this,"_labelDragOffset",new H(0,0));$(this,"onPointerMove",()=>{const{isDragging:t}=this.editor.inputs;if(!t)return;const r=this.editor.getShape(this.shapeId);if(!r)return;const i=Xp(this.editor,r),o=this.editor.getShapeGeometry(r),s=o.children[0],a=this.editor.getPointInShapeSpace(r,this.editor.inputs.currentPagePoint),c=s.nearestPoint(H.Add(a,this._labelDragOffset));let l;if(i.isStraight){const u=H.Dist(i.start.point,i.end.point);l=1-H.Dist(i.end.point,c)/u}else{const{_center:u,measure:d,angleEnd:h,angleStart:f}=o.children[0];l=rX(d,f,h,u.angle(c))}isNaN(l)&&(l=.5),this.didDrag=!0,this.editor.updateShape({id:r.id,type:r.type,props:{labelPosition:l}})});$(this,"onPointerUp",()=>{const t=this.editor.getShape(this.shapeId);t&&(this.didDrag||!this.wasAlreadySelected?this.complete():(this.editor.setEditingShape(t.id),this.editor.setCurrentTool("select.editing_shape")))});$(this,"onCancel",()=>{this.cancel()});$(this,"onComplete",()=>{this.cancel()});$(this,"onInterrupt",()=>{this.cancel()})}updateCursor(){this.editor.setCursor({type:"grabbing",rotation:0})}complete(){this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,{}):this.parent.transition("idle")}cancel(){this.editor.bailToMark(this.markId),this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,{}):this.parent.transition("idle")}}$(ULe,"id","pointing_arrow_label");class zLe extends Ln{constructor(){super(...arguments);$(this,"onEnter",()=>{const{inputs:t}=this.editor;t.shiftKey||this.editor.getSelectedShapeIds().length>0&&(this.editor.mark("selecting none"),this.editor.selectNone())});$(this,"onPointerMove",t=>{this.editor.inputs.isDragging&&this.parent.transition("brushing",t)});$(this,"onPointerUp",()=>{v$(this.editor),this.complete()});$(this,"onComplete",()=>{this.complete()});$(this,"onInterrupt",()=>{this.parent.transition("idle")})}complete(){this.parent.transition("idle")}}$(zLe,"id","pointing_canvas");class VLe extends Ln{constructor(){super(...arguments);$(this,"info",{});$(this,"onEnter",t=>{this.info=t;const{shape:r}=t;if(this.editor.isShapeOfType(r,"arrow")){const i=Mu(this.editor,r)[t.handle.id];i&&this.editor.setHintingShapes([i.toId])}this.editor.setCursor({type:"grabbing",rotation:0})});$(this,"onExit",()=>{this.editor.setHintingShapes([]),this.editor.setCursor({type:"default",rotation:0})});$(this,"onPointerUp",()=>{const{shape:t,handle:r}=this.info;if(this.editor.isShapeOfType(t,"note")){const{editor:i}=this,o=_1e(i,t,r,!1);if(o){p$(i,o,!0);return}}this.parent.transition("idle",this.info)});$(this,"onPointerMove",()=>{const{editor:t}=this;t.inputs.isDragging&&this.startDraggingHandle()});$(this,"onLongPress",()=>{this.startDraggingHandle()});$(this,"onCancel",()=>{this.cancel()});$(this,"onComplete",()=>{this.cancel()});$(this,"onInterrupt",()=>{this.cancel()})}startDraggingHandle(){const{editor:t}=this;if(t.getInstanceState().isReadonly)return;const{shape:r,handle:i}=this.info;if(t.isShapeOfType(r,"note")){const o=_1e(t,r,i,!0);if(o){const s=t.getPointInParentSpace(o,t.inputs.originPagePoint).sub(H.Rot(NN.clone().mul(r.props.scale),o.rotation));t.updateShape({...o,x:s.x,y:s.y}),t.setHoveredShape(o.id).select(o.id).setCurrentTool("select.translating",{...this.info,target:"shape",shape:t.getShape(o),onInteractionEnd:"note",isCreating:!0,onCreate:()=>{p$(t,o,!0)}});return}}this.parent.transition("dragging_handle",this.info)}cancel(){this.parent.transition("idle")}}$(VLe,"id","pointing_handle");function _1e(n,e,t,r){const i=n.getShapePageTransform(e.id),o=i.point(),s=i.rotation(),c=aLe(o,s,e.props.growY,0,e.props.scale)[t.index];if(c)return lLe(n,e,c,s,r)}class WLe extends Ln{constructor(){super(...arguments);$(this,"info",{});$(this,"onEnter",t=>{this.parent.setCurrentToolIdMask(t.onInteractionEnd),this.info=t,this.updateCursor()});$(this,"onExit",()=>{this.parent.setCurrentToolIdMask(void 0),this.editor.setCursor({type:"default",rotation:0})});$(this,"onPointerMove",()=>{this.editor.inputs.isDragging&&this.startRotating()});$(this,"onLongPress",()=>{this.startRotating()});$(this,"onPointerUp",()=>{this.complete()});$(this,"onCancel",()=>{this.cancel()});$(this,"onComplete",()=>{this.cancel()});$(this,"onInterrupt",()=>{this.cancel()})}updateCursor(){this.editor.setCursor({type:hx[this.info.handle],rotation:this.editor.getSelectionRotation()})}startRotating(){this.editor.getInstanceState().isReadonly||this.parent.transition("rotating",this.info)}complete(){this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,{}):this.parent.transition("idle")}cancel(){this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,{}):this.parent.transition("idle")}}$(WLe,"id","pointing_rotate_handle");class qLe extends Ln{constructor(){super(...arguments);$(this,"info",{});$(this,"onEnter",t=>{this.info=t});$(this,"onPointerUp",t=>{v$(this.editor),this.parent.transition("idle",t)});$(this,"onPointerMove",t=>{this.editor.inputs.isDragging&&this.startTranslating(t)});$(this,"onLongPress",t=>{this.startTranslating(t)});$(this,"onDoubleClick",t=>{var o,s;const r=this.editor.getHoveredShape(),i=r&&!this.editor.isShapeOfType(r,"group")?r:this.editor.getShapeAtPoint(this.editor.inputs.currentPagePoint,{hitInside:!0,margin:0,renderingOnly:!0});if(i){this.parent.transition("idle"),(s=(o=this.parent).onDoubleClick)==null||s.call(o,{...t,target:"shape",shape:this.editor.getShape(i)});return}});$(this,"onCancel",()=>{this.cancel()});$(this,"onComplete",()=>{this.cancel()});$(this,"onInterrupt",()=>{this.cancel()})}startTranslating(t){this.editor.getInstanceState().isReadonly||this.parent.transition("translating",t)}cancel(){this.parent.transition("idle")}}$(qLe,"id","pointing_selection");class KLe extends Ln{constructor(){super(...arguments);$(this,"hitShape",{});$(this,"hitShapeForPointerUp",{});$(this,"isDoubleClick",!1);$(this,"didSelectOnEnter",!1);$(this,"onEnter",t=>{const r=this.editor.getSelectedShapeIds(),i=this.editor.getSelectionRotatedPageBounds(),o=this.editor.getFocusedGroupId(),{inputs:{currentPagePoint:s,shiftKey:a,altKey:c}}=this.editor;this.hitShape=t.shape,this.isDoubleClick=!1;const l=this.editor.getOutermostSelectableShape(t.shape),u=this.editor.findShapeAncestor(l,d=>r.includes(d.id));if(this.editor.getShapeUtil(t.shape).onClick||l.id===o||r.includes(l.id)||u||r.length>1&&(i!=null&&i.containsPoint(s))){this.didSelectOnEnter=!1,this.hitShapeForPointerUp=l;return}this.didSelectOnEnter=!0,a&&!c?(this.editor.cancelDoubleClick(),r.includes(l.id)||(this.editor.mark("shift selecting shape"),this.editor.setSelectedShapes([...r,l.id]))):(this.editor.mark("selecting shape"),this.editor.setSelectedShapes([l.id]))});$(this,"onPointerUp",t=>{var u;const r=this.editor.getSelectedShapeIds(),i=this.editor.getFocusedGroupId(),o=this.editor.getZoomLevel(),{inputs:{currentPagePoint:s,shiftKey:a}}=this.editor,c=this.editor.getShapeAtPoint(s,{margin:this.editor.options.hitTestMargin/o,hitInside:!0,renderingOnly:!0})??this.hitShape,l=c?this.editor.getOutermostSelectableShape(c):this.hitShapeForPointerUp;if(l){const d=this.editor.getShapeUtil(l);if(d.onClick){const h=(u=d.onClick)==null?void 0:u.call(d,l);if(h){this.editor.mark("shape on click"),this.editor.updateShapes([h]),this.parent.transition("idle",t);return}}if(l.id===i){r.length>0?(this.editor.mark("clearing shape ids"),this.editor.setSelectedShapes([])):this.editor.popFocusedGroupId(),this.parent.transition("idle",t);return}}if(!this.didSelectOnEnter){const d=this.editor.getOutermostSelectableShape(c,h=>!r.includes(h.id));if(r.includes(d.id))if(a)this.editor.mark("deselecting on pointer up"),this.editor.deselect(l);else if(r.includes(l.id)){if(r.length===1){const h=this.editor.getShapeUtil(l).getGeometry(l),f=BLe(h),p=f.length===1?f[0]:void 0;if(p){const g=this.editor.getPointInShapeSpace(l,s);if(p.bounds.containsPoint(g,0)&&p.hitTestPoint(g)){this.editor.batch(()=>{this.editor.mark("editing on pointer up"),this.editor.select(l.id);const m=this.editor.getShapeUtil(l);this.editor.getInstanceState().isReadonly&&!m.canEditInReadOnly(l)||(this.editor.setEditingShape(l.id),this.editor.setCurrentTool("select.editing_shape"),this.isDoubleClick&&this.editor.emit("select-all-text",{shapeId:l.id}))});return}}}this.editor.mark("selecting on pointer up"),this.editor.select(l.id)}else this.editor.mark("selecting on pointer up"),this.editor.select(l);else if(a){const h=this.editor.getShapeAncestors(d);this.editor.mark("shift deselecting on pointer up"),this.editor.setSelectedShapes([...this.editor.getSelectedShapeIds().filter(f=>!h.find(p=>p.id===f)),d.id])}else this.editor.mark("selecting on pointer up"),this.editor.setSelectedShapes([d.id])}this.parent.transition("idle",t)});$(this,"onDoubleClick",()=>{this.isDoubleClick=!0});$(this,"onPointerMove",t=>{this.editor.inputs.isDragging&&this.startTranslating(t)});$(this,"onLongPress",t=>{this.startTranslating(t)});$(this,"onCancel",()=>{this.cancel()});$(this,"onComplete",()=>{this.cancel()});$(this,"onInterrupt",()=>{this.cancel()})}startTranslating(t){this.editor.getInstanceState().isReadonly||(this.editor.focus(),this.parent.transition("translating",t))}cancel(){this.parent.transition("idle")}}$(KLe,"id","pointing_shape");class GLe extends Ln{constructor(){super(...arguments);$(this,"info",{});$(this,"markId","");$(this,"didHoldCommand",!1);$(this,"creationCursorOffset",{x:0,y:0});$(this,"snapshot",{});$(this,"onEnter",t=>{const{isCreating:r=!1,creationCursorOffset:i={x:0,y:0}}=t;this.info=t,this.didHoldCommand=!1,this.parent.setCurrentToolIdMask(t.onInteractionEnd),this.creationCursorOffset=i,this.snapshot=this._createSnapshot(),r?(this.markId=`creating:${this.editor.getOnlySelectedShape().id}`,this.editor.setCursor({type:"cross",rotation:0})):(this.markId="starting resizing",this.editor.mark(this.markId)),this.handleResizeStart(),this.updateShapes()});$(this,"onTick",({elapsed:t})=>{const{editor:r}=this;r.edgeScrollManager.updateEdgeScrolling(t)});$(this,"onPointerMove",()=>{this.updateShapes()});$(this,"onKeyDown",()=>{this.updateShapes()});$(this,"onKeyUp",()=>{this.updateShapes()});$(this,"onPointerUp",()=>{this.complete()});$(this,"onComplete",()=>{this.complete()});$(this,"onCancel",()=>{this.cancel()});$(this,"onExit",()=>{this.parent.setCurrentToolIdMask(void 0),this.editor.setCursor({type:"default",rotation:0}),this.editor.snaps.clearIndicators()});$(this,"_createSnapshot",()=>{const t=this.editor.getSelectedShapeIds(),r=this.editor.getSelectionRotation(),{inputs:{originPagePoint:i}}=this.editor,o=this.editor.getSelectionRotatedPageBounds(),s=H.RotWith(o.getHandlePoint(this.info.handle),o.point,r),a=H.Sub(i,s),c=new Map,l=[];t.forEach(d=>{const h=this.editor.getShape(d);if(h){if(h.type==="frame"&&l.push({id:d,children:qr(this.editor.getSortedChildIdsForParent(h).map(f=>this.editor.getShape(f)))}),c.set(h.id,this._createShapeSnapshot(h)),this.editor.isShapeOfType(h,"frame")&&t.length===1)return;this.editor.visitDescendants(h.id,f=>{const p=this.editor.getShape(f);if(p&&(c.set(p.id,this._createShapeSnapshot(p)),this.editor.isShapeOfType(p,"frame")))return!1})}});const u=![...c.values()].some(d=>!q8e(d.pageRotation,r)||d.isAspectRatioLocked);return{shapeSnapshots:c,selectionBounds:o,cursorHandleOffset:a,selectionRotation:r,selectedShapeIds:t,canShapesDeform:u,initialSelectionPageBounds:this.editor.getSelectionPageBounds(),frames:l}});$(this,"_createShapeSnapshot",t=>{const r=this.editor.getShapePageTransform(t),i=this.editor.getShapeUtil(t);return{shape:t,bounds:this.editor.getShapeGeometry(t).bounds,pageTransform:r,pageRotation:Mn.Decompose(r).rotation,isAspectRatioLocked:i.isAspectRatioLocked(t)}})}cancel(){this.editor.bailToMark(this.markId),this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,{}):this.parent.transition("idle")}complete(){var t,r;if(Ao(this.editor,this.snapshot.selectedShapeIds),this.handleResizeEnd(),this.info.isCreating&&this.info.onCreate){(r=(t=this.info).onCreate)==null||r.call(t,this.editor.getOnlySelectedShape());return}if(this.editor.getInstanceState().isToolLocked&&this.info.onInteractionEnd){this.editor.setCurrentTool(this.info.onInteractionEnd,{});return}this.parent.transition("idle")}handleResizeStart(){const{shapeSnapshots:t}=this.snapshot,r=[];t.forEach(({shape:i})=>{var a;const o=this.editor.getShapeUtil(i),s=(a=o.onResizeStart)==null?void 0:a.call(o,i);s&&r.push(s)}),r.length>0&&this.editor.updateShapes(r)}handleResizeEnd(){const{shapeSnapshots:t}=this.snapshot,r=[];t.forEach(({shape:i})=>{var c;const o=this.editor.getShape(i.id),s=this.editor.getShapeUtil(i),a=(c=s.onResizeEnd)==null?void 0:c.call(s,i,o);a&&r.push(a)}),r.length>0&&this.editor.updateShapes(r)}updateShapes(){const{altKey:t,shiftKey:r}=this.editor.inputs,{frames:i,shapeSnapshots:o,selectionBounds:s,cursorHandleOffset:a,selectedShapeIds:c,selectionRotation:l,canShapesDeform:u}=this.snapshot;let d=r||!u;if(o.size===1){const T=[...o.values()][0];this.editor.isShapeOfType(T.shape,"text")&&(d=!(this.info.handle==="left"||this.info.handle==="right"))}const{ctrlKey:h}=this.editor.inputs,f=this.editor.inputs.currentPagePoint.clone().sub(a).sub(this.creationCursorOffset),p=this.editor.inputs.originPagePoint.clone().sub(a);if(this.editor.getInstanceState().isGridMode&&!h){const{gridSize:T}=this.editor.getDocumentSettings();f.snapToGrid(T)}const g=this.info.handle,m=w1e(g,Math.PI);if(this.editor.snaps.clearIndicators(),(this.editor.user.getIsSnapMode()?!h:h)&&l%Fo===0){const{nudge:T}=this.editor.snaps.shapeBounds.snapResizeShapes({dragDelta:H.Sub(f,p),initialSelectionPageBounds:this.snapshot.initialSelectionPageBounds,handle:w1e(g,l),isAspectRatioLocked:d,isResizingFromCenter:t});f.add(T)}const b=H.RotWith(t?s.center:s.getHandlePoint(m),s.point,l),S=H.Sub(f,b).rot(-l),E=H.Sub(p,b).rot(-l),w=H.DivV(S,E);Number.isFinite(w.x)||(w.x=1),Number.isFinite(w.y)||(w.y=1);const C=g==="top"||g==="bottom",I=g==="left"||g==="right";d?I?w.y=Math.abs(w.x):C?w.x=Math.abs(w.y):Math.abs(w.x)>Math.abs(w.y)?w.y=Math.abs(w.x)*(w.y<0?-1:1):w.x=Math.abs(w.y)*(w.x<0?-1:1):(C&&(w.x=1),I&&(w.y=1)),this.info.isCreating||this.updateCursor({dragHandle:g,isFlippedX:w.x<0,isFlippedY:w.y<0,rotation:l});for(const T of o.keys()){const D=o.get(T);this.editor.resizeShape(T,w,{initialShape:D.shape,initialBounds:D.bounds,initialPageTransform:D.pageTransform,dragHandle:g,mode:c.length===1&&T===c[0]?"resize_bounds":"scale_shape",scaleOrigin:b,isAspectRatioLocked:d,scaleAxisRotation:l,skipStartAndEndCallbacks:!0})}if(this.editor.inputs.ctrlKey){this.didHoldCommand=!0;for(const{id:T,children:D}of i){if(!D.length)continue;const O=o.get(T).shape,M=this.editor.getShape(T);if(!(O&&M))continue;const R=M.x-O.x,A=M.y-O.y,k=new H(R,A).rot(-O.rotation);if(k.x!==0||k.y!==0)for(const L of D)this.editor.updateShape({id:L.id,type:L.type,x:L.x-k.x,y:L.y-k.y})}}else if(this.didHoldCommand){this.didHoldCommand=!1;for(const{children:T}of i)if(T.length)for(const D of T)this.editor.updateShape({id:D.id,type:D.type,x:D.x,y:D.y})}}updateCursor({dragHandle:t,isFlippedX:r,isFlippedY:i,rotation:o}){const s={...this.editor.getInstanceState().cursor};switch(t){case"top_left":case"bottom_right":{s.type="nwse-resize",r!==i&&(s.type="nesw-resize");break}case"top_right":case"bottom_left":{s.type="nesw-resize",r!==i&&(s.type="nwse-resize");break}}s.rotation=o,this.editor.setCursor(s)}}$(GLe,"id","resizing");const GU=["top","top_right","right","bottom_right","bottom","bottom_left","left","top_left"];function w1e(n,e){e=e%Xi;const t=Math.round(e/(Ai/4)),r=GU.indexOf(n);return GU[(r+t)%GU.length]}const C1e=Math.PI/180;class ZLe extends Ln{constructor(){super(...arguments);$(this,"snapshot",{});$(this,"info",{});$(this,"markId","");$(this,"onEnter",t=>{this.info=t,this.parent.setCurrentToolIdMask(t.onInteractionEnd),this.markId="rotate start",this.editor.mark(this.markId);const r=A$e({editor:this.editor});if(!r)return this.parent.transition("idle",this.info);this.snapshot=r;const i=this._getRotationFromPointerPosition({snapToNearestDegree:!1});_O({editor:this.editor,delta:this._getRotationFromPointerPosition({snapToNearestDegree:!1}),snapshot:this.snapshot,stage:"start"}),this.editor.setCursor({type:hx[this.info.handle],rotation:i+this.snapshot.initialSelectionRotation})});$(this,"onExit",()=>{this.editor.setCursor({type:"default",rotation:0}),this.parent.setCurrentToolIdMask(void 0),this.snapshot={}});$(this,"onPointerMove",()=>{this.update()});$(this,"onKeyDown",()=>{this.update()});$(this,"onKeyUp",()=>{this.update()});$(this,"onPointerUp",()=>{this.complete()});$(this,"onComplete",()=>{this.complete()});$(this,"onCancel",()=>{this.cancel()});$(this,"update",()=>{const t=this._getRotationFromPointerPosition({snapToNearestDegree:!1});_O({editor:this.editor,delta:t,snapshot:this.snapshot,stage:"update"}),this.editor.setCursor({type:hx[this.info.handle],rotation:t+this.snapshot.initialSelectionRotation})});$(this,"cancel",()=>{this.editor.bailToMark(this.markId),this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):this.parent.transition("idle",this.info)});$(this,"complete",()=>{_O({editor:this.editor,delta:this._getRotationFromPointerPosition({snapToNearestDegree:!0}),snapshot:this.snapshot,stage:"end"}),Ao(this.editor,this.snapshot.shapeSnapshots.map(t=>t.shape.id)),this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):this.parent.transition("idle",this.info)})}_getRotationFromPointerPosition({snapToNearestDegree:t}){const r=this.editor.getSelectionRotation(),i=this.editor.getSelectionRotatedPageBounds(),{inputs:{shiftKey:o,currentPagePoint:s}}=this.editor,{initialCursorAngle:a,initialSelectionRotation:c}=this.snapshot;if(!i)return c;const u=i.center.clone().rotWith(i.point,r).angle(s)-a;let d=c+u;if(o)d=a$(d,24);else if(t&&(d=Math.round(d/C1e)*C1e,this.editor.getInstanceState().isCoarsePointer)){const h=a$(d,4),f=yO(d,h);Math.abs(f)<dMt(5)&&(d=h)}return d-c}}$(ZLe,"id","rotating");class XLe extends Ln{constructor(){super(...arguments);$(this,"hits",new Set);$(this,"size",0);$(this,"scribbleId","id");$(this,"initialSelectedShapeIds",new Set);$(this,"newlySelectedShapeIds",new Set);$(this,"onEnter",()=>{this.initialSelectedShapeIds=new Set(this.editor.inputs.shiftKey?this.editor.getSelectedShapeIds():[]),this.newlySelectedShapeIds=new Set,this.size=0,this.hits.clear();const t=this.editor.scribbles.addScribble({color:"selection-stroke",opacity:.32,size:12});this.scribbleId=t.id,this.updateScribbleSelection(!0),this.editor.updateInstanceState({brush:null})});$(this,"onExit",()=>{this.editor.scribbles.stop(this.scribbleId)});$(this,"onPointerMove",()=>{this.updateScribbleSelection(!0)});$(this,"onPointerUp",()=>{this.complete()});$(this,"onKeyDown",()=>{this.updateScribbleSelection(!1)});$(this,"onKeyUp",()=>{this.editor.inputs.altKey?this.updateScribbleSelection(!1):this.parent.transition("brushing")});$(this,"onCancel",()=>{this.cancel()});$(this,"onComplete",()=>{this.complete()});$(this,"pushPointToScribble",()=>{const{x:t,y:r}=this.editor.inputs.currentPagePoint;this.editor.scribbles.addPoint(this.scribbleId,t,r)})}updateScribbleSelection(t){const{editor:r}=this,i=this.editor.getCurrentPageShapes(),{inputs:{shiftKey:o,originPagePoint:s,previousPagePoint:a,currentPagePoint:c}}=this.editor,{newlySelectedShapeIds:l,initialSelectedShapeIds:u}=this;t&&this.pushPointToScribble();const d=i;let h,f,p,g;const m=0;for(let S=0,E=d.length;S<E;S++){if(h=d[S],r.isShapeOfType(h,"group")||l.has(h.id)||r.isShapeOrAncestorLocked(h)||(f=r.getShapeGeometry(h),r.isShapeOfType(h,"frame")&&f.bounds.containsPoint(r.getPointInShapeSpace(h,s))))continue;const w=r.getShapePageTransform(h);if(!f||!w)continue;const C=w.clone().invert();p=C.applyToPoint(a),g=C.applyToPoint(c);const{bounds:I}=f;if(!(I.minX-m>Math.max(p.x,g.x)||I.minY-m>Math.max(p.y,g.y)||I.maxX+m<Math.min(p.x,g.x)||I.maxY+m<Math.min(p.y,g.y))&&f.hitTestLineSegment(p,g,m)){const T=this.editor.getOutermostSelectableShape(h),D=this.editor.getShapeMask(T.id);if(D&&Sie(a,c,D)!==null&&!Fd(c,D))continue;l.add(T.id)}}const v=r.getSelectedShapeIds(),b=new Set(o?[...l,...u]:[...l]);(v.length!==b.size||v.some(S=>!b.has(S)))&&this.editor.setSelectedShapes(Array.from(b))}complete(){this.updateScribbleSelection(!0),this.parent.transition("idle")}cancel(){this.editor.setSelectedShapes([...this.initialSelectedShapeIds]),this.parent.transition("idle")}}$(XLe,"id","scribble_brushing");const zFt=20,VFt=100;class WFt{constructor(e){$(this,"prevDroppingShapeId",null);$(this,"droppingNodeTimer",null);$(this,"first",!0);$(this,"dispose",()=>{this.clear()});this.editor=e,e.disposables.add(this.dispose)}updateDroppingNode(e,t){var r;this.first&&(this.editor.setHintingShapes(e.map(i=>this.editor.findShapeAncestor(i,o=>o.type!=="group")).filter(i=>i)),this.prevDroppingShapeId=((r=this.editor.getDroppingOverShape(this.editor.inputs.originPagePoint,e))==null?void 0:r.id)??null,this.first=!1),this.droppingNodeTimer===null?this.setDragTimer(e,zFt,t):this.editor.inputs.pointerVelocity.len()>.5&&(clearTimeout(this.droppingNodeTimer),this.setDragTimer(e,VFt,t))}setDragTimer(e,t,r){this.droppingNodeTimer=this.editor.timers.setTimeout(()=>{this.editor.batch(()=>{this.handleDrag(this.editor.inputs.currentPagePoint,e,r)}),this.droppingNodeTimer=null},t)}handleDrag(e,t,r){var c,l,u,d,h;t=qr(t.map(f=>this.editor.getShape(f.id)));const i=((c=this.editor.getDroppingOverShape(e,t))==null?void 0:c.id)??null;if(i===this.prevDroppingShapeId){this.hintParents(t);return}const{prevDroppingShapeId:o}=this,s=o&&this.editor.getShape(o),a=i&&this.editor.getShape(i);s&&((u=(l=this.editor.getShapeUtil(s)).onDragShapesOut)==null||u.call(l,s,t)),a&&((h=(d=this.editor.getShapeUtil(a)).onDragShapesOver)==null||h.call(d,a,t)),this.hintParents(t),r==null||r(),this.prevDroppingShapeId=i}hintParents(e){const t=new Map;for(const i of e){const o=this.editor.findShapeAncestor(i,s=>s.type!=="group");o&&(t.has(o.id)||t.set(o.id,[]),t.get(o.id).push(i.id))}const r=[];for(const[i,o]of t){const s=this.editor.getShape(i);s&&iLe(this.editor,s).length<o.length&&r.push(s.id)}this.editor.setHintingShapes(r)}dropShapes(e){var r,i;const{prevDroppingShapeId:t}=this;if(this.handleDrag(this.editor.inputs.currentPagePoint,e),t){const o=this.editor.getShape(t);if(!o)return;(i=(r=this.editor.getShapeUtil(o)).onDropShapesOver)==null||i.call(r,o,e)}}clear(){this.prevDroppingShapeId=null,this.droppingNodeTimer!==null&&clearTimeout(this.droppingNodeTimer),this.droppingNodeTimer=null,this.editor.setHintingShapes([]),this.first=!0}}class YLe extends Ln{constructor(){super(...arguments);$(this,"info",{});$(this,"selectionSnapshot",{});$(this,"snapshot",{});$(this,"markId","");$(this,"isCloning",!1);$(this,"isCreating",!1);$(this,"onCreate",()=>{});$(this,"dragAndDropManager",new WFt(this.editor));$(this,"onEnter",t=>{var o;const{isCreating:r=!1,onCreate:i=()=>{}}=t;if(!((o=this.editor.getSelectedShapeIds())!=null&&o.length)){this.parent.transition("idle");return}if(this.info=t,this.parent.setCurrentToolIdMask(t.onInteractionEnd),this.isCreating=r,this.onCreate=i,r?this.markId=`creating:${this.editor.getOnlySelectedShape().id}`:(this.markId="translating",this.editor.mark(this.markId)),this.isCloning=!1,this.info=t,this.editor.setCursor({type:"move",rotation:0}),this.selectionSnapshot=x1e(this.editor),!this.isCreating&&this.editor.inputs.altKey){this.startCloning();return}this.snapshot=this.selectionSnapshot,this.handleStart(),this.updateShapes()});$(this,"onExit",()=>{this.parent.setCurrentToolIdMask(void 0),this.selectionSnapshot={},this.snapshot={},this.editor.snaps.clearIndicators(),this.editor.setCursor({type:"default",rotation:0}),this.dragAndDropManager.clear()});$(this,"onTick",({elapsed:t})=>{const{editor:r}=this;this.dragAndDropManager.updateDroppingNode(this.snapshot.movingShapes,this.updateParentTransforms),r.edgeScrollManager.updateEdgeScrolling(t)});$(this,"onPointerMove",()=>{this.updateShapes()});$(this,"onKeyDown",()=>{if(this.editor.inputs.altKey&&!this.isCloning){this.startCloning();return}this.updateShapes()});$(this,"onKeyUp",()=>{if(!this.editor.inputs.altKey&&this.isCloning){this.stopCloning();return}this.updateShapes()});$(this,"onPointerUp",()=>{this.complete()});$(this,"onComplete",()=>{this.complete()});$(this,"onCancel",()=>{this.cancel()});$(this,"updateParentTransforms",()=>{const{editor:t,snapshot:{shapeSnapshots:r}}=this;r.forEach(i=>{const o=t.getShape(i.shape.id);if(!o)return null;const s=Cu(o.parentId)?null:Mn.Inverse(t.getShapePageTransform(o.parentId));i.parentTransform=s})})}startCloning(){this.isCreating||(this.isCloning=!0,this.reset(),this.markId="translating",this.editor.mark(this.markId),this.editor.duplicateShapes(Array.from(this.editor.getSelectedShapeIds())),this.snapshot=x1e(this.editor),this.handleStart(),this.updateShapes())}stopCloning(){this.isCloning=!1,this.snapshot=this.selectionSnapshot,this.reset(),this.markId="translating",this.editor.mark(this.markId),this.updateShapes()}reset(){this.editor.bailToMark(this.markId)}complete(){var t;this.updateShapes(),this.dragAndDropManager.dropShapes(this.snapshot.movingShapes),Ao(this.editor,this.snapshot.movingShapes.map(r=>r.id)),this.handleEnd(),this.editor.getInstanceState().isToolLocked&&this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd):this.isCreating?(t=this.onCreate)==null||t.call(this,this.editor.getOnlySelectedShape()):this.parent.transition("idle")}cancel(){this.reset(),this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd):this.parent.transition("idle",this.info)}handleStart(){const{movingShapes:t}=this.snapshot,r=[];t.forEach(i=>{var a;const o=this.editor.getShapeUtil(i),s=(a=o.onTranslateStart)==null?void 0:a.call(o,i);s&&r.push(s)}),r.length>0&&this.editor.updateShapes(r),this.editor.setHoveredShape(null)}handleEnd(){const{movingShapes:t}=this.snapshot;if(this.isCloning&&t.length>0){const i=H.Average(t.map(s=>this.editor.getShapePageTransform(s.id).point())),o=H.Sub(i,this.selectionSnapshot.averagePagePoint);H.IsNaN(o)||this.editor.updateInstanceState({duplicateProps:{shapeIds:t.map(s=>s.id),offset:{x:o.x,y:o.y}}})}const r=[];t.forEach(i=>{var c;const o=this.editor.getShape(i.id),s=this.editor.getShapeUtil(i),a=(c=s.onTranslateEnd)==null?void 0:c.call(s,i,o);a&&r.push(a)}),r.length>0&&this.editor.updateShapes(r)}updateShapes(){const{snapshot:t}=this;this.dragAndDropManager.updateDroppingNode(t.movingShapes,this.updateParentTransforms),qFt({editor:this.editor,snapshot:t});const{movingShapes:r}=t,i=[];r.forEach(o=>{var l;const s=this.editor.getShape(o.id),a=this.editor.getShapeUtil(o),c=(l=a.onTranslate)==null?void 0:l.call(a,o,s);c&&i.push(c)}),i.length>0&&this.editor.updateShapes(i)}}$(YLe,"id","translating");function x1e(n){var d;const e=[],t=[],r=n.getSelectedShapeIds(),i=qr(r.map(h=>{const f=n.getShape(h);if(!f)return null;e.push(f);const p=n.getShapePageTransform(h),g=p.point(),m=p.rotation();t.push(g);const v=dv.isId(f.parentId)?null:Mn.Inverse(n.getShapePageTransform(f.parentId));return{shape:f,pagePoint:g,pageRotation:m,parentTransform:v}})),o=n.getOnlySelectedShape();let s=[];if(o)s=n.snaps.shapeBounds.getSnapPoints(o.id);else{const h=n.getSelectionPageBounds();h&&(s=h.cornersAndCenter.map((f,p)=>({id:"selection:"+p,x:f.x,y:f.y})))}let a,c;const{originPagePoint:l}=n.inputs,u=i.filter(h=>n.isShapeOfType(h.shape,"note")&&n.isPointInShape(h.shape,l));if(u.length!==0)if(u.length===1)c=u[0];else{const h=n.getCurrentPageShapesSorted();c=(d=u.map(f=>({snapshot:f,index:h.findIndex(p=>p.id===f.shape.id)})).sort((f,p)=>p.index-f.index)[0])==null?void 0:d.snapshot}return c&&(a=cLe(n,c.pageRotation,c.shape.props.scale,c.shape.props.growY??0)),{averagePagePoint:H.Average(t),movingShapes:e,shapeSnapshots:i,initialPageBounds:n.getSelectionPageBounds(),initialSnapPoints:s,noteAdjacentPositions:a,noteSnapshot:c}}function qFt({editor:n,snapshot:e}){const{inputs:t}=n,{noteSnapshot:r,noteAdjacentPositions:i,initialPageBounds:o,initialSnapPoints:s,shapeSnapshots:a,averagePagePoint:c}=e,l=n.getInstanceState().isGridMode,u=n.getDocumentSettings().gridSize,d=H.Sub(t.currentPagePoint,t.originPagePoint),h=n.inputs.shiftKey?Math.abs(d.x)<Math.abs(d.y)?"x":"y":null;if(h==="x"?d.x=0:h==="y"&&(d.y=0),n.snaps.clearIndicators(),(n.user.getIsSnapMode()?!t.ctrlKey:t.ctrlKey)&&n.inputs.pointerVelocity.len()<.5){const{nudge:m}=n.snaps.shapeBounds.snapTranslateShapes({dragDelta:d,initialSelectionPageBounds:o,lockedAxis:h,initialSelectionSnapPoints:s});d.add(m)}else if(r&&i){const{scale:m}=r.shape.props,v=r.pagePoint.clone().add(d).add(NN.clone().mul(m).rot(r.pageRotation));let b=sLe/n.getZoomLevel(),S=new H(0,0);for(const E of i){const w=H.Sub(v,E),C=w.len();C<b&&(b=C,S=w)}d.sub(S)}const p=H.Add(c,d);l&&!t.ctrlKey&&p.snapToGrid(u);const g=H.Sub(p,c);n.updateShapes(qr(a.map(({shape:m,pagePoint:v,parentTransform:b})=>{const S=H.Add(v,g),E=b?Mn.applyToPoint(b,S):S;return{id:m.id,type:m.type,x:E.x,y:E.y}})))}class YO extends Ln{constructor(){super(...arguments);$(this,"reactor");$(this,"cleanUpDuplicateProps",()=>{const t=this.editor.getSelectedShapeIds(),r=this.editor.getInstanceState();if(!r.duplicateProps)return;const i=new Set(r.duplicateProps.shapeIds);t.length===i.size&&t.every(o=>i.has(o))||this.editor.updateInstanceState({duplicateProps:null})});$(this,"onEnter",()=>{this.reactor=Zy("clean duplicate props",()=>{try{this.cleanUpDuplicateProps()}catch(t){typeof process<"u",console.error(t)}})});$(this,"onExit",()=>{var t;(t=this.reactor)==null||t.call(this),this.editor.getCurrentPageState().editingShapeId&&this.editor.setEditingShape(null)})}}$(YO,"id","select"),$(YO,"initial","idle"),$(YO,"children",()=>[XO,Hie,jFt,zLe,KLe,YLe,MLe,XLe,zie,qLe,$Le,HLe,GLe,ZLe,WLe,ULe,VLe,jLe]);class JLe extends Ln{constructor(){super(...arguments);$(this,"info",{});$(this,"onEnter",t=>{this.info=t});$(this,"onPointerDown",()=>{this.parent.transition("pointing",this.info)})}}$(JLe,"id","idle");class QLe extends Ln{constructor(){super(...arguments);$(this,"info",{});$(this,"onEnter",t=>{this.info=t});$(this,"onPointerUp",()=>{this.complete()});$(this,"onPointerMove",()=>{this.editor.inputs.isDragging&&this.parent.transition("zoom_brushing",this.info)});$(this,"onCancel",()=>{this.cancel()})}complete(){const{currentScreenPoint:t}=this.editor.inputs;this.editor.inputs.altKey?this.editor.zoomOut(t,{animation:{duration:220}}):this.editor.zoomIn(t,{animation:{duration:220}}),this.parent.transition("idle",this.info)}cancel(){this.parent.transition("idle",this.info)}}$(QLe,"id","pointing");class e7e extends Ln{constructor(){super(...arguments);$(this,"info",{});$(this,"zoomBrush",new xn);$(this,"onEnter",t=>{this.info=t,this.update()});$(this,"onExit",()=>{this.editor.updateInstanceState({zoomBrush:null})});$(this,"onPointerMove",()=>{this.update()});$(this,"onPointerUp",()=>{this.complete()});$(this,"onCancel",()=>{this.cancel()})}update(){const{inputs:{originPagePoint:t,currentPagePoint:r}}=this.editor;this.zoomBrush.setTo(xn.FromPoints([t,r])),this.editor.updateInstanceState({zoomBrush:this.zoomBrush.toJson()})}cancel(){this.parent.transition("idle",this.info)}complete(){const{zoomBrush:t}=this,r=8/this.editor.getZoomLevel();if(t.width<r&&t.height<r){const i=this.editor.inputs.currentScreenPoint;this.editor.inputs.altKey?this.editor.zoomOut(i,{animation:{duration:220}}):this.editor.zoomIn(i,{animation:{duration:220}})}else{const i=this.editor.inputs.altKey?this.editor.getZoomLevel()/2:void 0;this.editor.zoomToBounds(t,{targetZoom:i,animation:{duration:220}})}this.parent.transition("idle",this.info)}}$(e7e,"id","zoom_brushing");class JO extends Ln{constructor(){super(...arguments);$(this,"info",{});$(this,"onEnter",t=>{this.info=t,this.parent.setCurrentToolIdMask(t.onInteractionEnd),this.updateCursor()});$(this,"onExit",()=>{this.parent.setCurrentToolIdMask(void 0),this.editor.updateInstanceState({zoomBrush:null,cursor:{type:"default",rotation:0}}),this.parent.setCurrentToolIdMask(void 0)});$(this,"onKeyDown",()=>{this.updateCursor()});$(this,"onKeyUp",t=>{this.updateCursor(),t.code==="KeyZ"&&this.complete()});$(this,"onInterrupt",()=>{this.complete()})}complete(){this.info.onInteractionEnd&&this.info.onInteractionEnd!=="select"?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):this.parent.transition("select")}updateCursor(){this.editor.inputs.altKey?this.editor.setCursor({type:"zoom-out",rotation:0}):this.editor.setCursor({type:"zoom-in",rotation:0})}}$(JO,"id","zoom"),$(JO,"initial","idle"),$(JO,"children",()=>[JLe,e7e,QLe]);const KFt=[KO,GO,ZO,JO,YO];function Dn(n,e,{checkForDefaultPrevented:t=!0}={}){return function(i){if(n==null||n(i),t===!1||!i.defaultPrevented)return e==null?void 0:e(i)}}function GFt(n,e){typeof n=="function"?n(e):n!=null&&(n.current=e)}function HN(...n){return e=>n.forEach(t=>GFt(t,e))}function Vo(...n){return y.useCallback(HN(...n),n)}function ZFt(n,e){const t=y.createContext(e);function r(o){const{children:s,...a}=o,c=y.useMemo(()=>a,Object.values(a));return x.jsx(t.Provider,{value:c,children:s})}function i(o){const s=y.useContext(t);if(s)return s;if(e!==void 0)return e;throw new Error(`\`${o}\` must be used within \`${n}\``)}return r.displayName=n+"Provider",[r,i]}function Lg(n,e=[]){let t=[];function r(o,s){const a=y.createContext(s),c=t.length;t=[...t,s];function l(d){const{scope:h,children:f,...p}=d,g=(h==null?void 0:h[n][c])||a,m=y.useMemo(()=>p,Object.values(p));return x.jsx(g.Provider,{value:m,children:f})}function u(d,h){const f=(h==null?void 0:h[n][c])||a,p=y.useContext(f);if(p)return p;if(s!==void 0)return s;throw new Error(`\`${d}\` must be used within \`${o}\``)}return l.displayName=o+"Provider",[l,u]}const i=()=>{const o=t.map(s=>y.createContext(s));return function(a){const c=(a==null?void 0:a[n])||o;return y.useMemo(()=>({[`__scope${n}`]:{...a,[n]:c}}),[a,c])}};return i.scopeName=n,[r,XFt(i,...e)]}function XFt(...n){const e=n[0];if(n.length===1)return e;const t=()=>{const r=n.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(o){const s=r.reduce((a,{useScope:c,scopeName:l})=>{const d=c(o)[`__scope${l}`];return{...a,...d}},{});return y.useMemo(()=>({[`__scope${e.scopeName}`]:s}),[s])}};return t.scopeName=e.scopeName,t}var Ty=globalThis!=null&&globalThis.document?y.useLayoutEffect:()=>{},YFt=zT.useId||(()=>{}),JFt=0;function Ym(n){const[e,t]=y.useState(YFt());return Ty(()=>{n||t(r=>r??String(JFt++))},[n]),n||(e?`radix-${e}`:"")}function Zc(n){const e=y.useRef(n);return y.useEffect(()=>{e.current=n}),y.useMemo(()=>(...t)=>{var r;return(r=e.current)==null?void 0:r.call(e,...t)},[])}function Yy({prop:n,defaultProp:e,onChange:t=()=>{}}){const[r,i]=QFt({defaultProp:e,onChange:t}),o=n!==void 0,s=o?n:r,a=Zc(t),c=y.useCallback(l=>{if(o){const d=typeof l=="function"?l(n):l;d!==n&&a(d)}else i(l)},[o,n,i,a]);return[s,c]}function QFt({defaultProp:n,onChange:e}){const t=y.useState(n),[r]=t,i=y.useRef(r),o=Zc(e);return y.useEffect(()=>{i.current!==r&&(o(r),i.current=r)},[r,i,o]),t}var KS=y.forwardRef((n,e)=>{const{children:t,...r}=n,i=y.Children.toArray(t),o=i.find(t9t);if(o){const s=o.props.children,a=i.map(c=>c===o?y.Children.count(s)>1?y.Children.only(null):y.isValidElement(s)?s.props.children:null:c);return x.jsx(wX,{...r,ref:e,children:y.isValidElement(s)?y.cloneElement(s,void 0,a):null})}return x.jsx(wX,{...r,ref:e,children:t})});KS.displayName="Slot";var wX=y.forwardRef((n,e)=>{const{children:t,...r}=n;if(y.isValidElement(t)){const i=r9t(t);return y.cloneElement(t,{...n9t(r,t.props),ref:e?HN(e,i):i})}return y.Children.count(t)>1?y.Children.only(null):null});wX.displayName="SlotClone";var e9t=({children:n})=>x.jsx(x.Fragment,{children:n});function t9t(n){return y.isValidElement(n)&&n.type===e9t}function n9t(n,e){const t={...e};for(const r in e){const i=n[r],o=e[r];/^on[A-Z]/.test(r)?i&&o?t[r]=(...a)=>{o(...a),i(...a)}:i&&(t[r]=i):r==="style"?t[r]={...i,...o}:r==="className"&&(t[r]=[i,o].filter(Boolean).join(" "))}return{...n,...t}}function r9t(n){var r,i;let e=(r=Object.getOwnPropertyDescriptor(n.props,"ref"))==null?void 0:r.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?n.ref:(e=(i=Object.getOwnPropertyDescriptor(n,"ref"))==null?void 0:i.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?n.props.ref:n.props.ref||n.ref)}var i9t=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Pi=i9t.reduce((n,e)=>{const t=y.forwardRef((r,i)=>{const{asChild:o,...s}=r,a=o?KS:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),x.jsx(a,{...s,ref:i})});return t.displayName=`Primitive.${e}`,{...n,[e]:t}},{});function Vie(n,e){n&&Wu.flushSync(()=>n.dispatchEvent(e))}function o9t(n,e=globalThis==null?void 0:globalThis.document){const t=Zc(n);y.useEffect(()=>{const r=i=>{i.key==="Escape"&&t(i)};return e.addEventListener("keydown",r,{capture:!0}),()=>e.removeEventListener("keydown",r,{capture:!0})},[t,e])}var s9t="DismissableLayer",CX="dismissableLayer.update",a9t="dismissableLayer.pointerDownOutside",c9t="dismissableLayer.focusOutside",E1e,t7e=y.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),jD=y.forwardRef((n,e)=>{const{disableOutsidePointerEvents:t=!1,onEscapeKeyDown:r,onPointerDownOutside:i,onFocusOutside:o,onInteractOutside:s,onDismiss:a,...c}=n,l=y.useContext(t7e),[u,d]=y.useState(null),h=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,f]=y.useState({}),p=Vo(e,I=>d(I)),g=Array.from(l.layers),[m]=[...l.layersWithOutsidePointerEventsDisabled].slice(-1),v=g.indexOf(m),b=u?g.indexOf(u):-1,S=l.layersWithOutsidePointerEventsDisabled.size>0,E=b>=v,w=u9t(I=>{const T=I.target,D=[...l.branches].some(O=>O.contains(T));!E||D||(i==null||i(I),s==null||s(I),I.defaultPrevented||a==null||a())},h),C=d9t(I=>{const T=I.target;[...l.branches].some(O=>O.contains(T))||(o==null||o(I),s==null||s(I),I.defaultPrevented||a==null||a())},h);return o9t(I=>{b===l.layers.size-1&&(r==null||r(I),!I.defaultPrevented&&a&&(I.preventDefault(),a()))},h),y.useEffect(()=>{if(u)return t&&(l.layersWithOutsidePointerEventsDisabled.size===0&&(E1e=h.body.style.pointerEvents,h.body.style.pointerEvents="none"),l.layersWithOutsidePointerEventsDisabled.add(u)),l.layers.add(u),I1e(),()=>{t&&l.layersWithOutsidePointerEventsDisabled.size===1&&(h.body.style.pointerEvents=E1e)}},[u,h,t,l]),y.useEffect(()=>()=>{u&&(l.layers.delete(u),l.layersWithOutsidePointerEventsDisabled.delete(u),I1e())},[u,l]),y.useEffect(()=>{const I=()=>f({});return document.addEventListener(CX,I),()=>document.removeEventListener(CX,I)},[]),x.jsx(Pi.div,{...c,ref:p,style:{pointerEvents:S?E?"auto":"none":void 0,...n.style},onFocusCapture:Dn(n.onFocusCapture,C.onFocusCapture),onBlurCapture:Dn(n.onBlurCapture,C.onBlurCapture),onPointerDownCapture:Dn(n.onPointerDownCapture,w.onPointerDownCapture)})});jD.displayName=s9t;var l9t="DismissableLayerBranch",n7e=y.forwardRef((n,e)=>{const t=y.useContext(t7e),r=y.useRef(null),i=Vo(e,r);return y.useEffect(()=>{const o=r.current;if(o)return t.branches.add(o),()=>{t.branches.delete(o)}},[t.branches]),x.jsx(Pi.div,{...n,ref:i})});n7e.displayName=l9t;function u9t(n,e=globalThis==null?void 0:globalThis.document){const t=Zc(n),r=y.useRef(!1),i=y.useRef(()=>{});return y.useEffect(()=>{const o=a=>{if(a.target&&!r.current){let c=function(){r7e(a9t,t,l,{discrete:!0})};const l={originalEvent:a};a.pointerType==="touch"?(e.removeEventListener("click",i.current),i.current=c,e.addEventListener("click",i.current,{once:!0})):c()}else e.removeEventListener("click",i.current);r.current=!1},s=window.setTimeout(()=>{e.addEventListener("pointerdown",o)},0);return()=>{window.clearTimeout(s),e.removeEventListener("pointerdown",o),e.removeEventListener("click",i.current)}},[e,t]),{onPointerDownCapture:()=>r.current=!0}}function d9t(n,e=globalThis==null?void 0:globalThis.document){const t=Zc(n),r=y.useRef(!1);return y.useEffect(()=>{const i=o=>{o.target&&!r.current&&r7e(c9t,t,{originalEvent:o},{discrete:!1})};return e.addEventListener("focusin",i),()=>e.removeEventListener("focusin",i)},[e,t]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function I1e(){const n=new CustomEvent(CX);document.dispatchEvent(n)}function r7e(n,e,t,{discrete:r}){const i=t.originalEvent.target,o=new CustomEvent(n,{bubbles:!1,cancelable:!0,detail:t});e&&i.addEventListener(n,e,{once:!0}),r?Vie(i,o):i.dispatchEvent(o)}var h9t=jD,f9t=n7e,ZU="focusScope.autoFocusOnMount",XU="focusScope.autoFocusOnUnmount",P1e={bubbles:!1,cancelable:!0},p9t="FocusScope",UN=y.forwardRef((n,e)=>{const{loop:t=!1,trapped:r=!1,onMountAutoFocus:i,onUnmountAutoFocus:o,...s}=n,[a,c]=y.useState(null),l=Zc(i),u=Zc(o),d=y.useRef(null),h=Vo(e,g=>c(g)),f=y.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;y.useEffect(()=>{if(r){let g=function(S){if(f.paused||!a)return;const E=S.target;a.contains(E)?d.current=E:s0(d.current,{select:!0})},m=function(S){if(f.paused||!a)return;const E=S.relatedTarget;E!==null&&(a.contains(E)||s0(d.current,{select:!0}))},v=function(S){if(document.activeElement===document.body)for(const w of S)w.removedNodes.length>0&&s0(a)};document.addEventListener("focusin",g),document.addEventListener("focusout",m);const b=new MutationObserver(v);return a&&b.observe(a,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",g),document.removeEventListener("focusout",m),b.disconnect()}}},[r,a,f.paused]),y.useEffect(()=>{if(a){T1e.add(f);const g=document.activeElement;if(!a.contains(g)){const v=new CustomEvent(ZU,P1e);a.addEventListener(ZU,l),a.dispatchEvent(v),v.defaultPrevented||(g9t(S9t(i7e(a)),{select:!0}),document.activeElement===g&&s0(a))}return()=>{a.removeEventListener(ZU,l),setTimeout(()=>{const v=new CustomEvent(XU,P1e);a.addEventListener(XU,u),a.dispatchEvent(v),v.defaultPrevented||s0(g??document.body,{select:!0}),a.removeEventListener(XU,u),T1e.remove(f)},0)}}},[a,l,u,f]);const p=y.useCallback(g=>{if(!t&&!r||f.paused)return;const m=g.key==="Tab"&&!g.altKey&&!g.ctrlKey&&!g.metaKey,v=document.activeElement;if(m&&v){const b=g.currentTarget,[S,E]=m9t(b);S&&E?!g.shiftKey&&v===E?(g.preventDefault(),t&&s0(S,{select:!0})):g.shiftKey&&v===S&&(g.preventDefault(),t&&s0(E,{select:!0})):v===b&&g.preventDefault()}},[t,r,f.paused]);return x.jsx(Pi.div,{tabIndex:-1,...s,ref:h,onKeyDown:p})});UN.displayName=p9t;function g9t(n,{select:e=!1}={}){const t=document.activeElement;for(const r of n)if(s0(r,{select:e}),document.activeElement!==t)return}function m9t(n){const e=i7e(n),t=k1e(e,n),r=k1e(e.reverse(),n);return[t,r]}function i7e(n){const e=[],t=document.createTreeWalker(n,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const i=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||i?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;t.nextNode();)e.push(t.currentNode);return e}function k1e(n,e){for(const t of n)if(!v9t(t,{upTo:e}))return t}function v9t(n,{upTo:e}){if(getComputedStyle(n).visibility==="hidden")return!0;for(;n;){if(e!==void 0&&n===e)return!1;if(getComputedStyle(n).display==="none")return!0;n=n.parentElement}return!1}function y9t(n){return n instanceof HTMLInputElement&&"select"in n}function s0(n,{select:e=!1}={}){if(n&&n.focus){const t=document.activeElement;n.focus({preventScroll:!0}),n!==t&&y9t(n)&&e&&n.select()}}var T1e=b9t();function b9t(){let n=[];return{add(e){const t=n[0];e!==t&&(t==null||t.pause()),n=D1e(n,e),n.unshift(e)},remove(e){var t;n=D1e(n,e),(t=n[0])==null||t.resume()}}}function D1e(n,e){const t=[...n],r=t.indexOf(e);return r!==-1&&t.splice(r,1),t}function S9t(n){return n.filter(e=>e.tagName!=="A")}var _9t="Portal",BD=y.forwardRef((n,e)=>{var a;const{container:t,...r}=n,[i,o]=y.useState(!1);Ty(()=>o(!0),[]);const s=t||i&&((a=globalThis==null?void 0:globalThis.document)==null?void 0:a.body);return s?sW.createPortal(x.jsx(Pi.div,{...r,ref:e}),s):null});BD.displayName=_9t;function w9t(n,e){return y.useReducer((t,r)=>e[t][r]??t,n)}var ap=n=>{const{present:e,children:t}=n,r=C9t(e),i=typeof t=="function"?t({present:r.isPresent}):y.Children.only(t),o=Vo(r.ref,x9t(i));return typeof t=="function"||r.isPresent?y.cloneElement(i,{ref:o}):null};ap.displayName="Presence";function C9t(n){const[e,t]=y.useState(),r=y.useRef({}),i=y.useRef(n),o=y.useRef("none"),s=n?"mounted":"unmounted",[a,c]=w9t(s,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return y.useEffect(()=>{const l=yA(r.current);o.current=a==="mounted"?l:"none"},[a]),Ty(()=>{const l=r.current,u=i.current;if(u!==n){const h=o.current,f=yA(l);n?c("MOUNT"):f==="none"||(l==null?void 0:l.display)==="none"?c("UNMOUNT"):c(u&&h!==f?"ANIMATION_OUT":"UNMOUNT"),i.current=n}},[n,c]),Ty(()=>{if(e){const l=d=>{const f=yA(r.current).includes(d.animationName);d.target===e&&f&&Wu.flushSync(()=>c("ANIMATION_END"))},u=d=>{d.target===e&&(o.current=yA(r.current))};return e.addEventListener("animationstart",u),e.addEventListener("animationcancel",l),e.addEventListener("animationend",l),()=>{e.removeEventListener("animationstart",u),e.removeEventListener("animationcancel",l),e.removeEventListener("animationend",l)}}else c("ANIMATION_END")},[e,c]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:y.useCallback(l=>{l&&(r.current=getComputedStyle(l)),t(l)},[])}}function yA(n){return(n==null?void 0:n.animationName)||"none"}function x9t(n){var r,i;let e=(r=Object.getOwnPropertyDescriptor(n.props,"ref"))==null?void 0:r.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?n.ref:(e=(i=Object.getOwnPropertyDescriptor(n,"ref"))==null?void 0:i.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?n.props.ref:n.props.ref||n.ref)}var YU=0;function Wie(){y.useEffect(()=>{const n=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",n[0]??R1e()),document.body.insertAdjacentElement("beforeend",n[1]??R1e()),YU++,()=>{YU===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),YU--}},[])}function R1e(){const n=document.createElement("span");return n.setAttribute("data-radix-focus-guard",""),n.tabIndex=0,n.style.cssText="outline: none; opacity: 0; position: fixed; pointer-events: none",n}var Hp=function(){return Hp=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Hp.apply(this,arguments)};function o7e(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function E9t(n,e,t){if(t||arguments.length===2)for(var r=0,i=e.length,o;r<i;r++)(o||!(r in e))&&(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return n.concat(o||Array.prototype.slice.call(e))}var QO="right-scroll-bar-position",eM="width-before-scroll-bar",I9t="with-scroll-bars-hidden",P9t="--removed-body-scroll-bar-size";function JU(n,e){return typeof n=="function"?n(e):n&&(n.current=e),n}function k9t(n,e){var t=y.useState(function(){return{value:n,callback:e,facade:{get current(){return t.value},set current(r){var i=t.value;i!==r&&(t.value=r,t.callback(r,i))}}}})[0];return t.callback=e,t.facade}var T9t=typeof window<"u"?y.useLayoutEffect:y.useEffect,A1e=new WeakMap;function D9t(n,e){var t=k9t(null,function(r){return n.forEach(function(i){return JU(i,r)})});return T9t(function(){var r=A1e.get(t);if(r){var i=new Set(r),o=new Set(n),s=t.current;i.forEach(function(a){o.has(a)||JU(a,null)}),o.forEach(function(a){i.has(a)||JU(a,s)})}A1e.set(t,n)},[n]),t}function R9t(n){return n}function A9t(n,e){e===void 0&&(e=R9t);var t=[],r=!1,i={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return t.length?t[t.length-1]:n},useMedium:function(o){var s=e(o,r);return t.push(s),function(){t=t.filter(function(a){return a!==s})}},assignSyncMedium:function(o){for(r=!0;t.length;){var s=t;t=[],s.forEach(o)}t={push:function(a){return o(a)},filter:function(){return t}}},assignMedium:function(o){r=!0;var s=[];if(t.length){var a=t;t=[],a.forEach(o),s=t}var c=function(){var u=s;s=[],u.forEach(o)},l=function(){return Promise.resolve().then(c)};l(),t={push:function(u){s.push(u),l()},filter:function(u){return s=s.filter(u),t}}}};return i}function O9t(n){n===void 0&&(n={});var e=A9t(null);return e.options=Hp({async:!0,ssr:!1},n),e}var s7e=function(n){var e=n.sideCar,t=o7e(n,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=e.read();if(!r)throw new Error("Sidecar medium not found");return y.createElement(r,Hp({},t))};s7e.isSideCarExport=!0;function M9t(n,e){return n.useMedium(e),s7e}var a7e=O9t(),QU=function(){},zN=y.forwardRef(function(n,e){var t=y.useRef(null),r=y.useState({onScrollCapture:QU,onWheelCapture:QU,onTouchMoveCapture:QU}),i=r[0],o=r[1],s=n.forwardProps,a=n.children,c=n.className,l=n.removeScrollBar,u=n.enabled,d=n.shards,h=n.sideCar,f=n.noIsolation,p=n.inert,g=n.allowPinchZoom,m=n.as,v=m===void 0?"div":m,b=n.gapMode,S=o7e(n,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),E=h,w=D9t([t,e]),C=Hp(Hp({},S),i);return y.createElement(y.Fragment,null,u&&y.createElement(E,{sideCar:a7e,removeScrollBar:l,shards:d,noIsolation:f,inert:p,setCallbacks:o,allowPinchZoom:!!g,lockRef:t,gapMode:b}),s?y.cloneElement(y.Children.only(a),Hp(Hp({},C),{ref:w})):y.createElement(v,Hp({},C,{className:c,ref:w}),a))});zN.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};zN.classNames={fullWidth:eM,zeroRight:QO};var $9t=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function L9t(){if(!document)return null;var n=document.createElement("style");n.type="text/css";var e=$9t();return e&&n.setAttribute("nonce",e),n}function N9t(n,e){n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}function F9t(n){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(n)}var j9t=function(){var n=0,e=null;return{add:function(t){n==0&&(e=L9t())&&(N9t(e,t),F9t(e)),n++},remove:function(){n--,!n&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},B9t=function(){var n=j9t();return function(e,t){y.useEffect(function(){return n.add(e),function(){n.remove()}},[e&&t])}},c7e=function(){var n=B9t(),e=function(t){var r=t.styles,i=t.dynamic;return n(r,i),null};return e},H9t={left:0,top:0,right:0,gap:0},ez=function(n){return parseInt(n||"",10)||0},U9t=function(n){var e=window.getComputedStyle(document.body),t=e[n==="padding"?"paddingLeft":"marginLeft"],r=e[n==="padding"?"paddingTop":"marginTop"],i=e[n==="padding"?"paddingRight":"marginRight"];return[ez(t),ez(r),ez(i)]},z9t=function(n){if(n===void 0&&(n="margin"),typeof window>"u")return H9t;var e=U9t(n),t=document.documentElement.clientWidth,r=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,r-t+e[2]-e[0])}},V9t=c7e(),XC="data-scroll-locked",W9t=function(n,e,t,r){var i=n.left,o=n.top,s=n.right,a=n.gap;return t===void 0&&(t="margin"),`
  .`.concat(I9t,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(a,"px ").concat(r,`;
  }
  body[`).concat(XC,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(r,";"),t==="margin"&&`
    padding-left: `.concat(i,`px;
    padding-top: `).concat(o,`px;
    padding-right: `).concat(s,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(a,"px ").concat(r,`;
    `),t==="padding"&&"padding-right: ".concat(a,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(QO,` {
    right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(eM,` {
    margin-right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(QO," .").concat(QO,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(eM," .").concat(eM,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(XC,`] {
    `).concat(P9t,": ").concat(a,`px;
  }
`)},O1e=function(){var n=parseInt(document.body.getAttribute(XC)||"0",10);return isFinite(n)?n:0},q9t=function(){y.useEffect(function(){return document.body.setAttribute(XC,(O1e()+1).toString()),function(){var n=O1e()-1;n<=0?document.body.removeAttribute(XC):document.body.setAttribute(XC,n.toString())}},[])},K9t=function(n){var e=n.noRelative,t=n.noImportant,r=n.gapMode,i=r===void 0?"margin":r;q9t();var o=y.useMemo(function(){return z9t(i)},[i]);return y.createElement(V9t,{styles:W9t(o,!e,i,t?"":"!important")})},xX=!1;if(typeof window<"u")try{var bA=Object.defineProperty({},"passive",{get:function(){return xX=!0,!0}});window.addEventListener("test",bA,bA),window.removeEventListener("test",bA,bA)}catch{xX=!1}var gw=xX?{passive:!1}:!1,G9t=function(n){return n.tagName==="TEXTAREA"},l7e=function(n,e){var t=window.getComputedStyle(n);return t[e]!=="hidden"&&!(t.overflowY===t.overflowX&&!G9t(n)&&t[e]==="visible")},Z9t=function(n){return l7e(n,"overflowY")},X9t=function(n){return l7e(n,"overflowX")},M1e=function(n,e){var t=e.ownerDocument,r=e;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var i=u7e(n,r);if(i){var o=d7e(n,r),s=o[1],a=o[2];if(s>a)return!0}r=r.parentNode}while(r&&r!==t.body);return!1},Y9t=function(n){var e=n.scrollTop,t=n.scrollHeight,r=n.clientHeight;return[e,t,r]},J9t=function(n){var e=n.scrollLeft,t=n.scrollWidth,r=n.clientWidth;return[e,t,r]},u7e=function(n,e){return n==="v"?Z9t(e):X9t(e)},d7e=function(n,e){return n==="v"?Y9t(e):J9t(e)},Q9t=function(n,e){return n==="h"&&e==="rtl"?-1:1},ejt=function(n,e,t,r,i){var o=Q9t(n,window.getComputedStyle(e).direction),s=o*r,a=t.target,c=e.contains(a),l=!1,u=s>0,d=0,h=0;do{var f=d7e(n,a),p=f[0],g=f[1],m=f[2],v=g-m-o*p;(p||v)&&u7e(n,a)&&(d+=v,h+=p),a instanceof ShadowRoot?a=a.host:a=a.parentNode}while(!c&&a!==document.body||c&&(e.contains(a)||e===a));return(u&&(Math.abs(d)<1||!i)||!u&&(Math.abs(h)<1||!i))&&(l=!0),l},SA=function(n){return"changedTouches"in n?[n.changedTouches[0].clientX,n.changedTouches[0].clientY]:[0,0]},$1e=function(n){return[n.deltaX,n.deltaY]},L1e=function(n){return n&&"current"in n?n.current:n},tjt=function(n,e){return n[0]===e[0]&&n[1]===e[1]},njt=function(n){return`
  .block-interactivity-`.concat(n,` {pointer-events: none;}
  .allow-interactivity-`).concat(n,` {pointer-events: all;}
`)},rjt=0,mw=[];function ijt(n){var e=y.useRef([]),t=y.useRef([0,0]),r=y.useRef(),i=y.useState(rjt++)[0],o=y.useState(c7e)[0],s=y.useRef(n);y.useEffect(function(){s.current=n},[n]),y.useEffect(function(){if(n.inert){document.body.classList.add("block-interactivity-".concat(i));var g=E9t([n.lockRef.current],(n.shards||[]).map(L1e),!0).filter(Boolean);return g.forEach(function(m){return m.classList.add("allow-interactivity-".concat(i))}),function(){document.body.classList.remove("block-interactivity-".concat(i)),g.forEach(function(m){return m.classList.remove("allow-interactivity-".concat(i))})}}},[n.inert,n.lockRef.current,n.shards]);var a=y.useCallback(function(g,m){if("touches"in g&&g.touches.length===2)return!s.current.allowPinchZoom;var v=SA(g),b=t.current,S="deltaX"in g?g.deltaX:b[0]-v[0],E="deltaY"in g?g.deltaY:b[1]-v[1],w,C=g.target,I=Math.abs(S)>Math.abs(E)?"h":"v";if("touches"in g&&I==="h"&&C.type==="range")return!1;var T=M1e(I,C);if(!T)return!0;if(T?w=I:(w=I==="v"?"h":"v",T=M1e(I,C)),!T)return!1;if(!r.current&&"changedTouches"in g&&(S||E)&&(r.current=w),!w)return!0;var D=r.current||w;return ejt(D,m,g,D==="h"?S:E,!0)},[]),c=y.useCallback(function(g){var m=g;if(!(!mw.length||mw[mw.length-1]!==o)){var v="deltaY"in m?$1e(m):SA(m),b=e.current.filter(function(w){return w.name===m.type&&(w.target===m.target||m.target===w.shadowParent)&&tjt(w.delta,v)})[0];if(b&&b.should){m.cancelable&&m.preventDefault();return}if(!b){var S=(s.current.shards||[]).map(L1e).filter(Boolean).filter(function(w){return w.contains(m.target)}),E=S.length>0?a(m,S[0]):!s.current.noIsolation;E&&m.cancelable&&m.preventDefault()}}},[]),l=y.useCallback(function(g,m,v,b){var S={name:g,delta:m,target:v,should:b,shadowParent:ojt(v)};e.current.push(S),setTimeout(function(){e.current=e.current.filter(function(E){return E!==S})},1)},[]),u=y.useCallback(function(g){t.current=SA(g),r.current=void 0},[]),d=y.useCallback(function(g){l(g.type,$1e(g),g.target,a(g,n.lockRef.current))},[]),h=y.useCallback(function(g){l(g.type,SA(g),g.target,a(g,n.lockRef.current))},[]);y.useEffect(function(){return mw.push(o),n.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:h}),document.addEventListener("wheel",c,gw),document.addEventListener("touchmove",c,gw),document.addEventListener("touchstart",u,gw),function(){mw=mw.filter(function(g){return g!==o}),document.removeEventListener("wheel",c,gw),document.removeEventListener("touchmove",c,gw),document.removeEventListener("touchstart",u,gw)}},[]);var f=n.removeScrollBar,p=n.inert;return y.createElement(y.Fragment,null,p?y.createElement(o,{styles:njt(i)}):null,f?y.createElement(K9t,{gapMode:n.gapMode}):null)}function ojt(n){for(var e=null;n!==null;)n instanceof ShadowRoot&&(e=n.host,n=n.host),n=n.parentNode;return e}const sjt=M9t(a7e,ijt);var VN=y.forwardRef(function(n,e){return y.createElement(zN,Hp({},n,{ref:e,sideCar:sjt}))});VN.classNames=zN.classNames;var ajt=function(n){if(typeof document>"u")return null;var e=Array.isArray(n)?n[0]:n;return e.ownerDocument.body},vw=new WeakMap,_A=new WeakMap,wA={},tz=0,h7e=function(n){return n&&(n.host||h7e(n.parentNode))},cjt=function(n,e){return e.map(function(t){if(n.contains(t))return t;var r=h7e(t);return r&&n.contains(r)?r:(console.error("aria-hidden",t,"in not contained inside",n,". Doing nothing"),null)}).filter(function(t){return!!t})},ljt=function(n,e,t,r){var i=cjt(e,Array.isArray(n)?n:[n]);wA[t]||(wA[t]=new WeakMap);var o=wA[t],s=[],a=new Set,c=new Set(i),l=function(d){!d||a.has(d)||(a.add(d),l(d.parentNode))};i.forEach(l);var u=function(d){!d||c.has(d)||Array.prototype.forEach.call(d.children,function(h){if(a.has(h))u(h);else try{var f=h.getAttribute(r),p=f!==null&&f!=="false",g=(vw.get(h)||0)+1,m=(o.get(h)||0)+1;vw.set(h,g),o.set(h,m),s.push(h),g===1&&p&&_A.set(h,!0),m===1&&h.setAttribute(t,"true"),p||h.setAttribute(r,"true")}catch(v){console.error("aria-hidden: cannot operate on ",h,v)}})};return u(e),a.clear(),tz++,function(){s.forEach(function(d){var h=vw.get(d)-1,f=o.get(d)-1;vw.set(d,h),o.set(d,f),h||(_A.has(d)||d.removeAttribute(r),_A.delete(d)),f||d.removeAttribute(t)}),tz--,tz||(vw=new WeakMap,vw=new WeakMap,_A=new WeakMap,wA={})}},qie=function(n,e,t){t===void 0&&(t="data-aria-hidden");var r=Array.from(Array.isArray(n)?n:[n]),i=ajt(n);return i?(r.push.apply(r,Array.from(i.querySelectorAll("[aria-live]"))),ljt(r,i,t,"aria-hidden")):function(){return null}},Kie="Dialog",[f7e,jln]=Lg(Kie),[ujt,cp]=f7e(Kie),p7e=n=>{const{__scopeDialog:e,children:t,open:r,defaultOpen:i,onOpenChange:o,modal:s=!0}=n,a=y.useRef(null),c=y.useRef(null),[l=!1,u]=Yy({prop:r,defaultProp:i,onChange:o});return x.jsx(ujt,{scope:e,triggerRef:a,contentRef:c,contentId:Ym(),titleId:Ym(),descriptionId:Ym(),open:l,onOpenChange:u,onOpenToggle:y.useCallback(()=>u(d=>!d),[u]),modal:s,children:t})};p7e.displayName=Kie;var g7e="DialogTrigger",djt=y.forwardRef((n,e)=>{const{__scopeDialog:t,...r}=n,i=cp(g7e,t),o=Vo(e,i.triggerRef);return x.jsx(Pi.button,{type:"button","aria-haspopup":"dialog","aria-expanded":i.open,"aria-controls":i.contentId,"data-state":Xie(i.open),...r,ref:o,onClick:Dn(n.onClick,i.onOpenToggle)})});djt.displayName=g7e;var Gie="DialogPortal",[hjt,m7e]=f7e(Gie,{forceMount:void 0}),v7e=n=>{const{__scopeDialog:e,forceMount:t,children:r,container:i}=n,o=cp(Gie,e);return x.jsx(hjt,{scope:e,forceMount:t,children:y.Children.map(r,s=>x.jsx(ap,{present:t||o.open,children:x.jsx(BD,{asChild:!0,container:i,children:s})}))})};v7e.displayName=Gie;var y$="DialogOverlay",y7e=y.forwardRef((n,e)=>{const t=m7e(y$,n.__scopeDialog),{forceMount:r=t.forceMount,...i}=n,o=cp(y$,n.__scopeDialog);return o.modal?x.jsx(ap,{present:r||o.open,children:x.jsx(fjt,{...i,ref:e})}):null});y7e.displayName=y$;var fjt=y.forwardRef((n,e)=>{const{__scopeDialog:t,...r}=n,i=cp(y$,t);return x.jsx(VN,{as:KS,allowPinchZoom:!0,shards:[i.contentRef],children:x.jsx(Pi.div,{"data-state":Xie(i.open),...r,ref:e,style:{pointerEvents:"auto",...r.style}})})}),GS="DialogContent",b7e=y.forwardRef((n,e)=>{const t=m7e(GS,n.__scopeDialog),{forceMount:r=t.forceMount,...i}=n,o=cp(GS,n.__scopeDialog);return x.jsx(ap,{present:r||o.open,children:o.modal?x.jsx(pjt,{...i,ref:e}):x.jsx(gjt,{...i,ref:e})})});b7e.displayName=GS;var pjt=y.forwardRef((n,e)=>{const t=cp(GS,n.__scopeDialog),r=y.useRef(null),i=Vo(e,t.contentRef,r);return y.useEffect(()=>{const o=r.current;if(o)return qie(o)},[]),x.jsx(S7e,{...n,ref:i,trapFocus:t.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Dn(n.onCloseAutoFocus,o=>{var s;o.preventDefault(),(s=t.triggerRef.current)==null||s.focus()}),onPointerDownOutside:Dn(n.onPointerDownOutside,o=>{const s=o.detail.originalEvent,a=s.button===0&&s.ctrlKey===!0;(s.button===2||a)&&o.preventDefault()}),onFocusOutside:Dn(n.onFocusOutside,o=>o.preventDefault())})}),gjt=y.forwardRef((n,e)=>{const t=cp(GS,n.__scopeDialog),r=y.useRef(!1),i=y.useRef(!1);return x.jsx(S7e,{...n,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{var s,a;(s=n.onCloseAutoFocus)==null||s.call(n,o),o.defaultPrevented||(r.current||(a=t.triggerRef.current)==null||a.focus(),o.preventDefault()),r.current=!1,i.current=!1},onInteractOutside:o=>{var c,l;(c=n.onInteractOutside)==null||c.call(n,o),o.defaultPrevented||(r.current=!0,o.detail.originalEvent.type==="pointerdown"&&(i.current=!0));const s=o.target;((l=t.triggerRef.current)==null?void 0:l.contains(s))&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&i.current&&o.preventDefault()}})}),S7e=y.forwardRef((n,e)=>{const{__scopeDialog:t,trapFocus:r,onOpenAutoFocus:i,onCloseAutoFocus:o,...s}=n,a=cp(GS,t),c=y.useRef(null),l=Vo(e,c);return Wie(),x.jsxs(x.Fragment,{children:[x.jsx(UN,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:i,onUnmountAutoFocus:o,children:x.jsx(jD,{role:"dialog",id:a.contentId,"aria-describedby":a.descriptionId,"aria-labelledby":a.titleId,"data-state":Xie(a.open),...s,ref:l,onDismiss:()=>a.onOpenChange(!1)})}),x.jsxs(x.Fragment,{children:[x.jsx(vjt,{titleId:a.titleId}),x.jsx(bjt,{contentRef:c,descriptionId:a.descriptionId})]})]})}),Zie="DialogTitle",_7e=y.forwardRef((n,e)=>{const{__scopeDialog:t,...r}=n,i=cp(Zie,t);return x.jsx(Pi.h2,{id:i.titleId,...r,ref:e})});_7e.displayName=Zie;var w7e="DialogDescription",mjt=y.forwardRef((n,e)=>{const{__scopeDialog:t,...r}=n,i=cp(w7e,t);return x.jsx(Pi.p,{id:i.descriptionId,...r,ref:e})});mjt.displayName=w7e;var C7e="DialogClose",x7e=y.forwardRef((n,e)=>{const{__scopeDialog:t,...r}=n,i=cp(C7e,t);return x.jsx(Pi.button,{type:"button",...r,ref:e,onClick:Dn(n.onClick,()=>i.onOpenChange(!1))})});x7e.displayName=C7e;function Xie(n){return n?"open":"closed"}var E7e="DialogTitleWarning",[Bln,I7e]=ZFt(E7e,{contentName:GS,titleName:Zie,docsSlug:"dialog"}),vjt=({titleId:n})=>{const e=I7e(E7e),t=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return y.useEffect(()=>{n&&(document.getElementById(n)||console.error(t))},[t,n]),null},yjt="DialogDescriptionWarning",bjt=({contentRef:n,descriptionId:e})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${I7e(yjt).contentName}}.`;return y.useEffect(()=>{var o;const i=(o=n.current)==null?void 0:o.getAttribute("aria-describedby");e&&i&&(document.getElementById(e)||console.warn(r))},[r,n,e]),null},Sjt=p7e,_jt=v7e,wjt=y7e,Cjt=b7e;const P7e=()=>{},k7e=y.createContext(null);function xjt({onEvent:n,children:e}){return x.jsx(k7e.Provider,{value:n??P7e,children:e})}function lp(){return y.useContext(k7e)??P7e}const T7e=y.createContext(null);function Ejt({children:n}){const e=ot(),t=lp(),[r,i]=y.useState([]),o=y.useCallback(l=>{const u=l.id??us();return i(d=>[...d.filter(h=>h.id!==l.id),{...l,id:u}]),t("open-menu",{source:"dialog",id:u}),e.addOpenMenu(u),u},[e,t]),s=y.useCallback((l,u)=>(i(d=>d.map(h=>h.id===l?{...h,...u}:h)),t("open-menu",{source:"dialog",id:l}),e.addOpenMenu(l),l),[e,t]),a=y.useCallback(l=>(i(u=>u.filter(d=>{var h;return d.id===l?((h=d.onClose)==null||h.call(d),!1):!0})),t("close-menu",{source:"dialog",id:l}),e.deleteOpenMenu(l),l),[e,t]),c=y.useCallback(()=>{i(l=>(l.forEach(u=>{var d;(d=u.onClose)==null||d.call(u),t("close-menu",{source:"dialog",id:u.id}),e.deleteOpenMenu(u.id)}),[]))},[e,t]);return x.jsx(T7e.Provider,{value:{dialogs:r,addDialog:o,removeDialog:a,clearDialogs:c,updateDialog:s},children:n})}function g_(){const n=y.useContext(T7e);if(!n)throw new Error("useDialogs must be used within a DialogsProvider");return n}const Ijt=({id:n,component:e,onClose:t})=>{const{removeDialog:r}=g_(),i=Il(),o=y.useCallback(s=>{if(!s){if(t)try{t()}catch(a){console.warn(a)}r(n)}},[n,t,r]);return x.jsx(Sjt,{onOpenChange:o,defaultOpen:!0,children:x.jsx(_jt,{container:i,children:x.jsx(wjt,{dir:"ltr",className:"tlui-dialog__overlay",onClick:s=>{s.target===s.currentTarget&&o(!1)},children:x.jsx(Cjt,{dir:"ltr",className:"tlui-dialog__content",children:x.jsx(e,{onClose:()=>o(!1)})})})})})};function Pjt(){const{dialogs:n}=g_();return x.jsx(x.Fragment,{children:n.map(e=>x.jsx(Ijt,{...e},e.id))})}const kjt=Ke.memo(Pjt);function Tjt(){const n=ot(),e=_t("follow",()=>n.getInstanceState().followingUserId,[n]);return e?x.jsx(Djt,{userId:e}):null}function Djt({userId:n}){const e=c$e(n);return e?x.jsx("div",{className:"tlui-following-indicator",style:{borderColor:e.color}}):null}function WN(n){const e=n+"CollectionProvider",[t,r]=Lg(e),[i,o]=t(e,{collectionRef:{current:null},itemMap:new Map}),s=f=>{const{scope:p,children:g}=f,m=Ke.useRef(null),v=Ke.useRef(new Map).current;return x.jsx(i,{scope:p,itemMap:v,collectionRef:m,children:g})};s.displayName=e;const a=n+"CollectionSlot",c=Ke.forwardRef((f,p)=>{const{scope:g,children:m}=f,v=o(a,g),b=Vo(p,v.collectionRef);return x.jsx(KS,{ref:b,children:m})});c.displayName=a;const l=n+"CollectionItemSlot",u="data-radix-collection-item",d=Ke.forwardRef((f,p)=>{const{scope:g,children:m,...v}=f,b=Ke.useRef(null),S=Vo(p,b),E=o(l,g);return Ke.useEffect(()=>(E.itemMap.set(b,{ref:b,...v}),()=>void E.itemMap.delete(b))),x.jsx(KS,{[u]:"",ref:S,children:m})});d.displayName=l;function h(f){const p=o(n+"CollectionConsumer",f);return Ke.useCallback(()=>{const m=p.collectionRef.current;if(!m)return[];const v=Array.from(m.querySelectorAll(`[${u}]`));return Array.from(p.itemMap.values()).sort((E,w)=>v.indexOf(E.ref.current)-v.indexOf(w.ref.current))},[p.collectionRef,p.itemMap])}return[{Provider:s,Slot:c,ItemSlot:d},h,r]}var Rjt="VisuallyHidden",Yie=y.forwardRef((n,e)=>x.jsx(Pi.span,{...n,ref:e,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...n.style}}));Yie.displayName=Rjt;var Jie="ToastProvider",[Qie,Ajt,Ojt]=WN("Toast"),[D7e,Hln]=Lg("Toast",[Ojt]),[Mjt,qN]=D7e(Jie),R7e=n=>{const{__scopeToast:e,label:t="Notification",duration:r=5e3,swipeDirection:i="right",swipeThreshold:o=50,children:s}=n,[a,c]=y.useState(null),[l,u]=y.useState(0),d=y.useRef(!1),h=y.useRef(!1);return t.trim()||console.error(`Invalid prop \`label\` supplied to \`${Jie}\`. Expected non-empty \`string\`.`),x.jsx(Qie.Provider,{scope:e,children:x.jsx(Mjt,{scope:e,label:t,duration:r,swipeDirection:i,swipeThreshold:o,toastCount:l,viewport:a,onViewportChange:c,onToastAdd:y.useCallback(()=>u(f=>f+1),[]),onToastRemove:y.useCallback(()=>u(f=>f-1),[]),isFocusedToastEscapeKeyDownRef:d,isClosePausedRef:h,children:s})})};R7e.displayName=Jie;var A7e="ToastViewport",$jt=["F8"],EX="toast.viewportPause",IX="toast.viewportResume",O7e=y.forwardRef((n,e)=>{const{__scopeToast:t,hotkey:r=$jt,label:i="Notifications ({hotkey})",...o}=n,s=qN(A7e,t),a=Ajt(t),c=y.useRef(null),l=y.useRef(null),u=y.useRef(null),d=y.useRef(null),h=Vo(e,d,s.onViewportChange),f=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),p=s.toastCount>0;y.useEffect(()=>{const m=v=>{var S;r.every(E=>v[E]||v.code===E)&&((S=d.current)==null||S.focus())};return document.addEventListener("keydown",m),()=>document.removeEventListener("keydown",m)},[r]),y.useEffect(()=>{const m=c.current,v=d.current;if(p&&m&&v){const b=()=>{if(!s.isClosePausedRef.current){const C=new CustomEvent(EX);v.dispatchEvent(C),s.isClosePausedRef.current=!0}},S=()=>{if(s.isClosePausedRef.current){const C=new CustomEvent(IX);v.dispatchEvent(C),s.isClosePausedRef.current=!1}},E=C=>{!m.contains(C.relatedTarget)&&S()},w=()=>{m.contains(document.activeElement)||S()};return m.addEventListener("focusin",b),m.addEventListener("focusout",E),m.addEventListener("pointermove",b),m.addEventListener("pointerleave",w),window.addEventListener("blur",b),window.addEventListener("focus",S),()=>{m.removeEventListener("focusin",b),m.removeEventListener("focusout",E),m.removeEventListener("pointermove",b),m.removeEventListener("pointerleave",w),window.removeEventListener("blur",b),window.removeEventListener("focus",S)}}},[p,s.isClosePausedRef]);const g=y.useCallback(({tabbingDirection:m})=>{const b=a().map(S=>{const E=S.ref.current,w=[E,...Gjt(E)];return m==="forwards"?w:w.reverse()});return(m==="forwards"?b.reverse():b).flat()},[a]);return y.useEffect(()=>{const m=d.current;if(m){const v=b=>{var w,C,I;const S=b.altKey||b.ctrlKey||b.metaKey;if(b.key==="Tab"&&!S){const T=document.activeElement,D=b.shiftKey;if(b.target===m&&D){(w=l.current)==null||w.focus();return}const R=g({tabbingDirection:D?"backwards":"forwards"}),A=R.findIndex(k=>k===T);nz(R.slice(A+1))?b.preventDefault():D?(C=l.current)==null||C.focus():(I=u.current)==null||I.focus()}};return m.addEventListener("keydown",v),()=>m.removeEventListener("keydown",v)}},[a,g]),x.jsxs(f9t,{ref:c,role:"region","aria-label":i.replace("{hotkey}",f),tabIndex:-1,style:{pointerEvents:p?void 0:"none"},children:[p&&x.jsx(PX,{ref:l,onFocusFromOutsideViewport:()=>{const m=g({tabbingDirection:"forwards"});nz(m)}}),x.jsx(Qie.Slot,{scope:t,children:x.jsx(Pi.ol,{tabIndex:-1,...o,ref:h})}),p&&x.jsx(PX,{ref:u,onFocusFromOutsideViewport:()=>{const m=g({tabbingDirection:"backwards"});nz(m)}})]})});O7e.displayName=A7e;var M7e="ToastFocusProxy",PX=y.forwardRef((n,e)=>{const{__scopeToast:t,onFocusFromOutsideViewport:r,...i}=n,o=qN(M7e,t);return x.jsx(Yie,{"aria-hidden":!0,tabIndex:0,...i,ref:e,style:{position:"fixed"},onFocus:s=>{var l;const a=s.relatedTarget;!((l=o.viewport)!=null&&l.contains(a))&&r()}})});PX.displayName=M7e;var KN="Toast",Ljt="toast.swipeStart",Njt="toast.swipeMove",Fjt="toast.swipeCancel",jjt="toast.swipeEnd",$7e=y.forwardRef((n,e)=>{const{forceMount:t,open:r,defaultOpen:i,onOpenChange:o,...s}=n,[a=!0,c]=Yy({prop:r,defaultProp:i,onChange:o});return x.jsx(ap,{present:t||a,children:x.jsx(Ujt,{open:a,...s,ref:e,onClose:()=>c(!1),onPause:Zc(n.onPause),onResume:Zc(n.onResume),onSwipeStart:Dn(n.onSwipeStart,l=>{l.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:Dn(n.onSwipeMove,l=>{const{x:u,y:d}=l.detail.delta;l.currentTarget.setAttribute("data-swipe","move"),l.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${u}px`),l.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${d}px`)}),onSwipeCancel:Dn(n.onSwipeCancel,l=>{l.currentTarget.setAttribute("data-swipe","cancel"),l.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),l.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),l.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),l.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:Dn(n.onSwipeEnd,l=>{const{x:u,y:d}=l.detail.delta;l.currentTarget.setAttribute("data-swipe","end"),l.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),l.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),l.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${u}px`),l.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${d}px`),c(!1)})})})});$7e.displayName=KN;var[Bjt,Hjt]=D7e(KN,{onClose(){}}),Ujt=y.forwardRef((n,e)=>{const{__scopeToast:t,type:r="foreground",duration:i,open:o,onClose:s,onEscapeKeyDown:a,onPause:c,onResume:l,onSwipeStart:u,onSwipeMove:d,onSwipeCancel:h,onSwipeEnd:f,...p}=n,g=qN(KN,t),[m,v]=y.useState(null),b=Vo(e,k=>v(k)),S=y.useRef(null),E=y.useRef(null),w=i||g.duration,C=y.useRef(0),I=y.useRef(w),T=y.useRef(0),{onToastAdd:D,onToastRemove:O}=g,M=Zc(()=>{var L;(m==null?void 0:m.contains(document.activeElement))&&((L=g.viewport)==null||L.focus()),s()}),R=y.useCallback(k=>{!k||k===1/0||(window.clearTimeout(T.current),C.current=new Date().getTime(),T.current=window.setTimeout(M,k))},[M]);y.useEffect(()=>{const k=g.viewport;if(k){const L=()=>{R(I.current),l==null||l()},j=()=>{const N=new Date().getTime()-C.current;I.current=I.current-N,window.clearTimeout(T.current),c==null||c()};return k.addEventListener(EX,j),k.addEventListener(IX,L),()=>{k.removeEventListener(EX,j),k.removeEventListener(IX,L)}}},[g.viewport,w,c,l,R]),y.useEffect(()=>{o&&!g.isClosePausedRef.current&&R(w)},[o,w,g.isClosePausedRef,R]),y.useEffect(()=>(D(),()=>O()),[D,O]);const A=y.useMemo(()=>m?U7e(m):null,[m]);return g.viewport?x.jsxs(x.Fragment,{children:[A&&x.jsx(zjt,{__scopeToast:t,role:"status","aria-live":r==="foreground"?"assertive":"polite","aria-atomic":!0,children:A}),x.jsx(Bjt,{scope:t,onClose:M,children:Wu.createPortal(x.jsx(Qie.ItemSlot,{scope:t,children:x.jsx(h9t,{asChild:!0,onEscapeKeyDown:Dn(a,()=>{g.isFocusedToastEscapeKeyDownRef.current||M(),g.isFocusedToastEscapeKeyDownRef.current=!1}),children:x.jsx(Pi.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":o?"open":"closed","data-swipe-direction":g.swipeDirection,...p,ref:b,style:{userSelect:"none",touchAction:"none",...n.style},onKeyDown:Dn(n.onKeyDown,k=>{k.key==="Escape"&&(a==null||a(k.nativeEvent),k.nativeEvent.defaultPrevented||(g.isFocusedToastEscapeKeyDownRef.current=!0,M()))}),onPointerDown:Dn(n.onPointerDown,k=>{k.button===0&&(S.current={x:k.clientX,y:k.clientY})}),onPointerMove:Dn(n.onPointerMove,k=>{if(!S.current)return;const L=k.clientX-S.current.x,j=k.clientY-S.current.y,N=!!E.current,B=["left","right"].includes(g.swipeDirection),U=["left","up"].includes(g.swipeDirection)?Math.min:Math.max,K=B?U(0,L):0,z=B?0:U(0,j),G=k.pointerType==="touch"?10:2,te={x:K,y:z},ie={originalEvent:k,delta:te};N?(E.current=te,CA(Njt,d,ie,{discrete:!1})):N1e(te,g.swipeDirection,G)?(E.current=te,CA(Ljt,u,ie,{discrete:!1}),k.target.setPointerCapture(k.pointerId)):(Math.abs(L)>G||Math.abs(j)>G)&&(S.current=null)}),onPointerUp:Dn(n.onPointerUp,k=>{const L=E.current,j=k.target;if(j.hasPointerCapture(k.pointerId)&&j.releasePointerCapture(k.pointerId),E.current=null,S.current=null,L){const N=k.currentTarget,B={originalEvent:k,delta:L};N1e(L,g.swipeDirection,g.swipeThreshold)?CA(jjt,f,B,{discrete:!0}):CA(Fjt,h,B,{discrete:!0}),N.addEventListener("click",U=>U.preventDefault(),{once:!0})}})})})}),g.viewport)})]}):null}),zjt=n=>{const{__scopeToast:e,children:t,...r}=n,i=qN(KN,e),[o,s]=y.useState(!1),[a,c]=y.useState(!1);return qjt(()=>s(!0)),y.useEffect(()=>{const l=window.setTimeout(()=>c(!0),1e3);return()=>window.clearTimeout(l)},[]),a?null:x.jsx(BD,{asChild:!0,children:x.jsx(Yie,{...r,children:o&&x.jsxs(x.Fragment,{children:[i.label," ",t]})})})},Vjt="ToastTitle",L7e=y.forwardRef((n,e)=>{const{__scopeToast:t,...r}=n;return x.jsx(Pi.div,{...r,ref:e})});L7e.displayName=Vjt;var Wjt="ToastDescription",N7e=y.forwardRef((n,e)=>{const{__scopeToast:t,...r}=n;return x.jsx(Pi.div,{...r,ref:e})});N7e.displayName=Wjt;var F7e="ToastAction",j7e=y.forwardRef((n,e)=>{const{altText:t,...r}=n;return t.trim()?x.jsx(H7e,{altText:t,asChild:!0,children:x.jsx(eoe,{...r,ref:e})}):(console.error(`Invalid prop \`altText\` supplied to \`${F7e}\`. Expected non-empty \`string\`.`),null)});j7e.displayName=F7e;var B7e="ToastClose",eoe=y.forwardRef((n,e)=>{const{__scopeToast:t,...r}=n,i=Hjt(B7e,t);return x.jsx(H7e,{asChild:!0,children:x.jsx(Pi.button,{type:"button",...r,ref:e,onClick:Dn(n.onClick,i.onClose)})})});eoe.displayName=B7e;var H7e=y.forwardRef((n,e)=>{const{__scopeToast:t,altText:r,...i}=n;return x.jsx(Pi.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":r||void 0,...i,ref:e})});function U7e(n){const e=[];return Array.from(n.childNodes).forEach(r=>{if(r.nodeType===r.TEXT_NODE&&r.textContent&&e.push(r.textContent),Kjt(r)){const i=r.ariaHidden||r.hidden||r.style.display==="none",o=r.dataset.radixToastAnnounceExclude==="";if(!i)if(o){const s=r.dataset.radixToastAnnounceAlt;s&&e.push(s)}else e.push(...U7e(r))}}),e}function CA(n,e,t,{discrete:r}){const i=t.originalEvent.currentTarget,o=new CustomEvent(n,{bubbles:!0,cancelable:!0,detail:t});e&&i.addEventListener(n,e,{once:!0}),r?Vie(i,o):i.dispatchEvent(o)}var N1e=(n,e,t=0)=>{const r=Math.abs(n.x),i=Math.abs(n.y),o=r>i;return e==="left"||e==="right"?o&&r>t:!o&&i>t};function qjt(n=()=>{}){const e=Zc(n);Ty(()=>{let t=0,r=0;return t=window.requestAnimationFrame(()=>r=window.requestAnimationFrame(e)),()=>{window.cancelAnimationFrame(t),window.cancelAnimationFrame(r)}},[e])}function Kjt(n){return n.nodeType===n.ELEMENT_NODE}function Gjt(n){const e=[],t=document.createTreeWalker(n,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const i=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||i?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;t.nextNode();)e.push(t.currentNode);return e}function nz(n){const e=document.activeElement;return n.some(t=>t===e?!0:(t.focus(),document.activeElement!==e))}var Zjt=$7e,Xjt=L7e,Yjt=N7e,Jjt=j7e,F1e=eoe;const z7e=y.createContext(null);function Qjt({children:n}){const[e,t]=y.useState([]),r=y.useCallback(s=>{const a=s.id??us();return t(c=>[...c.filter(l=>l.id!==s.id),{...s,id:a}]),a},[]),i=y.useCallback(s=>(t(a=>a.filter(c=>c.id!==s)),s),[]),o=y.useCallback(()=>{t(()=>[])},[]);return x.jsx(R7e,{children:x.jsx(z7e.Provider,{value:{toasts:e,addToast:r,removeToast:i,clearToasts:o},children:n})})}function up(){const n=y.useContext(z7e);if(!n)throw new Error("useToasts must be used within a ToastsProvider");return n}const dr=y.forwardRef(function({children:e,disabled:t,type:r,...i},o){return x.jsx("button",{ref:o,type:"button",draggable:!1,disabled:t,...i,className:Ue("tlui-button",`tlui-button__${r}`,i.className),children:e})});function ia({children:n}){return x.jsx("span",{className:"tlui-button__label",children:n})}const Dy=y.memo(function({small:e,invertIcon:t,icon:r,color:i,className:o,...s}){const a=jie(),c=a.icons[r]??a.icons["question-mark-circle"],l=y.useRef(null);return y.useLayoutEffect(()=>{c||console.error(`Icon not found: ${r}. Add it to the assetUrls.icons object.`),l!=null&&l.current&&(l.current.style.webkitMask=`url(${c}) center 100% / 100% no-repeat`)},[l,c,r]),r==="none"?x.jsx("div",{className:Ue("tlui-icon tlui-icon__placeholder",{"tlui-icon__small":e},o)}):x.jsx("div",{...s,ref:l,className:Ue("tlui-icon",{"tlui-icon__small":e},o),style:{color:i,mask:`url(${c}) center 100% / 100% no-repeat`,transform:t?"scale(-1, 1)":void 0}})}),eBt={success:"check-circle",warning:"warning-triangle",error:"cross-circle",info:"info-circle"};function tBt({toast:n}){const{removeToast:e}=up(),t=Ni(),r=s=>{s||e(n.id)},i=n.actions&&n.actions.length>0,o=n.icon||n.severity&&eBt[n.severity];return x.jsxs(Zjt,{onOpenChange:r,className:"tlui-toast__container",duration:n.keepOpen?1/0:5e3,"data-severity":n.severity,children:[o&&x.jsx("div",{className:"tlui-toast__icon",children:x.jsx(Dy,{icon:o})}),x.jsxs("div",{className:"tlui-toast__main",children:[x.jsxs("div",{className:"tlui-toast__content",children:[n.title&&x.jsx(Xjt,{className:"tlui-toast__title",children:n.title}),n.description&&x.jsx(Yjt,{className:"tlui-toast__description",children:n.description})]}),n.actions&&x.jsxs("div",{className:"tlui-toast__actions",children:[n.actions.map((s,a)=>x.jsx(Jjt,{altText:s.label,asChild:!0,onClick:s.onClick,children:x.jsx(dr,{type:s.type,children:x.jsx(ia,{children:s.label})})},a)),x.jsx(F1e,{asChild:!0,children:x.jsx(dr,{type:"normal",className:"tlui-toast__close",style:{marginLeft:"auto"},children:x.jsx(ia,{children:n.closeLabel??t("toast.close")})})})]})]}),!i&&x.jsx(F1e,{asChild:!0,children:x.jsx(dr,{type:"normal",className:"tlui-toast__close",children:x.jsx(ia,{children:n.closeLabel??t("toast.close")})})})]})}function nBt(){const{toasts:n}=up();return x.jsx(x.Fragment,{children:n.map(e=>x.jsx(tBt,{toast:e},e.id))})}const rBt=y.memo(nBt);function iBt(){const n=ot(),{toasts:e}=up(),[t,r]=y.useState(!1);return y.useEffect(()=>{let i=-1;return e.length?r(!0):i=n.timers.setTimeout(()=>{r(!1)},1e3),()=>{clearTimeout(i)}},[e.length,r,n]),t?x.jsx(O7e,{className:"tlui-toast__viewport"}):null}function Ci({icon:n,small:e,invertIcon:t}){return x.jsx(Dy,{className:"tlui-button__icon",icon:n,small:e,invertIcon:t})}const rz=[0,390,428,468,580,640,840,1023];var Hs=(n=>(n[n.ZERO=0]="ZERO",n[n.MOBILE_XXS=1]="MOBILE_XXS",n[n.MOBILE_XS=2]="MOBILE_XS",n[n.MOBILE_SM=3]="MOBILE_SM",n[n.MOBILE=4]="MOBILE",n[n.TABLET_SM=5]="TABLET_SM",n[n.TABLET=6]="TABLET",n[n.DESKTOP=7]="DESKTOP",n))(Hs||{});const oBt="2.3.0",sBt="https://cdn.tldraw.com";function M1(){return`${sBt}/${oBt}`}let kX={fonts:{draw:`${M1()}/fonts/Shantell_Sans-Tldrawish.woff2`,serif:`${M1()}/fonts/IBMPlexSerif-Medium.woff2`,sansSerif:`${M1()}/fonts/IBMPlexSans-Medium.woff2`,monospace:`${M1()}/fonts/IBMPlexMono-Medium.woff2`}};function V7e(n){return y.useMemo(()=>n?{fonts:{...kX.fonts,...n==null?void 0:n.fonts}}:kX,[n])}const aBt=["align-bottom","align-center-horizontal","align-center-vertical","align-left","align-right","align-top","arrow-left","arrowhead-arrow","arrowhead-bar","arrowhead-diamond","arrowhead-dot","arrowhead-none","arrowhead-square","arrowhead-triangle-inverted","arrowhead-triangle","blob","bring-forward","bring-to-front","broken","check-circle","check","chevron-down","chevron-left","chevron-right","chevron-up","chevrons-ne","chevrons-sw","clipboard-copied","clipboard-copy","color","cross-2","cross-circle","dash-dashed","dash-dotted","dash-draw","dash-solid","disconnected","discord","distribute-horizontal","distribute-vertical","dot","dots-horizontal","dots-vertical","drag-handle-dots","duplicate","edit","external-link","fill-fill","fill-none","fill-pattern","fill-semi","fill-solid","follow","following","font-draw","font-mono","font-sans","font-serif","geo-arrow-down","geo-arrow-left","geo-arrow-right","geo-arrow-up","geo-check-box","geo-cloud","geo-diamond","geo-ellipse","geo-heart","geo-hexagon","geo-octagon","geo-oval","geo-pentagon","geo-rectangle","geo-rhombus-2","geo-rhombus","geo-star","geo-trapezoid","geo-triangle","geo-x-box","github","group","horizontal-align-end","horizontal-align-middle","horizontal-align-start","info-circle","leading","link","lock","menu","minus","mixed","pack","plus","question-mark-circle","question-mark","redo","reset-zoom","rotate-ccw","rotate-cw","send-backward","send-to-back","share-1","size-extra-large","size-large","size-medium","size-small","spline-cubic","spline-line","stack-horizontal","stack-vertical","stretch-horizontal","stretch-vertical","text-align-center","text-align-left","text-align-right","toggle-off","toggle-on","tool-arrow","tool-eraser","tool-frame","tool-hand","tool-highlight","tool-laser","tool-line","tool-media","tool-note","tool-pencil","tool-pointer","tool-screenshot","tool-text","trash","twitter","undo","ungroup","unlock","vertical-align-end","vertical-align-middle","vertical-align-start","warning-triangle","zoom-in","zoom-out"];let EI={...kX,icons:Object.fromEntries(aBt.map(n=>[n,`${M1()}/icons/icon/${n}.svg`])),translations:Object.fromEntries(z3.map(n=>[n.locale,`${M1()}/translations/${n.locale}.json`])),embedIcons:Object.fromEntries(DD.map(n=>[n.type,`${M1()}/embed-icons/${n.type}.png`]))};function cBt(n){return n?{fonts:Object.assign({...EI.fonts},{...n==null?void 0:n.fonts}),icons:Object.assign({...EI.icons},{...n==null?void 0:n.icons}),embedIcons:Object.assign({...EI.embedIcons},{...n==null?void 0:n.embedIcons}),translations:Object.assign({...EI.translations},{...n==null?void 0:n.translations})}:EI}function GN({className:n,children:e}){return x.jsx("div",{className:Ue("tlui-dialog__header",n),children:e})}function ZN({className:n,children:e}){return x.jsx(_7e,{dir:"ltr",className:Ue("tlui-dialog__header__title",n),children:e})}function XN(){return x.jsx("div",{className:"tlui-dialog__header__close",children:x.jsx(x7e,{"data-testid":"dialog.close",dir:"ltr",asChild:!0,children:x.jsx(dr,{type:"icon","aria-label":"Close",onTouchEnd:n=>n.target.click(),children:x.jsx(Ci,{small:!0,icon:"cross-2"})})})})}function q3({className:n,children:e,style:t}){return x.jsx("div",{className:Ue("tlui-dialog__body",n),style:t,children:e})}function toe({className:n,children:e}){return x.jsx("div",{className:Ue("tlui-dialog__footer",n),children:e})}const noe=y.forwardRef(function({className:e,label:t,icon:r,iconLeft:i,autoSelect:o=!1,autoFocus:s=!1,defaultValue:a,placeholder:c,onComplete:l,onValueChange:u,onCancel:d,onFocus:h,onBlur:f,shouldManuallyMaintainScrollPositionWhenFocused:p=!1,children:g,value:m},v){const b=ot(),S=y.useRef(null);y.useImperativeHandle(v,()=>S.current);const E=Ni(),w=y.useRef(a??""),C=y.useRef(a??""),[I,T]=y.useState(!1),D=y.useCallback(A=>{T(!0);const k=A.currentTarget;C.current=k.value,b.timers.requestAnimationFrame(()=>{o&&k.select()}),h==null||h()},[o,h,b.timers]),O=y.useCallback(A=>{const k=A.currentTarget.value;C.current=k,u==null||u(k)},[u]),M=y.useCallback(A=>{switch(A.key){case"Enter":{A.currentTarget.blur(),Wc(A),l==null||l(A.currentTarget.value);break}case"Escape":{A.currentTarget.value=w.current,A.currentTarget.blur(),Wc(A),d==null||d(A.currentTarget.value);break}}},[l,d]),R=y.useCallback(A=>{T(!1);const k=A.currentTarget.value;f==null||f(k)},[f]);return y.useEffect(()=>{if(!b.environment.isIos)return;const A=window.visualViewport;if(I&&p&&A){const k=()=>{var L;(L=S.current)==null||L.scrollIntoView({block:"center"})};return A.addEventListener("resize",k),A.addEventListener("scroll",k),b.timers.requestAnimationFrame(()=>{var L;(L=S.current)==null||L.scrollIntoView({block:"center"})}),()=>{A.removeEventListener("resize",k),A.removeEventListener("scroll",k)}}},[b,I,p]),x.jsxs("div",{draggable:!1,className:"tlui-input__wrapper",children:[g,t&&x.jsx("label",{children:E(t)}),i&&x.jsx(Dy,{icon:i,className:"tlui-icon-left",small:!0}),x.jsx("input",{ref:S,className:Ue("tlui-input",e),type:"text",defaultValue:a,onKeyUp:M,onChange:O,onFocus:D,onBlur:R,autoFocus:s,placeholder:c,value:m}),r&&x.jsx(Dy,{icon:r,small:!!t})]})}),W7e=Zd(function({onClose:e}){const t=ot(),r=Ni(),i=jie(),[o,s]=y.useState(null),[a,c]=y.useState(""),[l,u]=y.useState(null),[d,h]=y.useState(!1),f=y.useRef(-1);return x.jsxs(x.Fragment,{children:[x.jsxs(GN,{children:[x.jsx(ZN,{children:o?`${r("embed-dialog.title")} — ${o.title}`:r("embed-dialog.title")}),x.jsx(XN,{})]}),o?x.jsxs(x.Fragment,{children:[x.jsxs(q3,{className:"tlui-embed-dialog__enter",children:[x.jsx(noe,{className:"tlui-embed-dialog__input",label:"embed-dialog.url",placeholder:"http://example.com",autoFocus:!0,onValueChange:p=>{c(p);const g=K0(p);u(g&&g.definition.type===o.type?g:null),h(!1),clearTimeout(f.current),f.current=t.timers.setTimeout(()=>h(!g),320)}}),a===""?x.jsxs("div",{className:"tlui-embed-dialog__instruction",children:[x.jsx("span",{children:r("embed-dialog.instruction")})," ",o.instructionLink&&x.jsxs("a",{target:"_blank",rel:"noopener noreferrer",href:o.instructionLink,className:"tlui-embed-dialog__instruction__link",children:["Learn more.",x.jsx(Dy,{icon:"external-link",small:!0})]})]}):x.jsx("div",{className:"tlui-embed-dialog__warning",children:d?r("embed-dialog.invalid-url"):" "})]}),x.jsxs(toe,{className:"tlui-dialog__footer__actions",children:[x.jsx(dr,{type:"normal",onClick:()=>{s(null),u(null),c("")},children:x.jsx(ia,{children:r("embed-dialog.back")})}),x.jsx("div",{className:"tlui-embed__spacer"}),x.jsx(dr,{type:"normal",onClick:e,children:x.jsx(ia,{children:r("embed-dialog.cancel")})}),x.jsx(dr,{type:"primary",disabled:!l,onClick:()=>{l&&(t.putExternalContent({type:"embed",url:a,point:t.getViewportPageBounds().center,embed:l.definition}),e())},children:x.jsx(ia,{children:r("embed-dialog.create")})})]})]}):x.jsx(x.Fragment,{children:x.jsx(q3,{className:"tlui-embed-dialog__list",children:DD.map(p=>x.jsxs(dr,{type:"menu",onClick:()=>s(p),children:[x.jsx(ia,{children:p.title}),x.jsx("div",{className:"tlui-embed-dialog__item__image",style:{backgroundImage:`url(${i.embedIcons[p.type]})`}})]},p.type))})})]})});function q7e(){const n=ot(),e=y.useRef();return y.useEffect(()=>{const t=window.document.createElement("input");t.type="file",t.accept=n4t,t.multiple=!0,e.current=t;async function r(i){const o=i.target.files;!o||o.length===0||(n.mark("insert media"),await n.putExternalContent({type:"files",files:Array.from(o),point:n.getViewportPageBounds().center,ignoreParent:!1}),t.value="")}return t.addEventListener("change",r),()=>{e.current=void 0,t.removeEventListener("change",r)}},[n]),y.useCallback(()=>{var t;(t=e.current)==null||t.click()},[e])}const K7e=y.createContext(null);function lBt({overrides:n,children:e}){const t=ot(),r=lp(),{addDialog:i}=g_(),o=q7e(),s=y.useMemo(()=>{const a=[{id:"select",label:"tool.select",icon:"tool-pointer",kbd:"v",readonlyOk:!0,onSelect(l){t.setCurrentTool("select"),r("select-tool",{source:l,id:"select"})}},{id:"hand",label:"tool.hand",icon:"tool-hand",kbd:"h",readonlyOk:!0,onSelect(l){t.setCurrentTool("hand"),r("select-tool",{source:l,id:"hand"})}},{id:"eraser",label:"tool.eraser",icon:"tool-eraser",kbd:"e",onSelect(l){t.setCurrentTool("eraser"),r("select-tool",{source:l,id:"eraser"})}},{id:"draw",label:"tool.draw",icon:"tool-pencil",kbd:"d,b,x",onSelect(l){t.setCurrentTool("draw"),r("select-tool",{source:l,id:"draw"})}},...[...jf.values].map(l=>({id:l,label:`tool.${l}`,meta:{geo:l},kbd:l==="rectangle"?"r":l==="ellipse"?"o":void 0,icon:"geo-"+l,onSelect(u){t.batch(()=>{t.setStyleForNextShapes(jf,l),t.setCurrentTool("geo"),r("select-tool",{source:u,id:`geo-${l}`})})}})),{id:"arrow",label:"tool.arrow",icon:"tool-arrow",kbd:"a",onSelect(l){t.setCurrentTool("arrow"),r("select-tool",{source:l,id:"arrow"})}},{id:"line",label:"tool.line",icon:"tool-line",kbd:"l",onSelect(l){t.setCurrentTool("line"),r("select-tool",{source:l,id:"line"})}},{id:"frame",label:"tool.frame",icon:"tool-frame",kbd:"f",onSelect(l){t.setCurrentTool("frame"),r("select-tool",{source:l,id:"frame"})}},{id:"text",label:"tool.text",icon:"tool-text",kbd:"t",onSelect(l){t.setCurrentTool("text"),r("select-tool",{source:l,id:"text"})}},{id:"asset",label:"tool.asset",icon:"tool-media",kbd:"$u",onSelect(l){o(),r("select-tool",{source:l,id:"media"})}},{id:"note",label:"tool.note",icon:"tool-note",kbd:"n",onSelect(l){t.setCurrentTool("note"),r("select-tool",{source:l,id:"note"})}},{id:"laser",label:"tool.laser",readonlyOk:!0,icon:"tool-laser",kbd:"k",onSelect(l){t.setCurrentTool("laser"),r("select-tool",{source:l,id:"laser"})}},{id:"embed",label:"tool.embed",icon:"dot",onSelect(l){i({component:W7e}),r("select-tool",{source:l,id:"embed"})}},{id:"highlight",label:"tool.highlight",icon:"tool-highlight",kbd:"!d",onSelect(l){t.setCurrentTool("highlight"),r("select-tool",{source:l,id:"highlight"})}}];a.push();const c=Object.fromEntries(a.map(l=>[l.id,l]));return n?n(t,c,{insertMedia:o}):c},[n,t,r,o,i]);return x.jsx(K7e.Provider,{value:s,children:e})}function HD(){const n=y.useContext(K7e);if(!n)throw new Error("useTools must be used within a ToolProvider");return n}const G7e=Ke.createContext(null);function uBt({forceMobile:n=!1,children:e}){const t=ot(),r=_t("breakpoint",()=>{const{width:i}=t.getViewportScreenBounds(),o=n?Hs.MOBILE_SM:rz.length-1;for(let s=0;s<o;s++)if(i>rz[s]&&i<=rz[s+1])return s;return o},[t]);return x.jsx(G7e.Provider,{value:r,children:e})}function Ju(){const n=y.useContext(G7e);if(n===null)throw new Error("useBreakpoint must be used inside of the <BreakpointProvider /> component");return n}function dBt(){const{addToast:n,removeToast:e,clearToasts:t}=up(),{addDialog:r,clearDialogs:i,removeDialog:o,updateDialog:s}=g_(),c=Ju()<Hs.TABLET_SM,l=Ni();return y.useMemo(()=>({addToast:n,removeToast:e,clearToasts:t,addDialog:r,clearDialogs:i,removeDialog:o,updateDialog:s,msg:l,isMobile:c}),[r,n,i,t,l,o,e,s,c])}function hBt(n,e){const t={};for(const r of n)if(r.translations)for(const[i,o]of Uu(r.translations)){let s=t[i];s||(s=t[i]={}),Object.assign(s,o)}return{actions:(r,i)=>{for(const o of n)o.actions&&(i=o.actions(r,i,e));return i},tools:(r,i,o)=>{for(const s of n)s.tools&&(i=s.tools(r,i,{...e,...o}));return i},translations:t}}function Z7e(n){return y.useMemo(()=>n,n)}function fBt(n){const e=Z7e(n==null?[]:Array.isArray(n)?n:[n]);return y.useMemo(()=>{const t={};for(const r of e)if(r.translations)for(const[i,o]of Uu(r.translations)){let s=t[i];s||(s=t[i]={}),Object.assign(s,o)}return t},[e])}function pBt(n){const e=dBt(),t=Z7e(n==null?[]:Array.isArray(n)?n:[n]);return y.useMemo(()=>hBt(t,e),[t,e])}function gBt(n,e){const t=qr(e.map(i=>n.getShape(i)).filter(i=>i&&n.isShapeOfType(i,"frame")));if(!t.length)return;const r=[];n.batch(()=>{t.map(i=>{const o=n.getSortedChildIdsForParent(i.id);o.length&&(n.reparentShapes(o,i.parentId,i.index),r.push(...o))}),n.setSelectedShapes(r),n.deleteShapes(e)})}const mBt=50;function vBt(n,e,t={}){const r=n.getShape(e);if(!r)return;const i=n.getSortedChildIdsForParent(r.id),o=qr(i.map(f=>n.getShape(f)));if(!o.length)return;const s=xn.FromPoints(o.flatMap(f=>{const p=n.getShapeGeometry(f.id);return n.getShapeLocalTransform(f).applyToPoints(p.vertices)})),{padding:a=mBt}=t,c=s.w+2*a,l=s.h+2*a,u=a-s.minX,d=a-s.minY;if(u===0&&d===0&&r.props.w===c&&r.props.h===l)return;const h=new H(u,d).rot(r.rotation);n.batch(()=>{const f=i.map(p=>{const g=n.getShape(p);return{id:g.id,type:g.type,x:g.x+u,y:g.y+d}});f.push({id:r.id,type:r.type,x:r.x-h.x,y:r.y-h.y,props:{w:c,h:l}}),n.updateShapes(f)})}function j1e(n){return Wd.isValid(n)?{isValid:!0,hasProtocol:!0}:Wd.isValid("https://"+n)?{isValid:!0,hasProtocol:!1}:{isValid:!1,hasProtocol:!1}}const yBt=Zd(function({onClose:e}){const r=ot().getOnlySelectedShape();return r&&"url"in r.props&&typeof r.props.url=="string"?x.jsx(bBt,{onClose:e,selectedShape:r}):null}),bBt=Zd(function({onClose:e,selectedShape:t}){const r=ot(),i=Ni(),o=y.useRef(null);y.useEffect(()=>{r.timers.requestAnimationFrame(()=>{var p;return(p=o.current)==null?void 0:p.focus()})},[r]);const s=y.useRef(t.props.url),[a,c]=y.useState(()=>{const p=j1e(t.props.url),g=p.isValid===!0?p.hasProtocol?t.props.url:"https://"+t.props.url:"https://";return{actual:g,safe:g,valid:!0}}),l=y.useCallback(p=>{const g=p.replace(/https?:\/\/(https?:\/\/)/,(b,S)=>S),m=j1e(g),v=m.isValid===!0?m.hasProtocol?g:"https://"+g:"https://";c({actual:g,safe:v,valid:m.isValid})},[]),u=y.useCallback(()=>{const p=r.getOnlySelectedShape();p&&(r.updateShapes([{id:p.id,type:p.type,props:{url:""}}]),e())},[r,e]),d=y.useCallback(()=>{const p=r.getOnlySelectedShape();p&&(p&&"url"in p.props&&p.props.url!==a.safe&&r.updateShapes([{id:p.id,type:p.type,props:{url:a.safe}}]),e())},[r,e,a]),h=y.useCallback(()=>{e()},[e]);if(!t)return e(),null;const f=s.current&&!a.valid;return x.jsxs(x.Fragment,{children:[x.jsxs(GN,{children:[x.jsx(ZN,{children:i("edit-link-dialog.title")}),x.jsx(XN,{})]}),x.jsx(q3,{children:x.jsxs("div",{className:"tlui-edit-link-dialog",children:[x.jsx(noe,{ref:o,className:"tlui-edit-link-dialog__input",label:"edit-link-dialog.url",autoFocus:!0,value:a.actual,onValueChange:l,onComplete:d,onCancel:h}),x.jsx("div",{children:a.valid?i("edit-link-dialog.detail"):i("edit-link-dialog.invalid-url")})]})}),x.jsxs(toe,{className:"tlui-dialog__footer__actions",children:[x.jsx(dr,{type:"normal",onClick:h,onTouchEnd:h,children:x.jsx(ia,{children:i("edit-link-dialog.cancel")})}),f?x.jsx(dr,{type:"danger",onTouchEnd:u,onClick:u,children:x.jsx(ia,{children:i("edit-link-dialog.clear")})}):x.jsx(dr,{type:"primary",disabled:!a.valid,onTouchEnd:d,onClick:d,children:x.jsx(ia,{children:i("edit-link-dialog.save")})})]})]})});var roe={exports:{}};roe.exports;(function(n){var e=function(){var t=String.fromCharCode,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",o={};function s(c,l){if(!o[c]){o[c]={};for(var u=0;u<c.length;u++)o[c][c.charAt(u)]=u}return o[c][l]}var a={compressToBase64:function(c){if(c==null)return"";var l=a._compress(c,6,function(u){return r.charAt(u)});switch(l.length%4){default:case 0:return l;case 1:return l+"===";case 2:return l+"==";case 3:return l+"="}},decompressFromBase64:function(c){return c==null?"":c==""?null:a._decompress(c.length,32,function(l){return s(r,c.charAt(l))})},compressToUTF16:function(c){return c==null?"":a._compress(c,15,function(l){return t(l+32)})+" "},decompressFromUTF16:function(c){return c==null?"":c==""?null:a._decompress(c.length,16384,function(l){return c.charCodeAt(l)-32})},compressToUint8Array:function(c){for(var l=a.compress(c),u=new Uint8Array(l.length*2),d=0,h=l.length;d<h;d++){var f=l.charCodeAt(d);u[d*2]=f>>>8,u[d*2+1]=f%256}return u},decompressFromUint8Array:function(c){if(c==null)return a.decompress(c);for(var l=new Array(c.length/2),u=0,d=l.length;u<d;u++)l[u]=c[u*2]*256+c[u*2+1];var h=[];return l.forEach(function(f){h.push(t(f))}),a.decompress(h.join(""))},compressToEncodedURIComponent:function(c){return c==null?"":a._compress(c,6,function(l){return i.charAt(l)})},decompressFromEncodedURIComponent:function(c){return c==null?"":c==""?null:(c=c.replace(/ /g,"+"),a._decompress(c.length,32,function(l){return s(i,c.charAt(l))}))},compress:function(c){return a._compress(c,16,function(l){return t(l)})},_compress:function(c,l,u){if(c==null)return"";var d,h,f={},p={},g="",m="",v="",b=2,S=3,E=2,w=[],C=0,I=0,T;for(T=0;T<c.length;T+=1)if(g=c.charAt(T),Object.prototype.hasOwnProperty.call(f,g)||(f[g]=S++,p[g]=!0),m=v+g,Object.prototype.hasOwnProperty.call(f,m))v=m;else{if(Object.prototype.hasOwnProperty.call(p,v)){if(v.charCodeAt(0)<256){for(d=0;d<E;d++)C=C<<1,I==l-1?(I=0,w.push(u(C)),C=0):I++;for(h=v.charCodeAt(0),d=0;d<8;d++)C=C<<1|h&1,I==l-1?(I=0,w.push(u(C)),C=0):I++,h=h>>1}else{for(h=1,d=0;d<E;d++)C=C<<1|h,I==l-1?(I=0,w.push(u(C)),C=0):I++,h=0;for(h=v.charCodeAt(0),d=0;d<16;d++)C=C<<1|h&1,I==l-1?(I=0,w.push(u(C)),C=0):I++,h=h>>1}b--,b==0&&(b=Math.pow(2,E),E++),delete p[v]}else for(h=f[v],d=0;d<E;d++)C=C<<1|h&1,I==l-1?(I=0,w.push(u(C)),C=0):I++,h=h>>1;b--,b==0&&(b=Math.pow(2,E),E++),f[m]=S++,v=String(g)}if(v!==""){if(Object.prototype.hasOwnProperty.call(p,v)){if(v.charCodeAt(0)<256){for(d=0;d<E;d++)C=C<<1,I==l-1?(I=0,w.push(u(C)),C=0):I++;for(h=v.charCodeAt(0),d=0;d<8;d++)C=C<<1|h&1,I==l-1?(I=0,w.push(u(C)),C=0):I++,h=h>>1}else{for(h=1,d=0;d<E;d++)C=C<<1|h,I==l-1?(I=0,w.push(u(C)),C=0):I++,h=0;for(h=v.charCodeAt(0),d=0;d<16;d++)C=C<<1|h&1,I==l-1?(I=0,w.push(u(C)),C=0):I++,h=h>>1}b--,b==0&&(b=Math.pow(2,E),E++),delete p[v]}else for(h=f[v],d=0;d<E;d++)C=C<<1|h&1,I==l-1?(I=0,w.push(u(C)),C=0):I++,h=h>>1;b--,b==0&&(b=Math.pow(2,E),E++)}for(h=2,d=0;d<E;d++)C=C<<1|h&1,I==l-1?(I=0,w.push(u(C)),C=0):I++,h=h>>1;for(;;)if(C=C<<1,I==l-1){w.push(u(C));break}else I++;return w.join("")},decompress:function(c){return c==null?"":c==""?null:a._decompress(c.length,32768,function(l){return c.charCodeAt(l)})},_decompress:function(c,l,u){var d=[],h=4,f=4,p=3,g="",m=[],v,b,S,E,w,C,I,T={val:u(0),position:l,index:1};for(v=0;v<3;v+=1)d[v]=v;for(S=0,w=Math.pow(2,2),C=1;C!=w;)E=T.val&T.position,T.position>>=1,T.position==0&&(T.position=l,T.val=u(T.index++)),S|=(E>0?1:0)*C,C<<=1;switch(S){case 0:for(S=0,w=Math.pow(2,8),C=1;C!=w;)E=T.val&T.position,T.position>>=1,T.position==0&&(T.position=l,T.val=u(T.index++)),S|=(E>0?1:0)*C,C<<=1;I=t(S);break;case 1:for(S=0,w=Math.pow(2,16),C=1;C!=w;)E=T.val&T.position,T.position>>=1,T.position==0&&(T.position=l,T.val=u(T.index++)),S|=(E>0?1:0)*C,C<<=1;I=t(S);break;case 2:return""}for(d[3]=I,b=I,m.push(I);;){if(T.index>c)return"";for(S=0,w=Math.pow(2,p),C=1;C!=w;)E=T.val&T.position,T.position>>=1,T.position==0&&(T.position=l,T.val=u(T.index++)),S|=(E>0?1:0)*C,C<<=1;switch(I=S){case 0:for(S=0,w=Math.pow(2,8),C=1;C!=w;)E=T.val&T.position,T.position>>=1,T.position==0&&(T.position=l,T.val=u(T.index++)),S|=(E>0?1:0)*C,C<<=1;d[f++]=t(S),I=f-1,h--;break;case 1:for(S=0,w=Math.pow(2,16),C=1;C!=w;)E=T.val&T.position,T.position>>=1,T.position==0&&(T.position=l,T.val=u(T.index++)),S|=(E>0?1:0)*C,C<<=1;d[f++]=t(S),I=f-1,h--;break;case 2:return m.join("")}if(h==0&&(h=Math.pow(2,p),p++),d[I])g=d[I];else if(I===f)g=b+b.charAt(0);else return null;m.push(g),d[f++]=b+g.charAt(0),h--,b=g,h==0&&(h=Math.pow(2,p),p++)}}};return a}();n!=null?n.exports=e:typeof angular<"u"&&angular!=null&&angular.module("LZString",[]).factory("LZString",function(){return e})})(roe);var SBt=roe.exports;const X7e=Fy(SBt);async function _Bt(n,e,t){var v,b,S;const{elements:r,files:i}=e,o={shapes:[],bindings:[],rootShapeIds:[],assets:[],schema:n.store.schema.serialize()},s=new Map,a=new Map,c=n.getCurrentPageId(),l=new Map,u=[],d=new Set;r.forEach(E=>{if(l.set(E.id,ro()),E.boundElements!==null)for(const w of E.boundElements)w.type==="text"&&d.add(w.id)});let h=i4t;for(const E of r){if(d.has(E.id))continue;const w=l.get(E.id),C={id:w,typeName:"shape",parentId:c,index:h,x:E.x,y:E.y,rotation:0,isLocked:E.locked,opacity:wBt(E.opacity),meta:{}};switch(E.angle!==0&&a.set(w,E.angle),E.groupIds&&E.groupIds.length>0?s.has(E.groupIds[0])?(v=s.get(E.groupIds[0]))==null||v.push(w):s.set(E.groupIds[0],[w]):u.push(w),E.type){case"rectangle":case"ellipse":case"diamond":{let I="",T="middle";if(E.boundElements!==null){for(const O of E.boundElements)if(O.type==="text"){const M=r.find(R=>R.id===O.id);M&&(I=M.text,T=kBt[M.textAlign])}}const D=E.backgroundColor==="transparent"?E.strokeColor:E.backgroundColor;o.shapes.push({...C,type:"geo",props:{geo:E.type,url:E.link??"",w:E.width,h:E.height,size:xA[E.strokeWidth]??"draw",color:II[D]??"black",text:I,align:T,dash:EA(E),fill:RBt(E)}});break}case"freedraw":{o.shapes.push({...C,type:"draw",props:{dash:EA(E),size:xA[E.strokeWidth],color:II[E.strokeColor]??"black",segments:[{type:"free",points:E.points.map(([I,T,D=.5])=>({x:I,y:T,z:D}))}]}});break}case"line":{if(E.points.slice().length<2)break;const T=j3(E.points.length);o.shapes.push({...C,type:"line",props:{dash:EA(E),size:xA[E.strokeWidth],color:II[E.strokeColor]??"black",spline:E.roundness?"cubic":"line",points:{...Object.fromEntries(E.points.map(([D,O],M)=>{const R=T[M];return[R,{id:R,index:R,x:D,y:O}]}))}}});break}case"arrow":{let I="";if(E.boundElements!==null){for(const R of E.boundElements)if(R.type==="text"){const A=r.find(k=>k.id===R.id);A&&(I=A.text)}}const T=E.points[0],D=E.points[E.points.length-1],O=l.get((b=E.startBinding)==null?void 0:b.elementId),M=l.get((S=E.endBinding)==null?void 0:S.elementId);o.shapes.push({...C,type:"arrow",props:{text:I,bend:DBt(E,T,D),dash:EA(E),size:xA[E.strokeWidth]??"m",color:II[E.strokeColor]??"black",start:{x:T[0],y:T[1]},end:{x:D[0],y:D[1]},arrowheadEnd:B1e[E.endArrowhead]??"none",arrowheadStart:B1e[E.startArrowhead]??"none"}}),O&&o.bindings.push({id:fS(),typeName:"binding",type:"arrow",fromId:w,toId:O,props:{terminal:"start",normalizedAnchor:{x:.5,y:.5},isPrecise:!1,isExact:!1},meta:{}}),M&&o.bindings.push({id:fS(),typeName:"binding",type:"arrow",fromId:w,toId:M,props:{terminal:"end",normalizedAnchor:{x:.5,y:.5},isPrecise:!1,isExact:!1},meta:{}});break}case"text":{const{size:I,scale:T}=xBt(E.fontSize);o.shapes.push({...C,type:"text",props:{size:I,scale:T,font:EBt[E.fontFamily]??"draw",color:II[E.strokeColor]??"black",text:E.text,textAlign:TBt[E.textAlign]}});break}case"image":{const I=i[E.fileId];if(!I)break;const T=A1.createId();o.assets.push({id:T,typeName:"asset",type:"image",props:{w:E.width,h:E.height,fileSize:I.size,name:E.id??"Untitled",isAnimated:!1,mimeType:I.mimeType,src:I.dataURL},meta:{}}),o.shapes.push({...C,type:"image",props:{w:E.width,h:E.height,assetId:T}})}}h=Om(h)}const f=t??(n.inputs.shiftKey?n.inputs.currentPagePoint:void 0);n.mark("paste"),n.putContentOntoCurrentPage(o,{point:f,select:!1,preserveIds:!0});for(const E of s.values())if(E.length>1){n.groupShapes(E);const w=n.getShape(E[0]);w!=null&&w.parentId&&ku(w.parentId)&&u.push(w.parentId)}for(const[E,w]of a)n.select(E),n.rotateShapesBy([E],w);const p=qr(u.map(E=>n.getShape(E))),g=xn.Common(p.map(E=>n.getShapePageBounds(E))),m=n.getViewportPageBounds().center;n.updateShapes(p.map(E=>{const w={x:(E.x??0)-(g.x+g.w/2),y:(E.y??0)-(g.y+g.h/2)};return{id:E.id,type:E.type,x:m.x+w.x,y:m.y+w.y}})),n.setSelectedShapes(u)}const wBt=n=>{const e=n/100;return e<.2?.1:e<.4?.25:e<.6?.5:e<.8?.75:1},xA={1:"s",2:"m",3:"l",4:"xl"},CBt={16:"s",20:"m",28:"l",36:"xl"};function xBt(n){const e=CBt[n];return e?{size:e,scale:1}:n<16?{size:"s",scale:n/16}:n>36?{size:"xl",scale:n/36}:{size:"m",scale:1}}const EBt={1:"draw",2:"sans",3:"mono"},II={"#ffffff":"grey","#000000":"black","#343a40":"black","#495057":"grey","#c92a2a":"red","#a61e4d":"light-red","#862e9c":"violet","#5f3dc4":"light-violet","#364fc7":"blue","#1864ab":"light-blue","#0b7285":"light-green","#087f5b":"light-green","#2b8a3e":"green","#5c940d":"light-green","#e67700":"yellow","#d9480f":"orange","#ced4da":"grey","#868e96":"grey","#fa5252":"light-red","#e64980":"red","#be4bdb":"light-violet","#7950f2":"violet","#4c6ef5":"blue","#228be6":"light-blue","#15aabf":"light-green","#12b886":"green","#40c057":"green","#82c91e":"light-green","#fab005":"yellow","#fd7e14":"orange","#212529":"grey"},IBt={solid:"draw",dashed:"dashed",dotted:"dotted"},PBt={"cross-hatch":"pattern",hachure:"pattern",solid:"solid"},kBt={left:"start",center:"middle",right:"end"},TBt={left:"start",center:"middle",right:"end"},B1e={arrow:"arrow",dot:"dot",triangle:"triangle",bar:"pipe"};function DBt(n,e,t){let r=0;if(n.points.length>2){const i=new H(e[0],e[1]),o=new H(t[0],t[1]),s=new H(n.points[1][0],n.points[1][1]),a=H.Sub(o,i),c=H.Per(a),l=H.Med(o,i),u=H.Sub(l,c),d=H.Add(l,c),h=H.NearestPointOnLineSegment(u,d,s,!1);r=H.Dist(h,l),H.Clockwise(h,o,l)&&(r*=-1)}return r}const EA=n=>{let e=IBt[n.strokeStyle]??"draw";return e==="draw"&&n.roughness===0&&(e="solid"),e},RBt=n=>n.backgroundColor==="transparent"?"none":PBt[n.fillStyle]??"solid";async function Y7e(n,e,t,r){const o=(await Promise.all(e.map(async s=>await(await vg(s)).blob()))).map(s=>new File([s],"tldrawFile",{type:s.type}));n.mark("paste"),await n.putExternalContent({type:"files",files:o,point:t,ignoreParent:!1,sources:r}),e.forEach(s=>URL.revokeObjectURL(s))}function ABt(n,e,t){const r=t??(n.inputs.shiftKey?n.inputs.currentPagePoint:void 0),i=n.getSelectionPageBounds();n.mark("paste"),n.putContentOntoCurrentPage(e,{point:r,select:!0});const o=n.getSelectionPageBounds();i&&o&&(i!=null&&i.collides(o))&&(n.updateInstanceState({isChangingStyle:!0}),n.timers.setTimeout(()=>{n.updateInstanceState({isChangingStyle:!1})},150))}async function TX(n,e,t,r){var i;try{if(new URL(e).pathname.match(/\.(png|jpe?g|gif|svg|webp)$/i)&&(i=(await vg(e,{method:"HEAD"})).headers.get("content-type"))!=null&&i.match(/^image\//)){n.mark("paste"),Y7e(n,[e]);return}}catch(o){o.message!=="Failed to fetch"&&console.error(o)}return n.mark("paste"),await n.putExternalContent({type:"url",point:t,url:e,sources:r})}function OBt(n){const e=document.implementation.createHTMLDocument("");return e.documentElement.innerHTML=n.trim(),e.body.textContent||e.body.innerText||""}const MBt=n=>{try{const e=new URL(n);return e.protocol==="http:"||e.protocol==="https:"}catch{return!1}},$Bt=n=>{const e=n.split(/[\n\s]/);for(const t of e)try{const r=new URL(t);if(!(r.protocol==="http:"||r.protocol==="https:"))return}catch{return}return a$e(e)},LBt=n=>/^<svg/.test(n),NBt=["input","select","textarea"];function iz(n){const{activeElement:e}=document;return n.getIsMenuOpen()||e&&(e.getAttribute("contenteditable")||NBt.indexOf(e.tagName.toLowerCase())>-1)}const FBt=n=>n.types.find(e=>e.match(/^image\//)),oz=(n,e,t,r)=>{const i=$Bt(e);if(i)for(const o of i)TX(n,o,t);else MBt(e)?TX(n,e,t):LBt(e)?(n.mark("paste"),n.putExternalContent({type:"svg-text",text:e,point:t,sources:r})):(n.mark("paste"),n.putExternalContent({type:"text",text:e,point:t,sources:r}))},jBt=async(n,e,t)=>{if(n.getEditingShapeId()!==null)return;if(!e)throw Error("No clipboard data");const r=[];for(const i of Object.values(e.items))switch(i.kind){case"file":{r.push({type:"file",source:new Promise(o=>o(i.getAsFile()))});break}case"string":{i.type==="text/html"?r.push({type:"html",source:new Promise(o=>i.getAsString(o))}):i.type==="text/plain"?r.push({type:"text",source:new Promise(o=>i.getAsString(o))}):r.push({type:i.type,source:new Promise(o=>i.getAsString(o))});break}}Q7e(n,r,t)},J7e=async(n,e,t)=>{const r=[];for(const i of e){if(FBt(i))for(const o of i.types)o.match(/^image\//)&&r.push({type:"blob",source:i.getType(o)});i.types.includes("text/html")&&r.push({type:"html",source:(async()=>{const o=await i.getType("text/html");return await dS.blobToText(o)})()}),i.types.includes("text/uri-list")&&r.push({type:"url",source:(async()=>{const o=await i.getType("text/uri-list");return await dS.blobToText(o)})()}),i.types.includes("text/plain")&&r.push({type:"text",source:(async()=>{const o=await i.getType("text/plain");return await dS.blobToText(o)})()})}return await Q7e(n,r,t)};async function Q7e(n,e,t){const r=e.filter(o=>(o.type==="file"||o.type==="blob")&&o.source!==null);if(r.length){const s=(await Promise.all(r.map(a=>a.source))).filter(Boolean).map(a=>URL.createObjectURL(a));return await Y7e(n,s,t)}const i=await Promise.all(e.filter(o=>o.type!=="file").map(o=>new Promise(s=>{const a=o;if(a.type==="file"){s({type:"error",data:null,reason:"unexpected file"});return}a.source.then(c=>{var u;const l=(u=c.match(/<div data-tldraw[^>]*>(.*)<\/div>/))==null?void 0:u[1];if(l)try{const d=X7e.decompressFromBase64(l);if(d===null){s({type:"error",data:d,reason:"found tldraw data comment but could not parse base64"});return}else{const h=JSON.parse(d);if(h.type!=="application/tldraw"&&s({type:"error",data:h,reason:`found tldraw data comment but JSON was of a different type: ${h.type}`}),typeof h.data=="string"){s({type:"error",data:h,reason:"found tldraw json but data was a string instead of a TLClipboardModel object"});return}s({type:"tldraw",data:h.data});return}}catch{s({type:"error",data:l,reason:"found tldraw json but data was a string instead of a TLClipboardModel object"});return}else{if(a.type==="html"){s({type:"text",data:c,subtype:"html"});return}if(a.type==="url"){s({type:"text",data:c,subtype:"url"});return}try{const d=JSON.parse(c);if(d.type==="excalidraw/clipboard"){s({type:"excalidraw",data:d});return}else{s({type:"text",data:c,subtype:"json"});return}}catch{s({type:"text",data:c,subtype:"text"});return}}s({type:"error",data:c,reason:"unhandled case"})})})));for(const o of i)if(o.type==="tldraw"){ABt(n,o.data,t);return}for(const o of i)if(o.type==="excalidraw"){_Bt(n,o.data,t);return}for(const o of i)if(o.type==="text"&&o.subtype==="html"){const a=new DOMParser().parseFromString(o.data,"text/html").querySelector("body");if(a&&Array.from(a.children).filter(l=>l.nodeType===1).length===1&&a.firstElementChild&&a.firstElementChild.tagName==="A"&&a.firstElementChild.hasAttribute("href")&&a.firstElementChild.getAttribute("href")!==""){const l=a.firstElementChild.getAttribute("href");oz(n,l,t,i);return}if(!i.some(l=>l.type==="text"&&l.subtype!=="html")&&o.data.trim()){oz(n,OBt(o.data),t,i);return}}for(const o of i)if(o.type==="text"&&o.subtype==="url"){TX(n,o.data,t,i);return}for(const o of i)if(o.type==="text"&&o.subtype==="text"&&o.data.trim()){oz(n,o.data,t,i);return}}const b$=async n=>{var r;const e=await n.resolveAssetsInContent(n.getContentFromCurrentPage(n.getSelectedShapeIds()));if(!e){navigator&&navigator.clipboard&&navigator.clipboard.writeText("");return}const t=X7e.compressToBase64(JSON.stringify({type:"application/tldraw",kind:"content",data:e}));if(!(typeof navigator>"u")){const i=e.shapes.map(o=>n.isShapeOfType(o,"text")||n.isShapeOfType(o,"geo")||n.isShapeOfType(o,"arrow")?o.props.text:n.isShapeOfType(o,"bookmark")||n.isShapeOfType(o,"embed")?o.props.url:null).filter(p4t);if((r=navigator.clipboard)!=null&&r.write){const o=new Blob([`<div data-tldraw>${t}</div>`],{type:"text/html"});let s=i.join(" ");s===""&&(s=" "),navigator.clipboard.write([new ClipboardItem({"text/html":o,"text/plain":new Blob([s],{type:"text/plain"})})])}else navigator.clipboard.writeText&&navigator.clipboard.writeText(`<div data-tldraw>${t}</div>`)}};function BBt(){const n=ot(),e=lp(),t=y.useCallback(async function(s){n.getSelectedShapeIds().length!==0&&(await b$(n),e("copy",{source:s}))},[n,e]),r=y.useCallback(async function(s){n.getSelectedShapeIds().length!==0&&(await b$(n),n.deleteShapes(n.getSelectedShapeIds()),e("cut",{source:s}))},[n,e]),i=y.useCallback(async function(s,a,c){n.getEditingShapeId()===null&&(Array.isArray(s)&&s[0]instanceof ClipboardItem?(J7e(n,s,c),e("paste",{source:"menu"})):navigator.clipboard.read().then(l=>{i(l,a,c)}))},[n,e]);return{copy:t,cut:r,paste:i}}function HBt(){const n=ot(),e=lp(),t=_t("editor.isFocused",()=>n.getInstanceState().isFocused,[n]);y.useEffect(()=>{if(!t)return;const r=async c=>{n.getSelectedShapeIds().length===0||n.getEditingShapeId()!==null||iz(n)||(Ri(c),await b$(n),e("copy",{source:"kbd"}))};async function i(c){n.getSelectedShapeIds().length===0||n.getEditingShapeId()!==null||iz(n)||(Ri(c),await b$(n),n.deleteShapes(n.getSelectedShapeIds()),e("cut",{source:"kbd"}))}let o=!1;const s=c=>{c.button===1&&(o=!0,n.timers.requestAnimationFrame(()=>{o=!1}))},a=c=>{if(o){Wc(c);return}n.getEditingShapeId()!==null||iz(n)||(c.clipboardData&&!n.inputs.shiftKey?jBt(n,c.clipboardData):navigator.clipboard.read().then(l=>{Array.isArray(l)&&l[0]instanceof ClipboardItem&&J7e(n,l,n.inputs.currentPagePoint)}),Ri(c),e("paste",{source:"kbd"}))};return document.addEventListener("copy",r),document.addEventListener("cut",i),document.addEventListener("paste",a),document.addEventListener("pointerup",s),()=>{document.removeEventListener("copy",r),document.removeEventListener("cut",i),document.removeEventListener("paste",a),document.removeEventListener("pointerup",s)}},[n,e,t])}async function eNe(n,e,t){const{type:r,quality:i,scale:o,width:s,height:a}=t;let[c,l]=await C7t(s*o,a*o);c=Math.floor(c),l=Math.floor(l);const u=c/s,d=URL.createObjectURL(new Blob([e],{type:"image/svg+xml"})),h=await new Promise(p=>{const g=rx();g.crossOrigin="anonymous",g.onload=async()=>{n.environment.isSafari&&await new Promise(b=>n.timers.setTimeout(b,250));const m=document.createElement("canvas"),v=m.getContext("2d");m.width=c,m.height=l,v.imageSmoothingEnabled=!0,v.imageSmoothingQuality="high",v.drawImage(g,0,0,c,l),URL.revokeObjectURL(d),p(m)},g.onerror=()=>{p(null)},g.src=d});if(!h)return null;const f=await new Promise(p=>h.toBlob(g=>{(!g||ta.throwToBlob.get())&&p(null),p(g)},"image/"+r,i));if(!f)return null;if(r==="png"){const p=new DataView(await f.arrayBuffer());return Bp.setPhysChunk(p,u,{type:"image/"+r})}else return f}async function tNe(n,e,t){const r=await n.getSvgString(e!=null&&e.length?e:[...n.getCurrentPageShapeIds()],{scale:1,background:n.getInstanceState().exportBackground,...t});if(!r)throw new Error("Could not construct SVG.");return r}async function DX(n,e,t,r={}){var i;switch(t){case"svg":return(i=await tNe(n,e,r))==null?void 0:i.svg;case"json":{const o=await n.resolveAssetsInContent(n.getContentFromCurrentPage(e));return JSON.stringify(o)}default:vl(t)}}async function ioe({editor:n,ids:e,format:t,opts:r={}}){switch(t){case"svg":return new Blob([await DX(n,e,"svg",r)],{type:"text/plain"});case"json":return new Blob([await DX(n,e,"json",r)],{type:"text/plain"});case"jpeg":case"png":case"webp":{const i=await tNe(n,e,r);if(!i)throw new Error("Could not construct image.");const o=await eNe(n,i.svg,{type:t,quality:1,scale:2,width:i.width,height:i.height});if(!o)throw new Error("Could not construct image.");return o}default:vl(t)}}const UBt={jpeg:"image/jpeg",png:"image/png",webp:"image/webp",json:"text/plain",svg:"text/plain"};function zBt(n,e,t,r={}){return{blobPromise:ioe({editor:n,ids:e,format:t,opts:r}),mimeType:UBt[t]}}function VBt(n,e,t="svg",r={}){if(!window.navigator.clipboard)return Promise.reject(new Error("Copy not supported"));if(window.navigator.clipboard.write){const{blobPromise:i,mimeType:o}=zBt(n,e,t,r);return window.navigator.clipboard.write([new ClipboardItem({[o]:i})]).catch(s=>(console.error(s),i.then(a=>window.navigator.clipboard.write([new ClipboardItem({[o]:a})]))))}switch(t){case"json":case"svg":return WBt(async()=>DX(n,e,t,r));case"jpeg":case"png":throw new Error("Copy not supported");default:vl(t)}}async function WBt(n){var e,t;await((t=(e=navigator.clipboard)==null?void 0:e.writeText)==null?void 0:t.call(e,await n()))}function qBt(){const n=ot(),{addToast:e}=up(),t=Ni();return y.useCallback((r,i="svg")=>{VBt(n,r,i).catch(()=>{e({id:"copy-fail",severity:"warning",title:t("toast.error.copy-fail.title"),description:t("toast.error.copy-fail.desc")})})},[n,e,t])}async function KBt(n,e,t="png",r,i={}){if(!r&&(r=`shapes at ${H1e()}`,e.length===1)){const a=n.getShape(e[0]);n.isShapeOfType(a,"frame")?r=a.props.name??"frame":r=`${a.id.replace(/:/,"_")} at ${H1e()}`}r+=`.${t}`;const o=await ioe({editor:n,ids:e,format:t,opts:i}),s=new File([o],r,{type:o.type});GBt(s)}function H1e(){const n=new Date,e=String(n.getFullYear()).slice(2),t=String(n.getMonth()+1).padStart(2,"0"),r=String(n.getDate()).padStart(2,"0"),i=String(n.getHours()).padStart(2,"0"),o=String(n.getMinutes()).padStart(2,"0"),s=String(n.getSeconds()).padStart(2,"0");return`${e}-${t}-${r} ${i}.${o}.${s}`}function GBt(n){const e=document.createElement("a"),t=URL.createObjectURL(n);e.href=t,e.download=n.name,e.click(),URL.revokeObjectURL(t)}function ZBt(){const n=ot(),{addToast:e}=up(),t=Ni();return y.useCallback((r,i="png",o)=>{KBt(n,r,i,o,{scale:1,background:n.getInstanceState().exportBackground}).catch(s=>{console.error(s.message),e({id:"export-fail",title:t("toast.error.export-fail.title"),description:t("toast.error.export-fail.desc"),severity:"error"})})},[n,e,t])}async function XBt(n,e,t){const r=qr(e.map(a=>{const c=n.getShape(a);if(!(!c||n.getShapeUtil(c.type).toSvg===void 0))return c}));if(r.length===0)return;if(r.length===1){const a=r[0];if(!a||n.isShapeOfType(a,"image"))return}const i=[];if(t!==void 0){const a=r.map(c=>({shape:c,bounds:n.getShapeMaskedPageBounds(c).clone().expandBy(t)}));for(let c=0;c<a.length;c++){const l=a[c];if(c===0){i[0]={shapes:[l.shape],bounds:l.bounds};continue}let u=!1;for(const d of i)if(d.bounds.includes(l.bounds)){d.shapes.push(l.shape),d.bounds.expand(l.bounds),u=!0;break}u||i.push({shapes:[l.shape],bounds:l.bounds})}}else{const a=xn.Common(r.map(c=>n.getShapeMaskedPageBounds(c)));i.push({shapes:r,bounds:a})}const o=n.options.flattenImageBoundsPadding;for(const a of i){t!==void 0&&a.bounds.expandBy(-t);const c=await n.getSvgString(a.shapes,{padding:o});if(!(c!=null&&c.svg))continue;const l=new Blob([c.svg],{type:"image/svg+xml"}),u=await n.getAssetForExternalContent({type:"file",file:new File([l],"asset.svg",{type:"image/svg+xml"})});u&&(a.asset=u)}const s=[];return Gm(()=>{for(const a of i){const{asset:c,bounds:l,shapes:u}=a;if(!c)continue;const d=n.findCommonAncestor(u)??n.getCurrentPageId();if(!d)continue;let h="a1";for(const v of u)if(v.parentId===d){v.index>h&&(h=v.index);break}let f,p,g;if(ku(d)){const v=n.getShape(d);if(!v)continue;const b=n.getPointInShapeSpace(v,{x:l.x,y:l.y});g=n.getShapePageTransform(d).rotation(),b.sub(new H(o,o).rot(-g)),f=b.x,p=b.y}else f=l.x-o,p=l.y-o,g=0;n.deleteShapes(u),n.createAssets([{...c,id:c.id}]);const m=ro();n.createShape({id:m,type:"image",index:h,parentId:d,x:f,y:p,rotation:-g,props:{assetId:c.id,w:l.w+o*2,h:l.h+o*2}}),s.push(m)}}),s}function YBt(){const n=ot(),e=y.useRef(null),t=y.useRef(null);return y.useCallback(async function(){const i=document.createElement("div"),o=document.createElement("style"),s=(v,b)=>{v&&(v.innerHTML=""),b&&document.head.contains(b)&&document.head.removeChild(b),v&&document.body.contains(v)&&document.body.removeChild(v)};s(e.current,t.current),e.current=i,t.current=o;const a=`tl-print-surface-${us()}`;i.className=a,o.innerHTML=`
			.${a} {
				display: none;
			}

			.${a} svg {
				max-width: 100%;
				height: 100%;
				display: block;
			}

			@media print {				  
				html, body {
					min-height: 100%;
					height: 100%;
					margin: 0;
				}

				body {
					position: relative;
				}

				body > * {
					display: none;
				}

				.tldraw__editor {
					display: none;
				}

				.${a} {
					display: block !important;
					background: white;
					min-height: 100%;
					height: 100%;
					max-width: 100%;
				}

				.${a}__item {
					padding: 10mm;
					display: flex;
					min-height: 100%;
					flex-direction: column;
					page-break-after: always;
					position: relative;
					overflow: hidden;
					height: 100%;
				}

				.${a}__item__main {
					flex: 1;
					display: flex;
					align-items: center;
					justify-content: center;
					max-height: 100%;
				}

				.${a}__item__header {
					display: none;
				}

				.${a}__item__footer {
					display: none;
					text-align: right;
				}

				.${a}__item__footer__hide {
					display: none;
				}

				
			}

		`;const c=()=>{document.head.appendChild(o),document.body.appendChild(i)},l=()=>{n.once("tick",()=>{s(i,o)})};window.addEventListener("beforeprint",c),window.addEventListener("afterprint",l);function u(v,b,S){try{i.innerHTML+=`<div class="${a}__item">
        <div class="${a}__item__header">
          ${v.replace(/</g,"&lt;").replace(/>/g,"&gt;")}
        </div>
        <div class="${a}__item__main">
          ${S}
        </div>
        <div class="${a}__item__footer ${a}__item__footer__${b?"":"hide"}">
          ${b??""}
        </div>
      </div>`}catch(E){console.error(E)}}function d(){n.environment.isChromeForIos?(c(),window.print()):n.environment.isSafari?(c(),document.execCommand("print",!1)):window.print()}const h=n.getSelectedShapeIds(),f=n.getCurrentPageId(),p=n.getPages(),m={scale:1,background:!1,darkMode:!1,preserveAspectRatio:"xMidYMid meet"};if(n.getSelectedShapeIds().length>0){const v=await n.getSvgString(h,m);if(v){const b=p.find(S=>S.id===f);u(`tldraw — ${b==null?void 0:b.name}`,null,v.svg),d()}}else{const v=n.getCurrentPage(),b=await n.getSvgString(n.getSortedChildIdsForParent(v.id),m);b&&(u(`tldraw — ${v.name}`,null,b.svg),d())}window.removeEventListener("beforeprint",c),window.removeEventListener("afterprint",l)},[n])}const nNe=y.createContext(null);function JBt(n){return Object.fromEntries(n.map(e=>[e.id,e]))}function yw(n,e){if(n.getSelectedShapes().length===0)return n.getDocumentSettings().name||e}function QBt({overrides:n,children:e}){const t=ot(),{addDialog:r,clearDialogs:i}=g_(),{clearToasts:o}=up(),s=Ni(),a=q7e(),c=YBt(),{cut:l,copy:u,paste:d}=BBt(),h=qBt(),f=ZBt(),p=s("document.default-name"),g=lp(),m=y.useMemo(()=>{function v(){return t.isIn("select")||(t.complete(),t.setCurrentTool("select")),!1}function b(){return t.isIn("select")&&t.getSelectedShapeIds().length>0}const E=JBt([{id:"edit-link",label:"action.edit-link",icon:"link",onSelect(w){b()&&(v()||(g("edit-link",{source:w}),t.mark("edit-link"),r({component:yBt})))}},{id:"insert-embed",label:"action.insert-embed",kbd:"$i",onSelect(w){g("insert-embed",{source:w}),r({component:W7e})}},{id:"insert-media",label:"action.insert-media",kbd:"$u",onSelect(w){g("insert-media",{source:w}),a()}},{id:"undo",label:"action.undo",icon:"undo",kbd:"$z",onSelect(w){g("undo",{source:w}),t.undo()}},{id:"redo",label:"action.redo",icon:"redo",kbd:"$!z",onSelect(w){g("redo",{source:w}),t.redo()}},{id:"export-as-svg",label:{default:"action.export-as-svg",menu:"action.export-as-svg.short","context-menu":"action.export-as-svg.short"},readonlyOk:!0,onSelect(w){let C=t.getSelectedShapeIds();C.length===0&&(C=Array.from(t.getCurrentPageShapeIds().values())),C.length!==0&&(g("export-as",{format:"svg",source:w}),f(C,"svg",yw(t,p)))}},{id:"export-as-png",label:{default:"action.export-as-png",menu:"action.export-as-png.short","context-menu":"action.export-as-png.short"},readonlyOk:!0,onSelect(w){let C=t.getSelectedShapeIds();C.length===0&&(C=Array.from(t.getCurrentPageShapeIds().values())),C.length!==0&&(g("export-as",{format:"png",source:w}),f(C,"png",yw(t,p)))}},{id:"export-as-json",label:{default:"action.export-as-json",menu:"action.export-as-json.short","context-menu":"action.export-as-json.short"},readonlyOk:!0,onSelect(w){let C=t.getSelectedShapeIds();C.length===0&&(C=Array.from(t.getCurrentPageShapeIds().values())),C.length!==0&&(g("export-as",{format:"json",source:w}),f(C,"json",yw(t,p)))}},{id:"export-all-as-svg",label:{default:"action.export-all-as-svg",menu:"action.export-all-as-svg.short","context-menu":"action.export-all-as-svg.short"},readonlyOk:!0,onSelect(w){let C=t.getSelectedShapeIds();C.length===0&&(C=Array.from(t.getCurrentPageShapeIds().values())),C.length!==0&&(g("export-all-as",{format:"svg",source:w}),f(Array.from(t.getCurrentPageShapeIds()),"svg",yw(t,p)))}},{id:"export-all-as-png",label:{default:"action.export-all-as-png",menu:"action.export-all-as-png.short","context-menu":"action.export-all-as-png.short"},readonlyOk:!0,onSelect(w){const C=Array.from(t.getCurrentPageShapeIds().values());C.length!==0&&(g("export-all-as",{format:"png",source:w}),f(C,"png",yw(t,p)))}},{id:"export-all-as-json",label:{default:"action.export-all-as-json",menu:"action.export-all-as-json.short","context-menu":"action.export-all-as-json.short"},readonlyOk:!0,onSelect(w){const C=Array.from(t.getCurrentPageShapeIds().values());C.length!==0&&(g("export-all-as",{format:"json",source:w}),f(C,"json",yw(t,p)))}},{id:"copy-as-svg",label:{default:"action.copy-as-svg",menu:"action.copy-as-svg.short","context-menu":"action.copy-as-svg.short"},kbd:"$!c",readonlyOk:!0,onSelect(w){let C=t.getSelectedShapeIds();C.length===0&&(C=Array.from(t.getCurrentPageShapeIds().values())),C.length!==0&&(g("copy-as",{format:"svg",source:w}),h(C,"svg"))}},{id:"copy-as-png",label:{default:"action.copy-as-png",menu:"action.copy-as-png.short","context-menu":"action.copy-as-png.short"},readonlyOk:!0,onSelect(w){let C=t.getSelectedShapeIds();C.length===0&&(C=Array.from(t.getCurrentPageShapeIds().values())),C.length!==0&&(g("copy-as",{format:"png",source:w}),h(C,"png"))}},{id:"copy-as-json",label:{default:"action.copy-as-json",menu:"action.copy-as-json.short","context-menu":"action.copy-as-json.short"},readonlyOk:!0,onSelect(w){let C=t.getSelectedShapeIds();C.length===0&&(C=Array.from(t.getCurrentPageShapeIds().values())),C.length!==0&&(g("copy-as",{format:"json",source:w}),h(C,"json"))}},{id:"toggle-auto-size",label:"action.toggle-auto-size",onSelect(w){if(!b()||v())return;g("toggle-auto-size",{source:w}),t.mark("toggling auto size");const C=t.getSelectedShapes().filter(I=>t.isShapeOfType(I,"text")&&I.props.autoSize===!1);t.updateShapes(C.map(I=>({id:I.id,type:I.type,props:{...I.props,w:8,autoSize:!0}}))),Ao(t,C.map(I=>I.id))}},{id:"open-embed-link",label:"action.open-embed-link",readonlyOk:!0,onSelect(w){g("open-embed-link",{source:w});const C=t.getSelectedShapeIds(),I="No embed shapes selected";if(C.length!==1){console.error(I);return}const T=t.getShape(C[0]);if(!T||!t.isShapeOfType(T,"embed")){console.error(I);return}BLt(T.props.url,"_blank")}},{id:"select-zoom-tool",readonlyOk:!0,kbd:"z",onSelect(w){var C,I;if(((C=t.root.getCurrent())==null?void 0:C.id)!=="zoom"&&(g("zoom-tool",{source:w}),!(t.inputs.shiftKey||t.inputs.ctrlKey))){const T=t.root.getCurrent();T&&((I=T.getCurrent())==null?void 0:I.id)==="idle"&&t.setCurrentTool("zoom",{onInteractionEnd:T.id,maskAs:"zoom"})}}},{id:"convert-to-bookmark",label:"action.convert-to-bookmark",onSelect(w){b()&&(v()||t.batch(()=>{g("convert-to-bookmark",{source:w});const C=t.getSelectedShapes(),I=[],T=[];for(const D of C){if(!D||!t.isShapeOfType(D,"embed")||!D.props.url)continue;const O=new H(D.x,D.y);O.rot(-D.rotation),O.add(new H(D.props.w/2-300/2,D.props.h/2-320/2)),O.rot(D.rotation);const M={id:ro(),type:"bookmark",rotation:D.rotation,x:O.x,y:O.y,opacity:1,props:{url:D.props.url}};I.push(M),T.push(D.id)}t.mark("convert shapes to bookmark"),t.deleteShapes(T),t.createShapes(I)}))}},{id:"convert-to-embed",label:"action.convert-to-embed",onSelect(w){b()&&(v()||(g("convert-to-embed",{source:w}),t.batch(()=>{const C=t.getSelectedShapeIds(),I=qr(C.map(O=>t.getShape(O))),T=[],D=[];for(const O of I){if(!t.isShapeOfType(O,"bookmark"))continue;const{url:M}=O.props,R=K0(O.props.url);if(!R||!R.definition)continue;const{width:A,height:k}=R.definition,L=new H(O.x,O.y);L.rot(-O.rotation),L.add(new H(O.props.w/2-A/2,O.props.h/2-k/2)),L.rot(O.rotation);const j={id:ro(),type:"embed",x:L.x,y:L.y,rotation:O.rotation,props:{url:M,w:A,h:k}};T.push(j),D.push(O.id)}t.mark("convert shapes to embed"),t.deleteShapes(D),t.createShapes(T)})))}},{id:"duplicate",kbd:"$d",label:"action.duplicate",icon:"duplicate",onSelect(w){if(!b()||v())return;g("duplicate-shapes",{source:w});const C=t.getInstanceState();let I,T;if(C.duplicateProps)I=C.duplicateProps.shapeIds,T=C.duplicateProps.offset;else{I=t.getSelectedShapeIds();const D=xn.Common(qr(I.map(O=>t.getShapePageBounds(O))));T=t.getCameraOptions().isLocked?{x:20,y:20}:{x:D.width+20,y:0}}t.mark("duplicate shapes"),t.duplicateShapes(I,T),C.duplicateProps&&t.updateInstanceState({duplicateProps:{...C.duplicateProps,shapeIds:t.getSelectedShapeIds()}})}},{id:"ungroup",label:"action.ungroup",kbd:"$!g",icon:"ungroup",onSelect(w){b()&&(v()||(g("ungroup-shapes",{source:w}),t.mark("ungroup"),t.ungroupShapes(t.getSelectedShapeIds())))}},{id:"group",label:"action.group",kbd:"$g",icon:"group",onSelect(w){if(!b()||v())return;g("group-shapes",{source:w});const C=t.getOnlySelectedShape();C&&t.isShapeOfType(C,"group")?(t.mark("ungroup"),t.ungroupShapes(t.getSelectedShapeIds())):(t.mark("group"),t.groupShapes(t.getSelectedShapeIds()))}},{id:"remove-frame",label:"action.remove-frame",kbd:"$!f",onSelect(w){if(!b())return;g("remove-frame",{source:w});const C=t.getSelectedShapes();C.length>0&&C.every(I=>t.isShapeOfType(I,"frame"))&&(t.mark("remove-frame"),gBt(t,C.map(I=>I.id)))}},{id:"fit-frame-to-content",label:"action.fit-frame-to-content",onSelect(w){if(!b())return;g("fit-frame-to-content",{source:w});const C=t.getOnlySelectedShape();C&&t.isShapeOfType(C,"frame")&&(t.mark("fit-frame-to-content"),vBt(t,C.id))}},{id:"align-left",label:"action.align-left",kbd:"?A",icon:"align-left",onSelect(w){if(!b()||v())return;g("align-shapes",{operation:"left",source:w}),t.mark("align left");const C=t.getSelectedShapeIds();t.alignShapes(C,"left"),Ao(t,C)}},{id:"align-center-horizontal",label:{default:"action.align-center-horizontal","context-menu":"action.align-center-horizontal.short"},kbd:"?H",icon:"align-center-horizontal",onSelect(w){if(!b()||v())return;g("align-shapes",{operation:"center-horizontal",source:w}),t.mark("align center horizontal");const C=t.getSelectedShapeIds();t.alignShapes(C,"center-horizontal"),Ao(t,C)}},{id:"align-right",label:"action.align-right",kbd:"?D",icon:"align-right",onSelect(w){if(!b()||v())return;g("align-shapes",{operation:"right",source:w}),t.mark("align right");const C=t.getSelectedShapeIds();t.alignShapes(C,"right"),Ao(t,C)}},{id:"align-center-vertical",label:{default:"action.align-center-vertical","context-menu":"action.align-center-vertical.short"},kbd:"?V",icon:"align-center-vertical",onSelect(w){if(!b()||v())return;g("align-shapes",{operation:"center-vertical",source:w}),t.mark("align center vertical");const C=t.getSelectedShapeIds();t.alignShapes(C,"center-vertical"),Ao(t,C)}},{id:"align-top",label:"action.align-top",icon:"align-top",kbd:"?W",onSelect(w){if(!b()||v())return;g("align-shapes",{operation:"top",source:w}),t.mark("align top");const C=t.getSelectedShapeIds();t.alignShapes(C,"top"),Ao(t,C)}},{id:"align-bottom",label:"action.align-bottom",icon:"align-bottom",kbd:"?S",onSelect(w){if(!b()||v())return;g("align-shapes",{operation:"bottom",source:w}),t.mark("align bottom");const C=t.getSelectedShapeIds();t.alignShapes(C,"bottom"),Ao(t,C)}},{id:"distribute-horizontal",label:{default:"action.distribute-horizontal","context-menu":"action.distribute-horizontal.short"},icon:"distribute-horizontal",kbd:"?!h",onSelect(w){if(!b()||v())return;g("distribute-shapes",{operation:"horizontal",source:w}),t.mark("distribute horizontal");const C=t.getSelectedShapeIds();t.distributeShapes(C,"horizontal"),Ao(t,C)}},{id:"distribute-vertical",label:{default:"action.distribute-vertical","context-menu":"action.distribute-vertical.short"},icon:"distribute-vertical",kbd:"?!V",onSelect(w){if(!b()||v())return;g("distribute-shapes",{operation:"vertical",source:w}),t.mark("distribute vertical");const C=t.getSelectedShapeIds();t.distributeShapes(C,"vertical"),Ao(t,C)}},{id:"stretch-horizontal",label:{default:"action.stretch-horizontal","context-menu":"action.stretch-horizontal.short"},icon:"stretch-horizontal",onSelect(w){if(!b()||v())return;g("stretch-shapes",{operation:"horizontal",source:w}),t.mark("stretch horizontal");const C=t.getSelectedShapeIds();t.stretchShapes(C,"horizontal"),Ao(t,C)}},{id:"stretch-vertical",label:{default:"action.stretch-vertical","context-menu":"action.stretch-vertical.short"},icon:"stretch-vertical",onSelect(w){if(!b()||v())return;g("stretch-shapes",{operation:"vertical",source:w}),t.mark("stretch vertical");const C=t.getSelectedShapeIds();t.stretchShapes(C,"vertical"),Ao(t,C)}},{id:"flip-horizontal",label:{default:"action.flip-horizontal","context-menu":"action.flip-horizontal.short"},kbd:"!h",onSelect(w){if(!b()||v())return;g("flip-shapes",{operation:"horizontal",source:w}),t.mark("flip horizontal");const C=t.getSelectedShapeIds();t.flipShapes(C,"horizontal"),Ao(t,C)}},{id:"flip-vertical",label:{default:"action.flip-vertical","context-menu":"action.flip-vertical.short"},kbd:"!v",onSelect(w){if(!b()||v())return;g("flip-shapes",{operation:"vertical",source:w}),t.mark("flip vertical");const C=t.getSelectedShapeIds();t.flipShapes(C,"vertical"),Ao(t,C)}},{id:"pack",label:"action.pack",icon:"pack",onSelect(w){if(!b()||v())return;g("pack-shapes",{source:w}),t.mark("pack");const C=t.getSelectedShapeIds();t.packShapes(C,t.options.adjacentShapeMargin),Ao(t,C)}},{id:"stack-vertical",label:{default:"action.stack-vertical","context-menu":"action.stack-vertical.short"},icon:"stack-vertical",onSelect(w){if(!b()||v())return;g("stack-shapes",{operation:"vertical",source:w}),t.mark("stack-vertical");const C=t.getSelectedShapeIds();t.stackShapes(C,"vertical",16),Ao(t,C)}},{id:"stack-horizontal",label:{default:"action.stack-horizontal","context-menu":"action.stack-horizontal.short"},icon:"stack-horizontal",onSelect(w){if(!b()||v())return;g("stack-shapes",{operation:"horizontal",source:w}),t.mark("stack-horizontal");const C=t.getSelectedShapeIds();t.stackShapes(C,"horizontal",16),Ao(t,C)}},{id:"bring-to-front",label:"action.bring-to-front",kbd:"]",icon:"bring-to-front",onSelect(w){b()&&(v()||(g("reorder-shapes",{operation:"toFront",source:w}),t.mark("bring to front"),t.bringToFront(t.getSelectedShapeIds())))}},{id:"bring-forward",label:"action.bring-forward",icon:"bring-forward",kbd:"?]",onSelect(w){b()&&(v()||(g("reorder-shapes",{operation:"forward",source:w}),t.mark("bring forward"),t.bringForward(t.getSelectedShapeIds())))}},{id:"send-backward",label:"action.send-backward",icon:"send-backward",kbd:"?[",onSelect(w){b()&&(v()||(g("reorder-shapes",{operation:"backward",source:w}),t.mark("send backward"),t.sendBackward(t.getSelectedShapeIds())))}},{id:"send-to-back",label:"action.send-to-back",icon:"send-to-back",kbd:"[",onSelect(w){b()&&(v()||(g("reorder-shapes",{operation:"toBack",source:w}),t.mark("send to back"),t.sendToBack(t.getSelectedShapeIds())))}},{id:"cut",label:"action.cut",kbd:"$x",onSelect(w){b()&&(v()||(t.mark("cut"),l(w)))}},{id:"copy",label:"action.copy",kbd:"$c",readonlyOk:!0,onSelect(w){b()&&(v()||u(w))}},{id:"paste",label:"action.paste",kbd:"$v",onSelect(w){var C;(C=navigator.clipboard)==null||C.read().then(I=>{d(I,w,w==="context-menu"?t.inputs.currentPagePoint:void 0)})}},{id:"select-all",label:"action.select-all",kbd:"$a",readonlyOk:!0,onSelect(w){t.batch(()=>{v()||(g("select-all-shapes",{source:w}),t.mark("select all kbd"),t.selectAll())})}},{id:"select-none",label:"action.select-none",readonlyOk:!0,onSelect(w){b()&&(v()||(g("select-none-shapes",{source:w}),t.mark("select none"),t.selectNone()))}},{id:"delete",label:"action.delete",kbd:"⌫,del,backspace",icon:"trash",onSelect(w){b()&&(v()||(g("delete-shapes",{source:w}),t.mark("delete"),t.deleteShapes(t.getSelectedShapeIds())))}},{id:"rotate-cw",label:"action.rotate-cw",icon:"rotate-cw",onSelect(w){if(!b()||v())return;g("rotate-cw",{source:w}),t.mark("rotate-cw");const C=t.getSelectionRotation()%(Fo/2),I=sy(C,0)||sy(C,Fo/2),T=t.getSelectedShapeIds();t.rotateShapesBy(T,Fo/2-(I?0:C)),Ao(t,T)}},{id:"rotate-ccw",label:"action.rotate-ccw",icon:"rotate-ccw",onSelect(w){if(!b()||v())return;g("rotate-ccw",{source:w}),t.mark("rotate-ccw");const C=t.getSelectionRotation()%(Fo/2),I=sy(C,0),T=t.getSelectedShapeIds();t.rotateShapesBy(T,I?-(Fo/2):-C),Ao(t,T)}},{id:"zoom-in",label:"action.zoom-in",kbd:"$=,=",readonlyOk:!0,onSelect(w){g("zoom-in",{source:w}),t.zoomIn(void 0,{animation:{duration:t.options.animationMediumMs}})}},{id:"zoom-out",label:"action.zoom-out",kbd:"$-,-",readonlyOk:!0,onSelect(w){g("zoom-out",{source:w}),t.zoomOut(void 0,{animation:{duration:t.options.animationMediumMs}})}},{id:"zoom-to-100",label:"action.zoom-to-100",icon:"reset-zoom",kbd:"!0",readonlyOk:!0,onSelect(w){g("reset-zoom",{source:w}),t.resetZoom(void 0,{animation:{duration:t.options.animationMediumMs}})}},{id:"zoom-to-fit",label:"action.zoom-to-fit",kbd:"!1",readonlyOk:!0,onSelect(w){g("zoom-to-fit",{source:w}),t.zoomToFit({animation:{duration:t.options.animationMediumMs}})}},{id:"zoom-to-selection",label:"action.zoom-to-selection",kbd:"!2",readonlyOk:!0,onSelect(w){b()&&(v()||(g("zoom-to-selection",{source:w}),t.zoomToSelection({animation:{duration:t.options.animationMediumMs}})))}},{id:"toggle-snap-mode",label:{default:"action.toggle-snap-mode",menu:"action.toggle-snap-mode.menu"},onSelect(w){g("toggle-snap-mode",{source:w}),t.user.updateUserPreferences({isSnapMode:!t.user.getIsSnapMode()})},checkbox:!0},{id:"toggle-dark-mode",label:{default:"action.toggle-dark-mode",menu:"action.toggle-dark-mode.menu"},kbd:"$/",readonlyOk:!0,onSelect(w){const C=t.user.getIsDarkMode()?"light":"dark";g("color-scheme",{source:w,value:C}),t.user.updateUserPreferences({colorScheme:C})},checkbox:!0},{id:"toggle-wrap-mode",label:{default:"action.toggle-wrap-mode",menu:"action.toggle-wrap-mode.menu"},readonlyOk:!0,onSelect(w){g("toggle-wrap-mode",{source:w}),t.user.updateUserPreferences({isWrapMode:!t.user.getIsWrapMode()})},checkbox:!0},{id:"toggle-dynamic-size-mode",label:{default:"action.toggle-dynamic-size-mode",menu:"action.toggle-dynamic-size-mode.menu"},readonlyOk:!1,onSelect(w){g("toggle-dynamic-size-mode",{source:w}),t.user.updateUserPreferences({isDynamicSizeMode:!t.user.getIsDynamicResizeMode()})},checkbox:!0},{id:"toggle-reduce-motion",label:{default:"action.toggle-reduce-motion",menu:"action.toggle-reduce-motion.menu"},readonlyOk:!0,onSelect(w){g("toggle-reduce-motion",{source:w}),t.user.updateUserPreferences({animationSpeed:t.user.getAnimationSpeed()===0?1:0})},checkbox:!0},{id:"toggle-edge-scrolling",label:{default:"action.toggle-edge-scrolling",menu:"action.toggle-edge-scrolling.menu"},readonlyOk:!0,onSelect(w){g("toggle-edge-scrolling",{source:w}),t.user.updateUserPreferences({edgeScrollSpeed:t.user.getEdgeScrollSpeed()===0?1:0})},checkbox:!0},{id:"toggle-transparent",label:{default:"action.toggle-transparent",menu:"action.toggle-transparent.menu","context-menu":"action.toggle-transparent.context-menu"},readonlyOk:!0,onSelect(w){g("toggle-transparent",{source:w}),t.updateInstanceState({exportBackground:!t.getInstanceState().exportBackground})},checkbox:!0},{id:"toggle-tool-lock",label:{default:"action.toggle-tool-lock",menu:"action.toggle-tool-lock.menu"},kbd:"q",onSelect(w){g("toggle-tool-lock",{source:w}),t.updateInstanceState({isToolLocked:!t.getInstanceState().isToolLocked})},checkbox:!0},{id:"unlock-all",label:"action.unlock-all",onSelect(w){g("unlock-all",{source:w});const C=[];for(const I of t.getCurrentPageShapes())I.isLocked&&C.push({id:I.id,type:I.type,isLocked:!1});C.length>0&&t.updateShapes(C)}},{id:"toggle-focus-mode",label:{default:"action.toggle-focus-mode",menu:"action.toggle-focus-mode.menu"},readonlyOk:!0,kbd:"$.",checkbox:!0,onSelect(w){t.timers.requestAnimationFrame(()=>{t.batch(()=>{g("toggle-focus-mode",{source:w}),i(),o(),t.updateInstanceState({isFocusMode:!t.getInstanceState().isFocusMode})})})}},{id:"toggle-grid",label:{default:"action.toggle-grid",menu:"action.toggle-grid.menu"},readonlyOk:!0,kbd:"$'",onSelect(w){g("toggle-grid-mode",{source:w}),t.updateInstanceState({isGridMode:!t.getInstanceState().isGridMode})},checkbox:!0},{id:"toggle-debug-mode",label:{default:"action.toggle-debug-mode",menu:"action.toggle-debug-mode.menu"},readonlyOk:!0,onSelect(w){g("toggle-debug-mode",{source:w}),t.updateInstanceState({isDebugMode:!t.getInstanceState().isDebugMode})},checkbox:!0},{id:"print",label:"action.print",kbd:"$p",readonlyOk:!0,onSelect(w){g("print",{source:w}),c()}},{id:"exit-pen-mode",label:"action.exit-pen-mode",icon:"cross-2",readonlyOk:!0,onSelect(w){g("exit-pen-mode",{source:w}),t.updateInstanceState({isPenMode:!1})}},{id:"stop-following",label:"action.stop-following",icon:"cross-2",readonlyOk:!0,onSelect(w){g("stop-following",{source:w}),t.stopFollowingUser()}},{id:"back-to-content",label:"action.back-to-content",icon:"arrow-left",readonlyOk:!0,onSelect(w){g("zoom-to-content",{source:w});const C=t.getSelectionPageBounds()??t.getCurrentPageBounds();C&&t.zoomToBounds(C,{targetZoom:Math.min(1,t.getZoomLevel()),animation:{duration:220}})}},{id:"toggle-lock",label:"action.toggle-lock",kbd:"!l",onSelect(w){t.mark("locking"),g("toggle-lock",{source:w}),t.toggleLock(t.getSelectedShapeIds())}},{id:"new-page",label:"context.pages.new-page",onSelect(w){const C=dv.createId(),I=t.getSelectedShapeIds();t.batch(()=>{t.mark("move_shapes_to_page"),t.createPage({name:s("page-menu.new-page-initial-name"),id:C}),t.moveShapesToPage(I,C)}),g("new-page",{source:w})}},{id:"select-white-color",label:"color-style.white",kbd:"?t",onSelect(w){const C=qd;t.batch(()=>{t.mark("change-color"),t.isIn("select")&&t.setStyleForSelectedShapes(C,"white"),t.setStyleForNextShapes(C,"white")}),g("set-style",{source:w,id:C.id,value:"white"})}},{id:"select-fill-fill",label:"fill-style.fill",kbd:"?f",onSelect(w){const C=zS;t.batch(()=>{t.mark("change-fill"),t.isIn("select")&&t.setStyleForSelectedShapes(C,"fill"),t.setStyleForNextShapes(C,"fill")}),g("set-style",{source:w,id:C.id,value:"fill"})}},{id:"flatten-to-image",label:"action.flatten-to-image",kbd:"!f",onSelect:async w=>{const C=t.getSelectedShapeIds();if(C.length===0)return;t.mark("flattening to image"),g("flatten-to-image",{source:w});const I=await XBt(t,C,t.options.flattenImageBoundsExpand);I!=null&&I.length&&t.setSelectedShapes(I)}}]);return n?n(t,E,void 0):E},[t,g,n,r,a,f,h,l,u,d,i,o,c,s,p]);return x.jsx(nNe.Provider,{value:m,children:e})}function Hn(){const n=y.useContext(nNe);if(!n)throw new Error("useTools must be used within a ToolProvider");return n}function K3(n,e){return n?typeof n=="string"?n:e?n[e]??n.default:void 0:void 0}const eHt=["top","right","bottom","left"],Yp=Math.min,Ed=Math.max,S$=Math.round,IA=Math.floor,Ry=n=>({x:n,y:n}),tHt={left:"right",right:"left",bottom:"top",top:"bottom"},nHt={start:"end",end:"start"};function RX(n,e,t){return Ed(n,Yp(e,t))}function fv(n,e){return typeof n=="function"?n(e):n}function pv(n){return n.split("-")[0]}function yE(n){return n.split("-")[1]}function ooe(n){return n==="x"?"y":"x"}function soe(n){return n==="y"?"height":"width"}function Ay(n){return["top","bottom"].includes(pv(n))?"y":"x"}function aoe(n){return ooe(Ay(n))}function rHt(n,e,t){t===void 0&&(t=!1);const r=yE(n),i=aoe(n),o=soe(i);let s=i==="x"?r===(t?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[o]>e.floating[o]&&(s=_$(s)),[s,_$(s)]}function iHt(n){const e=_$(n);return[AX(n),e,AX(e)]}function AX(n){return n.replace(/start|end/g,e=>nHt[e])}function oHt(n,e,t){const r=["left","right"],i=["right","left"],o=["top","bottom"],s=["bottom","top"];switch(n){case"top":case"bottom":return t?e?i:r:e?r:i;case"left":case"right":return e?o:s;default:return[]}}function sHt(n,e,t,r){const i=yE(n);let o=oHt(pv(n),t==="start",r);return i&&(o=o.map(s=>s+"-"+i),e&&(o=o.concat(o.map(AX)))),o}function _$(n){return n.replace(/left|right|bottom|top/g,e=>tHt[e])}function aHt(n){return{top:0,right:0,bottom:0,left:0,...n}}function rNe(n){return typeof n!="number"?aHt(n):{top:n,right:n,bottom:n,left:n}}function w$(n){const{x:e,y:t,width:r,height:i}=n;return{width:r,height:i,top:t,left:e,right:e+r,bottom:t+i,x:e,y:t}}function U1e(n,e,t){let{reference:r,floating:i}=n;const o=Ay(e),s=aoe(e),a=soe(s),c=pv(e),l=o==="y",u=r.x+r.width/2-i.width/2,d=r.y+r.height/2-i.height/2,h=r[a]/2-i[a]/2;let f;switch(c){case"top":f={x:u,y:r.y-i.height};break;case"bottom":f={x:u,y:r.y+r.height};break;case"right":f={x:r.x+r.width,y:d};break;case"left":f={x:r.x-i.width,y:d};break;default:f={x:r.x,y:r.y}}switch(yE(e)){case"start":f[s]-=h*(t&&l?-1:1);break;case"end":f[s]+=h*(t&&l?-1:1);break}return f}const cHt=async(n,e,t)=>{const{placement:r="bottom",strategy:i="absolute",middleware:o=[],platform:s}=t,a=o.filter(Boolean),c=await(s.isRTL==null?void 0:s.isRTL(e));let l=await s.getElementRects({reference:n,floating:e,strategy:i}),{x:u,y:d}=U1e(l,r,c),h=r,f={},p=0;for(let g=0;g<a.length;g++){const{name:m,fn:v}=a[g],{x:b,y:S,data:E,reset:w}=await v({x:u,y:d,initialPlacement:r,placement:h,strategy:i,middlewareData:f,rects:l,platform:s,elements:{reference:n,floating:e}});u=b??u,d=S??d,f={...f,[m]:{...f[m],...E}},w&&p<=50&&(p++,typeof w=="object"&&(w.placement&&(h=w.placement),w.rects&&(l=w.rects===!0?await s.getElementRects({reference:n,floating:e,strategy:i}):w.rects),{x:u,y:d}=U1e(l,h,c)),g=-1)}return{x:u,y:d,placement:h,strategy:i,middlewareData:f}};async function G3(n,e){var t;e===void 0&&(e={});const{x:r,y:i,platform:o,rects:s,elements:a,strategy:c}=n,{boundary:l="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:h=!1,padding:f=0}=fv(e,n),p=rNe(f),m=a[h?d==="floating"?"reference":"floating":d],v=w$(await o.getClippingRect({element:(t=await(o.isElement==null?void 0:o.isElement(m)))==null||t?m:m.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(a.floating)),boundary:l,rootBoundary:u,strategy:c})),b=d==="floating"?{x:r,y:i,width:s.floating.width,height:s.floating.height}:s.reference,S=await(o.getOffsetParent==null?void 0:o.getOffsetParent(a.floating)),E=await(o.isElement==null?void 0:o.isElement(S))?await(o.getScale==null?void 0:o.getScale(S))||{x:1,y:1}:{x:1,y:1},w=w$(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:b,offsetParent:S,strategy:c}):b);return{top:(v.top-w.top+p.top)/E.y,bottom:(w.bottom-v.bottom+p.bottom)/E.y,left:(v.left-w.left+p.left)/E.x,right:(w.right-v.right+p.right)/E.x}}const lHt=n=>({name:"arrow",options:n,async fn(e){const{x:t,y:r,placement:i,rects:o,platform:s,elements:a,middlewareData:c}=e,{element:l,padding:u=0}=fv(n,e)||{};if(l==null)return{};const d=rNe(u),h={x:t,y:r},f=aoe(i),p=soe(f),g=await s.getDimensions(l),m=f==="y",v=m?"top":"left",b=m?"bottom":"right",S=m?"clientHeight":"clientWidth",E=o.reference[p]+o.reference[f]-h[f]-o.floating[p],w=h[f]-o.reference[f],C=await(s.getOffsetParent==null?void 0:s.getOffsetParent(l));let I=C?C[S]:0;(!I||!await(s.isElement==null?void 0:s.isElement(C)))&&(I=a.floating[S]||o.floating[p]);const T=E/2-w/2,D=I/2-g[p]/2-1,O=Yp(d[v],D),M=Yp(d[b],D),R=O,A=I-g[p]-M,k=I/2-g[p]/2+T,L=RX(R,k,A),j=!c.arrow&&yE(i)!=null&&k!==L&&o.reference[p]/2-(k<R?O:M)-g[p]/2<0,N=j?k<R?k-R:k-A:0;return{[f]:h[f]+N,data:{[f]:L,centerOffset:k-L-N,...j&&{alignmentOffset:N}},reset:j}}}),uHt=function(n){return n===void 0&&(n={}),{name:"flip",options:n,async fn(e){var t,r;const{placement:i,middlewareData:o,rects:s,initialPlacement:a,platform:c,elements:l}=e,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:h,fallbackStrategy:f="bestFit",fallbackAxisSideDirection:p="none",flipAlignment:g=!0,...m}=fv(n,e);if((t=o.arrow)!=null&&t.alignmentOffset)return{};const v=pv(i),b=Ay(a),S=pv(a)===a,E=await(c.isRTL==null?void 0:c.isRTL(l.floating)),w=h||(S||!g?[_$(a)]:iHt(a)),C=p!=="none";!h&&C&&w.push(...sHt(a,g,p,E));const I=[a,...w],T=await G3(e,m),D=[];let O=((r=o.flip)==null?void 0:r.overflows)||[];if(u&&D.push(T[v]),d){const k=rHt(i,s,E);D.push(T[k[0]],T[k[1]])}if(O=[...O,{placement:i,overflows:D}],!D.every(k=>k<=0)){var M,R;const k=(((M=o.flip)==null?void 0:M.index)||0)+1,L=I[k];if(L)return{data:{index:k,overflows:O},reset:{placement:L}};let j=(R=O.filter(N=>N.overflows[0]<=0).sort((N,B)=>N.overflows[1]-B.overflows[1])[0])==null?void 0:R.placement;if(!j)switch(f){case"bestFit":{var A;const N=(A=O.filter(B=>{if(C){const U=Ay(B.placement);return U===b||U==="y"}return!0}).map(B=>[B.placement,B.overflows.filter(U=>U>0).reduce((U,K)=>U+K,0)]).sort((B,U)=>B[1]-U[1])[0])==null?void 0:A[0];N&&(j=N);break}case"initialPlacement":j=a;break}if(i!==j)return{reset:{placement:j}}}return{}}}};function z1e(n,e){return{top:n.top-e.height,right:n.right-e.width,bottom:n.bottom-e.height,left:n.left-e.width}}function V1e(n){return eHt.some(e=>n[e]>=0)}const dHt=function(n){return n===void 0&&(n={}),{name:"hide",options:n,async fn(e){const{rects:t}=e,{strategy:r="referenceHidden",...i}=fv(n,e);switch(r){case"referenceHidden":{const o=await G3(e,{...i,elementContext:"reference"}),s=z1e(o,t.reference);return{data:{referenceHiddenOffsets:s,referenceHidden:V1e(s)}}}case"escaped":{const o=await G3(e,{...i,altBoundary:!0}),s=z1e(o,t.floating);return{data:{escapedOffsets:s,escaped:V1e(s)}}}default:return{}}}}};async function hHt(n,e){const{placement:t,platform:r,elements:i}=n,o=await(r.isRTL==null?void 0:r.isRTL(i.floating)),s=pv(t),a=yE(t),c=Ay(t)==="y",l=["left","top"].includes(s)?-1:1,u=o&&c?-1:1,d=fv(e,n);let{mainAxis:h,crossAxis:f,alignmentAxis:p}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...d};return a&&typeof p=="number"&&(f=a==="end"?p*-1:p),c?{x:f*u,y:h*l}:{x:h*l,y:f*u}}const fHt=function(n){return n===void 0&&(n=0),{name:"offset",options:n,async fn(e){var t,r;const{x:i,y:o,placement:s,middlewareData:a}=e,c=await hHt(e,n);return s===((t=a.offset)==null?void 0:t.placement)&&(r=a.arrow)!=null&&r.alignmentOffset?{}:{x:i+c.x,y:o+c.y,data:{...c,placement:s}}}}},pHt=function(n){return n===void 0&&(n={}),{name:"shift",options:n,async fn(e){const{x:t,y:r,placement:i}=e,{mainAxis:o=!0,crossAxis:s=!1,limiter:a={fn:m=>{let{x:v,y:b}=m;return{x:v,y:b}}},...c}=fv(n,e),l={x:t,y:r},u=await G3(e,c),d=Ay(pv(i)),h=ooe(d);let f=l[h],p=l[d];if(o){const m=h==="y"?"top":"left",v=h==="y"?"bottom":"right",b=f+u[m],S=f-u[v];f=RX(b,f,S)}if(s){const m=d==="y"?"top":"left",v=d==="y"?"bottom":"right",b=p+u[m],S=p-u[v];p=RX(b,p,S)}const g=a.fn({...e,[h]:f,[d]:p});return{...g,data:{x:g.x-t,y:g.y-r}}}}},gHt=function(n){return n===void 0&&(n={}),{options:n,fn(e){const{x:t,y:r,placement:i,rects:o,middlewareData:s}=e,{offset:a=0,mainAxis:c=!0,crossAxis:l=!0}=fv(n,e),u={x:t,y:r},d=Ay(i),h=ooe(d);let f=u[h],p=u[d];const g=fv(a,e),m=typeof g=="number"?{mainAxis:g,crossAxis:0}:{mainAxis:0,crossAxis:0,...g};if(c){const S=h==="y"?"height":"width",E=o.reference[h]-o.floating[S]+m.mainAxis,w=o.reference[h]+o.reference[S]-m.mainAxis;f<E?f=E:f>w&&(f=w)}if(l){var v,b;const S=h==="y"?"width":"height",E=["top","left"].includes(pv(i)),w=o.reference[d]-o.floating[S]+(E&&((v=s.offset)==null?void 0:v[d])||0)+(E?0:m.crossAxis),C=o.reference[d]+o.reference[S]+(E?0:((b=s.offset)==null?void 0:b[d])||0)-(E?m.crossAxis:0);p<w?p=w:p>C&&(p=C)}return{[h]:f,[d]:p}}}},mHt=function(n){return n===void 0&&(n={}),{name:"size",options:n,async fn(e){const{placement:t,rects:r,platform:i,elements:o}=e,{apply:s=()=>{},...a}=fv(n,e),c=await G3(e,a),l=pv(t),u=yE(t),d=Ay(t)==="y",{width:h,height:f}=r.floating;let p,g;l==="top"||l==="bottom"?(p=l,g=u===(await(i.isRTL==null?void 0:i.isRTL(o.floating))?"start":"end")?"left":"right"):(g=l,p=u==="end"?"top":"bottom");const m=f-c.top-c.bottom,v=h-c.left-c.right,b=Yp(f-c[p],m),S=Yp(h-c[g],v),E=!e.middlewareData.shift;let w=b,C=S;if(d?C=u||E?Yp(S,v):v:w=u||E?Yp(b,m):m,E&&!u){const T=Ed(c.left,0),D=Ed(c.right,0),O=Ed(c.top,0),M=Ed(c.bottom,0);d?C=h-2*(T!==0||D!==0?T+D:Ed(c.left,c.right)):w=f-2*(O!==0||M!==0?O+M:Ed(c.top,c.bottom))}await s({...e,availableWidth:C,availableHeight:w});const I=await i.getDimensions(o.floating);return h!==I.width||f!==I.height?{reset:{rects:!0}}:{}}}};function bE(n){return iNe(n)?(n.nodeName||"").toLowerCase():"#document"}function jd(n){var e;return(n==null||(e=n.ownerDocument)==null?void 0:e.defaultView)||window}function Iv(n){var e;return(e=(iNe(n)?n.ownerDocument:n.document)||window.document)==null?void 0:e.documentElement}function iNe(n){return n instanceof Node||n instanceof jd(n).Node}function _g(n){return n instanceof Element||n instanceof jd(n).Element}function wg(n){return n instanceof HTMLElement||n instanceof jd(n).HTMLElement}function W1e(n){return typeof ShadowRoot>"u"?!1:n instanceof ShadowRoot||n instanceof jd(n).ShadowRoot}function UD(n){const{overflow:e,overflowX:t,overflowY:r,display:i}=ep(n);return/auto|scroll|overlay|hidden|clip/.test(e+r+t)&&!["inline","contents"].includes(i)}function vHt(n){return["table","td","th"].includes(bE(n))}function YN(n){return[":popover-open",":modal"].some(e=>{try{return n.matches(e)}catch{return!1}})}function coe(n){const e=loe(),t=ep(n);return t.transform!=="none"||t.perspective!=="none"||(t.containerType?t.containerType!=="normal":!1)||!e&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!e&&(t.filter?t.filter!=="none":!1)||["transform","perspective","filter"].some(r=>(t.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(t.contain||"").includes(r))}function yHt(n){let e=Oy(n);for(;wg(e)&&!fx(e);){if(YN(e))return null;if(coe(e))return e;e=Oy(e)}return null}function loe(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function fx(n){return["html","body","#document"].includes(bE(n))}function ep(n){return jd(n).getComputedStyle(n)}function JN(n){return _g(n)?{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}:{scrollLeft:n.scrollX,scrollTop:n.scrollY}}function Oy(n){if(bE(n)==="html")return n;const e=n.assignedSlot||n.parentNode||W1e(n)&&n.host||Iv(n);return W1e(e)?e.host:e}function oNe(n){const e=Oy(n);return fx(e)?n.ownerDocument?n.ownerDocument.body:n.body:wg(e)&&UD(e)?e:oNe(e)}function Z3(n,e,t){var r;e===void 0&&(e=[]),t===void 0&&(t=!0);const i=oNe(n),o=i===((r=n.ownerDocument)==null?void 0:r.body),s=jd(i);return o?e.concat(s,s.visualViewport||[],UD(i)?i:[],s.frameElement&&t?Z3(s.frameElement):[]):e.concat(i,Z3(i,[],t))}function sNe(n){const e=ep(n);let t=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const i=wg(n),o=i?n.offsetWidth:t,s=i?n.offsetHeight:r,a=S$(t)!==o||S$(r)!==s;return a&&(t=o,r=s),{width:t,height:r,$:a}}function uoe(n){return _g(n)?n:n.contextElement}function YC(n){const e=uoe(n);if(!wg(e))return Ry(1);const t=e.getBoundingClientRect(),{width:r,height:i,$:o}=sNe(e);let s=(o?S$(t.width):t.width)/r,a=(o?S$(t.height):t.height)/i;return(!s||!Number.isFinite(s))&&(s=1),(!a||!Number.isFinite(a))&&(a=1),{x:s,y:a}}const bHt=Ry(0);function aNe(n){const e=jd(n);return!loe()||!e.visualViewport?bHt:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function SHt(n,e,t){return e===void 0&&(e=!1),!t||e&&t!==jd(n)?!1:e}function ZS(n,e,t,r){e===void 0&&(e=!1),t===void 0&&(t=!1);const i=n.getBoundingClientRect(),o=uoe(n);let s=Ry(1);e&&(r?_g(r)&&(s=YC(r)):s=YC(n));const a=SHt(o,t,r)?aNe(o):Ry(0);let c=(i.left+a.x)/s.x,l=(i.top+a.y)/s.y,u=i.width/s.x,d=i.height/s.y;if(o){const h=jd(o),f=r&&_g(r)?jd(r):r;let p=h,g=p.frameElement;for(;g&&r&&f!==p;){const m=YC(g),v=g.getBoundingClientRect(),b=ep(g),S=v.left+(g.clientLeft+parseFloat(b.paddingLeft))*m.x,E=v.top+(g.clientTop+parseFloat(b.paddingTop))*m.y;c*=m.x,l*=m.y,u*=m.x,d*=m.y,c+=S,l+=E,p=jd(g),g=p.frameElement}}return w$({width:u,height:d,x:c,y:l})}function _Ht(n){let{elements:e,rect:t,offsetParent:r,strategy:i}=n;const o=i==="fixed",s=Iv(r),a=e?YN(e.floating):!1;if(r===s||a&&o)return t;let c={scrollLeft:0,scrollTop:0},l=Ry(1);const u=Ry(0),d=wg(r);if((d||!d&&!o)&&((bE(r)!=="body"||UD(s))&&(c=JN(r)),wg(r))){const h=ZS(r);l=YC(r),u.x=h.x+r.clientLeft,u.y=h.y+r.clientTop}return{width:t.width*l.x,height:t.height*l.y,x:t.x*l.x-c.scrollLeft*l.x+u.x,y:t.y*l.y-c.scrollTop*l.y+u.y}}function wHt(n){return Array.from(n.getClientRects())}function cNe(n){return ZS(Iv(n)).left+JN(n).scrollLeft}function CHt(n){const e=Iv(n),t=JN(n),r=n.ownerDocument.body,i=Ed(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),o=Ed(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let s=-t.scrollLeft+cNe(n);const a=-t.scrollTop;return ep(r).direction==="rtl"&&(s+=Ed(e.clientWidth,r.clientWidth)-i),{width:i,height:o,x:s,y:a}}function xHt(n,e){const t=jd(n),r=Iv(n),i=t.visualViewport;let o=r.clientWidth,s=r.clientHeight,a=0,c=0;if(i){o=i.width,s=i.height;const l=loe();(!l||l&&e==="fixed")&&(a=i.offsetLeft,c=i.offsetTop)}return{width:o,height:s,x:a,y:c}}function EHt(n,e){const t=ZS(n,!0,e==="fixed"),r=t.top+n.clientTop,i=t.left+n.clientLeft,o=wg(n)?YC(n):Ry(1),s=n.clientWidth*o.x,a=n.clientHeight*o.y,c=i*o.x,l=r*o.y;return{width:s,height:a,x:c,y:l}}function q1e(n,e,t){let r;if(e==="viewport")r=xHt(n,t);else if(e==="document")r=CHt(Iv(n));else if(_g(e))r=EHt(e,t);else{const i=aNe(n);r={...e,x:e.x-i.x,y:e.y-i.y}}return w$(r)}function lNe(n,e){const t=Oy(n);return t===e||!_g(t)||fx(t)?!1:ep(t).position==="fixed"||lNe(t,e)}function IHt(n,e){const t=e.get(n);if(t)return t;let r=Z3(n,[],!1).filter(a=>_g(a)&&bE(a)!=="body"),i=null;const o=ep(n).position==="fixed";let s=o?Oy(n):n;for(;_g(s)&&!fx(s);){const a=ep(s),c=coe(s);!c&&a.position==="fixed"&&(i=null),(o?!c&&!i:!c&&a.position==="static"&&!!i&&["absolute","fixed"].includes(i.position)||UD(s)&&!c&&lNe(n,s))?r=r.filter(u=>u!==s):i=a,s=Oy(s)}return e.set(n,r),r}function PHt(n){let{element:e,boundary:t,rootBoundary:r,strategy:i}=n;const s=[...t==="clippingAncestors"?YN(e)?[]:IHt(e,this._c):[].concat(t),r],a=s[0],c=s.reduce((l,u)=>{const d=q1e(e,u,i);return l.top=Ed(d.top,l.top),l.right=Yp(d.right,l.right),l.bottom=Yp(d.bottom,l.bottom),l.left=Ed(d.left,l.left),l},q1e(e,a,i));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function kHt(n){const{width:e,height:t}=sNe(n);return{width:e,height:t}}function THt(n,e,t){const r=wg(e),i=Iv(e),o=t==="fixed",s=ZS(n,!0,o,e);let a={scrollLeft:0,scrollTop:0};const c=Ry(0);if(r||!r&&!o)if((bE(e)!=="body"||UD(i))&&(a=JN(e)),r){const d=ZS(e,!0,o,e);c.x=d.x+e.clientLeft,c.y=d.y+e.clientTop}else i&&(c.x=cNe(i));const l=s.left+a.scrollLeft-c.x,u=s.top+a.scrollTop-c.y;return{x:l,y:u,width:s.width,height:s.height}}function sz(n){return ep(n).position==="static"}function K1e(n,e){return!wg(n)||ep(n).position==="fixed"?null:e?e(n):n.offsetParent}function uNe(n,e){const t=jd(n);if(YN(n))return t;if(!wg(n)){let i=Oy(n);for(;i&&!fx(i);){if(_g(i)&&!sz(i))return i;i=Oy(i)}return t}let r=K1e(n,e);for(;r&&vHt(r)&&sz(r);)r=K1e(r,e);return r&&fx(r)&&sz(r)&&!coe(r)?t:r||yHt(n)||t}const DHt=async function(n){const e=this.getOffsetParent||uNe,t=this.getDimensions,r=await t(n.floating);return{reference:THt(n.reference,await e(n.floating),n.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function RHt(n){return ep(n).direction==="rtl"}const AHt={convertOffsetParentRelativeRectToViewportRelativeRect:_Ht,getDocumentElement:Iv,getClippingRect:PHt,getOffsetParent:uNe,getElementRects:DHt,getClientRects:wHt,getDimensions:kHt,getScale:YC,isElement:_g,isRTL:RHt};function OHt(n,e){let t=null,r;const i=Iv(n);function o(){var a;clearTimeout(r),(a=t)==null||a.disconnect(),t=null}function s(a,c){a===void 0&&(a=!1),c===void 0&&(c=1),o();const{left:l,top:u,width:d,height:h}=n.getBoundingClientRect();if(a||e(),!d||!h)return;const f=IA(u),p=IA(i.clientWidth-(l+d)),g=IA(i.clientHeight-(u+h)),m=IA(l),b={rootMargin:-f+"px "+-p+"px "+-g+"px "+-m+"px",threshold:Ed(0,Yp(1,c))||1};let S=!0;function E(w){const C=w[0].intersectionRatio;if(C!==c){if(!S)return s();C?s(!1,C):r=setTimeout(()=>{s(!1,1e-7)},1e3)}S=!1}try{t=new IntersectionObserver(E,{...b,root:i.ownerDocument})}catch{t=new IntersectionObserver(E,b)}t.observe(n)}return s(!0),o}function MHt(n,e,t,r){r===void 0&&(r={});const{ancestorScroll:i=!0,ancestorResize:o=!0,elementResize:s=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:c=!1}=r,l=uoe(n),u=i||o?[...l?Z3(l):[],...Z3(e)]:[];u.forEach(v=>{i&&v.addEventListener("scroll",t,{passive:!0}),o&&v.addEventListener("resize",t)});const d=l&&a?OHt(l,t):null;let h=-1,f=null;s&&(f=new ResizeObserver(v=>{let[b]=v;b&&b.target===l&&f&&(f.unobserve(e),cancelAnimationFrame(h),h=requestAnimationFrame(()=>{var S;(S=f)==null||S.observe(e)})),t()}),l&&!c&&f.observe(l),f.observe(e));let p,g=c?ZS(n):null;c&&m();function m(){const v=ZS(n);g&&(v.x!==g.x||v.y!==g.y||v.width!==g.width||v.height!==g.height)&&t(),g=v,p=requestAnimationFrame(m)}return t(),()=>{var v;u.forEach(b=>{i&&b.removeEventListener("scroll",t),o&&b.removeEventListener("resize",t)}),d==null||d(),(v=f)==null||v.disconnect(),f=null,c&&cancelAnimationFrame(p)}}const $Ht=fHt,LHt=pHt,NHt=uHt,FHt=mHt,jHt=dHt,G1e=lHt,BHt=gHt,HHt=(n,e,t)=>{const r=new Map,i={platform:AHt,...t},o={...i.platform,_c:r};return cHt(n,e,{...i,platform:o})};var tM=typeof document<"u"?y.useLayoutEffect:y.useEffect;function C$(n,e){if(n===e)return!0;if(typeof n!=typeof e)return!1;if(typeof n=="function"&&n.toString()===e.toString())return!0;let t,r,i;if(n&&e&&typeof n=="object"){if(Array.isArray(n)){if(t=n.length,t!==e.length)return!1;for(r=t;r--!==0;)if(!C$(n[r],e[r]))return!1;return!0}if(i=Object.keys(n),t=i.length,t!==Object.keys(e).length)return!1;for(r=t;r--!==0;)if(!{}.hasOwnProperty.call(e,i[r]))return!1;for(r=t;r--!==0;){const o=i[r];if(!(o==="_owner"&&n.$$typeof)&&!C$(n[o],e[o]))return!1}return!0}return n!==n&&e!==e}function dNe(n){return typeof window>"u"?1:(n.ownerDocument.defaultView||window).devicePixelRatio||1}function Z1e(n,e){const t=dNe(n);return Math.round(e*t)/t}function X1e(n){const e=y.useRef(n);return tM(()=>{e.current=n}),e}function UHt(n){n===void 0&&(n={});const{placement:e="bottom",strategy:t="absolute",middleware:r=[],platform:i,elements:{reference:o,floating:s}={},transform:a=!0,whileElementsMounted:c,open:l}=n,[u,d]=y.useState({x:0,y:0,strategy:t,placement:e,middlewareData:{},isPositioned:!1}),[h,f]=y.useState(r);C$(h,r)||f(r);const[p,g]=y.useState(null),[m,v]=y.useState(null),b=y.useCallback(N=>{N!==C.current&&(C.current=N,g(N))},[]),S=y.useCallback(N=>{N!==I.current&&(I.current=N,v(N))},[]),E=o||p,w=s||m,C=y.useRef(null),I=y.useRef(null),T=y.useRef(u),D=c!=null,O=X1e(c),M=X1e(i),R=y.useCallback(()=>{if(!C.current||!I.current)return;const N={placement:e,strategy:t,middleware:h};M.current&&(N.platform=M.current),HHt(C.current,I.current,N).then(B=>{const U={...B,isPositioned:!0};A.current&&!C$(T.current,U)&&(T.current=U,Wu.flushSync(()=>{d(U)}))})},[h,e,t,M]);tM(()=>{l===!1&&T.current.isPositioned&&(T.current.isPositioned=!1,d(N=>({...N,isPositioned:!1})))},[l]);const A=y.useRef(!1);tM(()=>(A.current=!0,()=>{A.current=!1}),[]),tM(()=>{if(E&&(C.current=E),w&&(I.current=w),E&&w){if(O.current)return O.current(E,w,R);R()}},[E,w,R,O,D]);const k=y.useMemo(()=>({reference:C,floating:I,setReference:b,setFloating:S}),[b,S]),L=y.useMemo(()=>({reference:E,floating:w}),[E,w]),j=y.useMemo(()=>{const N={position:t,left:0,top:0};if(!L.floating)return N;const B=Z1e(L.floating,u.x),U=Z1e(L.floating,u.y);return a?{...N,transform:"translate("+B+"px, "+U+"px)",...dNe(L.floating)>=1.5&&{willChange:"transform"}}:{position:t,left:B,top:U}},[t,a,L.floating,u.x,u.y]);return y.useMemo(()=>({...u,update:R,refs:k,elements:L,floatingStyles:j}),[u,R,k,L,j])}const zHt=n=>{function e(t){return{}.hasOwnProperty.call(t,"current")}return{name:"arrow",options:n,fn(t){const{element:r,padding:i}=typeof n=="function"?n(t):n;return r&&e(r)?r.current!=null?G1e({element:r.current,padding:i}).fn(t):{}:r?G1e({element:r,padding:i}).fn(t):{}}}},VHt=(n,e)=>({...$Ht(n),options:[n,e]}),WHt=(n,e)=>({...LHt(n),options:[n,e]}),qHt=(n,e)=>({...BHt(n),options:[n,e]}),KHt=(n,e)=>({...NHt(n),options:[n,e]}),GHt=(n,e)=>({...FHt(n),options:[n,e]}),ZHt=(n,e)=>({...jHt(n),options:[n,e]}),XHt=(n,e)=>({...zHt(n),options:[n,e]});var YHt="Arrow",hNe=y.forwardRef((n,e)=>{const{children:t,width:r=10,height:i=5,...o}=n;return x.jsx(Pi.svg,{...o,ref:e,width:r,height:i,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:n.asChild?t:x.jsx("polygon",{points:"0,0 30,0 15,10"})})});hNe.displayName=YHt;var JHt=hNe;function fNe(n){const[e,t]=y.useState(void 0);return Ty(()=>{if(n){t({width:n.offsetWidth,height:n.offsetHeight});const r=new ResizeObserver(i=>{if(!Array.isArray(i)||!i.length)return;const o=i[0];let s,a;if("borderBoxSize"in o){const c=o.borderBoxSize,l=Array.isArray(c)?c[0]:c;s=l.inlineSize,a=l.blockSize}else s=n.offsetWidth,a=n.offsetHeight;t({width:s,height:a})});return r.observe(n,{box:"border-box"}),()=>r.unobserve(n)}else t(void 0)},[n]),e}var doe="Popper",[pNe,QN]=Lg(doe),[QHt,gNe]=pNe(doe),mNe=n=>{const{__scopePopper:e,children:t}=n,[r,i]=y.useState(null);return x.jsx(QHt,{scope:e,anchor:r,onAnchorChange:i,children:t})};mNe.displayName=doe;var vNe="PopperAnchor",yNe=y.forwardRef((n,e)=>{const{__scopePopper:t,virtualRef:r,...i}=n,o=gNe(vNe,t),s=y.useRef(null),a=Vo(e,s);return y.useEffect(()=>{o.onAnchorChange((r==null?void 0:r.current)||s.current)}),r?null:x.jsx(Pi.div,{...i,ref:a})});yNe.displayName=vNe;var hoe="PopperContent",[eUt,tUt]=pNe(hoe),bNe=y.forwardRef((n,e)=>{var _e,Se,se,ee,Y,ue;const{__scopePopper:t,side:r="bottom",sideOffset:i=0,align:o="center",alignOffset:s=0,arrowPadding:a=0,avoidCollisions:c=!0,collisionBoundary:l=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:h=!1,updatePositionStrategy:f="optimized",onPlaced:p,...g}=n,m=gNe(hoe,t),[v,b]=y.useState(null),S=Vo(e,ye=>b(ye)),[E,w]=y.useState(null),C=fNe(E),I=(C==null?void 0:C.width)??0,T=(C==null?void 0:C.height)??0,D=r+(o!=="center"?"-"+o:""),O=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},M=Array.isArray(l)?l:[l],R=M.length>0,A={padding:O,boundary:M.filter(rUt),altBoundary:R},{refs:k,floatingStyles:L,placement:j,isPositioned:N,middlewareData:B}=UHt({strategy:"fixed",placement:D,whileElementsMounted:(...ye)=>MHt(...ye,{animationFrame:f==="always"}),elements:{reference:m.anchor},middleware:[VHt({mainAxis:i+T,alignmentAxis:s}),c&&WHt({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?qHt():void 0,...A}),c&&KHt({...A}),GHt({...A,apply:({elements:ye,rects:V,availableWidth:le,availableHeight:he})=>{const{width:oe,height:ne}=V.reference,ce=ye.floating.style;ce.setProperty("--radix-popper-available-width",`${le}px`),ce.setProperty("--radix-popper-available-height",`${he}px`),ce.setProperty("--radix-popper-anchor-width",`${oe}px`),ce.setProperty("--radix-popper-anchor-height",`${ne}px`)}}),E&&XHt({element:E,padding:a}),iUt({arrowWidth:I,arrowHeight:T}),h&&ZHt({strategy:"referenceHidden",...A})]}),[U,K]=wNe(j),z=Zc(p);Ty(()=>{N&&(z==null||z())},[N,z]);const G=(_e=B.arrow)==null?void 0:_e.x,te=(Se=B.arrow)==null?void 0:Se.y,ie=((se=B.arrow)==null?void 0:se.centerOffset)!==0,[Q,ge]=y.useState();return Ty(()=>{v&&ge(window.getComputedStyle(v).zIndex)},[v]),x.jsx("div",{ref:k.setFloating,"data-radix-popper-content-wrapper":"",style:{...L,transform:N?L.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:Q,"--radix-popper-transform-origin":[(ee=B.transformOrigin)==null?void 0:ee.x,(Y=B.transformOrigin)==null?void 0:Y.y].join(" "),...((ue=B.hide)==null?void 0:ue.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:n.dir,children:x.jsx(eUt,{scope:t,placedSide:U,onArrowChange:w,arrowX:G,arrowY:te,shouldHideArrow:ie,children:x.jsx(Pi.div,{"data-side":U,"data-align":K,...g,ref:S,style:{...g.style,animation:N?void 0:"none"}})})})});bNe.displayName=hoe;var SNe="PopperArrow",nUt={top:"bottom",right:"left",bottom:"top",left:"right"},_Ne=y.forwardRef(function(e,t){const{__scopePopper:r,...i}=e,o=tUt(SNe,r),s=nUt[o.placedSide];return x.jsx("span",{ref:o.onArrowChange,style:{position:"absolute",left:o.arrowX,top:o.arrowY,[s]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[o.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[o.placedSide],visibility:o.shouldHideArrow?"hidden":void 0},children:x.jsx(JHt,{...i,ref:t,style:{...i.style,display:"block"}})})});_Ne.displayName=SNe;function rUt(n){return n!==null}var iUt=n=>({name:"transformOrigin",options:n,fn(e){var m,v,b;const{placement:t,rects:r,middlewareData:i}=e,s=((m=i.arrow)==null?void 0:m.centerOffset)!==0,a=s?0:n.arrowWidth,c=s?0:n.arrowHeight,[l,u]=wNe(t),d={start:"0%",center:"50%",end:"100%"}[u],h=(((v=i.arrow)==null?void 0:v.x)??0)+a/2,f=(((b=i.arrow)==null?void 0:b.y)??0)+c/2;let p="",g="";return l==="bottom"?(p=s?d:`${h}px`,g=`${-c}px`):l==="top"?(p=s?d:`${h}px`,g=`${r.floating.height+c}px`):l==="right"?(p=`${-c}px`,g=s?d:`${f}px`):l==="left"&&(p=`${r.floating.width+c}px`,g=s?d:`${f}px`),{data:{x:p,y:g}}}});function wNe(n){const[e,t="center"]=n.split("-");return[e,t]}var foe=mNe,poe=yNe,CNe=bNe,xNe=_Ne,goe="Popover",[ENe,Uln]=Lg(goe,[QN]),zD=QN(),[oUt,Jy]=ENe(goe),INe=n=>{const{__scopePopover:e,children:t,open:r,defaultOpen:i,onOpenChange:o,modal:s=!1}=n,a=zD(e),c=y.useRef(null),[l,u]=y.useState(!1),[d=!1,h]=Yy({prop:r,defaultProp:i,onChange:o});return x.jsx(foe,{...a,children:x.jsx(oUt,{scope:e,contentId:Ym(),triggerRef:c,open:d,onOpenChange:h,onOpenToggle:y.useCallback(()=>h(f=>!f),[h]),hasCustomAnchor:l,onCustomAnchorAdd:y.useCallback(()=>u(!0),[]),onCustomAnchorRemove:y.useCallback(()=>u(!1),[]),modal:s,children:t})})};INe.displayName=goe;var PNe="PopoverAnchor",sUt=y.forwardRef((n,e)=>{const{__scopePopover:t,...r}=n,i=Jy(PNe,t),o=zD(t),{onCustomAnchorAdd:s,onCustomAnchorRemove:a}=i;return y.useEffect(()=>(s(),()=>a()),[s,a]),x.jsx(poe,{...o,...r,ref:e})});sUt.displayName=PNe;var kNe="PopoverTrigger",TNe=y.forwardRef((n,e)=>{const{__scopePopover:t,...r}=n,i=Jy(kNe,t),o=zD(t),s=Vo(e,i.triggerRef),a=x.jsx(Pi.button,{type:"button","aria-haspopup":"dialog","aria-expanded":i.open,"aria-controls":i.contentId,"data-state":MNe(i.open),...r,ref:s,onClick:Dn(n.onClick,i.onOpenToggle)});return i.hasCustomAnchor?a:x.jsx(poe,{asChild:!0,...o,children:a})});TNe.displayName=kNe;var moe="PopoverPortal",[aUt,cUt]=ENe(moe,{forceMount:void 0}),DNe=n=>{const{__scopePopover:e,forceMount:t,children:r,container:i}=n,o=Jy(moe,e);return x.jsx(aUt,{scope:e,forceMount:t,children:x.jsx(ap,{present:t||o.open,children:x.jsx(BD,{asChild:!0,container:i,children:r})})})};DNe.displayName=moe;var px="PopoverContent",RNe=y.forwardRef((n,e)=>{const t=cUt(px,n.__scopePopover),{forceMount:r=t.forceMount,...i}=n,o=Jy(px,n.__scopePopover);return x.jsx(ap,{present:r||o.open,children:o.modal?x.jsx(lUt,{...i,ref:e}):x.jsx(uUt,{...i,ref:e})})});RNe.displayName=px;var lUt=y.forwardRef((n,e)=>{const t=Jy(px,n.__scopePopover),r=y.useRef(null),i=Vo(e,r),o=y.useRef(!1);return y.useEffect(()=>{const s=r.current;if(s)return qie(s)},[]),x.jsx(VN,{as:KS,allowPinchZoom:!0,children:x.jsx(ANe,{...n,ref:i,trapFocus:t.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Dn(n.onCloseAutoFocus,s=>{var a;s.preventDefault(),o.current||(a=t.triggerRef.current)==null||a.focus()}),onPointerDownOutside:Dn(n.onPointerDownOutside,s=>{const a=s.detail.originalEvent,c=a.button===0&&a.ctrlKey===!0,l=a.button===2||c;o.current=l},{checkForDefaultPrevented:!1}),onFocusOutside:Dn(n.onFocusOutside,s=>s.preventDefault(),{checkForDefaultPrevented:!1})})})}),uUt=y.forwardRef((n,e)=>{const t=Jy(px,n.__scopePopover),r=y.useRef(!1),i=y.useRef(!1);return x.jsx(ANe,{...n,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{var s,a;(s=n.onCloseAutoFocus)==null||s.call(n,o),o.defaultPrevented||(r.current||(a=t.triggerRef.current)==null||a.focus(),o.preventDefault()),r.current=!1,i.current=!1},onInteractOutside:o=>{var c,l;(c=n.onInteractOutside)==null||c.call(n,o),o.defaultPrevented||(r.current=!0,o.detail.originalEvent.type==="pointerdown"&&(i.current=!0));const s=o.target;((l=t.triggerRef.current)==null?void 0:l.contains(s))&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&i.current&&o.preventDefault()}})}),ANe=y.forwardRef((n,e)=>{const{__scopePopover:t,trapFocus:r,onOpenAutoFocus:i,onCloseAutoFocus:o,disableOutsidePointerEvents:s,onEscapeKeyDown:a,onPointerDownOutside:c,onFocusOutside:l,onInteractOutside:u,...d}=n,h=Jy(px,t),f=zD(t);return Wie(),x.jsx(UN,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:i,onUnmountAutoFocus:o,children:x.jsx(jD,{asChild:!0,disableOutsidePointerEvents:s,onInteractOutside:u,onEscapeKeyDown:a,onPointerDownOutside:c,onFocusOutside:l,onDismiss:()=>h.onOpenChange(!1),children:x.jsx(CNe,{"data-state":MNe(h.open),role:"dialog",id:h.contentId,...f,...d,ref:e,style:{...d.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),ONe="PopoverClose",dUt=y.forwardRef((n,e)=>{const{__scopePopover:t,...r}=n,i=Jy(ONe,t);return x.jsx(Pi.button,{type:"button",...r,ref:e,onClick:Dn(n.onClick,()=>i.onOpenChange(!1))})});dUt.displayName=ONe;var hUt="PopoverArrow",fUt=y.forwardRef((n,e)=>{const{__scopePopover:t,...r}=n,i=zD(t);return x.jsx(xNe,{...i,...r,ref:e})});fUt.displayName=hUt;function MNe(n){return n?"open":"closed"}var pUt=INe,gUt=TNe,mUt=DNe,vUt=RNe;function Qy(n,e){const t=ot(),r=y.useRef(!1),i=lp(),o=y.useCallback(a=>{r.current=a,t.batch(()=>{a?(t.complete(),t.addOpenMenu(n)):t.updateInstanceState({openMenus:t.getOpenMenus().filter(c=>!c.startsWith(n))}),e==null||e(a)})},[t,n,e]),s=_t("is menu open",()=>t.getOpenMenus().includes(n),[t,n]);return y.useEffect(()=>(r.current&&(i("open-menu",{source:"unknown",id:n}),t.addOpenMenu(n)),()=>{r.current&&(t.deleteOpenMenu(n),t.getOpenMenus().forEach(a=>{a.startsWith(n)&&(i("close-menu",{source:"unknown",id:n}),t.deleteOpenMenu(a))}),r.current=!1)}),[t,n,i]),[s,o]}function voe({id:n,children:e,onOpenChange:t,open:r}){const[i,o]=Qy(n,t);return x.jsx(pUt,{onOpenChange:o,open:r||i,children:x.jsx("div",{className:"tlui-popover",children:e})})}function yoe({children:n}){return x.jsx(gUt,{asChild:!0,dir:"ltr",children:n})}function boe({side:n,children:e,align:t="center",sideOffset:r=8,alignOffset:i=0}){const o=Il();return x.jsx(mUt,{container:o,children:x.jsx(vUt,{className:"tlui-popover__content",side:n,sideOffset:r,align:t,alignOffset:i,dir:"ltr",children:e})})}const $Ne=y.createContext(null);function eF(){const n=y.useContext($Ne);if(!n)throw new Error("useTldrawUiMenuContext must be used within a TldrawUiMenuContextProvider");return n}function zh({type:n,sourceId:e,children:t}){return x.jsx($Ne.Provider,{value:{type:n,sourceId:e},children:t})}function yUt(n){return n.getSelectedShapeIds().map(r=>n.getShape(r)).filter(r=>{if(!r)return!1;if(n.isShapeOfType(r,"arrow")){const i=Mu(n,r);if(i.start||i.end)return!1}return!0})}const LNe=()=>{const n=ot();return _t("threeStackableItems",()=>yUt(n).length>2,[n])},Pv=()=>{const n=ot();return _t("isInSelectState",()=>n.isIn("select"),[n])},NNe=()=>{const n=ot();return _t("allow group",()=>{const e=n.getSelectedShapes();if(e.length<2)return!1;for(const t of e)if(n.isShapeOfType(t,"arrow")){const r=Mu(n,t);if(r.start&&!e.some(i=>i.id===r.start.toId)||r.end&&!e.some(i=>i.id===r.end.toId))return!1}return!0},[n])},FNe=()=>{const n=ot();return _t("allowUngroup",()=>n.getSelectedShapeIds().some(e=>{var t;return((t=n.getShape(e))==null?void 0:t.type)==="group"}),[n])},bUt=typeof window<"u"&&"navigator"in window&&!!navigator.clipboard&&!!navigator.clipboard.read;function SUt(n,e){const t=ot();return _t("selectedShapes",()=>t.getSelectedShapes().length>=n,[t,n,e])}function cu(n,e){const t=ot();return _t("selectedShapes",()=>{const r=t.getSelectedShapes().filter(i=>!t.isShapeOrAncestorLocked(i)).length;return n===void 0?r:r>=n},[t])}function _Ut(){const n=ot();return _t("showAutoSizeToggle",()=>{const e=n.getSelectedShapes();return e.length===1&&n.isShapeOfType(e[0],"text")&&e[0].props.autoSize===!1},[n])}function jNe(){const n=ot();return _t("hasLinkShapeSelected",()=>{const e=n.getOnlySelectedShape();return!!(e&&e.type!=="embed"&&"url"in e.props&&!e.isLocked)},[n])}function wUt(){const n=ot();return _t("onlyFlippableShape",()=>{const e=n.getOnlySelectedShape();return e&&(n.isShapeOfType(e,"group")||n.isShapeOfType(e,"arrow")||n.isShapeOfType(e,"line")||n.isShapeOfType(e,"draw"))},[n])}function BNe(){const n=ot();return _t("useCanRedo",()=>n.getCanRedo(),[n])}function HNe(){const n=ot();return _t("useCanUndo",()=>n.getCanUndo(),[n])}var CUt=y.createContext(void 0);function Soe(n){const e=y.useContext(CUt);return n||e||"ltr"}var az="rovingFocusGroup.onEntryFocus",xUt={bubbles:!1,cancelable:!0},tF="RovingFocusGroup",[OX,UNe,EUt]=WN(tF),[IUt,zNe]=Lg(tF,[EUt]),[PUt,kUt]=IUt(tF),VNe=y.forwardRef((n,e)=>x.jsx(OX.Provider,{scope:n.__scopeRovingFocusGroup,children:x.jsx(OX.Slot,{scope:n.__scopeRovingFocusGroup,children:x.jsx(TUt,{...n,ref:e})})}));VNe.displayName=tF;var TUt=y.forwardRef((n,e)=>{const{__scopeRovingFocusGroup:t,orientation:r,loop:i=!1,dir:o,currentTabStopId:s,defaultCurrentTabStopId:a,onCurrentTabStopIdChange:c,onEntryFocus:l,preventScrollOnEntryFocus:u=!1,...d}=n,h=y.useRef(null),f=Vo(e,h),p=Soe(o),[g=null,m]=Yy({prop:s,defaultProp:a,onChange:c}),[v,b]=y.useState(!1),S=Zc(l),E=UNe(t),w=y.useRef(!1),[C,I]=y.useState(0);return y.useEffect(()=>{const T=h.current;if(T)return T.addEventListener(az,S),()=>T.removeEventListener(az,S)},[S]),x.jsx(PUt,{scope:t,orientation:r,dir:p,loop:i,currentTabStopId:g,onItemFocus:y.useCallback(T=>m(T),[m]),onItemShiftTab:y.useCallback(()=>b(!0),[]),onFocusableItemAdd:y.useCallback(()=>I(T=>T+1),[]),onFocusableItemRemove:y.useCallback(()=>I(T=>T-1),[]),children:x.jsx(Pi.div,{tabIndex:v||C===0?-1:0,"data-orientation":r,...d,ref:f,style:{outline:"none",...n.style},onMouseDown:Dn(n.onMouseDown,()=>{w.current=!0}),onFocus:Dn(n.onFocus,T=>{const D=!w.current;if(T.target===T.currentTarget&&D&&!v){const O=new CustomEvent(az,xUt);if(T.currentTarget.dispatchEvent(O),!O.defaultPrevented){const M=E().filter(j=>j.focusable),R=M.find(j=>j.active),A=M.find(j=>j.id===g),L=[R,A,...M].filter(Boolean).map(j=>j.ref.current);KNe(L,u)}}w.current=!1}),onBlur:Dn(n.onBlur,()=>b(!1))})})}),WNe="RovingFocusGroupItem",qNe=y.forwardRef((n,e)=>{const{__scopeRovingFocusGroup:t,focusable:r=!0,active:i=!1,tabStopId:o,...s}=n,a=Ym(),c=o||a,l=kUt(WNe,t),u=l.currentTabStopId===c,d=UNe(t),{onFocusableItemAdd:h,onFocusableItemRemove:f}=l;return y.useEffect(()=>{if(r)return h(),()=>f()},[r,h,f]),x.jsx(OX.ItemSlot,{scope:t,id:c,focusable:r,active:i,children:x.jsx(Pi.span,{tabIndex:u?0:-1,"data-orientation":l.orientation,...s,ref:e,onMouseDown:Dn(n.onMouseDown,p=>{r?l.onItemFocus(c):p.preventDefault()}),onFocus:Dn(n.onFocus,()=>l.onItemFocus(c)),onKeyDown:Dn(n.onKeyDown,p=>{if(p.key==="Tab"&&p.shiftKey){l.onItemShiftTab();return}if(p.target!==p.currentTarget)return;const g=AUt(p,l.orientation,l.dir);if(g!==void 0){if(p.metaKey||p.ctrlKey||p.altKey||p.shiftKey)return;p.preventDefault();let v=d().filter(b=>b.focusable).map(b=>b.ref.current);if(g==="last")v.reverse();else if(g==="prev"||g==="next"){g==="prev"&&v.reverse();const b=v.indexOf(p.currentTarget);v=l.loop?OUt(v,b+1):v.slice(b+1)}setTimeout(()=>KNe(v))}})})})});qNe.displayName=WNe;var DUt={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function RUt(n,e){return e!=="rtl"?n:n==="ArrowLeft"?"ArrowRight":n==="ArrowRight"?"ArrowLeft":n}function AUt(n,e,t){const r=RUt(n.key,t);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return DUt[r]}function KNe(n,e=!1){const t=document.activeElement;for(const r of n)if(r===t||(r.focus({preventScroll:e}),document.activeElement!==t))return}function OUt(n,e){return n.map((t,r)=>n[(e+r)%n.length])}var MUt=VNe,$Ut=qNe,MX=["Enter"," "],LUt=["ArrowDown","PageUp","Home"],GNe=["ArrowUp","PageDown","End"],NUt=[...LUt,...GNe],FUt={ltr:[...MX,"ArrowRight"],rtl:[...MX,"ArrowLeft"]},jUt={ltr:["ArrowLeft"],rtl:["ArrowRight"]},VD="Menu",[X3,BUt,HUt]=WN(VD),[m_,nF]=Lg(VD,[HUt,QN,zNe]),WD=QN(),ZNe=zNe(),[XNe,eb]=m_(VD),[UUt,qD]=m_(VD),YNe=n=>{const{__scopeMenu:e,open:t=!1,children:r,dir:i,onOpenChange:o,modal:s=!0}=n,a=WD(e),[c,l]=y.useState(null),u=y.useRef(!1),d=Zc(o),h=Soe(i);return y.useEffect(()=>{const f=()=>{u.current=!0,document.addEventListener("pointerdown",p,{capture:!0,once:!0}),document.addEventListener("pointermove",p,{capture:!0,once:!0})},p=()=>u.current=!1;return document.addEventListener("keydown",f,{capture:!0}),()=>{document.removeEventListener("keydown",f,{capture:!0}),document.removeEventListener("pointerdown",p,{capture:!0}),document.removeEventListener("pointermove",p,{capture:!0})}},[]),x.jsx(foe,{...a,children:x.jsx(XNe,{scope:e,open:t,onOpenChange:d,content:c,onContentChange:l,children:x.jsx(UUt,{scope:e,onClose:y.useCallback(()=>d(!1),[d]),isUsingKeyboardRef:u,dir:h,modal:s,children:r})})})};YNe.displayName=VD;var zUt="MenuAnchor",_oe=y.forwardRef((n,e)=>{const{__scopeMenu:t,...r}=n,i=WD(t);return x.jsx(poe,{...i,...r,ref:e})});_oe.displayName=zUt;var woe="MenuPortal",[VUt,JNe]=m_(woe,{forceMount:void 0}),QNe=n=>{const{__scopeMenu:e,forceMount:t,children:r,container:i}=n,o=eb(woe,e);return x.jsx(VUt,{scope:e,forceMount:t,children:x.jsx(ap,{present:t||o.open,children:x.jsx(BD,{asChild:!0,container:i,children:r})})})};QNe.displayName=woe;var Fh="MenuContent",[WUt,Coe]=m_(Fh),eFe=y.forwardRef((n,e)=>{const t=JNe(Fh,n.__scopeMenu),{forceMount:r=t.forceMount,...i}=n,o=eb(Fh,n.__scopeMenu),s=qD(Fh,n.__scopeMenu);return x.jsx(X3.Provider,{scope:n.__scopeMenu,children:x.jsx(ap,{present:r||o.open,children:x.jsx(X3.Slot,{scope:n.__scopeMenu,children:s.modal?x.jsx(qUt,{...i,ref:e}):x.jsx(KUt,{...i,ref:e})})})})}),qUt=y.forwardRef((n,e)=>{const t=eb(Fh,n.__scopeMenu),r=y.useRef(null),i=Vo(e,r);return y.useEffect(()=>{const o=r.current;if(o)return qie(o)},[]),x.jsx(xoe,{...n,ref:i,trapFocus:t.open,disableOutsidePointerEvents:t.open,disableOutsideScroll:!0,onFocusOutside:Dn(n.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>t.onOpenChange(!1)})}),KUt=y.forwardRef((n,e)=>{const t=eb(Fh,n.__scopeMenu);return x.jsx(xoe,{...n,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>t.onOpenChange(!1)})}),xoe=y.forwardRef((n,e)=>{const{__scopeMenu:t,loop:r=!1,trapFocus:i,onOpenAutoFocus:o,onCloseAutoFocus:s,disableOutsidePointerEvents:a,onEntryFocus:c,onEscapeKeyDown:l,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:h,onDismiss:f,disableOutsideScroll:p,...g}=n,m=eb(Fh,t),v=qD(Fh,t),b=WD(t),S=ZNe(t),E=BUt(t),[w,C]=y.useState(null),I=y.useRef(null),T=Vo(e,I,m.onContentChange),D=y.useRef(0),O=y.useRef(""),M=y.useRef(0),R=y.useRef(null),A=y.useRef("right"),k=y.useRef(0),L=p?VN:y.Fragment,j=p?{as:KS,allowPinchZoom:!0}:void 0,N=U=>{var _e,Se;const K=O.current+U,z=E().filter(se=>!se.disabled),G=document.activeElement,te=(_e=z.find(se=>se.ref.current===G))==null?void 0:_e.textValue,ie=z.map(se=>se.textValue),Q=ozt(ie,K,te),ge=(Se=z.find(se=>se.textValue===Q))==null?void 0:Se.ref.current;(function se(ee){O.current=ee,window.clearTimeout(D.current),ee!==""&&(D.current=window.setTimeout(()=>se(""),1e3))})(K),ge&&setTimeout(()=>ge.focus())};y.useEffect(()=>()=>window.clearTimeout(D.current),[]),Wie();const B=y.useCallback(U=>{var z,G;return A.current===((z=R.current)==null?void 0:z.side)&&azt(U,(G=R.current)==null?void 0:G.area)},[]);return x.jsx(WUt,{scope:t,searchRef:O,onItemEnter:y.useCallback(U=>{B(U)&&U.preventDefault()},[B]),onItemLeave:y.useCallback(U=>{var K;B(U)||((K=I.current)==null||K.focus(),C(null))},[B]),onTriggerLeave:y.useCallback(U=>{B(U)&&U.preventDefault()},[B]),pointerGraceTimerRef:M,onPointerGraceIntentChange:y.useCallback(U=>{R.current=U},[]),children:x.jsx(L,{...j,children:x.jsx(UN,{asChild:!0,trapped:i,onMountAutoFocus:Dn(o,U=>{var K;U.preventDefault(),(K=I.current)==null||K.focus({preventScroll:!0})}),onUnmountAutoFocus:s,children:x.jsx(jD,{asChild:!0,disableOutsidePointerEvents:a,onEscapeKeyDown:l,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:h,onDismiss:f,children:x.jsx(MUt,{asChild:!0,...S,dir:v.dir,orientation:"vertical",loop:r,currentTabStopId:w,onCurrentTabStopIdChange:C,onEntryFocus:Dn(c,U=>{v.isUsingKeyboardRef.current||U.preventDefault()}),preventScrollOnEntryFocus:!0,children:x.jsx(CNe,{role:"menu","aria-orientation":"vertical","data-state":vFe(m.open),"data-radix-menu-content":"",dir:v.dir,...b,...g,ref:T,style:{outline:"none",...g.style},onKeyDown:Dn(g.onKeyDown,U=>{const z=U.target.closest("[data-radix-menu-content]")===U.currentTarget,G=U.ctrlKey||U.altKey||U.metaKey,te=U.key.length===1;z&&(U.key==="Tab"&&U.preventDefault(),!G&&te&&N(U.key));const ie=I.current;if(U.target!==ie||!NUt.includes(U.key))return;U.preventDefault();const ge=E().filter(_e=>!_e.disabled).map(_e=>_e.ref.current);GNe.includes(U.key)&&ge.reverse(),rzt(ge)}),onBlur:Dn(n.onBlur,U=>{U.currentTarget.contains(U.target)||(window.clearTimeout(D.current),O.current="")}),onPointerMove:Dn(n.onPointerMove,Y3(U=>{const K=U.target,z=k.current!==U.clientX;if(U.currentTarget.contains(K)&&z){const G=U.clientX>k.current?"right":"left";A.current=G,k.current=U.clientX}}))})})})})})})});eFe.displayName=Fh;var GUt="MenuGroup",Eoe=y.forwardRef((n,e)=>{const{__scopeMenu:t,...r}=n;return x.jsx(Pi.div,{role:"group",...r,ref:e})});Eoe.displayName=GUt;var ZUt="MenuLabel",tFe=y.forwardRef((n,e)=>{const{__scopeMenu:t,...r}=n;return x.jsx(Pi.div,{...r,ref:e})});tFe.displayName=ZUt;var x$="MenuItem",Y1e="menu.itemSelect",rF=y.forwardRef((n,e)=>{const{disabled:t=!1,onSelect:r,...i}=n,o=y.useRef(null),s=qD(x$,n.__scopeMenu),a=Coe(x$,n.__scopeMenu),c=Vo(e,o),l=y.useRef(!1),u=()=>{const d=o.current;if(!t&&d){const h=new CustomEvent(Y1e,{bubbles:!0,cancelable:!0});d.addEventListener(Y1e,f=>r==null?void 0:r(f),{once:!0}),Vie(d,h),h.defaultPrevented?l.current=!1:s.onClose()}};return x.jsx(nFe,{...i,ref:c,disabled:t,onClick:Dn(n.onClick,u),onPointerDown:d=>{var h;(h=n.onPointerDown)==null||h.call(n,d),l.current=!0},onPointerUp:Dn(n.onPointerUp,d=>{var h;l.current||(h=d.currentTarget)==null||h.click()}),onKeyDown:Dn(n.onKeyDown,d=>{const h=a.searchRef.current!=="";t||h&&d.key===" "||MX.includes(d.key)&&(d.currentTarget.click(),d.preventDefault())})})});rF.displayName=x$;var nFe=y.forwardRef((n,e)=>{const{__scopeMenu:t,disabled:r=!1,textValue:i,...o}=n,s=Coe(x$,t),a=ZNe(t),c=y.useRef(null),l=Vo(e,c),[u,d]=y.useState(!1),[h,f]=y.useState("");return y.useEffect(()=>{const p=c.current;p&&f((p.textContent??"").trim())},[o.children]),x.jsx(X3.ItemSlot,{scope:t,disabled:r,textValue:i??h,children:x.jsx($Ut,{asChild:!0,...a,focusable:!r,children:x.jsx(Pi.div,{role:"menuitem","data-highlighted":u?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...o,ref:l,onPointerMove:Dn(n.onPointerMove,Y3(p=>{r?s.onItemLeave(p):(s.onItemEnter(p),p.defaultPrevented||p.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:Dn(n.onPointerLeave,Y3(p=>s.onItemLeave(p))),onFocus:Dn(n.onFocus,()=>d(!0)),onBlur:Dn(n.onBlur,()=>d(!1))})})})}),XUt="MenuCheckboxItem",rFe=y.forwardRef((n,e)=>{const{checked:t=!1,onCheckedChange:r,...i}=n;return x.jsx(cFe,{scope:n.__scopeMenu,checked:t,children:x.jsx(rF,{role:"menuitemcheckbox","aria-checked":E$(t)?"mixed":t,...i,ref:e,"data-state":koe(t),onSelect:Dn(i.onSelect,()=>r==null?void 0:r(E$(t)?!0:!t),{checkForDefaultPrevented:!1})})})});rFe.displayName=XUt;var iFe="MenuRadioGroup",[YUt,JUt]=m_(iFe,{value:void 0,onValueChange:()=>{}}),oFe=y.forwardRef((n,e)=>{const{value:t,onValueChange:r,...i}=n,o=Zc(r);return x.jsx(YUt,{scope:n.__scopeMenu,value:t,onValueChange:o,children:x.jsx(Eoe,{...i,ref:e})})});oFe.displayName=iFe;var sFe="MenuRadioItem",aFe=y.forwardRef((n,e)=>{const{value:t,...r}=n,i=JUt(sFe,n.__scopeMenu),o=t===i.value;return x.jsx(cFe,{scope:n.__scopeMenu,checked:o,children:x.jsx(rF,{role:"menuitemradio","aria-checked":o,...r,ref:e,"data-state":koe(o),onSelect:Dn(r.onSelect,()=>{var s;return(s=i.onValueChange)==null?void 0:s.call(i,t)},{checkForDefaultPrevented:!1})})})});aFe.displayName=sFe;var Ioe="MenuItemIndicator",[cFe,QUt]=m_(Ioe,{checked:!1}),lFe=y.forwardRef((n,e)=>{const{__scopeMenu:t,forceMount:r,...i}=n,o=QUt(Ioe,t);return x.jsx(ap,{present:r||E$(o.checked)||o.checked===!0,children:x.jsx(Pi.span,{...i,ref:e,"data-state":koe(o.checked)})})});lFe.displayName=Ioe;var ezt="MenuSeparator",uFe=y.forwardRef((n,e)=>{const{__scopeMenu:t,...r}=n;return x.jsx(Pi.div,{role:"separator","aria-orientation":"horizontal",...r,ref:e})});uFe.displayName=ezt;var tzt="MenuArrow",dFe=y.forwardRef((n,e)=>{const{__scopeMenu:t,...r}=n,i=WD(t);return x.jsx(xNe,{...i,...r,ref:e})});dFe.displayName=tzt;var Poe="MenuSub",[nzt,hFe]=m_(Poe),fFe=n=>{const{__scopeMenu:e,children:t,open:r=!1,onOpenChange:i}=n,o=eb(Poe,e),s=WD(e),[a,c]=y.useState(null),[l,u]=y.useState(null),d=Zc(i);return y.useEffect(()=>(o.open===!1&&d(!1),()=>d(!1)),[o.open,d]),x.jsx(foe,{...s,children:x.jsx(XNe,{scope:e,open:r,onOpenChange:d,content:l,onContentChange:u,children:x.jsx(nzt,{scope:e,contentId:Ym(),triggerId:Ym(),trigger:a,onTriggerChange:c,children:t})})})};fFe.displayName=Poe;var SP="MenuSubTrigger",pFe=y.forwardRef((n,e)=>{const t=eb(SP,n.__scopeMenu),r=qD(SP,n.__scopeMenu),i=hFe(SP,n.__scopeMenu),o=Coe(SP,n.__scopeMenu),s=y.useRef(null),{pointerGraceTimerRef:a,onPointerGraceIntentChange:c}=o,l={__scopeMenu:n.__scopeMenu},u=y.useCallback(()=>{s.current&&window.clearTimeout(s.current),s.current=null},[]);return y.useEffect(()=>u,[u]),y.useEffect(()=>{const d=a.current;return()=>{window.clearTimeout(d),c(null)}},[a,c]),x.jsx(_oe,{asChild:!0,...l,children:x.jsx(nFe,{id:i.triggerId,"aria-haspopup":"menu","aria-expanded":t.open,"aria-controls":i.contentId,"data-state":vFe(t.open),...n,ref:HN(e,i.onTriggerChange),onClick:d=>{var h;(h=n.onClick)==null||h.call(n,d),!(n.disabled||d.defaultPrevented)&&(d.currentTarget.focus(),t.open||t.onOpenChange(!0))},onPointerMove:Dn(n.onPointerMove,Y3(d=>{o.onItemEnter(d),!d.defaultPrevented&&!n.disabled&&!t.open&&!s.current&&(o.onPointerGraceIntentChange(null),s.current=window.setTimeout(()=>{t.onOpenChange(!0),u()},100))})),onPointerLeave:Dn(n.onPointerLeave,Y3(d=>{var f,p;u();const h=(f=t.content)==null?void 0:f.getBoundingClientRect();if(h){const g=(p=t.content)==null?void 0:p.dataset.side,m=g==="right",v=m?-5:5,b=h[m?"left":"right"],S=h[m?"right":"left"];o.onPointerGraceIntentChange({area:[{x:d.clientX+v,y:d.clientY},{x:b,y:h.top},{x:S,y:h.top},{x:S,y:h.bottom},{x:b,y:h.bottom}],side:g}),window.clearTimeout(a.current),a.current=window.setTimeout(()=>o.onPointerGraceIntentChange(null),300)}else{if(o.onTriggerLeave(d),d.defaultPrevented)return;o.onPointerGraceIntentChange(null)}})),onKeyDown:Dn(n.onKeyDown,d=>{var f;const h=o.searchRef.current!=="";n.disabled||h&&d.key===" "||FUt[r.dir].includes(d.key)&&(t.onOpenChange(!0),(f=t.content)==null||f.focus(),d.preventDefault())})})})});pFe.displayName=SP;var gFe="MenuSubContent",mFe=y.forwardRef((n,e)=>{const t=JNe(Fh,n.__scopeMenu),{forceMount:r=t.forceMount,...i}=n,o=eb(Fh,n.__scopeMenu),s=qD(Fh,n.__scopeMenu),a=hFe(gFe,n.__scopeMenu),c=y.useRef(null),l=Vo(e,c);return x.jsx(X3.Provider,{scope:n.__scopeMenu,children:x.jsx(ap,{present:r||o.open,children:x.jsx(X3.Slot,{scope:n.__scopeMenu,children:x.jsx(xoe,{id:a.contentId,"aria-labelledby":a.triggerId,...i,ref:l,align:"start",side:s.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:u=>{var d;s.isUsingKeyboardRef.current&&((d=c.current)==null||d.focus()),u.preventDefault()},onCloseAutoFocus:u=>u.preventDefault(),onFocusOutside:Dn(n.onFocusOutside,u=>{u.target!==a.trigger&&o.onOpenChange(!1)}),onEscapeKeyDown:Dn(n.onEscapeKeyDown,u=>{s.onClose(),u.preventDefault()}),onKeyDown:Dn(n.onKeyDown,u=>{var f;const d=u.currentTarget.contains(u.target),h=jUt[s.dir].includes(u.key);d&&h&&(o.onOpenChange(!1),(f=a.trigger)==null||f.focus(),u.preventDefault())})})})})})});mFe.displayName=gFe;function vFe(n){return n?"open":"closed"}function E$(n){return n==="indeterminate"}function koe(n){return E$(n)?"indeterminate":n?"checked":"unchecked"}function rzt(n){const e=document.activeElement;for(const t of n)if(t===e||(t.focus(),document.activeElement!==e))return}function izt(n,e){return n.map((t,r)=>n[(e+r)%n.length])}function ozt(n,e,t){const i=e.length>1&&Array.from(e).every(l=>l===e[0])?e[0]:e,o=t?n.indexOf(t):-1;let s=izt(n,Math.max(o,0));i.length===1&&(s=s.filter(l=>l!==t));const c=s.find(l=>l.toLowerCase().startsWith(i.toLowerCase()));return c!==t?c:void 0}function szt(n,e){const{x:t,y:r}=n;let i=!1;for(let o=0,s=e.length-1;o<e.length;s=o++){const a=e[o].x,c=e[o].y,l=e[s].x,u=e[s].y;c>r!=u>r&&t<(l-a)*(r-c)/(u-c)+a&&(i=!i)}return i}function azt(n,e){if(!e)return!1;const t={x:n.clientX,y:n.clientY};return szt(t,e)}function Y3(n){return e=>e.pointerType==="mouse"?n(e):void 0}var yFe=YNe,bFe=_oe,SFe=QNe,_Fe=eFe,wFe=Eoe,CFe=tFe,xFe=rF,EFe=rFe,IFe=oFe,PFe=aFe,kFe=lFe,TFe=uFe,DFe=dFe,RFe=fFe,AFe=pFe,OFe=mFe,Toe="ContextMenu",[czt,zln]=Lg(Toe,[nF]),Pl=nF(),[lzt,MFe]=czt(Toe),$Fe=n=>{const{__scopeContextMenu:e,children:t,onOpenChange:r,dir:i,modal:o=!0}=n,[s,a]=y.useState(!1),c=Pl(e),l=Zc(r),u=y.useCallback(d=>{a(d),l(d)},[l]);return x.jsx(lzt,{scope:e,open:s,onOpenChange:u,modal:o,children:x.jsx(yFe,{...c,dir:i,open:s,onOpenChange:u,modal:o,children:t})})};$Fe.displayName=Toe;var LFe="ContextMenuTrigger",NFe=y.forwardRef((n,e)=>{const{__scopeContextMenu:t,disabled:r=!1,...i}=n,o=MFe(LFe,t),s=Pl(t),a=y.useRef({x:0,y:0}),c=y.useRef({getBoundingClientRect:()=>DOMRect.fromRect({width:0,height:0,...a.current})}),l=y.useRef(0),u=y.useCallback(()=>window.clearTimeout(l.current),[]),d=h=>{a.current={x:h.clientX,y:h.clientY},o.onOpenChange(!0)};return y.useEffect(()=>u,[u]),y.useEffect(()=>void(r&&u()),[r,u]),x.jsxs(x.Fragment,{children:[x.jsx(bFe,{...s,virtualRef:c}),x.jsx(Pi.span,{"data-state":o.open?"open":"closed","data-disabled":r?"":void 0,...i,ref:e,style:{WebkitTouchCallout:"none",...n.style},onContextMenu:r?n.onContextMenu:Dn(n.onContextMenu,h=>{u(),d(h),h.preventDefault()}),onPointerDown:r?n.onPointerDown:Dn(n.onPointerDown,PA(h=>{u(),l.current=window.setTimeout(()=>d(h),700)})),onPointerMove:r?n.onPointerMove:Dn(n.onPointerMove,PA(u)),onPointerCancel:r?n.onPointerCancel:Dn(n.onPointerCancel,PA(u)),onPointerUp:r?n.onPointerUp:Dn(n.onPointerUp,PA(u))})]})});NFe.displayName=LFe;var uzt="ContextMenuPortal",Doe=n=>{const{__scopeContextMenu:e,...t}=n,r=Pl(e);return x.jsx(SFe,{...r,...t})};Doe.displayName=uzt;var FFe="ContextMenuContent",jFe=y.forwardRef((n,e)=>{const{__scopeContextMenu:t,...r}=n,i=MFe(FFe,t),o=Pl(t),s=y.useRef(!1);return x.jsx(_Fe,{...o,...r,ref:e,side:"right",sideOffset:2,align:"start",onCloseAutoFocus:a=>{var c;(c=n.onCloseAutoFocus)==null||c.call(n,a),!a.defaultPrevented&&s.current&&a.preventDefault(),s.current=!1},onInteractOutside:a=>{var c;(c=n.onInteractOutside)==null||c.call(n,a),!a.defaultPrevented&&!i.modal&&(s.current=!0)},style:{...n.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});jFe.displayName=FFe;var dzt="ContextMenuGroup",BFe=y.forwardRef((n,e)=>{const{__scopeContextMenu:t,...r}=n,i=Pl(t);return x.jsx(wFe,{...i,...r,ref:e})});BFe.displayName=dzt;var hzt="ContextMenuLabel",fzt=y.forwardRef((n,e)=>{const{__scopeContextMenu:t,...r}=n,i=Pl(t);return x.jsx(CFe,{...i,...r,ref:e})});fzt.displayName=hzt;var pzt="ContextMenuItem",HFe=y.forwardRef((n,e)=>{const{__scopeContextMenu:t,...r}=n,i=Pl(t);return x.jsx(xFe,{...i,...r,ref:e})});HFe.displayName=pzt;var gzt="ContextMenuCheckboxItem",UFe=y.forwardRef((n,e)=>{const{__scopeContextMenu:t,...r}=n,i=Pl(t);return x.jsx(EFe,{...i,...r,ref:e})});UFe.displayName=gzt;var mzt="ContextMenuRadioGroup",vzt=y.forwardRef((n,e)=>{const{__scopeContextMenu:t,...r}=n,i=Pl(t);return x.jsx(IFe,{...i,...r,ref:e})});vzt.displayName=mzt;var yzt="ContextMenuRadioItem",bzt=y.forwardRef((n,e)=>{const{__scopeContextMenu:t,...r}=n,i=Pl(t);return x.jsx(PFe,{...i,...r,ref:e})});bzt.displayName=yzt;var Szt="ContextMenuItemIndicator",_zt=y.forwardRef((n,e)=>{const{__scopeContextMenu:t,...r}=n,i=Pl(t);return x.jsx(kFe,{...i,...r,ref:e})});_zt.displayName=Szt;var wzt="ContextMenuSeparator",Czt=y.forwardRef((n,e)=>{const{__scopeContextMenu:t,...r}=n,i=Pl(t);return x.jsx(TFe,{...i,...r,ref:e})});Czt.displayName=wzt;var xzt="ContextMenuArrow",Ezt=y.forwardRef((n,e)=>{const{__scopeContextMenu:t,...r}=n,i=Pl(t);return x.jsx(DFe,{...i,...r,ref:e})});Ezt.displayName=xzt;var Izt="ContextMenuSub",zFe=n=>{const{__scopeContextMenu:e,children:t,onOpenChange:r,open:i,defaultOpen:o}=n,s=Pl(e),[a,c]=Yy({prop:i,defaultProp:o,onChange:r});return x.jsx(RFe,{...s,open:a,onOpenChange:c,children:t})};zFe.displayName=Izt;var Pzt="ContextMenuSubTrigger",VFe=y.forwardRef((n,e)=>{const{__scopeContextMenu:t,...r}=n,i=Pl(t);return x.jsx(AFe,{...i,...r,ref:e})});VFe.displayName=Pzt;var kzt="ContextMenuSubContent",WFe=y.forwardRef((n,e)=>{const{__scopeContextMenu:t,...r}=n,i=Pl(t);return x.jsx(OFe,{...i,...r,ref:e,style:{...n.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});WFe.displayName=kzt;function PA(n){return e=>e.pointerType!=="mouse"?n(e):void 0}var Tzt=$Fe,Dzt=NFe,Rzt=Doe,Azt=jFe,Ozt=UFe;const qFe=typeof window>"u"?!1:window.navigator.userAgent.toLowerCase().indexOf("mac")>-1,Mzt=qFe?"⌘":"Ctrl",$zt=qFe?"⌥":"Alt";function KFe(n){return n.split(",")[0].split("").map(e=>{const t=e.replace(/\$/g,Mzt).replace(/\?/g,$zt).replace(/!/g,"⇧");return t[0].toUpperCase()+t.slice(1)})}function $X(n){return"— "+KFe(n).join(" ")}function Lzt(n){return x.jsx("svg",{width:16,height:16,viewBox:"0 0 16 16",...n,children:x.jsxs("g",{strokeWidth:2,fill:"none",fillRule:"evenodd",children:[x.jsx("circle",{strokeOpacity:.25,cx:8,cy:8,r:7,stroke:"currentColor"}),x.jsx("path",{strokeLinecap:"round",d:"M15 8c0-4.5-4.5-7-7-7",stroke:"currentColor",children:x.jsx("animateTransform",{attributeName:"transform",type:"rotate",from:"0 8 8",to:"360 8 8",dur:"1s",repeatCount:"indefinite"})})]})})}var Roe="DropdownMenu",[Nzt,Vln]=Lg(Roe,[nF]),kl=nF(),[Fzt,GFe]=Nzt(Roe),ZFe=n=>{const{__scopeDropdownMenu:e,children:t,dir:r,open:i,defaultOpen:o,onOpenChange:s,modal:a=!0}=n,c=kl(e),l=y.useRef(null),[u=!1,d]=Yy({prop:i,defaultProp:o,onChange:s});return x.jsx(Fzt,{scope:e,triggerId:Ym(),triggerRef:l,contentId:Ym(),open:u,onOpenChange:d,onOpenToggle:y.useCallback(()=>d(h=>!h),[d]),modal:a,children:x.jsx(yFe,{...c,open:u,onOpenChange:d,dir:r,modal:a,children:t})})};ZFe.displayName=Roe;var XFe="DropdownMenuTrigger",YFe=y.forwardRef((n,e)=>{const{__scopeDropdownMenu:t,disabled:r=!1,...i}=n,o=GFe(XFe,t),s=kl(t);return x.jsx(bFe,{asChild:!0,...s,children:x.jsx(Pi.button,{type:"button",id:o.triggerId,"aria-haspopup":"menu","aria-expanded":o.open,"aria-controls":o.open?o.contentId:void 0,"data-state":o.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...i,ref:HN(e,o.triggerRef),onPointerDown:Dn(n.onPointerDown,a=>{!r&&a.button===0&&a.ctrlKey===!1&&(o.onOpenToggle(),o.open||a.preventDefault())}),onKeyDown:Dn(n.onKeyDown,a=>{r||(["Enter"," "].includes(a.key)&&o.onOpenToggle(),a.key==="ArrowDown"&&o.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(a.key)&&a.preventDefault())})})})});YFe.displayName=XFe;var jzt="DropdownMenuPortal",JFe=n=>{const{__scopeDropdownMenu:e,...t}=n,r=kl(e);return x.jsx(SFe,{...r,...t})};JFe.displayName=jzt;var QFe="DropdownMenuContent",e9e=y.forwardRef((n,e)=>{const{__scopeDropdownMenu:t,...r}=n,i=GFe(QFe,t),o=kl(t),s=y.useRef(!1);return x.jsx(_Fe,{id:i.contentId,"aria-labelledby":i.triggerId,...o,...r,ref:e,onCloseAutoFocus:Dn(n.onCloseAutoFocus,a=>{var c;s.current||(c=i.triggerRef.current)==null||c.focus(),s.current=!1,a.preventDefault()}),onInteractOutside:Dn(n.onInteractOutside,a=>{const c=a.detail.originalEvent,l=c.button===0&&c.ctrlKey===!0,u=c.button===2||l;(!i.modal||u)&&(s.current=!0)}),style:{...n.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});e9e.displayName=QFe;var Bzt="DropdownMenuGroup",t9e=y.forwardRef((n,e)=>{const{__scopeDropdownMenu:t,...r}=n,i=kl(t);return x.jsx(wFe,{...i,...r,ref:e})});t9e.displayName=Bzt;var Hzt="DropdownMenuLabel",Uzt=y.forwardRef((n,e)=>{const{__scopeDropdownMenu:t,...r}=n,i=kl(t);return x.jsx(CFe,{...i,...r,ref:e})});Uzt.displayName=Hzt;var zzt="DropdownMenuItem",n9e=y.forwardRef((n,e)=>{const{__scopeDropdownMenu:t,...r}=n,i=kl(t);return x.jsx(xFe,{...i,...r,ref:e})});n9e.displayName=zzt;var Vzt="DropdownMenuCheckboxItem",r9e=y.forwardRef((n,e)=>{const{__scopeDropdownMenu:t,...r}=n,i=kl(t);return x.jsx(EFe,{...i,...r,ref:e})});r9e.displayName=Vzt;var Wzt="DropdownMenuRadioGroup",qzt=y.forwardRef((n,e)=>{const{__scopeDropdownMenu:t,...r}=n,i=kl(t);return x.jsx(IFe,{...i,...r,ref:e})});qzt.displayName=Wzt;var Kzt="DropdownMenuRadioItem",Gzt=y.forwardRef((n,e)=>{const{__scopeDropdownMenu:t,...r}=n,i=kl(t);return x.jsx(PFe,{...i,...r,ref:e})});Gzt.displayName=Kzt;var Zzt="DropdownMenuItemIndicator",Xzt=y.forwardRef((n,e)=>{const{__scopeDropdownMenu:t,...r}=n,i=kl(t);return x.jsx(kFe,{...i,...r,ref:e})});Xzt.displayName=Zzt;var Yzt="DropdownMenuSeparator",Jzt=y.forwardRef((n,e)=>{const{__scopeDropdownMenu:t,...r}=n,i=kl(t);return x.jsx(TFe,{...i,...r,ref:e})});Jzt.displayName=Yzt;var Qzt="DropdownMenuArrow",eVt=y.forwardRef((n,e)=>{const{__scopeDropdownMenu:t,...r}=n,i=kl(t);return x.jsx(DFe,{...i,...r,ref:e})});eVt.displayName=Qzt;var tVt=n=>{const{__scopeDropdownMenu:e,children:t,open:r,onOpenChange:i,defaultOpen:o}=n,s=kl(e),[a=!1,c]=Yy({prop:r,defaultProp:o,onChange:i});return x.jsx(RFe,{...s,open:a,onOpenChange:c,children:t})},nVt="DropdownMenuSubTrigger",i9e=y.forwardRef((n,e)=>{const{__scopeDropdownMenu:t,...r}=n,i=kl(t);return x.jsx(AFe,{...i,...r,ref:e})});i9e.displayName=nVt;var rVt="DropdownMenuSubContent",o9e=y.forwardRef((n,e)=>{const{__scopeDropdownMenu:t,...r}=n,i=kl(t);return x.jsx(OFe,{...i,...r,ref:e,style:{...n.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});o9e.displayName=rVt;var Aoe=ZFe,Ooe=YFe,iF=JFe,Moe=e9e,iVt=t9e,oVt=n9e,sVt=r9e,aVt=tVt,cVt=i9e,lVt=o9e;function XS({id:n,children:e,modal:t=!1,debugOpen:r=!1}){const[i,o]=Qy(n);return x.jsx(Aoe,{open:r||i,dir:"ltr",modal:t,onOpenChange:o,children:e})}function YS({children:n,...e}){return x.jsx(Ooe,{dir:"ltr",asChild:!0,onTouchEnd:t=>Ri(t),...e,children:n})}function JS({side:n="bottom",align:e="start",sideOffset:t=8,alignOffset:r=8,children:i}){const o=Il();return x.jsx(iF,{container:o,children:x.jsx(Moe,{className:"tlui-menu",side:n,sideOffset:t,align:e,alignOffset:r,collisionPadding:4,children:i})})}function uVt({id:n,children:e}){const[t,r]=Qy(n);return x.jsx(aVt,{open:t,onOpenChange:r,children:e})}function dVt({id:n,label:e,title:t,disabled:r}){return x.jsx(cVt,{dir:"ltr",asChild:!0,disabled:r,children:x.jsxs(dr,{"data-testid":n,type:"menu",className:"tlui-menu__submenu__trigger",disabled:r,title:t,children:[x.jsx(ia,{children:e}),x.jsx(Ci,{icon:"chevron-right",small:!0})]})})}function hVt({id:n,alignOffset:e=-1,sideOffset:t=-4,size:r="small",children:i}){const o=Il();return x.jsx(iF,{container:o,children:x.jsx(lVt,{"data-testid":n,className:"tlui-menu tlui-menu__submenu__content",alignOffset:e,sideOffset:t,collisionPadding:4,"data-size":r,children:i})})}function fVt({children:n}){return x.jsx(iVt,{dir:"ltr",className:"tlui-menu__group",children:n})}function J3({noClose:n,children:e}){return x.jsx(oVt,{dir:"ltr",asChild:!0,onClick:n?Ri:void 0,children:e})}function mk({children:n,visibleOnMobileLayout:e=!1}){const t=Ju();return!e&&t<Hs.MOBILE?null:x.jsx("kbd",{className:"tlui-kbd",children:KFe(n).map((r,i)=>x.jsx("span",{children:r},i))})}function ut({disabled:n=!1,spinner:e=!1,readonlyOk:t=!1,id:r,kbd:i,label:o,icon:s,onSelect:a,noClose:c,isSelected:l}){const{type:u,sourceId:d}=eF(),h=Ni(),[f,p]=y.useState(!1);if(Ev()&&!t)return null;const m=K3(o,u),v=i?$X(i):void 0,b=m?h(m):void 0,S=b&&v?`${b} ${v}`:b;switch(u){case"menu":return x.jsx(J3,{children:x.jsxs(dr,{type:"menu","data-testid":`${d}.${r}`,disabled:n,title:S,onClick:E=>{c&&Ri(E),f?p(!1):a(d)},children:[x.jsx(ia,{children:b}),i&&x.jsx(mk,{children:i})]})});case"context-menu":return n?null:x.jsxs(HFe,{dir:"ltr",title:S,draggable:!1,className:"tlui-button tlui-button__menu","data-testid":`${d}.${r}`,onSelect:E=>{c&&Ri(E),f?p(!1):a(d)},children:[x.jsx("span",{className:"tlui-button__label",draggable:!1,children:b}),i&&x.jsx(mk,{children:i}),e&&x.jsx(Lzt,{})]});case"panel":return x.jsxs(dr,{"data-testid":`${d}.${r}`,type:"menu",title:S,disabled:n,onClick:()=>a(d),children:[x.jsx(ia,{children:b}),s&&x.jsx(Ci,{icon:s})]});case"small-icons":case"icons":return x.jsx(dr,{"data-testid":`${d}.${r}`,type:"icon",title:S,disabled:n,onClick:()=>a(d),children:x.jsx(Ci,{icon:s,small:u==="small-icons"})});case"keyboard-shortcuts":return i?x.jsxs("div",{className:"tlui-shortcuts-dialog__key-pair","data-testid":`${d}.${r}`,children:[x.jsx("div",{className:"tlui-shortcuts-dialog__key-pair__key",children:b}),x.jsx("div",{className:"tlui-shortcuts-dialog__key-pair__value",children:x.jsx(mk,{visibleOnMobileLayout:!0,children:i})})]}):(console.warn(`Menu item '${o}' isn't shown in the keyboard shortcuts dialog because it doesn't have a keyboard shortcut.`),null);case"helper-buttons":return x.jsxs(dr,{type:"low",onClick:()=>a(d),children:[x.jsx(Ci,{icon:s}),x.jsx(ia,{children:b})]});case"toolbar":return x.jsx(dr,{type:"tool","data-testid":`tools.${r}`,"aria-label":m,"data-value":r,onClick:()=>a("toolbar"),title:S,onTouchStart:E=>{Ri(E),a("toolbar")},role:"radio","aria-checked":l?"true":"false",children:x.jsx(Ci,{icon:s})});case"toolbar-overflow":return x.jsx(J3,{"aria-label":o,children:x.jsx(dr,{type:"icon",className:"tlui-button-grid__button",onClick:()=>{a("toolbar")},"data-testid":`tools.more.${r}`,title:S,role:"radio","aria-checked":l?"true":"false","data-value":r,children:x.jsx(Ci,{icon:s})})});default:throw vl(u)}}function pVt(){return x.jsxs(x.Fragment,{children:[x.jsx(gVt,{}),x.jsx(mVt,{}),x.jsx(vVt,{}),x.jsx(yVt,{}),x.jsx(bVt,{}),x.jsx(wVt,{}),x.jsx(CVt,{}),x.jsx(xVt,{})]})}function gVt(){const n=Hn(),e=cu(2),t=Pv(),r=e&&t;return x.jsxs(x.Fragment,{children:[x.jsx(ut,{...n["align-left"],disabled:!r}),x.jsx(ut,{...n["align-center-horizontal"],disabled:!r}),x.jsx(ut,{...n["align-right"],disabled:!r}),x.jsx(ut,{...n["stretch-horizontal"],disabled:!r}),x.jsx(ut,{...n["align-top"],disabled:!r}),x.jsx(ut,{...n["align-center-vertical"],disabled:!r}),x.jsx(ut,{...n["align-bottom"],disabled:!r}),x.jsx(ut,{...n["stretch-vertical"],disabled:!r})]})}function mVt(){const n=Hn(),e=cu(3),t=Pv(),r=e&&t;return x.jsxs(x.Fragment,{children:[x.jsx(ut,{...n["distribute-horizontal"],disabled:!r}),x.jsx(ut,{...n["distribute-vertical"],disabled:!r})]})}function vVt(){const n=Hn(),e=LNe(),t=Pv(),r=e&&t;return x.jsxs(x.Fragment,{children:[x.jsx(ut,{...n["stack-horizontal"],disabled:!r}),x.jsx(ut,{...n["stack-vertical"],disabled:!r})]})}function yVt(){const n=Hn(),e=cu(1),t=Pv(),r=e&&t;return x.jsxs(x.Fragment,{children:[x.jsx(ut,{...n["send-to-back"],disabled:!r}),x.jsx(ut,{...n["send-backward"],disabled:!r}),x.jsx(ut,{...n["bring-forward"],disabled:!r}),x.jsx(ut,{...n["bring-to-front"],disabled:!r})]})}function bVt(){return Ju()<Hs.TABLET_SM?x.jsx(SVt,{}):x.jsx(_Vt,{})}function SVt(){const n=Hn(),e=ot(),t=_t("zoom is 1",()=>e.getZoomLevel()===1,[e]);return x.jsx(ut,{...n["zoom-to-100"],disabled:t})}function _Vt(){const n=Hn(),e=cu(1),t=Pv(),r=e&&t;return x.jsx(ut,{...n["rotate-ccw"],disabled:!r})}function wVt(){const n=Hn(),e=cu(1),t=Pv(),r=e&&t;return x.jsx(ut,{...n["rotate-cw"],disabled:!r})}function CVt(){const n=Hn(),e=jNe(),t=Pv(),r=e&&t;return x.jsx(ut,{...n["edit-link"],disabled:!r})}function xVt(){const n=NNe(),e=FNe();return n?x.jsx(J1e,{}):e?x.jsx(EVt,{}):x.jsx(J1e,{})}function J1e(){const n=Hn(),e=cu(2),t=Pv(),r=e&&t;return x.jsx(ut,{...n.group,disabled:!r})}function EVt(){const n=Hn();return x.jsx(ut,{...n.ungroup})}const IVt=y.memo(function({children:e}){const t=Ni(),r=Ju(),i=Ev(),o=ot(),s=_t("should display quick actions when in readonly",()=>o.isInAny("hand","zoom"),[o]),a=e??x.jsx(pVt,{});if(!(i&&!s))return x.jsxs(voe,{id:"actions-menu",children:[x.jsx(yoe,{children:x.jsx(dr,{type:"icon","data-testid":"actions-menu.button",title:t("actions-menu.title"),children:x.jsx(Ci,{icon:"dots-vertical",small:!0})})}),x.jsx(boe,{side:r>=Hs.TABLET?"bottom":"top",sideOffset:6,children:x.jsx("div",{className:"tlui-actions-menu tlui-buttons__grid","data-testid":"actions-menu.content",children:x.jsx(zh,{type:"icons",sourceId:"actions-menu",children:a})})})]})});function Yd({id:n,kbd:e,label:t,readonlyOk:r,onSelect:i,toggle:o=!1,disabled:s=!1,checked:a=!1}){const{type:c,sourceId:l}=eF(),u=Ev(),d=Ni();if(u&&!r)return null;const h=K3(t,c),f=h?d(h):void 0;switch(c){case"menu":return x.jsxs(sVt,{dir:"ltr",className:"tlui-button tlui-button__menu tlui-button__checkbox",title:f,onSelect:p=>{i==null||i(l),Ri(p)},disabled:s,checked:a,children:[x.jsx(Dy,{small:!0,icon:o?a?"toggle-on":"toggle-off":a?"check":"none"}),f&&x.jsx("span",{className:"tlui-button__label",draggable:!1,children:f}),e&&x.jsx(mk,{children:e})]});case"context-menu":return x.jsxs(Ozt,{className:"tlui-button tlui-button__menu tlui-button__checkbox",dir:"ltr",title:f,onSelect:p=>{i(l),Ri(p)},disabled:s,checked:a,children:[x.jsx(Dy,{small:!0,icon:o?a?"toggle-on":"toggle-off":a?"check":"none"}),f&&x.jsx("span",{className:"tlui-button__label",draggable:!1,children:f}),e&&x.jsx(mk,{children:e})]},n);default:return null}}function Vr({id:n,label:e,children:t}){const{type:r,sourceId:i}=eF(),o=Ni(),s=K3(e,r),a=s?o(s):void 0;switch(r){case"panel":return x.jsx("div",{className:"tlui-menu__group","data-testid":`${i}-group.${n}`,children:t});case"menu":return x.jsx(fVt,{"data-testid":`${i}-group.${n}`,children:t});case"context-menu":return x.jsx(BFe,{dir:"ltr",className:"tlui-menu__group","data-testid":`${i}-group.${n}`,children:t});case"keyboard-shortcuts":return x.jsxs("div",{className:"tlui-shortcuts-dialog__group","data-testid":`${i}-group.${n}`,children:[x.jsx("h2",{className:"tlui-shortcuts-dialog__group__title",children:a}),x.jsx("div",{className:"tlui-shortcuts-dialog__group__content",children:t})]});default:return t}}function Qu({id:n,disabled:e=!1,label:t,size:r="small",children:i}){const{type:o,sourceId:s}=eF(),a=Il(),c=Ni(),l=t?typeof t=="string"?t:t[o]??t.default:void 0,u=l?c(l):void 0;switch(o){case"menu":return x.jsxs(uVt,{id:`${s}-sub.${n}`,children:[x.jsx(dVt,{id:`${s}-sub.${u?u.toLowerCase()+"-button":""}`,disabled:e,label:u,title:u}),x.jsx(hVt,{id:`${s}-sub.${u?u.toLowerCase()+"-content":""}`,size:r,children:i})]});case"context-menu":return e?null:x.jsxs(PVt,{id:`${s}-sub.${n}`,children:[x.jsx(VFe,{dir:"ltr",disabled:e,asChild:!0,children:x.jsxs(dr,{"data-testid":`${s}-sub-trigger.${n}`,type:"menu",className:"tlui-menu__submenu__trigger",children:[x.jsx(ia,{children:u}),x.jsx(Ci,{icon:"chevron-right",small:!0})]})}),x.jsx(Doe,{container:a,children:x.jsx(WFe,{"data-testid":`${s}-sub-content.${n}`,className:"tlui-menu tlui-menu__submenu__content",alignOffset:-1,sideOffset:-4,collisionPadding:4,"data-size":r,children:i})})]});default:return i}}function PVt({id:n,children:e}){const[t,r]=Qy(n);return x.jsx(zFe,{open:t,onOpenChange:r,children:e})}function s9e(){const n=Hn();return _Ut()?x.jsx(ut,{...n["toggle-auto-size"]}):null}function a9e(){const n=Hn();return jNe()?x.jsx(ut,{...n["edit-link"]}):null}function kVt(){const n=Hn();return cu(1)?x.jsx(ut,{...n.duplicate}):null}function c9e(){const n=Hn(),e=ot();return _t("should display flatten option",()=>{if(e.getSelectedShapeIds().length===0)return!1;const i=e.getOnlySelectedShape();return!(i&&e.isShapeOfType(i,"image"))},[e])?x.jsx(ut,{...n["flatten-to-image"]}):null}function l9e(){const n=Hn();return NNe()?x.jsx(ut,{...n.group}):null}function u9e(){const n=Hn();return FNe()?x.jsx(ut,{...n.ungroup}):null}function d9e(){const n=ot(),e=Hn();return _t("allow unframe",()=>{const r=n.getSelectedShapes();return r.length===0?!1:r.every(i=>n.isShapeOfType(i,"frame"))},[n])?x.jsx(ut,{...e["remove-frame"]}):null}function h9e(){const n=ot(),e=Hn();return _t("allow fit frame to content",()=>{const r=n.getOnlySelectedShape();return r?n.isShapeOfType(r,"frame")&&n.getSortedChildIdsForParent(r).length>0:!1},[n])?x.jsx(ut,{...e["fit-frame-to-content"]}):null}function f9e(){const n=ot(),e=Hn();return _t("selected shapes",()=>n.getSelectedShapes().length>0,[n])?x.jsx(ut,{...e["toggle-lock"]}):null}function $oe(){const n=Hn(),e=ot(),t=_t("isTransparentBg",()=>!e.getInstanceState().exportBackground,[e]);return x.jsx(Yd,{...n["toggle-transparent"],checked:t,toggle:!0})}function TVt(){const n=ot(),e=Hn(),t=_t("any shapes",()=>n.getCurrentPageShapeIds().size>0,[n]);return x.jsx(ut,{...e["unlock-all"],disabled:!t})}function p9e(){const n=ot(),e=_t("zoomed to 100",()=>n.getZoomLevel()===1,[n]),t=Hn();return x.jsx(ut,{...t["zoom-to-100"],noClose:!0,disabled:e})}function g9e(){const n=ot(),e=_t("has shapes",()=>n.getCurrentPageShapeIds().size>0,[n]),t=Hn();return x.jsx(ut,{...t["zoom-to-fit"],disabled:!e,"data-testid":"minimap.zoom-menu.zoom-to-fit",noClose:!0})}function m9e(){const n=ot(),e=_t("has shapes",()=>n.getSelectedShapeIds().length>0,[n]),t=Hn();return x.jsx(ut,{...t["zoom-to-selection"],disabled:!e,"data-testid":"minimap.zoom-menu.zoom-to-selection",noClose:!0})}function v9e(){return x.jsxs(Vr,{id:"clipboard",children:[x.jsx(RVt,{}),x.jsx(AVt,{}),x.jsx(OVt,{}),x.jsx(kVt,{}),x.jsx(MVt,{})]})}function DVt(){var r;const n=ot(),e=Hn(),t=_t("atLeastOneShapeOnPage",()=>n.getCurrentPageShapeIds().size>0,[n]);return x.jsxs(Qu,{id:"copy-as",label:"context-menu.copy-as",size:"small",disabled:!t,children:[x.jsxs(Vr,{id:"copy-as-group",children:[x.jsx(ut,{...e["copy-as-svg"]}),!!((r=window.navigator.clipboard)!=null&&r.write)&&x.jsx(ut,{...e["copy-as-png"]}),x.jsx(ut,{...e["copy-as-json"]})]}),x.jsx(Vr,{id:"copy-as-bg",children:x.jsx($oe,{})})]})}function RVt(){const n=Hn(),e=cu(1);return x.jsx(ut,{...n.cut,disabled:!e})}function AVt(){const n=Hn(),e=SUt(1);return x.jsx(ut,{...n.copy,disabled:!e})}function OVt(){const n=Hn(),e=bUt;return x.jsx(ut,{...n.paste,disabled:!e})}function y9e(){const n=ot(),e=Hn();return _t("atLeastOneShapeOnPage",()=>n.getCurrentPageShapeIds().size>0,[n])?x.jsxs(Vr,{id:"conversions",children:[x.jsx(DVt,{}),x.jsxs(Qu,{id:"export-as",label:"context-menu.export-as",size:"small",children:[x.jsxs(Vr,{id:"export-as-group",children:[x.jsx(ut,{...e["export-as-svg"]}),x.jsx(ut,{...e["export-as-png"]}),x.jsx(ut,{...e["export-as-json"]})]}),x.jsx(Vr,{id:"export-as-bg",children:x.jsx($oe,{})})]})]}):null}function b9e(){const n=Hn(),e=ot(),t=_t("atLeastOneShapeOnPage",()=>e.getCurrentPageShapeIds().size>0,[e]);return x.jsx(ut,{...n["select-all"],disabled:!t})}function MVt(){const n=Hn(),e=cu(1);return x.jsx(ut,{...n.delete,disabled:!e})}function $Vt(){return x.jsxs(Qu,{id:"edit",label:"context-menu.edit",size:"small",children:[x.jsx(l9e,{}),x.jsx(u9e,{}),x.jsx(c9e,{}),x.jsx(a9e,{}),x.jsx(h9e,{}),x.jsx(d9e,{}),x.jsx(_9e,{}),x.jsx(S9e,{}),x.jsx(s9e,{}),x.jsx(f9e,{})]})}function LVt(){const n=cu(2),e=wUt(),t=Hn();return n||e?x.jsxs(Qu,{id:"arrange",label:"context-menu.arrange",size:"small",children:[n&&x.jsxs(Vr,{id:"align",children:[x.jsx(ut,{...t["align-left"]}),x.jsx(ut,{...t["align-center-horizontal"]}),x.jsx(ut,{...t["align-right"]}),x.jsx(ut,{...t["align-top"]}),x.jsx(ut,{...t["align-center-vertical"]}),x.jsx(ut,{...t["align-bottom"]})]}),x.jsx(NVt,{}),n&&x.jsxs(Vr,{id:"stretch",children:[x.jsx(ut,{...t["stretch-horizontal"]}),x.jsx(ut,{...t["stretch-vertical"]})]}),(n||e)&&x.jsxs(Vr,{id:"flip",children:[x.jsx(ut,{...t["flip-horizontal"]}),x.jsx(ut,{...t["flip-vertical"]})]}),x.jsx(FVt,{})]}):null}function NVt(){const n=Hn();return cu(3)?x.jsxs(Vr,{id:"distribute",children:[x.jsx(ut,{...n["distribute-horizontal"]}),x.jsx(ut,{...n["distribute-vertical"]})]}):null}function FVt(){const n=Hn(),e=cu(2),t=LNe();return e?x.jsxs(Vr,{id:"order",children:[x.jsx(ut,{...n.pack}),t&&x.jsx(ut,{...n["stack-horizontal"]}),t&&x.jsx(ut,{...n["stack-vertical"]})]}):null}function jVt(){const n=Hn();return cu(1)?x.jsx(Qu,{id:"reorder",label:"context-menu.reorder",size:"small",children:x.jsxs(Vr,{id:"reorder",children:[x.jsx(ut,{...n["bring-to-front"]}),x.jsx(ut,{...n["bring-forward"]}),x.jsx(ut,{...n["send-backward"]}),x.jsx(ut,{...n["send-to-back"]})]})}):null}function BVt(){const n=ot(),e=_t("pages",()=>n.getPages(),[n]),t=_t("current page id",()=>n.getCurrentPageId(),[n]),{addToast:r}=up(),i=Hn(),o=lp();return cu(1)?x.jsxs(Qu,{id:"move-to-page",label:"context-menu.move-to-page",size:"small",children:[x.jsx(Vr,{id:"pages",children:e.map(a=>x.jsx(ut,{id:a.id,disabled:t===a.id,label:a.name,onSelect:()=>{n.mark("move_shapes_to_page"),n.moveShapesToPage(n.getSelectedShapeIds(),a.id);const c=n.getPage(a.id);c&&r({title:"Changed Page",description:`Moved to ${c.name}.`,actions:[{label:"Go Back",type:"primary",onClick:()=>{n.mark("change-page"),n.setCurrentPage(t)}}]}),o("move-to-page",{source:"context-menu"})}},a.id))}),x.jsx(Vr,{id:"new-page",children:x.jsx(ut,{...i["new-page"]})})]}):null}function S9e(){const n=ot(),e=Hn();return _t("oneEmbedSelected",()=>{const r=n.getOnlySelectedShape();return r?!!(n.isShapeOfType(r,"embed")&&r.props.url&&!n.isShapeOrAncestorLocked(r)):!1},[n])?x.jsx(ut,{...e["convert-to-bookmark"]}):null}function _9e(){const n=ot(),e=Hn();return _t("oneEmbeddableBookmarkSelected",()=>{const r=n.getOnlySelectedShape();return r?!!(n.isShapeOfType(r,"bookmark")&&r.props.url&&K0(r.props.url)&&!n.isShapeOrAncestorLocked(r)):!1},[n])?x.jsx(ut,{...e["convert-to-embed"]}):null}function HVt(){const n=Hn(),e=ot(),t=_t("isSnapMode",()=>e.user.getIsSnapMode(),[e]);return x.jsx(Yd,{...n["toggle-snap-mode"],checked:t})}function UVt(){const n=Hn(),e=ot(),t=_t("isToolLock",()=>e.getInstanceState().isToolLocked,[e]);return x.jsx(Yd,{...n["toggle-tool-lock"],checked:t})}function zVt(){const n=Hn(),e=ot(),t=_t("isGridMode",()=>e.getInstanceState().isGridMode,[e]);return x.jsx(Yd,{...n["toggle-grid"],checked:t})}function VVt(){const n=Hn(),e=ot(),t=_t("isWrapMode",()=>e.user.getIsWrapMode(),[e]);return x.jsx(Yd,{...n["toggle-wrap-mode"],checked:t})}function WVt(){const n=Hn(),e=ot(),t=_t("isFocusMode",()=>e.getInstanceState().isFocusMode,[e]);return x.jsx(Yd,{...n["toggle-focus-mode"],checked:t})}function qVt(){const n=Hn(),e=ot(),t=_t("edgeScrollSpeed",()=>e.user.getEdgeScrollSpeed(),[e]);return x.jsx(Yd,{...n["toggle-edge-scrolling"],checked:t===1})}function KVt(){const n=Hn(),e=ot(),t=_t("animationSpeed",()=>e.user.getAnimationSpeed(),[e]);return x.jsx(Yd,{...n["toggle-reduce-motion"],checked:t===0})}function GVt(){const n=Hn(),e=ot(),t=_t("isDebugMode",()=>e.getInstanceState().isDebugMode,[e]);return x.jsx(Yd,{...n["toggle-debug-mode"],checked:t})}function ZVt(){const n=Hn(),e=ot(),t=_t("dynamic resize",()=>e.user.getIsDynamicResizeMode(),[e]);return x.jsx(Yd,{...n["toggle-dynamic-size-mode"],checked:t})}function XVt(){const n=ot();return _t("isSelectToolActive",()=>n.getCurrentToolId()==="select",[n])?x.jsxs(x.Fragment,{children:[x.jsxs(Vr,{id:"modify",children:[x.jsx($Vt,{}),x.jsx(LVt,{}),x.jsx(jVt,{}),x.jsx(BVt,{})]}),x.jsx(v9e,{}),x.jsx(y9e,{}),x.jsx(Vr,{id:"select-all",children:x.jsx(b9e,{})})]}):null}const YVt=y.memo(function({children:e}){const t=ot(),{Canvas:r}=hs(),i=y.useCallback(l=>{if(l){if(t.getInstanceState().isCoarsePointer){const u=t.getSelectedShapes(),{inputs:{currentPagePoint:d}}=t,h=t.getShapesAtPoint(d);if(!t.getSelectedShapes().length||!h.some(f=>u.includes(f))){const f=h.filter(p=>t.isShapeOrAncestorLocked(p));f.length&&t.select(...f.map(p=>p.id))}}}else{const u=t.getOnlySelectedShape();u&&t.isShapeOrAncestorLocked(u)&&t.setSelectedShapes([])}},[t]),o=Il(),[s,a]=Qy("context menu",i),c=e??x.jsx(XVt,{});return x.jsxs(Tzt,{dir:"ltr",onOpenChange:a,modal:!1,children:[x.jsx(Dzt,{onContextMenu:void 0,dir:"ltr",children:r?x.jsx(r,{}):null}),s&&x.jsx(Rzt,{container:o,children:x.jsx(Azt,{className:"tlui-menu scrollable","data-testid":"context-menu",alignOffset:-4,collisionPadding:4,onContextMenu:Ri,children:x.jsx(zh,{type:"context-menu",sourceId:"context-menu",children:c})})})]})});function LX({checked:n}){return x.jsx(Dy,{icon:n?"check":"none",className:"tlui-button__icon",small:!0})}function JVt(){const n=ot(),{addToast:e}=up(),{addDialog:t}=g_(),[r,i]=Ke.useState(!1);return x.jsxs(x.Fragment,{children:[x.jsxs(Vr,{id:"items",children:[x.jsx(ut,{id:"add-toast",onSelect:()=>{e({id:us(),title:"Something good happened",description:"Hey, attend to this thing over here. It might be important!",keepOpen:!0,severity:"success"}),e({id:us(),title:"Something happened",description:"Hey, attend to this thing over here. It might be important!",keepOpen:!0,severity:"info",actions:[{label:"Primary",type:"primary",onClick:()=>{}},{label:"Normal",type:"normal",onClick:()=>{}},{label:"Danger",type:"danger",onClick:()=>{}}]}),e({id:us(),title:"Something maybe bad happened",description:"Hey, attend to this thing over here. It might be important!",keepOpen:!0,severity:"warning",actions:[{label:"Primary",type:"primary",onClick:()=>{}},{label:"Normal",type:"normal",onClick:()=>{}},{label:"Danger",type:"danger",onClick:()=>{}}]}),e({id:us(),title:"Something bad happened",severity:"error",keepOpen:!0})},label:"Show toast"}),x.jsx(ut,{id:"show-dialog",label:"Show dialog",onSelect:()=>{t({component:({onClose:o})=>x.jsx(tWt,{displayDontShowAgain:!0,onCancel:()=>o(),onContinue:()=>o()}),onClose:()=>{}})}}),x.jsx(ut,{id:"create-shapes",label:"Create 100 shapes",onSelect:()=>nWt(n,100)}),x.jsx(ut,{id:"count-nodes",label:"Count shapes / nodes",onSelect:()=>{var a;const o=n.getSelectedShapes(),s=o.length===0?n.getRenderingShapes():o;window.alert(`Shapes ${s.length}, DOM nodes:${(a=document.querySelector(".tl-shapes").querySelectorAll("*"))==null?void 0:a.length}`)}}),(()=>{if(r)throw Error("oh no!");return null})(),x.jsx(ut,{id:"throw-error",onSelect:()=>i(!0),label:"Throw error"}),x.jsx(ut,{id:"hard-reset",onSelect:f$e,label:"Hard reset"})]}),x.jsxs(Vr,{id:"flags",children:[x.jsx(QVt,{}),x.jsx(eWt,{})]})]})}function QVt(){const n=Object.values(ta);return n.length?x.jsx(Qu,{id:"debug flags",label:"Debug Flags",children:x.jsx(Vr,{id:"debug flags",children:n.map(e=>x.jsx(w9e,{flag:e},e.name))})}):null}function eWt(){const n=Object.values(vMt);return n.length?x.jsx(Qu,{id:"feature flags",label:"Feature Flags",children:x.jsx(Vr,{id:"feature flags",children:n.map(e=>x.jsx(w9e,{flag:e},e.name))})}):null}function tWt({title:n="title",body:e="hello hello hello",cancel:t="Cancel",confirm:r="Continue",displayDontShowAgain:i=!1,onCancel:o,onContinue:s}){const[a,c]=Ke.useState(!1);return x.jsxs(x.Fragment,{children:[x.jsxs(GN,{children:[x.jsx(ZN,{children:n}),x.jsx(XN,{})]}),x.jsx(q3,{style:{maxWidth:350},children:e}),x.jsxs(toe,{className:"tlui-dialog__footer__actions",children:[i&&x.jsxs(dr,{type:"normal",onClick:()=>c(!a),style:{marginRight:"auto"},children:[x.jsx(LX,{checked:a}),x.jsx(ia,{children:"Don’t show again"})]}),x.jsx(dr,{type:"normal",onClick:o,children:x.jsx(ia,{children:t})}),x.jsx(dr,{type:"primary",onClick:async()=>s(),children:x.jsx(ia,{children:r})})]})]})}const w9e=Zd(function({flag:e,onChange:t}){const r=e.get();return x.jsx(Yd,{id:e.name,title:e.name,label:e.name.replace(/([a-z0-9])([A-Z])/g,i=>`${i[0]} ${i[1].toLowerCase()}`).replace(/^[a-z]/,i=>i.toUpperCase()),checked:r,onSelect:()=>{e.set(!r),t==null||t(!r)}})});let Q1e=0;function nWt(n,e){const t=Array(e),r=Math.floor(Math.sqrt(e));for(let i=0;i<e;i++)Q1e++,t[i]={id:ro("box"+Q1e),type:"geo",x:i%r*132,y:Math.floor(i/r)*132};n.batch(()=>{n.createShapes(t).setSelectedShapes(t.map(i=>i.id))})}function rWt({children:n}){const e=n??x.jsx(JVt,{});return x.jsxs(XS,{id:"debug",children:[x.jsx(YS,{children:x.jsx(dr,{type:"icon",title:"Debug menu",children:x.jsx(Ci,{icon:"dots-horizontal"})})}),x.jsx(JS,{side:"top",align:"end",alignOffset:0,children:x.jsx(zh,{type:"menu",sourceId:"debug-panel",children:e})})]})}const iWt=y.memo(function(){const{DebugMenu:e}=nb();return x.jsxs("div",{className:"tlui-debug-panel",children:[x.jsx(sWt,{}),x.jsx(aWt,{}),e&&x.jsx(e,{})]})});function oWt(n=!0){const[e,t]=y.useState(0),r=ot();y.useEffect(()=>{if(!n)return;const i=()=>t(o=>o+1);return r.on("tick",i),()=>{r.off("tick",i)}},[r,n])}const sWt=Zd(function(){oWt();const e=ot(),t=e.getPath(),r=e.getHoveredShape(),i=e.getOnlySelectedShape(),o=t==="select.idle"||!t.includes("select.")?r:i,s=o&&t.includes("select.")?` / ${o.type||""}${"geo"in o.props?" / "+o.props.geo:""} / [${H.ToInt(e.getPointInShapeSpace(o,e.inputs.currentPagePoint))}]`:"",a=t.startsWith("select.")&&!t.includes(".idle")?` / [${H.ToInt(e.inputs.originPagePoint)}] → [${H.ToInt(e.inputs.currentPagePoint)}] = ${H.Dist(e.inputs.originPagePoint,e.inputs.currentPagePoint).toFixed(0)}`:"";return x.jsx("div",{className:"tlui-debug-panel__current-state",children:`${t}${s}${a}`})});function aWt(){const n=ot(),e=_t("show_fps",()=>ta.showFps.get(),[ta]),t=y.useRef(null);return y.useEffect(()=>{if(!e)return;const r=250;let i=0,o=-1,s=performance.now(),a=0,c=0,l=!1;function u(){if(c++,a=performance.now()-s,a>r){const d=Math.round(c*(r/a)*(1e3/r));d>i&&(i=d);const h=i*.75;(d<h&&!l||d>=h&&l)&&(l=!l),t.current.innerHTML=`FPS ${d.toString()}`,t.current.className="tlui-debug-panel__fps"+(l?" tlui-debug-panel__fps__slow":""),a-=r,c=0,s=performance.now()}o=n.timers.requestAnimationFrame(u)}return u(),()=>{cancelAnimationFrame(o)}},[e,n]),e?x.jsx("div",{ref:t}):null}function C9e(){const n=ot(),e=lp(),t=_t("locale",()=>n.user.getLocale(),[n]);return x.jsx(Qu,{id:"help menu language",label:"menu.language",children:x.jsx(Vr,{id:"languages",children:z3.map(({locale:r,label:i})=>x.jsx(Yd,{id:`language-${r}`,title:r,label:i,checked:r===t,onSelect:()=>{n.user.updateUserPreferences({locale:r}),e("change-language",{source:"menu",locale:r})}},r))})})}function cWt(){return x.jsxs(x.Fragment,{children:[x.jsx(C9e,{}),x.jsx(lWt,{})]})}function lWt(){const{KeyboardShortcutsDialog:n}=nb(),{addDialog:e}=g_();return n?x.jsx(ut,{id:"keyboard-shortcuts-button",label:"help-menu.keyboard-shortcuts",readonlyOk:!0,onSelect:()=>{e({component:n})}}):null}const uWt=y.memo(function({children:e}){const t=Ni(),r=Ju(),i=e??x.jsx(cWt,{});return r<Hs.MOBILE?null:x.jsx("div",{className:"tlui-help-menu",children:x.jsxs(XS,{id:"help menu",children:[x.jsx(YS,{children:x.jsx(dr,{type:"help",title:t("help-menu.title"),"data-testid":"help-menu.button",children:x.jsx(Ci,{icon:"question-mark",small:!0})})}),x.jsx(JS,{side:"top",align:"end",alignOffset:0,sideOffset:8,children:x.jsx(zh,{type:"menu",sourceId:"help-menu",children:i})})]})})});function dWt(){const n=ot(),e=Hn(),[t,r]=y.useState(!1),i=y.useRef(!1);return oy("toggle showback to content",()=>{const o=i.current,s=n.getCurrentPageShapeIds();let a=!1;s.size&&(a=s.size===n.getCulledShapes().size),o!==a&&(r(a),i.current=a)},[n]),t?x.jsx(ut,{...e["back-to-content"],onSelect:()=>{e["back-to-content"].onSelect("helper-buttons"),r(!1)}}):null}function hWt(){const n=ot(),e=Hn();return _t("is pen mode",()=>n.getInstanceState().isPenMode,[n])?x.jsx(ut,{...e["exit-pen-mode"]}):null}function fWt(){const n=ot(),e=Hn();return _t("is following user",()=>!!n.getInstanceState().followingUserId,[n])?x.jsx(ut,{...e["stop-following"]}):null}function pWt(){return x.jsxs(x.Fragment,{children:[x.jsx(hWt,{}),x.jsx(dWt,{}),x.jsx(fWt,{})]})}function gWt({children:n}){const e=n??x.jsx(pWt,{});return x.jsx("div",{className:"tlui-helper-buttons",children:x.jsx(zh,{type:"helper-buttons",sourceId:"helper-buttons",children:e})})}function mWt(){const n=Hn(),e=HD();return x.jsxs(x.Fragment,{children:[x.jsxs(Vr,{label:"shortcuts-dialog.tools",id:"tools",children:[x.jsx(ut,{...n["toggle-tool-lock"]}),x.jsx(ut,{...n["insert-media"]}),x.jsx(ut,{...e.select}),x.jsx(ut,{...e.draw}),x.jsx(ut,{...e.eraser}),x.jsx(ut,{...e.hand}),x.jsx(ut,{...e.rectangle}),x.jsx(ut,{...e.ellipse}),x.jsx(ut,{...e.arrow}),x.jsx(ut,{...e.line}),x.jsx(ut,{...e.text}),x.jsx(ut,{...e.frame}),x.jsx(ut,{...e.note}),x.jsx(ut,{...e.laser})]}),x.jsxs(Vr,{label:"shortcuts-dialog.preferences",id:"preferences",children:[x.jsx(ut,{...n["toggle-dark-mode"]}),x.jsx(ut,{...n["toggle-focus-mode"]}),x.jsx(ut,{...n["toggle-grid"]})]}),x.jsxs(Vr,{label:"shortcuts-dialog.edit",id:"edit",children:[x.jsx(ut,{...n.undo}),x.jsx(ut,{...n.redo}),x.jsx(ut,{...n.cut}),x.jsx(ut,{...n.copy}),x.jsx(ut,{...n.paste}),x.jsx(ut,{...n["select-all"]}),x.jsx(ut,{...n.delete}),x.jsx(ut,{...n.duplicate})]}),x.jsxs(Vr,{label:"shortcuts-dialog.view",id:"view",children:[x.jsx(ut,{...n["zoom-in"]}),x.jsx(ut,{...n["zoom-out"]}),x.jsx(ut,{...n["zoom-to-100"]}),x.jsx(ut,{...n["zoom-to-fit"]}),x.jsx(ut,{...n["zoom-to-selection"]})]}),x.jsxs(Vr,{label:"shortcuts-dialog.transform",id:"transform",children:[x.jsx(ut,{...n["bring-to-front"]}),x.jsx(ut,{...n["bring-forward"]}),x.jsx(ut,{...n["send-backward"]}),x.jsx(ut,{...n["send-to-back"]}),x.jsx(ut,{...n.group}),x.jsx(ut,{...n.ungroup}),x.jsx(ut,{...n["flip-horizontal"]}),x.jsx(ut,{...n["flip-vertical"]}),x.jsx(ut,{...n["align-top"]}),x.jsx(ut,{...n["align-center-vertical"]}),x.jsx(ut,{...n["align-bottom"]}),x.jsx(ut,{...n["align-left"]}),x.jsx(ut,{...n["align-center-horizontal"]}),x.jsx(ut,{...n["align-right"]})]})]})}const vWt=y.memo(function({children:e}){const t=Ni(),r=Ju(),i=e??x.jsx(mWt,{});return x.jsxs(x.Fragment,{children:[x.jsxs(GN,{className:"tlui-shortcuts-dialog__header",children:[x.jsx(ZN,{children:t("shortcuts-dialog.title")}),x.jsx(XN,{})]}),x.jsx(q3,{className:Ue("tlui-shortcuts-dialog__body",{"tlui-shortcuts-dialog__body__mobile":r<=Hs.MOBILE_XS,"tlui-shortcuts-dialog__body__tablet":r<=Hs.TABLET}),children:x.jsx(zh,{type:"keyboard-shortcuts",sourceId:"kbd",children:i})}),x.jsx("div",{className:"tlui-dialog__scrim"})]})}),yWt=[{colorScheme:"light",label:"theme.light"},{colorScheme:"dark",label:"theme.dark"},{colorScheme:"system",label:"theme.system"}];function bWt(){const n=ot(),e=lp(),t=_t("colorScheme",()=>n.user.getUserPreferences().colorScheme,[n]);return x.jsx(Qu,{id:"help menu color-scheme",label:"menu.theme",children:x.jsx(Vr,{id:"languages",children:yWt.map(({colorScheme:r,label:i})=>x.jsx(Yd,{id:`color-scheme-${r}`,label:i,checked:r===t,onSelect:()=>{n.user.updateUserPreferences({colorScheme:r}),e("color-scheme",{source:"menu",value:r})}},r))})})}function SWt(){return x.jsxs(x.Fragment,{children:[x.jsx(wWt,{}),x.jsx(IWt,{}),x.jsx(_Wt,{}),x.jsx(PWt,{}),x.jsx(kWt,{})]})}function _Wt(){const n=Hn();return x.jsxs(Qu,{id:"export-all-as",label:"context-menu.export-all-as",size:"small",children:[x.jsxs(Vr,{id:"export-all-as-group",children:[x.jsx(ut,{...n["export-all-as-svg"]}),x.jsx(ut,{...n["export-all-as-png"]}),x.jsx(ut,{...n["export-all-as-json"]})]}),x.jsx(Vr,{id:"export-all-as-bg",children:x.jsx($oe,{})})]})}function wWt(){const n=ot(),e=_t("isSelectToolActive",()=>n.getCurrentToolId()==="select",[n]);return x.jsxs(Qu,{id:"edit",label:"menu.edit",disabled:!e,children:[x.jsx(EWt,{}),x.jsx(v9e,{}),x.jsx(y9e,{}),x.jsx(CWt,{}),x.jsx(xWt,{}),x.jsx(Vr,{id:"select-all",children:x.jsx(b9e,{})})]})}function CWt(){return x.jsxs(Vr,{id:"misc",children:[x.jsx(l9e,{}),x.jsx(u9e,{}),x.jsx(a9e,{}),x.jsx(s9e,{}),x.jsx(d9e,{}),x.jsx(h9e,{}),x.jsx(_9e,{}),x.jsx(S9e,{}),x.jsx(c9e,{})]})}function xWt(){return x.jsxs(Vr,{id:"lock",children:[x.jsx(f9e,{}),x.jsx(TVt,{})]})}function EWt(){const n=Hn(),e=HNe(),t=BNe();return x.jsxs(Vr,{id:"undo-redo",children:[x.jsx(ut,{...n.undo,disabled:!e}),x.jsx(ut,{...n.redo,disabled:!t})]})}function IWt(){const n=Hn();return x.jsx(Qu,{id:"view",label:"menu.view",children:x.jsxs(Vr,{id:"view-actions",children:[x.jsx(ut,{...n["zoom-in"]}),x.jsx(ut,{...n["zoom-out"]}),x.jsx(p9e,{}),x.jsx(g9e,{}),x.jsx(m9e,{})]})})}function PWt(){const n=Hn();return x.jsxs(Vr,{id:"extras",children:[x.jsx(ut,{...n["insert-embed"]}),x.jsx(ut,{...n["insert-media"]})]})}function kWt(){return x.jsx(Vr,{id:"preferences",children:x.jsxs(Qu,{id:"preferences",label:"menu.preferences",children:[x.jsxs(Vr,{id:"preferences-actions",children:[x.jsx(HVt,{}),x.jsx(UVt,{}),x.jsx(zVt,{}),x.jsx(VVt,{}),x.jsx(WVt,{}),x.jsx(qVt,{}),x.jsx(KVt,{}),x.jsx(ZVt,{}),x.jsx(GVt,{})]}),x.jsx(Vr,{id:"color-scheme",children:x.jsx(bWt,{})}),x.jsx(Vr,{id:"language",children:x.jsx(C9e,{})})]})})}const TWt=y.memo(function({children:e}){const t=Il(),[r,i]=Qy("main menu"),o=Ni(),s=e??x.jsx(SWt,{});return x.jsxs(Aoe,{dir:"ltr",open:r,onOpenChange:i,modal:!1,children:[x.jsx(Ooe,{asChild:!0,dir:"ltr",children:x.jsx(dr,{type:"icon","data-testid":"main-menu.button",title:o("menu.title"),children:x.jsx(Ci,{icon:"menu",small:!0})})}),x.jsx(iF,{container:t,children:x.jsx(Moe,{className:"tlui-menu",side:"bottom",align:"start",collisionPadding:4,alignOffset:0,sideOffset:6,children:x.jsx(zh,{type:"menu",sourceId:"main-menu",children:s})})})]})}),DWt=y.memo(function(){const e=Ju(),{MainMenu:t,QuickActions:r,ActionsMenu:i,PageMenu:o}=nb();return!t&&!o&&e<6?null:x.jsx("div",{className:"tlui-menu-zone",children:x.jsxs("div",{className:"tlui-buttons__horizontal",children:[t&&x.jsx(t,{}),o&&x.jsx(o,{}),e<6?null:x.jsxs(x.Fragment,{children:[r&&x.jsx(r,{}),i&&x.jsx(i,{})]})]})})}),cz={};function PI(n){if(cz[n])return cz[n];const t=document.createElement("canvas").getContext("2d");t.fillStyle=n,t.fillRect(0,0,1,1);const[r,i,o,s]=t.getImageData(0,0,1,1).data,a=new Float32Array([r/255,i/255,o/255,s/255]);return cz[n]=a,a}const nM=10,x9e=4*6*nM+12+4*12;function Nw(n,{center:e,radius:t,numArcSegments:r=20,startAngle:i=0,endAngle:o=Xi,offset:s=0}){const a=(o-i)/r;let c=s;for(let l=i;l<o;l+=a)n[c++]=e.x,n[c++]=e.y,n[c++]=e.x+Math.cos(l)*t,n[c++]=e.y+Math.sin(l)*t,n[c++]=e.x+Math.cos(l+a)*t,n[c++]=e.y+Math.sin(l+a)*t;return n}function Fw(n,e,t,r,i,o){n[e++]=t,n[e++]=r,n[e++]=t,n[e++]=r+o,n[e++]=t+i,n[e++]=r,n[e++]=t+i,n[e++]=r,n[e++]=t,n[e++]=r+o,n[e++]=t+i,n[e++]=r+o}function RWt(n,e,t){const r=nM;t=Math.min(t,Math.min(e.w,e.h)/2);const i=xn.ExpandBy(e,-t);if(i.w<=0||i.h<=0)return Nw(n,{center:e.center,radius:t,numArcSegments:nM*4}),nM*4*6;let o=0;return Fw(n,o,i.minX,i.minY,i.w,i.h),o+=12,Fw(n,o,i.minX,e.minY,i.w,t),o+=12,Fw(n,o,i.maxX,i.minY,t,i.h),o+=12,Fw(n,o,i.minX,i.maxY,i.w,t),o+=12,Fw(n,o,e.minX,i.minY,t,i.h),o+=12,Nw(n,{numArcSegments:r,offset:o,center:i.point,radius:t,startAngle:Ai,endAngle:Ai*1.5}),o+=r*6,Nw(n,{numArcSegments:r,offset:o,center:H.Add(i.point,new H(i.w,0)),radius:t,startAngle:Ai*1.5,endAngle:Xi}),o+=r*6,Nw(n,{numArcSegments:r,offset:o,center:H.Add(i.point,i.size),radius:t,startAngle:0,endAngle:Fo}),o+=r*6,Nw(n,{numArcSegments:r,offset:o,center:H.Add(i.point,new H(0,i.h)),radius:t,startAngle:Fo,endAngle:Ai}),x9e}function AWt(n){if(!n)throw new Error("Canvas element not found");const e=n.getContext("webgl2",{premultipliedAlpha:!1});if(!e)throw new Error("Failed to get webgl2 context");const t=`#version 300 es
  precision mediump float;
  
  in vec2 shapeVertexPosition;

	uniform vec4 canvasPageBounds;

	// taken (with thanks) from
	// https://webglfundamentals.org/webgl/lessons/webgl-2d-matrices.html
  void main() {
		// convert the position from pixels to 0.0 to 1.0
		vec2 zeroToOne = (shapeVertexPosition - canvasPageBounds.xy) / canvasPageBounds.zw;
	
		// convert from 0->1 to 0->2
		vec2 zeroToTwo = zeroToOne * 2.0;
	
		// convert from 0->2 to -1->+1 (clipspace)
		vec2 clipSpace = zeroToTwo - 1.0;
	
		gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);
  }`,r=e.createShader(e.VERTEX_SHADER);if(!r)throw new Error("Failed to create vertex shader");if(e.shaderSource(r,t),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS))throw new Error("Failed to compile vertex shader");const i=`#version 300 es
  precision mediump float;
  
	uniform vec4 fillColor;
  out vec4 outputColor;

  void main() {
	outputColor = fillColor;
  }`,o=e.createShader(e.FRAGMENT_SHADER);if(!o)throw new Error("Failed to create fragment shader");if(e.shaderSource(o,i),e.compileShader(o),!e.getShaderParameter(o,e.COMPILE_STATUS))throw new Error("Failed to compile fragment shader");const s=e.createProgram();if(!s)throw new Error("Failed to create program");if(e.attachShader(s,r),e.attachShader(s,o),e.linkProgram(s),!e.getProgramParameter(s,e.LINK_STATUS))throw new Error("Failed to link program");e.useProgram(s);const a=e.getAttribLocation(s,"shapeVertexPosition");if(a<0)throw new Error("Failed to get shapeVertexPosition attribute location");e.enableVertexAttribArray(a);const c=e.getUniformLocation(s,"canvasPageBounds"),l=e.getUniformLocation(s,"fillColor");if(!e.createBuffer())throw new Error("Failed to create buffer");if(!e.createBuffer())throw new Error("Failed to create buffer");return{context:e,selectedShapes:kA(e,1024),unselectedShapes:kA(e,4096),viewport:kA(e,x9e),collaborators:kA(e,1024),prepareTriangles(h,f){e.bindBuffer(e.ARRAY_BUFFER,h.buffer),e.bufferData(e.ARRAY_BUFFER,h.vertices,e.STATIC_DRAW,0,f),e.enableVertexAttribArray(a),e.vertexAttribPointer(a,2,e.FLOAT,!1,0,0)},drawTrianglesTransparently(h){e.enable(e.BLEND),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),e.drawArrays(e.TRIANGLES,0,h/2),e.disable(e.BLEND)},drawTriangles(h){e.drawArrays(e.TRIANGLES,0,h/2)},setFillColor(h){e.uniform4fv(l,h)},setCanvasPageBounds(h){e.uniform4fv(c,h)}}}function kA(n,e){const t=n.createBuffer();if(!t)throw new Error("Failed to create buffer");return{buffer:t,vertices:new Float32Array(e)}}function eSe(n,e,t){let r=n.vertices.length;for(;r<e+t.length;)r*=2;if(r!=n.vertices.length){const i=new Float32Array(r);i.set(n.vertices),n.vertices=i}n.vertices.set(t,e)}var OWt=Object.defineProperty,MWt=Object.getOwnPropertyDescriptor,tb=(n,e,t,r)=>{for(var i=MWt(e,t),o=n.length-1,s;o>=0;o--)(s=n[o])&&(i=s(e,t,i)||i);return i&&OWt(e,t,i),i};class kv{constructor(e,t,r){$(this,"disposables",[]);$(this,"close",()=>this.disposables.forEach(e=>e()));$(this,"gl");$(this,"shapeGeometryCache");$(this,"colors");$(this,"id",us());$(this,"canvasBoundingClientRect",lc("canvasBoundingClientRect",new xn));$(this,"originPagePoint",new H);$(this,"originPageCenter",new H);$(this,"isInViewport",!1);$(this,"getMinimapPagePoint",(e,t)=>{const r=this.getCanvasPageBounds(),i=this.getCanvasScreenBounds();let o=e-i.x,s=t-i.y;return o*=r.width/i.width,s*=r.height/i.height,o+=r.minX,s+=r.minY,new H(o,s,1)});$(this,"minimapScreenPointToPagePoint",(e,t,r=!1,i=!1)=>{const{editor:o}=this,s=o.getViewportPageBounds();let{x:a,y:c}=this.getMinimapPagePoint(e,t);if(i){const l=this.editor.getCurrentPageBounds()??new xn,u=l.minX-s.width/2,d=l.maxX+s.width/2,h=l.minY-s.height/2,f=l.maxY+s.height/2,p=Math.max(0,u+s.width-a),g=Math.max(0,-(d-s.width-a)),m=Math.max(0,h+s.height-c),v=Math.max(0,-(f-s.height-c));a+=(p-g)/2,c+=(m-v)/2,a=Ja(a,u,d),c=Ja(c,h,f)}if(r){const{originPagePoint:l}=this,u=Math.abs(a-l.x),d=Math.abs(c-l.y);u>d?c=l.y:a=l.x}return new H(a,c)});$(this,"render",()=>{const e=this.gl.context,t=this.getCanvasSize();this.gl.setCanvasPageBounds(this.getCanvasPageBoundsArray()),this.elem.width=t.x,this.elem.height=t.y,e.viewport(0,0,t.x,t.y),e.clearColor(this.colors.background[0],this.colors.background[1],this.colors.background[2],1),e.clear(e.COLOR_BUFFER_BIT);const r=new Set(this.editor.getSelectedShapeIds()),i=this.colors;let o=0,s=0;const a=this.editor.getCurrentPageShapeIdsSorted();for(let c=0,l=a.length;c<l;c++){const u=a[c],d=this.shapeGeometryCache.get(u);if(!d)continue;const h=d.length;r.has(u)?(eSe(this.gl.selectedShapes,o,d),o+=h):(eSe(this.gl.unselectedShapes,s,d),s+=h)}this.drawShapes(this.gl.unselectedShapes,s,i.shapeFill),this.drawShapes(this.gl.selectedShapes,o,i.selectFill),this.drawViewport(),this.drawCollaborators()});this.editor=e,this.elem=t,this.container=r,this.gl=AWt(t),this.shapeGeometryCache=e.store.createComputedCache("webgl-geometry",i=>{const o=e.getShapeMaskedPageBounds(i.id);if(!o)return null;const s=new Float32Array(12);return Fw(s,0,o.x,o.y,o.w,o.h),s}),this.colors=this._getColors(),this.disposables.push(this._listenForCanvasResize(),Zy("minimap render",this.render))}_getColors(){const e=getComputedStyle(this.editor.getContainer());return{shapeFill:PI(e.getPropertyValue("--color-text-3").trim()),selectFill:PI(e.getPropertyValue("--color-selected").trim()),viewportFill:PI(e.getPropertyValue("--color-muted-1").trim()),background:PI(e.getPropertyValue("--color-low").trim())}}updateColors(){this.colors=this._getColors()}getDpr(){return this.editor.getInstanceState().devicePixelRatio}getContentPageBounds(){const e=this.editor.getViewportPageBounds(),t=this.editor.getCurrentPageBounds();return t?xn.Expand(t,e):e}getContentScreenBounds(){const e=this.getContentPageBounds(),t=this.editor.pageToScreen(e.point),r=this.editor.pageToScreen(new H(e.maxX,e.maxY));return new xn(t.x,t.y,r.x-t.x,r.y-t.y)}_getCanvasBoundingRect(){const{x:e,y:t,width:r,height:i}=this.elem.getBoundingClientRect();return new xn(e,t,r,i)}getCanvasScreenBounds(){return this.canvasBoundingClientRect.get()}_listenForCanvasResize(){const e=new ResizeObserver(()=>{const t=this._getCanvasBoundingRect();this.canvasBoundingClientRect.set(t)});return e.observe(this.elem),e.observe(this.container),()=>e.disconnect()}getCanvasSize(){const e=this.canvasBoundingClientRect.get(),t=this.getDpr();return new H(e.width*t,e.height*t)}getCanvasClientPosition(){return this.canvasBoundingClientRect.get().point}getCanvasPageBounds(){const e=this.getCanvasScreenBounds(),t=this.getContentPageBounds(),r=e.width/e.height;let i=t.width,o=i/r;o<t.height&&(o=t.height,i=o*r);const s=new xn(0,0,i,o);return s.center=t.center,s}getZoom(){return this.getCanvasPageBounds().width/this.getCanvasScreenBounds().width}getCanvasPageBoundsArray(){const{x:e,y:t,w:r,h:i}=this.getCanvasPageBounds();return new Float32Array([e,t,r,i])}drawShapes(e,t,r){this.gl.prepareTriangles(e,t),this.gl.setFillColor(r),this.gl.drawTriangles(t)}drawViewport(){const e=this.editor.getViewportPageBounds(),t=RWt(this.gl.viewport.vertices,e,4*this.getZoom());this.gl.prepareTriangles(this.gl.viewport,t),this.gl.setFillColor(this.colors.viewportFill),this.gl.drawTrianglesTransparently(t),this.editor.environment.isSafari&&(this.gl.drawTrianglesTransparently(t),this.gl.drawTrianglesTransparently(t),this.gl.drawTrianglesTransparently(t))}drawCollaborators(){const e=this.editor.getCollaboratorsOnCurrentPage();if(!e.length)return;const t=20,r=t*6,i=r*e.length;this.gl.collaborators.vertices.length<i&&(this.gl.collaborators.vertices=new Float32Array(i));const o=this.gl.collaborators.vertices;let s=0;const a=this.getZoom();for(const{cursor:c}of e)Nw(o,{center:H.From(c),radius:3*a,offset:s,numArcSegments:t}),s+=r;this.gl.prepareTriangles(this.gl.collaborators,i),s=0;for(const{color:c}of e)this.gl.setFillColor(PI(c)),this.gl.context.drawArrays(this.gl.context.TRIANGLES,s/2,r/2),s+=r}}tb([Et],kv.prototype,"getDpr");tb([Et],kv.prototype,"getContentPageBounds");tb([Et],kv.prototype,"getContentScreenBounds");tb([Et],kv.prototype,"getCanvasSize");tb([Et],kv.prototype,"getCanvasClientPosition");tb([Et],kv.prototype,"getCanvasPageBounds");tb([Et],kv.prototype,"getZoom");tb([Et],kv.prototype,"getCanvasPageBoundsArray");function $Wt(){const n=ot(),e=Il(),t=y.useRef(null),r=y.useRef(!1),i=y.useRef();y.useEffect(()=>{try{const u=new kv(n,t.current,e);return i.current=u,i.current.close}catch(u){n.annotateError(u,{origin:"minimap",willCrashApp:!1}),n.timers.setTimeout(()=>{throw u})}},[n,e]);const o=y.useCallback(u=>{if(!n.getCurrentPageShapeIds().size||!i.current)return;const d=i.current.minimapScreenPointToPagePoint(u.clientX,u.clientY,!1,!1),h=i.current.minimapScreenPointToPagePoint(u.clientX,u.clientY,!1,!0);i.current.originPagePoint.setTo(h),i.current.originPageCenter.setTo(n.getViewportPageBounds().center),n.centerOnPoint(d,{animation:{duration:n.options.animationMediumMs}})},[n]),s=y.useCallback(u=>{if(!i.current)return;const d=u.currentTarget;if(AD(d,u),!n.getCurrentPageShapeIds().size)return;r.current=!0,i.current.isInViewport=!1;const h=i.current.minimapScreenPointToPagePoint(u.clientX,u.clientY,!1,!1),f=n.getViewportPageBounds(),p=i.current.getContentPageBounds();if(new xn(p.x-f.width/2,p.y-f.height/2,p.width+f.width,p.height+f.height).containsPoint(h)&&!f.containsPoint(h)){i.current.isInViewport=f.containsPoint(h);const v=H.Sub(f.center,f.point),b=H.Add(h,v);i.current.originPagePoint.setTo(b),i.current.originPageCenter.setTo(h),n.centerOnPoint(h,{animation:{duration:n.options.animationMediumMs}})}else{const v=i.current.minimapScreenPointToPagePoint(u.clientX,u.clientY,!1,!0);i.current.isInViewport=f.containsPoint(v),i.current.originPagePoint.setTo(v),i.current.originPageCenter.setTo(f.center)}function m(v){d&&OD(d,v),r.current=!1,document.body.removeEventListener("pointerup",m)}document.body.addEventListener("pointerup",m)},[n]),a=y.useCallback(u=>{if(!i.current)return;const d=i.current.minimapScreenPointToPagePoint(u.clientX,u.clientY,u.shiftKey,!0);if(r.current){if(i.current.isInViewport){const g=i.current.originPagePoint.clone().sub(i.current.originPageCenter);n.centerOnPoint(H.Sub(d,g));return}n.centerOnPoint(d)}const h=i.current.getMinimapPagePoint(u.clientX,u.clientY),f=n.pageToScreen(h),p={type:"pointer",target:"canvas",name:"pointer_move",...Bu(u),point:f,isPen:n.getInstanceState().isPenMode};n.dispatch(p)},[n]),c=y.useCallback(u=>{const d=r$e(u);n.dispatch({type:"wheel",name:"wheel",delta:d,point:new H(u.clientX,u.clientY),shiftKey:u.shiftKey,altKey:u.altKey,ctrlKey:u.metaKey||u.ctrlKey})},[n]),l=FD();return y.useEffect(()=>{n.timers.setTimeout(()=>{var u,d;(u=i.current)==null||u.updateColors(),(d=i.current)==null||d.render()})},[l,n]),x.jsx("div",{className:"tlui-minimap",children:x.jsx("canvas",{role:"img","aria-label":"minimap",ref:t,className:"tlui-minimap__canvas",onDoubleClick:o,onPointerMove:a,onPointerDown:s,onWheel:c})})}function LWt(n,e){const[t,r]=Ke.useState(e);Ke.useLayoutEffect(()=>{const o=Xre(n);if(o)try{r(JSON.parse(o))}catch{console.error(`Could not restore value ${n} from local storage.`)}},[n]);const i=Ke.useCallback(o=>{r(s=>{const a=typeof o=="function"?o(s):o;return Yre(n,JSON.stringify(a)),a})},[n]);return[t,i]}const NWt=y.memo(function(){const e=Hn(),t=Ni(),r=Ju(),[i,o]=LWt("minimap",!0),s=y.useCallback(()=>{o(l=>!l)},[o]),{ZoomMenu:a,Minimap:c}=nb();return r<Hs.MOBILE?null:x.jsxs("div",{className:"tlui-navigation-panel",children:[x.jsx("div",{className:"tlui-buttons__horizontal",children:a&&r<Hs.TABLET?x.jsx(a,{}):i?x.jsxs(x.Fragment,{children:[a&&x.jsx(a,{}),c&&x.jsx(dr,{type:"icon","data-testid":"minimap.toggle-button",title:t("navigation-zone.toggle-minimap"),className:"tlui-navigation-panel__toggle",onClick:s,children:x.jsx(Ci,{icon:i?"chevrons-ne":"chevrons-sw"})})]}):x.jsxs(x.Fragment,{children:[x.jsx(dr,{type:"icon","data-testid":"minimap.zoom-out",title:`${t(K3(e["zoom-out"].label))} ${$X(e["zoom-out"].kbd)}`,onClick:()=>e["zoom-out"].onSelect("navigation-zone"),children:x.jsx(Ci,{icon:"minus"})}),a&&x.jsx(a,{}),x.jsx(dr,{type:"icon","data-testid":"minimap.zoom-in",title:`${t(K3(e["zoom-in"].label))} ${$X(e["zoom-in"].kbd)}`,onClick:()=>e["zoom-in"].onSelect("navigation-zone"),children:x.jsx(Ci,{icon:"plus"})}),c&&x.jsx(dr,{type:"icon","data-testid":"minimap.toggle-button",title:t("navigation-zone.toggle-minimap"),className:"tlui-navigation-panel__toggle",onClick:s,children:x.jsx(Ci,{icon:i?"chevrons-ne":"chevrons-sw"})})]})}),c&&r>=Hs.TABLET&&!i&&x.jsx(c,{})]})}),FWt=function({name:e,id:t,isCurrentPage:r}){const i=ot(),o=y.useRef(null),s=y.useCallback(()=>{i.mark("rename page")},[i]),a=y.useCallback(c=>{i.renamePage(t,c||"New Page")},[i,t]);return x.jsx(noe,{className:"tlui-page-menu__item__input",ref:c=>o.current=c,defaultValue:e,onValueChange:a,onFocus:s,shouldManuallyMaintainScrollPositionWhenFocused:!0,autoFocus:r,autoSelect:!0})},NX=(n,e,t,r)=>{let i;const o=n.getPages(),s=t>r?o[r-1]:o[r],a=t>r?o[r]:o[r+1];s&&!a?i=Om(s.index):!s&&a?i=s4t(o[0].index):i=F3(s.index,a.index),i!==o[t].index&&(n.mark("moving page"),n.updatePage({id:e,index:i}))},tSe=Zd(function({index:e,listSize:t,item:r,onRename:i}){const o=ot(),s=Ni(),a=o.getPages(),c=y.useCallback(()=>{o.mark("creating page");const h=dv.createId();o.duplicatePage(r.id,h)},[o,r]),l=y.useCallback(()=>{NX(o,r.id,e,e-1)},[o,r,e]),u=y.useCallback(()=>{NX(o,r.id,e,e+1)},[o,r,e]),d=y.useCallback(()=>{o.mark("deleting page"),o.deletePage(r.id)},[o,r]);return x.jsxs(XS,{id:`page item submenu ${e}`,children:[x.jsx(YS,{children:x.jsx(dr,{type:"icon",title:s("page-menu.submenu.title"),children:x.jsx(Ci,{icon:"dots-vertical"})})}),x.jsx(JS,{alignOffset:0,side:"right",sideOffset:-4,children:x.jsxs(zh,{type:"menu",sourceId:"page-menu",children:[x.jsxs(Vr,{id:"modify",children:[i&&x.jsx(ut,{id:"rename",label:"page-menu.submenu.rename",onSelect:i}),x.jsx(ut,{id:"duplicate",label:"page-menu.submenu.duplicate-page",onSelect:c,disabled:a.length>=o.options.maxPages}),e>0&&x.jsx(ut,{id:"move-up",onSelect:l,label:"page-menu.submenu.move-up"}),e<t-1&&x.jsx(ut,{id:"move-down",label:"page-menu.submenu.move-down",onSelect:u})]}),t>1&&x.jsx(Vr,{id:"delete",children:x.jsx(ut,{id:"delete",onSelect:d,label:"page-menu.submenu.delete"})})]})})]})}),jWt=y.memo(function(){const e=ot(),t=Ni(),r=Ju(),i=y.useCallback(()=>m(!1),[]),[o,s]=Qy("page-menu",i),a=36,c=y.useRef(null),l=_t("pages",()=>e.getPages(),[e]),u=_t("currentPage",()=>e.getCurrentPage(),[e]),d=_t("currentPageId",()=>e.getCurrentPageId(),[e]),h=Ev(),f=_t("maxPageCountReached",()=>e.getPages().length>=e.options.maxPages,[e]),p=_t("isCoarsePointer",()=>e.getInstanceState().isCoarsePointer,[e]),[g,m]=y.useState(!1),v=y.useCallback(()=>{h||m(O=>!O)},[h]),b=y.useRef({isPointing:!1,status:"idle",pointing:null,startY:0,startIndex:0,dragIndex:0}),[S,E]=y.useState(Object.fromEntries(l.map((O,M)=>[O.id,{y:M*a,offsetY:0,isSelected:!1}])));y.useLayoutEffect(()=>{E(Object.fromEntries(l.map((O,M)=>[O.id,{y:M*a,offsetY:0,isSelected:!1}])))},[a,l]),y.useEffect(()=>{o&&e.timers.requestAnimationFrame(()=>{const O=document.querySelector(`[data-testid="page-menu-item-${d}"]`);if(O){const M=c.current;if(!M)return;const R=O.offsetTop,A=M.scrollTop;R<A&&M.scrollTo({top:R});const k=R+a,L=M.scrollTop+M.offsetHeight;k>L&&M.scrollTo({top:k-M.offsetHeight})}})},[a,d,o,e]);const w=y.useCallback(O=>{const{clientY:M,currentTarget:R}=O,{dataset:{id:A,index:k}}=R;if(!A||!k)return;const L=b.current;AD(O.currentTarget,O),L.status="pointing",L.pointing={id:A,index:+k};const N=S[A].y;L.startY=M,L.startIndex=Math.max(0,Math.min(Math.round(N/a),l.length-1))},[a,l.length,S]),C=y.useCallback(O=>{const M=b.current;if(M.status==="pointing"){const{clientY:R}=O,A=R-M.startY;Math.abs(A)>5&&(M.status="dragging")}if(M.status==="dragging"){const{clientY:R}=O,A=R-M.startY,k=S[M.pointing.id],{startIndex:L,pointing:j}=M,N=k.y+A,B=Math.max(0,Math.min(Math.round(N/a),l.length-1)),U={...S};if(U[j.id]={y:k.y,offsetY:A,isSelected:!0},B!==M.dragIndex){M.dragIndex=B;for(let K=0;K<l.length;K++){const z=l[K];if(z.id===M.pointing.id)continue;let{y:G}=U[z.id];B===L?G=K*a:B<L?B<=K&&K<L?G=(K+1)*a:G=K*a:B>L&&(B>=K&&K>L?G=(K-1)*a:G=K*a),G!==U[z.id].y&&(U[z.id]={y:G,offsetY:0,isSelected:!0})}}E(U)}},[a,l,S]),I=y.useCallback(O=>{const M=b.current;if(M.status==="dragging"){const{id:R,index:A}=M.pointing;NX(e,R,A,M.dragIndex)}OD(O.currentTarget,O),M.status="idle"},[e]),T=y.useCallback(O=>{const M=b.current;O.key==="Escape"&&(M.status==="dragging"&&E(Object.fromEntries(l.map((R,A)=>[R.id,{y:A*a,offsetY:0,isSelected:!1}]))),M.status="idle")},[a,l]),D=y.useCallback(()=>{h||e.batch(()=>{e.mark("creating page");const O=dv.createId();e.createPage({name:t("page-menu.new-page-initial-name"),id:O}),e.setCurrentPage(O),m(!0)})},[e,t,h]);return x.jsxs(voe,{id:"pages",onOpenChange:s,open:o,children:[x.jsx(yoe,{"data-testid":"main.page-menu",children:x.jsxs(dr,{type:"menu",title:u.name,"data-testid":"page-menu.button",className:"tlui-page-menu__trigger",children:[x.jsx("div",{className:"tlui-page-menu__name",children:u.name}),x.jsx(Ci,{icon:"chevron-down",small:!0})]})}),x.jsx(boe,{side:"bottom",align:"start",sideOffset:6,children:x.jsxs("div",{className:"tlui-page-menu__wrapper",children:[x.jsxs("div",{className:"tlui-page-menu__header",children:[x.jsx("div",{className:"tlui-page-menu__header__title",children:t("page-menu.title")}),!h&&x.jsxs("div",{className:"tlui-buttons__horizontal",children:[x.jsx(dr,{type:"icon","data-testid":"page-menu.edit",title:t(g?"page-menu.edit-done":"page-menu.edit-start"),onClick:v,children:x.jsx(Ci,{icon:g?"check":"edit"})}),x.jsx(dr,{type:"icon","data-testid":"page-menu.create",title:t(f?"page-menu.max-page-count-reached":"page-menu.create-new-page"),disabled:f,onClick:D,children:x.jsx(Ci,{icon:"plus"})})]})]}),x.jsx("div",{"data-testid":"page-menu.list",className:"tlui-page-menu__list tlui-menu__group",style:{height:a*l.length+4},ref:c,children:l.map((O,M)=>{const R=S[O.id]??{position:M*40,offsetY:0};return g?x.jsxs("div",{"data-testid":"page-menu.item",className:"tlui-page_menu__item__sortable",style:{zIndex:O.id===u.id?888:M,transform:`translate(0px, ${R.y+R.offsetY}px)`},children:[x.jsx(dr,{type:"icon",tabIndex:-1,className:"tlui-page_menu__item__sortable__handle",onPointerDown:w,onPointerUp:I,onPointerMove:C,onKeyDown:T,"data-id":O.id,"data-index":M,children:x.jsx(Ci,{icon:"drag-handle-dots"})}),r<Hs.TABLET_SM&&p?x.jsxs(dr,{type:"normal",className:"tlui-page-menu__item__button",onClick:()=>{const A=window.prompt("Rename page",O.name);A&&A!==O.name&&e.renamePage(O.id,A)},onDoubleClick:v,children:[x.jsx(LX,{checked:O.id===u.id}),x.jsx(ia,{children:O.name})]}):x.jsx("div",{className:"tlui-page_menu__item__sortable__title",style:{height:a},children:x.jsx(FWt,{id:O.id,name:O.name,isCurrentPage:O.id===u.id})}),!h&&x.jsx("div",{className:"tlui-page_menu__item__submenu","data-isediting":g,children:x.jsx(tSe,{index:M,item:O,listSize:l.length})})]},O.id+"_editing"):x.jsxs("div",{"data-testid":"page-menu.item",className:"tlui-page-menu__item",children:[x.jsxs(dr,{type:"normal",className:"tlui-page-menu__item__button",onClick:()=>e.setCurrentPage(O.id),onDoubleClick:v,title:t("page-menu.go-to-page"),children:[x.jsx(LX,{checked:O.id===u.id}),x.jsx(ia,{children:O.name})]}),!h&&x.jsx("div",{className:"tlui-page_menu__item__submenu",children:x.jsx(tSe,{index:M,item:O,listSize:l.length,onRename:()=>{if(e.environment.isIos){const A=window.prompt("Rename page",O.name);A&&A!==O.name&&e.renamePage(O.id,A)}else e.batch(()=>{m(!0),e.setCurrentPage(O.id)})}})})]},O.id)})})]})})]})});function BWt(){const n=Hn(),e=ot(),t=HNe(),r=BNe(),i=cu(1),o=Ev(),s=_t("should display quick actions",()=>e.isInAny("select","hand","zoom"),[e]),a=Pv(),c=i&&a;if(!(o&&!s))return x.jsxs(x.Fragment,{children:[x.jsx(ut,{...n.undo,disabled:!t}),x.jsx(ut,{...n.redo,disabled:!r}),x.jsx(ut,{...n.delete,disabled:!c}),x.jsx(ut,{...n.duplicate,disabled:!c})]})}const HWt=y.memo(function({children:e}){const t=e??x.jsx(BWt,{});return x.jsx(zh,{type:"small-icons",sourceId:"quick-actions",children:t})}),UWt=Object.freeze([qd,US,zS,bg]);function E9e(n=UWt){const e=ot();return _t("getRelevantStyles",()=>{var o;const t=new aX(e.getSharedStyles()),r=!!((o=e.root.getCurrent())!=null&&o.shapeType),i=e.isIn("select")&&e.getSelectedShapeIds().length>0;if(t.size===0&&e.isIn("select")&&e.getSelectedShapeIds().length===0)for(const s of n)t.applyValue(s,e.getStyleForNextShape(s));return r||i||t.size>0?t:null},[e])}const Mh={color:[{value:"black",icon:"color"},{value:"grey",icon:"color"},{value:"light-violet",icon:"color"},{value:"violet",icon:"color"},{value:"blue",icon:"color"},{value:"light-blue",icon:"color"},{value:"yellow",icon:"color"},{value:"orange",icon:"color"},{value:"green",icon:"color"},{value:"light-green",icon:"color"},{value:"light-red",icon:"color"},{value:"red",icon:"color"}],fill:[{value:"none",icon:"fill-none"},{value:"semi",icon:"fill-semi"},{value:"solid",icon:"fill-solid"},{value:"pattern",icon:"fill-pattern"}],dash:[{value:"draw",icon:"dash-draw"},{value:"dashed",icon:"dash-dashed"},{value:"dotted",icon:"dash-dotted"},{value:"solid",icon:"dash-solid"}],size:[{value:"s",icon:"size-small"},{value:"m",icon:"size-medium"},{value:"l",icon:"size-large"},{value:"xl",icon:"size-extra-large"}],font:[{value:"draw",icon:"font-draw"},{value:"sans",icon:"font-sans"},{value:"serif",icon:"font-serif"},{value:"mono",icon:"font-mono"}],textAlign:[{value:"start",icon:"text-align-left"},{value:"middle",icon:"text-align-center"},{value:"end",icon:"text-align-right"}],horizontalAlign:[{value:"start",icon:"horizontal-align-start"},{value:"middle",icon:"horizontal-align-middle"},{value:"end",icon:"horizontal-align-end"}],verticalAlign:[{value:"start",icon:"vertical-align-start"},{value:"middle",icon:"vertical-align-middle"},{value:"end",icon:"vertical-align-end"}],geo:[{value:"rectangle",icon:"geo-rectangle"},{value:"ellipse",icon:"geo-ellipse"},{value:"triangle",icon:"geo-triangle"},{value:"diamond",icon:"geo-diamond"},{value:"star",icon:"geo-star"},{value:"pentagon",icon:"geo-pentagon"},{value:"hexagon",icon:"geo-hexagon"},{value:"octagon",icon:"geo-octagon"},{value:"rhombus",icon:"geo-rhombus"},{value:"rhombus-2",icon:"geo-rhombus-2"},{value:"oval",icon:"geo-oval"},{value:"trapezoid",icon:"geo-trapezoid"},{value:"arrow-left",icon:"geo-arrow-left"},{value:"arrow-up",icon:"geo-arrow-up"},{value:"arrow-down",icon:"geo-arrow-down"},{value:"arrow-right",icon:"geo-arrow-right"},{value:"cloud",icon:"geo-cloud"},{value:"x-box",icon:"geo-x-box"},{value:"check-box",icon:"geo-check-box"},{value:"heart",icon:"geo-heart"}],arrowheadStart:[{value:"none",icon:"arrowhead-none"},{value:"arrow",icon:"arrowhead-arrow"},{value:"triangle",icon:"arrowhead-triangle"},{value:"square",icon:"arrowhead-square"},{value:"dot",icon:"arrowhead-dot"},{value:"diamond",icon:"arrowhead-diamond"},{value:"inverted",icon:"arrowhead-triangle-inverted"},{value:"bar",icon:"arrowhead-bar"}],arrowheadEnd:[{value:"none",icon:"arrowhead-none"},{value:"arrow",icon:"arrowhead-arrow"},{value:"triangle",icon:"arrowhead-triangle"},{value:"square",icon:"arrowhead-square"},{value:"dot",icon:"arrowhead-dot"},{value:"diamond",icon:"arrowhead-diamond"},{value:"inverted",icon:"arrowhead-triangle-inverted"},{value:"bar",icon:"arrowhead-bar"}],spline:[{value:"line",icon:"spline-line"},{value:"cubic",icon:"spline-cubic"}]},$1=y.memo(function(e){const{uiType:t,items:r,title:i,style:o,value:s,onValueChange:a,theme:c}=e,l=ot(),u=Ni(),d=y.useRef(!1),h=y.useRef(null),{handleButtonClick:f,handleButtonPointerDown:p,handleButtonPointerEnter:g,handleButtonPointerUp:m}=y.useMemo(()=>{const v=()=>{d.current=!1,window.removeEventListener("pointerup",v);const C=h.current;C&&["TEXTAREA","INPUT"].includes(C.nodeName)&&C.focus(),h.current=null};return{handleButtonClick:C=>{const{id:I}=C.currentTarget.dataset;s.type==="shared"&&s.value===I||(l.mark("point picker item"),a(o,I))},handleButtonPointerDown:C=>{const{id:I}=C.currentTarget.dataset;l.mark("point picker item"),a(o,I),d.current=!0,h.current=document.activeElement,window.addEventListener("pointerup",v)},handleButtonPointerEnter:C=>{if(!d.current)return;const{id:I}=C.currentTarget.dataset;a(o,I)},handleButtonPointerUp:C=>{const{id:I}=C.currentTarget.dataset;s.type==="shared"&&s.value===I||a(o,I)}}},[s,l,a,o]);return x.jsx("div",{"data-testid":`style.${t}`,className:Ue("tlui-buttons__grid"),children:r.map(v=>x.jsx(dr,{type:"icon","data-id":v.value,"data-testid":`style.${t}.${v.value}`,"aria-label":v.value,"data-state":s.type==="shared"&&s.value===v.value?"hinted":void 0,title:i+" — "+u(`${t}-style.${v.value}`),className:Ue("tlui-button-grid__button"),style:o===qd?{color:c[v.value].solid}:void 0,onPointerEnter:g,onPointerDown:p,onPointerUp:m,onClick:f,children:x.jsx(Ci,{icon:v.icon})},v.value))})});function I9e(n,[e,t]){return Math.min(t,Math.max(e,n))}function zWt(n){const e=y.useRef({value:n,previous:n});return y.useMemo(()=>(e.current.value!==n&&(e.current.previous=e.current.value,e.current.value=n),e.current.previous),[n])}var P9e=["PageUp","PageDown"],k9e=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],T9e={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},SE="Slider",[FX,VWt,WWt]=WN(SE),[D9e,Wln]=Lg(SE,[WWt]),[qWt,oF]=D9e(SE),R9e=y.forwardRef((n,e)=>{const{name:t,min:r=0,max:i=100,step:o=1,orientation:s="horizontal",disabled:a=!1,minStepsBetweenThumbs:c=0,defaultValue:l=[r],value:u,onValueChange:d=()=>{},onValueCommit:h=()=>{},inverted:f=!1,...p}=n,g=y.useRef(new Set),m=y.useRef(0),b=s==="horizontal"?KWt:GWt,[S=[],E]=Yy({prop:u,defaultProp:l,onChange:O=>{var R;(R=[...g.current][m.current])==null||R.focus(),d(O)}}),w=y.useRef(S);function C(O){const M=QWt(S,O);D(O,M)}function I(O){D(O,m.current)}function T(){const O=w.current[m.current];S[m.current]!==O&&h(S)}function D(O,M,{commit:R}={commit:!1}){const A=rqt(o),k=iqt(Math.round((O-r)/o)*o+r,A),L=I9e(k,[r,i]);E((j=[])=>{const N=YWt(j,L,M);if(nqt(N,c*o)){m.current=N.indexOf(L);const B=String(N)!==String(j);return B&&R&&h(N),B?N:j}else return j})}return x.jsx(qWt,{scope:n.__scopeSlider,name:t,disabled:a,min:r,max:i,valueIndexToChangeRef:m,thumbs:g.current,values:S,orientation:s,children:x.jsx(FX.Provider,{scope:n.__scopeSlider,children:x.jsx(FX.Slot,{scope:n.__scopeSlider,children:x.jsx(b,{"aria-disabled":a,"data-disabled":a?"":void 0,...p,ref:e,onPointerDown:Dn(p.onPointerDown,()=>{a||(w.current=S)}),min:r,max:i,inverted:f,onSlideStart:a?void 0:C,onSlideMove:a?void 0:I,onSlideEnd:a?void 0:T,onHomeKeyDown:()=>!a&&D(r,0,{commit:!0}),onEndKeyDown:()=>!a&&D(i,S.length-1,{commit:!0}),onStepKeyDown:({event:O,direction:M})=>{if(!a){const k=P9e.includes(O.key)||O.shiftKey&&k9e.includes(O.key)?10:1,L=m.current,j=S[L],N=o*k*M;D(j+N,L,{commit:!0})}}})})})})});R9e.displayName=SE;var[A9e,O9e]=D9e(SE,{startEdge:"left",endEdge:"right",size:"width",direction:1}),KWt=y.forwardRef((n,e)=>{const{min:t,max:r,dir:i,inverted:o,onSlideStart:s,onSlideMove:a,onSlideEnd:c,onStepKeyDown:l,...u}=n,[d,h]=y.useState(null),f=Vo(e,S=>h(S)),p=y.useRef(),g=Soe(i),m=g==="ltr",v=m&&!o||!m&&o;function b(S){const E=p.current||d.getBoundingClientRect(),w=[0,E.width],I=Loe(w,v?[t,r]:[r,t]);return p.current=E,I(S-E.left)}return x.jsx(A9e,{scope:n.__scopeSlider,startEdge:v?"left":"right",endEdge:v?"right":"left",direction:v?1:-1,size:"width",children:x.jsx(M9e,{dir:g,"data-orientation":"horizontal",...u,ref:f,style:{...u.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:S=>{const E=b(S.clientX);s==null||s(E)},onSlideMove:S=>{const E=b(S.clientX);a==null||a(E)},onSlideEnd:()=>{p.current=void 0,c==null||c()},onStepKeyDown:S=>{const w=T9e[v?"from-left":"from-right"].includes(S.key);l==null||l({event:S,direction:w?-1:1})}})})}),GWt=y.forwardRef((n,e)=>{const{min:t,max:r,inverted:i,onSlideStart:o,onSlideMove:s,onSlideEnd:a,onStepKeyDown:c,...l}=n,u=y.useRef(null),d=Vo(e,u),h=y.useRef(),f=!i;function p(g){const m=h.current||u.current.getBoundingClientRect(),v=[0,m.height],S=Loe(v,f?[r,t]:[t,r]);return h.current=m,S(g-m.top)}return x.jsx(A9e,{scope:n.__scopeSlider,startEdge:f?"bottom":"top",endEdge:f?"top":"bottom",size:"height",direction:f?1:-1,children:x.jsx(M9e,{"data-orientation":"vertical",...l,ref:d,style:{...l.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:g=>{const m=p(g.clientY);o==null||o(m)},onSlideMove:g=>{const m=p(g.clientY);s==null||s(m)},onSlideEnd:()=>{h.current=void 0,a==null||a()},onStepKeyDown:g=>{const v=T9e[f?"from-bottom":"from-top"].includes(g.key);c==null||c({event:g,direction:v?-1:1})}})})}),M9e=y.forwardRef((n,e)=>{const{__scopeSlider:t,onSlideStart:r,onSlideMove:i,onSlideEnd:o,onHomeKeyDown:s,onEndKeyDown:a,onStepKeyDown:c,...l}=n,u=oF(SE,t);return x.jsx(Pi.span,{...l,ref:e,onKeyDown:Dn(n.onKeyDown,d=>{d.key==="Home"?(s(d),d.preventDefault()):d.key==="End"?(a(d),d.preventDefault()):P9e.concat(k9e).includes(d.key)&&(c(d),d.preventDefault())}),onPointerDown:Dn(n.onPointerDown,d=>{const h=d.target;h.setPointerCapture(d.pointerId),d.preventDefault(),u.thumbs.has(h)?h.focus():r(d)}),onPointerMove:Dn(n.onPointerMove,d=>{d.target.hasPointerCapture(d.pointerId)&&i(d)}),onPointerUp:Dn(n.onPointerUp,d=>{const h=d.target;h.hasPointerCapture(d.pointerId)&&(h.releasePointerCapture(d.pointerId),o(d))})})}),$9e="SliderTrack",L9e=y.forwardRef((n,e)=>{const{__scopeSlider:t,...r}=n,i=oF($9e,t);return x.jsx(Pi.span,{"data-disabled":i.disabled?"":void 0,"data-orientation":i.orientation,...r,ref:e})});L9e.displayName=$9e;var jX="SliderRange",N9e=y.forwardRef((n,e)=>{const{__scopeSlider:t,...r}=n,i=oF(jX,t),o=O9e(jX,t),s=y.useRef(null),a=Vo(e,s),c=i.values.length,l=i.values.map(h=>j9e(h,i.min,i.max)),u=c>1?Math.min(...l):0,d=100-Math.max(...l);return x.jsx(Pi.span,{"data-orientation":i.orientation,"data-disabled":i.disabled?"":void 0,...r,ref:a,style:{...n.style,[o.startEdge]:u+"%",[o.endEdge]:d+"%"}})});N9e.displayName=jX;var BX="SliderThumb",F9e=y.forwardRef((n,e)=>{const t=VWt(n.__scopeSlider),[r,i]=y.useState(null),o=Vo(e,a=>i(a)),s=y.useMemo(()=>r?t().findIndex(a=>a.ref.current===r):-1,[t,r]);return x.jsx(ZWt,{...n,ref:o,index:s})}),ZWt=y.forwardRef((n,e)=>{const{__scopeSlider:t,index:r,name:i,...o}=n,s=oF(BX,t),a=O9e(BX,t),[c,l]=y.useState(null),u=Vo(e,b=>l(b)),d=c?!!c.closest("form"):!0,h=fNe(c),f=s.values[r],p=f===void 0?0:j9e(f,s.min,s.max),g=JWt(r,s.values.length),m=h==null?void 0:h[a.size],v=m?eqt(m,p,a.direction):0;return y.useEffect(()=>{if(c)return s.thumbs.add(c),()=>{s.thumbs.delete(c)}},[c,s.thumbs]),x.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[a.startEdge]:`calc(${p}% + ${v}px)`},children:[x.jsx(FX.ItemSlot,{scope:n.__scopeSlider,children:x.jsx(Pi.span,{role:"slider","aria-label":n["aria-label"]||g,"aria-valuemin":s.min,"aria-valuenow":f,"aria-valuemax":s.max,"aria-orientation":s.orientation,"data-orientation":s.orientation,"data-disabled":s.disabled?"":void 0,tabIndex:s.disabled?void 0:0,...o,ref:u,style:f===void 0?{display:"none"}:n.style,onFocus:Dn(n.onFocus,()=>{s.valueIndexToChangeRef.current=r})})}),d&&x.jsx(XWt,{name:i??(s.name?s.name+(s.values.length>1?"[]":""):void 0),value:f},r)]})});F9e.displayName=BX;var XWt=n=>{const{value:e,...t}=n,r=y.useRef(null),i=zWt(e);return y.useEffect(()=>{const o=r.current,s=window.HTMLInputElement.prototype,c=Object.getOwnPropertyDescriptor(s,"value").set;if(i!==e&&c){const l=new Event("input",{bubbles:!0});c.call(o,e),o.dispatchEvent(l)}},[i,e]),x.jsx("input",{style:{display:"none"},...t,ref:r,defaultValue:e})};function YWt(n=[],e,t){const r=[...n];return r[t]=e,r.sort((i,o)=>i-o)}function j9e(n,e,t){const o=100/(t-e)*(n-e);return I9e(o,[0,100])}function JWt(n,e){return e>2?`Value ${n+1} of ${e}`:e===2?["Minimum","Maximum"][n]:void 0}function QWt(n,e){if(n.length===1)return 0;const t=n.map(i=>Math.abs(i-e)),r=Math.min(...t);return t.indexOf(r)}function eqt(n,e,t){const r=n/2,o=Loe([0,50],[0,r]);return(r-o(e)*t)*t}function tqt(n){return n.slice(0,-1).map((e,t)=>n[t+1]-e)}function nqt(n,e){if(e>0){const t=tqt(n);return Math.min(...t)>=e}return!0}function Loe(n,e){return t=>{if(n[0]===n[1]||e[0]===e[1])return e[0];const r=(e[1]-e[0])/(n[1]-n[0]);return e[0]+r*(t-n[0])}}function rqt(n){return(String(n).split(".")[1]||"").length}function iqt(n,e){const t=Math.pow(10,e);return Math.round(n*t)/t}var oqt=R9e,sqt=L9e,aqt=N9e,cqt=F9e;const lqt=y.memo(function(e){const{title:t,steps:r,value:i,label:o,onValueChange:s}=e,a=ot(),c=Ni(),l=y.useCallback(h=>{s(h[0])},[s]),u=y.useCallback(()=>{a.mark("click slider")},[a]),d=y.useCallback(()=>{i&&s(i)},[i,s]);return x.jsx("div",{className:"tlui-slider__container",children:x.jsxs(oqt,{"data-testid":e["data-testid"],className:"tlui-slider","area-label":"Opacity",dir:"ltr",min:0,max:r,step:1,value:i?[i]:void 0,onPointerDown:u,onValueChange:l,onPointerUp:d,title:t+" — "+c(o),children:[x.jsx(sqt,{className:"tlui-slider__track",dir:"ltr",children:i!==null&&x.jsx(aqt,{className:"tlui-slider__range",dir:"ltr"})}),i!==null&&x.jsx(cqt,{className:"tlui-slider__thumb",dir:"ltr"})]})})});function uqt({label:n,uiTypeA:e,uiTypeB:t,labelA:r,labelB:i,itemsA:o,itemsB:s,styleA:a,styleB:c,valueA:l,valueB:u,onValueChange:d}){const h=Ni(),f=y.useMemo(()=>{var g;return((g=o.find(m=>l.type==="shared"&&l.value===m.value))==null?void 0:g.icon)??"mixed"},[o,l]),p=y.useMemo(()=>{var g;return((g=s.find(m=>u.type==="shared"&&u.value===m.value))==null?void 0:g.icon)??"mixed"},[s,u]);return l===void 0&&u===void 0?null:x.jsxs("div",{className:"tlui-style-panel__double-select-picker",children:[x.jsx("div",{title:h(n),className:"tlui-style-panel__double-select-picker-label",children:h(n)}),x.jsxs("div",{className:"tlui-buttons__horizontal",children:[x.jsxs(XS,{id:`style panel ${e} A`,children:[x.jsx(YS,{children:x.jsx(dr,{type:"icon","data-testid":`style.${e}`,title:h(r)+" — "+(l===null||l.type==="mixed"?h("style-panel.mixed"):h(`${e}-style.${l.value}`)),children:x.jsx(Ci,{icon:f,small:!0,invertIcon:!0})})}),x.jsx(JS,{side:"left",align:"center",sideOffset:80,alignOffset:0,children:x.jsx("div",{className:"tlui-buttons__grid",children:o.map((g,m)=>x.jsx(J3,{"data-testid":`style.${e}.${g.value}`,children:x.jsx(dr,{type:"icon",onClick:()=>d(a,g.value),title:`${h(r)} — ${h(`${e}-style.${g.value}`)}`,children:x.jsx(Ci,{icon:g.icon,invertIcon:!0})},g.value)},m))})})]}),x.jsxs(XS,{id:`style panel ${t}`,children:[x.jsx(YS,{children:x.jsx(dr,{type:"icon","data-testid":`style.${t}`,title:h(i)+" — "+(u===null||u.type==="mixed"?h("style-panel.mixed"):h(`${t}-style.${u.value}`)),children:x.jsx(Ci,{icon:p,small:!0})})}),x.jsx(JS,{side:"left",align:"center",sideOffset:116,alignOffset:0,children:x.jsx("div",{className:"tlui-buttons__grid",children:s.map(g=>x.jsx(J3,{children:x.jsx(dr,{type:"icon",title:`${h(i)} — ${h(`${t}-style.${g.value}`)}`,"data-testid":`style.${t}.${g.value}`,onClick:()=>d(c,g.value),children:x.jsx(Ci,{icon:g.icon})})},g.value))})})]})]})]})}const dqt=y.memo(uqt);function hqt({id:n,label:e,uiType:t,style:r,items:i,type:o,value:s,onValueChange:a}){const c=Ni(),l=ot(),u=y.useMemo(()=>{var f;return(f=i.find(p=>s.type==="shared"&&p.value===s.value))==null?void 0:f.icon},[i,s]),d=s.type==="mixed"?c("style-panel.mixed"):c(`${t}-style.${s.value}`),h=e?c(e):"";return x.jsxs(XS,{id:`style panel ${n}`,children:[x.jsx(YS,{children:x.jsxs(dr,{type:o,"data-testid":`style.${t}`,title:d,children:[x.jsx(ia,{children:h}),x.jsx(Ci,{icon:u??"mixed"})]})}),x.jsx(JS,{side:"left",align:"center",alignOffset:0,children:x.jsx("div",{className:"tlui-buttons__grid",children:i.map(f=>x.jsx(J3,{children:x.jsx(dr,{type:"icon","data-testid":`style.${t}.${f.value}`,title:c(`${t}-style.${f.value}`),onClick:()=>{l.mark("select style dropdown item"),a(r,f.value)},children:x.jsx(Ci,{icon:f.icon})})},f.value))})})]})}const Noe=y.memo(hqt);function fqt({styles:n}){const e=FD();if(!n)return null;const t=n.get(jf),r=n.get(r$),i=n.get(n$),o=n.get(s$),s=n.get(yg),a=t===void 0,c=r===void 0&&i===void 0,l=o===void 0,u=s===void 0,d=xv({isDarkMode:e});return x.jsxs(x.Fragment,{children:[x.jsx(pqt,{theme:d,styles:n}),!u&&x.jsx(gqt,{theme:d,styles:n}),!(a&&c&&l)&&x.jsxs("div",{className:"tlui-style-panel__section","aria-label":"style panel styles",children:[x.jsx(mqt,{styles:n}),x.jsx(yqt,{styles:n}),x.jsx(vqt,{styles:n})]})]})}function KD(){const n=ot(),e=lp();return Ke.useMemo(()=>function(r,i){n.batch(()=>{n.isIn("select")&&n.setStyleForSelectedShapes(r,i),n.setStyleForNextShapes(r,i),n.updateInstanceState({isChangingStyle:!0})}),e("set-style",{source:"style-panel",id:r.id,value:i})},[n,e])}function pqt({styles:n,theme:e}){const t=Ni(),r=ot(),i=KD(),o=n.get(qd),s=n.get(zS),a=n.get(US),c=n.get(bg),l=s!==void 0||a!==void 0||c!==void 0;return x.jsxs(x.Fragment,{children:[x.jsxs("div",{tabIndex:-1,className:"tlui-style-panel__section__common","aria-label":"style panel styles","data-testid":"style.panel",children:[o===void 0?null:x.jsx($1,{title:t("style-panel.color"),uiType:"color",style:qd,items:Mh.color,value:o,onValueChange:i,theme:e}),x.jsx(bqt,{})]}),l&&x.jsxs("div",{className:"tlui-style-panel__section","aria-label":"style panel styles",children:[s===void 0?null:x.jsx($1,{title:t("style-panel.fill"),uiType:"fill",style:zS,items:Mh.fill,value:s,onValueChange:i,theme:e}),a===void 0?null:x.jsx($1,{title:t("style-panel.dash"),uiType:"dash",style:US,items:Mh.dash,value:a,onValueChange:i,theme:e}),c===void 0?null:x.jsx($1,{title:t("style-panel.size"),uiType:"size",style:bg,items:Mh.size,value:c,onValueChange:(u,d)=>{i(u,d);const h=r.getSelectedShapeIds();h.length>0&&Ao(r,h)},theme:e})]})]})}function gqt({theme:n,styles:e}){const t=Ni(),r=KD(),i=e.get(yg),o=e.get(tX),s=e.get(i$),a=e.get(o$);return i===void 0&&s===void 0?null:x.jsxs("div",{className:"tlui-style-panel__section","aria-label":"style panel text",children:[i===void 0?null:x.jsx($1,{title:t("style-panel.font"),uiType:"font",style:yg,items:Mh.font,value:i,onValueChange:r,theme:n}),o===void 0?null:x.jsxs("div",{className:"tlui-style-panel__row",children:[x.jsx($1,{title:t("style-panel.align"),uiType:"align",style:tX,items:Mh.textAlign,value:o,onValueChange:r,theme:n}),x.jsx("div",{className:"tlui-style-panel__row__extra-button",children:x.jsx(dr,{type:"icon",title:t("style-panel.vertical-align"),"data-testid":"vertical-align",disabled:!0,children:x.jsx(Ci,{icon:"vertical-align-middle"})})})]}),s===void 0?null:x.jsxs("div",{className:"tlui-style-panel__row",children:[x.jsx($1,{title:t("style-panel.align"),uiType:"align",style:i$,items:Mh.horizontalAlign,value:s,onValueChange:r,theme:n}),x.jsx("div",{className:"tlui-style-panel__row__extra-button",children:a===void 0?x.jsx(dr,{type:"icon",title:t("style-panel.vertical-align"),"data-testid":"vertical-align",disabled:!0,children:x.jsx(Ci,{icon:"vertical-align-middle"})}):x.jsx(Noe,{type:"icon",id:"geo-vertical-alignment",uiType:"verticalAlign",style:o$,items:Mh.verticalAlign,value:a,onValueChange:r})})]})]})}function mqt({styles:n}){const e=KD(),t=n.get(jf);return t===void 0?null:x.jsx(Noe,{id:"geo",type:"menu",label:"style-panel.geo",uiType:"geo",style:jf,items:Mh.geo,value:t,onValueChange:e})}function vqt({styles:n}){const e=KD(),t=n.get(s$);return t===void 0?null:x.jsx(Noe,{id:"spline",type:"menu",label:"style-panel.spline",uiType:"spline",style:s$,items:Mh.spline,value:t,onValueChange:e})}function yqt({styles:n}){const e=KD(),t=n.get(r$),r=n.get(n$);return!t||!r?null:x.jsx(dqt,{label:"style-panel.arrowheads",uiTypeA:"arrowheadStart",styleA:n$,itemsA:Mh.arrowheadStart,valueA:r,uiTypeB:"arrowheadEnd",styleB:r$,itemsB:Mh.arrowheadEnd,valueB:t,onValueChange:e,labelA:"style-panel.arrowhead-start",labelB:"style-panel.arrowhead-end"})}const kI=[.1,.25,.5,.75,1];function bqt(){const n=ot(),e=_t("opacity",()=>n.getSharedOpacity(),[n]),t=lp(),r=Ni(),i=Ke.useCallback(s=>{const a=kI[s];n.batch(()=>{n.isIn("select")&&n.setOpacityForSelectedShapes(a),n.setOpacityForNextShapes(a),n.updateInstanceState({isChangingStyle:!0})}),t("set-style",{source:"style-panel",id:"opacity",value:s})},[n,t]);if(e===void 0)return null;const o=e.type==="mixed"?-1:kI.indexOf(qAt(kI,s=>Math.abs(s-e.value)));return x.jsx(lqt,{"data-testid":"style.opacity",value:o>=0?o:kI.length-1,label:e.type==="mixed"?"style-panel.mixed":`opacity-style.${e.value}`,onValueChange:i,steps:kI.length-1,title:r("style-panel.opacity")})}const Sqt=y.memo(function({isMobile:e,children:t}){const r=ot(),i=E9e(),o=y.useCallback(()=>{e||r.updateInstanceState({isChangingStyle:!1})},[r,e]),s=t??x.jsx(fqt,{styles:i});return x.jsx("div",{className:Ue("tlui-style-panel",{"tlui-style-panel__wrapper":!e}),"data-ismobile":e,onPointerLeave:o,children:s})});function _qt(){const n=ot(),e=Ni(),t=E9e(),r=t==null?void 0:t.get(qd),i=xv({isDarkMode:n.user.getIsDarkMode()}),o=((r==null?void 0:r.type)==="shared"?i[r.value]:i.black).solid,s=_t("disable style panel",()=>n.isInAny("hand","zoom","eraser","laser"),[n]),a=y.useCallback(l=>{l||n.updateInstanceState({isChangingStyle:!1})},[n]),{StylePanel:c}=nb();return c?x.jsxs(voe,{id:"mobile style menu",onOpenChange:a,children:[x.jsx(yoe,{children:x.jsx(dr,{type:"tool","data-testid":"mobile-styles.button",style:{color:s?"var(--color-muted-1)":o},title:e("style-panel.title"),disabled:s,children:x.jsx(Ci,{icon:s?"blob":(r==null?void 0:r.type)==="mixed"?"mixed":"blob"})})}),x.jsx(boe,{side:"top",align:"end",children:c&&x.jsx(c,{isMobile:!0})})]}):null}function B9e(){return x.jsxs(x.Fragment,{children:[x.jsx(Cqt,{}),x.jsx(xqt,{}),x.jsx(Eqt,{}),x.jsx(Iqt,{}),x.jsx(Pqt,{}),x.jsx(kqt,{}),x.jsx(Tqt,{}),x.jsx(Dqt,{}),x.jsx(Rqt,{}),x.jsx(Aqt,{}),x.jsx(Mqt,{}),x.jsx(Oqt,{}),x.jsx(Nqt,{}),x.jsx(Bqt,{}),x.jsx($qt,{}),x.jsx(jqt,{}),x.jsx(Fqt,{}),x.jsx(Lqt,{}),x.jsx(Hqt,{}),x.jsx(Uqt,{}),x.jsx(zqt,{}),x.jsx(Vqt,{}),x.jsx(Wqt,{}),x.jsx(qqt,{}),x.jsx(Kqt,{}),x.jsx(Gqt,{}),x.jsx(Xqt,{}),x.jsx(Zqt,{})]})}function wqt(n){var r;const e=ot(),t=(r=n.meta)==null?void 0:r.geo;return _t("is tool selected",()=>{const i=e.getCurrentToolId(),o=e.getSharedStyles().getAsKnownValue(jf);return t?i==="geo"&&o===t:i===n.id},[e,n.id,t])}function Io({tool:n}){const e=HD(),t=wqt(e[n]);return x.jsx(ut,{...e[n],isSelected:t})}function Cqt(){return x.jsx(Io,{tool:"select"})}function xqt(){return x.jsx(Io,{tool:"hand"})}function Eqt(){return x.jsx(Io,{tool:"draw"})}function Iqt(){return x.jsx(Io,{tool:"eraser"})}function Pqt(){return x.jsx(Io,{tool:"arrow"})}function kqt(){return x.jsx(Io,{tool:"text"})}function Tqt(){return x.jsx(Io,{tool:"note"})}function Dqt(){const n=HD();return x.jsx(ut,{...n.asset})}function Rqt(){return x.jsx(Io,{tool:"rectangle"})}function Aqt(){return x.jsx(Io,{tool:"ellipse"})}function Oqt(){return x.jsx(Io,{tool:"diamond"})}function Mqt(){return x.jsx(Io,{tool:"triangle"})}function $qt(){return x.jsx(Io,{tool:"rhombus"})}function Lqt(){return x.jsx(Io,{tool:"heart"})}function Nqt(){return x.jsx(Io,{tool:"hexagon"})}function Fqt(){return x.jsx(Io,{tool:"cloud"})}function jqt(){return x.jsx(Io,{tool:"star"})}function Bqt(){return x.jsx(Io,{tool:"oval"})}function Hqt(){return x.jsx(Io,{tool:"x-box"})}function Uqt(){return x.jsx(Io,{tool:"check-box"})}function zqt(){return x.jsx(Io,{tool:"arrow-left"})}function Vqt(){return x.jsx(Io,{tool:"arrow-up"})}function Wqt(){return x.jsx(Io,{tool:"arrow-down"})}function qqt(){return x.jsx(Io,{tool:"arrow-right"})}function Kqt(){return x.jsx(Io,{tool:"line"})}function Gqt(){return x.jsx(Io,{tool:"highlight"})}function Zqt(){return x.jsx(Io,{tool:"frame"})}function Xqt(){return x.jsx(Io,{tool:"laser"})}const lz=typeof navigator<"u"?navigator.userAgent.toLowerCase().indexOf("firefox")>0:!1;function uz(n,e,t,r){n.addEventListener?n.addEventListener(e,t,r):n.attachEvent&&n.attachEvent("on".concat(e),t)}function TI(n,e,t,r){n.removeEventListener?n.removeEventListener(e,t,r):n.detachEvent&&n.detachEvent("on".concat(e),t)}function H9e(n,e){const t=e.slice(0,e.length-1);for(let r=0;r<t.length;r++)t[r]=n[t[r].toLowerCase()];return t}function U9e(n){typeof n!="string"&&(n=""),n=n.replace(/\s/g,"");const e=n.split(",");let t=e.lastIndexOf("");for(;t>=0;)e[t-1]+=",",e.splice(t,1),t=e.lastIndexOf("");return e}function Yqt(n,e){const t=n.length>=e.length?n:e,r=n.length>=e.length?e:n;let i=!0;for(let o=0;o<t.length;o++)r.indexOf(t[o])===-1&&(i=!1);return i}const Q3={backspace:8,"⌫":8,tab:9,clear:12,enter:13,"↩":13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,num_0:96,num_1:97,num_2:98,num_3:99,num_4:100,num_5:101,num_6:102,num_7:103,num_8:104,num_9:105,num_multiply:106,num_add:107,num_enter:108,num_subtract:109,num_decimal:110,num_divide:111,"⇪":20,",":188,".":190,"/":191,"`":192,"-":lz?173:189,"=":lz?61:187,";":lz?59:186,"'":222,"[":219,"]":221,"\\":220},Cg={"⇧":16,shift:16,"⌥":18,alt:18,option:18,"⌃":17,ctrl:17,control:17,"⌘":91,cmd:91,command:91},HX={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey",shiftKey:16,ctrlKey:17,altKey:18,metaKey:91},Ac={16:!1,18:!1,17:!1,91:!1},xs={};for(let n=1;n<20;n++)Q3["f".concat(n)]=111+n;let Oo=[],vk=null,z9e="all";const ym=new Map,GD=n=>Q3[n.toLowerCase()]||Cg[n.toLowerCase()]||n.toUpperCase().charCodeAt(0),Jqt=n=>Object.keys(Q3).find(e=>Q3[e]===n),Qqt=n=>Object.keys(Cg).find(e=>Cg[e]===n);function V9e(n){z9e=n||"all"}function eT(){return z9e||"all"}function eKt(){return Oo.slice(0)}function tKt(){return Oo.map(n=>Jqt(n)||Qqt(n)||String.fromCharCode(n))}function nKt(){const n=[];return Object.keys(xs).forEach(e=>{xs[e].forEach(t=>{let{key:r,scope:i,mods:o,shortcut:s}=t;n.push({scope:i,shortcut:s,mods:o,keys:r.split("+").map(a=>GD(a))})})}),n}function rKt(n){const e=n.target||n.srcElement,{tagName:t}=e;let r=!0;const i=t==="INPUT"&&!["checkbox","radio","range","button","file","reset","submit","color"].includes(e.type);return(e.isContentEditable||(i||t==="TEXTAREA"||t==="SELECT")&&!e.readOnly)&&(r=!1),r}function iKt(n){return typeof n=="string"&&(n=GD(n)),Oo.indexOf(n)!==-1}function oKt(n,e){let t,r;n||(n=eT());for(const i in xs)if(Object.prototype.hasOwnProperty.call(xs,i))for(t=xs[i],r=0;r<t.length;)t[r].scope===n?t.splice(r,1).forEach(s=>{let{element:a}=s;return Foe(a)}):r++;eT()===n&&V9e(e||"all")}function sKt(n){let e=n.keyCode||n.which||n.charCode;const t=Oo.indexOf(e);if(t>=0&&Oo.splice(t,1),n.key&&n.key.toLowerCase()==="meta"&&Oo.splice(0,Oo.length),(e===93||e===224)&&(e=91),e in Ac){Ac[e]=!1;for(const r in Cg)Cg[r]===e&&(Hu[r]=!1)}}function W9e(n){if(typeof n>"u")Object.keys(xs).forEach(i=>{Array.isArray(xs[i])&&xs[i].forEach(o=>TA(o)),delete xs[i]}),Foe(null);else if(Array.isArray(n))n.forEach(i=>{i.key&&TA(i)});else if(typeof n=="object")n.key&&TA(n);else if(typeof n=="string"){for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];let[i,o]=t;typeof i=="function"&&(o=i,i=""),TA({key:n,scope:i,method:o,splitKey:"+"})}}const TA=n=>{let{key:e,scope:t,method:r,splitKey:i="+"}=n;U9e(e).forEach(s=>{const a=s.split(i),c=a.length,l=a[c-1],u=l==="*"?"*":GD(l);if(!xs[u])return;t||(t=eT());const d=c>1?H9e(Cg,a):[],h=[];xs[u]=xs[u].filter(f=>{const g=(r?f.method===r:!0)&&f.scope===t&&Yqt(f.mods,d);return g&&h.push(f.element),!g}),h.forEach(f=>Foe(f))})};function nSe(n,e,t,r){if(e.element!==r)return;let i;if(e.scope===t||e.scope==="all"){i=e.mods.length>0;for(const o in Ac)Object.prototype.hasOwnProperty.call(Ac,o)&&(!Ac[o]&&e.mods.indexOf(+o)>-1||Ac[o]&&e.mods.indexOf(+o)===-1)&&(i=!1);(e.mods.length===0&&!Ac[16]&&!Ac[18]&&!Ac[17]&&!Ac[91]||i||e.shortcut==="*")&&(e.keys=[],e.keys=e.keys.concat(Oo),e.method(n,e)===!1&&(n.preventDefault?n.preventDefault():n.returnValue=!1,n.stopPropagation&&n.stopPropagation(),n.cancelBubble&&(n.cancelBubble=!0)))}}function rSe(n,e){const t=xs["*"];let r=n.keyCode||n.which||n.charCode;if(!Hu.filter.call(this,n))return;if((r===93||r===224)&&(r=91),Oo.indexOf(r)===-1&&r!==229&&Oo.push(r),["ctrlKey","altKey","shiftKey","metaKey"].forEach(a=>{const c=HX[a];n[a]&&Oo.indexOf(c)===-1?Oo.push(c):!n[a]&&Oo.indexOf(c)>-1?Oo.splice(Oo.indexOf(c),1):a==="metaKey"&&n[a]&&Oo.length===3&&(n.ctrlKey||n.shiftKey||n.altKey||(Oo=Oo.slice(Oo.indexOf(c))))}),r in Ac){Ac[r]=!0;for(const a in Cg)Cg[a]===r&&(Hu[a]=!0);if(!t)return}for(const a in Ac)Object.prototype.hasOwnProperty.call(Ac,a)&&(Ac[a]=n[HX[a]]);n.getModifierState&&!(n.altKey&&!n.ctrlKey)&&n.getModifierState("AltGraph")&&(Oo.indexOf(17)===-1&&Oo.push(17),Oo.indexOf(18)===-1&&Oo.push(18),Ac[17]=!0,Ac[18]=!0);const i=eT();if(t)for(let a=0;a<t.length;a++)t[a].scope===i&&(n.type==="keydown"&&t[a].keydown||n.type==="keyup"&&t[a].keyup)&&nSe(n,t[a],i,e);if(!(r in xs))return;const o=xs[r],s=o.length;for(let a=0;a<s;a++)if((n.type==="keydown"&&o[a].keydown||n.type==="keyup"&&o[a].keyup)&&o[a].key){const c=o[a],{splitKey:l}=c,u=c.key.split(l),d=[];for(let h=0;h<u.length;h++)d.push(GD(u[h]));d.sort().join("")===Oo.sort().join("")&&nSe(n,c,i,e)}}function Hu(n,e,t){Oo=[];const r=U9e(n);let i=[],o="all",s=document,a=0,c=!1,l=!0,u="+",d=!1,h=!1;for(t===void 0&&typeof e=="function"&&(t=e),Object.prototype.toString.call(e)==="[object Object]"&&(e.scope&&(o=e.scope),e.element&&(s=e.element),e.keyup&&(c=e.keyup),e.keydown!==void 0&&(l=e.keydown),e.capture!==void 0&&(d=e.capture),typeof e.splitKey=="string"&&(u=e.splitKey),e.single===!0&&(h=!0)),typeof e=="string"&&(o=e),h&&W9e(n,o);a<r.length;a++)n=r[a].split(u),i=[],n.length>1&&(i=H9e(Cg,n)),n=n[n.length-1],n=n==="*"?"*":GD(n),n in xs||(xs[n]=[]),xs[n].push({keyup:c,keydown:l,scope:o,mods:i,shortcut:r[a],method:t,key:r[a],splitKey:u,element:s});if(typeof s<"u"&&window){if(!ym.has(s)){const f=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.event;return rSe(g,s)},p=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.event;rSe(g,s),sKt(g)};ym.set(s,{keydownListener:f,keyupListenr:p,capture:d}),uz(s,"keydown",f,d),uz(s,"keyup",p,d)}if(!vk){const f=()=>{Oo=[]};vk={listener:f,capture:d},uz(window,"focus",f,d)}}}function aKt(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"all";Object.keys(xs).forEach(t=>{xs[t].filter(i=>i.scope===e&&i.shortcut===n).forEach(i=>{i&&i.method&&i.method()})})}function Foe(n){const e=Object.values(xs).flat();if(e.findIndex(r=>{let{element:i}=r;return i===n})<0){const{keydownListener:r,keyupListenr:i,capture:o}=ym.get(n)||{};r&&i&&(TI(n,"keyup",i,o),TI(n,"keydown",r,o),ym.delete(n))}if((e.length<=0||ym.size<=0)&&(Object.keys(ym).forEach(i=>{const{keydownListener:o,keyupListenr:s,capture:a}=ym.get(i)||{};o&&s&&(TI(i,"keyup",s,a),TI(i,"keydown",o,a),ym.delete(i))}),ym.clear(),Object.keys(xs).forEach(i=>delete xs[i]),vk)){const{listener:i,capture:o}=vk;TI(window,"focus",i,o),vk=null}}const dz={getPressedKeyString:tKt,setScope:V9e,getScope:eT,deleteScope:oKt,getPressedKeyCodes:eKt,getAllKeyCodes:nKt,isPressed:iKt,filter:rKt,trigger:aKt,unbind:W9e,keyMap:Q3,modifier:Cg,modifierMap:HX};for(const n in dz)Object.prototype.hasOwnProperty.call(dz,n)&&(Hu[n]=dz[n]);if(typeof window<"u"){const n=window.hotkeys;Hu.noConflict=e=>(e&&window.hotkeys===Hu&&(window.hotkeys=n),Hu),window.hotkeys=Hu}const iSe=["copy","cut","paste","asset"];function cKt(){const n=ot(),e=Ev(),t=Hn(),r=HD(),i=_t("is focused",()=>n.getInstanceState().isFocused,[n]);y.useEffect(()=>{if(!i)return;const o=new Array,s=(c,l)=>{Hu(c,{element:document.body},l),o.push(()=>{Hu.unbind(c,l)})},a=(c,l)=>{Hu(c,{element:document.body,keyup:!0,keydown:!1},l),o.push(()=>{Hu.unbind(c,l)})};for(const c of Object.values(t))c.kbd&&(e&&!c.readonlyOk||iSe.includes(c.id)||s(oSe(c.kbd),l=>{_P(n)||(Ri(l),c.onSelect("kbd"))}));for(const c of Object.values(r))!c.kbd||!c.readonlyOk&&n.getInstanceState().isReadonly||iSe.includes(c.id)||s(oSe(c.kbd),l=>{_P(n)||(Ri(l),c.onSelect("kbd"))});return s(",",c=>{if(_P(n)||n.inputs.keys.has("Comma"))return;Ri(c),n.focus(),n.inputs.keys.add("Comma");const{x:l,y:u,z:d}=n.inputs.currentScreenPoint,h={type:"pointer",name:"pointer_down",point:{x:l,y:u,z:d},shiftKey:c.shiftKey,altKey:c.altKey,ctrlKey:c.metaKey||c.ctrlKey,pointerId:0,button:0,isPen:n.getInstanceState().isPenMode,target:"canvas"};n.dispatch(h)}),a(",",c=>{if(_P(n)||!n.inputs.keys.has("Comma"))return;n.inputs.keys.delete("Comma");const{x:l,y:u,z:d}=n.inputs.currentScreenPoint,h={type:"pointer",name:"pointer_up",point:{x:l,y:u,z:d},shiftKey:c.shiftKey,altKey:c.altKey,ctrlKey:c.metaKey||c.ctrlKey,pointerId:0,button:0,isPen:n.getInstanceState().isPenMode,target:"canvas"};n.dispatch(h)}),()=>{o.forEach(c=>c())}},[t,r,e,n,i])}function oSe(n){return lKt(n).map(e=>{let t="";const r=e.split("");return r.length===1?t=r[0]:r[0]==="!"?t=`shift+${r[1]}`:r[0]==="?"?r.length===3&&r[1]==="!"?t=`alt+shift+${r[2]}`:t=`alt+${r[1]}`:r[0]==="$"?r[1]==="!"?t=`cmd+shift+${r[2]},ctrl+shift+${r[2]}`:r[1]==="?"?t=`cmd+⌥+${r[2]},ctrl+alt+${r[2]}`:t=`cmd+${r[1]},ctrl+${r[1]}`:t=e,t}).join(",")}function lKt(n){typeof n!="string"&&(n=""),n=n.replace(/\s/g,"");const e=n.split(",");let t=e.lastIndexOf("");for(;t>=0;)e[t-1]+=",",e.splice(t,1),t=e.lastIndexOf("");return e}function _P(n){return n.getIsMenuOpen()||n.getEditingShapeId()!==null||n.getCrashingError()}const uKt=y.createContext(!1);function dKt({children:n}){const e=ot(),t=OLt(),r=Ju(),i=Ni(),o=Math.min(8,5+r),[s,a]=y.useState(0),c=y.useRef(null),[l,u]=y.useState(null),d=y.useMemo(()=>{const f=l?`:not([data-value="${l}"])`:"";return`
			#${t}_main > *:nth-child(n + ${o+(l?1:2)})${f} {
				display: none;
			}
			#${t}_more > *:nth-child(-n + ${o}) {
				display: none;
			}
        `},[l,t,o]),h=xie(()=>{if(!c.current)return;const f=Array.from(c.current.children);a(f.length),f.findIndex(m=>m.getAttribute("data-value")===l)<=o&&u(null);const g=Array.from(c.current.children).findIndex(m=>m.getAttribute("aria-checked")==="true");g!==-1&&g>=o&&u(f[g].getAttribute("data-value"))});return y.useLayoutEffect(()=>{h()}),y.useLayoutEffect(()=>{if(!c.current)return;const f=new MutationObserver(h);return f.observe(c.current,{childList:!0,subtree:!0,attributeFilter:["data-value","aria-checked"]}),()=>{f.disconnect()}},[h]),y.useEffect(()=>{const f=[["1",0],["2",1],["3",2],["4",3],["5",4],["6",5],["7",6],["8",7],["9",8],["0",9]];for(const[p,g]of f)Hu(p,m=>{var S;if(_P(e))return;Ri(m);const b=Array.from(((S=c.current)==null?void 0:S.children)??[]).filter(E=>!(E instanceof HTMLElement)||E.tagName.toLowerCase()!=="button"?!1:!!(E.offsetWidth||E.offsetHeight))[g];b&&b.click()});return()=>{Hu.unbind("1,2,3,4,5,6,7,8,9,0")}},[e]),x.jsxs(x.Fragment,{children:[x.jsx("style",{children:d}),x.jsxs("div",{className:Ue("tlui-toolbar__tools",{"tlui-toolbar__tools__mobile":r<Hs.TABLET_SM}),role:"radiogroup",children:[x.jsx("div",{id:`${t}_main`,ref:c,className:"tlui-toolbar__tools__list",children:x.jsx(zh,{type:"toolbar",sourceId:"toolbar",children:n})}),s>o+1&&x.jsx(uKt.Provider,{value:!0,children:x.jsxs(XS,{id:"toolbar overflow",modal:!1,children:[x.jsx(YS,{children:x.jsx(dr,{title:i("tool-panel.more"),type:"tool",className:"tlui-toolbar__overflow","data-testid":"tools.more-button",children:x.jsx(Ci,{icon:"chevron-up"})})}),x.jsx(JS,{side:"top",align:"center",children:x.jsx("div",{className:"tlui-buttons__grid","data-testid":"tools.more-content",id:`${t}_more`,children:x.jsx(zh,{type:"toolbar-overflow",sourceId:"toolbar",children:n})})})]})})]})]})}const hKt=["select","hand","draw","eraser","text","zoom","laser","highlight"];function fKt({activeToolId:n}){const e=ot(),t=Ju(),r=Ni(),i=_t("is tool locked",()=>e.getInstanceState().isToolLocked,[e]);return!n||hKt.includes(n)?null:x.jsx(dr,{type:"normal",title:r("action.toggle-tool-lock"),"data-testid":"tool-lock",className:Ue("tlui-toolbar__lock-button",{"tlui-toolbar__lock-button__mobile":t<Hs.TABLET_SM}),onClick:()=>e.updateInstanceState({isToolLocked:!i}),children:x.jsx(Ci,{icon:i?"lock":"unlock",small:!0})})}const q9e=y.memo(function({children:e}){const t=ot(),r=Ju(),i=Ev(),o=_t("current tool id",()=>t.getCurrentToolId(),[t]),{ActionsMenu:s,QuickActions:a}=nb();return x.jsx("div",{className:"tlui-toolbar",children:x.jsxs("div",{className:"tlui-toolbar__inner",children:[x.jsxs("div",{className:"tlui-toolbar__left",children:[!i&&x.jsxs("div",{className:"tlui-toolbar__extras",children:[r<Hs.TABLET&&x.jsxs("div",{className:"tlui-toolbar__extras__controls tlui-buttons__horizontal",children:[a&&x.jsx(a,{}),s&&x.jsx(s,{})]}),x.jsx(fKt,{activeToolId:o})]}),x.jsx(dKt,{children:e??x.jsx(B9e,{})})]}),r<Hs.TABLET_SM&&!i&&x.jsx("div",{className:"tlui-toolbar__tools",children:x.jsx(_qt,{})})]})})});function pKt(){const n=Hn();return x.jsxs(x.Fragment,{children:[x.jsx(ut,{...n["zoom-in"],noClose:!0}),x.jsx(ut,{...n["zoom-out"],noClose:!0}),x.jsx(p9e,{}),x.jsx(g9e,{}),x.jsx(m9e,{})]})}const gKt=y.memo(function({children:e}){const t=Il(),[r,i]=Qy("zoom menu"),o=e??x.jsx(pKt,{});return x.jsxs(Aoe,{dir:"ltr",open:r,onOpenChange:i,modal:!1,children:[x.jsx(Ooe,{asChild:!0,dir:"ltr",children:x.jsx(mKt,{})}),x.jsx(iF,{container:t,children:x.jsx(Moe,{className:"tlui-menu",side:"top",align:"start",alignOffset:0,sideOffset:8,collisionPadding:4,children:x.jsx(zh,{type:"menu",sourceId:"zoom-menu",children:o})})})]})}),mKt=y.forwardRef(function(e,t){const r=ot(),i=Ju(),o=_t("zoom",()=>r.getZoomLevel(),[r]),s=Ni(),a=y.useCallback(()=>{r.resetZoom(r.getViewportScreenCenter(),{animation:{duration:r.options.animationMediumMs}})},[r]);return x.jsx(dr,{ref:t,...e,type:"icon",title:`${s("navigation-zone.zoom")}`,"data-testid":"minimap.zoom-menu-button",className:i<Hs.TABLET_SM?"tlui-zoom-menu__button":"tlui-zoom-menu__button__pct",onDoubleClick:a,icon:i<Hs.MOBILE?"zoom-in":void 0,children:i<Hs.MOBILE?null:x.jsxs("span",{style:{flexGrow:0,textAlign:"center"},children:[Math.floor(o*100),"%"]})})}),K9e=y.createContext(null);function vKt({overrides:n={},children:e}){const t=mie(n);return x.jsx(K9e.Provider,{value:y.useMemo(()=>({ContextMenu:YVt,ActionsMenu:IVt,HelpMenu:uWt,ZoomMenu:gKt,MainMenu:TWt,Minimap:$Wt,StylePanel:Sqt,PageMenu:jWt,NavigationPanel:NWt,Toolbar:q9e,KeyboardShortcutsDialog:vWt,QuickActions:HWt,HelperButtons:gWt,DebugPanel:iWt,DebugMenu:rWt,MenuPanel:DWt,...t}),[t]),children:e})}function nb(){const n=y.useContext(K9e);if(!n)throw new Error("useTldrawUiComponents must be used within a TldrawUiComponentsProvider");return n}function yKt({overrides:n,components:e,assetUrls:t,onUiEvent:r,forceMobile:i,children:o}){return x.jsx(yFt,{assetUrls:cBt(t),children:x.jsx(_Ft,{overrides:fBt(n),children:x.jsx(xjt,{onEvent:r,children:x.jsx(Qjt,{children:x.jsx(Ejt,{children:x.jsx(uBt,{forceMobile:i,children:x.jsx(vKt,{overrides:e,children:x.jsx(bKt,{overrides:n,children:o})})})})})})})})}function bKt({overrides:n,children:e}){const t=pBt(n);return x.jsx(QBt,{overrides:t.actions,children:x.jsx(lBt,{overrides:t.tools,children:e})})}function SKt(){const n=ot(),{addToast:e}=up();y.useEffect(()=>{function t({name:r,count:i}){e({title:"Maximum Shapes Reached",description:`You've reached the maximum number of shapes allowed on ${r} (${i}). Please delete some shapes or move to a different page to continue.`,severity:"warning"})}return n.addListener("max-shapes",t),()=>{n.removeListener("max-shapes",t)}},[n,e])}const _Kt=Ke.memo(function({renderDebugMenuItems:e,children:t,hideUi:r,components:i,...o}){return x.jsx(yKt,{...o,components:i,children:x.jsx(wKt,{hideUi:r,renderDebugMenuItems:e,children:t})})}),wKt=Ke.memo(function({children:e,hideUi:t,...r}){return x.jsxs(x.Fragment,{children:[e,t?null:x.jsx(xKt,{...r}),x.jsx(CKt,{})]})});function CKt(){const{InFrontOfTheCanvas:n}=hs();return n?x.jsx("div",{className:"tl-front",children:x.jsx(n,{})}):null}const xKt=Ke.memo(function(){const e=ot(),t=Ni(),r=Ju(),i=Ev(),o=_t("focus",()=>e.getInstanceState().isFocusMode,[e]),s=_t("debug",()=>e.getInstanceState().isDebugMode,[e]),{SharePanel:a,TopPanel:c,MenuPanel:l,StylePanel:u,Toolbar:d,HelpMenu:h,NavigationPanel:f,HelperButtons:p,DebugPanel:g}=nb();cKt(),HBt(),SKt();const{"toggle-focus-mode":m}=Hn();return x.jsxs("div",{className:Ue("tlui-layout",{"tlui-layout__mobile":r<Hs.TABLET_SM}),"data-breakpoint":r,children:[o?x.jsx("div",{className:"tlui-layout__top",children:x.jsx(dr,{type:"icon",className:"tlui-focus-button",title:t("focus-mode.toggle-focus-mode"),onClick:()=>m.onSelect("menu"),children:x.jsx(Ci,{icon:"dot"})})}):x.jsxs(x.Fragment,{children:[x.jsxs("div",{className:"tlui-layout__top",children:[x.jsxs("div",{className:"tlui-layout__top__left",children:[l&&x.jsx(l,{}),p&&x.jsx(p,{})]}),x.jsx("div",{className:"tlui-layout__top__center",children:c&&x.jsx(c,{})}),x.jsxs("div",{className:"tlui-layout__top__right",children:[a&&x.jsx(a,{}),u&&r>=Hs.TABLET_SM&&!i&&x.jsx(u,{})]})]}),x.jsxs("div",{className:"tlui-layout__bottom",children:[x.jsxs("div",{className:"tlui-layout__bottom__main",children:[f&&x.jsx(f,{}),d&&x.jsx(d,{}),h&&x.jsx(h,{})]}),s&&g&&x.jsx(g,{})]})]}),x.jsx(rBt,{}),x.jsx(kjt,{}),x.jsx(iBt,{}),x.jsx(Tjt,{})]})});async function EKt(n,e){const{url:t,style:r="normal",weight:i="500",display:o,featureSettings:s,stretch:a,unicodeRange:c,variant:l,format:u}=e,d={style:r,weight:i,display:o,featureSettings:s,stretch:a,unicodeRange:c,variant:l},h=new FontFace(n,`url(${t})`,d);return await h.load(),document.fonts.add(h),h.$$_url=t,h.$$_fontface=`
@font-face {
	font-family: ${h.family};
	font-stretch: ${h.stretch};
	font-weight: ${h.weight};
	font-style: ${h.style};
	src: url("${t}") format("${u}")
}`,h}const DA=(n,e)=>{const[t,r]=y.useState(2);return y.useEffect(()=>{let i=!1;return r(2),EKt(n,e).then(()=>{i||r(0)}).catch(o=>{i||(console.error(o),r(1))}),()=>{i=!0}},[n,e]),t};function IKt(n){return{draw:{url:n.fonts.draw,format:n.fonts.draw.split(".").pop()},serif:{url:n.fonts.serif,format:n.fonts.serif.split(".").pop()},sansSerif:{url:n.fonts.sansSerif,format:n.fonts.sansSerif.split(".").pop()},monospace:{url:n.fonts.monospace,format:n.fonts.monospace.split(".").pop()}}}function G9e(n){const e=y.useMemo(()=>IKt(n),[n]),t=[DA("tldraw_draw",e.draw),DA("tldraw_serif",e.serif),DA("tldraw_sans",e.sansSerif),DA("tldraw_mono",e.monospace)];return{error:t.some(r=>r===1),done:!t.some(r=>r===2)}}function PKt(n){const{children:e,maxImageDimension:t,maxAssetSize:r,acceptedImageMimeTypes:i,acceptedVideoMimeTypes:o,onMount:s,components:a={},shapeUtils:c=[],bindingUtils:l=[],tools:u=[],...d}=n,h=mie(a),f=y.useMemo(()=>({Scribble:Hbe,CollaboratorScribble:Hbe,SelectionForeground:XLt,SelectionBackground:GLt,Handles:zLt,...h}),[h]),p=pk(c),g=y.useMemo(()=>[...Bie,...p],[p]),m=pk(l),v=y.useMemo(()=>[...Y$e,...m],[m]),b=pk(u),S=y.useMemo(()=>[...KFt,...tNt,...b],[b]),E="persistenceKey"in d?d.persistenceKey:void 0,w=V7e(d.assetUrls),C=y.useMemo(()=>({onResolveAsset:N7t(E),...d.assetOptions}),[E,d.assetOptions]),{done:I,error:T}=G9e(w);return T?x.jsx(W$e,{children:"Could not load assets. Please refresh the page."}):I?x.jsx(ILt,{initialState:"select",...d,components:f,shapeUtils:g,bindingUtils:v,tools:S,assetOptions:C,children:x.jsxs(_Kt,{...d,components:f,children:[x.jsx(kKt,{maxImageDimension:t,maxAssetSize:r,acceptedImageMimeTypes:i,acceptedVideoMimeTypes:o,persistenceKey:E,onMount:s}),e]})}):x.jsx(Pie,{children:x.jsx(gie,{})})}function kKt({maxImageDimension:n=1e3,maxAssetSize:e=10*1024*1024,acceptedImageMimeTypes:t=Zre,acceptedVideoMimeTypes:r=R6e,onMount:i,persistenceKey:o}){const s=ot(),a=up(),c=Ni(),l=xie(h=>{const f=[];return f.push(...RFt(h)),M7t(h,{maxImageDimension:n,maxAssetSize:e,acceptedImageMimeTypes:t,acceptedVideoMimeTypes:r},{toasts:a,msg:c},o),f.push(i==null?void 0:i(h)),()=>{f.forEach(p=>p==null?void 0:p())}});y.useLayoutEffect(()=>{if(s)return l==null?void 0:l(s)},[s,l]);const{Canvas:u}=hs(),{ContextMenu:d}=nb();return d?x.jsx(d,{}):u?x.jsx(u,{}):null}y.memo(function(e){const[t,r]=y.useState(null),[i,o]=y.useState(null),s=pk(e.shapeUtils??[]),a=y.useMemo(()=>[...Bie,...s],[s]),c=pk(e.bindingUtils??[]),l=y.useMemo(()=>[...Y$e,...c],[c]),u=U$e({snapshot:e.snapshot,shapeUtils:a}),d=V7e(),{done:h,error:f}=G9e(d),{pageId:p,bounds:g,scale:m,background:v,padding:b,darkMode:S,preserveAspectRatio:E,format:w="svg"}=e;return y.useLayoutEffect(()=>{if(!i||!u||!h)return;let C=!1;const I=document.createElement("div");i.appendChild(I),i.classList.add("tl-container","tl-theme__light");const T=new En({store:u,shapeUtils:a,bindingUtils:l,tools:[],getContainer:()=>I});p&&T.setCurrentPage(p);const D=T.getCurrentPageShapeIds();async function O(){const M=await T.getSvgString([...D],{bounds:g,scale:m,background:v,padding:b,darkMode:S,preserveAspectRatio:E});if(M&&!C){if(w==="svg"){if(!C){const R=new Blob([M.svg],{type:"image/svg+xml"}),A=URL.createObjectURL(R);r(A)}}else if(w==="png"){const R=await eNe(T,M.svg,{type:w,quality:1,scale:2,width:M.width,height:M.height});if(R&&!C){const A=URL.createObjectURL(R);r(A)}}}T.dispose()}return O(),()=>{C=!0}},[w,i,u,a,l,p,g,m,v,b,S,E,h,f]),f?x.jsx(W$e,{children:"Could not load assets."}):h?x.jsx("div",{ref:o,style:{position:"relative",width:"100%",height:"100%"},children:t&&x.jsx("img",{src:t,referrerPolicy:"strict-origin-when-cross-origin",style:{width:"100%",height:"100%"}})}):x.jsx(Pie,{children:x.jsx(gie,{})})});const TKt=oi({schemaVersion:wl(1),storeVersion:vO,recordVersions:e$($r,oi({version:vO,subTypeVersions:e$($r,vO).optional(),subTypeKey:$r.optional()}))}),DKt=oi({schemaVersion:wl(2),sequences:e$($r,vO)});oi({tldrawFileFormatVersion:Q4t,schema:eOt("schemaVersion",{1:TKt,2:DKt}),records:Nc(oi({id:$r,typeName:$r}).allowUnknownProperties())});async function RKt(n,e,t="png",r={}){return await ioe({editor:n,ids:e,format:t,opts:r})}const AKt="_scrollable_1p6bv_1",OKt="_select_1p6bv_1",MKt="_fadeIn_1p6bv_1",$Kt="_hide_1p6bv_1",LKt="_container_1p6bv_4",NKt="_spinner_1p6bv_1",FKt={"tl-container":"_tl-container_1p6bv_1","tl-theme__light":"_tl-theme__light_1p6bv_1","tl-theme__dark":"_tl-theme__dark_1p6bv_1","tl-counter-scaled":"_tl-counter-scaled_1p6bv_1","tl-container__focused":"_tl-container__focused_1p6bv_1","tl-canvas":"_tl-canvas_1p6bv_1","tl-culled-shapes":"_tl-culled-shapes_1p6bv_1","tl-culled-shapes__canvas":"_tl-culled-shapes__canvas_1p6bv_1","tl-shapes":"_tl-shapes_1p6bv_1","tl-overlays":"_tl-overlays_1p6bv_1","tl-overlays__item":"_tl-overlays__item_1p6bv_1","tl-svg-context":"_tl-svg-context_1p6bv_1","tl-front":"_tl-front_1p6bv_1","tl-background__wrapper":"_tl-background__wrapper_1p6bv_1","tl-background":"_tl-background_1p6bv_1","tl-grid":"_tl-grid_1p6bv_1","tl-grid-dot":"_tl-grid-dot_1p6bv_1","tl-html-layer":"_tl-html-layer_1p6bv_1","tl-brush":"_tl-brush_1p6bv_1","tl-brush__default":"_tl-brush__default_1p6bv_1","tl-scribble":"_tl-scribble_1p6bv_1","tl-shape":"_tl-shape_1p6bv_1","tl-shape__culled":"_tl-shape__culled_1p6bv_1","tl-svg-container":"_tl-svg-container_1p6bv_1","tl-html-container":"_tl-html-container_1p6bv_1","tl-collaborator__scribble":"_tl-collaborator__scribble_1p6bv_1","tl-collaborator__brush":"_tl-collaborator__brush_1p6bv_1","tl-collaborator__shape-indicator":"_tl-collaborator__shape-indicator_1p6bv_1","tl-user-scribble":"_tl-user-scribble_1p6bv_1","tl-user-brush":"_tl-user-brush_1p6bv_1","tl-user-indicator__selected":"_tl-user-indicator__selected_1p6bv_1","tl-user-indicator__hovered":"_tl-user-indicator__hovered_1p6bv_1","tl-user-handles":"_tl-user-handles_1p6bv_1","tl-user-snapline":"_tl-user-snapline_1p6bv_1","tl-selection__fg":"_tl-selection__fg_1p6bv_1","tl-user-indicator__hint":"_tl-user-indicator__hint_1p6bv_1","tl-collaborator__cursor-hint":"_tl-collaborator__cursor-hint_1p6bv_1","tl-collaborator__cursor":"_tl-collaborator__cursor_1p6bv_1","tl-cursor":"_tl-cursor_1p6bv_1","tl-shape-indicator":"_tl-shape-indicator_1p6bv_1","tl-selection__bg":"_tl-selection__bg_1p6bv_1","tl-selection__fg__outline":"_tl-selection__fg__outline_1p6bv_1","tl-corner-handle":"_tl-corner-handle_1p6bv_1","tl-text-handle":"_tl-text-handle_1p6bv_1","tl-corner-crop-handle":"_tl-corner-crop-handle_1p6bv_1","tl-corner-crop-edge-handle":"_tl-corner-crop-edge-handle_1p6bv_1","tl-mobile-rotate__bg":"_tl-mobile-rotate__bg_1p6bv_1","tl-mobile-rotate__fg":"_tl-mobile-rotate__fg_1p6bv_1","tl-transparent":"_tl-transparent_1p6bv_1","tl-handle":"_tl-handle_1p6bv_1","tl-handle__bg":"_tl-handle__bg_1p6bv_1","tl-handle__fg":"_tl-handle__fg_1p6bv_1","tl-handle__create":"_tl-handle__create_1p6bv_1","tl-handle__clone":"_tl-handle__clone_1p6bv_1","tl-image":"_tl-image_1p6bv_1","tl-video":"_tl-video_1p6bv_1","tl-video-container":"_tl-video-container_1p6bv_1","tl-image-container":"_tl-image-container_1p6bv_1","tl-embed-container":"_tl-embed-container_1p6bv_1","tl-image__tg":"_tl-image__tg_1p6bv_1","tl-collaborator-cursor":"_tl-collaborator-cursor_1p6bv_1","tl-nametag":"_tl-nametag_1p6bv_1","tl-nametag-title":"_tl-nametag-title_1p6bv_1","tl-nametag-chat":"_tl-nametag-chat_1p6bv_1","tl-cursor-chat":"_tl-cursor-chat_1p6bv_1","tl-cursor-chat__bubble":"_tl-cursor-chat__bubble_1p6bv_1","tl-cursor-chat-fade":"_tl-cursor-chat-fade_1p6bv_1","tl-text-shape-label":"_tl-text-shape-label_1p6bv_1","tl-text-wrapper":"_tl-text-wrapper_1p6bv_1","tl-text-content":"_tl-text-content_1p6bv_1","tl-text":"_tl-text_1p6bv_1","tl-text-measure":"_tl-text-measure_1p6bv_1","tl-text-input":"_tl-text-input_1p6bv_1","tl-text-content__wrapper":"_tl-text-content__wrapper_1p6bv_1","tl-arrow-label":"_tl-arrow-label_1p6bv_1","tl-snap-indicator":"_tl-snap-indicator_1p6bv_1","tl-snap-point":"_tl-snap-point_1p6bv_1","tl-group":"_tl-group_1p6bv_1","tl-bookmark__container":"_tl-bookmark__container_1p6bv_1","tl-bookmark__image_container":"_tl-bookmark__image_container_1p6bv_1","tl-hyperlink-button":"_tl-hyperlink-button_1p6bv_1","tl-bookmark__placeholder":"_tl-bookmark__placeholder_1p6bv_1","tl-bookmark__image":"_tl-bookmark__image_1p6bv_1","tl-bookmark__copy_container":"_tl-bookmark__copy_container_1p6bv_1","tl-bookmark__heading":"_tl-bookmark__heading_1p6bv_1","tl-bookmark__description":"_tl-bookmark__description_1p6bv_1","tl-bookmark__link":"_tl-bookmark__link_1p6bv_1","tl-hyperlink__icon":"_tl-hyperlink__icon_1p6bv_1","tl-bookmark__favicon":"_tl-bookmark__favicon_1p6bv_1","tl-hyperlink-button__hidden":"_tl-hyperlink-button__hidden_1p6bv_1","tl-text-label":"_tl-text-label_1p6bv_1","tl-text-label__inner":"_tl-text-label__inner_1p6bv_1","tl-arrow-hint":"_tl-arrow-hint_1p6bv_1","tl-arrow-label__inner":"_tl-arrow-label__inner_1p6bv_1","tl-arrow":"_tl-arrow_1p6bv_1","tl-note__container":"_tl-note__container_1p6bv_1","tl-loading":"_tl-loading_1p6bv_1","fade-in":"_fade-in_1p6bv_1","tl-frame__body":"_tl-frame__body_1p6bv_1","tl-frame__creating":"_tl-frame__creating_1p6bv_1","tl-frame-heading":"_tl-frame-heading_1p6bv_1","tl-frame-heading-hit-area":"_tl-frame-heading-hit-area_1p6bv_1","tl-frame-label":"_tl-frame-label_1p6bv_1","tl-frame-label__editing":"_tl-frame-label__editing_1p6bv_1","tl-frame-name-input":"_tl-frame-name-input_1p6bv_1","tl-embed":"_tl-embed_1p6bv_1","tl-shape-error-boundary":"_tl-shape-error-boundary_1p6bv_1","tl-error-boundary":"_tl-error-boundary_1p6bv_1","tl-error-boundary__overlay":"_tl-error-boundary__overlay_1p6bv_1","tl-error-boundary__content":"_tl-error-boundary__content_1p6bv_1","tl-error-boundary__canvas":"_tl-error-boundary__canvas_1p6bv_1","tl-error-boundary__content__expanded":"_tl-error-boundary__content__expanded_1p6bv_1","tl-error-boundary__content__error":"_tl-error-boundary__content__error_1p6bv_1","tl-error-boundary__content__actions":"_tl-error-boundary__content__actions_1p6bv_1","tl-error-boundary__content__actions__group":"_tl-error-boundary__content__actions__group_1p6bv_1","tl-error-boundary__reset":"_tl-error-boundary__reset_1p6bv_1","tl-error-boundary__refresh":"_tl-error-boundary__refresh_1p6bv_1","tl-hidden":"_tl-hidden_1p6bv_1","debug__ui-logger":"_debug__ui-logger_1p6bv_1","tl-hit-test-blocker":"_tl-hit-test-blocker_1p6bv_1","tl-hit-test-blocker__hidden":"_tl-hit-test-blocker__hidden_1p6bv_1","tlui-button":"_tlui-button_1p6bv_1","tlui-kbd":"_tlui-kbd_1p6bv_1","tlui-button__label":"_tlui-button__label_1p6bv_1","tlui-button__icon":"_tlui-button__icon_1p6bv_1","tlui-button__low":"_tlui-button__low_1p6bv_1","tlui-button__primary":"_tlui-button__primary_1p6bv_1","tlui-button__danger":"_tlui-button__danger_1p6bv_1","tlui-button__panel":"_tlui-button__panel_1p6bv_1","tlui-button__menu":"_tlui-button__menu_1p6bv_1","tlui-button__checkbox":"_tlui-button__checkbox_1p6bv_1","tlui-button__checkbox__indicator":"_tlui-button__checkbox__indicator_1p6bv_1","tlui-toolbar__lock-button":"_tlui-toolbar__lock-button_1p6bv_1","tlui-button__tool":"_tlui-button__tool_1p6bv_1","tlui-layout__mobile":"_tlui-layout__mobile_1p6bv_1","tlui-icon":"_tlui-icon_1p6bv_1","tlui-button__help":"_tlui-button__help_1p6bv_1","tlui-buttons__horizontal":"_tlui-buttons__horizontal_1p6bv_1","tlui-buttons__grid":"_tlui-buttons__grid_1p6bv_1","tlui-zoom-menu__button__pct":"_tlui-zoom-menu__button__pct_1p6bv_1","tlui-layout":"_tlui-layout_1p6bv_1","tlui-layout__top":"_tlui-layout__top_1p6bv_1","tlui-layout__top__left":"_tlui-layout__top__left_1p6bv_1","tlui-layout__top__right":"_tlui-layout__top__right_1p6bv_1",scrollable:AKt,"tlui-helper-buttons":"_tlui-helper-buttons_1p6bv_1","tlui-icon__placeholder":"_tlui-icon__placeholder_1p6bv_1","tlui-icon__small":"_tlui-icon__small_1p6bv_1","tlui-slider":"_tlui-slider_1p6bv_1","tlui-slider__container":"_tlui-slider__container_1p6bv_1","tlui-slider__track":"_tlui-slider__track_1p6bv_1","tlui-slider__range":"_tlui-slider__range_1p6bv_1","tlui-slider__thumb":"_tlui-slider__thumb_1p6bv_1","tlui-focus-button":"_tlui-focus-button_1p6bv_1","tlui-popover":"_tlui-popover_1p6bv_1","tlui-popover__content":"_tlui-popover__content_1p6bv_1","tlui-debug-panel":"_tlui-debug-panel_1p6bv_1","tlui-debug-panel__current-state":"_tlui-debug-panel__current-state_1p6bv_1","tlui-debug-panel__fps":"_tlui-debug-panel__fps_1p6bv_1","tlui-debug-panel__fps__slow":"_tlui-debug-panel__fps__slow_1p6bv_1","tlui-menu-zone":"_tlui-menu-zone_1p6bv_1","tlui-style-panel__wrapper":"_tlui-style-panel__wrapper_1p6bv_1","tlui-style-panel":"_tlui-style-panel_1p6bv_1",select:OKt,"tlui-style-panel__section":"_tlui-style-panel__section_1p6bv_1","tlui-style-panel__section__common":"_tlui-style-panel__section__common_1p6bv_1","tlui-style-panel__row":"_tlui-style-panel__row_1p6bv_1","tlui-style-panel__row__extra-button":"_tlui-style-panel__row__extra-button_1p6bv_1","tlui-style-panel__double-select-picker":"_tlui-style-panel__double-select-picker_1p6bv_1","tlui-style-panel__double-select-picker-label":"_tlui-style-panel__double-select-picker-label_1p6bv_1","tlui-input":"_tlui-input_1p6bv_1","tlui-input__wrapper":"_tlui-input__wrapper_1p6bv_1","tlui-dialog__overlay":"_tlui-dialog__overlay_1p6bv_1",fadeIn:MKt,"tlui-dialog__content":"_tlui-dialog__content_1p6bv_1","tlui-dialog__header":"_tlui-dialog__header_1p6bv_1","tlui-dialog__header__title":"_tlui-dialog__header__title_1p6bv_1","tlui-dialog__header__close":"_tlui-dialog__header__close_1p6bv_1","tlui-dialog__body":"_tlui-dialog__body_1p6bv_1","tlui-dialog__footer":"_tlui-dialog__footer_1p6bv_1","tlui-dialog__footer__actions":"_tlui-dialog__footer__actions_1p6bv_1","tlui-toolbar":"_tlui-toolbar_1p6bv_1","tlui-toolbar__inner":"_tlui-toolbar__inner_1p6bv_1","tlui-toolbar__left":"_tlui-toolbar__left_1p6bv_1","tlui-toolbar__extras":"_tlui-toolbar__extras_1p6bv_1","tlui-toolbar__extras__controls":"_tlui-toolbar__extras__controls_1p6bv_1","tlui-toolbar__tools":"_tlui-toolbar__tools_1p6bv_1","tlui-toolbar__tools__list":"_tlui-toolbar__tools__list_1p6bv_1","tlui-toolbar__overflow":"_tlui-toolbar__overflow_1p6bv_1","tlui-help-menu":"_tlui-help-menu_1p6bv_1","tlui-context-menu__move-to-page__name":"_tlui-context-menu__move-to-page__name_1p6bv_1","tlui-menu":"_tlui-menu_1p6bv_1","tlui-menu__arrow":"_tlui-menu__arrow_1p6bv_1","tlui-menu__group":"_tlui-menu__group_1p6bv_1","tlui-menu__submenu__trigger":"_tlui-menu__submenu__trigger_1p6bv_1","tlui-actions-menu":"_tlui-actions-menu_1p6bv_1","tlui-toast__viewport":"_tlui-toast__viewport_1p6bv_1","tlui-toast__icon":"_tlui-toast__icon_1p6bv_1","tlui-toast__container":"_tlui-toast__container_1p6bv_1","tlui-toast__main":"_tlui-toast__main_1p6bv_1","tlui-toast__content":"_tlui-toast__content_1p6bv_1","tlui-toast__title":"_tlui-toast__title_1p6bv_1","tlui-toast__description":"_tlui-toast__description_1p6bv_1","tlui-toast__actions":"_tlui-toast__actions_1p6bv_1","tlui-toast__close":"_tlui-toast__close_1p6bv_1","slide-in":"_slide-in_1p6bv_1",hide:$Kt,"swipe-out":"_swipe-out_1p6bv_1","tlui-layout__bottom":"_tlui-layout__bottom_1p6bv_1","tlui-layout__bottom__main":"_tlui-layout__bottom__main_1p6bv_1","tlui-navigation-panel":"_tlui-navigation-panel_1p6bv_1","tlui-navigation-panel__toggle":"_tlui-navigation-panel__toggle_1p6bv_1","tlui-minimap":"_tlui-minimap_1p6bv_1","tlui-minimap__canvas":"_tlui-minimap__canvas_1p6bv_1","tlui-page-menu__wrapper":"_tlui-page-menu__wrapper_1p6bv_1","tlui-page-menu__trigger":"_tlui-page-menu__trigger_1p6bv_1","tlui-page-menu__header":"_tlui-page-menu__header_1p6bv_1","tlui-page-menu__header__title":"_tlui-page-menu__header__title_1p6bv_1","tlui-page-menu__name":"_tlui-page-menu__name_1p6bv_1","tlui-page-menu__list":"_tlui-page-menu__list_1p6bv_1","tlui-page-menu__item":"_tlui-page-menu__item_1p6bv_1","tlui-page-menu__item__button":"_tlui-page-menu__item__button_1p6bv_1","tlui-page-menu__item__button__checkbox":"_tlui-page-menu__item__button__checkbox_1p6bv_1","tlui-page-menu__item__button__check":"_tlui-page-menu__item__button__check_1p6bv_1","tlui-page_menu__item__sortable":"_tlui-page_menu__item__sortable_1p6bv_1","tlui-page_menu__item__sortable__title":"_tlui-page_menu__item__sortable__title_1p6bv_1","tlui-page_menu__item__sortable__handle":"_tlui-page_menu__item__sortable__handle_1p6bv_1","tlui-page-menu__item__input":"_tlui-page-menu__item__input_1p6bv_1","tlui-page_menu__item__submenu":"_tlui-page_menu__item__submenu_1p6bv_1","tlui-edit-link-dialog":"_tlui-edit-link-dialog_1p6bv_1","tlui-edit-link-dialog__input":"_tlui-edit-link-dialog__input_1p6bv_1","tlui-embed__spacer":"_tlui-embed__spacer_1p6bv_1","tlui-embed-dialog__list":"_tlui-embed-dialog__list_1p6bv_1","tlui-embed-dialog__item__image":"_tlui-embed-dialog__item__image_1p6bv_1","tlui-embed-dialog__enter":"_tlui-embed-dialog__enter_1p6bv_1","tlui-embed-dialog__input":"_tlui-embed-dialog__input_1p6bv_1","tlui-embed-dialog__warning":"_tlui-embed-dialog__warning_1p6bv_1","tlui-embed-dialog__instruction__link":"_tlui-embed-dialog__instruction__link_1p6bv_1","tlui-following-indicator":"_tlui-following-indicator_1p6bv_1","tlui-offline-indicator":"_tlui-offline-indicator_1p6bv_1","tlui-shortcuts-dialog__header":"_tlui-shortcuts-dialog__header_1p6bv_1","tlui-shortcuts-dialog__body":"_tlui-shortcuts-dialog__body_1p6bv_1","tlui-shortcuts-dialog__body__tablet":"_tlui-shortcuts-dialog__body__tablet_1p6bv_1","tlui-shortcuts-dialog__body__mobile":"_tlui-shortcuts-dialog__body__mobile_1p6bv_1","tlui-shortcuts-dialog__group":"_tlui-shortcuts-dialog__group_1p6bv_1","tlui-shortcuts-dialog__group__title":"_tlui-shortcuts-dialog__group__title_1p6bv_1","tlui-shortcuts-dialog__group__content":"_tlui-shortcuts-dialog__group__content_1p6bv_1","tlui-shortcuts-dialog__key-pair":"_tlui-shortcuts-dialog__key-pair_1p6bv_1","tlui-shortcuts-dialog__key-pair__key":"_tlui-shortcuts-dialog__key-pair__key_1p6bv_1",container:LKt,spinner:NKt},jKt={chatMaskable:"./chat-icon-mask.svg",chatFilled:"./chat-icon-fill.svg"},BKt={"chat-icon":jKt.chatMaskable},Vu=()=>new Map,UX=n=>{const e=Vu();return n.forEach((t,r)=>{e.set(r,t)}),e},Tv=(n,e,t)=>{let r=n.get(e);return r===void 0&&n.set(e,r=t()),r},HKt=(n,e)=>{const t=[];for(const[r,i]of n)t.push(e(i,r));return t},UKt=(n,e)=>{for(const[t,r]of n)if(e(r,t))return!0;return!1},QS=()=>new Set,hz=n=>n[n.length-1],zKt=(n,e)=>{for(let t=0;t<e.length;t++)n.push(e[t])},gv=Array.from,VKt=Array.isArray;class WKt{constructor(){this._observers=Vu()}on(e,t){return Tv(this._observers,e,QS).add(t),t}once(e,t){const r=(...i)=>{this.off(e,r),t(...i)};this.on(e,r)}off(e,t){const r=this._observers.get(e);r!==void 0&&(r.delete(t),r.size===0&&this._observers.delete(e))}emit(e,t){return gv((this._observers.get(e)||Vu()).values()).forEach(r=>r(...t))}destroy(){this._observers=Vu()}}let qKt=class{constructor(){this._observers=Vu()}on(e,t){Tv(this._observers,e,QS).add(t)}once(e,t){const r=(...i)=>{this.off(e,r),t(...i)};this.on(e,r)}off(e,t){const r=this._observers.get(e);r!==void 0&&(r.delete(t),r.size===0&&this._observers.delete(e))}emit(e,t){return gv((this._observers.get(e)||Vu()).values()).forEach(r=>r(...t))}destroy(){this._observers=Vu()}};const My=Math.floor,rM=Math.abs,Z9e=(n,e)=>n<e?n:e,v_=(n,e)=>n>e?n:e,X9e=n=>n!==0?n<0:1/n<0,sSe=1,aSe=2,fz=4,pz=8,tT=32,Jm=64,Bd=128,sF=31,zX=63,pS=127,KKt=2147483647,Y9e=Number.MAX_SAFE_INTEGER,GKt=Number.isInteger||(n=>typeof n=="number"&&isFinite(n)&&My(n)===n),ZKt=n=>n.toLowerCase(),XKt=/^\s*/g,YKt=n=>n.replace(XKt,""),JKt=/([A-Z])/g,cSe=(n,e)=>YKt(n.replace(JKt,t=>`${e}${ZKt(t)}`)),QKt=n=>{const e=unescape(encodeURIComponent(n)),t=e.length,r=new Uint8Array(t);for(let i=0;i<t;i++)r[i]=e.codePointAt(i);return r},nT=typeof TextEncoder<"u"?new TextEncoder:null,eGt=n=>nT.encode(n),tGt=nT?eGt:QKt;let yk=typeof TextDecoder>"u"?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});yk&&yk.decode(new Uint8Array).length===1&&(yk=null);class ZD{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}}const aF=()=>new ZD,nGt=n=>{let e=n.cpos;for(let t=0;t<n.bufs.length;t++)e+=n.bufs[t].length;return e},Jp=n=>{const e=new Uint8Array(nGt(n));let t=0;for(let r=0;r<n.bufs.length;r++){const i=n.bufs[r];e.set(i,t),t+=i.length}return e.set(new Uint8Array(n.cbuf.buffer,0,n.cpos),t),e},rGt=(n,e)=>{const t=n.cbuf.length;t-n.cpos<e&&(n.bufs.push(new Uint8Array(n.cbuf.buffer,0,n.cpos)),n.cbuf=new Uint8Array(v_(t,e)*2),n.cpos=0)},ec=(n,e)=>{const t=n.cbuf.length;n.cpos===t&&(n.bufs.push(n.cbuf),n.cbuf=new Uint8Array(t*2),n.cpos=0),n.cbuf[n.cpos++]=e},VX=ec,fi=(n,e)=>{for(;e>pS;)ec(n,Bd|pS&e),e=My(e/128);ec(n,pS&e)},joe=(n,e)=>{const t=X9e(e);for(t&&(e=-e),ec(n,(e>zX?Bd:0)|(t?Jm:0)|zX&e),e=My(e/64);e>0;)ec(n,(e>pS?Bd:0)|pS&e),e=My(e/128)},WX=new Uint8Array(3e4),iGt=WX.length/3,oGt=(n,e)=>{if(e.length<iGt){const t=nT.encodeInto(e,WX).written||0;fi(n,t);for(let r=0;r<t;r++)ec(n,WX[r])}else md(n,tGt(e))},sGt=(n,e)=>{const t=unescape(encodeURIComponent(e)),r=t.length;fi(n,r);for(let i=0;i<r;i++)ec(n,t.codePointAt(i))},JC=nT&&nT.encodeInto?oGt:sGt,cF=(n,e)=>{const t=n.cbuf.length,r=n.cpos,i=Z9e(t-r,e.length),o=e.length-i;n.cbuf.set(e.subarray(0,i),r),n.cpos+=i,o>0&&(n.bufs.push(n.cbuf),n.cbuf=new Uint8Array(v_(t*2,o)),n.cbuf.set(e.subarray(i)),n.cpos=o)},md=(n,e)=>{fi(n,e.byteLength),cF(n,e)},Boe=(n,e)=>{rGt(n,e);const t=new DataView(n.cbuf.buffer,n.cpos,e);return n.cpos+=e,t},aGt=(n,e)=>Boe(n,4).setFloat32(0,e,!1),cGt=(n,e)=>Boe(n,8).setFloat64(0,e,!1),lGt=(n,e)=>Boe(n,8).setBigInt64(0,e,!1),lSe=new DataView(new ArrayBuffer(4)),uGt=n=>(lSe.setFloat32(0,n),lSe.getFloat32(0)===n),rT=(n,e)=>{switch(typeof e){case"string":ec(n,119),JC(n,e);break;case"number":GKt(e)&&rM(e)<=KKt?(ec(n,125),joe(n,e)):uGt(e)?(ec(n,124),aGt(n,e)):(ec(n,123),cGt(n,e));break;case"bigint":ec(n,122),lGt(n,e);break;case"object":if(e===null)ec(n,126);else if(VKt(e)){ec(n,117),fi(n,e.length);for(let t=0;t<e.length;t++)rT(n,e[t])}else if(e instanceof Uint8Array)ec(n,116),md(n,e);else{ec(n,118);const t=Object.keys(e);fi(n,t.length);for(let r=0;r<t.length;r++){const i=t[r];JC(n,i),rT(n,e[i])}}break;case"boolean":ec(n,e?120:121);break;default:ec(n,127)}};class uSe extends ZD{constructor(e){super(),this.w=e,this.s=null,this.count=0}write(e){this.s===e?this.count++:(this.count>0&&fi(this,this.count-1),this.count=1,this.w(this,e),this.s=e)}}const dSe=n=>{n.count>0&&(joe(n.encoder,n.count===1?n.s:-n.s),n.count>1&&fi(n.encoder,n.count-2))};class iM{constructor(){this.encoder=new ZD,this.s=0,this.count=0}write(e){this.s===e?this.count++:(dSe(this),this.count=1,this.s=e)}toUint8Array(){return dSe(this),Jp(this.encoder)}}const hSe=n=>{if(n.count>0){const e=n.diff*2+(n.count===1?0:1);joe(n.encoder,e),n.count>1&&fi(n.encoder,n.count-2)}};class gz{constructor(){this.encoder=new ZD,this.s=0,this.count=0,this.diff=0}write(e){this.diff===e-this.s?(this.s=e,this.count++):(hSe(this),this.count=1,this.diff=e-this.s,this.s=e)}toUint8Array(){return hSe(this),Jp(this.encoder)}}class dGt{constructor(){this.sarr=[],this.s="",this.lensE=new iM}write(e){this.s+=e,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(e.length)}toUint8Array(){const e=new ZD;return this.sarr.push(this.s),this.s="",JC(e,this.sarr.join("")),cF(e,this.lensE.toUint8Array()),Jp(e)}}const $y=n=>new Error(n),ag=()=>{throw $y("Method unimplemented")},Vh=()=>{throw $y("Unexpected case")},J9e=$y("Unexpected end of array"),Q9e=$y("Integer out of Range");class lF{constructor(e){this.arr=e,this.pos=0}}const _E=n=>new lF(n),hGt=n=>n.pos!==n.arr.length,fGt=(n,e)=>{const t=new Uint8Array(n.arr.buffer,n.pos+n.arr.byteOffset,e);return n.pos+=e,t},vd=n=>fGt(n,ii(n)),gx=n=>n.arr[n.pos++],ii=n=>{let e=0,t=1;const r=n.arr.length;for(;n.pos<r;){const i=n.arr[n.pos++];if(e=e+(i&pS)*t,t*=128,i<Bd)return e;if(e>Y9e)throw Q9e}throw J9e},Hoe=n=>{let e=n.arr[n.pos++],t=e&zX,r=64;const i=(e&Jm)>0?-1:1;if(!(e&Bd))return i*t;const o=n.arr.length;for(;n.pos<o;){if(e=n.arr[n.pos++],t=t+(e&pS)*r,r*=128,e<Bd)return i*t;if(t>Y9e)throw Q9e}throw J9e},pGt=n=>{let e=ii(n);if(e===0)return"";{let t=String.fromCodePoint(gx(n));if(--e<100)for(;e--;)t+=String.fromCodePoint(gx(n));else for(;e>0;){const r=e<1e4?e:1e4,i=n.arr.subarray(n.pos,n.pos+r);n.pos+=r,t+=String.fromCodePoint.apply(null,i),e-=r}return decodeURIComponent(escape(t))}},gGt=n=>yk.decode(vd(n)),QC=yk?gGt:pGt,Uoe=(n,e)=>{const t=new DataView(n.arr.buffer,n.arr.byteOffset+n.pos,e);return n.pos+=e,t},mGt=n=>Uoe(n,4).getFloat32(0,!1),vGt=n=>Uoe(n,8).getFloat64(0,!1),yGt=n=>Uoe(n,8).getBigInt64(0,!1),bGt=[n=>{},n=>null,Hoe,mGt,vGt,yGt,n=>!1,n=>!0,QC,n=>{const e=ii(n),t={};for(let r=0;r<e;r++){const i=QC(n);t[i]=iT(n)}return t},n=>{const e=ii(n),t=[];for(let r=0;r<e;r++)t.push(iT(n));return t},vd],iT=n=>bGt[127-gx(n)](n);class fSe extends lF{constructor(e,t){super(e),this.reader=t,this.s=null,this.count=0}read(){return this.count===0&&(this.s=this.reader(this),hGt(this)?this.count=ii(this)+1:this.count=-1),this.count--,this.s}}class oM extends lF{constructor(e){super(e),this.s=0,this.count=0}read(){if(this.count===0){this.s=Hoe(this);const e=X9e(this.s);this.count=1,e&&(this.s=-this.s,this.count=ii(this)+2)}return this.count--,this.s}}class mz extends lF{constructor(e){super(e),this.s=0,this.count=0,this.diff=0}read(){if(this.count===0){const e=Hoe(this),t=e&1;this.diff=My(e/2),this.count=1,t&&(this.count=ii(this)+2)}return this.s+=this.diff,this.count--,this.s}}class SGt{constructor(e){this.decoder=new oM(e),this.str=QC(this.decoder),this.spos=0}read(){const e=this.spos+this.decoder.read(),t=this.str.slice(this.spos,e);return this.spos=e,t}}const _Gt=crypto.getRandomValues.bind(crypto),eje=()=>_Gt(new Uint32Array(1))[0],wGt="10000000-1000-4000-8000"+-1e11,CGt=()=>wGt.replace(/[018]/g,n=>(n^eje()&15>>n/4).toString(16)),pSe=n=>new Promise(n);Promise.all.bind(Promise);const gSe=n=>n===void 0?null:n;class xGt{constructor(){this.map=new Map}setItem(e,t){this.map.set(e,t)}getItem(e){return this.map.get(e)}}let tje=new xGt,EGt=!0;try{typeof localStorage<"u"&&localStorage&&(tje=localStorage,EGt=!1)}catch{}const IGt=tje,PGt=Object.assign,kGt=Object.keys,TGt=(n,e)=>{for(const t in n)e(n[t],t)},mSe=n=>kGt(n).length,DGt=n=>{for(const e in n)return!1;return!0},RGt=(n,e)=>{for(const t in n)if(!e(n[t],t))return!1;return!0},AGt=(n,e)=>Object.prototype.hasOwnProperty.call(n,e),OGt=(n,e)=>n===e||mSe(n)===mSe(e)&&RGt(n,(t,r)=>(t!==void 0||AGt(e,r))&&e[r]===t),zoe=(n,e,t=0)=>{try{for(;t<n.length;t++)n[t](...e)}finally{t<n.length&&zoe(n,e,t+1)}},MGt=n=>n,$Gt=(n,e)=>e.includes(n);var nje={};const oT=typeof process<"u"&&process.release&&/node|io\.js/.test(process.release.name)&&Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]";let _p;const LGt=()=>{if(_p===void 0)if(oT){_p=Vu();const n=process.argv;let e=null;for(let t=0;t<n.length;t++){const r=n[t];r[0]==="-"?(e!==null&&_p.set(e,""),e=r):e!==null&&(_p.set(e,r),e=null)}e!==null&&_p.set(e,"")}else typeof location=="object"?(_p=Vu(),(location.search||"?").slice(1).split("&").forEach(n=>{if(n.length!==0){const[e,t]=n.split("=");_p.set(`--${cSe(e,"-")}`,t),_p.set(`-${cSe(e,"-")}`,t)}})):_p=Vu();return _p},qX=n=>LGt().has(n),KX=n=>gSe(oT?nje[n.toUpperCase().replaceAll("-","_")]:IGt.getItem(n)),NGt=n=>qX("--"+n)||KX(n)!==null;NGt("production");const vSe=oT&&$Gt(nje.FORCE_COLOR,["true","1","2"]),FGt=!qX("--no-colors")&&(!oT||process.stdout.isTTY||vSe)&&(!oT||qX("--color")||vSe||KX("COLORTERM")!==null||(KX("TERM")||"").includes("color")),jGt=n=>new Uint8Array(n),BGt=n=>{const e=jGt(n.byteLength);return e.set(n),e};class HGt{constructor(e,t){this.left=e,this.right=t}}const dm=(n,e)=>new HGt(n,e);typeof DOMParser<"u"&&new DOMParser;const UGt=n=>HKt(n,(e,t)=>`${t}:${e};`).join(""),Dv=Symbol,rje=Dv(),ije=Dv(),zGt=Dv(),VGt=Dv(),WGt=Dv(),oje=Dv(),qGt=Dv(),sje=Dv(),KGt=Dv(),GGt=n=>{var r;n.length===1&&((r=n[0])==null?void 0:r.constructor)===Function&&(n=n[0]());const e=[];let t=0;for(;t<n.length;t++){const i=n[t];i===void 0||i.constructor===String||i.constructor===Number||i.constructor===Object&&e.push(JSON.stringify(i))}return e},ZGt={[rje]:dm("font-weight","bold"),[ije]:dm("font-weight","normal"),[zGt]:dm("color","blue"),[WGt]:dm("color","green"),[VGt]:dm("color","grey"),[oje]:dm("color","red"),[qGt]:dm("color","purple"),[sje]:dm("color","orange"),[KGt]:dm("color","black")},XGt=n=>{var s;n.length===1&&((s=n[0])==null?void 0:s.constructor)===Function&&(n=n[0]());const e=[],t=[],r=Vu();let i=[],o=0;for(;o<n.length;o++){const a=n[o],c=ZGt[a];if(c!==void 0)r.set(c.left,c.right);else{if(a===void 0)break;if(a.constructor===String||a.constructor===Number){const l=UGt(r);o>0||l.length>0?(e.push("%c"+a),t.push(l)):e.push(a)}else break}}for(o>0&&(i=t,i.unshift(e.join("")));o<n.length;o++){const a=n[o];a instanceof Symbol||i.push(a)}return i},YGt=FGt?XGt:GGt,JGt=(...n)=>{console.log(...YGt(n)),QGt.forEach(e=>e.print(n))},QGt=QS(),aje=n=>({[Symbol.iterator](){return this},next:n}),eZt=(n,e)=>aje(()=>{let t;do t=n.next();while(!t.done&&!e(t.value));return t}),vz=(n,e)=>aje(()=>{const{done:t,value:r}=n.next();return{done:t,value:t?void 0:e(r)}});class Voe{constructor(e,t){this.clock=e,this.len=t}}class XD{constructor(){this.clients=new Map}}const cje=(n,e,t)=>e.clients.forEach((r,i)=>{const o=n.doc.store.clients.get(i);for(let s=0;s<r.length;s++){const a=r[s];wje(n,o,a.clock,a.len,t)}}),tZt=(n,e)=>{let t=0,r=n.length-1;for(;t<=r;){const i=My((t+r)/2),o=n[i],s=o.clock;if(s<=e){if(e<s+o.len)return i;t=i+1}else r=i-1}return null},lje=(n,e)=>{const t=n.clients.get(e.client);return t!==void 0&&tZt(t,e.clock)!==null},Woe=n=>{n.clients.forEach(e=>{e.sort((i,o)=>i.clock-o.clock);let t,r;for(t=1,r=1;t<e.length;t++){const i=e[r-1],o=e[t];i.clock+i.len>=o.clock?i.len=v_(i.len,o.clock+o.len-i.clock):(r<t&&(e[r]=o),r++)}e.length=r})},nZt=n=>{const e=new XD;for(let t=0;t<n.length;t++)n[t].clients.forEach((r,i)=>{if(!e.clients.has(i)){const o=r.slice();for(let s=t+1;s<n.length;s++)zKt(o,n[s].clients.get(i)||[]);e.clients.set(i,o)}});return Woe(e),e},I$=(n,e,t,r)=>{Tv(n.clients,e,()=>[]).push(new Voe(t,r))},rZt=()=>new XD,iZt=n=>{const e=rZt();return n.clients.forEach((t,r)=>{const i=[];for(let o=0;o<t.length;o++){const s=t[o];if(s.deleted){const a=s.id.clock;let c=s.length;if(o+1<t.length)for(let l=t[o+1];o+1<t.length&&l.deleted;l=t[++o+1])c+=l.length;i.push(new Voe(a,c))}}i.length>0&&e.clients.set(r,i)}),e},wE=(n,e)=>{fi(n.restEncoder,e.clients.size),gv(e.clients.entries()).sort((t,r)=>r[0]-t[0]).forEach(([t,r])=>{n.resetDsCurVal(),fi(n.restEncoder,t);const i=r.length;fi(n.restEncoder,i);for(let o=0;o<i;o++){const s=r[o];n.writeDsClock(s.clock),n.writeDsLen(s.len)}})},qoe=n=>{const e=new XD,t=ii(n.restDecoder);for(let r=0;r<t;r++){n.resetDsCurVal();const i=ii(n.restDecoder),o=ii(n.restDecoder);if(o>0){const s=Tv(e.clients,i,()=>[]);for(let a=0;a<o;a++)s.push(new Voe(n.readDsClock(),n.readDsLen()))}}return e},ySe=(n,e,t)=>{const r=new XD,i=ii(n.restDecoder);for(let o=0;o<i;o++){n.resetDsCurVal();const s=ii(n.restDecoder),a=ii(n.restDecoder),c=t.clients.get(s)||[],l=va(t,s);for(let u=0;u<a;u++){const d=n.readDsClock(),h=d+n.readDsLen();if(d<l){l<h&&I$(r,s,l,h-l);let f=xg(c,d),p=c[f];for(!p.deleted&&p.id.clock<d&&(c.splice(f+1,0,$$(e,p,d-p.id.clock)),f++);f<c.length&&(p=c[f++],p.id.clock<h);)p.deleted||(h<p.id.clock+p.length&&c.splice(f,0,$$(e,p,h-p.id.clock)),p.delete(e))}else I$(r,s,d,h-d)}}if(r.clients.size>0){const o=new e_;return fi(o.restEncoder,0),wE(o,r),o.toUint8Array()}return null},uje=eje;class y_ extends WKt{constructor({guid:e=CGt(),collectionid:t=null,gc:r=!0,gcFilter:i=()=>!0,meta:o=null,autoLoad:s=!1,shouldLoad:a=!0}={}){super(),this.gc=r,this.gcFilter=i,this.clientID=uje(),this.guid=e,this.collectionid=t,this.share=new Map,this.store=new Sje,this._transaction=null,this._transactionCleanups=[],this.subdocs=new Set,this._item=null,this.shouldLoad=a,this.autoLoad=s,this.meta=o,this.isLoaded=!1,this.isSynced=!1,this.whenLoaded=pSe(l=>{this.on("load",()=>{this.isLoaded=!0,l(this)})});const c=()=>pSe(l=>{const u=d=>{(d===void 0||d===!0)&&(this.off("sync",u),l())};this.on("sync",u)});this.on("sync",l=>{l===!1&&this.isSynced&&(this.whenSynced=c()),this.isSynced=l===void 0||l===!0,this.isSynced&&!this.isLoaded&&this.emit("load",[this])}),this.whenSynced=c()}load(){const e=this._item;e!==null&&!this.shouldLoad&&Lo(e.parent.doc,t=>{t.subdocsLoaded.add(this)},null,!0),this.shouldLoad=!0}getSubdocs(){return this.subdocs}getSubdocGuids(){return new Set(gv(this.subdocs).map(e=>e.guid))}transact(e,t=null){return Lo(this,e,t)}get(e,t=Kc){const r=Tv(this.share,e,()=>{const o=new t;return o._integrate(this,null),o}),i=r.constructor;if(t!==Kc&&i!==t)if(i===Kc){const o=new t;o._map=r._map,r._map.forEach(s=>{for(;s!==null;s=s.left)s.parent=o}),o._start=r._start;for(let s=o._start;s!==null;s=s.right)s.parent=o;return o._length=r._length,this.share.set(e,o),o._integrate(this,null),o}else throw new Error(`Type with the name ${e} has already been defined with a different constructor`);return r}getArray(e=""){return this.get(e,n2)}getText(e=""){return this.get(e,yx)}getMap(e=""){return this.get(e,vx)}getXmlElement(e=""){return this.get(e,bx)}getXmlFragment(e=""){return this.get(e,t_)}toJSON(){const e={};return this.share.forEach((t,r)=>{e[r]=t.toJSON()}),e}destroy(){gv(this.subdocs).forEach(t=>t.destroy());const e=this._item;if(e!==null){this._item=null;const t=e.content;t.doc=new y_({guid:this.guid,...t.opts,shouldLoad:!1}),t.doc._item=e,Lo(e.parent.doc,r=>{const i=t.doc;e.deleted||r.subdocsAdded.add(i),r.subdocsRemoved.add(this)},null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),super.destroy()}}class dje{constructor(e){this.restDecoder=e}resetDsCurVal(){}readDsClock(){return ii(this.restDecoder)}readDsLen(){return ii(this.restDecoder)}}class hje extends dje{readLeftID(){return si(ii(this.restDecoder),ii(this.restDecoder))}readRightID(){return si(ii(this.restDecoder),ii(this.restDecoder))}readClient(){return ii(this.restDecoder)}readInfo(){return gx(this.restDecoder)}readString(){return QC(this.restDecoder)}readParentInfo(){return ii(this.restDecoder)===1}readTypeRef(){return ii(this.restDecoder)}readLen(){return ii(this.restDecoder)}readAny(){return iT(this.restDecoder)}readBuf(){return BGt(vd(this.restDecoder))}readJSON(){return JSON.parse(QC(this.restDecoder))}readKey(){return QC(this.restDecoder)}}class oZt{constructor(e){this.dsCurrVal=0,this.restDecoder=e}resetDsCurVal(){this.dsCurrVal=0}readDsClock(){return this.dsCurrVal+=ii(this.restDecoder),this.dsCurrVal}readDsLen(){const e=ii(this.restDecoder)+1;return this.dsCurrVal+=e,e}}class mx extends oZt{constructor(e){super(e),this.keys=[],ii(e),this.keyClockDecoder=new mz(vd(e)),this.clientDecoder=new oM(vd(e)),this.leftClockDecoder=new mz(vd(e)),this.rightClockDecoder=new mz(vd(e)),this.infoDecoder=new fSe(vd(e),gx),this.stringDecoder=new SGt(vd(e)),this.parentInfoDecoder=new fSe(vd(e),gx),this.typeRefDecoder=new oM(vd(e)),this.lenDecoder=new oM(vd(e))}readLeftID(){return new e2(this.clientDecoder.read(),this.leftClockDecoder.read())}readRightID(){return new e2(this.clientDecoder.read(),this.rightClockDecoder.read())}readClient(){return this.clientDecoder.read()}readInfo(){return this.infoDecoder.read()}readString(){return this.stringDecoder.read()}readParentInfo(){return this.parentInfoDecoder.read()===1}readTypeRef(){return this.typeRefDecoder.read()}readLen(){return this.lenDecoder.read()}readAny(){return iT(this.restDecoder)}readBuf(){return vd(this.restDecoder)}readJSON(){return iT(this.restDecoder)}readKey(){const e=this.keyClockDecoder.read();if(e<this.keys.length)return this.keys[e];{const t=this.stringDecoder.read();return this.keys.push(t),t}}}class fje{constructor(){this.restEncoder=aF()}toUint8Array(){return Jp(this.restEncoder)}resetDsCurVal(){}writeDsClock(e){fi(this.restEncoder,e)}writeDsLen(e){fi(this.restEncoder,e)}}class YD extends fje{writeLeftID(e){fi(this.restEncoder,e.client),fi(this.restEncoder,e.clock)}writeRightID(e){fi(this.restEncoder,e.client),fi(this.restEncoder,e.clock)}writeClient(e){fi(this.restEncoder,e)}writeInfo(e){VX(this.restEncoder,e)}writeString(e){JC(this.restEncoder,e)}writeParentInfo(e){fi(this.restEncoder,e?1:0)}writeTypeRef(e){fi(this.restEncoder,e)}writeLen(e){fi(this.restEncoder,e)}writeAny(e){rT(this.restEncoder,e)}writeBuf(e){md(this.restEncoder,e)}writeJSON(e){JC(this.restEncoder,JSON.stringify(e))}writeKey(e){JC(this.restEncoder,e)}}class pje{constructor(){this.restEncoder=aF(),this.dsCurrVal=0}toUint8Array(){return Jp(this.restEncoder)}resetDsCurVal(){this.dsCurrVal=0}writeDsClock(e){const t=e-this.dsCurrVal;this.dsCurrVal=e,fi(this.restEncoder,t)}writeDsLen(e){e===0&&Vh(),fi(this.restEncoder,e-1),this.dsCurrVal+=e}}class e_ extends pje{constructor(){super(),this.keyMap=new Map,this.keyClock=0,this.keyClockEncoder=new gz,this.clientEncoder=new iM,this.leftClockEncoder=new gz,this.rightClockEncoder=new gz,this.infoEncoder=new uSe(VX),this.stringEncoder=new dGt,this.parentInfoEncoder=new uSe(VX),this.typeRefEncoder=new iM,this.lenEncoder=new iM}toUint8Array(){const e=aF();return fi(e,0),md(e,this.keyClockEncoder.toUint8Array()),md(e,this.clientEncoder.toUint8Array()),md(e,this.leftClockEncoder.toUint8Array()),md(e,this.rightClockEncoder.toUint8Array()),md(e,Jp(this.infoEncoder)),md(e,this.stringEncoder.toUint8Array()),md(e,Jp(this.parentInfoEncoder)),md(e,this.typeRefEncoder.toUint8Array()),md(e,this.lenEncoder.toUint8Array()),cF(e,Jp(this.restEncoder)),Jp(e)}writeLeftID(e){this.clientEncoder.write(e.client),this.leftClockEncoder.write(e.clock)}writeRightID(e){this.clientEncoder.write(e.client),this.rightClockEncoder.write(e.clock)}writeClient(e){this.clientEncoder.write(e)}writeInfo(e){this.infoEncoder.write(e)}writeString(e){this.stringEncoder.write(e)}writeParentInfo(e){this.parentInfoEncoder.write(e?1:0)}writeTypeRef(e){this.typeRefEncoder.write(e)}writeLen(e){this.lenEncoder.write(e)}writeAny(e){rT(this.restEncoder,e)}writeBuf(e){md(this.restEncoder,e)}writeJSON(e){rT(this.restEncoder,e)}writeKey(e){const t=this.keyMap.get(e);t===void 0?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(e)):this.keyClockEncoder.write(t)}}const sZt=(n,e,t,r)=>{r=v_(r,e[0].id.clock);const i=xg(e,r);fi(n.restEncoder,e.length-i),n.writeClient(t),fi(n.restEncoder,r);const o=e[i];o.write(n,r-o.id.clock);for(let s=i+1;s<e.length;s++)e[s].write(n,0)},Koe=(n,e,t)=>{const r=new Map;t.forEach((i,o)=>{va(e,o)>i&&r.set(o,i)}),uF(e).forEach((i,o)=>{t.has(o)||r.set(o,0)}),fi(n.restEncoder,r.size),gv(r.entries()).sort((i,o)=>o[0]-i[0]).forEach(([i,o])=>{sZt(n,e.clients.get(i),i,o)})},aZt=(n,e)=>{const t=Vu(),r=ii(n.restDecoder);for(let i=0;i<r;i++){const o=ii(n.restDecoder),s=new Array(o),a=n.readClient();let c=ii(n.restDecoder);t.set(a,{i:0,refs:s});for(let l=0;l<o;l++){const u=n.readInfo();switch(sF&u){case 0:{const d=n.readLen();s[l]=new Th(si(a,c),d),c+=d;break}case 10:{const d=ii(n.restDecoder);s[l]=new Dh(si(a,c),d),c+=d;break}default:{const d=(u&(Jm|Bd))===0,h=new Bs(si(a,c),null,(u&Bd)===Bd?n.readLeftID():null,null,(u&Jm)===Jm?n.readRightID():null,d?n.readParentInfo()?e.get(n.readString()):n.readLeftID():null,d&&(u&tT)===tT?n.readString():null,Hje(n,u));s[l]=h,c+=h.length}}}}return t},cZt=(n,e,t)=>{const r=[];let i=gv(t.keys()).sort((f,p)=>f-p);if(i.length===0)return null;const o=()=>{if(i.length===0)return null;let f=t.get(i[i.length-1]);for(;f.refs.length===f.i;)if(i.pop(),i.length>0)f=t.get(i[i.length-1]);else return null;return f};let s=o();if(s===null)return null;const a=new Sje,c=new Map,l=(f,p)=>{const g=c.get(f);(g==null||g>p)&&c.set(f,p)};let u=s.refs[s.i++];const d=new Map,h=()=>{for(const f of r){const p=f.id.client,g=t.get(p);g?(g.i--,a.clients.set(p,g.refs.slice(g.i)),t.delete(p),g.i=0,g.refs=[]):a.clients.set(p,[f]),i=i.filter(m=>m!==p)}r.length=0};for(;;){if(u.constructor!==Dh){const p=Tv(d,u.id.client,()=>va(e,u.id.client))-u.id.clock;if(p<0)r.push(u),l(u.id.client,u.id.clock-1),h();else{const g=u.getMissing(n,e);if(g!==null){r.push(u);const m=t.get(g)||{refs:[],i:0};if(m.refs.length===m.i)l(g,va(e,g)),h();else{u=m.refs[m.i++];continue}}else(p===0||p<u.length)&&(u.integrate(n,p),d.set(u.id.client,u.id.clock+u.length))}}if(r.length>0)u=r.pop();else if(s!==null&&s.i<s.refs.length)u=s.refs[s.i++];else{if(s=o(),s===null)break;u=s.refs[s.i++]}}if(a.clients.size>0){const f=new e_;return Koe(f,a,new Map),fi(f.restEncoder,0),{missing:c,update:f.toUint8Array()}}return null},lZt=(n,e)=>Koe(n,e.doc.store,e.beforeState),uZt=(n,e,t,r=new mx(n))=>Lo(e,i=>{i.local=!1;let o=!1;const s=i.doc,a=s.store,c=aZt(r,s),l=cZt(i,a,c),u=a.pendingStructs;if(u){for(const[h,f]of u.missing)if(f<va(a,h)){o=!0;break}if(l){for(const[h,f]of l.missing){const p=u.missing.get(h);(p==null||p>f)&&u.missing.set(h,f)}u.update=T$([u.update,l.update])}}else a.pendingStructs=l;const d=ySe(r,i,a);if(a.pendingDs){const h=new mx(_E(a.pendingDs));ii(h.restDecoder);const f=ySe(h,i,a);d&&f?a.pendingDs=T$([d,f]):a.pendingDs=d||f}else a.pendingDs=d;if(o){const h=a.pendingStructs.update;a.pendingStructs=null,gje(i.doc,h)}},t,!1),gje=(n,e,t,r=mx)=>{const i=_E(e);uZt(i,n,t,new r(i))},dZt=(n,e,t)=>gje(n,e,t,hje),hZt=(n,e,t=new Map)=>{Koe(n,e.store,t),wE(n,iZt(e.store))},fZt=(n,e=new Uint8Array([0]),t=new e_)=>{const r=mje(e);hZt(t,n,r);const i=[t.toUint8Array()];if(n.store.pendingDs&&i.push(n.store.pendingDs),n.store.pendingStructs&&i.push(RZt(n.store.pendingStructs.update,e)),i.length>1){if(t.constructor===YD)return TZt(i.map((o,s)=>s===0?o:OZt(o)));if(t.constructor===e_)return T$(i)}return i[0]},pZt=(n,e)=>fZt(n,e,new YD),gZt=n=>{const e=new Map,t=ii(n.restDecoder);for(let r=0;r<t;r++){const i=ii(n.restDecoder),o=ii(n.restDecoder);e.set(i,o)}return e},mje=n=>gZt(new dje(_E(n))),vje=(n,e)=>(fi(n.restEncoder,e.size),gv(e.entries()).sort((t,r)=>r[0]-t[0]).forEach(([t,r])=>{fi(n.restEncoder,t),fi(n.restEncoder,r)}),n),mZt=(n,e)=>vje(n,uF(e.store)),vZt=(n,e=new pje)=>(n instanceof Map?vje(e,n):mZt(e,n),e.toUint8Array()),yZt=n=>vZt(n,new fje);class bZt{constructor(){this.l=[]}}const bSe=()=>new bZt,SSe=(n,e)=>n.l.push(e),_Se=(n,e)=>{const t=n.l,r=t.length;n.l=t.filter(i=>e!==i),r===n.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},yje=(n,e,t)=>zoe(n.l,[e,t]);class e2{constructor(e,t){this.client=e,this.clock=t}}const RA=(n,e)=>n===e||n!==null&&e!==null&&n.client===e.client&&n.clock===e.clock,si=(n,e)=>new e2(n,e),bje=n=>{for(const[e,t]of n.doc.share.entries())if(t===n)return e;throw Vh()};class SZt{constructor(e,t,r,i=0){this.type=e,this.tname=t,this.item=r,this.assoc=i}}class _Zt{constructor(e,t,r=0){this.type=e,this.index=t,this.assoc=r}}const wZt=(n,e,t=0)=>new _Zt(n,e,t),AA=(n,e,t)=>{let r=null,i=null;return n._item===null?i=bje(n):r=si(n._item.id.client,n._item.id.clock),new SZt(r,i,e,t)},P$=(n,e,t=0)=>{let r=n._start;if(t<0){if(e===0)return AA(n,null,t);e--}for(;r!==null;){if(!r.deleted&&r.countable){if(r.length>e)return AA(n,si(r.id.client,r.id.clock+e),t);e-=r.length}if(r.right===null&&t<0)return AA(n,r.lastId,t);r=r.right}return AA(n,null,t)},k$=(n,e,t=!0)=>{const r=e.store,i=n.item,o=n.type,s=n.tname,a=n.assoc;let c=null,l=0;if(i!==null){if(va(r,i.client)<=i.clock)return null;const u=t?TSe(r,i):{item:t2(r,i),diff:0},d=u.item;if(!(d instanceof Bs))return null;if(c=d.parent,c._item===null||!c._item.deleted){l=d.deleted||!d.countable?0:u.diff+(a>=0?0:1);let h=d.left;for(;h!==null;)!h.deleted&&h.countable&&(l+=h.length),h=h.left}}else{if(s!==null)c=e.get(s);else if(o!==null){if(va(r,o.client)<=o.clock)return null;const{item:u}=t?TSe(r,o):{item:t2(r,o)};if(u instanceof Bs&&u.content instanceof Ng)c=u.content.type;else return null}else throw Vh();a>=0?l=c._length:l=0}return wZt(c,l,n.assoc)},jw=(n,e)=>e===void 0?!n.deleted:e.sv.has(n.id.client)&&(e.sv.get(n.id.client)||0)>n.id.clock&&!lje(e.ds,n.id),GX=(n,e)=>{const t=Tv(n.meta,GX,QS),r=n.doc.store;t.has(e)||(e.sv.forEach((i,o)=>{i<va(r,o)&&Ly(n,si(o,i))}),cje(n,e.ds,i=>{}),t.add(e))};class Sje{constructor(){this.clients=new Map,this.pendingStructs=null,this.pendingDs=null}}const uF=n=>{const e=new Map;return n.clients.forEach((t,r)=>{const i=t[t.length-1];e.set(r,i.id.clock+i.length)}),e},va=(n,e)=>{const t=n.clients.get(e);if(t===void 0)return 0;const r=t[t.length-1];return r.id.clock+r.length},_je=(n,e)=>{let t=n.clients.get(e.id.client);if(t===void 0)t=[],n.clients.set(e.id.client,t);else{const r=t[t.length-1];if(r.id.clock+r.length!==e.id.clock)throw Vh()}t.push(e)},xg=(n,e)=>{let t=0,r=n.length-1,i=n[r],o=i.id.clock;if(o===e)return r;let s=My(e/(o+i.length-1)*r);for(;t<=r;){if(i=n[s],o=i.id.clock,o<=e){if(e<o+i.length)return s;t=s+1}else r=s-1;s=My((t+r)/2)}throw Vh()},CZt=(n,e)=>{const t=n.clients.get(e.client);return t[xg(t,e.clock)]},t2=CZt,ZX=(n,e,t)=>{const r=xg(e,t),i=e[r];return i.id.clock<t&&i instanceof Bs?(e.splice(r+1,0,$$(n,i,t-i.id.clock)),r+1):r},Ly=(n,e)=>{const t=n.doc.store.clients.get(e.client);return t[ZX(n,t,e.clock)]},wSe=(n,e,t)=>{const r=e.clients.get(t.client),i=xg(r,t.clock),o=r[i];return t.clock!==o.id.clock+o.length-1&&o.constructor!==Th&&r.splice(i+1,0,$$(n,o,t.clock-o.id.clock+1)),o},xZt=(n,e,t)=>{const r=n.clients.get(e.id.client);r[xg(r,e.id.clock)]=t},wje=(n,e,t,r,i)=>{if(r===0)return;const o=t+r;let s=ZX(n,e,t),a;do a=e[s++],o<a.id.clock+a.length&&ZX(n,e,o),i(a);while(s<e.length&&e[s].id.clock<o)};class EZt{constructor(e,t,r){this.doc=e,this.deleteSet=new XD,this.beforeState=uF(e.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=t,this.meta=new Map,this.local=r,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set,this._needFormattingCleanup=!1}}const CSe=(n,e)=>e.deleteSet.clients.size===0&&!UKt(e.afterState,(t,r)=>e.beforeState.get(r)!==t)?!1:(Woe(e.deleteSet),lZt(n,e),wE(n,e.deleteSet),!0),xSe=(n,e,t)=>{const r=e._item;(r===null||r.id.clock<(n.beforeState.get(r.id.client)||0)&&!r.deleted)&&Tv(n.changed,e,QS).add(t)},sM=(n,e)=>{let t=n[e],r=n[e-1],i=e;for(;i>0;t=r,r=n[--i-1]){if(r.deleted===t.deleted&&r.constructor===t.constructor&&r.mergeWith(t)){t instanceof Bs&&t.parentSub!==null&&t.parent._map.get(t.parentSub)===t&&t.parent._map.set(t.parentSub,r);continue}break}const o=e-i;return o&&n.splice(e+1-o,o),o},IZt=(n,e,t)=>{for(const[r,i]of n.clients.entries()){const o=e.clients.get(r);for(let s=i.length-1;s>=0;s--){const a=i[s],c=a.clock+a.len;for(let l=xg(o,a.clock),u=o[l];l<o.length&&u.id.clock<c;u=o[++l]){const d=o[l];if(a.clock+a.len<=d.id.clock)break;d instanceof Bs&&d.deleted&&!d.keep&&t(d)&&d.gc(e,!1)}}}},PZt=(n,e)=>{n.clients.forEach((t,r)=>{const i=e.clients.get(r);for(let o=t.length-1;o>=0;o--){const s=t[o],a=Z9e(i.length-1,1+xg(i,s.clock+s.len-1));for(let c=a,l=i[c];c>0&&l.id.clock>=s.clock;l=i[c])c-=1+sM(i,c)}})},Cje=(n,e)=>{if(e<n.length){const t=n[e],r=t.doc,i=r.store,o=t.deleteSet,s=t._mergeStructs;try{Woe(o),t.afterState=uF(t.doc.store),r.emit("beforeObserverCalls",[t,r]);const a=[];t.changed.forEach((c,l)=>a.push(()=>{(l._item===null||!l._item.deleted)&&l._callObserver(t,c)})),a.push(()=>{t.changedParentTypes.forEach((c,l)=>{l._dEH.l.length>0&&(l._item===null||!l._item.deleted)&&(c=c.filter(u=>u.target._item===null||!u.target._item.deleted),c.forEach(u=>{u.currentTarget=l,u._path=null}),c.sort((u,d)=>u.path.length-d.path.length),yje(l._dEH,c,t))})}),a.push(()=>r.emit("afterTransaction",[t,r])),zoe(a,[]),t._needFormattingCleanup&&KZt(t)}finally{r.gc&&IZt(o,i,r.gcFilter),PZt(o,i),t.afterState.forEach((u,d)=>{const h=t.beforeState.get(d)||0;if(h!==u){const f=i.clients.get(d),p=v_(xg(f,h),1);for(let g=f.length-1;g>=p;)g-=1+sM(f,g)}});for(let u=s.length-1;u>=0;u--){const{client:d,clock:h}=s[u].id,f=i.clients.get(d),p=xg(f,h);p+1<f.length&&sM(f,p+1)>1||p>0&&sM(f,p)}if(!t.local&&t.afterState.get(r.clientID)!==t.beforeState.get(r.clientID)&&(JGt(sje,rje,"[yjs] ",ije,oje,"Changed the client-id because another client seems to be using it."),r.clientID=uje()),r.emit("afterTransactionCleanup",[t,r]),r._observers.has("update")){const u=new YD;CSe(u,t)&&r.emit("update",[u.toUint8Array(),t.origin,r,t])}if(r._observers.has("updateV2")){const u=new e_;CSe(u,t)&&r.emit("updateV2",[u.toUint8Array(),t.origin,r,t])}const{subdocsAdded:a,subdocsLoaded:c,subdocsRemoved:l}=t;(a.size>0||l.size>0||c.size>0)&&(a.forEach(u=>{u.clientID=r.clientID,u.collectionid==null&&(u.collectionid=r.collectionid),r.subdocs.add(u)}),l.forEach(u=>r.subdocs.delete(u)),r.emit("subdocs",[{loaded:c,added:a,removed:l},r,t]),l.forEach(u=>u.destroy())),n.length<=e+1?(r._transactionCleanups=[],r.emit("afterAllTransactions",[r,n])):Cje(n,e+1)}}},Lo=(n,e,t=null,r=!0)=>{const i=n._transactionCleanups;let o=!1,s=null;n._transaction===null&&(o=!0,n._transaction=new EZt(n,t,r),i.push(n._transaction),i.length===1&&n.emit("beforeAllTransactions",[n]),n.emit("beforeTransaction",[n._transaction,n]));try{s=e(n._transaction)}finally{if(o){const a=n._transaction===i[0];n._transaction=null,a&&Cje(i,0)}}return s};function*kZt(n){const e=ii(n.restDecoder);for(let t=0;t<e;t++){const r=ii(n.restDecoder),i=n.readClient();let o=ii(n.restDecoder);for(let s=0;s<r;s++){const a=n.readInfo();if(a===10){const c=ii(n.restDecoder);yield new Dh(si(i,o),c),o+=c}else if(sF&a){const c=(a&(Jm|Bd))===0,l=new Bs(si(i,o),null,(a&Bd)===Bd?n.readLeftID():null,null,(a&Jm)===Jm?n.readRightID():null,c?n.readParentInfo()?n.readString():n.readLeftID():null,c&&(a&tT)===tT?n.readString():null,Hje(n,a));yield l,o+=l.length}else{const c=n.readLen();yield new Th(si(i,o),c),o+=c}}}}class Goe{constructor(e,t){this.gen=kZt(e),this.curr=null,this.done=!1,this.filterSkips=t,this.next()}next(){do this.curr=this.gen.next().value||null;while(this.filterSkips&&this.curr!==null&&this.curr.constructor===Dh);return this.curr}}class Zoe{constructor(e){this.currClient=0,this.startClock=0,this.written=0,this.encoder=e,this.clientStructs=[]}}const TZt=n=>T$(n,hje,YD),DZt=(n,e)=>{if(n.constructor===Th){const{client:t,clock:r}=n.id;return new Th(si(t,r+e),n.length-e)}else if(n.constructor===Dh){const{client:t,clock:r}=n.id;return new Dh(si(t,r+e),n.length-e)}else{const t=n,{client:r,clock:i}=t.id;return new Bs(si(r,i+e),null,si(r,i+e-1),null,t.rightOrigin,t.parent,t.parentSub,t.content.splice(e))}},T$=(n,e=mx,t=e_)=>{if(n.length===1)return n[0];const r=n.map(u=>new e(_E(u)));let i=r.map(u=>new Goe(u,!0)),o=null;const s=new t,a=new Zoe(s);for(;i=i.filter(h=>h.curr!==null),i.sort((h,f)=>{if(h.curr.id.client===f.curr.id.client){const p=h.curr.id.clock-f.curr.id.clock;return p===0?h.curr.constructor===f.curr.constructor?0:h.curr.constructor===Dh?1:-1:p}else return f.curr.id.client-h.curr.id.client}),i.length!==0;){const u=i[0],d=u.curr.id.client;if(o!==null){let h=u.curr,f=!1;for(;h!==null&&h.id.clock+h.length<=o.struct.id.clock+o.struct.length&&h.id.client>=o.struct.id.client;)h=u.next(),f=!0;if(h===null||h.id.client!==d||f&&h.id.clock>o.struct.id.clock+o.struct.length)continue;if(d!==o.struct.id.client)w0(a,o.struct,o.offset),o={struct:h,offset:0},u.next();else if(o.struct.id.clock+o.struct.length<h.id.clock)if(o.struct.constructor===Dh)o.struct.length=h.id.clock+h.length-o.struct.id.clock;else{w0(a,o.struct,o.offset);const p=h.id.clock-o.struct.id.clock-o.struct.length;o={struct:new Dh(si(d,o.struct.id.clock+o.struct.length),p),offset:0}}else{const p=o.struct.id.clock+o.struct.length-h.id.clock;p>0&&(o.struct.constructor===Dh?o.struct.length-=p:h=DZt(h,p)),o.struct.mergeWith(h)||(w0(a,o.struct,o.offset),o={struct:h,offset:0},u.next())}}else o={struct:u.curr,offset:0},u.next();for(let h=u.curr;h!==null&&h.id.client===d&&h.id.clock===o.struct.id.clock+o.struct.length&&h.constructor!==Dh;h=u.next())w0(a,o.struct,o.offset),o={struct:h,offset:0}}o!==null&&(w0(a,o.struct,o.offset),o=null),Xoe(a);const c=r.map(u=>qoe(u)),l=nZt(c);return wE(s,l),s.toUint8Array()},RZt=(n,e,t=mx,r=e_)=>{const i=mje(e),o=new r,s=new Zoe(o),a=new t(_E(n)),c=new Goe(a,!1);for(;c.curr;){const u=c.curr,d=u.id.client,h=i.get(d)||0;if(c.curr.constructor===Dh){c.next();continue}if(u.id.clock+u.length>h)for(w0(s,u,v_(h-u.id.clock,0)),c.next();c.curr&&c.curr.id.client===d;)w0(s,c.curr,0),c.next();else for(;c.curr&&c.curr.id.client===d&&c.curr.id.clock+c.curr.length<=h;)c.next()}Xoe(s);const l=qoe(a);return wE(o,l),o.toUint8Array()},xje=n=>{n.written>0&&(n.clientStructs.push({written:n.written,restEncoder:Jp(n.encoder.restEncoder)}),n.encoder.restEncoder=aF(),n.written=0)},w0=(n,e,t)=>{n.written>0&&n.currClient!==e.id.client&&xje(n),n.written===0&&(n.currClient=e.id.client,n.encoder.writeClient(e.id.client),fi(n.encoder.restEncoder,e.id.clock+t)),e.write(n.encoder,t),n.written++},Xoe=n=>{xje(n);const e=n.encoder.restEncoder;fi(e,n.clientStructs.length);for(let t=0;t<n.clientStructs.length;t++){const r=n.clientStructs[t];fi(e,r.written),cF(e,r.restEncoder)}},AZt=(n,e,t,r)=>{const i=new t(_E(n)),o=new Goe(i,!1),s=new r,a=new Zoe(s);for(let l=o.curr;l!==null;l=o.next())w0(a,e(l),0);Xoe(a);const c=qoe(i);return wE(s,c),s.toUint8Array()},OZt=n=>AZt(n,MGt,mx,YD),ESe="You must not compute changes after the event-handler fired.";class dF{constructor(e,t){this.target=e,this.currentTarget=e,this.transaction=t,this._changes=null,this._keys=null,this._delta=null,this._path=null}get path(){return this._path||(this._path=MZt(this.currentTarget,this.target))}deletes(e){return lje(this.transaction.deleteSet,e.id)}get keys(){if(this._keys===null){if(this.transaction.doc._transactionCleanups.length===0)throw $y(ESe);const e=new Map,t=this.target;this.transaction.changed.get(t).forEach(i=>{if(i!==null){const o=t._map.get(i);let s,a;if(this.adds(o)){let c=o.left;for(;c!==null&&this.adds(c);)c=c.left;if(this.deletes(o))if(c!==null&&this.deletes(c))s="delete",a=hz(c.content.getContent());else return;else c!==null&&this.deletes(c)?(s="update",a=hz(c.content.getContent())):(s="add",a=void 0)}else if(this.deletes(o))s="delete",a=hz(o.content.getContent());else return;e.set(i,{action:s,oldValue:a})}}),this._keys=e}return this._keys}get delta(){return this.changes.delta}adds(e){return e.id.clock>=(this.transaction.beforeState.get(e.id.client)||0)}get changes(){let e=this._changes;if(e===null){if(this.transaction.doc._transactionCleanups.length===0)throw $y(ESe);const t=this.target,r=QS(),i=QS(),o=[];if(e={added:r,deleted:i,delta:o,keys:this.keys},this.transaction.changed.get(t).has(null)){let a=null;const c=()=>{a&&o.push(a)};for(let l=t._start;l!==null;l=l.right)l.deleted?this.deletes(l)&&!this.adds(l)&&((a===null||a.delete===void 0)&&(c(),a={delete:0}),a.delete+=l.length,i.add(l)):this.adds(l)?((a===null||a.insert===void 0)&&(c(),a={insert:[]}),a.insert=a.insert.concat(l.content.getContent()),r.add(l)):((a===null||a.retain===void 0)&&(c(),a={retain:0}),a.retain+=l.length);a!==null&&a.retain===void 0&&c()}this._changes=e}return e}}const MZt=(n,e)=>{const t=[];for(;e._item!==null&&e!==n;){if(e._item.parentSub!==null)t.unshift(e._item.parentSub);else{let r=0,i=e._item.parent._start;for(;i!==e._item&&i!==null;)!i.deleted&&i.countable&&(r+=i.length),i=i.right;t.unshift(r)}e=e._item.parent}return t},Eje=80;let Yoe=0;class $Zt{constructor(e,t){e.marker=!0,this.p=e,this.index=t,this.timestamp=Yoe++}}const LZt=n=>{n.timestamp=Yoe++},Ije=(n,e,t)=>{n.p.marker=!1,n.p=e,e.marker=!0,n.index=t,n.timestamp=Yoe++},NZt=(n,e,t)=>{if(n.length>=Eje){const r=n.reduce((i,o)=>i.timestamp<o.timestamp?i:o);return Ije(r,e,t),r}else{const r=new $Zt(e,t);return n.push(r),r}},hF=(n,e)=>{if(n._start===null||e===0||n._searchMarker===null)return null;const t=n._searchMarker.length===0?null:n._searchMarker.reduce((o,s)=>rM(e-o.index)<rM(e-s.index)?o:s);let r=n._start,i=0;for(t!==null&&(r=t.p,i=t.index,LZt(t));r.right!==null&&i<e;){if(!r.deleted&&r.countable){if(e<i+r.length)break;i+=r.length}r=r.right}for(;r.left!==null&&i>e;)r=r.left,!r.deleted&&r.countable&&(i-=r.length);for(;r.left!==null&&r.left.id.client===r.id.client&&r.left.id.clock+r.left.length===r.id.clock;)r=r.left,!r.deleted&&r.countable&&(i-=r.length);return t!==null&&rM(t.index-i)<r.parent.length/Eje?(Ije(t,r,i),t):NZt(n._searchMarker,r,i)},sT=(n,e,t)=>{for(let r=n.length-1;r>=0;r--){const i=n[r];if(t>0){let o=i.p;for(o.marker=!1;o&&(o.deleted||!o.countable);)o=o.left,o&&!o.deleted&&o.countable&&(i.index-=o.length);if(o===null||o.marker===!0){n.splice(r,1);continue}i.p=o,o.marker=!0}(e<i.index||t>0&&e===i.index)&&(i.index=v_(e,i.index+t))}},fF=(n,e,t)=>{const r=n,i=e.changedParentTypes;for(;Tv(i,n,()=>[]).push(t),n._item!==null;)n=n._item.parent;yje(r._eH,t,e)};class Kc{constructor(){this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=bSe(),this._dEH=bSe(),this._searchMarker=null}get parent(){return this._item?this._item.parent:null}_integrate(e,t){this.doc=e,this._item=t}_copy(){throw ag()}clone(){throw ag()}_write(e){}get _first(){let e=this._start;for(;e!==null&&e.deleted;)e=e.right;return e}_callObserver(e,t){!e.local&&this._searchMarker&&(this._searchMarker.length=0)}observe(e){SSe(this._eH,e)}observeDeep(e){SSe(this._dEH,e)}unobserve(e){_Se(this._eH,e)}unobserveDeep(e){_Se(this._dEH,e)}toJSON(){}}const Pje=(n,e,t)=>{e<0&&(e=n._length+e),t<0&&(t=n._length+t);let r=t-e;const i=[];let o=n._start;for(;o!==null&&r>0;){if(o.countable&&!o.deleted){const s=o.content.getContent();if(s.length<=e)e-=s.length;else{for(let a=e;a<s.length&&r>0;a++)i.push(s[a]),r--;e=0}}o=o.right}return i},kje=n=>{const e=[];let t=n._start;for(;t!==null;){if(t.countable&&!t.deleted){const r=t.content.getContent();for(let i=0;i<r.length;i++)e.push(r[i])}t=t.right}return e},aT=(n,e)=>{let t=0,r=n._start;for(;r!==null;){if(r.countable&&!r.deleted){const i=r.content.getContent();for(let o=0;o<i.length;o++)e(i[o],t++,n)}r=r.right}},Tje=(n,e)=>{const t=[];return aT(n,(r,i)=>{t.push(e(r,i,n))}),t},FZt=n=>{let e=n._start,t=null,r=0;return{[Symbol.iterator](){return this},next:()=>{if(t===null){for(;e!==null&&e.deleted;)e=e.right;if(e===null)return{done:!0,value:void 0};t=e.content.getContent(),r=0,e=e.right}const i=t[r++];return t.length<=r&&(t=null),{done:!1,value:i}}}},Dje=(n,e)=>{const t=hF(n,e);let r=n._start;for(t!==null&&(r=t.p,e-=t.index);r!==null;r=r.right)if(!r.deleted&&r.countable){if(e<r.length)return r.content.getContent()[e];e-=r.length}},D$=(n,e,t,r)=>{let i=t;const o=n.doc,s=o.clientID,a=o.store,c=t===null?e._start:t.right;let l=[];const u=()=>{l.length>0&&(i=new Bs(si(s,va(a,s)),i,i&&i.lastId,c,c&&c.id,e,null,new n_(l)),i.integrate(n,0),l=[])};r.forEach(d=>{if(d===null)l.push(d);else switch(d.constructor){case Number:case Object:case Boolean:case Array:case String:l.push(d);break;default:switch(u(),d.constructor){case Uint8Array:case ArrayBuffer:i=new Bs(si(s,va(a,s)),i,i&&i.lastId,c,c&&c.id,e,null,new JD(new Uint8Array(d))),i.integrate(n,0);break;case y_:i=new Bs(si(s,va(a,s)),i,i&&i.lastId,c,c&&c.id,e,null,new QD(d)),i.integrate(n,0);break;default:if(d instanceof Kc)i=new Bs(si(s,va(a,s)),i,i&&i.lastId,c,c&&c.id,e,null,new Ng(d)),i.integrate(n,0);else throw new Error("Unexpected content type in insert operation")}}}),u()},Rje=()=>$y("Length exceeded!"),Aje=(n,e,t,r)=>{if(t>e._length)throw Rje();if(t===0)return e._searchMarker&&sT(e._searchMarker,t,r.length),D$(n,e,null,r);const i=t,o=hF(e,t);let s=e._start;for(o!==null&&(s=o.p,t-=o.index,t===0&&(s=s.prev,t+=s&&s.countable&&!s.deleted?s.length:0));s!==null;s=s.right)if(!s.deleted&&s.countable){if(t<=s.length){t<s.length&&Ly(n,si(s.id.client,s.id.clock+t));break}t-=s.length}return e._searchMarker&&sT(e._searchMarker,i,r.length),D$(n,e,s,r)},jZt=(n,e,t)=>{let i=(e._searchMarker||[]).reduce((o,s)=>s.index>o.index?s:o,{index:0,p:e._start}).p;if(i)for(;i.right;)i=i.right;return D$(n,e,i,t)},Oje=(n,e,t,r)=>{if(r===0)return;const i=t,o=r,s=hF(e,t);let a=e._start;for(s!==null&&(a=s.p,t-=s.index);a!==null&&t>0;a=a.right)!a.deleted&&a.countable&&(t<a.length&&Ly(n,si(a.id.client,a.id.clock+t)),t-=a.length);for(;r>0&&a!==null;)a.deleted||(r<a.length&&Ly(n,si(a.id.client,a.id.clock+r)),a.delete(n),r-=a.length),a=a.right;if(r>0)throw Rje();e._searchMarker&&sT(e._searchMarker,i,-o+r)},R$=(n,e,t)=>{const r=e._map.get(t);r!==void 0&&r.delete(n)},Joe=(n,e,t,r)=>{const i=e._map.get(t)||null,o=n.doc,s=o.clientID;let a;if(r==null)a=new n_([r]);else switch(r.constructor){case Number:case Object:case Boolean:case Array:case String:a=new n_([r]);break;case Uint8Array:a=new JD(r);break;case y_:a=new QD(r);break;default:if(r instanceof Kc)a=new Ng(r);else throw new Error("Unexpected content type")}new Bs(si(s,va(o.store,s)),i,i&&i.lastId,null,null,e,t,a).integrate(n,0)},Qoe=(n,e)=>{const t=n._map.get(e);return t!==void 0&&!t.deleted?t.content.getContent()[t.length-1]:void 0},Mje=n=>{const e={};return n._map.forEach((t,r)=>{t.deleted||(e[r]=t.content.getContent()[t.length-1])}),e},$je=(n,e)=>{const t=n._map.get(e);return t!==void 0&&!t.deleted},BZt=(n,e)=>{const t={};return n._map.forEach((r,i)=>{let o=r;for(;o!==null&&(!e.sv.has(o.id.client)||o.id.clock>=(e.sv.get(o.id.client)||0));)o=o.left;o!==null&&jw(o,e)&&(t[i]=o.content.getContent()[o.length-1])}),t},OA=n=>eZt(n.entries(),e=>!e[1].deleted);class HZt extends dF{}class n2 extends Kc{constructor(){super(),this._prelimContent=[],this._searchMarker=[]}static from(e){const t=new n2;return t.push(e),t}_integrate(e,t){super._integrate(e,t),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new n2}clone(){const e=new n2;return e.insert(0,this.toArray().map(t=>t instanceof Kc?t.clone():t)),e}get length(){return this._prelimContent===null?this._length:this._prelimContent.length}_callObserver(e,t){super._callObserver(e,t),fF(this,e,new HZt(this,e))}insert(e,t){this.doc!==null?Lo(this.doc,r=>{Aje(r,this,e,t)}):this._prelimContent.splice(e,0,...t)}push(e){this.doc!==null?Lo(this.doc,t=>{jZt(t,this,e)}):this._prelimContent.push(...e)}unshift(e){this.insert(0,e)}delete(e,t=1){this.doc!==null?Lo(this.doc,r=>{Oje(r,this,e,t)}):this._prelimContent.splice(e,t)}get(e){return Dje(this,e)}toArray(){return kje(this)}slice(e=0,t=this.length){return Pje(this,e,t)}toJSON(){return this.map(e=>e instanceof Kc?e.toJSON():e)}map(e){return Tje(this,e)}forEach(e){aT(this,e)}[Symbol.iterator](){return FZt(this)}_write(e){e.writeTypeRef(dXt)}}const UZt=n=>new n2;class zZt extends dF{constructor(e,t,r){super(e,t),this.keysChanged=r}}class vx extends Kc{constructor(e){super(),this._prelimContent=null,e===void 0?this._prelimContent=new Map:this._prelimContent=new Map(e)}_integrate(e,t){super._integrate(e,t),this._prelimContent.forEach((r,i)=>{this.set(i,r)}),this._prelimContent=null}_copy(){return new vx}clone(){const e=new vx;return this.forEach((t,r)=>{e.set(r,t instanceof Kc?t.clone():t)}),e}_callObserver(e,t){fF(this,e,new zZt(this,e,t))}toJSON(){const e={};return this._map.forEach((t,r)=>{if(!t.deleted){const i=t.content.getContent()[t.length-1];e[r]=i instanceof Kc?i.toJSON():i}}),e}get size(){return[...OA(this._map)].length}keys(){return vz(OA(this._map),e=>e[0])}values(){return vz(OA(this._map),e=>e[1].content.getContent()[e[1].length-1])}entries(){return vz(OA(this._map),e=>[e[0],e[1].content.getContent()[e[1].length-1]])}forEach(e){this._map.forEach((t,r)=>{t.deleted||e(t.content.getContent()[t.length-1],r,this)})}[Symbol.iterator](){return this.entries()}delete(e){this.doc!==null?Lo(this.doc,t=>{R$(t,this,e)}):this._prelimContent.delete(e)}set(e,t){return this.doc!==null?Lo(this.doc,r=>{Joe(r,this,e,t)}):this._prelimContent.set(e,t),t}get(e){return Qoe(this,e)}has(e){return $je(this,e)}clear(){this.doc!==null?Lo(this.doc,e=>{this.forEach(function(t,r,i){R$(e,i,r)})}):this._prelimContent.clear()}_write(e){e.writeTypeRef(hXt)}}const VZt=n=>new vx,G0=(n,e)=>n===e||typeof n=="object"&&typeof e=="object"&&n&&e&&OGt(n,e);class XX{constructor(e,t,r,i){this.left=e,this.right=t,this.index=r,this.currentAttributes=i}forward(){switch(this.right===null&&Vh(),this.right.content.constructor){case Ua:this.right.deleted||CE(this.currentAttributes,this.right.content);break;default:this.right.deleted||(this.index+=this.right.length);break}this.left=this.right,this.right=this.right.right}}const ISe=(n,e,t)=>{for(;e.right!==null&&t>0;){switch(e.right.content.constructor){case Ua:e.right.deleted||CE(e.currentAttributes,e.right.content);break;default:e.right.deleted||(t<e.right.length&&Ly(n,si(e.right.id.client,e.right.id.clock+t)),e.index+=e.right.length,t-=e.right.length);break}e.left=e.right,e.right=e.right.right}return e},MA=(n,e,t,r)=>{const i=new Map,o=r?hF(e,t):null;if(o){const s=new XX(o.p.left,o.p,o.index,i);return ISe(n,s,t-o.index)}else{const s=new XX(null,e._start,0,i);return ISe(n,s,t)}},Lje=(n,e,t,r)=>{for(;t.right!==null&&(t.right.deleted===!0||t.right.content.constructor===Ua&&G0(r.get(t.right.content.key),t.right.content.value));)t.right.deleted||r.delete(t.right.content.key),t.forward();const i=n.doc,o=i.clientID;r.forEach((s,a)=>{const c=t.left,l=t.right,u=new Bs(si(o,va(i.store,o)),c,c&&c.lastId,l,l&&l.id,e,null,new Ua(a,s));u.integrate(n,0),t.right=u,t.forward()})},CE=(n,e)=>{const{key:t,value:r}=e;r===null?n.delete(t):n.set(t,r)},Nje=(n,e)=>{for(;n.right!==null;){if(!(n.right.deleted||n.right.content.constructor===Ua&&G0(e[n.right.content.key]??null,n.right.content.value)))break;n.forward()}},Fje=(n,e,t,r)=>{const i=n.doc,o=i.clientID,s=new Map;for(const a in r){const c=r[a],l=t.currentAttributes.get(a)??null;if(!G0(l,c)){s.set(a,l);const{left:u,right:d}=t;t.right=new Bs(si(o,va(i.store,o)),u,u&&u.lastId,d,d&&d.id,e,null,new Ua(a,c)),t.right.integrate(n,0),t.forward()}}return s},yz=(n,e,t,r,i)=>{t.currentAttributes.forEach((h,f)=>{i[f]===void 0&&(i[f]=null)});const o=n.doc,s=o.clientID;Nje(t,i);const a=Fje(n,e,t,i),c=r.constructor===String?new Eg(r):r instanceof Kc?new Ng(r):new b_(r);let{left:l,right:u,index:d}=t;e._searchMarker&&sT(e._searchMarker,t.index,c.getLength()),u=new Bs(si(s,va(o.store,s)),l,l&&l.lastId,u,u&&u.id,e,null,c),u.integrate(n,0),t.right=u,t.index=d,t.forward(),Lje(n,e,t,a)},PSe=(n,e,t,r,i)=>{const o=n.doc,s=o.clientID;Nje(t,i);const a=Fje(n,e,t,i);e:for(;t.right!==null&&(r>0||a.size>0&&(t.right.deleted||t.right.content.constructor===Ua));){if(!t.right.deleted)switch(t.right.content.constructor){case Ua:{const{key:c,value:l}=t.right.content,u=i[c];if(u!==void 0){if(G0(u,l))a.delete(c);else{if(r===0)break e;a.set(c,l)}t.right.delete(n)}else t.currentAttributes.set(c,l);break}default:r<t.right.length&&Ly(n,si(t.right.id.client,t.right.id.clock+r)),r-=t.right.length;break}t.forward()}if(r>0){let c="";for(;r>0;r--)c+=`
`;t.right=new Bs(si(s,va(o.store,s)),t.left,t.left&&t.left.lastId,t.right,t.right&&t.right.id,e,null,new Eg(c)),t.right.integrate(n,0),t.forward()}Lje(n,e,t,a)},jje=(n,e,t,r,i)=>{let o=e;const s=Vu();for(;o&&(!o.countable||o.deleted);){if(!o.deleted&&o.content.constructor===Ua){const l=o.content;s.set(l.key,l)}o=o.right}let a=0,c=!1;for(;e!==o;){if(t===e&&(c=!0),!e.deleted){const l=e.content;switch(l.constructor){case Ua:{const{key:u,value:d}=l,h=r.get(u)??null;(s.get(u)!==l||h===d)&&(e.delete(n),a++,!c&&(i.get(u)??null)===d&&h!==d&&(h===null?i.delete(u):i.set(u,h))),!c&&!e.deleted&&CE(i,l);break}}}e=e.right}return a},WZt=(n,e)=>{for(;e&&e.right&&(e.right.deleted||!e.right.countable);)e=e.right;const t=new Set;for(;e&&(e.deleted||!e.countable);){if(!e.deleted&&e.content.constructor===Ua){const r=e.content.key;t.has(r)?e.delete(n):t.add(r)}e=e.left}},qZt=n=>{let e=0;return Lo(n.doc,t=>{let r=n._start,i=n._start,o=Vu();const s=UX(o);for(;i;){if(i.deleted===!1)switch(i.content.constructor){case Ua:CE(s,i.content);break;default:e+=jje(t,r,i,o,s),o=UX(s),r=i;break}i=i.right}}),e},KZt=n=>{const e=new Set,t=n.doc;for(const[r,i]of n.afterState.entries()){const o=n.beforeState.get(r)||0;i!==o&&wje(n,t.store.clients.get(r),o,i,s=>{!s.deleted&&s.content.constructor===Ua&&s.constructor!==Th&&e.add(s.parent)})}Lo(t,r=>{cje(n,n.deleteSet,i=>{if(i instanceof Th||!i.parent._hasFormatting||e.has(i.parent))return;const o=i.parent;i.content.constructor===Ua?e.add(o):WZt(r,i)});for(const i of e)qZt(i)})},kSe=(n,e,t)=>{const r=t,i=UX(e.currentAttributes),o=e.right;for(;t>0&&e.right!==null;){if(e.right.deleted===!1)switch(e.right.content.constructor){case Ng:case b_:case Eg:t<e.right.length&&Ly(n,si(e.right.id.client,e.right.id.clock+t)),t-=e.right.length,e.right.delete(n);break}e.forward()}o&&jje(n,o,e.right,i,e.currentAttributes);const s=(e.left||e.right).parent;return s._searchMarker&&sT(s._searchMarker,e.index,-r+t),e};class GZt extends dF{constructor(e,t,r){super(e,t),this.childListChanged=!1,this.keysChanged=new Set,r.forEach(i=>{i===null?this.childListChanged=!0:this.keysChanged.add(i)})}get changes(){if(this._changes===null){const e={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set};this._changes=e}return this._changes}get delta(){if(this._delta===null){const e=this.target.doc,t=[];Lo(e,r=>{const i=new Map,o=new Map;let s=this.target._start,a=null;const c={};let l="",u=0,d=0;const h=()=>{if(a!==null){let f=null;switch(a){case"delete":d>0&&(f={delete:d}),d=0;break;case"insert":(typeof l=="object"||l.length>0)&&(f={insert:l},i.size>0&&(f.attributes={},i.forEach((p,g)=>{p!==null&&(f.attributes[g]=p)}))),l="";break;case"retain":u>0&&(f={retain:u},DGt(c)||(f.attributes=PGt({},c))),u=0;break}f&&t.push(f),a=null}};for(;s!==null;){switch(s.content.constructor){case Ng:case b_:this.adds(s)?this.deletes(s)||(h(),a="insert",l=s.content.getContent()[0],h()):this.deletes(s)?(a!=="delete"&&(h(),a="delete"),d+=1):s.deleted||(a!=="retain"&&(h(),a="retain"),u+=1);break;case Eg:this.adds(s)?this.deletes(s)||(a!=="insert"&&(h(),a="insert"),l+=s.content.str):this.deletes(s)?(a!=="delete"&&(h(),a="delete"),d+=s.length):s.deleted||(a!=="retain"&&(h(),a="retain"),u+=s.length);break;case Ua:{const{key:f,value:p}=s.content;if(this.adds(s)){if(!this.deletes(s)){const g=i.get(f)??null;G0(g,p)?p!==null&&s.delete(r):(a==="retain"&&h(),G0(p,o.get(f)??null)?delete c[f]:c[f]=p)}}else if(this.deletes(s)){o.set(f,p);const g=i.get(f)??null;G0(g,p)||(a==="retain"&&h(),c[f]=g)}else if(!s.deleted){o.set(f,p);const g=c[f];g!==void 0&&(G0(g,p)?g!==null&&s.delete(r):(a==="retain"&&h(),p===null?delete c[f]:c[f]=p))}s.deleted||(a==="insert"&&h(),CE(i,s.content));break}}s=s.right}for(h();t.length>0;){const f=t[t.length-1];if(f.retain!==void 0&&f.attributes===void 0)t.pop();else break}}),this._delta=t}return this._delta}}class yx extends Kc{constructor(e){super(),this._pending=e!==void 0?[()=>this.insert(0,e)]:[],this._searchMarker=[],this._hasFormatting=!1}get length(){return this._length}_integrate(e,t){super._integrate(e,t);try{this._pending.forEach(r=>r())}catch(r){console.error(r)}this._pending=null}_copy(){return new yx}clone(){const e=new yx;return e.applyDelta(this.toDelta()),e}_callObserver(e,t){super._callObserver(e,t);const r=new GZt(this,e,t);fF(this,e,r),!e.local&&this._hasFormatting&&(e._needFormattingCleanup=!0)}toString(){let e="",t=this._start;for(;t!==null;)!t.deleted&&t.countable&&t.content.constructor===Eg&&(e+=t.content.str),t=t.right;return e}toJSON(){return this.toString()}applyDelta(e,{sanitize:t=!0}={}){this.doc!==null?Lo(this.doc,r=>{const i=new XX(null,this._start,0,new Map);for(let o=0;o<e.length;o++){const s=e[o];if(s.insert!==void 0){const a=!t&&typeof s.insert=="string"&&o===e.length-1&&i.right===null&&s.insert.slice(-1)===`
`?s.insert.slice(0,-1):s.insert;(typeof a!="string"||a.length>0)&&yz(r,this,i,a,s.attributes||{})}else s.retain!==void 0?PSe(r,this,i,s.retain,s.attributes||{}):s.delete!==void 0&&kSe(r,i,s.delete)}}):this._pending.push(()=>this.applyDelta(e))}toDelta(e,t,r){const i=[],o=new Map,s=this.doc;let a="",c=this._start;function l(){if(a.length>0){const d={};let h=!1;o.forEach((p,g)=>{h=!0,d[g]=p});const f={insert:a};h&&(f.attributes=d),i.push(f),a=""}}const u=()=>{for(;c!==null;){if(jw(c,e)||t!==void 0&&jw(c,t))switch(c.content.constructor){case Eg:{const d=o.get("ychange");e!==void 0&&!jw(c,e)?(d===void 0||d.user!==c.id.client||d.type!=="removed")&&(l(),o.set("ychange",r?r("removed",c.id):{type:"removed"})):t!==void 0&&!jw(c,t)?(d===void 0||d.user!==c.id.client||d.type!=="added")&&(l(),o.set("ychange",r?r("added",c.id):{type:"added"})):d!==void 0&&(l(),o.delete("ychange")),a+=c.content.str;break}case Ng:case b_:{l();const d={insert:c.content.getContent()[0]};if(o.size>0){const h={};d.attributes=h,o.forEach((f,p)=>{h[p]=f})}i.push(d);break}case Ua:jw(c,e)&&(l(),CE(o,c.content));break}c=c.right}l()};return e||t?Lo(s,d=>{e&&GX(d,e),t&&GX(d,t),u()},"cleanup"):u(),i}insert(e,t,r){if(t.length<=0)return;const i=this.doc;i!==null?Lo(i,o=>{const s=MA(o,this,e,!r);r||(r={},s.currentAttributes.forEach((a,c)=>{r[c]=a})),yz(o,this,s,t,r)}):this._pending.push(()=>this.insert(e,t,r))}insertEmbed(e,t,r){const i=this.doc;i!==null?Lo(i,o=>{const s=MA(o,this,e,!r);yz(o,this,s,t,r||{})}):this._pending.push(()=>this.insertEmbed(e,t,r||{}))}delete(e,t){if(t===0)return;const r=this.doc;r!==null?Lo(r,i=>{kSe(i,MA(i,this,e,!0),t)}):this._pending.push(()=>this.delete(e,t))}format(e,t,r){if(t===0)return;const i=this.doc;i!==null?Lo(i,o=>{const s=MA(o,this,e,!1);s.right!==null&&PSe(o,this,s,t,r)}):this._pending.push(()=>this.format(e,t,r))}removeAttribute(e){this.doc!==null?Lo(this.doc,t=>{R$(t,this,e)}):this._pending.push(()=>this.removeAttribute(e))}setAttribute(e,t){this.doc!==null?Lo(this.doc,r=>{Joe(r,this,e,t)}):this._pending.push(()=>this.setAttribute(e,t))}getAttribute(e){return Qoe(this,e)}getAttributes(){return Mje(this)}_write(e){e.writeTypeRef(fXt)}}const ZZt=n=>new yx;class bz{constructor(e,t=()=>!0){this._filter=t,this._root=e,this._currentNode=e._start,this._firstCall=!0}[Symbol.iterator](){return this}next(){let e=this._currentNode,t=e&&e.content&&e.content.type;if(e!==null&&(!this._firstCall||e.deleted||!this._filter(t)))do if(t=e.content.type,!e.deleted&&(t.constructor===bx||t.constructor===t_)&&t._start!==null)e=t._start;else for(;e!==null;)if(e.right!==null){e=e.right;break}else e.parent===this._root?e=null:e=e.parent._item;while(e!==null&&(e.deleted||!this._filter(e.content.type)));return this._firstCall=!1,e===null?{value:void 0,done:!0}:(this._currentNode=e,{value:e.content.type,done:!1})}}class t_ extends Kc{constructor(){super(),this._prelimContent=[]}get firstChild(){const e=this._first;return e?e.content.getContent()[0]:null}_integrate(e,t){super._integrate(e,t),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new t_}clone(){const e=new t_;return e.insert(0,this.toArray().map(t=>t instanceof Kc?t.clone():t)),e}get length(){return this._prelimContent===null?this._length:this._prelimContent.length}createTreeWalker(e){return new bz(this,e)}querySelector(e){e=e.toUpperCase();const r=new bz(this,i=>i.nodeName&&i.nodeName.toUpperCase()===e).next();return r.done?null:r.value}querySelectorAll(e){return e=e.toUpperCase(),gv(new bz(this,t=>t.nodeName&&t.nodeName.toUpperCase()===e))}_callObserver(e,t){fF(this,e,new JZt(this,t,e))}toString(){return Tje(this,e=>e.toString()).join("")}toJSON(){return this.toString()}toDOM(e=document,t={},r){const i=e.createDocumentFragment();return r!==void 0&&r._createAssociation(i,this),aT(this,o=>{i.insertBefore(o.toDOM(e,t,r),null)}),i}insert(e,t){this.doc!==null?Lo(this.doc,r=>{Aje(r,this,e,t)}):this._prelimContent.splice(e,0,...t)}insertAfter(e,t){if(this.doc!==null)Lo(this.doc,r=>{const i=e&&e instanceof Kc?e._item:e;D$(r,this,i,t)});else{const r=this._prelimContent,i=e===null?0:r.findIndex(o=>o===e)+1;if(i===0&&e!==null)throw $y("Reference item not found");r.splice(i,0,...t)}}delete(e,t=1){this.doc!==null?Lo(this.doc,r=>{Oje(r,this,e,t)}):this._prelimContent.splice(e,t)}toArray(){return kje(this)}push(e){this.insert(this.length,e)}unshift(e){this.insert(0,e)}get(e){return Dje(this,e)}slice(e=0,t=this.length){return Pje(this,e,t)}forEach(e){aT(this,e)}_write(e){e.writeTypeRef(gXt)}}const XZt=n=>new t_;class bx extends t_{constructor(e="UNDEFINED"){super(),this.nodeName=e,this._prelimAttrs=new Map}get nextSibling(){const e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){const e=this._item?this._item.prev:null;return e?e.content.type:null}_integrate(e,t){super._integrate(e,t),this._prelimAttrs.forEach((r,i)=>{this.setAttribute(i,r)}),this._prelimAttrs=null}_copy(){return new bx(this.nodeName)}clone(){const e=new bx(this.nodeName),t=this.getAttributes();return TGt(t,(r,i)=>{typeof r=="string"&&e.setAttribute(i,r)}),e.insert(0,this.toArray().map(r=>r instanceof Kc?r.clone():r)),e}toString(){const e=this.getAttributes(),t=[],r=[];for(const a in e)r.push(a);r.sort();const i=r.length;for(let a=0;a<i;a++){const c=r[a];t.push(c+'="'+e[c]+'"')}const o=this.nodeName.toLocaleLowerCase(),s=t.length>0?" "+t.join(" "):"";return`<${o}${s}>${super.toString()}</${o}>`}removeAttribute(e){this.doc!==null?Lo(this.doc,t=>{R$(t,this,e)}):this._prelimAttrs.delete(e)}setAttribute(e,t){this.doc!==null?Lo(this.doc,r=>{Joe(r,this,e,t)}):this._prelimAttrs.set(e,t)}getAttribute(e){return Qoe(this,e)}hasAttribute(e){return $je(this,e)}getAttributes(e){return e?BZt(this,e):Mje(this)}toDOM(e=document,t={},r){const i=e.createElement(this.nodeName),o=this.getAttributes();for(const s in o){const a=o[s];typeof a=="string"&&i.setAttribute(s,a)}return aT(this,s=>{i.appendChild(s.toDOM(e,t,r))}),r!==void 0&&r._createAssociation(i,this),i}_write(e){e.writeTypeRef(pXt),e.writeKey(this.nodeName)}}const YZt=n=>new bx(n.readKey());class JZt extends dF{constructor(e,t,r){super(e,r),this.childListChanged=!1,this.attributesChanged=new Set,t.forEach(i=>{i===null?this.childListChanged=!0:this.attributesChanged.add(i)})}}class A$ extends vx{constructor(e){super(),this.hookName=e}_copy(){return new A$(this.hookName)}clone(){const e=new A$(this.hookName);return this.forEach((t,r)=>{e.set(r,t)}),e}toDOM(e=document,t={},r){const i=t[this.hookName];let o;return i!==void 0?o=i.createDom(this):o=document.createElement(this.hookName),o.setAttribute("data-yjs-hook",this.hookName),r!==void 0&&r._createAssociation(o,this),o}_write(e){e.writeTypeRef(mXt),e.writeKey(this.hookName)}}const QZt=n=>new A$(n.readKey());class O$ extends yx{get nextSibling(){const e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){const e=this._item?this._item.prev:null;return e?e.content.type:null}_copy(){return new O$}clone(){const e=new O$;return e.applyDelta(this.toDelta()),e}toDOM(e=document,t,r){const i=e.createTextNode(this.toString());return r!==void 0&&r._createAssociation(i,this),i}toString(){return this.toDelta().map(e=>{const t=[];for(const i in e.attributes){const o=[];for(const s in e.attributes[i])o.push({key:s,value:e.attributes[i][s]});o.sort((s,a)=>s.key<a.key?-1:1),t.push({nodeName:i,attrs:o})}t.sort((i,o)=>i.nodeName<o.nodeName?-1:1);let r="";for(let i=0;i<t.length;i++){const o=t[i];r+=`<${o.nodeName}`;for(let s=0;s<o.attrs.length;s++){const a=o.attrs[s];r+=` ${a.key}="${a.value}"`}r+=">"}r+=e.insert;for(let i=t.length-1;i>=0;i--)r+=`</${t[i].nodeName}>`;return r}).join("")}toJSON(){return this.toString()}_write(e){e.writeTypeRef(vXt)}}const eXt=n=>new O$;class ese{constructor(e,t){this.id=e,this.length=t}get deleted(){throw ag()}mergeWith(e){return!1}write(e,t,r){throw ag()}integrate(e,t){throw ag()}}const tXt=0;class Th extends ese{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor!==e.constructor?!1:(this.length+=e.length,!0)}integrate(e,t){t>0&&(this.id.clock+=t,this.length-=t),_je(e.doc.store,this)}write(e,t){e.writeInfo(tXt),e.writeLen(this.length-t)}getMissing(e,t){return null}}class JD{constructor(e){this.content=e}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new JD(this.content)}splice(e){throw ag()}mergeWith(e){return!1}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeBuf(this.content)}getRef(){return 3}}const nXt=n=>new JD(n.readBuf());class cT{constructor(e){this.len=e}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new cT(this.len)}splice(e){const t=new cT(this.len-e);return this.len=e,t}mergeWith(e){return this.len+=e.len,!0}integrate(e,t){I$(e.deleteSet,t.id.client,t.id.clock,this.len),t.markDeleted()}delete(e){}gc(e){}write(e,t){e.writeLen(this.len-t)}getRef(){return 1}}const rXt=n=>new cT(n.readLen()),Bje=(n,e)=>new y_({guid:n,...e,shouldLoad:e.shouldLoad||e.autoLoad||!1});class QD{constructor(e){e._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=e;const t={};this.opts=t,e.gc||(t.gc=!1),e.autoLoad&&(t.autoLoad=!0),e.meta!==null&&(t.meta=e.meta)}getLength(){return 1}getContent(){return[this.doc]}isCountable(){return!0}copy(){return new QD(Bje(this.doc.guid,this.opts))}splice(e){throw ag()}mergeWith(e){return!1}integrate(e,t){this.doc._item=t,e.subdocsAdded.add(this.doc),this.doc.shouldLoad&&e.subdocsLoaded.add(this.doc)}delete(e){e.subdocsAdded.has(this.doc)?e.subdocsAdded.delete(this.doc):e.subdocsRemoved.add(this.doc)}gc(e){}write(e,t){e.writeString(this.doc.guid),e.writeAny(this.opts)}getRef(){return 9}}const iXt=n=>new QD(Bje(n.readString(),n.readAny()));class b_{constructor(e){this.embed=e}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new b_(this.embed)}splice(e){throw ag()}mergeWith(e){return!1}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeJSON(this.embed)}getRef(){return 5}}const oXt=n=>new b_(n.readJSON());class Ua{constructor(e,t){this.key=e,this.value=t}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new Ua(this.key,this.value)}splice(e){throw ag()}mergeWith(e){return!1}integrate(e,t){const r=t.parent;r._searchMarker=null,r._hasFormatting=!0}delete(e){}gc(e){}write(e,t){e.writeKey(this.key),e.writeJSON(this.value)}getRef(){return 6}}const sXt=n=>new Ua(n.readKey(),n.readJSON());class M${constructor(e){this.arr=e}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new M$(this.arr)}splice(e){const t=new M$(this.arr.slice(e));return this.arr=this.arr.slice(0,e),t}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){const r=this.arr.length;e.writeLen(r-t);for(let i=t;i<r;i++){const o=this.arr[i];e.writeString(o===void 0?"undefined":JSON.stringify(o))}}getRef(){return 2}}const aXt=n=>{const e=n.readLen(),t=[];for(let r=0;r<e;r++){const i=n.readString();i==="undefined"?t.push(void 0):t.push(JSON.parse(i))}return new M$(t)};class n_{constructor(e){this.arr=e}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new n_(this.arr)}splice(e){const t=new n_(this.arr.slice(e));return this.arr=this.arr.slice(0,e),t}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){const r=this.arr.length;e.writeLen(r-t);for(let i=t;i<r;i++){const o=this.arr[i];e.writeAny(o)}}getRef(){return 8}}const cXt=n=>{const e=n.readLen(),t=[];for(let r=0;r<e;r++)t.push(n.readAny());return new n_(t)};class Eg{constructor(e){this.str=e}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new Eg(this.str)}splice(e){const t=new Eg(this.str.slice(e));this.str=this.str.slice(0,e);const r=this.str.charCodeAt(e-1);return r>=55296&&r<=56319&&(this.str=this.str.slice(0,e-1)+"�",t.str="�"+t.str.slice(1)),t}mergeWith(e){return this.str+=e.str,!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeString(t===0?this.str:this.str.slice(t))}getRef(){return 4}}const lXt=n=>new Eg(n.readString()),uXt=[UZt,VZt,ZZt,YZt,XZt,QZt,eXt],dXt=0,hXt=1,fXt=2,pXt=3,gXt=4,mXt=5,vXt=6;class Ng{constructor(e){this.type=e}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new Ng(this.type._copy())}splice(e){throw ag()}mergeWith(e){return!1}integrate(e,t){this.type._integrate(e.doc,t)}delete(e){let t=this.type._start;for(;t!==null;)t.deleted?t.id.clock<(e.beforeState.get(t.id.client)||0)&&e._mergeStructs.push(t):t.delete(e),t=t.right;this.type._map.forEach(r=>{r.deleted?r.id.clock<(e.beforeState.get(r.id.client)||0)&&e._mergeStructs.push(r):r.delete(e)}),e.changed.delete(this.type)}gc(e){let t=this.type._start;for(;t!==null;)t.gc(e,!0),t=t.right;this.type._start=null,this.type._map.forEach(r=>{for(;r!==null;)r.gc(e,!0),r=r.left}),this.type._map=new Map}write(e,t){this.type._write(e)}getRef(){return 7}}const yXt=n=>new Ng(uXt[n.readTypeRef()](n)),TSe=(n,e)=>{let t=e,r=0,i;do r>0&&(t=si(t.client,t.clock+r)),i=t2(n,t),r=t.clock-i.id.clock,t=i.redone;while(t!==null&&i instanceof Bs);return{item:i,diff:r}},$$=(n,e,t)=>{const{client:r,clock:i}=e.id,o=new Bs(si(r,i+t),e,si(r,i+t-1),e.right,e.rightOrigin,e.parent,e.parentSub,e.content.splice(t));return e.deleted&&o.markDeleted(),e.keep&&(o.keep=!0),e.redone!==null&&(o.redone=si(e.redone.client,e.redone.clock+t)),e.right=o,o.right!==null&&(o.right.left=o),n._mergeStructs.push(o),o.parentSub!==null&&o.right===null&&o.parent._map.set(o.parentSub,o),e.length=t,o};class Bs extends ese{constructor(e,t,r,i,o,s,a,c){super(e,c.getLength()),this.origin=r,this.left=t,this.right=i,this.rightOrigin=o,this.parent=s,this.parentSub=a,this.redone=null,this.content=c,this.info=this.content.isCountable()?aSe:0}set marker(e){(this.info&pz)>0!==e&&(this.info^=pz)}get marker(){return(this.info&pz)>0}get keep(){return(this.info&sSe)>0}set keep(e){this.keep!==e&&(this.info^=sSe)}get countable(){return(this.info&aSe)>0}get deleted(){return(this.info&fz)>0}set deleted(e){this.deleted!==e&&(this.info^=fz)}markDeleted(){this.info|=fz}getMissing(e,t){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=va(t,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=va(t,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===e2&&this.id.client!==this.parent.client&&this.parent.clock>=va(t,this.parent.client))return this.parent.client;if(this.origin&&(this.left=wSe(e,t,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=Ly(e,this.rightOrigin),this.rightOrigin=this.right.id),this.left&&this.left.constructor===Th||this.right&&this.right.constructor===Th)this.parent=null;else if(!this.parent)this.left&&this.left.constructor===Bs&&(this.parent=this.left.parent,this.parentSub=this.left.parentSub),this.right&&this.right.constructor===Bs&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);else if(this.parent.constructor===e2){const r=t2(t,this.parent);r.constructor===Th?this.parent=null:this.parent=r.content.type}return null}integrate(e,t){if(t>0&&(this.id.clock+=t,this.left=wSe(e,e.doc.store,si(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(t),this.length-=t),this.parent){if(!this.left&&(!this.right||this.right.left!==null)||this.left&&this.left.right!==this.right){let r=this.left,i;if(r!==null)i=r.right;else if(this.parentSub!==null)for(i=this.parent._map.get(this.parentSub)||null;i!==null&&i.left!==null;)i=i.left;else i=this.parent._start;const o=new Set,s=new Set;for(;i!==null&&i!==this.right;){if(s.add(i),o.add(i),RA(this.origin,i.origin)){if(i.id.client<this.id.client)r=i,o.clear();else if(RA(this.rightOrigin,i.rightOrigin))break}else if(i.origin!==null&&s.has(t2(e.doc.store,i.origin)))o.has(t2(e.doc.store,i.origin))||(r=i,o.clear());else break;i=i.right}this.left=r}if(this.left!==null){const r=this.left.right;this.right=r,this.left.right=this}else{let r;if(this.parentSub!==null)for(r=this.parent._map.get(this.parentSub)||null;r!==null&&r.left!==null;)r=r.left;else r=this.parent._start,this.parent._start=this;this.right=r}this.right!==null?this.right.left=this:this.parentSub!==null&&(this.parent._map.set(this.parentSub,this),this.left!==null&&this.left.delete(e)),this.parentSub===null&&this.countable&&!this.deleted&&(this.parent._length+=this.length),_je(e.doc.store,this),this.content.integrate(e,this),xSe(e,this.parent,this.parentSub),(this.parent._item!==null&&this.parent._item.deleted||this.parentSub!==null&&this.right!==null)&&this.delete(e)}else new Th(this.id,this.length).integrate(e,0)}get next(){let e=this.right;for(;e!==null&&e.deleted;)e=e.right;return e}get prev(){let e=this.left;for(;e!==null&&e.deleted;)e=e.left;return e}get lastId(){return this.length===1?this.id:si(this.id.client,this.id.clock+this.length-1)}mergeWith(e){if(this.constructor===e.constructor&&RA(e.origin,this.lastId)&&this.right===e&&RA(this.rightOrigin,e.rightOrigin)&&this.id.client===e.id.client&&this.id.clock+this.length===e.id.clock&&this.deleted===e.deleted&&this.redone===null&&e.redone===null&&this.content.constructor===e.content.constructor&&this.content.mergeWith(e.content)){const t=this.parent._searchMarker;return t&&t.forEach(r=>{r.p===e&&(r.p=this,!this.deleted&&this.countable&&(r.index-=this.length))}),e.keep&&(this.keep=!0),this.right=e.right,this.right!==null&&(this.right.left=this),this.length+=e.length,!0}return!1}delete(e){if(!this.deleted){const t=this.parent;this.countable&&this.parentSub===null&&(t._length-=this.length),this.markDeleted(),I$(e.deleteSet,this.id.client,this.id.clock,this.length),xSe(e,t,this.parentSub),this.content.delete(e)}}gc(e,t){if(!this.deleted)throw Vh();this.content.gc(e),t?xZt(e,this,new Th(this.id,this.length)):this.content=new cT(this.length)}write(e,t){const r=t>0?si(this.id.client,this.id.clock+t-1):this.origin,i=this.rightOrigin,o=this.parentSub,s=this.content.getRef()&sF|(r===null?0:Bd)|(i===null?0:Jm)|(o===null?0:tT);if(e.writeInfo(s),r!==null&&e.writeLeftID(r),i!==null&&e.writeRightID(i),r===null&&i===null){const a=this.parent;if(a._item!==void 0){const c=a._item;if(c===null){const l=bje(a);e.writeParentInfo(!0),e.writeString(l)}else e.writeParentInfo(!1),e.writeLeftID(c.id)}else a.constructor===String?(e.writeParentInfo(!0),e.writeString(a)):a.constructor===e2?(e.writeParentInfo(!1),e.writeLeftID(a)):Vh();o!==null&&e.writeString(o)}this.content.write(e,t)}}const Hje=(n,e)=>bXt[e&sF](n),bXt=[()=>{Vh()},rXt,aXt,nXt,lXt,oXt,sXt,yXt,cXt,iXt,()=>{Vh()}],SXt=10;class Dh extends ese{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor!==e.constructor?!1:(this.length+=e.length,!0)}integrate(e,t){Vh()}write(e,t){e.writeInfo(SXt),fi(e.restEncoder,this.length-t)}getMissing(e,t){return null}}const Uje=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:{},zje="__ $YJS$ __";Uje[zje]===!0&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438");Uje[zje]=!0;class _Xt extends qKt{constructor(e){super(),this.yarray=e,this.doc=e.doc,this.map=new Map;{const t=e.toArray();this.doc.transact(()=>{for(let r=t.length-1;r>=0;r--){const i=t[r];this.map.has(i.key)?e.delete(r):this.map.set(i.key,i)}})}e.observe((t,r)=>{const i=new Map,o=Array.from(t.changes.added);t.changes.deleted.forEach(l=>{l.content.getContent().forEach(u=>{this.map.get(u.key)===u&&(this.map.delete(u.key),i.set(u.key,{action:"delete",oldValue:u.val}))})});const s=new Map;o.map(l=>l.content.getContent()).flat().forEach(l=>{s.set(l.key,l)});const a=new Set,c=e.toArray();this.doc.transact(l=>{for(let u=c.length-1;u>=0&&(s.size>0||a.size>0);u--){const d=c[u];if(a.has(d.key))a.delete(d.key),e.delete(u,1);else if(s.get(d.key)===d){const h=this.map.get(d.key);if(h)a.add(d.key),i.set(d.key,{action:"update",oldValue:h.val,newValue:d.val});else{const f=i.get(d.key);f&&f.action==="delete"?i.set(d.key,{action:"update",newValue:d.val,oldValue:f.oldValue}):i.set(d.key,{action:"add",newValue:d.val})}s.delete(d.key),this.map.set(d.key,d)}else s.has(d.key)&&(a.add(d.key),s.delete(d.key))}}),i.size>0&&this.emit("change",[i,r])})}set(e,t){this.doc.transact(r=>{this.map.has(e)&&this.delete(e),this.yarray.push([{key:e,val:t}])})}delete(e){let t=0;for(const r of this.yarray){if(r.key===e){this.yarray.delete(t);break}t++}}get(e){const t=this.map.get(e);return t&&t.val}has(e){return this.map.has(e)}}const Vje="3.7.7",wXt=Vje,xE=typeof Buffer=="function",DSe=typeof TextDecoder=="function"?new TextDecoder:void 0,RSe=typeof TextEncoder=="function"?new TextEncoder:void 0,CXt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",wP=Array.prototype.slice.call(CXt),$A=(n=>{let e={};return n.forEach((t,r)=>e[t]=r),e})(wP),xXt=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,Dc=String.fromCharCode.bind(String),ASe=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):n=>new Uint8Array(Array.prototype.slice.call(n,0)),Wje=n=>n.replace(/=/g,"").replace(/[+\/]/g,e=>e=="+"?"-":"_"),qje=n=>n.replace(/[^A-Za-z0-9\+\/]/g,""),Kje=n=>{let e,t,r,i,o="";const s=n.length%3;for(let a=0;a<n.length;){if((t=n.charCodeAt(a++))>255||(r=n.charCodeAt(a++))>255||(i=n.charCodeAt(a++))>255)throw new TypeError("invalid character found");e=t<<16|r<<8|i,o+=wP[e>>18&63]+wP[e>>12&63]+wP[e>>6&63]+wP[e&63]}return s?o.slice(0,s-3)+"===".substring(s):o},tse=typeof btoa=="function"?n=>btoa(n):xE?n=>Buffer.from(n,"binary").toString("base64"):Kje,YX=xE?n=>Buffer.from(n).toString("base64"):n=>{let t=[];for(let r=0,i=n.length;r<i;r+=4096)t.push(Dc.apply(null,n.subarray(r,r+4096)));return tse(t.join(""))},aM=(n,e=!1)=>e?Wje(YX(n)):YX(n),EXt=n=>{if(n.length<2){var e=n.charCodeAt(0);return e<128?n:e<2048?Dc(192|e>>>6)+Dc(128|e&63):Dc(224|e>>>12&15)+Dc(128|e>>>6&63)+Dc(128|e&63)}else{var e=65536+(n.charCodeAt(0)-55296)*1024+(n.charCodeAt(1)-56320);return Dc(240|e>>>18&7)+Dc(128|e>>>12&63)+Dc(128|e>>>6&63)+Dc(128|e&63)}},IXt=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,Gje=n=>n.replace(IXt,EXt),OSe=xE?n=>Buffer.from(n,"utf8").toString("base64"):RSe?n=>YX(RSe.encode(n)):n=>tse(Gje(n)),r2=(n,e=!1)=>e?Wje(OSe(n)):OSe(n),MSe=n=>r2(n,!0),PXt=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,kXt=n=>{switch(n.length){case 4:var e=(7&n.charCodeAt(0))<<18|(63&n.charCodeAt(1))<<12|(63&n.charCodeAt(2))<<6|63&n.charCodeAt(3),t=e-65536;return Dc((t>>>10)+55296)+Dc((t&1023)+56320);case 3:return Dc((15&n.charCodeAt(0))<<12|(63&n.charCodeAt(1))<<6|63&n.charCodeAt(2));default:return Dc((31&n.charCodeAt(0))<<6|63&n.charCodeAt(1))}},Zje=n=>n.replace(PXt,kXt),Xje=n=>{if(n=n.replace(/\s+/g,""),!xXt.test(n))throw new TypeError("malformed base64.");n+="==".slice(2-(n.length&3));let e,t="",r,i;for(let o=0;o<n.length;)e=$A[n.charAt(o++)]<<18|$A[n.charAt(o++)]<<12|(r=$A[n.charAt(o++)])<<6|(i=$A[n.charAt(o++)]),t+=r===64?Dc(e>>16&255):i===64?Dc(e>>16&255,e>>8&255):Dc(e>>16&255,e>>8&255,e&255);return t},nse=typeof atob=="function"?n=>atob(qje(n)):xE?n=>Buffer.from(n,"base64").toString("binary"):Xje,Yje=xE?n=>ASe(Buffer.from(n,"base64")):n=>ASe(nse(n).split("").map(e=>e.charCodeAt(0))),Jje=n=>Yje(Qje(n)),TXt=xE?n=>Buffer.from(n,"base64").toString("utf8"):DSe?n=>DSe.decode(Yje(n)):n=>Zje(nse(n)),Qje=n=>qje(n.replace(/[-_]/g,e=>e=="-"?"+":"/")),JX=n=>TXt(Qje(n)),DXt=n=>{if(typeof n!="string")return!1;const e=n.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(e)||!/[^\s0-9a-zA-Z\-_]/.test(e)},eBe=n=>({value:n,enumerable:!1,writable:!0,configurable:!0}),tBe=function(){const n=(e,t)=>Object.defineProperty(String.prototype,e,eBe(t));n("fromBase64",function(){return JX(this)}),n("toBase64",function(e){return r2(this,e)}),n("toBase64URI",function(){return r2(this,!0)}),n("toBase64URL",function(){return r2(this,!0)}),n("toUint8Array",function(){return Jje(this)})},nBe=function(){const n=(e,t)=>Object.defineProperty(Uint8Array.prototype,e,eBe(t));n("toBase64",function(e){return aM(this,e)}),n("toBase64URI",function(){return aM(this,!0)}),n("toBase64URL",function(){return aM(this,!0)})},RXt=()=>{tBe(),nBe()},DI={version:Vje,VERSION:wXt,atob:nse,atobPolyfill:Xje,btoa:tse,btoaPolyfill:Kje,fromBase64:JX,toBase64:r2,encode:r2,encodeURI:MSe,encodeURL:MSe,utob:Gje,btou:Zje,decode:JX,isValid:DXt,fromUint8Array:aM,toUint8Array:Jje,extendString:tBe,extendUint8Array:nBe,extendBuiltins:RXt};var Sz=()=>new Map,AXt=(n,e,t)=>{let r=n.get(e);return r===void 0&&n.set(e,r=t()),r},OXt=()=>new Set,MXt=Array.from,rse=class{constructor(){this._observers=Sz()}on(n,e){AXt(this._observers,n,OXt).add(e)}once(n,e){const t=(...r)=>{this.off(n,t),e(...r)};this.on(n,t)}off(n,e){const t=this._observers.get(n);t!==void 0&&(t.delete(e),t.size===0&&this._observers.delete(n))}emit(n,e){return MXt((this._observers.get(n)||Sz()).values()).forEach(t=>t(...e))}destroy(){this._observers=Sz()}},hm="__yjs",LA="__yjs_clientid",$Xt=class extends rse{constructor(n,e){super(),this.states=new Map,this.actorToClientMap=new Map,this.meta=new Map,this._checkInterval=0,this.doc=n,this.room=e,this.room.updatePresence({[LA]:this.doc.clientID}),this.othersUnsub=this.room.events.others.subscribe(t=>{let r;if(this.rebuildActorToClientMap(t.others),t.type==="leave"){const i=this.actorToClientMap.get(t.user.connectionId);i!==void 0&&(r={added:[],updated:[],removed:[i]}),this.rebuildActorToClientMap(t.others)}if(t.type==="enter"||t.type==="update"){this.rebuildActorToClientMap(t.others);const i=this.actorToClientMap.get(t.user.connectionId);i!==void 0&&(r={added:t.type==="enter"?[i]:[],updated:t.type==="update"?[i]:[],removed:[]})}r!==void 0&&(this.emit("change",[r,"presence"]),this.emit("update",[r,"presence"]))})}rebuildActorToClientMap(n){this.actorToClientMap.clear(),n.forEach(e=>{e.presence[LA]!==void 0&&this.actorToClientMap.set(e.connectionId,e.presence[LA])})}destroy(){this.emit("destroy",[this]),this.othersUnsub(),this.setLocalState(null),super.destroy()}getLocalState(){const n=this.room.getPresence();return Object.keys(n).length===0||typeof n[hm]>"u"?null:n[hm]}setLocalState(n){var o;const e=(o=this.room.getSelf())==null?void 0:o.presence;if(n===null){if(e===void 0)return;this.room.updatePresence({...e,[hm]:null}),this.emit("update",[{added:[],updated:[],removed:[this.doc.clientID]},"local"]);return}const t=e==null?void 0:e[hm],r=t===void 0?[this.doc.clientID]:[],i=t===void 0?[]:[this.doc.clientID];this.room.updatePresence({[hm]:{...t||{},...n||{}}}),this.emit("update",[{added:r,updated:i,removed:[]},"local"])}setLocalStateField(n,e){var i;const t=(i=this.room.getSelf())==null?void 0:i.presence[hm],r={[n]:e};this.room.updatePresence({[hm]:{...t||{},...r}})}getStates(){var r;const e=this.room.getOthers().reduce((i,o)=>{const s=o.presence[hm],a=o.presence[LA];return s!==void 0&&a!==void 0&&i.set(a,s||{}),i},new Map),t=(r=this.room.getSelf())==null?void 0:r.presence[hm];return t!==void 0&&e.set(this.doc.clientID,t),e}},$Se=class extends rse{constructor({doc:n,isRoot:e,updateDoc:t,fetchDoc:r}){super(),this.unsubscribers=[],this._synced=!1,this.handleServerUpdate=({update:i,stateVector:o})=>{if(dZt(this.doc,DI.toUint8Array(i),"backend"),o){try{const s=pZt(this.doc,DI.toUint8Array(o));this.updateRoomDoc(DI.fromUint8Array(s))}catch(s){console.warn(s)}this.synced=!0}},this.syncDoc=()=>{this.synced=!1;const i=DI.fromUint8Array(yZt(this.doc));this.fetchRoomDoc(i)},this.updateHandler=(i,o)=>{if(o!=="backend"){const s=DI.fromUint8Array(i);this.updateRoomDoc(s)}},this.doc=n,this.doc.on("update",this.updateHandler),this.updateRoomDoc=i=>{t(i,e?void 0:this.doc.guid)},this.fetchRoomDoc=i=>{r(i,e?void 0:this.doc.guid)},this.syncDoc()}get synced(){return this._synced}set synced(n){this._synced!==n&&(this._synced=n,this.emit("synced",[n]),this.emit("sync",[n]))}destroy(){this.doc.off("update",this.updateHandler),this.unsubscribers.forEach(n=>n()),this._observers=new Map,this.doc.destroy()}},LXt="@liveblocks/yjs",NXt="2.1.0",FXt="esm";pZe(LXt,NXt,FXt);var jXt={autoloadSubdocs:!1},rBe=class extends rse{constructor(n,e,t=jXt){super(),this.unsubscribers=[],this.subdocHandlers=new Map,this.handleSubdocs=({loaded:r,removed:i,added:o})=>{var s;if(r.forEach(this.createSubdocHandler),this.options.autoloadSubdocs)for(const a of o)this.subdocHandlers.has(a.guid)||a.load();for(const a of i)this.subdocHandlers.has(a.guid)&&((s=this.subdocHandlers.get(a.guid))==null||s.destroy(),this.subdocHandlers.delete(a.guid))},this.updateDoc=(r,i)=>{this.room.updateYDoc(r,i)},this.fetchDoc=(r,i)=>{this.room.fetchYDoc(r,i)},this.createSubdocHandler=r=>{var o;if(this.subdocHandlers.has(r.guid)){(o=this.subdocHandlers.get(r.guid))==null||o.syncDoc();return}const i=new $Se({doc:r,isRoot:!1,updateDoc:this.updateDoc,fetchDoc:this.fetchDoc});this.subdocHandlers.set(r.guid,i)},this.loadSubdoc=r=>{for(const i of this.rootDoc.subdocs)if(i.guid===r)return i.load(),!0;return!1},this.syncDoc=()=>{this.rootDocHandler.syncDoc();for(const[r,i]of this.subdocHandlers)i.syncDoc()},this.rootDoc=e,this.room=n,this.options=t,this.rootDocHandler=new $Se({doc:e,isRoot:!0,updateDoc:this.updateDoc,fetchDoc:this.fetchDoc}),this.awareness=new $Xt(this.rootDoc,this.room),this.unsubscribers.push(this.room.events.status.subscribe(r=>{r==="connected"?this.rootDocHandler.syncDoc():this.rootDocHandler.synced=!1})),this.unsubscribers.push(this.room.events.ydoc.subscribe(r=>{var c;const{type:i}=r;if(i===gZe.UPDATE_YDOC)return;const{stateVector:o,update:s,guid:a}=r;a!==void 0?(c=this.subdocHandlers.get(a))==null||c.handleServerUpdate({update:s,stateVector:o}):this.rootDocHandler.handleServerUpdate({update:s,stateVector:o})})),this.rootDocHandler.on("synced",()=>{const r=this.rootDocHandler.synced;for(const[i,o]of this.subdocHandlers)o.syncDoc();this.emit("synced",[r]),this.emit("sync",[r])}),this.rootDoc.on("subdocs",this.handleSubdocs),this.syncDoc()}get synced(){return this.rootDocHandler.synced}destroy(){this.unsubscribers.forEach(n=>n()),this.awareness.destroy(),this.rootDocHandler.destroy(),this._observers=new Map;for(const[n,e]of this.subdocHandlers)e.destroy();this.subdocHandlers.clear(),super.destroy()}disconnect(){}connect(){}};function BXt({shapeUtils:n=[],identifier:e="default"}){const[t]=y.useState(()=>H$e({shapeUtils:[...Bie,...n]})),[r,i]=y.useState({status:"loading"}),o=M2e(),s=gee(),{yDoc:a,yStore:c,room:l}=y.useMemo(()=>{const u=new y_({gc:!0}),d=u.getArray(`tl_${e}`),h=new _Xt(d);return{yDoc:u,yStore:h,room:new rBe(o,u)}},[o,e]);return y.useEffect(()=>{i({status:"loading"});const u=[];function d(){u.push(t.listen(function({changes:E}){a.transact(()=>{Object.values(E.added).forEach(w=>{c.set(w.id,w)}),Object.values(E.updated).forEach(([w,C])=>{c.set(C.id,C)}),Object.values(E.removed).forEach(w=>{c.delete(w.id)})})},{source:"user",scope:"document"}));const h=(S,E)=>{if(E.local)return;const w=[],C=[];S.forEach((I,T)=>{switch(I.action){case"add":case"update":{const D=c.get(T);C.push(D);break}case"delete":{w.push(T);break}}}),t.mergeRemoteChanges(()=>{w.length&&t.remove(w),C.length&&t.put(C)})};c.on("change",h),u.push(()=>c.off("change",h));const f=Et("userPreferences",()=>({id:s.id,name:"peer",color:"orangered"})),p=o.getSelf(),g=p==null?void 0:p.presence.__yjs_clientid,m=U3.createId(g),v=OOt(f)(t);l.awareness.setLocalStateField("presence",v.get()??null),u.push(Zy("when presence changes",()=>{const S=v.get()??null;requestAnimationFrame(()=>{l.awareness.setLocalStateField("presence",S)})}));const b=S=>{const E=l.awareness.getStates(),w=[],C=[];for(const I of S.added){const T=E.get(I);T!=null&&T.presence&&T.presence.id!==m&&C.push(T.presence)}for(const I of S.updated){const T=E.get(I);T!=null&&T.presence&&T.presence.id!==m&&C.push(T.presence)}for(const I of S.removed)w.push(U3.createId(I.toString()));t.mergeRemoteChanges(()=>{w.length>0&&t.remove(w),C.length>0&&t.put(C)})};l.awareness.on("update",b),u.push(()=>l.awareness.off("update",b)),c.yarray.length?Gm(()=>{t.clear();const S=c.yarray.toJSON().map(({val:E})=>E);t.put(S)}):a.transact(()=>{for(const S of t.allRecords())c.set(S.id,S)}),i({store:t,status:"synced-remote",connectionStatus:"online"})}return l.on("synced",d),u.push(()=>l.off("synced",d)),()=>{u.forEach(h=>h()),u.length=0}},[l,a,t,c]),r}const _z=()=>null,HXt={tools:(n,e)=>({...e})},UXt=n=>(HD(),x.jsx(q9e,{...n,children:x.jsx(B9e,{})})),zXt={icons:{...BKt}};function VXt(n){const e=y.useRef(null),t=y.useRef(),r=BXt({identifier:n.identifier});return x.jsx("div",{className:FKt.container,ref:e,children:x.jsx(PKt,{store:r,forceMobile:!0,components:{HelpMenu:_z,DebugPanel:_z,MenuPanel:_z,Toolbar:UXt},overrides:HXt,assetUrls:zXt,onMount:i=>{t.current=i,i.findChildWithValue=o=>PGe(e.current,o),n.onMount(i)}})})}const iBe=n=>{const e=n.getCurrentPageShapes().map(t=>t.id);return RKt(n,e,"png")};function wz(n){const{contentUpdate:e,setEditor:t}=n,r=i=>{t(i),i==null||i.on("change",({changes:{added:o,removed:s}})=>{if(Object.keys(o).length>0||Object.keys(s).length>0){const a=i.getCurrentPageShapes(),c=a.length;e(c>0,a)}})};return x.jsx($2e,{...n,children:x.jsx(VXt,{onMount:r,identifier:n.identifier})})}const WXt=()=>{let n=!0;return(e,t)=>{if(n){n=!1;try{e()}finally{n=!0}}else t!==void 0&&t()}};class qXt{constructor(e,t,r){this.start=e,this.end=t,this.direction=r}}const KXt=(n,e,t)=>{const r=n.getSelection();if(r!==null){const i=r.getStartPosition(),o=r.getEndPosition(),s=P$(t,e.getOffsetAt(i)),a=P$(t,e.getOffsetAt(o));return new qXt(s,a,r.getDirection())}return null},GXt=(n,e,t,r)=>{const i=k$(t.start,r),o=k$(t.end,r);if(i!==null&&o!==null&&i.type===e&&o.type===e){const s=n.getModel(),a=s.getPositionAt(i.index),c=s.getPositionAt(o.index);return hW.createWithDirection(a.lineNumber,a.column,c.lineNumber,c.column,t.direction)}return null};class ZXt{constructor(e,t,r=new Set,i=null){this.doc=e.doc,this.ytext=e,this.monacoModel=t,this.editors=r,this.mux=WXt(),this._savedSelections=new Map,this._beforeTransaction=()=>{this.mux(()=>{this._savedSelections=new Map,r.forEach(o=>{if(o.getModel()===t){const s=KXt(o,t,e);s!==null&&this._savedSelections.set(o,s)}})})},this.doc.on("beforeAllTransactions",this._beforeTransaction),this._decorations=new Map,this._rerenderDecorations=()=>{r.forEach(o=>{if(i&&o.getModel()===t){const s=this._decorations.get(o)||[],a=[];i.getStates().forEach((c,l)=>{if(l!==this.doc.clientID&&c.selection!=null&&c.selection.anchor!=null&&c.selection.head!=null){const u=k$(c.selection.anchor,this.doc),d=k$(c.selection.head,this.doc);if(u!==null&&d!==null&&u.type===e&&d.type===e){let h,f,p,g;u.index<d.index?(h=t.getPositionAt(u.index),f=t.getPositionAt(d.index),p="yRemoteSelectionHead yRemoteSelectionHead-"+l,g=null):(h=t.getPositionAt(d.index),f=t.getPositionAt(u.index),p=null,g="yRemoteSelectionHead yRemoteSelectionHead-"+l),a.push({range:new yZe(h.lineNumber,h.column,f.lineNumber,f.column),options:{className:"yRemoteSelection yRemoteSelection-"+l,afterContentClassName:p,beforeContentClassName:g}})}}}),this._decorations.set(o,o.deltaDecorations(s,a))}else this._decorations.delete(o)})},this._ytextObserver=o=>{this.mux(()=>{let s=0;o.delta.forEach(a=>{if(a.retain!==void 0)s+=a.retain;else if(a.insert!==void 0){const c=t.getPositionAt(s),l=new hW(c.lineNumber,c.column,c.lineNumber,c.column),u=a.insert;t.applyEdits([{range:l,text:u}]),s+=u.length}else if(a.delete!==void 0){const c=t.getPositionAt(s),l=t.getPositionAt(s+a.delete),u=new hW(c.lineNumber,c.column,l.lineNumber,l.column);t.applyEdits([{range:u,text:""}])}else throw Vh()}),this._savedSelections.forEach((a,c)=>{const l=GXt(c,e,a,this.doc);l!==null&&c.setSelection(l)})}),this._rerenderDecorations()},e.observe(this._ytextObserver);{const o=e.toString();t.getValue()!==o&&t.setValue(o)}this._monacoChangeHandler=t.onDidChangeContent(o=>{this.mux(()=>{this.doc.transact(()=>{o.changes.sort((s,a)=>a.rangeOffset-s.rangeOffset).forEach(s=>{e.delete(s.rangeOffset,s.rangeLength),e.insert(s.rangeOffset,s.text)})},this)})}),this._monacoDisposeHandler=t.onWillDispose(()=>{this.destroy()}),i&&(r.forEach(o=>{o.onDidChangeCursorSelection(()=>{if(o.getModel()===t){const s=o.getSelection();if(s===null)return;let a=t.getOffsetAt(s.getStartPosition()),c=t.getOffsetAt(s.getEndPosition());if(s.getDirection()===bZe.RTL){const l=a;a=c,c=l}i.setLocalStateField("selection",{anchor:P$(e,a),head:P$(e,c)})}}),i.on("change",this._rerenderDecorations)}),this.awareness=i)}destroy(){this._monacoChangeHandler.dispose(),this._monacoDisposeHandler.dispose(),this.ytext.unobserve(this._ytextObserver),this.doc.off("beforeAllTransactions",this._beforeTransaction),this.awareness&&this.awareness.off("change",this._rerenderDecorations)}}const XXt="_avatars_1syk7_1",YXt="_avatar_1syk7_1",JXt="_avatar_picture_1syk7_38",QX={avatars:XXt,avatar:YXt,avatar_picture:JXt};function QXt(){const n=mZe(),e=gee();return x.jsxs("div",{className:QX.avatars,children:[n.map(({connectionId:t,info:r})=>r?x.jsx(LSe,{picture:r.picture},t):null),(e==null?void 0:e.info)&&x.jsx("div",{className:"relative ml-8 first:ml-0",children:x.jsx(LSe,{picture:e.info.picture})})]})}function LSe({picture:n}){return x.jsx("div",{className:QX.avatar,children:x.jsx("img",{src:n,className:QX.avatar_picture})})}function eYt({yProvider:n}){const e=gee(o=>o.info),[t,r]=y.useState([]);y.useEffect(()=>{const o=e;n.awareness.setLocalStateField("user",o);function s(){r([...n.awareness.getStates()])}return n.awareness.on("change",s),s(),()=>{n.awareness.off("change",s)}},[n]);const i=y.useMemo(()=>{let o="";for(const[s,a]of t)a!=null&&a.user&&(o+=`
          .yRemoteSelection-${s}, 
          .yRemoteSelectionHead-${s}  {
            --user-color: ${a.user.color||"orangered"};
          }
          `);return{__html:o}},[t]);return x.jsx("style",{dangerouslySetInnerHTML:i})}const tYt="_toolbar_cfe5z_1",nYt="_button_cfe5z_7",rYt="_run_cfe5z_40",iYt="_terminate_cfe5z_47",oYt="_ask_cfe5z_56",$b={toolbar:tYt,button:nYt,run:rYt,terminate:iYt,ask:oYt};function sYt({editor:n,run:e,terminate:t,canRun:r}){return x.jsxs("div",{className:$b.toolbar,children:[x.jsx("button",{className:$b.button,onClick:()=>n.trigger("","undo",null),"aria-label":"undo",children:x.jsx(aYt,{})}),x.jsx("button",{className:$b.button,onClick:()=>n.trigger("","redo",null),"aria-label":"redo",children:x.jsx(cYt,{})}),x.jsxs("button",{className:`${$b.button} ${$b.run}`,onClick:e,"aria-label":"redo",disabled:!r,children:["Run ",x.jsx(lYt,{})]}),!r&&x.jsx("button",{className:`${$b.button} ${$b.terminate}`,onClick:t,"aria-label":"redo",children:"Terminate"})]})}function aYt(){return x.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[x.jsx("path",{d:"M4 6h6a3 3 0 0 1 3 3v0a3 3 0 0 1-3 3H8.91",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",vectorEffect:"non-scaling-stroke"}),x.jsx("path",{d:"M5.5 3.5 3 6l2.5 2.5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",vectorEffect:"non-scaling-stroke"})]})}function cYt(){return x.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[x.jsx("path",{d:"M12 6H6a3 3 0 0 0-3 3v0a3 3 0 0 0 3 3h1.09",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",vectorEffect:"non-scaling-stroke"}),x.jsx("path",{d:"M10.5 3.5 13 6l-2.5 2.5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",vectorEffect:"non-scaling-stroke"})]})}function lYt(){return x.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:x.jsx("path",{d:"M4 14V2l8 6-8 6z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",vectorEffect:"non-scaling-stroke"})})}const uYt="_container_1a23d_1",dYt="_editorHeader_1a23d_13",hYt="_editorContainer_1a23d_19",cM={container:uYt,editorHeader:dYt,editorContainer:hYt};var fYt={name:"python",displayName:"%displayName%",description:"%description%",version:"1.0.0",publisher:"vscode",license:"MIT",engines:{vscode:"*"},categories:["Programming Languages"],contributes:{languages:[{id:"python",extensions:[".py",".rpy",".pyw",".cpy",".gyp",".gypi",".pyi",".ipy",".pyt"],aliases:["Python","py"],filenames:["SConstruct","SConscript"],firstLine:"^#!\\s*/?.*\\bpython[0-9.-]*\\b",configuration:"./language-configuration.json"}],grammars:[{language:"python",scopeName:"source.python",path:"./syntaxes/MagicPython.tmLanguage.json"},{scopeName:"source.regexp.python",path:"./syntaxes/MagicRegExp.tmLanguage.json"}],configurationDefaults:{"[python]":{"diffEditor.ignoreTrimWhitespace":!1}}},scripts:{"update-grammar":"node ../node_modules/vscode-grammar-updater/bin MagicStack/MagicPython grammars/MagicPython.tmLanguage ./syntaxes/MagicPython.tmLanguage.json grammars/MagicRegExp.tmLanguage ./syntaxes/MagicRegExp.tmLanguage.json"},repository:{type:"git",url:"https://github.com/microsoft/vscode.git"},main:void 0};const{registerFileUrl:eR,whenReady:Kln}=L2e(fYt,void 0,{system:!0});eR("./syntaxes/MagicPython.tmLanguage.json",new URL(""+new URL("../assets/MagicPython.tmLanguage.DSrfAYO2.json",import.meta.url).href,import.meta.url).toString(),"application/json");eR("./syntaxes/MagicRegExp.tmLanguage.json",new URL(""+new URL("../assets/MagicRegExp.tmLanguage.XKSD9R-M.json",import.meta.url).href,import.meta.url).toString(),"application/json");eR("./language-configuration.json",new URL("data:application/json;base64,eyJjb21tZW50cyI6eyJsaW5lQ29tbWVudCI6IiMiLCJibG9ja0NvbW1lbnQiOlsiXCJcIlwiIiwiXCJcIlwiIl19LCJicmFja2V0cyI6W1sieyIsIn0iXSxbIlsiLCJdIl0sWyIoIiwiKSJdXSwiYXV0b0Nsb3NpbmdQYWlycyI6W3sib3BlbiI6InsiLCJjbG9zZSI6In0ifSx7Im9wZW4iOiJbIiwiY2xvc2UiOiJdIn0seyJvcGVuIjoiKCIsImNsb3NlIjoiKSJ9LHsib3BlbiI6IlwiIiwiY2xvc2UiOiJcIiIsIm5vdEluIjpbInN0cmluZyJdfSx7Im9wZW4iOiJyXCIiLCJjbG9zZSI6IlwiIiwibm90SW4iOlsic3RyaW5nIiwiY29tbWVudCJdfSx7Im9wZW4iOiJSXCIiLCJjbG9zZSI6IlwiIiwibm90SW4iOlsic3RyaW5nIiwiY29tbWVudCJdfSx7Im9wZW4iOiJ1XCIiLCJjbG9zZSI6IlwiIiwibm90SW4iOlsic3RyaW5nIiwiY29tbWVudCJdfSx7Im9wZW4iOiJVXCIiLCJjbG9zZSI6IlwiIiwibm90SW4iOlsic3RyaW5nIiwiY29tbWVudCJdfSx7Im9wZW4iOiJmXCIiLCJjbG9zZSI6IlwiIiwibm90SW4iOlsic3RyaW5nIiwiY29tbWVudCJdfSx7Im9wZW4iOiJGXCIiLCJjbG9zZSI6IlwiIiwibm90SW4iOlsic3RyaW5nIiwiY29tbWVudCJdfSx7Im9wZW4iOiJiXCIiLCJjbG9zZSI6IlwiIiwibm90SW4iOlsic3RyaW5nIiwiY29tbWVudCJdfSx7Im9wZW4iOiJCXCIiLCJjbG9zZSI6IlwiIiwibm90SW4iOlsic3RyaW5nIiwiY29tbWVudCJdfSx7Im9wZW4iOiInIiwiY2xvc2UiOiInIiwibm90SW4iOlsic3RyaW5nIiwiY29tbWVudCJdfSx7Im9wZW4iOiJyJyIsImNsb3NlIjoiJyIsIm5vdEluIjpbInN0cmluZyIsImNvbW1lbnQiXX0seyJvcGVuIjoiUiciLCJjbG9zZSI6IiciLCJub3RJbiI6WyJzdHJpbmciLCJjb21tZW50Il19LHsib3BlbiI6InUnIiwiY2xvc2UiOiInIiwibm90SW4iOlsic3RyaW5nIiwiY29tbWVudCJdfSx7Im9wZW4iOiJVJyIsImNsb3NlIjoiJyIsIm5vdEluIjpbInN0cmluZyIsImNvbW1lbnQiXX0seyJvcGVuIjoiZiciLCJjbG9zZSI6IiciLCJub3RJbiI6WyJzdHJpbmciLCJjb21tZW50Il19LHsib3BlbiI6IkYnIiwiY2xvc2UiOiInIiwibm90SW4iOlsic3RyaW5nIiwiY29tbWVudCJdfSx7Im9wZW4iOiJiJyIsImNsb3NlIjoiJyIsIm5vdEluIjpbInN0cmluZyIsImNvbW1lbnQiXX0seyJvcGVuIjoiQiciLCJjbG9zZSI6IiciLCJub3RJbiI6WyJzdHJpbmciLCJjb21tZW50Il19LHsib3BlbiI6ImAiLCJjbG9zZSI6ImAiLCJub3RJbiI6WyJzdHJpbmciXX1dLCJzdXJyb3VuZGluZ1BhaXJzIjpbWyJ7IiwifSJdLFsiWyIsIl0iXSxbIigiLCIpIl0sWyJcIiIsIlwiIl0sWyInIiwiJyJdLFsiYCIsImAiXV0sImZvbGRpbmciOnsib2ZmU2lkZSI6dHJ1ZSwibWFya2VycyI6eyJzdGFydCI6Il5cXHMqI1xccypyZWdpb25cXGIiLCJlbmQiOiJeXFxzKiNcXHMqZW5kcmVnaW9uXFxiIn19LCJvbkVudGVyUnVsZXMiOlt7ImJlZm9yZVRleHQiOiJeXFxzKig/OmRlZnxjbGFzc3xmb3J8aWZ8ZWxpZnxlbHNlfHdoaWxlfHRyeXx3aXRofGZpbmFsbHl8ZXhjZXB0fGFzeW5jKS4qPzpcXHMqJCIsImFjdGlvbiI6eyJpbmRlbnQiOiJpbmRlbnQifX1dfQ==",import.meta.url).toString(),"application/json");eR("package.json",new URL("data:application/json;base64,eyJuYW1lIjoicHl0aG9uIiwiZGlzcGxheU5hbWUiOiIlZGlzcGxheU5hbWUlIiwiZGVzY3JpcHRpb24iOiIlZGVzY3JpcHRpb24lIiwidmVyc2lvbiI6IjEuMC4wIiwicHVibGlzaGVyIjoidnNjb2RlIiwibGljZW5zZSI6Ik1JVCIsImVuZ2luZXMiOnsidnNjb2RlIjoiKiJ9LCJjYXRlZ29yaWVzIjpbIlByb2dyYW1taW5nIExhbmd1YWdlcyJdLCJjb250cmlidXRlcyI6eyJsYW5ndWFnZXMiOlt7ImlkIjoicHl0aG9uIiwiZXh0ZW5zaW9ucyI6WyIucHkiLCIucnB5IiwiLnB5dyIsIi5jcHkiLCIuZ3lwIiwiLmd5cGkiLCIucHlpIiwiLmlweSIsIi5weXQiXSwiYWxpYXNlcyI6WyJQeXRob24iLCJweSJdLCJmaWxlbmFtZXMiOlsiU0NvbnN0cnVjdCIsIlNDb25zY3JpcHQiXSwiZmlyc3RMaW5lIjoiXiMhXFxzKi8/LipcXGJweXRob25bMC05Li1dKlxcYiIsImNvbmZpZ3VyYXRpb24iOiIuL2xhbmd1YWdlLWNvbmZpZ3VyYXRpb24uanNvbiJ9XSwiZ3JhbW1hcnMiOlt7Imxhbmd1YWdlIjoicHl0aG9uIiwic2NvcGVOYW1lIjoic291cmNlLnB5dGhvbiIsInBhdGgiOiIuL3N5bnRheGVzL01hZ2ljUHl0aG9uLnRtTGFuZ3VhZ2UuanNvbiJ9LHsic2NvcGVOYW1lIjoic291cmNlLnJlZ2V4cC5weXRob24iLCJwYXRoIjoiLi9zeW50YXhlcy9NYWdpY1JlZ0V4cC50bUxhbmd1YWdlLmpzb24ifV0sImNvbmZpZ3VyYXRpb25EZWZhdWx0cyI6eyJbcHl0aG9uXSI6eyJkaWZmRWRpdG9yLmlnbm9yZVRyaW1XaGl0ZXNwYWNlIjpmYWxzZX19fSwic2NyaXB0cyI6eyJ1cGRhdGUtZ3JhbW1hciI6Im5vZGUgLi4vbm9kZV9tb2R1bGVzL3ZzY29kZS1ncmFtbWFyLXVwZGF0ZXIvYmluIE1hZ2ljU3RhY2svTWFnaWNQeXRob24gZ3JhbW1hcnMvTWFnaWNQeXRob24udG1MYW5ndWFnZSAuL3N5bnRheGVzL01hZ2ljUHl0aG9uLnRtTGFuZ3VhZ2UuanNvbiBncmFtbWFycy9NYWdpY1JlZ0V4cC50bUxhbmd1YWdlIC4vc3ludGF4ZXMvTWFnaWNSZWdFeHAudG1MYW5ndWFnZS5qc29uIn0sInJlcG9zaXRvcnkiOnsidHlwZSI6ImdpdCIsInVybCI6Imh0dHBzOi8vZ2l0aHViLmNvbS9taWNyb3NvZnQvdnNjb2RlLmdpdCJ9fQ==",import.meta.url).toString(),"application/json");eR("package.nls.json",new URL("data:application/json;base64,eyJkaXNwbGF5TmFtZSI6IlB5dGhvbiBMYW5ndWFnZSBCYXNpY3MiLCJkZXNjcmlwdGlvbiI6IlByb3ZpZGVzIHN5bnRheCBoaWdobGlnaHRpbmcsIGJyYWNrZXQgbWF0Y2hpbmcgYW5kIGZvbGRpbmcgaW4gUHl0aG9uIGZpbGVzLiJ9",import.meta.url).toString(),"application/json");let eY=class extends Dr{constructor(e,t,r){super(),this.configurationService=e,this.modelService=t,this.languageService=r,this._onDidChangeConfiguration=this._register(new ft),this.onDidChangeConfiguration=this._onDidChangeConfiguration.event,this._register(this.configurationService.onDidChangeConfiguration(i=>this._onDidChangeConfiguration.fire(this.toResourceConfigurationChangeEvent(i))))}getValue(e,t,r){return typeof r=="string"?this._getValue(e,N2e.isIPosition(t)?t:null,r):this._getValue(e,null,typeof t=="string"?t:void 0)}updateValue(e,t,r,i){var c;const o=this.getLanguage(e,null),s=this.configurationService.inspect(t,{resource:e,overrideIdentifier:o});i===void 0&&(i=this.deriveConfigurationTarget(s,o));const a=o&&((c=s.overrideIdentifiers)!=null&&c.includes(o))?o:void 0;return this.configurationService.updateValue(t,r,{resource:e,overrideIdentifier:a},i)}deriveConfigurationTarget(e,t){var r,i,o,s,a,c,l,u,d;if(t){if(((r=e.memory)==null?void 0:r.override)!==void 0)return 8;if(((i=e.workspaceFolder)==null?void 0:i.override)!==void 0)return 6;if(((o=e.workspace)==null?void 0:o.override)!==void 0)return 5;if(((s=e.userRemote)==null?void 0:s.override)!==void 0)return 4;if(((a=e.userLocal)==null?void 0:a.override)!==void 0)return 3}return((c=e.memory)==null?void 0:c.value)!==void 0?8:((l=e.workspaceFolder)==null?void 0:l.value)!==void 0?6:((u=e.workspace)==null?void 0:u.value)!==void 0?5:((d=e.userRemote)==null?void 0:d.value)!==void 0?4:3}_getValue(e,t,r){const i=e?this.getLanguage(e,t):void 0;return typeof r>"u"?this.configurationService.getValue({resource:e,overrideIdentifier:i}):this.configurationService.getValue(r,{resource:e,overrideIdentifier:i})}inspect(e,t,r){const i=e?this.getLanguage(e,t):void 0;return this.configurationService.inspect(r,{resource:e,overrideIdentifier:i})}getLanguage(e,t){const r=this.modelService.getModel(e);return r?t?r.getLanguageIdAtPosition(t.lineNumber,t.column):r.getLanguageId():this.languageService.guessLanguageIdByFilepathOrFirstLine(e)}toResourceConfigurationChangeEvent(e){return{affectedKeys:e.affectedKeys,affectsConfiguration:(t,r)=>{const i=t?this.getLanguage(t,null):void 0;return e.affectsConfiguration(r,{resource:t,overrideIdentifier:i})}}}};eY=An([Be(0,VT),Be(1,GL),Be(2,mee)],eY);const pF=".vscode",L$="settings",pYt=`${pF}/${L$}.json`,gYt="vscode://schemas/settings/default",mYt="vscode://schemas/settings/user",vYt="vscode://schemas/settings/profile",yYt="vscode://schemas/settings/machine",oBe="vscode://schemas/settings/workspace",bYt="vscode://schemas/settings/folder",SYt="vscode://schemas/launch",_Yt="vscode://schemas/tasks",wYt=[2,3,4,5,6],sBe=[3,4,5],CYt=[1,...sBe],Cz=[2,3,4,5,6],lM=[3,4,5,6],aBe=[4,5,6],Iu="tasks",C0="launch",ise=Object.create(null);ise[Iu]=`${pF}/${Iu}.json`;ise[C0]=`${pF}/${C0}.json`;const cBe=Object.create(null);cBe[Iu]=`${Iu}.json`;const xYt=`{
	"version": "2.0.0",
	"tasks": []
}`,bm="workbench.settings.applyToAllProfiles",Er="vs/workbench/api/common/configurationExtensionPoint",EYt=Gc.as(vee.JSONContribution),uM=Gc.as(lg.Configuration),NSe={type:"object",defaultSnippets:[{body:{title:"",properties:{}}}],properties:{title:{description:Ve(Er,0,"A title for the current category of settings. This label will be rendered in the Settings editor as a subheading. If the title is the same as the extension display name, then the category will be grouped under the main extension heading."),type:"string"},order:{description:Ve(Er,1,"When specified, gives the order of this category of settings relative to other categories."),type:"integer"},properties:{description:Ve(Er,2,"Description of the configuration properties."),type:"object",propertyNames:{pattern:"\\S+",patternErrorMessage:Ve(Er,3,"Property should not be empty.")},additionalProperties:{anyOf:[{title:Ve(Er,4,"Schema of the configuration property."),$ref:"http://json-schema.org/draft-07/schema#"},{type:"object",properties:{scope:{type:"string",enum:["application","machine","window","resource","language-overridable","machine-overridable"],default:"window",enumDescriptions:[Ve(Er,5,"Configuration that can be configured only in the user settings."),Ve(Er,6,"Configuration that can be configured only in the user settings or only in the remote settings."),Ve(Er,7,"Configuration that can be configured in the user, remote or workspace settings."),Ve(Er,8,"Configuration that can be configured in the user, remote, workspace or folder settings."),Ve(Er,9,"Resource configuration that can be configured in language specific settings."),Ve(Er,10,"Machine configuration that can be configured also in workspace or folder settings.")],markdownDescription:Ve(Er,11,"Scope in which the configuration is applicable. Available scopes are `application`, `machine`, `window`, `resource`, and `machine-overridable`.")},enumDescriptions:{type:"array",items:{type:"string"},description:Ve(Er,12,"Descriptions for enum values")},markdownEnumDescriptions:{type:"array",items:{type:"string"},description:Ve(Er,13,"Descriptions for enum values in the markdown format.")},enumItemLabels:{type:"array",items:{type:"string"},markdownDescription:Ve(Er,14,"Labels for enum values to be displayed in the Settings editor. When specified, the {0} values still show after the labels, but less prominently.","`enum`")},markdownDescription:{type:"string",description:Ve(Er,15,"The description in the markdown format.")},deprecationMessage:{type:"string",description:Ve(Er,16,"If set, the property is marked as deprecated and the given message is shown as an explanation.")},markdownDeprecationMessage:{type:"string",description:Ve(Er,17,"If set, the property is marked as deprecated and the given message is shown as an explanation in the markdown format.")},editPresentation:{type:"string",enum:["singlelineText","multilineText"],enumDescriptions:[Ve(Er,18,"The value will be shown in an inputbox."),Ve(Er,19,"The value will be shown in a textarea.")],default:"singlelineText",description:Ve(Er,20,"When specified, controls the presentation format of the string setting.")},order:{type:"integer",description:Ve(Er,21,"When specified, gives the order of this setting relative to other settings within the same category. Settings with an order property will be placed before settings without this property set.")},ignoreSync:{type:"boolean",description:Ve(Er,22,"When enabled, Settings Sync will not sync the user value of this configuration by default.")}}}]}}}};let _d;const lBe=yee.registerExtensionPoint({extensionPoint:"configurationDefaults",jsonSchema:{$ref:F2e}});lBe.setHandler((n,{added:e,removed:t})=>{_d&&uM.deltaConfiguration(_d);const r=_d={};if(queueMicrotask(()=>{_d===r&&(uM.deltaConfiguration(_d),_d=void 0)}),t.length){const i=t.map(o=>({overrides:zl(o.value),source:{id:o.description.identifier.value,displayName:o.description.displayName}}));_d.removedDefaults=i}if(e.length){const i=uM.getConfigurationProperties(),o=[6,3,4,5],s=e.map(a=>{const c=zl(a.value);for(const l of Object.keys(c))if(!CC.test(l)){const u=i[l];u!=null&&u.scope&&!o.includes(u.scope)&&(a.collector.warn(Ve(Er,23,"Cannot register configuration defaults for '{0}'. Only defaults for machine-overridable, window, resource and language overridable scoped settings are supported.",l)),delete c[l])}return{overrides:c,source:{id:a.description.identifier.value,displayName:a.description.displayName}}});_d.addedDefaults=s}});const IYt=yee.registerExtensionPoint({extensionPoint:"configuration",deps:[lBe],jsonSchema:{description:Ve(Er,24,"Contributes configuration settings."),oneOf:[NSe,{type:"array",items:NSe}]}}),xz=new jy;IYt.setHandler((n,{added:e,removed:t})=>{if(_d??(_d={}),t.length){const s=[];for(const a of t)s.push(...xz.get(a.description.identifier)||[]),xz.delete(a.description.identifier);_d.removedConfigurations=s}const r=new Set;function i(s,a){var u,d,h;const c=[],l=zl(s);return l.title&&typeof l.title!="string"&&a.collector.error(Ve(Er,25,"'configuration.title' must be a string")),o(l,a),l.id=s.id||a.description.identifier.value,l.extensionInfo={id:a.description.identifier.value,displayName:a.description.displayName},l.restrictedProperties=((d=(u=a.description.capabilities)==null?void 0:u.untrustedWorkspaces)==null?void 0:d.supported)==="limited"?(h=a.description.capabilities)==null?void 0:h.untrustedWorkspaces.restrictedConfigurations:void 0,l.title=l.title||a.description.displayName||a.description.identifier.value,c.push(l),c}function o(s,a){const c=s.properties;if(c){typeof c!="object"&&(a.collector.error(Ve(Er,26,"'configuration.properties' must be an object")),s.properties={});for(const u in c){const d=c[u],h=_Ze(u,d);if(h){delete c[u],a.collector.warn(h);continue}if(r.has(u)){delete c[u],a.collector.warn(Ve(Er,27,"Cannot register '{0}'. This property is already registered.",u));continue}if(!xd(d)){delete c[u],a.collector.error(Ve(Er,28,"configuration.properties property '{0}' must be an object",u));continue}r.add(u),d.scope?d.scope.toString()==="application"?d.scope=1:d.scope.toString()==="machine"?d.scope=2:d.scope.toString()==="resource"?d.scope=4:d.scope.toString()==="machine-overridable"?d.scope=6:d.scope.toString()==="language-overridable"?d.scope=5:d.scope=3:d.scope=3}}const l=s.allOf;if(l){a.collector.error(Ve(Er,29,"'configuration.allOf' is deprecated and should no longer be used. Instead, pass multiple configuration sections as an array to the 'configuration' contribution point."));for(const u of l)o(u,a)}}if(e.length){const s=[];for(const a of e){const c=[],l=a.value;Array.isArray(l)?l.forEach(u=>c.push(...i(u,a))):c.push(...i(l,a)),xz.set(a.description.identifier,c),s.push(...c)}_d.addedConfigurations=s}uM.deltaConfiguration(_d),_d=void 0});EYt.registerSchema("vscode://schemas/workspaceConfig",{allowComments:!0,allowTrailingCommas:!0,default:{folders:[{path:""}],settings:{}},required:["folders"],properties:{folders:{minItems:0,uniqueItems:!0,description:Ve(Er,30,"List of folders to be loaded in the workspace."),items:{type:"object",defaultSnippets:[{body:{path:"$1"}}],oneOf:[{properties:{path:{type:"string",description:Ve(Er,31,"A file path. e.g. `/root/folderA` or `./folderA` for a relative path that will be resolved against the location of the workspace file.")},name:{type:"string",description:Ve(Er,32,"An optional name for the folder. ")}},required:["path"]},{properties:{uri:{type:"string",description:Ve(Er,33,"URI of the folder")},name:{type:"string",description:Ve(Er,32,"An optional name for the folder. ")}},required:["uri"]}]}},settings:{type:"object",default:{},description:Ve(Er,34,"Workspace settings"),$ref:oBe},launch:{type:"object",default:{configurations:[],compounds:[]},description:Ve(Er,35,"Workspace launch configurations"),$ref:SYt},tasks:{type:"object",default:{version:"2.0.0",tasks:[]},description:Ve(Er,36,"Workspace task configurations"),$ref:_Yt},extensions:{type:"object",default:{},description:Ve(Er,37,"Workspace extensions"),$ref:"vscode://schemas/extensions"},remoteAuthority:{type:"string",doNotSuggest:!0,description:Ve(Er,38,"The remote server where the workspace is located.")},transient:{type:"boolean",doNotSuggest:!0,description:Ve(Er,39,"A transient workspace will disappear when restarting or reloading.")}},errorMessage:Ve(Er,40,"Unknown workspace configuration property")});class PYt extends Dr{constructor(){super(...arguments),this.type="table"}shouldRender(e){var t;return!!((t=e.contributes)!=null&&t.configuration)}render(e){var a;const t=(a=e.contributes)==null?void 0:a.configuration;let r={};Array.isArray(t)?t.forEach(c=>{r={...r,...c.properties}}):t&&(r=t.properties);const i=r?Object.keys(r):[],o=[Ve(Er,41,"ID"),Ve(Er,42,"Description"),Ve(Er,43,"Default")],s=i.sort((c,l)=>c.localeCompare(l)).map(c=>[new Ij().appendMarkdown(`\`${c}\``),r[c].markdownDescription?new Ij(r[c].markdownDescription,!1):r[c].description??"",new Ij().appendCodeblock("json",JSON.stringify(x2e(r[c].default)?wZe(r[c].type):r[c].default,null,2))]);return{data:{headers:o,rows:s},dispose:()=>{}}}}Gc.as(SZe.ExtensionFeaturesRegistry).registerExtensionFeature({id:"configuration",label:Ve(Er,44,"Settings"),access:{canToggle:!1},renderer:new wd(PYt)});const d1="vs/workbench/contrib/workspaces/browser/workspaces.contribution";let tY=class extends Dr{constructor(e,t,r,i,o,s){super(),this.contextService=e,this.notificationService=t,this.fileService=r,this.quickInputService=i,this.hostService=o,this.storageService=s,this.findWorkspaces()}async findWorkspaces(){var r;const e=this.contextService.getWorkspace().folders[0];if(!e||this.contextService.getWorkbenchState()!==2||xZe(this.contextService.getWorkspace()))return;const t=(r=(await this.fileService.resolve(e.uri)).children)==null?void 0:r.map(i=>i.name);if(Array.isArray(t)){const i=t.filter(j2e);i.length>0&&this.doHandleWorkspaceFiles(e.uri,i)}}doHandleWorkspaceFiles(e,t){const r={id:"workspaces.dontPromptToOpen",scope:EZe.WORKSPACE,isSecondary:!0};if(t.length===1){const i=t[0];this.notificationService.prompt($s.Info,Ve(d1,0,"This folder contains a workspace file '{0}'. Do you want to open it? [Learn more]({1}) about workspace files.",i,"https://go.microsoft.com/fwlink/?linkid=2025315"),[{label:Ve(d1,1,"Open Workspace"),run:()=>this.hostService.openWindow([{workspaceUri:jh(e,i)}])}],{neverShowAgain:r,priority:this.storageService.isNew(1)?void 0:Kce.SILENT})}else t.length>1&&this.notificationService.prompt($s.Info,Ve(d1,2,"This folder contains multiple workspace files. Do you want to open one? [Learn more]({0}) about workspace files.","https://go.microsoft.com/fwlink/?linkid=2025315"),[{label:Ve(d1,3,"Select Workspace"),run:()=>{this.quickInputService.pick(t.map(i=>({label:i})),{placeHolder:Ve(d1,4,"Select a workspace to open")}).then(i=>{i&&this.hostService.openWindow([{workspaceUri:jh(e,i.label)}])})}}],{neverShowAgain:r,priority:this.storageService.isNew(1)?void 0:Kce.SILENT})}};tY=An([Be(0,kg),Be(1,ZL),Be(2,Tg),Be(3,MZe),Be(4,See),Be(5,XL)],tY);Gc.as(bee.Workbench).registerWorkbenchContribution(tY,4);CZe(class extends IZe{constructor(){super({id:"workbench.action.openWorkspaceFromEditor",title:RGe(d1,1,"Open Workspace"),f1:!1,menu:{id:PZe.EditorContent,when:kZe.and(TZe.Extension.isEqualTo(DZe),RZe.isEqualTo(AZe),OZe.toNegated())}})}async run(n,e){const t=n.get(See),r=n.get(kg),i=n.get(ZL);if(r.getWorkbenchState()===3){const o=r.getWorkspace().configuration;if(o&&_ee(o,e)){i.info(Ve(d1,5,"This workspace is already open."));return}}return t.openWindow([{workspaceUri:e}])}});class N$ extends wS{constructor(e,t){super(e,t),this._folders=[],this._transient=!1,this._settingsModelParser=new wS(e,t),this._launchModel=Js.createEmptyModel(t),this._tasksModel=Js.createEmptyModel(t)}get folders(){return this._folders}get transient(){return this._transient}get settingsModel(){return this._settingsModelParser.configurationModel}get launchModel(){return this._launchModel}get tasksModel(){return this._tasksModel}reparseWorkspaceSettings(e){this._settingsModelParser.reparse(e)}getRestrictedWorkspaceSettings(){return this._settingsModelParser.restrictedConfigurations}doParseRaw(e,t){return this._folders=e.folders||[],this._transient=AGe(e.transient)&&e.transient,this._settingsModelParser.parseRaw(e.settings,t),this._launchModel=this.createConfigurationModelFrom(e,"launch"),this._tasksModel=this.createConfigurationModelFrom(e,"tasks"),super.doParseRaw(e,t)}createConfigurationModelFrom(e,t){const r=e[t];if(r){const i=B2e(r,a=>console.error(`Conflict in settings file ${this._name}: ${a}`)),o=Object.create(null);o[t]=i;const s=Object.keys(r).map(a=>`${t}.${a}`);return new Js(o,s,[],void 0,this.logService)}return Js.createEmptyModel(this.logService)}}class uBe extends wS{constructor(e,t,r){super(e,r),this.scope=t}doParseRaw(e,t){const r=B2e(e,s=>console.error(`Conflict in settings file ${this._name}: ${s}`)),i=Object.create(null);i[this.scope]=r;const o=Object.keys(e).map(s=>`${this.scope}.${s}`);return{contents:i,keys:o,overrides:[]}}}class FSe extends fW{constructor(e,t,r,i,o,s,a,c,l,u,d){super(e,t,r,i,o,s,a,c,l,d),this._workspace=u}getValue(e,t={}){return super.getValue(e,t,this._workspace)}inspect(e,t={}){return super.inspect(e,t,this._workspace)}keys(){return super.keys(this._workspace)}compareAndDeleteFolderConfiguration(e){return this._workspace&&this._workspace.folders.length>0&&this._workspace.folders[0].uri.toString()===e.toString()?{keys:[],overrides:[]}:super.compareAndDeleteFolderConfiguration(e)}compare(e){const t=(s,a,c)=>{const l=[];return l.push(...a.filter(u=>s.indexOf(u)===-1)),l.push(...s.filter(u=>a.indexOf(u)===-1)),l.push(...s.filter(u=>a.indexOf(u)===-1?!1:by(this.getValue(u,{overrideIdentifier:c}),e.getValue(u,{overrideIdentifier:c}))?this._workspace&&this._workspace.folders.some(d=>!by(this.getValue(u,{resource:d.uri,overrideIdentifier:c}),e.getValue(u,{resource:d.uri,overrideIdentifier:c}))):!0)),l},r=t(this.allKeys(),e.allKeys()),i=[],o=fM([...this.allOverrideIdentifiers(),...e.allOverrideIdentifiers()]);for(const s of o){const a=t(this.getAllKeysForOverrideIdentifier(s),e.getAllKeysForOverrideIdentifier(s),s);a.length&&i.push([s,a])}return{keys:r,overrides:i}}}function kYt(n){return n.hasOwnProperty("workspace")}function dM(n){return n.hasOwnProperty("folderUri")}function TYt(n){return n.hasOwnProperty("fileUri")}function dBe(n){return F$(n)||hBe(n)}function F$(n){const e=n;return typeof(e==null?void 0:e.path)=="string"&&(!e.name||typeof e.name=="string")}function hBe(n){const e=n;return typeof(e==null?void 0:e.uri)=="string"&&(!e.name||typeof e.name=="string")}function ose(n,e,t,r,i){if(n.scheme!==r.scheme)return{name:t,uri:n.toString(!0)};let o=e?void 0:i.relativePath(r,n);if(o!==void 0)o.length===0?o=".":DP&&(o=jSe(o));else if(n.scheme===hr.file)o=n.fsPath,DP&&(o=jSe(o));else if(i.isEqualAuthority(n.authority,r.authority))o=n.path;else return{name:t,uri:n.toString(!0)};return{name:t,path:o}}function jSe(n){return n=kw(n),$Ze(n)||(n=LZe(n)),n}function Ez(n,e,t){const r=[],i=new Set,o=t.dirname(e);for(const s of n){let a;if(F$(s))s.path&&(a=t.resolvePath(o,s.path));else if(hBe(s))try{a=Te.parse(s.uri),a.path[0]!==Pp.sep&&(a=a.with({path:Pp.sep+a.path}))}catch(c){console.warn(c)}if(a){const c=t.getComparisonKey(a);if(!i.has(c)){i.add(c);const l=s.name||t.basenameOrAuthority(a);r.push(new U2e({uri:a,name:l,index:r.length},s))}}}return r}function BSe(n,e,t,r,i){const o=DYt(e,n),s=i.dirname(e),a=i.dirname(r),c=[];for(const h of o.folders){const f=F$(h)?i.resolvePath(s,h.path):Te.parse(h.uri);let p;t?p=!1:p=!F$(h)||OGe(h.path),c.push(ose(f,p,h.name,a,i))}const l={insertSpaces:!1,tabSize:4,eol:lee||E2e?`
`:`\r
`},u=H2e(n,["folders"],c,l);let d=Gce(n,u);return NZe(o.remoteAuthority,FZe(r))&&(d=Gce(d,jZe(d,["remoteAuthority"],l))),d}function DYt(n,e){const t=wee(e);if(t&&Array.isArray(t.folders))t.folders=t.folders.filter(r=>dBe(r));else throw new Error(`${n} looks like an invalid workspace file.`);return t}function RYt(n){return n.workspace&&typeof n.workspace=="object"&&typeof n.workspace.id=="string"&&typeof n.workspace.configPath=="string"}function AYt(n){return typeof n.folderUri=="string"}function OYt(n){return typeof n.fileUri=="string"}function MYt(n,e){const t={workspaces:[],files:[]};if(n){const r=function(o,s){for(let a=0;a<o.length;a++)try{s(o[a],a)}catch(c){e.warn(`Error restoring recent entry ${JSON.stringify(o[a])}: ${c.toString()}. Skip entry.`)}},i=n;Array.isArray(i.entries)&&r(i.entries,o=>{const s=o.label,a=o.remoteAuthority;RYt(o)?t.workspaces.push({label:s,remoteAuthority:a,workspace:{id:o.workspace.id,configPath:Te.parse(o.workspace.configPath)}}):AYt(o)?t.workspaces.push({label:s,remoteAuthority:a,folderUri:Te.parse(o.folderUri)}):OYt(o)&&t.files.push({label:s,remoteAuthority:a,fileUri:Te.parse(o.fileUri)})})}return t}function $Yt(n){const e={entries:[]};for(const t of n.workspaces)dM(t)?e.entries.push({folderUri:t.folderUri.toString(),label:t.label,remoteAuthority:t.remoteAuthority}):e.entries.push({workspace:{id:t.workspace.id,configPath:t.workspace.configPath.toString()},label:t.label,remoteAuthority:t.remoteAuthority});for(const t of n.files)e.entries.push({fileUri:t.fileUri.toString(),label:t.label,remoteAuthority:t.remoteAuthority});return e}const fBe=MGe(VT),Nr="vs/workbench/services/configuration/common/configurationEditing";class HSe extends JV{constructor(e,t){super(e),this.code=t}}let nY=class{constructor(e,t,r,i,o,s,a,c,l,u,d,h){this.remoteSettingsResource=e,this.configurationService=t,this.contextService=r,this.userDataProfileService=i,this.userDataProfilesService=o,this.fileService=s,this.textModelResolverService=a,this.textFileService=c,this.notificationService=l,this.preferencesService=u,this.editorService=d,this.uriIdentityService=h,this.queue=new Cee}async writeConfiguration(e,t,r={}){const i=this.getConfigurationEditOperation(e,t,r.scopes||{});return this.queue.queue(async()=>{try{await this.doWriteConfiguration(i,r)}catch(o){if(r.donotNotifyError)throw o;await this.onError(o,i,r.scopes)}})}async doWriteConfiguration(e,t){await this.validate(e.target,e,!t.handleDirtyFile,t.scopes||{});const r=e.resource,i=await this.resolveModelReference(r);try{const o=this.getFormattingOptions(i.object.textEditorModel);await this.updateConfiguration(e,i.object.textEditorModel,o,t)}finally{i.dispose()}}async updateConfiguration(e,t,r,i){if(this.hasParseErrors(t.getValue(),e))throw this.toConfigurationEditingError(11,e.target,e);if(this.textFileService.isDirty(t.uri)&&i.handleDirtyFile)switch(i.handleDirtyFile){case"save":await this.save(t,e);break;case"revert":await this.textFileService.revert(t.uri);break}const o=this.getEdits(e,t.getValue(),r)[0];o&&this.applyEditsToBuffer(o,t)&&await this.save(t,e)}async save(e,t){try{await this.textFileService.save(e.uri,{ignoreErrorHandler:!0})}catch(r){throw r.fileOperationResult===3?this.toConfigurationEditingError(10,t.target,t):new HSe(Ve(Nr,0,"Error while writing to {0}. {1}",this.stringifyTarget(t.target),r.message),13)}}applyEditsToBuffer(e,t){const r=t.getPositionAt(e.offset),i=t.getPositionAt(e.offset+e.length),o=new Sy(r.lineNumber,r.column,i.lineNumber,i.column),s=t.getValueInRange(o);if(e.content!==s){const a=s?Zce.replace(o,e.content):Zce.insert(r,e.content);return t.pushEditOperations([new z2e(r.lineNumber,r.column,r.lineNumber,r.column)],[a],()=>[]),!0}return!1}getEdits({value:e,jsonPath:t},r,i){return t.length?H2e(r,t,e,i):[{content:JSON.stringify(e,null,i.insertSpaces&&i.tabSize?" ".repeat(i.tabSize):"	"),length:r.length,offset:0}]}getFormattingOptions(e){const{insertSpaces:t,tabSize:r}=e.getOptions(),i=e.getEOL();return{insertSpaces:t,tabSize:r,eol:i}}async onError(e,t,r){switch(e.code){case 11:this.onInvalidConfigurationError(e,t);break;case 9:this.onConfigurationFileDirtyError(e,t,r);break;case 10:return this.doWriteConfiguration(t,{scopes:r,handleDirtyFile:"revert"});default:this.notificationService.error(e.message)}}onInvalidConfigurationError(e,t){const r=t.workspaceStandAloneConfigurationKey===Iu?Ve(Nr,1,"Open Tasks Configuration"):t.workspaceStandAloneConfigurationKey===C0?Ve(Nr,2,"Open Launch Configuration"):null;r?this.notificationService.prompt($s.Error,e.message,[{label:r,run:()=>this.openFile(t.resource)}]):this.notificationService.prompt($s.Error,e.message,[{label:Ve(Nr,3,"Open Settings"),run:()=>this.openSettings(t)}])}onConfigurationFileDirtyError(e,t,r){const i=t.workspaceStandAloneConfigurationKey===Iu?Ve(Nr,1,"Open Tasks Configuration"):t.workspaceStandAloneConfigurationKey===C0?Ve(Nr,2,"Open Launch Configuration"):null;i?this.notificationService.prompt($s.Error,e.message,[{label:Ve(Nr,4,"Save and Retry"),run:()=>{const o=t.key?`${t.workspaceStandAloneConfigurationKey}.${t.key}`:t.workspaceStandAloneConfigurationKey;this.writeConfiguration(t.target,{key:o,value:t.value},{handleDirtyFile:"save",scopes:r})}},{label:i,run:()=>this.openFile(t.resource)}]):this.notificationService.prompt($s.Error,e.message,[{label:Ve(Nr,4,"Save and Retry"),run:()=>this.writeConfiguration(t.target,{key:t.key,value:t.value},{handleDirtyFile:"save",scopes:r})},{label:Ve(Nr,3,"Open Settings"),run:()=>this.openSettings(t)}])}openSettings(e){const t={jsonEditor:!0};switch(e.target){case 1:this.preferencesService.openUserSettings(t);break;case 2:this.preferencesService.openRemoteSettings(t);break;case 3:this.preferencesService.openWorkspaceSettings(t);break;case 4:if(e.resource){const r=this.contextService.getWorkspaceFolder(e.resource);r&&this.preferencesService.openFolderSettings({folderUri:r.uri,jsonEditor:!0})}break}}openFile(e){this.editorService.openEditor({resource:e,options:{pinned:!0}})}toConfigurationEditingError(e,t,r){const i=this.toErrorMessage(e,t,r);return new HSe(i,e)}toErrorMessage(e,t,r){switch(e){case 12:return Ve(Nr,5,"Unable to write {0} because it is configured in system policy.",r.key);case 0:return Ve(Nr,6,"Unable to write to {0} because {1} is not a registered configuration.",this.stringifyTarget(t),r.key);case 1:return Ve(Nr,7,"Unable to write {0} to Workspace Settings. This setting can be written only into User settings.",r.key);case 2:return Ve(Nr,8,"Unable to write {0} to Workspace Settings. This setting can be written only into User settings.",r.key);case 3:return Ve(Nr,9,"Unable to write to Folder Settings because {0} does not support the folder resource scope.",r.key);case 4:return Ve(Nr,10,"Unable to write to User Settings because {0} does not support for global scope.",r.key);case 5:return Ve(Nr,11,"Unable to write to Workspace Settings because {0} does not support for workspace scope in a multi folder workspace.",r.key);case 6:return Ve(Nr,12,"Unable to write to Folder Settings because no resource is provided.");case 7:return Ve(Nr,13,"Unable to write to Language Settings because {0} is not a resource language setting.",r.key);case 8:return Ve(Nr,14,"Unable to write to {0} because no workspace is opened. Please open a workspace first and try again.",this.stringifyTarget(t));case 11:{if(r.workspaceStandAloneConfigurationKey===Iu)return Ve(Nr,15,"Unable to write into the tasks configuration file. Please open it to correct errors/warnings in it and try again.");if(r.workspaceStandAloneConfigurationKey===C0)return Ve(Nr,16,"Unable to write into the launch configuration file. Please open it to correct errors/warnings in it and try again.");switch(t){case 1:return Ve(Nr,17,"Unable to write into user settings. Please open the user settings to correct errors/warnings in it and try again.");case 2:return Ve(Nr,18,"Unable to write into remote user settings. Please open the remote user settings to correct errors/warnings in it and try again.");case 3:return Ve(Nr,19,"Unable to write into workspace settings. Please open the workspace settings to correct errors/warnings in the file and try again.");case 4:{let i="<<unknown>>";if(r.resource){const o=this.contextService.getWorkspaceFolder(r.resource);o&&(i=o.name)}return Ve(Nr,20,"Unable to write into folder settings. Please open the '{0}' folder settings to correct errors/warnings in it and try again.",i)}default:return""}}case 9:{if(r.workspaceStandAloneConfigurationKey===Iu)return Ve(Nr,21,"Unable to write into tasks configuration file because the file has unsaved changes. Please save it first and then try again.");if(r.workspaceStandAloneConfigurationKey===C0)return Ve(Nr,22,"Unable to write into launch configuration file because the file has unsaved changes. Please save it first and then try again.");switch(t){case 1:return Ve(Nr,23,"Unable to write into user settings because the file has unsaved changes. Please save the user settings file first and then try again.");case 2:return Ve(Nr,24,"Unable to write into remote user settings because the file has unsaved changes. Please save the remote user settings file first and then try again.");case 3:return Ve(Nr,25,"Unable to write into workspace settings because the file has unsaved changes. Please save the workspace settings file first and then try again.");case 4:{let i="<<unknown>>";if(r.resource){const o=this.contextService.getWorkspaceFolder(r.resource);o&&(i=o.name)}return Ve(Nr,26,"Unable to write into folder settings because the file has unsaved changes. Please save the '{0}' folder settings file first and then try again.",i)}default:return""}}case 10:if(r.workspaceStandAloneConfigurationKey===Iu)return Ve(Nr,27,"Unable to write into tasks configuration file because the content of the file is newer.");if(r.workspaceStandAloneConfigurationKey===C0)return Ve(Nr,28,"Unable to write into launch configuration file because the content of the file is newer.");switch(t){case 1:return Ve(Nr,29,"Unable to write into user settings because the content of the file is newer.");case 2:return Ve(Nr,30,"Unable to write into remote user settings because the content of the file is newer.");case 3:return Ve(Nr,31,"Unable to write into workspace settings because the content of the file is newer.");case 4:return Ve(Nr,32,"Unable to write into folder settings because the content of the file is newer.")}case 13:return Ve(Nr,33,"Unable to write to {0} because of an internal error.",this.stringifyTarget(t))}}stringifyTarget(e){switch(e){case 1:return Ve(Nr,34,"User Settings");case 2:return Ve(Nr,35,"Remote User Settings");case 3:return Ve(Nr,36,"Workspace Settings");case 4:return Ve(Nr,37,"Folder Settings");default:return""}}defaultResourceValue(e){const t=this.uriIdentityService.extUri.basename(e);switch(t.substr(0,t.length-this.uriIdentityService.extUri.extname(e).length)){case Iu:return xYt;default:return"{}"}}async resolveModelReference(e){return await this.fileService.exists(e)||await this.textFileService.write(e,this.defaultResourceValue(e),{encoding:"utf8"}),this.textModelResolverService.createModelReference(e)}hasParseErrors(e,t){if(t.workspaceStandAloneConfigurationKey&&!t.key)return!1;const r=[];return wee(e,r,{allowTrailingComma:!0,allowEmptyContent:!0}),r.length>0}async validate(e,t,r,i){var a,c;if(this.configurationService.inspect(t.key).policyValue!==void 0)throw this.toConfigurationEditingError(12,e,t);const s=(a=Gc.as(lg.Configuration).getConfigurationProperties()[t.key])==null?void 0:a.scope;if(!t.workspaceStandAloneConfigurationKey&&this.configurationService.keys().default.indexOf(t.key)<0&&!CC.test(t.key)&&t.value!==void 0)throw this.toConfigurationEditingError(0,e,t);if(t.workspaceStandAloneConfigurationKey&&t.workspaceStandAloneConfigurationKey!==Iu&&(e===1||e===2))throw this.toConfigurationEditingError(4,e,t);if((e===3||e===4)&&this.contextService.getWorkbenchState()===1)throw this.toConfigurationEditingError(8,e,t);if(e===3&&!t.workspaceStandAloneConfigurationKey&&!CC.test(t.key)){if(s===1)throw this.toConfigurationEditingError(1,e,t);if(s===2)throw this.toConfigurationEditingError(2,e,t)}if(e===4){if(!t.resource)throw this.toConfigurationEditingError(6,e,t);if(!t.workspaceStandAloneConfigurationKey&&!CC.test(t.key)&&s!==void 0&&!aBe.includes(s))throw this.toConfigurationEditingError(3,e,t)}if((c=i.overrideIdentifiers)!=null&&c.length&&s!==5)throw this.toConfigurationEditingError(7,e,t);if(!t.resource)throw this.toConfigurationEditingError(6,e,t);if(r&&this.textFileService.isDirty(t.resource))throw this.toConfigurationEditingError(9,e,t)}getConfigurationEditOperation(e,t,r){var l,u;if(t.key){const d=e===1?cBe:ise,h=Object.keys(d);for(const f of h){const p=this.getConfigurationFileResource(e,f,d[f],r.resource,void 0);if(t.key===f){const m=this.isWorkspaceConfigurationResource(p)?[f]:[];return{key:m[m.length-1],jsonPath:m,value:t.value,resource:p??void 0,workspaceStandAloneConfigurationKey:f,target:e}}const g=`${f}.`;if(t.key.indexOf(g)===0){const m=this.isWorkspaceConfigurationResource(p)?[f,t.key.substr(g.length)]:[t.key.substr(g.length)];return{key:m[m.length-1],jsonPath:m,value:t.value,resource:p??void 0,workspaceStandAloneConfigurationKey:f,target:e}}}}const i=t.key,s=(l=Gc.as(lg.Configuration).getConfigurationProperties()[i])==null?void 0:l.scope;let a=(u=r.overrideIdentifiers)!=null&&u.length?[V2e(r.overrideIdentifiers),i]:[i];if(e===1||e===2)return{key:i,jsonPath:a,value:t.value,resource:this.getConfigurationFileResource(e,i,"",null,s)??void 0,target:e};const c=this.getConfigurationFileResource(e,i,pYt,r.resource,s);return this.isWorkspaceConfigurationResource(c)&&(a=["settings",...a]),{key:i,jsonPath:a,value:t.value,resource:c??void 0,target:e}}isWorkspaceConfigurationResource(e){const t=this.contextService.getWorkspace();return!!(t.configuration&&e&&t.configuration.fsPath===e.fsPath)}getConfigurationFileResource(e,t,r,i,o){if(e===1)return t===Iu?this.userDataProfileService.currentProfile.tasksResource:!this.userDataProfileService.currentProfile.isDefault&&this.configurationService.isSettingAppliedForAllProfiles(t)?this.userDataProfilesService.defaultProfile.settingsResource:this.userDataProfileService.currentProfile.settingsResource;if(e===2)return this.remoteSettingsResource;const s=this.contextService.getWorkbenchState();if(s!==1){const a=this.contextService.getWorkspace();if(e===3){if(s===3)return a.configuration??null;if(s===2)return a.folders[0].toResource(r)}if(e===4&&i){const c=this.contextService.getWorkspaceFolder(i);if(c)return c.toResource(r)}}return null}};nY=An([Be(1,fBe),Be(2,kg),Be(3,xee),Be(4,Gx),Be(5,Tg),Be(6,Eee),Be(7,Iee),Be(8,ZL),Be(9,BZe),Be(10,HZe),Be(11,WT)],nY);const bC=class bC extends UZe{constructor(e,t,r){var i;super(r),this.configurationCache=e,this.configurationRegistry=Gc.as(lg.Configuration),this.cachedConfigurationDefaultsOverrides={},this.cacheKey={type:"defaults",key:"configurationDefaultsOverrides"},this.updateCache=!1,(i=t.options)!=null&&i.configurationDefaults&&this.configurationRegistry.registerDefaultConfigurations([{overrides:t.options.configurationDefaults}])}getConfigurationDefaultOverrides(){return this.cachedConfigurationDefaultsOverrides}async initialize(){return await this.initializeCachedConfigurationDefaultsOverrides(),super.initialize()}reload(){return this.updateCache=!0,this.cachedConfigurationDefaultsOverrides={},this.updateCachedConfigurationDefaultsOverrides(),super.reload()}hasCachedConfigurationDefaultsOverrides(){return!$Ge(this.cachedConfigurationDefaultsOverrides)}initializeCachedConfigurationDefaultsOverrides(){return this.initiaizeCachedConfigurationDefaultsOverridesPromise||(this.initiaizeCachedConfigurationDefaultsOverridesPromise=(async()=>{try{if(localStorage.getItem(bC.DEFAULT_OVERRIDES_CACHE_EXISTS_KEY)){const e=await this.configurationCache.read(this.cacheKey);e&&(this.cachedConfigurationDefaultsOverrides=JSON.parse(e))}}catch{}this.cachedConfigurationDefaultsOverrides=xd(this.cachedConfigurationDefaultsOverrides)?this.cachedConfigurationDefaultsOverrides:{}})()),this.initiaizeCachedConfigurationDefaultsOverridesPromise}onDidUpdateConfiguration(e,t){super.onDidUpdateConfiguration(e,t),t&&this.updateCachedConfigurationDefaultsOverrides()}async updateCachedConfigurationDefaultsOverrides(){if(!this.updateCache)return;const e={},t=this.configurationRegistry.getConfigurationDefaultsOverrides();for(const[r,i]of t)!CC.test(r)&&i.value!==void 0&&(e[r]=i.value);try{Object.keys(e).length?(localStorage.setItem(bC.DEFAULT_OVERRIDES_CACHE_EXISTS_KEY,"yes"),await this.configurationCache.write(this.cacheKey,JSON.stringify(e))):(localStorage.removeItem(bC.DEFAULT_OVERRIDES_CACHE_EXISTS_KEY),await this.configurationCache.remove(this.cacheKey))}catch{}}};bC.DEFAULT_OVERRIDES_CACHE_EXISTS_KEY="DefaultOverridesCacheExists";let rY=bC;class LYt extends W2e{constructor(e,t,r,i){super(e.defaultProfile.settingsResource,{scopes:[1]},r.extUri,t,i),this._onDidChangeConfiguration=this._register(new ft),this.onDidChangeConfiguration=this._onDidChangeConfiguration.event,this._register(this.onDidChange(()=>this.reloadConfigurationScheduler.schedule())),this.reloadConfigurationScheduler=this._register(new Zx(()=>this.loadConfiguration().then(o=>this._onDidChangeConfiguration.fire(o)),50))}async initialize(){return this.loadConfiguration()}async loadConfiguration(){const e=await super.loadConfiguration(),t=e.getValue(bm),r=Array.isArray(t)?t:[];return this.parseOptions.include||r.length?this.reparse({...this.parseOptions,include:r}):e}}class NYt extends Dr{get hasTasksLoaded(){return this.userConfiguration.value instanceof j$}constructor(e,t,r,i,o,s){super(),this.settingsResource=e,this.tasksResource=t,this.configurationParseOptions=r,this.fileService=i,this.uriIdentityService=o,this.logService=s,this._onDidChangeConfiguration=this._register(new ft),this.onDidChangeConfiguration=this._onDidChangeConfiguration.event,this.userConfiguration=this._register(new zp),this.userConfigurationChangeDisposable=this._register(new zp),this.userConfiguration.value=new W2e(e,this.configurationParseOptions,o.extUri,this.fileService,s),this.userConfigurationChangeDisposable.value=this.userConfiguration.value.onDidChange(()=>this.reloadConfigurationScheduler.schedule()),this.reloadConfigurationScheduler=this._register(new Zx(()=>this.userConfiguration.value.loadConfiguration().then(a=>this._onDidChangeConfiguration.fire(a)),50))}async reset(e,t,r){return this.settingsResource=e,this.tasksResource=t,this.configurationParseOptions=r,this.doReset()}async doReset(e){const t=this.uriIdentityService.extUri.dirname(this.settingsResource),r=this.tasksResource?[[Iu,this.tasksResource]]:[],i=new j$(t.toString(),this.settingsResource,r,this.configurationParseOptions,this.fileService,this.uriIdentityService,this.logService),o=await i.loadConfiguration(e);return this.userConfiguration.value=i,this.userConfigurationChangeDisposable.value&&(this.userConfigurationChangeDisposable.value=this.userConfiguration.value.onDidChange(()=>this.reloadConfigurationScheduler.schedule())),o}async initialize(){return this.userConfiguration.value.loadConfiguration()}async reload(e){return this.hasTasksLoaded?this.userConfiguration.value.loadConfiguration():this.doReset(e)}reparse(e){return this.configurationParseOptions={...this.configurationParseOptions,...e},this.userConfiguration.value.reparse(this.configurationParseOptions)}getRestrictedSettings(){return this.userConfiguration.value.getRestrictedSettings()}}class j$ extends Dr{constructor(e,t,r,i,o,s,a){super(),this.settingsResource=t,this.standAloneConfigurationResources=r,this.fileService=o,this.uriIdentityService=s,this.logService=a,this._onDidChange=this._register(new ft),this.onDidChange=this._onDidChange.event,this.allResources=[this.settingsResource,...this.standAloneConfigurationResources.map(([,c])=>c)],this._register(QV(...this.allResources.map(c=>QV(this.fileService.watch(s.extUri.dirname(c)),this.fileService.watch(c))))),this._folderSettingsModelParser=new wS(e,a),this._folderSettingsParseOptions=i,this._standAloneConfigurations=[],this._cache=Js.createEmptyModel(this.logService),this._register(ns.debounce(ns.any(ns.filter(this.fileService.onDidFilesChange,c=>this.handleFileChangesEvent(c)),ns.filter(this.fileService.onDidRunOperation,c=>this.handleFileOperationEvent(c))),()=>{},100)(()=>this._onDidChange.fire()))}async resolveContents(e){const t=async o=>Promise.all(o.map(async s=>{try{return(await this.fileService.readFile(s,{atomic:!0})).value.toString()}catch(a){this.logService.trace(`Error while resolving configuration file '${s.toString()}': ${LGe(a)}`),a.fileOperationResult!==1&&a.fileOperationResult!==9&&this.logService.error(a)}return"{}"})),[[r],i]=await Promise.all([e?Promise.resolve([void 0]):t([this.settingsResource]),t(this.standAloneConfigurationResources.map(([,o])=>o))]);return[r,i.map((o,s)=>[this.standAloneConfigurationResources[s][0],o])]}async loadConfiguration(e){const[t,r]=await this.resolveContents(!!e);this._standAloneConfigurations=[],this._folderSettingsModelParser.parse("",this._folderSettingsParseOptions),t!==void 0&&this._folderSettingsModelParser.parse(t,this._folderSettingsParseOptions);for(let i=0;i<r.length;i++){const o=r[i][1];if(o!==void 0){const s=new uBe(this.standAloneConfigurationResources[i][1].toString(),this.standAloneConfigurationResources[i][0],this.logService);s.parse(o),this._standAloneConfigurations.push(s.configurationModel)}}return this.consolidate(e),this._cache}getRestrictedSettings(){return this._folderSettingsModelParser.restrictedConfigurations}reparse(e){const t=this._folderSettingsModelParser.configurationModel.contents;return this._folderSettingsParseOptions=e,this._folderSettingsModelParser.reparse(this._folderSettingsParseOptions),by(t,this._folderSettingsModelParser.configurationModel.contents)||this.consolidate(),this._cache}consolidate(e){this._cache=(e??this._folderSettingsModelParser.configurationModel).merge(...this._standAloneConfigurations)}handleFileChangesEvent(e){return!!(this.allResources.some(t=>e.contains(t))||this.allResources.some(t=>e.contains(this.uriIdentityService.extUri.dirname(t),2)))}handleFileOperationEvent(e){return!!((e.isOperation(0)||e.isOperation(3)||e.isOperation(1)||e.isOperation(4))&&this.allResources.some(t=>this.uriIdentityService.extUri.isEqual(e.resource,t))||e.isOperation(1)&&this.allResources.some(t=>this.uriIdentityService.extUri.isEqual(e.resource,this.uriIdentityService.extUri.dirname(t))))}}class FYt extends Dr{constructor(e,t,r,i,o,s){super(),this._userConfigurationInitializationPromise=null,this._onDidChangeConfiguration=this._register(new ft),this.onDidChangeConfiguration=this._onDidChangeConfiguration.event,this._onDidInitialize=this._register(new ft),this.onDidInitialize=this._onDidInitialize.event,this._fileService=r,this._userConfiguration=this._cachedConfiguration=new jYt(e,t,{scopes:Cz},s),o.getEnvironment().then(async a=>{if(a){const c=this._register(new Iz(a.settingsPath,{scopes:Cz},this._fileService,i,s));this._register(c.onDidChangeConfiguration(u=>this.onDidUserConfigurationChange(u))),this._userConfigurationInitializationPromise=c.initialize();const l=await this._userConfigurationInitializationPromise;this._userConfiguration.dispose(),this._userConfiguration=c,this.onDidUserConfigurationChange(l),this._onDidInitialize.fire(l)}})}async initialize(){if(this._userConfiguration instanceof Iz)return this._userConfiguration.initialize();let e=await this._userConfiguration.initialize();return this._userConfigurationInitializationPromise&&(e=await this._userConfigurationInitializationPromise,this._userConfigurationInitializationPromise=null),e}reload(){return this._userConfiguration.reload()}reparse(){return this._userConfiguration.reparse({scopes:Cz})}getRestrictedSettings(){return this._userConfiguration.getRestrictedSettings()}onDidUserConfigurationChange(e){this.updateCache(),this._onDidChangeConfiguration.fire(e)}async updateCache(){if(this._userConfiguration instanceof Iz){let e;try{e=await this._userConfiguration.resolveContent()}catch(t){if(t.fileOperationResult!==1)return}await this._cachedConfiguration.updateConfiguration(e)}}}class Iz extends Dr{constructor(e,t,r,i,o){super(),this.configurationResource=e,this.fileService=r,this.uriIdentityService=i,this.logService=o,this._onDidChangeConfiguration=this._register(new ft),this.onDidChangeConfiguration=this._onDidChangeConfiguration.event,this.fileWatcherDisposable=this._register(new zp),this.directoryWatcherDisposable=this._register(new zp),this.parser=new wS(this.configurationResource.toString(),o),this.parseOptions=t,this._register(r.onDidFilesChange(s=>this.handleFileChangesEvent(s))),this._register(r.onDidRunOperation(s=>this.handleFileOperationEvent(s))),this.reloadConfigurationScheduler=this._register(new Zx(()=>this.reload().then(s=>this._onDidChangeConfiguration.fire(s)),50)),this._register(ho(()=>{this.stopWatchingResource(),this.stopWatchingDirectory()}))}watchResource(){this.fileWatcherDisposable.value=this.fileService.watch(this.configurationResource)}stopWatchingResource(){this.fileWatcherDisposable.value=void 0}watchDirectory(){const e=this.uriIdentityService.extUri.dirname(this.configurationResource);this.directoryWatcherDisposable.value=this.fileService.watch(e)}stopWatchingDirectory(){this.directoryWatcherDisposable.value=void 0}async initialize(){const e=await this.fileService.exists(this.configurationResource);return this.onResourceExists(e),this.reload()}async resolveContent(){return(await this.fileService.readFile(this.configurationResource,{atomic:!0})).value.toString()}async reload(){try{const e=await this.resolveContent();return this.parser.parse(e,this.parseOptions),this.parser.configurationModel}catch{return Js.createEmptyModel(this.logService)}}reparse(e){return this.parseOptions=e,this.parser.reparse(this.parseOptions),this.parser.configurationModel}getRestrictedSettings(){return this.parser.restrictedConfigurations}handleFileChangesEvent(e){let t=e.contains(this.configurationResource,0);e.contains(this.configurationResource,1)?(t=!0,this.onResourceExists(!0)):e.contains(this.configurationResource,2)&&(t=!0,this.onResourceExists(!1)),t&&this.reloadConfigurationScheduler.schedule()}handleFileOperationEvent(e){(e.isOperation(0)||e.isOperation(3)||e.isOperation(1)||e.isOperation(4))&&this.uriIdentityService.extUri.isEqual(e.resource,this.configurationResource)&&this.reloadConfigurationScheduler.schedule()}onResourceExists(e){e?(this.stopWatchingDirectory(),this.watchResource()):(this.stopWatchingResource(),this.watchDirectory())}}class jYt extends Dr{constructor(e,t,r,i){super(),this.configurationCache=t,this._onDidChange=this._register(new ft),this.onDidChange=this._onDidChange.event,this.key={type:"user",key:e},this.parser=new wS("CachedRemoteUserConfiguration",i),this.parseOptions=r,this.configurationModel=Js.createEmptyModel(i)}getConfigurationModel(){return this.configurationModel}initialize(){return this.reload()}reparse(e){return this.parseOptions=e,this.parser.reparse(this.parseOptions),this.configurationModel=this.parser.configurationModel,this.configurationModel}getRestrictedSettings(){return this.parser.restrictedConfigurations}async reload(){try{const e=await this.configurationCache.read(this.key),t=JSON.parse(e);t.content&&(this.parser.parse(t.content,this.parseOptions),this.configurationModel=this.parser.configurationModel)}catch{}return this.configurationModel}async updateConfiguration(e){return e?this.configurationCache.write(this.key,JSON.stringify({content:e})):this.configurationCache.remove(this.key)}}class BYt extends Dr{get initialized(){return this._initialized}constructor(e,t,r,i){super(),this.configurationCache=e,this.fileService=t,this.uriIdentityService=r,this.logService=i,this._workspaceConfigurationDisposables=this._register(new ei),this._workspaceIdentifier=null,this._isWorkspaceTrusted=!1,this._onDidUpdateConfiguration=this._register(new ft),this.onDidUpdateConfiguration=this._onDidUpdateConfiguration.event,this._initialized=!1,this.fileService=t,this._workspaceConfiguration=this._cachedConfiguration=new HYt(e,i)}async initialize(e,t){this._workspaceIdentifier=e,this._isWorkspaceTrusted=t,this._initialized||(this.configurationCache.needsCaching(this._workspaceIdentifier.configPath)?(this._workspaceConfiguration=this._cachedConfiguration,this.waitAndInitialize(this._workspaceIdentifier)):this.doInitialize(new NA(this.fileService,this.uriIdentityService,this.logService))),await this.reload()}async reload(){this._workspaceIdentifier&&await this._workspaceConfiguration.load(this._workspaceIdentifier,{scopes:lM,skipRestricted:this.isUntrusted()})}getFolders(){return this._workspaceConfiguration.getFolders()}setFolders(e,t){return this._workspaceIdentifier?t.write(this._workspaceIdentifier.configPath,[{path:["folders"],value:e}],!0).then(()=>this.reload()):Promise.resolve()}isTransient(){return this._workspaceConfiguration.isTransient()}getConfiguration(){return this._workspaceConfiguration.getWorkspaceSettings()}updateWorkspaceTrust(e){return this._isWorkspaceTrusted=e,this.reparseWorkspaceSettings()}reparseWorkspaceSettings(){return this._workspaceConfiguration.reparseWorkspaceSettings({scopes:lM,skipRestricted:this.isUntrusted()}),this.getConfiguration()}getRestrictedSettings(){return this._workspaceConfiguration.getRestrictedSettings()}async waitAndInitialize(e){if(await I2e(e.configPath,this.fileService),!(this._workspaceConfiguration instanceof NA)){const t=this._register(new NA(this.fileService,this.uriIdentityService,this.logService));await t.load(e,{scopes:lM,skipRestricted:this.isUntrusted()}),this.doInitialize(t),this.onDidWorkspaceConfigurationChange(!1,!0)}}doInitialize(e){this._workspaceConfigurationDisposables.clear(),this._workspaceConfiguration=this._workspaceConfigurationDisposables.add(e),this._workspaceConfigurationDisposables.add(this._workspaceConfiguration.onDidChange(t=>this.onDidWorkspaceConfigurationChange(!0,!1))),this._initialized=!0}isUntrusted(){return!this._isWorkspaceTrusted}async onDidWorkspaceConfigurationChange(e,t){e&&await this.reload(),this.updateCache(),this._onDidUpdateConfiguration.fire(t)}async updateCache(){if(this._workspaceIdentifier&&this.configurationCache.needsCaching(this._workspaceIdentifier.configPath)&&this._workspaceConfiguration instanceof NA){const e=await this._workspaceConfiguration.resolveContent(this._workspaceIdentifier);await this._cachedConfiguration.updateWorkspace(this._workspaceIdentifier,e)}}}class NA extends Dr{constructor(e,t,r){super(),this.fileService=e,this.logService=r,this._workspaceIdentifier=null,this._onDidChange=this._register(new ft),this.onDidChange=this._onDidChange.event,this.workspaceConfigurationModelParser=new N$("",r),this.workspaceSettings=Js.createEmptyModel(r),this._register(ns.any(ns.filter(this.fileService.onDidFilesChange,i=>!!this._workspaceIdentifier&&i.contains(this._workspaceIdentifier.configPath)),ns.filter(this.fileService.onDidRunOperation,i=>!!this._workspaceIdentifier&&(i.isOperation(0)||i.isOperation(3)||i.isOperation(1)||i.isOperation(4))&&t.extUri.isEqual(i.resource,this._workspaceIdentifier.configPath)))(()=>this.reloadConfigurationScheduler.schedule())),this.reloadConfigurationScheduler=this._register(new Zx(()=>this._onDidChange.fire(),50)),this.workspaceConfigWatcher=this._register(this.watchWorkspaceConfigurationFile())}get workspaceIdentifier(){return this._workspaceIdentifier}async resolveContent(e){return(await this.fileService.readFile(e.configPath,{atomic:!0})).value.toString()}async load(e,t){(!this._workspaceIdentifier||this._workspaceIdentifier.id!==e.id)&&(this._workspaceIdentifier=e,this.workspaceConfigurationModelParser=new N$(this._workspaceIdentifier.id,this.logService),_S(this.workspaceConfigWatcher),this.workspaceConfigWatcher=this._register(this.watchWorkspaceConfigurationFile()));let r="";try{r=await this.resolveContent(this._workspaceIdentifier)}catch(i){await this.fileService.exists(this._workspaceIdentifier.configPath)&&this.logService.error(i)}this.workspaceConfigurationModelParser.parse(r,t),this.consolidate()}getConfigurationModel(){return this.workspaceConfigurationModelParser.configurationModel}getFolders(){return this.workspaceConfigurationModelParser.folders}isTransient(){return this.workspaceConfigurationModelParser.transient}getWorkspaceSettings(){return this.workspaceSettings}reparseWorkspaceSettings(e){return this.workspaceConfigurationModelParser.reparseWorkspaceSettings(e),this.consolidate(),this.getWorkspaceSettings()}getRestrictedSettings(){return this.workspaceConfigurationModelParser.getRestrictedWorkspaceSettings()}consolidate(){this.workspaceSettings=this.workspaceConfigurationModelParser.settingsModel.merge(this.workspaceConfigurationModelParser.launchModel,this.workspaceConfigurationModelParser.tasksModel)}watchWorkspaceConfigurationFile(){return this._workspaceIdentifier?this.fileService.watch(this._workspaceIdentifier.configPath):Dr.None}}class HYt{constructor(e,t){this.configurationCache=e,this.logService=t,this.onDidChange=ns.None,this.workspaceConfigurationModelParser=new N$("",t),this.workspaceSettings=Js.createEmptyModel(t)}async load(e,t){try{const r=this.getKey(e),i=await this.configurationCache.read(r),o=JSON.parse(i);o.content&&(this.workspaceConfigurationModelParser=new N$(r.key,this.logService),this.workspaceConfigurationModelParser.parse(o.content,t),this.consolidate())}catch{}}get workspaceIdentifier(){return null}getConfigurationModel(){return this.workspaceConfigurationModelParser.configurationModel}getFolders(){return this.workspaceConfigurationModelParser.folders}isTransient(){return this.workspaceConfigurationModelParser.transient}getWorkspaceSettings(){return this.workspaceSettings}reparseWorkspaceSettings(e){return this.workspaceConfigurationModelParser.reparseWorkspaceSettings(e),this.consolidate(),this.getWorkspaceSettings()}getRestrictedSettings(){return this.workspaceConfigurationModelParser.getRestrictedWorkspaceSettings()}consolidate(){this.workspaceSettings=this.workspaceConfigurationModelParser.settingsModel.merge(this.workspaceConfigurationModelParser.launchModel,this.workspaceConfigurationModelParser.tasksModel)}async updateWorkspace(e,t){try{const r=this.getKey(e);t?await this.configurationCache.write(r,JSON.stringify({content:t})):await this.configurationCache.remove(r)}catch{}}getKey(e){return{type:"workspaces",key:e.id}}}class UYt{constructor(e,t,r,i,o){this.configurationCache=i,this.logService=o,this.onDidChange=ns.None,this.key={type:"folder",key:YL(jh(e,t).toString()).toString(16)},this._folderSettingsModelParser=new wS("CachedFolderConfiguration",o),this._folderSettingsParseOptions=r,this._standAloneConfigurations=[],this.configurationModel=Js.createEmptyModel(o)}async loadConfiguration(){try{const e=await this.configurationCache.read(this.key),{content:t}=JSON.parse(e.toString());if(t)for(const r of Object.keys(t))if(r===L$)this._folderSettingsModelParser.parse(t[r],this._folderSettingsParseOptions);else{const i=new uBe(r,r,this.logService);i.parse(t[r]),this._standAloneConfigurations.push(i.configurationModel)}this.consolidate()}catch{}return this.configurationModel}async updateConfiguration(e,t){const r={};e&&(r[L$]=e),t.forEach(([i,o])=>{o&&(r[i]=o)}),Object.keys(r).length?await this.configurationCache.write(this.key,JSON.stringify({content:r})):await this.configurationCache.remove(this.key)}getRestrictedSettings(){return this._folderSettingsModelParser.restrictedConfigurations}reparse(e){return this._folderSettingsParseOptions=e,this._folderSettingsModelParser.reparse(this._folderSettingsParseOptions),this.consolidate(),this.configurationModel}consolidate(){this.configurationModel=this._folderSettingsModelParser.configurationModel.merge(...this._standAloneConfigurations)}getUnsupportedKeys(){return[]}}class zYt extends Dr{constructor(e,t,r,i,o,s,a,c,l){super(),this.workspaceFolder=t,this.workbenchState=i,this.workspaceTrusted=o,this.configurationCache=l,this._onDidChange=this._register(new ft),this.onDidChange=this._onDidChange.event,this.scopes=this.workbenchState===3?aBe:lM,this.configurationFolder=a.extUri.joinPath(t.uri,r),this.cachedFolderConfiguration=new UYt(t.uri,r,{scopes:this.scopes,skipRestricted:this.isUntrusted()},l,c),e&&this.configurationCache.needsCaching(t.uri)?(this.folderConfiguration=this.cachedFolderConfiguration,I2e(t.uri,s).then(()=>{this.folderConfiguration=this._register(this.createFileServiceBasedConfiguration(s,a,c)),this._register(this.folderConfiguration.onDidChange(u=>this.onDidFolderConfigurationChange())),this.onDidFolderConfigurationChange()})):(this.folderConfiguration=this._register(this.createFileServiceBasedConfiguration(s,a,c)),this._register(this.folderConfiguration.onDidChange(u=>this.onDidFolderConfigurationChange())))}loadConfiguration(){return this.folderConfiguration.loadConfiguration()}updateWorkspaceTrust(e){return this.workspaceTrusted=e,this.reparse()}reparse(){const e=this.folderConfiguration.reparse({scopes:this.scopes,skipRestricted:this.isUntrusted()});return this.updateCache(),e}getRestrictedSettings(){return this.folderConfiguration.getRestrictedSettings()}isUntrusted(){return!this.workspaceTrusted}onDidFolderConfigurationChange(){this.updateCache(),this._onDidChange.fire()}createFileServiceBasedConfiguration(e,t,r){const i=t.extUri.joinPath(this.configurationFolder,`${L$}.json`),o=[Iu,C0].map(s=>[s,t.extUri.joinPath(this.configurationFolder,`${s}.json`)]);return new j$(this.configurationFolder.toString(),i,o,{scopes:this.scopes,skipRestricted:this.isUntrusted()},e,t,r)}async updateCache(){if(this.configurationCache.needsCaching(this.configurationFolder)&&this.folderConfiguration instanceof j$){const[e,t]=await this.folderConfiguration.resolveContents();this.cachedFolderConfiguration.updateConfiguration(e,t)}}}const sse="vs/workbench/services/configuration/browser/configurationService";function USe(n,e){var t;return n.isDefault||(t=n.useDefaultFlags)!=null&&t.settings?e?CYt:void 0:e?sBe:wYt}let Pz=class extends Y2e{constructor(){super(...arguments),this.initialized=!1}};class VYt extends Dr{get restrictedSettings(){return this._restrictedSettings}constructor({remoteAuthority:e,configurationCache:t},r,i,o,s,a,c,l,u){if(super(),this.userDataProfileService=i,this.userDataProfilesService=o,this.fileService=s,this.remoteAgentService=a,this.uriIdentityService=c,this.logService=l,this.initialized=!1,this.applicationConfiguration=null,this.remoteUserConfiguration=null,this._onDidChangeConfiguration=this._register(new ft),this.onDidChangeConfiguration=this._onDidChangeConfiguration.event,this._onWillChangeWorkspaceFolders=this._register(new ft),this.onWillChangeWorkspaceFolders=this._onWillChangeWorkspaceFolders.event,this._onDidChangeWorkspaceFolders=this._register(new ft),this.onDidChangeWorkspaceFolders=this._onDidChangeWorkspaceFolders.event,this._onDidChangeWorkspaceName=this._register(new ft),this.onDidChangeWorkspaceName=this._onDidChangeWorkspaceName.event,this._onDidChangeWorkbenchState=this._register(new ft),this.onDidChangeWorkbenchState=this._onDidChangeWorkbenchState.event,this.isWorkspaceTrusted=!0,this._restrictedSettings={default:[]},this._onDidChangeRestrictedSettings=this._register(new ft),this.onDidChangeRestrictedSettings=this._onDidChangeRestrictedSettings.event,this.configurationRegistry=Gc.as(lg.Configuration),this.initRemoteUserConfigurationBarrier=new Mf,this.completeWorkspaceBarrier=new Mf,this.defaultConfiguration=this._register(new rY(t,r,l)),this.policyConfiguration=u instanceof ZZe?new XZe:this._register(new YZe(this.defaultConfiguration,u,l)),this.configurationCache=t,this._configuration=new FSe(this.defaultConfiguration.configurationModel,this.policyConfiguration.configurationModel,Js.createEmptyModel(l),Js.createEmptyModel(l),Js.createEmptyModel(l),Js.createEmptyModel(l),new Wl,Js.createEmptyModel(l),new Wl,this.workspace,l),this.applicationConfigurationDisposables=this._register(new ei),this.createApplicationConfiguration(),this.localUserConfiguration=this._register(new NYt(i.currentProfile.settingsResource,i.currentProfile.tasksResource,{scopes:USe(i.currentProfile,!!e)},s,c,l)),this.cachedFolderConfigs=new Wl,this._register(this.localUserConfiguration.onDidChangeConfiguration(d=>this.onLocalUserConfigurationChanged(d))),e){const d=this.remoteUserConfiguration=this._register(new FYt(e,t,s,c,a,l));this._register(d.onDidInitialize(h=>{this._register(d.onDidChangeConfiguration(f=>this.onRemoteUserConfigurationChanged(f))),this.onRemoteUserConfigurationChanged(h),this.initRemoteUserConfigurationBarrier.open()}))}else this.initRemoteUserConfigurationBarrier.open();this.workspaceConfiguration=this._register(new BYt(t,s,c,l)),this._register(this.workspaceConfiguration.onDidUpdateConfiguration(d=>{this.onWorkspaceConfigurationChanged(d).then(()=>{this.workspace.initialized=this.workspaceConfiguration.initialized,this.checkAndMarkWorkspaceComplete(d)})})),this._register(this.defaultConfiguration.onDidChangeConfiguration(({properties:d,defaults:h})=>this.onDefaultConfigurationChanged(h,d))),this._register(this.policyConfiguration.onDidChangeConfiguration(d=>this.onPolicyConfigurationChanged(d))),this._register(i.onDidChangeCurrentProfile(d=>this.onUserDataProfileChanged(d))),this.workspaceEditingQueue=new Cee}createApplicationConfiguration(){var e;this.applicationConfigurationDisposables.clear(),this.userDataProfileService.currentProfile.isDefault||(e=this.userDataProfileService.currentProfile.useDefaultFlags)!=null&&e.settings?this.applicationConfiguration=null:(this.applicationConfiguration=this.applicationConfigurationDisposables.add(this._register(new LYt(this.userDataProfilesService,this.fileService,this.uriIdentityService,this.logService))),this.applicationConfigurationDisposables.add(this.applicationConfiguration.onDidChangeConfiguration(t=>this.onApplicationConfigurationChanged(t))))}async getCompleteWorkspace(){return await this.completeWorkspaceBarrier.wait(),this.getWorkspace()}getWorkspace(){return this.workspace}getWorkbenchState(){return this.workspace.configuration?3:this.workspace.folders.length===1?2:1}getWorkspaceFolder(e){return this.workspace.getFolder(e)}addFolders(e,t){return this.updateFolders(e,[],t)}removeFolders(e){return this.updateFolders([],e)}async updateFolders(e,t,r){return this.workspaceEditingQueue.queue(()=>this.doUpdateFolders(e,t,r))}isInsideWorkspace(e){return!!this.getWorkspaceFolder(e)}isCurrentWorkspace(e){switch(this.getWorkbenchState()){case 2:{let t;return Te.isUri(e)?t=e:wM(e)&&(t=e.uri),Te.isUri(t)&&this.uriIdentityService.extUri.isEqual(t,this.workspace.folders[0].uri)}case 3:return Dk(e)&&this.workspace.id===e.id}return!1}async doUpdateFolders(e,t,r){if(this.getWorkbenchState()!==3||e.length+t.length===0)return Promise.resolve(void 0);let i=!1,o=this.getWorkspace().folders,s=o.map(a=>a.raw).filter((a,c)=>dBe(a)?!this.contains(t,o[c].uri):!0);if(i=o.length!==s.length,e.length){const a=this.getWorkspace().configuration,c=this.uriIdentityService.extUri.dirname(a);o=Ez(s,a,this.uriIdentityService.extUri);const l=o.map(d=>d.uri),u=[];for(const d of e){const h=d.uri;if(!this.contains(l,h)){try{if(!(await this.fileService.stat(h)).isDirectory)continue}catch{}u.push(ose(h,!1,d.name,c,this.uriIdentityService.extUri))}}u.length>0&&(i=!0,typeof r=="number"&&r>=0&&r<s.length?(s=s.slice(0),s.splice(r,0,...u)):s=[...s,...u])}return i?this.setFolders(s):Promise.resolve(void 0)}async setFolders(e){if(!this.instantiationService)throw new Error("Cannot update workspace folders because workspace service is not yet ready to accept writes.");return await this.instantiationService.invokeFunction(t=>this.workspaceConfiguration.setFolders(e,t.get(Z2e))),this.onWorkspaceConfigurationChanged(!1)}contains(e,t){return e.some(r=>this.uriIdentityService.extUri.isEqual(r,t))}getConfigurationData(){return this._configuration.toData()}getValue(e,t){const r=typeof e=="string"?e:void 0,i=Pj(e)?e:Pj(t)?t:void 0;return this._configuration.getValue(r,i)}async updateValue(e,t,r,i,o){const s=JZe(r)?r:Pj(r)?{resource:r.resource,overrideIdentifiers:r.overrideIdentifier?[r.overrideIdentifier]:void 0}:void 0,a=s?i:r,c=a?[a]:[];if(s!=null&&s.overrideIdentifiers&&(s.overrideIdentifiers=fM(s.overrideIdentifiers),s.overrideIdentifiers=s.overrideIdentifiers.length?s.overrideIdentifiers:void 0),!c.length){if(s!=null&&s.overrideIdentifiers&&s.overrideIdentifiers.length>1)throw new Error("Configuration Target is required while updating the value for multiple override identifiers");const l=this.inspect(e,{resource:s==null?void 0:s.resource,overrideIdentifier:s!=null&&s.overrideIdentifiers?s.overrideIdentifiers[0]:void 0});c.push(...this.deriveConfigurationTargets(e,t,l)),by(t,l.defaultValue)&&c.length===1&&(c[0]===2||c[0]===3)&&(t=void 0)}await pW.settled(c.map(l=>this.writeConfigurationValue(e,t,l,s,o)))}async reloadConfiguration(e){if(e===void 0){this.reloadDefaultConfiguration();const t=await this.reloadApplicationConfiguration(!0),{local:r,remote:i}=await this.reloadUserConfiguration();await this.reloadWorkspaceConfiguration(),await this.loadConfiguration(t,r,i,!0);return}if(QZe(e)){await this.reloadWorkspaceFolderConfiguration(e);return}switch(e){case 7:this.reloadDefaultConfiguration();return;case 2:{const{local:t,remote:r}=await this.reloadUserConfiguration();await this.loadConfiguration(this._configuration.applicationConfiguration,t,r,!0);return}case 3:await this.reloadLocalUserConfiguration();return;case 4:await this.reloadRemoteUserConfiguration();return;case 5:case 6:await this.reloadWorkspaceConfiguration();return}}hasCachedConfigurationDefaultsOverrides(){return this.defaultConfiguration.hasCachedConfigurationDefaultsOverrides()}inspect(e,t){return this._configuration.inspect(e,t)}keys(){return this._configuration.keys()}async whenRemoteConfigurationLoaded(){await this.initRemoteUserConfigurationBarrier.wait()}async initialize(e){Rc("code/willInitWorkspaceService");const t=this.initialized;this.initialized=!1;const r=await this.createWorkspace(e);await this.updateWorkspaceAndInitializeConfiguration(r,t),this.checkAndMarkWorkspaceComplete(!1),Rc("code/didInitWorkspaceService")}updateWorkspaceTrust(e){var t;if(this.isWorkspaceTrusted!==e){this.isWorkspaceTrusted=e;const r=this._configuration.toData(),i=[];for(const s of this.workspace.folders){const a=this.cachedFolderConfigs.get(s.uri);let c;a&&(c=a.updateWorkspaceTrust(this.isWorkspaceTrusted),this._configuration.updateFolderConfiguration(s.uri,c)),i.push(c)}this.getWorkbenchState()===2?i[0]&&this._configuration.updateWorkspaceConfiguration(i[0]):this._configuration.updateWorkspaceConfiguration(this.workspaceConfiguration.updateWorkspaceTrust(this.isWorkspaceTrusted)),this.updateRestrictedSettings();let o=[];this.restrictedSettings.userLocal&&o.push(...this.restrictedSettings.userLocal),this.restrictedSettings.userRemote&&o.push(...this.restrictedSettings.userRemote),this.restrictedSettings.workspace&&o.push(...this.restrictedSettings.workspace),(t=this.restrictedSettings.workspaceFolder)==null||t.forEach(s=>o.push(...s)),o=fM(o),o.length&&this.triggerConfigurationChange({keys:o,overrides:[]},{data:r,workspace:this.workspace},5)}}acquireInstantiationService(e){this.instantiationService=e}isSettingAppliedForAllProfiles(e){var r;if(((r=this.configurationRegistry.getConfigurationProperties()[e])==null?void 0:r.scope)===1)return!0;const t=this.getValue(bm)??[];return Array.isArray(t)&&t.includes(e)}async createWorkspace(e){return Dk(e)?this.createMultiFolderWorkspace(e):wM(e)?this.createSingleFolderWorkspace(e):this.createEmptyWorkspace(e)}async createMultiFolderWorkspace(e){await this.workspaceConfiguration.initialize({id:e.id,configPath:e.configPath},this.isWorkspaceTrusted);const t=e.configPath,r=Ez(this.workspaceConfiguration.getFolders(),t,this.uriIdentityService.extUri),i=e.id,o=new Pz(i,r,this.workspaceConfiguration.isTransient(),t,s=>this.uriIdentityService.extUri.ignorePathCasing(s));return o.initialized=this.workspaceConfiguration.initialized,o}createSingleFolderWorkspace(e){const t=new Pz(e.id,[eXe(e.uri)],!1,null,r=>this.uriIdentityService.extUri.ignorePathCasing(r));return t.initialized=!0,t}createEmptyWorkspace(e){const t=new Pz(e.id,[],!1,null,r=>this.uriIdentityService.extUri.ignorePathCasing(r));return t.initialized=!0,Promise.resolve(t)}checkAndMarkWorkspaceComplete(e){!this.completeWorkspaceBarrier.isOpen()&&this.workspace.initialized&&(this.completeWorkspaceBarrier.open(),this.validateWorkspaceFoldersAndReload(e))}async updateWorkspaceAndInitializeConfiguration(e,t){const r=!!this.workspace;let i,o,s=[];if(r?(i=this.getWorkbenchState(),o=this.workspace.configuration?this.workspace.configuration.fsPath:void 0,s=this.workspace.folders,this.workspace.update(e)):this.workspace=e,await this.initializeConfiguration(t),r){const a=this.getWorkbenchState();i&&a!==i&&this._onDidChangeWorkbenchState.fire(a);const c=this.workspace.configuration?this.workspace.configuration.fsPath:void 0;(o&&c!==o||a!==i)&&this._onDidChangeWorkspaceName.fire();const l=this.compareFolders(s,this.workspace.folders);l&&(l.added.length||l.removed.length||l.changed.length)&&(await this.handleWillChangeWorkspaceFolders(l,!1),this._onDidChangeWorkspaceFolders.fire(l))}this.localUserConfiguration.hasTasksLoaded||this._register(tXe(nXe,()=>this.reloadLocalUserConfiguration(!1,this._configuration.localUserConfiguration)))}compareFolders(e,t){const r={added:[],removed:[],changed:[]};r.added=t.filter(i=>!e.some(o=>i.uri.toString()===o.uri.toString()));for(let i=0;i<e.length;i++){const o=e[i];let s=0;for(s=0;s<t.length&&o.uri.toString()!==t[s].uri.toString();s++);s<t.length?(i!==s||o.name!==t[s].name)&&r.changed.push(o):r.removed.push(o)}return r}async initializeConfiguration(e){await this.defaultConfiguration.initialize();const t=this.policyConfiguration.initialize(),r=this.applicationConfiguration?this.applicationConfiguration.initialize():Promise.resolve(Js.createEmptyModel(this.logService)),i=async()=>{Rc("code/willInitUserConfiguration");const c=await Promise.all([this.localUserConfiguration.initialize(),this.remoteUserConfiguration?this.remoteUserConfiguration.initialize():Promise.resolve(Js.createEmptyModel(this.logService))]);if(this.applicationConfiguration){const l=await r;c[0]=this.localUserConfiguration.reparse({exclude:l.getValue(bm)})}return Rc("code/didInitUserConfiguration"),c},[,o,[s,a]]=await Promise.all([t,r,i()]);Rc("code/willInitWorkspaceConfiguration"),await this.loadConfiguration(o,s,a,e),Rc("code/didInitWorkspaceConfiguration")}reloadDefaultConfiguration(){this.onDefaultConfigurationChanged(this.defaultConfiguration.reload())}async reloadApplicationConfiguration(e){if(!this.applicationConfiguration)return Js.createEmptyModel(this.logService);const t=await this.applicationConfiguration.loadConfiguration();return e||this.onApplicationConfigurationChanged(t),t}async reloadUserConfiguration(){const[e,t]=await Promise.all([this.reloadLocalUserConfiguration(!0),this.reloadRemoteUserConfiguration(!0)]);return{local:e,remote:t}}async reloadLocalUserConfiguration(e,t){const r=await this.localUserConfiguration.reload(t);return e||this.onLocalUserConfigurationChanged(r),r}async reloadRemoteUserConfiguration(e){if(this.remoteUserConfiguration){const t=await this.remoteUserConfiguration.reload();return e||this.onRemoteUserConfigurationChanged(t),t}return Js.createEmptyModel(this.logService)}async reloadWorkspaceConfiguration(){const e=this.getWorkbenchState();if(e===2)return this.onWorkspaceFolderConfigurationChanged(this.workspace.folders[0]);if(e===3)return this.workspaceConfiguration.reload().then(()=>this.onWorkspaceConfigurationChanged(!1))}reloadWorkspaceFolderConfiguration(e){return this.onWorkspaceFolderConfigurationChanged(e)}async loadConfiguration(e,t,r,i){this.cachedFolderConfigs=new Wl;const o=this.workspace.folders,s=await this.loadFolderConfigurations(o),a=this.getWorkspaceConfigurationModel(s),c=new Wl;s.forEach((u,d)=>c.set(o[d].uri,u));const l=this._configuration;if(this._configuration=new FSe(this.defaultConfiguration.configurationModel,this.policyConfiguration.configurationModel,e,t,r,a,c,Js.createEmptyModel(this.logService),new Wl,this.workspace,this.logService),this.initialized=!0,i){const u=this._configuration.compare(l);this.triggerConfigurationChange(u,{data:l.toData(),workspace:this.workspace},5)}this.updateRestrictedSettings()}getWorkspaceConfigurationModel(e){switch(this.getWorkbenchState()){case 2:return e[0];case 3:return this.workspaceConfiguration.getConfiguration();default:return Js.createEmptyModel(this.logService)}}onUserDataProfileChanged(e){e.join((async()=>{var o,s;const t=[];t.push(this.localUserConfiguration.reset(e.profile.settingsResource,e.profile.tasksResource,{scopes:USe(e.profile,!!this.remoteUserConfiguration)})),(e.previous.isDefault!==e.profile.isDefault||!!((o=e.previous.useDefaultFlags)!=null&&o.settings)!=!!((s=e.profile.useDefaultFlags)!=null&&s.settings))&&(this.createApplicationConfiguration(),this.applicationConfiguration&&t.push(this.reloadApplicationConfiguration(!0)));let[r,i]=await Promise.all(t);i=i??this._configuration.applicationConfiguration,this.applicationConfiguration&&(r=this.localUserConfiguration.reparse({exclude:i.getValue(bm)})),await this.loadConfiguration(i,r,this._configuration.remoteUserConfiguration,!0)})())}onDefaultConfigurationChanged(e,t){if(this.workspace){const r=this._configuration.toData(),i=this._configuration.compareAndUpdateDefaultConfiguration(e,t);if(this.applicationConfiguration&&this._configuration.updateApplicationConfiguration(this.applicationConfiguration.reparse()),this.remoteUserConfiguration&&(this._configuration.updateLocalUserConfiguration(this.localUserConfiguration.reparse()),this._configuration.updateRemoteUserConfiguration(this.remoteUserConfiguration.reparse())),this.getWorkbenchState()===2){const o=this.cachedFolderConfigs.get(this.workspace.folders[0].uri);o&&(this._configuration.updateWorkspaceConfiguration(o.reparse()),this._configuration.updateFolderConfiguration(this.workspace.folders[0].uri,o.reparse()))}else{this._configuration.updateWorkspaceConfiguration(this.workspaceConfiguration.reparseWorkspaceSettings());for(const o of this.workspace.folders){const s=this.cachedFolderConfigs.get(o.uri);s&&this._configuration.updateFolderConfiguration(o.uri,s.reparse())}}this.triggerConfigurationChange(i,{data:r,workspace:this.workspace},7),this.updateRestrictedSettings()}}onPolicyConfigurationChanged(e){const t={data:this._configuration.toData(),workspace:this.workspace},r=this._configuration.compareAndUpdatePolicyConfiguration(e);this.triggerConfigurationChange(r,t,7)}onApplicationConfigurationChanged(e){var c;const t={data:this._configuration.toData(),workspace:this.workspace},r=this._configuration.applicationConfiguration.getValue(bm)??[],i=this._configuration.compareAndUpdateApplicationConfiguration(e),o=this.getValue(bm)??[],s=this.configurationRegistry.getConfigurationProperties(),a=[];for(const l of i.keys)if(((c=s[l])==null?void 0:c.scope)===1){if(a.push(l),l===bm){for(const u of r)o.includes(u)||a.push(u);for(const u of o)r.includes(u)||a.push(u)}}else o.includes(l)&&a.push(l);i.keys=a,i.keys.includes(bm)&&this._configuration.updateLocalUserConfiguration(this.localUserConfiguration.reparse({exclude:o})),this.triggerConfigurationChange(i,t,2)}onLocalUserConfigurationChanged(e){const t={data:this._configuration.toData(),workspace:this.workspace},r=this._configuration.compareAndUpdateLocalUserConfiguration(e);this.triggerConfigurationChange(r,t,2)}onRemoteUserConfigurationChanged(e){const t={data:this._configuration.toData(),workspace:this.workspace},r=this._configuration.compareAndUpdateRemoteUserConfiguration(e);this.triggerConfigurationChange(r,t,2)}async onWorkspaceConfigurationChanged(e){if(this.workspace&&this.workspace.configuration){let t=Ez(this.workspaceConfiguration.getFolders(),this.workspace.configuration,this.uriIdentityService.extUri);if(this.workspace.initialized){const{added:r,removed:i,changed:o}=this.compareFolders(this.workspace.folders,t);r.length||i.length||o.length?t=await this.toValidWorkspaceFolders(t):t=this.workspace.folders}await this.updateWorkspaceConfiguration(t,this.workspaceConfiguration.getConfiguration(),e)}}updateRestrictedSettings(){var p,g,m;const e=[],t=this.configurationRegistry.getConfigurationProperties(),r=Object.keys(t).filter(v=>t[v].restricted).sort((v,b)=>v.localeCompare(b)),i=Hb(r,this._restrictedSettings.default,(v,b)=>v.localeCompare(b));e.push(...i.added,...i.removed);const o=(((p=this.applicationConfiguration)==null?void 0:p.getRestrictedSettings())||[]).sort((v,b)=>v.localeCompare(b)),s=Hb(o,this._restrictedSettings.application||[],(v,b)=>v.localeCompare(b));e.push(...s.added,...s.removed);const a=this.localUserConfiguration.getRestrictedSettings().sort((v,b)=>v.localeCompare(b)),c=Hb(a,this._restrictedSettings.userLocal||[],(v,b)=>v.localeCompare(b));e.push(...c.added,...c.removed);const l=(((g=this.remoteUserConfiguration)==null?void 0:g.getRestrictedSettings())||[]).sort((v,b)=>v.localeCompare(b)),u=Hb(l,this._restrictedSettings.userRemote||[],(v,b)=>v.localeCompare(b));e.push(...u.added,...u.removed);const d=new Wl;for(const v of this.workspace.folders){const b=this.cachedFolderConfigs.get(v.uri),S=((b==null?void 0:b.getRestrictedSettings())||[]).sort((C,I)=>C.localeCompare(I));S.length&&d.set(v.uri,S);const E=((m=this._restrictedSettings.workspaceFolder)==null?void 0:m.get(v.uri))||[],w=Hb(S,E,(C,I)=>C.localeCompare(I));e.push(...w.added,...w.removed)}const h=this.getWorkbenchState()===3?this.workspaceConfiguration.getRestrictedSettings().sort((v,b)=>v.localeCompare(b)):this.workspace.folders[0]?d.get(this.workspace.folders[0].uri)||[]:[],f=Hb(h,this._restrictedSettings.workspace||[],(v,b)=>v.localeCompare(b));e.push(...f.added,...f.removed),e.length&&(this._restrictedSettings={default:r,application:o.length?o:void 0,userLocal:a.length?a:void 0,userRemote:l.length?l:void 0,workspace:h.length?h:void 0,workspaceFolder:d.size?d:void 0},this._onDidChangeRestrictedSettings.fire(this.restrictedSettings))}async updateWorkspaceConfiguration(e,t,r){const i={data:this._configuration.toData(),workspace:this.workspace},o=this._configuration.compareAndUpdateWorkspaceConfiguration(t),s=this.compareFolders(this.workspace.folders,e);if(s.added.length||s.removed.length||s.changed.length){this.workspace.folders=e;const a=await this.onFoldersChanged();await this.handleWillChangeWorkspaceFolders(s,r),this.triggerConfigurationChange(a,i,6),this._onDidChangeWorkspaceFolders.fire(s)}else this.triggerConfigurationChange(o,i,5);this.updateRestrictedSettings()}async handleWillChangeWorkspaceFolders(e,t){const r=[];this._onWillChangeWorkspaceFolders.fire({join(i){r.push(i)},changes:e,fromCache:t});try{await pW.settled(r)}catch{}}async onWorkspaceFolderConfigurationChanged(e){const[t]=await this.loadFolderConfigurations([e]),r={data:this._configuration.toData(),workspace:this.workspace},i=this._configuration.compareAndUpdateFolderConfiguration(e.uri,t);if(this.getWorkbenchState()===2){const o=this._configuration.compareAndUpdateWorkspaceConfiguration(t);this.triggerConfigurationChange(Yce(i,o),r,5)}else this.triggerConfigurationChange(i,r,6);this.updateRestrictedSettings()}async onFoldersChanged(){const e=[];for(const r of this.cachedFolderConfigs.keys())this.workspace.folders.filter(i=>i.uri.toString()===r.toString())[0]||(this.cachedFolderConfigs.get(r).dispose(),this.cachedFolderConfigs.delete(r),e.push(this._configuration.compareAndDeleteFolderConfiguration(r)));const t=this.workspace.folders.filter(r=>!this.cachedFolderConfigs.has(r.uri));return t.length&&(await this.loadFolderConfigurations(t)).forEach((i,o)=>{e.push(this._configuration.compareAndUpdateFolderConfiguration(t[o].uri,i))}),Yce(...e)}loadFolderConfigurations(e){return Promise.all([...e.map(t=>{let r=this.cachedFolderConfigs.get(t.uri);return r||(r=new zYt(!this.initialized,t,pF,this.getWorkbenchState(),this.isWorkspaceTrusted,this.fileService,this.uriIdentityService,this.logService,this.configurationCache),this._register(r.onDidChange(()=>this.onWorkspaceFolderConfigurationChanged(t))),this.cachedFolderConfigs.set(t.uri,this._register(r))),r.loadConfiguration()})])}async validateWorkspaceFoldersAndReload(e){const t=await this.toValidWorkspaceFolders(this.workspace.folders),{removed:r}=this.compareFolders(this.workspace.folders,t);r.length&&await this.updateWorkspaceConfiguration(t,this.workspaceConfiguration.getConfiguration(),e)}async toValidWorkspaceFolders(e){const t=[];for(const r of e){try{if(!(await this.fileService.stat(r.uri)).isDirectory)continue}catch(i){this.logService.warn(`Ignoring the error while validating workspace folder ${r.uri.toString()} - ${UT(i)}`)}t.push(r)}return t}async writeConfigurationValue(e,t,r,i,o){var a,c,l;if(!this.instantiationService)throw new Error("Cannot write configuration because the configuration service is not yet ready to accept writes.");if(r===7)throw new Error("Invalid configuration target");if(r===8){const u={data:this._configuration.toData(),workspace:this.workspace};this._configuration.updateValue(e,t,i),this.triggerConfigurationChange({keys:(a=i==null?void 0:i.overrideIdentifiers)!=null&&a.length?[V2e(i.overrideIdentifiers),e]:[e],overrides:(c=i==null?void 0:i.overrideIdentifiers)!=null&&c.length?i.overrideIdentifiers.map(d=>[d,[e]]):[]},u,r);return}const s=this.toEditableConfigurationTarget(r,e);if(!s)throw new Error("Invalid configuration target");if(s===2&&!this.remoteUserConfiguration)throw new Error("Invalid configuration target");if((l=i==null?void 0:i.overrideIdentifiers)!=null&&l.length&&i.overrideIdentifiers.length>1){const u=this.getConfigurationModelForEditableConfigurationTarget(s,i.resource);if(u){const d=i.overrideIdentifiers.sort(),h=u.overrides.find(f=>qL([...f.identifiers].sort(),d));h&&(i.overrideIdentifiers=h.identifiers)}}switch(this.configurationEditing=this.configurationEditing??this.createConfigurationEditingService(this.instantiationService),await(await this.configurationEditing).writeConfiguration(s,{key:e,value:t},{scopes:i,...o}),s){case 1:this.applicationConfiguration&&this.isSettingAppliedForAllProfiles(e)?await this.reloadApplicationConfiguration():await this.reloadLocalUserConfiguration();return;case 2:return this.reloadRemoteUserConfiguration().then(()=>{});case 3:return this.reloadWorkspaceConfiguration();case 4:{const u=i&&i.resource?this.workspace.getFolder(i.resource):null;if(u)return this.reloadWorkspaceFolderConfiguration(u)}}}async createConfigurationEditingService(e){var r;const t=((r=await this.remoteAgentService.getEnvironment())==null?void 0:r.settingsPath)??null;return e.createInstance(nY,t)}getConfigurationModelForEditableConfigurationTarget(e,t){switch(e){case 1:return this._configuration.localUserConfiguration;case 2:return this._configuration.remoteUserConfiguration;case 3:return this._configuration.workspaceConfiguration;case 4:return t?this._configuration.folderConfigurations.get(t):void 0}}getConfigurationModel(e,t){switch(e){case 3:return this._configuration.localUserConfiguration;case 4:return this._configuration.remoteUserConfiguration;case 5:return this._configuration.workspaceConfiguration;case 6:return t?this._configuration.folderConfigurations.get(t):void 0;default:return}}deriveConfigurationTargets(e,t,r){if(by(t,r.value))return[];const i=[];return r.workspaceFolderValue!==void 0&&i.push(6),r.workspaceValue!==void 0&&i.push(5),r.userRemoteValue!==void 0&&i.push(4),r.userLocalValue!==void 0&&i.push(3),t===void 0?i:[i[0]||2]}triggerConfigurationChange(e,t,r){if(e.keys.length){r!==7&&this.logService.debug(`Configuration keys changed in ${rXe(r)} target`,...e.keys);const i=new X2e(e,t,this._configuration,this.workspace,this.logService);i.source=r,this._onDidChangeConfiguration.fire(i)}}toEditableConfigurationTarget(e,t){var r;if(e===2){if(this.remoteUserConfiguration){const i=(r=this.configurationRegistry.getConfigurationProperties()[t])==null?void 0:r.scope;if(i===2||i===6||this.inspect(t).userRemoteValue!==void 0)return 2}return 1}return e===3?1:e===4?2:e===5?3:e===6?4:null}}let iY=class extends Dr{constructor(e,t,r,i,o){super(),this.workspaceContextService=e,this.environmentService=t,this.workspaceTrustManagementService=r,i.whenInstalledExtensionsRegistered().then(()=>{this.registerConfigurationSchemas();const s=Gc.as(lg.Configuration),a=this._register(new VZe(50));this._register(ns.any(s.onDidUpdateConfiguration,s.onDidSchemaChange,r.onDidChangeTrust)(()=>a.trigger(()=>this.registerConfigurationSchemas(),o.phase===4?void 0:2500)))})}registerConfigurationSchemas(){const e={properties:rf.properties,patternProperties:rf.patternProperties,additionalProperties:!0,allowTrailingCommas:!0,allowComments:!0},t=this.environmentService.remoteAuthority?{properties:Object.assign({},WZe.properties,WE.properties,$_.properties),patternProperties:rf.patternProperties,additionalProperties:!0,allowTrailingCommas:!0,allowComments:!0}:e,r={properties:Object.assign({},Xce.properties,qE.properties,WE.properties,$_.properties),patternProperties:rf.patternProperties,additionalProperties:!0,allowTrailingCommas:!0,allowComments:!0},i={properties:Object.assign({},Xce.properties,qE.properties,WE.properties,$_.properties),patternProperties:rf.patternProperties,additionalProperties:!0,allowTrailingCommas:!0,allowComments:!0},o={properties:Object.assign({},this.checkAndFilterPropertiesRequiringTrust(qE.properties),this.checkAndFilterPropertiesRequiringTrust(WE.properties),this.checkAndFilterPropertiesRequiringTrust($_.properties)),patternProperties:rf.patternProperties,additionalProperties:!0,allowTrailingCommas:!0,allowComments:!0},s={properties:Object.keys(rf.properties).reduce((l,u)=>(l[u]=Object.assign({deprecationMessage:void 0},rf.properties[u]),l),{}),patternProperties:Object.keys(rf.patternProperties).reduce((l,u)=>(l[u]=Object.assign({deprecationMessage:void 0},rf.patternProperties[u]),l),{}),additionalProperties:!0,allowTrailingCommas:!0,allowComments:!0},a=this.workspaceContextService.getWorkbenchState()===3?{properties:Object.assign({},this.checkAndFilterPropertiesRequiringTrust(qE.properties),this.checkAndFilterPropertiesRequiringTrust($_.properties)),patternProperties:rf.patternProperties,additionalProperties:!0,allowTrailingCommas:!0,allowComments:!0}:o,c={type:"object",description:Ve(sse,0,"Contribute defaults for configurations"),properties:Object.assign({},qE.properties,WE.properties,$_.properties),patternProperties:{[qZe]:{type:"object",default:{},$ref:KZe}},additionalProperties:!1};this.registerSchemas({defaultSettingsSchema:s,userSettingsSchema:t,profileSettingsSchema:r,machineSettingsSchema:i,workspaceSettingsSchema:o,folderSettingsSchema:a,configDefaultsSchema:c})}registerSchemas(e){const t=Gc.as(vee.JSONContribution);t.registerSchema(gYt,e.defaultSettingsSchema),t.registerSchema(mYt,e.userSettingsSchema),t.registerSchema(vYt,e.profileSettingsSchema),t.registerSchema(yYt,e.machineSettingsSchema),t.registerSchema(oBe,e.workspaceSettingsSchema),t.registerSchema(bYt,e.folderSettingsSchema),t.registerSchema(F2e,e.configDefaultsSchema)}checkAndFilterPropertiesRequiringTrust(e){if(this.workspaceTrustManagementService.isWorkspaceTrusted())return e;const t={};return Object.entries(e).forEach(([r,i])=>{i.restricted||(t[r]=i)}),t}};iY=An([Be(0,kg),Be(1,Xx),Be(2,K2e),Be(3,JL),Be(4,G2e)],iY);let oY=class extends Dr{constructor(e,t){super(),e.hasCachedConfigurationDefaultsOverrides()&&t.whenInstalledExtensionsRegistered().then(()=>e.reloadConfiguration(7))}};oY=An([Be(0,VT),Be(1,JL)],oY);var IT;let B$=(IT=class extends Dr{constructor(e){super(),this.workbenchAssignmentService=e,this.processedExperimentalSettings=new Set,this.configurationRegistry=Gc.as(lg.Configuration),this.processExperimentalSettings(Object.keys(this.configurationRegistry.getConfigurationProperties())),this._register(this.configurationRegistry.onDidUpdateConfiguration(({properties:t})=>this.processExperimentalSettings(t)))}async processExperimentalSettings(e){var i;const t={},r=this.configurationRegistry.getConfigurationProperties();for(const o of e){const s=r[o];if((i=s==null?void 0:s.tags)!=null&&i.includes("experimental")&&!this.processedExperimentalSettings.has(o)){this.processedExperimentalSettings.add(o);try{const a=await this.workbenchAssignmentService.getTreatment(`config.${o}`);!x2e(a)&&!by(a,s.default)&&(t[o]=a)}catch{}}}Object.keys(t).length&&this.configurationRegistry.registerDefaultConfigurations([{overrides:t,source:Ve(sse,1,"Experiments")}])}},IT.ID="workbench.contrib.updateExperimentalSettingsDefaults",IT);B$=An([Be(0,GZe)],B$);const pBe=Gc.as(bee.Workbench);pBe.registerWorkbenchContribution(iY,3);pBe.registerWorkbenchContribution(oY,4);q2e(B$.ID,B$,2);const WYt=Gc.as(lg.Configuration);WYt.registerConfiguration({...zZe,properties:{[bm]:{type:"array",description:Ve(sse,2,"Configure settings to be applied for all profiles."),default:[],scope:1,additionalProperties:!0,uniqueItems:!0}}});class qYt{constructor(e,t,r){this.donotCacheResourcesWithSchemes=e,this.fileService=r,this.cachedConfigurations=new Map,this.cacheHome=t.cacheHome}needsCaching(e){return!this.donotCacheResourcesWithSchemes.includes(e.scheme)}read(e){return this.getCachedConfiguration(e).read()}write(e,t){return this.getCachedConfiguration(e).save(t)}remove(e){return this.getCachedConfiguration(e).remove()}getCachedConfiguration({type:e,key:t}){const r=`${e}:${t}`;let i=this.cachedConfigurations.get(r);return i||(i=new KYt({type:e,key:t},this.cacheHome,this.fileService),this.cachedConfigurations.set(r,i)),i}}class KYt{constructor({type:e,key:t},r,i){this.fileService=i,this.cachedConfigurationFolderResource=jh(r,"CachedConfigurations",e,t),this.cachedConfigurationFileResource=jh(this.cachedConfigurationFolderResource,e==="workspaces"?"workspace.json":"configuration.json"),this.queue=new Cee}async read(){try{return(await this.fileService.readFile(this.cachedConfigurationFileResource)).value.toString()}catch{return""}}async save(e){await this.createCachedFolder()&&await this.queue.queue(async()=>{await this.fileService.writeFile(this.cachedConfigurationFileResource,ac.fromString(e))})}async remove(){try{await this.queue.queue(()=>this.fileService.del(this.cachedConfigurationFolderResource,{recursive:!0,useTrash:!1}))}catch(e){if(e.fileOperationResult!==1)throw e}}async createCachedFolder(){if(await this.fileService.exists(this.cachedConfigurationFolderResource))return!0;try{return await this.fileService.createFolder(this.cachedConfigurationFolderResource),!0}catch{return!1}}}const Sd="vs/workbench/services/label/common/labelService",GYt=yee.registerExtensionPoint({extensionPoint:"resourceLabelFormatters",jsonSchema:{description:Ve(Sd,0,"Contributes resource label formatting rules."),type:"array",items:{type:"object",required:["scheme","formatting"],properties:{scheme:{type:"string",description:Ve(Sd,1,'URI scheme on which to match the formatter on. For example "file". Simple glob patterns are supported.')},authority:{type:"string",description:Ve(Sd,2,"URI authority on which to match the formatter on. Simple glob patterns are supported.")},formatting:{description:Ve(Sd,3,"Rules for formatting uri resource labels."),type:"object",properties:{label:{type:"string",description:Ve(Sd,4,"Label rules to display. For example: myLabel:/${path}. ${path}, ${scheme}, ${authority} and ${authoritySuffix} are supported as variables.")},separator:{type:"string",description:Ve(Sd,5,"Separator to be used in the uri label display. '/' or '' as an example.")},stripPathStartingSeparator:{type:"boolean",description:Ve(Sd,6,"Controls whether `${path}` substitutions should have starting separator characters stripped.")},tildify:{type:"boolean",description:Ve(Sd,7,"Controls if the start of the uri label should be tildified when possible.")},workspaceSuffix:{type:"string",description:Ve(Sd,8,"Suffix appended to the workspace label.")}}}}}}}),zSe=/\//g,ZYt=/\$\{(scheme|authoritySuffix|authority|path|(query)\.(.+?))\}/g;function XYt(n){return!!(n&&n[2]===":")}let sY=class{constructor(e){this.formattersDisposables=new Map,GYt.setHandler((t,r)=>{for(const i of r.added)for(const o of i.value){const s={...o};typeof s.formatting.label!="string"&&(s.formatting.label="${authority}${path}"),typeof s.formatting.separator!="string"&&(s.formatting.separator=P2e),!Oa(i.description,"contribLabelFormatterWorkspaceTooltip")&&s.formatting.workspaceTooltip&&(s.formatting.workspaceTooltip=void 0),this.formattersDisposables.set(s,e.registerFormatter(s))}for(const i of r.removed)for(const o of i.value)_S(this.formattersDisposables.get(o))})}};sY=An([Be(0,Pee)],sY);Gc.as(bee.Workbench).registerWorkbenchContribution(sY,3);const VSe=50;let aY=class extends Dr{constructor(e,t,r,i,o,s){var c,l;super(),this.environmentService=e,this.contextService=t,this.pathService=r,this.remoteAgentService=i,this._onDidChangeFormatters=this._register(new ft({leakWarningThreshold:400})),this.onDidChangeFormatters=this._onDidChangeFormatters.event,this.os=pM,this.userHome=r.defaultUriScheme===hr.file?this.pathService.userHome({preferLocal:!0}):void 0;const a=this.storedFormattersMemento=new iXe("cachedResourceLabelFormatters2",o);this.storedFormatters=a.getMemento(0,1),this.formatters=((l=(c=this.storedFormatters)==null?void 0:c.formatters)==null?void 0:l.slice())||[],this.resolveRemoteEnvironment()}async resolveRemoteEnvironment(){const e=await this.remoteAgentService.getEnvironment();this.os=(e==null?void 0:e.os)??pM,this.userHome=await this.pathService.userHome()}findFormatting(e){let t;for(const r of this.formatters)if(r.scheme===e.scheme){if(!r.authority&&(!t||r.priority)){t=r;continue}if(!r.authority)continue;oXe(r.authority.toLowerCase(),e.authority.toLowerCase())&&(!t||!t.authority||r.authority.length>t.authority.length||r.authority.length===t.authority.length&&r.priority)&&(t=r)}return t?t.formatting:void 0}getUriLabel(e,t={}){let r=this.findFormatting(e);r&&t.separator&&(r={...r,separator:t.separator});const i=this.doGetUriLabel(e,r,t);return!r&&t.separator?i.replace(zSe,t.separator):i}doGetUriLabel(e,t,r={}){if(!t)return sXe(e,{os:this.os,tildify:this.userHome?{userHome:this.userHome}:void 0,relative:r.relative?{noPrefix:r.noPrefix,getWorkspace:()=>this.contextService.getWorkspace(),getWorkspaceFolder:i=>this.contextService.getWorkspaceFolder(i)}:void 0});if(r.relative&&this.contextService){let i=this.contextService.getWorkspaceFolder(e);if(!i){const o=this.contextService.getWorkspace(),s=k2e(o.folders);s&&e.scheme!==s.uri.scheme&&e.path.startsWith(Pp.sep)&&(i=this.contextService.getWorkspaceFolder(s.uri.with({path:e.path})))}if(i){const o=this.formatUri(i.uri,t,r.noPrefix);let s=this.formatUri(e,t,r.noPrefix),a=0;for(;s[a]&&s[a]===o[a];)a++;if(!s[a]||s[a]===t.separator?s=s.substring(1+a):a===o.length&&i.uri.path===Pp.sep&&(s=s.substring(a)),this.contextService.getWorkspace().folders.length>1&&!r.noPrefix){const l=(i==null?void 0:i.name)??gW(i.uri);s=s?`${l} • ${s}`:l}return s}}return this.formatUri(e,t,r.noPrefix)}getUriBasenameLabel(e){const t=this.findFormatting(e),r=this.doGetUriLabel(e,t);let i;return(t==null?void 0:t.separator)===Ej.sep?i=Ej:(t==null?void 0:t.separator)===Pp.sep?i=Pp:i=this.os===1?Ej:Pp,i.basename(r)}getWorkspaceLabel(e,t){if(aXe(e)){const r=J2e(e);return wM(r)||Dk(r)?this.getWorkspaceLabel(r,t):""}return Te.isUri(e)?this.doGetSingleFolderWorkspaceLabel(e,t):wM(e)?this.doGetSingleFolderWorkspaceLabel(e.uri,t):Dk(e)?this.doGetWorkspaceLabel(e.configPath,t):""}doGetWorkspaceLabel(e,t){if(mW(e,this.environmentService))return Ve(Sd,9,"Untitled (Workspace)");if(r4(e))return Ve(Sd,10,"Workspace");let r=I2(e);r.endsWith(xC)&&(r=r.substr(0,r.length-xC.length-1));let i;switch(t==null?void 0:t.verbose){case 0:i=r;break;case 2:i=Ve(Sd,11,"{0} (Workspace)",this.getUriLabel(jh(QL(e),r)));break;case 1:default:i=Ve(Sd,12,"{0} (Workspace)",r);break}return(t==null?void 0:t.verbose)===0?i:this.appendWorkspaceSuffix(i,e)}doGetSingleFolderWorkspaceLabel(e,t){let r;switch(t==null?void 0:t.verbose){case 2:r=this.getUriLabel(e);break;case 0:case 1:default:r=I2(e)||Pp.sep;break}return(t==null?void 0:t.verbose)===0?r:this.appendWorkspaceSuffix(r,e)}getSeparator(e,t){const r=this.findFormatting(Te.from({scheme:e,authority:t}));return(r==null?void 0:r.separator)||Pp.sep}getHostLabel(e,t){const r=this.findFormatting(Te.from({scheme:e,authority:t}));return(r==null?void 0:r.workspaceSuffix)||t||""}getHostTooltip(e,t){const r=this.findFormatting(Te.from({scheme:e,authority:t}));return r==null?void 0:r.workspaceTooltip}registerCachedFormatter(e){var i;const t=(i=this.storedFormatters).formatters??(i.formatters=[]);let r=t.findIndex(o=>o.scheme===e.scheme&&o.authority===e.authority);if(r===-1&&t.length>=VSe&&(r=VSe-1),r===-1)t.unshift(e);else{for(let o=r;o>0;o--)t[o]=t[o-1];t[0]=e}return this.storedFormattersMemento.saveMemento(),this.registerFormatter(e)}registerFormatter(e){return this.formatters.push(e),this._onDidChangeFormatters.fire({scheme:e.scheme}),{dispose:()=>{this.formatters=this.formatters.filter(t=>t!==e),this._onDidChangeFormatters.fire({scheme:e.scheme})}}}formatUri(e,t,r){let i=t.label.replace(ZYt,(o,s,a,c)=>{switch(s){case"scheme":return e.scheme;case"authority":return e.authority;case"authoritySuffix":{const l=e.authority.indexOf("+");return l===-1?e.authority:e.authority.slice(l+1)}case"path":return t.stripPathStartingSeparator?e.path.slice(e.path[0]===t.separator?1:0):e.path;default:{if(a==="query"){const{query:l}=e;if(l&&l[0]==="{"&&l[l.length-1]==="}")try{return JSON.parse(l)[c]||""}catch{}}return""}}});return t.normalizeDriveLetter&&XYt(i)&&(i=i.charAt(1).toUpperCase()+i.substr(2)),t.tildify&&!r&&this.userHome&&(i=cXe(i,this.userHome.fsPath,this.os)),t.authorityPrefix&&e.authority&&(i=t.authorityPrefix+i),i.replace(zSe,t.separator)}appendWorkspaceSuffix(e,t){const r=this.findFormatting(t),i=r&&typeof r.workspaceSuffix=="string"?r.workspaceSuffix:void 0;return i?`${e} [${i}]`:e}};aY=An([Be(0,Xx),Be(1,kg),Be(2,lXe),Be(3,kee),Be(4,XL),Be(5,G2e)],aY);let cY=class{constructor(e,t,r,i){this.configurationService=e,this.environmentService=r,this.storageService=i,this.remoteEnvironment=null,t.getEnvironment().then(o=>this.remoteEnvironment=o)}getEOL(e,t){const r=this.configurationService.getValue("files.eol",{overrideIdentifier:t,resource:e});if(r&&typeof r=="string"&&r!=="auto")return r;const i=this.getOS(e);return i===3||i===2?`
`:`\r
`}getOS(e){let t=pM;const r=this.environmentService.remoteAuthority;if(r&&e&&e.scheme!==hr.file){const i=`resource.authority.os.${r}`;t=this.remoteEnvironment?this.remoteEnvironment.os:this.storageService.getNumber(i,1,pM),this.storageService.store(i,t,1,1)}return t}};cY=An([Be(0,VT),Be(1,kee),Be(2,Xx),Be(3,XL)],cY);const FA="vs/workbench/services/workspaces/browser/abstractWorkspaceEditingService";let lY=class{constructor(e,t,r,i,o,s,a,c,l,u,d,h,f,p,g,m){this.jsonEditingService=e,this.contextService=t,this.configurationService=r,this.notificationService=i,this.commandService=o,this.fileService=s,this.textFileService=a,this.workspacesService=c,this.environmentService=l,this.fileDialogService=u,this.dialogService=d,this.hostService=h,this.uriIdentityService=f,this.workspaceTrustManagementService=p,this.userDataProfilesService=g,this.userDataProfileService=m}async pickNewWorkspacePath(){const e=[hr.file];this.environmentService.remoteAuthority&&e.unshift(hr.vscodeRemote);let t=await this.fileDialogService.showSaveDialog({saveLabel:uXe(Ve(FA,0,"Save")),title:Ve(FA,1,"Save Workspace"),filters:dXe,defaultUri:jh(await this.fileDialogService.defaultWorkspacePath(),this.getNewWorkspaceName()),availableFileSystems:e});if(t)return j2e(t)||(t=t.with({path:`${t.path}.${xC}`})),t}getNewWorkspaceName(){var r;const e=(r=this.getCurrentWorkspaceIdentifier())==null?void 0:r.configPath;if(e&&hXe(e,this.environmentService))return I2(e);const t=k2e(this.contextService.getWorkspace().folders);return t?`${I2(t.uri)}.${xC}`:`workspace.${xC}`}async updateFolders(e,t,r,i){const o=this.contextService.getWorkspace().folders;let s=[];typeof t=="number"&&(s=o.slice(e,e+t).map(u=>u.uri));let a=[];Array.isArray(r)&&(a=r.map(u=>({uri:Jce(u.uri),name:u.name})));const c=s.length>0,l=a.length>0;if(!(!l&&!c))return l&&!c?this.doAddFolders(a,e,i):c&&!l?this.removeFolders(s):this.includesSingleFolderWorkspace(s)?this.createAndEnterWorkspace(a):this.contextService.getWorkbenchState()!==3?this.doAddFolders(a,e,i):this.doUpdateFolders(a,s,e,i)}async doUpdateFolders(e,t,r,i=!1){try{await this.contextService.updateFolders(e,t,r)}catch(o){if(i)throw o;this.handleWorkspaceConfigurationEditingError(o)}}addFolders(e,t=!1){const r=e.map(i=>({uri:Jce(i.uri),name:i.name}));return this.doAddFolders(r,void 0,t)}async doAddFolders(e,t,r=!1){const i=this.contextService.getWorkbenchState();if(i!==3){let o=this.contextService.getWorkspace().folders.map(s=>({uri:s.uri}));return o.splice(typeof t=="number"?t:o.length,0,...e),o=fM(o,s=>this.uriIdentityService.extUri.getComparisonKey(s.uri)),i===1&&o.length===0||i===2&&o.length===1?void 0:this.createAndEnterWorkspace(o)}try{await this.contextService.addFolders(e,t)}catch(o){if(r)throw o;this.handleWorkspaceConfigurationEditingError(o)}}async removeFolders(e,t=!1){if(this.includesSingleFolderWorkspace(e))return this.createAndEnterWorkspace([]);try{await this.contextService.removeFolders(e)}catch(r){if(t)throw r;this.handleWorkspaceConfigurationEditingError(r)}}includesSingleFolderWorkspace(e){if(this.contextService.getWorkbenchState()===2){const t=this.contextService.getWorkspace().folders[0];return e.some(r=>this.uriIdentityService.extUri.isEqual(r,t.uri))}return!1}async createAndEnterWorkspace(e,t){if(t&&!await this.isValidTargetWorkspacePath(t))return;const r=this.environmentService.remoteAuthority,i=await this.workspacesService.createUntitledWorkspace(e,r);if(t)try{await this.saveWorkspaceAs(i,t)}finally{await this.workspacesService.deleteUntitledWorkspace(i)}else t=i.configPath,this.userDataProfileService.currentProfile.isDefault||await this.userDataProfilesService.setProfileForWorkspace(i,this.userDataProfileService.currentProfile);return this.enterWorkspace(t)}async saveAndEnterWorkspace(e){const t=this.getCurrentWorkspaceIdentifier();if(t){if(_ee(t.configPath,e))return this.saveWorkspace(t);if(await this.isValidTargetWorkspacePath(e))return await this.saveWorkspaceAs(t,e),this.enterWorkspace(e)}}async isValidTargetWorkspacePath(e){return!0}async saveWorkspaceAs(e,t){const r=e.configPath;if(!mW(t,this.environmentService)&&!this.userDataProfileService.currentProfile.isDefault){const c=await this.workspacesService.getWorkspaceIdentifier(t);await this.userDataProfilesService.setProfileForWorkspace(c,this.userDataProfileService.currentProfile)}if(this.uriIdentityService.extUri.isEqual(r,t))return;const o=mW(r,this.environmentService),s=await this.fileService.readFile(r),a=BSe(s.value.toString(),r,o,t,this.uriIdentityService.extUri);await this.textFileService.create([{resource:t,value:a,options:{overwrite:!0}}]),await this.trustWorkspaceConfiguration(t)}async saveWorkspace(e){const t=e.configPath,r=this.textFileService.files.get(t);if(r){await r.save({force:!0,reason:1});return}if(await this.fileService.exists(t))return;const s=BSe(JSON.stringify({folders:[]},null,"	"),t,!1,t,this.uriIdentityService.extUri);await this.textFileService.create([{resource:t,value:s}])}handleWorkspaceConfigurationEditingError(e){switch(e.code){case 0:this.onInvalidWorkspaceConfigurationFileError();break;default:this.notificationService.error(e.message)}}onInvalidWorkspaceConfigurationFileError(){const e=Ve(FA,2,"Unable to write into workspace configuration file. Please open the file to correct errors/warnings in it and try again.");this.askToOpenWorkspaceConfigurationFile(e)}askToOpenWorkspaceConfigurationFile(e){this.notificationService.prompt($s.Error,e,[{label:Ve(FA,3,"Open Workspace Configuration"),run:()=>this.commandService.executeCommand("workbench.action.openWorkspaceConfigFile")}])}async doEnterWorkspace(e){if(this.environmentService.extensionTestsLocationURI)throw new Error("Entering a new workspace is not possible in tests.");const t=await this.workspacesService.getWorkspaceIdentifier(e);return this.contextService.getWorkbenchState()===2&&await this.migrateWorkspaceSettings(t),await this.configurationService.initialize(t),this.workspacesService.enterWorkspace(e)}migrateWorkspaceSettings(e){return this.doCopyWorkspaceSettings(e,t=>t.scope===3)}copyWorkspaceSettings(e){return this.doCopyWorkspaceSettings(e)}doCopyWorkspaceSettings(e,t){const r=Gc.as(lg.Configuration).getConfigurationProperties(),i={};for(const o of this.configurationService.keys().workspace)if(r[o]){if(t&&!t(r[o]))continue;i[o]=this.configurationService.inspect(o).workspaceValue}return this.jsonEditingService.write(e.configPath,[{path:["settings"],value:i}],!0)}async trustWorkspaceConfiguration(e){this.contextService.getWorkbenchState()!==1&&this.workspaceTrustManagementService.isWorkspaceTrusted()&&await this.workspaceTrustManagementService.setUrisTrust([e],!0)}getCurrentWorkspaceIdentifier(){const e=J2e(this.contextService.getWorkspace());if(Dk(e))return e}};lY=An([Be(0,Z2e),Be(1,kg),Be(2,fBe),Be(3,ZL),Be(4,fXe),Be(5,Tg),Be(6,Iee),Be(7,Q2e),Be(8,Xx),Be(9,pXe),Be(10,gXe),Be(11,See),Be(12,WT),Be(13,K2e),Be(14,Gx),Be(15,xee)],lY);var Bw,Hx;let uY=(Hx=class extends Dr{constructor(e,t,r,i,o,s){super(),this.storageService=e,this.contextService=t,this.logService=r,this.fileService=i,this.environmentService=o,this.uriIdentityService=s,this._onRecentlyOpenedChange=this._register(new ft),this.onDidChangeRecentlyOpened=this._onRecentlyOpenedChange.event,this.addWorkspaceToRecentlyOpened(),this.registerListeners()}registerListeners(){this._register(this.storageService.onDidChangeValue(-1,Bw.RECENTLY_OPENED_KEY,this._register(new ei))(()=>this._onRecentlyOpenedChange.fire())),this._register(this.contextService.onDidChangeWorkspaceFolders(e=>this.onDidChangeWorkspaceFolders(e)))}onDidChangeWorkspaceFolders(e){if(r4(this.contextService.getWorkspace()))for(const t of e.added)this.addRecentlyOpened([{folderUri:t.uri}])}addWorkspaceToRecentlyOpened(){const e=this.contextService.getWorkspace(),t=this.environmentService.remoteAuthority;switch(this.contextService.getWorkbenchState()){case 2:this.addRecentlyOpened([{folderUri:e.folders[0].uri,remoteAuthority:t}]);break;case 3:this.addRecentlyOpened([{workspace:{id:e.id,configPath:e.configuration},remoteAuthority:t}]);break}}async getRecentlyOpened(){const e=this.storageService.get(Bw.RECENTLY_OPENED_KEY,-1);if(e){const t=MYt(JSON.parse(e),this.logService);return t.workspaces=t.workspaces.filter(r=>!(dM(r)&&r.folderUri.scheme===hr.file&&!r4(this.contextService.getWorkspace())||kYt(r)&&r4(r.workspace.configPath))),t}return{workspaces:[],files:[]}}async addRecentlyOpened(e){const t=await this.getRecentlyOpened();for(const r of e)TYt(r)?(this.doRemoveRecentlyOpened(t,[r.fileUri]),t.files.unshift(r)):dM(r)?(this.doRemoveRecentlyOpened(t,[r.folderUri]),t.workspaces.unshift(r)):(this.doRemoveRecentlyOpened(t,[r.workspace.configPath]),t.workspaces.unshift(r));return this.saveRecentlyOpened(t)}async removeRecentlyOpened(e){const t=await this.getRecentlyOpened();return this.doRemoveRecentlyOpened(t,e),this.saveRecentlyOpened(t)}doRemoveRecentlyOpened(e,t){e.files=e.files.filter(r=>!t.some(i=>i.toString()===r.fileUri.toString())),e.workspaces=e.workspaces.filter(r=>!t.some(i=>i.toString()===(dM(r)?r.folderUri.toString():r.workspace.configPath.toString())))}async saveRecentlyOpened(e){return this.storageService.store(Bw.RECENTLY_OPENED_KEY,JSON.stringify($Yt(e)),-1,0)}async clearRecentlyOpened(){this.storageService.remove(Bw.RECENTLY_OPENED_KEY,-1)}async enterWorkspace(e){return{workspace:await this.getWorkspaceIdentifier(e)}}async createUntitledWorkspace(e,t){const r=(Date.now()+Math.round(Math.random()*1e3)).toString(),i=jh(this.environmentService.untitledWorkspacesHome,`Untitled-${r}.${xC}`),o=[];if(e)for(const a of e)o.push(ose(a.uri,!0,a.name,this.environmentService.untitledWorkspacesHome,this.uriIdentityService.extUri));const s={folders:o,remoteAuthority:t};return await this.fileService.writeFile(i,ac.fromString(JSON.stringify(s,null,"	"))),this.getWorkspaceIdentifier(i)}async deleteUntitledWorkspace(e){try{await this.fileService.del(e.configPath)}catch(t){if(t.fileOperationResult!==1)throw t}}async getWorkspaceIdentifier(e){return mXe(e)}async getDirtyWorkspaces(){return[]}},Bw=Hx,Hx.RECENTLY_OPENED_KEY="recently.opened",Hx);uY=Bw=An([Be(0,XL),Be(1,kg),Be(2,Li),Be(3,Tg),Be(4,Xx),Be(5,WT)],uY);function YYt(){throw new Error("unsupported")}function JYt(n){let e=null;return(...t)=>(e==null&&(e=n(...t)),e)}function QYt(n){return new Proxy(n,{construct:JYt((e,t)=>Reflect.construct(n,t))})}Te.from({scheme:hr.vscodeUserData,path:"/User/settings.json"});async function eJt(n){const e=await CM(Gx);await(await CM(Tg)).writeFile(e.defaultProfile.settingsResource,ac.fromString(n))}async function tJt(){const n=await CM(Gx);return(await(await CM(Tg)).readFile(n.defaultProfile.settingsResource)).value.toString()}Gc.as(lg.Configuration);let dY=class extends VYt{constructor(e,t,r,i,o,s,a,c){const l=new qYt([hr.file,hr.vscodeUserData,hr.tmp],e,i);super({configurationCache:l},e,t,r,i,o,s,a,c)}};dY=An([Be(0,Xx),Be(1,xee),Be(2,Gx),Be(3,Tg),Be(4,kee),Be(5,WT),Be(6,Li),Be(7,vXe)],dY);class nJt extends lY{constructor(){super(...arguments),this.enterWorkspace=YYt}}let gBe;_Xe(async n=>{const e=n.get(kg);e.acquireInstantiationService(n.get(Kx));const t=gBe??wXe();if(Te.isUri(t)){const r=t.with({path:"/workspace.code-workspace"});try{const i=n.get(Tg);await i.createFolder(t),await i.writeFile(r,ac.fromString(JSON.stringify({folders:[{path:t.path}]})))}catch{}await e.initialize({id:Yx(),configPath:r})}else await e.initialize(t)});const WSe=QYt(dY);function rJt(n){return gBe=n,{...exe(),[Pee.toString()]:new wd(aY,void 0,!0),[VT.toString()]:new wd(WSe,[],!0),[kg.toString()]:new wd(WSe,[],!0),[yXe.toString()]:new wd(eY,[],!0),[bXe.toString()]:new wd(nJt,[],!0),[Q2e.toString()]:new wd(uY,void 0,!0),[SXe.toString()]:new wd(cY,void 0,!0)}}const iJt=n=>{let e="";if(n.url){const t=n;if(!t.url.startsWith("ws://")&&!t.url.startsWith("wss://"))throw new Error(`This is not a proper websocket url: ${t.url}`);e=t.url}else{const t=n;if(e=`${t.secured?"wss":"ws"}://${t.host}`,t.port&&t.port!==80&&(e+=`:${t.port}`),t.path&&(e+=`/${t.path}`),t.extraParams){const i=new URL(e);for(const[o,s]of Object.entries(t.extraParams))s&&i.searchParams.set(o,s instanceof Array?s.join(","):s.toString());e=i.toString()}}return e},oJt=n=>n instanceof URL?n.href:new URL(`data:text/plain;base64,${btoa(n)}`).href,sJt=(n,e,t,r)=>Object.hasOwn(t,"uri")?Rk.parse(t.uri):Rk.parse(`/workspace/model${n}.${t.fileExt}`);var Zl;(function(n){n[n.NONE=0]="NONE",n[n.CODE=1]="CODE",n[n.MODEL=2]="MODEL",n[n.CODE_AND_MODEL=3]="CODE_AND_MODEL"})(Zl||(Zl={}));const aJt=(n,e)=>{const t=jA(n.main),r=jA(e.main),i=jA(n.original),o=jA(e.original);return t!==r||i!==o?Zl.CODE:Zl.NONE},jA=n=>n&&Object.hasOwn(n,"text")?n.text:void 0,ase=(n,e)=>{const r=aJt(n,e)===Zl.CODE,i=BA(n.main),o=BA(e.main),s=BA(n.original),a=BA(e.original),c=i!==o||s!==a;return c&&r?Zl.CODE_AND_MODEL:c?Zl.MODEL:r?Zl.CODE:Zl.NONE},BA=n=>{if(n)return Object.hasOwn(n,"uri")?n.uri:Object.hasOwn(n,"fileExt")?n.fileExt:void 0},mBe=(n,e)=>n instanceof Object&&e instanceof Object?JSON.stringify(n)===JSON.stringify(e):n===e;class vBe{constructor(e,t){$(this,"id");$(this,"logger");$(this,"editor");$(this,"diffEditor");$(this,"modelRef");$(this,"modelRefOriginal");this.id=e,this.logger=t}buildConfig(e){const t={$type:e.$type,codeResources:e.codeResources,useDiffEditor:e.useDiffEditor===!0,readOnly:e.readOnly??!1,domReadOnly:e.domReadOnly??!1,overrideAutomaticLayout:e.overrideAutomaticLayout??!0,awaitExtensionReadiness:e.awaitExtensionReadiness??void 0};return t.editorOptions={...e.editorOptions,automaticLayout:e.overrideAutomaticLayout??!0},t.diffEditorOptions={...e.diffEditorOptions,automaticLayout:e.overrideAutomaticLayout??!0},t}haveEditor(){return this.editor!==void 0||this.diffEditor!==void 0}getEditor(){return this.editor}getDiffEditor(){return this.diffEditor}async createEditors(e){this.getConfig().useDiffEditor?this.diffEditor=xM.createDiffEditor(e,this.getConfig().diffEditorOptions):this.editor=xM.create(e,this.getConfig().editorOptions);const t=await this.buildModelRefs(this.getConfig().codeResources);await this.updateEditorModels(t)}disposeEditors(){var e,t,r;this.editor&&((e=this.modelRef)==null||e.dispose(),this.editor.dispose(),this.editor=void 0),this.diffEditor&&((t=this.modelRef)==null||t.dispose(),(r=this.modelRefOriginal)==null||r.dispose(),this.diffEditor.dispose(),this.diffEditor=void 0)}getTextModels(){var t,r;const e=this.getModelRefs();return{text:((t=e.modelRef)==null?void 0:t.object.textEditorModel)??void 0,textOriginal:((r=e.modelRefOriginal)==null?void 0:r.object.textEditorModel)??void 0}}getModelRefs(){return{modelRef:this.modelRef,modelRefOriginal:this.modelRefOriginal}}async updateCodeResources(e){var r,i,o,s,a;if(!this.editor&&!this.diffEditor)return Promise.reject(new Error("You cannot update the code resources as neither editor or diff editor is available."));const t=ase(this.getConfig().codeResources,e);if(t!==Zl.NONE&&this.updateCodeResourcesConfig(e),t===Zl.CODE)this.editor?this.editor.setValue(((r=e.main)==null?void 0:r.text)??""):((o=this.diffEditor)==null||o.getModifiedEditor().setValue(((i=e.main)==null?void 0:i.text)??""),(a=this.diffEditor)==null||a.getOriginalEditor().setValue(((s=e.original)==null?void 0:s.text)??""));else if(t===Zl.MODEL||t===Zl.CODE_AND_MODEL){const c=await this.buildModelRefs(e);this.updateEditorModels(c)}}async buildModelRefs(e){const t=await this.buildModelRef(e.main),r=await this.buildModelRef(e.original);return{modelRef:t,modelRefOriginal:r}}async buildModelRef(e){if(e){const t=sJt(this.id,!1,e);if(t){const r=await CXe(t,e==null?void 0:e.text);return this.checkEnforceLanguageId(r,e.enforceLanguageId),r}}}async updateEditorModels(e){var i,o;if(!this.editor&&!this.diffEditor)return Promise.reject(new Error("You cannot update models as neither editor nor diff editor is available."));let t=!1,r=!1;if(e.modelRef&&((i=this.modelRef)==null||i.dispose(),this.modelRef=e.modelRef,t=!0),e.modelRefOriginal&&((o=this.modelRefOriginal)==null||o.dispose(),this.modelRefOriginal=e.modelRefOriginal,r=!0),this.editor)t&&this.modelRef&&this.modelRef.object.textEditorModel!==null&&this.editor.setModel(this.modelRef.object.textEditorModel);else if(this.diffEditor)if((t||r)&&this.modelRef&&this.modelRefOriginal&&this.modelRef.object.textEditorModel!==null&&this.modelRefOriginal.object.textEditorModel!==null)this.diffEditor.setModel({original:this.modelRefOriginal.object.textEditorModel,modified:this.modelRef.object.textEditorModel});else return Promise.reject(new Error("You cannot update models, because original model ref is not contained, but required for DiffEditor."))}checkEnforceLanguageId(e,t){var r;t&&e&&(e==null||e.object.setLanguageId(t),(r=this.logger)==null||r.info(`Main languageId is enforced: ${t}`))}updateCodeResourcesConfig(e){const t=this.getConfig();t.codeResources.main=e.main,t.codeResources.original=e.original}updateLayout(){var e,t;this.getConfig().useDiffEditor?(e=this.diffEditor)==null||e.layout():(t=this.editor)==null||t.layout()}async awaitReadiness(e){if(e){const t=[];for(const r of e)t.push(r());return Promise.all(t)}return Promise.resolve()}updateMonacoEditorOptions(e){var t;(t=this.getEditor())==null||t.updateOptions(e)}async updateUserConfiguration(e){return e?eJt(e):Promise.resolve()}getUserConfiguration(){return tJt()}}class cJt extends vBe{constructor(t,r,i){super(t,i);$(this,"config");const o=r.wrapperConfig.editorAppConfig;this.config=this.buildConfig(o),this.config.languageDef=o.languageDef}getConfig(){return this.config}async specifyServices(){const t=(await bd(()=>import("../chunks/index.CuAq3Z7v.js"),__vite__mapDeps([7,8,9,4,10,5,2,3,6,11,12,13,14]),import.meta.url)).default;return{...t()}}async init(){var r,i;await this.awaitReadiness(this.config.awaitExtensionReadiness);const t=this.config.languageDef;if(t&&(t.languageExtensionConfig&&(WR.register(t.languageExtensionConfig),WR.getLanguages().filter(s=>s.id===t.languageExtensionConfig.id).length===0&&WR.register({id:t.languageExtensionConfig.id})),t.monarchLanguage&&WR.setMonarchTokensProvider(t.languageExtensionConfig.id,t.monarchLanguage),t.theme&&(xM.defineTheme(t.theme.name,t.theme.data),xM.setTheme(t.theme.name))),((r=this.config.editorOptions)==null?void 0:r["semanticHighlighting.enabled"])!==void 0){const o=JSON.stringify({"editor.semanticHighlighting.enabled":this.config.editorOptions["semanticHighlighting.enabled"]});await this.updateUserConfiguration(o)}(i=this.logger)==null||i.info("Init of Classic App was completed.")}disposeApp(){this.disposeEditors()}isAppConfigDifferent(t,r,i){let o=!1;i&&(o=ase(t.codeResources,r.codeResources)!==Zl.NONE);const s=["useDiffEditor","domReadOnly","readOnly","awaitExtensionReadiness","overrideAutomaticLayout","editorOptions","diffEditorOptions","theme","languageDef","languageExtensionConfig","themeData"],a=c=>!mBe(t[c],r[c]);return o=o||s.some(a),o}}class lJt extends vBe{constructor(t,r,i){super(t);$(this,"config");$(this,"extensionRegisterResults",new Map);this.logger=i;const o=r.wrapperConfig.editorAppConfig;this.config=this.buildConfig(o),this.config.extensions=o.extensions??void 0,this.config.userConfiguration=o.userConfiguration??void 0}getConfig(){return this.config}getExtensionRegisterResult(t){return this.extensionRegisterResults.get(t)}async specifyServices(){const t=(await bd(()=>import("../chunks/index.BpWhFMvC.js"),__vite__mapDeps([15,8,9,4,10,5,2,3,6,11,12,13,14,16]),import.meta.url)).default,r=(await bd(()=>import("../chunks/index.yjtX7sLc.js"),__vite__mapDeps([17,8,9,4,10,5,2,3,6,11,12,13,14,16]),import.meta.url)).default;return{...t(),...r()}}async init(){var i,o;const t=(await bd(()=>import("../chunks/index.CObYoXy1.js"),__vite__mapDeps([18,8,9,4,10,5,2,3,6,11,12,13,14]),import.meta.url)).whenReady,r=(this.config.awaitExtensionReadiness??[]).concat(t);if(await this.awaitReadiness(r),this.config.extensions){const s=[];for(const a of this.config.extensions){const c=a.config,l=L2e(c,1);if(this.extensionRegisterResults.set(c.name,l),a.filesOrContents&&Object.hasOwn(l,"registerFileUrl"))for(const u of a.filesOrContents)l.registerFileUrl(u[0],oJt(u[1]));s.push(l.whenReady())}await Promise.all(s)}await this.updateUserConfiguration((i=this.config.userConfiguration)==null?void 0:i.json),(o=this.logger)==null||o.info("Init of Extended App was completed.")}disposeApp(){this.disposeEditors(),this.extensionRegisterResults.forEach(t=>t==null?void 0:t.dispose())}isAppConfigDifferent(t,r,i){let o=!1;i&&(o=ase(t.codeResources,r.codeResources)!==Zl.NONE);const s=["useDiffEditor","domReadOnly","readOnly","awaitExtensionReadiness","overrideAutomaticLayout","editorOptions","diffEditorOptions","extensions","userConfiguration"],a=c=>!mBe(t[c],r[c]);return o=o||s.some(a),o}}var tc={};const wr=pee(xXe);var Pr={},S_={},cse={},H$={},Xn={},ha={};Object.defineProperty(ha,"__esModule",{value:!0});ha.stringArray=ha.array=ha.func=ha.error=ha.number=ha.string=ha.boolean=void 0;function uJt(n){return n===!0||n===!1}ha.boolean=uJt;function yBe(n){return typeof n=="string"||n instanceof String}ha.string=yBe;function dJt(n){return typeof n=="number"||n instanceof Number}ha.number=dJt;function hJt(n){return n instanceof Error}ha.error=hJt;function fJt(n){return typeof n=="function"}ha.func=fJt;function bBe(n){return Array.isArray(n)}ha.array=bBe;function pJt(n){return bBe(n)&&n.every(e=>yBe(e))}ha.stringArray=pJt;Object.defineProperty(Xn,"__esModule",{value:!0});Xn.Message=Xn.NotificationType9=Xn.NotificationType8=Xn.NotificationType7=Xn.NotificationType6=Xn.NotificationType5=Xn.NotificationType4=Xn.NotificationType3=Xn.NotificationType2=Xn.NotificationType1=Xn.NotificationType0=Xn.NotificationType=Xn.RequestType9=Xn.RequestType8=Xn.RequestType7=Xn.RequestType6=Xn.RequestType5=Xn.RequestType4=Xn.RequestType3=Xn.RequestType2=Xn.RequestType1=Xn.RequestType=Xn.RequestType0=Xn.AbstractMessageSignature=Xn.ParameterStructures=Xn.ResponseError=Xn.ErrorCodes=void 0;const e1=ha;var hY;(function(n){n.ParseError=-32700,n.InvalidRequest=-32600,n.MethodNotFound=-32601,n.InvalidParams=-32602,n.InternalError=-32603,n.jsonrpcReservedErrorRangeStart=-32099,n.serverErrorStart=-32099,n.MessageWriteError=-32099,n.MessageReadError=-32098,n.PendingResponseRejected=-32097,n.ConnectionInactive=-32096,n.ServerNotInitialized=-32002,n.UnknownErrorCode=-32001,n.jsonrpcReservedErrorRangeEnd=-32e3,n.serverErrorEnd=-32e3})(hY||(Xn.ErrorCodes=hY={}));class lse extends Error{constructor(e,t,r){super(t),this.code=e1.number(e)?e:hY.UnknownErrorCode,this.data=r,Object.setPrototypeOf(this,lse.prototype)}toJson(){const e={code:this.code,message:this.message};return this.data!==void 0&&(e.data=this.data),e}}Xn.ResponseError=lse;class _l{constructor(e){this.kind=e}static is(e){return e===_l.auto||e===_l.byName||e===_l.byPosition}toString(){return this.kind}}Xn.ParameterStructures=_l;_l.auto=new _l("auto");_l.byPosition=new _l("byPosition");_l.byName=new _l("byName");class Is{constructor(e,t){this.method=e,this.numberOfParams=t}get parameterStructures(){return _l.auto}}Xn.AbstractMessageSignature=Is;class gJt extends Is{constructor(e){super(e,0)}}Xn.RequestType0=gJt;class mJt extends Is{constructor(e,t=_l.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}}Xn.RequestType=mJt;class vJt extends Is{constructor(e,t=_l.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}}Xn.RequestType1=vJt;class yJt extends Is{constructor(e){super(e,2)}}Xn.RequestType2=yJt;class bJt extends Is{constructor(e){super(e,3)}}Xn.RequestType3=bJt;class SJt extends Is{constructor(e){super(e,4)}}Xn.RequestType4=SJt;class _Jt extends Is{constructor(e){super(e,5)}}Xn.RequestType5=_Jt;class wJt extends Is{constructor(e){super(e,6)}}Xn.RequestType6=wJt;class CJt extends Is{constructor(e){super(e,7)}}Xn.RequestType7=CJt;class xJt extends Is{constructor(e){super(e,8)}}Xn.RequestType8=xJt;class EJt extends Is{constructor(e){super(e,9)}}Xn.RequestType9=EJt;class IJt extends Is{constructor(e,t=_l.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}}Xn.NotificationType=IJt;class PJt extends Is{constructor(e){super(e,0)}}Xn.NotificationType0=PJt;class kJt extends Is{constructor(e,t=_l.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}}Xn.NotificationType1=kJt;class TJt extends Is{constructor(e){super(e,2)}}Xn.NotificationType2=TJt;class DJt extends Is{constructor(e){super(e,3)}}Xn.NotificationType3=DJt;class RJt extends Is{constructor(e){super(e,4)}}Xn.NotificationType4=RJt;class AJt extends Is{constructor(e){super(e,5)}}Xn.NotificationType5=AJt;class OJt extends Is{constructor(e){super(e,6)}}Xn.NotificationType6=OJt;class MJt extends Is{constructor(e){super(e,7)}}Xn.NotificationType7=MJt;class $Jt extends Is{constructor(e){super(e,8)}}Xn.NotificationType8=$Jt;class LJt extends Is{constructor(e){super(e,9)}}Xn.NotificationType9=LJt;var qSe;(function(n){function e(i){const o=i;return o&&e1.string(o.method)&&(e1.string(o.id)||e1.number(o.id))}n.isRequest=e;function t(i){const o=i;return o&&e1.string(o.method)&&i.id===void 0}n.isNotification=t;function r(i){const o=i;return o&&(o.result!==void 0||!!o.error)&&(e1.string(o.id)||e1.number(o.id)||o.id===null)}n.isResponse=r})(qSe||(Xn.Message=qSe={}));var Qm={},KSe;Object.defineProperty(Qm,"__esModule",{value:!0});Qm.LRUCache=Qm.LinkedMap=Qm.Touch=void 0;var al;(function(n){n.None=0,n.First=1,n.AsOld=n.First,n.Last=2,n.AsNew=n.Last})(al||(Qm.Touch=al={}));class SBe{constructor(){this[KSe]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){var e;return(e=this._head)==null?void 0:e.value}get last(){var e;return(e=this._tail)==null?void 0:e.value}has(e){return this._map.has(e)}get(e,t=al.None){const r=this._map.get(e);if(r)return t!==al.None&&this.touch(r,t),r.value}set(e,t,r=al.None){let i=this._map.get(e);if(i)i.value=t,r!==al.None&&this.touch(i,r);else{switch(i={key:e,value:t,next:void 0,previous:void 0},r){case al.None:this.addItemLast(i);break;case al.First:this.addItemFirst(i);break;case al.Last:this.addItemLast(i);break;default:this.addItemLast(i);break}this._map.set(e,i),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){const t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){const r=this._state;let i=this._head;for(;i;){if(t?e.bind(t)(i.value,i.key,this):e(i.value,i.key,this),this._state!==r)throw new Error("LinkedMap got modified during iteration.");i=i.next}}keys(){const e=this._state;let t=this._head;const r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){const i={value:t.key,done:!1};return t=t.next,i}else return{value:void 0,done:!0}}};return r}values(){const e=this._state;let t=this._head;const r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){const i={value:t.value,done:!1};return t=t.next,i}else return{value:void 0,done:!0}}};return r}entries(){const e=this._state;let t=this._head;const r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){const i={value:[t.key,t.value],done:!1};return t=t.next,i}else return{value:void 0,done:!0}}};return r}[(KSe=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._head,r=this.size;for(;t&&r>e;)this._map.delete(t.key),t=t.next,r--;this._head=t,this._size=r,t&&(t.previous=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{const t=e.next,r=e.previous;if(!t||!r)throw new Error("Invalid list");t.previous=r,r.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(t!==al.First&&t!==al.Last)){if(t===al.First){if(e===this._head)return;const r=e.next,i=e.previous;e===this._tail?(i.next=void 0,this._tail=i):(r.previous=i,i.next=r),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===al.Last){if(e===this._tail)return;const r=e.next,i=e.previous;e===this._head?(r.previous=void 0,this._head=r):(r.previous=i,i.next=r),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){const e=[];return this.forEach((t,r)=>{e.push([r,t])}),e}fromJSON(e){this.clear();for(const[t,r]of e)this.set(t,r)}}Qm.LinkedMap=SBe;class NJt extends SBe{constructor(e,t=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,t=al.AsNew){return super.get(e,t)}peek(e){return super.get(e,al.None)}set(e,t){return super.set(e,t,al.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}}Qm.LRUCache=NJt;var gF={};Object.defineProperty(gF,"__esModule",{value:!0});gF.Disposable=void 0;var GSe;(function(n){function e(t){return{dispose:t}}n.create=e})(GSe||(gF.Disposable=GSe={}));var Ig={},Rv={};Object.defineProperty(Rv,"__esModule",{value:!0});let fY;function pY(){if(fY===void 0)throw new Error("No runtime abstraction layer installed");return fY}(function(n){function e(t){if(t===void 0)throw new Error("No runtime abstraction layer provided");fY=t}n.install=e})(pY||(pY={}));Rv.default=pY;Object.defineProperty(Ig,"__esModule",{value:!0});Ig.Emitter=Ig.Event=void 0;const FJt=Rv;var ZSe;(function(n){const e={dispose(){}};n.None=function(){return e}})(ZSe||(Ig.Event=ZSe={}));class jJt{add(e,t=null,r){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(e),this._contexts.push(t),Array.isArray(r)&&r.push({dispose:()=>this.remove(e,t)})}remove(e,t=null){if(!this._callbacks)return;let r=!1;for(let i=0,o=this._callbacks.length;i<o;i++)if(this._callbacks[i]===e)if(this._contexts[i]===t){this._callbacks.splice(i,1),this._contexts.splice(i,1);return}else r=!0;if(r)throw new Error("When adding a listener with a context, you should remove it with the same context")}invoke(...e){if(!this._callbacks)return[];const t=[],r=this._callbacks.slice(0),i=this._contexts.slice(0);for(let o=0,s=r.length;o<s;o++)try{t.push(r[o].apply(i[o],e))}catch(a){(0,FJt.default)().console.error(a)}return t}isEmpty(){return!this._callbacks||this._callbacks.length===0}dispose(){this._callbacks=void 0,this._contexts=void 0}}class mF{constructor(e){this._options=e}get event(){return this._event||(this._event=(e,t,r)=>{this._callbacks||(this._callbacks=new jJt),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(e,t);const i={dispose:()=>{this._callbacks&&(this._callbacks.remove(e,t),i.dispose=mF._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this))}};return Array.isArray(r)&&r.push(i),i}),this._event}fire(e){this._callbacks&&this._callbacks.invoke.call(this._callbacks,e)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}}Ig.Emitter=mF;mF._noop=function(){};var Ny={};Object.defineProperty(Ny,"__esModule",{value:!0});Ny.CancellationTokenSource=Ny.CancellationToken=void 0;const BJt=Rv,HJt=ha,gY=Ig;var U$;(function(n){n.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:gY.Event.None}),n.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:gY.Event.None});function e(t){const r=t;return r&&(r===n.None||r===n.Cancelled||HJt.boolean(r.isCancellationRequested)&&!!r.onCancellationRequested)}n.is=e})(U$||(Ny.CancellationToken=U$={}));const UJt=Object.freeze(function(n,e){const t=(0,BJt.default)().timer.setTimeout(n.bind(e),0);return{dispose(){t.dispose()}}});class XSe{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?UJt:(this._emitter||(this._emitter=new gY.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}}class zJt{get token(){return this._token||(this._token=new XSe),this._token}cancel(){this._token?this._token.cancel():this._token=U$.Cancelled}dispose(){this._token?this._token instanceof XSe&&this._token.dispose():this._token=U$.None}}Ny.CancellationTokenSource=zJt;var Sx={};Object.defineProperty(Sx,"__esModule",{value:!0});Sx.SharedArrayReceiverStrategy=Sx.SharedArraySenderStrategy=void 0;const VJt=Ny;var lT;(function(n){n.Continue=0,n.Cancelled=1})(lT||(lT={}));class WJt{constructor(){this.buffers=new Map}enableCancellation(e){if(e.id===null)return;const t=new SharedArrayBuffer(4),r=new Int32Array(t,0,1);r[0]=lT.Continue,this.buffers.set(e.id,t),e.$cancellationData=t}async sendCancellation(e,t){const r=this.buffers.get(t);if(r===void 0)return;const i=new Int32Array(r,0,1);Atomics.store(i,0,lT.Cancelled)}cleanup(e){this.buffers.delete(e)}dispose(){this.buffers.clear()}}Sx.SharedArraySenderStrategy=WJt;class qJt{constructor(e){this.data=new Int32Array(e,0,1)}get isCancellationRequested(){return Atomics.load(this.data,0)===lT.Cancelled}get onCancellationRequested(){throw new Error("Cancellation over SharedArrayBuffer doesn't support cancellation events")}}class KJt{constructor(e){this.token=new qJt(e)}cancel(){}dispose(){}}class GJt{constructor(){this.kind="request"}createCancellationTokenSource(e){const t=e.$cancellationData;return t===void 0?new VJt.CancellationTokenSource:new KJt(t)}}Sx.SharedArrayReceiverStrategy=GJt;var cy={},tR={};Object.defineProperty(tR,"__esModule",{value:!0});tR.Semaphore=void 0;const ZJt=Rv;let XJt=class{constructor(e=1){if(e<=0)throw new Error("Capacity must be greater than 0");this._capacity=e,this._active=0,this._waiting=[]}lock(e){return new Promise((t,r)=>{this._waiting.push({thunk:e,resolve:t,reject:r}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,ZJt.default)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;const e=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{const t=e.thunk();t instanceof Promise?t.then(r=>{this._active--,e.resolve(r),this.runNext()},r=>{this._active--,e.reject(r),this.runNext()}):(this._active--,e.resolve(t),this.runNext())}catch(t){this._active--,e.reject(t),this.runNext()}}};tR.Semaphore=XJt;Object.defineProperty(cy,"__esModule",{value:!0});cy.ReadableStreamMessageReader=wBe=cy.AbstractMessageReader=cy.MessageReader=void 0;const mY=Rv,Hw=ha,kz=Ig,YJt=tR;var YSe;(function(n){function e(t){let r=t;return r&&Hw.func(r.listen)&&Hw.func(r.dispose)&&Hw.func(r.onError)&&Hw.func(r.onClose)&&Hw.func(r.onPartialMessage)}n.is=e})(YSe||(cy.MessageReader=YSe={}));class _Be{constructor(){this.errorEmitter=new kz.Emitter,this.closeEmitter=new kz.Emitter,this.partialMessageEmitter=new kz.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e){this.errorEmitter.fire(this.asError(e))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(e){this.partialMessageEmitter.fire(e)}asError(e){return e instanceof Error?e:new Error(`Reader received error. Reason: ${Hw.string(e.message)?e.message:"unknown"}`)}}var wBe=cy.AbstractMessageReader=_Be,vY;(function(n){function e(t){let r,i;const o=new Map;let s;const a=new Map;if(t===void 0||typeof t=="string")r=t??"utf-8";else{if(r=t.charset??"utf-8",t.contentDecoder!==void 0&&(i=t.contentDecoder,o.set(i.name,i)),t.contentDecoders!==void 0)for(const c of t.contentDecoders)o.set(c.name,c);if(t.contentTypeDecoder!==void 0&&(s=t.contentTypeDecoder,a.set(s.name,s)),t.contentTypeDecoders!==void 0)for(const c of t.contentTypeDecoders)a.set(c.name,c)}return s===void 0&&(s=(0,mY.default)().applicationJson.decoder,a.set(s.name,s)),{charset:r,contentDecoder:i,contentDecoders:o,contentTypeDecoder:s,contentTypeDecoders:a}}n.fromOptions=e})(vY||(vY={}));class JJt extends _Be{constructor(e,t){super(),this.readable=e,this.options=vY.fromOptions(t),this.buffer=(0,mY.default)().messageBuffer.create(this.options.charset),this._partialMessageTimeout=1e4,this.nextMessageLength=-1,this.messageToken=0,this.readSemaphore=new YJt.Semaphore(1)}set partialMessageTimeout(e){this._partialMessageTimeout=e}get partialMessageTimeout(){return this._partialMessageTimeout}listen(e){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=e;const t=this.readable.onData(r=>{this.onData(r)});return this.readable.onError(r=>this.fireError(r)),this.readable.onClose(()=>this.fireClose()),t}onData(e){try{for(this.buffer.append(e);;){if(this.nextMessageLength===-1){const r=this.buffer.tryReadHeaders(!0);if(!r)return;const i=r.get("content-length");if(!i){this.fireError(new Error(`Header must provide a Content-Length property.
${JSON.stringify(Object.fromEntries(r))}`));return}const o=parseInt(i);if(isNaN(o)){this.fireError(new Error(`Content-Length value must be a number. Got ${i}`));return}this.nextMessageLength=o}const t=this.buffer.tryReadBody(this.nextMessageLength);if(t===void 0){this.setPartialMessageTimer();return}this.clearPartialMessageTimer(),this.nextMessageLength=-1,this.readSemaphore.lock(async()=>{const r=this.options.contentDecoder!==void 0?await this.options.contentDecoder.decode(t):t,i=await this.options.contentTypeDecoder.decode(r,this.options);this.callback(i)}).catch(r=>{this.fireError(r)})}}catch(t){this.fireError(t)}}clearPartialMessageTimer(){this.partialMessageTimer&&(this.partialMessageTimer.dispose(),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),!(this._partialMessageTimeout<=0)&&(this.partialMessageTimer=(0,mY.default)().timer.setTimeout((e,t)=>{this.partialMessageTimer=void 0,e===this.messageToken&&(this.firePartialMessage({messageToken:e,waitingTime:t}),this.setPartialMessageTimer())},this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}}cy.ReadableStreamMessageReader=JJt;var ly={};Object.defineProperty(ly,"__esModule",{value:!0});ly.WriteableStreamMessageWriter=xBe=ly.AbstractMessageWriter=ly.MessageWriter=void 0;const JSe=Rv,CP=ha,QJt=tR,QSe=Ig,eQt="Content-Length: ",e_e=`\r
`;var t_e;(function(n){function e(t){let r=t;return r&&CP.func(r.dispose)&&CP.func(r.onClose)&&CP.func(r.onError)&&CP.func(r.write)}n.is=e})(t_e||(ly.MessageWriter=t_e={}));class CBe{constructor(){this.errorEmitter=new QSe.Emitter,this.closeEmitter=new QSe.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e,t,r){this.errorEmitter.fire([this.asError(e),t,r])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(e){return e instanceof Error?e:new Error(`Writer received error. Reason: ${CP.string(e.message)?e.message:"unknown"}`)}}var xBe=ly.AbstractMessageWriter=CBe,yY;(function(n){function e(t){return t===void 0||typeof t=="string"?{charset:t??"utf-8",contentTypeEncoder:(0,JSe.default)().applicationJson.encoder}:{charset:t.charset??"utf-8",contentEncoder:t.contentEncoder,contentTypeEncoder:t.contentTypeEncoder??(0,JSe.default)().applicationJson.encoder}}n.fromOptions=e})(yY||(yY={}));class tQt extends CBe{constructor(e,t){super(),this.writable=e,this.options=yY.fromOptions(t),this.errorCount=0,this.writeSemaphore=new QJt.Semaphore(1),this.writable.onError(r=>this.fireError(r)),this.writable.onClose(()=>this.fireClose())}async write(e){return this.writeSemaphore.lock(async()=>this.options.contentTypeEncoder.encode(e,this.options).then(r=>this.options.contentEncoder!==void 0?this.options.contentEncoder.encode(r):r).then(r=>{const i=[];return i.push(eQt,r.byteLength.toString(),e_e),i.push(e_e),this.doWrite(e,i,r)},r=>{throw this.fireError(r),r}))}async doWrite(e,t,r){try{return await this.writable.write(t.join(""),"ascii"),this.writable.write(r)}catch(i){return this.handleError(i,e),Promise.reject(i)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){this.writable.end()}}ly.WriteableStreamMessageWriter=tQt;var vF={};Object.defineProperty(vF,"__esModule",{value:!0});vF.AbstractMessageBuffer=void 0;const nQt=13,rQt=10,iQt=`\r
`;class oQt{constructor(e="utf-8"){this._encoding=e,this._chunks=[],this._totalLength=0}get encoding(){return this._encoding}append(e){const t=typeof e=="string"?this.fromString(e,this._encoding):e;this._chunks.push(t),this._totalLength+=t.byteLength}tryReadHeaders(e=!1){if(this._chunks.length===0)return;let t=0,r=0,i=0,o=0;e:for(;r<this._chunks.length;){const l=this._chunks[r];for(i=0;i<l.length;){switch(l[i]){case nQt:switch(t){case 0:t=1;break;case 2:t=3;break;default:t=0}break;case rQt:switch(t){case 1:t=2;break;case 3:t=4,i++;break e;default:t=0}break;default:t=0}i++}o+=l.byteLength,r++}if(t!==4)return;const s=this._read(o+i),a=new Map,c=this.toString(s,"ascii").split(iQt);if(c.length<2)return a;for(let l=0;l<c.length-2;l++){const u=c[l],d=u.indexOf(":");if(d===-1)throw new Error(`Message header must separate key and value using ':'
${u}`);const h=u.substr(0,d),f=u.substr(d+1).trim();a.set(e?h.toLowerCase():h,f)}return a}tryReadBody(e){if(!(this._totalLength<e))return this._read(e)}get numberOfBytes(){return this._totalLength}_read(e){if(e===0)return this.emptyBuffer();if(e>this._totalLength)throw new Error("Cannot read so many bytes!");if(this._chunks[0].byteLength===e){const o=this._chunks[0];return this._chunks.shift(),this._totalLength-=e,this.asNative(o)}if(this._chunks[0].byteLength>e){const o=this._chunks[0],s=this.asNative(o,e);return this._chunks[0]=o.slice(e),this._totalLength-=e,s}const t=this.allocNative(e);let r=0,i=0;for(;e>0;){const o=this._chunks[i];if(o.byteLength>e){const s=o.slice(0,e);t.set(s,r),r+=e,this._chunks[i]=o.slice(e),this._totalLength-=e,e-=e}else t.set(o,r),r+=o.byteLength,this._chunks.shift(),this._totalLength-=o.byteLength,e-=o.byteLength}return t}}vF.AbstractMessageBuffer=oQt;var EBe={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.createMessageConnection=n.ConnectionOptions=n.MessageStrategy=n.CancellationStrategy=n.CancellationSenderStrategy=n.CancellationReceiverStrategy=n.RequestCancellationReceiverStrategy=n.IdCancellationReceiverStrategy=n.ConnectionStrategy=n.ConnectionError=n.ConnectionErrors=n.LogTraceNotification=n.SetTraceNotification=n.TraceFormat=n.TraceValues=n.Trace=n.NullLogger=n.ProgressType=n.ProgressToken=void 0;const e=Rv,t=ha,r=Xn,i=Qm,o=Ig,s=Ny;var a;(function(A){A.type=new r.NotificationType("$/cancelRequest")})(a||(a={}));var c;(function(A){function k(L){return typeof L=="string"||typeof L=="number"}A.is=k})(c||(n.ProgressToken=c={}));var l;(function(A){A.type=new r.NotificationType("$/progress")})(l||(l={}));class u{constructor(){}}n.ProgressType=u;var d;(function(A){function k(L){return t.func(L)}A.is=k})(d||(d={})),n.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}});var h;(function(A){A[A.Off=0]="Off",A[A.Messages=1]="Messages",A[A.Compact=2]="Compact",A[A.Verbose=3]="Verbose"})(h||(n.Trace=h={}));var f;(function(A){A.Off="off",A.Messages="messages",A.Compact="compact",A.Verbose="verbose"})(f||(n.TraceValues=f={})),function(A){function k(j){if(!t.string(j))return A.Off;switch(j=j.toLowerCase(),j){case"off":return A.Off;case"messages":return A.Messages;case"compact":return A.Compact;case"verbose":return A.Verbose;default:return A.Off}}A.fromString=k;function L(j){switch(j){case A.Off:return"off";case A.Messages:return"messages";case A.Compact:return"compact";case A.Verbose:return"verbose";default:return"off"}}A.toString=L}(h||(n.Trace=h={}));var p;(function(A){A.Text="text",A.JSON="json"})(p||(n.TraceFormat=p={})),function(A){function k(L){return t.string(L)?(L=L.toLowerCase(),L==="json"?A.JSON:A.Text):A.Text}A.fromString=k}(p||(n.TraceFormat=p={}));var g;(function(A){A.type=new r.NotificationType("$/setTrace")})(g||(n.SetTraceNotification=g={}));var m;(function(A){A.type=new r.NotificationType("$/logTrace")})(m||(n.LogTraceNotification=m={}));var v;(function(A){A[A.Closed=1]="Closed",A[A.Disposed=2]="Disposed",A[A.AlreadyListening=3]="AlreadyListening"})(v||(n.ConnectionErrors=v={}));class b extends Error{constructor(k,L){super(L),this.code=k,Object.setPrototypeOf(this,b.prototype)}}n.ConnectionError=b;var S;(function(A){function k(L){const j=L;return j&&t.func(j.cancelUndispatched)}A.is=k})(S||(n.ConnectionStrategy=S={}));var E;(function(A){function k(L){const j=L;return j&&(j.kind===void 0||j.kind==="id")&&t.func(j.createCancellationTokenSource)&&(j.dispose===void 0||t.func(j.dispose))}A.is=k})(E||(n.IdCancellationReceiverStrategy=E={}));var w;(function(A){function k(L){const j=L;return j&&j.kind==="request"&&t.func(j.createCancellationTokenSource)&&(j.dispose===void 0||t.func(j.dispose))}A.is=k})(w||(n.RequestCancellationReceiverStrategy=w={}));var C;(function(A){A.Message=Object.freeze({createCancellationTokenSource(L){return new s.CancellationTokenSource}});function k(L){return E.is(L)||w.is(L)}A.is=k})(C||(n.CancellationReceiverStrategy=C={}));var I;(function(A){A.Message=Object.freeze({sendCancellation(L,j){return L.sendNotification(a.type,{id:j})},cleanup(L){}});function k(L){const j=L;return j&&t.func(j.sendCancellation)&&t.func(j.cleanup)}A.is=k})(I||(n.CancellationSenderStrategy=I={}));var T;(function(A){A.Message=Object.freeze({receiver:C.Message,sender:I.Message});function k(L){const j=L;return j&&C.is(j.receiver)&&I.is(j.sender)}A.is=k})(T||(n.CancellationStrategy=T={}));var D;(function(A){function k(L){const j=L;return j&&t.func(j.handleMessage)}A.is=k})(D||(n.MessageStrategy=D={}));var O;(function(A){function k(L){const j=L;return j&&(T.is(j.cancellationStrategy)||S.is(j.connectionStrategy)||D.is(j.messageStrategy))}A.is=k})(O||(n.ConnectionOptions=O={}));var M;(function(A){A[A.New=1]="New",A[A.Listening=2]="Listening",A[A.Closed=3]="Closed",A[A.Disposed=4]="Disposed"})(M||(M={}));function R(A,k,L,j){const N=L!==void 0?L:n.NullLogger;let B=0,U=0,K=0;const z="2.0";let G;const te=new Map;let ie;const Q=new Map,ge=new Map;let _e,Se=new i.LinkedMap,se=new Map,ee=new Set,Y=new Map,ue=h.Off,ye=p.Text,V,le=M.New;const he=new o.Emitter,oe=new o.Emitter,ne=new o.Emitter,ce=new o.Emitter,Ae=new o.Emitter,Ie=j&&j.cancellationStrategy?j.cancellationStrategy:T.Message;function be(Ce){if(Ce===null)throw new Error("Can't send requests with id null since the response can't be correlated.");return"req-"+Ce.toString()}function De(Ce){return Ce===null?"res-unknown-"+(++K).toString():"res-"+Ce.toString()}function Me(){return"not-"+(++U).toString()}function He(Ce,ct){r.Message.isRequest(ct)?Ce.set(be(ct.id),ct):r.Message.isResponse(ct)?Ce.set(De(ct.id),ct):Ce.set(Me(),ct)}function Je(Ce){}function qe(){return le===M.Listening}function Ge(){return le===M.Closed}function St(){return le===M.Disposed}function Pt(){(le===M.New||le===M.Listening)&&(le=M.Closed,oe.fire(void 0))}function on(Ce){he.fire([Ce,void 0,void 0])}function an(Ce){he.fire(Ce)}A.onClose(Pt),A.onError(on),k.onClose(Pt),k.onError(an);function Rt(){_e||Se.size===0||(_e=(0,e.default)().timer.setImmediate(()=>{_e=void 0,yn()}))}function Xt(Ce){r.Message.isRequest(Ce)?Kn(Ce):r.Message.isNotification(Ce)?Rr(Ce):r.Message.isResponse(Ce)?lr(Ce):Lr(Ce)}function yn(){if(Se.size===0)return;const Ce=Se.shift();try{const ct=j==null?void 0:j.messageStrategy;D.is(ct)?ct.handleMessage(Ce,Xt):Xt(Ce)}finally{Rt()}}const bn=Ce=>{try{if(r.Message.isNotification(Ce)&&Ce.method===a.type.method){const ct=Ce.params.id,At=be(ct),$t=Se.get(At);if(r.Message.isRequest($t)){const jn=j==null?void 0:j.connectionStrategy,Zn=jn&&jn.cancelUndispatched?jn.cancelUndispatched($t,Je):void 0;if(Zn&&(Zn.error!==void 0||Zn.result!==void 0)){Se.delete(At),Y.delete(ct),Zn.id=$t.id,Gn(Zn,Ce.method,Date.now()),k.write(Zn).catch(()=>N.error("Sending response for canceled message failed."));return}}const _n=Y.get(ct);if(_n!==void 0){_n.cancel(),ze(Ce);return}else ee.add(ct)}He(Se,Ce)}finally{Rt()}};function Kn(Ce){if(St())return;function ct(ve,W,X){const fe={jsonrpc:z,id:Ce.id};ve instanceof r.ResponseError?fe.error=ve.toJson():fe.result=ve===void 0?null:ve,Gn(fe,W,X),k.write(fe).catch(()=>N.error("Sending response failed."))}function At(ve,W,X){const fe={jsonrpc:z,id:Ce.id,error:ve.toJson()};Gn(fe,W,X),k.write(fe).catch(()=>N.error("Sending response failed."))}function $t(ve,W,X){ve===void 0&&(ve=null);const fe={jsonrpc:z,id:Ce.id,result:ve};Gn(fe,W,X),k.write(fe).catch(()=>N.error("Sending response failed."))}J(Ce);const _n=te.get(Ce.method);let jn,Zn;_n&&(jn=_n.type,Zn=_n.handler);const Z=Date.now();if(Zn||G){const ve=Ce.id??String(Date.now()),W=E.is(Ie.receiver)?Ie.receiver.createCancellationTokenSource(ve):Ie.receiver.createCancellationTokenSource(Ce);Ce.id!==null&&ee.has(Ce.id)&&W.cancel(),Ce.id!==null&&Y.set(ve,W);try{let X;if(Zn)if(Ce.params===void 0){if(jn!==void 0&&jn.numberOfParams!==0){At(new r.ResponseError(r.ErrorCodes.InvalidParams,`Request ${Ce.method} defines ${jn.numberOfParams} params but received none.`),Ce.method,Z);return}X=Zn(W.token)}else if(Array.isArray(Ce.params)){if(jn!==void 0&&jn.parameterStructures===r.ParameterStructures.byName){At(new r.ResponseError(r.ErrorCodes.InvalidParams,`Request ${Ce.method} defines parameters by name but received parameters by position`),Ce.method,Z);return}X=Zn(...Ce.params,W.token)}else{if(jn!==void 0&&jn.parameterStructures===r.ParameterStructures.byPosition){At(new r.ResponseError(r.ErrorCodes.InvalidParams,`Request ${Ce.method} defines parameters by position but received parameters by name`),Ce.method,Z);return}X=Zn(Ce.params,W.token)}else G&&(X=G(Ce.method,Ce.params,W.token));const fe=X;X?fe.then?fe.then(xt=>{Y.delete(ve),ct(xt,Ce.method,Z)},xt=>{Y.delete(ve),xt instanceof r.ResponseError?At(xt,Ce.method,Z):xt&&t.string(xt.message)?At(new r.ResponseError(r.ErrorCodes.InternalError,`Request ${Ce.method} failed with message: ${xt.message}`),Ce.method,Z):At(new r.ResponseError(r.ErrorCodes.InternalError,`Request ${Ce.method} failed unexpectedly without providing any details.`),Ce.method,Z)}):(Y.delete(ve),ct(X,Ce.method,Z)):(Y.delete(ve),$t(X,Ce.method,Z))}catch(X){Y.delete(ve),X instanceof r.ResponseError?ct(X,Ce.method,Z):X&&t.string(X.message)?At(new r.ResponseError(r.ErrorCodes.InternalError,`Request ${Ce.method} failed with message: ${X.message}`),Ce.method,Z):At(new r.ResponseError(r.ErrorCodes.InternalError,`Request ${Ce.method} failed unexpectedly without providing any details.`),Ce.method,Z)}}else At(new r.ResponseError(r.ErrorCodes.MethodNotFound,`Unhandled method ${Ce.method}`),Ce.method,Z)}function lr(Ce){if(!St())if(Ce.id===null)Ce.error?N.error(`Received response message without id: Error is: 
${JSON.stringify(Ce.error,void 0,4)}`):N.error("Received response message without id. No further error information provided.");else{const ct=Ce.id,At=se.get(ct);if(it(Ce,At),At!==void 0){se.delete(ct);try{if(Ce.error){const $t=Ce.error;At.reject(new r.ResponseError($t.code,$t.message,$t.data))}else if(Ce.result!==void 0)At.resolve(Ce.result);else throw new Error("Should never happen.")}catch($t){$t.message?N.error(`Response handler '${At.method}' failed with message: ${$t.message}`):N.error(`Response handler '${At.method}' failed unexpectedly.`)}}}}function Rr(Ce){if(St())return;let ct,At;if(Ce.method===a.type.method){const $t=Ce.params.id;ee.delete($t),ze(Ce);return}else{const $t=Q.get(Ce.method);$t&&(At=$t.handler,ct=$t.type)}if(At||ie)try{if(ze(Ce),At)if(Ce.params===void 0)ct!==void 0&&ct.numberOfParams!==0&&ct.parameterStructures!==r.ParameterStructures.byName&&N.error(`Notification ${Ce.method} defines ${ct.numberOfParams} params but received none.`),At();else if(Array.isArray(Ce.params)){const $t=Ce.params;Ce.method===l.type.method&&$t.length===2&&c.is($t[0])?At({token:$t[0],value:$t[1]}):(ct!==void 0&&(ct.parameterStructures===r.ParameterStructures.byName&&N.error(`Notification ${Ce.method} defines parameters by name but received parameters by position`),ct.numberOfParams!==Ce.params.length&&N.error(`Notification ${Ce.method} defines ${ct.numberOfParams} params but received ${$t.length} arguments`)),At(...$t))}else ct!==void 0&&ct.parameterStructures===r.ParameterStructures.byPosition&&N.error(`Notification ${Ce.method} defines parameters by position but received parameters by name`),At(Ce.params);else ie&&ie(Ce.method,Ce.params)}catch($t){$t.message?N.error(`Notification handler '${Ce.method}' failed with message: ${$t.message}`):N.error(`Notification handler '${Ce.method}' failed unexpectedly.`)}else ne.fire(Ce)}function Lr(Ce){if(!Ce){N.error("Received empty message.");return}N.error(`Received message which is neither a response nor a notification message:
${JSON.stringify(Ce,null,4)}`);const ct=Ce;if(t.string(ct.id)||t.number(ct.id)){const At=ct.id,$t=se.get(At);$t&&$t.reject(new Error("The received response has neither a result nor an error property."))}}function er(Ce){if(Ce!=null)switch(ue){case h.Verbose:return JSON.stringify(Ce,null,4);case h.Compact:return JSON.stringify(Ce);default:return}}function ke(Ce){if(!(ue===h.Off||!V))if(ye===p.Text){let ct;(ue===h.Verbose||ue===h.Compact)&&Ce.params&&(ct=`Params: ${er(Ce.params)}

`),V.log(`Sending request '${Ce.method} - (${Ce.id})'.`,ct)}else at("send-request",Ce)}function Qn(Ce){if(!(ue===h.Off||!V))if(ye===p.Text){let ct;(ue===h.Verbose||ue===h.Compact)&&(Ce.params?ct=`Params: ${er(Ce.params)}

`:ct=`No parameters provided.

`),V.log(`Sending notification '${Ce.method}'.`,ct)}else at("send-notification",Ce)}function Gn(Ce,ct,At){if(!(ue===h.Off||!V))if(ye===p.Text){let $t;(ue===h.Verbose||ue===h.Compact)&&(Ce.error&&Ce.error.data?$t=`Error data: ${er(Ce.error.data)}

`:Ce.result?$t=`Result: ${er(Ce.result)}

`:Ce.error===void 0&&($t=`No result returned.

`)),V.log(`Sending response '${ct} - (${Ce.id})'. Processing request took ${Date.now()-At}ms`,$t)}else at("send-response",Ce)}function J(Ce){if(!(ue===h.Off||!V))if(ye===p.Text){let ct;(ue===h.Verbose||ue===h.Compact)&&Ce.params&&(ct=`Params: ${er(Ce.params)}

`),V.log(`Received request '${Ce.method} - (${Ce.id})'.`,ct)}else at("receive-request",Ce)}function ze(Ce){if(!(ue===h.Off||!V||Ce.method===m.type.method))if(ye===p.Text){let ct;(ue===h.Verbose||ue===h.Compact)&&(Ce.params?ct=`Params: ${er(Ce.params)}

`:ct=`No parameters provided.

`),V.log(`Received notification '${Ce.method}'.`,ct)}else at("receive-notification",Ce)}function it(Ce,ct){if(!(ue===h.Off||!V))if(ye===p.Text){let At;if((ue===h.Verbose||ue===h.Compact)&&(Ce.error&&Ce.error.data?At=`Error data: ${er(Ce.error.data)}

`:Ce.result?At=`Result: ${er(Ce.result)}

`:Ce.error===void 0&&(At=`No result returned.

`)),ct){const $t=Ce.error?` Request failed: ${Ce.error.message} (${Ce.error.code}).`:"";V.log(`Received response '${ct.method} - (${Ce.id})' in ${Date.now()-ct.timerStart}ms.${$t}`,At)}else V.log(`Received response ${Ce.id} without active response promise.`,At)}else at("receive-response",Ce)}function at(Ce,ct){if(!V||ue===h.Off)return;const At={isLSPMessage:!0,type:Ce,message:ct,timestamp:Date.now()};V.log(At)}function Lt(){if(Ge())throw new b(v.Closed,"Connection is closed.");if(St())throw new b(v.Disposed,"Connection is disposed.")}function fn(){if(qe())throw new b(v.AlreadyListening,"Connection is already listening")}function hn(){if(!qe())throw new Error("Call listen() first.")}function Ut(Ce){return Ce===void 0?null:Ce}function sn(Ce){if(Ce!==null)return Ce}function ae(Ce){return Ce!=null&&!Array.isArray(Ce)&&typeof Ce=="object"}function Wt(Ce,ct){switch(Ce){case r.ParameterStructures.auto:return ae(ct)?sn(ct):[Ut(ct)];case r.ParameterStructures.byName:if(!ae(ct))throw new Error("Received parameters by name but param is not an object literal.");return sn(ct);case r.ParameterStructures.byPosition:return[Ut(ct)];default:throw new Error(`Unknown parameter structure ${Ce.toString()}`)}}function un(Ce,ct){let At;const $t=Ce.numberOfParams;switch($t){case 0:At=void 0;break;case 1:At=Wt(Ce.parameterStructures,ct[0]);break;default:At=[];for(let _n=0;_n<ct.length&&_n<$t;_n++)At.push(Ut(ct[_n]));if(ct.length<$t)for(let _n=ct.length;_n<$t;_n++)At.push(null);break}return At}const qt={sendNotification:(Ce,...ct)=>{Lt();let At,$t;if(t.string(Ce)){At=Ce;const jn=ct[0];let Zn=0,Z=r.ParameterStructures.auto;r.ParameterStructures.is(jn)&&(Zn=1,Z=jn);let ve=ct.length;const W=ve-Zn;switch(W){case 0:$t=void 0;break;case 1:$t=Wt(Z,ct[Zn]);break;default:if(Z===r.ParameterStructures.byName)throw new Error(`Received ${W} parameters for 'by Name' notification parameter structure.`);$t=ct.slice(Zn,ve).map(X=>Ut(X));break}}else{const jn=ct;At=Ce.method,$t=un(Ce,jn)}const _n={jsonrpc:z,method:At,params:$t};return Qn(_n),k.write(_n).catch(jn=>{throw N.error("Sending notification failed."),jn})},onNotification:(Ce,ct)=>{Lt();let At;return t.func(Ce)?ie=Ce:ct&&(t.string(Ce)?(At=Ce,Q.set(Ce,{type:void 0,handler:ct})):(At=Ce.method,Q.set(Ce.method,{type:Ce,handler:ct}))),{dispose:()=>{At!==void 0?Q.delete(At):ie=void 0}}},onProgress:(Ce,ct,At)=>{if(ge.has(ct))throw new Error(`Progress handler for token ${ct} already registered`);return ge.set(ct,At),{dispose:()=>{ge.delete(ct)}}},sendProgress:(Ce,ct,At)=>qt.sendNotification(l.type,{token:ct,value:At}),onUnhandledProgress:ce.event,sendRequest:(Ce,...ct)=>{Lt(),hn();let At,$t,_n;if(t.string(Ce)){At=Ce;const ve=ct[0],W=ct[ct.length-1];let X=0,fe=r.ParameterStructures.auto;r.ParameterStructures.is(ve)&&(X=1,fe=ve);let xt=ct.length;s.CancellationToken.is(W)&&(xt=xt-1,_n=W);const Zt=xt-X;switch(Zt){case 0:$t=void 0;break;case 1:$t=Wt(fe,ct[X]);break;default:if(fe===r.ParameterStructures.byName)throw new Error(`Received ${Zt} parameters for 'by Name' request parameter structure.`);$t=ct.slice(X,xt).map(or=>Ut(or));break}}else{const ve=ct;At=Ce.method,$t=un(Ce,ve);const W=Ce.numberOfParams;_n=s.CancellationToken.is(ve[W])?ve[W]:void 0}const jn=B++;let Zn;_n&&(Zn=_n.onCancellationRequested(()=>{const ve=Ie.sender.sendCancellation(qt,jn);return ve===void 0?(N.log(`Received no promise from cancellation strategy when cancelling id ${jn}`),Promise.resolve()):ve.catch(()=>{N.log(`Sending cancellation messages for id ${jn} failed`)})}));const Z={jsonrpc:z,id:jn,method:At,params:$t};return ke(Z),typeof Ie.sender.enableCancellation=="function"&&Ie.sender.enableCancellation(Z),new Promise(async(ve,W)=>{const X=Zt=>{ve(Zt),Ie.sender.cleanup(jn),Zn==null||Zn.dispose()},fe=Zt=>{W(Zt),Ie.sender.cleanup(jn),Zn==null||Zn.dispose()},xt={method:At,timerStart:Date.now(),resolve:X,reject:fe};try{await k.write(Z),se.set(jn,xt)}catch(Zt){throw N.error("Sending request failed."),xt.reject(new r.ResponseError(r.ErrorCodes.MessageWriteError,Zt.message?Zt.message:"Unknown reason")),Zt}})},onRequest:(Ce,ct)=>{Lt();let At=null;return d.is(Ce)?(At=void 0,G=Ce):t.string(Ce)?(At=null,ct!==void 0&&(At=Ce,te.set(Ce,{handler:ct,type:void 0}))):ct!==void 0&&(At=Ce.method,te.set(Ce.method,{type:Ce,handler:ct})),{dispose:()=>{At!==null&&(At!==void 0?te.delete(At):G=void 0)}}},hasPendingResponse:()=>se.size>0,trace:async(Ce,ct,At)=>{let $t=!1,_n=p.Text;At!==void 0&&(t.boolean(At)?$t=At:($t=At.sendNotification||!1,_n=At.traceFormat||p.Text)),ue=Ce,ye=_n,ue===h.Off?V=void 0:V=ct,$t&&!Ge()&&!St()&&await qt.sendNotification(g.type,{value:h.toString(Ce)})},onError:he.event,onClose:oe.event,onUnhandledNotification:ne.event,onDispose:Ae.event,end:()=>{k.end()},dispose:()=>{if(St())return;le=M.Disposed,Ae.fire(void 0);const Ce=new r.ResponseError(r.ErrorCodes.PendingResponseRejected,"Pending response rejected since connection got disposed");for(const ct of se.values())ct.reject(Ce);se=new Map,Y=new Map,ee=new Set,Se=new i.LinkedMap,t.func(k.dispose)&&k.dispose(),t.func(A.dispose)&&A.dispose()},listen:()=>{Lt(),fn(),le=M.Listening,A.listen(bn)},inspect:()=>{(0,e.default)().console.log("inspect")}};return qt.onNotification(m.type,Ce=>{if(ue===h.Off||!V)return;const ct=ue===h.Verbose||ue===h.Compact;V.log(Ce.message,ct?Ce.verbose:void 0)}),qt.onNotification(l.type,Ce=>{const ct=ge.get(Ce.token);ct?ct(Ce.value):ce.fire(Ce)}),qt}n.createMessageConnection=R})(EBe);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.ProgressType=n.ProgressToken=n.createMessageConnection=n.NullLogger=n.ConnectionOptions=n.ConnectionStrategy=n.AbstractMessageBuffer=n.WriteableStreamMessageWriter=n.AbstractMessageWriter=n.MessageWriter=n.ReadableStreamMessageReader=n.AbstractMessageReader=n.MessageReader=n.SharedArrayReceiverStrategy=n.SharedArraySenderStrategy=n.CancellationToken=n.CancellationTokenSource=n.Emitter=n.Event=n.Disposable=n.LRUCache=n.Touch=n.LinkedMap=n.ParameterStructures=n.NotificationType9=n.NotificationType8=n.NotificationType7=n.NotificationType6=n.NotificationType5=n.NotificationType4=n.NotificationType3=n.NotificationType2=n.NotificationType1=n.NotificationType0=n.NotificationType=n.ErrorCodes=n.ResponseError=n.RequestType9=n.RequestType8=n.RequestType7=n.RequestType6=n.RequestType5=n.RequestType4=n.RequestType3=n.RequestType2=n.RequestType1=n.RequestType0=n.RequestType=n.Message=n.RAL=void 0,n.MessageStrategy=n.CancellationStrategy=n.CancellationSenderStrategy=n.CancellationReceiverStrategy=n.ConnectionError=n.ConnectionErrors=n.LogTraceNotification=n.SetTraceNotification=n.TraceFormat=n.TraceValues=n.Trace=void 0;const e=Xn;Object.defineProperty(n,"Message",{enumerable:!0,get:function(){return e.Message}}),Object.defineProperty(n,"RequestType",{enumerable:!0,get:function(){return e.RequestType}}),Object.defineProperty(n,"RequestType0",{enumerable:!0,get:function(){return e.RequestType0}}),Object.defineProperty(n,"RequestType1",{enumerable:!0,get:function(){return e.RequestType1}}),Object.defineProperty(n,"RequestType2",{enumerable:!0,get:function(){return e.RequestType2}}),Object.defineProperty(n,"RequestType3",{enumerable:!0,get:function(){return e.RequestType3}}),Object.defineProperty(n,"RequestType4",{enumerable:!0,get:function(){return e.RequestType4}}),Object.defineProperty(n,"RequestType5",{enumerable:!0,get:function(){return e.RequestType5}}),Object.defineProperty(n,"RequestType6",{enumerable:!0,get:function(){return e.RequestType6}}),Object.defineProperty(n,"RequestType7",{enumerable:!0,get:function(){return e.RequestType7}}),Object.defineProperty(n,"RequestType8",{enumerable:!0,get:function(){return e.RequestType8}}),Object.defineProperty(n,"RequestType9",{enumerable:!0,get:function(){return e.RequestType9}}),Object.defineProperty(n,"ResponseError",{enumerable:!0,get:function(){return e.ResponseError}}),Object.defineProperty(n,"ErrorCodes",{enumerable:!0,get:function(){return e.ErrorCodes}}),Object.defineProperty(n,"NotificationType",{enumerable:!0,get:function(){return e.NotificationType}}),Object.defineProperty(n,"NotificationType0",{enumerable:!0,get:function(){return e.NotificationType0}}),Object.defineProperty(n,"NotificationType1",{enumerable:!0,get:function(){return e.NotificationType1}}),Object.defineProperty(n,"NotificationType2",{enumerable:!0,get:function(){return e.NotificationType2}}),Object.defineProperty(n,"NotificationType3",{enumerable:!0,get:function(){return e.NotificationType3}}),Object.defineProperty(n,"NotificationType4",{enumerable:!0,get:function(){return e.NotificationType4}}),Object.defineProperty(n,"NotificationType5",{enumerable:!0,get:function(){return e.NotificationType5}}),Object.defineProperty(n,"NotificationType6",{enumerable:!0,get:function(){return e.NotificationType6}}),Object.defineProperty(n,"NotificationType7",{enumerable:!0,get:function(){return e.NotificationType7}}),Object.defineProperty(n,"NotificationType8",{enumerable:!0,get:function(){return e.NotificationType8}}),Object.defineProperty(n,"NotificationType9",{enumerable:!0,get:function(){return e.NotificationType9}}),Object.defineProperty(n,"ParameterStructures",{enumerable:!0,get:function(){return e.ParameterStructures}});const t=Qm;Object.defineProperty(n,"LinkedMap",{enumerable:!0,get:function(){return t.LinkedMap}}),Object.defineProperty(n,"LRUCache",{enumerable:!0,get:function(){return t.LRUCache}}),Object.defineProperty(n,"Touch",{enumerable:!0,get:function(){return t.Touch}});const r=gF;Object.defineProperty(n,"Disposable",{enumerable:!0,get:function(){return r.Disposable}});const i=Ig;Object.defineProperty(n,"Event",{enumerable:!0,get:function(){return i.Event}}),Object.defineProperty(n,"Emitter",{enumerable:!0,get:function(){return i.Emitter}});const o=Ny;Object.defineProperty(n,"CancellationTokenSource",{enumerable:!0,get:function(){return o.CancellationTokenSource}}),Object.defineProperty(n,"CancellationToken",{enumerable:!0,get:function(){return o.CancellationToken}});const s=Sx;Object.defineProperty(n,"SharedArraySenderStrategy",{enumerable:!0,get:function(){return s.SharedArraySenderStrategy}}),Object.defineProperty(n,"SharedArrayReceiverStrategy",{enumerable:!0,get:function(){return s.SharedArrayReceiverStrategy}});const a=cy;Object.defineProperty(n,"MessageReader",{enumerable:!0,get:function(){return a.MessageReader}}),Object.defineProperty(n,"AbstractMessageReader",{enumerable:!0,get:function(){return a.AbstractMessageReader}}),Object.defineProperty(n,"ReadableStreamMessageReader",{enumerable:!0,get:function(){return a.ReadableStreamMessageReader}});const c=ly;Object.defineProperty(n,"MessageWriter",{enumerable:!0,get:function(){return c.MessageWriter}}),Object.defineProperty(n,"AbstractMessageWriter",{enumerable:!0,get:function(){return c.AbstractMessageWriter}}),Object.defineProperty(n,"WriteableStreamMessageWriter",{enumerable:!0,get:function(){return c.WriteableStreamMessageWriter}});const l=vF;Object.defineProperty(n,"AbstractMessageBuffer",{enumerable:!0,get:function(){return l.AbstractMessageBuffer}});const u=EBe;Object.defineProperty(n,"ConnectionStrategy",{enumerable:!0,get:function(){return u.ConnectionStrategy}}),Object.defineProperty(n,"ConnectionOptions",{enumerable:!0,get:function(){return u.ConnectionOptions}}),Object.defineProperty(n,"NullLogger",{enumerable:!0,get:function(){return u.NullLogger}}),Object.defineProperty(n,"createMessageConnection",{enumerable:!0,get:function(){return u.createMessageConnection}}),Object.defineProperty(n,"ProgressToken",{enumerable:!0,get:function(){return u.ProgressToken}}),Object.defineProperty(n,"ProgressType",{enumerable:!0,get:function(){return u.ProgressType}}),Object.defineProperty(n,"Trace",{enumerable:!0,get:function(){return u.Trace}}),Object.defineProperty(n,"TraceValues",{enumerable:!0,get:function(){return u.TraceValues}}),Object.defineProperty(n,"TraceFormat",{enumerable:!0,get:function(){return u.TraceFormat}}),Object.defineProperty(n,"SetTraceNotification",{enumerable:!0,get:function(){return u.SetTraceNotification}}),Object.defineProperty(n,"LogTraceNotification",{enumerable:!0,get:function(){return u.LogTraceNotification}}),Object.defineProperty(n,"ConnectionErrors",{enumerable:!0,get:function(){return u.ConnectionErrors}}),Object.defineProperty(n,"ConnectionError",{enumerable:!0,get:function(){return u.ConnectionError}}),Object.defineProperty(n,"CancellationReceiverStrategy",{enumerable:!0,get:function(){return u.CancellationReceiverStrategy}}),Object.defineProperty(n,"CancellationSenderStrategy",{enumerable:!0,get:function(){return u.CancellationSenderStrategy}}),Object.defineProperty(n,"CancellationStrategy",{enumerable:!0,get:function(){return u.CancellationStrategy}}),Object.defineProperty(n,"MessageStrategy",{enumerable:!0,get:function(){return u.MessageStrategy}});const d=Rv;n.RAL=d.default})(H$);Object.defineProperty(cse,"__esModule",{value:!0});const Up=H$;class yF extends Up.AbstractMessageBuffer{constructor(e="utf-8"){super(e),this.asciiDecoder=new TextDecoder("ascii")}emptyBuffer(){return yF.emptyBuffer}fromString(e,t){return new TextEncoder().encode(e)}toString(e,t){return t==="ascii"?this.asciiDecoder.decode(e):new TextDecoder(t).decode(e)}asNative(e,t){return t===void 0?e:e.slice(0,t)}allocNative(e){return new Uint8Array(e)}}yF.emptyBuffer=new Uint8Array(0);class sQt{constructor(e){this.socket=e,this._onData=new Up.Emitter,this._messageListener=t=>{t.data.arrayBuffer().then(i=>{this._onData.fire(new Uint8Array(i))},()=>{(0,Up.RAL)().console.error("Converting blob to array buffer failed.")})},this.socket.addEventListener("message",this._messageListener)}onClose(e){return this.socket.addEventListener("close",e),Up.Disposable.create(()=>this.socket.removeEventListener("close",e))}onError(e){return this.socket.addEventListener("error",e),Up.Disposable.create(()=>this.socket.removeEventListener("error",e))}onEnd(e){return this.socket.addEventListener("end",e),Up.Disposable.create(()=>this.socket.removeEventListener("end",e))}onData(e){return this._onData.event(e)}}class aQt{constructor(e){this.socket=e}onClose(e){return this.socket.addEventListener("close",e),Up.Disposable.create(()=>this.socket.removeEventListener("close",e))}onError(e){return this.socket.addEventListener("error",e),Up.Disposable.create(()=>this.socket.removeEventListener("error",e))}onEnd(e){return this.socket.addEventListener("end",e),Up.Disposable.create(()=>this.socket.removeEventListener("end",e))}write(e,t){if(typeof e=="string"){if(t!==void 0&&t!=="utf-8")throw new Error(`In a Browser environments only utf-8 text encoding is supported. But got encoding: ${t}`);this.socket.send(e)}else this.socket.send(e);return Promise.resolve()}end(){this.socket.close()}}const cQt=new TextEncoder,IBe=Object.freeze({messageBuffer:Object.freeze({create:n=>new yF(n)}),applicationJson:Object.freeze({encoder:Object.freeze({name:"application/json",encode:(n,e)=>{if(e.charset!=="utf-8")throw new Error(`In a Browser environments only utf-8 text encoding is supported. But got encoding: ${e.charset}`);return Promise.resolve(cQt.encode(JSON.stringify(n,void 0,0)))}}),decoder:Object.freeze({name:"application/json",decode:(n,e)=>{if(!(n instanceof Uint8Array))throw new Error("In a Browser environments only Uint8Arrays are supported.");return Promise.resolve(JSON.parse(new TextDecoder(e.charset).decode(n)))}})}),stream:Object.freeze({asReadableStream:n=>new sQt(n),asWritableStream:n=>new aQt(n)}),console,timer:Object.freeze({setTimeout(n,e,...t){const r=setTimeout(n,e,...t);return{dispose:()=>clearTimeout(r)}},setImmediate(n,...e){const t=setTimeout(n,0,...e);return{dispose:()=>clearTimeout(t)}},setInterval(n,e,...t){const r=setInterval(n,e,...t);return{dispose:()=>clearInterval(r)}}})});function bY(){return IBe}(function(n){function e(){Up.RAL.install(IBe)}n.install=e})(bY||(bY={}));cse.default=bY;(function(n){var e=Ir&&Ir.__createBinding||(Object.create?function(c,l,u,d){d===void 0&&(d=u);var h=Object.getOwnPropertyDescriptor(l,u);(!h||("get"in h?!l.__esModule:h.writable||h.configurable))&&(h={enumerable:!0,get:function(){return l[u]}}),Object.defineProperty(c,d,h)}:function(c,l,u,d){d===void 0&&(d=u),c[d]=l[u]}),t=Ir&&Ir.__exportStar||function(c,l){for(var u in c)u!=="default"&&!Object.prototype.hasOwnProperty.call(l,u)&&e(l,c,u)};Object.defineProperty(n,"__esModule",{value:!0}),n.createMessageConnection=n.BrowserMessageWriter=n.BrowserMessageReader=void 0,cse.default.install();const i=H$;t(H$,n);class o extends i.AbstractMessageReader{constructor(l){super(),this._onData=new i.Emitter,this._messageListener=u=>{this._onData.fire(u.data)},l.addEventListener("error",u=>this.fireError(u)),l.onmessage=this._messageListener}listen(l){return this._onData.event(l)}}n.BrowserMessageReader=o;class s extends i.AbstractMessageWriter{constructor(l){super(),this.port=l,this.errorCount=0,l.addEventListener("error",u=>this.fireError(u))}write(l){try{return this.port.postMessage(l),Promise.resolve()}catch(u){return this.handleError(u,l),Promise.reject(u)}}handleError(l,u){this.errorCount++,this.fireError(l,u,this.errorCount)}end(){}}n.BrowserMessageWriter=s;function a(c,l,u,d){return u===void 0&&(u=i.NullLogger),i.ConnectionStrategy.is(d)&&(d={connectionStrategy:d}),(0,i.createMessageConnection)(c,l,u,d)}n.createMessageConnection=a})(S_);var n_e=S_,PBe={},SY;(function(n){function e(t){return typeof t=="string"}n.is=e})(SY||(SY={}));var z$;(function(n){function e(t){return typeof t=="string"}n.is=e})(z$||(z$={}));var _Y;(function(n){n.MIN_VALUE=-2147483648,n.MAX_VALUE=2147483647;function e(t){return typeof t=="number"&&n.MIN_VALUE<=t&&t<=n.MAX_VALUE}n.is=e})(_Y||(_Y={}));var uT;(function(n){n.MIN_VALUE=0,n.MAX_VALUE=2147483647;function e(t){return typeof t=="number"&&n.MIN_VALUE<=t&&t<=n.MAX_VALUE}n.is=e})(uT||(uT={}));var Ih;(function(n){function e(r,i){return r===Number.MAX_VALUE&&(r=uT.MAX_VALUE),i===Number.MAX_VALUE&&(i=uT.MAX_VALUE),{line:r,character:i}}n.create=e;function t(r){let i=r;return nt.objectLiteral(i)&&nt.uinteger(i.line)&&nt.uinteger(i.character)}n.is=t})(Ih||(Ih={}));var Us;(function(n){function e(r,i,o,s){if(nt.uinteger(r)&&nt.uinteger(i)&&nt.uinteger(o)&&nt.uinteger(s))return{start:Ih.create(r,i),end:Ih.create(o,s)};if(Ih.is(r)&&Ih.is(i))return{start:r,end:i};throw new Error(`Range#create called with invalid arguments[${r}, ${i}, ${o}, ${s}]`)}n.create=e;function t(r){let i=r;return nt.objectLiteral(i)&&Ih.is(i.start)&&Ih.is(i.end)}n.is=t})(Us||(Us={}));var dT;(function(n){function e(r,i){return{uri:r,range:i}}n.create=e;function t(r){let i=r;return nt.objectLiteral(i)&&Us.is(i.range)&&(nt.string(i.uri)||nt.undefined(i.uri))}n.is=t})(dT||(dT={}));var wY;(function(n){function e(r,i,o,s){return{targetUri:r,targetRange:i,targetSelectionRange:o,originSelectionRange:s}}n.create=e;function t(r){let i=r;return nt.objectLiteral(i)&&Us.is(i.targetRange)&&nt.string(i.targetUri)&&Us.is(i.targetSelectionRange)&&(Us.is(i.originSelectionRange)||nt.undefined(i.originSelectionRange))}n.is=t})(wY||(wY={}));var V$;(function(n){function e(r,i,o,s){return{red:r,green:i,blue:o,alpha:s}}n.create=e;function t(r){const i=r;return nt.objectLiteral(i)&&nt.numberRange(i.red,0,1)&&nt.numberRange(i.green,0,1)&&nt.numberRange(i.blue,0,1)&&nt.numberRange(i.alpha,0,1)}n.is=t})(V$||(V$={}));var CY;(function(n){function e(r,i){return{range:r,color:i}}n.create=e;function t(r){const i=r;return nt.objectLiteral(i)&&Us.is(i.range)&&V$.is(i.color)}n.is=t})(CY||(CY={}));var xY;(function(n){function e(r,i,o){return{label:r,textEdit:i,additionalTextEdits:o}}n.create=e;function t(r){const i=r;return nt.objectLiteral(i)&&nt.string(i.label)&&(nt.undefined(i.textEdit)||cg.is(i))&&(nt.undefined(i.additionalTextEdits)||nt.typedArray(i.additionalTextEdits,cg.is))}n.is=t})(xY||(xY={}));var EY;(function(n){n.Comment="comment",n.Imports="imports",n.Region="region"})(EY||(EY={}));var IY;(function(n){function e(r,i,o,s,a,c){const l={startLine:r,endLine:i};return nt.defined(o)&&(l.startCharacter=o),nt.defined(s)&&(l.endCharacter=s),nt.defined(a)&&(l.kind=a),nt.defined(c)&&(l.collapsedText=c),l}n.create=e;function t(r){const i=r;return nt.objectLiteral(i)&&nt.uinteger(i.startLine)&&nt.uinteger(i.startLine)&&(nt.undefined(i.startCharacter)||nt.uinteger(i.startCharacter))&&(nt.undefined(i.endCharacter)||nt.uinteger(i.endCharacter))&&(nt.undefined(i.kind)||nt.string(i.kind))}n.is=t})(IY||(IY={}));var W$;(function(n){function e(r,i){return{location:r,message:i}}n.create=e;function t(r){let i=r;return nt.defined(i)&&dT.is(i.location)&&nt.string(i.message)}n.is=t})(W$||(W$={}));var PY;(function(n){n.Error=1,n.Warning=2,n.Information=3,n.Hint=4})(PY||(PY={}));var kY;(function(n){n.Unnecessary=1,n.Deprecated=2})(kY||(kY={}));var TY;(function(n){function e(t){const r=t;return nt.objectLiteral(r)&&nt.string(r.href)}n.is=e})(TY||(TY={}));var hT;(function(n){function e(r,i,o,s,a,c){let l={range:r,message:i};return nt.defined(o)&&(l.severity=o),nt.defined(s)&&(l.code=s),nt.defined(a)&&(l.source=a),nt.defined(c)&&(l.relatedInformation=c),l}n.create=e;function t(r){var i;let o=r;return nt.defined(o)&&Us.is(o.range)&&nt.string(o.message)&&(nt.number(o.severity)||nt.undefined(o.severity))&&(nt.integer(o.code)||nt.string(o.code)||nt.undefined(o.code))&&(nt.undefined(o.codeDescription)||nt.string((i=o.codeDescription)===null||i===void 0?void 0:i.href))&&(nt.string(o.source)||nt.undefined(o.source))&&(nt.undefined(o.relatedInformation)||nt.typedArray(o.relatedInformation,W$.is))}n.is=t})(hT||(hT={}));var r_;(function(n){function e(r,i,...o){let s={title:r,command:i};return nt.defined(o)&&o.length>0&&(s.arguments=o),s}n.create=e;function t(r){let i=r;return nt.defined(i)&&nt.string(i.title)&&nt.string(i.command)}n.is=t})(r_||(r_={}));var cg;(function(n){function e(o,s){return{range:o,newText:s}}n.replace=e;function t(o,s){return{range:{start:o,end:o},newText:s}}n.insert=t;function r(o){return{range:o,newText:""}}n.del=r;function i(o){const s=o;return nt.objectLiteral(s)&&nt.string(s.newText)&&Us.is(s.range)}n.is=i})(cg||(cg={}));var gS;(function(n){function e(r,i,o){const s={label:r};return i!==void 0&&(s.needsConfirmation=i),o!==void 0&&(s.description=o),s}n.create=e;function t(r){const i=r;return nt.objectLiteral(i)&&nt.string(i.label)&&(nt.boolean(i.needsConfirmation)||i.needsConfirmation===void 0)&&(nt.string(i.description)||i.description===void 0)}n.is=t})(gS||(gS={}));var $c;(function(n){function e(t){const r=t;return nt.string(r)}n.is=e})($c||($c={}));var Cm;(function(n){function e(o,s,a){return{range:o,newText:s,annotationId:a}}n.replace=e;function t(o,s,a){return{range:{start:o,end:o},newText:s,annotationId:a}}n.insert=t;function r(o,s){return{range:o,newText:"",annotationId:s}}n.del=r;function i(o){const s=o;return cg.is(s)&&(gS.is(s.annotationId)||$c.is(s.annotationId))}n.is=i})(Cm||(Cm={}));var fT;(function(n){function e(r,i){return{textDocument:r,edits:i}}n.create=e;function t(r){let i=r;return nt.defined(i)&&pT.is(i.textDocument)&&Array.isArray(i.edits)}n.is=t})(fT||(fT={}));var _x;(function(n){function e(r,i,o){let s={kind:"create",uri:r};return i!==void 0&&(i.overwrite!==void 0||i.ignoreIfExists!==void 0)&&(s.options=i),o!==void 0&&(s.annotationId=o),s}n.create=e;function t(r){let i=r;return i&&i.kind==="create"&&nt.string(i.uri)&&(i.options===void 0||(i.options.overwrite===void 0||nt.boolean(i.options.overwrite))&&(i.options.ignoreIfExists===void 0||nt.boolean(i.options.ignoreIfExists)))&&(i.annotationId===void 0||$c.is(i.annotationId))}n.is=t})(_x||(_x={}));var wx;(function(n){function e(r,i,o,s){let a={kind:"rename",oldUri:r,newUri:i};return o!==void 0&&(o.overwrite!==void 0||o.ignoreIfExists!==void 0)&&(a.options=o),s!==void 0&&(a.annotationId=s),a}n.create=e;function t(r){let i=r;return i&&i.kind==="rename"&&nt.string(i.oldUri)&&nt.string(i.newUri)&&(i.options===void 0||(i.options.overwrite===void 0||nt.boolean(i.options.overwrite))&&(i.options.ignoreIfExists===void 0||nt.boolean(i.options.ignoreIfExists)))&&(i.annotationId===void 0||$c.is(i.annotationId))}n.is=t})(wx||(wx={}));var Cx;(function(n){function e(r,i,o){let s={kind:"delete",uri:r};return i!==void 0&&(i.recursive!==void 0||i.ignoreIfNotExists!==void 0)&&(s.options=i),o!==void 0&&(s.annotationId=o),s}n.create=e;function t(r){let i=r;return i&&i.kind==="delete"&&nt.string(i.uri)&&(i.options===void 0||(i.options.recursive===void 0||nt.boolean(i.options.recursive))&&(i.options.ignoreIfNotExists===void 0||nt.boolean(i.options.ignoreIfNotExists)))&&(i.annotationId===void 0||$c.is(i.annotationId))}n.is=t})(Cx||(Cx={}));var q$;(function(n){function e(t){let r=t;return r&&(r.changes!==void 0||r.documentChanges!==void 0)&&(r.documentChanges===void 0||r.documentChanges.every(i=>nt.string(i.kind)?_x.is(i)||wx.is(i)||Cx.is(i):fT.is(i)))}n.is=e})(q$||(q$={}));class HA{constructor(e,t){this.edits=e,this.changeAnnotations=t}insert(e,t,r){let i,o;if(r===void 0?i=cg.insert(e,t):$c.is(r)?(o=r,i=Cm.insert(e,t,r)):(this.assertChangeAnnotations(this.changeAnnotations),o=this.changeAnnotations.manage(r),i=Cm.insert(e,t,o)),this.edits.push(i),o!==void 0)return o}replace(e,t,r){let i,o;if(r===void 0?i=cg.replace(e,t):$c.is(r)?(o=r,i=Cm.replace(e,t,r)):(this.assertChangeAnnotations(this.changeAnnotations),o=this.changeAnnotations.manage(r),i=Cm.replace(e,t,o)),this.edits.push(i),o!==void 0)return o}delete(e,t){let r,i;if(t===void 0?r=cg.del(e):$c.is(t)?(i=t,r=Cm.del(e,t)):(this.assertChangeAnnotations(this.changeAnnotations),i=this.changeAnnotations.manage(t),r=Cm.del(e,i)),this.edits.push(r),i!==void 0)return i}add(e){this.edits.push(e)}all(){return this.edits}clear(){this.edits.splice(0,this.edits.length)}assertChangeAnnotations(e){if(e===void 0)throw new Error("Text edit change is not configured to manage change annotations.")}}class r_e{constructor(e){this._annotations=e===void 0?Object.create(null):e,this._counter=0,this._size=0}all(){return this._annotations}get size(){return this._size}manage(e,t){let r;if($c.is(e)?r=e:(r=this.nextId(),t=e),this._annotations[r]!==void 0)throw new Error(`Id ${r} is already in use.`);if(t===void 0)throw new Error(`No annotation provided for id ${r}`);return this._annotations[r]=t,this._size++,r}nextId(){return this._counter++,this._counter.toString()}}class lQt{constructor(e){this._textEditChanges=Object.create(null),e!==void 0?(this._workspaceEdit=e,e.documentChanges?(this._changeAnnotations=new r_e(e.changeAnnotations),e.changeAnnotations=this._changeAnnotations.all(),e.documentChanges.forEach(t=>{if(fT.is(t)){const r=new HA(t.edits,this._changeAnnotations);this._textEditChanges[t.textDocument.uri]=r}})):e.changes&&Object.keys(e.changes).forEach(t=>{const r=new HA(e.changes[t]);this._textEditChanges[t]=r})):this._workspaceEdit={}}get edit(){return this.initDocumentChanges(),this._changeAnnotations!==void 0&&(this._changeAnnotations.size===0?this._workspaceEdit.changeAnnotations=void 0:this._workspaceEdit.changeAnnotations=this._changeAnnotations.all()),this._workspaceEdit}getTextEditChange(e){if(pT.is(e)){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");const t={uri:e.uri,version:e.version};let r=this._textEditChanges[t.uri];if(!r){const i=[],o={textDocument:t,edits:i};this._workspaceEdit.documentChanges.push(o),r=new HA(i,this._changeAnnotations),this._textEditChanges[t.uri]=r}return r}else{if(this.initChanges(),this._workspaceEdit.changes===void 0)throw new Error("Workspace edit is not configured for normal text edit changes.");let t=this._textEditChanges[e];if(!t){let r=[];this._workspaceEdit.changes[e]=r,t=new HA(r),this._textEditChanges[e]=t}return t}}initDocumentChanges(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._changeAnnotations=new r_e,this._workspaceEdit.documentChanges=[],this._workspaceEdit.changeAnnotations=this._changeAnnotations.all())}initChanges(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._workspaceEdit.changes=Object.create(null))}createFile(e,t,r){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");let i;gS.is(t)||$c.is(t)?i=t:r=t;let o,s;if(i===void 0?o=_x.create(e,r):(s=$c.is(i)?i:this._changeAnnotations.manage(i),o=_x.create(e,r,s)),this._workspaceEdit.documentChanges.push(o),s!==void 0)return s}renameFile(e,t,r,i){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");let o;gS.is(r)||$c.is(r)?o=r:i=r;let s,a;if(o===void 0?s=wx.create(e,t,i):(a=$c.is(o)?o:this._changeAnnotations.manage(o),s=wx.create(e,t,i,a)),this._workspaceEdit.documentChanges.push(s),a!==void 0)return a}deleteFile(e,t,r){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");let i;gS.is(t)||$c.is(t)?i=t:r=t;let o,s;if(i===void 0?o=Cx.create(e,r):(s=$c.is(i)?i:this._changeAnnotations.manage(i),o=Cx.create(e,r,s)),this._workspaceEdit.documentChanges.push(o),s!==void 0)return s}}var DY;(function(n){function e(r){return{uri:r}}n.create=e;function t(r){let i=r;return nt.defined(i)&&nt.string(i.uri)}n.is=t})(DY||(DY={}));var RY;(function(n){function e(r,i){return{uri:r,version:i}}n.create=e;function t(r){let i=r;return nt.defined(i)&&nt.string(i.uri)&&nt.integer(i.version)}n.is=t})(RY||(RY={}));var pT;(function(n){function e(r,i){return{uri:r,version:i}}n.create=e;function t(r){let i=r;return nt.defined(i)&&nt.string(i.uri)&&(i.version===null||nt.integer(i.version))}n.is=t})(pT||(pT={}));var AY;(function(n){function e(r,i,o,s){return{uri:r,languageId:i,version:o,text:s}}n.create=e;function t(r){let i=r;return nt.defined(i)&&nt.string(i.uri)&&nt.string(i.languageId)&&nt.integer(i.version)&&nt.string(i.text)}n.is=t})(AY||(AY={}));var K$;(function(n){n.PlainText="plaintext",n.Markdown="markdown";function e(t){const r=t;return r===n.PlainText||r===n.Markdown}n.is=e})(K$||(K$={}));var xx;(function(n){function e(t){const r=t;return nt.objectLiteral(t)&&K$.is(r.kind)&&nt.string(r.value)}n.is=e})(xx||(xx={}));var OY;(function(n){n.Text=1,n.Method=2,n.Function=3,n.Constructor=4,n.Field=5,n.Variable=6,n.Class=7,n.Interface=8,n.Module=9,n.Property=10,n.Unit=11,n.Value=12,n.Enum=13,n.Keyword=14,n.Snippet=15,n.Color=16,n.File=17,n.Reference=18,n.Folder=19,n.EnumMember=20,n.Constant=21,n.Struct=22,n.Event=23,n.Operator=24,n.TypeParameter=25})(OY||(OY={}));var MY;(function(n){n.PlainText=1,n.Snippet=2})(MY||(MY={}));var $Y;(function(n){n.Deprecated=1})($Y||($Y={}));var LY;(function(n){function e(r,i,o){return{newText:r,insert:i,replace:o}}n.create=e;function t(r){const i=r;return i&&nt.string(i.newText)&&Us.is(i.insert)&&Us.is(i.replace)}n.is=t})(LY||(LY={}));var NY;(function(n){n.asIs=1,n.adjustIndentation=2})(NY||(NY={}));var FY;(function(n){function e(t){const r=t;return r&&(nt.string(r.detail)||r.detail===void 0)&&(nt.string(r.description)||r.description===void 0)}n.is=e})(FY||(FY={}));var jY;(function(n){function e(t){return{label:t}}n.create=e})(jY||(jY={}));var BY;(function(n){function e(t,r){return{items:t||[],isIncomplete:!!r}}n.create=e})(BY||(BY={}));var gT;(function(n){function e(r){return r.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}n.fromPlainText=e;function t(r){const i=r;return nt.string(i)||nt.objectLiteral(i)&&nt.string(i.language)&&nt.string(i.value)}n.is=t})(gT||(gT={}));var HY;(function(n){function e(t){let r=t;return!!r&&nt.objectLiteral(r)&&(xx.is(r.contents)||gT.is(r.contents)||nt.typedArray(r.contents,gT.is))&&(t.range===void 0||Us.is(t.range))}n.is=e})(HY||(HY={}));var UY;(function(n){function e(t,r){return r?{label:t,documentation:r}:{label:t}}n.create=e})(UY||(UY={}));var zY;(function(n){function e(t,r,...i){let o={label:t};return nt.defined(r)&&(o.documentation=r),nt.defined(i)?o.parameters=i:o.parameters=[],o}n.create=e})(zY||(zY={}));var VY;(function(n){n.Text=1,n.Read=2,n.Write=3})(VY||(VY={}));var WY;(function(n){function e(t,r){let i={range:t};return nt.number(r)&&(i.kind=r),i}n.create=e})(WY||(WY={}));var qY;(function(n){n.File=1,n.Module=2,n.Namespace=3,n.Package=4,n.Class=5,n.Method=6,n.Property=7,n.Field=8,n.Constructor=9,n.Enum=10,n.Interface=11,n.Function=12,n.Variable=13,n.Constant=14,n.String=15,n.Number=16,n.Boolean=17,n.Array=18,n.Object=19,n.Key=20,n.Null=21,n.EnumMember=22,n.Struct=23,n.Event=24,n.Operator=25,n.TypeParameter=26})(qY||(qY={}));var KY;(function(n){n.Deprecated=1})(KY||(KY={}));var GY;(function(n){function e(t,r,i,o,s){let a={name:t,kind:r,location:{uri:o,range:i}};return s&&(a.containerName=s),a}n.create=e})(GY||(GY={}));var ZY;(function(n){function e(t,r,i,o){return o!==void 0?{name:t,kind:r,location:{uri:i,range:o}}:{name:t,kind:r,location:{uri:i}}}n.create=e})(ZY||(ZY={}));var XY;(function(n){function e(r,i,o,s,a,c){let l={name:r,detail:i,kind:o,range:s,selectionRange:a};return c!==void 0&&(l.children=c),l}n.create=e;function t(r){let i=r;return i&&nt.string(i.name)&&nt.number(i.kind)&&Us.is(i.range)&&Us.is(i.selectionRange)&&(i.detail===void 0||nt.string(i.detail))&&(i.deprecated===void 0||nt.boolean(i.deprecated))&&(i.children===void 0||Array.isArray(i.children))&&(i.tags===void 0||Array.isArray(i.tags))}n.is=t})(XY||(XY={}));var YY;(function(n){n.Empty="",n.QuickFix="quickfix",n.Refactor="refactor",n.RefactorExtract="refactor.extract",n.RefactorInline="refactor.inline",n.RefactorRewrite="refactor.rewrite",n.Source="source",n.SourceOrganizeImports="source.organizeImports",n.SourceFixAll="source.fixAll"})(YY||(YY={}));var mT;(function(n){n.Invoked=1,n.Automatic=2})(mT||(mT={}));var JY;(function(n){function e(r,i,o){let s={diagnostics:r};return i!=null&&(s.only=i),o!=null&&(s.triggerKind=o),s}n.create=e;function t(r){let i=r;return nt.defined(i)&&nt.typedArray(i.diagnostics,hT.is)&&(i.only===void 0||nt.typedArray(i.only,nt.string))&&(i.triggerKind===void 0||i.triggerKind===mT.Invoked||i.triggerKind===mT.Automatic)}n.is=t})(JY||(JY={}));var QY;(function(n){function e(r,i,o){let s={title:r},a=!0;return typeof i=="string"?(a=!1,s.kind=i):r_.is(i)?s.command=i:s.edit=i,a&&o!==void 0&&(s.kind=o),s}n.create=e;function t(r){let i=r;return i&&nt.string(i.title)&&(i.diagnostics===void 0||nt.typedArray(i.diagnostics,hT.is))&&(i.kind===void 0||nt.string(i.kind))&&(i.edit!==void 0||i.command!==void 0)&&(i.command===void 0||r_.is(i.command))&&(i.isPreferred===void 0||nt.boolean(i.isPreferred))&&(i.edit===void 0||q$.is(i.edit))}n.is=t})(QY||(QY={}));var eJ;(function(n){function e(r,i){let o={range:r};return nt.defined(i)&&(o.data=i),o}n.create=e;function t(r){let i=r;return nt.defined(i)&&Us.is(i.range)&&(nt.undefined(i.command)||r_.is(i.command))}n.is=t})(eJ||(eJ={}));var tJ;(function(n){function e(r,i){return{tabSize:r,insertSpaces:i}}n.create=e;function t(r){let i=r;return nt.defined(i)&&nt.uinteger(i.tabSize)&&nt.boolean(i.insertSpaces)}n.is=t})(tJ||(tJ={}));var nJ;(function(n){function e(r,i,o){return{range:r,target:i,data:o}}n.create=e;function t(r){let i=r;return nt.defined(i)&&Us.is(i.range)&&(nt.undefined(i.target)||nt.string(i.target))}n.is=t})(nJ||(nJ={}));var rJ;(function(n){function e(r,i){return{range:r,parent:i}}n.create=e;function t(r){let i=r;return nt.objectLiteral(i)&&Us.is(i.range)&&(i.parent===void 0||n.is(i.parent))}n.is=t})(rJ||(rJ={}));var iJ;(function(n){n.namespace="namespace",n.type="type",n.class="class",n.enum="enum",n.interface="interface",n.struct="struct",n.typeParameter="typeParameter",n.parameter="parameter",n.variable="variable",n.property="property",n.enumMember="enumMember",n.event="event",n.function="function",n.method="method",n.macro="macro",n.keyword="keyword",n.modifier="modifier",n.comment="comment",n.string="string",n.number="number",n.regexp="regexp",n.operator="operator",n.decorator="decorator"})(iJ||(iJ={}));var oJ;(function(n){n.declaration="declaration",n.definition="definition",n.readonly="readonly",n.static="static",n.deprecated="deprecated",n.abstract="abstract",n.async="async",n.modification="modification",n.documentation="documentation",n.defaultLibrary="defaultLibrary"})(oJ||(oJ={}));var sJ;(function(n){function e(t){const r=t;return nt.objectLiteral(r)&&(r.resultId===void 0||typeof r.resultId=="string")&&Array.isArray(r.data)&&(r.data.length===0||typeof r.data[0]=="number")}n.is=e})(sJ||(sJ={}));var aJ;(function(n){function e(r,i){return{range:r,text:i}}n.create=e;function t(r){const i=r;return i!=null&&Us.is(i.range)&&nt.string(i.text)}n.is=t})(aJ||(aJ={}));var cJ;(function(n){function e(r,i,o){return{range:r,variableName:i,caseSensitiveLookup:o}}n.create=e;function t(r){const i=r;return i!=null&&Us.is(i.range)&&nt.boolean(i.caseSensitiveLookup)&&(nt.string(i.variableName)||i.variableName===void 0)}n.is=t})(cJ||(cJ={}));var lJ;(function(n){function e(r,i){return{range:r,expression:i}}n.create=e;function t(r){const i=r;return i!=null&&Us.is(i.range)&&(nt.string(i.expression)||i.expression===void 0)}n.is=t})(lJ||(lJ={}));var uJ;(function(n){function e(r,i){return{frameId:r,stoppedLocation:i}}n.create=e;function t(r){const i=r;return nt.defined(i)&&Us.is(r.stoppedLocation)}n.is=t})(uJ||(uJ={}));var G$;(function(n){n.Type=1,n.Parameter=2;function e(t){return t===1||t===2}n.is=e})(G$||(G$={}));var Z$;(function(n){function e(r){return{value:r}}n.create=e;function t(r){const i=r;return nt.objectLiteral(i)&&(i.tooltip===void 0||nt.string(i.tooltip)||xx.is(i.tooltip))&&(i.location===void 0||dT.is(i.location))&&(i.command===void 0||r_.is(i.command))}n.is=t})(Z$||(Z$={}));var dJ;(function(n){function e(r,i,o){const s={position:r,label:i};return o!==void 0&&(s.kind=o),s}n.create=e;function t(r){const i=r;return nt.objectLiteral(i)&&Ih.is(i.position)&&(nt.string(i.label)||nt.typedArray(i.label,Z$.is))&&(i.kind===void 0||G$.is(i.kind))&&i.textEdits===void 0||nt.typedArray(i.textEdits,cg.is)&&(i.tooltip===void 0||nt.string(i.tooltip)||xx.is(i.tooltip))&&(i.paddingLeft===void 0||nt.boolean(i.paddingLeft))&&(i.paddingRight===void 0||nt.boolean(i.paddingRight))}n.is=t})(dJ||(dJ={}));var hJ;(function(n){function e(t){return{kind:"snippet",value:t}}n.createSnippet=e})(hJ||(hJ={}));var fJ;(function(n){function e(t,r,i,o){return{insertText:t,filterText:r,range:i,command:o}}n.create=e})(fJ||(fJ={}));var pJ;(function(n){function e(t){return{items:t}}n.create=e})(pJ||(pJ={}));var gJ;(function(n){n.Invoked=0,n.Automatic=1})(gJ||(gJ={}));var mJ;(function(n){function e(t,r){return{range:t,text:r}}n.create=e})(mJ||(mJ={}));var vJ;(function(n){function e(t,r){return{triggerKind:t,selectedCompletionInfo:r}}n.create=e})(vJ||(vJ={}));var yJ;(function(n){function e(t){const r=t;return nt.objectLiteral(r)&&z$.is(r.uri)&&nt.string(r.name)}n.is=e})(yJ||(yJ={}));const uQt=[`
`,`\r
`,"\r"];var bJ;(function(n){function e(o,s,a,c){return new dQt(o,s,a,c)}n.create=e;function t(o){let s=o;return!!(nt.defined(s)&&nt.string(s.uri)&&(nt.undefined(s.languageId)||nt.string(s.languageId))&&nt.uinteger(s.lineCount)&&nt.func(s.getText)&&nt.func(s.positionAt)&&nt.func(s.offsetAt))}n.is=t;function r(o,s){let a=o.getText(),c=i(s,(u,d)=>{let h=u.range.start.line-d.range.start.line;return h===0?u.range.start.character-d.range.start.character:h}),l=a.length;for(let u=c.length-1;u>=0;u--){let d=c[u],h=o.offsetAt(d.range.start),f=o.offsetAt(d.range.end);if(f<=l)a=a.substring(0,h)+d.newText+a.substring(f,a.length);else throw new Error("Overlapping edit");l=h}return a}n.applyEdits=r;function i(o,s){if(o.length<=1)return o;const a=o.length/2|0,c=o.slice(0,a),l=o.slice(a);i(c,s),i(l,s);let u=0,d=0,h=0;for(;u<c.length&&d<l.length;)s(c[u],l[d])<=0?o[h++]=c[u++]:o[h++]=l[d++];for(;u<c.length;)o[h++]=c[u++];for(;d<l.length;)o[h++]=l[d++];return o}})(bJ||(bJ={}));class dQt{constructor(e,t,r,i){this._uri=e,this._languageId=t,this._version=r,this._content=i,this._lineOffsets=void 0}get uri(){return this._uri}get languageId(){return this._languageId}get version(){return this._version}getText(e){if(e){let t=this.offsetAt(e.start),r=this.offsetAt(e.end);return this._content.substring(t,r)}return this._content}update(e,t){this._content=e.text,this._version=t,this._lineOffsets=void 0}getLineOffsets(){if(this._lineOffsets===void 0){let e=[],t=this._content,r=!0;for(let i=0;i<t.length;i++){r&&(e.push(i),r=!1);let o=t.charAt(i);r=o==="\r"||o===`
`,o==="\r"&&i+1<t.length&&t.charAt(i+1)===`
`&&i++}r&&t.length>0&&e.push(t.length),this._lineOffsets=e}return this._lineOffsets}positionAt(e){e=Math.max(Math.min(e,this._content.length),0);let t=this.getLineOffsets(),r=0,i=t.length;if(i===0)return Ih.create(0,e);for(;r<i;){let s=Math.floor((r+i)/2);t[s]>e?i=s:r=s+1}let o=r-1;return Ih.create(o,e-t[o])}offsetAt(e){let t=this.getLineOffsets();if(e.line>=t.length)return this._content.length;if(e.line<0)return 0;let r=t[e.line],i=e.line+1<t.length?t[e.line+1]:this._content.length;return Math.max(Math.min(r+e.character,i),r)}get lineCount(){return this.getLineOffsets().length}}var nt;(function(n){const e=Object.prototype.toString;function t(f){return typeof f<"u"}n.defined=t;function r(f){return typeof f>"u"}n.undefined=r;function i(f){return f===!0||f===!1}n.boolean=i;function o(f){return e.call(f)==="[object String]"}n.string=o;function s(f){return e.call(f)==="[object Number]"}n.number=s;function a(f,p,g){return e.call(f)==="[object Number]"&&p<=f&&f<=g}n.numberRange=a;function c(f){return e.call(f)==="[object Number]"&&-2147483648<=f&&f<=2147483647}n.integer=c;function l(f){return e.call(f)==="[object Number]"&&0<=f&&f<=2147483647}n.uinteger=l;function u(f){return e.call(f)==="[object Function]"}n.func=u;function d(f){return f!==null&&typeof f=="object"}n.objectLiteral=d;function h(f,p){return Array.isArray(f)&&f.every(p)}n.typedArray=h})(nt||(nt={}));const hQt=Object.freeze(Object.defineProperty({__proto__:null,get AnnotatedTextEdit(){return Cm},get ChangeAnnotation(){return gS},get ChangeAnnotationIdentifier(){return $c},get CodeAction(){return QY},get CodeActionContext(){return JY},get CodeActionKind(){return YY},get CodeActionTriggerKind(){return mT},get CodeDescription(){return TY},get CodeLens(){return eJ},get Color(){return V$},get ColorInformation(){return CY},get ColorPresentation(){return xY},get Command(){return r_},get CompletionItem(){return jY},get CompletionItemKind(){return OY},get CompletionItemLabelDetails(){return FY},get CompletionItemTag(){return $Y},get CompletionList(){return BY},get CreateFile(){return _x},get DeleteFile(){return Cx},get Diagnostic(){return hT},get DiagnosticRelatedInformation(){return W$},get DiagnosticSeverity(){return PY},get DiagnosticTag(){return kY},get DocumentHighlight(){return WY},get DocumentHighlightKind(){return VY},get DocumentLink(){return nJ},get DocumentSymbol(){return XY},get DocumentUri(){return SY},EOL:uQt,get FoldingRange(){return IY},get FoldingRangeKind(){return EY},get FormattingOptions(){return tJ},get Hover(){return HY},get InlayHint(){return dJ},get InlayHintKind(){return G$},get InlayHintLabelPart(){return Z$},get InlineCompletionContext(){return vJ},get InlineCompletionItem(){return fJ},get InlineCompletionList(){return pJ},get InlineCompletionTriggerKind(){return gJ},get InlineValueContext(){return uJ},get InlineValueEvaluatableExpression(){return lJ},get InlineValueText(){return aJ},get InlineValueVariableLookup(){return cJ},get InsertReplaceEdit(){return LY},get InsertTextFormat(){return MY},get InsertTextMode(){return NY},get Location(){return dT},get LocationLink(){return wY},get MarkedString(){return gT},get MarkupContent(){return xx},get MarkupKind(){return K$},get OptionalVersionedTextDocumentIdentifier(){return pT},get ParameterInformation(){return UY},get Position(){return Ih},get Range(){return Us},get RenameFile(){return wx},get SelectedCompletionInfo(){return mJ},get SelectionRange(){return rJ},get SemanticTokenModifiers(){return oJ},get SemanticTokenTypes(){return iJ},get SemanticTokens(){return sJ},get SignatureInformation(){return zY},get StringValue(){return hJ},get SymbolInformation(){return GY},get SymbolKind(){return qY},get SymbolTag(){return KY},get TextDocument(){return bJ},get TextDocumentEdit(){return fT},get TextDocumentIdentifier(){return DY},get TextDocumentItem(){return AY},get TextEdit(){return cg},get URI(){return z$},get VersionedTextDocumentIdentifier(){return RY},WorkspaceChange:lQt,get WorkspaceEdit(){return q$},get WorkspaceFolder(){return yJ},get WorkspaceSymbol(){return ZY},get integer(){return _Y},get uinteger(){return uT}},Symbol.toStringTag,{value:"Module"})),use=pee(hQt);var gi={};Object.defineProperty(gi,"__esModule",{value:!0});gi.ProtocolNotificationType=gi.ProtocolNotificationType0=gi.ProtocolRequestType=gi.ProtocolRequestType0=gi.RegistrationType=gi.MessageDirection=void 0;const Ex=S_;var i_e;(function(n){n.clientToServer="clientToServer",n.serverToClient="serverToClient",n.both="both"})(i_e||(gi.MessageDirection=i_e={}));class fQt{constructor(e){this.method=e}}gi.RegistrationType=fQt;class pQt extends Ex.RequestType0{constructor(e){super(e)}}gi.ProtocolRequestType0=pQt;class gQt extends Ex.RequestType{constructor(e){super(e,Ex.ParameterStructures.byName)}}gi.ProtocolRequestType=gQt;class mQt extends Ex.NotificationType0{constructor(e){super(e)}}gi.ProtocolNotificationType0=mQt;class vQt extends Ex.NotificationType{constructor(e){super(e,Ex.ParameterStructures.byName)}}gi.ProtocolNotificationType=vQt;var kBe={},Ms={};Object.defineProperty(Ms,"__esModule",{value:!0});Ms.objectLiteral=Ms.typedArray=Ms.stringArray=Ms.array=Ms.func=Ms.error=Ms.number=Ms.string=Ms.boolean=void 0;function yQt(n){return n===!0||n===!1}Ms.boolean=yQt;function TBe(n){return typeof n=="string"||n instanceof String}Ms.string=TBe;function bQt(n){return typeof n=="number"||n instanceof Number}Ms.number=bQt;function SQt(n){return n instanceof Error}Ms.error=SQt;function _Qt(n){return typeof n=="function"}Ms.func=_Qt;function DBe(n){return Array.isArray(n)}Ms.array=DBe;function wQt(n){return DBe(n)&&n.every(e=>TBe(e))}Ms.stringArray=wQt;function CQt(n,e){return Array.isArray(n)&&n.every(e)}Ms.typedArray=CQt;function xQt(n){return n!==null&&typeof n=="object"}Ms.objectLiteral=xQt;var bF={};Object.defineProperty(bF,"__esModule",{value:!0});bF.ImplementationRequest=void 0;const o_e=gi;var s_e;(function(n){n.method="textDocument/implementation",n.messageDirection=o_e.MessageDirection.clientToServer,n.type=new o_e.ProtocolRequestType(n.method)})(s_e||(bF.ImplementationRequest=s_e={}));var SF={};Object.defineProperty(SF,"__esModule",{value:!0});SF.TypeDefinitionRequest=void 0;const a_e=gi;var c_e;(function(n){n.method="textDocument/typeDefinition",n.messageDirection=a_e.MessageDirection.clientToServer,n.type=new a_e.ProtocolRequestType(n.method)})(c_e||(SF.TypeDefinitionRequest=c_e={}));var Ix={};Object.defineProperty(Ix,"__esModule",{value:!0});Ix.DidChangeWorkspaceFoldersNotification=Ix.WorkspaceFoldersRequest=void 0;const X$=gi;var l_e;(function(n){n.method="workspace/workspaceFolders",n.messageDirection=X$.MessageDirection.serverToClient,n.type=new X$.ProtocolRequestType0(n.method)})(l_e||(Ix.WorkspaceFoldersRequest=l_e={}));var u_e;(function(n){n.method="workspace/didChangeWorkspaceFolders",n.messageDirection=X$.MessageDirection.clientToServer,n.type=new X$.ProtocolNotificationType(n.method)})(u_e||(Ix.DidChangeWorkspaceFoldersNotification=u_e={}));var _F={};Object.defineProperty(_F,"__esModule",{value:!0});_F.ConfigurationRequest=void 0;const d_e=gi;var h_e;(function(n){n.method="workspace/configuration",n.messageDirection=d_e.MessageDirection.serverToClient,n.type=new d_e.ProtocolRequestType(n.method)})(h_e||(_F.ConfigurationRequest=h_e={}));var Px={};Object.defineProperty(Px,"__esModule",{value:!0});Px.ColorPresentationRequest=Px.DocumentColorRequest=void 0;const Y$=gi;var f_e;(function(n){n.method="textDocument/documentColor",n.messageDirection=Y$.MessageDirection.clientToServer,n.type=new Y$.ProtocolRequestType(n.method)})(f_e||(Px.DocumentColorRequest=f_e={}));var p_e;(function(n){n.method="textDocument/colorPresentation",n.messageDirection=Y$.MessageDirection.clientToServer,n.type=new Y$.ProtocolRequestType(n.method)})(p_e||(Px.ColorPresentationRequest=p_e={}));var kx={};Object.defineProperty(kx,"__esModule",{value:!0});kx.FoldingRangeRefreshRequest=kx.FoldingRangeRequest=void 0;const J$=gi;var g_e;(function(n){n.method="textDocument/foldingRange",n.messageDirection=J$.MessageDirection.clientToServer,n.type=new J$.ProtocolRequestType(n.method)})(g_e||(kx.FoldingRangeRequest=g_e={}));var m_e;(function(n){n.method="workspace/foldingRange/refresh",n.messageDirection=J$.MessageDirection.serverToClient,n.type=new J$.ProtocolRequestType0(n.method)})(m_e||(kx.FoldingRangeRefreshRequest=m_e={}));var wF={};Object.defineProperty(wF,"__esModule",{value:!0});wF.DeclarationRequest=void 0;const v_e=gi;var y_e;(function(n){n.method="textDocument/declaration",n.messageDirection=v_e.MessageDirection.clientToServer,n.type=new v_e.ProtocolRequestType(n.method)})(y_e||(wF.DeclarationRequest=y_e={}));var CF={};Object.defineProperty(CF,"__esModule",{value:!0});CF.SelectionRangeRequest=void 0;const b_e=gi;var S_e;(function(n){n.method="textDocument/selectionRange",n.messageDirection=b_e.MessageDirection.clientToServer,n.type=new b_e.ProtocolRequestType(n.method)})(S_e||(CF.SelectionRangeRequest=S_e={}));var uy={};Object.defineProperty(uy,"__esModule",{value:!0});uy.WorkDoneProgressCancelNotification=uy.WorkDoneProgressCreateRequest=uy.WorkDoneProgress=void 0;const EQt=S_,Q$=gi;var __e;(function(n){n.type=new EQt.ProgressType;function e(t){return t===n.type}n.is=e})(__e||(uy.WorkDoneProgress=__e={}));var w_e;(function(n){n.method="window/workDoneProgress/create",n.messageDirection=Q$.MessageDirection.serverToClient,n.type=new Q$.ProtocolRequestType(n.method)})(w_e||(uy.WorkDoneProgressCreateRequest=w_e={}));var C_e;(function(n){n.method="window/workDoneProgress/cancel",n.messageDirection=Q$.MessageDirection.clientToServer,n.type=new Q$.ProtocolNotificationType(n.method)})(C_e||(uy.WorkDoneProgressCancelNotification=C_e={}));var dy={};Object.defineProperty(dy,"__esModule",{value:!0});dy.CallHierarchyOutgoingCallsRequest=dy.CallHierarchyIncomingCallsRequest=dy.CallHierarchyPrepareRequest=void 0;const Tx=gi;var x_e;(function(n){n.method="textDocument/prepareCallHierarchy",n.messageDirection=Tx.MessageDirection.clientToServer,n.type=new Tx.ProtocolRequestType(n.method)})(x_e||(dy.CallHierarchyPrepareRequest=x_e={}));var E_e;(function(n){n.method="callHierarchy/incomingCalls",n.messageDirection=Tx.MessageDirection.clientToServer,n.type=new Tx.ProtocolRequestType(n.method)})(E_e||(dy.CallHierarchyIncomingCallsRequest=E_e={}));var I_e;(function(n){n.method="callHierarchy/outgoingCalls",n.messageDirection=Tx.MessageDirection.clientToServer,n.type=new Tx.ProtocolRequestType(n.method)})(I_e||(dy.CallHierarchyOutgoingCallsRequest=I_e={}));var Ru={};Object.defineProperty(Ru,"__esModule",{value:!0});Ru.SemanticTokensRefreshRequest=Ru.SemanticTokensRangeRequest=Ru.SemanticTokensDeltaRequest=Ru.SemanticTokensRequest=Ru.SemanticTokensRegistrationType=Ru.TokenFormat=void 0;const mv=gi;var P_e;(function(n){n.Relative="relative"})(P_e||(Ru.TokenFormat=P_e={}));var vT;(function(n){n.method="textDocument/semanticTokens",n.type=new mv.RegistrationType(n.method)})(vT||(Ru.SemanticTokensRegistrationType=vT={}));var k_e;(function(n){n.method="textDocument/semanticTokens/full",n.messageDirection=mv.MessageDirection.clientToServer,n.type=new mv.ProtocolRequestType(n.method),n.registrationMethod=vT.method})(k_e||(Ru.SemanticTokensRequest=k_e={}));var T_e;(function(n){n.method="textDocument/semanticTokens/full/delta",n.messageDirection=mv.MessageDirection.clientToServer,n.type=new mv.ProtocolRequestType(n.method),n.registrationMethod=vT.method})(T_e||(Ru.SemanticTokensDeltaRequest=T_e={}));var D_e;(function(n){n.method="textDocument/semanticTokens/range",n.messageDirection=mv.MessageDirection.clientToServer,n.type=new mv.ProtocolRequestType(n.method),n.registrationMethod=vT.method})(D_e||(Ru.SemanticTokensRangeRequest=D_e={}));var R_e;(function(n){n.method="workspace/semanticTokens/refresh",n.messageDirection=mv.MessageDirection.serverToClient,n.type=new mv.ProtocolRequestType0(n.method)})(R_e||(Ru.SemanticTokensRefreshRequest=R_e={}));var xF={};Object.defineProperty(xF,"__esModule",{value:!0});xF.ShowDocumentRequest=void 0;const A_e=gi;var O_e;(function(n){n.method="window/showDocument",n.messageDirection=A_e.MessageDirection.serverToClient,n.type=new A_e.ProtocolRequestType(n.method)})(O_e||(xF.ShowDocumentRequest=O_e={}));var EF={};Object.defineProperty(EF,"__esModule",{value:!0});EF.LinkedEditingRangeRequest=void 0;const M_e=gi;var $_e;(function(n){n.method="textDocument/linkedEditingRange",n.messageDirection=M_e.MessageDirection.clientToServer,n.type=new M_e.ProtocolRequestType(n.method)})($_e||(EF.LinkedEditingRangeRequest=$_e={}));var pl={};Object.defineProperty(pl,"__esModule",{value:!0});pl.WillDeleteFilesRequest=pl.DidDeleteFilesNotification=pl.DidRenameFilesNotification=pl.WillRenameFilesRequest=pl.DidCreateFilesNotification=pl.WillCreateFilesRequest=pl.FileOperationPatternKind=void 0;const Wh=gi;var L_e;(function(n){n.file="file",n.folder="folder"})(L_e||(pl.FileOperationPatternKind=L_e={}));var N_e;(function(n){n.method="workspace/willCreateFiles",n.messageDirection=Wh.MessageDirection.clientToServer,n.type=new Wh.ProtocolRequestType(n.method)})(N_e||(pl.WillCreateFilesRequest=N_e={}));var F_e;(function(n){n.method="workspace/didCreateFiles",n.messageDirection=Wh.MessageDirection.clientToServer,n.type=new Wh.ProtocolNotificationType(n.method)})(F_e||(pl.DidCreateFilesNotification=F_e={}));var j_e;(function(n){n.method="workspace/willRenameFiles",n.messageDirection=Wh.MessageDirection.clientToServer,n.type=new Wh.ProtocolRequestType(n.method)})(j_e||(pl.WillRenameFilesRequest=j_e={}));var B_e;(function(n){n.method="workspace/didRenameFiles",n.messageDirection=Wh.MessageDirection.clientToServer,n.type=new Wh.ProtocolNotificationType(n.method)})(B_e||(pl.DidRenameFilesNotification=B_e={}));var H_e;(function(n){n.method="workspace/didDeleteFiles",n.messageDirection=Wh.MessageDirection.clientToServer,n.type=new Wh.ProtocolNotificationType(n.method)})(H_e||(pl.DidDeleteFilesNotification=H_e={}));var U_e;(function(n){n.method="workspace/willDeleteFiles",n.messageDirection=Wh.MessageDirection.clientToServer,n.type=new Wh.ProtocolRequestType(n.method)})(U_e||(pl.WillDeleteFilesRequest=U_e={}));var hy={};Object.defineProperty(hy,"__esModule",{value:!0});hy.MonikerRequest=hy.MonikerKind=hy.UniquenessLevel=void 0;const z_e=gi;var V_e;(function(n){n.document="document",n.project="project",n.group="group",n.scheme="scheme",n.global="global"})(V_e||(hy.UniquenessLevel=V_e={}));var W_e;(function(n){n.$import="import",n.$export="export",n.local="local"})(W_e||(hy.MonikerKind=W_e={}));var q_e;(function(n){n.method="textDocument/moniker",n.messageDirection=z_e.MessageDirection.clientToServer,n.type=new z_e.ProtocolRequestType(n.method)})(q_e||(hy.MonikerRequest=q_e={}));var fy={};Object.defineProperty(fy,"__esModule",{value:!0});fy.TypeHierarchySubtypesRequest=fy.TypeHierarchySupertypesRequest=fy.TypeHierarchyPrepareRequest=void 0;const Dx=gi;var K_e;(function(n){n.method="textDocument/prepareTypeHierarchy",n.messageDirection=Dx.MessageDirection.clientToServer,n.type=new Dx.ProtocolRequestType(n.method)})(K_e||(fy.TypeHierarchyPrepareRequest=K_e={}));var G_e;(function(n){n.method="typeHierarchy/supertypes",n.messageDirection=Dx.MessageDirection.clientToServer,n.type=new Dx.ProtocolRequestType(n.method)})(G_e||(fy.TypeHierarchySupertypesRequest=G_e={}));var Z_e;(function(n){n.method="typeHierarchy/subtypes",n.messageDirection=Dx.MessageDirection.clientToServer,n.type=new Dx.ProtocolRequestType(n.method)})(Z_e||(fy.TypeHierarchySubtypesRequest=Z_e={}));var Rx={};Object.defineProperty(Rx,"__esModule",{value:!0});Rx.InlineValueRefreshRequest=Rx.InlineValueRequest=void 0;const eL=gi;var X_e;(function(n){n.method="textDocument/inlineValue",n.messageDirection=eL.MessageDirection.clientToServer,n.type=new eL.ProtocolRequestType(n.method)})(X_e||(Rx.InlineValueRequest=X_e={}));var Y_e;(function(n){n.method="workspace/inlineValue/refresh",n.messageDirection=eL.MessageDirection.serverToClient,n.type=new eL.ProtocolRequestType0(n.method)})(Y_e||(Rx.InlineValueRefreshRequest=Y_e={}));var py={};Object.defineProperty(py,"__esModule",{value:!0});py.InlayHintRefreshRequest=py.InlayHintResolveRequest=py.InlayHintRequest=void 0;const Ax=gi;var J_e;(function(n){n.method="textDocument/inlayHint",n.messageDirection=Ax.MessageDirection.clientToServer,n.type=new Ax.ProtocolRequestType(n.method)})(J_e||(py.InlayHintRequest=J_e={}));var Q_e;(function(n){n.method="inlayHint/resolve",n.messageDirection=Ax.MessageDirection.clientToServer,n.type=new Ax.ProtocolRequestType(n.method)})(Q_e||(py.InlayHintResolveRequest=Q_e={}));var ewe;(function(n){n.method="workspace/inlayHint/refresh",n.messageDirection=Ax.MessageDirection.serverToClient,n.type=new Ax.ProtocolRequestType0(n.method)})(ewe||(py.InlayHintRefreshRequest=ewe={}));var Rh={};Object.defineProperty(Rh,"__esModule",{value:!0});Rh.DiagnosticRefreshRequest=Rh.WorkspaceDiagnosticRequest=Rh.DocumentDiagnosticRequest=Rh.DocumentDiagnosticReportKind=Rh.DiagnosticServerCancellationData=void 0;const RBe=S_,IQt=Ms,Ox=gi;var twe;(function(n){function e(t){const r=t;return r&&IQt.boolean(r.retriggerRequest)}n.is=e})(twe||(Rh.DiagnosticServerCancellationData=twe={}));var nwe;(function(n){n.Full="full",n.Unchanged="unchanged"})(nwe||(Rh.DocumentDiagnosticReportKind=nwe={}));var rwe;(function(n){n.method="textDocument/diagnostic",n.messageDirection=Ox.MessageDirection.clientToServer,n.type=new Ox.ProtocolRequestType(n.method),n.partialResult=new RBe.ProgressType})(rwe||(Rh.DocumentDiagnosticRequest=rwe={}));var iwe;(function(n){n.method="workspace/diagnostic",n.messageDirection=Ox.MessageDirection.clientToServer,n.type=new Ox.ProtocolRequestType(n.method),n.partialResult=new RBe.ProgressType})(iwe||(Rh.WorkspaceDiagnosticRequest=iwe={}));var owe;(function(n){n.method="workspace/diagnostic/refresh",n.messageDirection=Ox.MessageDirection.serverToClient,n.type=new Ox.ProtocolRequestType0(n.method)})(owe||(Rh.DiagnosticRefreshRequest=owe={}));var Os={};Object.defineProperty(Os,"__esModule",{value:!0});Os.DidCloseNotebookDocumentNotification=Os.DidSaveNotebookDocumentNotification=Os.DidChangeNotebookDocumentNotification=Os.NotebookCellArrayChange=Os.DidOpenNotebookDocumentNotification=Os.NotebookDocumentSyncRegistrationType=Os.NotebookDocument=Os.NotebookCell=Os.ExecutionSummary=Os.NotebookCellKind=void 0;const yT=use,Bf=Ms,Pg=gi;var SJ;(function(n){n.Markup=1,n.Code=2;function e(t){return t===1||t===2}n.is=e})(SJ||(Os.NotebookCellKind=SJ={}));var _J;(function(n){function e(i,o){const s={executionOrder:i};return(o===!0||o===!1)&&(s.success=o),s}n.create=e;function t(i){const o=i;return Bf.objectLiteral(o)&&yT.uinteger.is(o.executionOrder)&&(o.success===void 0||Bf.boolean(o.success))}n.is=t;function r(i,o){return i===o?!0:i==null||o===null||o===void 0?!1:i.executionOrder===o.executionOrder&&i.success===o.success}n.equals=r})(_J||(Os.ExecutionSummary=_J={}));var tL;(function(n){function e(o,s){return{kind:o,document:s}}n.create=e;function t(o){const s=o;return Bf.objectLiteral(s)&&SJ.is(s.kind)&&yT.DocumentUri.is(s.document)&&(s.metadata===void 0||Bf.objectLiteral(s.metadata))}n.is=t;function r(o,s){const a=new Set;return o.document!==s.document&&a.add("document"),o.kind!==s.kind&&a.add("kind"),o.executionSummary!==s.executionSummary&&a.add("executionSummary"),(o.metadata!==void 0||s.metadata!==void 0)&&!i(o.metadata,s.metadata)&&a.add("metadata"),(o.executionSummary!==void 0||s.executionSummary!==void 0)&&!_J.equals(o.executionSummary,s.executionSummary)&&a.add("executionSummary"),a}n.diff=r;function i(o,s){if(o===s)return!0;if(o==null||s===null||s===void 0||typeof o!=typeof s||typeof o!="object")return!1;const a=Array.isArray(o),c=Array.isArray(s);if(a!==c)return!1;if(a&&c){if(o.length!==s.length)return!1;for(let l=0;l<o.length;l++)if(!i(o[l],s[l]))return!1}if(Bf.objectLiteral(o)&&Bf.objectLiteral(s)){const l=Object.keys(o),u=Object.keys(s);if(l.length!==u.length||(l.sort(),u.sort(),!i(l,u)))return!1;for(let d=0;d<l.length;d++){const h=l[d];if(!i(o[h],s[h]))return!1}}return!0}})(tL||(Os.NotebookCell=tL={}));var swe;(function(n){function e(r,i,o,s){return{uri:r,notebookType:i,version:o,cells:s}}n.create=e;function t(r){const i=r;return Bf.objectLiteral(i)&&Bf.string(i.uri)&&yT.integer.is(i.version)&&Bf.typedArray(i.cells,tL.is)}n.is=t})(swe||(Os.NotebookDocument=swe={}));var Mx;(function(n){n.method="notebookDocument/sync",n.messageDirection=Pg.MessageDirection.clientToServer,n.type=new Pg.RegistrationType(n.method)})(Mx||(Os.NotebookDocumentSyncRegistrationType=Mx={}));var awe;(function(n){n.method="notebookDocument/didOpen",n.messageDirection=Pg.MessageDirection.clientToServer,n.type=new Pg.ProtocolNotificationType(n.method),n.registrationMethod=Mx.method})(awe||(Os.DidOpenNotebookDocumentNotification=awe={}));var cwe;(function(n){function e(r){const i=r;return Bf.objectLiteral(i)&&yT.uinteger.is(i.start)&&yT.uinteger.is(i.deleteCount)&&(i.cells===void 0||Bf.typedArray(i.cells,tL.is))}n.is=e;function t(r,i,o){const s={start:r,deleteCount:i};return o!==void 0&&(s.cells=o),s}n.create=t})(cwe||(Os.NotebookCellArrayChange=cwe={}));var lwe;(function(n){n.method="notebookDocument/didChange",n.messageDirection=Pg.MessageDirection.clientToServer,n.type=new Pg.ProtocolNotificationType(n.method),n.registrationMethod=Mx.method})(lwe||(Os.DidChangeNotebookDocumentNotification=lwe={}));var uwe;(function(n){n.method="notebookDocument/didSave",n.messageDirection=Pg.MessageDirection.clientToServer,n.type=new Pg.ProtocolNotificationType(n.method),n.registrationMethod=Mx.method})(uwe||(Os.DidSaveNotebookDocumentNotification=uwe={}));var dwe;(function(n){n.method="notebookDocument/didClose",n.messageDirection=Pg.MessageDirection.clientToServer,n.type=new Pg.ProtocolNotificationType(n.method),n.registrationMethod=Mx.method})(dwe||(Os.DidCloseNotebookDocumentNotification=dwe={}));var IF={};Object.defineProperty(IF,"__esModule",{value:!0});IF.InlineCompletionRequest=void 0;const hwe=gi;var fwe;(function(n){n.method="textDocument/inlineCompletion",n.messageDirection=hwe.MessageDirection.clientToServer,n.type=new hwe.ProtocolRequestType(n.method)})(fwe||(IF.InlineCompletionRequest=fwe={}));(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.WorkspaceSymbolRequest=n.CodeActionResolveRequest=n.CodeActionRequest=n.DocumentSymbolRequest=n.DocumentHighlightRequest=n.ReferencesRequest=n.DefinitionRequest=n.SignatureHelpRequest=n.SignatureHelpTriggerKind=n.HoverRequest=n.CompletionResolveRequest=n.CompletionRequest=n.CompletionTriggerKind=n.PublishDiagnosticsNotification=n.WatchKind=n.RelativePattern=n.FileChangeType=n.DidChangeWatchedFilesNotification=n.WillSaveTextDocumentWaitUntilRequest=n.WillSaveTextDocumentNotification=n.TextDocumentSaveReason=n.DidSaveTextDocumentNotification=n.DidCloseTextDocumentNotification=n.DidChangeTextDocumentNotification=n.TextDocumentContentChangeEvent=n.DidOpenTextDocumentNotification=n.TextDocumentSyncKind=n.TelemetryEventNotification=n.LogMessageNotification=n.ShowMessageRequest=n.ShowMessageNotification=n.MessageType=n.DidChangeConfigurationNotification=n.ExitNotification=n.ShutdownRequest=n.InitializedNotification=n.InitializeErrorCodes=n.InitializeRequest=n.WorkDoneProgressOptions=n.TextDocumentRegistrationOptions=n.StaticRegistrationOptions=n.PositionEncodingKind=n.FailureHandlingKind=n.ResourceOperationKind=n.UnregistrationRequest=n.RegistrationRequest=n.DocumentSelector=n.NotebookCellTextDocumentFilter=n.NotebookDocumentFilter=n.TextDocumentFilter=void 0,n.MonikerRequest=n.MonikerKind=n.UniquenessLevel=n.WillDeleteFilesRequest=n.DidDeleteFilesNotification=n.WillRenameFilesRequest=n.DidRenameFilesNotification=n.WillCreateFilesRequest=n.DidCreateFilesNotification=n.FileOperationPatternKind=n.LinkedEditingRangeRequest=n.ShowDocumentRequest=n.SemanticTokensRegistrationType=n.SemanticTokensRefreshRequest=n.SemanticTokensRangeRequest=n.SemanticTokensDeltaRequest=n.SemanticTokensRequest=n.TokenFormat=n.CallHierarchyPrepareRequest=n.CallHierarchyOutgoingCallsRequest=n.CallHierarchyIncomingCallsRequest=n.WorkDoneProgressCancelNotification=n.WorkDoneProgressCreateRequest=n.WorkDoneProgress=n.SelectionRangeRequest=n.DeclarationRequest=n.FoldingRangeRefreshRequest=n.FoldingRangeRequest=n.ColorPresentationRequest=n.DocumentColorRequest=n.ConfigurationRequest=n.DidChangeWorkspaceFoldersNotification=n.WorkspaceFoldersRequest=n.TypeDefinitionRequest=n.ImplementationRequest=n.ApplyWorkspaceEditRequest=n.ExecuteCommandRequest=n.PrepareRenameRequest=n.RenameRequest=n.PrepareSupportDefaultBehavior=n.DocumentOnTypeFormattingRequest=n.DocumentRangesFormattingRequest=n.DocumentRangeFormattingRequest=n.DocumentFormattingRequest=n.DocumentLinkResolveRequest=n.DocumentLinkRequest=n.CodeLensRefreshRequest=n.CodeLensResolveRequest=n.CodeLensRequest=n.WorkspaceSymbolResolveRequest=void 0,n.InlineCompletionRequest=n.DidCloseNotebookDocumentNotification=n.DidSaveNotebookDocumentNotification=n.DidChangeNotebookDocumentNotification=n.NotebookCellArrayChange=n.DidOpenNotebookDocumentNotification=n.NotebookDocumentSyncRegistrationType=n.NotebookDocument=n.NotebookCell=n.ExecutionSummary=n.NotebookCellKind=n.DiagnosticRefreshRequest=n.WorkspaceDiagnosticRequest=n.DocumentDiagnosticRequest=n.DocumentDiagnosticReportKind=n.DiagnosticServerCancellationData=n.InlayHintRefreshRequest=n.InlayHintResolveRequest=n.InlayHintRequest=n.InlineValueRefreshRequest=n.InlineValueRequest=n.TypeHierarchySupertypesRequest=n.TypeHierarchySubtypesRequest=n.TypeHierarchyPrepareRequest=void 0;const e=gi,t=use,r=Ms,i=bF;Object.defineProperty(n,"ImplementationRequest",{enumerable:!0,get:function(){return i.ImplementationRequest}});const o=SF;Object.defineProperty(n,"TypeDefinitionRequest",{enumerable:!0,get:function(){return o.TypeDefinitionRequest}});const s=Ix;Object.defineProperty(n,"WorkspaceFoldersRequest",{enumerable:!0,get:function(){return s.WorkspaceFoldersRequest}}),Object.defineProperty(n,"DidChangeWorkspaceFoldersNotification",{enumerable:!0,get:function(){return s.DidChangeWorkspaceFoldersNotification}});const a=_F;Object.defineProperty(n,"ConfigurationRequest",{enumerable:!0,get:function(){return a.ConfigurationRequest}});const c=Px;Object.defineProperty(n,"DocumentColorRequest",{enumerable:!0,get:function(){return c.DocumentColorRequest}}),Object.defineProperty(n,"ColorPresentationRequest",{enumerable:!0,get:function(){return c.ColorPresentationRequest}});const l=kx;Object.defineProperty(n,"FoldingRangeRequest",{enumerable:!0,get:function(){return l.FoldingRangeRequest}}),Object.defineProperty(n,"FoldingRangeRefreshRequest",{enumerable:!0,get:function(){return l.FoldingRangeRefreshRequest}});const u=wF;Object.defineProperty(n,"DeclarationRequest",{enumerable:!0,get:function(){return u.DeclarationRequest}});const d=CF;Object.defineProperty(n,"SelectionRangeRequest",{enumerable:!0,get:function(){return d.SelectionRangeRequest}});const h=uy;Object.defineProperty(n,"WorkDoneProgress",{enumerable:!0,get:function(){return h.WorkDoneProgress}}),Object.defineProperty(n,"WorkDoneProgressCreateRequest",{enumerable:!0,get:function(){return h.WorkDoneProgressCreateRequest}}),Object.defineProperty(n,"WorkDoneProgressCancelNotification",{enumerable:!0,get:function(){return h.WorkDoneProgressCancelNotification}});const f=dy;Object.defineProperty(n,"CallHierarchyIncomingCallsRequest",{enumerable:!0,get:function(){return f.CallHierarchyIncomingCallsRequest}}),Object.defineProperty(n,"CallHierarchyOutgoingCallsRequest",{enumerable:!0,get:function(){return f.CallHierarchyOutgoingCallsRequest}}),Object.defineProperty(n,"CallHierarchyPrepareRequest",{enumerable:!0,get:function(){return f.CallHierarchyPrepareRequest}});const p=Ru;Object.defineProperty(n,"TokenFormat",{enumerable:!0,get:function(){return p.TokenFormat}}),Object.defineProperty(n,"SemanticTokensRequest",{enumerable:!0,get:function(){return p.SemanticTokensRequest}}),Object.defineProperty(n,"SemanticTokensDeltaRequest",{enumerable:!0,get:function(){return p.SemanticTokensDeltaRequest}}),Object.defineProperty(n,"SemanticTokensRangeRequest",{enumerable:!0,get:function(){return p.SemanticTokensRangeRequest}}),Object.defineProperty(n,"SemanticTokensRefreshRequest",{enumerable:!0,get:function(){return p.SemanticTokensRefreshRequest}}),Object.defineProperty(n,"SemanticTokensRegistrationType",{enumerable:!0,get:function(){return p.SemanticTokensRegistrationType}});const g=xF;Object.defineProperty(n,"ShowDocumentRequest",{enumerable:!0,get:function(){return g.ShowDocumentRequest}});const m=EF;Object.defineProperty(n,"LinkedEditingRangeRequest",{enumerable:!0,get:function(){return m.LinkedEditingRangeRequest}});const v=pl;Object.defineProperty(n,"FileOperationPatternKind",{enumerable:!0,get:function(){return v.FileOperationPatternKind}}),Object.defineProperty(n,"DidCreateFilesNotification",{enumerable:!0,get:function(){return v.DidCreateFilesNotification}}),Object.defineProperty(n,"WillCreateFilesRequest",{enumerable:!0,get:function(){return v.WillCreateFilesRequest}}),Object.defineProperty(n,"DidRenameFilesNotification",{enumerable:!0,get:function(){return v.DidRenameFilesNotification}}),Object.defineProperty(n,"WillRenameFilesRequest",{enumerable:!0,get:function(){return v.WillRenameFilesRequest}}),Object.defineProperty(n,"DidDeleteFilesNotification",{enumerable:!0,get:function(){return v.DidDeleteFilesNotification}}),Object.defineProperty(n,"WillDeleteFilesRequest",{enumerable:!0,get:function(){return v.WillDeleteFilesRequest}});const b=hy;Object.defineProperty(n,"UniquenessLevel",{enumerable:!0,get:function(){return b.UniquenessLevel}}),Object.defineProperty(n,"MonikerKind",{enumerable:!0,get:function(){return b.MonikerKind}}),Object.defineProperty(n,"MonikerRequest",{enumerable:!0,get:function(){return b.MonikerRequest}});const S=fy;Object.defineProperty(n,"TypeHierarchyPrepareRequest",{enumerable:!0,get:function(){return S.TypeHierarchyPrepareRequest}}),Object.defineProperty(n,"TypeHierarchySubtypesRequest",{enumerable:!0,get:function(){return S.TypeHierarchySubtypesRequest}}),Object.defineProperty(n,"TypeHierarchySupertypesRequest",{enumerable:!0,get:function(){return S.TypeHierarchySupertypesRequest}});const E=Rx;Object.defineProperty(n,"InlineValueRequest",{enumerable:!0,get:function(){return E.InlineValueRequest}}),Object.defineProperty(n,"InlineValueRefreshRequest",{enumerable:!0,get:function(){return E.InlineValueRefreshRequest}});const w=py;Object.defineProperty(n,"InlayHintRequest",{enumerable:!0,get:function(){return w.InlayHintRequest}}),Object.defineProperty(n,"InlayHintResolveRequest",{enumerable:!0,get:function(){return w.InlayHintResolveRequest}}),Object.defineProperty(n,"InlayHintRefreshRequest",{enumerable:!0,get:function(){return w.InlayHintRefreshRequest}});const C=Rh;Object.defineProperty(n,"DiagnosticServerCancellationData",{enumerable:!0,get:function(){return C.DiagnosticServerCancellationData}}),Object.defineProperty(n,"DocumentDiagnosticReportKind",{enumerable:!0,get:function(){return C.DocumentDiagnosticReportKind}}),Object.defineProperty(n,"DocumentDiagnosticRequest",{enumerable:!0,get:function(){return C.DocumentDiagnosticRequest}}),Object.defineProperty(n,"WorkspaceDiagnosticRequest",{enumerable:!0,get:function(){return C.WorkspaceDiagnosticRequest}}),Object.defineProperty(n,"DiagnosticRefreshRequest",{enumerable:!0,get:function(){return C.DiagnosticRefreshRequest}});const I=Os;Object.defineProperty(n,"NotebookCellKind",{enumerable:!0,get:function(){return I.NotebookCellKind}}),Object.defineProperty(n,"ExecutionSummary",{enumerable:!0,get:function(){return I.ExecutionSummary}}),Object.defineProperty(n,"NotebookCell",{enumerable:!0,get:function(){return I.NotebookCell}}),Object.defineProperty(n,"NotebookDocument",{enumerable:!0,get:function(){return I.NotebookDocument}}),Object.defineProperty(n,"NotebookDocumentSyncRegistrationType",{enumerable:!0,get:function(){return I.NotebookDocumentSyncRegistrationType}}),Object.defineProperty(n,"DidOpenNotebookDocumentNotification",{enumerable:!0,get:function(){return I.DidOpenNotebookDocumentNotification}}),Object.defineProperty(n,"NotebookCellArrayChange",{enumerable:!0,get:function(){return I.NotebookCellArrayChange}}),Object.defineProperty(n,"DidChangeNotebookDocumentNotification",{enumerable:!0,get:function(){return I.DidChangeNotebookDocumentNotification}}),Object.defineProperty(n,"DidSaveNotebookDocumentNotification",{enumerable:!0,get:function(){return I.DidSaveNotebookDocumentNotification}}),Object.defineProperty(n,"DidCloseNotebookDocumentNotification",{enumerable:!0,get:function(){return I.DidCloseNotebookDocumentNotification}});const T=IF;Object.defineProperty(n,"InlineCompletionRequest",{enumerable:!0,get:function(){return T.InlineCompletionRequest}});var D;(function(ae){function Wt(un){const qt=un;return r.string(qt)||r.string(qt.language)||r.string(qt.scheme)||r.string(qt.pattern)}ae.is=Wt})(D||(n.TextDocumentFilter=D={}));var O;(function(ae){function Wt(un){const qt=un;return r.objectLiteral(qt)&&(r.string(qt.notebookType)||r.string(qt.scheme)||r.string(qt.pattern))}ae.is=Wt})(O||(n.NotebookDocumentFilter=O={}));var M;(function(ae){function Wt(un){const qt=un;return r.objectLiteral(qt)&&(r.string(qt.notebook)||O.is(qt.notebook))&&(qt.language===void 0||r.string(qt.language))}ae.is=Wt})(M||(n.NotebookCellTextDocumentFilter=M={}));var R;(function(ae){function Wt(un){if(!Array.isArray(un))return!1;for(let qt of un)if(!r.string(qt)&&!D.is(qt)&&!M.is(qt))return!1;return!0}ae.is=Wt})(R||(n.DocumentSelector=R={}));var A;(function(ae){ae.method="client/registerCapability",ae.messageDirection=e.MessageDirection.serverToClient,ae.type=new e.ProtocolRequestType(ae.method)})(A||(n.RegistrationRequest=A={}));var k;(function(ae){ae.method="client/unregisterCapability",ae.messageDirection=e.MessageDirection.serverToClient,ae.type=new e.ProtocolRequestType(ae.method)})(k||(n.UnregistrationRequest=k={}));var L;(function(ae){ae.Create="create",ae.Rename="rename",ae.Delete="delete"})(L||(n.ResourceOperationKind=L={}));var j;(function(ae){ae.Abort="abort",ae.Transactional="transactional",ae.TextOnlyTransactional="textOnlyTransactional",ae.Undo="undo"})(j||(n.FailureHandlingKind=j={}));var N;(function(ae){ae.UTF8="utf-8",ae.UTF16="utf-16",ae.UTF32="utf-32"})(N||(n.PositionEncodingKind=N={}));var B;(function(ae){function Wt(un){const qt=un;return qt&&r.string(qt.id)&&qt.id.length>0}ae.hasId=Wt})(B||(n.StaticRegistrationOptions=B={}));var U;(function(ae){function Wt(un){const qt=un;return qt&&(qt.documentSelector===null||R.is(qt.documentSelector))}ae.is=Wt})(U||(n.TextDocumentRegistrationOptions=U={}));var K;(function(ae){function Wt(qt){const Ce=qt;return r.objectLiteral(Ce)&&(Ce.workDoneProgress===void 0||r.boolean(Ce.workDoneProgress))}ae.is=Wt;function un(qt){const Ce=qt;return Ce&&r.boolean(Ce.workDoneProgress)}ae.hasWorkDoneProgress=un})(K||(n.WorkDoneProgressOptions=K={}));var z;(function(ae){ae.method="initialize",ae.messageDirection=e.MessageDirection.clientToServer,ae.type=new e.ProtocolRequestType(ae.method)})(z||(n.InitializeRequest=z={}));var G;(function(ae){ae.unknownProtocolVersion=1})(G||(n.InitializeErrorCodes=G={}));var te;(function(ae){ae.method="initialized",ae.messageDirection=e.MessageDirection.clientToServer,ae.type=new e.ProtocolNotificationType(ae.method)})(te||(n.InitializedNotification=te={}));var ie;(function(ae){ae.method="shutdown",ae.messageDirection=e.MessageDirection.clientToServer,ae.type=new e.ProtocolRequestType0(ae.method)})(ie||(n.ShutdownRequest=ie={}));var Q;(function(ae){ae.method="exit",ae.messageDirection=e.MessageDirection.clientToServer,ae.type=new e.ProtocolNotificationType0(ae.method)})(Q||(n.ExitNotification=Q={}));var ge;(function(ae){ae.method="workspace/didChangeConfiguration",ae.messageDirection=e.MessageDirection.clientToServer,ae.type=new e.ProtocolNotificationType(ae.method)})(ge||(n.DidChangeConfigurationNotification=ge={}));var _e;(function(ae){ae.Error=1,ae.Warning=2,ae.Info=3,ae.Log=4,ae.Debug=5})(_e||(n.MessageType=_e={}));var Se;(function(ae){ae.method="window/showMessage",ae.messageDirection=e.MessageDirection.serverToClient,ae.type=new e.ProtocolNotificationType(ae.method)})(Se||(n.ShowMessageNotification=Se={}));var se;(function(ae){ae.method="window/showMessageRequest",ae.messageDirection=e.MessageDirection.serverToClient,ae.type=new e.ProtocolRequestType(ae.method)})(se||(n.ShowMessageRequest=se={}));var ee;(function(ae){ae.method="window/logMessage",ae.messageDirection=e.MessageDirection.serverToClient,ae.type=new e.ProtocolNotificationType(ae.method)})(ee||(n.LogMessageNotification=ee={}));var Y;(function(ae){ae.method="telemetry/event",ae.messageDirection=e.MessageDirection.serverToClient,ae.type=new e.ProtocolNotificationType(ae.method)})(Y||(n.TelemetryEventNotification=Y={}));var ue;(function(ae){ae.None=0,ae.Full=1,ae.Incremental=2})(ue||(n.TextDocumentSyncKind=ue={}));var ye;(function(ae){ae.method="textDocument/didOpen",ae.messageDirection=e.MessageDirection.clientToServer,ae.type=new e.ProtocolNotificationType(ae.method)})(ye||(n.DidOpenTextDocumentNotification=ye={}));var V;(function(ae){function Wt(qt){let Ce=qt;return Ce!=null&&typeof Ce.text=="string"&&Ce.range!==void 0&&(Ce.rangeLength===void 0||typeof Ce.rangeLength=="number")}ae.isIncremental=Wt;function un(qt){let Ce=qt;return Ce!=null&&typeof Ce.text=="string"&&Ce.range===void 0&&Ce.rangeLength===void 0}ae.isFull=un})(V||(n.TextDocumentContentChangeEvent=V={}));var le;(function(ae){ae.method="textDocument/didChange",ae.messageDirection=e.MessageDirection.clientToServer,ae.type=new e.ProtocolNotificationType(ae.method)})(le||(n.DidChangeTextDocumentNotification=le={}));var he;(function(ae){ae.method="textDocument/didClose",ae.messageDirection=e.MessageDirection.clientToServer,ae.type=new e.ProtocolNotificationType(ae.method)})(he||(n.DidCloseTextDocumentNotification=he={}));var oe;(function(ae){ae.method="textDocument/didSave",ae.messageDirection=e.MessageDirection.clientToServer,ae.type=new e.ProtocolNotificationType(ae.method)})(oe||(n.DidSaveTextDocumentNotification=oe={}));var ne;(function(ae){ae.Manual=1,ae.AfterDelay=2,ae.FocusOut=3})(ne||(n.TextDocumentSaveReason=ne={}));var ce;(function(ae){ae.method="textDocument/willSave",ae.messageDirection=e.MessageDirection.clientToServer,ae.type=new e.ProtocolNotificationType(ae.method)})(ce||(n.WillSaveTextDocumentNotification=ce={}));var Ae;(function(ae){ae.method="textDocument/willSaveWaitUntil",ae.messageDirection=e.MessageDirection.clientToServer,ae.type=new e.ProtocolRequestType(ae.method)})(Ae||(n.WillSaveTextDocumentWaitUntilRequest=Ae={}));var Ie;(function(ae){ae.method="workspace/didChangeWatchedFiles",ae.messageDirection=e.MessageDirection.clientToServer,ae.type=new e.ProtocolNotificationType(ae.method)})(Ie||(n.DidChangeWatchedFilesNotification=Ie={}));var be;(function(ae){ae.Created=1,ae.Changed=2,ae.Deleted=3})(be||(n.FileChangeType=be={}));var De;(function(ae){function Wt(un){const qt=un;return r.objectLiteral(qt)&&(t.URI.is(qt.baseUri)||t.WorkspaceFolder.is(qt.baseUri))&&r.string(qt.pattern)}ae.is=Wt})(De||(n.RelativePattern=De={}));var Me;(function(ae){ae.Create=1,ae.Change=2,ae.Delete=4})(Me||(n.WatchKind=Me={}));var He;(function(ae){ae.method="textDocument/publishDiagnostics",ae.messageDirection=e.MessageDirection.serverToClient,ae.type=new e.ProtocolNotificationType(ae.method)})(He||(n.PublishDiagnosticsNotification=He={}));var Je;(function(ae){ae.Invoked=1,ae.TriggerCharacter=2,ae.TriggerForIncompleteCompletions=3})(Je||(n.CompletionTriggerKind=Je={}));var qe;(function(ae){ae.method="textDocument/completion",ae.messageDirection=e.MessageDirection.clientToServer,ae.type=new e.ProtocolRequestType(ae.method)})(qe||(n.CompletionRequest=qe={}));var Ge;(function(ae){ae.method="completionItem/resolve",ae.messageDirection=e.MessageDirection.clientToServer,ae.type=new e.ProtocolRequestType(ae.method)})(Ge||(n.CompletionResolveRequest=Ge={}));var St;(function(ae){ae.method="textDocument/hover",ae.messageDirection=e.MessageDirection.clientToServer,ae.type=new e.ProtocolRequestType(ae.method)})(St||(n.HoverRequest=St={}));var Pt;(function(ae){ae.Invoked=1,ae.TriggerCharacter=2,ae.ContentChange=3})(Pt||(n.SignatureHelpTriggerKind=Pt={}));var on;(function(ae){ae.method="textDocument/signatureHelp",ae.messageDirection=e.MessageDirection.clientToServer,ae.type=new e.ProtocolRequestType(ae.method)})(on||(n.SignatureHelpRequest=on={}));var an;(function(ae){ae.method="textDocument/definition",ae.messageDirection=e.MessageDirection.clientToServer,ae.type=new e.ProtocolRequestType(ae.method)})(an||(n.DefinitionRequest=an={}));var Rt;(function(ae){ae.method="textDocument/references",ae.messageDirection=e.MessageDirection.clientToServer,ae.type=new e.ProtocolRequestType(ae.method)})(Rt||(n.ReferencesRequest=Rt={}));var Xt;(function(ae){ae.method="textDocument/documentHighlight",ae.messageDirection=e.MessageDirection.clientToServer,ae.type=new e.ProtocolRequestType(ae.method)})(Xt||(n.DocumentHighlightRequest=Xt={}));var yn;(function(ae){ae.method="textDocument/documentSymbol",ae.messageDirection=e.MessageDirection.clientToServer,ae.type=new e.ProtocolRequestType(ae.method)})(yn||(n.DocumentSymbolRequest=yn={}));var bn;(function(ae){ae.method="textDocument/codeAction",ae.messageDirection=e.MessageDirection.clientToServer,ae.type=new e.ProtocolRequestType(ae.method)})(bn||(n.CodeActionRequest=bn={}));var Kn;(function(ae){ae.method="codeAction/resolve",ae.messageDirection=e.MessageDirection.clientToServer,ae.type=new e.ProtocolRequestType(ae.method)})(Kn||(n.CodeActionResolveRequest=Kn={}));var lr;(function(ae){ae.method="workspace/symbol",ae.messageDirection=e.MessageDirection.clientToServer,ae.type=new e.ProtocolRequestType(ae.method)})(lr||(n.WorkspaceSymbolRequest=lr={}));var Rr;(function(ae){ae.method="workspaceSymbol/resolve",ae.messageDirection=e.MessageDirection.clientToServer,ae.type=new e.ProtocolRequestType(ae.method)})(Rr||(n.WorkspaceSymbolResolveRequest=Rr={}));var Lr;(function(ae){ae.method="textDocument/codeLens",ae.messageDirection=e.MessageDirection.clientToServer,ae.type=new e.ProtocolRequestType(ae.method)})(Lr||(n.CodeLensRequest=Lr={}));var er;(function(ae){ae.method="codeLens/resolve",ae.messageDirection=e.MessageDirection.clientToServer,ae.type=new e.ProtocolRequestType(ae.method)})(er||(n.CodeLensResolveRequest=er={}));var ke;(function(ae){ae.method="workspace/codeLens/refresh",ae.messageDirection=e.MessageDirection.serverToClient,ae.type=new e.ProtocolRequestType0(ae.method)})(ke||(n.CodeLensRefreshRequest=ke={}));var Qn;(function(ae){ae.method="textDocument/documentLink",ae.messageDirection=e.MessageDirection.clientToServer,ae.type=new e.ProtocolRequestType(ae.method)})(Qn||(n.DocumentLinkRequest=Qn={}));var Gn;(function(ae){ae.method="documentLink/resolve",ae.messageDirection=e.MessageDirection.clientToServer,ae.type=new e.ProtocolRequestType(ae.method)})(Gn||(n.DocumentLinkResolveRequest=Gn={}));var J;(function(ae){ae.method="textDocument/formatting",ae.messageDirection=e.MessageDirection.clientToServer,ae.type=new e.ProtocolRequestType(ae.method)})(J||(n.DocumentFormattingRequest=J={}));var ze;(function(ae){ae.method="textDocument/rangeFormatting",ae.messageDirection=e.MessageDirection.clientToServer,ae.type=new e.ProtocolRequestType(ae.method)})(ze||(n.DocumentRangeFormattingRequest=ze={}));var it;(function(ae){ae.method="textDocument/rangesFormatting",ae.messageDirection=e.MessageDirection.clientToServer,ae.type=new e.ProtocolRequestType(ae.method)})(it||(n.DocumentRangesFormattingRequest=it={}));var at;(function(ae){ae.method="textDocument/onTypeFormatting",ae.messageDirection=e.MessageDirection.clientToServer,ae.type=new e.ProtocolRequestType(ae.method)})(at||(n.DocumentOnTypeFormattingRequest=at={}));var Lt;(function(ae){ae.Identifier=1})(Lt||(n.PrepareSupportDefaultBehavior=Lt={}));var fn;(function(ae){ae.method="textDocument/rename",ae.messageDirection=e.MessageDirection.clientToServer,ae.type=new e.ProtocolRequestType(ae.method)})(fn||(n.RenameRequest=fn={}));var hn;(function(ae){ae.method="textDocument/prepareRename",ae.messageDirection=e.MessageDirection.clientToServer,ae.type=new e.ProtocolRequestType(ae.method)})(hn||(n.PrepareRenameRequest=hn={}));var Ut;(function(ae){ae.method="workspace/executeCommand",ae.messageDirection=e.MessageDirection.clientToServer,ae.type=new e.ProtocolRequestType(ae.method)})(Ut||(n.ExecuteCommandRequest=Ut={}));var sn;(function(ae){ae.method="workspace/applyEdit",ae.messageDirection=e.MessageDirection.serverToClient,ae.type=new e.ProtocolRequestType("workspace/applyEdit")})(sn||(n.ApplyWorkspaceEditRequest=sn={}))})(kBe);var PF={};Object.defineProperty(PF,"__esModule",{value:!0});PF.createProtocolConnection=void 0;const pwe=S_;function PQt(n,e,t,r){return pwe.ConnectionStrategy.is(r)&&(r={connectionStrategy:r}),(0,pwe.createMessageConnection)(n,e,t,r)}PF.createProtocolConnection=PQt;(function(n){var e=Ir&&Ir.__createBinding||(Object.create?function(o,s,a,c){c===void 0&&(c=a);var l=Object.getOwnPropertyDescriptor(s,a);(!l||("get"in l?!s.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return s[a]}}),Object.defineProperty(o,c,l)}:function(o,s,a,c){c===void 0&&(c=a),o[c]=s[a]}),t=Ir&&Ir.__exportStar||function(o,s){for(var a in o)a!=="default"&&!Object.prototype.hasOwnProperty.call(s,a)&&e(s,o,a)};Object.defineProperty(n,"__esModule",{value:!0}),n.LSPErrorCodes=n.createProtocolConnection=void 0,t(S_,n),t(use,n),t(gi,n),t(kBe,n);var r=PF;Object.defineProperty(n,"createProtocolConnection",{enumerable:!0,get:function(){return r.createProtocolConnection}});var i;(function(o){o.lspReservedErrorRangeStart=-32899,o.RequestFailed=-32803,o.ServerCancelled=-32802,o.ContentModified=-32801,o.RequestCancelled=-32800,o.lspReservedErrorRangeEnd=-32800})(i||(n.LSPErrorCodes=i={}))})(PBe);(function(n){var e=Ir&&Ir.__createBinding||(Object.create?function(o,s,a,c){c===void 0&&(c=a);var l=Object.getOwnPropertyDescriptor(s,a);(!l||("get"in l?!s.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return s[a]}}),Object.defineProperty(o,c,l)}:function(o,s,a,c){c===void 0&&(c=a),o[c]=s[a]}),t=Ir&&Ir.__exportStar||function(o,s){for(var a in o)a!=="default"&&!Object.prototype.hasOwnProperty.call(s,a)&&e(s,o,a)};Object.defineProperty(n,"__esModule",{value:!0}),n.createProtocolConnection=void 0;const r=n_e;t(n_e,n),t(PBe,n);function i(o,s,a,c){return(0,r.createMessageConnection)(o,s,a,c)}n.createProtocolConnection=i})(Pr);var kF={},ji={};Object.defineProperty(ji,"__esModule",{value:!0});ji.asPromise=ji.thenable=ji.typedArray=ji.stringArray=ji.array=ji.func=ji.error=ji.number=ji.string=ji.boolean=void 0;function kQt(n){return n===!0||n===!1}ji.boolean=kQt;function ABe(n){return typeof n=="string"||n instanceof String}ji.string=ABe;function TQt(n){return typeof n=="number"||n instanceof Number}ji.number=TQt;function DQt(n){return n instanceof Error}ji.error=DQt;function OBe(n){return typeof n=="function"}ji.func=OBe;function MBe(n){return Array.isArray(n)}ji.array=MBe;function RQt(n){return MBe(n)&&n.every(e=>ABe(e))}ji.stringArray=RQt;function AQt(n,e){return Array.isArray(n)&&n.every(e)}ji.typedArray=AQt;function $Be(n){return n&&OBe(n.then)}ji.thenable=$Be;function OQt(n){return n instanceof Promise?n:$Be(n)?new Promise((e,t)=>{n.then(r=>e(r),r=>t(r))}):Promise.resolve(n)}ji.asPromise=OQt;var nc={};Object.defineProperty(nc,"__esModule",{value:!0});nc.forEach=nc.mapAsync=nc.map=nc.clearTestMode=nc.setTestMode=nc.Semaphore=nc.Delayer=void 0;const nR=Pr;class MQt{constructor(e){this.defaultDelay=e,this.timeout=void 0,this.completionPromise=void 0,this.onSuccess=void 0,this.task=void 0}trigger(e,t=this.defaultDelay){return this.task=e,t>=0&&this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise(r=>{this.onSuccess=r}).then(()=>{this.completionPromise=void 0,this.onSuccess=void 0;var r=this.task();return this.task=void 0,r})),(t>=0||this.timeout===void 0)&&(this.timeout=(0,nR.RAL)().timer.setTimeout(()=>{this.timeout=void 0,this.onSuccess(void 0)},t>=0?t:this.defaultDelay)),this.completionPromise}forceDelivery(){if(!this.completionPromise)return;this.cancelTimeout();let e=this.task();return this.completionPromise=void 0,this.onSuccess=void 0,this.task=void 0,e}isTriggered(){return this.timeout!==void 0}cancel(){this.cancelTimeout(),this.completionPromise=void 0}cancelTimeout(){this.timeout!==void 0&&(this.timeout.dispose(),this.timeout=void 0)}}nc.Delayer=MQt;class $Qt{constructor(e=1){if(e<=0)throw new Error("Capacity must be greater than 0");this._capacity=e,this._active=0,this._waiting=[]}lock(e){return new Promise((t,r)=>{this._waiting.push({thunk:e,resolve:t,reject:r}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,nR.RAL)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;const e=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{const t=e.thunk();t instanceof Promise?t.then(r=>{this._active--,e.resolve(r),this.runNext()},r=>{this._active--,e.reject(r),this.runNext()}):(this._active--,e.resolve(t),this.runNext())}catch(t){this._active--,e.reject(t),this.runNext()}}}nc.Semaphore=$Qt;let dse=!1;function LQt(){dse=!0}nc.setTestMode=LQt;function NQt(){dse=!1}nc.clearTestMode=NQt;const gwe=15;class hse{constructor(e=gwe){this.yieldAfter=dse===!0?Math.max(e,2):Math.max(e,gwe),this.startTime=Date.now(),this.counter=0,this.total=0,this.counterInterval=1}start(){this.counter=0,this.total=0,this.counterInterval=1,this.startTime=Date.now()}shouldYield(){if(++this.counter>=this.counterInterval){const e=Date.now()-this.startTime,t=Math.max(0,this.yieldAfter-e);if(this.total+=this.counter,this.counter=0,e>=this.yieldAfter||t<=1)return this.counterInterval=1,this.total=0,!0;switch(e){case 0:case 1:this.counterInterval=this.total*2;break}}return!1}}async function FQt(n,e,t,r){if(n.length===0)return[];const i=new Array(n.length),o=new hse(r==null?void 0:r.yieldAfter);function s(c){o.start();for(let l=c;l<n.length;l++)if(i[l]=e(n[l]),o.shouldYield())return r!=null&&r.yieldCallback&&r.yieldCallback(),l+1;return-1}let a=s(0);for(;a!==-1&&!(t!==void 0&&t.isCancellationRequested);)a=await new Promise(c=>{(0,nR.RAL)().timer.setImmediate(()=>{c(s(a))})});return i}nc.map=FQt;async function jQt(n,e,t,r){if(n.length===0)return[];const i=new Array(n.length),o=new hse(r==null?void 0:r.yieldAfter);async function s(c){o.start();for(let l=c;l<n.length;l++)if(i[l]=await e(n[l],t),o.shouldYield())return r!=null&&r.yieldCallback&&r.yieldCallback(),l+1;return-1}let a=await s(0);for(;a!==-1&&!(t!==void 0&&t.isCancellationRequested);)a=await new Promise(c=>{(0,nR.RAL)().timer.setImmediate(()=>{c(s(a))})});return i}nc.mapAsync=jQt;async function BQt(n,e,t,r){if(n.length===0)return;const i=new hse(r==null?void 0:r.yieldAfter);function o(a){i.start();for(let c=a;c<n.length;c++)if(e(n[c]),i.shouldYield())return r!=null&&r.yieldCallback&&r.yieldCallback(),c+1;return-1}let s=o(0);for(;s!==-1&&!(t!==void 0&&t.isCancellationRequested);)s=await new Promise(a=>{(0,nR.RAL)().timer.setImmediate(()=>{a(o(s))})})}nc.forEach=BQt;var TF={};Object.defineProperty(TF,"__esModule",{value:!0});const HQt=wr;class UQt extends HQt.CompletionItem{constructor(e){super(e)}}TF.default=UQt;var DF={};Object.defineProperty(DF,"__esModule",{value:!0});const zQt=wr;class VQt extends zQt.CodeLens{constructor(e){super(e)}}DF.default=VQt;var RF={};Object.defineProperty(RF,"__esModule",{value:!0});const WQt=wr;class qQt extends WQt.DocumentLink{constructor(e,t){super(e,t)}}RF.default=qQt;var AF={};Object.defineProperty(AF,"__esModule",{value:!0});const KQt=wr;class GQt extends KQt.CodeAction{constructor(e,t){super(e),this.data=t}}AF.default=GQt;var i_={};Object.defineProperty(i_,"__esModule",{value:!0});i_.ProtocolDiagnostic=i_.DiagnosticCode=void 0;const ZQt=wr,Tz=ji;var mwe;(function(n){function e(t){const r=t;return r!=null&&(Tz.number(r.value)||Tz.string(r.value))&&Tz.string(r.target)}n.is=e})(mwe||(i_.DiagnosticCode=mwe={}));class XQt extends ZQt.Diagnostic{constructor(e,t,r,i){super(e,t,r),this.data=i,this.hasDiagnosticCode=!1}}i_.ProtocolDiagnostic=XQt;var OF={};Object.defineProperty(OF,"__esModule",{value:!0});const YQt=wr;class JQt extends YQt.CallHierarchyItem{constructor(e,t,r,i,o,s,a){super(e,t,r,i,o,s),a!==void 0&&(this.data=a)}}OF.default=JQt;var MF={};Object.defineProperty(MF,"__esModule",{value:!0});const QQt=wr;class een extends QQt.TypeHierarchyItem{constructor(e,t,r,i,o,s,a){super(e,t,r,i,o,s),a!==void 0&&(this.data=a)}}MF.default=een;var $F={};Object.defineProperty($F,"__esModule",{value:!0});const UA=wr;class ten extends UA.SymbolInformation{constructor(e,t,r,i,o){const s=!(i instanceof UA.Uri);super(e,t,r,s?i:new UA.Location(i,new UA.Range(0,0,0,0))),this.hasRange=s,o!==void 0&&(this.data=o)}}$F.default=ten;var LF={};Object.defineProperty(LF,"__esModule",{value:!0});const nen=wr;class ren extends nen.InlayHint{constructor(e,t,r){super(e,t,r)}}LF.default=ren;Object.defineProperty(kF,"__esModule",{value:!0});kF.createConverter=void 0;const ua=wr,Tr=Pr,Lb=ji,vwe=nc,ien=TF,oen=DF,sen=RF,ywe=AF,bwe=i_,aen=OF,cen=MF,len=$F,uen=LF;var wJ;(function(n){function e(t){const r=t;return r&&!!r.inserting&&!!r.replacing}n.is=e})(wJ||(wJ={}));function den(n){const t=n||(J=>J.toString());function r(J){return t(J)}function i(J){return{uri:t(J.uri)}}function o(J){return{uri:t(J.uri),languageId:J.languageId,version:J.version,text:J.getText()}}function s(J){return{uri:t(J.uri),version:J.version}}function a(J){return{textDocument:o(J)}}function c(J){const ze=J;return!!ze.document&&!!ze.contentChanges}function l(J){const ze=J;return!!ze.uri&&!!ze.version}function u(J,ze,it){if(l(J))return{textDocument:{uri:t(J.uri),version:J.version},contentChanges:[{text:J.getText()}]};if(c(J)){const at=ze,Lt=it;return{textDocument:{uri:t(at),version:Lt},contentChanges:J.contentChanges.map(hn=>{const Ut=hn.range;return{range:{start:{line:Ut.start.line,character:Ut.start.character},end:{line:Ut.end.line,character:Ut.end.character}},rangeLength:hn.rangeLength,text:hn.text}})}}else throw Error("Unsupported text document change parameter")}function d(J){return{textDocument:i(J)}}function h(J,ze=!1){let it={textDocument:i(J)};return ze&&(it.text=J.getText()),it}function f(J){switch(J){case ua.TextDocumentSaveReason.Manual:return Tr.TextDocumentSaveReason.Manual;case ua.TextDocumentSaveReason.AfterDelay:return Tr.TextDocumentSaveReason.AfterDelay;case ua.TextDocumentSaveReason.FocusOut:return Tr.TextDocumentSaveReason.FocusOut}return Tr.TextDocumentSaveReason.Manual}function p(J){return{textDocument:i(J.document),reason:f(J.reason)}}function g(J){return{files:J.files.map(ze=>({uri:t(ze)}))}}function m(J){return{files:J.files.map(ze=>({oldUri:t(ze.oldUri),newUri:t(ze.newUri)}))}}function v(J){return{files:J.files.map(ze=>({uri:t(ze)}))}}function b(J){return{files:J.files.map(ze=>({uri:t(ze)}))}}function S(J){return{files:J.files.map(ze=>({oldUri:t(ze.oldUri),newUri:t(ze.newUri)}))}}function E(J){return{files:J.files.map(ze=>({uri:t(ze)}))}}function w(J,ze){return{textDocument:i(J),position:L(ze)}}function C(J){switch(J){case ua.CompletionTriggerKind.TriggerCharacter:return Tr.CompletionTriggerKind.TriggerCharacter;case ua.CompletionTriggerKind.TriggerForIncompleteCompletions:return Tr.CompletionTriggerKind.TriggerForIncompleteCompletions;default:return Tr.CompletionTriggerKind.Invoked}}function I(J,ze,it){return{textDocument:i(J),position:L(ze),context:{triggerKind:C(it.triggerKind),triggerCharacter:it.triggerCharacter}}}function T(J){switch(J){case ua.SignatureHelpTriggerKind.Invoke:return Tr.SignatureHelpTriggerKind.Invoked;case ua.SignatureHelpTriggerKind.TriggerCharacter:return Tr.SignatureHelpTriggerKind.TriggerCharacter;case ua.SignatureHelpTriggerKind.ContentChange:return Tr.SignatureHelpTriggerKind.ContentChange}}function D(J){return{label:J.label}}function O(J){return J.map(D)}function M(J){return{label:J.label,parameters:O(J.parameters)}}function R(J){return J.map(M)}function A(J){return J===void 0?J:{signatures:R(J.signatures),activeSignature:J.activeSignature,activeParameter:J.activeParameter}}function k(J,ze,it){return{textDocument:i(J),position:L(ze),context:{isRetrigger:it.isRetrigger,triggerCharacter:it.triggerCharacter,triggerKind:T(it.triggerKind),activeSignatureHelp:A(it.activeSignatureHelp)}}}function L(J){return{line:J.line,character:J.character}}function j(J){return J==null?J:{line:J.line>Tr.uinteger.MAX_VALUE?Tr.uinteger.MAX_VALUE:J.line,character:J.character>Tr.uinteger.MAX_VALUE?Tr.uinteger.MAX_VALUE:J.character}}function N(J,ze){return vwe.map(J,j,ze)}function B(J){return J.map(j)}function U(J){return J==null?J:{start:j(J.start),end:j(J.end)}}function K(J){return J.map(U)}function z(J){return J==null?J:Tr.Location.create(r(J.uri),U(J.range))}function G(J){switch(J){case ua.DiagnosticSeverity.Error:return Tr.DiagnosticSeverity.Error;case ua.DiagnosticSeverity.Warning:return Tr.DiagnosticSeverity.Warning;case ua.DiagnosticSeverity.Information:return Tr.DiagnosticSeverity.Information;case ua.DiagnosticSeverity.Hint:return Tr.DiagnosticSeverity.Hint}}function te(J){if(!J)return;let ze=[];for(let it of J){let at=ie(it);at!==void 0&&ze.push(at)}return ze.length>0?ze:void 0}function ie(J){switch(J){case ua.DiagnosticTag.Unnecessary:return Tr.DiagnosticTag.Unnecessary;case ua.DiagnosticTag.Deprecated:return Tr.DiagnosticTag.Deprecated;default:return}}function Q(J){return{message:J.message,location:z(J.location)}}function ge(J){return J.map(Q)}function _e(J){if(J!=null)return Lb.number(J)||Lb.string(J)?J:{value:J.value,target:r(J.target)}}function Se(J){const ze=Tr.Diagnostic.create(U(J.range),J.message),it=J instanceof bwe.ProtocolDiagnostic?J:void 0;it!==void 0&&it.data!==void 0&&(ze.data=it.data);const at=_e(J.code);return bwe.DiagnosticCode.is(at)?it!==void 0&&it.hasDiagnosticCode?ze.code=at:(ze.code=at.value,ze.codeDescription={href:at.target}):ze.code=at,Lb.number(J.severity)&&(ze.severity=G(J.severity)),Array.isArray(J.tags)&&(ze.tags=te(J.tags)),J.relatedInformation&&(ze.relatedInformation=ge(J.relatedInformation)),J.source&&(ze.source=J.source),ze}function se(J,ze){return J==null?J:vwe.map(J,Se,ze)}function ee(J){return J==null?J:J.map(Se)}function Y(J,ze){switch(J){case"$string":return ze;case Tr.MarkupKind.PlainText:return{kind:J,value:ze};case Tr.MarkupKind.Markdown:return{kind:J,value:ze.value};default:return`Unsupported Markup content received. Kind is: ${J}`}}function ue(J){switch(J){case ua.CompletionItemTag.Deprecated:return Tr.CompletionItemTag.Deprecated}}function ye(J){if(J===void 0)return J;const ze=[];for(let it of J){const at=ue(it);at!==void 0&&ze.push(at)}return ze}function V(J,ze){return ze!==void 0?ze:J+1}function le(J,ze=!1){let it,at;Lb.string(J.label)?it=J.label:(it=J.label.label,ze&&(J.label.detail!==void 0||J.label.description!==void 0)&&(at={detail:J.label.detail,description:J.label.description}));let Lt={label:it};at!==void 0&&(Lt.labelDetails=at);let fn=J instanceof ien.default?J:void 0;J.detail&&(Lt.detail=J.detail),J.documentation&&(!fn||fn.documentationFormat==="$string"?Lt.documentation=J.documentation:Lt.documentation=Y(fn.documentationFormat,J.documentation)),J.filterText&&(Lt.filterText=J.filterText),he(Lt,J),Lb.number(J.kind)&&(Lt.kind=V(J.kind,fn&&fn.originalItemKind)),J.sortText&&(Lt.sortText=J.sortText),J.additionalTextEdits&&(Lt.additionalTextEdits=ce(J.additionalTextEdits)),J.commitCharacters&&(Lt.commitCharacters=J.commitCharacters.slice()),J.command&&(Lt.command=an(J.command)),(J.preselect===!0||J.preselect===!1)&&(Lt.preselect=J.preselect);const hn=ye(J.tags);if(fn){if(fn.data!==void 0&&(Lt.data=fn.data),fn.deprecated===!0||fn.deprecated===!1){if(fn.deprecated===!0&&hn!==void 0&&hn.length>0){const Ut=hn.indexOf(ua.CompletionItemTag.Deprecated);Ut!==-1&&hn.splice(Ut,1)}Lt.deprecated=fn.deprecated}fn.insertTextMode!==void 0&&(Lt.insertTextMode=fn.insertTextMode)}return hn!==void 0&&hn.length>0&&(Lt.tags=hn),Lt.insertTextMode===void 0&&J.keepWhitespace===!0&&(Lt.insertTextMode=Tr.InsertTextMode.adjustIndentation),Lt}function he(J,ze){let it=Tr.InsertTextFormat.PlainText,at,Lt;ze.textEdit?(at=ze.textEdit.newText,Lt=ze.textEdit.range):ze.insertText instanceof ua.SnippetString?(it=Tr.InsertTextFormat.Snippet,at=ze.insertText.value):at=ze.insertText,ze.range&&(Lt=ze.range),J.insertTextFormat=it,ze.fromEdit&&at!==void 0&&Lt!==void 0?J.textEdit=oe(at,Lt):J.insertText=at}function oe(J,ze){return wJ.is(ze)?Tr.InsertReplaceEdit.create(J,U(ze.inserting),U(ze.replacing)):{newText:J,range:U(ze)}}function ne(J){return{range:U(J.range),newText:J.newText}}function ce(J){return J==null?J:J.map(ne)}function Ae(J){return J<=ua.SymbolKind.TypeParameter?J+1:Tr.SymbolKind.Property}function Ie(J){return J}function be(J){return J.map(Ie)}function De(J,ze,it){return{textDocument:i(J),position:L(ze),context:{includeDeclaration:it.includeDeclaration}}}async function Me(J,ze){let it=Tr.CodeAction.create(J.title);if(J instanceof ywe.default&&J.data!==void 0&&(it.data=J.data),J.kind!==void 0&&(it.kind=St(J.kind)),J.diagnostics!==void 0&&(it.diagnostics=await se(J.diagnostics,ze)),J.edit!==void 0)throw new Error("VS Code code actions can only be converted to a protocol code action without an edit.");return J.command!==void 0&&(it.command=an(J.command)),J.isPreferred!==void 0&&(it.isPreferred=J.isPreferred),J.disabled!==void 0&&(it.disabled={reason:J.disabled.reason}),it}function He(J){let ze=Tr.CodeAction.create(J.title);if(J instanceof ywe.default&&J.data!==void 0&&(ze.data=J.data),J.kind!==void 0&&(ze.kind=St(J.kind)),J.diagnostics!==void 0&&(ze.diagnostics=ee(J.diagnostics)),J.edit!==void 0)throw new Error("VS Code code actions can only be converted to a protocol code action without an edit.");return J.command!==void 0&&(ze.command=an(J.command)),J.isPreferred!==void 0&&(ze.isPreferred=J.isPreferred),J.disabled!==void 0&&(ze.disabled={reason:J.disabled.reason}),ze}async function Je(J,ze){if(J==null)return J;let it;return J.only&&Lb.string(J.only.value)&&(it=[J.only.value]),Tr.CodeActionContext.create(await se(J.diagnostics,ze),it,Ge(J.triggerKind))}function qe(J){if(J==null)return J;let ze;return J.only&&Lb.string(J.only.value)&&(ze=[J.only.value]),Tr.CodeActionContext.create(ee(J.diagnostics),ze,Ge(J.triggerKind))}function Ge(J){switch(J){case ua.CodeActionTriggerKind.Invoke:return Tr.CodeActionTriggerKind.Invoked;case ua.CodeActionTriggerKind.Automatic:return Tr.CodeActionTriggerKind.Automatic;default:return}}function St(J){if(J!=null)return J.value}function Pt(J){return J==null?J:Tr.InlineValueContext.create(J.frameId,U(J.stoppedLocation))}function on(J,ze,it){return{context:Tr.InlineCompletionContext.create(it.triggerKind,it.selectedCompletionInfo),textDocument:i(J),position:j(ze)}}function an(J){let ze=Tr.Command.create(J.title,J.command);return J.arguments&&(ze.arguments=J.arguments),ze}function Rt(J){let ze=Tr.CodeLens.create(U(J.range));return J.command&&(ze.command=an(J.command)),J instanceof oen.default&&J.data&&(ze.data=J.data),ze}function Xt(J,ze){const it={tabSize:J.tabSize,insertSpaces:J.insertSpaces};return ze.trimTrailingWhitespace&&(it.trimTrailingWhitespace=!0),ze.trimFinalNewlines&&(it.trimFinalNewlines=!0),ze.insertFinalNewline&&(it.insertFinalNewline=!0),it}function yn(J){return{textDocument:i(J)}}function bn(J){return{textDocument:i(J)}}function Kn(J){let ze=Tr.DocumentLink.create(U(J.range));J.target&&(ze.target=r(J.target)),J.tooltip!==void 0&&(ze.tooltip=J.tooltip);let it=J instanceof sen.default?J:void 0;return it&&it.data&&(ze.data=it.data),ze}function lr(J){return{textDocument:i(J)}}function Rr(J){const ze={name:J.name,kind:Ae(J.kind),uri:r(J.uri),range:U(J.range),selectionRange:U(J.selectionRange)};return J.detail!==void 0&&J.detail.length>0&&(ze.detail=J.detail),J.tags!==void 0&&(ze.tags=be(J.tags)),J instanceof aen.default&&J.data!==void 0&&(ze.data=J.data),ze}function Lr(J){const ze={name:J.name,kind:Ae(J.kind),uri:r(J.uri),range:U(J.range),selectionRange:U(J.selectionRange)};return J.detail!==void 0&&J.detail.length>0&&(ze.detail=J.detail),J.tags!==void 0&&(ze.tags=be(J.tags)),J instanceof cen.default&&J.data!==void 0&&(ze.data=J.data),ze}function er(J){const ze=J instanceof len.default?{name:J.name,kind:Ae(J.kind),location:J.hasRange?z(J.location):{uri:t(J.location.uri)},data:J.data}:{name:J.name,kind:Ae(J.kind),location:z(J.location)};return J.tags!==void 0&&(ze.tags=be(J.tags)),J.containerName!==""&&(ze.containerName=J.containerName),ze}function ke(J){const ze=typeof J.label=="string"?J.label:J.label.map(Qn),it=Tr.InlayHint.create(j(J.position),ze);return J.kind!==void 0&&(it.kind=J.kind),J.textEdits!==void 0&&(it.textEdits=ce(J.textEdits)),J.tooltip!==void 0&&(it.tooltip=Gn(J.tooltip)),J.paddingLeft!==void 0&&(it.paddingLeft=J.paddingLeft),J.paddingRight!==void 0&&(it.paddingRight=J.paddingRight),J instanceof uen.default&&J.data!==void 0&&(it.data=J.data),it}function Qn(J){const ze=Tr.InlayHintLabelPart.create(J.value);return J.location!==void 0&&(ze.location=z(J.location)),J.command!==void 0&&(ze.command=an(J.command)),J.tooltip!==void 0&&(ze.tooltip=Gn(J.tooltip)),ze}function Gn(J){return typeof J=="string"?J:{kind:Tr.MarkupKind.Markdown,value:J.value}}return{asUri:r,asTextDocumentIdentifier:i,asTextDocumentItem:o,asVersionedTextDocumentIdentifier:s,asOpenTextDocumentParams:a,asChangeTextDocumentParams:u,asCloseTextDocumentParams:d,asSaveTextDocumentParams:h,asWillSaveTextDocumentParams:p,asDidCreateFilesParams:g,asDidRenameFilesParams:m,asDidDeleteFilesParams:v,asWillCreateFilesParams:b,asWillRenameFilesParams:S,asWillDeleteFilesParams:E,asTextDocumentPositionParams:w,asCompletionParams:I,asSignatureHelpParams:k,asWorkerPosition:L,asRange:U,asRanges:K,asPosition:j,asPositions:N,asPositionsSync:B,asLocation:z,asDiagnosticSeverity:G,asDiagnosticTag:ie,asDiagnostic:Se,asDiagnostics:se,asDiagnosticsSync:ee,asCompletionItem:le,asTextEdit:ne,asSymbolKind:Ae,asSymbolTag:Ie,asSymbolTags:be,asReferenceParams:De,asCodeAction:Me,asCodeActionSync:He,asCodeActionContext:Je,asCodeActionContextSync:qe,asInlineValueContext:Pt,asCommand:an,asCodeLens:Rt,asFormattingOptions:Xt,asDocumentSymbolParams:yn,asCodeLensParams:bn,asDocumentLink:Kn,asDocumentLinkParams:lr,asCallHierarchyItem:Rr,asTypeHierarchyItem:Lr,asInlayHint:ke,asWorkspaceSymbol:er,asInlineCompletionParams:on}}kF.createConverter=den;var NF={};Object.defineProperty(NF,"__esModule",{value:!0});NF.createConverter=void 0;const pn=wr,br=Pr,yh=ji,Ti=nc,hen=TF,fen=DF,pen=RF,gen=AF,Swe=i_,men=OF,ven=MF,yen=$F,ben=LF,_we=Pr;var nL;(function(n){function e(t){let r=t;return r&&yh.string(r.language)&&yh.string(r.value)}n.is=e})(nL||(nL={}));function Sen(n,e,t){const i=n||(Z=>pn.Uri.parse(Z));function o(Z){return i(Z)}function s(Z){const ve=[];for(const W of Z)if(typeof W=="string")ve.push(W);else if(_we.NotebookCellTextDocumentFilter.is(W))if(typeof W.notebook=="string")ve.push({notebookType:W.notebook,language:W.language});else{const X=W.notebook.notebookType??"*";ve.push({notebookType:X,scheme:W.notebook.scheme,pattern:W.notebook.pattern,language:W.language})}else _we.TextDocumentFilter.is(W)&&ve.push({language:W.language,scheme:W.scheme,pattern:W.pattern});return ve}async function a(Z,ve){return Ti.map(Z,l,ve)}function c(Z){const ve=new Array(Z.length);for(let W=0;W<Z.length;W++)ve[W]=l(Z[W]);return ve}function l(Z){let ve=new Swe.ProtocolDiagnostic(p(Z.range),Z.message,m(Z.severity),Z.data);if(Z.code!==void 0){if(typeof Z.code=="string"||typeof Z.code=="number")br.CodeDescription.is(Z.codeDescription)?ve.code={value:Z.code,target:o(Z.codeDescription.href)}:ve.code=Z.code;else if(Swe.DiagnosticCode.is(Z.code)){ve.hasDiagnosticCode=!0;const W=Z.code;ve.code={value:W.value,target:o(W.target)}}}return Z.source&&(ve.source=Z.source),Z.relatedInformation&&(ve.relatedInformation=u(Z.relatedInformation)),Array.isArray(Z.tags)&&(ve.tags=d(Z.tags)),ve}function u(Z){const ve=new Array(Z.length);for(let W=0;W<Z.length;W++){const X=Z[W];ve[W]=new pn.DiagnosticRelatedInformation(G(X.location),X.message)}return ve}function d(Z){if(!Z)return;let ve=[];for(let W of Z){let X=h(W);X!==void 0&&ve.push(X)}return ve.length>0?ve:void 0}function h(Z){switch(Z){case br.DiagnosticTag.Unnecessary:return pn.DiagnosticTag.Unnecessary;case br.DiagnosticTag.Deprecated:return pn.DiagnosticTag.Deprecated;default:return}}function f(Z){return Z?new pn.Position(Z.line,Z.character):void 0}function p(Z){return Z?new pn.Range(Z.start.line,Z.start.character,Z.end.line,Z.end.character):void 0}async function g(Z,ve){return Ti.map(Z,W=>new pn.Range(W.start.line,W.start.character,W.end.line,W.end.character),ve)}function m(Z){if(Z==null)return pn.DiagnosticSeverity.Error;switch(Z){case br.DiagnosticSeverity.Error:return pn.DiagnosticSeverity.Error;case br.DiagnosticSeverity.Warning:return pn.DiagnosticSeverity.Warning;case br.DiagnosticSeverity.Information:return pn.DiagnosticSeverity.Information;case br.DiagnosticSeverity.Hint:return pn.DiagnosticSeverity.Hint}return pn.DiagnosticSeverity.Error}function v(Z){if(yh.string(Z))return S(Z);if(nL.is(Z))return S().appendCodeblock(Z.value,Z.language);if(Array.isArray(Z)){let ve=[];for(let W of Z){let X=S();nL.is(W)?X.appendCodeblock(W.value,W.language):X.appendMarkdown(W),ve.push(X)}return ve}else return S(Z)}function b(Z){if(yh.string(Z))return Z;switch(Z.kind){case br.MarkupKind.Markdown:return S(Z.value);case br.MarkupKind.PlainText:return Z.value;default:return`Unsupported Markup content received. Kind is: ${Z.kind}`}}function S(Z){let ve;if(Z===void 0||typeof Z=="string")ve=new pn.MarkdownString(Z);else switch(Z.kind){case br.MarkupKind.Markdown:ve=new pn.MarkdownString(Z.value);break;case br.MarkupKind.PlainText:ve=new pn.MarkdownString,ve.appendText(Z.value);break;default:ve=new pn.MarkdownString,ve.appendText(`Unsupported Markup content received. Kind is: ${Z.kind}`);break}return ve.isTrusted=e,ve.supportHtml=t,ve}function E(Z){if(Z)return new pn.Hover(v(Z.contents),p(Z.range))}async function w(Z,ve,W){if(!Z)return;if(Array.isArray(Z))return Ti.map(Z,or=>O(or,ve),W);const X=Z,{defaultRange:fe,commitCharacters:xt}=C(X,ve),Zt=await Ti.map(X.items,or=>{var tr,vo,fs;return O(or,xt,fe,(tr=X.itemDefaults)==null?void 0:tr.insertTextMode,(vo=X.itemDefaults)==null?void 0:vo.insertTextFormat,(fs=X.itemDefaults)==null?void 0:fs.data)},W);return new pn.CompletionList(Zt,X.isIncomplete)}function C(Z,ve){var fe,xt;const W=(fe=Z.itemDefaults)==null?void 0:fe.editRange,X=((xt=Z.itemDefaults)==null?void 0:xt.commitCharacters)??ve;return br.Range.is(W)?{defaultRange:p(W),commitCharacters:X}:W!==void 0?{defaultRange:{inserting:p(W.insert),replacing:p(W.replace)},commitCharacters:X}:{defaultRange:void 0,commitCharacters:X}}function I(Z){return br.CompletionItemKind.Text<=Z&&Z<=br.CompletionItemKind.TypeParameter?[Z-1,void 0]:[pn.CompletionItemKind.Text,Z]}function T(Z){switch(Z){case br.CompletionItemTag.Deprecated:return pn.CompletionItemTag.Deprecated}}function D(Z){if(Z==null)return[];const ve=[];for(const W of Z){const X=T(W);X!==void 0&&ve.push(X)}return ve}function O(Z,ve,W,X,fe,xt){const Zt=D(Z.tags),or=M(Z),tr=new hen.default(or);Z.detail&&(tr.detail=Z.detail),Z.documentation&&(tr.documentation=b(Z.documentation),tr.documentationFormat=yh.string(Z.documentation)?"$string":Z.documentation.kind),Z.filterText&&(tr.filterText=Z.filterText);const vo=R(Z,W,fe);if(vo&&(tr.insertText=vo.text,tr.range=vo.range,tr.fromEdit=vo.fromEdit),yh.number(Z.kind)){let[Tl,rs]=I(Z.kind);tr.kind=Tl,rs&&(tr.originalItemKind=rs)}Z.sortText&&(tr.sortText=Z.sortText),Z.additionalTextEdits&&(tr.additionalTextEdits=j(Z.additionalTextEdits));const fs=Z.commitCharacters!==void 0?yh.stringArray(Z.commitCharacters)?Z.commitCharacters:void 0:ve;fs&&(tr.commitCharacters=fs.slice()),Z.command&&(tr.command=ce(Z.command)),(Z.deprecated===!0||Z.deprecated===!1)&&(tr.deprecated=Z.deprecated,Z.deprecated===!0&&Zt.push(pn.CompletionItemTag.Deprecated)),(Z.preselect===!0||Z.preselect===!1)&&(tr.preselect=Z.preselect);const ps=Z.data??xt;ps!==void 0&&(tr.data=ps),Zt.length>0&&(tr.tags=Zt);const Wo=Z.insertTextMode??X;return Wo!==void 0&&(tr.insertTextMode=Wo,Wo===br.InsertTextMode.asIs&&(tr.keepWhitespace=!0)),tr}function M(Z){return br.CompletionItemLabelDetails.is(Z.labelDetails)?{label:Z.label,detail:Z.labelDetails.detail,description:Z.labelDetails.description}:Z.label}function R(Z,ve,W){const X=Z.insertTextFormat??W;if(Z.textEdit!==void 0||ve!==void 0){const[fe,xt]=Z.textEdit!==void 0?A(Z.textEdit):[ve,Z.textEditText??Z.label];return X===br.InsertTextFormat.Snippet?{text:new pn.SnippetString(xt),range:fe,fromEdit:!0}:{text:xt,range:fe,fromEdit:!0}}else return Z.insertText?X===br.InsertTextFormat.Snippet?{text:new pn.SnippetString(Z.insertText),fromEdit:!1}:{text:Z.insertText,fromEdit:!1}:void 0}function A(Z){return br.InsertReplaceEdit.is(Z)?[{inserting:p(Z.insert),replacing:p(Z.replace)},Z.newText]:[p(Z.range),Z.newText]}function k(Z){if(Z)return new pn.TextEdit(p(Z.range),Z.newText)}async function L(Z,ve){if(Z)return Ti.map(Z,k,ve)}function j(Z){if(!Z)return;const ve=new Array(Z.length);for(let W=0;W<Z.length;W++)ve[W]=k(Z[W]);return ve}async function N(Z,ve){if(!Z)return;let W=new pn.SignatureHelp;return yh.number(Z.activeSignature)?W.activeSignature=Z.activeSignature:W.activeSignature=0,yh.number(Z.activeParameter)?W.activeParameter=Z.activeParameter:W.activeParameter=0,Z.signatures&&(W.signatures=await B(Z.signatures,ve)),W}async function B(Z,ve){return Ti.mapAsync(Z,U,ve)}async function U(Z,ve){let W=new pn.SignatureInformation(Z.label);return Z.documentation!==void 0&&(W.documentation=b(Z.documentation)),Z.parameters!==void 0&&(W.parameters=await K(Z.parameters,ve)),Z.activeParameter!==void 0&&(W.activeParameter=Z.activeParameter),W}function K(Z,ve){return Ti.map(Z,z,ve)}function z(Z){let ve=new pn.ParameterInformation(Z.label);return Z.documentation&&(ve.documentation=b(Z.documentation)),ve}function G(Z){return Z?new pn.Location(i(Z.uri),p(Z.range)):void 0}async function te(Z,ve){if(Z)return ge(Z,ve)}async function ie(Z,ve){if(Z)return ge(Z,ve)}function Q(Z){if(!Z)return;let ve={targetUri:i(Z.targetUri),targetRange:p(Z.targetRange),originSelectionRange:p(Z.originSelectionRange),targetSelectionRange:p(Z.targetSelectionRange)};if(!ve.targetSelectionRange)throw new Error("targetSelectionRange must not be undefined or null");return ve}async function ge(Z,ve){if(Z)if(yh.array(Z)){if(Z.length===0)return[];if(br.LocationLink.is(Z[0])){const W=Z;return Ti.map(W,Q,ve)}else{const W=Z;return Ti.map(W,G,ve)}}else return br.LocationLink.is(Z)?[Q(Z)]:G(Z)}async function _e(Z,ve){if(Z)return Ti.map(Z,G,ve)}async function Se(Z,ve){if(Z)return Ti.map(Z,se,ve)}function se(Z){let ve=new pn.DocumentHighlight(p(Z.range));return yh.number(Z.kind)&&(ve.kind=ee(Z.kind)),ve}function ee(Z){switch(Z){case br.DocumentHighlightKind.Text:return pn.DocumentHighlightKind.Text;case br.DocumentHighlightKind.Read:return pn.DocumentHighlightKind.Read;case br.DocumentHighlightKind.Write:return pn.DocumentHighlightKind.Write}return pn.DocumentHighlightKind.Text}async function Y(Z,ve){if(Z)return Ti.map(Z,le,ve)}function ue(Z){return Z<=br.SymbolKind.TypeParameter?Z-1:pn.SymbolKind.Property}function ye(Z){switch(Z){case br.SymbolTag.Deprecated:return pn.SymbolTag.Deprecated;default:return}}function V(Z){if(Z==null)return;const ve=[];for(const W of Z){const X=ye(W);X!==void 0&&ve.push(X)}return ve.length===0?void 0:ve}function le(Z){const ve=Z.data,W=Z.location,X=W.range===void 0||ve!==void 0?new yen.default(Z.name,ue(Z.kind),Z.containerName??"",W.range===void 0?i(W.uri):new pn.Location(i(Z.location.uri),p(W.range)),ve):new pn.SymbolInformation(Z.name,ue(Z.kind),Z.containerName??"",new pn.Location(i(Z.location.uri),p(W.range)));return ne(X,Z),X}async function he(Z,ve){if(Z!=null)return Ti.map(Z,oe,ve)}function oe(Z){let ve=new pn.DocumentSymbol(Z.name,Z.detail||"",ue(Z.kind),p(Z.range),p(Z.selectionRange));if(ne(ve,Z),Z.children!==void 0&&Z.children.length>0){let W=[];for(let X of Z.children)W.push(oe(X));ve.children=W}return ve}function ne(Z,ve){Z.tags=V(ve.tags),ve.deprecated&&(Z.tags?Z.tags.includes(pn.SymbolTag.Deprecated)||(Z.tags=Z.tags.concat(pn.SymbolTag.Deprecated)):Z.tags=[pn.SymbolTag.Deprecated])}function ce(Z){let ve={title:Z.title,command:Z.command};return Z.arguments&&(ve.arguments=Z.arguments),ve}async function Ae(Z,ve){if(Z)return Ti.map(Z,ce,ve)}const Ie=new Map;Ie.set(br.CodeActionKind.Empty,pn.CodeActionKind.Empty),Ie.set(br.CodeActionKind.QuickFix,pn.CodeActionKind.QuickFix),Ie.set(br.CodeActionKind.Refactor,pn.CodeActionKind.Refactor),Ie.set(br.CodeActionKind.RefactorExtract,pn.CodeActionKind.RefactorExtract),Ie.set(br.CodeActionKind.RefactorInline,pn.CodeActionKind.RefactorInline),Ie.set(br.CodeActionKind.RefactorRewrite,pn.CodeActionKind.RefactorRewrite),Ie.set(br.CodeActionKind.Source,pn.CodeActionKind.Source),Ie.set(br.CodeActionKind.SourceOrganizeImports,pn.CodeActionKind.SourceOrganizeImports);function be(Z){if(Z==null)return;let ve=Ie.get(Z);if(ve)return ve;let W=Z.split(".");ve=pn.CodeActionKind.Empty;for(let X of W)ve=ve.append(X);return ve}function De(Z){if(Z!=null)return Z.map(ve=>be(ve))}async function Me(Z,ve){if(Z==null)return;let W=new gen.default(Z.title,Z.data);return Z.kind!==void 0&&(W.kind=be(Z.kind)),Z.diagnostics!==void 0&&(W.diagnostics=c(Z.diagnostics)),Z.edit!==void 0&&(W.edit=await Ge(Z.edit,ve)),Z.command!==void 0&&(W.command=ce(Z.command)),Z.isPreferred!==void 0&&(W.isPreferred=Z.isPreferred),Z.disabled!==void 0&&(W.disabled={reason:Z.disabled.reason}),W}function He(Z,ve){return Ti.mapAsync(Z,async W=>br.Command.is(W)?ce(W):Me(W,ve),ve)}function Je(Z){if(!Z)return;let ve=new fen.default(p(Z.range));return Z.command&&(ve.command=ce(Z.command)),Z.data!==void 0&&Z.data!==null&&(ve.data=Z.data),ve}async function qe(Z,ve){if(Z)return Ti.map(Z,Je,ve)}async function Ge(Z,ve){if(!Z)return;const W=new Map;if(Z.changeAnnotations!==void 0){const xt=Z.changeAnnotations;await Ti.forEach(Object.keys(xt),Zt=>{const or=St(xt[Zt]);W.set(Zt,or)},ve)}const X=xt=>{if(xt!==void 0)return W.get(xt)},fe=new pn.WorkspaceEdit;if(Z.documentChanges){const xt=Z.documentChanges;await Ti.forEach(xt,Zt=>{if(br.CreateFile.is(Zt))fe.createFile(i(Zt.uri),Zt.options,X(Zt.annotationId));else if(br.RenameFile.is(Zt))fe.renameFile(i(Zt.oldUri),i(Zt.newUri),Zt.options,X(Zt.annotationId));else if(br.DeleteFile.is(Zt))fe.deleteFile(i(Zt.uri),Zt.options,X(Zt.annotationId));else if(br.TextDocumentEdit.is(Zt)){const or=i(Zt.textDocument.uri);for(const tr of Zt.edits)br.AnnotatedTextEdit.is(tr)?fe.replace(or,p(tr.range),tr.newText,X(tr.annotationId)):fe.replace(or,p(tr.range),tr.newText)}else throw new Error(`Unknown workspace edit change received:
${JSON.stringify(Zt,void 0,4)}`)},ve)}else if(Z.changes){const xt=Z.changes;await Ti.forEach(Object.keys(xt),Zt=>{fe.set(i(Zt),j(xt[Zt]))},ve)}return fe}function St(Z){if(Z!==void 0)return{label:Z.label,needsConfirmation:!!Z.needsConfirmation,description:Z.description}}function Pt(Z){let ve=p(Z.range),W=Z.target?o(Z.target):void 0,X=new pen.default(ve,W);return Z.tooltip!==void 0&&(X.tooltip=Z.tooltip),Z.data!==void 0&&Z.data!==null&&(X.data=Z.data),X}async function on(Z,ve){if(Z)return Ti.map(Z,Pt,ve)}function an(Z){return new pn.Color(Z.red,Z.green,Z.blue,Z.alpha)}function Rt(Z){return new pn.ColorInformation(p(Z.range),an(Z.color))}async function Xt(Z,ve){if(Z)return Ti.map(Z,Rt,ve)}function yn(Z){let ve=new pn.ColorPresentation(Z.label);return ve.additionalTextEdits=j(Z.additionalTextEdits),Z.textEdit&&(ve.textEdit=k(Z.textEdit)),ve}async function bn(Z,ve){if(Z)return Ti.map(Z,yn,ve)}function Kn(Z){if(Z)switch(Z){case br.FoldingRangeKind.Comment:return pn.FoldingRangeKind.Comment;case br.FoldingRangeKind.Imports:return pn.FoldingRangeKind.Imports;case br.FoldingRangeKind.Region:return pn.FoldingRangeKind.Region}}function lr(Z){return new pn.FoldingRange(Z.startLine,Z.endLine,Kn(Z.kind))}async function Rr(Z,ve){if(Z)return Ti.map(Z,lr,ve)}function Lr(Z){return new pn.SelectionRange(p(Z.range),Z.parent?Lr(Z.parent):void 0)}async function er(Z,ve){return Array.isArray(Z)?Ti.map(Z,Lr,ve):[]}function ke(Z){return br.InlineValueText.is(Z)?new pn.InlineValueText(p(Z.range),Z.text):br.InlineValueVariableLookup.is(Z)?new pn.InlineValueVariableLookup(p(Z.range),Z.variableName,Z.caseSensitiveLookup):new pn.InlineValueEvaluatableExpression(p(Z.range),Z.expression)}async function Qn(Z,ve){return Array.isArray(Z)?Ti.map(Z,ke,ve):[]}async function Gn(Z,ve){const W=typeof Z.label=="string"?Z.label:await Ti.map(Z.label,J,ve),X=new ben.default(f(Z.position),W);return Z.kind!==void 0&&(X.kind=Z.kind),Z.textEdits!==void 0&&(X.textEdits=await L(Z.textEdits,ve)),Z.tooltip!==void 0&&(X.tooltip=ze(Z.tooltip)),Z.paddingLeft!==void 0&&(X.paddingLeft=Z.paddingLeft),Z.paddingRight!==void 0&&(X.paddingRight=Z.paddingRight),Z.data!==void 0&&(X.data=Z.data),X}function J(Z){const ve=new pn.InlayHintLabelPart(Z.value);return Z.location!==void 0&&(ve.location=G(Z.location)),Z.tooltip!==void 0&&(ve.tooltip=ze(Z.tooltip)),Z.command!==void 0&&(ve.command=ce(Z.command)),ve}function ze(Z){return typeof Z=="string"?Z:S(Z)}async function it(Z,ve){if(Array.isArray(Z))return Ti.mapAsync(Z,Gn,ve)}function at(Z){if(Z===null)return;const ve=new men.default(ue(Z.kind),Z.name,Z.detail||"",o(Z.uri),p(Z.range),p(Z.selectionRange),Z.data);return Z.tags!==void 0&&(ve.tags=V(Z.tags)),ve}async function Lt(Z,ve){if(Z!==null)return Ti.map(Z,at,ve)}async function fn(Z,ve){return new pn.CallHierarchyIncomingCall(at(Z.from),await g(Z.fromRanges,ve))}async function hn(Z,ve){if(Z!==null)return Ti.mapAsync(Z,fn,ve)}async function Ut(Z,ve){return new pn.CallHierarchyOutgoingCall(at(Z.to),await g(Z.fromRanges,ve))}async function sn(Z,ve){if(Z!==null)return Ti.mapAsync(Z,Ut,ve)}async function ae(Z,ve){if(Z!=null)return new pn.SemanticTokens(new Uint32Array(Z.data),Z.resultId)}function Wt(Z){return new pn.SemanticTokensEdit(Z.start,Z.deleteCount,Z.data!==void 0?new Uint32Array(Z.data):void 0)}async function un(Z,ve){if(Z!=null)return new pn.SemanticTokensEdits(Z.edits.map(Wt),Z.resultId)}function qt(Z){return Z}async function Ce(Z,ve){if(Z!=null)return new pn.LinkedEditingRanges(await g(Z.ranges,ve),ct(Z.wordPattern))}function ct(Z){if(Z!=null)return new RegExp(Z)}function At(Z){if(Z===null)return;let ve=new ven.default(ue(Z.kind),Z.name,Z.detail||"",o(Z.uri),p(Z.range),p(Z.selectionRange),Z.data);return Z.tags!==void 0&&(ve.tags=V(Z.tags)),ve}async function $t(Z,ve){if(Z!==null)return Ti.map(Z,At,ve)}function _n(Z){if(yh.string(Z))return Z;if(br.RelativePattern.is(Z)){if(br.URI.is(Z.baseUri))return new pn.RelativePattern(o(Z.baseUri),Z.pattern);if(br.WorkspaceFolder.is(Z.baseUri)){const ve=pn.workspace.getWorkspaceFolder(o(Z.baseUri.uri));return ve!==void 0?new pn.RelativePattern(ve,Z.pattern):void 0}}}async function jn(Z,ve){if(!Z)return;if(Array.isArray(Z))return Ti.map(Z,fe=>Zn(fe),ve);const W=Z,X=await Ti.map(W.items,fe=>Zn(fe),ve);return new pn.InlineCompletionList(X)}function Zn(Z){let ve;typeof Z.insertText=="string"?ve=Z.insertText:ve=new pn.SnippetString(Z.insertText.value);let W;Z.command&&(W=ce(Z.command));const X=new pn.InlineCompletionItem(ve,p(Z.range),W);return Z.filterText&&(X.filterText=Z.filterText),X}return{asUri:o,asDocumentSelector:s,asDiagnostics:a,asDiagnostic:l,asRange:p,asRanges:g,asPosition:f,asDiagnosticSeverity:m,asDiagnosticTag:h,asHover:E,asCompletionResult:w,asCompletionItem:O,asTextEdit:k,asTextEdits:L,asSignatureHelp:N,asSignatureInformations:B,asSignatureInformation:U,asParameterInformations:K,asParameterInformation:z,asDeclarationResult:te,asDefinitionResult:ie,asLocation:G,asReferences:_e,asDocumentHighlights:Se,asDocumentHighlight:se,asDocumentHighlightKind:ee,asSymbolKind:ue,asSymbolTag:ye,asSymbolTags:V,asSymbolInformations:Y,asSymbolInformation:le,asDocumentSymbols:he,asDocumentSymbol:oe,asCommand:ce,asCommands:Ae,asCodeAction:Me,asCodeActionKind:be,asCodeActionKinds:De,asCodeActionResult:He,asCodeLens:Je,asCodeLenses:qe,asWorkspaceEdit:Ge,asDocumentLink:Pt,asDocumentLinks:on,asFoldingRangeKind:Kn,asFoldingRange:lr,asFoldingRanges:Rr,asColor:an,asColorInformation:Rt,asColorInformations:Xt,asColorPresentation:yn,asColorPresentations:bn,asSelectionRange:Lr,asSelectionRanges:er,asInlineValue:ke,asInlineValues:Qn,asInlayHint:Gn,asInlayHints:it,asSemanticTokensLegend:qt,asSemanticTokens:ae,asSemanticTokensEdit:Wt,asSemanticTokensEdits:un,asCallHierarchyItem:at,asCallHierarchyItems:Lt,asCallHierarchyIncomingCall:fn,asCallHierarchyIncomingCalls:hn,asCallHierarchyOutgoingCall:Ut,asCallHierarchyOutgoingCalls:sn,asLinkedEditingRanges:Ce,asTypeHierarchyItem:At,asTypeHierarchyItems:$t,asGlobPattern:_n,asInlineCompletionResult:jn,asInlineCompletionItem:Zn}}NF.createConverter=Sen;var xi={};Object.defineProperty(xi,"__esModule",{value:!0});xi.generateUuid=xi.parse=xi.isUUID=xi.v4=xi.empty=void 0;class fse{constructor(e){this._value=e}asHex(){return this._value}equals(e){return this.asHex()===e.asHex()}}class ni extends fse{static _oneOf(e){return e[Math.floor(e.length*Math.random())]}static _randomHex(){return ni._oneOf(ni._chars)}constructor(){super([ni._randomHex(),ni._randomHex(),ni._randomHex(),ni._randomHex(),ni._randomHex(),ni._randomHex(),ni._randomHex(),ni._randomHex(),"-",ni._randomHex(),ni._randomHex(),ni._randomHex(),ni._randomHex(),"-","4",ni._randomHex(),ni._randomHex(),ni._randomHex(),"-",ni._oneOf(ni._timeHighBits),ni._randomHex(),ni._randomHex(),ni._randomHex(),"-",ni._randomHex(),ni._randomHex(),ni._randomHex(),ni._randomHex(),ni._randomHex(),ni._randomHex(),ni._randomHex(),ni._randomHex(),ni._randomHex(),ni._randomHex(),ni._randomHex(),ni._randomHex()].join(""))}}ni._chars=["0","1","2","3","4","5","6","6","7","8","9","a","b","c","d","e","f"];ni._timeHighBits=["8","9","a","b"];xi.empty=new fse("00000000-0000-0000-0000-000000000000");function LBe(){return new ni}xi.v4=LBe;const _en=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function NBe(n){return _en.test(n)}xi.isUUID=NBe;function wen(n){if(!NBe(n))throw new Error("invalid uuid");return new fse(n)}xi.parse=wen;function Cen(){return LBe().asHex()}xi.generateUuid=Cen;var rR={};Object.defineProperty(rR,"__esModule",{value:!0});rR.ProgressPart=void 0;const wwe=wr,Cwe=Pr,xwe=ji;class xen{constructor(e,t,r){this._client=e,this._token=t,this._reported=0,this._infinite=!1,this._lspProgressDisposable=this._client.onProgress(Cwe.WorkDoneProgress.type,this._token,i=>{switch(i.kind){case"begin":this.begin(i);break;case"report":this.report(i);break;case"end":this.done(),r&&r(this);break}})}begin(e){this._infinite=e.percentage===void 0,this._lspProgressDisposable!==void 0&&wwe.window.withProgress({location:wwe.ProgressLocation.Window,cancellable:e.cancellable,title:e.title},async(t,r)=>{if(this._lspProgressDisposable!==void 0)return this._progress=t,this._cancellationToken=r,this._tokenDisposable=this._cancellationToken.onCancellationRequested(()=>{this._client.sendNotification(Cwe.WorkDoneProgressCancelNotification.type,{token:this._token})}),this.report(e),new Promise((i,o)=>{this._resolve=i,this._reject=o})})}report(e){if(this._infinite&&xwe.string(e.message))this._progress!==void 0&&this._progress.report({message:e.message});else if(xwe.number(e.percentage)){const t=Math.max(0,Math.min(e.percentage,100)),r=Math.max(0,t-this._reported);this._reported+=r,this._progress!==void 0&&this._progress.report({message:e.message,increment:r})}}cancel(){this.cleanup(),this._reject!==void 0&&(this._reject(),this._resolve=void 0,this._reject=void 0)}done(){this.cleanup(),this._resolve!==void 0&&(this._resolve(),this._resolve=void 0,this._reject=void 0)}cleanup(){this._lspProgressDisposable!==void 0&&(this._lspProgressDisposable.dispose(),this._lspProgressDisposable=void 0),this._tokenDisposable!==void 0&&(this._tokenDisposable.dispose(),this._tokenDisposable=void 0),this._progress=void 0,this._cancellationToken=void 0}}rR.ProgressPart=xen;var yr={};Object.defineProperty(yr,"__esModule",{value:!0});yr.WorkspaceFeature=yr.TextDocumentLanguageFeature=yr.TextDocumentEventFeature=yr.DynamicDocumentFeature=yr.DynamicFeature=yr.StaticFeature=yr.ensure=yr.LSPCancellationError=void 0;const mS=wr,Dz=Pr,Kl=ji,Ewe=xi;class Een extends mS.CancellationError{constructor(e){super(),this.data=e}}yr.LSPCancellationError=Een;function Ien(n,e){return n[e]===void 0&&(n[e]={}),n[e]}yr.ensure=Ien;var Iwe;(function(n){function e(t){const r=t;return r!=null&&Kl.func(r.fillClientCapabilities)&&Kl.func(r.initialize)&&Kl.func(r.getState)&&Kl.func(r.clear)&&(r.fillInitializeParams===void 0||Kl.func(r.fillInitializeParams))}n.is=e})(Iwe||(yr.StaticFeature=Iwe={}));var Pwe;(function(n){function e(t){const r=t;return r!=null&&Kl.func(r.fillClientCapabilities)&&Kl.func(r.initialize)&&Kl.func(r.getState)&&Kl.func(r.clear)&&(r.fillInitializeParams===void 0||Kl.func(r.fillInitializeParams))&&Kl.func(r.register)&&Kl.func(r.unregister)&&r.registrationType!==void 0}n.is=e})(Pwe||(yr.DynamicFeature=Pwe={}));class pse{constructor(e){this._client=e}getState(){const e=this.getDocumentSelectors();let t=0;for(const i of e){t++;for(const o of mS.workspace.textDocuments)if(mS.languages.match(i,o)>0)return{kind:"document",id:this.registrationType.method,registrations:!0,matches:!0}}const r=t>0;return{kind:"document",id:this.registrationType.method,registrations:r,matches:!1}}}yr.DynamicDocumentFeature=pse;class Pen extends pse{static textDocumentFilter(e,t){for(const r of e)if(mS.languages.match(r,t)>0)return!0;return!1}constructor(e,t,r,i,o,s,a){super(e),this._event=t,this._type=r,this._middleware=i,this._createParams=o,this._textDocument=s,this._selectorFilter=a,this._selectors=new Map,this._onNotificationSent=new mS.EventEmitter}getStateInfo(){return[this._selectors.values(),!1]}getDocumentSelectors(){return this._selectors.values()}register(e){e.registerOptions.documentSelector&&(this._listener||(this._listener=this._event(t=>{this.callback(t).catch(r=>{this._client.error(`Sending document notification ${this._type.method} failed.`,r)})})),this._selectors.set(e.id,this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)))}async callback(e){const t=async r=>{const i=this._createParams(r);await this._client.sendNotification(this._type,i),this.notificationSent(this.getTextDocument(r),this._type,i)};if(this.matches(e)){const r=this._middleware();return r?r(e,i=>t(i)):t(e)}}matches(e){return this._client.hasDedicatedTextSynchronizationFeature(this._textDocument(e))?!1:!this._selectorFilter||this._selectorFilter(this._selectors.values(),e)}get onNotificationSent(){return this._onNotificationSent.event}notificationSent(e,t,r){this._onNotificationSent.fire({textDocument:e,type:t,params:r})}unregister(e){this._selectors.delete(e),this._selectors.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}clear(){this._selectors.clear(),this._onNotificationSent.dispose(),this._listener&&(this._listener.dispose(),this._listener=void 0)}getProvider(e){for(const t of this._selectors.values())if(mS.languages.match(t,e)>0)return{send:r=>this.callback(r)}}}yr.TextDocumentEventFeature=Pen;class ken extends pse{constructor(e,t){super(e),this._registrationType=t,this._registrations=new Map}*getDocumentSelectors(){for(const e of this._registrations.values()){const t=e.data.registerOptions.documentSelector;t!==null&&(yield this._client.protocol2CodeConverter.asDocumentSelector(t))}}get registrationType(){return this._registrationType}register(e){if(!e.registerOptions.documentSelector)return;let t=this.registerLanguageProvider(e.registerOptions,e.id);this._registrations.set(e.id,{disposable:t[0],data:e,provider:t[1]})}unregister(e){let t=this._registrations.get(e);t!==void 0&&t.disposable.dispose()}clear(){this._registrations.forEach(e=>{e.disposable.dispose()}),this._registrations.clear()}getRegistration(e,t){if(t){if(Dz.TextDocumentRegistrationOptions.is(t)){const r=Dz.StaticRegistrationOptions.hasId(t)?t.id:Ewe.generateUuid(),i=t.documentSelector??e;if(i)return[r,Object.assign({},t,{documentSelector:i})]}else if(Kl.boolean(t)&&t===!0||Dz.WorkDoneProgressOptions.is(t)){if(!e)return[void 0,void 0];const r=Kl.boolean(t)&&t===!0?{documentSelector:e}:Object.assign({},t,{documentSelector:e});return[Ewe.generateUuid(),r]}}else return[void 0,void 0];return[void 0,void 0]}getRegistrationOptions(e,t){if(!(!e||!t))return Kl.boolean(t)&&t===!0?{documentSelector:e}:Object.assign({},t,{documentSelector:e})}getProvider(e){for(const t of this._registrations.values()){let r=t.data.registerOptions.documentSelector;if(r!==null&&mS.languages.match(this._client.protocol2CodeConverter.asDocumentSelector(r),e)>0)return t.provider}}getAllProviders(){const e=[];for(const t of this._registrations.values())e.push(t.provider);return e}}yr.TextDocumentLanguageFeature=ken;class Ten{constructor(e,t){this._client=e,this._registrationType=t,this._registrations=new Map}getState(){const e=this._registrations.size>0;return{kind:"workspace",id:this._registrationType.method,registrations:e}}get registrationType(){return this._registrationType}register(e){const t=this.registerLanguageProvider(e.registerOptions);this._registrations.set(e.id,{disposable:t[0],provider:t[1]})}unregister(e){let t=this._registrations.get(e);t!==void 0&&t.disposable.dispose()}clear(){this._registrations.forEach(e=>{e.disposable.dispose()}),this._registrations.clear()}getProviders(){const e=[];for(const t of this._registrations.values())e.push(t.provider);return e}}yr.WorkspaceFeature=Ten;var ev={};const Den=typeof process=="object"&&process&&process.platform==="win32";var Ren=Den?{sep:"\\"}:{sep:"/"},Aen=FBe;function FBe(n,e,t){n instanceof RegExp&&(n=kwe(n,t)),e instanceof RegExp&&(e=kwe(e,t));var r=jBe(n,e,t);return r&&{start:r[0],end:r[1],pre:t.slice(0,r[0]),body:t.slice(r[0]+n.length,r[1]),post:t.slice(r[1]+e.length)}}function kwe(n,e){var t=e.match(n);return t?t[0]:null}FBe.range=jBe;function jBe(n,e,t){var r,i,o,s,a,c=t.indexOf(n),l=t.indexOf(e,c+1),u=c;if(c>=0&&l>0){if(n===e)return[c,l];for(r=[],o=t.length;u>=0&&!a;)u==c?(r.push(u),c=t.indexOf(n,u+1)):r.length==1?a=[r.pop(),l]:(i=r.pop(),i<o&&(o=i,s=l),l=t.indexOf(e,u+1)),u=c<l&&c>=0?c:l;r.length&&(a=[o,s])}return a}var BBe=Aen,Oen=Len,HBe="\0SLASH"+Math.random()+"\0",UBe="\0OPEN"+Math.random()+"\0",gse="\0CLOSE"+Math.random()+"\0",zBe="\0COMMA"+Math.random()+"\0",VBe="\0PERIOD"+Math.random()+"\0";function Rz(n){return parseInt(n,10)==n?parseInt(n,10):n.charCodeAt(0)}function Men(n){return n.split("\\\\").join(HBe).split("\\{").join(UBe).split("\\}").join(gse).split("\\,").join(zBe).split("\\.").join(VBe)}function $en(n){return n.split(HBe).join("\\").split(UBe).join("{").split(gse).join("}").split(zBe).join(",").split(VBe).join(".")}function WBe(n){if(!n)return[""];var e=[],t=BBe("{","}",n);if(!t)return n.split(",");var r=t.pre,i=t.body,o=t.post,s=r.split(",");s[s.length-1]+="{"+i+"}";var a=WBe(o);return o.length&&(s[s.length-1]+=a.shift(),s.push.apply(s,a)),e.push.apply(e,s),e}function Len(n){return n?(n.substr(0,2)==="{}"&&(n="\\{\\}"+n.substr(2)),xP(Men(n),!0).map($en)):[]}function Nen(n){return"{"+n+"}"}function Fen(n){return/^-?0\d/.test(n)}function jen(n,e){return n<=e}function Ben(n,e){return n>=e}function xP(n,e){var t=[],r=BBe("{","}",n);if(!r)return[n];var i=r.pre,o=r.post.length?xP(r.post,!1):[""];if(/\$$/.test(r.pre))for(var s=0;s<o.length;s++){var a=i+"{"+r.body+"}"+o[s];t.push(a)}else{var c=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(r.body),l=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(r.body),u=c||l,d=r.body.indexOf(",")>=0;if(!u&&!d)return r.post.match(/,.*\}/)?(n=r.pre+"{"+r.body+gse+r.post,xP(n)):[n];var h;if(u)h=r.body.split(/\.\./);else if(h=WBe(r.body),h.length===1&&(h=xP(h[0],!1).map(Nen),h.length===1))return o.map(function(O){return r.pre+h[0]+O});var f;if(u){var p=Rz(h[0]),g=Rz(h[1]),m=Math.max(h[0].length,h[1].length),v=h.length==3?Math.abs(Rz(h[2])):1,b=jen,S=g<p;S&&(v*=-1,b=Ben);var E=h.some(Fen);f=[];for(var w=p;b(w,g);w+=v){var C;if(l)C=String.fromCharCode(w),C==="\\"&&(C="");else if(C=String(w),E){var I=m-C.length;if(I>0){var T=new Array(I+1).join("0");w<0?C="-"+T+C.slice(1):C=T+C}}f.push(C)}}else{f=[];for(var D=0;D<h.length;D++)f.push.apply(f,xP(h[D],!1))}for(var D=0;D<f.length;D++)for(var s=0;s<o.length;s++){var a=i+f[D]+o[s];(!e||u||a)&&t.push(a)}}return t}const Hd=FF=(n,e,t={})=>(rL(e),!t.nocomment&&e.charAt(0)==="#"?!1:new jF(e,t).match(n));var FF=Hd;const CJ=Ren;Hd.sep=CJ.sep;const pf=Symbol("globstar **");Hd.GLOBSTAR=pf;const Hen=Oen,Twe={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},xJ="[^/]",Az=xJ+"*?",Uen="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",zen="(?:(?!(?:\\/|^)\\.).)*?",qBe=n=>n.split("").reduce((e,t)=>(e[t]=!0,e),{}),Dwe=qBe("().*{}+?[]^$\\!"),Ven=qBe("[.("),Rwe=/\/+/;Hd.filter=(n,e={})=>(t,r,i)=>Hd(t,n,e);const e0=(n,e={})=>{const t={};return Object.keys(n).forEach(r=>t[r]=n[r]),Object.keys(e).forEach(r=>t[r]=e[r]),t};Hd.defaults=n=>{if(!n||typeof n!="object"||!Object.keys(n).length)return Hd;const e=Hd,t=(r,i,o)=>e(r,i,e0(n,o));return t.Minimatch=class extends e.Minimatch{constructor(i,o){super(i,e0(n,o))}},t.Minimatch.defaults=r=>e.defaults(e0(n,r)).Minimatch,t.filter=(r,i)=>e.filter(r,e0(n,i)),t.defaults=r=>e.defaults(e0(n,r)),t.makeRe=(r,i)=>e.makeRe(r,e0(n,i)),t.braceExpand=(r,i)=>e.braceExpand(r,e0(n,i)),t.match=(r,i,o)=>e.match(r,i,e0(n,o)),t};Hd.braceExpand=(n,e)=>KBe(n,e);const KBe=(n,e={})=>(rL(n),e.nobrace||!/\{(?:(?!\{).)*\}/.test(n)?[n]:Hen(n)),Wen=1024*64,rL=n=>{if(typeof n!="string")throw new TypeError("invalid pattern");if(n.length>Wen)throw new TypeError("pattern is too long")},Oz=Symbol("subparse");Hd.makeRe=(n,e)=>new jF(n,e||{}).makeRe();Hd.match=(n,e,t={})=>{const r=new jF(e,t);return n=n.filter(i=>r.match(i)),r.options.nonull&&!n.length&&n.push(e),n};const qen=n=>n.replace(/\\(.)/g,"$1"),Ken=n=>n.replace(/\\([^-\]])/g,"$1"),Gen=n=>n.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),Zen=n=>n.replace(/[[\]\\]/g,"\\$&");class jF{constructor(e,t){rL(e),t||(t={}),this.options=t,this.set=[],this.pattern=e,this.windowsPathsNoEscape=!!t.windowsPathsNoEscape||t.allowWindowsEscape===!1,this.windowsPathsNoEscape&&(this.pattern=this.pattern.replace(/\\/g,"/")),this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.partial=!!t.partial,this.make()}debug(){}make(){const e=this.pattern,t=this.options;if(!t.nocomment&&e.charAt(0)==="#"){this.comment=!0;return}if(!e){this.empty=!0;return}this.parseNegate();let r=this.globSet=this.braceExpand();t.debug&&(this.debug=(...i)=>console.error(...i)),this.debug(this.pattern,r),r=this.globParts=r.map(i=>i.split(Rwe)),this.debug(this.pattern,r),r=r.map((i,o,s)=>i.map(this.parse,this)),this.debug(this.pattern,r),r=r.filter(i=>i.indexOf(!1)===-1),this.debug(this.pattern,r),this.set=r}parseNegate(){if(this.options.nonegate)return;const e=this.pattern;let t=!1,r=0;for(let i=0;i<e.length&&e.charAt(i)==="!";i++)t=!t,r++;r&&(this.pattern=e.slice(r)),this.negate=t}matchOne(e,t,r){var i=this.options;this.debug("matchOne",{this:this,file:e,pattern:t}),this.debug("matchOne",e.length,t.length);for(var o=0,s=0,a=e.length,c=t.length;o<a&&s<c;o++,s++){this.debug("matchOne loop");var l=t[s],u=e[o];if(this.debug(t,l,u),l===!1)return!1;if(l===pf){this.debug("GLOBSTAR",[t,l,u]);var d=o,h=s+1;if(h===c){for(this.debug("** at the end");o<a;o++)if(e[o]==="."||e[o]===".."||!i.dot&&e[o].charAt(0)===".")return!1;return!0}for(;d<a;){var f=e[d];if(this.debug(`
globstar while`,e,d,t,h,f),this.matchOne(e.slice(d),t.slice(h),r))return this.debug("globstar found match!",d,a,f),!0;if(f==="."||f===".."||!i.dot&&f.charAt(0)==="."){this.debug("dot detected!",e,d,t,h);break}this.debug("globstar swallow a segment, and continue"),d++}return!!(r&&(this.debug(`
>>> no match, partial?`,e,d,t,h),d===a))}var p;if(typeof l=="string"?(p=u===l,this.debug("string match",l,u,p)):(p=u.match(l),this.debug("pattern match",l,u,p)),!p)return!1}if(o===a&&s===c)return!0;if(o===a)return r;if(s===c)return o===a-1&&e[o]==="";throw new Error("wtf?")}braceExpand(){return KBe(this.pattern,this.options)}parse(e,t){rL(e);const r=this.options;if(e==="**")if(r.noglobstar)e="*";else return pf;if(e==="")return"";let i="",o=!1,s=!1;const a=[],c=[];let l,u=!1,d=-1,h=-1,f,p,g,m=e.charAt(0)===".",v=r.dot||m;const b=()=>m?"":v?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",S=I=>I.charAt(0)==="."?"":r.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",E=()=>{if(l){switch(l){case"*":i+=Az,o=!0;break;case"?":i+=xJ,o=!0;break;default:i+="\\"+l;break}this.debug("clearStateChar %j %j",l,i),l=!1}};for(let I=0,T;I<e.length&&(T=e.charAt(I));I++){if(this.debug("%s	%s %s %j",e,I,i,T),s){if(T==="/")return!1;Dwe[T]&&(i+="\\"),i+=T,s=!1;continue}switch(T){case"/":return!1;case"\\":if(u&&e.charAt(I+1)==="-"){i+=T;continue}E(),s=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s	%s %s %j <-- stateChar",e,I,i,T),u){this.debug("  in class"),T==="!"&&I===h+1&&(T="^"),i+=T;continue}this.debug("call clearStateChar %j",l),E(),l=T,r.noext&&E();continue;case"(":{if(u){i+="(";continue}if(!l){i+="\\(";continue}const D={type:l,start:I-1,reStart:i.length,open:Twe[l].open,close:Twe[l].close};this.debug(this.pattern,"	",D),a.push(D),i+=D.open,D.start===0&&D.type!=="!"&&(m=!0,i+=S(e.slice(I+1))),this.debug("plType %j %j",l,i),l=!1;continue}case")":{const D=a[a.length-1];if(u||!D){i+="\\)";continue}a.pop(),E(),o=!0,p=D,i+=p.close,p.type==="!"&&c.push(Object.assign(p,{reEnd:i.length}));continue}case"|":{const D=a[a.length-1];if(u||!D){i+="\\|";continue}E(),i+="|",D.start===0&&D.type!=="!"&&(m=!0,i+=S(e.slice(I+1)));continue}case"[":if(E(),u){i+="\\"+T;continue}u=!0,h=I,d=i.length,i+=T;continue;case"]":if(I===h+1||!u){i+="\\"+T;continue}f=e.substring(h+1,I);try{RegExp("["+Zen(Ken(f))+"]"),i+=T}catch{i=i.substring(0,d)+"(?:$.)"}o=!0,u=!1;continue;default:E(),Dwe[T]&&!(T==="^"&&u)&&(i+="\\"),i+=T;break}}for(u&&(f=e.slice(h+1),g=this.parse(f,Oz),i=i.substring(0,d)+"\\["+g[0],o=o||g[1]),p=a.pop();p;p=a.pop()){let I;I=i.slice(p.reStart+p.open.length),this.debug("setting tail",i,p),I=I.replace(/((?:\\{2}){0,64})(\\?)\|/g,(D,O,M)=>(M||(M="\\"),O+O+M+"|")),this.debug(`tail=%j
   %s`,I,I,p,i);const T=p.type==="*"?Az:p.type==="?"?xJ:"\\"+p.type;o=!0,i=i.slice(0,p.reStart)+T+"\\("+I}E(),s&&(i+="\\\\");const w=Ven[i.charAt(0)];for(let I=c.length-1;I>-1;I--){const T=c[I],D=i.slice(0,T.reStart),O=i.slice(T.reStart,T.reEnd-8);let M=i.slice(T.reEnd);const R=i.slice(T.reEnd-8,T.reEnd)+M,A=D.split(")").length,k=D.split("(").length-A;let L=M;for(let N=0;N<k;N++)L=L.replace(/\)[+*?]?/,"");M=L;const j=M===""&&t!==Oz?"(?:$|\\/)":"";i=D+O+M+j+R}if(i!==""&&o&&(i="(?=.)"+i),w&&(i=b()+i),t===Oz)return[i,o];if(r.nocase&&!o&&(o=e.toUpperCase()!==e.toLowerCase()),!o)return qen(e);const C=r.nocase?"i":"";try{return Object.assign(new RegExp("^"+i+"$",C),{_glob:e,_src:i})}catch{return new RegExp("$.")}}makeRe(){if(this.regexp||this.regexp===!1)return this.regexp;const e=this.set;if(!e.length)return this.regexp=!1,this.regexp;const t=this.options,r=t.noglobstar?Az:t.dot?Uen:zen,i=t.nocase?"i":"";let o=e.map(s=>(s=s.map(a=>typeof a=="string"?Gen(a):a===pf?pf:a._src).reduce((a,c)=>(a[a.length-1]===pf&&c===pf||a.push(c),a),[]),s.forEach((a,c)=>{a!==pf||s[c-1]===pf||(c===0?s.length>1?s[c+1]="(?:\\/|"+r+"\\/)?"+s[c+1]:s[c]=r:c===s.length-1?s[c-1]+="(?:\\/|"+r+")?":(s[c-1]+="(?:\\/|\\/"+r+"\\/)"+s[c+1],s[c+1]=pf))}),s.filter(a=>a!==pf).join("/"))).join("|");o="^(?:"+o+")$",this.negate&&(o="^(?!"+o+").*$");try{this.regexp=new RegExp(o,i)}catch{this.regexp=!1}return this.regexp}match(e,t=this.partial){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return e==="";if(e==="/"&&t)return!0;const r=this.options;CJ.sep!=="/"&&(e=e.split(CJ.sep).join("/")),e=e.split(Rwe),this.debug(this.pattern,"split",e);const i=this.set;this.debug(this.pattern,"set",i);let o;for(let s=e.length-1;s>=0&&(o=e[s],!o);s--);for(let s=0;s<i.length;s++){const a=i[s];let c=e;if(r.matchBase&&a.length===1&&(c=[o]),this.matchOne(c,a,t))return r.flipNegate?!0:!this.negate}return r.flipNegate?!1:this.negate}static defaults(e){return Hd.defaults(e).Minimatch}}Hd.Minimatch=jF;Object.defineProperty(ev,"__esModule",{value:!0});ev.DiagnosticFeature=ev.DiagnosticPullMode=ev.vsdiag=void 0;const Xen=FF,di=wr,As=Pr,Yen=xi,EJ=yr;function zA(n,e){return n[e]===void 0&&(n[e]={}),n[e]}var bh;(function(n){(function(e){e.full="full",e.unChanged="unChanged"})(n.DocumentDiagnosticReportKind||(n.DocumentDiagnosticReportKind={}))})(bh||(ev.vsdiag=bh={}));var iL;(function(n){n.onType="onType",n.onSave="onSave"})(iL||(ev.DiagnosticPullMode=iL={}));var il;(function(n){n.active="open",n.reschedule="reschedule",n.outDated="drop"})(il||(il={}));class bk{constructor(){this.open=new Set,this._onOpen=new di.EventEmitter,this._onClose=new di.EventEmitter,bk.fillTabResources(this.open);const e=t=>{if(t.closed.length===0&&t.opened.length===0)return;const r=this.open,i=new Set;bk.fillTabResources(i);const o=new Set,s=new Set(i);for(const a of r.values())i.has(a)?s.delete(a):o.add(a);if(this.open=i,o.size>0){const a=new Set;for(const c of o)a.add(di.Uri.parse(c));this._onClose.fire(a)}if(s.size>0){const a=new Set;for(const c of s)a.add(di.Uri.parse(c));this._onOpen.fire(a)}};di.window.tabGroups.onDidChangeTabs!==void 0?this.disposable=di.window.tabGroups.onDidChangeTabs(e):this.disposable={dispose:()=>{}}}get onClose(){return this._onClose.event}get onOpen(){return this._onOpen.event}dispose(){this.disposable.dispose()}isActive(e){var t,r;return e instanceof di.Uri?((t=di.window.activeTextEditor)==null?void 0:t.document.uri)===e:((r=di.window.activeTextEditor)==null?void 0:r.document)===e}isVisible(e){const t=e instanceof di.Uri?e:e.uri;return this.open.has(t.toString())}getTabResources(){const e=new Set;return bk.fillTabResources(new Set,e),e}static fillTabResources(e,t){const r=e??new Set;for(const i of di.window.tabGroups.all)for(const o of i.tabs){const s=o.input;let a;s instanceof di.TabInputText?a=s.uri:s instanceof di.TabInputTextDiff?a=s.modified:s instanceof di.TabInputCustom&&(a=s.uri),a!==void 0&&!r.has(a.toString())&&(r.add(a.toString()),t!==void 0&&t.add(a))}}}var Aa;(function(n){n[n.document=1]="document",n[n.workspace=2]="workspace"})(Aa||(Aa={}));var jm;(function(n){function e(t){return t instanceof di.Uri?t.toString():t.uri.toString()}n.asKey=e})(jm||(jm={}));class Jen{constructor(){this.documentPullStates=new Map,this.workspacePullStates=new Map}track(e,t,r){const i=e===Aa.document?this.documentPullStates:this.workspacePullStates,[o,s,a]=t instanceof di.Uri?[t.toString(),t,r]:[t.uri.toString(),t.uri,t.version];let c=i.get(o);return c===void 0&&(c={document:s,pulledVersion:a,resultId:void 0},i.set(o,c)),c}update(e,t,r,i){const o=e===Aa.document?this.documentPullStates:this.workspacePullStates,[s,a,c,l]=t instanceof di.Uri?[t.toString(),t,r,i]:[t.uri.toString(),t.uri,t.version,r];let u=o.get(s);u===void 0?(u={document:a,pulledVersion:c,resultId:l},o.set(s,u)):(u.pulledVersion=c,u.resultId=l)}unTrack(e,t){const r=jm.asKey(t);(e===Aa.document?this.documentPullStates:this.workspacePullStates).delete(r)}tracks(e,t){const r=jm.asKey(t);return(e===Aa.document?this.documentPullStates:this.workspacePullStates).has(r)}getResultId(e,t){var o;const r=jm.asKey(t);return(o=(e===Aa.document?this.documentPullStates:this.workspacePullStates).get(r))==null?void 0:o.resultId}getAllResultIds(){const e=[];for(let[t,r]of this.workspacePullStates)this.documentPullStates.has(t)&&(r=this.documentPullStates.get(t)),r.resultId!==void 0&&e.push({uri:t,value:r.resultId});return e}}class Qen{constructor(e,t,r){this.client=e,this.tabs=t,this.options=r,this.isDisposed=!1,this.onDidChangeDiagnosticsEmitter=new di.EventEmitter,this.provider=this.createProvider(),this.diagnostics=di.languages.createDiagnosticCollection(r.identifier),this.openRequests=new Map,this.documentStates=new Jen,this.workspaceErrorCounter=0}knows(e,t){const r=t instanceof di.Uri?t:t.uri;return this.documentStates.tracks(e,t)||this.openRequests.has(r.toString())}forget(e,t){this.documentStates.unTrack(e,t)}pull(e,t){if(this.isDisposed)return;const r=e instanceof di.Uri?e:e.uri;this.pullAsync(e).then(()=>{t&&t()},i=>{this.client.error(`Document pull failed for text document ${r.toString()}`,i,!1)})}async pullAsync(e,t){if(this.isDisposed)return;const r=e instanceof di.Uri,i=r?e:e.uri,o=i.toString();t=r?t:e.version;const s=this.openRequests.get(o),a=r?this.documentStates.track(Aa.document,e,t):this.documentStates.track(Aa.document,e);if(s===void 0){const c=new di.CancellationTokenSource;this.openRequests.set(o,{state:il.active,document:e,version:t,tokenSource:c});let l,u;try{l=await this.provider.provideDiagnostics(e,a.resultId,c.token)??{kind:bh.DocumentDiagnosticReportKind.full,items:[]}}catch(d){if(d instanceof EJ.LSPCancellationError&&As.DiagnosticServerCancellationData.is(d.data)&&d.data.retriggerRequest===!1&&(u={state:il.outDated,document:e}),u===void 0&&d instanceof di.CancellationError)u={state:il.reschedule,document:e};else throw d}if(u=u??this.openRequests.get(o),u===void 0){this.client.error(`Lost request state in diagnostic pull model. Clearing diagnostics for ${o}`),this.diagnostics.delete(i);return}if(this.openRequests.delete(o),!this.tabs.isVisible(e)){this.documentStates.unTrack(Aa.document,e);return}if(u.state===il.outDated)return;l!==void 0&&(l.kind===bh.DocumentDiagnosticReportKind.full&&this.diagnostics.set(i,l.items),a.pulledVersion=t,a.resultId=l.resultId),u.state===il.reschedule&&this.pull(e)}else s.state===il.active?(s.tokenSource.cancel(),this.openRequests.set(o,{state:il.reschedule,document:s.document})):s.state===il.outDated&&this.openRequests.set(o,{state:il.reschedule,document:s.document})}forgetDocument(e){const t=e instanceof di.Uri?e:e.uri,r=t.toString(),i=this.openRequests.get(r);this.options.workspaceDiagnostics?i!==void 0?this.openRequests.set(r,{state:il.reschedule,document:e}):this.pull(e,()=>{this.forget(Aa.document,e)}):(i!==void 0&&(i.state===il.active&&i.tokenSource.cancel(),this.openRequests.set(r,{state:il.outDated,document:e})),this.diagnostics.delete(t),this.forget(Aa.document,e))}pullWorkspace(){this.isDisposed||this.pullWorkspaceAsync().then(()=>{this.workspaceTimeout=(0,As.RAL)().timer.setTimeout(()=>{this.pullWorkspace()},2e3)},e=>{!(e instanceof EJ.LSPCancellationError)&&!As.DiagnosticServerCancellationData.is(e.data)&&(this.client.error("Workspace diagnostic pull failed.",e,!1),this.workspaceErrorCounter++),this.workspaceErrorCounter<=5&&(this.workspaceTimeout=(0,As.RAL)().timer.setTimeout(()=>{this.pullWorkspace()},2e3))})}async pullWorkspaceAsync(){if(!this.provider.provideWorkspaceDiagnostics||this.isDisposed)return;this.workspaceCancellation!==void 0&&(this.workspaceCancellation.cancel(),this.workspaceCancellation=void 0),this.workspaceCancellation=new di.CancellationTokenSource;const e=this.documentStates.getAllResultIds().map(t=>({uri:this.client.protocol2CodeConverter.asUri(t.uri),value:t.value}));await this.provider.provideWorkspaceDiagnostics(e,this.workspaceCancellation.token,t=>{if(!(!t||this.isDisposed))for(const r of t.items)r.kind===bh.DocumentDiagnosticReportKind.full&&(this.documentStates.tracks(Aa.document,r.uri)||this.diagnostics.set(r.uri,r.items)),this.documentStates.update(Aa.workspace,r.uri,r.version??void 0,r.resultId)})}createProvider(){const e={onDidChangeDiagnostics:this.onDidChangeDiagnosticsEmitter.event,provideDiagnostics:(t,r,i)=>{const o=(a,c,l)=>{const u={identifier:this.options.identifier,textDocument:{uri:this.client.code2ProtocolConverter.asUri(a instanceof di.Uri?a:a.uri)},previousResultId:c};return this.isDisposed===!0||!this.client.isRunning()?{kind:bh.DocumentDiagnosticReportKind.full,items:[]}:this.client.sendRequest(As.DocumentDiagnosticRequest.type,u,l).then(async d=>d==null||this.isDisposed||l.isCancellationRequested?{kind:bh.DocumentDiagnosticReportKind.full,items:[]}:d.kind===As.DocumentDiagnosticReportKind.Full?{kind:bh.DocumentDiagnosticReportKind.full,resultId:d.resultId,items:await this.client.protocol2CodeConverter.asDiagnostics(d.items,l)}:{kind:bh.DocumentDiagnosticReportKind.unChanged,resultId:d.resultId},d=>this.client.handleFailedRequest(As.DocumentDiagnosticRequest.type,l,d,{kind:bh.DocumentDiagnosticReportKind.full,items:[]}))},s=this.client.middleware;return s.provideDiagnostics?s.provideDiagnostics(t,r,i,o):o(t,r,i)}};return this.options.workspaceDiagnostics&&(e.provideWorkspaceDiagnostics=(t,r,i)=>{const o=async l=>l.kind===As.DocumentDiagnosticReportKind.Full?{kind:bh.DocumentDiagnosticReportKind.full,uri:this.client.protocol2CodeConverter.asUri(l.uri),resultId:l.resultId,version:l.version,items:await this.client.protocol2CodeConverter.asDiagnostics(l.items,r)}:{kind:bh.DocumentDiagnosticReportKind.unChanged,uri:this.client.protocol2CodeConverter.asUri(l.uri),resultId:l.resultId,version:l.version},s=l=>{const u=[];for(const d of l)u.push({uri:this.client.code2ProtocolConverter.asUri(d.uri),value:d.value});return u},a=(l,u)=>{const d=(0,Yen.generateUuid)(),h=this.client.onProgress(As.WorkspaceDiagnosticRequest.partialResult,d,async p=>{if(p==null){i(null);return}const g={items:[]};for(const m of p.items)try{g.items.push(await o(m))}catch(v){this.client.error("Converting workspace diagnostics failed.",v)}i(g)}),f={identifier:this.options.identifier,previousResultIds:s(l),partialResultToken:d};return this.isDisposed===!0||!this.client.isRunning()?{items:[]}:this.client.sendRequest(As.WorkspaceDiagnosticRequest.type,f,u).then(async p=>{if(u.isCancellationRequested)return{items:[]};const g={items:[]};for(const m of p.items)g.items.push(await o(m));return h.dispose(),i(g),{items:[]}},p=>(h.dispose(),this.client.handleFailedRequest(As.DocumentDiagnosticRequest.type,u,p,{items:[]})))},c=this.client.middleware;return c.provideWorkspaceDiagnostics?c.provideWorkspaceDiagnostics(t,r,i,a):a(t,r)}),e}dispose(){var e,t;this.isDisposed=!0,(e=this.workspaceCancellation)==null||e.cancel(),(t=this.workspaceTimeout)==null||t.dispose();for(const[r,i]of this.openRequests)i.state===il.active&&i.tokenSource.cancel(),this.openRequests.set(r,{state:il.outDated,document:i.document});this.diagnostics.dispose()}}class etn{constructor(e){this.diagnosticRequestor=e,this.documents=new As.LinkedMap,this.isDisposed=!1}add(e){if(this.isDisposed===!0)return;const t=jm.asKey(e);this.documents.has(t)||(this.documents.set(t,e,As.Touch.Last),this.trigger())}remove(e){const t=jm.asKey(e);this.documents.delete(t),this.documents.size===0?this.stop():t===this.endDocumentKey()&&(this.endDocument=this.documents.last)}trigger(){if(this.isDisposed!==!0){if(this.intervalHandle!==void 0){this.endDocument=this.documents.last;return}this.endDocument=this.documents.last,this.intervalHandle=(0,As.RAL)().timer.setInterval(()=>{const e=this.documents.first;if(e!==void 0){const t=jm.asKey(e);this.diagnosticRequestor.pull(e),this.documents.set(t,e,As.Touch.Last),t===this.endDocumentKey()&&this.stop()}},200)}}dispose(){this.isDisposed=!0,this.stop(),this.documents.clear()}stop(){var e;(e=this.intervalHandle)==null||e.dispose(),this.intervalHandle=void 0,this.endDocument=void 0}endDocumentKey(){return this.endDocument!==void 0?jm.asKey(this.endDocument):void 0}}class ttn{constructor(e,t,r){var p;const i=e.clientOptions.diagnosticPullOptions??{onChange:!0,onSave:!1},o=e.protocol2CodeConverter.asDocumentSelector(r.documentSelector),s=[],a=g=>{const m=r.documentSelector;if(i.match!==void 0)return i.match(m,g);for(const v of m)if(As.TextDocumentFilter.is(v)){if(typeof v=="string"||v.language!==void 0&&v.language!=="*"||v.scheme!==void 0&&v.scheme!=="*"&&v.scheme!==g.scheme)return!1;if(v.pattern!==void 0){const b=new Xen.Minimatch(v.pattern,{noext:!0});if(!b.makeRe()||!b.match(g.fsPath))return!1}}return!0},c=g=>g instanceof di.Uri?a(g):di.languages.match(o,g)>0&&t.isVisible(g),l=g=>{var m;return g instanceof di.Uri?((m=this.activeTextDocument)==null?void 0:m.uri.toString())===g.toString():this.activeTextDocument===g};this.diagnosticRequestor=new Qen(e,t,r),this.backgroundScheduler=new etn(this.diagnosticRequestor);const u=g=>{!c(g)||!r.interFileDependencies||l(g)||this.backgroundScheduler.add(g)};this.activeTextDocument=(p=di.window.activeTextEditor)==null?void 0:p.document,di.window.onDidChangeActiveTextEditor(g=>{const m=this.activeTextDocument;this.activeTextDocument=g==null?void 0:g.document,m!==void 0&&u(m),this.activeTextDocument!==void 0&&this.backgroundScheduler.remove(this.activeTextDocument)});const d=e.getFeature(As.DidOpenTextDocumentNotification.method);s.push(d.onNotificationSent(g=>{const m=g.textDocument;this.diagnosticRequestor.knows(Aa.document,m)||c(m)&&this.diagnosticRequestor.pull(m,()=>{u(m)})})),s.push(t.onOpen(g=>{for(const m of g){if(this.diagnosticRequestor.knows(Aa.document,m))continue;const v=m.toString();let b;for(const S of di.workspace.textDocuments)if(v===S.uri.toString()){b=S;break}b!==void 0&&c(b)&&this.diagnosticRequestor.pull(b,()=>{u(b)})}}));const h=new Set;for(const g of di.workspace.textDocuments)c(g)&&(this.diagnosticRequestor.pull(g,()=>{u(g)}),h.add(g.uri.toString()));if(i.onTabs===!0)for(const g of t.getTabResources())!h.has(g.toString())&&c(g)&&this.diagnosticRequestor.pull(g,()=>{u(g)});if(i.onChange===!0){const g=e.getFeature(As.DidChangeTextDocumentNotification.method);s.push(g.onNotificationSent(async m=>{const v=m.textDocument;(i.filter===void 0||!i.filter(v,iL.onType))&&this.diagnosticRequestor.knows(Aa.document,v)&&this.diagnosticRequestor.pull(v,()=>{this.backgroundScheduler.trigger()})}))}if(i.onSave===!0){const g=e.getFeature(As.DidSaveTextDocumentNotification.method);s.push(g.onNotificationSent(m=>{const v=m.textDocument;(i.filter===void 0||!i.filter(v,iL.onSave))&&this.diagnosticRequestor.knows(Aa.document,v)&&this.diagnosticRequestor.pull(m.textDocument,()=>{this.backgroundScheduler.trigger()})}))}const f=e.getFeature(As.DidCloseTextDocumentNotification.method);s.push(f.onNotificationSent(g=>{this.cleanUpDocument(g.textDocument)})),t.onClose(g=>{for(const m of g)this.cleanUpDocument(m)}),this.diagnosticRequestor.onDidChangeDiagnosticsEmitter.event(()=>{for(const g of di.workspace.textDocuments)c(g)&&this.diagnosticRequestor.pull(g)}),r.workspaceDiagnostics===!0&&r.identifier!=="da348dc5-c30a-4515-9d98-31ff3be38d14"&&this.diagnosticRequestor.pullWorkspace(),this.disposable=di.Disposable.from(...s,this.backgroundScheduler,this.diagnosticRequestor)}get onDidChangeDiagnosticsEmitter(){return this.diagnosticRequestor.onDidChangeDiagnosticsEmitter}get diagnostics(){return this.diagnosticRequestor.provider}cleanUpDocument(e){this.diagnosticRequestor.knows(Aa.document,e)&&(this.diagnosticRequestor.forgetDocument(e),this.backgroundScheduler.remove(e))}}class ntn extends EJ.TextDocumentLanguageFeature{constructor(e){super(e,As.DocumentDiagnosticRequest.type)}fillClientCapabilities(e){let t=zA(zA(e,"textDocument"),"diagnostic");t.dynamicRegistration=!0,t.relatedDocumentSupport=!1,zA(zA(e,"workspace"),"diagnostics").refreshSupport=!0}initialize(e,t){this._client.onRequest(As.DiagnosticRefreshRequest.type,async()=>{for(const s of this.getAllProviders())s.onDidChangeDiagnosticsEmitter.fire()});let[i,o]=this.getRegistration(t,e.diagnosticProvider);!i||!o||this.register({id:i,registerOptions:o})}clear(){this.tabs!==void 0&&(this.tabs.dispose(),this.tabs=void 0),super.clear()}registerLanguageProvider(e){this.tabs===void 0&&(this.tabs=new bk);const t=new ttn(this._client,this.tabs,e);return[t.disposable,t]}}ev.DiagnosticFeature=ntn;var BF={};Object.defineProperty(BF,"__esModule",{value:!0});BF.NotebookDocumentSyncFeature=void 0;const ll=wr,rtn=FF,Bm=Pr,itn=xi,Awe=ji;function Owe(n,e){return n[e]===void 0&&(n[e]={}),n[e]}var fC;(function(n){(function(e){function t(d,h){return{version:d.version,uri:h.asUri(d.uri)}}e.asVersionedNotebookDocumentIdentifier=t;function r(d,h,f){const p=Bm.NotebookDocument.create(f.asUri(d.uri),d.notebookType,d.version,i(h,f));return Object.keys(d.metadata).length>0&&(p.metadata=o(d.metadata)),p}e.asNotebookDocument=r;function i(d,h){return d.map(f=>s(f,h))}e.asNotebookCells=i;function o(d){return c(new Set,d)}e.asMetadata=o;function s(d,h){const f=Bm.NotebookCell.create(a(d.kind),h.asUri(d.document.uri));return Object.keys(d.metadata).length>0&&(f.metadata=o(d.metadata)),d.executionSummary!==void 0&&Awe.number(d.executionSummary.executionOrder)&&Awe.boolean(d.executionSummary.success)&&(f.executionSummary={executionOrder:d.executionSummary.executionOrder,success:d.executionSummary.success}),f}e.asNotebookCell=s;function a(d){switch(d){case ll.NotebookCellKind.Markup:return Bm.NotebookCellKind.Markup;case ll.NotebookCellKind.Code:return Bm.NotebookCellKind.Code}}function c(d,h){if(d.has(h))throw new Error("Can't deep copy cyclic structures.");if(Array.isArray(h)){const f=[];for(const p of h)if(p!==null&&typeof p=="object"||Array.isArray(p))f.push(c(d,p));else{if(p instanceof RegExp)throw new Error("Can't transfer regular expressions to the server");f.push(p)}return f}else{const f=Object.keys(h),p=Object.create(null);for(const g of f){const m=h[g];if(m!==null&&typeof m=="object"||Array.isArray(m))p[g]=c(d,m);else{if(m instanceof RegExp)throw new Error("Can't transfer regular expressions to the server");p[g]=m}}return p}}function l(d,h){const f=h.asChangeTextDocumentParams(d,d.document.uri,d.document.version);return{document:f.textDocument,changes:f.contentChanges}}e.asTextContentChange=l;function u(d,h){const f=Object.create(null);if(d.metadata&&(f.metadata=n.c2p.asMetadata(d.metadata)),d.cells!==void 0){const p=Object.create(null),g=d.cells;g.structure&&(p.structure={array:{start:g.structure.array.start,deleteCount:g.structure.array.deleteCount,cells:g.structure.array.cells!==void 0?g.structure.array.cells.map(m=>n.c2p.asNotebookCell(m,h)):void 0},didOpen:g.structure.didOpen!==void 0?g.structure.didOpen.map(m=>h.asOpenTextDocumentParams(m.document).textDocument):void 0,didClose:g.structure.didClose!==void 0?g.structure.didClose.map(m=>h.asCloseTextDocumentParams(m.document).textDocument):void 0}),g.data!==void 0&&(p.data=g.data.map(m=>n.c2p.asNotebookCell(m,h))),g.textContent!==void 0&&(p.textContent=g.textContent.map(m=>n.c2p.asTextContentChange(m,h))),Object.keys(p).length>0&&(f.cells=p)}return f}e.asNotebookDocumentChangeEvent=u})(n.c2p||(n.c2p={}))})(fC||(fC={}));var IJ;(function(n){function e(a,c,l){const u=a.length,d=c.length;let h=0;for(;h<d&&h<u&&t(a[h],c[h],l);)h++;if(h<d&&h<u){let f=u-1,p=d-1;for(;f>=0&&p>=0&&t(a[f],c[p],l);)f--,p--;const g=f+1-h,m=h===p+1?void 0:c.slice(h,p+1);return m!==void 0?{start:h,deleteCount:g,cells:m}:{start:h,deleteCount:g}}else return h<d?{start:h,deleteCount:0,cells:c.slice(h)}:h<u?{start:h,deleteCount:u-h}:void 0}n.computeDiff=e;function t(a,c,l=!0){return a.kind!==c.kind||a.document.uri.toString()!==c.document.uri.toString()||a.document.languageId!==c.document.languageId||!r(a.executionSummary,c.executionSummary)?!1:!l||l&&o(a.metadata,c.metadata)}function r(a,c){return a===c?!0:a===void 0||c===void 0?!1:a.executionOrder===c.executionOrder&&a.success===c.success&&i(a.timing,c.timing)}function i(a,c){return a===c?!0:a===void 0||c===void 0?!1:a.startTime===c.startTime&&a.endTime===c.endTime}function o(a,c){if(a===c)return!0;if(a==null||c===null||c===void 0||typeof a!=typeof c||typeof a!="object")return!1;const l=Array.isArray(a),u=Array.isArray(c);if(l!==u)return!1;if(l&&u){if(a.length!==c.length)return!1;for(let d=0;d<a.length;d++)if(!o(a[d],c[d]))return!1}if(s(a)&&s(c)){const d=Object.keys(a),h=Object.keys(c);if(d.length!==h.length||(d.sort(),h.sort(),!o(d,h)))return!1;for(let f=0;f<d.length;f++){const p=d[f];if(!o(a[p],c[p]))return!1}return!0}return!1}function s(a){return a!==null&&typeof a=="object"}n.isObjectLiteral=s})(IJ||(IJ={}));var PJ;(function(n){function e(t,r){if(typeof t=="string")return t==="*"||r.notebookType===t;if(t.notebookType!==void 0&&t.notebookType!=="*"&&r.notebookType!==t.notebookType)return!1;const i=r.uri;if(t.scheme!==void 0&&t.scheme!=="*"&&i.scheme!==t.scheme)return!1;if(t.pattern!==void 0){const o=new rtn.Minimatch(t.pattern,{noext:!0});if(!o.makeRe()||!o.match(i.fsPath))return!1}return!0}n.matchNotebook=e})(PJ||(PJ={}));var oL;(function(n){function e(r){var s,a,c;const i=r.notebookSelector,o=[];for(const l of i){const u=(typeof l.notebook=="string"?l.notebook:(s=l.notebook)==null?void 0:s.notebookType)??"*",d=typeof l.notebook=="string"||(a=l.notebook)==null?void 0:a.scheme,h=typeof l.notebook=="string"||(c=l.notebook)==null?void 0:c.pattern;if(l.cells!==void 0)for(const f of l.cells)o.push(t(u,d,h,f.language));else o.push(t(u,d,h,void 0))}return o}n.asDocumentSelector=e;function t(r,i,o,s){return i===void 0&&o===void 0?{notebook:r,language:s}:{notebook:{notebookType:r,scheme:i,pattern:o},language:s}}})(oL||(oL={}));var sL;(function(n){function e(t){return{cells:t,uris:new Set(t.map(r=>r.document.uri.toString()))}}n.create=e})(sL||(sL={}));class VA{constructor(e,t){this.client=e,this.options=t,this.notebookSyncInfo=new Map,this.notebookDidOpen=new Set,this.disposables=[],this.selector=e.protocol2CodeConverter.asDocumentSelector(oL.asDocumentSelector(t)),ll.workspace.onDidOpenNotebookDocument(r=>{this.notebookDidOpen.add(r.uri.toString()),this.didOpen(r)},void 0,this.disposables);for(const r of ll.workspace.notebookDocuments)this.notebookDidOpen.add(r.uri.toString()),this.didOpen(r);ll.workspace.onDidChangeNotebookDocument(r=>this.didChangeNotebookDocument(r),void 0,this.disposables),this.options.save===!0&&ll.workspace.onDidSaveNotebookDocument(r=>this.didSave(r),void 0,this.disposables),ll.workspace.onDidCloseNotebookDocument(r=>{this.didClose(r),this.notebookDidOpen.delete(r.uri.toString())},void 0,this.disposables)}getState(){for(const e of ll.workspace.notebookDocuments)if(this.getMatchingCells(e)!==void 0)return{kind:"document",id:"$internal",registrations:!0,matches:!0};return{kind:"document",id:"$internal",registrations:!0,matches:!1}}get mode(){return"notebook"}handles(e){return ll.languages.match(this.selector,e)>0}didOpenNotebookCellTextDocument(e,t){if(ll.languages.match(this.selector,t.document)===0||!this.notebookDidOpen.has(e.uri.toString()))return;const r=this.notebookSyncInfo.get(e.uri.toString()),i=this.cellMatches(e,t);if(r!==void 0){const o=r.uris.has(t.document.uri.toString());if(i&&o||!i&&!o)return;if(i){const s=this.getMatchingCells(e);if(s!==void 0){const a=this.asNotebookDocumentChangeEvent(e,void 0,r,s);a!==void 0&&this.doSendChange(a,s).catch(()=>{})}}}else i&&this.doSendOpen(e,[t]).catch(()=>{})}didChangeNotebookCellTextDocument(e,t){ll.languages.match(this.selector,t.document)!==0&&this.doSendChange({notebook:e,cells:{textContent:[t]}},void 0).catch(()=>{})}didCloseNotebookCellTextDocument(e,t){const r=this.notebookSyncInfo.get(e.uri.toString());if(r===void 0)return;const i=t.document.uri,o=r.cells.findIndex(s=>s.document.uri.toString()===i.toString());if(o!==-1)if(o===0&&r.cells.length===1)this.doSendClose(e,r.cells).catch(()=>{});else{const s=r.cells.slice(),a=s.splice(o,1);this.doSendChange({notebook:e,cells:{structure:{array:{start:o,deleteCount:1},didClose:a}}},s).catch(()=>{})}}dispose(){for(const e of this.disposables)e.dispose()}didOpen(e,t=this.getMatchingCells(e),r=this.notebookSyncInfo.get(e.uri.toString())){if(r!==void 0)if(t!==void 0){const i=this.asNotebookDocumentChangeEvent(e,void 0,r,t);i!==void 0&&this.doSendChange(i,t).catch(()=>{})}else this.doSendClose(e,[]).catch(()=>{});else{if(t===void 0)return;this.doSendOpen(e,t).catch(()=>{})}}didChangeNotebookDocument(e){const t=e.notebook,r=this.notebookSyncInfo.get(t.uri.toString());if(r===void 0){if(e.contentChanges.length===0)return;const i=this.getMatchingCells(t);if(i===void 0)return;this.didOpen(t,i,r)}else{const i=this.getMatchingCells(t);if(i===void 0){this.didClose(t,r);return}const o=this.asNotebookDocumentChangeEvent(e.notebook,e,r,i);o!==void 0&&this.doSendChange(o,i).catch(()=>{})}}didSave(e){this.notebookSyncInfo.get(e.uri.toString())!==void 0&&this.doSendSave(e).catch(()=>{})}didClose(e,t=this.notebookSyncInfo.get(e.uri.toString())){if(t===void 0)return;const r=e.getCells().filter(i=>t.uris.has(i.document.uri.toString()));this.doSendClose(e,r).catch(()=>{})}async sendDidOpenNotebookDocument(e){const t=this.getMatchingCells(e);if(t!==void 0)return this.doSendOpen(e,t)}async doSendOpen(e,t){var o;const r=async(s,a)=>{const c=fC.c2p.asNotebookDocument(s,a,this.client.code2ProtocolConverter),l=a.map(u=>this.client.code2ProtocolConverter.asTextDocumentItem(u.document));try{await this.client.sendNotification(Bm.DidOpenNotebookDocumentNotification.type,{notebookDocument:c,cellTextDocuments:l})}catch(u){throw this.client.error("Sending DidOpenNotebookDocumentNotification failed",u),u}},i=(o=this.client.middleware)==null?void 0:o.notebooks;return this.notebookSyncInfo.set(e.uri.toString(),sL.create(t)),(i==null?void 0:i.didOpen)!==void 0?i.didOpen(e,t,r):r(e,t)}async sendDidChangeNotebookDocument(e){return this.doSendChange(e,void 0)}async doSendChange(e,t=this.getMatchingCells(e.notebook)){var o,s;const r=async a=>{try{await this.client.sendNotification(Bm.DidChangeNotebookDocumentNotification.type,{notebookDocument:fC.c2p.asVersionedNotebookDocumentIdentifier(a.notebook,this.client.code2ProtocolConverter),change:fC.c2p.asNotebookDocumentChangeEvent(a,this.client.code2ProtocolConverter)})}catch(c){throw this.client.error("Sending DidChangeNotebookDocumentNotification failed",c),c}},i=(o=this.client.middleware)==null?void 0:o.notebooks;return((s=e.cells)==null?void 0:s.structure)!==void 0&&this.notebookSyncInfo.set(e.notebook.uri.toString(),sL.create(t??[])),(i==null?void 0:i.didChange)!==void 0?i==null?void 0:i.didChange(e,r):r(e)}async sendDidSaveNotebookDocument(e){return this.doSendSave(e)}async doSendSave(e){var i;const t=async o=>{try{await this.client.sendNotification(Bm.DidSaveNotebookDocumentNotification.type,{notebookDocument:{uri:this.client.code2ProtocolConverter.asUri(o.uri)}})}catch(s){throw this.client.error("Sending DidSaveNotebookDocumentNotification failed",s),s}},r=(i=this.client.middleware)==null?void 0:i.notebooks;return(r==null?void 0:r.didSave)!==void 0?r.didSave(e,t):t(e)}async sendDidCloseNotebookDocument(e){return this.doSendClose(e,this.getMatchingCells(e)??[])}async doSendClose(e,t){var o;const r=async(s,a)=>{try{await this.client.sendNotification(Bm.DidCloseNotebookDocumentNotification.type,{notebookDocument:{uri:this.client.code2ProtocolConverter.asUri(s.uri)},cellTextDocuments:a.map(c=>this.client.code2ProtocolConverter.asTextDocumentIdentifier(c.document))})}catch(c){throw this.client.error("Sending DidCloseNotebookDocumentNotification failed",c),c}},i=(o=this.client.middleware)==null?void 0:o.notebooks;return this.notebookSyncInfo.delete(e.uri.toString()),(i==null?void 0:i.didClose)!==void 0?i.didClose(e,t,r):r(e,t)}asNotebookDocumentChangeEvent(e,t,r,i){if(t!==void 0&&t.notebook!==e)throw new Error("Notebook must be identical");const o={notebook:e};(t==null?void 0:t.metadata)!==void 0&&(o.metadata=fC.c2p.asMetadata(t.metadata));let s;if((t==null?void 0:t.cellChanges)!==void 0&&t.cellChanges.length>0){const a=[];s=new Set(i.map(c=>c.document.uri.toString()));for(const c of t.cellChanges)s.has(c.cell.document.uri.toString())&&(c.executionSummary!==void 0||c.metadata!==void 0)&&a.push(c.cell);a.length>0&&(o.cells=o.cells??{},o.cells.data=a)}if(((t==null?void 0:t.contentChanges)!==void 0&&t.contentChanges.length>0||t===void 0)&&r!==void 0&&i!==void 0){const a=r.cells,c=i,l=IJ.computeDiff(a,c,!1);let u,d;if(l!==void 0){u=l.cells===void 0?new Map:new Map(l.cells.map(p=>[p.document.uri.toString(),p])),d=l.deleteCount===0?new Map:new Map(a.slice(l.start,l.start+l.deleteCount).map(p=>[p.document.uri.toString(),p]));for(const p of Array.from(d.keys()))u.has(p)&&(d.delete(p),u.delete(p));o.cells=o.cells??{};const h=[],f=[];if(u.size>0||d.size>0){for(const p of u.values())h.push(p);for(const p of d.values())f.push(p)}o.cells.structure={array:l,didOpen:h,didClose:f}}}return Object.keys(o).length>1?o:void 0}getMatchingCells(e,t=e.getCells()){if(this.options.notebookSelector!==void 0){for(const r of this.options.notebookSelector)if(r.notebook===void 0||PJ.matchNotebook(r.notebook,e)){const i=this.filterCells(e,t,r.cells);return i.length===0?void 0:i}}}cellMatches(e,t){const r=this.getMatchingCells(e,[t]);return r!==void 0&&r[0]===t}filterCells(e,t,r){var o;const i=r!==void 0?t.filter(s=>{const a=s.document.languageId;return r.some(c=>c.language==="*"||a===c.language)}):t;return typeof((o=this.client.clientOptions.notebookDocumentOptions)==null?void 0:o.filterCells)=="function"?this.client.clientOptions.notebookDocumentOptions.filterCells(e,i):i}}class L1{constructor(e){this.client=e,this.registrations=new Map,this.registrationType=Bm.NotebookDocumentSyncRegistrationType.type,ll.workspace.onDidOpenTextDocument(t=>{if(t.uri.scheme!==L1.CellScheme)return;const[r,i]=this.findNotebookDocumentAndCell(t);if(!(r===void 0||i===void 0))for(const o of this.registrations.values())o instanceof VA&&o.didOpenNotebookCellTextDocument(r,i)}),ll.workspace.onDidChangeTextDocument(t=>{if(t.contentChanges.length===0)return;const r=t.document;if(r.uri.scheme!==L1.CellScheme)return;const[i]=this.findNotebookDocumentAndCell(r);if(i!==void 0)for(const o of this.registrations.values())o instanceof VA&&o.didChangeNotebookCellTextDocument(i,t)}),ll.workspace.onDidCloseTextDocument(t=>{if(t.uri.scheme!==L1.CellScheme)return;const[r,i]=this.findNotebookDocumentAndCell(t);if(!(r===void 0||i===void 0))for(const o of this.registrations.values())o instanceof VA&&o.didCloseNotebookCellTextDocument(r,i)})}getState(){if(this.registrations.size===0)return{kind:"document",id:this.registrationType.method,registrations:!1,matches:!1};for(const e of this.registrations.values()){const t=e.getState();if(t.kind==="document"&&t.registrations===!0&&t.matches===!0)return{kind:"document",id:this.registrationType.method,registrations:!0,matches:!0}}return{kind:"document",id:this.registrationType.method,registrations:!0,matches:!1}}fillClientCapabilities(e){const t=Owe(Owe(e,"notebookDocument"),"synchronization");t.dynamicRegistration=!0,t.executionSummarySupport=!0}preInitialize(e){const t=e.notebookDocumentSync;t!==void 0&&(this.dedicatedChannel=this.client.protocol2CodeConverter.asDocumentSelector(oL.asDocumentSelector(t)))}initialize(e){const t=e.notebookDocumentSync;if(t===void 0)return;const r=t.id??itn.generateUuid();this.register({id:r,registerOptions:t})}register(e){const t=new VA(this.client,e.registerOptions);this.registrations.set(e.id,t)}unregister(e){const t=this.registrations.get(e);t&&t.dispose()}clear(){for(const e of this.registrations.values())e.dispose();this.registrations.clear()}handles(e){if(e.uri.scheme!==L1.CellScheme)return!1;if(this.dedicatedChannel!==void 0&&ll.languages.match(this.dedicatedChannel,e)>0)return!0;for(const t of this.registrations.values())if(t.handles(e))return!0;return!1}getProvider(e){for(const t of this.registrations.values())if(t.handles(e.document))return t}findNotebookDocumentAndCell(e){const t=e.uri.toString();for(const r of ll.workspace.notebookDocuments)for(const i of r.getCells())if(i.document.uri.toString()===t)return[r,i];return[void 0,void 0]}}BF.NotebookDocumentSyncFeature=L1;L1.CellScheme="vscode-notebook-cell";var gy={};Object.defineProperty(gy,"__esModule",{value:!0});gy.SyncConfigurationFeature=gy.toJSONObject=gy.ConfigurationFeature=void 0;const i2=wr,EP=Pr,otn=ji,stn=xi,Mwe=yr;class atn{constructor(e){this._client=e}getState(){return{kind:"static"}}fillClientCapabilities(e){e.workspace=e.workspace||{},e.workspace.configuration=!0}initialize(){let e=this._client;e.onRequest(EP.ConfigurationRequest.type,(t,r)=>{let i=s=>{let a=[];for(let c of s.items){let l=c.scopeUri!==void 0&&c.scopeUri!==null?this._client.protocol2CodeConverter.asUri(c.scopeUri):void 0;a.push(this.getConfiguration(l,c.section!==null?c.section:void 0))}return a},o=e.middleware.workspace;return o&&o.configuration?o.configuration(t,r,i):i(t)})}getConfiguration(e,t){let r=null;if(t){let i=t.lastIndexOf(".");if(i===-1)r=vS(i2.workspace.getConfiguration(void 0,e).get(t));else{let o=i2.workspace.getConfiguration(t.substr(0,i),e);o&&(r=vS(o.get(t.substr(i+1))))}}else{let i=i2.workspace.getConfiguration(void 0,e);r={};for(let o of Object.keys(i))i.has(o)&&(r[o]=vS(i.get(o)))}return r===void 0&&(r=null),r}clear(){}}gy.ConfigurationFeature=atn;function vS(n){if(n){if(Array.isArray(n))return n.map(vS);if(typeof n=="object"){const e=Object.create(null);for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=vS(n[t]));return e}}return n}gy.toJSONObject=vS;class ctn{constructor(e){this._client=e,this.isCleared=!1,this._listeners=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._listeners.size>0}}get registrationType(){return EP.DidChangeConfigurationNotification.type}fillClientCapabilities(e){(0,Mwe.ensure)((0,Mwe.ensure)(e,"workspace"),"didChangeConfiguration").dynamicRegistration=!0}initialize(){var t;this.isCleared=!1;let e=(t=this._client.clientOptions.synchronize)==null?void 0:t.configurationSection;e!==void 0&&this.register({id:stn.generateUuid(),registerOptions:{section:e}})}register(e){let t=i2.workspace.onDidChangeConfiguration(r=>{this.onDidChangeConfiguration(e.registerOptions.section,r)});this._listeners.set(e.id,t),e.registerOptions.section!==void 0&&this.onDidChangeConfiguration(e.registerOptions.section,void 0)}unregister(e){let t=this._listeners.get(e);t&&(this._listeners.delete(e),t.dispose())}clear(){for(const e of this._listeners.values())e.dispose();this._listeners.clear(),this.isCleared=!0}onDidChangeConfiguration(e,t){var s;if(this.isCleared)return;let r;if(otn.string(e)?r=[e]:r=e,r!==void 0&&t!==void 0&&!r.some(c=>t.affectsConfiguration(c)))return;const i=async a=>a===void 0?this._client.sendNotification(EP.DidChangeConfigurationNotification.type,{settings:null}):this._client.sendNotification(EP.DidChangeConfigurationNotification.type,{settings:this.extractSettingsInformation(a)});let o=(s=this._client.middleware.workspace)==null?void 0:s.didChangeConfiguration;(o?o(r,i):i(r)).catch(a=>{this._client.error(`Sending notification ${EP.DidChangeConfigurationNotification.type.method} failed`,a)})}extractSettingsInformation(e){function t(o,s){let a=o;for(let c=0;c<s.length-1;c++){let l=a[s[c]];l||(l=Object.create(null),a[s[c]]=l),a=l}return a}let r=this._client.clientOptions.workspaceFolder?this._client.clientOptions.workspaceFolder.uri:void 0,i=Object.create(null);for(let o=0;o<e.length;o++){let s=e[o],a=s.indexOf("."),c=null;if(a>=0?c=i2.workspace.getConfiguration(s.substr(0,a),r).get(s.substr(a+1)):c=i2.workspace.getConfiguration(void 0,r).get(s),c){let l=e[o].split(".");t(i,l)[l[l.length-1]]=vS(c)}}return i}}gy.SyncConfigurationFeature=ctn;var Au={};Object.defineProperty(Au,"__esModule",{value:!0});Au.DidSaveTextDocumentFeature=Au.WillSaveWaitUntilFeature=Au.WillSaveFeature=Au.DidChangeTextDocumentFeature=Au.DidCloseTextDocumentFeature=Au.DidOpenTextDocumentFeature=void 0;const kd=wr,_o=Pr,Es=yr,EE=xi;class ltn extends Es.TextDocumentEventFeature{constructor(e,t){super(e,kd.workspace.onDidOpenTextDocument,_o.DidOpenTextDocumentNotification.type,()=>e.middleware.didOpen,r=>e.code2ProtocolConverter.asOpenTextDocumentParams(r),r=>r,Es.TextDocumentEventFeature.textDocumentFilter),this._syncedDocuments=t}get openDocuments(){return this._syncedDocuments.values()}fillClientCapabilities(e){(0,Es.ensure)((0,Es.ensure)(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){const r=e.resolvedTextDocumentSync;t&&r&&r.openClose&&this.register({id:EE.generateUuid(),registerOptions:{documentSelector:t}})}get registrationType(){return _o.DidOpenTextDocumentNotification.type}register(e){if(super.register(e),!e.registerOptions.documentSelector)return;const t=this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector);kd.workspace.textDocuments.forEach(r=>{const i=r.uri.toString();if(!this._syncedDocuments.has(i)&&kd.languages.match(t,r)>0&&!this._client.hasDedicatedTextSynchronizationFeature(r)){const o=this._client.middleware,s=a=>this._client.sendNotification(this._type,this._createParams(a));(o.didOpen?o.didOpen(r,s):s(r)).catch(a=>{this._client.error(`Sending document notification ${this._type.method} failed`,a)}),this._syncedDocuments.set(i,r)}})}getTextDocument(e){return e}notificationSent(e,t,r){this._syncedDocuments.set(e.uri.toString(),e),super.notificationSent(e,t,r)}}Au.DidOpenTextDocumentFeature=ltn;class utn extends Es.TextDocumentEventFeature{constructor(e,t,r){super(e,kd.workspace.onDidCloseTextDocument,_o.DidCloseTextDocumentNotification.type,()=>e.middleware.didClose,i=>e.code2ProtocolConverter.asCloseTextDocumentParams(i),i=>i,Es.TextDocumentEventFeature.textDocumentFilter),this._syncedDocuments=t,this._pendingTextDocumentChanges=r}get registrationType(){return _o.DidCloseTextDocumentNotification.type}fillClientCapabilities(e){(0,Es.ensure)((0,Es.ensure)(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.openClose&&this.register({id:EE.generateUuid(),registerOptions:{documentSelector:t}})}async callback(e){await super.callback(e),this._pendingTextDocumentChanges.delete(e.uri.toString())}getTextDocument(e){return e}notificationSent(e,t,r){this._syncedDocuments.delete(e.uri.toString()),super.notificationSent(e,t,r)}unregister(e){const t=this._selectors.get(e);super.unregister(e);const r=this._selectors.values();this._syncedDocuments.forEach(i=>{if(kd.languages.match(t,i)>0&&!this._selectorFilter(r,i)&&!this._client.hasDedicatedTextSynchronizationFeature(i)){let o=this._client.middleware,s=a=>this._client.sendNotification(this._type,this._createParams(a));this._syncedDocuments.delete(i.uri.toString()),(o.didClose?o.didClose(i,s):s(i)).catch(a=>{this._client.error(`Sending document notification ${this._type.method} failed`,a)})}})}}Au.DidCloseTextDocumentFeature=utn;class dtn extends Es.DynamicDocumentFeature{constructor(e,t){super(e),this._changeData=new Map,this._onNotificationSent=new kd.EventEmitter,this._onPendingChangeAdded=new kd.EventEmitter,this._pendingTextDocumentChanges=t,this._syncKind=_o.TextDocumentSyncKind.None}get onNotificationSent(){return this._onNotificationSent.event}get onPendingChangeAdded(){return this._onPendingChangeAdded.event}get syncKind(){return this._syncKind}get registrationType(){return _o.DidChangeTextDocumentNotification.type}fillClientCapabilities(e){(0,Es.ensure)((0,Es.ensure)(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.change!==void 0&&r.change!==_o.TextDocumentSyncKind.None&&this.register({id:EE.generateUuid(),registerOptions:Object.assign({},{documentSelector:t},{syncKind:r.change})})}register(e){e.registerOptions.documentSelector&&(this._listener||(this._listener=kd.workspace.onDidChangeTextDocument(this.callback,this)),this._changeData.set(e.id,{syncKind:e.registerOptions.syncKind,documentSelector:this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)}),this.updateSyncKind(e.registerOptions.syncKind))}*getDocumentSelectors(){for(const e of this._changeData.values())yield e.documentSelector}async callback(e){if(e.contentChanges.length===0)return;const t=e.document.uri,r=e.document.version,i=[];for(const o of this._changeData.values())if(kd.languages.match(o.documentSelector,e.document)>0&&!this._client.hasDedicatedTextSynchronizationFeature(e.document)){const s=this._client.middleware;if(o.syncKind===_o.TextDocumentSyncKind.Incremental){const a=async c=>{const l=this._client.code2ProtocolConverter.asChangeTextDocumentParams(c,t,r);await this._client.sendNotification(_o.DidChangeTextDocumentNotification.type,l),this.notificationSent(c.document,_o.DidChangeTextDocumentNotification.type,l)};i.push(s.didChange?s.didChange(e,c=>a(c)):a(e))}else if(o.syncKind===_o.TextDocumentSyncKind.Full){const a=async c=>{const l=c.document.uri.toString();this._pendingTextDocumentChanges.set(l,c.document),this._onPendingChangeAdded.fire()};i.push(s.didChange?s.didChange(e,c=>a(c)):a(e))}}return Promise.all(i).then(void 0,o=>{throw this._client.error(`Sending document notification ${_o.DidChangeTextDocumentNotification.type.method} failed`,o),o})}notificationSent(e,t,r){this._onNotificationSent.fire({textDocument:e,type:t,params:r})}unregister(e){if(this._changeData.delete(e),this._changeData.size===0)this._listener&&(this._listener.dispose(),this._listener=void 0),this._syncKind=_o.TextDocumentSyncKind.None;else{this._syncKind=_o.TextDocumentSyncKind.None;for(const t of this._changeData.values())if(this.updateSyncKind(t.syncKind),this._syncKind===_o.TextDocumentSyncKind.Full)break}}clear(){this._pendingTextDocumentChanges.clear(),this._changeData.clear(),this._syncKind=_o.TextDocumentSyncKind.None,this._listener&&(this._listener.dispose(),this._listener=void 0)}getPendingDocumentChanges(e){if(this._pendingTextDocumentChanges.size===0)return[];let t;if(e.size===0)t=Array.from(this._pendingTextDocumentChanges.values()),this._pendingTextDocumentChanges.clear();else{t=[];for(const r of this._pendingTextDocumentChanges)e.has(r[0])||(t.push(r[1]),this._pendingTextDocumentChanges.delete(r[0]))}return t}getProvider(e){for(const t of this._changeData.values())if(kd.languages.match(t.documentSelector,e)>0)return{send:r=>this.callback(r)}}updateSyncKind(e){if(this._syncKind!==_o.TextDocumentSyncKind.Full)switch(e){case _o.TextDocumentSyncKind.Full:this._syncKind=e;break;case _o.TextDocumentSyncKind.Incremental:this._syncKind===_o.TextDocumentSyncKind.None&&(this._syncKind=_o.TextDocumentSyncKind.Incremental);break}}}Au.DidChangeTextDocumentFeature=dtn;class htn extends Es.TextDocumentEventFeature{constructor(e){super(e,kd.workspace.onWillSaveTextDocument,_o.WillSaveTextDocumentNotification.type,()=>e.middleware.willSave,t=>e.code2ProtocolConverter.asWillSaveTextDocumentParams(t),t=>t.document,(t,r)=>Es.TextDocumentEventFeature.textDocumentFilter(t,r.document))}get registrationType(){return _o.WillSaveTextDocumentNotification.type}fillClientCapabilities(e){let t=(0,Es.ensure)((0,Es.ensure)(e,"textDocument"),"synchronization");t.willSave=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.willSave&&this.register({id:EE.generateUuid(),registerOptions:{documentSelector:t}})}getTextDocument(e){return e.document}}Au.WillSaveFeature=htn;class ftn extends Es.DynamicDocumentFeature{constructor(e){super(e),this._selectors=new Map}getDocumentSelectors(){return this._selectors.values()}get registrationType(){return _o.WillSaveTextDocumentWaitUntilRequest.type}fillClientCapabilities(e){let t=(0,Es.ensure)((0,Es.ensure)(e,"textDocument"),"synchronization");t.willSaveWaitUntil=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.willSaveWaitUntil&&this.register({id:EE.generateUuid(),registerOptions:{documentSelector:t}})}register(e){e.registerOptions.documentSelector&&(this._listener||(this._listener=kd.workspace.onWillSaveTextDocument(this.callback,this)),this._selectors.set(e.id,this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)))}callback(e){if(Es.TextDocumentEventFeature.textDocumentFilter(this._selectors.values(),e.document)&&!this._client.hasDedicatedTextSynchronizationFeature(e.document)){let t=this._client.middleware,r=i=>this._client.sendRequest(_o.WillSaveTextDocumentWaitUntilRequest.type,this._client.code2ProtocolConverter.asWillSaveTextDocumentParams(i)).then(async o=>{let s=await this._client.protocol2CodeConverter.asTextEdits(o);return s===void 0?[]:s});e.waitUntil(t.willSaveWaitUntil?t.willSaveWaitUntil(e,r):r(e))}}unregister(e){this._selectors.delete(e),this._selectors.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}clear(){this._selectors.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}}Au.WillSaveWaitUntilFeature=ftn;class ptn extends Es.TextDocumentEventFeature{constructor(e){super(e,kd.workspace.onDidSaveTextDocument,_o.DidSaveTextDocumentNotification.type,()=>e.middleware.didSave,t=>e.code2ProtocolConverter.asSaveTextDocumentParams(t,this._includeText),t=>t,Es.TextDocumentEventFeature.textDocumentFilter),this._includeText=!1}get registrationType(){return _o.DidSaveTextDocumentNotification.type}fillClientCapabilities(e){(0,Es.ensure)((0,Es.ensure)(e,"textDocument"),"synchronization").didSave=!0}initialize(e,t){const r=e.resolvedTextDocumentSync;if(t&&r&&r.save){const i=typeof r.save=="boolean"?{includeText:!1}:{includeText:!!r.save.includeText};this.register({id:EE.generateUuid(),registerOptions:Object.assign({},{documentSelector:t},i)})}}register(e){this._includeText=!!e.registerOptions.includeText,super.register(e)}getTextDocument(e){return e}}Au.DidSaveTextDocumentFeature=ptn;var HF={};Object.defineProperty(HF,"__esModule",{value:!0});HF.CompletionItemFeature=void 0;const gtn=wr,ui=Pr,Mz=yr,mtn=xi,vtn=[ui.CompletionItemKind.Text,ui.CompletionItemKind.Method,ui.CompletionItemKind.Function,ui.CompletionItemKind.Constructor,ui.CompletionItemKind.Field,ui.CompletionItemKind.Variable,ui.CompletionItemKind.Class,ui.CompletionItemKind.Interface,ui.CompletionItemKind.Module,ui.CompletionItemKind.Property,ui.CompletionItemKind.Unit,ui.CompletionItemKind.Value,ui.CompletionItemKind.Enum,ui.CompletionItemKind.Keyword,ui.CompletionItemKind.Snippet,ui.CompletionItemKind.Color,ui.CompletionItemKind.File,ui.CompletionItemKind.Reference,ui.CompletionItemKind.Folder,ui.CompletionItemKind.EnumMember,ui.CompletionItemKind.Constant,ui.CompletionItemKind.Struct,ui.CompletionItemKind.Event,ui.CompletionItemKind.Operator,ui.CompletionItemKind.TypeParameter];class ytn extends Mz.TextDocumentLanguageFeature{constructor(e){super(e,ui.CompletionRequest.type),this.labelDetailsSupport=new Map}fillClientCapabilities(e){let t=(0,Mz.ensure)((0,Mz.ensure)(e,"textDocument"),"completion");t.dynamicRegistration=!0,t.contextSupport=!0,t.completionItem={snippetSupport:!0,commitCharactersSupport:!0,documentationFormat:[ui.MarkupKind.Markdown,ui.MarkupKind.PlainText],deprecatedSupport:!0,preselectSupport:!0,tagSupport:{valueSet:[ui.CompletionItemTag.Deprecated]},insertReplaceSupport:!0,resolveSupport:{properties:["documentation","detail","additionalTextEdits"]},insertTextModeSupport:{valueSet:[ui.InsertTextMode.asIs,ui.InsertTextMode.adjustIndentation]},labelDetailsSupport:!0},t.insertTextMode=ui.InsertTextMode.adjustIndentation,t.completionItemKind={valueSet:vtn},t.completionList={itemDefaults:["commitCharacters","editRange","insertTextFormat","insertTextMode","data"]}}initialize(e,t){const r=this.getRegistrationOptions(t,e.completionProvider);r&&this.register({id:mtn.generateUuid(),registerOptions:r})}registerLanguageProvider(e,t){var a;this.labelDetailsSupport.set(t,!!((a=e.completionItem)!=null&&a.labelDetailsSupport));const r=e.triggerCharacters??[],i=e.allCommitCharacters,o=e.documentSelector,s={provideCompletionItems:(c,l,u,d)=>{const h=this._client,f=this._client.middleware,p=(g,m,v,b)=>h.sendRequest(ui.CompletionRequest.type,h.code2ProtocolConverter.asCompletionParams(g,m,v),b).then(S=>b.isCancellationRequested?null:h.protocol2CodeConverter.asCompletionResult(S,i,b),S=>h.handleFailedRequest(ui.CompletionRequest.type,b,S,null));return f.provideCompletionItem?f.provideCompletionItem(c,l,d,u,p):p(c,l,d,u)},resolveCompletionItem:e.resolveProvider?(c,l)=>{const u=this._client,d=this._client.middleware,h=(f,p)=>u.sendRequest(ui.CompletionResolveRequest.type,u.code2ProtocolConverter.asCompletionItem(f,!!this.labelDetailsSupport.get(t)),p).then(g=>p.isCancellationRequested?null:u.protocol2CodeConverter.asCompletionItem(g),g=>u.handleFailedRequest(ui.CompletionResolveRequest.type,p,g,f));return d.resolveCompletionItem?d.resolveCompletionItem(c,l,h):h(c,l)}:void 0};return[gtn.languages.registerCompletionItemProvider(this._client.protocol2CodeConverter.asDocumentSelector(o),s,...r),s]}}HF.CompletionItemFeature=ytn;var UF={};Object.defineProperty(UF,"__esModule",{value:!0});UF.HoverFeature=void 0;const btn=wr,RI=Pr,$z=yr,Stn=xi;class _tn extends $z.TextDocumentLanguageFeature{constructor(e){super(e,RI.HoverRequest.type)}fillClientCapabilities(e){const t=(0,$z.ensure)((0,$z.ensure)(e,"textDocument"),"hover");t.dynamicRegistration=!0,t.contentFormat=[RI.MarkupKind.Markdown,RI.MarkupKind.PlainText]}initialize(e,t){const r=this.getRegistrationOptions(t,e.hoverProvider);r&&this.register({id:Stn.generateUuid(),registerOptions:r})}registerLanguageProvider(e){const t=e.documentSelector,r={provideHover:(i,o,s)=>{const a=this._client,c=(u,d,h)=>a.sendRequest(RI.HoverRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(u,d),h).then(f=>h.isCancellationRequested?null:a.protocol2CodeConverter.asHover(f),f=>a.handleFailedRequest(RI.HoverRequest.type,h,f,null)),l=a.middleware;return l.provideHover?l.provideHover(i,o,s,c):c(i,o,s)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return btn.languages.registerHoverProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}}UF.HoverFeature=_tn;var zF={};Object.defineProperty(zF,"__esModule",{value:!0});zF.DefinitionFeature=void 0;const wtn=wr,Lz=Pr,Nz=yr,Ctn=xi;class xtn extends Nz.TextDocumentLanguageFeature{constructor(e){super(e,Lz.DefinitionRequest.type)}fillClientCapabilities(e){let t=(0,Nz.ensure)((0,Nz.ensure)(e,"textDocument"),"definition");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){const r=this.getRegistrationOptions(t,e.definitionProvider);r&&this.register({id:Ctn.generateUuid(),registerOptions:r})}registerLanguageProvider(e){const t=e.documentSelector,r={provideDefinition:(i,o,s)=>{const a=this._client,c=(u,d,h)=>a.sendRequest(Lz.DefinitionRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(u,d),h).then(f=>h.isCancellationRequested?null:a.protocol2CodeConverter.asDefinitionResult(f,h),f=>a.handleFailedRequest(Lz.DefinitionRequest.type,h,f,null)),l=a.middleware;return l.provideDefinition?l.provideDefinition(i,o,s,c):c(i,o,s)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return wtn.languages.registerDefinitionProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}}zF.DefinitionFeature=xtn;var VF={};Object.defineProperty(VF,"__esModule",{value:!0});VF.SignatureHelpFeature=void 0;const $we=wr,AI=Pr,Fz=yr,Etn=xi;class Itn extends Fz.TextDocumentLanguageFeature{constructor(e){super(e,AI.SignatureHelpRequest.type)}fillClientCapabilities(e){let t=(0,Fz.ensure)((0,Fz.ensure)(e,"textDocument"),"signatureHelp");t.dynamicRegistration=!0,t.signatureInformation={documentationFormat:[AI.MarkupKind.Markdown,AI.MarkupKind.PlainText]},t.signatureInformation.parameterInformation={labelOffsetSupport:!0},t.signatureInformation.activeParameterSupport=!0,t.contextSupport=!0}initialize(e,t){const r=this.getRegistrationOptions(t,e.signatureHelpProvider);r&&this.register({id:Etn.generateUuid(),registerOptions:r})}registerLanguageProvider(e){const t={provideSignatureHelp:(r,i,o,s)=>{const a=this._client,c=(u,d,h,f)=>a.sendRequest(AI.SignatureHelpRequest.type,a.code2ProtocolConverter.asSignatureHelpParams(u,d,h),f).then(p=>f.isCancellationRequested?null:a.protocol2CodeConverter.asSignatureHelp(p,f),p=>a.handleFailedRequest(AI.SignatureHelpRequest.type,f,p,null)),l=a.middleware;return l.provideSignatureHelp?l.provideSignatureHelp(r,i,s,o,c):c(r,i,s,o)}};return[this.registerProvider(e,t),t]}registerProvider(e,t){const r=this._client.protocol2CodeConverter.asDocumentSelector(e.documentSelector);if(e.retriggerCharacters===void 0){const i=e.triggerCharacters||[];return $we.languages.registerSignatureHelpProvider(r,t,...i)}else{const i={triggerCharacters:e.triggerCharacters||[],retriggerCharacters:e.retriggerCharacters||[]};return $we.languages.registerSignatureHelpProvider(r,t,i)}}}VF.SignatureHelpFeature=Itn;var WF={};Object.defineProperty(WF,"__esModule",{value:!0});WF.DocumentHighlightFeature=void 0;const Ptn=wr,jz=Pr,Bz=yr,ktn=xi;class Ttn extends Bz.TextDocumentLanguageFeature{constructor(e){super(e,jz.DocumentHighlightRequest.type)}fillClientCapabilities(e){(0,Bz.ensure)((0,Bz.ensure)(e,"textDocument"),"documentHighlight").dynamicRegistration=!0}initialize(e,t){const r=this.getRegistrationOptions(t,e.documentHighlightProvider);r&&this.register({id:ktn.generateUuid(),registerOptions:r})}registerLanguageProvider(e){const t=e.documentSelector,r={provideDocumentHighlights:(i,o,s)=>{const a=this._client,c=(u,d,h)=>a.sendRequest(jz.DocumentHighlightRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(u,d),h).then(f=>h.isCancellationRequested?null:a.protocol2CodeConverter.asDocumentHighlights(f,h),f=>a.handleFailedRequest(jz.DocumentHighlightRequest.type,h,f,null)),l=a.middleware;return l.provideDocumentHighlights?l.provideDocumentHighlights(i,o,s,c):c(i,o,s)}};return[Ptn.languages.registerDocumentHighlightProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}}WF.DocumentHighlightFeature=Ttn;var mse={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.DocumentSymbolFeature=n.SupportedSymbolTags=n.SupportedSymbolKinds=void 0;const e=wr,t=Pr,r=yr,i=xi;n.SupportedSymbolKinds=[t.SymbolKind.File,t.SymbolKind.Module,t.SymbolKind.Namespace,t.SymbolKind.Package,t.SymbolKind.Class,t.SymbolKind.Method,t.SymbolKind.Property,t.SymbolKind.Field,t.SymbolKind.Constructor,t.SymbolKind.Enum,t.SymbolKind.Interface,t.SymbolKind.Function,t.SymbolKind.Variable,t.SymbolKind.Constant,t.SymbolKind.String,t.SymbolKind.Number,t.SymbolKind.Boolean,t.SymbolKind.Array,t.SymbolKind.Object,t.SymbolKind.Key,t.SymbolKind.Null,t.SymbolKind.EnumMember,t.SymbolKind.Struct,t.SymbolKind.Event,t.SymbolKind.Operator,t.SymbolKind.TypeParameter],n.SupportedSymbolTags=[t.SymbolTag.Deprecated];class o extends r.TextDocumentLanguageFeature{constructor(a){super(a,t.DocumentSymbolRequest.type)}fillClientCapabilities(a){let c=(0,r.ensure)((0,r.ensure)(a,"textDocument"),"documentSymbol");c.dynamicRegistration=!0,c.symbolKind={valueSet:n.SupportedSymbolKinds},c.hierarchicalDocumentSymbolSupport=!0,c.tagSupport={valueSet:n.SupportedSymbolTags},c.labelSupport=!0}initialize(a,c){const l=this.getRegistrationOptions(c,a.documentSymbolProvider);l&&this.register({id:i.generateUuid(),registerOptions:l})}registerLanguageProvider(a){const c=a.documentSelector,l={provideDocumentSymbols:(d,h)=>{const f=this._client,p=async(m,v)=>{try{const b=await f.sendRequest(t.DocumentSymbolRequest.type,f.code2ProtocolConverter.asDocumentSymbolParams(m),v);if(v.isCancellationRequested||b===void 0||b===null)return null;if(b.length===0)return[];{const S=b[0];return t.DocumentSymbol.is(S)?await f.protocol2CodeConverter.asDocumentSymbols(b,v):await f.protocol2CodeConverter.asSymbolInformations(b,v)}}catch(b){return f.handleFailedRequest(t.DocumentSymbolRequest.type,v,b,null)}},g=f.middleware;return g.provideDocumentSymbols?g.provideDocumentSymbols(d,h,p):p(d,h)}},u=a.label!==void 0?{label:a.label}:void 0;return[e.languages.registerDocumentSymbolProvider(this._client.protocol2CodeConverter.asDocumentSelector(c),l,u),l]}}n.DocumentSymbolFeature=o})(mse);var qF={};Object.defineProperty(qF,"__esModule",{value:!0});qF.WorkspaceSymbolFeature=void 0;const Dtn=wr,OI=Pr,Hz=yr,Lwe=mse,Rtn=xi;class Atn extends Hz.WorkspaceFeature{constructor(e){super(e,OI.WorkspaceSymbolRequest.type)}fillClientCapabilities(e){let t=(0,Hz.ensure)((0,Hz.ensure)(e,"workspace"),"symbol");t.dynamicRegistration=!0,t.symbolKind={valueSet:Lwe.SupportedSymbolKinds},t.tagSupport={valueSet:Lwe.SupportedSymbolTags},t.resolveSupport={properties:["location.range"]}}initialize(e){e.workspaceSymbolProvider&&this.register({id:Rtn.generateUuid(),registerOptions:e.workspaceSymbolProvider===!0?{workDoneProgress:!1}:e.workspaceSymbolProvider})}registerLanguageProvider(e){const t={provideWorkspaceSymbols:(r,i)=>{const o=this._client,s=(c,l)=>o.sendRequest(OI.WorkspaceSymbolRequest.type,{query:c},l).then(u=>l.isCancellationRequested?null:o.protocol2CodeConverter.asSymbolInformations(u,l),u=>o.handleFailedRequest(OI.WorkspaceSymbolRequest.type,l,u,null)),a=o.middleware;return a.provideWorkspaceSymbols?a.provideWorkspaceSymbols(r,i,s):s(r,i)},resolveWorkspaceSymbol:e.resolveProvider===!0?(r,i)=>{const o=this._client,s=(c,l)=>o.sendRequest(OI.WorkspaceSymbolResolveRequest.type,o.code2ProtocolConverter.asWorkspaceSymbol(c),l).then(u=>l.isCancellationRequested?null:o.protocol2CodeConverter.asSymbolInformation(u),u=>o.handleFailedRequest(OI.WorkspaceSymbolResolveRequest.type,l,u,null)),a=o.middleware;return a.resolveWorkspaceSymbol?a.resolveWorkspaceSymbol(r,i,s):s(r,i)}:void 0};return[Dtn.languages.registerWorkspaceSymbolProvider(t),t]}}qF.WorkspaceSymbolFeature=Atn;var KF={};Object.defineProperty(KF,"__esModule",{value:!0});KF.ReferencesFeature=void 0;const Otn=wr,Uz=Pr,zz=yr,Mtn=xi;class $tn extends zz.TextDocumentLanguageFeature{constructor(e){super(e,Uz.ReferencesRequest.type)}fillClientCapabilities(e){(0,zz.ensure)((0,zz.ensure)(e,"textDocument"),"references").dynamicRegistration=!0}initialize(e,t){const r=this.getRegistrationOptions(t,e.referencesProvider);r&&this.register({id:Mtn.generateUuid(),registerOptions:r})}registerLanguageProvider(e){const t=e.documentSelector,r={provideReferences:(i,o,s,a)=>{const c=this._client,l=(d,h,f,p)=>c.sendRequest(Uz.ReferencesRequest.type,c.code2ProtocolConverter.asReferenceParams(d,h,f),p).then(g=>p.isCancellationRequested?null:c.protocol2CodeConverter.asReferences(g,p),g=>c.handleFailedRequest(Uz.ReferencesRequest.type,p,g,null)),u=c.middleware;return u.provideReferences?u.provideReferences(i,o,s,a,l):l(i,o,s,a)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return Otn.languages.registerReferenceProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}}KF.ReferencesFeature=$tn;var GF={};Object.defineProperty(GF,"__esModule",{value:!0});GF.CodeActionFeature=void 0;const Ltn=wr,dd=Pr,Ntn=xi,Vz=yr;class Ftn extends Vz.TextDocumentLanguageFeature{constructor(e){super(e,dd.CodeActionRequest.type)}fillClientCapabilities(e){const t=(0,Vz.ensure)((0,Vz.ensure)(e,"textDocument"),"codeAction");t.dynamicRegistration=!0,t.isPreferredSupport=!0,t.disabledSupport=!0,t.dataSupport=!0,t.resolveSupport={properties:["edit"]},t.codeActionLiteralSupport={codeActionKind:{valueSet:[dd.CodeActionKind.Empty,dd.CodeActionKind.QuickFix,dd.CodeActionKind.Refactor,dd.CodeActionKind.RefactorExtract,dd.CodeActionKind.RefactorInline,dd.CodeActionKind.RefactorRewrite,dd.CodeActionKind.Source,dd.CodeActionKind.SourceOrganizeImports]}},t.honorsChangeAnnotations=!0}initialize(e,t){const r=this.getRegistrationOptions(t,e.codeActionProvider);r&&this.register({id:Ntn.generateUuid(),registerOptions:r})}registerLanguageProvider(e){const t=e.documentSelector,r={provideCodeActions:(i,o,s,a)=>{const c=this._client,l=async(d,h,f,p)=>{const g={textDocument:c.code2ProtocolConverter.asTextDocumentIdentifier(d),range:c.code2ProtocolConverter.asRange(h),context:c.code2ProtocolConverter.asCodeActionContextSync(f)};return c.sendRequest(dd.CodeActionRequest.type,g,p).then(m=>p.isCancellationRequested||m===null||m===void 0?null:c.protocol2CodeConverter.asCodeActionResult(m,p),m=>c.handleFailedRequest(dd.CodeActionRequest.type,p,m,null))},u=c.middleware;return u.provideCodeActions?u.provideCodeActions(i,o,s,a,l):l(i,o,s,a)},resolveCodeAction:e.resolveProvider?(i,o)=>{const s=this._client,a=this._client.middleware,c=async(l,u)=>s.sendRequest(dd.CodeActionResolveRequest.type,s.code2ProtocolConverter.asCodeActionSync(l),u).then(d=>u.isCancellationRequested?l:s.protocol2CodeConverter.asCodeAction(d,u),d=>s.handleFailedRequest(dd.CodeActionResolveRequest.type,u,d,l));return a.resolveCodeAction?a.resolveCodeAction(i,o,c):c(i,o)}:void 0};return[Ltn.languages.registerCodeActionsProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r,e.codeActionKinds?{providedCodeActionKinds:this._client.protocol2CodeConverter.asCodeActionKinds(e.codeActionKinds)}:void 0),r]}}GF.CodeActionFeature=Ftn;var ZF={};Object.defineProperty(ZF,"__esModule",{value:!0});ZF.CodeLensFeature=void 0;const Nwe=wr,bw=Pr,jtn=xi,MI=yr;class Btn extends MI.TextDocumentLanguageFeature{constructor(e){super(e,bw.CodeLensRequest.type)}fillClientCapabilities(e){(0,MI.ensure)((0,MI.ensure)(e,"textDocument"),"codeLens").dynamicRegistration=!0,(0,MI.ensure)((0,MI.ensure)(e,"workspace"),"codeLens").refreshSupport=!0}initialize(e,t){this._client.onRequest(bw.CodeLensRefreshRequest.type,async()=>{for(const o of this.getAllProviders())o.onDidChangeCodeLensEmitter.fire()});const i=this.getRegistrationOptions(t,e.codeLensProvider);i&&this.register({id:jtn.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const t=e.documentSelector,r=new Nwe.EventEmitter,i={onDidChangeCodeLenses:r.event,provideCodeLenses:(o,s)=>{const a=this._client,c=(u,d)=>a.sendRequest(bw.CodeLensRequest.type,a.code2ProtocolConverter.asCodeLensParams(u),d).then(h=>d.isCancellationRequested?null:a.protocol2CodeConverter.asCodeLenses(h,d),h=>a.handleFailedRequest(bw.CodeLensRequest.type,d,h,null)),l=a.middleware;return l.provideCodeLenses?l.provideCodeLenses(o,s,c):c(o,s)},resolveCodeLens:e.resolveProvider?(o,s)=>{const a=this._client,c=(u,d)=>a.sendRequest(bw.CodeLensResolveRequest.type,a.code2ProtocolConverter.asCodeLens(u),d).then(h=>d.isCancellationRequested?u:a.protocol2CodeConverter.asCodeLens(h),h=>a.handleFailedRequest(bw.CodeLensResolveRequest.type,d,h,u)),l=a.middleware;return l.resolveCodeLens?l.resolveCodeLens(o,s,c):c(o,s)}:void 0};return[Nwe.languages.registerCodeLensProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),i),{provider:i,onDidChangeCodeLensEmitter:r}]}}ZF.CodeLensFeature=Btn;var my={};Object.defineProperty(my,"__esModule",{value:!0});my.DocumentOnTypeFormattingFeature=my.DocumentRangeFormattingFeature=my.DocumentFormattingFeature=void 0;const XF=wr,Of=Pr,vse=xi,tv=yr;var $x;(function(n){function e(t){const r=XF.workspace.getConfiguration("files",t);return{trimTrailingWhitespace:r.get("trimTrailingWhitespace"),trimFinalNewlines:r.get("trimFinalNewlines"),insertFinalNewline:r.get("insertFinalNewline")}}n.fromConfiguration=e})($x||($x={}));class Htn extends tv.TextDocumentLanguageFeature{constructor(e){super(e,Of.DocumentFormattingRequest.type)}fillClientCapabilities(e){(0,tv.ensure)((0,tv.ensure)(e,"textDocument"),"formatting").dynamicRegistration=!0}initialize(e,t){const r=this.getRegistrationOptions(t,e.documentFormattingProvider);r&&this.register({id:vse.generateUuid(),registerOptions:r})}registerLanguageProvider(e){const t=e.documentSelector,r={provideDocumentFormattingEdits:(i,o,s)=>{const a=this._client,c=(u,d,h)=>{const f={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(u),options:a.code2ProtocolConverter.asFormattingOptions(d,$x.fromConfiguration(u))};return a.sendRequest(Of.DocumentFormattingRequest.type,f,h).then(p=>h.isCancellationRequested?null:a.protocol2CodeConverter.asTextEdits(p,h),p=>a.handleFailedRequest(Of.DocumentFormattingRequest.type,h,p,null))},l=a.middleware;return l.provideDocumentFormattingEdits?l.provideDocumentFormattingEdits(i,o,s,c):c(i,o,s)}};return[XF.languages.registerDocumentFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}}my.DocumentFormattingFeature=Htn;class Utn extends tv.TextDocumentLanguageFeature{constructor(e){super(e,Of.DocumentRangeFormattingRequest.type)}fillClientCapabilities(e){const t=(0,tv.ensure)((0,tv.ensure)(e,"textDocument"),"rangeFormatting");t.dynamicRegistration=!0,t.rangesSupport=!0}initialize(e,t){const r=this.getRegistrationOptions(t,e.documentRangeFormattingProvider);r&&this.register({id:vse.generateUuid(),registerOptions:r})}registerLanguageProvider(e){const t=e.documentSelector,r={provideDocumentRangeFormattingEdits:(i,o,s,a)=>{const c=this._client,l=(d,h,f,p)=>{const g={textDocument:c.code2ProtocolConverter.asTextDocumentIdentifier(d),range:c.code2ProtocolConverter.asRange(h),options:c.code2ProtocolConverter.asFormattingOptions(f,$x.fromConfiguration(d))};return c.sendRequest(Of.DocumentRangeFormattingRequest.type,g,p).then(m=>p.isCancellationRequested?null:c.protocol2CodeConverter.asTextEdits(m,p),m=>c.handleFailedRequest(Of.DocumentRangeFormattingRequest.type,p,m,null))},u=c.middleware;return u.provideDocumentRangeFormattingEdits?u.provideDocumentRangeFormattingEdits(i,o,s,a,l):l(i,o,s,a)}};return e.rangesSupport&&(r.provideDocumentRangesFormattingEdits=(i,o,s,a)=>{const c=this._client,l=(d,h,f,p)=>{const g={textDocument:c.code2ProtocolConverter.asTextDocumentIdentifier(d),ranges:c.code2ProtocolConverter.asRanges(h),options:c.code2ProtocolConverter.asFormattingOptions(f,$x.fromConfiguration(d))};return c.sendRequest(Of.DocumentRangesFormattingRequest.type,g,p).then(m=>p.isCancellationRequested?null:c.protocol2CodeConverter.asTextEdits(m,p),m=>c.handleFailedRequest(Of.DocumentRangesFormattingRequest.type,p,m,null))},u=c.middleware;return u.provideDocumentRangesFormattingEdits?u.provideDocumentRangesFormattingEdits(i,o,s,a,l):l(i,o,s,a)}),[XF.languages.registerDocumentRangeFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}}my.DocumentRangeFormattingFeature=Utn;class ztn extends tv.TextDocumentLanguageFeature{constructor(e){super(e,Of.DocumentOnTypeFormattingRequest.type)}fillClientCapabilities(e){(0,tv.ensure)((0,tv.ensure)(e,"textDocument"),"onTypeFormatting").dynamicRegistration=!0}initialize(e,t){const r=this.getRegistrationOptions(t,e.documentOnTypeFormattingProvider);r&&this.register({id:vse.generateUuid(),registerOptions:r})}registerLanguageProvider(e){const t=e.documentSelector,r={provideOnTypeFormattingEdits:(o,s,a,c,l)=>{const u=this._client,d=(f,p,g,m,v)=>{let b={textDocument:u.code2ProtocolConverter.asTextDocumentIdentifier(f),position:u.code2ProtocolConverter.asPosition(p),ch:g,options:u.code2ProtocolConverter.asFormattingOptions(m,$x.fromConfiguration(f))};return u.sendRequest(Of.DocumentOnTypeFormattingRequest.type,b,v).then(S=>v.isCancellationRequested?null:u.protocol2CodeConverter.asTextEdits(S,v),S=>u.handleFailedRequest(Of.DocumentOnTypeFormattingRequest.type,v,S,null))},h=u.middleware;return h.provideOnTypeFormattingEdits?h.provideOnTypeFormattingEdits(o,s,a,c,l,d):d(o,s,a,c,l)}},i=e.moreTriggerCharacter||[];return[XF.languages.registerOnTypeFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r,e.firstTriggerCharacter,...i),r]}}my.DocumentOnTypeFormattingFeature=ztn;var YF={};Object.defineProperty(YF,"__esModule",{value:!0});YF.RenameFeature=void 0;const Vtn=wr,Nb=Pr,Wtn=xi,Fwe=ji,Wz=yr;class qtn extends Wz.TextDocumentLanguageFeature{constructor(e){super(e,Nb.RenameRequest.type)}fillClientCapabilities(e){let t=(0,Wz.ensure)((0,Wz.ensure)(e,"textDocument"),"rename");t.dynamicRegistration=!0,t.prepareSupport=!0,t.prepareSupportDefaultBehavior=Nb.PrepareSupportDefaultBehavior.Identifier,t.honorsChangeAnnotations=!0}initialize(e,t){const r=this.getRegistrationOptions(t,e.renameProvider);r&&(Fwe.boolean(e.renameProvider)&&(r.prepareProvider=!1),this.register({id:Wtn.generateUuid(),registerOptions:r}))}registerLanguageProvider(e){const t=e.documentSelector,r={provideRenameEdits:(i,o,s,a)=>{const c=this._client,l=(d,h,f,p)=>{let g={textDocument:c.code2ProtocolConverter.asTextDocumentIdentifier(d),position:c.code2ProtocolConverter.asPosition(h),newName:f};return c.sendRequest(Nb.RenameRequest.type,g,p).then(m=>p.isCancellationRequested?null:c.protocol2CodeConverter.asWorkspaceEdit(m,p),m=>c.handleFailedRequest(Nb.RenameRequest.type,p,m,null,!1))},u=c.middleware;return u.provideRenameEdits?u.provideRenameEdits(i,o,s,a,l):l(i,o,s,a)},prepareRename:e.prepareProvider?(i,o,s)=>{const a=this._client,c=(u,d,h)=>{let f={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(u),position:a.code2ProtocolConverter.asPosition(d)};return a.sendRequest(Nb.PrepareRenameRequest.type,f,h).then(p=>h.isCancellationRequested?null:Nb.Range.is(p)?a.protocol2CodeConverter.asRange(p):this.isDefaultBehavior(p)?p.defaultBehavior===!0?null:Promise.reject(new Error("The element can't be renamed.")):p&&Nb.Range.is(p.range)?{range:a.protocol2CodeConverter.asRange(p.range),placeholder:p.placeholder}:Promise.reject(new Error("The element can't be renamed.")),p=>{throw typeof p.message=="string"?new Error(p.message):new Error("The element can't be renamed.")})},l=a.middleware;return l.prepareRename?l.prepareRename(i,o,s,c):c(i,o,s)}:void 0};return[this.registerProvider(t,r),r]}registerProvider(e,t){return Vtn.languages.registerRenameProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}isDefaultBehavior(e){const t=e;return t&&Fwe.boolean(t.defaultBehavior)}}YF.RenameFeature=qtn;var JF={};Object.defineProperty(JF,"__esModule",{value:!0});JF.DocumentLinkFeature=void 0;const Ktn=wr,$I=Pr,qz=yr,Gtn=xi;class Ztn extends qz.TextDocumentLanguageFeature{constructor(e){super(e,$I.DocumentLinkRequest.type)}fillClientCapabilities(e){const t=(0,qz.ensure)((0,qz.ensure)(e,"textDocument"),"documentLink");t.dynamicRegistration=!0,t.tooltipSupport=!0}initialize(e,t){const r=this.getRegistrationOptions(t,e.documentLinkProvider);r&&this.register({id:Gtn.generateUuid(),registerOptions:r})}registerLanguageProvider(e){const t=e.documentSelector,r={provideDocumentLinks:(i,o)=>{const s=this._client,a=(l,u)=>s.sendRequest($I.DocumentLinkRequest.type,s.code2ProtocolConverter.asDocumentLinkParams(l),u).then(d=>u.isCancellationRequested?null:s.protocol2CodeConverter.asDocumentLinks(d,u),d=>s.handleFailedRequest($I.DocumentLinkRequest.type,u,d,null)),c=s.middleware;return c.provideDocumentLinks?c.provideDocumentLinks(i,o,a):a(i,o)},resolveDocumentLink:e.resolveProvider?(i,o)=>{const s=this._client;let a=(l,u)=>s.sendRequest($I.DocumentLinkResolveRequest.type,s.code2ProtocolConverter.asDocumentLink(l),u).then(d=>u.isCancellationRequested?l:s.protocol2CodeConverter.asDocumentLink(d),d=>s.handleFailedRequest($I.DocumentLinkResolveRequest.type,u,d,l));const c=s.middleware;return c.resolveDocumentLink?c.resolveDocumentLink(i,o,a):a(i,o)}:void 0};return[Ktn.languages.registerDocumentLinkProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}}JF.DocumentLinkFeature=Ztn;var QF={};Object.defineProperty(QF,"__esModule",{value:!0});QF.ExecuteCommandFeature=void 0;const Xtn=wr,Kz=Pr,Ytn=xi,jwe=yr;class Jtn{constructor(e){this._client=e,this._commands=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._commands.size>0}}get registrationType(){return Kz.ExecuteCommandRequest.type}fillClientCapabilities(e){(0,jwe.ensure)((0,jwe.ensure)(e,"workspace"),"executeCommand").dynamicRegistration=!0}initialize(e){e.executeCommandProvider&&this.register({id:Ytn.generateUuid(),registerOptions:Object.assign({},e.executeCommandProvider)})}register(e){const t=this._client,r=t.middleware,i=(o,s)=>{let a={command:o,arguments:s};return t.sendRequest(Kz.ExecuteCommandRequest.type,a).then(void 0,c=>t.handleFailedRequest(Kz.ExecuteCommandRequest.type,void 0,c,void 0))};if(e.registerOptions.commands){const o=[];for(const s of e.registerOptions.commands)o.push(Xtn.commands.registerCommand(s,(...a)=>r.executeCommand?r.executeCommand(s,a,i):i(s,a)));this._commands.set(e.id,o)}}unregister(e){let t=this._commands.get(e);t&&t.forEach(r=>r.dispose())}clear(){this._commands.forEach(e=>{e.forEach(t=>t.dispose())}),this._commands.clear()}}QF.ExecuteCommandFeature=Jtn;var e9={};Object.defineProperty(e9,"__esModule",{value:!0});e9.FileSystemWatcherFeature=void 0;const Qtn=wr,Fb=Pr,WA=yr;class enn{constructor(e,t){this._client=e,this._notifyFileEvent=t,this._watchers=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._watchers.size>0}}get registrationType(){return Fb.DidChangeWatchedFilesNotification.type}fillClientCapabilities(e){(0,WA.ensure)((0,WA.ensure)(e,"workspace"),"didChangeWatchedFiles").dynamicRegistration=!0,(0,WA.ensure)((0,WA.ensure)(e,"workspace"),"didChangeWatchedFiles").relativePatternSupport=!0}initialize(e,t){}register(e){if(!Array.isArray(e.registerOptions.watchers))return;const t=[];for(const r of e.registerOptions.watchers){const i=this._client.protocol2CodeConverter.asGlobPattern(r.globPattern);if(i===void 0)continue;let o=!0,s=!0,a=!0;r.kind!==void 0&&r.kind!==null&&(o=(r.kind&Fb.WatchKind.Create)!==0,s=(r.kind&Fb.WatchKind.Change)!==0,a=(r.kind&Fb.WatchKind.Delete)!==0);const c=Qtn.workspace.createFileSystemWatcher(i,!o,!s,!a);this.hookListeners(c,o,s,a,t),t.push(c)}this._watchers.set(e.id,t)}registerRaw(e,t){let r=[];for(let i of t)this.hookListeners(i,!0,!0,!0,r);this._watchers.set(e,r)}hookListeners(e,t,r,i,o){t&&e.onDidCreate(s=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(s),type:Fb.FileChangeType.Created}),null,o),r&&e.onDidChange(s=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(s),type:Fb.FileChangeType.Changed}),null,o),i&&e.onDidDelete(s=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(s),type:Fb.FileChangeType.Deleted}),null,o)}unregister(e){let t=this._watchers.get(e);if(t)for(let r of t)r.dispose()}clear(){this._watchers.forEach(e=>{for(let t of e)t.dispose()}),this._watchers.clear()}}e9.FileSystemWatcherFeature=enn;var t9={};Object.defineProperty(t9,"__esModule",{value:!0});t9.ColorProviderFeature=void 0;const tnn=wr,LI=Pr,Gz=yr;class nnn extends Gz.TextDocumentLanguageFeature{constructor(e){super(e,LI.DocumentColorRequest.type)}fillClientCapabilities(e){(0,Gz.ensure)((0,Gz.ensure)(e,"textDocument"),"colorProvider").dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.colorProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){const t=e.documentSelector,r={provideColorPresentations:(i,o,s)=>{const a=this._client,c=(u,d,h)=>{const f={color:u,textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(d.document),range:a.code2ProtocolConverter.asRange(d.range)};return a.sendRequest(LI.ColorPresentationRequest.type,f,h).then(p=>h.isCancellationRequested?null:this._client.protocol2CodeConverter.asColorPresentations(p,h),p=>a.handleFailedRequest(LI.ColorPresentationRequest.type,h,p,null))},l=a.middleware;return l.provideColorPresentations?l.provideColorPresentations(i,o,s,c):c(i,o,s)},provideDocumentColors:(i,o)=>{const s=this._client,a=(l,u)=>{const d={textDocument:s.code2ProtocolConverter.asTextDocumentIdentifier(l)};return s.sendRequest(LI.DocumentColorRequest.type,d,u).then(h=>u.isCancellationRequested?null:this._client.protocol2CodeConverter.asColorInformations(h,u),h=>s.handleFailedRequest(LI.DocumentColorRequest.type,u,h,null))},c=s.middleware;return c.provideDocumentColors?c.provideDocumentColors(i,o,a):a(i,o)}};return[tnn.languages.registerColorProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}}t9.ColorProviderFeature=nnn;var n9={};Object.defineProperty(n9,"__esModule",{value:!0});n9.ImplementationFeature=void 0;const rnn=wr,Zz=Pr,Xz=yr;class inn extends Xz.TextDocumentLanguageFeature{constructor(e){super(e,Zz.ImplementationRequest.type)}fillClientCapabilities(e){let t=(0,Xz.ensure)((0,Xz.ensure)(e,"textDocument"),"implementation");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.implementationProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){const t=e.documentSelector,r={provideImplementation:(i,o,s)=>{const a=this._client,c=(u,d,h)=>a.sendRequest(Zz.ImplementationRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(u,d),h).then(f=>h.isCancellationRequested?null:a.protocol2CodeConverter.asDefinitionResult(f,h),f=>a.handleFailedRequest(Zz.ImplementationRequest.type,h,f,null)),l=a.middleware;return l.provideImplementation?l.provideImplementation(i,o,s,c):c(i,o,s)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return rnn.languages.registerImplementationProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}}n9.ImplementationFeature=inn;var r9={};Object.defineProperty(r9,"__esModule",{value:!0});r9.TypeDefinitionFeature=void 0;const onn=wr,Yz=Pr,NI=yr;class snn extends NI.TextDocumentLanguageFeature{constructor(e){super(e,Yz.TypeDefinitionRequest.type)}fillClientCapabilities(e){(0,NI.ensure)((0,NI.ensure)(e,"textDocument"),"typeDefinition").dynamicRegistration=!0;let t=(0,NI.ensure)((0,NI.ensure)(e,"textDocument"),"typeDefinition");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.typeDefinitionProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){const t=e.documentSelector,r={provideTypeDefinition:(i,o,s)=>{const a=this._client,c=(u,d,h)=>a.sendRequest(Yz.TypeDefinitionRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(u,d),h).then(f=>h.isCancellationRequested?null:a.protocol2CodeConverter.asDefinitionResult(f,h),f=>a.handleFailedRequest(Yz.TypeDefinitionRequest.type,h,f,null)),l=a.middleware;return l.provideTypeDefinition?l.provideTypeDefinition(i,o,s,c):c(i,o,s)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return onn.languages.registerTypeDefinitionProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}}r9.TypeDefinitionFeature=snn;var Lx={};Object.defineProperty(Lx,"__esModule",{value:!0});Lx.WorkspaceFoldersFeature=Lx.arrayDiff=void 0;const ann=xi,qA=wr,FI=Pr;function Jz(n,e){if(n!=null)return n[e]}function kJ(n,e){return n.filter(t=>e.indexOf(t)<0)}Lx.arrayDiff=kJ;class cnn{constructor(e){this._client=e,this._listeners=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._listeners.size>0}}get registrationType(){return FI.DidChangeWorkspaceFoldersNotification.type}fillInitializeParams(e){const t=qA.workspace.workspaceFolders;this.initializeWithFolders(t),t===void 0?e.workspaceFolders=null:e.workspaceFolders=t.map(r=>this.asProtocol(r))}initializeWithFolders(e){this._initialFolders=e}fillClientCapabilities(e){e.workspace=e.workspace||{},e.workspace.workspaceFolders=!0}initialize(e){const t=this._client;t.onRequest(FI.WorkspaceFoldersRequest.type,o=>{const s=()=>{const c=qA.workspace.workspaceFolders;return c===void 0?null:c.map(u=>this.asProtocol(u))},a=t.middleware.workspace;return a&&a.workspaceFolders?a.workspaceFolders(o,s):s()});const r=Jz(Jz(Jz(e,"workspace"),"workspaceFolders"),"changeNotifications");let i;typeof r=="string"?i=r:r===!0&&(i=ann.generateUuid()),i&&this.register({id:i,registerOptions:void 0})}sendInitialEvent(e){let t;if(this._initialFolders&&e){const r=kJ(this._initialFolders,e),i=kJ(e,this._initialFolders);(i.length>0||r.length>0)&&(t=this.doSendEvent(i,r))}else this._initialFolders?t=this.doSendEvent([],this._initialFolders):e&&(t=this.doSendEvent(e,[]));t!==void 0&&t.catch(r=>{this._client.error(`Sending notification ${FI.DidChangeWorkspaceFoldersNotification.type.method} failed`,r)})}doSendEvent(e,t){let r={event:{added:e.map(i=>this.asProtocol(i)),removed:t.map(i=>this.asProtocol(i))}};return this._client.sendNotification(FI.DidChangeWorkspaceFoldersNotification.type,r)}register(e){let t=e.id,r=this._client,i=qA.workspace.onDidChangeWorkspaceFolders(o=>{let s=l=>this.doSendEvent(l.added,l.removed),a=r.middleware.workspace;(a&&a.didChangeWorkspaceFolders?a.didChangeWorkspaceFolders(o,s):s(o)).catch(l=>{this._client.error(`Sending notification ${FI.DidChangeWorkspaceFoldersNotification.type.method} failed`,l)})});this._listeners.set(t,i),this.sendInitialEvent(qA.workspace.workspaceFolders)}unregister(e){let t=this._listeners.get(e);t!==void 0&&(this._listeners.delete(e),t.dispose())}clear(){for(let e of this._listeners.values())e.dispose();this._listeners.clear()}asProtocol(e){return e===void 0?null:{uri:this._client.code2ProtocolConverter.asUri(e.uri),name:e.name}}}Lx.WorkspaceFoldersFeature=cnn;var i9={};Object.defineProperty(i9,"__esModule",{value:!0});i9.FoldingRangeFeature=void 0;const Bwe=wr,jb=Pr,jI=yr;class lnn extends jI.TextDocumentLanguageFeature{constructor(e){super(e,jb.FoldingRangeRequest.type)}fillClientCapabilities(e){let t=(0,jI.ensure)((0,jI.ensure)(e,"textDocument"),"foldingRange");t.dynamicRegistration=!0,t.rangeLimit=5e3,t.lineFoldingOnly=!0,t.foldingRangeKind={valueSet:[jb.FoldingRangeKind.Comment,jb.FoldingRangeKind.Imports,jb.FoldingRangeKind.Region]},t.foldingRange={collapsedText:!1},(0,jI.ensure)((0,jI.ensure)(e,"workspace"),"foldingRange").refreshSupport=!0}initialize(e,t){this._client.onRequest(jb.FoldingRangeRefreshRequest.type,async()=>{for(const o of this.getAllProviders())o.onDidChangeFoldingRange.fire()});let[r,i]=this.getRegistration(t,e.foldingRangeProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){const t=e.documentSelector,r=new Bwe.EventEmitter,i={onDidChangeFoldingRanges:r.event,provideFoldingRanges:(o,s,a)=>{const c=this._client,l=(d,h,f)=>{const p={textDocument:c.code2ProtocolConverter.asTextDocumentIdentifier(d)};return c.sendRequest(jb.FoldingRangeRequest.type,p,f).then(g=>f.isCancellationRequested?null:c.protocol2CodeConverter.asFoldingRanges(g,f),g=>c.handleFailedRequest(jb.FoldingRangeRequest.type,f,g,null))},u=c.middleware;return u.provideFoldingRanges?u.provideFoldingRanges(o,s,a,l):l(o,s,a)}};return[Bwe.languages.registerFoldingRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),i),{provider:i,onDidChangeFoldingRange:r}]}}i9.FoldingRangeFeature=lnn;var o9={};Object.defineProperty(o9,"__esModule",{value:!0});o9.DeclarationFeature=void 0;const unn=wr,Qz=Pr,eV=yr;class dnn extends eV.TextDocumentLanguageFeature{constructor(e){super(e,Qz.DeclarationRequest.type)}fillClientCapabilities(e){const t=(0,eV.ensure)((0,eV.ensure)(e,"textDocument"),"declaration");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){const[r,i]=this.getRegistration(t,e.declarationProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){const t=e.documentSelector,r={provideDeclaration:(i,o,s)=>{const a=this._client,c=(u,d,h)=>a.sendRequest(Qz.DeclarationRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(u,d),h).then(f=>h.isCancellationRequested?null:a.protocol2CodeConverter.asDeclarationResult(f,h),f=>a.handleFailedRequest(Qz.DeclarationRequest.type,h,f,null)),l=a.middleware;return l.provideDeclaration?l.provideDeclaration(i,o,s,c):c(i,o,s)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return unn.languages.registerDeclarationProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}}o9.DeclarationFeature=dnn;var s9={};Object.defineProperty(s9,"__esModule",{value:!0});s9.SelectionRangeFeature=void 0;const hnn=wr,tV=Pr,nV=yr;class fnn extends nV.TextDocumentLanguageFeature{constructor(e){super(e,tV.SelectionRangeRequest.type)}fillClientCapabilities(e){const t=(0,nV.ensure)((0,nV.ensure)(e,"textDocument"),"selectionRange");t.dynamicRegistration=!0}initialize(e,t){const[r,i]=this.getRegistration(t,e.selectionRangeProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){const t=e.documentSelector,r={provideSelectionRanges:(i,o,s)=>{const a=this._client,c=async(u,d,h)=>{const f={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(u),positions:a.code2ProtocolConverter.asPositionsSync(d,h)};return a.sendRequest(tV.SelectionRangeRequest.type,f,h).then(p=>h.isCancellationRequested?null:a.protocol2CodeConverter.asSelectionRanges(p,h),p=>a.handleFailedRequest(tV.SelectionRangeRequest.type,h,p,null))},l=a.middleware;return l.provideSelectionRanges?l.provideSelectionRanges(i,o,s,c):c(i,o,s)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return hnn.languages.registerSelectionRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}}s9.SelectionRangeFeature=fnn;var a9={};Object.defineProperty(a9,"__esModule",{value:!0});a9.ProgressFeature=void 0;const Hwe=Pr,pnn=rR;function gnn(n,e){return n[e]===void 0&&(n[e]=Object.create(null)),n[e]}class mnn{constructor(e){this._client=e,this.activeParts=new Set}getState(){return{kind:"window",id:Hwe.WorkDoneProgressCreateRequest.method,registrations:this.activeParts.size>0}}fillClientCapabilities(e){gnn(e,"window").workDoneProgress=!0}initialize(){const e=this._client,t=i=>{this.activeParts.delete(i)},r=i=>{this.activeParts.add(new pnn.ProgressPart(this._client,i.token,t))};e.onRequest(Hwe.WorkDoneProgressCreateRequest.type,r)}clear(){for(const e of this.activeParts)e.done();this.activeParts.clear()}}a9.ProgressFeature=mnn;var c9={};Object.defineProperty(c9,"__esModule",{value:!0});c9.CallHierarchyFeature=void 0;const vnn=wr,t1=Pr,rV=yr;class ynn{constructor(e){this.client=e,this.middleware=e.middleware}prepareCallHierarchy(e,t,r){const i=this.client,o=this.middleware,s=(a,c,l)=>{const u=i.code2ProtocolConverter.asTextDocumentPositionParams(a,c);return i.sendRequest(t1.CallHierarchyPrepareRequest.type,u,l).then(d=>l.isCancellationRequested?null:i.protocol2CodeConverter.asCallHierarchyItems(d,l),d=>i.handleFailedRequest(t1.CallHierarchyPrepareRequest.type,l,d,null))};return o.prepareCallHierarchy?o.prepareCallHierarchy(e,t,r,s):s(e,t,r)}provideCallHierarchyIncomingCalls(e,t){const r=this.client,i=this.middleware,o=(s,a)=>{const c={item:r.code2ProtocolConverter.asCallHierarchyItem(s)};return r.sendRequest(t1.CallHierarchyIncomingCallsRequest.type,c,a).then(l=>a.isCancellationRequested?null:r.protocol2CodeConverter.asCallHierarchyIncomingCalls(l,a),l=>r.handleFailedRequest(t1.CallHierarchyIncomingCallsRequest.type,a,l,null))};return i.provideCallHierarchyIncomingCalls?i.provideCallHierarchyIncomingCalls(e,t,o):o(e,t)}provideCallHierarchyOutgoingCalls(e,t){const r=this.client,i=this.middleware,o=(s,a)=>{const c={item:r.code2ProtocolConverter.asCallHierarchyItem(s)};return r.sendRequest(t1.CallHierarchyOutgoingCallsRequest.type,c,a).then(l=>a.isCancellationRequested?null:r.protocol2CodeConverter.asCallHierarchyOutgoingCalls(l,a),l=>r.handleFailedRequest(t1.CallHierarchyOutgoingCallsRequest.type,a,l,null))};return i.provideCallHierarchyOutgoingCalls?i.provideCallHierarchyOutgoingCalls(e,t,o):o(e,t)}}class bnn extends rV.TextDocumentLanguageFeature{constructor(e){super(e,t1.CallHierarchyPrepareRequest.type)}fillClientCapabilities(e){const t=e,r=(0,rV.ensure)((0,rV.ensure)(t,"textDocument"),"callHierarchy");r.dynamicRegistration=!0}initialize(e,t){const[r,i]=this.getRegistration(t,e.callHierarchyProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){const t=this._client,r=new ynn(t);return[vnn.languages.registerCallHierarchyProvider(this._client.protocol2CodeConverter.asDocumentSelector(e.documentSelector),r),r]}}c9.CallHierarchyFeature=bnn;var l9={};Object.defineProperty(l9,"__esModule",{value:!0});l9.SemanticTokensFeature=void 0;const KA=wr,Mr=Pr,BI=yr,Snn=ji;class _nn extends BI.TextDocumentLanguageFeature{constructor(e){super(e,Mr.SemanticTokensRegistrationType.type)}fillClientCapabilities(e){const t=(0,BI.ensure)((0,BI.ensure)(e,"textDocument"),"semanticTokens");t.dynamicRegistration=!0,t.tokenTypes=[Mr.SemanticTokenTypes.namespace,Mr.SemanticTokenTypes.type,Mr.SemanticTokenTypes.class,Mr.SemanticTokenTypes.enum,Mr.SemanticTokenTypes.interface,Mr.SemanticTokenTypes.struct,Mr.SemanticTokenTypes.typeParameter,Mr.SemanticTokenTypes.parameter,Mr.SemanticTokenTypes.variable,Mr.SemanticTokenTypes.property,Mr.SemanticTokenTypes.enumMember,Mr.SemanticTokenTypes.event,Mr.SemanticTokenTypes.function,Mr.SemanticTokenTypes.method,Mr.SemanticTokenTypes.macro,Mr.SemanticTokenTypes.keyword,Mr.SemanticTokenTypes.modifier,Mr.SemanticTokenTypes.comment,Mr.SemanticTokenTypes.string,Mr.SemanticTokenTypes.number,Mr.SemanticTokenTypes.regexp,Mr.SemanticTokenTypes.operator,Mr.SemanticTokenTypes.decorator],t.tokenModifiers=[Mr.SemanticTokenModifiers.declaration,Mr.SemanticTokenModifiers.definition,Mr.SemanticTokenModifiers.readonly,Mr.SemanticTokenModifiers.static,Mr.SemanticTokenModifiers.deprecated,Mr.SemanticTokenModifiers.abstract,Mr.SemanticTokenModifiers.async,Mr.SemanticTokenModifiers.modification,Mr.SemanticTokenModifiers.documentation,Mr.SemanticTokenModifiers.defaultLibrary],t.formats=[Mr.TokenFormat.Relative],t.requests={range:!0,full:{delta:!0}},t.multilineTokenSupport=!1,t.overlappingTokenSupport=!1,t.serverCancelSupport=!0,t.augmentsSyntaxTokens=!0,(0,BI.ensure)((0,BI.ensure)(e,"workspace"),"semanticTokens").refreshSupport=!0}initialize(e,t){this._client.onRequest(Mr.SemanticTokensRefreshRequest.type,async()=>{for(const s of this.getAllProviders())s.onDidChangeSemanticTokensEmitter.fire()});const[i,o]=this.getRegistration(t,e.semanticTokensProvider);!i||!o||this.register({id:i,registerOptions:o})}registerLanguageProvider(e){const t=e.documentSelector,r=Snn.boolean(e.full)?e.full:e.full!==void 0,i=e.full!==void 0&&typeof e.full!="boolean"&&e.full.delta===!0,o=new KA.EventEmitter,s=r?{onDidChangeSemanticTokens:o.event,provideDocumentSemanticTokens:(f,p)=>{const g=this._client,m=g.middleware,v=(b,S)=>{const E={textDocument:g.code2ProtocolConverter.asTextDocumentIdentifier(b)};return g.sendRequest(Mr.SemanticTokensRequest.type,E,S).then(w=>S.isCancellationRequested?null:g.protocol2CodeConverter.asSemanticTokens(w,S),w=>g.handleFailedRequest(Mr.SemanticTokensRequest.type,S,w,null))};return m.provideDocumentSemanticTokens?m.provideDocumentSemanticTokens(f,p,v):v(f,p)},provideDocumentSemanticTokensEdits:i?(f,p,g)=>{const m=this._client,v=m.middleware,b=(S,E,w)=>{const C={textDocument:m.code2ProtocolConverter.asTextDocumentIdentifier(S),previousResultId:E};return m.sendRequest(Mr.SemanticTokensDeltaRequest.type,C,w).then(async I=>w.isCancellationRequested?null:Mr.SemanticTokens.is(I)?await m.protocol2CodeConverter.asSemanticTokens(I,w):await m.protocol2CodeConverter.asSemanticTokensEdits(I,w),I=>m.handleFailedRequest(Mr.SemanticTokensDeltaRequest.type,w,I,null))};return v.provideDocumentSemanticTokensEdits?v.provideDocumentSemanticTokensEdits(f,p,g,b):b(f,p,g)}:void 0}:void 0,c=e.range===!0?{provideDocumentRangeSemanticTokens:(f,p,g)=>{const m=this._client,v=m.middleware,b=(S,E,w)=>{const C={textDocument:m.code2ProtocolConverter.asTextDocumentIdentifier(S),range:m.code2ProtocolConverter.asRange(E)};return m.sendRequest(Mr.SemanticTokensRangeRequest.type,C,w).then(I=>w.isCancellationRequested?null:m.protocol2CodeConverter.asSemanticTokens(I,w),I=>m.handleFailedRequest(Mr.SemanticTokensRangeRequest.type,w,I,null))};return v.provideDocumentRangeSemanticTokens?v.provideDocumentRangeSemanticTokens(f,p,g,b):b(f,p,g)}}:void 0,l=[],u=this._client,d=u.protocol2CodeConverter.asSemanticTokensLegend(e.legend),h=u.protocol2CodeConverter.asDocumentSelector(t);return s!==void 0&&l.push(KA.languages.registerDocumentSemanticTokensProvider(h,s,d)),c!==void 0&&l.push(KA.languages.registerDocumentRangeSemanticTokensProvider(h,c,d)),[new KA.Disposable(()=>l.forEach(f=>f.dispose())),{range:c,full:s,onDidChangeSemanticTokensEmitter:o}]}}l9.SemanticTokensFeature=_nn;var Ou={};Object.defineProperty(Ou,"__esModule",{value:!0});Ou.WillDeleteFilesFeature=Ou.WillRenameFilesFeature=Ou.WillCreateFilesFeature=Ou.DidDeleteFilesFeature=Ou.DidRenameFilesFeature=Ou.DidCreateFilesFeature=void 0;const $h=wr,wnn=FF,nv=Pr,Cnn=xi;function Uwe(n,e){return n[e]===void 0&&(n[e]={}),n[e]}function xnn(n,e){return n[e]}function zwe(n,e,t){n[e]=t}class yS{constructor(e,t,r,i,o){this._client=e,this._event=t,this._registrationType=r,this._clientCapability=i,this._serverCapability=o,this._filters=new Map}getState(){return{kind:"workspace",id:this._registrationType.method,registrations:this._filters.size>0}}filterSize(){return this._filters.size}get registrationType(){return this._registrationType}fillClientCapabilities(e){const t=Uwe(Uwe(e,"workspace"),"fileOperations");zwe(t,"dynamicRegistration",!0),zwe(t,this._clientCapability,!0)}initialize(e){var i;const t=(i=e.workspace)==null?void 0:i.fileOperations,r=t!==void 0?xnn(t,this._serverCapability):void 0;if((r==null?void 0:r.filters)!==void 0)try{this.register({id:Cnn.generateUuid(),registerOptions:{filters:r.filters}})}catch(o){this._client.warn(`Ignoring invalid glob pattern for ${this._serverCapability} registration: ${o}`)}}register(e){this._listener||(this._listener=this._event(this.send,this));const t=e.registerOptions.filters.map(r=>{const i=new wnn.Minimatch(r.pattern.glob,yS.asMinimatchOptions(r.pattern.options));if(!i.makeRe())throw new Error(`Invalid pattern ${r.pattern.glob}!`);return{scheme:r.scheme,matcher:i,kind:r.pattern.matches}});this._filters.set(e.id,t)}unregister(e){this._filters.delete(e),this._filters.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}clear(){this._filters.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}getFileType(e){return yS.getFileType(e)}async filter(e,t){const r=await Promise.all(e.files.map(async o=>{const s=t(o),a=s.fsPath.replace(/\\/g,"/");for(const c of this._filters.values())for(const l of c)if(!(l.scheme!==void 0&&l.scheme!==s.scheme)){if(l.matcher.match(a)){if(l.kind===void 0)return!0;const u=await this.getFileType(s);if(u===void 0)return this._client.error(`Failed to determine file type for ${s.toString()}.`),!0;if(u===$h.FileType.File&&l.kind===nv.FileOperationPatternKind.file||u===$h.FileType.Directory&&l.kind===nv.FileOperationPatternKind.folder)return!0}else if(l.kind===nv.FileOperationPatternKind.folder&&await yS.getFileType(s)===$h.FileType.Directory&&l.matcher.match(`${a}/`))return!0}return!1})),i=e.files.filter((o,s)=>r[s]);return{...e,files:i}}static async getFileType(e){try{return(await $h.workspace.fs.stat(e)).type}catch{return}}static asMinimatchOptions(e){const t={dot:!0};return(e==null?void 0:e.ignoreCase)===!0&&(t.nocase=!0),t}}class GBe extends yS{constructor(e,t,r,i,o,s,a){super(e,t,r,i,o),this._notificationType=r,this._accessUri=s,this._createParams=a}async send(e){const t=await this.filter(e,this._accessUri);if(t.files.length){const r=async i=>this._client.sendNotification(this._notificationType,this._createParams(i));return this.doSend(t,r)}}}class ZBe extends GBe{constructor(){super(...arguments),this._fsPathFileTypes=new Map}async getFileType(e){const t=e.fsPath;if(this._fsPathFileTypes.has(t))return this._fsPathFileTypes.get(t);const r=await yS.getFileType(e);return r&&this._fsPathFileTypes.set(t,r),r}async cacheFileTypes(e,t){await this.filter(e,t)}clearFileTypeCache(){this._fsPathFileTypes.clear()}unregister(e){super.unregister(e),this.filterSize()===0&&this._willListener&&(this._willListener.dispose(),this._willListener=void 0)}clear(){super.clear(),this._willListener&&(this._willListener.dispose(),this._willListener=void 0)}}class Enn extends GBe{constructor(e){super(e,$h.workspace.onDidCreateFiles,nv.DidCreateFilesNotification.type,"didCreate","didCreate",t=>t,e.code2ProtocolConverter.asDidCreateFilesParams)}doSend(e,t){const r=this._client.middleware.workspace;return r!=null&&r.didCreateFiles?r.didCreateFiles(e,t):t(e)}}Ou.DidCreateFilesFeature=Enn;class Inn extends ZBe{constructor(e){super(e,$h.workspace.onDidRenameFiles,nv.DidRenameFilesNotification.type,"didRename","didRename",t=>t.oldUri,e.code2ProtocolConverter.asDidRenameFilesParams)}register(e){this._willListener||(this._willListener=$h.workspace.onWillRenameFiles(this.willRename,this)),super.register(e)}willRename(e){e.waitUntil(this.cacheFileTypes(e,t=>t.oldUri))}doSend(e,t){this.clearFileTypeCache();const r=this._client.middleware.workspace;return r!=null&&r.didRenameFiles?r.didRenameFiles(e,t):t(e)}}Ou.DidRenameFilesFeature=Inn;class Pnn extends ZBe{constructor(e){super(e,$h.workspace.onDidDeleteFiles,nv.DidDeleteFilesNotification.type,"didDelete","didDelete",t=>t,e.code2ProtocolConverter.asDidDeleteFilesParams)}register(e){this._willListener||(this._willListener=$h.workspace.onWillDeleteFiles(this.willDelete,this)),super.register(e)}willDelete(e){e.waitUntil(this.cacheFileTypes(e,t=>t))}doSend(e,t){this.clearFileTypeCache();const r=this._client.middleware.workspace;return r!=null&&r.didDeleteFiles?r.didDeleteFiles(e,t):t(e)}}Ou.DidDeleteFilesFeature=Pnn;class yse extends yS{constructor(e,t,r,i,o,s,a){super(e,t,r,i,o),this._requestType=r,this._accessUri=s,this._createParams=a}async send(e){const t=this.waitUntil(e);e.waitUntil(t)}async waitUntil(e){const t=await this.filter(e,this._accessUri);if(t.files.length){const r=i=>this._client.sendRequest(this._requestType,this._createParams(i),i.token).then(this._client.protocol2CodeConverter.asWorkspaceEdit);return this.doSend(t,r)}else return}}class knn extends yse{constructor(e){super(e,$h.workspace.onWillCreateFiles,nv.WillCreateFilesRequest.type,"willCreate","willCreate",t=>t,e.code2ProtocolConverter.asWillCreateFilesParams)}doSend(e,t){const r=this._client.middleware.workspace;return r!=null&&r.willCreateFiles?r.willCreateFiles(e,t):t(e)}}Ou.WillCreateFilesFeature=knn;class Tnn extends yse{constructor(e){super(e,$h.workspace.onWillRenameFiles,nv.WillRenameFilesRequest.type,"willRename","willRename",t=>t.oldUri,e.code2ProtocolConverter.asWillRenameFilesParams)}doSend(e,t){const r=this._client.middleware.workspace;return r!=null&&r.willRenameFiles?r.willRenameFiles(e,t):t(e)}}Ou.WillRenameFilesFeature=Tnn;class Dnn extends yse{constructor(e){super(e,$h.workspace.onWillDeleteFiles,nv.WillDeleteFilesRequest.type,"willDelete","willDelete",t=>t,e.code2ProtocolConverter.asWillDeleteFilesParams)}doSend(e,t){const r=this._client.middleware.workspace;return r!=null&&r.willDeleteFiles?r.willDeleteFiles(e,t):t(e)}}Ou.WillDeleteFilesFeature=Dnn;var u9={};Object.defineProperty(u9,"__esModule",{value:!0});u9.LinkedEditingFeature=void 0;const Rnn=wr,iV=Pr,oV=yr;class Ann extends oV.TextDocumentLanguageFeature{constructor(e){super(e,iV.LinkedEditingRangeRequest.type)}fillClientCapabilities(e){const t=(0,oV.ensure)((0,oV.ensure)(e,"textDocument"),"linkedEditingRange");t.dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.linkedEditingRangeProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){const t=e.documentSelector,r={provideLinkedEditingRanges:(i,o,s)=>{const a=this._client,c=(u,d,h)=>a.sendRequest(iV.LinkedEditingRangeRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(u,d),h).then(f=>h.isCancellationRequested?null:a.protocol2CodeConverter.asLinkedEditingRanges(f,h),f=>a.handleFailedRequest(iV.LinkedEditingRangeRequest.type,h,f,null)),l=a.middleware;return l.provideLinkedEditingRange?l.provideLinkedEditingRange(i,o,s,c):c(i,o,s)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return Rnn.languages.registerLinkedEditingRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}}u9.LinkedEditingFeature=Ann;var d9={};Object.defineProperty(d9,"__esModule",{value:!0});d9.TypeHierarchyFeature=void 0;const Onn=wr,n1=Pr,sV=yr;class Mnn{constructor(e){this.client=e,this.middleware=e.middleware}prepareTypeHierarchy(e,t,r){const i=this.client,o=this.middleware,s=(a,c,l)=>{const u=i.code2ProtocolConverter.asTextDocumentPositionParams(a,c);return i.sendRequest(n1.TypeHierarchyPrepareRequest.type,u,l).then(d=>l.isCancellationRequested?null:i.protocol2CodeConverter.asTypeHierarchyItems(d,l),d=>i.handleFailedRequest(n1.TypeHierarchyPrepareRequest.type,l,d,null))};return o.prepareTypeHierarchy?o.prepareTypeHierarchy(e,t,r,s):s(e,t,r)}provideTypeHierarchySupertypes(e,t){const r=this.client,i=this.middleware,o=(s,a)=>{const c={item:r.code2ProtocolConverter.asTypeHierarchyItem(s)};return r.sendRequest(n1.TypeHierarchySupertypesRequest.type,c,a).then(l=>a.isCancellationRequested?null:r.protocol2CodeConverter.asTypeHierarchyItems(l,a),l=>r.handleFailedRequest(n1.TypeHierarchySupertypesRequest.type,a,l,null))};return i.provideTypeHierarchySupertypes?i.provideTypeHierarchySupertypes(e,t,o):o(e,t)}provideTypeHierarchySubtypes(e,t){const r=this.client,i=this.middleware,o=(s,a)=>{const c={item:r.code2ProtocolConverter.asTypeHierarchyItem(s)};return r.sendRequest(n1.TypeHierarchySubtypesRequest.type,c,a).then(l=>a.isCancellationRequested?null:r.protocol2CodeConverter.asTypeHierarchyItems(l,a),l=>r.handleFailedRequest(n1.TypeHierarchySubtypesRequest.type,a,l,null))};return i.provideTypeHierarchySubtypes?i.provideTypeHierarchySubtypes(e,t,o):o(e,t)}}class $nn extends sV.TextDocumentLanguageFeature{constructor(e){super(e,n1.TypeHierarchyPrepareRequest.type)}fillClientCapabilities(e){const t=(0,sV.ensure)((0,sV.ensure)(e,"textDocument"),"typeHierarchy");t.dynamicRegistration=!0}initialize(e,t){const[r,i]=this.getRegistration(t,e.typeHierarchyProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){const t=this._client,r=new Mnn(t);return[Onn.languages.registerTypeHierarchyProvider(t.protocol2CodeConverter.asDocumentSelector(e.documentSelector),r),r]}}d9.TypeHierarchyFeature=$nn;var h9={};Object.defineProperty(h9,"__esModule",{value:!0});h9.InlineValueFeature=void 0;const Vwe=wr,GA=Pr,HI=yr;class Lnn extends HI.TextDocumentLanguageFeature{constructor(e){super(e,GA.InlineValueRequest.type)}fillClientCapabilities(e){(0,HI.ensure)((0,HI.ensure)(e,"textDocument"),"inlineValue").dynamicRegistration=!0,(0,HI.ensure)((0,HI.ensure)(e,"workspace"),"inlineValue").refreshSupport=!0}initialize(e,t){this._client.onRequest(GA.InlineValueRefreshRequest.type,async()=>{for(const o of this.getAllProviders())o.onDidChangeInlineValues.fire()});const[r,i]=this.getRegistration(t,e.inlineValueProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){const t=e.documentSelector,r=new Vwe.EventEmitter,i={onDidChangeInlineValues:r.event,provideInlineValues:(o,s,a,c)=>{const l=this._client,u=(h,f,p,g)=>{const m={textDocument:l.code2ProtocolConverter.asTextDocumentIdentifier(h),range:l.code2ProtocolConverter.asRange(f),context:l.code2ProtocolConverter.asInlineValueContext(p)};return l.sendRequest(GA.InlineValueRequest.type,m,g).then(v=>g.isCancellationRequested?null:l.protocol2CodeConverter.asInlineValues(v,g),v=>l.handleFailedRequest(GA.InlineValueRequest.type,g,v,null))},d=l.middleware;return d.provideInlineValues?d.provideInlineValues(o,s,a,c,u):u(o,s,a,c)}};return[this.registerProvider(t,i),{provider:i,onDidChangeInlineValues:r}]}registerProvider(e,t){return Vwe.languages.registerInlineValuesProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}}h9.InlineValueFeature=Lnn;var f9={};Object.defineProperty(f9,"__esModule",{value:!0});f9.InlayHintsFeature=void 0;const Wwe=wr,Sw=Pr,UI=yr;class Nnn extends UI.TextDocumentLanguageFeature{constructor(e){super(e,Sw.InlayHintRequest.type)}fillClientCapabilities(e){const t=(0,UI.ensure)((0,UI.ensure)(e,"textDocument"),"inlayHint");t.dynamicRegistration=!0,t.resolveSupport={properties:["tooltip","textEdits","label.tooltip","label.location","label.command"]},(0,UI.ensure)((0,UI.ensure)(e,"workspace"),"inlayHint").refreshSupport=!0}initialize(e,t){this._client.onRequest(Sw.InlayHintRefreshRequest.type,async()=>{for(const o of this.getAllProviders())o.onDidChangeInlayHints.fire()});const[r,i]=this.getRegistration(t,e.inlayHintProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){const t=e.documentSelector,r=new Wwe.EventEmitter,i={onDidChangeInlayHints:r.event,provideInlayHints:(o,s,a)=>{const c=this._client,l=async(d,h,f)=>{const p={textDocument:c.code2ProtocolConverter.asTextDocumentIdentifier(d),range:c.code2ProtocolConverter.asRange(h)};try{const g=await c.sendRequest(Sw.InlayHintRequest.type,p,f);return f.isCancellationRequested?null:c.protocol2CodeConverter.asInlayHints(g,f)}catch(g){return c.handleFailedRequest(Sw.InlayHintRequest.type,f,g,null)}},u=c.middleware;return u.provideInlayHints?u.provideInlayHints(o,s,a,l):l(o,s,a)}};return i.resolveInlayHint=e.resolveProvider===!0?(o,s)=>{const a=this._client,c=async(u,d)=>{try{const h=await a.sendRequest(Sw.InlayHintResolveRequest.type,a.code2ProtocolConverter.asInlayHint(u),d);if(d.isCancellationRequested)return null;const f=a.protocol2CodeConverter.asInlayHint(h,d);return d.isCancellationRequested?null:f}catch(h){return a.handleFailedRequest(Sw.InlayHintResolveRequest.type,d,h,null)}},l=a.middleware;return l.resolveInlayHint?l.resolveInlayHint(o,s,c):c(o,s)}:void 0,[this.registerProvider(t,i),{provider:i,onDidChangeInlayHints:r}]}registerProvider(e,t){return Wwe.languages.registerInlayHintsProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}}f9.InlayHintsFeature=Nnn;var p9={};Object.defineProperty(p9,"__esModule",{value:!0});p9.InlineCompletionItemFeature=void 0;const Fnn=wr,aV=Pr,cV=yr,jnn=xi;class Bnn extends cV.TextDocumentLanguageFeature{constructor(e){super(e,aV.InlineCompletionRequest.type)}fillClientCapabilities(e){let t=(0,cV.ensure)((0,cV.ensure)(e,"textDocument"),"inlineCompletion");t.dynamicRegistration=!0}initialize(e,t){const r=this.getRegistrationOptions(t,e.inlineCompletionProvider);r&&this.register({id:jnn.generateUuid(),registerOptions:r})}registerLanguageProvider(e){const t=e.documentSelector,r={provideInlineCompletionItems:(i,o,s,a)=>{const c=this._client,l=this._client.middleware,u=(d,h,f,p)=>c.sendRequest(aV.InlineCompletionRequest.type,c.code2ProtocolConverter.asInlineCompletionParams(d,h,f),p).then(g=>p.isCancellationRequested?null:c.protocol2CodeConverter.asInlineCompletionResult(g,p),g=>c.handleFailedRequest(aV.InlineCompletionRequest.type,p,g,null));return l.provideInlineCompletionItems?l.provideInlineCompletionItems(i,o,s,a,u):u(i,o,s,a)}};return[Fnn.languages.registerInlineCompletionItemProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}}p9.InlineCompletionItemFeature=Bnn;var bse,Sse,_se;Object.defineProperty(tc,"__esModule",{value:!0});tc.ProposedFeatures=XBe=tc.BaseLanguageClient=tc.MessageTransports=tc.SuspendMode=_se=tc.State=Sse=tc.CloseAction=bse=tc.ErrorAction=tc.RevealOutputChannelOn=void 0;const Wi=wr,Jt=Pr,Hnn=kF,Unn=NF,gf=ji,ZA=nc,qwe=xi,znn=rR,df=yr,Vnn=ev,Kwe=BF,Gwe=gy,_w=Au,Wnn=HF,qnn=UF,Knn=zF,Gnn=VF,Znn=WF,Xnn=mse,Ynn=qF,Jnn=KF,Qnn=GF,ern=ZF,lV=my,trn=YF,nrn=JF,rrn=QF,irn=e9,orn=t9,srn=n9,arn=r9,crn=Lx,lrn=i9,urn=o9,drn=s9,hrn=a9,frn=c9,prn=l9,ww=Ou,grn=u9,mrn=d9,vrn=h9,yrn=f9,brn=p9;var h1;(function(n){n[n.Debug=0]="Debug",n[n.Info=1]="Info",n[n.Warn=2]="Warn",n[n.Error=3]="Error",n[n.Never=4]="Never"})(h1||(tc.RevealOutputChannelOn=h1={}));var bT;(function(n){n[n.Continue=1]="Continue",n[n.Shutdown=2]="Shutdown"})(bT||(bse=tc.ErrorAction=bT={}));var vy;(function(n){n[n.DoNotRestart=1]="DoNotRestart",n[n.Restart=2]="Restart"})(vy||(Sse=tc.CloseAction=vy={}));var Sk;(function(n){n[n.Stopped=1]="Stopped",n[n.Starting=3]="Starting",n[n.Running=2]="Running"})(Sk||(_se=tc.State=Sk={}));var Zwe;(function(n){n.off="off",n.on="on"})(Zwe||(tc.SuspendMode=Zwe={}));var TJ;(function(n){function e(t){return t==null?!1:typeof t=="boolean"||typeof t=="object"&&t!==null&&gf.stringArray(t.enabledCommands)?t:!1}n.sanitizeIsTrusted=e})(TJ||(TJ={}));class Srn{constructor(e,t){this.client=e,this.maxRestartCount=t,this.restarts=[]}error(e,t,r){return r&&r<=3?{action:bT.Continue}:{action:bT.Shutdown}}closed(){return this.restarts.push(Date.now()),this.restarts.length<=this.maxRestartCount?{action:vy.Restart}:this.restarts[this.restarts.length-1]-this.restarts[0]<=3*60*1e3?{action:vy.DoNotRestart,message:`The ${this.client.name} server crashed ${this.maxRestartCount+1} times in the last 3 minutes. The server will not be restarted. See the output for more information.`}:(this.restarts.shift(),{action:vy.Restart})}}var ti;(function(n){n.Initial="initial",n.Starting="starting",n.StartFailed="startFailed",n.Running="running",n.Stopping="stopping",n.Stopped="stopped"})(ti||(ti={}));var Xwe;(function(n){function e(t){return t&&Jt.MessageReader.is(t.reader)&&Jt.MessageWriter.is(t.writer)}n.is=e})(Xwe||(tc.MessageTransports=Xwe={}));class bS{constructor(e,t,r){var o;this._traceFormat=Jt.TraceFormat.Text,this._diagnosticQueue=new Map,this._diagnosticQueueState={state:"idle"},this._features=[],this._dynamicFeatures=new Map,this.workspaceEditLock=new ZA.Semaphore(1),this._id=e,this._name=t,r=r||{};const i={isTrusted:!1,supportHtml:!1};r.markdown!==void 0&&(i.isTrusted=TJ.sanitizeIsTrusted(r.markdown.isTrusted),i.supportHtml=r.markdown.supportHtml===!0),this._clientOptions={documentSelector:r.documentSelector??[],synchronize:r.synchronize??{},diagnosticCollectionName:r.diagnosticCollectionName,outputChannelName:r.outputChannelName??this._name,revealOutputChannelOn:r.revealOutputChannelOn??h1.Error,stdioEncoding:r.stdioEncoding??"utf8",initializationOptions:r.initializationOptions,initializationFailedHandler:r.initializationFailedHandler,progressOnInitialization:!!r.progressOnInitialization,errorHandler:r.errorHandler??this.createDefaultErrorHandler((o=r.connectionOptions)==null?void 0:o.maxRestartCount),middleware:r.middleware??{},uriConverters:r.uriConverters,workspaceFolder:r.workspaceFolder,connectionOptions:r.connectionOptions,markdown:i,diagnosticPullOptions:r.diagnosticPullOptions??{onChange:!0,onSave:!1},notebookDocumentOptions:r.notebookDocumentOptions??{}},this._clientOptions.synchronize=this._clientOptions.synchronize||{},this._state=ti.Initial,this._ignoredRegistrations=new Set,this._listeners=[],this._notificationHandlers=new Map,this._pendingNotificationHandlers=new Map,this._notificationDisposables=new Map,this._requestHandlers=new Map,this._pendingRequestHandlers=new Map,this._requestDisposables=new Map,this._progressHandlers=new Map,this._pendingProgressHandlers=new Map,this._progressDisposables=new Map,this._connection=void 0,this._initializeResult=void 0,r.outputChannel?(this._outputChannel=r.outputChannel,this._disposeOutputChannel=!1):(this._outputChannel=void 0,this._disposeOutputChannel=!0),this._traceOutputChannel=r.traceOutputChannel,this._diagnostics=void 0,this._pendingOpenNotifications=new Set,this._pendingChangeSemaphore=new ZA.Semaphore(1),this._pendingChangeDelayer=new ZA.Delayer(250),this._fileEvents=[],this._fileEventDelayer=new ZA.Delayer(250),this._onStop=void 0,this._telemetryEmitter=new Jt.Emitter,this._stateChangeEmitter=new Jt.Emitter,this._trace=Jt.Trace.Off,this._tracer={log:(s,a)=>{gf.string(s)?this.logTrace(s,a):this.logObjectTrace(s)}},this._c2p=Hnn.createConverter(r.uriConverters?r.uriConverters.code2Protocol:void 0),this._p2c=Unn.createConverter(r.uriConverters?r.uriConverters.protocol2Code:void 0,this._clientOptions.markdown.isTrusted,this._clientOptions.markdown.supportHtml),this._syncedDocuments=new Map,this.registerBuiltinFeatures()}get name(){return this._name}get middleware(){return this._clientOptions.middleware??Object.create(null)}get clientOptions(){return this._clientOptions}get protocol2CodeConverter(){return this._p2c}get code2ProtocolConverter(){return this._c2p}get onTelemetry(){return this._telemetryEmitter.event}get onDidChangeState(){return this._stateChangeEmitter.event}get outputChannel(){return this._outputChannel||(this._outputChannel=Wi.window.createOutputChannel(this._clientOptions.outputChannelName?this._clientOptions.outputChannelName:this._name)),this._outputChannel}get traceOutputChannel(){return this._traceOutputChannel?this._traceOutputChannel:this.outputChannel}get diagnostics(){return this._diagnostics}get state(){return this.getPublicState()}get $state(){return this._state}set $state(e){let t=this.getPublicState();this._state=e;let r=this.getPublicState();r!==t&&this._stateChangeEmitter.fire({oldState:t,newState:r})}getPublicState(){switch(this.$state){case ti.Starting:return Sk.Starting;case ti.Running:return Sk.Running;default:return Sk.Stopped}}get initializeResult(){return this._initializeResult}async sendRequest(e,...t){var o;if(this.$state===ti.StartFailed||this.$state===ti.Stopping||this.$state===ti.Stopped)return Promise.reject(new Jt.ResponseError(Jt.ErrorCodes.ConnectionInactive,"Client is not running"));const r=await this.$start();this._didChangeTextDocumentFeature.syncKind===Jt.TextDocumentSyncKind.Full&&await this.sendPendingFullTextDocumentChanges(r);const i=(o=this._clientOptions.middleware)==null?void 0:o.sendRequest;if(i!==void 0){let s,a;return t.length===1?Jt.CancellationToken.is(t[0])?a=t[0]:s=t[0]:t.length===2&&(s=t[0],a=t[1]),i(e,s,a,(c,l,u)=>{const d=[];return l!==void 0&&d.push(l),u!==void 0&&d.push(u),r.sendRequest(c,...d)})}else return r.sendRequest(e,...t)}onRequest(e,t){const r=typeof e=="string"?e:e.method;this._requestHandlers.set(r,t);const i=this.activeConnection();let o;return i!==void 0?(this._requestDisposables.set(r,i.onRequest(e,t)),o={dispose:()=>{const s=this._requestDisposables.get(r);s!==void 0&&(s.dispose(),this._requestDisposables.delete(r))}}):(this._pendingRequestHandlers.set(r,t),o={dispose:()=>{this._pendingRequestHandlers.delete(r);const s=this._requestDisposables.get(r);s!==void 0&&(s.dispose(),this._requestDisposables.delete(r))}}),{dispose:()=>{this._requestHandlers.delete(r),o.dispose()}}}async sendNotification(e,t){var a;if(this.$state===ti.StartFailed||this.$state===ti.Stopping||this.$state===ti.Stopped)return Promise.reject(new Jt.ResponseError(Jt.ErrorCodes.ConnectionInactive,"Client is not running"));const r=this._didChangeTextDocumentFeature.syncKind===Jt.TextDocumentSyncKind.Full;let i;r&&typeof e!="string"&&e.method===Jt.DidOpenTextDocumentNotification.method&&(i=t==null?void 0:t.textDocument.uri,this._pendingOpenNotifications.add(i));const o=await this.$start();r&&await this.sendPendingFullTextDocumentChanges(o),i!==void 0&&this._pendingOpenNotifications.delete(i);const s=(a=this._clientOptions.middleware)==null?void 0:a.sendNotification;return s?s(e,o.sendNotification.bind(o),t):o.sendNotification(e,t)}onNotification(e,t){const r=typeof e=="string"?e:e.method;this._notificationHandlers.set(r,t);const i=this.activeConnection();let o;return i!==void 0?(this._notificationDisposables.set(r,i.onNotification(e,t)),o={dispose:()=>{const s=this._notificationDisposables.get(r);s!==void 0&&(s.dispose(),this._notificationDisposables.delete(r))}}):(this._pendingNotificationHandlers.set(r,t),o={dispose:()=>{this._pendingNotificationHandlers.delete(r);const s=this._notificationDisposables.get(r);s!==void 0&&(s.dispose(),this._notificationDisposables.delete(r))}}),{dispose:()=>{this._notificationHandlers.delete(r),o.dispose()}}}async sendProgress(e,t,r){if(this.$state===ti.StartFailed||this.$state===ti.Stopping||this.$state===ti.Stopped)return Promise.reject(new Jt.ResponseError(Jt.ErrorCodes.ConnectionInactive,"Client is not running"));try{return(await this.$start()).sendProgress(e,t,r)}catch(i){throw this.error(`Sending progress for token ${t} failed.`,i),i}}onProgress(e,t,r){var c;this._progressHandlers.set(t,{type:e,handler:r});const i=this.activeConnection();let o;const s=(c=this._clientOptions.middleware)==null?void 0:c.handleWorkDoneProgress,a=Jt.WorkDoneProgress.is(e)&&s!==void 0?l=>{s(t,l,()=>r(l))}:r;return i!==void 0?(this._progressDisposables.set(t,i.onProgress(e,t,a)),o={dispose:()=>{const l=this._progressDisposables.get(t);l!==void 0&&(l.dispose(),this._progressDisposables.delete(t))}}):(this._pendingProgressHandlers.set(t,{type:e,handler:r}),o={dispose:()=>{this._pendingProgressHandlers.delete(t);const l=this._progressDisposables.get(t);l!==void 0&&(l.dispose(),this._progressDisposables.delete(t))}}),{dispose:()=>{this._progressHandlers.delete(t),o.dispose()}}}createDefaultErrorHandler(e){if(e!==void 0&&e<0)throw new Error(`Invalid maxRestartCount: ${e}`);return new Srn(this,e??4)}async setTrace(e){this._trace=e;const t=this.activeConnection();t!==void 0&&await t.trace(this._trace,this._tracer,{sendNotification:!1,traceFormat:this._traceFormat})}data2String(e){if(e instanceof Jt.ResponseError){const t=e;return`  Message: ${t.message}
  Code: ${t.code} ${t.data?`
`+t.data.toString():""}`}return e instanceof Error?gf.string(e.stack)?e.stack:e.message:gf.string(e)?e:e.toString()}debug(e,t,r=!0){this.logOutputMessage(Jt.MessageType.Debug,h1.Debug,"Debug",e,t,r)}info(e,t,r=!0){this.logOutputMessage(Jt.MessageType.Info,h1.Info,"Info",e,t,r)}warn(e,t,r=!0){this.logOutputMessage(Jt.MessageType.Warning,h1.Warn,"Warn",e,t,r)}error(e,t,r=!0){this.logOutputMessage(Jt.MessageType.Error,h1.Error,"Error",e,t,r)}logOutputMessage(e,t,r,i,o,s){this.outputChannel.appendLine(`[${r.padEnd(5)} - ${new Date().toLocaleTimeString()}] ${i}`),o!=null&&this.outputChannel.appendLine(this.data2String(o)),(s==="force"||s&&this._clientOptions.revealOutputChannelOn<=t)&&this.showNotificationMessage(e,i)}showNotificationMessage(e,t){t=t??"A request has failed. See the output for more information.",(e===Jt.MessageType.Error?Wi.window.showErrorMessage:e===Jt.MessageType.Warning?Wi.window.showWarningMessage:Wi.window.showInformationMessage)(t,"Go to output").then(i=>{i!==void 0&&this.outputChannel.show(!0)})}logTrace(e,t){this.traceOutputChannel.appendLine(`[Trace - ${new Date().toLocaleTimeString()}] ${e}`),t&&this.traceOutputChannel.appendLine(this.data2String(t))}logObjectTrace(e){e.isLSPMessage&&e.type?this.traceOutputChannel.append(`[LSP   - ${new Date().toLocaleTimeString()}] `):this.traceOutputChannel.append(`[Trace - ${new Date().toLocaleTimeString()}] `),e&&this.traceOutputChannel.appendLine(`${JSON.stringify(e)}`)}needsStart(){return this.$state===ti.Initial||this.$state===ti.Stopping||this.$state===ti.Stopped}needsStop(){return this.$state===ti.Starting||this.$state===ti.Running}activeConnection(){return this.$state===ti.Running&&this._connection!==void 0?this._connection:void 0}isRunning(){return this.$state===ti.Running}async start(){if(this._disposed==="disposing"||this._disposed==="disposed")throw new Error("Client got disposed and can't be restarted.");if(this.$state===ti.Stopping)throw new Error("Client is currently stopping. Can only restart a full stopped client");if(this._onStart!==void 0)return this._onStart;const[e,t,r]=this.createOnStartPromise();this._onStart=e,this._diagnostics===void 0&&(this._diagnostics=this._clientOptions.diagnosticCollectionName?Wi.languages.createDiagnosticCollection(this._clientOptions.diagnosticCollectionName):Wi.languages.createDiagnosticCollection());for(const[i,o]of this._notificationHandlers)this._pendingNotificationHandlers.has(i)||this._pendingNotificationHandlers.set(i,o);for(const[i,o]of this._requestHandlers)this._pendingRequestHandlers.has(i)||this._pendingRequestHandlers.set(i,o);for(const[i,o]of this._progressHandlers)this._pendingProgressHandlers.has(i)||this._pendingProgressHandlers.set(i,o);this.$state=ti.Starting;try{const i=await this.createConnection();i.onNotification(Jt.LogMessageNotification.type,o=>{switch(o.type){case Jt.MessageType.Error:this.error(o.message,void 0,!1);break;case Jt.MessageType.Warning:this.warn(o.message,void 0,!1);break;case Jt.MessageType.Info:this.info(o.message,void 0,!1);break;case Jt.MessageType.Debug:this.debug(o.message,void 0,!1);break;default:this.outputChannel.appendLine(o.message)}}),i.onNotification(Jt.ShowMessageNotification.type,o=>{switch(o.type){case Jt.MessageType.Error:Wi.window.showErrorMessage(o.message);break;case Jt.MessageType.Warning:Wi.window.showWarningMessage(o.message);break;case Jt.MessageType.Info:Wi.window.showInformationMessage(o.message);break;default:Wi.window.showInformationMessage(o.message)}}),i.onRequest(Jt.ShowMessageRequest.type,o=>{let s;switch(o.type){case Jt.MessageType.Error:s=Wi.window.showErrorMessage;break;case Jt.MessageType.Warning:s=Wi.window.showWarningMessage;break;case Jt.MessageType.Info:s=Wi.window.showInformationMessage;break;default:s=Wi.window.showInformationMessage}let a=o.actions||[];return s(o.message,...a)}),i.onNotification(Jt.TelemetryEventNotification.type,o=>{this._telemetryEmitter.fire(o)}),i.onRequest(Jt.ShowDocumentRequest.type,async o=>{var c;const s=async l=>{const u=this.protocol2CodeConverter.asUri(l.uri);try{if(l.external===!0)return{success:await Wi.env.openExternal(u)};{const d={};return l.selection!==void 0&&(d.selection=this.protocol2CodeConverter.asRange(l.selection)),l.takeFocus===void 0||l.takeFocus===!1?d.preserveFocus=!0:l.takeFocus===!0&&(d.preserveFocus=!1),await Wi.window.showTextDocument(u,d),{success:!0}}}catch{return{success:!1}}},a=(c=this._clientOptions.middleware.window)==null?void 0:c.showDocument;return a!==void 0?a(o,s):s(o)}),i.listen(),await this.initialize(i),t()}catch(i){this.$state=ti.StartFailed,this.error(`${this._name} client: couldn't create connection to server.`,i,"force"),r(i)}return this._onStart}createOnStartPromise(){let e,t;return[new Promise((i,o)=>{e=i,t=o}),e,t]}async initialize(e){this.refreshTrace(e,!1);const t=this._clientOptions.initializationOptions,[r,i]=this._clientOptions.workspaceFolder!==void 0?[this._clientOptions.workspaceFolder.uri.fsPath,[{uri:this._c2p.asUri(this._clientOptions.workspaceFolder.uri),name:this._clientOptions.workspaceFolder.name}]]:[this._clientGetRootPath(),null],o={processId:null,clientInfo:{name:Wi.env.appName,version:Wi.version},locale:this.getLocale(),rootPath:r||null,rootUri:r?this._c2p.asUri(Wi.Uri.file(r)):null,capabilities:this.computeClientCapabilities(),initializationOptions:gf.func(t)?t():t,trace:Jt.Trace.toString(this._trace),workspaceFolders:i};if(this.fillInitializeParams(o),this._clientOptions.progressOnInitialization){const s=qwe.generateUuid(),a=new znn.ProgressPart(e,s);o.workDoneToken=s;try{const c=await this.doInitialize(e,o);return a.done(),c}catch(c){throw a.cancel(),c}}else return this.doInitialize(e,o)}async doInitialize(e,t){try{const r=await e.initialize(t);if(r.capabilities.positionEncoding!==void 0&&r.capabilities.positionEncoding!==Jt.PositionEncodingKind.UTF16)throw new Error(`Unsupported position encoding (${r.capabilities.positionEncoding}) received from server ${this.name}`);this._initializeResult=r,this.$state=ti.Running;let i;gf.number(r.capabilities.textDocumentSync)?r.capabilities.textDocumentSync===Jt.TextDocumentSyncKind.None?i={openClose:!1,change:Jt.TextDocumentSyncKind.None,save:void 0}:i={openClose:!0,change:r.capabilities.textDocumentSync,save:{includeText:!1}}:r.capabilities.textDocumentSync!==void 0&&r.capabilities.textDocumentSync!==null&&(i=r.capabilities.textDocumentSync),this._capabilities=Object.assign({},r.capabilities,{resolvedTextDocumentSync:i}),e.onNotification(Jt.PublishDiagnosticsNotification.type,o=>this.handleDiagnostics(o)),e.onRequest(Jt.RegistrationRequest.type,o=>this.handleRegistrationRequest(o)),e.onRequest("client/registerFeature",o=>this.handleRegistrationRequest(o)),e.onRequest(Jt.UnregistrationRequest.type,o=>this.handleUnregistrationRequest(o)),e.onRequest("client/unregisterFeature",o=>this.handleUnregistrationRequest(o)),e.onRequest(Jt.ApplyWorkspaceEditRequest.type,o=>this.handleApplyWorkspaceEdit(o));for(const[o,s]of this._pendingNotificationHandlers)this._notificationDisposables.set(o,e.onNotification(o,s));this._pendingNotificationHandlers.clear();for(const[o,s]of this._pendingRequestHandlers)this._requestDisposables.set(o,e.onRequest(o,s));this._pendingRequestHandlers.clear();for(const[o,s]of this._pendingProgressHandlers)this._progressDisposables.set(o,e.onProgress(s.type,o,s.handler));return this._pendingProgressHandlers.clear(),await e.sendNotification(Jt.InitializedNotification.type,{}),this.hookFileEvents(e),this.hookConfigurationChanged(e),this.initializeFeatures(e),r}catch(r){throw this._clientOptions.initializationFailedHandler?this._clientOptions.initializationFailedHandler(r)?this.initialize(e):this.stop():r instanceof Jt.ResponseError&&r.data&&r.data.retry?Wi.window.showErrorMessage(r.message,{title:"Retry",id:"retry"}).then(i=>{i&&i.id==="retry"?this.initialize(e):this.stop()}):(r&&r.message&&Wi.window.showErrorMessage(r.message),this.error("Server initialization failed.",r),this.stop()),r}}_clientGetRootPath(){let e=Wi.workspace.workspaceFolders;if(!e||e.length===0)return;let t=e[0];if(t.uri.scheme==="file")return t.uri.fsPath}stop(e=2e3){return this.shutdown("stop",e)}dispose(e=2e3){try{return this._disposed="disposing",this.stop(e)}finally{this._disposed="disposed"}}async shutdown(e,t){if(this.$state===ti.Stopped||this.$state===ti.Initial)return;if(this.$state===ti.Stopping){if(this._onStop!==void 0)return this._onStop;throw new Error("Client is stopping but no stop promise available.")}const r=this.activeConnection();if(r===void 0||this.$state!==ti.Running)throw new Error(`Client is not running and can't be stopped. It's current state is: ${this.$state}`);this._initializeResult=void 0,this.$state=ti.Stopping,this.cleanUp(e);const i=new Promise(s=>{(0,Jt.RAL)().timer.setTimeout(s,t)}),o=(async s=>(await s.shutdown(),await s.exit(),s))(r);return this._onStop=Promise.race([i,o]).then(s=>{if(s!==void 0)s.end(),s.dispose();else throw this.error("Stopping server timed out",void 0,!1),new Error("Stopping the server timed out")},s=>{throw this.error("Stopping server failed",s,!1),s}).finally(()=>{this.$state=ti.Stopped,e==="stop"&&this.cleanUpChannel(),this._onStart=void 0,this._onStop=void 0,this._connection=void 0,this._ignoredRegistrations.clear()})}cleanUp(e){this._fileEvents=[],this._fileEventDelayer.cancel();const t=this._listeners.splice(0,this._listeners.length);for(const r of t)r.dispose();this._syncedDocuments&&this._syncedDocuments.clear();for(const r of Array.from(this._features.entries()).map(i=>i[1]).reverse())r.clear();e==="stop"&&this._diagnostics!==void 0&&(this._diagnostics.dispose(),this._diagnostics=void 0),this._idleInterval!==void 0&&(this._idleInterval.dispose(),this._idleInterval=void 0)}cleanUpChannel(){this._outputChannel!==void 0&&this._disposeOutputChannel&&(this._outputChannel.dispose(),this._outputChannel=void 0)}notifyFileEvent(e){var o;const t=this;async function r(s){return t._fileEvents.push(s),t._fileEventDelayer.trigger(async()=>{await t.sendNotification(Jt.DidChangeWatchedFilesNotification.type,{changes:t._fileEvents}),t._fileEvents=[]})}const i=(o=this.clientOptions.middleware)==null?void 0:o.workspace;(i!=null&&i.didChangeWatchedFile?i.didChangeWatchedFile(e,r):r(e)).catch(s=>{t.error("Notify file events failed.",s)})}async sendPendingFullTextDocumentChanges(e){return this._pendingChangeSemaphore.lock(async()=>{try{const t=this._didChangeTextDocumentFeature.getPendingDocumentChanges(this._pendingOpenNotifications);if(t.length===0)return;for(const r of t){const i=this.code2ProtocolConverter.asChangeTextDocumentParams(r);await e.sendNotification(Jt.DidChangeTextDocumentNotification.type,i),this._didChangeTextDocumentFeature.notificationSent(r,Jt.DidChangeTextDocumentNotification.type,i)}}catch(t){throw this.error("Sending pending changes failed",t,!1),t}})}triggerPendingChangeDelivery(){this._pendingChangeDelayer.trigger(async()=>{const e=this.activeConnection();if(e===void 0){this.triggerPendingChangeDelivery();return}await this.sendPendingFullTextDocumentChanges(e)}).catch(e=>this.error("Delivering pending changes failed",e,!1))}handleDiagnostics(e){if(!this._diagnostics)return;const t=e.uri;this._diagnosticQueueState.state==="busy"&&this._diagnosticQueueState.document===t&&this._diagnosticQueueState.tokenSource.cancel(),this._diagnosticQueue.set(e.uri,e.diagnostics),this.triggerDiagnosticQueue()}triggerDiagnosticQueue(){(0,Jt.RAL)().timer.setImmediate(()=>{this.workDiagnosticQueue()})}workDiagnosticQueue(){if(this._diagnosticQueueState.state==="busy")return;const e=this._diagnosticQueue.entries().next();if(e.done===!0)return;const[t,r]=e.value;this._diagnosticQueue.delete(t);const i=new Wi.CancellationTokenSource;this._diagnosticQueueState={state:"busy",document:t,tokenSource:i},this._p2c.asDiagnostics(r,i.token).then(o=>{if(!i.token.isCancellationRequested){const s=this._p2c.asUri(t),a=this.clientOptions.middleware;a.handleDiagnostics?a.handleDiagnostics(s,o,(c,l)=>this.setDiagnostics(c,l)):this.setDiagnostics(s,o)}}).finally(()=>{this._diagnosticQueueState={state:"idle"},this.triggerDiagnosticQueue()})}setDiagnostics(e,t){this._diagnostics&&this._diagnostics.set(e,t)}getLocale(){return Wi.env.language}async $start(){if(this.$state===ti.StartFailed)throw new Error("Previous start failed. Can't restart server.");await this.start();const e=this.activeConnection();if(e===void 0)throw new Error("Starting server failed");return e}async createConnection(){let e=(i,o,s)=>{this.handleConnectionError(i,o,s).catch(a=>this.error("Handling connection error failed",a))},t=()=>{this.handleConnectionClosed().catch(i=>this.error("Handling connection close failed",i))};const r=await this.createMessageTransports(this._clientOptions.stdioEncoding||"utf8");return this._connection=wrn(r.reader,r.writer,e,t,this._clientOptions.connectionOptions),this._connection}async handleConnectionClosed(){if(this.$state===ti.Stopped)return;try{this._connection!==void 0&&this._connection.dispose()}catch{}let e={action:vy.DoNotRestart};if(this.$state!==ti.Stopping)try{e=await this._clientOptions.errorHandler.closed()}catch{}this._connection=void 0,e.action===vy.DoNotRestart?(this.error(e.message??"Connection to server got closed. Server will not be restarted.",void 0,e.handled===!0?!1:"force"),this.cleanUp("stop"),this.$state===ti.Starting?this.$state=ti.StartFailed:this.$state=ti.Stopped,this._onStop=Promise.resolve(),this._onStart=void 0):e.action===vy.Restart&&(this.info(e.message??"Connection to server got closed. Server will restart.",!e.handled),this.cleanUp("restart"),this.$state=ti.Initial,this._onStop=Promise.resolve(),this._onStart=void 0,this.start().catch(t=>this.error("Restarting server failed",t,"force")))}async handleConnectionError(e,t,r){const i=await this._clientOptions.errorHandler.error(e,t,r);i.action===bT.Shutdown?(this.error(i.message??`Client ${this._name}: connection to server is erroring.
${e.message}
Shutting down server.`,void 0,i.handled===!0?!1:"force"),this.stop().catch(o=>{this.error("Stopping server failed",o,!1)})):this.error(i.message??`Client ${this._name}: connection to server is erroring.
${e.message}`,void 0,i.handled===!0?!1:"force")}hookConfigurationChanged(e){this._listeners.push(Wi.workspace.onDidChangeConfiguration(()=>{this.refreshTrace(e,!0)}))}refreshTrace(e,t=!1){const r=Wi.workspace.getConfiguration(this._id);let i=Jt.Trace.Off,o=Jt.TraceFormat.Text;if(r){const s=r.get("trace.server","off");typeof s=="string"?i=Jt.Trace.fromString(s):(i=Jt.Trace.fromString(r.get("trace.server.verbosity","off")),o=Jt.TraceFormat.fromString(r.get("trace.server.format","text")))}this._trace=i,this._traceFormat=o,e.trace(this._trace,this._tracer,{sendNotification:t,traceFormat:this._traceFormat}).catch(s=>{this.error("Updating trace failed with error",s,!1)})}hookFileEvents(e){let t=this._clientOptions.synchronize.fileEvents;if(!t)return;let r;gf.array(t)?r=t:r=[t],r&&this._dynamicFeatures.get(Jt.DidChangeWatchedFilesNotification.type.method).registerRaw(qwe.generateUuid(),r)}registerFeatures(e){for(let t of e)this.registerFeature(t)}registerFeature(e){if(this._features.push(e),df.DynamicFeature.is(e)){const t=e.registrationType;this._dynamicFeatures.set(t.method,e)}}getFeature(e){return this._dynamicFeatures.get(e)}hasDedicatedTextSynchronizationFeature(e){const t=this.getFeature(Jt.NotebookDocumentSyncRegistrationType.method);return t===void 0||!(t instanceof Kwe.NotebookDocumentSyncFeature)?!1:t.handles(e)}registerBuiltinFeatures(){const e=new Map;this.registerFeature(new Gwe.ConfigurationFeature(this)),this.registerFeature(new _w.DidOpenTextDocumentFeature(this,this._syncedDocuments)),this._didChangeTextDocumentFeature=new _w.DidChangeTextDocumentFeature(this,e),this._didChangeTextDocumentFeature.onPendingChangeAdded(()=>{this.triggerPendingChangeDelivery()}),this.registerFeature(this._didChangeTextDocumentFeature),this.registerFeature(new _w.WillSaveFeature(this)),this.registerFeature(new _w.WillSaveWaitUntilFeature(this)),this.registerFeature(new _w.DidSaveTextDocumentFeature(this)),this.registerFeature(new _w.DidCloseTextDocumentFeature(this,this._syncedDocuments,e)),this.registerFeature(new irn.FileSystemWatcherFeature(this,t=>this.notifyFileEvent(t))),this.registerFeature(new Wnn.CompletionItemFeature(this)),this.registerFeature(new qnn.HoverFeature(this)),this.registerFeature(new Gnn.SignatureHelpFeature(this)),this.registerFeature(new Knn.DefinitionFeature(this)),this.registerFeature(new Jnn.ReferencesFeature(this)),this.registerFeature(new Znn.DocumentHighlightFeature(this)),this.registerFeature(new Xnn.DocumentSymbolFeature(this)),this.registerFeature(new Ynn.WorkspaceSymbolFeature(this)),this.registerFeature(new Qnn.CodeActionFeature(this)),this.registerFeature(new ern.CodeLensFeature(this)),this.registerFeature(new lV.DocumentFormattingFeature(this)),this.registerFeature(new lV.DocumentRangeFormattingFeature(this)),this.registerFeature(new lV.DocumentOnTypeFormattingFeature(this)),this.registerFeature(new trn.RenameFeature(this)),this.registerFeature(new nrn.DocumentLinkFeature(this)),this.registerFeature(new rrn.ExecuteCommandFeature(this)),this.registerFeature(new Gwe.SyncConfigurationFeature(this)),this.registerFeature(new arn.TypeDefinitionFeature(this)),this.registerFeature(new srn.ImplementationFeature(this)),this.registerFeature(new orn.ColorProviderFeature(this)),this.clientOptions.workspaceFolder===void 0&&this.registerFeature(new crn.WorkspaceFoldersFeature(this)),this.registerFeature(new lrn.FoldingRangeFeature(this)),this.registerFeature(new urn.DeclarationFeature(this)),this.registerFeature(new drn.SelectionRangeFeature(this)),this.registerFeature(new hrn.ProgressFeature(this)),this.registerFeature(new frn.CallHierarchyFeature(this)),this.registerFeature(new prn.SemanticTokensFeature(this)),this.registerFeature(new grn.LinkedEditingFeature(this)),this.registerFeature(new ww.DidCreateFilesFeature(this)),this.registerFeature(new ww.DidRenameFilesFeature(this)),this.registerFeature(new ww.DidDeleteFilesFeature(this)),this.registerFeature(new ww.WillCreateFilesFeature(this)),this.registerFeature(new ww.WillRenameFilesFeature(this)),this.registerFeature(new ww.WillDeleteFilesFeature(this)),this.registerFeature(new mrn.TypeHierarchyFeature(this)),this.registerFeature(new vrn.InlineValueFeature(this)),this.registerFeature(new yrn.InlayHintsFeature(this)),this.registerFeature(new Vnn.DiagnosticFeature(this)),this.registerFeature(new Kwe.NotebookDocumentSyncFeature(this))}registerProposedFeatures(){this.registerFeatures(DJ.createAll(this))}fillInitializeParams(e){for(let t of this._features)gf.func(t.fillInitializeParams)&&t.fillInitializeParams(e)}computeClientCapabilities(){const e={};(0,df.ensure)(e,"workspace").applyEdit=!0;const t=(0,df.ensure)((0,df.ensure)(e,"workspace"),"workspaceEdit");t.documentChanges=!0,t.resourceOperations=[Jt.ResourceOperationKind.Create,Jt.ResourceOperationKind.Rename,Jt.ResourceOperationKind.Delete],t.failureHandling=Jt.FailureHandlingKind.TextOnlyTransactional,t.normalizesLineEndings=!0,t.changeAnnotationSupport={groupsOnLabel:!0};const r=(0,df.ensure)((0,df.ensure)(e,"textDocument"),"publishDiagnostics");r.relatedInformation=!0,r.versionSupport=!1,r.tagSupport={valueSet:[Jt.DiagnosticTag.Unnecessary,Jt.DiagnosticTag.Deprecated]},r.codeDescriptionSupport=!0,r.dataSupport=!0;const i=(0,df.ensure)(e,"window"),o=(0,df.ensure)(i,"showMessage");o.messageActionItem={additionalPropertiesSupport:!0};const s=(0,df.ensure)(i,"showDocument");s.support=!0;const a=(0,df.ensure)(e,"general");a.staleRequestSupport={cancel:!0,retryOnContentModified:Array.from(bS.RequestsToCancelOnContentModified)},a.regularExpressions={engine:"ECMAScript",version:"ES2020"},a.markdown={parser:"marked",version:"1.1.0"},a.positionEncodings=["utf-16"],this._clientOptions.markdown.supportHtml&&(a.markdown.allowedTags=["ul","li","p","code","blockquote","ol","h1","h2","h3","h4","h5","h6","hr","em","pre","table","thead","tbody","tr","th","td","div","del","a","strong","br","img","span"]);for(let c of this._features)c.fillClientCapabilities(e);return e}initializeFeatures(e){const t=this._clientOptions.documentSelector;for(const r of this._features)gf.func(r.preInitialize)&&r.preInitialize(this._capabilities,t);for(const r of this._features)r.initialize(this._capabilities,t)}async handleRegistrationRequest(e){var r;const t=(r=this.clientOptions.middleware)==null?void 0:r.handleRegisterCapability;return t?t(e,i=>this.doRegisterCapability(i)):this.doRegisterCapability(e)}async doRegisterCapability(e){if(!this.isRunning()){for(const t of e.registrations)this._ignoredRegistrations.add(t.id);return}for(const t of e.registrations){const r=this._dynamicFeatures.get(t.method);if(r===void 0)return Promise.reject(new Error(`No feature implementation for ${t.method} found. Registration failed.`));const i=t.registerOptions??{};i.documentSelector=i.documentSelector??this._clientOptions.documentSelector;const o={id:t.id,registerOptions:i};try{r.register(o)}catch(s){return Promise.reject(s)}}}async handleUnregistrationRequest(e){var r;const t=(r=this.clientOptions.middleware)==null?void 0:r.handleUnregisterCapability;return t?t(e,i=>this.doUnregisterCapability(i)):this.doUnregisterCapability(e)}async doUnregisterCapability(e){for(const t of e.unregisterations){if(this._ignoredRegistrations.has(t.id))continue;const r=this._dynamicFeatures.get(t.method);if(!r)return Promise.reject(new Error(`No feature implementation for ${t.method} found. Unregistration failed.`));r.unregister(t.id)}}async handleApplyWorkspaceEdit(e){const t=e.edit,r=await this.workspaceEditLock.lock(()=>this._p2c.asWorkspaceEdit(t)),i=new Map;Wi.workspace.textDocuments.forEach(s=>i.set(s.uri.toString(),s));let o=!1;if(t.documentChanges){for(const s of t.documentChanges)if(Jt.TextDocumentEdit.is(s)&&s.textDocument.version&&s.textDocument.version>=0){const a=this._p2c.asUri(s.textDocument.uri).toString(),c=i.get(a);if(c&&c.version!==s.textDocument.version){o=!0;break}}}return o?Promise.resolve({applied:!1}):gf.asPromise(Wi.workspace.applyEdit(r).then(s=>({applied:s})))}handleFailedRequest(e,t,r,i,o=!0){if(r instanceof Jt.ResponseError){if(r.code===Jt.ErrorCodes.PendingResponseRejected||r.code===Jt.ErrorCodes.ConnectionInactive)return i;if(r.code===Jt.LSPErrorCodes.RequestCancelled||r.code===Jt.LSPErrorCodes.ServerCancelled){if(t!==void 0&&t.isCancellationRequested)return i;throw r.data!==void 0?new df.LSPCancellationError(r.data):new Wi.CancellationError}else if(r.code===Jt.LSPErrorCodes.ContentModified){if(bS.RequestsToCancelOnContentModified.has(e.method)||bS.CancellableResolveCalls.has(e.method))throw new Wi.CancellationError;return i}}throw this.error(`Request ${e.method} failed.`,r,o),r}}var XBe=tc.BaseLanguageClient=bS;bS.RequestsToCancelOnContentModified=new Set([Jt.SemanticTokensRequest.method,Jt.SemanticTokensRangeRequest.method,Jt.SemanticTokensDeltaRequest.method]);bS.CancellableResolveCalls=new Set([Jt.CompletionResolveRequest.method,Jt.CodeLensResolveRequest.method,Jt.CodeActionResolveRequest.method,Jt.InlayHintResolveRequest.method,Jt.DocumentLinkResolveRequest.method,Jt.WorkspaceSymbolResolveRequest.method]);class _rn{error(e){(0,Jt.RAL)().console.error(e)}warn(e){(0,Jt.RAL)().console.warn(e)}info(e){(0,Jt.RAL)().console.info(e)}log(e){(0,Jt.RAL)().console.log(e)}}function wrn(n,e,t,r,i){const o=new _rn,s=(0,Jt.createProtocolConnection)(n,e,o,i);return s.onError(c=>{t(c[0],c[1],c[2])}),s.onClose(r),{listen:()=>s.listen(),sendRequest:s.sendRequest,onRequest:s.onRequest,hasPendingResponse:s.hasPendingResponse,sendNotification:s.sendNotification,onNotification:s.onNotification,onProgress:s.onProgress,sendProgress:s.sendProgress,trace:(c,l,u)=>{const d={sendNotification:!1,traceFormat:Jt.TraceFormat.Text};return u===void 0?s.trace(c,l,d):(gf.boolean(u),s.trace(c,l,u))},initialize:c=>s.sendRequest(Jt.InitializeRequest.type,c),shutdown:()=>s.sendRequest(Jt.ShutdownRequest.type,void 0),exit:()=>s.sendNotification(Jt.ExitNotification.type),end:()=>s.end(),dispose:()=>s.dispose()}}var DJ;(function(n){function e(t){return[new brn.InlineCompletionItemFeature(t)]}n.createAll=e})(DJ||(tc.ProposedFeatures=DJ={}));class Crn extends XBe{constructor({id:t,name:r,clientOptions:i,connectionProvider:o}){super(t||r.toLowerCase(),r,i);$(this,"connectionProvider");this.connectionProvider=o}createMessageTransports(t){return this.connectionProvider.get(t)}}class xrn extends wBe{constructor(t){super();$(this,"socket");$(this,"state","initial");$(this,"callback");$(this,"events",[]);this.socket=t,this.socket.onMessage(r=>this.readMessage(r)),this.socket.onError(r=>this.fireError(r)),this.socket.onClose((r,i)=>{if(r!==1e3){const o={name:""+r,message:`Error during socket reconnect: code = ${r}, reason = ${i}`};this.fireError(o)}this.fireClose()})}listen(t){if(this.state==="initial")for(this.state="listening",this.callback=t;this.events.length!==0;){const r=this.events.pop();r.message?this.readMessage(r.message):r.error?this.fireError(r.error):this.fireClose()}return{dispose:()=>{this.callback===t&&(this.state="initial",this.callback=void 0)}}}dispose(){super.dispose(),this.state="initial",this.callback=void 0,this.events.splice(0,this.events.length)}readMessage(t){if(this.state==="initial")this.events.splice(0,0,{message:t});else if(this.state==="listening")try{const r=JSON.parse(t);this.callback(r)}catch(r){const i={name:"400",message:`Error during message parsing, reason = ${typeof r=="object"?r.message:"unknown"}`};this.fireError(i)}}fireError(t){this.state==="initial"?this.events.splice(0,0,{error:t}):this.state==="listening"&&super.fireError(t)}fireClose(){this.state==="initial"?this.events.splice(0,0,{}):this.state==="listening"&&super.fireClose(),this.state="closed"}}class Ern extends xBe{constructor(t){super();$(this,"errorCount",0);$(this,"socket");this.socket=t}end(){}async write(t){try{const r=JSON.stringify(t);this.socket.send(r)}catch(r){this.errorCount++,this.fireError(r,t,this.errorCount)}}}function Irn(n){return{send:e=>n.send(e),onMessage:e=>{n.onmessage=t=>e(t.data)},onError:e=>{n.onerror=t=>{Object.hasOwn(t,"message")&&e(t.message)}},onClose:e=>{n.onclose=t=>e(t.code,t.reason)},dispose:()=>n.close()}}var Nx=Pr;class Prn{constructor(){$(this,"languageClient");$(this,"languageClientConfig");$(this,"messageTransports");$(this,"connectionProvider");$(this,"languageId");$(this,"worker");$(this,"port");$(this,"name");$(this,"logger")}async init(e){var t;this.languageClientConfig=e.languageClientConfig,this.name=this.languageClientConfig.name??"unnamed",this.logger=e.logger,this.languageId=((t=this.languageClientConfig)==null?void 0:t.languageId)??"unknown"}haveLanguageClient(){return this.languageClient!==void 0}haveLanguageClientConfig(){return this.languageClientConfig!==void 0}getLanguageClient(){return this.languageClient}getWorker(){return this.worker}isStarted(){var e;return this.languageClient!==void 0&&((e=this.languageClient)==null?void 0:e.isRunning())}getMessageTransports(){return this.messageTransports}getConnectionProvider(){return this.connectionProvider}async start(){if(this.languageClientConfig)return this.startLanguageClientConnection();{const e={message:`languageClientWrapper (${this.name}): Unable to start monaco-languageclient. No configuration was provided.`,error:"No error was provided."};return Promise.reject(e)}}async restartLanguageClient(e,t){var r;if(e?await this.disposeLanguageClient(!1):await this.disposeLanguageClient(t),this.worker=e,this.languageClientConfig)return(r=this.logger)==null||r.info("Re-Starting monaco-languageclient"),this.startLanguageClientConnection();{const i={message:`languageClientWrapper (${this.name}): Unable to restart languageclient. No configuration was provided.`,error:"No error was provided."};return Promise.reject(i)}}startLanguageClientConnection(){var t,r,i;if(this.languageClient&&this.languageClient.isRunning())return(t=this.logger)==null||t.info("monaco-languageclient already running!"),Promise.resolve();const e=(r=this.languageClientConfig)==null?void 0:r.options;return this.connectionProvider=(i=this.languageClientConfig)==null?void 0:i.connectionProvider,new Promise((o,s)=>{if((e==null?void 0:e.$type)==="WebSocket"||(e==null?void 0:e.$type)==="WebSocketUrl"){const a=iJt(e),c=new WebSocket(a);c.onopen=async()=>{var u;const l=Irn(c);this.messageTransports=await((u=this.connectionProvider)==null?void 0:u.get(""))??{reader:new xrn(l),writer:new Ern(l)},this.handleLanguageClientStart(o,s)},c.onerror=l=>{const u={message:`languageClientWrapper (${this.name}): Websocket connection failed.`,error:l.error??"No error was provided."};s(u)}}else{if(!this.worker){if((e==null?void 0:e.$type)==="WorkerConfig"){const c=e;this.worker=new Worker(new URL(c.url,import.meta.url).href,{type:c.type,name:c.workerName}),this.worker.onerror=l=>{const u={message:`languageClientWrapper (${this.name}): Illegal worker configuration detected. Potentially the url is wrong.`,error:l.error??"No error was provided."};s(u)}}else{const c=e;this.worker=c.worker}e!=null&&e.messagePort&&(this.port=e==null?void 0:e.messagePort)}(async c=>{var l;this.messageTransports=await((l=this.connectionProvider)==null?void 0:l.get(""))??{reader:new Nx.BrowserMessageReader(c),writer:new Nx.BrowserMessageWriter(c)},this.handleLanguageClientStart(o,s)})(this.port?this.port:this.worker)}})}async handleLanguageClientStart(e,t){var o,s,a,c,l,u;this.connectionProvider||(this.connectionProvider={get:()=>Promise.resolve(this.messageTransports)});const r={name:((o=this.languageClientConfig)==null?void 0:o.name)??"Monaco Wrapper Language Client",clientOptions:((s=this.languageClientConfig)==null?void 0:s.clientOptions)??{documentSelector:[this.languageId],errorHandler:{error:()=>({action:bse.Continue}),closed:()=>({action:Sse.DoNotRestart})}},connectionProvider:this.connectionProvider};this.languageClient=new Crn(r);const i=(a=this.languageClientConfig)==null?void 0:a.options;(c=this.messageTransports)==null||c.reader.onClose(async()=>{var d,h;if(await((d=this.languageClient)==null?void 0:d.stop()),((i==null?void 0:i.$type)==="WebSocket"||(i==null?void 0:i.$type)==="WebSocketUrl")&&(i!=null&&i.stopOptions)){const f=i==null?void 0:i.stopOptions;f.onCall(this.getLanguageClient()),f.reportStatus&&((h=this.logger)==null||h.info(this.reportStatus().join(`
`)))}});try{if(await this.languageClient.start(),((i==null?void 0:i.$type)==="WebSocket"||(i==null?void 0:i.$type)==="WebSocketUrl")&&(i!=null&&i.startOptions)){const d=i==null?void 0:i.startOptions;d.onCall(this.getLanguageClient()),d.reportStatus&&((l=this.logger)==null||l.info(this.reportStatus().join(`
`)))}}catch(d){const h={message:`languageClientWrapper (${this.name}): Start was unsuccessful.`,error:d??"No error was provided."};t(h)}(u=this.logger)==null||u.info(`languageClientWrapper (${this.name}): Started successfully.`),e()}disposeWorker(e){var t;(e===void 0||e===!1)&&((t=this.worker)==null||t.terminate(),this.worker=void 0)}async disposeLanguageClient(e){var t;if(!this.languageClient)return this.disposeWorker(e),Promise.resolve();if(this.languageClient&&this.languageClient.isRunning())try{return await this.languageClient.dispose(),this.disposeWorker(e),this.languageClient=void 0,(t=this.logger)==null||t.info("monaco-languageclient and monaco-editor were successfully disposed."),Promise.resolve()}catch(r){const i={message:`languageClientWrapper (${this.name}): Disposing the monaco-languageclient resulted in error.`,error:r??"No error was provided."};return Promise.reject(i)}else return Promise.resolve()}reportStatus(){const e=[],t=this.getLanguageClient();return e.push("LanguageClientWrapper status:"),e.push(`LanguageClient: ${(t==null?void 0:t.name)??"Language Client"} is in a '${_se[(t==null?void 0:t.state)??1]}' state`),e}}class krn{constructor(){this._systemSchemes=new Set(Object.keys(hr)),this._providerInfo=new Map,this.extUri=new txe(e=>{const t=this._providerInfo.get(e.scheme);return!(t===void 0||t&1024)})}$acceptProviderInfos(e,t){t===null?this._providerInfo.delete(e.scheme):this._providerInfo.set(e.scheme,t)}isFreeScheme(e){return!this._providerInfo.has(e)&&!this._systemSchemes.has(e)}getCapabilities(e){return this._providerInfo.get(e)}}const IE=go("IExtHostFileSystemInfo");var xp;let RJ=xp=class{constructor(e,t){this._fileSystemProvider=new Map,this._writeQueue=new EXe,this._proxy=e.getProxy(dn.MainThreadFileSystem);const r=this;this.value=Object.freeze({async stat(i){try{let o;const s=r._fileSystemProvider.get(i.scheme);return s?(await r._proxy.$ensureActivation(i.scheme),o=await s.impl.stat(i)):o=await r._proxy.$stat(i),{type:o.type,ctime:o.ctime,mtime:o.mtime,size:o.size,permissions:o.permissions===gM.Readonly?1:void 0}}catch(o){xp._handleError(o)}},async readDirectory(i){try{const o=r._fileSystemProvider.get(i.scheme);return o?(await r._proxy.$ensureActivation(i.scheme),(await o.impl.readDirectory(i)).slice()):await r._proxy.$readdir(i)}catch(o){return xp._handleError(o)}},async createDirectory(i){try{const o=r._fileSystemProvider.get(i.scheme);return o&&!o.isReadonly?(await r._proxy.$ensureActivation(i.scheme),await r.mkdirp(o.impl,o.extUri,i)):await r._proxy.$mkdir(i)}catch(o){return xp._handleError(o)}},async readFile(i){try{const o=r._fileSystemProvider.get(i.scheme);return o?(await r._proxy.$ensureActivation(i.scheme),(await o.impl.readFile(i)).slice()):(await r._proxy.$readFile(i)).buffer}catch(o){return xp._handleError(o)}},async writeFile(i,o){try{const s=r._fileSystemProvider.get(i.scheme);return s&&!s.isReadonly?(await r._proxy.$ensureActivation(i.scheme),await r.mkdirp(s.impl,s.extUri,s.extUri.dirname(i)),await r._writeQueue.queueFor(i,()=>Promise.resolve(s.impl.writeFile(i,o,{create:!0,overwrite:!0})))):await r._proxy.$writeFile(i,ac.wrap(o))}catch(s){return xp._handleError(s)}},async delete(i,o){try{const s=r._fileSystemProvider.get(i.scheme);return s&&!s.isReadonly&&!(o!=null&&o.useTrash)?(await r._proxy.$ensureActivation(i.scheme),await s.impl.delete(i,{recursive:!1,...o})):await r._proxy.$delete(i,{recursive:!1,useTrash:!1,atomic:!1,...o})}catch(s){return xp._handleError(s)}},async rename(i,o,s){try{return await r._proxy.$rename(i,o,{overwrite:!1,...s})}catch(a){return xp._handleError(a)}},async copy(i,o,s){try{return await r._proxy.$copy(i,o,{overwrite:!1,...s})}catch(a){return xp._handleError(a)}},isWritableFileSystem(i){const o=t.getCapabilities(i);if(typeof o=="number")return!(o&2048)}})}async mkdirp(e,t,r){const i=[];for(;!t.isEqual(r,t.dirname(r));)try{if(!((await e.stat(r)).type&RP.Directory))throw Pa.FileExists(`Unable to create folder '${r.scheme===hr.file?r.fsPath:r.toString(!0)}' that already exists but is not a directory`);break}catch(o){if(eW(o)!==Bl.FileNotFound)throw o;i.push(t.basename(r)),r=t.dirname(r)}for(let o=i.length-1;o>=0;o--){r=t.joinPath(r,i[o]);try{await e.createDirectory(r)}catch(s){if(eW(s)!==Bl.FileExists)throw s}}}static _handleError(e){if(e instanceof Pa)throw e;if(e instanceof NGe)switch(e.code){case Bl.FileExists:throw Pa.FileExists(e.message);case Bl.FileNotFound:throw Pa.FileNotFound(e.message);case Bl.FileNotADirectory:throw Pa.FileNotADirectory(e.message);case Bl.FileIsADirectory:throw Pa.FileIsADirectory(e.message);case Bl.NoPermissions:throw Pa.NoPermissions(e.message);case Bl.Unavailable:throw Pa.Unavailable(e.message);default:throw new Pa(e.message,e.name)}if(!(e instanceof Error))throw new Pa(String(e));if(e.name==="ENOPRO"||e.message.includes("ENOPRO"))throw Pa.Unavailable(e.message);switch(e.name){case Bl.FileExists:throw Pa.FileExists(e.message);case Bl.FileNotFound:throw Pa.FileNotFound(e.message);case Bl.FileNotADirectory:throw Pa.FileNotADirectory(e.message);case Bl.FileIsADirectory:throw Pa.FileIsADirectory(e.message);case Bl.NoPermissions:throw Pa.NoPermissions(e.message);case Bl.Unavailable:throw Pa.Unavailable(e.message);default:throw new Pa(e.message,e.name)}}addFileSystemProvider(e,t,r){return this._fileSystemProvider.set(e,{impl:t,extUri:r!=null&&r.isCaseSensitive?Qce:IXe,isReadonly:!!(r!=null&&r.isReadonly)}),ho(()=>this._fileSystemProvider.delete(e))}getFileSystemProviderExtUri(e){var t;return((t=this._fileSystemProvider.get(e))==null?void 0:t.extUri)??Qce}};RJ=xp=An([Be(0,Ii),Be(1,IE)],RJ);const g9=go("IExtHostConsumerFileSystem");class YBe extends nxe{get disposed(){return this._disposed}constructor(e,t,r,i,o){super(),this.id=e,this.name=t,this.logger=r,this.proxy=i,this.extension=o,this.offset=0,this._disposed=!1,this.visible=!1,this.setLevel(r.getLevel()),this._register(r.onDidChangeLogLevel(s=>this.setLevel(s)))}get logLevel(){return this.getLevel()}appendLine(e){this.append(e+`
`)}append(e){this.info(e)}clear(){const e=this.offset;this.logger.flush(),this.proxy.$update(this.id,kj.Clear,e)}replace(e){const t=this.offset;this.info(e),this.proxy.$update(this.id,kj.Replace,t),this.visible&&this.logger.flush()}show(e,t){this.logger.flush(),this.proxy.$reveal(this.id,!!(typeof e=="boolean"?e:t))}hide(){this.proxy.$close(this.id)}log(e,t){this.offset+=ac.fromString(t).byteLength,TXe(this.logger,e,t),this.visible&&(this.logger.flush(),this.proxy.$update(this.id,kj.Append))}dispose(){super.dispose(),this._disposed||(this.proxy.$dispose(this.id),this._disposed=!0)}}class Trn extends YBe{appendLine(e){this.append(e)}}let AJ=class{constructor(e,t,r,i,o,s){this.initData=t,this.extHostFileSystem=r,this.extHostFileSystemInfo=i,this.loggerService=o,this.logService=s,this.extensionLogDirectoryPromise=new Map,this.namePool=1,this.channels=new Map,this.visibleChannelId=null,this.proxy=e.getProxy(dn.MainThreadOutputService),this.outputsLocation=this.extHostFileSystemInfo.extUri.joinPath(t.logsLocation,`output_logging_${PXe(new Date).replace(/-|:|\.\d+Z$/g,"")}`)}$setVisibleChannel(e){this.visibleChannelId=e;for(const[t,r]of this.channels)r.visible=t===this.visibleChannelId}createOutputChannel(e,t,r){var l,u;if(e=e.trim(),!e)throw new Error("illegal argument `name`. must not be falsy");const i=typeof t=="object"&&t.log,o=Hm(t)?t:void 0;if(Hm(o)&&!o.trim())throw new Error("illegal argument `languageId`. must not be empty");let s;const a=(u=(l=this.initData.environment.extensionLogLevel)==null?void 0:l.find(([d])=>jc.equals(r.identifier,d)))==null?void 0:u[1];a&&(s=kXe(a));const c=i?this.doCreateLogOutputChannel(e,s,r):this.doCreateOutputChannel(e,o,r);return c.then(d=>{this.channels.set(d.id,d),d.visible=d.id===this.visibleChannelId}),i?this.createExtHostLogOutputChannel(e,s??this.logService.getLevel(),c):this.createExtHostOutputChannel(e,c)}async doCreateOutputChannel(e,t,r){this.outputDirectoryPromise||(this.outputDirectoryPromise=this.extHostFileSystem.value.createDirectory(this.outputsLocation).then(()=>this.outputsLocation));const i=await this.outputDirectoryPromise,o=this.extHostFileSystemInfo.extUri.joinPath(i,`${this.namePool++}-${e.replace(/[\\/:\*\?"<>\|]/g,"")}.log`),s=this.loggerService.createLogger(o,{logLevel:"always",donotRotate:!0,donotUseFormatters:!0,hidden:!0}),a=await this.proxy.$register(e,o,t,r.identifier.value);return new YBe(a,e,s,this.proxy,r)}async doCreateLogOutputChannel(e,t,r){const i=await this.createExtensionLogDirectory(r),o=e.replace(/[\\/:\*\?"<>\|]/g,""),s=this.extHostFileSystemInfo.extUri.joinPath(i,`${o}.log`),a=`${r.identifier.value}.${o}`,c=this.loggerService.createLogger(s,{id:a,name:e,logLevel:t,extensionId:r.identifier.value});return new Trn(a,e,c,this.proxy,r)}createExtensionLogDirectory(e){let t=this.extensionLogDirectoryPromise.get(e.identifier.value);if(!t){const r=this.extHostFileSystemInfo.extUri.joinPath(this.initData.logsLocation,e.identifier.value);this.extensionLogDirectoryPromise.set(e.identifier.value,t=(async()=>{try{await this.extHostFileSystem.value.createDirectory(r)}catch(i){if(eW(i)!==Bl.FileExists)throw i}return r})())}return t}createExtHostOutputChannel(e,t){let r=!1;const i=()=>{if(r)throw new Error("Channel has been closed")};return{get name(){return e},append(o){i(),t.then(s=>s.append(o))},appendLine(o){i(),t.then(s=>s.appendLine(o))},clear(){i(),t.then(o=>o.clear())},replace(o){i(),t.then(s=>s.replace(o))},show(o,s){i(),t.then(a=>a.show(o,s))},hide(){i(),t.then(o=>o.hide())},dispose(){r=!0,t.then(o=>o.dispose())}}}createExtHostLogOutputChannel(e,t,r){const i=new ei,o=()=>{if(i.isDisposed)throw new Error("Channel has been closed")},s=i.add(new ft);function a(c){t=c,s.fire(c)}return r.then(c=>{i.add(c),c.logLevel!==t&&a(c.logLevel),i.add(c.onDidChangeLogLevel(l=>a(l)))}),{...this.createExtHostOutputChannel(e,r),get logLevel(){return t},onDidChangeLogLevel:s.event,trace(c,...l){o(),r.then(u=>u.trace(c,...l))},debug(c,...l){o(),r.then(u=>u.debug(c,...l))},info(c,...l){o(),r.then(u=>u.info(c,...l))},warn(c,...l){o(),r.then(u=>u.warn(c,...l))},error(c,...l){o(),r.then(u=>u.error(c,...l))},dispose(){i.dispose()}}}};AJ=An([Be(0,Ii),Be(1,Cl),Be(2,g9),Be(3,IE),Be(4,s_),Be(5,Li)],AJ);const JBe=go("IExtHostOutputService"),m9=go("IURITransformerService");class Drn{constructor(e){e?(this.transformIncoming=e.transformIncoming.bind(e),this.transformOutgoing=e.transformOutgoing.bind(e),this.transformOutgoingURI=e.transformOutgoingURI.bind(e),this.transformOutgoingScheme=e.transformOutgoingScheme.bind(e)):(this.transformIncoming=t=>t,this.transformOutgoing=t=>t,this.transformOutgoingURI=t=>t,this.transformOutgoingScheme=t=>t)}}const Rrn="vs/workbench/api/common/extHostWorkspace";function ST(n,e,t){return new txe(r=>wse(r,t)).isEqual(n,e)}function Arn(n,e,t){return ST(n.uri,e.uri,t)?0:x2(n.uri.toString(),e.uri.toString())}function Orn(n,e,t){return n.index!==e.index?n.index<e.index?-1:1:ST(n.uri,e.uri,t)?x2(n.name,e.name):x2(n.uri.toString(),e.uri.toString())}function QBe(n,e,t,r){const i=n.slice(0).sort((s,a)=>t(s,a,r)),o=e.slice(0).sort((s,a)=>t(s,a,r));return Hb(i,o,(s,a)=>t(s,a,r))}function wse(n,e){const t=e.getCapabilities(n.scheme);return!(t&&t&1024)}class o2 extends Y2e{static toExtHostWorkspace(e,t,r,i){if(!e)return{workspace:null,added:[],removed:[]};const{id:o,name:s,folders:a,configuration:c,transient:l,isUntitled:u}=e,d=[],h=t;t?a.forEach((m,v)=>{const b=Te.revive(m.uri),S=o2._findFolder(r||t,b,i);S?(S.name=m.name,S.index=m.index,d.push(S)):d.push({uri:b,name:m.name,index:v})}):d.push(...a.map(({uri:m,name:v,index:b})=>({uri:Te.revive(m),name:v,index:b}))),d.sort((m,v)=>m.index<v.index?-1:1);const f=new o2(o,s,d,!!l,c?Te.revive(c):null,!!u,m=>wse(m,i)),{added:p,removed:g}=QBe(h?h.workspaceFolders:[],f.workspaceFolders,Arn,i);return{workspace:f,added:p,removed:g}}static _findFolder(e,t,r){for(let i=0;i<e.folders.length;i++){const o=e.workspaceFolders[i];if(ST(o.uri,t,r))return o}}constructor(e,t,r,i,o,s,a){super(e,r.map(c=>new U2e(c)),i,o,a),this._name=t,this._isUntitled=s,this._workspaceFolders=[],this._structure=T2e.forUris(a),r.forEach(c=>{this._workspaceFolders.push(c),this._structure.set(c.uri,c)})}get name(){return this._name}get isUntitled(){return this._isUntitled}get workspaceFolders(){return this._workspaceFolders.slice(0)}getWorkspaceFolder(e,t){return t&&this._structure.get(e)&&(e=QL(e)),this._structure.findSubstr(e)}resolveWorkspaceFolder(e){return this._structure.get(e)}}let OJ=class{constructor(e,t,r,i,o){this._onDidChangeWorkspace=new ft,this.onDidChangeWorkspace=this._onDidChangeWorkspace.event,this._onDidGrantWorkspaceTrust=new ft,this.onDidGrantWorkspaceTrust=this._onDidGrantWorkspaceTrust.event,this._activeSearchCallbacks=[],this._trusted=!1,this._editSessionIdentityProviders=new Map,this._providerHandlePool=0,this._onWillCreateEditSessionIdentityEvent=new AP,this._canonicalUriProviders=new Map,this._logService=i,this._extHostFileSystemInfo=r,this._uriTransformerService=o,this._requestIdProvider=new DXe,this._barrier=new Mf,this._proxy=e.getProxy(dn.MainThreadWorkspace),this._messageService=e.getProxy(dn.MainThreadMessageService);const s=t.workspace;this._confirmedWorkspace=s?new o2(s.id,s.name,[],!!s.transient,s.configuration?Te.revive(s.configuration):null,!!s.isUntitled,a=>wse(a,r)):void 0}$initializeWorkspace(e,t){this._trusted=t,this.$acceptWorkspaceData(e),this._barrier.open()}waitForInitializeCall(){return this._barrier.wait()}get workspace(){return this._actualWorkspace}get name(){return this._actualWorkspace?this._actualWorkspace.name:void 0}get workspaceFile(){if(this._actualWorkspace&&this._actualWorkspace.configuration)return this._actualWorkspace.isUntitled?Te.from({scheme:hr.untitled,path:I2(QL(this._actualWorkspace.configuration))}):this._actualWorkspace.configuration}get _actualWorkspace(){return this._unconfirmedWorkspace||this._confirmedWorkspace}getWorkspaceFolders(){if(this._actualWorkspace)return this._actualWorkspace.workspaceFolders.slice(0)}async getWorkspaceFolders2(){if(await this._barrier.wait(),!!this._actualWorkspace)return this._actualWorkspace.workspaceFolders.slice(0)}updateWorkspaceFolders(e,t,r,...i){const o=[];if(Array.isArray(i)&&i.forEach(u=>{Te.isUri(u.uri)&&!o.some(d=>ST(d.uri,u.uri,this._extHostFileSystemInfo))&&o.push({uri:u.uri,name:u.name||gW(u.uri)})}),this._unconfirmedWorkspace||[t,r].some(u=>typeof u!="number"||u<0)||r===0&&o.length===0)return!1;const s=this._actualWorkspace?this._actualWorkspace.workspaceFolders:[];if(t+r>s.length)return!1;const a=s.slice(0);a.splice(t,r,...o.map(u=>({uri:u.uri,name:u.name||gW(u.uri),index:void 0})));for(let u=0;u<a.length;u++){const d=a[u];if(a.some((h,f)=>f!==u&&ST(d.uri,h.uri,this._extHostFileSystemInfo)))return!1}a.forEach((u,d)=>u.index=d);const{added:c,removed:l}=QBe(s,a,Orn,this._extHostFileSystemInfo);if(c.length===0&&l.length===0)return!1;if(this._proxy){const u=e.displayName||e.name;this._proxy.$updateWorkspaceFolders(u,t,r,o).then(void 0,d=>{this._unconfirmedWorkspace=void 0;const h={source:{identifier:e.identifier,label:e.displayName||e.name}};this._messageService.$showMessage($s.Error,Ve(Rrn,0,"Extension '{0}' failed to update workspace folders: {1}",u,d.toString()),h,[])})}return this.trySetWorkspaceFolders(a),!0}getWorkspaceFolder(e,t){if(this._actualWorkspace)return this._actualWorkspace.getWorkspaceFolder(e,t)}async getWorkspaceFolder2(e,t){if(await this._barrier.wait(),!!this._actualWorkspace)return this._actualWorkspace.getWorkspaceFolder(e,t)}async resolveWorkspaceFolder(e){if(await this._barrier.wait(),!!this._actualWorkspace)return this._actualWorkspace.resolveWorkspaceFolder(e)}getPath(){if(!this._actualWorkspace)return;const{folders:e}=this._actualWorkspace;if(e.length!==0)return e[0].uri.fsPath}getRelativePath(e,t){let r,i="";if(typeof e=="string"?(r=Te.file(e),i=e):typeof e<"u"&&(r=e,i=e.fsPath),!r)return i;const o=this.getWorkspaceFolder(r,!0);if(!o)return i;typeof t>"u"&&this._actualWorkspace&&(t=this._actualWorkspace.folders.length>1);let s=rxe(o.uri,r);return t&&o.name&&(s=`${o.name}/${s}`),s}trySetWorkspaceFolders(e){this._actualWorkspace&&(this._unconfirmedWorkspace=o2.toExtHostWorkspace({id:this._actualWorkspace.id,name:this._actualWorkspace.name,configuration:this._actualWorkspace.configuration,folders:e,isUntitled:this._actualWorkspace.isUntitled},this._actualWorkspace,void 0,this._extHostFileSystemInfo).workspace||void 0)}$acceptWorkspaceData(e){const{workspace:t,added:r,removed:i}=o2.toExtHostWorkspace(e,this._confirmedWorkspace,this._unconfirmedWorkspace,this._extHostFileSystemInfo);this._confirmedWorkspace=t||void 0,this._unconfirmedWorkspace=void 0,this._onDidChangeWorkspace.fire(Object.freeze({added:r,removed:i}))}findFiles(e,t,r,i,o=Xl.None){this._logService.trace(`extHostWorkspace#findFiles: fileSearch, extension: ${i.value}, entryPoint: findFiles`);let s="",a=!0;return t===null?a=!1:t!==void 0&&(typeof t=="string"?s=t:s=t.pattern),this._findFilesImpl(e,void 0,{exclude:s,maxResults:r,useDefaultExcludes:a,useDefaultSearchExcludes:!1,useIgnoreFiles:!1},o)}findFiles2(e,t={},r,i=Xl.None){return this._logService.trace(`extHostWorkspace#findFiles2: fileSearch, extension: ${r.value}, entryPoint: findFiles2`),this._findFilesImpl(void 0,e,t,i)}async _findFilesImpl(e,t,r,i=Xl.None){if(i&&i.isCancellationRequested)return Promise.resolve([]);const o=typeof r.exclude=="string"?r.exclude:r.exclude?r.exclude.pattern:void 0,s={ignoreSymlinks:typeof r.followSymlinks=="boolean"?!r.followSymlinks:void 0,disregardIgnoreFiles:typeof r.useIgnoreFiles=="boolean"?!r.useIgnoreFiles:void 0,disregardGlobalIgnoreFiles:typeof r.useGlobalIgnoreFiles=="boolean"?!r.useGlobalIgnoreFiles:void 0,disregardParentIgnoreFiles:typeof r.useParentIgnoreFiles=="boolean"?!r.useParentIgnoreFiles:void 0,disregardExcludeSettings:typeof r.useDefaultExcludes=="boolean"?!r.useDefaultExcludes:!1,disregardSearchExcludeSettings:typeof r.useDefaultSearchExcludes=="boolean"?!r.useDefaultSearchExcludes:!1,maxResults:r.maxResults,excludePattern:o,shouldGlobSearch:typeof r.fuzzy=="boolean"?!r.fuzzy:!0,_reason:"startFileSearch"};let a;if(e){const{includePattern:c,folder:l}=uV(i4.from(e));a=l,s.includePattern=c}else{const{includePattern:c,folder:l}=uV(i4.from(t));a=l,s.filePattern=c}return this._proxy.$startFileSearch(a??null,s,i).then(c=>Array.isArray(c)?c.map(l=>Te.revive(l)):[])}async findTextInFiles(e,t,r,i,o=Xl.None){this._logService.trace(`extHostWorkspace#findTextInFiles: textSearch, extension: ${i.value}, entryPoint: findTextInFiles`);const s=this._requestIdProvider.getNext(),a=typeof t.previewOptions>"u"?{matchLines:100,charsPerLine:1e4}:t.previewOptions,{includePattern:c,folder:l}=uV(i4.from(t.include)),u=typeof t.exclude=="string"?t.exclude:t.exclude?t.exclude.pattern:void 0,d={ignoreSymlinks:typeof t.followSymlinks=="boolean"?!t.followSymlinks:void 0,disregardIgnoreFiles:typeof t.useIgnoreFiles=="boolean"?!t.useIgnoreFiles:void 0,disregardGlobalIgnoreFiles:typeof t.useGlobalIgnoreFiles=="boolean"?!t.useGlobalIgnoreFiles:void 0,disregardParentIgnoreFiles:typeof t.useParentIgnoreFiles=="boolean"?!t.useParentIgnoreFiles:void 0,disregardExcludeSettings:typeof t.useDefaultExcludes=="boolean"?!t.useDefaultExcludes:!0,fileEncoding:t.encoding,maxResults:t.maxResults,previewOptions:a,afterContext:t.afterContext,beforeContext:t.beforeContext,includePattern:c,excludePattern:u};if(this._activeSearchCallbacks[s]=h=>{const f=Te.revive(h.resource);h.results.forEach(p=>{const g=EM(p);RXe(g)?r({uri:f,preview:{text:g.preview.text,matches:mM(g.preview.matches,m=>new _s(m.startLineNumber,m.startColumn,m.endLineNumber,m.endColumn))},ranges:mM(g.ranges,m=>new _s(m.startLineNumber,m.startColumn,m.endLineNumber,m.endColumn))}):r({uri:f,text:g.text,lineNumber:g.lineNumber})})},o.isCancellationRequested)return{};try{const h=await this._proxy.$startTextSearch(e,l??null,d,s,o);return delete this._activeSearchCallbacks[s],h||{}}catch(h){throw delete this._activeSearchCallbacks[s],h}}$handleTextSearchResult(e,t){var r,i;(i=(r=this._activeSearchCallbacks)[t])==null||i.call(r,e)}async save(e){const t=await this._proxy.$save(e,{saveAs:!1});return Te.revive(t)}async saveAs(e){const t=await this._proxy.$save(e,{saveAs:!0});return Te.revive(t)}saveAll(e){return this._proxy.$saveAll(e)}resolveProxy(e){return this._proxy.$resolveProxy(e)}loadCertificates(){return this._proxy.$loadCertificates()}get trusted(){return this._trusted}requestWorkspaceTrust(e){return this._proxy.$requestWorkspaceTrust(e)}$onDidGrantWorkspaceTrust(){this._trusted||(this._trusted=!0,this._onDidGrantWorkspaceTrust.fire())}registerEditSessionIdentityProvider(e,t){if(this._editSessionIdentityProviders.has(e))throw new Error(`A provider has already been registered for scheme ${e}`);this._editSessionIdentityProviders.set(e,t);const r=this._uriTransformerService.transformOutgoingScheme(e),i=this._providerHandlePool++;return this._proxy.$registerEditSessionIdentityProvider(i,r),ho(()=>{this._editSessionIdentityProviders.delete(e),this._proxy.$unregisterEditSessionIdentityProvider(i)})}async $getEditSessionIdentifier(e,t){this._logService.info("Getting edit session identifier for workspaceFolder",e);const r=await this.resolveWorkspaceFolder(Te.revive(e));if(!r){this._logService.warn("Unable to resolve workspace folder");return}this._logService.info("Invoking #provideEditSessionIdentity for workspaceFolder",r);const i=this._editSessionIdentityProviders.get(r.uri.scheme);if(this._logService.info(`Provider for scheme ${r.uri.scheme} is defined: `,!!i),!i)return;const o=await i.provideEditSessionIdentity(r,t);if(this._logService.info("Provider returned edit session identifier: ",o),!!o)return o}async $provideEditSessionIdentityMatch(e,t,r,i){var c;this._logService.info("Getting edit session identifier for workspaceFolder",e);const o=await this.resolveWorkspaceFolder(Te.revive(e));if(!o){this._logService.warn("Unable to resolve workspace folder");return}this._logService.info("Invoking #provideEditSessionIdentity for workspaceFolder",o);const s=this._editSessionIdentityProviders.get(o.uri.scheme);if(this._logService.info(`Provider for scheme ${o.uri.scheme} is defined: `,!!s),!s)return;const a=await((c=s.provideEditSessionIdentityMatch)==null?void 0:c.call(s,t,r,i));if(this._logService.info("Provider returned edit session identifier match result: ",a),!!a)return a}getOnWillCreateEditSessionIdentityEvent(e){return(t,r,i)=>{const o=function(a){t.call(r,a)};return o.extension=e,this._onWillCreateEditSessionIdentityEvent.event(o,void 0,i)}}async $onWillCreateEditSessionIdentity(e,t,r){const i=await this.resolveWorkspaceFolder(Te.revive(e));if(i===void 0)throw new Error("Unable to resolve workspace folder");await this._onWillCreateEditSessionIdentityEvent.fireAsync({workspaceFolder:i},t,async(o,s)=>{const a=Date.now();await Promise.resolve(o),Date.now()-a>r&&this._logService.warn("SLOW edit session create-participant",s.extension.identifier)}),t.isCancellationRequested}registerCanonicalUriProvider(e,t){if(this._canonicalUriProviders.has(e))throw new Error(`A provider has already been registered for scheme ${e}`);this._canonicalUriProviders.set(e,t);const r=this._uriTransformerService.transformOutgoingScheme(e),i=this._providerHandlePool++;return this._proxy.$registerCanonicalUriProvider(i,r),ho(()=>{this._canonicalUriProviders.delete(e),this._proxy.$unregisterCanonicalUriProvider(i)})}async provideCanonicalUri(e,t,r){var s;const i=this._canonicalUriProviders.get(e.scheme);if(!i)return;const o=await((s=i.provideCanonicalUri)==null?void 0:s.call(i,Te.revive(e),t,r));if(o)return o}async $provideCanonicalUri(e,t,r){return this.provideCanonicalUri(Te.revive(e),{targetScheme:t},r)}};OJ=An([Be(0,Ii),Be(1,Cl),Be(2,IE),Be(3,Li),Be(4,m9)],OJ);const Av=go("IExtHostWorkspace");function uV(n){let e,t;return n&&(typeof n=="string"?e=n:(e=n.pattern,t=Te.revive(n.baseUri))),{includePattern:e,folder:t}}var IP,SS;let MJ=(SS=class{constructor(e,t){this._logService=t,this._provider=new Map,this._proxy=e.getProxy(dn.MainThreadDecorations)}registerFileDecorationProvider(e,t){const r=IP._handlePool++;this._provider.set(r,{provider:e,extensionDescription:t}),this._proxy.$registerDecorationProvider(r,t.identifier.value);const i=e.onDidChangeFileDecorations&&e.onDidChangeFileDecorations(o=>{if(!o){this._proxy.$onDidChange(r,null);return}const s=vM(o);if(s.length<=IP._maxEventSize){this._proxy.$onDidChange(r,s);return}this._logService.warn("[Decorations] CAPPING events from decorations provider",t.identifier.value,s.length);const a=s.map(u=>({uri:u,rank:FGe(u.path,"/")})),c=jGe(a,(u,d)=>u.rank-d.rank||x2(u.uri.path,d.uri.path)),l=[];e:for(const u of c){let d;for(const h of u){const f=OP(h.uri.path);if(d!==f&&(d=f,l.push(h.uri)>=IP._maxEventSize))break e}}this._proxy.$onDidChange(r,l)});return new pi(()=>{i==null||i.dispose(),this._proxy.$unregisterDecorationProvider(r),this._provider.delete(r)})}async $provideDecorations(e,t,r){if(!this._provider.has(e))return Object.create(null);const i=Object.create(null),{provider:o,extensionDescription:s}=this._provider.get(e);return await Promise.all(t.map(async a=>{try{const{uri:c,id:l}=a,u=await Promise.resolve(o.provideFileDecoration(Te.revive(c),r));if(!u)return;try{vW.validate(u),u.badge&&typeof u.badge!="string"&&vt(s,"codiconDecoration"),i[l]=[u.propagate,u.tooltip,u.badge,u.color]}catch(d){this._logService.warn(`INVALID decoration from extension '${s.identifier.value}': ${d}`)}}catch(c){this._logService.error(c)}})),i}},IP=SS,SS._handlePool=0,SS._maxEventSize=250,SS);MJ=IP=An([Be(0,Ii),Be(1,Li)],MJ);const eHe=go("IExtHostDecorations");function zI(n,e){if(e){const t=e.split(".");let r=n;for(let i=0;r&&i<t.length;i++)r=r[t[i]];return r}}function Mrn(n){return n instanceof Te}function $rn(n){return n&&n.uri instanceof Te&&n.languageId&&typeof n.languageId=="string"}function Lrn(n){return n&&!n.uri&&n.languageId&&typeof n.languageId=="string"}function Nrn(n){return n&&n.uri instanceof Te&&(!n.name||typeof n.name=="string")&&(!n.index||typeof n.index=="number")}function Ywe(n){if(Mrn(n))return{resource:n};if($rn(n))return{resource:n.uri,overrideIdentifier:n.languageId};if(Lrn(n))return{overrideIdentifier:n.languageId};if(Nrn(n))return{resource:n.uri};if(n===null)return{resource:null}}let $J=class{constructor(e,t,r){this._proxy=e.getProxy(dn.MainThreadConfiguration),this._extHostWorkspace=t,this._logService=r,this._barrier=new Mf,this._actual=null}getConfigProvider(){return this._barrier.wait().then(e=>this._actual)}$initializeConfiguration(e){this._actual=new Frn(this._proxy,this._extHostWorkspace,e,this._logService),this._barrier.open()}$acceptConfigurationChanged(e,t){this.getConfigProvider().then(r=>r.$acceptConfigurationChanged(e,t))}};$J=An([Be(0,Ii),Be(1,Av),Be(2,Li)],$J);class Frn{constructor(e,t,r,i){this._onDidChangeConfiguration=new ft,this._proxy=e,this._logService=i,this._extHostWorkspace=t,this._configuration=fW.parse(r,i),this._configurationScopes=this._toMap(r.configurationScopes)}get onDidChangeConfiguration(){return this._onDidChangeConfiguration&&this._onDidChangeConfiguration.event}$acceptConfigurationChanged(e,t){const r={data:this._configuration.toData(),workspace:this._extHostWorkspace.workspace};this._configuration=fW.parse(e,this._logService),this._configurationScopes=this._toMap(e.configurationScopes),this._onDidChangeConfiguration.fire(this._toConfigurationChangeEvent(t,r))}getConfiguration(e,t,r){const i=Ywe(t)||{},o=this._toReadonlyValue(e?zI(this._configuration.getValue(void 0,i,this._extHostWorkspace.workspace),e):this._configuration.getValue(void 0,i,this._extHostWorkspace.workspace));e&&this._validateConfigurationAccess(e,i,r==null?void 0:r.identifier);function s(c){if(c==null)return null;if(typeof c=="boolean")return c?2:5;switch(c){case o4.Global:return 2;case o4.Workspace:return 5;case o4.WorkspaceFolder:return 6}}const a={has(c){return typeof zI(o,c)<"u"},get:(c,l)=>{this._validateConfigurationAccess(e?`${e}.${c}`:c,i,r==null?void 0:r.identifier);let u=zI(o,c);if(typeof u>"u")u=l;else{let d;const h=(f,p)=>{if(xd(f)){let g;const m=()=>{d=d||zl(o),g=g||zI(d,p)};return new Proxy(f,{get:(v,b)=>{if(typeof b=="string"&&b.toLowerCase()==="tojson")return m(),()=>g;if(d)return g=g||zI(d,p),g[b];const S=v[b];return typeof b=="string"?h(S,`${p}.${b}`):S},set:(v,b,S)=>(m(),g&&(g[b]=S),!0),deleteProperty:(v,b)=>(m(),g&&delete g[b],!0),defineProperty:(v,b,S)=>(m(),g&&Object.defineProperty(g,b,S),!0)})}return Array.isArray(f)?zl(f):f};u=h(u,c)}return u},update:(c,l,u,d)=>{c=e?`${e}.${c}`:c;const h=s(u);return l!==void 0?this._proxy.$updateConfigurationOption(h,c,l,i,d):this._proxy.$removeConfigurationOption(h,c,i,d)},inspect:c=>{var u,d,h,f,p,g,m,v,b,S,E;c=e?`${e}.${c}`:c;const l=this._configuration.inspect(c,i,this._extHostWorkspace.workspace);if(l)return{key:c,defaultValue:zl(((u=l.policy)==null?void 0:u.value)??((d=l.default)==null?void 0:d.value)),globalValue:zl(((h=l.user)==null?void 0:h.value)??((f=l.application)==null?void 0:f.value)),workspaceValue:zl((p=l.workspace)==null?void 0:p.value),workspaceFolderValue:zl((g=l.workspaceFolder)==null?void 0:g.value),defaultLanguageValue:zl((m=l.default)==null?void 0:m.override),globalLanguageValue:zl(((v=l.user)==null?void 0:v.override)??((b=l.application)==null?void 0:b.override)),workspaceLanguageValue:zl((S=l.workspace)==null?void 0:S.override),workspaceFolderLanguageValue:zl((E=l.workspaceFolder)==null?void 0:E.override),languageIds:zl(l.overrideIdentifiers)}}};return typeof o=="object"&&IM(a,o,!1),Object.freeze(a)}_toReadonlyValue(e){const t=r=>xd(r)?new Proxy(r,{get:(i,o)=>t(i[o]),set:(i,o,s)=>{throw new Error(`TypeError: Cannot assign to read only property '${String(o)}' of object`)},deleteProperty:(i,o)=>{throw new Error(`TypeError: Cannot delete read only property '${String(o)}' of object`)},defineProperty:(i,o)=>{throw new Error(`TypeError: Cannot define property '${String(o)}' for a readonly object`)},setPrototypeOf:i=>{throw new Error("TypeError: Cannot set prototype for a readonly object")},isExtensible:()=>!1,preventExtensions:()=>!0}):r;return t(e)}_validateConfigurationAccess(e,t,r){const i=CC.test(e)?4:this._configurationScopes.get(e),o=r?`[${r.value}] `:"";if(i===4){typeof(t==null?void 0:t.resource)>"u"&&this._logService.warn(`${o}Accessing a resource scoped configuration without providing a resource is not expected. To get the effective value for '${e}', provide the URI of a resource or 'null' for any resource.`);return}if(i===3){t!=null&&t.resource&&this._logService.warn(`${o}Accessing a window scoped configuration for a resource is not expected. To associate '${e}' to a resource, define its scope to 'resource' in configuration contributions in 'package.json'.`);return}}_toConfigurationChangeEvent(e,t){const r=new X2e(e,t,this._configuration,this._extHostWorkspace.workspace,this._logService);return Object.freeze({affectsConfiguration:(i,o)=>r.affectsConfiguration(i,Ywe(o))})}_toMap(e){return e.reduce((t,r)=>(t.set(r[0],r[1]),t),new Map)}}const Ov=go("IExtHostConfiguration"),Bb=(n,e,t,r)=>{let i=e;return{enumerable:!0,configurable:!1,get(){return i},set(o){var s;if(!t(i,o)){const a=i;i=o,(s=n.listener)==null||s.call(n,r(o,a))}}}},Cw=(n,e)=>n===e,t0={range:(n,e)=>n===e?!0:!n||!e?!1:n.isEqual(e),label:Cw,description:Cw,sortText:Cw,busy:Cw,error:Cw,canResolveChildren:Cw,tags:(n,e)=>!(n.length!==e.length||n.some(t=>!e.find(r=>t.id===r.id)))},xw=n=>e=>({op:4,update:n(e)}),jrn=(n,e)=>({range:(()=>{let t;const r=xw(i=>({range:Sy.lift(Rn.from(i))}));return{enumerable:!0,configurable:!1,get(){return t},set(i){var o,s;(o=n.listener)==null||o.call(n,{op:6}),t0.range(t,i)||(t=i,(s=n.listener)==null||s.call(n,r(i)))}}})(),label:Bb(n,e,t0.label,xw(t=>({label:t}))),description:Bb(n,void 0,t0.description,xw(t=>({description:t}))),sortText:Bb(n,void 0,t0.sortText,xw(t=>({sortText:t}))),canResolveChildren:Bb(n,!1,t0.canResolveChildren,t=>({op:2,state:t})),busy:Bb(n,!1,t0.busy,xw(t=>({busy:t}))),error:Bb(n,void 0,t0.error,xw(t=>({error:$a.fromStrict(t)||null}))),tags:Bb(n,[],t0.tags,(t,r)=>({op:1,new:t.map(Ak.from),old:r.map(Ak.from)}))}),Brn=n=>{const e=Mo.fromString(n.extId),t=new __(e.controllerId,e.localId,n.label,Te.revive(n.uri)||void 0);return t.range=Rn.to(n.range||void 0),t.description=n.description||void 0,t.sortText=n.sortText||void 0,t.tags=n.tags.map(r=>Ak.to({id:$Xe(r).tagId})),t},Jwe=n=>{let e;for(const t of n.tests){const r=Brn(t.item);Tee(r).parent=e,e=r}return e};class __{constructor(e,t,r,i){if(t.includes("\0"))throw new Error(`Test IDs may not include the ${JSON.stringify(t)} symbol`);const o=AXe(this,e);Object.defineProperties(this,{id:{value:t,enumerable:!0,writable:!1},uri:{value:i,enumerable:!0,writable:!1},parent:{enumerable:!1,get(){return o.parent instanceof Cse?void 0:o.parent}},children:{value:OXe(o,Tee,__),enumerable:!0,writable:!1},...jrn(o,r)})}}class Cse extends __{constructor(e,t){super(e,e,t,void 0),this._isRoot=!0}}class Hrn extends MXe{constructor(e,t,r){super({controllerId:e,getDocumentVersion:i=>{var o;return i&&((o=r.getDocument(i))==null?void 0:o.version)},getApiFor:Tee,getChildren:i=>i.children,root:new Cse(e,t),toITestItem:qT.from})}}const Urn="vs/workbench/api/common/extHostTelemetry";let LJ=class extends Dr{constructor(e,t){super(),this.initData=e,this.loggerService=t,this._onDidChangeTelemetryEnabled=this._register(new ft),this.onDidChangeTelemetryEnabled=this._onDidChangeTelemetryEnabled.event,this._onDidChangeTelemetryConfiguration=this._register(new ft),this.onDidChangeTelemetryConfiguration=this._onDidChangeTelemetryConfiguration.event,this._productConfig={usage:!0,error:!0},this._level=0,this._telemetryIsSupported=!1,this._inLoggingOnlyMode=!1,this._telemetryLoggers=new Map,this.extHostTelemetryLogFile=Te.revive(this.initData.environment.extensionTelemetryLogResource),this._inLoggingOnlyMode=this.initData.environment.isExtensionTelemetryLoggingOnly,this._outputLogger=t.createLogger(this.extHostTelemetryLogFile,{id:LXe,name:Ve(Urn,0,"Extension Telemetry{0}",this._inLoggingOnlyMode?" (Not Sent)":""),hidden:!0}),this._register(this._outputLogger),this._register(t.onDidChangeLogLevel(r=>{NXe(r)&&this.updateLoggerVisibility()})),this._outputLogger.info("Below are logs for extension telemetry events sent to the telemetry output channel API once the log level is set to trace."),this._outputLogger.info("===========================================================")}updateLoggerVisibility(){this.loggerService.setVisibility(this.extHostTelemetryLogFile,this._telemetryIsSupported&&this.loggerService.getLogLevel()===ixe.Trace)}getTelemetryConfiguration(){return this._level===3}getTelemetryDetails(){return{isCrashEnabled:this._level>=1,isErrorsEnabled:this._productConfig.error?this._level>=2:!1,isUsageEnabled:this._productConfig.usage?this._level>=3:!1}}instantiateLogger(e,t,r){const i=this.getTelemetryDetails(),o=new tHe(t,r,e,this._outputLogger,this._inLoggingOnlyMode,this.getBuiltInCommonProperties(e),{isUsageEnabled:i.isUsageEnabled,isErrorsEnabled:i.isErrorsEnabled}),s=this._telemetryLoggers.get(e.identifier.value)??[];return this._telemetryLoggers.set(e.identifier.value,[...s,o]),o.apiTelemetryLogger}$initializeTelemetryLevel(e,t,r){this._level=e,this._telemetryIsSupported=t,this._productConfig=r??{usage:!0,error:!0},this.updateLoggerVisibility()}getBuiltInCommonProperties(e){const t=Object.create(null);switch(t["common.extname"]=`${e.publisher}.${e.name}`,t["common.extversion"]=e.version,t["common.vscodemachineid"]=this.initData.telemetryInfo.machineId,t["common.vscodesessionid"]=this.initData.telemetryInfo.sessionId,t["common.sqmid"]=this.initData.telemetryInfo.sqmId,t["common.vscodeversion"]=this.initData.version,t["common.isnewappinstall"]=nHe(this.initData.telemetryInfo.firstSessionDate),t["common.product"]=this.initData.environment.appHost,this.initData.uiKind){case Ok.Web:t["common.uikind"]="web";break;case Ok.Desktop:t["common.uikind"]="desktop";break;default:t["common.uikind"]="unknown"}return t["common.remotename"]=oxe(FXe(this.initData.remote.authority)),t}$onDidChangeTelemetryLevel(e){this._oldTelemetryEnablement=this.getTelemetryConfiguration(),this._level=e;const t=this.getTelemetryDetails();this._telemetryLoggers.forEach((r,i)=>{const o=r.filter(s=>!s.isDisposed);o.length===0?this._telemetryLoggers.delete(i):this._telemetryLoggers.set(i,o)}),this._telemetryLoggers.forEach(r=>{for(const i of r)i.updateTelemetryEnablements(t.isUsageEnabled,t.isErrorsEnabled)}),this._oldTelemetryEnablement!==this.getTelemetryConfiguration()&&this._onDidChangeTelemetryEnabled.fire(this.getTelemetryConfiguration()),this._onDidChangeTelemetryConfiguration.fire(this.getTelemetryDetails()),this.updateLoggerVisibility()}onExtensionError(e,t){const r=this._telemetryLoggers.get(e.value),i=r==null?void 0:r.filter(s=>!s.isDisposed);if(!i)return this._telemetryLoggers.delete(e.value),!1;let o=!1;for(const s of i)s.ignoreUnhandledExtHostErrors||(s.logError(t),o=!0);return o}};LJ=An([Be(0,Cl),Be(1,s_)],LJ);class tHe{static validateSender(e){if(typeof e!="object")throw new TypeError("TelemetrySender argument is invalid");if(typeof e.sendEventData!="function")throw new TypeError("TelemetrySender.sendEventData must be a function");if(typeof e.sendErrorData!="function")throw new TypeError("TelemetrySender.sendErrorData must be a function");if(typeof e.flush<"u"&&typeof e.flush!="function")throw new TypeError("TelemetrySender.flush must be a function or undefined")}constructor(e,t,r,i,o,s,a){this._extension=r,this._logger=i,this._inLoggingOnlyMode=o,this._commonProperties=s,this._onDidChangeEnableStates=new ft,this.ignoreUnhandledExtHostErrors=(t==null?void 0:t.ignoreUnhandledErrors)??!1,this._ignoreBuiltinCommonProperties=(t==null?void 0:t.ignoreBuiltInCommonProperties)??!1,this._additionalCommonProperties=t==null?void 0:t.additionalCommonProperties,this._sender=e,this._telemetryEnablements={isUsageEnabled:a.isUsageEnabled,isErrorsEnabled:a.isErrorsEnabled}}updateTelemetryEnablements(e,t){this._apiObject&&(this._telemetryEnablements={isUsageEnabled:e,isErrorsEnabled:t},this._onDidChangeEnableStates.fire(this._apiObject))}mixInCommonPropsAndCleanData(e){let t="properties"in e?e.properties??{}:e;return t=ele(t,[]),this._additionalCommonProperties&&(t=IM(t,this._additionalCommonProperties)),this._ignoreBuiltinCommonProperties||(t=IM(t,this._commonProperties)),"properties"in e?e.properties=t:e=t,e}logEvent(e,t){var r;this._sender&&(this._extension.publisher==="vscode"?e=this._extension.name+"/"+e:e=this._extension.identifier.value+"/"+e,t=this.mixInCommonPropsAndCleanData(t||{}),this._inLoggingOnlyMode||(r=this._sender)==null||r.sendEventData(e,t),this._logger.trace(e,t))}logUsage(e,t){this._telemetryEnablements.isUsageEnabled&&this.logEvent(e,t)}logError(e,t){if(!(!this._telemetryEnablements.isErrorsEnabled||!this._sender))if(typeof e=="string")this.logEvent(e,t);else{const r={name:e.name,message:e.message,stack:e.stack,cause:e.cause},i=ele(r,[]),o=new Error(i.message,{cause:i.cause});o.stack=i.stack,o.name=i.name,t=this.mixInCommonPropsAndCleanData(t||{}),this._inLoggingOnlyMode||this._sender.sendErrorData(o,t),this._logger.trace("exception",t)}}get apiTelemetryLogger(){if(!this._apiObject){const e=this,t={logUsage:e.logUsage.bind(e),get isUsageEnabled(){return e._telemetryEnablements.isUsageEnabled},get isErrorsEnabled(){return e._telemetryEnablements.isErrorsEnabled},logError:e.logError.bind(e),dispose:e.dispose.bind(e),onDidChangeEnableStates:e._onDidChangeEnableStates.event.bind(e)};this._apiObject=Object.freeze(t)}return this._apiObject}get isDisposed(){return!this._sender}dispose(){var e;if((e=this._sender)!=null&&e.flush){let t=this._sender;this._sender=void 0,Promise.resolve(t.flush()).then(t=void 0),this._apiObject=void 0}else this._sender=void 0}}function nHe(n){const e=Date.now()-new Date(n).getTime();return isNaN(e)?!1:e<1e3*60*60*24}const v9=go("IExtHostTelemetry");var Em,PT,kT,_2e;let NJ=(_2e=class{constructor(e,t,r){Tn(this,Em,void 0);Tn(this,PT,void 0);Tn(this,kT,void 0);this._commands=new Map,this._apiCommands=new Map,gn(this,Em,e.getProxy(dn.MainThreadCommands)),this._logService=t,gn(this,kT,r),gn(this,PT,e.getProxy(dn.MainThreadTelemetry)),this.converter=new zrn(this,i=>{const o=this._apiCommands.get(i);return(o==null?void 0:o.result)===ir.Void?o:void 0},t),this._argumentProcessors=[{processArgument(i){return EM(i)}},{processArgument(i){return tle(i,function(o){if(Sy.isIRange(o))return Rn.to(o);if(N2e.isIPosition(o))return io.to(o);if(Sy.isIRange(o.range)&&Te.isUri(o.uri))return CS.to(o);if(o instanceof ac)return o.buffer.buffer;if(!Array.isArray(o))return o})}}]}registerArgumentProcessor(e){this._argumentProcessors.push(e)}registerApiCommand(e){const t=this.registerCommand(!1,e.id,async(...r)=>{const i=e.args.map((s,a)=>{if(!s.validate(r[a]))throw new Error(`Invalid argument '${s.name}' when running '${e.id}', received: ${typeof r[a]=="object"?JSON.stringify(r[a],null,"	"):r[a]} `);return s.convert(r[a])}),o=await this.executeCommand(e.internalId,...i);return e.result.convert(o,r,this.converter)},void 0,{description:e.description,args:e.args,returns:e.result.description});return this._apiCommands.set(e.id,e),new pi(()=>{t.dispose(),this._apiCommands.delete(e.id)})}registerCommand(e,t,r,i,o,s){if(this._logService.trace("ExtHostCommands#registerCommand",t),!t.trim().length)throw new Error("invalid id");if(this._commands.has(t))throw new Error(`command '${t}' already exists`);return this._commands.set(t,{callback:r,thisArg:i,metadata:o,extension:s}),e&&Qe(this,Em).$registerCommand(t),new pi(()=>{this._commands.delete(t)&&e&&Qe(this,Em).$unregisterCommand(t)})}executeCommand(e,...t){return this._logService.trace("ExtHostCommands#executeCommand",e),this._doExecuteCommand(e,t,!0)}async _doExecuteCommand(e,t,r){if(this._commands.has(e))return Qe(this,Em).$fireCommandActivationEvent(e),this._executeContributedCommand(e,t,!1);{let i=!1;const o=tle(t,function(s){if(s instanceof Ah)return io.from(s);if(s instanceof _s)return Rn.from(s);if(s instanceof k2)return CS.from(s);if(e7.isNotebookRange(s))return J0.from(s);if(s instanceof ArrayBuffer)return i=!0,ac.wrap(new Uint8Array(s));if(s instanceof Uint8Array)return i=!0,ac.wrap(s);if(s instanceof ac)return i=!0,s;if(!Array.isArray(s))return s});try{const s=await Qe(this,Em).$executeCommand(e,i?new _y(o):o,r);return EM(s)}catch(s){if(s instanceof Error&&s.message==="$executeCommand:retry")return this._doExecuteCommand(e,t,!1);throw s}}}async _executeContributedCommand(e,t,r){var l,u,d;const i=this._commands.get(e);if(!i)throw new Error("Unknown command");const{callback:o,thisArg:s,metadata:a}=i;if(a!=null&&a.args)for(let h=0;h<a.args.length;h++)try{BGe(t[h],a.args[h].constraint)}catch{throw new Error(`Running the contributed command: '${e}' failed. Illegal argument '${a.args[h].name}' - ${a.args[h].description}`)}const c=E2.create();try{return await o.apply(s,t)}catch(h){if(e===this.converter.delegatingCommandId){const f=this.converter.getActualCommand(...t);f&&(e=f.command)}if(this._logService.error(h,e,(l=i.extension)==null?void 0:l.identifier),!r)throw h;if((u=i.extension)!=null&&u.identifier){const f=Qe(this,kT).onExtensionError(i.extension.identifier,h);this._logService.trace("forwarded error to extension?",f,(d=i.extension)==null?void 0:d.identifier)}throw new class extends Error{constructor(){var p,g;super(UT(h)),this.id=e,this.source=((p=i.extension)==null?void 0:p.displayName)??((g=i.extension)==null?void 0:g.name)}}}finally{this._reportTelemetry(i,e,c.elapsed())}}_reportTelemetry(e,t,r){e.extension&&Qe(this,PT).$publicLog2("Extension:ActionExecuted",{extensionId:e.extension.identifier.value,id:new cxe(t),duration:r})}$executeContributedCommand(e,...t){this._logService.trace("ExtHostCommands#$executeContributedCommand",e);const r=this._commands.get(e);return r?(t=t.map(i=>this._argumentProcessors.reduce((o,s)=>{var a;return s.processArgument(o,(a=r.extension)==null?void 0:a.identifier)},i)),this._executeContributedCommand(e,t,!0)):Promise.reject(new Error(`Contributed command '${e}' does not exist.`))}getCommands(e=!1){return this._logService.trace("ExtHostCommands#getCommands",e),Qe(this,Em).$getCommands().then(t=>(e&&(t=t.filter(r=>r[0]!=="_")),t))}$getContributedCommandMetadata(){const e=Object.create(null);for(const[t,r]of this._commands){const{metadata:i}=r;i&&(e[t]=i)}return Promise.resolve(e)}},Em=new WeakMap,PT=new WeakMap,kT=new WeakMap,_2e);NJ=An([Be(0,Ii),Be(1,Li),Be(2,v9)],NJ);const PE=go("IExtHostCommands");class zrn{constructor(e,t,r){this._commands=e,this._lookupApiCommand=t,this._logService=r,this.delegatingCommandId=`__vsc${Yx()}`,this._cache=new Map,this._cachIdPool=0,this._commands.registerCommand(!0,this.delegatingCommandId,this._executeConvertedCommand,this)}toInternal(e,t){if(!e)return;const r={$ident:void 0,id:e.command,title:e.title,tooltip:e.tooltip};if(!e.command)return r;const i=this._lookupApiCommand(e.command);if(i)r.id=i.internalId,r.arguments=i.args.map((o,s)=>o.convert(e.arguments&&e.arguments[s]));else if(KL(e.arguments)){const o=`${e.command} /${++this._cachIdPool}`;this._cache.set(o,e),t.add(ho(()=>{this._cache.delete(o),this._logService.trace("CommandsConverter#DISPOSE",o)})),r.$ident=o,r.id=this.delegatingCommandId,r.arguments=[o],this._logService.trace("CommandsConverter#CREATE",e.command,o)}return r}fromInternal(e){return typeof e.$ident=="string"?this._cache.get(e.$ident):{command:e.id,title:e.title,arguments:e.arguments}}getActualCommand(...e){return this._cache.get(e[0])}_executeConvertedCommand(...e){const t=this.getActualCommand(...e);return this._logService.trace("CommandsConverter#EXECUTE",e[0],t?t.command:"MISSING"),t?this._commands.executeCommand(t.command,...t.arguments||[]):Promise.reject(`Actual command not found, wanted to execute ${e[0]}`)}}const Ro=class Ro{static Arr(e){return new Ro(`${e.name}_array`,`Array of ${e.name}, ${e.description}`,t=>Array.isArray(t)&&t.every(r=>e.validate(r)),t=>t.map(r=>e.convert(r)))}constructor(e,t,r,i){this.name=e,this.description=t,this.validate=r,this.convert=i}optional(){return new Ro(this.name,`(optional) ${this.description}`,e=>e==null||this.validate(e),e=>e===void 0?void 0:e===null?null:this.convert(e))}with(e,t){return new Ro(e??this.name,t??this.description,this.validate,this.convert)}};Ro.Uri=new Ro("uri","Uri of a text document",e=>Te.isUri(e),e=>e),Ro.Position=new Ro("position","A position in a text document",e=>Ah.isPosition(e),io.from),Ro.Range=new Ro("range","A range in a text document",e=>_s.isRange(e),Rn.from),Ro.Selection=new Ro("selection","A selection in a text document",e=>P2.isSelection(e),eg.from),Ro.Number=new Ro("number","",e=>typeof e=="number",e=>e),Ro.String=new Ro("string","",e=>typeof e=="string",e=>e),Ro.StringArray=Ro.Arr(Ro.String),Ro.CallHierarchyItem=new Ro("item","A call hierarchy item",e=>e instanceof sxe,Dee.from),Ro.TypeHierarchyItem=new Ro("item","A type hierarchy item",e=>e instanceof axe,$P.from),Ro.TestItem=new Ro("testItem","A VS Code TestItem",e=>e instanceof __,qT.from);let jt=Ro;const CL=class CL{constructor(e,t){this.description=e,this.convert=t}};CL.Void=new CL("no result",e=>e);let ir=CL;class vr{constructor(e,t,r,i,o){this.id=e,this.internalId=t,this.description=r,this.args=i,this.result=o}}const FJ=new Map;function Vrn(n,e){e?FJ.set(n,e):FJ.delete(n)}function Wrn(n){return FJ.get(n)}class qrn extends jXe{constructor(e,t,r,i,o,s,a){super(t,r,i,o),this._proxy=e,this._languageId=s,this._isDirty=a,this._isDisposed=!1}dispose(){kf(!this._isDisposed),this._isDisposed=!0,this._isDirty=!1}equalLines(e){return qL(this._lines,e)}get document(){if(!this._document){const e=this;this._document={get uri(){return e._uri},get fileName(){return e._uri.fsPath},get isUntitled(){return e._uri.scheme===hr.untitled},get languageId(){return e._languageId},get version(){return e._versionId},get isClosed(){return e._isDisposed},get isDirty(){return e._isDirty},save(){return e._save()},getText(t){return t?e._getTextInRange(t):e.getText()},get eol(){return e._eol===`
`?Mk.LF:Mk.CRLF},get lineCount(){return e._lines.length},lineAt(t){return e._lineAt(t)},offsetAt(t){return e._offsetAt(t)},positionAt(t){return e._positionAt(t)},validateRange(t){return e._validateRange(t)},validatePosition(t){return e._validatePosition(t)},getWordRangeAtPosition(t,r){return e._getWordRangeAtPosition(t,r)}}}return Object.freeze(this._document)}_acceptLanguageId(e){kf(!this._isDisposed),this._languageId=e}_acceptIsDirty(e){kf(!this._isDisposed),this._isDirty=e}_save(){return this._isDisposed?Promise.reject(new Error("Document has been closed")):this._proxy.$trySaveDocument(this._uri)}_getTextInRange(e){const t=this._validateRange(e);if(t.isEmpty)return"";if(t.isSingleLine)return this._lines[t.start.line].substring(t.start.character,t.end.character);const r=this._eol,i=t.start.line,o=t.end.line,s=[];s.push(this._lines[i].substring(t.start.character));for(let a=i+1;a<o;a++)s.push(this._lines[a]);return s.push(this._lines[o].substring(0,t.end.character)),s.join(r)}_lineAt(e){let t;if(e instanceof Ah?t=e.line:typeof e=="number"&&(t=e),typeof t!="number"||t<0||t>=this._lines.length||Math.floor(t)!==t)throw new Error("Illegal value for `line`");return new Krn(t,this._lines[t],t===this._lines.length-1)}_offsetAt(e){return e=this._validatePosition(e),this._ensureLineStarts(),this._lineStarts.getPrefixSum(e.line-1)+e.character}_positionAt(e){e=Math.floor(e),e=Math.max(0,e),this._ensureLineStarts();const t=this._lineStarts.getIndexOf(e),r=this._lines[t.index].length;return new Ah(t.index,Math.min(t.remainder,r))}_validateRange(e){if(!(e instanceof _s))throw new Error("Invalid argument");const t=this._validatePosition(e.start),r=this._validatePosition(e.end);return t===e.start&&r===e.end?e:new _s(t.line,t.character,r.line,r.character)}_validatePosition(e){if(!(e instanceof Ah))throw new Error("Invalid argument");if(this._lines.length===0)return e.with(0,0);let{line:t,character:r}=e,i=!1;if(t<0)t=0,r=0,i=!0;else if(t>=this._lines.length)t=this._lines.length-1,r=this._lines[t].length,i=!0;else{const o=this._lines[t].length;r<0?(r=0,i=!0):r>o&&(r=o,i=!0)}return i?new Ah(t,r):e}_getWordRangeAtPosition(e,t){const r=this._validatePosition(e);if(!t)t=Wrn(this._languageId);else if(D2e(t))throw new Error(`[getWordRangeAtPosition]: ignoring custom regexp '${t.source}' because it matches the empty string.`);const i=BXe(r.character+1,HXe(t),this._lines[r.line],0);if(i)return new _s(r.line,i.startColumn-1,r.line,i.endColumn-1)}}class Krn{constructor(e,t,r){this._line=e,this._text=t,this._isLastLine=r}get lineNumber(){return this._line}get text(){return this._text}get range(){return new _s(this._line,0,this._line,this._text.length)}get rangeIncludingLineBreak(){return this._isLastLine?this.range:new _s(this._line,0,this._line+1,0)}get firstNonWhitespaceCharacterIndex(){return/^(\s*)/.exec(this._text)[1].length}get isEmptyOrWhitespace(){return this.firstNonWhitespaceCharacterIndex===this._text.length}}const xL=class xL{constructor(e,t,r){const i=xL._Keys.nextId();e.$registerTextEditorDecorationType(t.identifier,i,VXe.from(r)),this.value=Object.freeze({key:i,dispose(){e.$removeTextEditorDecorationType(i)}})}};xL._Keys=new Ree("TextEditorDecorationType");let jJ=xL;class Grn{constructor(e,t){this._collectedEdits=[],this._setEndOfLine=void 0,this._finalized=!1,this._document=e,this._documentVersionId=e.version,this._undoStopBefore=t.undoStopBefore,this._undoStopAfter=t.undoStopAfter}finalize(){return this._finalized=!0,{documentVersionId:this._documentVersionId,edits:this._collectedEdits,setEndOfLine:this._setEndOfLine,undoStopBefore:this._undoStopBefore,undoStopAfter:this._undoStopAfter}}_throwIfFinalized(){if(this._finalized)throw new Error("Edit is only valid while callback runs")}replace(e,t){this._throwIfFinalized();let r=null;if(e instanceof Ah)r=new _s(e,e);else if(e instanceof _s)r=e;else throw new Error("Unrecognized location");this._pushEdit(r,t,!1)}insert(e,t){this._throwIfFinalized(),this._pushEdit(new _s(e,e),t,!0)}delete(e){this._throwIfFinalized();let t=null;if(e instanceof _s)t=e;else throw new Error("Unrecognized location");this._pushEdit(t,null,!0)}_pushEdit(e,t,r){const i=this._document.validateRange(e);this._collectedEdits.push({range:i,text:t,forceMoveMarkers:r})}setEndOfLine(e){if(this._throwIfFinalized(),e!==Mk.LF&&e!==Mk.CRLF)throw yM("endOfLine");this._setEndOfLine=e}}class Zrn{constructor(e,t,r,i){this._proxy=e,this._id=t,this._accept(r),this._logService=i;const o=this;this.value={get tabSize(){return o._tabSize},set tabSize(s){o._setTabSize(s)},get indentSize(){return o._indentSize},set indentSize(s){o._setIndentSize(s)},get insertSpaces(){return o._insertSpaces},set insertSpaces(s){o._setInsertSpaces(s)},get cursorStyle(){return o._cursorStyle},set cursorStyle(s){o._setCursorStyle(s)},get lineNumbers(){return o._lineNumbers},set lineNumbers(s){o._setLineNumbers(s)}}}_accept(e){this._tabSize=e.tabSize,this._indentSize=e.indentSize,this._originalIndentSize=e.originalIndentSize,this._insertSpaces=e.insertSpaces,this._cursorStyle=e.cursorStyle,this._lineNumbers=s4.to(e.lineNumbers)}_validateTabSize(e){if(e==="auto")return"auto";if(typeof e=="number"){const t=Math.floor(e);return t>0?t:null}if(typeof e=="string"){const t=parseInt(e,10);return isNaN(t)?null:t>0?t:null}return null}_setTabSize(e){const t=this._validateTabSize(e);if(t!==null){if(typeof t=="number"){if(this._tabSize===t)return;this._tabSize=t}this._warnOnError("setTabSize",this._proxy.$trySetOptions(this._id,{tabSize:t}))}}_validateIndentSize(e){if(e==="tabSize")return"tabSize";if(typeof e=="number"){const t=Math.floor(e);return t>0?t:null}if(typeof e=="string"){const t=parseInt(e,10);return isNaN(t)?null:t>0?t:null}return null}_setIndentSize(e){const t=this._validateIndentSize(e);if(t!==null){if(typeof t=="number"){if(this._originalIndentSize===t)return;this._indentSize=t,this._originalIndentSize=t}this._warnOnError("setIndentSize",this._proxy.$trySetOptions(this._id,{indentSize:t}))}}_validateInsertSpaces(e){return e==="auto"?"auto":e==="false"?!1:!!e}_setInsertSpaces(e){const t=this._validateInsertSpaces(e);if(typeof t=="boolean"){if(this._insertSpaces===t)return;this._insertSpaces=t}this._warnOnError("setInsertSpaces",this._proxy.$trySetOptions(this._id,{insertSpaces:t}))}_setCursorStyle(e){this._cursorStyle!==e&&(this._cursorStyle=e,this._warnOnError("setCursorStyle",this._proxy.$trySetOptions(this._id,{cursorStyle:e})))}_setLineNumbers(e){this._lineNumbers!==e&&(this._lineNumbers=e,this._warnOnError("setLineNumbers",this._proxy.$trySetOptions(this._id,{lineNumbers:s4.from(e)})))}assign(e){const t={};let r=!1;if(typeof e.tabSize<"u"){const i=this._validateTabSize(e.tabSize);i==="auto"?(r=!0,t.tabSize=i):typeof i=="number"&&this._tabSize!==i&&(this._tabSize=i,r=!0,t.tabSize=i)}if(typeof e.indentSize<"u"){const i=this._validateIndentSize(e.indentSize);i==="tabSize"?(r=!0,t.indentSize=i):typeof i=="number"&&this._originalIndentSize!==i&&(this._indentSize=i,this._originalIndentSize=i,r=!0,t.indentSize=i)}if(typeof e.insertSpaces<"u"){const i=this._validateInsertSpaces(e.insertSpaces);i==="auto"?(r=!0,t.insertSpaces=i):this._insertSpaces!==i&&(this._insertSpaces=i,r=!0,t.insertSpaces=i)}typeof e.cursorStyle<"u"&&this._cursorStyle!==e.cursorStyle&&(this._cursorStyle=e.cursorStyle,r=!0,t.cursorStyle=e.cursorStyle),typeof e.lineNumbers<"u"&&this._lineNumbers!==e.lineNumbers&&(this._lineNumbers=e.lineNumbers,r=!0,t.lineNumbers=s4.from(e.lineNumbers)),r&&this._warnOnError("setOptions",this._proxy.$trySetOptions(this._id,t))}_warnOnError(e,t){t.catch(r=>{this._logService.warn(`ExtHostTextEditorOptions '${e}' failed:'`),this._logService.warn(r)})}}class Xrn{constructor(e,t,r,i,o,s,a,c){this.id=e,this._proxy=t,this._logService=r,this._disposed=!1,this._hasDecorationsForKey=new Set,this._selections=o,this._options=new Zrn(this._proxy,this.id,s,r),this._visibleRanges=a,this._viewColumn=c;const l=this;this.value=Object.freeze({get document(){return i.value},set document(u){throw new y1("document")},get selection(){return l._selections&&l._selections[0]},set selection(u){if(!(u instanceof P2))throw yM("selection");l._selections=[u],l._trySetSelection()},get selections(){return l._selections},set selections(u){if(!Array.isArray(u)||u.some(d=>!(d instanceof P2)))throw yM("selections");l._selections=u,l._trySetSelection()},get visibleRanges(){return l._visibleRanges},set visibleRanges(u){throw new y1("visibleRanges")},get options(){return l._options.value},set options(u){l._disposed||l._options.assign(u)},get viewColumn(){return l._viewColumn},set viewColumn(u){throw new y1("viewColumn")},edit(u,d={undoStopBefore:!0,undoStopAfter:!0}){if(l._disposed)return Promise.reject(new Error("TextEditor#edit not possible on closed editors"));const h=new Grn(i.value,d);return u(h),l._applyEdit(h)},insertSnippet(u,d,h={undoStopBefore:!0,undoStopAfter:!0}){if(l._disposed)return Promise.reject(new Error("TextEditor#insertSnippet not possible on closed editors"));let f;if(!d||Array.isArray(d)&&d.length===0)f=l._selections.map(p=>Rn.from(p));else if(d instanceof Ah){const{lineNumber:p,column:g}=io.from(d);f=[{startLineNumber:p,startColumn:g,endLineNumber:p,endColumn:g}]}else if(d instanceof _s)f=[Rn.from(d)];else{f=[];for(const p of d)if(p instanceof _s)f.push(Rn.from(p));else{const{lineNumber:g,column:m}=io.from(p);f.push({startLineNumber:g,startColumn:m,endLineNumber:g,endColumn:m})}}return t.$tryInsertSnippet(e,i.value.version,u.value,f,h)},setDecorations(u,d){const h=d.length===0;h&&!l._hasDecorationsForKey.has(u.key)||(h?l._hasDecorationsForKey.delete(u.key):l._hasDecorationsForKey.add(u.key),l._runOnProxy(()=>{if(UXe(d))return t.$trySetDecorations(e,u.key,zXe(d));{const f=new Array(4*d.length);for(let p=0,g=d.length;p<g;p++){const m=d[p];f[4*p]=m.start.line+1,f[4*p+1]=m.start.character+1,f[4*p+2]=m.end.line+1,f[4*p+3]=m.end.character+1}return t.$trySetDecorationsFast(e,u.key,f)}}))},revealRange(u,d){l._runOnProxy(()=>t.$tryRevealRange(e,Rn.from(u),d||lxe.Default))},show(u){t.$tryShowEditor(e,Ma.from(u))},hide(){t.$tryHideEditor(e)}})}dispose(){kf(!this._disposed),this._disposed=!0}_acceptOptions(e){kf(!this._disposed),this._options._accept(e)}_acceptVisibleRanges(e){kf(!this._disposed),this._visibleRanges=e}_acceptViewColumn(e){kf(!this._disposed),this._viewColumn=e}_acceptSelections(e){kf(!this._disposed),this._selections=e}async _trySetSelection(){const e=this._selections.map(eg.from);return await this._runOnProxy(()=>this._proxy.$trySetSelections(this.id,e)),this.value}_applyEdit(e){const t=e.finalize();if(t.edits.length===0&&!t.setEndOfLine)return Promise.resolve(!0);const r=t.edits.map(o=>o.range);r.sort((o,s)=>o.end.line===s.end.line?o.end.character===s.end.character?o.start.line===s.start.line?o.start.character-s.start.character:o.start.line-s.start.line:o.end.character-s.end.character:o.end.line-s.end.line);for(let o=0,s=r.length-1;o<s;o++){const a=r[o].end;if(r[o+1].start.isBefore(a))return Promise.reject(new Error("Overlapping ranges are not allowed!"))}const i=t.edits.map(o=>({range:Rn.from(o.range),text:o.text,forceMoveMarkers:o.forceMoveMarkers}));return this._proxy.$tryApplyEdits(this.id,t.documentVersionId,i,{setEndOfLine:typeof t.setEndOfLine=="number"?uxe.from(t.setEndOfLine):void 0,undoStopBefore:t.undoStopBefore,undoStopAfter:t.undoStopAfter})}_runOnProxy(e){return this._disposed?(this._logService.warn("TextEditor is closed/disposed"),Promise.resolve(void 0)):e().then(()=>this,t=>(t instanceof Error&&t.name==="DISPOSED"||this._logService.warn(t),null))}}class Yrn{constructor(e){this.value=e,this._count=0}ref(){this._count++}unref(){return--this._count===0}}let BJ=class{constructor(e,t){this._extHostRpc=e,this._logService=t,this._activeEditorId=null,this._editors=new Map,this._documents=new Wl,this._onDidAddDocuments=new ft,this._onDidRemoveDocuments=new ft,this._onDidChangeVisibleTextEditors=new ft,this._onDidChangeActiveTextEditor=new ft,this.onDidAddDocuments=this._onDidAddDocuments.event,this.onDidRemoveDocuments=this._onDidRemoveDocuments.event,this.onDidChangeVisibleTextEditors=this._onDidChangeVisibleTextEditors.event,this.onDidChangeActiveTextEditor=this._onDidChangeActiveTextEditor.event}$acceptDocumentsAndEditorsDelta(e){this.acceptDocumentsAndEditorsDelta(e)}acceptDocumentsAndEditorsDelta(e){const t=[],r=[],i=[];if(e.removedDocuments)for(const o of e.removedDocuments){const s=Te.revive(o),a=this._documents.get(s);a!=null&&a.unref()&&(this._documents.delete(s),t.push(a.value))}if(e.addedDocuments)for(const o of e.addedDocuments){const s=Te.revive(o.uri);let a=this._documents.get(s);if(a&&s.scheme!==hr.vscodeNotebookCell&&s.scheme!==hr.vscodeInteractiveInput)throw new Error(`document '${s} already exists!'`);a||(a=new Yrn(new qrn(this._extHostRpc.getProxy(dn.MainThreadDocuments),s,o.lines,o.EOL,o.versionId,o.languageId,o.isDirty)),this._documents.set(s,a),r.push(a.value)),a.ref()}if(e.removedEditors)for(const o of e.removedEditors){const s=this._editors.get(o);this._editors.delete(o),s&&i.push(s)}if(e.addedEditors)for(const o of e.addedEditors){const s=Te.revive(o.documentUri);kf(this._documents.has(s),`document '${s}' does not exist`),kf(!this._editors.has(o.id),`editor '${o.id}' already exists!`);const a=this._documents.get(s).value,c=new Xrn(o.id,this._extHostRpc.getProxy(dn.MainThreadTextEditors),this._logService,new MP(()=>a.document),o.selections.map(eg.to),o.options,o.visibleRanges.map(l=>Rn.to(l)),typeof o.editorPosition=="number"?Ma.to(o.editorPosition):void 0);this._editors.set(o.id,c)}e.newActiveEditor!==void 0&&(kf(e.newActiveEditor===null||this._editors.has(e.newActiveEditor),`active editor '${e.newActiveEditor}' does not exist`),this._activeEditorId=e.newActiveEditor),_S(t),_S(i),e.removedDocuments&&this._onDidRemoveDocuments.fire(t),e.addedDocuments&&this._onDidAddDocuments.fire(r),(e.removedEditors||e.addedEditors)&&this._onDidChangeVisibleTextEditors.fire(this.allEditors().map(o=>o.value)),e.newActiveEditor!==void 0&&this._onDidChangeActiveTextEditor.fire(this.activeEditor())}getDocument(e){var t;return(t=this._documents.get(e))==null?void 0:t.value}allDocuments(){return uee.map(this._documents.values(),e=>e.value)}getEditor(e){return this._editors.get(e)}activeEditor(e){if(!this._activeEditorId)return;const t=this._editors.get(this._activeEditorId);return e?t:t==null?void 0:t.value}allEditors(){return[...this._editors.values()]}};BJ=An([Be(0,Ii),Be(1,Li)],BJ);const iR=go("IExtHostDocumentsAndEditors"),Jrn="vs/workbench/api/common/extHostTerminalService",kE=go("IExtHostTerminalService");class Qwe extends Dr{constructor(e,t,r,i){super(),this._proxy=e,this._id=t,this._creationOptions=r,this._name=i,this._disposed=!1,this._state={isInteractedWith:!1},this.isOpen=!1,this._onWillDispose=this._register(new ft),this.onWillDispose=this._onWillDispose.event,this._creationOptions=Object.freeze(this._creationOptions),this._pidPromise=new Promise(s=>this._pidPromiseComplete=s);const o=this;this.value={get name(){return o._name||""},get processId(){return o._pidPromise},get creationOptions(){return o._creationOptions},get exitStatus(){return o._exitStatus},get state(){return o._state},get selection(){return o._selection},get shellIntegration(){return o.shellIntegration},sendText(s,a=!0){o._checkDisposed(),o._proxy.$sendText(o._id,s,a)},show(s){o._checkDisposed(),o._proxy.$show(o._id,s)},hide(){o._checkDisposed(),o._proxy.$hide(o._id)},dispose(){o._disposed||(o._disposed=!0,o._proxy.$dispose(o._id))},get dimensions(){if(!(o._cols===void 0||o._rows===void 0))return{columns:o._cols,rows:o._rows}}}}dispose(){this._onWillDispose.fire(),super.dispose()}async create(e,t){if(typeof this._id!="string")throw new Error("Terminal has already been created");await this._proxy.$createTerminal(this._id,{name:e.name,shellPath:e.shellPath??void 0,shellArgs:e.shellArgs??void 0,cwd:e.cwd??(t==null?void 0:t.cwd)??void 0,env:e.env??void 0,icon:rHe(e.iconPath)??void 0,color:yW.isThemeColor(e.color)?e.color.id:void 0,initialText:e.message??void 0,strictEnv:e.strictEnv??void 0,hideFromUser:e.hideFromUser??void 0,forceShellIntegration:(t==null?void 0:t.forceShellIntegration)??void 0,isFeatureTerminal:(t==null?void 0:t.isFeatureTerminal)??void 0,isExtensionOwnedTerminal:!0,useShellEnvironment:(t==null?void 0:t.useShellEnvironment)??void 0,location:(t==null?void 0:t.location)||this._serializeParentTerminal(e.location,t==null?void 0:t.resolvedExtHostIdentifier),isTransient:e.isTransient??void 0})}async createExtensionTerminal(e,t,r,i,o){if(typeof this._id!="string")throw new Error("Terminal has already been created");if(await this._proxy.$createTerminal(this._id,{name:this._name,isExtensionCustomPtyTerminal:!0,icon:i,color:yW.isThemeColor(o)?o.id:void 0,location:(t==null?void 0:t.location)||this._serializeParentTerminal(e,r),isTransient:!0}),typeof this._id=="string")throw new Error("Terminal creation failed");return this._id}_serializeParentTerminal(e,t){return typeof e=="object"?"parentTerminal"in e&&e.parentTerminal&&t?{parentTerminal:t}:"viewColumn"in e?{viewColumn:Ma.from(e.viewColumn),preserveFocus:e.preserveFocus}:void 0:e}_checkDisposed(){if(this._disposed)throw new Error("Terminal has already been disposed")}set name(e){this._name=e}setExitStatus(e,t){this._exitStatus=Object.freeze({code:e,reason:t})}setDimensions(e,t){return e===this._cols&&t===this._rows||e===0||t===0?!1:(this._cols=e,this._rows=t,!0)}setInteractedWith(){return this._state.isInteractedWith?!1:(this._state={isInteractedWith:!0},!0)}setSelection(e){this._selection=e}_setProcessId(e){this._pidPromiseComplete?(this._pidPromiseComplete(e),this._pidPromiseComplete=void 0):this._pidPromise.then(t=>{t!==e&&(this._pidPromise=Promise.resolve(e))})}}class dV{get onProcessReady(){return this._onProcessReady.event}constructor(e){this._pty=e,this.id=0,this.shouldPersist=!1,this._onProcessData=new ft,this.onProcessData=this._onProcessData.event,this._onProcessReady=new ft,this._onDidChangeProperty=new ft,this.onDidChangeProperty=this._onDidChangeProperty.event,this._onProcessExit=new ft,this.onProcessExit=this._onProcessExit.event}refreshProperty(e){throw new Error(`refreshProperty is not suppported in extension owned terminals. property: ${e}`)}updateProperty(e,t){throw new Error(`updateProperty is not suppported in extension owned terminals. property: ${e}, value: ${t}`)}async start(){}shutdown(){this._pty.close()}input(e){var t,r;(r=(t=this._pty).handleInput)==null||r.call(t,e)}resize(e,t){var r,i;(i=(r=this._pty).setDimensions)==null||i.call(r,{columns:e,rows:t})}clearBuffer(){}async processBinary(e){}acknowledgeDataEvent(e){}async setUnicodeVersion(e){}getInitialCwd(){return Promise.resolve("")}getCwd(){return Promise.resolve("")}startSendingEvents(e){var t,r,i,o,s,a,c,l;this._pty.onDidWrite(u=>this._onProcessData.fire(u)),(r=(t=this._pty).onDidClose)==null||r.call(t,(u=void 0)=>{this._onProcessExit.fire(u===void 0?void 0:u)}),(o=(i=this._pty).onDidOverrideDimensions)==null||o.call(i,u=>{u&&this._onDidChangeProperty.fire({type:"overrideDimensions",value:{cols:u.columns,rows:u.rows}})}),(a=(s=this._pty).onDidChangeName)==null||a.call(s,u=>{this._onDidChangeProperty.fire({type:"title",value:u})}),this._pty.open(e||void 0),e&&((l=(c=this._pty).setDimensions)==null||l.call(c,e)),this._onProcessReady.fire({pid:-1,cwd:"",windowsPty:void 0})}}let Qrn=1,HJ=class extends Dr{get activeTerminal(){var e;return(e=this._activeTerminal)==null?void 0:e.value}get terminals(){return this._terminals.map(e=>e.value)}constructor(e,t,r){super(),this._extHostCommands=t,this._terminals=[],this._terminalProcesses=new Map,this._terminalProcessDisposables={},this._extensionTerminalAwaitingStart={},this._getTerminalPromises={},this._environmentVariableCollections=new Map,this._lastQuickFixCommands=this._register(new zp),this._linkProviders=new Set,this._profileProviders=new Map,this._quickFixProviders=new Map,this._terminalLinkCache=new Map,this._terminalLinkCancellationSource=new Map,this._onDidCloseTerminal=new ft,this.onDidCloseTerminal=this._onDidCloseTerminal.event,this._onDidOpenTerminal=new ft,this.onDidOpenTerminal=this._onDidOpenTerminal.event,this._onDidChangeActiveTerminal=new ft,this.onDidChangeActiveTerminal=this._onDidChangeActiveTerminal.event,this._onDidChangeTerminalDimensions=new ft,this.onDidChangeTerminalDimensions=this._onDidChangeTerminalDimensions.event,this._onDidChangeTerminalState=new ft,this.onDidChangeTerminalState=this._onDidChangeTerminalState.event,this._onDidChangeShell=new ft,this.onDidChangeShell=this._onDidChangeShell.event,this._onDidWriteTerminalData=new ft({onWillAddFirstListener:()=>this._proxy.$startSendingDataEvents(),onDidRemoveLastListener:()=>this._proxy.$stopSendingDataEvents()}),this.onDidWriteTerminalData=this._onDidWriteTerminalData.event,this._onDidExecuteCommand=new ft({onWillAddFirstListener:()=>this._proxy.$startSendingCommandEvents(),onDidRemoveLastListener:()=>this._proxy.$stopSendingCommandEvents()}),this.onDidExecuteTerminalCommand=this._onDidExecuteCommand.event,this._proxy=r.getProxy(dn.MainThreadTerminalService),this._bufferer=new WXe(this._proxy.$sendProcessData),this._proxy.$registerProcessSupport(e),this._extHostCommands.registerArgumentProcessor({processArgument:i=>{const o=s=>{var c;const a=s;return(c=this.getTerminalById(a.instanceId))==null?void 0:c.value};switch(i==null?void 0:i.$mid){case 15:return o(i);default:{if(Array.isArray(i))for(let s=0;s<i.length&&i[s].$mid===15;s++)i[s]=o(i[s]);return i}}}}),this._register({dispose:()=>{for(const[i,o]of this._terminalProcesses)o.shutdown(!0)}})}getDefaultShell(e){const t=e?this._defaultAutomationProfile:this._defaultProfile;return(t==null?void 0:t.path)||""}getDefaultShellArgs(e){const t=e?this._defaultAutomationProfile:this._defaultProfile;return(t==null?void 0:t.args)||[]}createExtensionTerminal(e,t){const r=new Qwe(this._proxy,Yx(),e,e.name),i=new dV(e.pty);return r.createExtensionTerminal(e.location,t,this._serializeParentTerminal(e,t).resolvedExtHostIdentifier,rHe(e.iconPath),tin(e.color)).then(o=>{const s=this._setupExtHostProcessListeners(o,i);this._terminalProcessDisposables[o]=s}),this._terminals.push(r),r.value}_serializeParentTerminal(e,t){if(t=t||{},e.location&&typeof e.location=="object"&&"parentTerminal"in e.location){const r=e.location.parentTerminal;if(r){const i=this._terminals.find(o=>o.value===r);i&&(t.resolvedExtHostIdentifier=i._id)}}else e.location&&typeof e.location!="object"?t.location=e.location:t.location&&typeof t.location=="object"&&"splitActiveTerminal"in t.location&&(t.location={splitActiveTerminal:!0});return t}attachPtyToTerminal(e,t){if(!this.getTerminalById(e))throw new Error(`Cannot resolve terminal with id ${e} for virtual process`);const i=new dV(t),o=this._setupExtHostProcessListeners(e,i);this._terminalProcessDisposables[e]=o}async $acceptActiveTerminalChanged(e){const t=this._activeTerminal;if(e===null){this._activeTerminal=void 0,t!==this._activeTerminal&&this._onDidChangeActiveTerminal.fire(this._activeTerminal);return}const r=this.getTerminalById(e);r&&(this._activeTerminal=r,t!==this._activeTerminal&&this._onDidChangeActiveTerminal.fire(this._activeTerminal.value))}async $acceptTerminalProcessData(e,t){const r=this.getTerminalById(e);r&&this._onDidWriteTerminalData.fire({terminal:r.value,data:t})}async $acceptTerminalDimensions(e,t,r){const i=this.getTerminalById(e);i&&i.setDimensions(t,r)&&this._onDidChangeTerminalDimensions.fire({terminal:i.value,dimensions:i.value.dimensions})}async $acceptDidExecuteCommand(e,t){const r=this.getTerminalById(e);r&&this._onDidExecuteCommand.fire({terminal:r.value,...t})}async $acceptTerminalMaximumDimensions(e,t,r){var i;(i=this._terminalProcesses.get(e))==null||i.resize(t,r)}async $acceptTerminalTitleChange(e,t){const r=this.getTerminalById(e);r&&(r.name=t)}async $acceptTerminalClosed(e,t,r){const i=this._getTerminalObjectIndexById(this._terminals,e);if(i!==null){const o=this._terminals.splice(i,1)[0];o.setExitStatus(t,r),this._onDidCloseTerminal.fire(o.value)}}$acceptTerminalOpened(e,t,r,i){if(t){const a=this._getTerminalObjectIndexById(this._terminals,t);if(a!==null){this._terminals[a]._id=e,this._onDidOpenTerminal.fire(this.terminals[a]),this._terminals[a].isOpen=!0;return}}const o={name:i.name,shellPath:i.executable,shellArgs:i.args,cwd:typeof i.cwd=="string"?i.cwd:Te.revive(i.cwd),env:i.env,hideFromUser:i.hideFromUser},s=new Qwe(this._proxy,e,o,r);this._terminals.push(s),this._onDidOpenTerminal.fire(s.value),s.isOpen=!0}async $acceptTerminalProcessId(e,t){const r=this.getTerminalById(e);r==null||r._setProcessId(t)}async $startExtensionTerminal(e,t){const r=this.getTerminalById(e);if(!r)return{message:Ve(Jrn,0,"Could not find the terminal with id {0} on the extension host",e)};r.isOpen||await new Promise(o=>{const s=this.onDidOpenTerminal(async a=>{a===r.value&&(s.dispose(),o())})});const i=this._terminalProcesses.get(e);i?i.startSendingEvents(t):this._extensionTerminalAwaitingStart[e]={initialDimensions:t}}_setupExtHostProcessListeners(e,t){const r=new ei;r.add(t.onProcessReady(o=>this._proxy.$sendProcessReady(e,o.pid,o.cwd,o.windowsPty))),r.add(t.onDidChangeProperty(o=>this._proxy.$sendProcessProperty(e,o))),this._bufferer.startBuffering(e,t.onProcessData),r.add(t.onProcessExit(o=>this._onProcessExit(e,o))),this._terminalProcesses.set(e,t);const i=this._extensionTerminalAwaitingStart[e];return i&&t instanceof dV&&(t.startSendingEvents(i.initialDimensions),delete this._extensionTerminalAwaitingStart[e]),r}$acceptProcessAckDataEvent(e,t){var r;(r=this._terminalProcesses.get(e))==null||r.acknowledgeDataEvent(t)}$acceptProcessInput(e,t){var r;(r=this._terminalProcesses.get(e))==null||r.input(t)}$acceptTerminalInteraction(e){const t=this.getTerminalById(e);t!=null&&t.setInteractedWith()&&this._onDidChangeTerminalState.fire(t.value)}$acceptTerminalSelection(e,t){var r;(r=this.getTerminalById(e))==null||r.setSelection(t)}$acceptProcessResize(e,t,r){var i;try{(i=this._terminalProcesses.get(e))==null||i.resize(t,r)}catch(o){if(o.code!=="EPIPE"&&o.code!=="ERR_IPC_CHANNEL_CLOSED")throw o}}$acceptProcessShutdown(e,t){var r;(r=this._terminalProcesses.get(e))==null||r.shutdown(t)}$acceptProcessRequestInitialCwd(e){var t;(t=this._terminalProcesses.get(e))==null||t.getInitialCwd().then(r=>this._proxy.$sendProcessProperty(e,{type:"initialCwd",value:r}))}$acceptProcessRequestCwd(e){var t;(t=this._terminalProcesses.get(e))==null||t.getCwd().then(r=>this._proxy.$sendProcessProperty(e,{type:"cwd",value:r}))}$acceptProcessRequestLatency(e){return Promise.resolve(e)}registerLinkProvider(e){return this._linkProviders.add(e),this._linkProviders.size===1&&this._proxy.$startLinkProvider(),new pi(()=>{this._linkProviders.delete(e),this._linkProviders.size===0&&this._proxy.$stopLinkProvider()})}registerProfileProvider(e,t,r){if(this._profileProviders.has(t))throw new Error(`Terminal profile provider "${t}" already registered`);return this._profileProviders.set(t,r),this._proxy.$registerProfileProvider(t,e.identifier.value),new pi(()=>{this._profileProviders.delete(t),this._proxy.$unregisterProfileProvider(t)})}registerTerminalQuickFixProvider(e,t,r){if(this._quickFixProviders.has(e))throw new Error(`Terminal quick fix provider "${e}" is already registered`);return this._quickFixProviders.set(e,r),this._proxy.$registerQuickFixProvider(e,t),new pi(()=>{this._quickFixProviders.delete(e),this._proxy.$unregisterQuickFixProvider(e)})}async $provideTerminalQuickFixes(e,t){const r=new Uc().token;if(r.isCancellationRequested)return;const i=this._quickFixProviders.get(e);if(!i)return;const o=await i.provideTerminalQuickFixes(t,r);if(o===null||Array.isArray(o)&&o.length===0)return;const s=new ei;if(this._lastQuickFixCommands.value=s,!Array.isArray(o))return o?nle.from(o,this._extHostCommands.converter,s):void 0;const a=[];for(const c of o){const l=nle.from(c,this._extHostCommands.converter,s);l&&a.push(l)}return a}async $createContributedProfileTerminal(e,t){var o;const r=new Uc().token;let i=await((o=this._profileProviders.get(e))==null?void 0:o.provideTerminalProfile(r));if(!r.isCancellationRequested){if(i&&!("options"in i)&&(i={options:i}),!i||!("options"in i))throw new Error(`No terminal profile options provided for id "${e}"`);if("pty"in i.options){this.createExtensionTerminal(i.options,t);return}this.createTerminalFromOptions(i.options,t)}}async $provideLinks(e,t){const r=this.getTerminalById(e);if(!r)return[];this._terminalLinkCache.delete(e);const i=this._terminalLinkCancellationSource.get(e);i==null||i.dispose(!0);const o=new Uc;this._terminalLinkCancellationSource.set(e,o);const s=[],a={terminal:r.value,line:t},c=[];for(const d of this._linkProviders)c.push(pW.withAsyncBody(async h=>{o.token.onCancellationRequested(()=>h({provider:d,links:[]}));const f=await d.provideTerminalLinks(a,o.token)||[];o.token.isCancellationRequested||h({provider:d,links:f})}));const l=await Promise.all(c);if(o.token.isCancellationRequested)return[];const u=new Map;for(const d of l)d&&d.links.length>0&&s.push(...d.links.map(h=>{const f={id:Qrn++,startIndex:h.startIndex,length:h.length,label:h.tooltip};return u.set(f.id,{provider:d.provider,link:h}),f}));return this._terminalLinkCache.set(e,u),s}$activateLink(e,t){var i;const r=(i=this._terminalLinkCache.get(e))==null?void 0:i.get(t);r&&r.provider.handleTerminalLink(r.link)}_onProcessExit(e,t){this._bufferer.stopBuffering(e),this._terminalProcesses.delete(e),delete this._extensionTerminalAwaitingStart[e];const r=this._terminalProcessDisposables[e];r&&(r.dispose(),delete this._terminalProcessDisposables[e]),this._proxy.$sendProcessExit(e,t)}getTerminalById(e){return this._getTerminalObjectById(this._terminals,e)}getTerminalIdByApiObject(e){const t=this._terminals.findIndex(r=>r.value===e);return t>=0?t:null}_getTerminalObjectById(e,t){const r=this._getTerminalObjectIndexById(e,t);return r!==null?e[r]:null}_getTerminalObjectIndexById(e,t){const r=e.findIndex(i=>i._id===t);return r>=0?r:null}getEnvironmentVariableCollection(e){let t=this._environmentVariableCollections.get(e.identifier.value);return t||(t=new eCe,this._setEnvironmentVariableCollection(e.identifier.value,t)),t.getScopedEnvironmentVariableCollection(void 0)}_syncEnvironmentVariableCollection(e,t){const r=qXe(t.map),i=KXe(t.descriptionMap);this._proxy.$setEnvironmentVariableCollection(e,t.persistent,r.length===0?void 0:r,i)}$initEnvironmentVariableCollections(e){e.forEach(t=>{const r=t[0],i=new eCe(t[1]);this._setEnvironmentVariableCollection(r,i)})}$acceptDefaultProfile(e,t){const r=this._defaultProfile;this._defaultProfile=e,this._defaultAutomationProfile=t,(r==null?void 0:r.path)!==e.path&&this._onDidChangeShell.fire(e.path)}_setEnvironmentVariableCollection(e,t){this._environmentVariableCollections.set(e,t),t.onDidChangeCollection(()=>{this._syncEnvironmentVariableCollection(e,t)})}};HJ=An([Be(1,PE),Be(2,Ii)],HJ);class eCe{get persistent(){return this._persistent}set persistent(e){this._persistent=e,this._onDidChangeCollection.fire()}get onDidChangeCollection(){return this._onDidChangeCollection&&this._onDidChangeCollection.event}constructor(e){this.map=new Map,this.scopedCollections=new Map,this.descriptionMap=new Map,this._persistent=!0,this._onDidChangeCollection=new ft,this.map=new Map(e)}getScopedEnvironmentVariableCollection(e){const t=this.getScopeKey(e);let r=this.scopedCollections.get(t);return r||(r=new ein(this,e),this.scopedCollections.set(t,r),r.onDidChangeCollection(()=>this._onDidChangeCollection.fire())),r}replace(e,t,r,i){this._setIfDiffers(e,{value:t,type:a4.Replace,options:r??{applyAtProcessCreation:!0},scope:i})}append(e,t,r,i){this._setIfDiffers(e,{value:t,type:a4.Append,options:r??{applyAtProcessCreation:!0},scope:i})}prepend(e,t,r,i){this._setIfDiffers(e,{value:t,type:a4.Prepend,options:r??{applyAtProcessCreation:!0},scope:i})}_setIfDiffers(e,t){var s,a,c,l,u,d;if(t.options&&t.options.applyAtProcessCreation===!1&&!t.options.applyAtShellIntegration)throw new Error("EnvironmentVariableMutatorOptions must apply at either process creation or shell integration");const r=this.getKey(e,t.scope),i=this.map.get(r),o=t.options?{applyAtProcessCreation:t.options.applyAtProcessCreation??!1,applyAtShellIntegration:t.options.applyAtShellIntegration??!1}:{applyAtProcessCreation:!0};if(!i||i.value!==t.value||i.type!==t.type||((s=i.options)==null?void 0:s.applyAtProcessCreation)!==o.applyAtProcessCreation||((a=i.options)==null?void 0:a.applyAtShellIntegration)!==o.applyAtShellIntegration||((l=(c=i.scope)==null?void 0:c.workspaceFolder)==null?void 0:l.index)!==((d=(u=t.scope)==null?void 0:u.workspaceFolder)==null?void 0:d.index)){const h=this.getKey(e,t.scope),f={variable:e,...t,options:o};this.map.set(h,f),this._onDidChangeCollection.fire()}}get(e,t){const r=this.getKey(e,t),i=this.map.get(r);return i?tCe(i):void 0}getKey(e,t){const r=this.getScopeKey(t);return r.length?`${e}:::${r}`:e}getScopeKey(e){return this.getWorkspaceKey(e==null?void 0:e.workspaceFolder)??""}getWorkspaceKey(e){return e?e.uri.toString():void 0}getVariableMap(e){const t=new Map;for(const[r,i]of this.map)this.getScopeKey(i.scope)===this.getScopeKey(e)&&t.set(i.variable,tCe(i));return t}delete(e,t){const r=this.getKey(e,t);this.map.delete(r),this._onDidChangeCollection.fire()}clear(e){var t,r;if(e!=null&&e.workspaceFolder){for(const[i,o]of this.map)((r=(t=o.scope)==null?void 0:t.workspaceFolder)==null?void 0:r.index)===e.workspaceFolder.index&&this.map.delete(i);this.clearDescription(e)}else this.map.clear(),this.descriptionMap.clear();this._onDidChangeCollection.fire()}setDescription(e,t){const r=this.getScopeKey(t),i=this.descriptionMap.get(r);if(!i||i.description!==e){let o;typeof e=="string"?o=e:o=e==null?void 0:e.value.split(`

`)[0];const s={description:o,scope:t};this.descriptionMap.set(r,s),this._onDidChangeCollection.fire()}}getDescription(e){var r;const t=this.getScopeKey(e);return(r=this.descriptionMap.get(t))==null?void 0:r.description}clearDescription(e){const t=this.getScopeKey(e);this.descriptionMap.delete(t)}}class ein{get persistent(){return this.collection.persistent}set persistent(e){this.collection.persistent=e}get onDidChangeCollection(){return this._onDidChangeCollection&&this._onDidChangeCollection.event}constructor(e,t){this.collection=e,this.scope=t,this._onDidChangeCollection=new ft}getScoped(e){return this.collection.getScopedEnvironmentVariableCollection(e)}replace(e,t,r){this.collection.replace(e,t,r,this.scope)}append(e,t,r){this.collection.append(e,t,r,this.scope)}prepend(e,t,r){this.collection.prepend(e,t,r,this.scope)}get(e){return this.collection.get(e,this.scope)}forEach(e,t){this.collection.getVariableMap(this.scope).forEach((r,i)=>e.call(t,i,r,this),this.scope)}[Symbol.iterator](){return this.collection.getVariableMap(this.scope).entries()}delete(e){this.collection.delete(e,this.scope),this._onDidChangeCollection.fire(void 0)}clear(){this.collection.clear(this.scope)}set description(e){this.collection.setDescription(e,this.scope)}get description(){return this.collection.getDescription(this.scope)}}let UJ=class extends HJ{constructor(e,t){super(!1,e,t)}createTerminal(e,t,r){throw new tW}createTerminalFromOptions(e,t){throw new tW}};UJ=An([Be(0,PE),Be(1,Ii)],UJ);function rHe(n){if(!(!n||typeof n=="string"))return"id"in n?{id:n.id,color:n.color}:n}function tin(n){return yW.isThemeColor(n)?n:void 0}function tCe(n){const e={...n};return delete e.scope,e.options=e.options??void 0,delete e.variable,e}const y9=go("IExtHostApiDeprecationService");let zJ=class{constructor(e,t){this._extHostLogService=t,this._reportedUsages=new Set,this._telemetryShape=e.getProxy(dn.MainThreadTelemetry)}report(e,t,r){const i=this.getUsageKey(e,t);this._reportedUsages.has(i)||(this._reportedUsages.add(i),t.isUnderDevelopment&&this._extHostLogService.warn(`[Deprecation Warning] '${e}' is deprecated. ${r}`),this._telemetryShape.$publicLog2("extHostDeprecatedApiUsage",{extensionId:t.identifier.value,apiId:e}))}getUsageKey(e,t){return`${e}-${t.identifier.value}`}};zJ=An([Be(0,Ii),Be(1,Li)],zJ);var aL;(function(n){function e(r){if(r!=null)return r}n.from=e;function t(r){if(r!=null)return r}n.to=t})(aL||(aL={}));var cL;(function(n){function e(r){if(r!=null)return r}n.from=e;function t(r){if(r!=null)return r}n.to=t})(cL||(cL={}));var VJ;(function(n){function e(r){if(r!=null)return r}n.from=e;function t(r){if(r!=null)return r}n.to=t})(VJ||(VJ={}));var _k;(function(n){function e(i){if(i){const o=i;return o&&!!o.process}else return!1}n.is=e;function t(i){if(i==null)return;const o={process:i.process,args:i.args};return i.options&&(o.options=VJ.from(i.options)),o}n.from=t;function r(i){if(i!=null)return new Aee(i.process,i.args,i.options)}n.to=r})(_k||(_k={}));var WJ;(function(n){function e(r){if(r!=null)return r}n.from=e;function t(r){if(r!=null)return r}n.to=t})(WJ||(WJ={}));var wk;(function(n){function e(i){if(i){const o=i;return o&&(!!o.commandLine||!!o.command)}else return!1}n.is=e;function t(i){if(i==null)return;const o={};return i.commandLine!==void 0?o.commandLine=i.commandLine:(o.command=i.command,o.args=i.args),i.options&&(o.options=WJ.from(i.options)),o}n.from=t;function r(i){if(!(i==null||i.command===void 0&&i.commandLine===void 0))return i.commandLine?new PM(i.commandLine,i.options):new PM(i.command,i.args?i.args:[],i.options)}n.to=r})(wk||(wk={}));var rv;(function(n){function e(i){if(i){const o=i;return o&&o.customExecution==="customExecution"}else return!1}n.is=e;function t(i){return{customExecution:"customExecution"}}n.from=t;function r(i,o){return o.get(i)}n.to=r})(rv||(rv={}));var qJ;(function(n){function e(t){if(t!=null)return{_id:t.id,isDefault:t.isDefault}}n.from=e})(qJ||(qJ={}));var Z0;(function(n){function e(i,o){if(i==null)return[];const s=[];for(const a of i){const c=t(a,o);c&&s.push(c)}return s}n.fromMany=e;function t(i,o){if(i==null)return;let s;i.execution instanceof Aee?s=_k.from(i.execution):i.execution instanceof PM?s=wk.from(i.execution):i.execution&&i.execution instanceof dxe&&(s=rv.from(i.execution));const a=aL.from(i.definition);let c;return i.scope?typeof i.scope=="number"?c=i.scope:c=i.scope.uri:c=bW.Workspace,!a||!c?void 0:{_id:i._id,definition:a,name:i.name,source:{extensionId:o.identifier.value,label:i.source,scope:c},execution:s,isBackground:i.isBackground,group:qJ.from(i.group),presentationOptions:cL.from(i.presentationOptions),problemMatchers:i.problemMatchers,hasDefinedMatchers:i.hasDefinedMatchers,runOptions:i.runOptions?i.runOptions:{reevaluateOnRerun:!0},detail:i.detail}}n.from=t;async function r(i,o,s){if(i==null)return;let a;_k.is(i.execution)?a=_k.to(i.execution):wk.is(i.execution)?a=wk.to(i.execution):rv.is(i.execution)&&(a=rv.to(i._id,s));const c=aL.to(i.definition);let l;if(i.source&&(i.source.scope!==void 0?typeof i.source.scope=="number"?l=i.source.scope:l=await o.resolveWorkspaceFolder(Te.revive(i.source.scope)):l=bW.Workspace),!c||!l)return;const u=new hxe(c,l,i.name,i.source.label,a,i.problemMatchers);return i.isBackground!==void 0&&(u.isBackground=i.isBackground),i.group!==void 0&&(u.group=SW.from(i.group._id),u.group&&i.group.isDefault&&(u.group=new SW(u.group.id,u.group.label),i.group.isDefault===!0&&(u.group.isDefault=i.group.isDefault))),i.presentationOptions&&(u.presentationOptions=cL.to(i.presentationOptions)),i._id&&(u._id=i._id),i.detail&&(u.detail=i.detail),u}n.to=r})(Z0||(Z0={}));var KJ;(function(n){function e(r){return r}n.from=e;function t(r){if(r)return Object.assign(Object.create(null),r)}n.to=t})(KJ||(KJ={}));var TT;class hV{constructor(e,t,r){Tn(this,TT,void 0);this._id=t,this._task=r,gn(this,TT,e)}get task(){return this._task}terminate(){Qe(this,TT).terminateTask(this)}fireDidStartProcess(e){}fireDidEndProcess(e){}}TT=new WeakMap;let GJ=class{constructor(e,t,r,i,o,s,a,c){this._onDidExecuteTask=new ft,this._onDidTerminateTask=new ft,this._onDidTaskProcessStarted=new ft,this._onDidTaskProcessEnded=new ft,this._proxy=e.getProxy(dn.MainThreadTask),this._workspaceProvider=r,this._editorService=i,this._configurationService=o,this._terminalService=s,this._handleCounter=0,this._handlers=new Map,this._taskExecutions=new Map,this._taskExecutionPromises=new Map,this._providedCustomExecutions2=new Map,this._notProvidedCustomExecutions=new Set,this._activeCustomExecutions2=new Map,this._logService=a,this._deprecationService=c,this._proxy.$registerSupportedExecutions(!0)}registerTaskProvider(e,t,r){if(!r)return new pi(()=>{});const i=this.nextHandle();return this._handlers.set(i,{type:t,provider:r,extension:e}),this._proxy.$registerTaskProvider(i,t),new pi(()=>{this._handlers.delete(i),this._proxy.$unregisterTaskProvider(i)})}registerTaskSystem(e,t){this._proxy.$registerTaskSystem(e,t)}fetchTasks(e){return this._proxy.$fetchTasks(KJ.from(e)).then(async t=>{const r=[];for(const i of t){const o=await Z0.to(i,this._workspaceProvider,this._providedCustomExecutions2);o&&r.push(o)}return r})}get taskExecutions(){const e=[];return this._taskExecutions.forEach(t=>e.push(t)),e}terminateTask(e){if(!(e instanceof hV))throw new Error("No valid task execution provided");return this._proxy.$terminateTask(e._id)}get onDidStartTask(){return this._onDidExecuteTask.event}async $onDidStartTask(e,t,r){const i=this._providedCustomExecutions2.get(e.id);i&&(this._activeCustomExecutions2.set(e.id,i),this._terminalService.attachPtyToTerminal(t,await i.callback(r))),this._lastStartedTask=e.id,this._onDidExecuteTask.fire({execution:await this.getTaskExecution(e)})}get onDidEndTask(){return this._onDidTerminateTask.event}async $OnDidEndTask(e){if(!this._taskExecutionPromises.has(e.id))return;const t=await this.getTaskExecution(e);this._taskExecutionPromises.delete(e.id),this._taskExecutions.delete(e.id),this.customExecutionComplete(e),this._onDidTerminateTask.fire({execution:t})}get onDidStartTaskProcess(){return this._onDidTaskProcessStarted.event}async $onDidStartTaskProcess(e){const t=await this.getTaskExecution(e.id);this._onDidTaskProcessStarted.fire({execution:t,processId:e.processId})}get onDidEndTaskProcess(){return this._onDidTaskProcessEnded.event}async $onDidEndTaskProcess(e){const t=await this.getTaskExecution(e.id);this._onDidTaskProcessEnded.fire({execution:t,exitCode:e.exitCode})}$provideTasks(e,t){const r=this._handlers.get(e);if(!r)return Promise.reject(new Error("no handler found"));const i=[],o=Lc(()=>r.provider.provideTasks(Xl.None)).then(s=>this.provideTasksInternal(t,i,r,s));return new Promise(s=>{o.then(a=>{Promise.all(i).then(()=>{s(a)})})})}async $resolveTask(e,t){const r=this._handlers.get(e);if(!r)return Promise.reject(new Error("no handler found"));if(t.definition.type!==r.type)throw new Error(`Unexpected: Task of type [${t.definition.type}] cannot be resolved by provider of type [${r.type}].`);const i=await Z0.to(t,this._workspaceProvider,this._providedCustomExecutions2);if(!i)throw new Error("Unexpected: Task cannot be resolved.");const o=await r.provider.resolveTask(i,Xl.None);if(!o)return;this.checkDeprecation(o,r);const s=Z0.from(o,r.extension);if(!s)throw new Error("Unexpected: Task cannot be resolved.");if(o.definition!==i.definition)throw new Error("Unexpected: The resolved task definition must be the same object as the original task definition. The task definition cannot be changed.");return rv.is(s.execution)&&await this.addCustomExecution(s,o,!0),await this.resolveTaskInternal(s)}nextHandle(){return this._handleCounter++}async addCustomExecution(e,t,r){const i=await this._proxy.$createTaskId(e);!r&&!this._providedCustomExecutions2.has(i)&&(this._notProvidedCustomExecutions.add(i),this._activeCustomExecutions2.set(i,t.execution)),this._providedCustomExecutions2.set(i,t.execution)}async getTaskExecution(e,t){if(typeof e=="string"){const o=this._taskExecutionPromises.get(e);if(!o)throw new JV("Unexpected: The specified task is missing an execution");return o}const r=this._taskExecutionPromises.get(e.id);if(r)return r;let i;return t?i=Promise.resolve(new hV(this,e.id,t)):i=Z0.to(e.task,this._workspaceProvider,this._providedCustomExecutions2).then(o=>{if(!o)throw new JV("Unexpected: Task does not exist.");return new hV(this,e.id,o)}),this._taskExecutionPromises.set(e.id,i),i.then(o=>(this._taskExecutions.set(e.id,o),o))}checkDeprecation(e,t){e._deprecated&&this._deprecationService.report("Task.constructor",t.extension,"Use the Task constructor that takes a `scope` instead.")}customExecutionComplete(e){this._activeCustomExecutions2.get(e.id)&&this._activeCustomExecutions2.delete(e.id),this._notProvidedCustomExecutions.has(e.id)&&this._lastStartedTask!==e.id&&(this._providedCustomExecutions2.delete(e.id),this._notProvidedCustomExecutions.delete(e.id));const r=this._notProvidedCustomExecutions.values();let i=r.next();for(;!i.done;)!this._activeCustomExecutions2.has(i.value)&&this._lastStartedTask!==i.value&&(this._providedCustomExecutions2.delete(i.value),this._notProvidedCustomExecutions.delete(i.value)),i=r.next()}};GJ=An([Be(0,Ii),Be(1,Cl),Be(2,Av),Be(3,iR),Be(4,Ov),Be(5,kE),Be(6,Li),Be(7,y9)],GJ);let ZJ=class extends GJ{constructor(e,t,r,i,o,s,a,c){super(e,t,r,i,o,s,a,c),this.registerTaskSystem(hr.vscodeRemote,{scheme:hr.vscodeRemote,authority:"",platform:HGe(0)})}async executeTask(e,t){if(!t.execution)throw new Error("Tasks to execute must include an execution");const r=Z0.from(t,e);if(r===void 0)throw new Error("Task is not valid");if(rv.is(r.execution))await this.addCustomExecution(r,t,!1);else throw new tW;const i=await this.getTaskExecution(await this._proxy.$getTaskExecution(r),t);return this._proxy.$executeTask(r).catch(o=>{throw new Error(o)}),i}provideTasksInternal(e,t,r,i){const o=[];if(i)for(const s of i){if(this.checkDeprecation(s,r),!s.definition||!e[s.definition.type]){const c=s.source?s.source:"No task source";this._logService.warn(`The task [${c}, ${s.name}] uses an undefined task type. The task will be ignored in the future.`)}const a=Z0.from(s,r.extension);a&&rv.is(a.execution)?(o.push(a),t.push(this.addCustomExecution(a,s,!0))):this._logService.warn("Only custom execution tasks supported.")}return{tasks:o,extension:r.extension}}async resolveTaskInternal(e){if(rv.is(e.execution))return e;this._logService.warn("Only custom execution tasks supported.")}async $resolveVariables(e,t){return{process:void 0,variables:Object.create(null)}}async $jsonTasksSupported(){return!1}async $findExecutable(e,t,r){}};ZJ=An([Be(0,Ii),Be(1,Cl),Be(2,Av),Be(3,iR),Be(4,Ov),Be(5,kE),Be(6,Li),Be(7,y9)],ZJ);const iHe=go("IExtHostTask"),oR=go("IExtHostEditorTabs");class nCe{constructor(e,t,r){this._activeTabIdGetter=r,this._parentGroup=t,this.acceptDtoUpdate(e)}get apiObject(){if(!this._apiObject){const e=this,t={get isActive(){return e._dto.id===e._activeTabIdGetter()},get label(){return e._dto.label},get input(){return e._input},get isDirty(){return e._dto.isDirty},get isPinned(){return e._dto.isPinned},get isPreview(){return e._dto.isPreview},get group(){return e._parentGroup.apiObject}};this._apiObject=Object.freeze(t)}return this._apiObject}get tabId(){return this._dto.id}acceptDtoUpdate(e){this._dto=e,this._input=this._initInput()}_initInput(){switch(this._dto.input.kind){case 1:return new Lee(Te.revive(this._dto.input.uri));case 2:return new kM(Te.revive(this._dto.input.original),Te.revive(this._dto.input.modified));case 3:return new yxe(Te.revive(this._dto.input.base),Te.revive(this._dto.input.input1),Te.revive(this._dto.input.input2),Te.revive(this._dto.input.result));case 6:return new $ee(Te.revive(this._dto.input.uri),this._dto.input.viewType);case 7:return new vxe(this._dto.input.viewType);case 4:return new Mee(Te.revive(this._dto.input.uri),this._dto.input.notebookType);case 5:return new Oee(Te.revive(this._dto.input.original),Te.revive(this._dto.input.modified),this._dto.input.notebookType);case 8:return new mxe;case 9:return new gxe(Te.revive(this._dto.input.uri),Te.revive(this._dto.input.inputBoxUri));case 10:return new pxe;case 11:return new fxe(this._dto.input.diffEditors.map(e=>new kM(Te.revive(e.original),Te.revive(e.modified))));default:return}}}class nin{constructor(e,t){this._tabs=[],this._activeTabId="",this._dto=e,this._activeGroupIdGetter=t;for(const r of e.tabs)r.isActive&&(this._activeTabId=r.id),this._tabs.push(new nCe(r,this,()=>this.activeTabId()))}get apiObject(){if(!this._apiObject){const e=this,t={get isActive(){return e._dto.groupId===e._activeGroupIdGetter()},get viewColumn(){return Ma.to(e._dto.viewColumn)},get activeTab(){var r;return(r=e._tabs.find(i=>i.tabId===e._activeTabId))==null?void 0:r.apiObject},get tabs(){return Object.freeze(e._tabs.map(r=>r.apiObject))}};this._apiObject=Object.freeze(t)}return this._apiObject}get groupId(){return this._dto.groupId}get tabs(){return this._tabs}acceptGroupDtoUpdate(e){this._dto=e}acceptTabOperation(e){if(e.kind===0){const r=new nCe(e.tabDto,this,()=>this.activeTabId());return this._tabs.splice(e.index,0,r),e.tabDto.isActive&&(this._activeTabId=r.tabId),r}else if(e.kind===1){const r=this._tabs.splice(e.index,1)[0];if(!r)throw new Error(`Tab close updated received for index ${e.index} which does not exist`);return r.tabId===this._activeTabId&&(this._activeTabId=""),r}else if(e.kind===3){if(e.oldIndex===void 0)throw new Error("Invalid old index on move IPC");const r=this._tabs.splice(e.oldIndex,1)[0];if(!r)throw new Error(`Tab move updated received for index ${e.oldIndex} which does not exist`);return this._tabs.splice(e.index,0,r),r}const t=this._tabs.find(r=>r.tabId===e.tabDto.id);if(!t)throw new Error("INVALID tab");return e.tabDto.isActive?this._activeTabId=e.tabDto.id:this._activeTabId===e.tabDto.id&&!e.tabDto.isActive&&(this._activeTabId=""),t.acceptDtoUpdate(e.tabDto),t}activeTabId(){return this._activeTabId}}let XJ=class{constructor(e){this._onDidChangeTabs=new ft,this._onDidChangeTabGroups=new ft,this._extHostTabGroups=[],this._proxy=e.getProxy(dn.MainThreadEditorTabs)}get tabGroups(){if(!this._apiObject){const e=this,t={onDidChangeTabGroups:e._onDidChangeTabGroups.event,onDidChangeTabs:e._onDidChangeTabs.event,get all(){return Object.freeze(e._extHostTabGroups.map(r=>r.apiObject))},get activeTabGroup(){var o;const r=e._activeGroupId;return bM((o=e._extHostTabGroups.find(s=>s.groupId===r))==null?void 0:o.apiObject)},close:async(r,i)=>{const o=Array.isArray(r)?r:[r];return o.length?rin(o[0])?this._closeGroups(o,i):this._closeTabs(o,i):!0}};this._apiObject=Object.freeze(t)}return this._apiObject}$acceptEditorTabModel(e){var l;const t=new Set(this._extHostTabGroups.map(u=>u.groupId)),r=new Set(e.map(u=>u.groupId)),i=UGe(t,r),o=this._extHostTabGroups.filter(u=>i.removed.includes(u.groupId)).map(u=>u.apiObject),s=[],a=[];this._extHostTabGroups=e.map(u=>{const d=new nin(u,()=>this._activeGroupId);return i.added.includes(d.groupId)?s.push(d.apiObject):a.push(d.apiObject),d});const c=bM((l=e.find(u=>u.isActive===!0))==null?void 0:l.groupId);c!==void 0&&this._activeGroupId!==c&&(this._activeGroupId=c),this._onDidChangeTabGroups.fire(Object.freeze({opened:s,closed:o,changed:a}))}$acceptTabGroupUpdate(e){const t=this._extHostTabGroups.find(r=>r.groupId===e.groupId);if(!t)throw new Error("Update Group IPC call received before group creation.");t.acceptGroupDtoUpdate(e),e.isActive&&(this._activeGroupId=e.groupId),this._onDidChangeTabGroups.fire(Object.freeze({changed:[t.apiObject],opened:[],closed:[]}))}$acceptTabOperation(e){const t=this._extHostTabGroups.find(i=>i.groupId===e.groupId);if(!t)throw new Error("Update Tabs IPC call received before group creation.");const r=t.acceptTabOperation(e);switch(e.kind){case 0:this._onDidChangeTabs.fire(Object.freeze({opened:[r.apiObject],closed:[],changed:[]}));return;case 1:this._onDidChangeTabs.fire(Object.freeze({opened:[],closed:[r.apiObject],changed:[]}));return;case 3:case 2:this._onDidChangeTabs.fire(Object.freeze({opened:[],closed:[],changed:[r.apiObject]}));return}}_findExtHostTabFromApi(e){for(const t of this._extHostTabGroups)for(const r of t.tabs)if(r.apiObject===e)return r}_findExtHostTabGroupFromApi(e){return this._extHostTabGroups.find(t=>t.apiObject===e)}async _closeTabs(e,t){const r=[];for(const i of e){const o=this._findExtHostTabFromApi(i);if(!o)throw new Error("Tab close: Invalid tab not found!");r.push(o.tabId)}return this._proxy.$closeTab(r,t)}async _closeGroups(e,t){const r=[];for(const i of e){const o=this._findExtHostTabGroupFromApi(i);if(!o)throw new Error("Group close: Invalid group not found!");r.push(o.groupId)}return this._proxy.$closeGroup(r,t)}};XJ=An([Be(0,Ii)],XJ);function rin(n){return n.tabs!==void 0}const EL=class EL{constructor(e,t,r,i){this.startup=e,this.codeLoadingTime=t,this.activateCallTime=r,this.activateResolvedTime=i}};EL.NONE=new EL(!1,-1,-1,-1);let Fx=EL;class rCe{constructor(e){this._startup=e,this._codeLoadingStart=-1,this._codeLoadingStop=-1,this._activateCallStart=-1,this._activateCallStop=-1,this._activateResolveStart=-1,this._activateResolveStop=-1}_delta(e,t){return e===-1||t===-1?-1:t-e}build(){return new Fx(this._startup,this._delta(this._codeLoadingStart,this._codeLoadingStop),this._delta(this._activateCallStart,this._activateCallStop),this._delta(this._activateResolveStart,this._activateResolveStop))}codeLoadingStart(){this._codeLoadingStart=Date.now()}codeLoadingStop(){this._codeLoadingStop=Date.now()}activateCallStart(){this._activateCallStart=Date.now()}activateCallStop(){this._activateCallStop=Date.now()}activateResolveStart(){this._activateResolveStart=Date.now()}activateResolveStop(){this._activateResolveStop=Date.now()}}class b9{constructor(e,t,r,i,o,s){this.activationFailed=e,this.activationFailedError=t,this.activationTimes=r,this.module=i,this.exports=o,this.subscriptions=s}}class iin extends b9{constructor(e){super(!1,null,e,{activate:void 0,deactivate:void 0},void 0,[])}}class oin extends b9{constructor(){super(!1,null,Fx.NONE,{activate:void 0,deactivate:void 0},void 0,[])}}class lL extends b9{constructor(e){super(!0,e,Fx.NONE,{activate:void 0,deactivate:void 0},void 0,[])}}let YJ=class{constructor(e,t,r,i){this._logService=i,this._registry=e,this._globalRegistry=t,this._host=r,this._operations=new jy,this._alreadyActivatedEvents=Object.create(null)}dispose(){for(const[e,t]of this._operations)t.dispose()}async waitForActivatingExtensions(){const e=[];for(const[t,r]of this._operations)e.push(r.wait());await Promise.all(e)}isActivated(e){const t=this._operations.get(e);return!!(t&&t.value)}getActivatedExtension(e){const t=this._operations.get(e);if(!t||!t.value)throw new Error(`Extension '${e.value}' is not known or not activated`);return t.value}async activateByEvent(e,t){if(this._alreadyActivatedEvents[e])return;const r=this._registry.getExtensionDescriptionsForActivationEvent(e);await this._activateExtensions(r.map(i=>({id:i.identifier,reason:{startup:t,extensionId:i.identifier,activationEvent:e}}))),this._alreadyActivatedEvents[e]=!0}activateById(e,t){const r=this._registry.getExtensionDescription(e);if(!r)throw new Error(`Extension '${e.value}' is not known`);return this._activateExtensions([{id:r.identifier,reason:t}])}async _activateExtensions(e){const t=e.filter(r=>!this.isActivated(r.id)).map(r=>this._handleActivationRequest(r));await Promise.all(t.map(r=>r.wait()))}_handleActivationRequest(e){if(this._operations.has(e.id))return this._operations.get(e.id);if(this._isHostExtension(e.id))return this._createAndSaveOperation(e,null,[],null);const t=this._registry.getExtensionDescription(e.id);if(!t){const o=new Error(`Cannot activate unknown extension '${e.id.value}'`),s=this._createAndSaveOperation(e,null,[],new lL(o));return this._host.onExtensionActivationError(e.id,o,new rle(e.id.value)),s}const r=[],i=typeof t.extensionDependencies>"u"?[]:t.extensionDependencies;for(const o of i){if(this._isResolvedExtension(o))continue;const s=this._operations.get(o);if(s){r.push(s);continue}if(this._isHostExtension(o)){r.push(this._handleActivationRequest({id:this._globalRegistry.getExtensionDescription(o).identifier,reason:e.reason}));continue}const a=this._registry.getExtensionDescription(o);if(a){if(!a.main&&!a.browser)continue;r.push(this._handleActivationRequest({id:a.identifier,reason:e.reason}));continue}const c=t.displayName||t.identifier.value,l=new Error(`Cannot activate the '${c}' extension because it depends on unknown extension '${o}'`),u=this._createAndSaveOperation(e,t.displayName,[],new lL(l));return this._host.onExtensionActivationError(t.identifier,l,new rle(o)),u}return this._createAndSaveOperation(e,t.displayName,r,null)}_createAndSaveOperation(e,t,r,i){const o=new JJ(e.id,t,e.reason,r,i,this._host,this._logService);return this._operations.set(e.id,o),o}_isHostExtension(e){return LP.isHostExtension(e,this._registry,this._globalRegistry)}_isResolvedExtension(e){const t=this._globalRegistry.getExtensionDescription(e);return t?!t.main&&!t.browser:!1}};YJ=An([Be(3,Li)],YJ);let JJ=class{get value(){return this._value}get friendlyName(){return this._displayName||this._id.value}constructor(e,t,r,i,o,s,a){this._id=e,this._displayName=t,this._reason=r,this._deps=i,this._value=o,this._host=s,this._logService=a,this._barrier=new Mf,this._isDisposed=!1,this._initialize()}dispose(){this._isDisposed=!0}wait(){return this._barrier.wait()}async _initialize(){await this._waitForDepsThenActivate(),this._barrier.open()}async _waitForDepsThenActivate(){if(!this._value){for(;this._deps.length>0;){for(let e=0;e<this._deps.length;e++){const t=this._deps[e];if(t.value&&!t.value.activationFailed){this._deps.splice(e,1),e--;continue}if(t.value&&t.value.activationFailed){const r=new Error(`Cannot activate the '${this.friendlyName}' extension because its dependency '${t.friendlyName}' failed to activate`);r.detail=t.value.activationFailedError,this._value=new lL(r),this._host.onExtensionActivationError(this._id,r,null);return}}this._deps.length>0&&await Promise.race(this._deps.map(e=>e.wait()))}await this._activate()}}async _activate(){try{this._value=await this._host.actualActivateExtension(this._id,this._reason)}catch(e){const t=new Error;if(e&&e.name&&(t.name=e.name),e&&e.message?t.message=`Activating extension '${this._id.value}' failed: ${e.message}.`:t.message=`Activating extension '${this._id.value}' failed: ${e}.`,e&&e.stack&&(t.stack=e.stack),this._value=new lL(t),this._isDisposed&&SM(e))return;this._host.onExtensionActivationError(this._id,t,null),this._logService.error(`Activating extension ${this._id.value} failed due to an error:`),this._logService.error(e)}}};JJ=An([Be(6,Li)],JJ);class oHe{constructor(e,t){this._logService=t,this._onDidChangeStorage=new ft,this.onDidChangeStorage=this._onDidChangeStorage.event,this._proxy=e.getProxy(dn.MainThreadStorage)}registerExtensionStorageKeysToSync(e,t){this._proxy.$registerExtensionStorageKeysToSync(e,t)}async initializeExtensionStorage(e,t,r){const i=await this._proxy.$initializeExtensionStorage(e,t);let o;return i&&(o=this.safeParseValue(e,t,i)),o||r}setValue(e,t,r){return this._proxy.$setValue(e,t,r)}$acceptValue(e,t,r){const i=this.safeParseValue(e,t,r);i&&this._onDidChangeStorage.fire({shared:e,key:t,value:i})}safeParseValue(e,t,r){try{return JSON.parse(r)}catch(i){this._logService.error(`[extHostStorage] unexpected error parsing storage contents (extensionId: ${t}, global: ${e}): ${i}`)}}}const xse=go("IExtHostStorage");class sHe{constructor(e,t,r){this._deferredPromises=new Map,this._id=e,this._shared=t,this._storage=r,this._init=this._storage.initializeExtensionStorage(this._shared,this._id,Object.create(null)).then(i=>(this._value=i,this)),this._storageListener=this._storage.onDidChangeStorage(i=>{i.shared===this._shared&&i.key===this._id&&(this._value=i.value)}),this._scheduler=new Zx(()=>{const i=this._deferredPromises;this._deferredPromises=new Map,(async()=>{try{await this._storage.setValue(this._shared,this._id,this._value);for(const o of i.values())o.complete()}catch(o){for(const s of i.values())s.error(o)}})()},0)}keys(){return Object.entries(this._value??{}).filter(([,e])=>e!==void 0).map(([e])=>e)}get whenReady(){return this._init}get(e,t){let r=this._value[e];return typeof r>"u"&&(r=t),r}update(e,t){this._value[e]=t;const r=this._deferredPromises.get(e);if(r!==void 0)return r.p;const i=new Nee;return this._deferredPromises.set(e,i),this._scheduler.isScheduled()||this._scheduler.schedule(),i.p}dispose(){this._storageListener.dispose()}}class sin extends sHe{setKeysForSync(e){this._storage.registerExtensionStorageKeysToSync({id:this._id,version:this._extension.version},e)}constructor(e,t){super(e.identifier.value,!0,t),this._extension=e}}const Ese=go("IExtensionStoragePaths");let QJ=class{constructor(e,t,r){this._logService=t,this._extHostFileSystem=r,this._workspace=e.workspace??void 0,this._environment=e.environment,this.whenReady=this._getOrCreateWorkspaceStoragePath().then(i=>this._value=i)}async _getWorkspaceStorageURI(e){return Te.joinPath(this._environment.workspaceStorageHome,e)}async _getOrCreateWorkspaceStoragePath(){var r;if(!this._workspace)return Promise.resolve(void 0);const e=this._workspace.id,t=await this._getWorkspaceStorageURI(e);try{return await this._extHostFileSystem.value.stat(t),this._logService.trace("[ExtHostStorage] storage dir already exists",t),t}catch{}try{return this._logService.trace("[ExtHostStorage] creating dir and metadata-file",t),await this._extHostFileSystem.value.createDirectory(t),await this._extHostFileSystem.value.writeFile(Te.joinPath(t,"meta.json"),new TextEncoder().encode(JSON.stringify({id:this._workspace.id,configuration:(r=Te.revive(this._workspace.configuration))==null?void 0:r.toString(),name:this._workspace.name},void 0,2))),t}catch(i){this._logService.error("[ExtHostStorage]",i);return}}workspaceValue(e){if(this._value)return Te.joinPath(this._value,e.identifier.value)}globalValue(e){return Te.joinPath(this._environment.globalStorageHome,e.identifier.value.toLowerCase())}onWillDeactivateAll(){}};QJ=An([Be(0,Cl),Be(1,Li),Be(2,g9)],QJ);const Ise=go("IExtHostAuthentication");let eQ=class{constructor(e){this._authenticationProviders=new Map,this._onDidChangeSessions=new ft,this.onDidChangeSessions=this._onDidChangeSessions.event,this._getSessionTaskSingler=new iCe,this._getSessionsTaskSingler=new iCe,this._proxy=e.getProxy(dn.MainThreadAuthentication)}async getSession(e,t,r,i={}){const o=jc.toKey(e.identifier),s=[...r].sort().join(" ");return await this._getSessionTaskSingler.getOrCreate(`${o} ${t} ${s}`,async()=>{await this._proxy.$ensureProvider(t);const a=e.displayName||e.name;return this._proxy.$getSession(t,r,o,a,i)})}async getSessions(e,t,r){const i=jc.toKey(e.identifier),o=[...r].sort().join(" ");return await this._getSessionsTaskSingler.getOrCreate(`${i} ${o}`,async()=>{await this._proxy.$ensureProvider(t);const s=e.displayName||e.name;return this._proxy.$getSessions(t,r,i,s)})}async removeSession(e,t){const r=this._authenticationProviders.get(e);return r?r.provider.removeSession(t):this._proxy.$removeSession(e,t)}registerAuthenticationProvider(e,t,r,i){if(this._authenticationProviders.get(e))throw new Error(`An authentication provider with id '${e}' is already registered.`);this._authenticationProviders.set(e,{label:t,provider:r,options:i??{supportsMultipleAccounts:!1}});const o=r.onDidChangeSessions(s=>this._proxy.$sendDidChangeSessions(e,s));return this._proxy.$registerAuthenticationProvider(e,t,(i==null?void 0:i.supportsMultipleAccounts)??!1),new pi(()=>{o.dispose(),this._authenticationProviders.delete(e),this._proxy.$unregisterAuthenticationProvider(e)})}$createSession(e,t,r){const i=this._authenticationProviders.get(e);if(i)return Promise.resolve(i.provider.createSession(t,r));throw new Error(`Unable to find authentication provider with handle: ${e}`)}$removeSession(e,t){const r=this._authenticationProviders.get(e);if(r)return Promise.resolve(r.provider.removeSession(t));throw new Error(`Unable to find authentication provider with handle: ${e}`)}$getSessions(e,t){const r=this._authenticationProviders.get(e);if(r)return Promise.resolve(r.provider.getSessions(t));throw new Error(`Unable to find authentication provider with handle: ${e}`)}$onDidChangeAuthenticationSessions(e,t){return e.startsWith(bxe)||this._onDidChangeSessions.fire({provider:{id:e,label:t}}),Promise.resolve()}};eQ=An([Be(0,Ii)],eQ);class iCe{constructor(){this._inFlightPromises=new Map}getOrCreate(e,t){const r=this._inFlightPromises.get(e);if(r)return r;const i=t().finally(()=>this._inFlightPromises.delete(e));return this._inFlightPromises.set(e,i),i}}var tQ;const oCe="vs/workbench/api/common/extHostLanguageModels",Pse=go("IExtHostLanguageModels");class sCe{constructor(e,t){this.option=e,this.stream=new _W,this.stream=t??new _W}}class ain{constructor(){this._responseStreams=new Map,this._defaultStream=new _W,this._isDone=!1,this._isStreaming=!1;const e=this;this.apiObject={stream:e._defaultStream.asyncIterable}}*_streams(){if(this._responseStreams.size>0)for(const[,e]of this._responseStreams)yield e.stream;else yield this._defaultStream}handleFragment(e){if(this._isDone)return;this._isStreaming=!0;let t=this._responseStreams.get(e.index);t||(this._responseStreams.size===0?t=new sCe(e.index,this._defaultStream):t=new sCe(e.index),this._responseStreams.set(e.index,t)),t.stream.emitOne(e.part)}get isStreaming(){return this._isStreaming}reject(e){this._isDone=!0;for(const t of this._streams())t.reject(e)}resolve(){this._isDone=!0;for(const e of this._streams())e.resolve()}}var Ux;let nQ=(Ux=class{constructor(e,t,r){this._logService=t,this._extHostAuthentication=r,this._onDidChangeModelAccess=new ft,this._onDidChangeProviders=new ft,this.onDidChangeProviders=this._onDidChangeProviders.event,this._languageModels=new Map,this._allLanguageModelData=new Map,this._modelAccessList=new jy,this._pendingRequest=new Map,this._languageAccessInformationExtensions=new Set,this._proxy=e.getProxy(dn.MainThreadLanguageModels)}dispose(){this._onDidChangeModelAccess.dispose(),this._onDidChangeProviders.dispose()}registerLanguageModel(e,t,r,i){var c;const o=tQ._idPool++;this._languageModels.set(o,{extension:e.identifier,provider:r,languageModelId:t});let s;i.auth&&(s={providerLabel:e.displayName||e.name,accountLabel:typeof i.auth=="object"?i.auth.label:void 0}),this._proxy.$registerLanguageModelProvider(o,t,{extension:e.identifier,identifier:t,name:i.name??"",version:i.version,tokens:i.tokens,auth:s});const a=(c=r.onDidReceiveLanguageModelResponse2)==null?void 0:c.call(r,({extensionId:l,participant:u,tokenCount:d})=>{this._proxy.$whenLanguageModelChatRequestMade(t,new jc(l),u,d)});return ho(()=>{this._languageModels.delete(o),this._proxy.$unregisterProvider(o),a==null||a.dispose()})}async $provideLanguageModelResponse(e,t,r,i,o,s){const a=this._languageModels.get(e);if(!a)return;const c=new Sxe(async l=>{if(s.isCancellationRequested){this._logService.warn(`[CHAT](${a.extension.value}) CANNOT send progress because the REQUEST IS CANCELLED`);return}this._proxy.$handleProgressChunk(t,{index:l.index,part:l.part})});return a.provider.provideLanguageModelResponse2(i.map(Tj.to),o,jc.toKey(r),c,s)}$provideTokenLength(e,t,r){const i=this._languageModels.get(e);return i?Promise.resolve(i.provider.provideTokenCount(t,r)):Promise.resolve(0)}$updateLanguageModels(e){var i;const t=[],r=[];if(e.added)for(const o of e.added)this._allLanguageModelData.set(o.identifier,o),t.push(o.identifier);if(e.removed)for(const o of e.removed){this._allLanguageModelData.delete(o),r.push(o);for(const[s,a]of this._pendingRequest)a.languageModelId===o&&(a.res.reject(new R2e),this._pendingRequest.delete(s))}this._onDidChangeProviders.fire(Object.freeze({added:Object.freeze(t),removed:Object.freeze(r)})),(i=e.added)==null||i.forEach(this._fakeAuthPopulate,this)}getLanguageModelIds(){return Array.from(this._allLanguageModelData.keys())}$updateModelAccesslist(e){const t=new Array;for(const{from:r,to:i,enabled:o}of e){const s=this._modelAccessList.get(r)??new KT;if(s.has(i)!==o){o?s.add(i):s.delete(i),this._modelAccessList.set(r,s);const c={from:r,to:i};t.push(c),this._onDidChangeModelAccess.fire(c)}}}async sendChatRequest(e,t,r,i,o){var f;const s=e.identifier,a=await this._proxy.$prepareChatAccess(s,t,i.justification);if(!a||!this._allLanguageModelData.has(t))throw YI.NotFound(`Language model '${t}' is unknown.`);if(this._isUsingAuth(s,a)&&(!await this._getAuthAccess(e,{identifier:a.extension,displayName:a.auth.providerLabel},i.justification,i.silent)||!((f=this._modelAccessList.get(s))!=null&&f.has(a.extension))))throw YI.NoPermissions(`Language model '${t}' cannot be used by '${s.value}'.`);const c=Math.random()*1e6|0,l=this._proxy.$fetchResponse(s,t,c,r.map(Tj.from),i.modelOptions??{},o),u=new Mf,d=new ain;this._pendingRequest.set(c,{languageModelId:t,res:d});let h;if(l.catch(p=>{u.isOpen()?d.reject(p):h=p}).finally(()=>{this._pendingRequest.delete(c),d.resolve(),u.open()}),await u.wait(),h)throw new YI(`Language model '${t}' errored, check cause for more details`,"Unknown",h);return d.apiObject}async $handleResponseFragment(e,t){const r=this._pendingRequest.get(e);r&&r.res.handleFragment(t)}async _getAuthAccess(e,t,r,i){const o=bxe+t.identifier.value;if(await this._extHostAuthentication.getSession(e,o,[],{silent:!0}))return this.$updateModelAccesslist([{from:e.identifier,to:t.identifier,enabled:!0}]),!0;if(i)return!1;try{const a=r?Ve(oCe,0,`To allow access to the language models provided by {0}. Justification:

{1}`,t.displayName,r):Ve(oCe,1,"To allow access to the language models provided by {0}",t.displayName);return await this._extHostAuthentication.getSession(e,o,[],{forceNewSession:{detail:a}}),this.$updateModelAccesslist([{from:e.identifier,to:t.identifier,enabled:!0}]),!0}catch{return!1}}_isUsingAuth(e,t){return!!t.auth&&!jc.equals(t.extension,e)}async _fakeAuthPopulate(e){for(const t of this._languageAccessInformationExtensions)try{await this._getAuthAccess(t,{identifier:e.extension,displayName:""},void 0,!0)}catch(r){this._logService.error("Fake Auth request failed"),this._logService.error(r)}}async computeTokenLength(e,t,r){const i=this._allLanguageModelData.get(e);if(!i)throw YI.NotFound(`Language model '${e}' is unknown.`);const o=uee.find(this._languageModels.values(),s=>s.languageModelId===e);return o?o.provider.provideTokenCount(t,r):this._proxy.$countTokens(i.identifier,typeof t=="string"?t:Tj.from(t),r)}getLanguageModelInfo(e){const t=this._allLanguageModelData.get(e);if(t)return{id:t.identifier,name:t.name,version:t.version,tokens:t.tokens}}createLanguageModelAccessInformation(e){this._languageAccessInformationExtensions.add(e);const t=this,r=ns.signal(ns.filter(this._onDidChangeModelAccess.event,o=>jc.equals(o.from,e.identifier))),i=ns.signal(this._onDidChangeProviders.event);return{get onDidChange(){return ns.any(r,i)},canSendRequest(o){const s=t._allLanguageModelData.get(o);if(!s)return;if(!t._isUsingAuth(e.identifier,s))return!0;const a=t._modelAccessList.get(e.identifier);if(a)return a.has(s.extension)}}}},tQ=Ux,Ux._idPool=1,Ux);nQ=tQ=An([Be(0,Ii),Be(1,Li),Be(2,Ise)],nQ);class aHe{constructor(e){this._onDidChangePassword=new ft,this.onDidChangePassword=this._onDidChangePassword.event,this._proxy=e.getProxy(dn.MainThreadSecretState)}async $onDidChangePassword(e){this._onDidChangePassword.fire(e)}get(e,t){return this._proxy.$getPassword(e,t)}store(e,t,r){return this._proxy.$setPassword(e,t,r)}delete(e,t){return this._proxy.$deletePassword(e,t)}}const kse=go("IExtHostSecretState");var x0;class cin{constructor(e,t){Tn(this,x0,void 0);this._onDidChange=new ft,this.onDidChange=this._onDidChange.event,this._id=jc.toKey(e.identifier),gn(this,x0,t),Qe(this,x0).onDidChangePassword(r=>{r.extensionId===this._id&&this._onDidChange.fire({key:r.key})})}get(e){return Qe(this,x0).get(this._id,e)}store(e,t){return Qe(this,x0).store(this._id,e,t)}delete(e){return Qe(this,x0).delete(this._id,e)}}x0=new WeakMap;let rQ=class{constructor(e,t,r){this.logService=r,this.bundleCache=new Map,this._proxy=t.getProxy(dn.MainThreadLocalization),this.currentLanguage=e.environment.appLanguage,this.isDefaultLanguage=this.currentLanguage===zGe}getMessage(e,t){var c;const{message:r,args:i,comment:o}=t;if(this.isDefaultLanguage)return Nce(r,i??{});let s=r;o&&o.length>0&&(s+=`/${Array.isArray(o)?o.join(""):o}`);const a=(c=this.bundleCache.get(e))==null?void 0:c.contents[s];return a||this.logService.warn(`Using default string since no string found in i18n bundle that has the key: ${s}`),Nce(a??r,i??{})}getBundle(e){var t;return(t=this.bundleCache.get(e))==null?void 0:t.contents}getBundleUri(e){var t;return(t=this.bundleCache.get(e))==null?void 0:t.uri}async initializeLocalizedMessages(e){var i;if(this.isDefaultLanguage||!e.l10n&&!e.isBuiltin||this.bundleCache.has(e.identifier.value))return;let t;const r=await this.getBundleLocation(e);if(!r){this.logService.error(`No bundle location found for extension ${e.identifier.value}`);return}try{const o=await this._proxy.$fetchBundleContents(r),s=JSON.parse(o);t=e.isBuiltin?(i=s.contents)==null?void 0:i.bundle:s}catch(o){this.logService.error(`Failed to load translations for ${e.identifier.value} from ${r}: ${o.message}`);return}t&&this.bundleCache.set(e.identifier.value,{contents:t,uri:r})}async getBundleLocation(e){if(e.isBuiltin){const t=await this._proxy.$fetchBuiltInBundleUri(e.identifier.value,this.currentLanguage);return Te.revive(t)}return e.l10n?Te.joinPath(e.extensionLocation,e.l10n,`bundle.l10n.${this.currentLanguage}.json`):void 0}};rQ=An([Be(0,Cl),Be(1,Ii),Be(2,Li)],rQ);const Tse=go("IExtHostLocalizationService"),Dse=go("IExtHostManagedSockets");let iQ=class{constructor(e){this._remoteSocketIdCounter=0,this._factory=null,this._managedRemoteSockets=new Map,this._proxy=e.getProxy(dn.MainThreadManagedSockets)}setFactory(e,t){for(const r of this._managedRemoteSockets.values())r.dispose();this._factory&&this._proxy.$unregisterSocketFactory(this._factory.socketFactoryId),this._factory=new lin(e,t),this._proxy.$registerSocketFactory(this._factory.socketFactoryId)}async $openRemoteSocket(e){if(!this._factory||this._factory.socketFactoryId!==e)throw new Error(`No socket factory with id ${e}`);const t=++this._remoteSocketIdCounter,r=await this._factory.makeConnection(),i=new ei;return this._managedRemoteSockets.set(t,new uin(t,r,i)),i.add(ho(()=>this._managedRemoteSockets.delete(t))),i.add(r.onDidEnd(()=>{this._proxy.$onDidManagedSocketEnd(t),i.dispose()})),i.add(r.onDidClose(o=>{this._proxy.$onDidManagedSocketClose(t,(o==null?void 0:o.stack)??(o==null?void 0:o.message)),i.dispose()})),i.add(r.onDidReceiveMessage(o=>this._proxy.$onDidManagedSocketHaveData(t,ac.wrap(o)))),t}$remoteSocketWrite(e,t){var r;(r=this._managedRemoteSockets.get(e))==null||r.actual.send(t.buffer)}$remoteSocketEnd(e){const t=this._managedRemoteSockets.get(e);t&&(t.actual.end(),t.dispose())}async $remoteSocketDrain(e){var t,r,i;await((i=(t=this._managedRemoteSockets.get(e))==null?void 0:(r=t.actual).drain)==null?void 0:i.call(r))}};iQ=An([Be(0,Ii)],iQ);class lin{constructor(e,t){this.socketFactoryId=e,this.makeConnection=t}}class uin extends Dr{constructor(e,t,r){super(),this.socketId=e,this.actual=t,this._register(r)}}var oQ;const aCe="vs/workbench/api/common/extHostExtensionService",cHe=go("IHostUtils");let sQ=oQ=class extends Dr{constructor(e,t,r,i,o,s,a,c,l,u,d,h,f){super(),this._extHostManagedSockets=h,this._extHostLanguageModels=f,this._onDidChangeRemoteConnectionData=this._register(new ft),this.onDidChangeRemoteConnectionData=this._onDidChangeRemoteConnectionData.event,this._realPathCache=new Map,this._isTerminating=!1,this._hostUtils=t,this._extHostContext=r,this._initData=a,this._extHostWorkspace=i,this._extHostConfiguration=o,this._logService=s,this._extHostTunnelService=l,this._extHostTerminalService=u,this._extHostLocalizationService=d,this._mainThreadWorkspaceProxy=this._extHostContext.getProxy(dn.MainThreadWorkspace),this._mainThreadTelemetryProxy=this._extHostContext.getProxy(dn.MainThreadTelemetry),this._mainThreadExtensionsProxy=this._extHostContext.getProxy(dn.MainThreadExtensionService),this._almostReadyToRunExtensions=new Mf,this._readyToStartExtensionHost=new Mf,this._readyToRunExtensions=new Mf,this._eagerExtensionsActivated=new Mf,this._activationEventsReader=new hin(this._initData.extensions.activationEvents),this._globalRegistry=new LP(this._activationEventsReader,this._initData.extensions.allExtensions);const p=new KT(this._initData.extensions.myExtensions);this._myRegistry=new LP(this._activationEventsReader,lHe(this._globalRegistry,p)),gb&&(this._logService.info(`Creating extension host with the following global extensions: ${Ew(this._globalRegistry)}`),this._logService.info(`Creating extension host with the following local extensions: ${Ew(this._myRegistry)}`)),this._storage=new oHe(this._extHostContext,this._logService),this._secretState=new aHe(this._extHostContext),this._storagePath=c,this._instaService=e.createChild(new _xe([xse,this._storage],[kse,this._secretState])),this._activator=this._register(new YJ(this._myRegistry,this._globalRegistry,{onExtensionActivationError:(g,m,v)=>{this._mainThreadExtensionsProxy.$onExtensionActivationError(g,nW(m),v)},actualActivateExtension:async(g,m)=>{if(LP.isHostExtension(g,this._myRegistry,this._globalRegistry))return await this._mainThreadExtensionsProxy.$activateExtension(g,m),new oin;const v=this._myRegistry.getExtensionDescription(g);return this._activateExtension(v,m)}},this._logService)),this._extensionPathIndex=null,this._resolvers=Object.create(null),this._started=!1,this._remoteConnectionData=this._initData.remote.connectionData}getRemoteConnectionData(){return this._remoteConnectionData}async initialize(){try{await this._beforeAlmostReadyToRunExtensions(),this._almostReadyToRunExtensions.open(),await this._extHostWorkspace.waitForInitializeCall(),Rc("code/extHost/ready"),this._readyToStartExtensionHost.open(),this._initData.autoStart&&this._startExtensionHost()}catch(e){dee(e)}}async _deactivateAll(){this._storagePath.onWillDeactivateAll();let e=[];try{e=this._myRegistry.getAllExtensionDescriptions().map(o=>o.identifier).filter(o=>this.isActivated(o)).map(o=>this._deactivate(o))}catch{}await Promise.all(e)}terminate(e,t=0){if(this._isTerminating)return;this._isTerminating=!0,this._logService.info(`Extension host terminating: ${e}`),this._logService.flush(),this._extHostTerminalService.dispose(),this._activator.dispose(),_M&&rW(i=>{this._logService.error(i)}),this._extHostContext.dispose();const r=this._deactivateAll();Promise.race([NP(5e3),r]).finally(()=>{this._hostUtils.pid?this._logService.info(`Extension host with pid ${this._hostUtils.pid} exiting with code ${t}`):this._logService.info(`Extension host exiting with code ${t}`),this._logService.flush(),this._logService.dispose(),this._hostUtils.exit(t)})}isActivated(e){return this._readyToRunExtensions.isOpen()?this._activator.isActivated(e):!1}async getExtension(e){const t=await this._mainThreadExtensionsProxy.$getExtension(e);return t&&{...t,identifier:new jc(t.identifier.value),extensionLocation:Te.revive(t.extensionLocation)}}_activateByEvent(e,t){return this._activator.activateByEvent(e,t)}_activateById(e,t){return this._activator.activateById(e,t)}activateByIdWithErrors(e,t){return this._activateById(e,t).then(()=>{const r=this._activator.getActivatedExtension(e);if(r.activationFailed)return Promise.reject(r.activationFailedError)})}getExtensionRegistry(){return this._readyToRunExtensions.wait().then(e=>this._myRegistry)}getExtensionExports(e){if(this._readyToRunExtensions.isOpen())return this._activator.getActivatedExtension(e).exports;try{return this._activator.getActivatedExtension(e).exports}catch{return null}}async _realPathExtensionUri(e){if(e.scheme===hr.file&&this._hostUtils.fsRealpath){const t=e.fsPath;this._realPathCache.has(t)||this._realPathCache.set(t,this._hostUtils.fsRealpath(t));const r=await this._realPathCache.get(t);return Te.file(r)}return e}async getExtensionPathIndex(){return this._extensionPathIndex||(this._extensionPathIndex=this._createExtensionPathIndex(this._myRegistry.getAllExtensionDescriptions()).then(e=>new din(e))),this._extensionPathIndex}async _createExtensionPathIndex(e){const t=T2e.forUris(r=>JXe.ignorePathCasing(r));return await Promise.all(e.map(async r=>{if(this._getEntryPoint(r)){const i=await this._realPathExtensionUri(r.extensionLocation);t.set(i,r)}})),t}_deactivate(e){let t=Promise.resolve(void 0);if(!this._readyToRunExtensions.isOpen()||!this._activator.isActivated(e))return t;const r=this._activator.getActivatedExtension(e);if(!r)return t;try{typeof r.module.deactivate=="function"&&(t=Promise.resolve(r.module.deactivate()).then(void 0,i=>(this._logService.error(i),Promise.resolve(void 0))))}catch(i){this._logService.error(`An error occurred when deactivating the extension '${e.value}':`),this._logService.error(i)}try{_S(r.subscriptions)}catch(i){this._logService.error(`An error occurred when deactivating the subscriptions for extension '${e.value}':`),this._logService.error(i)}return t}async _activateExtension(e,t){return this._initData.remote.isRemote?this._mainThreadExtensionsProxy.$onWillActivateExtension(e.identifier):await this._mainThreadExtensionsProxy.$onWillActivateExtension(e.identifier),this._doActivateExtension(e,t).then(r=>{const i=r.activationTimes;return this._mainThreadExtensionsProxy.$onDidActivateExtension(e.identifier,i.codeLoadingTime,i.activateCallTime,i.activateResolvedTime,t),this._logExtensionActivationTimes(e,t,"success",i),r},r=>{throw this._logExtensionActivationTimes(e,t,"failure"),r})}_logExtensionActivationTimes(e,t,r,i){const o=lCe(e,t);this._mainThreadTelemetryProxy.$publicLog2("extensionActivationTimes",{...o,...i||{},outcome:r})}_doActivateExtension(e,t){const r=lCe(e,t);this._mainThreadTelemetryProxy.$publicLog2("activatePlugin",r);const i=this._getEntryPoint(e);if(!i)return Promise.resolve(new iin(Fx.NONE));this._logService.info(`ExtensionService#_doActivateExtension ${e.identifier.value}, startup: ${t.startup}, activationEvent: '${t.activationEvent}'${e.identifier.value!==t.extensionId.value?`, root cause: ${t.extensionId.value}`:""}`),this._logService.flush();const o=new rCe(t.startup);return Promise.all([this._loadCommonJSModule(e,jh(e.extensionLocation,i),o),this._loadExtensionContext(e)]).then(s=>(Rc(`code/extHost/willActivateExtension/${e.identifier.value}`),oQ._callActivate(this._logService,e.identifier,s[0],s[1],o))).then(s=>(Rc(`code/extHost/didActivateExtension/${e.identifier.value}`),s))}_loadExtensionContext(e){const t=this._extHostLanguageModels.createLanguageModelAccessInformation(e),r=new sin(e,this._storage),i=new sHe(e.identifier.value,!1,this._storage),o=new cin(e,this._secretState),s=e.isUnderDevelopment?this._initData.environment.extensionTestsLocationURI?c4.Test:c4.Development:c4.Production,a=this._initData.remote.isRemote?FP.Workspace:FP.UI;return this._logService.trace(`ExtensionService#loadExtensionContext ${e.identifier.value}`),Promise.all([r.whenReady,i.whenReady,this._storagePath.whenReady]).then(()=>{var h;const c=this;let l,u;const d=Oa(e,"ipc")?(h=this._initData.messagePorts)==null?void 0:h.get(jc.toKey(e.identifier)):void 0;return Object.freeze({globalState:r,workspaceState:i,secrets:o,subscriptions:[],get languageModelAccessInformation(){return t},get extensionUri(){return e.extensionLocation},get extensionPath(){return e.extensionLocation.fsPath},asAbsolutePath(f){return Fce(e.extensionLocation.fsPath,f)},get storagePath(){var f;return(f=c._storagePath.workspaceValue(e))==null?void 0:f.fsPath},get globalStoragePath(){return c._storagePath.globalValue(e).fsPath},get logPath(){return Fce(c._initData.logsLocation.fsPath,e.identifier.value)},get logUri(){return Te.joinPath(c._initData.logsLocation,e.identifier.value)},get storageUri(){return c._storagePath.workspaceValue(e)},get globalStorageUri(){return c._storagePath.globalValue(e)},get extensionMode(){return s},get extension(){return l===void 0&&(l=new PP(c,e.identifier,e,a,!1)),l},get extensionRuntime(){return vt(e,"extensionRuntime"),c.extensionRuntime},get environmentVariableCollection(){return c._extHostTerminalService.getEnvironmentVariableCollection(e)},get messagePassingProtocol(){if(!u){if(!d)return;const f=ns.buffer(ns.fromDOMEventEmitter(d,"message",p=>p.data));d.start(),u={onDidReceiveMessage:f,postMessage:d.postMessage.bind(d)}}return u}})})}static _callActivate(e,t,r,i,o){return r=r||{activate:void 0,deactivate:void 0},this._callActivateOptional(e,t,r,i,o).then(s=>new b9(!1,null,o.build(),r,s,i.subscriptions))}static _callActivateOptional(e,t,r,i,o){if(typeof r.activate=="function")try{o.activateCallStart(),e.trace(`ExtensionService#_callActivateOptional ${t.value}`);const s=typeof global=="object"?global:self,a=r.activate.apply(s,[i]);return o.activateCallStop(),o.activateResolveStart(),Promise.resolve(a).then(c=>(o.activateResolveStop(),c))}catch(s){return Promise.reject(s)}else return Promise.resolve(r)}_activateOneStartupFinished(e,t){this._activateById(e.identifier,{startup:!1,extensionId:e.identifier,activationEvent:t}).then(void 0,r=>{this._logService.error(r)})}_activateAllStartupFinishedDeferred(e,t=0){const i=Date.now();VGe(()=>{for(let o=t;o<e.length;o+=1){const s=e[o];for(const a of s.activationEvents??[])if(a==="onStartupFinished")if(Date.now()-i>50){this._activateAllStartupFinishedDeferred(e,o);break}else this._activateOneStartupFinished(s,a)}})}_activateAllStartupFinished(){this._mainThreadExtensionsProxy.$setPerformanceMarks(GXe()),this._extHostConfiguration.getConfigProvider().then(e=>{const t=e.getConfiguration("extensions.experimental").get("deferredStartupFinishedActivation"),r=this._myRegistry.getAllExtensionDescriptions();if(t)this._activateAllStartupFinishedDeferred(r);else for(const i of r)if(i.activationEvents)for(const o of i.activationEvents)o==="onStartupFinished"&&this._activateOneStartupFinished(i,o)})}_handleEagerExtensions(){const e=this._activateByEvent("*",!0).then(void 0,s=>{this._logService.error(s)});this._register(this._extHostWorkspace.onDidChangeWorkspace(s=>this._handleWorkspaceContainsEagerExtensions(s.added)));const t=this._extHostWorkspace.workspace?this._extHostWorkspace.workspace.folders:[],r=this._handleWorkspaceContainsEagerExtensions(t),i=this._handleRemoteResolverEagerExtensions(),o=Promise.all([i,e,r]).then(()=>{});return Promise.race([o,NP(1e4)]).then(()=>{this._activateAllStartupFinished()}),o}_handleWorkspaceContainsEagerExtensions(e){return e.length===0?Promise.resolve(void 0):Promise.all(this._myRegistry.getAllExtensionDescriptions().map(t=>this._handleWorkspaceContainsEagerExtension(e,t))).then(()=>{})}async _handleWorkspaceContainsEagerExtension(e,t){if(this.isActivated(t.identifier))return;const r=!this._initData.remote.isRemote&&!!this._initData.remote.authority,i={logService:this._logService,folders:e.map(s=>s.uri),forceUsingSearch:r||!this._hostUtils.fsExists,exists:s=>this._hostUtils.fsExists(s.fsPath),checkExists:(s,a,c)=>this._mainThreadWorkspaceProxy.$checkExists(s,a,c)},o=await ZXe(i,t);if(o)return this._activateById(t.identifier,{startup:!0,extensionId:t.identifier,activationEvent:o.activationEvent}).then(void 0,s=>this._logService.error(s))}async _handleRemoteResolverEagerExtensions(){if(this._initData.remote.authority)return this._activateByEvent(`onResolveRemoteAuthority:${this._initData.remote.authority}`,!1)}async $extensionTestsExecute(){await this._eagerExtensionsActivated.wait();try{return await this._doHandleExtensionTests()}catch(e){throw console.error(e),e}}async _doHandleExtensionTests(){const{extensionDevelopmentLocationURI:e,extensionTestsLocationURI:t}=this._initData.environment;if(!e||!t)throw new Error(Ve(aCe,0,"Cannot load test runner."));const r=await this._loadCommonJSModule(null,t,new rCe(!1));if(!r||typeof r.run!="function")throw new Error(Ve(aCe,1,"Path {0} does not point to a valid extension test runner.",t.toString()));return new Promise((i,o)=>{const s=(l,u)=>{l?(gb&&this._logService.error("Test runner called back with error",l),o(l)):(gb&&(u?this._logService.info(`Test runner called back with ${u} failures.`):this._logService.info("Test runner called back with successful outcome.")),i(typeof u=="number"&&u>0?1:0))},a=wxe(t),c=r.run(a,s);c&&c.then&&c.then(()=>{gb&&this._logService.info("Test runner finished successfully."),i(0)}).catch(l=>{gb&&this._logService.error("Test runner finished with error",l),o(l instanceof Error&&l.stack?l.stack:String(l))})})}_startExtensionHost(){if(this._started)throw new Error("Extension host is already started!");return this._started=!0,this._readyToStartExtensionHost.wait().then(()=>this._readyToRunExtensions.open()).then(()=>Promise.race([this._activator.waitForActivatingExtensions(),NP(1e3)])).then(()=>this._handleEagerExtensions()).then(()=>{this._eagerExtensionsActivated.open(),this._logService.info("Eager extensions activated")})}registerRemoteAuthorityResolver(e,t){return this._resolvers[e]=t,ho(()=>{delete this._resolvers[e]})}async getRemoteExecServer(e){var r;const{resolver:t}=await this._activateAndGetResolver(e);return(r=t==null?void 0:t.resolveExecServer)==null?void 0:r.call(t,e,{resolveAttempt:0})}async _activateAndGetResolver(e){const t=e.indexOf("+");if(t===-1)throw new Tw("Not an authority that can be resolved!",qR.InvalidAuthority);const r=e.substr(0,t);return await this._almostReadyToRunExtensions.wait(),await this._activateByEvent(`onResolveRemoteAuthority:${r}`,!1),{authorityPrefix:r,resolver:this._resolvers[r]}}async $resolveAuthority(e,t){var b;const r=E2.create(!1),i=()=>`[resolveAuthority(${ile(e)},${t})][${r.elapsed()}ms] `,o=S=>this._logService.info(`${i()}${S}`),s=S=>this._logService.warn(`${i()}${S}`),a=(S,E=void 0)=>this._logService.error(`${i()}${S}`,E),c=S=>{if(S instanceof Tw)return{type:"error",error:{code:S._code,message:S._message,detail:S._detail}};throw S},l=async S=>{o(`activating resolver for ${S}...`);const{resolver:E,authorityPrefix:w}=await this._activateAndGetResolver(S);if(!E)throw a(`no resolver for ${w}`),new Tw(`No remote extension installed to resolve ${w}.`,qR.NoResolverFound);return{resolver:E,authorityPrefix:w,remoteAuthority:S}},u=e.split(/@|%40/g).reverse();o(`activating remote resolvers ${u.join(" -> ")}`);let d;try{d=await Promise.all(u.map(l)).catch(async S=>{if(!(S instanceof Tw)||S._code!==qR.InvalidAuthority)throw S;return s(`resolving nested authorities failed: ${S.message}`),[await l(e)]})}catch(S){return c(S)}const h=new QXe;h.cancelAndSet(()=>o("waiting..."),1e3);let f,p;for(const[S,{authorityPrefix:E,resolver:w,remoteAuthority:C}]of d.entries())try{if(S===d.length-1)o("invoking final resolve()..."),Rc(`code/extHost/willResolveAuthority/${E}`),f=await w.resolve(C,{resolveAttempt:t,execServer:p}),Rc(`code/extHost/didResolveAuthorityOK/${E}`),o("setting tunnel factory..."),this._register(await this._extHostTunnelService.setTunnelFactory(w,l4.isManagedResolvedAuthority(f)?f:void 0));else{if(o(`invoking resolveExecServer() for ${C}`),Rc(`code/extHost/willResolveExecServer/${E}`),p=await((b=w.resolveExecServer)==null?void 0:b.call(w,C,{resolveAttempt:t,execServer:p})),!p)throw new Tw(`Exec server was not available for ${C}`,qR.NoResolverFound);Rc(`code/extHost/didResolveExecServerOK/${E}`)}}catch(I){return Rc(`code/extHost/didResolveAuthorityError/${E}`),a("returned an error",I),h.dispose(),c(I)}h.dispose();const g={environmentTunnels:f.environmentTunnels,features:f.tunnelFeatures?{elevation:f.tunnelFeatures.elevation,privacyOptions:f.tunnelFeatures.privacyOptions,protocol:f.tunnelFeatures.protocol===void 0?!0:f.tunnelFeatures.protocol}:void 0},m={extensionHostEnv:f.extensionHostEnv,isTrusted:f.isTrusted,authenticationSession:f.authenticationSessionForInitializingExtensions?{id:f.authenticationSessionForInitializingExtensions.id,providerId:f.authenticationSessionForInitializingExtensions.providerId}:void 0};o(`returned ${l4.isManagedResolvedAuthority(f)?"managed authority":`${f.host}:${f.port}`}`);let v;if(l4.isManagedResolvedAuthority(f)){const S=t;this._extHostManagedSockets.setFactory(S,f.makeConnection),v={authority:e,connectTo:new XXe(S),connectionToken:f.connectionToken}}else v={authority:e,connectTo:new YXe(f.host,f.port),connectionToken:f.connectionToken};return{type:"ok",value:{authority:v,options:m,tunnelInformation:g}}}async $getCanonicalURI(e,t){this._logService.info(`$getCanonicalURI invoked for authority (${ile(e)})`);const{resolver:r}=await this._activateAndGetResolver(e);if(!r)return null;const i=Te.revive(t);if(typeof r.getCanonicalURI>"u")return i;const o=await Lc(()=>r.getCanonicalURI(i));return o||i}async $startExtensionHost(e){e.toAdd.forEach(s=>s.extensionLocation=Te.revive(s.extensionLocation));const{globalRegistry:t,myExtensions:r}=cCe(this._activationEventsReader,this._globalRegistry,this._myRegistry,e),i=await this._createExtensionPathIndex(r);return(await this.getExtensionPathIndex()).setSearchTree(i),this._globalRegistry.set(t.getAllExtensionDescriptions()),this._myRegistry.set(r),gb&&(this._logService.info(`$startExtensionHost: global extensions: ${Ew(this._globalRegistry)}`),this._logService.info(`$startExtensionHost: local extensions: ${Ew(this._myRegistry)}`)),this._startExtensionHost()}$activateByEvent(e,t){return t===1?this._almostReadyToRunExtensions.wait().then(r=>this._activateByEvent(e,!1)):this._readyToRunExtensions.wait().then(r=>this._activateByEvent(e,!1))}async $activate(e,t){return await this._readyToRunExtensions.wait(),this._myRegistry.getExtensionDescription(e)?(await this._activateById(e,t),!0):!1}async $deltaExtensions(e){e.toAdd.forEach(s=>s.extensionLocation=Te.revive(s.extensionLocation));const{globalRegistry:t,myExtensions:r}=cCe(this._activationEventsReader,this._globalRegistry,this._myRegistry,e),i=await this._createExtensionPathIndex(r);return(await this.getExtensionPathIndex()).setSearchTree(i),this._globalRegistry.set(t.getAllExtensionDescriptions()),this._myRegistry.set(r),gb&&(this._logService.info(`$deltaExtensions: global extensions: ${Ew(this._globalRegistry)}`),this._logService.info(`$deltaExtensions: local extensions: ${Ew(this._myRegistry)}`)),Promise.resolve(void 0)}async $test_latency(e){return e}async $test_up(e){return e.byteLength}async $test_down(e){const t=ac.alloc(e),r=Math.random()%256;for(let i=0;i<e;i++)t.writeUInt8(r,i);return t}async $updateRemoteConnectionData(e){this._remoteConnectionData=e,this._onDidChangeRemoteConnectionData.fire()}};sQ=oQ=An([Be(0,Kx),Be(1,cHe),Be(2,Ii),Be(3,Av),Be(4,Ov),Be(5,Li),Be(6,Cl),Be(7,Ese),Be(8,Fee),Be(9,kE),Be(10,Tse),Be(11,Dse),Be(12,Pse)],sQ);function cCe(n,e,t,r){n.addActivationEvents(r.addActivationEvents);const i=new LP(n,e.getAllExtensionDescriptions());i.deltaExtensions(r.toAdd,r.toRemove);const o=new KT(t.getAllExtensionDescriptions().map(a=>a.identifier));for(const a of r.myToRemove)o.delete(a);for(const a of r.myToAdd)o.add(a);const s=lHe(i,o);return{globalRegistry:i,myExtensions:s}}function lCe(n,e){return{id:n.identifier.value,name:n.name,extensionVersion:n.version,publisherDisplayName:n.publisher,activationEvents:n.activationEvents?n.activationEvents.join(","):null,isBuiltin:n.isBuiltin,reason:e.activationEvent,reasonId:e.extensionId.value}}function Ew(n){return n.getAllExtensionDescriptions().map(e=>e.identifier.value).join(",")}const rb=go("IExtHostExtensionService");var F1,DT,j1;class PP{constructor(e,t,r,i,o){Tn(this,F1,void 0);Tn(this,DT,void 0);Tn(this,j1,void 0);gn(this,F1,e),gn(this,DT,t),gn(this,j1,r.identifier),this.id=r.identifier.value,this.extensionUri=r.extensionLocation,this.extensionPath=iW(wxe(r.extensionLocation)),this.packageJSON=r,this.extensionKind=i,this.isFromDifferentExtensionHost=o}get isActive(){return Qe(this,F1).isActivated(Qe(this,j1))}get exports(){if(!(this.packageJSON.api==="none"||this.isFromDifferentExtensionHost))return Qe(this,F1).getExtensionExports(Qe(this,j1))}async activate(){if(this.isFromDifferentExtensionHost)throw new Error("Cannot activate foreign extension");return await Qe(this,F1).activateByIdWithErrors(Qe(this,j1),{startup:!1,extensionId:Qe(this,DT),activationEvent:"api"}),this.exports}}F1=new WeakMap,DT=new WeakMap,j1=new WeakMap;function lHe(n,e){return n.getAllExtensionDescriptions().filter(t=>e.has(t.identifier))}class din{constructor(e){this._searchTree=e}setSearchTree(e){this._searchTree=e}findSubstr(e){return this._searchTree.findSubstr(e)}forEach(e){return this._searchTree.forEach(e)}}class hin{constructor(e){this._map=new jy,this.addActivationEvents(e)}readActivationEvents(e){return this._map.get(e.identifier)??[]}addActivationEvents(e){for(const t of Object.keys(e))this._map.set(t,e[t])}}var qi;(function(n){n.Unknown="unknown",n.Env="env",n.Config="config",n.Command="command",n.Input="input",n.ExtensionInstallFolder="extensionInstallFolder",n.WorkspaceFolder="workspaceFolder",n.Cwd="cwd",n.WorkspaceFolderBasename="workspaceFolderBasename",n.UserHome="userHome",n.LineNumber="lineNumber",n.SelectedText="selectedText",n.File="file",n.FileWorkspaceFolder="fileWorkspaceFolder",n.FileWorkspaceFolderBasename="fileWorkspaceFolderBasename",n.RelativeFile="relativeFile",n.RelativeFileDirname="relativeFileDirname",n.FileDirname="fileDirname",n.FileExtname="fileExtname",n.FileBasename="fileBasename",n.FileBasenameNoExtension="fileBasenameNoExtension",n.FileDirnameBasename="fileDirnameBasename",n.ExecPath="execPath",n.ExecInstallFolder="execInstallFolder",n.PathSeparator="pathSeparator",n.PathSeparatorAlias="/"})(qi||(qi={}));class Nl extends Error{constructor(e,t){super(t),this.variable=e}}const Fl="vs/workbench/services/configurationResolver/common/variableResolver",p1=class p1{constructor(e,t,r,i){this._contributedVariables=new Map,this._context=e,this._labelService=t,this._userHomePromise=r,i&&(this._envVariablesPromise=i.then(o=>this.prepareEnv(o)))}prepareEnv(e){if(DP){const t=Object.create(null);return Object.keys(e).forEach(r=>{t[r.toLowerCase()]=e[r]}),t}return e}resolveWithEnvironment(e,t,r){return this.recursiveResolve({env:this.prepareEnv(e),userHome:void 0},t?t.uri:void 0,r)}async resolveAsync(e,t){const r={env:await this._envVariablesPromise,userHome:await this._userHomePromise};return this.recursiveResolve(r,e?e.uri:void 0,t)}async resolveAnyBase(e,t,r,i){const o=zl(t);DP&&o.windows?Object.keys(o.windows).forEach(a=>o[a]=o.windows[a]):E2e&&o.osx?Object.keys(o.osx).forEach(a=>o[a]=o.osx[a]):lee&&o.linux&&Object.keys(o.linux).forEach(a=>o[a]=o.linux[a]),delete o.windows,delete o.osx,delete o.linux;const s={env:await this._envVariablesPromise,userHome:await this._userHomePromise};return this.recursiveResolve(s,e?e.uri:void 0,o,r,i)}async resolveAnyAsync(e,t,r){return this.resolveAnyBase(e,t,r)}async resolveAnyMap(e,t,r){const i=new Map;return{newConfig:await this.resolveAnyBase(e,t,r,i),resolvedVariables:i}}resolveWithInteractionReplace(e,t,r,i){throw new Error("resolveWithInteractionReplace not implemented.")}resolveWithInteraction(e,t,r,i){throw new Error("resolveWithInteraction not implemented.")}contributeVariable(e,t){if(this._contributedVariables.has(e))throw new Error("Variable "+e+" is contributed twice.");this._contributedVariables.set(e,t)}async recursiveResolve(e,t,r,i,o){if(Hm(r))return this.resolveString(e,t,r,i,o);if(Array.isArray(r))return Promise.all(r.map(s=>this.recursiveResolve(e,t,s,i,o)));if(xd(r)){const s=Object.create(null),a=await Promise.all(Object.keys(r).map(async c=>[await this.resolveString(e,t,c,i,o),await this.recursiveResolve(e,t,r[c],i,o)]));for(const[c,l]of a)s[c]=l;return s}return r}resolveString(e,t,r,i,o){return WGe(r,p1.VARIABLE_REGEXP,async(s,a)=>{if(a.includes(p1.VARIABLE_LHS))return s;let c=await this.evaluateSingleVariable(e,s,a,t,i);return o==null||o.set(a,c),c!==s&&Hm(c)&&c.match(p1.VARIABLE_REGEXP)&&(c=await this.resolveString(e,t,c,i,o)),c})}fsPath(e){return this._labelService?this._labelService.getUriLabel(e,{noPrefix:!0}):e.fsPath}async evaluateSingleVariable(e,t,r,i,o){let s;const a=r.split(":");a.length>1&&(r=a[0],s=a[1]);const c=d=>{const h=this._context.getFilePath();if(h)return kw(h);throw new Nl(d,Ve(Fl,0,"Variable {0} can not be resolved. Please open an editor.",t))},l=d=>{const h=c(d);if(this._context.getWorkspaceFolderPathForFile){const f=this._context.getWorkspaceFolderPathForFile();if(f)return kw(f)}throw new Nl(d,Ve(Fl,1,"Variable {0}: can not find workspace folder of '{1}'.",t,Ef(h)))},u=d=>{if(s){const h=this._context.getFolderUri(s);if(h)return h;throw new Nl(d,Ve(Fl,2,"Variable {0} can not be resolved. No such folder '{1}'.",t,s))}if(i)return i;throw this._context.getWorkspaceFolderCount()>1?new Nl(d,Ve(Fl,3,"Variable {0} can not be resolved in a multi folder workspace. Scope this variable using ':' and a workspace folder name.",t)):new Nl(d,Ve(Fl,4,"Variable {0} can not be resolved. Please open a folder.",t))};switch(r){case"env":if(s){if(e.env){const d=e.env[DP?s.toLowerCase():s];if(Hm(d))return d}return""}throw new Nl(qi.Env,Ve(Fl,5,"Variable {0} can not be resolved because no environment variable name is given.",t));case"config":if(s){const d=this._context.getConfigurationValue(i,s);if(Pw(d))throw new Nl(qi.Config,Ve(Fl,6,"Variable {0} can not be resolved because setting '{1}' not found.",t,s));if(xd(d))throw new Nl(qi.Config,Ve(Fl,7,"Variable {0} can not be resolved because '{1}' is a structured value.",t,s));return d}throw new Nl(qi.Config,Ve(Fl,8,"Variable {0} can not be resolved because no settings name is given.",t));case"command":return this.resolveFromMap(qi.Command,t,s,o,"command");case"input":return this.resolveFromMap(qi.Input,t,s,o,"input");case"extensionInstallFolder":if(s){const d=await this._context.getExtension(s);if(!d)throw new Nl(qi.ExtensionInstallFolder,Ve(Fl,9,"Variable {0} can not be resolved because the extension {1} is not installed.",t,s));return this.fsPath(d.extensionLocation)}throw new Nl(qi.ExtensionInstallFolder,Ve(Fl,10,"Variable {0} can not be resolved because no extension name is given.",t));default:switch(r){case"workspaceRoot":case"workspaceFolder":return kw(this.fsPath(u(qi.WorkspaceFolder)));case"cwd":return i||s?kw(this.fsPath(u(qi.Cwd))):A2e();case"workspaceRootFolderName":case"workspaceFolderBasename":return kw(Ef(this.fsPath(u(qi.WorkspaceFolderBasename))));case"userHome":{if(e.userHome)return e.userHome;throw new Nl(qi.UserHome,Ve(Fl,11,"Variable {0} can not be resolved. UserHome path is not defined",t))}case"lineNumber":{const d=this._context.getLineNumber();if(d)return d;throw new Nl(qi.LineNumber,Ve(Fl,12,"Variable {0} can not be resolved. Make sure to have a line selected in the active editor.",t))}case"selectedText":{const d=this._context.getSelectedText();if(d)return d;throw new Nl(qi.SelectedText,Ve(Fl,13,"Variable {0} can not be resolved. Make sure to have some text selected in the active editor.",t))}case"file":return c(qi.File);case"fileWorkspaceFolder":return l(qi.FileWorkspaceFolder);case"fileWorkspaceFolderBasename":return Ef(l(qi.FileWorkspaceFolderBasename));case"relativeFile":return i||s?Bce(this.fsPath(u(qi.RelativeFile)),c(qi.RelativeFile)):c(qi.RelativeFile);case"relativeFileDirname":{const d=OP(c(qi.RelativeFileDirname));if(i||s){const h=Bce(this.fsPath(u(qi.RelativeFileDirname)),d);return h.length===0?".":h}return d}case"fileDirname":return OP(c(qi.FileDirname));case"fileExtname":return jce(c(qi.FileExtname));case"fileBasename":return Ef(c(qi.FileBasename));case"fileBasenameNoExtension":{const d=Ef(c(qi.FileBasenameNoExtension));return d.slice(0,d.length-jce(d).length)}case"fileDirnameBasename":return Ef(OP(c(qi.FileDirnameBasename)));case"execPath":{const d=this._context.getExecPath();return d||t}case"execInstallFolder":{const d=this._context.getAppRoot();return d||t}case"pathSeparator":case"/":return P2e;default:try{const d=s?`${r}:${s}`:r;return this.resolveFromMap(qi.Unknown,t,d,o,void 0)}catch{return t}}}}resolveFromMap(e,t,r,i,o){if(r&&i){const s=o===void 0?i[r]:i[o+":"+r];if(typeof s=="string")return s;throw new Nl(e,Ve(Fl,14,"Variable {0} can not be resolved because the command has no value.",t))}return t}};p1.VARIABLE_LHS="${",p1.VARIABLE_REGEXP=/\$\{(.*?)\}/g;let aQ=p1;const Rse=go("IExtHostVariableResolverProvider");class fin extends aQ{constructor(e,t,r,i,o,s,a){function c(){var l;if(r){const u=r.activeEditor();if(u)return u.document.uri;const d=(l=i.tabGroups.all.find(h=>h.isActive))==null?void 0:l.activeTab;if(d!==void 0){if(d.input instanceof kM||d.input instanceof Oee)return d.input.modified;if(d.input instanceof Lee||d.input instanceof Mee||d.input instanceof $ee)return d.input.uri}}}super({getFolderUri:l=>{const u=s.folders.filter(d=>d.name===l);if(u&&u.length>0)return u[0].uri},getWorkspaceFolderCount:()=>s.folders.length,getConfigurationValue:(l,u)=>o.getConfiguration(void 0,l).get(u),getAppRoot:()=>A2e(),getExecPath:()=>Hce.VSCODE_EXEC_PATH,getFilePath:()=>{const l=c();if(l)return iW(l.fsPath)},getWorkspaceFolderPathForFile:()=>{if(t){const l=c();if(l){const u=t.getWorkspaceFolder(l);if(u)return iW(u.uri.fsPath)}}},getSelectedText:()=>{if(r){const l=r.activeEditor();if(l&&!l.selection.isEmpty)return l.document.getText(l.selection)}},getLineNumber:()=>{if(r){const l=r.activeEditor();if(l)return String(l.selection.end.line+1)}},getExtension:l=>e.getExtension(l)},void 0,a?Promise.resolve(a):void 0,Promise.resolve(Hce))}}let cQ=class extends Dr{constructor(e,t,r,i,o){super(),this.extensionService=e,this.workspaceService=t,this.editorService=r,this.configurationService=i,this.editorTabs=o,this._resolver=new MP(async()=>{const s=await this.configurationService.getConfigProvider(),c={folders:await this.workspaceService.getWorkspaceFolders2()||[]};return this._register(this.workspaceService.onDidChangeWorkspace(async l=>{c.folders=await this.workspaceService.getWorkspaceFolders2()||[]})),new fin(this.extensionService,this.workspaceService,this.editorService,this.editorTabs,s,c,this.homeDir())})}getResolver(){return this._resolver.value}homeDir(){}};cQ=An([Be(0,rb),Be(1,Av),Be(2,iR),Be(3,Ov),Be(4,oR)],cQ);const uHe=go("IExtHostDebugService");let lQ=class{get onDidStartDebugSession(){return this._onDidStartDebugSession.event}get onDidTerminateDebugSession(){return this._onDidTerminateDebugSession.event}get onDidChangeActiveDebugSession(){return this._onDidChangeActiveDebugSession.event}get activeDebugSession(){var e;return(e=this._activeDebugSession)==null?void 0:e.api}get onDidReceiveDebugSessionCustomEvent(){return this._onDidReceiveDebugSessionCustomEvent.event}get activeDebugConsole(){return this._activeDebugConsole.value}constructor(e,t,r,i,o,s,a){this._workspaceService=t,this._extensionService=r,this._configurationService=i,this._editorTabs=o,this._variableResolver=s,this._commands=a,this._debugSessions=new Map,this._debugVisualizationTreeItemIdsCounter=0,this._debugVisualizationProviders=new Map,this._debugVisualizationTrees=new Map,this._debugVisualizationTreeItemIds=new WeakMap,this._debugVisualizationElements=new Map,this._visualizers=new Map,this._visualizerIdCounter=0,this._configProviderHandleCounter=0,this._configProviders=[],this._adapterFactoryHandleCounter=0,this._adapterFactories=[],this._trackerFactoryHandleCounter=0,this._trackerFactories=[],this._debugAdapters=new Map,this._debugAdaptersTrackers=new Map,this._onDidStartDebugSession=new ft,this._onDidTerminateDebugSession=new ft,this._onDidChangeActiveDebugSession=new ft,this._onDidReceiveDebugSessionCustomEvent=new ft,this._debugServiceProxy=e.getProxy(dn.MainThreadDebugService),this._onDidChangeBreakpoints=new ft,this._onDidChangeActiveStackItem=new ft,this._activeDebugConsole=new gin(this._debugServiceProxy),this._breakpoints=new Map,this._extensionService.getExtensionRegistry().then(c=>{c.onDidChange(l=>{this.registerAllDebugTypes(c)}),this.registerAllDebugTypes(c)})}async $getVisualizerTreeItem(e,t){var o,s;const r=this.hydrateVisualizationContext(t);if(!r)return;const i=await((s=(o=this._debugVisualizationTrees.get(e))==null?void 0:o.getTreeItem)==null?void 0:s.call(o,r));return i?this.convertVisualizerTreeItem(e,i):void 0}registerDebugVisualizationTree(e,t,r){const i=jc.toKey(e.identifier),o=this.extensionVisKey(i,t);if(this._debugVisualizationProviders.has(o))throw new Error(`A debug visualization provider with id '${t}' is already registered`);return this._debugVisualizationTrees.set(o,r),this._debugServiceProxy.$registerDebugVisualizerTree(o,!!r.editItem),ho(()=>{this._debugServiceProxy.$unregisterDebugVisualizerTree(o),this._debugVisualizationTrees.delete(t)})}async $getVisualizerTreeItemChildren(e,t){var o,s,a;const r=(o=this._debugVisualizationElements.get(t))==null?void 0:o.item;if(!r)return[];const i=await((a=(s=this._debugVisualizationTrees.get(e))==null?void 0:s.getChildren)==null?void 0:a.call(s,r));return(i==null?void 0:i.map(c=>this.convertVisualizerTreeItem(e,c)))||[]}async $editVisualizerTreeItem(e,t){var o,s;const r=this._debugVisualizationElements.get(e);if(!r)return;const i=await((s=(o=this._debugVisualizationTrees.get(r.provider))==null?void 0:o.editItem)==null?void 0:s.call(o,r.item,t));return this.convertVisualizerTreeItem(r.provider,i||r.item)}$disposeVisualizedTree(e){var i;const t=this._debugVisualizationElements.get(e);if(!t)return;const r=[t.children];for(const o of r)if(o)for(const s of o)r.push((i=this._debugVisualizationElements.get(s))==null?void 0:i.children),this._debugVisualizationElements.delete(s)}convertVisualizerTreeItem(e,t){let r=this._debugVisualizationTreeItemIds.get(t);return r||(r=this._debugVisualizationTreeItemIdsCounter++,this._debugVisualizationTreeItemIds.set(t,r),this._debugVisualizationElements.set(r,{provider:e,item:t})),eYe.from(t,r)}asDebugSourceUri(e,t){const r=e;if(typeof r.sourceReference=="number"&&r.sourceReference>0){let i=`debug:${encodeURIComponent(r.path||"")}`,o="?";return t&&(i+=`${o}session=${encodeURIComponent(t.id)}`,o="&"),i+=`${o}ref=${r.sourceReference}`,Te.parse(i)}else{if(r.path)return Te.file(r.path);throw new Error("cannot create uri from DAP 'source' object; properties 'path' and 'sourceReference' are both missing.")}}registerAllDebugTypes(e){const t=[];for(const r of e.getAllExtensionDescriptions())if(r.contributes){const i=r.contributes.debuggers;if(i&&i.length>0)for(const o of i)tYe(o)&&t.push(o.type)}this._debugServiceProxy.$registerDebugTypes(t)}get activeStackItem(){return this._activeStackItem}get onDidChangeActiveStackItem(){return this._onDidChangeActiveStackItem.event}get onDidChangeBreakpoints(){return this._onDidChangeBreakpoints.event}get breakpoints(){const e=[];return this._breakpoints.forEach(t=>e.push(t)),e}async $resolveDebugVisualizer(e,t){var a;const r=this._visualizers.get(e);if(!r)throw new Error(`No debug visualizer found with id '${e}'`);let{v:i,provider:o,extensionId:s}=r;if(i.visualization||(i=await((a=o.resolveDebugVisualization)==null?void 0:a.call(o,i,t))||i,r.v=i),!i.visualization)throw new Error(`No visualization returned from resolveDebugVisualization in '${o}'`);return this.serializeVisualization(s,i.visualization)}async $executeDebugVisualizerCommand(e){const t=this._visualizers.get(e);if(!t)throw new Error(`No debug visualizer found with id '${e}'`);const r=t.v.visualization;r&&"command"in r&&this._commands.executeCommand(r.command,...r.arguments||[])}hydrateVisualizationContext(e){const t=this._debugSessions.get(e.sessionId);return t&&{session:t.api,variable:e.variable,containerId:e.containerId,frameId:e.frameId,threadId:e.threadId}}async $provideDebugVisualizers(e,t,r,i){const o=this.hydrateVisualizationContext(r),s=this.extensionVisKey(e,t),a=this._debugVisualizationProviders.get(s);if(!o||!a)return[];const c=await a.provideDebugVisualization(o,i);return c?c.map(l=>{const u=++this._visualizerIdCounter;this._visualizers.set(u,{v:l,provider:a,extensionId:e});const d=l.iconPath?this.getIconPathOrClass(l.iconPath):void 0;return{id:u,name:l.name,iconClass:d==null?void 0:d.iconClass,iconPath:d==null?void 0:d.iconPath,visualization:this.serializeVisualization(e,l.visualization)}}):[]}$disposeDebugVisualizers(e){for(const t of e)this._visualizers.delete(t)}registerDebugVisualizationProvider(e,t,r){var s,a;if(!((a=(s=e.contributes)==null?void 0:s.debugVisualizers)!=null&&a.some(c=>c.id===t)))throw new Error(`Extensions may only call registerDebugVisualizationProvider() for renderers they contribute (got ${t})`);const i=jc.toKey(e.identifier),o=this.extensionVisKey(i,t);if(this._debugVisualizationProviders.has(o))throw new Error(`A debug visualization provider with id '${t}' is already registered`);return this._debugVisualizationProviders.set(o,r),this._debugServiceProxy.$registerDebugVisualizer(i,t),ho(()=>{this._debugServiceProxy.$unregisterDebugVisualizer(i,t),this._debugVisualizationProviders.delete(t)})}addBreakpoints(e){const t=e.filter(o=>{const s=o.id;return this._breakpoints.has(s)?!1:(this._breakpoints.set(s,o),!0)});this.fireBreakpointChanges(t,[],[]);const r=[],i=new Map;for(const o of t)if(o instanceof JI){let s=i.get(o.location.uri.toString());s||(s={type:"sourceMulti",uri:o.location.uri,lines:[]},i.set(o.location.uri.toString(),s),r.push(s)),s.lines.push({id:o.id,enabled:o.enabled,condition:o.condition,hitCondition:o.hitCondition,logMessage:o.logMessage,line:o.location.range.start.line,character:o.location.range.start.character,mode:o.mode})}else o instanceof QI&&r.push({type:"function",id:o.id,enabled:o.enabled,hitCondition:o.hitCondition,logMessage:o.logMessage,condition:o.condition,functionName:o.functionName,mode:o.mode});return this._debugServiceProxy.$registerBreakpoints(r)}removeBreakpoints(e){const t=e.filter(s=>this._breakpoints.delete(s.id));this.fireBreakpointChanges([],t,[]);const r=t.filter(s=>s instanceof JI).map(s=>s.id),i=t.filter(s=>s instanceof QI).map(s=>s.id),o=t.filter(s=>s instanceof ole).map(s=>s.id);return this._debugServiceProxy.$unregisterBreakpoints(r,i,o)}startDebugging(e,t,r){var i,o,s;return this._debugServiceProxy.$startDebugging(e?e.uri:void 0,t,{parentSessionID:r.parentSession?r.parentSession.id:void 0,lifecycleManagedByParent:r.lifecycleManagedByParent,repl:r.consoleMode===Cxe.MergeWithParent?"mergeWithParent":"separate",noDebug:r.noDebug,compact:r.compact,suppressSaveBeforeStart:r.suppressSaveBeforeStart,suppressDebugStatusbar:r.suppressDebugStatusbar??((i=r.debugUI)==null?void 0:i.simple),suppressDebugToolbar:r.suppressDebugToolbar??((o=r.debugUI)==null?void 0:o.simple),suppressDebugView:r.suppressDebugView??((s=r.debugUI)==null?void 0:s.simple)})}stopDebugging(e){return this._debugServiceProxy.$stopDebugging(e?e.id:void 0)}registerDebugConfigurationProvider(e,t,r){if(!t)return new pi(()=>{});const i=this._configProviderHandleCounter++;return this._configProviders.push({type:e,handle:i,provider:t}),this._debugServiceProxy.$registerDebugConfigurationProvider(e,r,!!t.provideDebugConfigurations,!!t.resolveDebugConfiguration,!!t.resolveDebugConfigurationWithSubstitutedVariables,i),new pi(()=>{this._configProviders=this._configProviders.filter(o=>o.provider!==t),this._debugServiceProxy.$unregisterDebugConfigurationProvider(i)})}registerDebugAdapterDescriptorFactory(e,t,r){if(!r)return new pi(()=>{});if(!this.definesDebugType(e,t))throw new Error(`a DebugAdapterDescriptorFactory can only be registered from the extension that defines the '${t}' debugger.`);if(this.getAdapterDescriptorFactoryByType(t))throw new Error("a DebugAdapterDescriptorFactory can only be registered once per a type.");const i=this._adapterFactoryHandleCounter++;return this._adapterFactories.push({type:t,handle:i,factory:r}),this._debugServiceProxy.$registerDebugAdapterDescriptorFactory(t,i),new pi(()=>{this._adapterFactories=this._adapterFactories.filter(o=>o.factory!==r),this._debugServiceProxy.$unregisterDebugAdapterDescriptorFactory(i)})}registerDebugAdapterTrackerFactory(e,t){if(!t)return new pi(()=>{});const r=this._trackerFactoryHandleCounter++;return this._trackerFactories.push({type:e,handle:r,factory:t}),new pi(()=>{this._trackerFactories=this._trackerFactories.filter(i=>i.factory!==t)})}async $runInTerminal(e,t){return Promise.resolve(void 0)}async $substituteVariables(e,t){let r;const i=await this.getFolder(e);return i&&(r={uri:i.uri,name:i.name,index:i.index,toResource:()=>{throw new Error("Not implemented")}}),(await this._variableResolver.getResolver()).resolveAnyAsync(r,t)}createDebugAdapter(e,t){if(e.type==="implementation")return new vin(e.implementation)}createSignService(){}async $startDASession(e,t){const r=this,i=await this.getSession(t);return this.getAdapterDescriptor(this.getAdapterDescriptorFactoryByType(i.type),i).then(o=>{if(!o)throw new Error(`Couldn't find a debug adapter descriptor for debug type '${i.type}' (extension might have failed to activate)`);const s=this.convertToDto(o),a=this.createDebugAdapter(s,i);if(!a)throw new Error(`Couldn't create a debug adapter for type '${i.type}'.`);const c=a;return this._debugAdapters.set(e,c),this.getDebugAdapterTrackers(i).then(l=>(l&&this._debugAdaptersTrackers.set(e,l),c.onMessage(async u=>{if(u.type==="request"&&u.command==="handshake"){const d=u,h={type:"response",seq:0,command:d.command,request_seq:d.seq,success:!0};this._signService||(this._signService=this.createSignService());try{if(this._signService){const f=await this._signService.sign(d.arguments.value);h.body={signature:f},c.sendResponse(h)}else throw new Error("no signer")}catch(f){h.success=!1,h.message=f.message,c.sendResponse(h)}}else l&&l.onDidSendMessage&&l.onDidSendMessage(u),u=nYe(u,!0),r._debugServiceProxy.$acceptDAMessage(e,u)}),c.onError(u=>{l&&l.onError&&l.onError(u),this._debugServiceProxy.$acceptDAError(e,u.name,u.message,u.stack)}),c.onExit(u=>{l&&l.onExit&&l.onExit(u??void 0,void 0),this._debugServiceProxy.$acceptDAExit(e,u??void 0,void 0)}),l&&l.onWillStartSession&&l.onWillStartSession(),c.startSession()))})}$sendDAMessage(e,t){t=rYe(t,!1);const r=this._debugAdaptersTrackers.get(e);r&&r.onWillReceiveMessage&&r.onWillReceiveMessage(t);const i=this._debugAdapters.get(e);i==null||i.sendMessage(t)}$stopDASession(e){const t=this._debugAdaptersTrackers.get(e);this._debugAdaptersTrackers.delete(e),t&&t.onWillStopSession&&t.onWillStopSession();const r=this._debugAdapters.get(e);return this._debugAdapters.delete(e),r?r.stopSession():Promise.resolve(void 0)}$acceptBreakpointsDelta(e){const t=[],r=[],i=[];if(e.added)for(const o of e.added){const s=o.id;if(s&&!this._breakpoints.has(s)){let a;if(o.type==="function")a=new QI(o.functionName,o.enabled,o.condition,o.hitCondition,o.logMessage,o.mode);else if(o.type==="data")a=new ole(o.label,o.dataId,o.canPersist,o.enabled,o.hitCondition,o.condition,o.logMessage,o.mode);else{const c=Te.revive(o.uri);a=new JI(new k2(c,new Ah(o.line,o.character)),o.enabled,o.condition,o.hitCondition,o.logMessage,o.mode)}iYe(a,s),this._breakpoints.set(s,a),t.push(a)}}if(e.removed)for(const o of e.removed){const s=this._breakpoints.get(o);s&&(this._breakpoints.delete(o),r.push(s))}if(e.changed){for(const o of e.changed)if(o.id){const s=this._breakpoints.get(o.id);if(s){if(s instanceof QI&&o.type==="function"){const a=s;a.enabled=o.enabled,a.condition=o.condition,a.hitCondition=o.hitCondition,a.logMessage=o.logMessage,a.functionName=o.functionName}else if(s instanceof JI&&o.type==="source"){const a=s;a.enabled=o.enabled,a.condition=o.condition,a.hitCondition=o.hitCondition,a.logMessage=o.logMessage,a.location=new k2(Te.revive(o.uri),new Ah(o.line,o.character))}i.push(s)}}}this.fireBreakpointChanges(t,r,i)}async $acceptStackFrameFocus(e){let t;if(e){const r=await this.getSession(e.sessionId);e.kind==="thread"?t=new xxe(r.api,e.threadId):t=new Exe(r.api,e.threadId,e.frameId)}this._activeStackItem=t,this._onDidChangeActiveStackItem.fire(this._activeStackItem)}$provideDebugConfigurations(e,t,r){return Lc(async()=>{const i=this.getConfigProviderByHandle(e);if(!i)throw new Error("no DebugConfigurationProvider found");if(!i.provideDebugConfigurations)throw new Error("DebugConfigurationProvider has no method provideDebugConfigurations");const o=await this.getFolder(t);return i.provideDebugConfigurations(o,r)}).then(i=>{if(!i)throw new Error("nothing returned from DebugConfigurationProvider.provideDebugConfigurations");return i})}$resolveDebugConfiguration(e,t,r,i){return Lc(async()=>{const o=this.getConfigProviderByHandle(e);if(!o)throw new Error("no DebugConfigurationProvider found");if(!o.resolveDebugConfiguration)throw new Error("DebugConfigurationProvider has no method resolveDebugConfiguration");const s=await this.getFolder(t);return o.resolveDebugConfiguration(s,r,i)})}$resolveDebugConfigurationWithSubstitutedVariables(e,t,r,i){return Lc(async()=>{const o=this.getConfigProviderByHandle(e);if(!o)throw new Error("no DebugConfigurationProvider found");if(!o.resolveDebugConfigurationWithSubstitutedVariables)throw new Error("DebugConfigurationProvider has no method resolveDebugConfigurationWithSubstitutedVariables");const s=await this.getFolder(t);return o.resolveDebugConfigurationWithSubstitutedVariables(s,r,i)})}async $provideDebugAdapter(e,t){const r=this.getAdapterDescriptorFactoryByHandle(e);if(!r)return Promise.reject(new Error("no adapter descriptor factory found for handle"));const i=await this.getSession(t);return this.getAdapterDescriptor(r,i).then(o=>{if(!o)throw new Error(`Couldn't find a debug adapter descriptor for debug type '${i.type}'`);return this.convertToDto(o)})}async $acceptDebugSessionStarted(e){const t=await this.getSession(e);this._onDidStartDebugSession.fire(t.api)}async $acceptDebugSessionTerminated(e){const t=await this.getSession(e);t&&(this._onDidTerminateDebugSession.fire(t.api),this._debugSessions.delete(t.id))}async $acceptDebugSessionActiveChanged(e){var t;this._activeDebugSession=e?await this.getSession(e):void 0,this._onDidChangeActiveDebugSession.fire((t=this._activeDebugSession)==null?void 0:t.api)}async $acceptDebugSessionNameChanged(e,t){const r=await this.getSession(e);r==null||r._acceptNameChanged(t)}async $acceptDebugSessionCustomEvent(e,t){const i={session:(await this.getSession(e)).api,event:t.event,body:t.body};this._onDidReceiveDebugSessionCustomEvent.fire(i)}convertToDto(e){if(e instanceof Ixe)return{type:"executable",command:e.command,args:e.args,options:e.options};if(e instanceof wW)return{type:"server",port:e.port,host:e.host};if(e instanceof Pxe)return{type:"pipeServer",path:e.path};if(e instanceof kxe)return{type:"implementation",implementation:e.implementation};throw new Error("convertToDto unexpected type")}getAdapterDescriptorFactoryByType(e){const t=this._adapterFactories.filter(r=>r.type===e);if(t.length>0)return t[0].factory}getAdapterDescriptorFactoryByHandle(e){const t=this._adapterFactories.filter(r=>r.handle===e);if(t.length>0)return t[0].factory}getConfigProviderByHandle(e){const t=this._configProviders.filter(r=>r.handle===e);if(t.length>0)return t[0].provider}definesDebugType(e,t){if(e.contributes){const r=e.contributes.debuggers;if(r&&r.length>0){for(const i of r)if(i.label&&i.type&&i.type===t)return!0}}return!1}getDebugAdapterTrackers(e){const r=e.configuration.type,i=this._trackerFactories.filter(o=>o.type===r||o.type==="*").map(o=>Lc(()=>o.factory.createDebugAdapterTracker(e.api)).then(s=>s,s=>null));return Promise.race([Promise.all(i).then(o=>{const s=o.filter(a=>!!a);if(s.length>0)return new min(s)}),new Promise(o=>setTimeout(()=>o(void 0),1e3))]).catch(o=>{})}async getAdapterDescriptor(e,t){const r=t.configuration.debugServer;if(typeof r=="number")return Promise.resolve(new wW(r));if(e){const o=await this._extensionService.getExtensionRegistry();return Lc(()=>e.createDebugAdapterDescriptor(t.api,this.daExecutableFromPackage(t,o))).then(s=>{if(s)return s})}const i=await this._extensionService.getExtensionRegistry();return Promise.resolve(this.daExecutableFromPackage(t,i))}daExecutableFromPackage(e,t){}fireBreakpointChanges(e,t,r){(e.length>0||t.length>0||r.length>0)&&this._onDidChangeBreakpoints.fire(Object.freeze({added:e,removed:t,changed:r}))}async getSession(e){if(e)if(typeof e=="string"){const t=this._debugSessions.get(e);if(t)return t}else{let t=this._debugSessions.get(e.id);if(!t){const r=await this.getFolder(e.folderUri),i=e.parent?this._debugSessions.get(e.parent):void 0;t=new pin(this._debugServiceProxy,e.id,e.type,e.name,r,e.configuration,i==null?void 0:i.api),this._debugSessions.set(t.id,t),this._debugServiceProxy.$sessionCached(t.id)}return t}throw new Error("cannot find session")}getFolder(e){if(e){const t=Te.revive(e);return this._workspaceService.resolveWorkspaceFolder(t)}return Promise.resolve(void 0)}extensionVisKey(e,t){return`${e}\0${t}`}serializeVisualization(e,t){if(t){if("title"in t&&"command"in t)return{type:0};if("treeId"in t)return{type:1,id:`${e}\0${t.treeId}`};throw new Error("Unsupported debug visualization type")}}getIconPathOrClass(e){const t=this.getIconUris(e);let r,i;return"id"in t?i=t7.asClassName(t):r=t,{iconPath:r,iconClass:i}}getIconUris(e){if(e instanceof Q0)return{id:e.id};const t=typeof e=="object"&&"dark"in e?e.dark:e,r=typeof e=="object"&&"light"in e?e.light:e;return{dark:typeof t=="string"?Te.file(t):t,light:typeof r=="string"?Te.file(r):r}}};lQ=An([Be(0,Ii),Be(1,Av),Be(2,rb),Be(3,Ov),Be(4,oR),Be(5,Rse),Be(6,PE)],lQ);class pin{constructor(e,t,r,i,o,s,a){this._debugServiceProxy=e,this._id=t,this._type=r,this._name=i,this._workspaceFolder=o,this._configuration=s,this._parentSession=a}get api(){const e=this;return this.apiSession??(this.apiSession=Object.freeze({id:e._id,type:e._type,get name(){return e._name},set name(t){e._name=t,e._debugServiceProxy.$setDebugSessionName(e._id,t)},parentSession:e._parentSession,workspaceFolder:e._workspaceFolder,configuration:e._configuration,customRequest(t,r){return e._debugServiceProxy.$customDebugAdapterRequest(e._id,t,r)},getDebugProtocolBreakpoint(t){return e._debugServiceProxy.$getDebugProtocolBreakpoint(e._id,t.id)}}))}get id(){return this._id}get type(){return this._type}_acceptNameChanged(e){this._name=e}get configuration(){return this._configuration}}class gin{constructor(e){this.value=Object.freeze({append(t){e.$appendDebugConsole(t)},appendLine(t){this.append(t+`
`)}})}}class min{constructor(e){this.trackers=e}onWillStartSession(){this.trackers.forEach(e=>e.onWillStartSession?e.onWillStartSession():void 0)}onWillReceiveMessage(e){this.trackers.forEach(t=>t.onWillReceiveMessage?t.onWillReceiveMessage(e):void 0)}onDidSendMessage(e){this.trackers.forEach(t=>t.onDidSendMessage?t.onDidSendMessage(e):void 0)}onWillStopSession(){this.trackers.forEach(e=>e.onWillStopSession?e.onWillStopSession():void 0)}onError(e){this.trackers.forEach(t=>t.onError?t.onError(e):void 0)}onExit(e,t){this.trackers.forEach(r=>r.onExit?r.onExit(e,t):void 0)}}class vin extends oYe{constructor(e){super(),this.implementation=e,e.onDidSendMessage(t=>{this.acceptMessage(t)})}startSession(){return Promise.resolve(void 0)}sendMessage(e){this.implementation.handleMessage(e)}stopSession(){return this.implementation.dispose(),Promise.resolve(void 0)}}let uQ=class extends lQ{constructor(e,t,r,i,o,s,a){super(e,t,r,i,o,s,a)}};uQ=An([Be(0,Ii),Be(1,Av),Be(2,rb),Be(3,Ov),Be(4,oR),Be(5,Rse),Be(6,PE)],uQ);class yin{constructor(e,t,r){this.config=e,this.provider=t,this.sessionToken=r,this.isLimitHit=!1,this.resultCount=0,this.isCanceled=!1,this.filePattern=e.filePattern,this.includePattern=e.includePattern&&CW(e.includePattern),this.maxResults=e.maxResults||void 0,this.exists=e.exists,this.activeCancellationTokens=new Set,this.globalExcludePattern=e.excludePattern&&CW(e.excludePattern)}cancel(){this.isCanceled=!0,this.activeCancellationTokens.forEach(e=>e.cancel()),this.activeCancellationTokens=new Set}search(e){const t=this.config.folderQueries||[];return new Promise((r,i)=>{const o=s=>{this.resultCount++,e(s)};if(this.isCanceled)return r({limitHit:this.isLimitHit});this.config.extraFileResources&&this.config.extraFileResources.forEach(s=>{const a=s.toString(),c=Ef(a);this.globalExcludePattern&&this.globalExcludePattern(a,c)||this.matchFile(o,{base:s,basename:c})}),Promise.all(t.map(s=>this.searchInFolder(s,o))).then(s=>{r({limitHit:this.isLimitHit,stats:s[0]||void 0})},s=>{i(new Error(UT(s)))})})}async searchInFolder(e,t){const r=new Uc,i=this.getSearchOptionsForFolder(e),o=this.initDirectoryTree(),s=new Txe(this.config,e),a=!s.hasSiblingExcludeClauses();let c;try{this.activeCancellationTokens.add(r),c=E2.create();const l=await this.provider.provideFileSearchResults({pattern:this.config.filePattern||""},i,r.token),u=c.elapsed(),d=E2.create();return this.isCanceled&&!this.isLimitHit||(l&&l.forEach(h=>{const f=Pp.relative(e.folder.path,h.path);if(a){const p=Ef(h.path);this.matchFile(t,{base:e.folder,relativePath:f,basename:p});return}this.addDirectoryEntries(o,e.folder,f,t)}),this.isCanceled&&!this.isLimitHit)?null:(this.matchDirectoryTree(o,s,t),{providerTime:u,postProcessTime:d.elapsed()})}finally{r.dispose(),this.activeCancellationTokens.delete(r)}}getSearchOptionsForFolder(e){const t=TM(this.config.includePattern,e.includePattern),r=TM(this.config.excludePattern,e.excludePattern);return{folder:e.folder,excludes:r,includes:t,useIgnoreFiles:!e.disregardIgnoreFiles,useGlobalIgnoreFiles:!e.disregardGlobalIgnoreFiles,useParentIgnoreFiles:!e.disregardParentIgnoreFiles,followSymlinks:!e.ignoreSymlinks,maxResults:this.config.maxResults,session:this.sessionToken}}initDirectoryTree(){const e={rootEntries:[],pathToEntries:Object.create(null)};return e.pathToEntries["."]=e.rootEntries,e}addDirectoryEntries({pathToEntries:e},t,r,i){if(r===this.filePattern){const s=Ef(this.filePattern);this.matchFile(i,{base:t,relativePath:this.filePattern,basename:s})}function o(s){const a=Ef(s),c=OP(s);let l=e[c];l||(l=e[c]=[],o(c)),l.push({base:t,relativePath:s,basename:a})}o(r)}matchDirectoryTree({rootEntries:e,pathToEntries:t},r,i){const o=this,s=this.filePattern;function a(c){const l=sYe(()=>c.map(u=>u.basename));for(let u=0,d=c.length;u<d;u++){const h=c[u],{relativePath:f,basename:p}=h;if(r.matchesExcludesSync(f,p,s!==p?l:void 0))continue;const g=t[f];if(g)a(g);else{if(f===s)continue;o.matchFile(i,h)}if(o.isLimitHit)break}}a(e)}matchFile(e,t){(!this.includePattern||t.relativePath&&this.includePattern(t.relativePath,t.basename))&&((this.exists||this.maxResults&&this.resultCount>=this.maxResults)&&(this.isLimitHit=!0,this.cancel()),this.isLimitHit||e(t))}}const IL=class IL{constructor(){this.sessions=new Map}fileSearch(e,t,r,i){const o=this.getSessionTokenSource(e.cacheKey),s=new yin(e,t,o&&o.token);let a=0;const c=l=>{a+=l.length,r(l.map(u=>this.rawMatchToSearchItem(u)))};return this.doSearch(s,IL.BATCH_SIZE,c,i).then(l=>({limitHit:l.limitHit,stats:{fromCache:!1,type:"fileSearchProvider",resultCount:a,detailStats:l.stats}}))}clearCache(e){const t=this.getSessionTokenSource(e);t==null||t.cancel()}getSessionTokenSource(e){if(e)return this.sessions.has(e)||this.sessions.set(e,new Uc),this.sessions.get(e)}rawMatchToSearchItem(e){return e.relativePath?{resource:jh(e.base,e.relativePath)}:{resource:e.base}}doSearch(e,t,r,i){const o=i.onCancellationRequested(()=>{e.cancel()}),s=c=>{c&&(a.push(c),t>0&&a.length>=t&&(r(a),a=[]))};let a=[];return e.search(s).then(c=>(a.length&&r(a),o.dispose(),c),c=>(a.length&&r(a),o.dispose(),Promise.reject(c)))}};IL.BATCH_SIZE=512;let dQ=IL;class uCe{constructor(e,t,r){this.queryProviderPair=e,this.fileUtils=t,this.processType=r,this.collector=null,this.isLimitHit=!1,this.resultCount=0}get query(){return this.queryProviderPair.query}search(e,t){const r=this.query.folderQueries||[],i=new Uc(t);return new Promise((o,s)=>{this.collector=new Sin(e);let a=!1;const c=(l,u)=>{if(!a&&!this.isLimitHit){const d=this.resultSize(l);kP(l)&&typeof this.query.maxResults=="number"&&this.resultCount+d>this.query.maxResults&&(this.isLimitHit=!0,a=!0,i.cancel(),l=this.trimResultToSize(l,this.query.maxResults-this.resultCount));const h=this.resultSize(l);this.resultCount+=h,(h>0||!kP(l))&&this.collector.add(l,u)}};Promise.all(r.map((l,u)=>this.searchInFolder(l,d=>c(d,u),i.token))).then(l=>{i.dispose(),this.collector.flush();const u=l.some(d=>!!d&&!!d.limitHit);o({limitHit:this.isLimitHit||u,messages:qGe(l.map(d=>d!=null&&d.message?Array.isArray(d.message)?d.message:[d.message]:[])),stats:{type:this.processType}})},l=>{i.dispose();const u=UT(l);s(new Error(u))})})}resultSize(e){return kP(e)?Array.isArray(e.ranges)?e.ranges.length:1:0}trimResultToSize(e,t){const r=Array.isArray(e.ranges)?e.ranges:[e.ranges],i=Array.isArray(e.preview.matches)?e.preview.matches:[e.preview.matches];return{ranges:r.slice(0,t),preview:{matches:i.slice(0,t),text:e.preview.text},uri:e.uri}}async searchInFolder(e,t,r){const i=new Txe(this.query,e),o=[],s={report:l=>{if(!this.validateProviderResult(l))return;const u=e.folder.scheme===hr.file?aYe(()=>this.fileUtils.readdir(QL(l.uri))):void 0,d=rxe(e.folder,l.uri);if(d){const h=i.includedInQuery(d,Ef(d),u);cYe(h)?o.push(h.then(f=>{f&&t(l)})):h&&t(l)}}},a=this.getSearchOptionsForFolder(e);let c;return this.queryProviderPair.query.type===3?c=await this.queryProviderPair.provider.provideAITextSearchResults(this.queryProviderPair.query.contentPattern,a,s,r):c=await this.queryProviderPair.provider.provideTextSearchResults(bin(this.queryProviderPair.query.contentPattern),a,s,r),o.length&&await Promise.all(o),c}validateProviderResult(e){if(kP(e)){if(Array.isArray(e.ranges)){if(!Array.isArray(e.preview.matches))return console.warn("INVALID - A text search provider match's`ranges` and`matches` properties must have the same type."),!1;if(e.preview.matches.length!==e.ranges.length)return console.warn("INVALID - A text search provider match's`ranges` and`matches` properties must have the same length."),!1}else if(Array.isArray(e.preview.matches))return console.warn("INVALID - A text search provider match's`ranges` and`matches` properties must have the same length."),!1}return!0}getSearchOptionsForFolder(e){const t=TM(this.query.includePattern,e.includePattern),r=TM(this.query.excludePattern,e.excludePattern),i={folder:Te.from(e.folder),excludes:r,includes:t,useIgnoreFiles:!e.disregardIgnoreFiles,useGlobalIgnoreFiles:!e.disregardGlobalIgnoreFiles,useParentIgnoreFiles:!e.disregardParentIgnoreFiles,followSymlinks:!e.ignoreSymlinks,encoding:e.fileEncoding&&this.fileUtils.toCanonicalName(e.fileEncoding),maxFileSize:this.query.maxFileSize,maxResults:this.query.maxResults,previewOptions:this.query.previewOptions,afterContext:this.query.afterContext,beforeContext:this.query.beforeContext};return"usePCRE2"in this.query&&(i.usePCRE2=this.query.usePCRE2),i}}function bin(n){return{isCaseSensitive:n.isCaseSensitive||!1,isRegExp:n.isRegExp||!1,isWordMatch:n.isWordMatch||!1,isMultiline:n.isMultiline||!1,pattern:n.pattern}}class Sin{constructor(e){this._onResult=e,this._currentFolderIdx=-1,this._currentFileMatch=null,this._batchedCollector=new hQ(512,t=>this.sendItems(t))}add(e,t){this._currentFileMatch&&(this._currentFolderIdx!==t||!_ee(this._currentUri,e.uri))&&(this.pushToCollector(),this._currentFileMatch=null),this._currentFileMatch||(this._currentFolderIdx=t,this._currentFileMatch={resource:e.uri,results:[]}),this._currentFileMatch.results.push(_in(e))}pushToCollector(){const e=this._currentFileMatch&&this._currentFileMatch.results?this._currentFileMatch.results.length:0;this._batchedCollector.addItem(this._currentFileMatch,e)}flush(){this.pushToCollector(),this._batchedCollector.flush()}sendItems(e){this._onResult(e)}}function _in(n){return kP(n)?{preview:{matches:mM(n.preview.matches,e=>({startLineNumber:e.start.line,startColumn:e.start.character,endLineNumber:e.end.line,endColumn:e.end.character})),text:n.preview.text},ranges:mM(n.ranges,e=>({startLineNumber:e.start.line,startColumn:e.start.character,endLineNumber:e.end.line,endColumn:e.end.character}))}:{text:n.text,lineNumber:n.lineNumber}}function kP(n){return!!n.preview}const SC=class SC{constructor(e,t){this.maxBatchSize=e,this.cb=t,this.totalNumberCompleted=0,this.batch=[],this.batchSize=0}addItem(e,t){e&&this.addItemToBatch(e,t)}addItems(e,t){e&&this.addItemsToBatch(e,t)}addItemToBatch(e,t){this.batch.push(e),this.batchSize+=t,this.onUpdate()}addItemsToBatch(e,t){this.batch=this.batch.concat(e),this.batchSize+=t,this.onUpdate()}onUpdate(){this.totalNumberCompleted<SC.START_BATCH_AFTER_COUNT?this.flush():this.batchSize>=this.maxBatchSize?this.flush():this.timeoutHandle||(this.timeoutHandle=setTimeout(()=>{this.flush()},SC.TIMEOUT))}flush(){this.batchSize&&(this.totalNumberCompleted+=this.batchSize,this.cb(this.batch),this.batch=[],this.batchSize=0,this.timeoutHandle&&(clearTimeout(this.timeoutHandle),this.timeoutHandle=0))}};SC.TIMEOUT=4e3,SC.START_BATCH_AFTER_COUNT=50;let hQ=SC;const dHe=go("IExtHostSearch");let fQ=class{constructor(e,t,r){this.extHostRpc=e,this._uriTransformer=t,this._logService=r,this._proxy=this.extHostRpc.getProxy(dn.MainThreadSearch),this._handlePool=0,this._textSearchProvider=new Map,this._textSearchUsedSchemes=new Set,this._aiTextSearchProvider=new Map,this._aiTextSearchUsedSchemes=new Set,this._fileSearchProvider=new Map,this._fileSearchUsedSchemes=new Set,this._fileSearchManager=new dQ}_transformScheme(e){return this._uriTransformer.transformOutgoingScheme(e)}registerTextSearchProvider(e,t){if(this._textSearchUsedSchemes.has(e))throw new Error(`a text search provider for the scheme '${e}' is already registered`);this._textSearchUsedSchemes.add(e);const r=this._handlePool++;return this._textSearchProvider.set(r,t),this._proxy.$registerTextSearchProvider(r,this._transformScheme(e)),ho(()=>{this._textSearchUsedSchemes.delete(e),this._textSearchProvider.delete(r),this._proxy.$unregisterProvider(r)})}registerAITextSearchProvider(e,t){if(this._aiTextSearchUsedSchemes.has(e))throw new Error(`an AI text search provider for the scheme '${e}'is already registered`);this._aiTextSearchUsedSchemes.add(e);const r=this._handlePool++;return this._aiTextSearchProvider.set(r,t),this._proxy.$registerAITextSearchProvider(r,this._transformScheme(e)),ho(()=>{this._aiTextSearchUsedSchemes.delete(e),this._aiTextSearchProvider.delete(r),this._proxy.$unregisterProvider(r)})}registerFileSearchProvider(e,t){if(this._fileSearchUsedSchemes.has(e))throw new Error(`a file search provider for the scheme '${e}' is already registered`);this._fileSearchUsedSchemes.add(e);const r=this._handlePool++;return this._fileSearchProvider.set(r,t),this._proxy.$registerFileSearchProvider(r,this._transformScheme(e)),ho(()=>{this._fileSearchUsedSchemes.delete(e),this._fileSearchProvider.delete(r),this._proxy.$unregisterProvider(r)})}$provideFileSearchResults(e,t,r,i){const o=fV(r),s=this._fileSearchProvider.get(e);if(s)return this._fileSearchManager.fileSearch(o,s,a=>{this._proxy.$handleFileMatch(e,t,a.map(c=>c.resource))},i);throw new Error("3 unknown provider: "+e)}async doInternalFileSearchWithCustomCallback(e,t,r){return{messages:[]}}$clearCache(e){return this._fileSearchManager.clearCache(e),Promise.resolve(void 0)}$provideTextSearchResults(e,t,r,i){const o=this._textSearchProvider.get(e);if(!o||!o.provideTextSearchResults)throw new Error(`2 Unknown provider ${e}`);const s=fV(r);return this.createTextSearchManager(s,o).search(c=>this._proxy.$handleTextMatch(e,t,c),i)}$provideAITextSearchResults(e,t,r,i){const o=this._aiTextSearchProvider.get(e);if(!o||!o.provideAITextSearchResults)throw new Error(`1 Unknown provider ${e}`);const s=fV(r);return this.createAITextSearchManager(s,o).search(c=>this._proxy.$handleTextMatch(e,t,c),i)}$enableExtensionHostSearch(){}createTextSearchManager(e,t){return new uCe({query:e,provider:t},{readdir:r=>Promise.resolve([]),toCanonicalName:r=>r},"textSearchProvider")}createAITextSearchManager(e,t){return new uCe({query:e,provider:t},{readdir:r=>Promise.resolve([]),toCanonicalName:r=>r},"aiTextSearchProvider")}};fQ=An([Be(0,Ii),Be(1,m9),Be(2,Li)],fQ);function fV(n){return{...n,folderQueries:n.folderQueries&&n.folderQueries.map(win),extraFileResources:n.extraFileResources&&n.extraFileResources.map(e=>Te.revive(e))}}function win(n){return{...n,folder:Te.revive(n.folder)}}var pQ,zx;let gQ=(zx=class{getState(){const e=this._state;return{get focused(){return e.focused},get active(){return e.active}}}constructor(e){this._onDidChangeWindowState=new ft,this.onDidChangeWindowState=this._onDidChangeWindowState.event,this._state=pQ.InitialState,this._proxy=e.getProxy(dn.MainThreadWindow),this._proxy.$getInitialState().then(({isFocused:t,isActive:r})=>{this.onDidChangeWindowProperty("focused",t),this.onDidChangeWindowProperty("active",r)})}$onDidChangeWindowFocus(e){this.onDidChangeWindowProperty("focused",e)}$onDidChangeWindowActive(e){this.onDidChangeWindowProperty("active",e)}onDidChangeWindowProperty(e,t){t!==this._state[e]&&(this._state={...this._state,[e]:t},this._onDidChangeWindowState.fire(this._state))}openUri(e,t){let r;if(typeof e=="string"){r=e;try{e=Te.parse(e)}catch{return Promise.reject(`Invalid uri - '${e}'`)}}return oW(e.scheme)?Promise.reject("Invalid scheme - cannot be empty"):e.scheme===hr.command?Promise.reject(`Invalid scheme '${e.scheme}'`):this._proxy.$openUri(e,r,t)}async asExternalUri(e,t){if(oW(e.scheme))return Promise.reject("Invalid scheme - cannot be empty");const r=await this._proxy.$asExternalUri(e,t);return Te.from(r)}},pQ=zx,zx.InitialState={focused:!0,active:!0},zx);gQ=pQ=An([Be(0,Ii)],gQ);const hHe=go("IExtHostWindow");let uL=class extends lYe{constructor(e,t){super(t.logLevel,t.logsLocation,t.loggers.map(r=>EM(r))),this._proxy=e.getProxy(dn.MainThreadLogger)}$setLogLevel(e,t){t?this.setLogLevel(Te.revive(t),e):this.setLogLevel(e)}setVisibility(e,t){super.setVisibility(e,t),this._proxy.$setVisibility(e,t)}doCreateLogger(e,t,r){return new Cin(this._proxy,e,t,r)}};uL=An([Be(0,Ii),Be(1,Cl)],uL);let Cin=class extends nxe{constructor(e,t,r,i){super((i==null?void 0:i.logLevel)==="always"),this.proxy=e,this.file=t,this.isLoggerCreated=!1,this.buffer=[],this.setLevel(r),this.proxy.$createLogger(t,i).then(()=>{this.doLog(this.buffer),this.isLoggerCreated=!0})}log(e,t){const r=[[e,t]];this.isLoggerCreated?this.doLog(r):this.buffer.push(...r)}doLog(e){this.proxy.$log(this.file,e)}flush(){this.proxy.$flush(this.file)}};const fHe=go("IExtHostTerminalShellIntegration");let mQ=class extends Dr{constructor(e,t){super(),this._extHostTerminalService=t,this._activeShellIntegrations=new Map,this._onDidChangeTerminalShellIntegration=new ft,this.onDidChangeTerminalShellIntegration=this._onDidChangeTerminalShellIntegration.event,this._onDidStartTerminalShellExecution=new ft,this.onDidStartTerminalShellExecution=this._onDidStartTerminalShellExecution.event,this._onDidEndTerminalShellExecution=new ft,this.onDidEndTerminalShellExecution=this._onDidEndTerminalShellExecution.event,this._proxy=e.getProxy(dn.MainThreadTerminalShellIntegration),this._register(ho(()=>{for(const[r,i]of this._activeShellIntegrations)i.dispose();this._activeShellIntegrations.clear()}))}$shellIntegrationChange(e){const t=this._extHostTerminalService.getTerminalById(e);if(!t)return;const r=t.value;let i=this._activeShellIntegrations.get(e);i||(i=new xin(t.value,this._onDidStartTerminalShellExecution),this._activeShellIntegrations.set(e,i),i.store.add(t.onWillDispose(()=>{var o;return(o=this._activeShellIntegrations.get(e))==null?void 0:o.dispose()})),i.store.add(i.onDidRequestShellExecution(o=>this._proxy.$executeCommand(e,o))),i.store.add(i.onDidRequestEndExecution(o=>this._onDidEndTerminalShellExecution.fire(o))),i.store.add(i.onDidRequestChangeShellIntegration(o=>this._onDidChangeTerminalShellIntegration.fire(o))),t.shellIntegration=i.value),this._onDidChangeTerminalShellIntegration.fire({terminal:r,shellIntegration:i.value})}$shellExecutionStart(e,t,r,i,o){var a;this._activeShellIntegrations.has(e)||this.$shellIntegrationChange(e);const s={value:t,confidence:r,isTrusted:i};(a=this._activeShellIntegrations.get(e))==null||a.startShellExecution(s,o)}$shellExecutionEnd(e,t,r,i,o){var a;const s={value:t,confidence:r,isTrusted:i};(a=this._activeShellIntegrations.get(e))==null||a.endShellExecution(s,o)}$shellExecutionData(e,t){var r;(r=this._activeShellIntegrations.get(e))==null||r.emitData(t)}$cwdChange(e,t){var r;(r=this._activeShellIntegrations.get(e))==null||r.setCwd(KGe(t)?Te.revive(t):t)}$closeTerminal(e){var t;(t=this._activeShellIntegrations.get(e))==null||t.dispose(),this._activeShellIntegrations.delete(e)}};mQ=An([Be(0,Ii),Be(1,kE)],mQ);class xin extends Dr{get currentExecution(){return this._currentExecution}constructor(e,t){super(),this._terminal=e,this._onDidStartTerminalShellExecution=t,this._ignoreNextExecution=!1,this.store=this._register(new ei),this._onDidRequestChangeShellIntegration=this._register(new ft),this.onDidRequestChangeShellIntegration=this._onDidRequestChangeShellIntegration.event,this._onDidRequestShellExecution=this._register(new ft),this.onDidRequestShellExecution=this._onDidRequestShellExecution.event,this._onDidRequestEndExecution=this._register(new ft),this.onDidRequestEndExecution=this._onDidRequestEndExecution.event;const r=this;this.value={get cwd(){return r._cwd},executeCommand(i,o){let s=i;o&&(s+=` "${o.map(l=>`${l.replaceAll('"','\\"')}`).join('" "')}"`),r._onDidRequestShellExecution.fire(s);const a={value:s,confidence:Dxe.High,isTrusted:!0},c=r.startShellExecution(a,r._cwd,!0).value;return r._ignoreNextExecution=!0,c}}}startShellExecution(e,t,r){if(this._ignoreNextExecution&&this._currentExecution)this._ignoreNextExecution=!1;else{this._currentExecution&&(this._currentExecution.endExecution(void 0),this._onDidRequestEndExecution.fire({terminal:this._terminal,shellIntegration:this.value,execution:this._currentExecution.value,exitCode:void 0}));const i=this._currentExecution=new Ein(e,t);r?queueMicrotask(()=>this._onDidStartTerminalShellExecution.fire({terminal:this._terminal,shellIntegration:this.value,execution:i.value})):this._onDidStartTerminalShellExecution.fire({terminal:this._terminal,shellIntegration:this.value,execution:this._currentExecution.value})}return this._currentExecution}emitData(e){var t;(t=this.currentExecution)==null||t.emitData(e)}endShellExecution(e,t){this._currentExecution&&(this._currentExecution.endExecution(e),this._onDidRequestEndExecution.fire({terminal:this._terminal,shellIntegration:this.value,execution:this._currentExecution.value,exitCode:t}),this._currentExecution=void 0)}setCwd(e){let t=!1;Te.isUri(this._cwd)?t=!Te.isUri(e)||this._cwd.toString()!==e.toString():this._cwd!==e&&(t=!0),t&&(this._cwd=e,this._onDidRequestChangeShellIntegration.fire({terminal:this._terminal,shellIntegration:this.value}))}}class Ein{constructor(e,t){this._commandLine=e,this.cwd=t,this._ended=!1;const r=this;this.value={get commandLine(){return r._commandLine},get cwd(){return r.cwd},read(){return r._createDataStream()}}}_createDataStream(){if(!this._dataStream){if(this._ended)return Rxe.EMPTY;this._dataStream=new Iin}return this._dataStream.createIterable()}emitData(e){var t;(t=this._dataStream)==null||t.emitData(e)}endExecution(e){var t;e&&(this._commandLine=e),(t=this._dataStream)==null||t.endExecution(),this._dataStream=void 0,this._ended=!0}}class Iin extends Dr{constructor(){super(...arguments),this._emitters=[]}createIterable(){this._barrier||(this._barrier=new Mf);const e=this._barrier;return new Rxe(async r=>{this._emitters.push(r),await e.wait()})}emitData(e){for(const t of this._emitters)t.emitOne(e)}endExecution(){var e;(e=this._barrier)==null||e.open(),this._barrier=void 0}}mo(Tse,rQ,1);mo(s_,uL,1);mo(y9,zJ,1);mo(PE,NJ,0);mo(Ise,eQ,0);mo(Pse,nQ,0);mo(Ov,$J,0);mo(g9,RJ,0);mo(uHe,uQ,0);mo(eHe,MJ,0);mo(iR,BJ,0);mo(Dse,iQ,0);mo(IE,krn,0);mo(JBe,AJ,1);mo(dHe,fQ,0);mo(xse,oHe,0);mo(iHe,ZJ,0);mo(kE,UJ,0);mo(fHe,mQ,0);mo(Fee,uYe,0);mo(hHe,gQ,0);mo(Av,OJ,0);mo(kse,aHe,0);mo(v9,LJ,0);mo(oR,XJ,0);mo(Rse,cQ,0);const pV="vs/workbench/api/common/extHostLogService";let vQ=class extends dYe{constructor(e,t,r){const i=r.remote.isRemote?"remoteexthost":e?"workerexthost":"exthost",o=r.remote.isRemote?Ve(pV,0,"Extension Host (Remote)"):e?Ve(pV,1,"Extension Host (Worker)"):Ve(pV,2,"Extension Host");super(t.createLogger(i,{name:o}))}};vQ=An([Be(1,s_),Be(2,Cl)],vQ);class dCe{static async installEarlyHandler(e){Error.stackTraceLimit=100;const t=e.get(Li),i=e.get(Ii).getProxy(dn.MainThreadErrors);rW(o=>{t.error(o);const s=nW(o);i.$onUnexpectedError(s)})}static async installFullHandler(e){const t=e.get(Li),r=e.get(Ii),i=e.get(rb),o=e.get(v9),s=r.getProxy(dn.MainThreadExtensionService),a=r.getProxy(dn.MainThreadErrors),c=await i.getExtensionPathIndex(),l=new WeakMap;function u(f,p){if(l.has(f))return l.get(f).stack;let g="",m,v;for(const S of p)g+=`
	at ${S.toString()}`,v=S.getFileName(),!m&&v&&(m=c.findSubstr(Te.file(v)));const b=`${f.name||"Error"}: ${f.message||""}${g}`;return l.set(f,{extensionIdentifier:m==null?void 0:m.identifier,stack:b}),b}const d=Symbol("prepareStackTrace wrapped");let h=u;Object.defineProperty(Error,"prepareStackTrace",{configurable:!1,get(){return h},set(f){if(f===u||!f||f[d]){h=f||u;return}h=function(p,g){return u(p,g),f.call(Error,p,g)},Object.assign(h,{[d]:!0})}}),rW(f=>{t.error(f);const p=nW(f),g=l.get(f);if(!(g!=null&&g.extensionIdentifier)){a.$onUnexpectedError(p);return}s.$onExtensionRuntimeError(g.extensionIdentifier,p);const m=o.onExtensionError(g.extensionIdentifier,f);t.trace("forwarded error to extension?",m,g)})}}class Ase{constructor(e,t,r,i,o){this._hostUtils=r,this._rpcProtocol=new hYe(e,null,i),t=Ase._transform(t,this._rpcProtocol);const s=new _xe(...fYe());s.set(Cl,{_serviceBrand:void 0,...t,messagePorts:o}),s.set(Ii,new pYe(this._rpcProtocol)),s.set(m9,new Drn(i)),s.set(cHe,r),s.set(Li,new wd(vQ,[!0],!0)),s.set(s_,new wd(uL,[],!0));const a=new gYe(s,!0);_M&&a.invokeFunction(dCe.installEarlyHandler),this._logService=a.invokeFunction(c=>c.get(Li)),Rc("code/extHost/didCreateServices"),this._hostUtils.pid?this._logService.info(`Extension host with pid ${this._hostUtils.pid} started`):this._logService.info("Extension host started"),this._logService.trace("initData",t),this._extensionService=a.invokeFunction(c=>c.get(rb)),this._extensionService.initialize(),_M&&a.invokeFunction(dCe.installFullHandler)}async asBrowserUri(e){const t=this._rpcProtocol.getProxy(dn.MainThreadExtensionService);return Te.revive(await t.$asBrowserUri(e))}async getAllStaticBrowserUris(){return(await this._rpcProtocol.getProxy(dn.MainThreadExtensionService).$getAllStaticBrowserUris()).map(([t,r])=>[Te.revive(t),Te.revive(r)])}terminate(e){this._extensionService.terminate(e)}getExtHostExtensionService(){return this._extensionService}static _transform(e,t){e.extensions.allExtensions.forEach(i=>{i.extensionLocation=Te.revive(t.transformIncomingURIs(i.extensionLocation))}),e.environment.appRoot=Te.revive(t.transformIncomingURIs(e.environment.appRoot));const r=e.environment.extensionDevelopmentLocationURI;return r&&(e.environment.extensionDevelopmentLocationURI=r.map(i=>Te.revive(t.transformIncomingURIs(i)))),e.environment.extensionTestsLocationURI=Te.revive(t.transformIncomingURIs(e.environment.extensionTestsLocationURI)),e.environment.globalStorageHome=Te.revive(t.transformIncomingURIs(e.environment.globalStorageHome)),e.environment.workspaceStorageHome=Te.revive(t.transformIncomingURIs(e.environment.workspaceStorageHome)),e.environment.extensionTelemetryLogResource=Te.revive(t.transformIncomingURIs(e.environment.extensionTelemetryLogResource)),e.nlsBaseUrl=Te.revive(t.transformIncomingURIs(e.nlsBaseUrl)),e.logsLocation=Te.revive(t.transformIncomingURIs(e.logsLocation)),e.workspace=t.transformIncomingURIs(e.workspace),e}}class Pin{constructor(e){this._relatedInformationProviders=new Map,this._nextHandle=0,this._proxy=e.getProxy(dn.MainThreadAiRelatedInformation)}async $provideAiRelatedInformation(e,t,r){if(this._relatedInformationProviders.size===0)throw new Error("No related information providers registered");const i=this._relatedInformationProviders.get(e);if(!i)throw new Error("related information provider not found");return await i.provideRelatedInformation(t,r)??[]}getRelatedInformation(e,t,r){return this._proxy.$getAiRelatedInformation(t,r)}registerRelatedInformationProvider(e,t,r){const i=this._nextHandle;return this._nextHandle++,this._relatedInformationProviders.set(i,r),this._proxy.$registerAiRelatedInformationProvider(i,t),new pi(()=>{this._proxy.$unregisterAiRelatedInformationProvider(i),this._relatedInformationProviders.delete(i)})}}const kin=[new vr("vscode.executeDocumentHighlights","_executeDocumentHighlights","Execute document highlight provider.",[jt.Uri,jt.Position],new ir("A promise that resolves to an array of DocumentHighlight-instances.",fm(Axe.to))),new vr("vscode.executeDocumentSymbolProvider","_executeDocumentSymbolProvider","Execute document symbol provider.",[jt.Uri],new ir("A promise that resolves to an array of SymbolInformation and DocumentSymbol instances.",(n,e)=>{if(hee(n))return;class t extends Hxe{static to(i){const o=new t(i.name,Uxe.to(i.kind),i.containerName||"",new k2(e[0],Rn.to(i.range)));return o.detail=i.detail,o.range=o.location.range,o.selectionRange=Rn.to(i.selectionRange),o.children=i.children?i.children.map(t.to):[],o}}return n.map(t.to)})),new vr("vscode.executeFormatDocumentProvider","_executeFormatDocumentProvider","Execute document format provider.",[jt.Uri,new jt("options","Formatting options",n=>!0,n=>n)],new ir("A promise that resolves to an array of TextEdits.",fm(Hf.to))),new vr("vscode.executeFormatRangeProvider","_executeFormatRangeProvider","Execute range format provider.",[jt.Uri,jt.Range,new jt("options","Formatting options",n=>!0,n=>n)],new ir("A promise that resolves to an array of TextEdits.",fm(Hf.to))),new vr("vscode.executeFormatOnTypeProvider","_executeFormatOnTypeProvider","Execute format on type provider.",[jt.Uri,jt.Position,new jt("ch","Trigger character",n=>typeof n=="string",n=>n),new jt("options","Formatting options",n=>!0,n=>n)],new ir("A promise that resolves to an array of TextEdits.",fm(Hf.to))),new vr("vscode.executeDefinitionProvider","_executeDefinitionProvider","Execute all definition providers.",[jt.Uri,jt.Position],new ir("A promise that resolves to an array of Location or LocationLink instances.",XA)),new vr("vscode.executeTypeDefinitionProvider","_executeTypeDefinitionProvider","Execute all type definition providers.",[jt.Uri,jt.Position],new ir("A promise that resolves to an array of Location or LocationLink instances.",XA)),new vr("vscode.executeDeclarationProvider","_executeDeclarationProvider","Execute all declaration providers.",[jt.Uri,jt.Position],new ir("A promise that resolves to an array of Location or LocationLink instances.",XA)),new vr("vscode.executeImplementationProvider","_executeImplementationProvider","Execute all implementation providers.",[jt.Uri,jt.Position],new ir("A promise that resolves to an array of Location or LocationLink instances.",XA)),new vr("vscode.executeReferenceProvider","_executeReferenceProvider","Execute all reference providers.",[jt.Uri,jt.Position],new ir("A promise that resolves to an array of Location-instances.",fm(CS.to))),new vr("vscode.executeHoverProvider","_executeHoverProvider","Execute all hover providers.",[jt.Uri,jt.Position],new ir("A promise that resolves to an array of Hover-instances.",fm(Oxe.to))),new vr("vscode.executeSelectionRangeProvider","_executeSelectionRangeProvider","Execute selection range provider.",[jt.Uri,new jt("position","A position in a text document",n=>Array.isArray(n)&&n.every(e=>Ah.isPosition(e)),n=>n.map(io.from))],new ir("A promise that resolves to an array of ranges.",n=>n.map(e=>{let t;for(const r of e.reverse())t=new Mxe(Rn.to(r),t);return t}))),new vr("vscode.executeWorkspaceSymbolProvider","_executeWorkspaceSymbolProvider","Execute all workspace symbol providers.",[jt.String.with("query","Search string")],new ir("A promise that resolves to an array of SymbolInformation-instances.",n=>n.map(xW.to))),new vr("vscode.prepareCallHierarchy","_executePrepareCallHierarchy","Prepare call hierarchy at a position inside a document",[jt.Uri,jt.Position],new ir("A promise that resolves to an array of CallHierarchyItem-instances",n=>n.map(Dee.to))),new vr("vscode.provideIncomingCalls","_executeProvideIncomingCalls","Compute incoming calls for an item",[jt.CallHierarchyItem],new ir("A promise that resolves to an array of CallHierarchyIncomingCall-instances",n=>n.map(mYe.to))),new vr("vscode.provideOutgoingCalls","_executeProvideOutgoingCalls","Compute outgoing calls for an item",[jt.CallHierarchyItem],new ir("A promise that resolves to an array of CallHierarchyOutgoingCall-instances",n=>n.map(vYe.to))),new vr("vscode.prepareRename","_executePrepareRename","Execute the prepareRename of rename provider.",[jt.Uri,jt.Position],new ir("A promise that resolves to a range and placeholder text.",n=>{if(n)return{range:Rn.to(n.range),placeholder:n.text}})),new vr("vscode.executeDocumentRenameProvider","_executeDocumentRenameProvider","Execute rename provider.",[jt.Uri,jt.Position,jt.String.with("newName","The new symbol name")],new ir("A promise that resolves to a WorkspaceEdit.",n=>{if(n){if(n.rejectReason)throw new Error(n.rejectReason);return Jl.to(n)}})),new vr("vscode.executeLinkProvider","_executeLinkProvider","Execute document link provider.",[jt.Uri,jt.Number.with("linkResolveCount","Number of links that should be resolved, only when links are unresolved.").optional()],new ir("A promise that resolves to an array of DocumentLink-instances.",n=>n.map(jP.to))),new vr("vscode.provideDocumentSemanticTokensLegend","_provideDocumentSemanticTokensLegend","Provide semantic tokens legend for a document",[jt.Uri],new ir("A promise that resolves to SemanticTokensLegend.",n=>{if(n)return new EW(n.tokenTypes,n.tokenModifiers)})),new vr("vscode.provideDocumentSemanticTokens","_provideDocumentSemanticTokens","Provide semantic tokens for a document",[jt.Uri],new ir("A promise that resolves to SemanticTokens.",n=>{if(!n)return;const e=sle(n);if(e.type==="full")return new DM(e.data,void 0)})),new vr("vscode.provideDocumentRangeSemanticTokensLegend","_provideDocumentRangeSemanticTokensLegend","Provide semantic tokens legend for a document range",[jt.Uri,jt.Range.optional()],new ir("A promise that resolves to SemanticTokensLegend.",n=>{if(n)return new EW(n.tokenTypes,n.tokenModifiers)})),new vr("vscode.provideDocumentRangeSemanticTokens","_provideDocumentRangeSemanticTokens","Provide semantic tokens for a document range",[jt.Uri,jt.Range],new ir("A promise that resolves to SemanticTokens.",n=>{if(!n)return;const e=sle(n);if(e.type==="full")return new DM(e.data,void 0)})),new vr("vscode.executeCompletionItemProvider","_executeCompletionItemProvider","Execute completion item provider.",[jt.Uri,jt.Position,jt.String.with("triggerCharacter","Trigger completion when the user types the character, like `,` or `(`").optional(),jt.Number.with("itemResolveCount","Number of completions to resolve (too large numbers slow down completions)").optional()],new ir("A promise that resolves to a CompletionList-instance.",(n,e,t)=>{if(!n)return new RM([]);const r=n.suggestions.map(i=>yYe.to(i,t));return new RM(r,n.incomplete)})),new vr("vscode.executeSignatureHelpProvider","_executeSignatureHelpProvider","Execute signature help provider.",[jt.Uri,jt.Position,jt.String.with("triggerCharacter","Trigger signature help when the user types the character, like `,` or `(`").optional()],new ir("A promise that resolves to SignatureHelp.",n=>{if(n)return IW.to(n)})),new vr("vscode.executeCodeLensProvider","_executeCodeLensProvider","Execute code lens provider.",[jt.Uri,jt.Number.with("itemResolveCount","Number of lenses that should be resolved and returned. Will only return resolved lenses, will impact performance)").optional()],new ir("A promise that resolves to an array of CodeLens-instances.",(n,e,t)=>fm(r=>new zxe(Rn.to(r.range),r.command&&t.fromInternal(r.command)))(n))),new vr("vscode.executeCodeActionProvider","_executeCodeActionProvider","Execute code action provider.",[jt.Uri,new jt("rangeOrSelection","Range in a text document. Some refactoring provider requires Selection object.",n=>_s.isRange(n),n=>P2.isSelection(n)?eg.from(n):Rn.from(n)),jt.String.with("kind","Code action kind to return code actions for").optional(),jt.Number.with("itemResolveCount","Number of code actions to resolve (too large numbers slow down code actions)").optional()],new ir("A promise that resolves to an array of Command-instances.",(n,e,t)=>fm(r=>{if(r._isSynthetic){if(!r.command)throw new Error("Synthetic code actions must have a command");return t.fromInternal(r.command)}else{const i=new Vxe(r.title,r.kind?new jee(r.kind):void 0);return r.edit&&(i.edit=Jl.to(r.edit)),r.command&&(i.command=t.fromInternal(r.command)),i.isPreferred=r.isPreferred,i}})(n))),new vr("vscode.executeDocumentColorProvider","_executeDocumentColorProvider","Execute document color provider.",[jt.Uri],new ir("A promise that resolves to an array of ColorInformation objects.",n=>n?n.map(e=>new $xe(Rn.to(e.range),AM.to(e.color))):[])),new vr("vscode.executeColorPresentationProvider","_executeColorPresentationProvider","Execute color presentation provider.",[new jt("color","The color to show and insert",n=>n instanceof Lxe,AM.from),new jt("context","Context object with uri and range",n=>!0,n=>({uri:n.uri,range:Rn.from(n.range)}))],new ir("A promise that resolves to an array of ColorPresentation objects.",n=>n?n.map(Nxe.to):[])),new vr("vscode.executeInlayHintProvider","_executeInlayHintProvider","Execute inlay hints provider",[jt.Uri,jt.Range],new ir("A promise that resolves to an array of Inlay objects",(n,e,t)=>n.map(bYe.to.bind(void 0,t)))),new vr("vscode.executeFoldingRangeProvider","_executeFoldingRangeProvider","Execute folding range provider",[jt.Uri],new ir("A promise that resolves to an array of FoldingRange objects",(n,e)=>{if(n)return n.map(Fxe.to)})),new vr("vscode.resolveNotebookContentProviders","_resolveNotebookContentProvider","Resolve Notebook Content Providers",[],new ir("A promise that resolves to an array of NotebookContentProvider static info objects.",fm(n=>({viewType:n.viewType,displayName:n.displayName,options:{transientOutputs:n.options.transientOutputs,transientCellMetadata:n.options.transientCellMetadata,transientDocumentMetadata:n.options.transientDocumentMetadata},filenamePattern:n.filenamePattern.map(e=>Wxe.to(e))})))),new vr("vscode.executeInlineValueProvider","_executeInlineValueProvider","Execute inline value provider",[jt.Uri,jt.Range,new jt("context","An InlineValueContext",n=>n&&typeof n.frameId=="number"&&n.stoppedLocation instanceof _s,n=>jxe.from(n))],new ir("A promise that resolves to an array of InlineValue objects",n=>n.map(Bxe.to))),new vr("vscode.open","_workbench.open","Opens the provided resource in the editor. Can be a text or binary file, or an http(s) URL. If you need more control over the options for opening a text file, use vscode.window.showTextDocument instead.",[new jt("uriOrString","Uri-instance or string (only http/https)",n=>Te.isUri(n)||typeof n=="string"&&GGe(n,hr.http,hr.https),n=>n),new jt("columnOrOptions","Either the column in which to open or editor options, see vscode.TextDocumentShowOptions",n=>n===void 0||typeof n=="number"||typeof n=="object",n=>n&&(typeof n=="number"?[Ma.from(n),void 0]:[Ma.from(n.viewColumn),Dj.from(n)])).optional(),jt.String.with("label","").optional()],ir.Void),new vr("vscode.openWith","_workbench.openWith","Opens the provided resource with a specific editor.",[jt.Uri.with("resource","Resource to open"),jt.String.with("viewId","Custom editor view id. This should be the viewType string for custom editors or the notebookType string for notebooks. Use 'default' to use VS Code's default text editor"),new jt("columnOrOptions","Either the column in which to open or editor options, see vscode.TextDocumentShowOptions",n=>n===void 0||typeof n=="number"||typeof n=="object",n=>n&&(typeof n=="number"?[Ma.from(n),void 0]:[Ma.from(n.viewColumn),Dj.from(n)])).optional()],ir.Void),new vr("vscode.diff","_workbench.diff","Opens the provided resources in the diff editor to compare their contents.",[jt.Uri.with("left","Left-hand side resource of the diff editor"),jt.Uri.with("right","Right-hand side resource of the diff editor"),jt.String.with("title","Human readable title for the diff editor").optional(),new jt("columnOrOptions","Either the column in which to open or editor options, see vscode.TextDocumentShowOptions",n=>n===void 0||typeof n=="object",n=>n&&[Ma.from(n.viewColumn),Dj.from(n)]).optional()],ir.Void),new vr("vscode.changes","_workbench.changes","Opens a list of resources in the changes editor to compare their contents.",[jt.String.with("title","Human readable title for the changes editor"),new jt("resourceList","List of resources to compare",n=>{for(const e of n){if(e.length!==3)return!1;const[t,r,i]=e;if(!Te.isUri(t)||!Te.isUri(r)&&r!==void 0&&r!==null||!Te.isUri(i)&&i!==void 0&&i!==null)return!1}return!0},n=>n)],ir.Void),new vr("vscode.prepareTypeHierarchy","_executePrepareTypeHierarchy","Prepare type hierarchy at a position inside a document",[jt.Uri,jt.Position],new ir("A promise that resolves to an array of TypeHierarchyItem-instances",n=>n.map($P.to))),new vr("vscode.provideSupertypes","_executeProvideSupertypes","Compute supertypes for an item",[jt.TypeHierarchyItem],new ir("A promise that resolves to an array of TypeHierarchyItem-instances",n=>n.map($P.to))),new vr("vscode.provideSubtypes","_executeProvideSubtypes","Compute subtypes for an item",[jt.TypeHierarchyItem],new ir("A promise that resolves to an array of TypeHierarchyItem-instances",n=>n.map($P.to))),new vr("vscode.revealTestInExplorer","_revealTestInExplorer","Reveals a test instance in the explorer",[jt.TestItem],ir.Void),new vr("vscode.experimental.editSession.continue","_workbench.editSessions.actions.continueEditSession","Continue the current edit session in a different workspace",[jt.Uri.with("workspaceUri","The target workspace to continue the current edit session in")],ir.Void),new vr("setContext","_setContext","Set a custom context key value that can be used in when clauses.",[jt.String.with("name","The context key name"),new jt("value","The context key value",()=>!0,n=>n)],ir.Void),new vr("vscode.executeMappedEditsProvider","_executeMappedEditsProvider","Execute Mapped Edits Provider",[jt.Uri,jt.StringArray,new jt("MappedEditsContext","Mapped Edits Context",n=>ale.is(n),n=>ale.from(n))],new ir("A promise that resolves to a workspace edit or null",n=>n?Jl.to(n):null))];class Tin{static register(e){kin.forEach(e.registerApiCommand,e),this._registerValidateWhenClausesCommand(e)}static _registerValidateWhenClausesCommand(e){e.registerCommand(!1,"_validateWhenClauses",_Ye)}}function fm(n){return e=>{if(Array.isArray(e))return e.map(n)}}function XA(n){if(!Array.isArray(n))return;const e=[];for(const t of n)SYe(t)?e.push(PW.to(t)):e.push(CS.to(t));return e}let yQ=class{constructor(e,t){this._proxy=e.getProxy(dn.MainThreadBulkEdits),this._versionInformationProvider={getTextDocumentVersion:r=>{var i;return(i=t.getDocument(r))==null?void 0:i.version},getNotebookDocumentVersion:()=>{}}}applyWorkspaceEdit(e,t,r){const i=new _y(Jl.from(e,this._versionInformationProvider));return this._proxy.$tryApplyWorkspaceEdit(i,void 0,(r==null?void 0:r.isRefactoring)??!1)}};yQ=An([Be(0,Ii)],yQ);class Din{constructor(e,t,r,i,o){this._extension=e,this._request=t,this._proxy=r,this._commandsConverter=i,this._sessionDisposables=o,this._stopWatch=E2.create(!1),this._isClosed=!1}close(){this._isClosed=!0}get timings(){return{firstProgress:this._firstProgress,totalElapsed:this._stopWatch.elapsed()}}get apiObject(){if(!this._apiObject){let t=function(i){if(e._isClosed){const o=new Error("Response stream has been closed");throw Error.captureStackTrace(o,i),o}};const e=this;this._stopWatch.reset();const r=i=>{typeof this._firstProgress>"u"&&"content"in i&&(this._firstProgress=this._stopWatch.elapsed()),this._proxy.$handleProgressChunk(this._request.requestId,i)};this._apiObject={markdown(i){t(this.markdown);const o=new Zxe(i),s=IYe.from(o);return r(s),this},markdownWithVulnerabilities(i,o){t(this.markdown),o&&vt(e._extension,"chatParticipantAdditions");const s=new DW(i,o),a=PYe.from(s);return r(a),this},filetree(i,o){t(this.filetree);const s=new Xxe(i,o),a=kYe.from(s);return r(a),this},anchor(i,o){t(this.anchor);const s=new Yxe(i,o),a=TYe.from(s);return r(a),this},button(i){t(this.anchor);const o=new Jxe(i),s=DYe.from(o,e._commandsConverter,e._sessionDisposables);return r(s),this},progress(i){t(this.progress);const o=new MM(i),s=RW.from(o);return r(s),this},reference(i,o){var s;if(t(this.reference),"variableName"in i&&!i.value){const a=e._request.variables.variables.find(c=>c.name===i.variableName);if(a){let c;if((s=a.references)!=null&&s.length)c=a.references.map(l=>({kind:"reference",reference:{variableName:i.variableName,value:l.reference}}));else{const l=new EC(i,o);c=[OM.from(l)]}return c.forEach(l=>r(l)),this}}else{const a=new EC(i,o),c=OM.from(a);r(c)}return this},textEdit(i,o){t(this.textEdit),vt(e._extension,"chatParticipantAdditions");const s=new AW(i,o),a=RYe.from(s);return r(a),this},detectedParticipant(i,o){t(this.detectedParticipant),vt(e._extension,"chatParticipantAdditions");const s=new OW(i,o),a=AYe.from(s);return r(a),this},push(i){if(t(this.push),(i instanceof AW||i instanceof DW||i instanceof OW)&&vt(e._extension,"chatParticipantAdditions"),i instanceof EC)this.reference(i.value,i.iconPath);else{const o=Kxe.from(i,e._commandsConverter,e._sessionDisposables);r(o)}return this}}}return this._apiObject}}const Ik=class Ik extends Dr{constructor(e,t,r){super(),this._logService=t,this.commands=r,this._agents=new Map,this._sessionDisposables=this._register(new ZGe),this._completionDisposables=this._register(new ei),this._proxy=e.getProxy(dn.MainThreadChatAgents2)}transferActiveChat(e){this._proxy.$transferActiveChatSession(e)}createChatAgent(e,t,r){const i=Ik._idPool++,o=new hCe(e,t,this._proxy,i,r);return this._agents.set(i,o),this._proxy.$registerAgent(i,e.identifier,t,{},void 0),o.apiAgent}createDynamicChatAgent(e,t,r,i,o){const s=Ik._idPool++,a=new hCe(e,t,this._proxy,s,o);return this._agents.set(s,a),this._proxy.$registerAgent(s,e.identifier,t,{isSticky:!0},{name:r,description:i}),a.apiAgent}async $invokeAgent(e,t,r,i){const o=this._agents.get(e);if(!o)throw new Error(`[CHAT](${e}) CANNOT invoke agent because the agent is not registered`);let s=this._sessionDisposables.get(t.sessionId);s||(s=new ei,this._sessionDisposables.set(t.sessionId,s));const a=new Din(o.extension,t,this._proxy,this.commands.converter,s);try{const c=await this.prepareHistoryTurns(t.agentId,r),l=o.invoke(wYe.to(t),{history:c},a.apiObject,i);return await kW(Promise.resolve(l).then(u=>{if(u!=null&&u.metadata)try{JSON.stringify(u.metadata)}catch(d){const h=`result.metadata MUST be JSON.stringify-able. Got error: ${d.message}`;return this._logService.error(`[${o.extension.identifier.value}] [@${o.id}] ${h}`,o.extension),{errorDetails:{message:h},timings:a.timings}}return{errorDetails:u==null?void 0:u.errorDetails,timings:a.timings,metadata:u==null?void 0:u.metadata}}),i)}catch(c){return this._logService.error(c,o.extension),{errorDetails:{message:UT(c),responseIsIncomplete:!0}}}finally{a.close()}}async prepareHistoryTurns(e,t){const r=[];for(const i of t.history){const o=Rj.to(i.result),s=e===i.request.agentId?o:{...o,metadata:void 0};r.push(new qxe(i.request.message,i.request.command,i.request.variables.variables.map(CYe.to),i.request.agentId));const a=Qp(i.response.map(c=>Kxe.toContent(c,this.commands.converter)));r.push(new Gxe(a,s,i.request.agentId,i.request.command))}return r}$releaseSession(e){this._sessionDisposables.deleteAndDispose(e)}async $provideFollowups(e,t,r,i,o){const s=this._agents.get(t);if(!s)return Promise.resolve([]);const a=await this.prepareHistoryTurns(s.id,i),c=Rj.to(r);return(await s.provideFollowups(c,{history:a},o)).filter(l=>{const u=!l.participant||uee.some(this._agents.values(),d=>d.id===l.participant&&jc.equals(d.extension.identifier,s.extension.identifier));return u||this._logService.warn(`[@${s.id}] ChatFollowup refers to an unknown participant: ${l.participant}`),u}).map(l=>cle.from(l,e))}$acceptFeedback(e,t,r,i){const o=this._agents.get(e);if(!o)return;const s=Rj.to(t);let a;switch(r){case lle.Down:a=TW.Unhelpful;break;case lle.Up:a=TW.Helpful;break}o.acceptFeedback(Object.freeze(i?{result:s,kind:a,reportIssue:i}:{result:s,kind:a}))}$acceptAction(e,t,r){const i=this._agents.get(e);if(!i||r.action.kind==="vote")return;const o=xYe.to(t,r,this.commands.converter);o&&i.acceptAction(Object.freeze(o))}async $invokeCompletionProvider(e,t,r){const i=this._agents.get(e);return i?(await i.invokeCompletionProvider(t,r)).map(s=>EYe.from(s,this.commands.converter,this._completionDisposables)):[]}async $provideWelcomeMessage(e,t,r){const i=this._agents.get(e);if(i)return await i.provideWelcomeMessage(ule.to(t),r)}async $provideSampleQuestions(e,t,r){const i=this._agents.get(e);if(i)return(await i.provideSampleQuestions(ule.to(t),r)).map(o=>cle.from(o,void 0))}};Ik._idPool=0;let bQ=Ik;class hCe{constructor(e,t,r,i,o){this.extension=e,this.id=t,this._proxy=r,this._handle=i,this._requestHandler=o,this._onDidReceiveFeedback=new ft,this._onDidPerformAction=new ft}acceptFeedback(e){this._onDidReceiveFeedback.fire(e)}acceptAction(e){this._onDidPerformAction.fire(e)}async invokeCompletionProvider(e,t){return this._agentVariableProvider?await this._agentVariableProvider.provider.provideCompletionItems(e,t)??[]:[]}async provideFollowups(e,t,r){if(!this._followupProvider)return[];const i=await this._followupProvider.provideFollowups(e,t,r);return i?i.filter(o=>!(o&&"commandId"in o)).filter(o=>!(o&&"message"in o)):[]}async provideWelcomeMessage(e,t){if(!this._welcomeMessageProvider)return[];const r=await this._welcomeMessageProvider.provideWelcomeMessage(e,t);return r?r.map(i=>typeof i=="string"?i:$a.from(i)):[]}async provideSampleQuestions(e,t){if(!this._welcomeMessageProvider||!this._welcomeMessageProvider.provideSampleQuestions)return[];const r=await this._welcomeMessageProvider.provideSampleQuestions(e,t);return r||[]}get apiAgent(){let e=!1,t=!1;const r=()=>{e||t||(t=!0,queueMicrotask(()=>{this._proxy.$updateAgent(this._handle,{fullName:this._fullName,icon:this._iconPath?this._iconPath instanceof Te?this._iconPath:"light"in this._iconPath?this._iconPath.light:void 0:void 0,iconDark:this._iconPath&&"dark"in this._iconPath?this._iconPath.dark:void 0,themeIcon:this._iconPath instanceof Q0?this._iconPath:void 0,hasFollowups:this._followupProvider!==void 0,isSecondary:this._isSecondary,helpTextPrefix:!this._helpTextPrefix||typeof this._helpTextPrefix=="string"?this._helpTextPrefix:$a.from(this._helpTextPrefix),helpTextVariablesPrefix:!this._helpTextVariablesPrefix||typeof this._helpTextVariablesPrefix=="string"?this._helpTextVariablesPrefix:$a.from(this._helpTextVariablesPrefix),helpTextPostfix:!this._helpTextPostfix||typeof this._helpTextPostfix=="string"?this._helpTextPostfix:$a.from(this._helpTextPostfix),sampleRequest:this._sampleRequest,supportIssueReporting:this._supportIssueReporting,requester:this._requester}),t=!1}))},i=this;return{get id(){return i.id},get fullName(){return vt(i.extension,"defaultChatParticipant"),i._fullName??i.extension.displayName??i.extension.name},set fullName(o){vt(i.extension,"defaultChatParticipant"),i._fullName=o,r()},get iconPath(){return i._iconPath},set iconPath(o){i._iconPath=o,r()},get requestHandler(){return i._requestHandler},set requestHandler(o){O2e(typeof o=="function","Invalid request handler"),i._requestHandler=o},get followupProvider(){return i._followupProvider},set followupProvider(o){i._followupProvider=o,r()},get isDefault(){return vt(i.extension,"defaultChatParticipant"),i._isDefault},set isDefault(o){vt(i.extension,"defaultChatParticipant"),i._isDefault=o,r()},get helpTextPrefix(){return vt(i.extension,"defaultChatParticipant"),i._helpTextPrefix},set helpTextPrefix(o){vt(i.extension,"defaultChatParticipant"),i._helpTextPrefix=o,r()},get helpTextVariablesPrefix(){return vt(i.extension,"defaultChatParticipant"),i._helpTextVariablesPrefix},set helpTextVariablesPrefix(o){vt(i.extension,"defaultChatParticipant"),i._helpTextVariablesPrefix=o,r()},get helpTextPostfix(){return vt(i.extension,"defaultChatParticipant"),i._helpTextPostfix},set helpTextPostfix(o){vt(i.extension,"defaultChatParticipant"),i._helpTextPostfix=o,r()},get isSecondary(){return vt(i.extension,"defaultChatParticipant"),i._isSecondary},set isSecondary(o){vt(i.extension,"defaultChatParticipant"),i._isSecondary=o,r()},get sampleRequest(){return i._sampleRequest},set sampleRequest(o){i._sampleRequest=o,r()},get supportIssueReporting(){return vt(i.extension,"chatParticipantAdditions"),i._supportIssueReporting},set supportIssueReporting(o){vt(i.extension,"chatParticipantAdditions"),i._supportIssueReporting=o,r()},get onDidReceiveFeedback(){return i._onDidReceiveFeedback.event},set participantVariableProvider(o){if(vt(i.extension,"chatParticipantAdditions"),i._agentVariableProvider=o,o){if(!o.triggerCharacters.length)throw new Error("triggerCharacters are required");i._proxy.$registerAgentCompletionsProvider(i._handle,o.triggerCharacters)}else i._proxy.$unregisterAgentCompletionsProvider(i._handle)},get participantVariableProvider(){return vt(i.extension,"chatParticipantAdditions"),i._agentVariableProvider},set welcomeMessageProvider(o){vt(i.extension,"defaultChatParticipant"),i._welcomeMessageProvider=o,r()},get welcomeMessageProvider(){return vt(i.extension,"defaultChatParticipant"),i._welcomeMessageProvider},onDidPerformAction:Oa(this.extension,"chatParticipantAdditions")?this._onDidPerformAction.event:void 0,set requester(o){i._requester=o,r()},get requester(){return i._requester},dispose(){e=!0,i._followupProvider=void 0,i._onDidReceiveFeedback.dispose(),i._proxy.$unregisterAgent(i._handle)}}}invoke(e,t,r,i){return this._requestHandler(e,t,r,i)}}const PL=class PL{constructor(e){this._resolver=new Map,this._proxy=e.getProxy(dn.MainThreadChatVariables)}async $resolveVariable(e,t,r,i){const o=this._resolver.get(e);if(o)try{if(o.resolver.resolve2){vt(o.extension,"chatParticipantAdditions");const s=new Rin(t,this._proxy),a=await o.resolver.resolve2(o.data.name,{prompt:r},s.apiObject,i);if(a)return a.map(dle.from)}else{const s=await o.resolver.resolve(o.data.name,{prompt:r},i);if(s)return s.map(dle.from)}}catch(s){fee(s)}}registerVariableResolver(e,t,r,i){const o=PL._idPool++;return this._resolver.set(o,{extension:e,data:{name:t,description:r},resolver:i}),this._proxy.$registerVariable(o,{name:t,description:r}),ho(()=>{this._resolver.delete(o),this._proxy.$unregisterVariable(o)})}};PL._idPool=0;let SQ=PL;class Rin{constructor(e,t){this._requestId=e,this._proxy=t,this._isClosed=!1}close(){this._isClosed=!0}get apiObject(){if(!this._apiObject){let t=function(i){if(e._isClosed){const o=new Error("Response stream has been closed");throw Error.captureStackTrace(o,i),o}};const e=this,r=i=>{this._proxy.$handleProgressChunk(this._requestId,i)};this._apiObject={progress(i){t(this.progress);const o=new MM(i),s=RW.from(o);return r(s),this},reference(i){t(this.reference);const o=new EC(i),s=OM.from(o);return r(s),this},push(i){return t(this.push),i instanceof EC?r(OM.from(i)):i instanceof MM&&r(RW.from(i)),this}}}return this._apiObject}}class Ain{constructor(e){const t=e.getProxy(dn.MainThreadClipboard);this.value=Object.freeze({readText(){return t.$readText()},writeText(r){return t.$writeText(r)}})}}const pHe="vscode-cdn.net",Oin=`vscode-resource.${pHe}`,_Q=`'self' https://*.${pHe}`;function Ck(n,e){return n.scheme===hr.http||n.scheme===hr.https?n:(e&&e.authority&&e.isRemote&&n.scheme===hr.file&&(n=Te.from({scheme:hr.vscodeRemote,authority:e.authority,path:n.path})),Te.from({scheme:hr.https,authority:`${n.scheme}+${Min(n.authority)}.${Oin}`,path:n.path,fragment:n.fragment,query:n.query}))}function Min(n){return n.replace(/./g,e=>{const t=e.charCodeAt(0);return t>=97&&t<=122||t>=65&&t<=90||t>=48&&t<=57?e:"-"+t.toString(16).padStart(4,"0")})}class $in{constructor(e,t,r){this._proxy=e,this._editors=t,this._remoteInfo=r,this._handlePool=0,this._disposables=new ei,this._insets=new Map,this._disposables.add(t.onDidChangeVisibleTextEditors(()=>{const i=t.getVisibleTextEditors();for(const o of this._insets.values())i.indexOf(o.editor)<0&&o.inset.dispose()}))}dispose(){this._insets.forEach(e=>e.inset.dispose()),this._disposables.dispose()}createWebviewEditorInset(e,t,r,i,o){let s;for(const f of this._editors.getVisibleTextEditors(!0))if(f.value===e){s=f;break}if(!s)throw new Error("not a visible editor");const a=this,c=this._handlePool++,l=new ft,u=new ft,d=new class{constructor(){this._html="",this._options=Object.create(null)}asWebviewUri(f){return Ck(f,a._remoteInfo)}get cspSource(){return _Q}set options(f){this._options=f,a._proxy.$setOptions(c,f)}get options(){return this._options}set html(f){this._html=f,a._proxy.$setHtml(c,f)}get html(){return this._html}get onDidReceiveMessage(){return l.event}postMessage(f){return a._proxy.$postMessage(c,f)}},h=new class{constructor(){this.editor=e,this.line=t,this.height=r,this.webview=d,this.onDidDispose=u.event}dispose(){a._insets.has(c)&&(a._insets.delete(c),a._proxy.$disposeEditorInset(c),u.fire(),u.dispose(),l.dispose())}};return this._proxy.$createEditorInset(c,s.id,s.value.document.uri,t+1,r,i||{},o.identifier,o.extensionLocation),this._insets.set(c,{editor:e,inset:h,onDidReceiveMessage:l}),h}$onDidDispose(e){const t=this._insets.get(e);t&&t.inset.dispose()}$onDidReceiveMessage(e,t){const r=this._insets.get(e);r==null||r.onDidReceiveMessage.fire(t)}}function Lin(n,e,t){const r=n.getProxy(dn.MainThreadComments),f=class f{constructor(){this._commentControllers=new Map,this._commentControllersByExtension=new jy,e.registerArgumentProcessor({processArgument:m=>{if(m&&m.$mid===6){const v=this._commentControllers.get(m.handle);return v?v.value:m}else if(m&&m.$mid===7){const v=m,b=this._commentControllers.get(v.commentControlHandle);if(!b)return v;const S=b.getCommentThread(v.commentThreadHandle);return S?S.value:v}else if(m&&(m.$mid===9||m.$mid===8)){const v=this._commentControllers.get(m.thread.commentControlHandle);if(!v)return m;const b=v.getCommentThread(m.thread.commentThreadHandle);return b?m.$mid===8?b.value:{thread:b.value,text:m.text}:m}else if(m&&m.$mid===10){const v=this._commentControllers.get(m.thread.commentControlHandle);if(!v)return m;const b=v.getCommentThread(m.thread.commentThreadHandle);if(!b)return m;const S=m.commentUniqueId,E=b.getCommentByUniqueId(S);return E||m}else if(m&&m.$mid===11){const v=this._commentControllers.get(m.thread.commentControlHandle);if(!v)return m;const b=v.getCommentThread(m.thread.commentThreadHandle);if(!b)return m;const S=m.text,E=m.commentUniqueId,w=b.getCommentByUniqueId(E);return w?(typeof w.body=="string"?w.body=S:w.body=new T2(S),w):m}return m}})}createCommentController(m,v,b){const S=f.handlePool++,E=new s(m,S,v,b);this._commentControllers.set(E.handle,E);const w=this._commentControllersByExtension.get(m.identifier)||[];return w.push(E),this._commentControllersByExtension.set(m.identifier,w),E.value}async $createCommentThreadTemplate(m,v,b){const S=this._commentControllers.get(m);S&&S.$createCommentThreadTemplate(v,b)}async $setActiveComment(m,v){const b=this._commentControllers.get(m);b&&b.$setActiveComment(v??void 0)}async $updateCommentThreadTemplate(m,v,b){const S=this._commentControllers.get(m);S&&S.$updateCommentThreadTemplate(v,b)}$deleteCommentThread(m,v){const b=this._commentControllers.get(m);b==null||b.$deleteCommentThread(v)}async $provideCommentingRanges(m,v,b){const S=this._commentControllers.get(m);if(!S||!S.commentingRangeProvider)return Promise.resolve(void 0);const E=await t.ensureDocumentData(Te.revive(v));return Lc(async()=>{const w=await S.commentingRangeProvider.provideCommentingRanges(E.document,b);let C;return Array.isArray(w)?C={ranges:w,fileComments:!1}:w?C={ranges:w.ranges||[],fileComments:w.fileComments||!1}:C=w??void 0,C}).then(w=>{let C;return w&&(C={ranges:w.ranges.map(I=>Rn.from(I)),fileComments:w.fileComments}),C})}$toggleReaction(m,v,b,S,E){const w=this._commentControllers.get(m);return!w||!w.reactionHandler?Promise.resolve(void 0):Lc(()=>{const C=w.getCommentThread(v);if(C){const I=C.getCommentByUniqueId(S.uniqueIdInThread);if(w!==void 0&&I&&w.reactionHandler)return w.reactionHandler(I,l(E))}return Promise.resolve(void 0)})}};f.handlePool=0;let i=f;const p=class p{set threadId(m){this._id=m}get threadId(){return this._id}get id(){return this._id}get resource(){return this._uri}get uri(){return this._uri}set range(m){(m===void 0!=(this._range===void 0)||!m||!this._range||!m.isEqual(this._range))&&(this._range=m,this.modifications.range=m,this._onDidUpdateCommentThread.fire())}get range(){return this._range}set canReply(m){this._canReply!==m&&(this._canReply=m,this.modifications.canReply=m,this._onDidUpdateCommentThread.fire())}get canReply(){return this._canReply}get label(){return this._label}set label(m){this._label=m,this.modifications.label=m,this._onDidUpdateCommentThread.fire()}get contextValue(){return this._contextValue}set contextValue(m){this._contextValue=m,this.modifications.contextValue=m,this._onDidUpdateCommentThread.fire()}get comments(){return this._comments}set comments(m){this._comments=m,this.modifications.comments=m,this._onDidUpdateCommentThread.fire()}get collapsibleState(){return this._collapseState}set collapsibleState(m){this._collapseState=m,this.modifications.collapsibleState=m,this._onDidUpdateCommentThread.fire()}get state(){return this._state}set state(m){this._state=m,typeof m=="object"?(vt(this.extensionDescription,"commentThreadApplicability"),this.modifications.state=m.resolved,this.modifications.applicability=m.applicability):this.modifications.state=m,this._onDidUpdateCommentThread.fire()}get isDisposed(){return this._isDiposed}constructor(m,v,b,S,E,w,C,I){this._commentControllerHandle=v,this._id=b,this._uri=S,this._range=E,this._comments=w,this.extensionDescription=C,this._isTemplate=I,this.handle=p._handlePool++,this.commentHandle=0,this.modifications=Object.create(null),this._onDidUpdateCommentThread=new ft,this.onDidUpdateCommentThread=this._onDidUpdateCommentThread.event,this._canReply=!0,this._commentsMap=new Map,this._acceptInputDisposables=new zp,this._acceptInputDisposables.value=new ei,this._id===void 0&&(this._id=`${m}.${this.handle}`),r.$createCommentThread(v,this.handle,this._id,this._uri,Rn.from(this._range),C.identifier,this._isTemplate),this._localDisposables=[],this._isDiposed=!1,this._localDisposables.push(this.onDidUpdateCommentThread(()=>{this.eventuallyUpdateCommentThread()})),this.comments=w,this._localDisposables.push({dispose:()=>{r.$deleteCommentThread(v,this.handle)}});const T=this;this.value={get uri(){return T.uri},get range(){return T.range},set range(D){T.range=D},get comments(){return T.comments},set comments(D){T.comments=D},get collapsibleState(){return T.collapsibleState},set collapsibleState(D){T.collapsibleState=D},get canReply(){return T.canReply},set canReply(D){T.canReply=D},get contextValue(){return T.contextValue},set contextValue(D){T.contextValue=D},get label(){return T.label},set label(D){T.label=D},get state(){return T.state},set state(D){T.state=D},dispose:()=>{T.dispose()}}}updateIsTemplate(){this._isTemplate&&(this._isTemplate=!1,this.modifications.isTemplate=!1)}eventuallyUpdateCommentThread(){if(this._isDiposed)return;this.updateIsTemplate(),this._acceptInputDisposables.value||(this._acceptInputDisposables.value=new ei);const m=b=>Object.prototype.hasOwnProperty.call(this.modifications,b),v={};m("range")&&(v.range=Rn.from(this._range)),m("label")&&(v.label=this.label),m("contextValue")&&(v.contextValue=this.contextValue??null),m("comments")&&(v.comments=this._comments.map(b=>a(this,b,this._commentsMap,this.extensionDescription))),m("collapsibleState")&&(v.collapseState=u(this._collapseState)),m("canReply")&&(v.canReply=this.canReply),m("state")&&(v.state=d(this._state)),m("applicability")&&(v.applicability=h(this._state)),m("isTemplate")&&(v.isTemplate=this._isTemplate),this.modifications={},r.$updateCommentThread(this._commentControllerHandle,this.handle,this._id,this._uri,v)}getCommentByUniqueId(m){for(const v of this._commentsMap){const b=v[0],S=v[1];if(m===S)return b}}dispose(){this._isDiposed=!0,this._acceptInputDisposables.dispose(),this._localDisposables.forEach(m=>m.dispose())}};p._handlePool=0;let o=p;class s{get id(){return this._id}get label(){return this._label}get handle(){return this._handle}get commentingRangeProvider(){return this._commentingRangeProvider}set commentingRangeProvider(m){this._commentingRangeProvider=m,m!=null&&m.resourceHints&&vt(this._extension,"commentingRangeHint"),r.$updateCommentingRanges(this.handle,m==null?void 0:m.resourceHints)}get reactionHandler(){return this._reactionHandler}set reactionHandler(m){this._reactionHandler=m,r.$updateCommentControllerFeatures(this.handle,{reactionHandler:!!m})}get options(){return this._options}set options(m){this._options=m,r.$updateCommentControllerFeatures(this.handle,{options:this._options})}get activeComment(){return vt(this._extension,"activeComment"),this._activeComment}get activeCommentThread(){return vt(this._extension,"activeComment"),this._activeThread}constructor(m,v,b,S){this._extension=m,this._handle=v,this._id=b,this._label=S,this._threads=new Map,r.$registerCommentController(this.handle,b,S,this._extension.identifier.value);const E=this;this.value=Object.freeze({id:E.id,label:E.label,get options(){return E.options},set options(w){E.options=w},get commentingRangeProvider(){return E.commentingRangeProvider},set commentingRangeProvider(w){E.commentingRangeProvider=w},get reactionHandler(){return E.reactionHandler},set reactionHandler(w){E.reactionHandler=w},get activeCommentThread(){return E.activeCommentThread},createCommentThread(w,C,I){return E.createCommentThread(w,C,I).value},dispose:()=>{E.dispose()}}),this._localDisposables=[],this._localDisposables.push({dispose:()=>{r.$unregisterCommentController(this.handle)}})}createCommentThread(m,v,b){v===void 0&&vt(this._extension,"fileComments");const S=new o(this.id,this.handle,void 0,m,v,b,this._extension,!1);return this._threads.set(S.handle,S),S}$setActiveComment(m){if(!m){this._activeComment=void 0,this._activeThread=void 0;return}const v=this._threads.get(m.commentThreadHandle);v&&(this._activeComment=m.uniqueIdInThread?v.getCommentByUniqueId(m.uniqueIdInThread):void 0,this._activeThread=v)}$createCommentThreadTemplate(m,v){const b=new o(this.id,this.handle,void 0,Te.revive(m),Rn.to(v),[],this._extension,!0);return b.collapsibleState=KR.Expanded,this._threads.set(b.handle,b),b}$updateCommentThreadTemplate(m,v){const b=this._threads.get(m);b&&(b.range=Rn.to(v))}$deleteCommentThread(m){const v=this._threads.get(m);v==null||v.dispose(),this._threads.delete(m)}getCommentThread(m){return this._threads.get(m)}dispose(){this._threads.forEach(m=>{m.dispose()}),this._localDisposables.forEach(m=>m.dispose())}}function a(g,m,v,b){var E,w;let S=v.get(m);return S||(S=++g.commentHandle,v.set(m,S)),m.state!==void 0&&vt(b,"commentsDraftState"),(E=m.reactions)!=null&&E.some(C=>C.reactors!==void 0)&&vt(b,"commentReactor"),{mode:m.mode,contextValue:m.contextValue,uniqueIdInThread:S,body:typeof m.body=="string"?m.body:$a.from(m.body),userName:m.author.name,userIconPath:m.author.iconPath,label:m.label,commentReactions:m.reactions?m.reactions.map(C=>c(C)):void 0,state:m.state,timestamp:(w=m.timestamp)==null?void 0:w.toJSON()}}function c(g){return{label:g.label,iconPath:g.iconPath?OYe(g.iconPath):void 0,count:g.count,hasReacted:g.authorHasReacted,reactors:g.reactors&&g.reactors.length>0&&typeof g.reactors[0]!="string"?g.reactors.map(m=>m.name):g.reactors}}function l(g){var m;return{label:g.label||"",count:g.count||0,iconPath:g.iconPath?Te.revive(g.iconPath):"",authorHasReacted:g.hasReacted||!1,reactors:(m=g.reactors)==null?void 0:m.map(v=>({name:v}))}}function u(g){if(g!==void 0)switch(g){case MW.Expanded:return KR.Expanded;case MW.Collapsed:return KR.Collapsed}return KR.Collapsed}function d(g){let m;if(typeof g=="object"?m=g.resolved:m=g,m!==void 0)switch(m){case $W.Unresolved:return Aj.Unresolved;case $W.Resolved:return Aj.Resolved}return Aj.Unresolved}function h(g){let m;if(typeof g=="object"&&(m=g.applicability),m!==void 0)switch(m){case LW.Current:return Oj.Current;case LW.Outdated:return Oj.Outdated}return Oj.Current}return new i}var B1,H1,RT,AT,OT,Dp,U1,z1,V1,W1,MT,s2,q1;class Nin{constructor(e,t,r,i,o,s,a){Tn(this,B1,void 0);Tn(this,H1,void 0);Tn(this,RT,void 0);Tn(this,AT,void 0);Tn(this,OT,void 0);Tn(this,Dp,void 0);Tn(this,U1,void 0);Tn(this,z1,void 0);Tn(this,V1,void 0);Tn(this,W1,void 0);Tn(this,MT,void 0);Tn(this,s2,void 0);Tn(this,q1,void 0);gn(this,U1,""),gn(this,V1,!1),gn(this,W1,!1),this._onMessageEmitter=new ft,this.onDidReceiveMessage=this._onMessageEmitter.event,gn(this,q1,new ft),this._onDidDispose=Qe(this,q1).event,gn(this,B1,e),gn(this,H1,t),gn(this,z1,r),gn(this,AT,i),gn(this,OT,o),gn(this,Dp,s),gn(this,MT,jx(s)),gn(this,s2,Fin(s)),gn(this,RT,a)}dispose(){gn(this,V1,!0),Qe(this,q1).fire(),Qe(this,q1).dispose(),this._onMessageEmitter.dispose()}asWebviewUri(e){return gn(this,W1,!0),Ck(e,Qe(this,AT))}get cspSource(){const e=Qe(this,Dp).extensionLocation;if(e.scheme===hr.https||e.scheme===hr.http){let t=e.toString();return t.endsWith("/")||(t+="/"),t+" "+_Q}return _Q}get html(){return this.assertNotDisposed(),Qe(this,U1)}set html(e){this.assertNotDisposed(),Qe(this,U1)!==e&&(gn(this,U1,e),Qe(this,s2)&&!Qe(this,W1)&&/(["'])vscode-resource:([^\s'"]+?)(["'])/i.test(e)&&(gn(this,W1,!0),Qe(this,RT).report("Webview vscode-resource: uris",Qe(this,Dp),"Please migrate to use the 'webview.asWebviewUri' api instead: https://aka.ms/vscode-webview-use-aswebviewuri")),Qe(this,H1).$setHtml(Qe(this,B1),this.rewriteOldResourceUrlsIfNeeded(e)))}get options(){return this.assertNotDisposed(),Qe(this,z1)}set options(e){this.assertNotDisposed(),by(Qe(this,z1),e)||Qe(this,H1).$setOptions(Qe(this,B1),gHe(Qe(this,Dp),Qe(this,OT),e)),gn(this,z1,e)}async postMessage(e){if(Qe(this,V1))return!1;const t=$Ye(e,{serializeBuffersForPostMessage:Qe(this,MT)});return Qe(this,H1).$postMessage(Qe(this,B1),t.message,...t.buffers)}assertNotDisposed(){if(Qe(this,V1))throw new Error("Webview is disposed")}rewriteOldResourceUrlsIfNeeded(e){var i;if(!Qe(this,s2))return e;const t=((i=Qe(this,Dp).extensionLocation)==null?void 0:i.scheme)===hr.vscodeRemote,r=Qe(this,Dp).extensionLocation.scheme===hr.vscodeRemote?Qe(this,Dp).extensionLocation.authority:void 0;return e.replace(/(["'])(?:vscode-resource):(\/\/([^\s\/'"]+?)(?=\/))?([^\s'"]+?)(["'])/gi,(o,s,a,c,l,u)=>{const d=Te.from({scheme:c||"file",path:decodeURIComponent(l)}),h=Ck(d,{isRemote:t,authority:r}).toString();return`${s}${h}${u}`}).replace(/(["'])(?:vscode-webview-resource):(\/\/[^\s\/'"]+\/([^\s\/'"]+?)(?=\/))?([^\s'"]+?)(["'])/gi,(o,s,a,c,l,u)=>{const d=Te.from({scheme:c||"file",path:decodeURIComponent(l)}),h=Ck(d,{isRemote:t,authority:r}).toString();return`${s}${h}${u}`})}}B1=new WeakMap,H1=new WeakMap,RT=new WeakMap,AT=new WeakMap,OT=new WeakMap,Dp=new WeakMap,U1=new WeakMap,z1=new WeakMap,V1=new WeakMap,W1=new WeakMap,MT=new WeakMap,s2=new WeakMap,q1=new WeakMap;function jx(n){try{const e=Qxe(eEe(n.engines.vscode));return!!e&&e.majorBase>=1&&e.minorBase>=57}catch{return!1}}function Fin(n){try{const e=Qxe(eEe(n.engines.vscode));return e?e.majorBase<1||e.majorBase===1&&e.minorBase<60:!1}catch{return!1}}class jin extends Dr{constructor(e,t,r,i,o){super(),this.remoteInfo=t,this.workspace=r,this._logService=i,this._deprecationService=o,this._webviews=new Map,this._webviewProxy=e.getProxy(dn.MainThreadWebviews)}dispose(){super.dispose();for(const e of this._webviews.values())e.dispose();this._webviews.clear()}$onMessage(e,t,r){const i=this.getWebview(e);if(i){const{message:o}=MYe(t,r.value);i._onMessageEmitter.fire(o)}}$onMissingCsp(e,t){this._logService.warn(`${t} created a webview without a content security policy: https://aka.ms/vscode-webview-missing-csp`)}createNewWebview(e,t,r){const i=new Nin(e,this._webviewProxy,Bin(t),this.remoteInfo,this.workspace,r,this._deprecationService);this._webviews.set(e,i);const o=i._onDidDispose(()=>{o.dispose(),this.deleteWebview(e)});return i}deleteWebview(e){this._webviews.delete(e)}getWebview(e){return this._webviews.get(e)}}function dL(n){return{id:n.identifier,location:n.extensionLocation}}function gHe(n,e,t){return{enableCommandUris:t.enableCommandUris,enableScripts:t.enableScripts,enableForms:t.enableForms,portMapping:t.portMapping,localResourceRoots:t.localResourceRoots||Hin(n,e)}}function Bin(n){var e;return{enableCommandUris:n.enableCommandUris,enableScripts:n.enableScripts,enableForms:n.enableForms,portMapping:n.portMapping,localResourceRoots:(e=n.localResourceRoots)==null?void 0:e.map(t=>Te.from(t))}}function Hin(n,e){return[...((e==null?void 0:e.getWorkspaceFolders())||[]).map(t=>t.uri),n.extensionLocation]}const kL=class kL{constructor(e){this.id=e,this._data=new Map,this._idPool=1}add(e){const t=this._idPool++;return this._data.set(t,e),this.logDebugInfo(),t}get(e,t){return this._data.has(e)?this._data.get(e)[t]:void 0}delete(e){this._data.delete(e),this.logDebugInfo()}logDebugInfo(){kL.enableDebugLogging&&console.log(`${this.id} cache size - ${this._data.size}`)}};kL.enableDebugLogging=!1;let Kd=kL;class Uin{constructor(e,t){this.document=e,this._storagePath=t,this._backupCounter=1,this._edits=new Kd("custom documents")}addEdit(e){return this._edits.add([e])}async undo(e,t){await this.getEdit(e).undo(),t||this.disposeBackup()}async redo(e,t){await this.getEdit(e).redo(),t||this.disposeBackup()}disposeEdits(e){for(const t of e)this._edits.delete(t)}getNewBackupUri(){if(!this._storagePath)throw new Error("Backup requires a valid storage path");const e=Gin(this.document.uri)+this._backupCounter++;return jh(this._storagePath,e)}updateBackup(e){var t;(t=this._backup)==null||t.delete(),this._backup=e}disposeBackup(){var e;(e=this._backup)==null||e.delete(),this._backup=void 0}getEdit(e){const t=this._edits.get(e,0);if(!t)throw new Error("No edit found");return t}}class zin{constructor(){this._documents=new Map}get(e,t){return this._documents.get(this.key(e,t))}add(e,t,r){const i=this.key(e,t.uri);if(this._documents.has(i))throw new Error(`Document already exists for viewType:${e} resource:${t.uri}`);const o=new Uin(t,r);return this._documents.set(i,o),o}delete(e,t){const r=this.key(e,t.uri);this._documents.delete(r)}key(e,t){return`${e}@@@${t}`}}class Vin{constructor(){this._providers=new Map}addTextProvider(e,t,r){return this.add(0,e,t,r)}addCustomProvider(e,t,r){return this.add(1,e,t,r)}get(e){return this._providers.get(e)}add(e,t,r,i){if(this._providers.has(t))throw new Error(`Provider for viewType:${t} already registered`);return this._providers.set(t,{type:e,extension:r,provider:i}),new pi(()=>this._providers.delete(t))}}class Win{constructor(e,t,r,i,o){this._extHostDocuments=t,this._extensionStoragePaths=r,this._extHostWebview=i,this._extHostWebviewPanels=o,this._editorProviders=new Vin,this._documents=new zin,this._proxy=e.getProxy(dn.MainThreadCustomEditors)}registerCustomEditorProvider(e,t,r,i){const o=new ei;return qin(r)?(o.add(this._editorProviders.addTextProvider(t,e,r)),this._proxy.$registerTextEditorProvider(dL(e),t,i.webviewOptions||{},{supportsMove:!!r.moveCustomTextEditor},jx(e))):(o.add(this._editorProviders.addCustomProvider(t,e,r)),YA(r)&&o.add(r.onDidChangeCustomDocument(s=>{const a=this.getCustomDocumentEntry(t,s.document.uri);if(Kin(s)){const c=a.addEdit(s);this._proxy.$onDidEdit(s.document.uri,t,c,s.label)}else this._proxy.$onContentChange(s.document.uri,t)})),this._proxy.$registerCustomEditorProvider(dL(e),t,i.webviewOptions||{},!!i.supportsMultipleEditorsPerDocument,jx(e))),pi.from(o,new pi(()=>{this._proxy.$unregisterEditorProvider(t)}))}async $createCustomDocument(e,t,r,i,o){const s=this._editorProviders.get(t);if(!s)throw new Error(`No provider found for '${t}'`);if(s.type!==1)throw new Error(`Invalid provide type for '${t}'`);const a=Te.revive(e),c=await s.provider.openCustomDocument(a,{backupId:r,untitledDocumentData:i==null?void 0:i.buffer},o);let l;return YA(s.provider)&&this._extensionStoragePaths&&(l=this._extensionStoragePaths.workspaceValue(s.extension)??this._extensionStoragePaths.globalValue(s.extension)),this._documents.add(t,c,l),{editable:YA(s.provider)}}async $disposeCustomDocument(e,t){const r=this._editorProviders.get(t);if(!r)throw new Error(`No provider found for '${t}'`);if(r.type!==1)throw new Error(`Invalid provider type for '${t}'`);const i=Te.revive(e),{document:o}=this.getCustomDocumentEntry(t,i);this._documents.delete(t,o),o.dispose()}async $resolveCustomEditor(e,t,r,i,o,s){const a=this._editorProviders.get(r);if(!a)throw new Error(`No provider found for '${r}'`);const c=Ma.to(o),l=this._extHostWebview.createNewWebview(t,i.contentOptions,a.extension),u=this._extHostWebviewPanels.createNewWebviewPanel(t,r,i.title,c,i.options,l,i.active),d=Te.revive(e);switch(a.type){case 1:{const{document:h}=this.getCustomDocumentEntry(r,d);return a.provider.resolveCustomEditor(h,u,s)}case 0:{const h=this._extHostDocuments.getDocument(d);return a.provider.resolveCustomTextEditor(h,u,s)}default:throw new Error("Unknown webview provider type")}}$disposeEdits(e,t,r){this.getCustomDocumentEntry(t,e).disposeEdits(r)}async $onMoveCustomEditor(e,t,r){const i=this._editorProviders.get(r);if(!i)throw new Error(`No provider found for '${r}'`);if(!i.provider.moveCustomTextEditor)throw new Error(`Provider does not implement move '${r}'`);const o=this._extHostWebviewPanels.getWebviewPanel(e);if(!o)throw new Error("No webview found");const s=Te.revive(t),a=this._extHostDocuments.getDocument(s);await i.provider.moveCustomTextEditor(a,o,Xl.None)}async $undo(e,t,r,i){return this.getCustomDocumentEntry(t,e).undo(r,i)}async $redo(e,t,r,i){return this.getCustomDocumentEntry(t,e).redo(r,i)}async $revert(e,t,r){const i=this.getCustomDocumentEntry(t,e);await this.getCustomEditorProvider(t).revertCustomDocument(i.document,r),i.disposeBackup()}async $onSave(e,t,r){const i=this.getCustomDocumentEntry(t,e);await this.getCustomEditorProvider(t).saveCustomDocument(i.document,r),i.disposeBackup()}async $onSaveAs(e,t,r,i){const o=this.getCustomDocumentEntry(t,e);return this.getCustomEditorProvider(t).saveCustomDocumentAs(o.document,Te.revive(r),i)}async $backup(e,t,r){const i=this.getCustomDocumentEntry(t,e),s=await this.getCustomEditorProvider(t).backupCustomDocument(i.document,{destination:i.getNewBackupUri()},r);return i.updateBackup(s),s.id}getCustomDocumentEntry(e,t){const r=this._documents.get(e,Te.revive(t));if(!r)throw new Error("No custom document found");return r}getCustomEditorProvider(e){const t=this._editorProviders.get(e),r=t==null?void 0:t.provider;if(!r||!YA(r))throw new Error("Custom document is not editable");return r}}function YA(n){return!!n.onDidChangeCustomDocument}function qin(n){return typeof n.resolveCustomTextEditor=="function"}function Kin(n){return typeof n.undo=="function"&&typeof n.redo=="function"}function Gin(n){const e=n.scheme===hr.file||n.scheme===hr.untitled?n.fsPath:n.toString();return YL(e)+""}var a0;const Zin="vs/workbench/api/common/extHostDiagnostics";var Im,E0,ka;const $se=class $se{constructor(e,t,r,i,o,s,a,c){Tn(this,Im,void 0);Tn(this,E0,void 0);Tn(this,ka,void 0);this._name=e,this._owner=t,this._maxDiagnosticsTotal=r,this._maxDiagnosticsPerFile=i,this._modelVersionIdProvider=o,this._isDisposed=!1,this._maxDiagnosticsTotal=Math.max(i,r),gn(this,ka,new Wl(l=>s.getComparisonKey(l))),gn(this,Im,a),gn(this,E0,c)}dispose(){var e;this._isDisposed||(Qe(this,E0).fire([...Qe(this,ka).keys()]),(e=Qe(this,Im))==null||e.$clear(this._owner),Qe(this,ka).clear(),this._isDisposed=!0)}get name(){return this._checkDisposed(),this._name}set(e,t){if(!e){this.clear();return}this._checkDisposed();let r=[];if(Te.isUri(e)){if(!t){this.delete(e);return}Qe(this,ka).set(e,t.slice()),r=[e]}else if(Array.isArray(e)){r=[];let s;e=[...e].sort($se._compareIndexedTuplesByUri);for(const a of e){const[c,l]=a;if((!s||c.toString()!==s.toString())&&(s&&Qe(this,ka).get(s).length===0&&Qe(this,ka).delete(s),s=c,r.push(c),Qe(this,ka).set(c,[])),l){const u=Qe(this,ka).get(c);u==null||u.push(...l)}else{const u=Qe(this,ka).get(c);u&&(u.length=0)}}}if(Qe(this,E0).fire(r),!Qe(this,Im))return;const i=[];let o=0;for(const s of r){let a=[];const c=Qe(this,ka).get(s);if(c)if(c.length>this._maxDiagnosticsPerFile){a=[];const l=[eP.Error,eP.Warning,eP.Information,eP.Hint];e:for(let u=0;u<4;u++)for(const d of c)if(d.severity===l[u]&&a.push({...$M.from(d),modelVersionId:this._modelVersionIdProvider(s)})===this._maxDiagnosticsPerFile)break e;a.push({severity:LYe.Info,message:Ve(Zin,0,"Not showing {0} further errors and warnings.",c.length-this._maxDiagnosticsPerFile),startLineNumber:a[a.length-1].startLineNumber,startColumn:a[a.length-1].startColumn,endLineNumber:a[a.length-1].endLineNumber,endColumn:a[a.length-1].endColumn})}else a=c.map(l=>({...$M.from(l),modelVersionId:this._modelVersionIdProvider(s)}));if(i.push([s,a]),o+=a.length,o>this._maxDiagnosticsTotal)break}Qe(this,Im).$changeMany(this._owner,i)}delete(e){var t;this._checkDisposed(),Qe(this,E0).fire([e]),Qe(this,ka).delete(e),(t=Qe(this,Im))==null||t.$changeMany(this._owner,[[e,void 0]])}clear(){var e;this._checkDisposed(),Qe(this,E0).fire([...Qe(this,ka).keys()]),Qe(this,ka).clear(),(e=Qe(this,Im))==null||e.$clear(this._owner)}forEach(e,t){this._checkDisposed();for(const[r,i]of this)e.call(t,r,i,this)}*[Symbol.iterator](){this._checkDisposed();for(const e of Qe(this,ka).keys())yield[e,this.get(e)]}get(e){this._checkDisposed();const t=Qe(this,ka).get(e);return Array.isArray(t)?Object.freeze(t.slice(0)):[]}has(e){return this._checkDisposed(),Array.isArray(Qe(this,ka).get(e))}_checkDisposed(){if(this._isDisposed)throw new Error("illegal state - object is disposed")}static _compareIndexedTuplesByUri(e,t){return e[0].toString()<t[0].toString()?-1:e[0].toString()>t[0].toString()?1:0}};Im=new WeakMap,E0=new WeakMap,ka=new WeakMap;let hL=$se;var Y0;let wQ=(Y0=class{static _mapper(e){const t=new Wl;for(const r of e)t.set(r,r);return{uris:Object.freeze(Array.from(t.values()))}}constructor(e,t,r,i){this._logService=t,this._fileSystemInfoService=r,this._extHostDocumentsAndEditors=i,this._collections=new Map,this._onDidChangeDiagnostics=new XGe({merge:o=>o.flat(),delay:50}),this.onDidChangeDiagnostics=ns.map(this._onDidChangeDiagnostics.event,a0._mapper),this._proxy=e.getProxy(dn.MainThreadDiagnostics)}createDiagnosticCollection(e,t){const{_collections:r,_proxy:i,_onDidChangeDiagnostics:o,_logService:s,_fileSystemInfoService:a,_extHostDocumentsAndEditors:c}=this,l=new class{$changeMany(h,f){i.$changeMany(h,f),s.trace("[DiagnosticCollection] change many (extension, owner, uris)",e.value,h,f.length===0?"CLEARING":f)}$clear(h){i.$clear(h),s.trace("[DiagnosticCollection] remove all (extension, owner)",e.value,h)}dispose(){i.dispose()}};let u;if(!t)t="_generated_diagnostic_collection_name_#"+a0._idPool++,u=t;else if(!r.has(t))u=t;else{this._logService.warn(`DiagnosticCollection with name '${t}' does already exist.`);do u=t+a0._idPool++;while(r.has(u))}return new class extends hL{constructor(){super(t,u,a0._maxDiagnosticsTotal,a0._maxDiagnosticsPerFile,h=>{var f;return(f=c.getDocument(h))==null?void 0:f.version},a.extUri,l,o),r.set(u,this)}dispose(){super.dispose(),r.delete(u)}}}getDiagnostics(e){if(e)return this._getDiagnostics(e);{const t=new Map,r=[];for(const i of this._collections.values())i.forEach((o,s)=>{let a=t.get(o.toString());typeof a>"u"&&(a=r.length,t.set(o.toString(),a),r.push([o,[]])),r[a][1]=r[a][1].concat(...s)});return r}}_getDiagnostics(e){let t=[];for(const r of this._collections.values())r.has(e)&&(t=t.concat(r.get(e)));return t}$acceptMarkersChange(e){if(!this._mirrorCollection){const t="_generated_mirror",r=new hL(t,t,Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,i=>{},this._fileSystemInfoService.extUri,void 0,this._onDidChangeDiagnostics);this._collections.set(t,r),this._mirrorCollection=r}for(const[t,r]of e)this._mirrorCollection.set(Te.revive(t),r.map($M.to))}},a0=Y0,Y0._idPool=0,Y0._maxDiagnosticsPerFile=1e3,Y0._maxDiagnosticsTotal=1.1*a0._maxDiagnosticsPerFile,Y0);wQ=a0=An([Be(1,Li),Be(2,IE)],wQ);class Xin{constructor(e){this._proxy=e.getProxy(dn.MainThreadDialogs)}showOpenDialog(e,t){return t!=null&&t.allowUIResources&&vt(e,"showLocal"),this._proxy.$showOpenDialog(t).then(r=>r?r.map(i=>Te.revive(i)):void 0)}showSaveDialog(e){return this._proxy.$showSaveDialog(e).then(t=>t?Te.revive(t):void 0)}}const TL=class TL{constructor(e,t,r){this._documentsAndEditors=t,this._logService=r,this._documentContentProviders=new Map,this._proxy=e.getProxy(dn.MainThreadDocumentContentProviders)}registerTextDocumentContentProvider(e,t){if(Object.keys(hr).indexOf(e)>=0)throw new Error(`scheme '${e}' already registered`);const r=TL._handlePool++;this._documentContentProviders.set(r,t),this._proxy.$registerTextContentProvider(r,e);let i;if(typeof t.onDidChange=="function"){let o;i=t.onDidChange(async s=>{if(s.scheme!==e){this._logService.warn(`Provider for scheme '${e}' is firing event for schema '${s.scheme}' which will be IGNORED`);return}if(!this._documentsAndEditors.getDocument(s))return;o&&await o;const a=this.$provideTextDocumentContent(r,s).then(async c=>{if(!c&&typeof c!="string")return;const l=this._documentsAndEditors.getDocument(s);if(!l)return;const u=YGe(c);if(!l.equalLines(u))return this._proxy.$onVirtualDocumentChange(s,c)}).catch(dee).finally(()=>{o===a&&(o=void 0)});o=a})}return new pi(()=>{this._documentContentProviders.delete(r)&&this._proxy.$unregisterTextContentProvider(r),i&&(i.dispose(),i=void 0)})}$provideTextDocumentContent(e,t){const r=this._documentContentProviders.get(e);return r?Promise.resolve(r.provideTextDocumentContent(Te.revive(t),Xl.None)):Promise.reject(new Error(`unsupported uri-scheme: ${t.scheme}`))}};TL._handlePool=0;let CQ=TL;class Yin{constructor(e,t,r,i={timeout:1500,errors:3}){this._logService=e,this._documents=t,this._mainThreadBulkEdits=r,this._thresholds=i,this._callbacks=new JGe,this._badListeners=new WeakMap}dispose(){this._callbacks.clear()}getOnWillSaveTextDocumentEvent(e){return(t,r,i)=>{const s={dispose:this._callbacks.push([t,r,e])};return Array.isArray(i)&&i.push(s),s}}async $participateInSave(e,t){const r=Te.revive(e);let i=!1;const o=setTimeout(()=>i=!0,this._thresholds.timeout),s=[];try{for(const a of[...this._callbacks]){if(i)break;const c=this._documents.getDocument(r),l=await this._deliverEventAsyncAndBlameBadListeners(a,{document:c,reason:tEe.to(t)});s.push(l)}}finally{clearTimeout(o)}return s}_deliverEventAsyncAndBlameBadListeners([e,t,r],i){const o=this._badListeners.get(e);return typeof o=="number"&&o>this._thresholds.errors?Promise.resolve(!1):this._deliverEventAsync(r,e,t,i).then(()=>!0,s=>{if(this._logService.error(`onWillSaveTextDocument-listener from extension '${r.identifier.value}' threw ERROR`),this._logService.error(s),!(s instanceof Error)||s.message!=="concurrent_edits"){const a=this._badListeners.get(e);this._badListeners.set(e,a?a+1:1),typeof a=="number"&&a>this._thresholds.errors&&this._logService.info(`onWillSaveTextDocument-listener from extension '${r.identifier.value}' will now be IGNORED because of timeouts and/or errors`)}return!1})}_deliverEventAsync(e,t,r,i){const o=[],s=Date.now(),{document:a,reason:c}=i,{version:l}=a,u=Object.freeze({document:a,reason:c,waitUntil(d){if(Object.isFrozen(o))throw QGe("waitUntil can not be called async");o.push(Promise.resolve(d))}});try{t.apply(r,[u])}catch(d){return Promise.reject(d)}return new Promise((d,h)=>{const f=setTimeout(()=>h(new Error("timeout")),this._thresholds.timeout);return Promise.all(o).then(p=>{this._logService.debug(`onWillSaveTextDocument-listener from extension '${e.identifier.value}' finished after ${Date.now()-s}ms`),clearTimeout(f),d(p)}).catch(p=>{clearTimeout(f),h(p)})}).then(d=>{const h={edits:[]};for(const f of d)if(Array.isArray(f)&&f.every(p=>p instanceof nEe))for(const{newText:p,newEol:g,range:m}of f)h.edits.push({resource:a.uri,versionId:void 0,textEdit:{range:m&&Rn.from(m),text:p,eol:g&&uxe.from(g)}});if(h.edits.length!==0)return l===a.version?this._mainThreadBulkEdits.$tryApplyWorkspaceEdit(new _y(h)):Promise.reject(new Error("concurrent_edits"))})}}class Jin{constructor(e,t){this._onDidAddDocument=new ft,this._onDidRemoveDocument=new ft,this._onDidChangeDocument=new ft,this._onDidSaveDocument=new ft,this.onDidAddDocument=this._onDidAddDocument.event,this.onDidRemoveDocument=this._onDidRemoveDocument.event,this.onDidChangeDocument=this._onDidChangeDocument.event,this.onDidSaveDocument=this._onDidSaveDocument.event,this._toDispose=new ei,this._documentLoader=new Map,this._proxy=e.getProxy(dn.MainThreadDocuments),this._documentsAndEditors=t,this._documentsAndEditors.onDidRemoveDocuments(r=>{for(const i of r)this._onDidRemoveDocument.fire(i.document)},void 0,this._toDispose),this._documentsAndEditors.onDidAddDocuments(r=>{for(const i of r)this._onDidAddDocument.fire(i.document)},void 0,this._toDispose)}dispose(){this._toDispose.dispose()}getAllDocumentData(){return[...this._documentsAndEditors.allDocuments()]}getDocumentData(e){if(!e)return;const t=this._documentsAndEditors.getDocument(e);if(t)return t}getDocument(e){const t=this.getDocumentData(e);if(!(t!=null&&t.document))throw new Error(`Unable to retrieve document from URI '${e}'`);return t.document}ensureDocumentData(e){const t=this._documentsAndEditors.getDocument(e);if(t)return Promise.resolve(t);let r=this._documentLoader.get(e.toString());return r||(r=this._proxy.$tryOpenDocument(e).then(i=>{this._documentLoader.delete(e.toString());const o=Te.revive(i);return bM(this._documentsAndEditors.getDocument(o))},i=>(this._documentLoader.delete(e.toString()),Promise.reject(i))),this._documentLoader.set(e.toString(),r)),r}createDocumentData(e){return this._proxy.$tryCreateDocument(e).then(t=>Te.revive(t))}$acceptModelLanguageChanged(e,t){const r=Te.revive(e),i=this._documentsAndEditors.getDocument(r);if(!i)throw new Error("unknown document");this._onDidRemoveDocument.fire(i.document),i._acceptLanguageId(t),this._onDidAddDocument.fire(i.document)}$acceptModelSaved(e){const t=Te.revive(e),r=this._documentsAndEditors.getDocument(t);if(!r)throw new Error("unknown document");this.$acceptDirtyStateChanged(e,!1),this._onDidSaveDocument.fire(r.document)}$acceptDirtyStateChanged(e,t){const r=Te.revive(e),i=this._documentsAndEditors.getDocument(r);if(!i)throw new Error("unknown document");i._acceptIsDirty(t),this._onDidChangeDocument.fire({document:i.document,contentChanges:[],reason:void 0})}$acceptModelChanged(e,t,r){const i=Te.revive(e),o=this._documentsAndEditors.getDocument(i);if(!o)throw new Error("unknown document");o._acceptIsDirty(r),o.onEvents(t);let s;t.isUndoing?s=NW.Undo:t.isRedoing&&(s=NW.Redo),this._onDidChangeDocument.fire(NYe({document:o.document,contentChanges:t.changes.map(a=>({range:Rn.to(a.range),rangeOffset:a.rangeOffset,rangeLength:a.rangeLength,text:a.text})),reason:s}))}setWordDefinitionFor(e,t){Vrn(e,t)}}class Qin{constructor(e){this._AiEmbeddingVectorProviders=new Map,this._nextHandle=0,this._proxy=e.getProxy(dn.MainThreadAiEmbeddingVector)}async $provideAiEmbeddingVector(e,t,r){if(this._AiEmbeddingVectorProviders.size===0)throw new Error("No embedding vector providers registered");const i=this._AiEmbeddingVectorProviders.get(e);if(!i)throw new Error("Embedding vector provider not found");const o=await i.provideEmbeddingVector(t,r);if(!o)throw new Error("Embedding vector provider returned undefined");return o}registerEmbeddingVectorProvider(e,t,r){const i=this._nextHandle;return this._nextHandle++,this._AiEmbeddingVectorProviders.set(i,r),this._proxy.$registerAiEmbeddingVectorProvider(t,i),new pi(()=>{this._proxy.$unregisterAiEmbeddingVectorProvider(i),this._AiEmbeddingVectorProviders.delete(i)})}}class eon{constructor(){this._schemes=[]}add(e){this._stateMachine=void 0,this._schemes.push(e)}delete(e){const t=this._schemes.indexOf(e);t>=0&&(this._schemes.splice(t,1),this._stateMachine=void 0)}_initStateMachine(){if(!this._stateMachine){const e=this._schemes.sort(),t=[];let r,i,o=14,s=14;for(const a of e){let c=r?eZe(r,a):0;for(c===0?i=1:i=s;c<a.length;c++)c+1===a.length?(o=s,s=9):s+=1,t.push([i,a.toUpperCase().charCodeAt(c),s]),t.push([i,a.toLowerCase().charCodeAt(c),s]),i=s;r=a,s=o}t.push([9,58,10]),t.push([10,47,12]),this._stateMachine=new FYe(t)}}provideDocumentLinks(e){this._initStateMachine();const t=[],r=jYe.computeLinks({getLineContent(i){return e.lineAt(i-1).text},getLineCount(){return e.lineCount}},this._stateMachine);for(const i of r){const o=jP.to(i);o.target&&t.push(o)}return t}}class fL{constructor(e,t){this._extHostLanguageFeatures=t,this._linkProvider=new eon,this._fsProvider=new Map,this._registeredSchemes=new Set,this._watches=new Map,this._handlePool=0,this._proxy=e.getProxy(dn.MainThreadFileSystem)}dispose(){var e;(e=this._linkProviderRegistration)==null||e.dispose()}registerFileSystemProvider(e,t,r,i={}){if(fL._validateFileSystemProvider(r),this._registeredSchemes.has(t))throw new Error(`a provider for the scheme '${t}' is already registered`);this._linkProviderRegistration||(this._linkProviderRegistration=this._extHostLanguageFeatures.registerDocumentLinkProvider(e,"*",this._linkProvider));const o=this._handlePool++;this._linkProvider.add(t),this._registeredSchemes.add(t),this._fsProvider.set(o,r);let s=2;i.isCaseSensitive&&(s+=1024),i.isReadonly&&(s+=2048),typeof r.copy=="function"&&(s+=8),typeof r.open=="function"&&typeof r.close=="function"&&typeof r.read=="function"&&typeof r.write=="function"&&(vt(e,"fsChunks"),s+=4);let a;i.isReadonly&&rEe(i.isReadonly)&&i.isReadonly.value!==""&&(a={value:i.isReadonly.value,isTrusted:i.isReadonly.isTrusted,supportThemeIcons:i.isReadonly.supportThemeIcons,supportHtml:i.isReadonly.supportHtml,baseUri:i.isReadonly.baseUri,uris:i.isReadonly.uris}),this._proxy.$registerFileSystemProvider(o,t,s,a).catch(l=>{console.error(`FAILED to register filesystem provider of ${e.identifier.value}-extension for the scheme ${t}`),console.error(l)});const c=r.onDidChangeFile(l=>{const u=[];for(const d of l){const{uri:h,type:f}=d;if(h.scheme!==t)continue;let p;switch(f){case u4.Changed:p=0;break;case u4.Created:p=1;break;case u4.Deleted:p=2;break;default:throw new Error("Unknown FileChangeType")}u.push({resource:h,type:p})}this._proxy.$onFileSystemChange(o,u)});return ho(()=>{c.dispose(),this._linkProvider.delete(t),this._registeredSchemes.delete(t),this._fsProvider.delete(o),this._proxy.$unregisterProvider(o)})}static _validateFileSystemProvider(e){if(!e)throw new Error("MISSING provider");if(typeof e.watch!="function")throw new Error("Provider does NOT implement watch");if(typeof e.stat!="function")throw new Error("Provider does NOT implement stat");if(typeof e.readDirectory!="function")throw new Error("Provider does NOT implement readDirectory");if(typeof e.createDirectory!="function")throw new Error("Provider does NOT implement createDirectory");if(typeof e.readFile!="function")throw new Error("Provider does NOT implement readFile");if(typeof e.writeFile!="function")throw new Error("Provider does NOT implement writeFile");if(typeof e.delete!="function")throw new Error("Provider does NOT implement delete");if(typeof e.rename!="function")throw new Error("Provider does NOT implement rename")}static _asIStat(e){const{type:t,ctime:r,mtime:i,size:o,permissions:s}=e;return{type:t,ctime:r,mtime:i,size:o,permissions:s}}$stat(e,t){return Promise.resolve(this._getFsProvider(e).stat(Te.revive(t))).then(r=>fL._asIStat(r))}$readdir(e,t){return Promise.resolve(this._getFsProvider(e).readDirectory(Te.revive(t)))}$readFile(e,t){return Promise.resolve(this._getFsProvider(e).readFile(Te.revive(t))).then(r=>ac.wrap(r))}$writeFile(e,t,r,i){return Promise.resolve(this._getFsProvider(e).writeFile(Te.revive(t),r.buffer,i))}$delete(e,t,r){return Promise.resolve(this._getFsProvider(e).delete(Te.revive(t),r))}$rename(e,t,r,i){return Promise.resolve(this._getFsProvider(e).rename(Te.revive(t),Te.revive(r),i))}$copy(e,t,r,i){const o=this._getFsProvider(e);if(!o.copy)throw new Error('FileSystemProvider does not implement "copy"');return Promise.resolve(o.copy(Te.revive(t),Te.revive(r),i))}$mkdir(e,t){return Promise.resolve(this._getFsProvider(e).createDirectory(Te.revive(t)))}$watch(e,t,r,i){const o=this._getFsProvider(e).watch(Te.revive(r),i);this._watches.set(t,o)}$unwatch(e,t){const r=this._watches.get(t);r&&(r.dispose(),this._watches.delete(t))}$open(e,t,r){const i=this._getFsProvider(e);if(!i.open)throw new Error('FileSystemProvider does not implement "open"');return Promise.resolve(i.open(Te.revive(t),r))}$close(e,t){const r=this._getFsProvider(e);if(!r.close)throw new Error('FileSystemProvider does not implement "close"');return Promise.resolve(r.close(t))}$read(e,t,r,i){const o=this._getFsProvider(e);if(!o.read)throw new Error('FileSystemProvider does not implement "read"');const s=ac.alloc(i);return Promise.resolve(o.read(t,r,s.buffer,0,i)).then(a=>s.slice(0,a))}$write(e,t,r,i){const o=this._getFsProvider(e);if(!o.write)throw new Error('FileSystemProvider does not implement "write"');return Promise.resolve(o.write(t,r,i.buffer,0,i.byteLength))}_getFsProvider(e){const t=this._fsProvider.get(e);if(!t){const r=new Error;throw r.name="ENOPRO",r.message="no provider",r}return t}}class ton{get ignoreCreateEvents(){return!!(this._config&1)}get ignoreChangeEvents(){return!!(this._config&2)}get ignoreDeleteEvents(){return!!(this._config&4)}constructor(e,t,r,i,o,s){this.session=Math.random(),this._onDidCreate=new ft,this._onDidChange=new ft,this._onDidDelete=new ft,this._config=0,s!=null&&s.ignoreCreateEvents&&(this._config+=1),s!=null&&s.ignoreChangeEvents&&(this._config+=2),s!=null&&s.ignoreDeleteEvents&&(this._config+=4);const a=CW(o),c=typeof o=="string",l=s==null?void 0:s.correlate,u=i(d=>{if(!(typeof d.session=="number"&&d.session!==this.session)&&!(l&&typeof d.session>"u")){if(!(s!=null&&s.ignoreCreateEvents))for(const h of d.created){const f=Te.revive(h);a(f.fsPath)&&(!c||t.getWorkspaceFolder(f))&&this._onDidCreate.fire(f)}if(!(s!=null&&s.ignoreChangeEvents))for(const h of d.changed){const f=Te.revive(h);a(f.fsPath)&&(!c||t.getWorkspaceFolder(f))&&this._onDidChange.fire(f)}if(!(s!=null&&s.ignoreDeleteEvents))for(const h of d.deleted){const f=Te.revive(h);a(f.fsPath)&&(!c||t.getWorkspaceFolder(f))&&this._onDidDelete.fire(f)}}});this._disposable=pi.from(this.ensureWatching(e,r,o,s,s==null?void 0:s.correlate),this._onDidCreate,this._onDidChange,this._onDidDelete,u)}ensureWatching(e,t,r,i,o){const s=pi.from();if(typeof r=="string"||i!=null&&i.ignoreChangeEvents&&(i!=null&&i.ignoreCreateEvents)&&(i!=null&&i.ignoreDeleteEvents))return s;const a=e.getProxy(dn.MainThreadFileSystemEventService);let c=!1;(r.pattern.includes(BYe)||r.pattern.includes(HYe))&&(c=!0);let l;return o&&(i!=null&&i.ignoreChangeEvents||i!=null&&i.ignoreCreateEvents||i!=null&&i.ignoreDeleteEvents)&&(l=14,i!=null&&i.ignoreChangeEvents&&(l&=-3),i!=null&&i.ignoreCreateEvents&&(l&=-5),i!=null&&i.ignoreDeleteEvents&&(l&=-9)),a.$watch(t.identifier.value,this.session,r.baseUri,{recursive:c,excludes:(i==null?void 0:i.excludes)??[],filter:l},!!o),pi.from({dispose:()=>a.$unwatch(this.session)})}dispose(){this._disposable.dispose()}get onDidCreate(){return this._onDidCreate.event}get onDidChange(){return this._onDidChange.event}get onDidDelete(){return this._onDidDelete.event}}class non{constructor(e){this._events=e,this.session=this._events.session,this._created=new MP(()=>this._events.created.map(Te.revive)),this._changed=new MP(()=>this._events.changed.map(Te.revive)),this._deleted=new MP(()=>this._events.deleted.map(Te.revive))}get created(){return this._created.value}get changed(){return this._changed.value}get deleted(){return this._deleted.value}}class ron{constructor(e,t,r){this._mainContext=e,this._logService=t,this._extHostDocumentsAndEditors=r,this._onFileSystemEvent=new ft,this._onDidRenameFile=new ft,this._onDidCreateFile=new ft,this._onDidDeleteFile=new ft,this._onWillRenameFile=new AP,this._onWillCreateFile=new AP,this._onWillDeleteFile=new AP,this.onDidRenameFile=this._onDidRenameFile.event,this.onDidCreateFile=this._onDidCreateFile.event,this.onDidDeleteFile=this._onDidDeleteFile.event}createFileSystemWatcher(e,t,r,i){return new ton(this._mainContext,e,t,this._onFileSystemEvent.event,i4.from(r),i)}$onFileEvent(e){this._onFileSystemEvent.fire(new non(e))}$onDidRunFileOperation(e,t){switch(e){case 2:this._onDidRenameFile.fire(Object.freeze({files:t.map(r=>({oldUri:Te.revive(r.source),newUri:Te.revive(r.target)}))}));break;case 1:this._onDidDeleteFile.fire(Object.freeze({files:t.map(r=>Te.revive(r.target))}));break;case 0:case 3:this._onDidCreateFile.fire(Object.freeze({files:t.map(r=>Te.revive(r.target))}));break}}getOnWillRenameFileEvent(e){return this._createWillExecuteEvent(e,this._onWillRenameFile)}getOnWillCreateFileEvent(e){return this._createWillExecuteEvent(e,this._onWillCreateFile)}getOnWillDeleteFileEvent(e){return this._createWillExecuteEvent(e,this._onWillDeleteFile)}_createWillExecuteEvent(e,t){return(r,i,o)=>{const s=function(c){r.call(i,c)};return s.extension=e,t.event(s,void 0,o)}}async $onWillRunFileOperation(e,t,r,i){switch(e){case 2:return await this._fireWillEvent(this._onWillRenameFile,{files:t.map(o=>({oldUri:Te.revive(o.source),newUri:Te.revive(o.target)}))},r,i);case 1:return await this._fireWillEvent(this._onWillDeleteFile,{files:t.map(o=>Te.revive(o.target))},r,i);case 0:case 3:return await this._fireWillEvent(this._onWillCreateFile,{files:t.map(o=>Te.revive(o.target))},r,i)}}async _fireWillEvent(e,t,r,i){const o=new Set,s=[];if(await e.fireAsync(t,i,async(c,l)=>{const u=Date.now(),d=await Promise.resolve(c);d instanceof n7&&(s.push([l.extension,d]),o.add(l.extension.displayName??l.extension.identifier.value)),Date.now()-u>r&&this._logService.warn("SLOW file-participant",l.extension.identifier)}),i.isCancellationRequested||s.length===0)return;const a={edits:[]};for(const[,c]of s){const{edits:l}=Jl.from(c,{getTextDocumentVersion:u=>{var d;return(d=this._extHostDocumentsAndEditors.getDocument(u))==null?void 0:d.version},getNotebookDocumentVersion:()=>{}});a.edits=a.edits.concat(l)}return{edit:a,extensionNames:Array.from(o)}}}const DL=class DL{constructor(e,t){this.extension=e,this.provider=t,this.handle=DL._pool++}};DL._pool=0;let xQ=DL;class ion{constructor(e){this.session=e,this.responses=[]}}const Pk=class Pk{constructor(e,t,r,i){this._documents=r,this._logService=i,this._inputProvider=new Map,this._inputSessions=new Map,this._proxy=e.getProxy(dn.MainThreadInlineChat),t.registerApiCommand(new vr("vscode.editorChat.start","inlineChat.start","Invoke a new editor chat session",[new jt("Run arguments","",o=>!0,o=>{if(o)return{initialRange:o.initialRange?Rn.from(o.initialRange):void 0,initialSelection:P2.isSelection(o.initialSelection)?eg.from(o.initialSelection):void 0,message:o.message,autoSend:o.autoSend,position:o.position?io.from(o.position):void 0}})],ir.Void))}registerProvider(e,t,r){const i=new xQ(e,t);return this._inputProvider.set(i.handle,i),this._proxy.$registerInteractiveEditorProvider(i.handle,(r==null?void 0:r.label)??e.displayName??e.name,e.identifier,typeof t.handleInteractiveEditorResponseFeedback=="function",typeof t.provideFollowups=="function",(r==null?void 0:r.supportReportIssue)??!1),ho(()=>{this._proxy.$unregisterInteractiveEditorProvider(i.handle),this._inputProvider.delete(i.handle)})}async $prepareSession(e,t,r,i){var u;const o=this._inputProvider.get(e);if(!o){this._logService.warn("CANNOT prepare session because the PROVIDER IS GONE");return}const s=this._documents.getDocument(Te.revive(t)),a=eg.to(r),c=await o.provider.prepareInteractiveEditorSession({document:s,selection:a},i);if(!c)return;if(c.wholeRange&&!c.wholeRange.contains(a))throw new Error("InteractiveEditorSessionProvider returned a wholeRange that does not contain the selection.");const l=Pk._nextId++;return this._inputSessions.set(l,new ion(c)),{id:l,placeholder:c.placeholder,input:c.input,slashCommands:(u=c.slashCommands)==null?void 0:u.map(d=>({command:d.command,detail:d.detail,refer:d.refer,executeImmediately:d.executeImmediately})),wholeRange:Rn.from(c.wholeRange),message:c.message}}async $provideResponse(e,t,r,i){const o=this._inputProvider.get(e);if(!o)return;const s=this._inputSessions.get(t.id);if(!s)return;const a={prompt:r.prompt,selection:eg.to(r.selection),wholeRange:Rn.to(r.wholeRange),attempt:r.attempt,live:r.live,previewDocument:this._documents.getDocument(Te.revive(r.previewDocument)),withIntentDetection:r.withIntentDetection};let c=!1;const l={report:async v=>{var b,S,E;if(!r.live&&((b=v.edits)!=null&&b.length))throw new Error("Progress reporting is only supported for live sessions");c||i.isCancellationRequested||await this._proxy.$handleProgressChunk(r.requestId,{message:v.message,edits:(S=v.edits)==null?void 0:S.map(Hf.from),editsShouldBeInstant:v.editsShouldBeInstant,slashCommand:(E=v.slashCommand)==null?void 0:E.command,markdownFragment:T2.isMarkdownString(v.content)?v.content.value:v.content})}},u=Promise.resolve(o.provider.provideInteractiveEditorResponse(s.session,a,l,i));let d;try{d=await kW(u,i)}finally{c=!0}if(!d)return;const h=s.responses.push(d)-1,f={wholeRange:Rn.from(d.wholeRange),placeholder:d.placeholder};if(!Pk._isEditResponse(d))return{...f,id:h,type:"editorEdit",message:$a.from(d.contents),edits:[]};const{edits:p,contents:g}=d,m=g!==void 0?$a.from(g):void 0;return p instanceof n7?{...f,id:h,type:"bulkEdit",edits:Jl.from(p),message:m}:{...f,id:h,type:"editorEdit",edits:p.map(Hf.from),message:m}}async $provideFollowups(e,t,r,i){const o=this._inputProvider.get(e),s=this._inputSessions.get(t),a=s==null?void 0:s.responses[r];if(o&&a&&o.provider.provideFollowups){const c=Promise.resolve(o.provider.provideFollowups(s.session,a,i)),l=await kW(c,i);return l==null?void 0:l.map(UYe.from)}}$handleFeedback(e,t,r,i){var c,l;const o=this._inputProvider.get(e),s=this._inputSessions.get(t),a=s==null?void 0:s.responses[r];if(o&&a){const u=zYe.to(i);(l=(c=o.provider).handleInteractiveEditorResponseFeedback)==null||l.call(c,s.session,a,u)}}$releaseSession(e,t){}static _isEditResponse(e){return typeof e=="object"&&typeof e.edits=="object"}};Pk._nextId=0;let EQ=Pk;class oon{constructor(e,t,r,i,o){this._extHostNotebooks=t,this._textDocumentsAndEditors=r,this._commands=i;const s=new vr("interactive.open","_interactive.open","Open interactive window and return notebook editor and input URI",[new jt("showOptions","Show Options",a=>!0,a=>a),new jt("resource","Interactive resource Uri",a=>!0,a=>a),new jt("controllerId","Notebook controller Id",a=>!0,a=>a),new jt("title","Interactive editor title",a=>!0,a=>a)],new ir("Notebook and input URI",a=>{if(o.debug("[ExtHostInteractive] open iw with notebook editor id",a.notebookEditorId),a.notebookEditorId!==void 0){const c=this._extHostNotebooks.getEditorById(a.notebookEditorId);return o.debug("[ExtHostInteractive] notebook editor found",c.id),{notebookUri:Te.revive(a.notebookUri),inputUri:Te.revive(a.inputUri),notebookEditor:c.apiEditor}}return o.debug("[ExtHostInteractive] notebook editor not found, uris for the interactive document",a.notebookUri,a.inputUri),{notebookUri:Te.revive(a.notebookUri),inputUri:Te.revive(a.inputUri)}}));this._commands.registerApiCommand(s)}$willAddInteractiveDocument(e,t,r,i){this._textDocumentsAndEditors.acceptDocumentsAndEditorsDelta({addedDocuments:[{EOL:t,lines:[""],languageId:r,uri:e,isDirty:!1,versionId:1}]})}$willRemoveInteractiveDocument(e,t){this._textDocumentsAndEditors.acceptDocumentsAndEditorsDelta({removedDocuments:[e]})}}class son{constructor(e){this._handlePool=0,this._proxy=e.getProxy(dn.MainThreadLabelService)}$registerResourceLabelFormatter(e){const t=this._handlePool++;return this._proxy.$registerResourceLabelFormatter(t,e),ho(()=>{this._proxy.$unregisterResourceLabelFormatter(t)})}}const mHe="vs/workbench/api/common/extHostLanguageFeatures";class pL{constructor(e,t){this._documents=e,this._provider=t}async provideDocumentSymbols(e,t){const r=this._documents.getDocument(e),i=await this._provider.provideDocumentSymbols(r,t);if(!hee(i))return i[0]instanceof oEe?i.map(WYe.from):pL._asDocumentSymbolTree(i)}static _asDocumentSymbolTree(e){var i,o;e=e.slice(0).sort((s,a)=>{let c=s.location.range.start.compareTo(a.location.range.start);return c===0&&(c=a.location.range.end.compareTo(s.location.range.end)),c});const t=[],r=[];for(const s of e){const a={name:s.name||"!!MISSING: name!!",kind:Uxe.from(s.kind),tags:((i=s.tags)==null?void 0:i.map(qYe.from))||[],detail:"",containerName:s.containerName,range:Rn.from(s.location.range),selectionRange:Rn.from(s.location.range),children:[]};for(;;){if(r.length===0){r.push(a),t.push(a);break}const c=r[r.length-1];if(Sy.containsRange(c.range,a.range)&&!Sy.equalsRange(c.range,a.range)){(o=c.children)==null||o.push(a),r.push(a);break}r.pop()}}return t}}class JA{constructor(e,t,r,i,o,s){this._documents=e,this._commands=t,this._provider=r,this._extension=i,this._extTelemetry=o,this._logService=s,this._cache=new Kd("CodeLens"),this._disposables=new Map}async provideCodeLenses(e,t){const r=this._documents.getDocument(e),i=await this._provider.provideCodeLenses(r,t);if(!i||t.isCancellationRequested)return;const o=this._cache.add(i),s=new ei;this._disposables.set(o,s);const a={cacheId:o,lenses:[]};for(let c=0;c<i.length;c++)a.lenses.push({cacheId:[o,c],range:Rn.from(i[c].range),command:this._commands.toInternal(i[c].command,s)});return a}async resolveCodeLens(e,t){const r=e.cacheId&&this._cache.get(...e.cacheId);if(!r)return;let i;if(typeof this._provider.resolveCodeLens!="function"||r.isResolved?i=r:i=await this._provider.resolveCodeLens(r,t),i||(i=r),t.isCancellationRequested)return;const o=e.cacheId&&this._disposables.get(e.cacheId[0]);if(o){if(!i.command){const s=new Error("INVALID code lens resolved, lacks command: "+this._extension.identifier.value);this._extTelemetry.onExtensionError(this._extension.identifier,s),this._logService.error(s);return}return e.command=this._commands.toInternal(i.command,o),e}}releaseCodeLenses(e){var t;(t=this._disposables.get(e))==null||t.dispose(),this._disposables.delete(e),this._cache.delete(e)}}function S9(n){return Array.isArray(n)?n.map(PW.from):n?[PW.from(n)]:[]}class fCe{constructor(e,t){this._documents=e,this._provider=t}async provideDefinition(e,t,r){const i=this._documents.getDocument(e),o=io.to(t),s=await this._provider.provideDefinition(i,o,r);return S9(s)}}class pCe{constructor(e,t){this._documents=e,this._provider=t}async provideDeclaration(e,t,r){const i=this._documents.getDocument(e),o=io.to(t),s=await this._provider.provideDeclaration(i,o,r);return S9(s)}}class gCe{constructor(e,t){this._documents=e,this._provider=t}async provideImplementation(e,t,r){const i=this._documents.getDocument(e),o=io.to(t),s=await this._provider.provideImplementation(i,o,r);return S9(s)}}class mCe{constructor(e,t){this._documents=e,this._provider=t}async provideTypeDefinition(e,t,r){const i=this._documents.getDocument(e),o=io.to(t),s=await this._provider.provideTypeDefinition(i,o,r);return S9(s)}}const RL=class RL{constructor(e,t){this._documents=e,this._provider=t,this._hoverCounter=0,this._hoverMap=new Map}async provideHover(e,t,r,i){const o=this._documents.getDocument(e),s=io.to(t);let a;if(r&&r.verbosityRequest){const d=r.verbosityRequest.previousHover.id,h=this._hoverMap.get(d);if(!h)throw new Error(`Hover with id ${d} not found`);const f={action:r.verbosityRequest.action,previousHover:h};a=await this._provider.provideHover(o,s,i,f)}else a=await this._provider.provideHover(o,s,i);if(!a||hee(a.contents))return;a.range||(a.range=o.getWordRangeAtPosition(s)),a.range||(a.range=new _s(s,s));const c=Oxe.from(a),l=this._hoverCounter;if(this._hoverMap.size===RL.HOVER_MAP_MAX_SIZE){const d=Math.min(...this._hoverMap.keys());this._hoverMap.delete(d)}return this._hoverMap.set(l,a),this._hoverCounter+=1,{...c,id:l}}releaseHover(e){this._hoverMap.delete(e)}};RL.HOVER_MAP_MAX_SIZE=10;let xk=RL;class vCe{constructor(e,t){this._documents=e,this._provider=t}async provideEvaluatableExpression(e,t,r){const i=this._documents.getDocument(e),o=io.to(t),s=await this._provider.provideEvaluatableExpression(i,o,r);if(s)return KYe.from(s)}}class yCe{constructor(e,t){this._documents=e,this._provider=t}async provideInlineValues(e,t,r,i){const o=this._documents.getDocument(e),s=await this._provider.provideInlineValues(o,Rn.to(t),jxe.to(r),i);if(Array.isArray(s))return s.map(a=>Bxe.from(a))}}class bCe{constructor(e,t){this._documents=e,this._provider=t}async provideDocumentHighlights(e,t,r){const i=this._documents.getDocument(e),o=io.to(t),s=await this._provider.provideDocumentHighlights(i,o,r);if(Array.isArray(s))return s.map(Axe.from)}}class SCe{constructor(e,t){this._documents=e,this._provider=t}async provideMultiDocumentHighlights(e,t,r,i){const o=this._documents.getDocument(e),s=r.map(l=>this._documents.getDocument(l)),a=io.to(t),c=await this._provider.provideMultiDocumentHighlights(o,a,s,i);if(Array.isArray(c))return c.map(GYe.from)}}class _Ce{constructor(e,t){this._documents=e,this._provider=t}async provideLinkedEditingRanges(e,t,r){const i=this._documents.getDocument(e),o=io.to(t),s=await this._provider.provideLinkedEditingRanges(i,o,r);if(s&&Array.isArray(s.ranges))return{ranges:Qp(s.ranges.map(Rn.from)),wordPattern:s.wordPattern}}}class wCe{constructor(e,t){this._documents=e,this._provider=t}async provideReferences(e,t,r,i){const o=this._documents.getDocument(e),s=io.to(t),a=await this._provider.provideReferences(o,s,r,i);if(Array.isArray(a))return a.map(CS.from)}}const _C=class _C{constructor(e,t,r,i,o,s,a){this._documents=e,this._commands=t,this._diagnostics=r,this._provider=i,this._logService=o,this._extension=s,this._apiDeprecation=a,this._cache=new Kd("CodeAction"),this._disposables=new Map}async provideCodeActions(e,t,r,i){var f;const o=this._documents.getDocument(e),s=z2e.isISelection(t)?eg.to(t):Rn.to(t),a=[];for(const p of this._diagnostics.getDiagnostics(e))if(s.intersection(p.range)&&a.push(p)>_C._maxCodeActionsPerFile)break;const c={diagnostics:a,only:r.only?new jee(r.only):void 0,triggerKind:ZYe.to(r.trigger)},l=await this._provider.provideCodeActions(o,s,c,i);if(!KL(l)||i.isCancellationRequested)return;const u=this._cache.add(l),d=new ei;this._disposables.set(u,d);const h=[];for(let p=0;p<l.length;p++){const g=l[p];if(g)if(_C._isCommand(g))this._apiDeprecation.report("CodeActionProvider.provideCodeActions - return commands",this._extension,"Return 'CodeAction' instances instead."),h.push({_isSynthetic:!0,title:g.title,command:this._commands.toInternal(g,d)});else{c.only&&(g.kind?c.only.contains(g.kind)||this._logService.warn(`${this._extension.identifier.value} - Code actions of kind '${c.only.value} 'requested but returned code action is of kind '${g.kind.value}'. Code action will be dropped. Please check 'CodeActionContext.only' to only return requested code actions.`):this._logService.warn(`${this._extension.identifier.value} - Code actions of kind '${c.only.value} 'requested but returned code action does not have a 'kind'. Code action will be dropped. Please set 'CodeAction.kind'.`));const m=g.ranges??[];h.push({cacheId:[u,p],title:g.title,command:g.command&&this._commands.toInternal(g.command,d),diagnostics:g.diagnostics&&g.diagnostics.map($M.from),edit:g.edit&&Jl.from(g.edit,void 0),kind:g.kind&&g.kind.value,isPreferred:g.isPreferred,isAI:Oa(this._extension,"codeActionAI")?g.isAI:!1,ranges:Oa(this._extension,"codeActionRanges")?Qp(m.map(Rn.from)):void 0,disabled:(f=g.disabled)==null?void 0:f.reason})}}return{cacheId:u,actions:h}}async resolveCodeAction(e,t){const[r,i]=e,o=this._cache.get(r,i);if(!o||_C._isCommand(o))return{};if(!this._provider.resolveCodeAction)return{};const s=await this._provider.resolveCodeAction(o,t)??o;let a;s.edit&&(a=Jl.from(s.edit,void 0));let c;if(s.command){const l=this._disposables.get(r);l&&(c=this._commands.toInternal(s.command,l))}return{edit:a,command:c}}releaseCodeActions(e){var t;(t=this._disposables.get(e))==null||t.dispose(),this._disposables.delete(e),this._cache.delete(e)}static _isCommand(e){return typeof e.command=="string"&&typeof e.title=="string"}};_C._maxCodeActionsPerFile=1e3;let pC=_C;class VI{constructor(e,t,r,i,o){this._proxy=e,this._documents=t,this._provider=r,this._handle=i,this._extension=o,this._cache=new Kd("DocumentPasteEdit")}async prepareDocumentPaste(e,t,r,i){if(!this._provider.prepareDocumentPaste)return;const o=this._documents.getDocument(e),s=t.map(l=>Rn.to(l)),a=IC.toDataTransfer(r,()=>{throw new tZe});if(await this._provider.prepareDocumentPaste(o,s,a,i),i.isCancellationRequested)return;const c=Array.from(a).filter(([,l])=>!(l instanceof XYe));return IC.from(c)}async providePasteEdits(e,t,r,i,o,s){if(!this._provider.provideDocumentPasteEdits)return[];const a=this._documents.getDocument(t),c=r.map(h=>Rn.to(h)),l=IC.toDataTransfer(i,async h=>(await this._proxy.$resolvePasteFileData(this._handle,e,h)).buffer),u=await this._provider.provideDocumentPasteEdits(a,c,l,{only:o.only?new sEe(o.only):void 0,triggerKind:o.triggerKind},s);if(!u||s.isCancellationRequested)return[];const d=this._cache.add(u);return u.map((h,f)=>{var p;return{_cacheId:[d,f],title:h.title??Ve(mHe,0,"Paste using '{0}' extension",this._extension.displayName||this._extension.name),kind:h.kind,yieldTo:(p=h.yieldTo)==null?void 0:p.map(g=>g.value),insertText:typeof h.insertText=="string"?h.insertText:{snippet:h.insertText.value},additionalEdit:h.additionalEdit?Jl.from(h.additionalEdit,void 0):void 0}})}async resolvePasteEdit(e,t){const[r,i]=e,o=this._cache.get(r,i);if(!o||!this._provider.resolveDocumentPasteEdit)return{};const s=await this._provider.resolveDocumentPasteEdit(o,t)??o;return{additionalEdit:s.additionalEdit?Jl.from(s.additionalEdit,void 0):void 0}}releasePasteEdits(e){this._cache.delete(e)}}class CCe{constructor(e,t){this._documents=e,this._provider=t}async provideDocumentFormattingEdits(e,t,r){const i=this._documents.getDocument(e),o=await this._provider.provideDocumentFormattingEdits(i,t,r);if(Array.isArray(o))return o.map(Hf.from)}}class gV{constructor(e,t){this._documents=e,this._provider=t}async provideDocumentRangeFormattingEdits(e,t,r,i){const o=this._documents.getDocument(e),s=Rn.to(t),a=await this._provider.provideDocumentRangeFormattingEdits(o,s,r,i);if(Array.isArray(a))return a.map(Hf.from)}async provideDocumentRangesFormattingEdits(e,t,r,i){O2e(typeof this._provider.provideDocumentRangesFormattingEdits=="function","INVALID invocation of `provideDocumentRangesFormattingEdits`");const o=this._documents.getDocument(e),s=t.map(Rn.to),a=await this._provider.provideDocumentRangesFormattingEdits(o,s,r,i);if(Array.isArray(a))return a.map(Hf.from)}}class xCe{constructor(e,t){this._documents=e,this._provider=t,this.autoFormatTriggerCharacters=[]}async provideOnTypeFormattingEdits(e,t,r,i,o){const s=this._documents.getDocument(e),a=io.to(t),c=await this._provider.provideOnTypeFormattingEdits(s,a,r,i,o);if(Array.isArray(c))return c.map(Hf.from)}}class QA{constructor(e,t){this._provider=e,this._logService=t,this._cache=new Kd("WorkspaceSymbols")}async provideWorkspaceSymbols(e,t){const r=await this._provider.provideWorkspaceSymbols(e,t);if(!KL(r))return{symbols:[]};const i=this._cache.add(r),o={cacheId:i,symbols:[]};for(let s=0;s<r.length;s++){const a=r[s];if(!a||!a.name){this._logService.warn("INVALID SymbolInformation",a);continue}o.symbols.push({...xW.from(a),cacheId:[i,s]})}return o}async resolveWorkspaceSymbol(e,t){if(typeof this._provider.resolveWorkspaceSymbol!="function"||!e.cacheId)return e;const r=this._cache.get(...e.cacheId);if(r){const i=await this._provider.resolveWorkspaceSymbol(r,t);return i&&IM(e,xW.from(i),!0)}}releaseWorkspaceSymbols(e){this._cache.delete(e)}}class N1{static supportsResolving(e){return typeof e.prepareRename=="function"}constructor(e,t,r){this._documents=e,this._provider=t,this._logService=r}async provideRenameEdits(e,t,r,i){const o=this._documents.getDocument(e),s=io.to(t);try{const a=await this._provider.provideRenameEdits(o,s,r,i);return a?Jl.from(a):void 0}catch(a){const c=N1._asMessage(a);return c?{rejectReason:c,edits:void 0}:Promise.reject(a)}}async resolveRenameLocation(e,t,r){if(typeof this._provider.prepareRename!="function")return Promise.resolve(void 0);const i=this._documents.getDocument(e),o=io.to(t);try{const s=await this._provider.prepareRename(i,o,r);let a,c;if(_s.isRange(s)?(a=s,c=i.getText(s)):xd(s)&&(a=s.range,c=s.placeholder),!a||!c)return;if(a.start.line>o.line||a.end.line<o.line){this._logService.warn("INVALID rename location: position line must be within range start/end lines");return}return{range:Rn.from(a),text:c}}catch(s){const a=N1._asMessage(s);return a?{rejectReason:a,range:void 0,text:void 0}:Promise.reject(s)}}static _asMessage(e){return typeof e=="string"?e:e instanceof Error&&typeof e.message=="string"?e.message:void 0}}const kk=class kk{constructor(e,t,r){this._documents=e,this._provider=t,this._logService=r}async supportsAutomaticNewSymbolNamesTriggerKind(){return this._provider.supportsAutomaticTriggerKind}async provideNewSymbolNames(e,t,r,i){const o=this._documents.getDocument(e),s=Rn.to(t);try{const a=kk.languageTriggerKindToVSCodeTriggerKind[r],c=await this._provider.provideNewSymbolNames(o,s,a,i);return c?c.map(l=>typeof l=="string"?{newSymbolName:l}:{newSymbolName:l.newSymbolName,tags:l.tags}):void 0}catch(a){this._logService.error(kk._asMessage(a)??JSON.stringify(a,null,"	"));return}}static _asMessage(e){return typeof e=="string"?e:e instanceof Error&&typeof e.message=="string"?e.message:void 0}};kk.languageTriggerKindToVSCodeTriggerKind={[hle.Invoke]:FW.Invoke,[hle.Automatic]:FW.Automatic};let Ek=kk;class mV{constructor(e,t){this.resultId=e,this.tokens=t}}class xu{constructor(e,t){this._documents=e,this._provider=t,this._nextResultId=1,this._previousResults=new Map}async provideDocumentSemanticTokens(e,t,r){const i=this._documents.getDocument(e),o=t!==0?this._previousResults.get(t):null;let s=typeof(o==null?void 0:o.resultId)=="string"&&typeof this._provider.provideDocumentSemanticTokensEdits=="function"?await this._provider.provideDocumentSemanticTokensEdits(i,o.resultId,r):await this._provider.provideDocumentSemanticTokens(i,r);return o&&this._previousResults.delete(t),s?(s=xu._fixProvidedSemanticTokens(s),this._send(xu._convertToEdits(o,s),s)):null}async releaseDocumentSemanticColoring(e){this._previousResults.delete(e)}static _fixProvidedSemanticTokens(e){return xu._isSemanticTokens(e)?xu._isCorrectSemanticTokens(e)?e:new DM(new Uint32Array(e.data),e.resultId):xu._isSemanticTokensEdits(e)?xu._isCorrectSemanticTokensEdits(e)?e:new d4(e.edits.map(t=>new aEe(t.start,t.deleteCount,t.data?new Uint32Array(t.data):t.data)),e.resultId):e}static _isSemanticTokens(e){return e&&!!e.data}static _isCorrectSemanticTokens(e){return e.data instanceof Uint32Array}static _isSemanticTokensEdits(e){return e&&Array.isArray(e.edits)}static _isCorrectSemanticTokensEdits(e){for(const t of e.edits)if(!(t.data instanceof Uint32Array))return!1;return!0}static _convertToEdits(e,t){if(!xu._isSemanticTokens(t)||!e||!e.tokens)return t;const r=e.tokens,i=r.length,o=t.data,s=o.length;let a=0;const c=Math.min(i,s);for(;a<c&&r[a]===o[a];)a++;if(a===i&&a===s)return new d4([],t.resultId);let l=0;const u=c-a;for(;l<u&&r[i-l-1]===o[s-l-1];)l++;return new d4([{start:a,deleteCount:i-a-l,data:o.subarray(a,s-l)}],t.resultId)}_send(e,t){if(xu._isSemanticTokens(e)){const r=this._nextResultId++;return this._previousResults.set(r,new mV(e.resultId,e.data)),jW({id:r,type:"full",data:e.data})}if(xu._isSemanticTokensEdits(e)){const r=this._nextResultId++;return xu._isSemanticTokens(t)?this._previousResults.set(r,new mV(t.resultId,t.data)):this._previousResults.set(r,new mV(e.resultId)),jW({id:r,type:"delta",deltas:(e.edits||[]).map(i=>({start:i.start,deleteCount:i.deleteCount,data:i.data}))})}return null}}class ECe{constructor(e,t){this._documents=e,this._provider=t}async provideDocumentRangeSemanticTokens(e,t,r){const i=this._documents.getDocument(e),o=await this._provider.provideDocumentRangeSemanticTokens(i,Rn.to(t),r);return o?this._send(o):null}_send(e){return jW({id:0,type:"full",data:e.data})}}class f1{static supportsResolving(e){return typeof e.resolveCompletionItem=="function"}constructor(e,t,r,i,o){this._documents=e,this._commands=t,this._provider=r,this._apiDeprecation=i,this._extension=o,this._cache=new Kd("CompletionItem"),this._disposables=new Map}async provideCompletionItems(e,t,r,i){const o=this._documents.getDocument(e),s=io.to(t),a=o.getWordRangeAtPosition(s)||new _s(s,s),c=a.with({end:s}),l=new E2,u=await this._provider.provideCompletionItems(o,s,i,YYe.to(r));if(!u||i.isCancellationRequested)return;const d=Array.isArray(u)?new RM(u):u,h=f1.supportsResolving(this._provider)?this._cache.add(d.items):this._cache.add([]),f=new ei;this._disposables.set(h,f);const p=[],g={x:h,b:p,a:{replace:Rn.from(a),insert:Rn.from(c)},c:d.isIncomplete||void 0,d:l.elapsed()};for(let m=0;m<d.items.length;m++){const v=d.items[m],b=this._convertCompletionItem(v,[h,m],c,a);p.push(b)}return g}async resolveCompletionItem(e,t){if(typeof this._provider.resolveCompletionItem!="function")return;const r=this._cache.get(...e);if(!r)return;const i=this._convertCompletionItem(r,e),o=await this._provider.resolveCompletionItem(r,t);if(!o)return;const s=this._convertCompletionItem(o,e);return(i.h!==s.h||i.i!==s.i)&&this._apiDeprecation.report("CompletionItem.insertText",this._extension,"extension MAY NOT change 'insertText' of a CompletionItem during resolve"),(i.n!==s.n||i.o!==s.o||!by(i.p,s.p))&&this._apiDeprecation.report("CompletionItem.command",this._extension,"extension MAY NOT change 'command' of a CompletionItem during resolve"),{...i,d:s.d,c:s.c,l:s.l,h:s.h,i:s.i,n:s.n,o:s.o,p:s.p}}releaseCompletionItems(e){var t;(t=this._disposables.get(e))==null||t.dispose(),this._disposables.delete(e),this._cache.delete(e)}_convertCompletionItem(e,t,r,i){var l;const o=this._disposables.get(t[0]);if(!o)throw Error("DisposableStore is missing...");const s=this._commands.toInternal(e.command,o),a={x:t,a:e.label,b:e.kind!==void 0?JYe.from(e.kind):void 0,m:e.tags&&e.tags.map(QYe.from),c:e.detail,d:typeof e.documentation>"u"?void 0:$a.fromStrict(e.documentation),e:e.sortText!==e.label?e.sortText:void 0,f:e.filterText!==e.label?e.filterText:void 0,g:e.preselect||void 0,i:e.keepWhitespace?1:0,k:(l=e.commitCharacters)==null?void 0:l.join(""),l:e.additionalTextEdits&&e.additionalTextEdits.map(Hf.from),n:s==null?void 0:s.$ident,o:s==null?void 0:s.id,p:s!=null&&s.$ident||s==null?void 0:s.arguments};e.textEdit?(this._apiDeprecation.report("CompletionItem.textEdit",this._extension,"Use 'CompletionItem.insertText' and 'CompletionItem.range' instead."),a.h=e.textEdit.newText):typeof e.insertText=="string"?a.h=e.insertText:e.insertText instanceof cEe&&(a.h=e.insertText.value,a.i|=4);let c;return e.textEdit?c=e.textEdit.range:e.range&&(c=e.range),_s.isRange(c)?a.j=Rn.from(c):c&&(!(r!=null&&r.isEqual(c.inserting))||!(i!=null&&i.isEqual(c.replacing)))&&(a.j={insert:Rn.from(c.inserting),replace:Rn.from(c.replacing)}),a}}class TP{async provideInlineCompletions(e,t,r,i){}disposeCompletions(e){}handleDidShowCompletionItem(e,t,r){}handlePartialAccept(e,t,r,i){}}class aon extends TP{constructor(e,t,r,i){super(),this._extension=e,this._documents=t,this._provider=r,this._commands=i,this._references=new vHe,this._isAdditionsProposedApiEnabled=Oa(this._extension,"inlineCompletionsAdditions"),this.languageTriggerKindToVSCodeTriggerKind={[fle.Automatic]:BW.Automatic,[fle.Explicit]:BW.Invoke}}get supportsHandleEvents(){return Oa(this._extension,"inlineCompletionsAdditions")&&(typeof this._provider.handleDidShowCompletionItem=="function"||typeof this._provider.handleDidPartiallyAcceptCompletionItem=="function")}async provideInlineCompletions(e,t,r,i){const o=this._documents.getDocument(e),s=io.to(t),a=await this._provider.provideInlineCompletionItems(o,s,{selectedCompletionInfo:r.selectedSuggestionInfo?{range:Rn.to(r.selectedSuggestionInfo.range),text:r.selectedSuggestionInfo.text}:void 0,triggerKind:this.languageTriggerKindToVSCodeTriggerKind[r.triggerKind]},i);if(!a||i.isCancellationRequested)return;const c=Array.isArray(a)?a:a.items,l=this._isAdditionsProposedApiEnabled?Array.isArray(a)?[]:a.commands||[]:[],u=this._isAdditionsProposedApiEnabled&&!Array.isArray(a)?a.enableForwardStability:void 0;let d;return{pid:this._references.createReferenceId({dispose(){d==null||d.dispose()},items:c}),items:c.map((f,p)=>{let g;f.command&&(d||(d=new ei),g=this._commands.toInternal(f.command,d));const m=f.insertText;return{insertText:typeof m=="string"?m:{snippet:m.value},filterText:f.filterText,range:f.range?Rn.from(f.range):void 0,command:g,idx:p,completeBracketPairs:this._isAdditionsProposedApiEnabled?f.completeBracketPairs:!1}}),commands:l.map(f=>(d||(d=new ei),this._commands.toInternal(f,d))),suppressSuggestions:!1,enableForwardStability:u}}disposeCompletions(e){const t=this._references.disposeReferenceId(e);t==null||t.dispose()}handleDidShowCompletionItem(e,t,r){var o;const i=(o=this._references.get(e))==null?void 0:o.items[t];i&&this._provider.handleDidShowCompletionItem&&this._isAdditionsProposedApiEnabled&&this._provider.handleDidShowCompletionItem(i,r)}handlePartialAccept(e,t,r,i){var s;const o=(s=this._references.get(e))==null?void 0:s.items[t];o&&this._provider.handleDidPartiallyAcceptCompletionItem&&this._isAdditionsProposedApiEnabled&&(this._provider.handleDidPartiallyAcceptCompletionItem(o,r),this._provider.handleDidPartiallyAcceptCompletionItem(o,eJe.to(i)))}}class vV{async provideInlineEdits(e,t,r){const i=this._documents.getDocument(e),o=await this._provider.provideInlineEdit(i,{triggerKind:this.languageTriggerKindToVSCodeTriggerKind[t.triggerKind]},r);if(!o||r.isCancellationRequested)return;let s;const a=this._references.createReferenceId({dispose(){s==null||s.dispose()},item:o});let c;o.accepted&&(s||(s=new ei),c=this._commands.toInternal(o.accepted,s));let l;return o.rejected&&(s||(s=new ei),l=this._commands.toInternal(o.rejected,s)),{pid:a,text:o.text,range:Rn.from(o.range),accepted:c,rejected:l}}disposeEdit(e){const t=this._references.disposeReferenceId(e);t==null||t.dispose()}constructor(e,t,r,i){this._documents=t,this._provider=r,this._commands=i,this._references=new vHe,this.languageTriggerKindToVSCodeTriggerKind={[ple.Automatic]:HW.Automatic,[ple.Invoke]:HW.Invoke}}}class vHe{constructor(){this._references=new Map,this._idPool=1}createReferenceId(e){const t=this._idPool++;return this._references.set(t,e),t}disposeReferenceId(e){const t=this._references.get(e);return this._references.delete(e),t}get(e){return this._references.get(e)}}class yV{constructor(e,t){this._documents=e,this._provider=t,this._cache=new Kd("SignatureHelp")}async provideSignatureHelp(e,t,r,i){const o=this._documents.getDocument(e),s=io.to(t),a=this.reviveContext(r),c=await this._provider.provideSignatureHelp(o,s,i,a);if(c){const l=this._cache.add([c]);return{...IW.from(c),id:l}}}reviveContext(e){let t;if(e.activeSignatureHelp){const r=IW.to(e.activeSignatureHelp),i=this._cache.get(e.activeSignatureHelp.id,0);i?(t=i,t.activeSignature=r.activeSignature,t.activeParameter=r.activeParameter):t=r}return{...e,activeSignatureHelp:t}}releaseSignatureHelp(e){this._cache.delete(e)}}class e4{constructor(e,t,r,i,o){this._documents=e,this._commands=t,this._provider=r,this._logService=i,this._extension=o,this._cache=new Kd("InlayHints"),this._disposables=new Map}async provideInlayHints(e,t,r){const i=this._documents.getDocument(e),o=Rn.to(t),s=await this._provider.provideInlayHints(i,o,r);if(!Array.isArray(s)||s.length===0){this._logService.trace(`[InlayHints] NO inlay hints from '${this._extension.identifier.value}' for range ${JSON.stringify(t)}`);return}if(r.isCancellationRequested)return;const a=this._cache.add(s);this._disposables.set(a,new ei);const c={hints:[],cacheId:a};for(let l=0;l<s.length;l++)this._isValidInlayHint(s[l],o)&&c.hints.push(this._convertInlayHint(s[l],[a,l]));return this._logService.trace(`[InlayHints] ${c.hints.length} inlay hints from '${this._extension.identifier.value}' for range ${JSON.stringify(t)}`),c}async resolveInlayHint(e,t){if(typeof this._provider.resolveInlayHint!="function")return;const r=this._cache.get(...e);if(!r)return;const i=await this._provider.resolveInlayHint(r,t);if(i&&this._isValidInlayHint(i))return this._convertInlayHint(i,e)}releaseHints(e){var t;(t=this._disposables.get(e))==null||t.dispose(),this._disposables.delete(e),this._cache.delete(e)}_isValidInlayHint(e,t){return e.label.length===0||Array.isArray(e.label)&&e.label.every(r=>r.value.length===0)?(console.log("INVALID inlay hint, empty label",e),!1):!(t&&!t.contains(e.position))}_convertInlayHint(e,t){const r=this._disposables.get(t[0]);if(!r)throw Error("DisposableStore is missing...");const i={label:"",cacheId:t,tooltip:$a.fromStrict(e.tooltip),position:io.from(e.position),textEdits:e.textEdits&&e.textEdits.map(Hf.from),kind:e.kind&&tJe.from(e.kind),paddingLeft:e.paddingLeft,paddingRight:e.paddingRight};if(typeof e.label=="string")i.label=e.label;else{const o=[];i.label=o;for(const s of e.label){if(!s.value){console.warn("INVALID inlay hint, empty label part",this._extension.identifier.value);continue}const a={label:s.value,tooltip:$a.fromStrict(s.tooltip)};k2.isLocation(s.location)&&(a.location=CS.from(s.location)),s.command&&(a.command=this._commands.toInternal(s.command,r)),o.push(a)}}return i}}class X0{constructor(e,t){this._documents=e,this._provider=t,this._cache=new Kd("DocumentLink")}async provideLinks(e,t){const r=this._documents.getDocument(e),i=await this._provider.provideDocumentLinks(r,t);if(!(!Array.isArray(i)||i.length===0)&&!t.isCancellationRequested){if(typeof this._provider.resolveDocumentLink!="function")return{links:i.filter(X0._validateLink).map(jP.from)};{const o=this._cache.add(i),s={links:[],cacheId:o};for(let a=0;a<i.length;a++){if(!X0._validateLink(i[a]))continue;const c=jP.from(i[a]);c.cacheId=[o,a],s.links.push(c)}return s}}}static _validateLink(e){return e.target&&e.target.path.length>5e4?(console.warn("DROPPING link because it is too long"),!1):!0}async resolveLink(e,t){if(typeof this._provider.resolveDocumentLink!="function")return;const r=this._cache.get(...e);if(!r)return;const i=await this._provider.resolveDocumentLink(r,t);if(!(!i||!X0._validateLink(i)))return jP.from(i)}releaseLinks(e){this._cache.delete(e)}}class bV{constructor(e,t){this._documents=e,this._provider=t}async provideColors(e,t){const r=this._documents.getDocument(e),i=await this._provider.provideDocumentColors(r,t);return Array.isArray(i)?i.map(s=>({color:AM.from(s.color),range:Rn.from(s.range)})):[]}async provideColorPresentations(e,t,r){const i=this._documents.getDocument(e),o=Rn.to(t.range),s=AM.to(t.color),a=await this._provider.provideColorPresentations(s,{document:i,range:o},r);if(Array.isArray(a))return a.map(Nxe.from)}}class ICe{constructor(e,t){this._documents=e,this._provider=t}async provideFoldingRanges(e,t,r){const i=this._documents.getDocument(e),o=await this._provider.provideFoldingRanges(i,t,r);if(Array.isArray(o))return o.map(Fxe.from)}}class PCe{constructor(e,t,r){this._documents=e,this._provider=t,this._logService=r}async provideSelectionRanges(e,t,r){const i=this._documents.getDocument(e),o=t.map(io.to),s=await this._provider.provideSelectionRanges(i,o,r);if(!KL(s))return[];if(s.length!==o.length)return this._logService.warn("BAD selection ranges, provider must return ranges for each position"),[];const a=[];for(let c=0;c<o.length;c++){const l=[];a.push(l);let u=o[c],d=s[c];for(;;){if(!d.range.contains(u))throw new Error("INVALID selection range, must contain the previous range");if(l.push(nJe.from(d)),!d.parent)break;u=d.range,d=d.parent}}return a}}class WI{constructor(e,t){this._documents=e,this._provider=t,this._idPool=new Ree(""),this._cache=new Map}async prepareSession(e,t,r){const i=this._documents.getDocument(e),o=io.to(t),s=await this._provider.prepareCallHierarchy(i,o,r);if(!s)return;const a=this._idPool.nextId();return this._cache.set(a,new Map),Array.isArray(s)?s.map(c=>this._cacheAndConvertItem(a,c)):[this._cacheAndConvertItem(a,s)]}async provideCallsTo(e,t,r){const i=this._itemFromCache(e,t);if(!i)throw new Error("missing call hierarchy item");const o=await this._provider.provideCallHierarchyIncomingCalls(i,r);if(o)return o.map(s=>({from:this._cacheAndConvertItem(e,s.from),fromRanges:s.fromRanges.map(a=>Rn.from(a))}))}async provideCallsFrom(e,t,r){const i=this._itemFromCache(e,t);if(!i)throw new Error("missing call hierarchy item");const o=await this._provider.provideCallHierarchyOutgoingCalls(i,r);if(o)return o.map(s=>({to:this._cacheAndConvertItem(e,s.to),fromRanges:s.fromRanges.map(a=>Rn.from(a))}))}releaseSession(e){this._cache.delete(e)}_cacheAndConvertItem(e,t){const r=this._cache.get(e),i=Dee.from(t,e,r.size.toString(36));return r.set(i._itemId,t),i}_itemFromCache(e,t){const r=this._cache.get(e);return r==null?void 0:r.get(t)}}class qI{constructor(e,t){this._documents=e,this._provider=t,this._idPool=new Ree(""),this._cache=new Map}async prepareSession(e,t,r){const i=this._documents.getDocument(e),o=io.to(t),s=await this._provider.prepareTypeHierarchy(i,o,r);if(!s)return;const a=this._idPool.nextId();return this._cache.set(a,new Map),Array.isArray(s)?s.map(c=>this._cacheAndConvertItem(a,c)):[this._cacheAndConvertItem(a,s)]}async provideSupertypes(e,t,r){const i=this._itemFromCache(e,t);if(!i)throw new Error("missing type hierarchy item");const o=await this._provider.provideTypeHierarchySupertypes(i,r);if(o)return o.map(s=>this._cacheAndConvertItem(e,s))}async provideSubtypes(e,t,r){const i=this._itemFromCache(e,t);if(!i)throw new Error("missing type hierarchy item");const o=await this._provider.provideTypeHierarchySubtypes(i,r);if(o)return o.map(s=>this._cacheAndConvertItem(e,s))}releaseSession(e){this._cache.delete(e)}_cacheAndConvertItem(e,t){const r=this._cache.get(e),i=$P.from(t,e,r.size.toString(36));return r.set(i._itemId,t),i}_itemFromCache(e,t){const r=this._cache.get(e);return r==null?void 0:r.get(t)}}class t4{constructor(e,t,r,i,o){this._proxy=e,this._documents=t,this._provider=r,this._handle=i,this._extension=o,this._cache=new Kd("DocumentDropEdit")}async provideDocumentOnDropEdits(e,t,r,i,o){const s=this._documents.getDocument(t),a=io.to(r),c=IC.toDataTransfer(i,async h=>(await this._proxy.$resolveDocumentOnDropFileData(this._handle,e,h)).buffer),l=await this._provider.provideDocumentDropEdits(s,a,c,o);if(!l)return;const u=vM(l),d=this._cache.add(u);return u.map((h,f)=>{var p,g;return{_cacheId:[d,f],title:h.title??Ve(mHe,1,"Drop using '{0}' extension",this._extension.displayName||this._extension.name),kind:(p=h.kind)==null?void 0:p.value,yieldTo:(g=h.yieldTo)==null?void 0:g.map(m=>m.value),insertText:typeof h.insertText=="string"?h.insertText:{snippet:h.insertText.value},additionalEdit:h.additionalEdit?Jl.from(h.additionalEdit,void 0):void 0}})}async resolveDropEdit(e,t){const[r,i]=e,o=this._cache.get(r,i);if(!o||!this._provider.resolveDocumentDropEdit)return{};const s=await this._provider.resolveDocumentDropEdit(o,t)??o;return{additionalEdit:s.additionalEdit?Jl.from(s.additionalEdit,void 0):void 0}}releaseDropEdits(e){this._cache.delete(e)}}class kCe{constructor(e,t){this._documents=e,this._provider=t}async provideMappedEdits(e,t,r,i){var u,d;const o=Te.revive(e),s=this._documents.getDocument(o),a=r.documents.map(h=>h.map(f=>({uri:Te.revive(f.uri),version:f.version,ranges:f.ranges.map(p=>Rn.to(p))}))),c={documents:a,selections:((d=(u=a[0])==null?void 0:u[0])==null?void 0:d.ranges)??[]},l=await this._provider.provideMappedEdits(s,t,c,i);return l?Jl.from(l):null}}class KI{constructor(e,t){this.adapter=e,this.extension=t}}const Zs=class Zs{constructor(e,t,r,i,o,s,a,c){this._uriTransformer=t,this._documents=r,this._commands=i,this._diagnostics=o,this._logService=s,this._apiDeprecation=a,this._extensionTelemetry=c,this._adapter=new Map,this._proxy=e.getProxy(dn.MainThreadLanguageFeatures)}_transformDocumentSelector(e,t){return r7.from(e,this._uriTransformer,t)}_createDisposable(e){return new pi(()=>{this._adapter.delete(e),this._proxy.$unregister(e)})}_nextHandle(){return Zs._handlePool++}async _withAdapter(e,t,r,i,o,s=!1){const a=this._adapter.get(e);if(!a||!(a.adapter instanceof t))return i;const c=Date.now();s||this._logService.trace(`[${a.extension.identifier.value}] INVOKE provider '${r.toString().replace(/[\r\n]/g,"")}'`);const l=r(a.adapter,a.extension);return Promise.resolve(l).catch(u=>{SM(u)||(this._logService.error(`[${a.extension.identifier.value}] provider FAILED`),this._logService.error(u),this._extensionTelemetry.onExtensionError(a.extension.identifier,u))}).finally(()=>{s||this._logService.trace(`[${a.extension.identifier.value}] provider DONE after ${Date.now()-c}ms`)}),Xl.isCancellationToken(o)?VYe(l,o):l}_addNewAdapter(e,t){const r=this._nextHandle();return this._adapter.set(r,new KI(e,t)),r}static _extLabel(e){return e.displayName||e.name}registerDocumentSymbolProvider(e,t,r,i){const o=this._addNewAdapter(new pL(this._documents,r),e),s=i&&i.label||Zs._extLabel(e);return this._proxy.$registerDocumentSymbolProvider(o,this._transformDocumentSelector(t,e),s),this._createDisposable(o)}$provideDocumentSymbols(e,t,r){return this._withAdapter(e,pL,i=>i.provideDocumentSymbols(Te.revive(t),r),void 0,r)}registerCodeLensProvider(e,t,r){const i=this._nextHandle(),o=typeof r.onDidChangeCodeLenses=="function"?this._nextHandle():void 0;this._adapter.set(i,new KI(new JA(this._documents,this._commands.converter,r,e,this._extensionTelemetry,this._logService),e)),this._proxy.$registerCodeLensSupport(i,this._transformDocumentSelector(t,e),o);let s=this._createDisposable(i);if(o!==void 0){const a=r.onDidChangeCodeLenses(c=>this._proxy.$emitCodeLensEvent(o));s=pi.from(s,a)}return s}$provideCodeLenses(e,t,r){return this._withAdapter(e,JA,i=>i.provideCodeLenses(Te.revive(t),r),void 0,r)}$resolveCodeLens(e,t,r){return this._withAdapter(e,JA,i=>i.resolveCodeLens(t,r),void 0,void 0)}$releaseCodeLenses(e,t){this._withAdapter(e,JA,r=>Promise.resolve(r.releaseCodeLenses(t)),void 0,void 0)}registerDefinitionProvider(e,t,r){const i=this._addNewAdapter(new fCe(this._documents,r),e);return this._proxy.$registerDefinitionSupport(i,this._transformDocumentSelector(t,e)),this._createDisposable(i)}$provideDefinition(e,t,r,i){return this._withAdapter(e,fCe,o=>o.provideDefinition(Te.revive(t),r,i),[],i)}registerDeclarationProvider(e,t,r){const i=this._addNewAdapter(new pCe(this._documents,r),e);return this._proxy.$registerDeclarationSupport(i,this._transformDocumentSelector(t,e)),this._createDisposable(i)}$provideDeclaration(e,t,r,i){return this._withAdapter(e,pCe,o=>o.provideDeclaration(Te.revive(t),r,i),[],i)}registerImplementationProvider(e,t,r){const i=this._addNewAdapter(new gCe(this._documents,r),e);return this._proxy.$registerImplementationSupport(i,this._transformDocumentSelector(t,e)),this._createDisposable(i)}$provideImplementation(e,t,r,i){return this._withAdapter(e,gCe,o=>o.provideImplementation(Te.revive(t),r,i),[],i)}registerTypeDefinitionProvider(e,t,r){const i=this._addNewAdapter(new mCe(this._documents,r),e);return this._proxy.$registerTypeDefinitionSupport(i,this._transformDocumentSelector(t,e)),this._createDisposable(i)}$provideTypeDefinition(e,t,r,i){return this._withAdapter(e,mCe,o=>o.provideTypeDefinition(Te.revive(t),r,i),[],i)}registerHoverProvider(e,t,r,i){const o=this._addNewAdapter(new xk(this._documents,r),e);return this._proxy.$registerHoverProvider(o,this._transformDocumentSelector(t,e)),this._createDisposable(o)}$provideHover(e,t,r,i,o){return this._withAdapter(e,xk,s=>s.provideHover(Te.revive(t),r,i,o),void 0,o)}$releaseHover(e,t){this._withAdapter(e,xk,r=>Promise.resolve(r.releaseHover(t)),void 0,void 0)}registerEvaluatableExpressionProvider(e,t,r,i){const o=this._addNewAdapter(new vCe(this._documents,r),e);return this._proxy.$registerEvaluatableExpressionProvider(o,this._transformDocumentSelector(t,e)),this._createDisposable(o)}$provideEvaluatableExpression(e,t,r,i){return this._withAdapter(e,vCe,o=>o.provideEvaluatableExpression(Te.revive(t),r,i),void 0,i)}registerInlineValuesProvider(e,t,r,i){const o=typeof r.onDidChangeInlineValues=="function"?this._nextHandle():void 0,s=this._addNewAdapter(new yCe(this._documents,r),e);this._proxy.$registerInlineValuesProvider(s,this._transformDocumentSelector(t,e),o);let a=this._createDisposable(s);if(o!==void 0){const c=r.onDidChangeInlineValues(l=>this._proxy.$emitInlineValuesEvent(o));a=pi.from(a,c)}return a}$provideInlineValues(e,t,r,i,o){return this._withAdapter(e,yCe,s=>s.provideInlineValues(Te.revive(t),r,i,o),void 0,o)}registerDocumentHighlightProvider(e,t,r){const i=this._addNewAdapter(new bCe(this._documents,r),e);return this._proxy.$registerDocumentHighlightProvider(i,this._transformDocumentSelector(t,e)),this._createDisposable(i)}registerMultiDocumentHighlightProvider(e,t,r){const i=this._addNewAdapter(new SCe(this._documents,r),e);return this._proxy.$registerMultiDocumentHighlightProvider(i,this._transformDocumentSelector(t,e)),this._createDisposable(i)}$provideDocumentHighlights(e,t,r,i){return this._withAdapter(e,bCe,o=>o.provideDocumentHighlights(Te.revive(t),r,i),void 0,i)}$provideMultiDocumentHighlights(e,t,r,i,o){return this._withAdapter(e,SCe,s=>s.provideMultiDocumentHighlights(Te.revive(t),r,i.map(a=>Te.revive(a)),o),void 0,o)}registerLinkedEditingRangeProvider(e,t,r){const i=this._addNewAdapter(new _Ce(this._documents,r),e);return this._proxy.$registerLinkedEditingRangeProvider(i,this._transformDocumentSelector(t,e)),this._createDisposable(i)}$provideLinkedEditingRanges(e,t,r,i){return this._withAdapter(e,_Ce,async o=>{const s=await o.provideLinkedEditingRanges(Te.revive(t),r,i);if(s)return{ranges:s.ranges,wordPattern:s.wordPattern?Zs._serializeRegExp(s.wordPattern):void 0}},void 0,i)}registerReferenceProvider(e,t,r){const i=this._addNewAdapter(new wCe(this._documents,r),e);return this._proxy.$registerReferenceSupport(i,this._transformDocumentSelector(t,e)),this._createDisposable(i)}$provideReferences(e,t,r,i,o){return this._withAdapter(e,wCe,s=>s.provideReferences(Te.revive(t),r,i,o),void 0,o)}registerCodeActionProvider(e,t,r,i){var a,c;const o=new ei,s=this._addNewAdapter(new pC(this._documents,this._commands.converter,this._diagnostics,r,this._logService,e,this._apiDeprecation),e);return this._proxy.$registerQuickFixSupport(s,this._transformDocumentSelector(t,e),{providedKinds:(a=i==null?void 0:i.providedCodeActionKinds)==null?void 0:a.map(l=>l.value),documentation:(c=i==null?void 0:i.documentation)==null?void 0:c.map(l=>({kind:l.kind.value,command:this._commands.converter.toInternal(l.command,o)}))},Zs._extLabel(e),!!r.resolveCodeAction),o.add(this._createDisposable(s)),o}$provideCodeActions(e,t,r,i,o){return this._withAdapter(e,pC,s=>s.provideCodeActions(Te.revive(t),r,i,o),void 0,o)}$resolveCodeAction(e,t,r){return this._withAdapter(e,pC,i=>i.resolveCodeAction(t,r),{},void 0)}$releaseCodeActions(e,t){this._withAdapter(e,pC,r=>Promise.resolve(r.releaseCodeActions(t)),void 0,void 0)}registerDocumentFormattingEditProvider(e,t,r){const i=this._addNewAdapter(new CCe(this._documents,r),e);return this._proxy.$registerDocumentFormattingSupport(i,this._transformDocumentSelector(t,e),e.identifier,e.displayName||e.name),this._createDisposable(i)}$provideDocumentFormattingEdits(e,t,r,i){return this._withAdapter(e,CCe,o=>o.provideDocumentFormattingEdits(Te.revive(t),r,i),void 0,i)}registerDocumentRangeFormattingEditProvider(e,t,r){const i=typeof r.provideDocumentRangesFormattingEdits=="function",o=this._addNewAdapter(new gV(this._documents,r),e);return this._proxy.$registerRangeFormattingSupport(o,this._transformDocumentSelector(t,e),e.identifier,e.displayName||e.name,i),this._createDisposable(o)}$provideDocumentRangeFormattingEdits(e,t,r,i,o){return this._withAdapter(e,gV,s=>s.provideDocumentRangeFormattingEdits(Te.revive(t),r,i,o),void 0,o)}$provideDocumentRangesFormattingEdits(e,t,r,i,o){return this._withAdapter(e,gV,s=>s.provideDocumentRangesFormattingEdits(Te.revive(t),r,i,o),void 0,o)}registerOnTypeFormattingEditProvider(e,t,r,i){const o=this._addNewAdapter(new xCe(this._documents,r),e);return this._proxy.$registerOnTypeFormattingSupport(o,this._transformDocumentSelector(t,e),i,e.identifier),this._createDisposable(o)}$provideOnTypeFormattingEdits(e,t,r,i,o,s){return this._withAdapter(e,xCe,a=>a.provideOnTypeFormattingEdits(Te.revive(t),r,i,o,s),void 0,s)}registerWorkspaceSymbolProvider(e,t){const r=this._addNewAdapter(new QA(t,this._logService),e);return this._proxy.$registerNavigateTypeSupport(r,typeof t.resolveWorkspaceSymbol=="function"),this._createDisposable(r)}$provideWorkspaceSymbols(e,t,r){return this._withAdapter(e,QA,i=>i.provideWorkspaceSymbols(t,r),{symbols:[]},r)}$resolveWorkspaceSymbol(e,t,r){return this._withAdapter(e,QA,i=>i.resolveWorkspaceSymbol(t,r),void 0,void 0)}$releaseWorkspaceSymbols(e,t){this._withAdapter(e,QA,r=>r.releaseWorkspaceSymbols(t),void 0,void 0)}registerRenameProvider(e,t,r){const i=this._addNewAdapter(new N1(this._documents,r,this._logService),e);return this._proxy.$registerRenameSupport(i,this._transformDocumentSelector(t,e),N1.supportsResolving(r)),this._createDisposable(i)}$provideRenameEdits(e,t,r,i,o){return this._withAdapter(e,N1,s=>s.provideRenameEdits(Te.revive(t),r,i,o),void 0,o)}$resolveRenameLocation(e,t,r,i){return this._withAdapter(e,N1,o=>o.resolveRenameLocation(Te.revive(t),r,i),void 0,i)}registerNewSymbolNamesProvider(e,t,r){const i=this._addNewAdapter(new Ek(this._documents,r,this._logService),e);return this._proxy.$registerNewSymbolNamesProvider(i,this._transformDocumentSelector(t,e)),this._createDisposable(i)}$supportsAutomaticNewSymbolNamesTriggerKind(e){return this._withAdapter(e,Ek,t=>t.supportsAutomaticNewSymbolNamesTriggerKind(),!1,void 0)}$provideNewSymbolNames(e,t,r,i,o){return this._withAdapter(e,Ek,s=>s.provideNewSymbolNames(Te.revive(t),r,i,o),void 0,o)}registerDocumentSemanticTokensProvider(e,t,r,i){const o=this._addNewAdapter(new xu(this._documents,r),e),s=typeof r.onDidChangeSemanticTokens=="function"?this._nextHandle():void 0;this._proxy.$registerDocumentSemanticTokensProvider(o,this._transformDocumentSelector(t,e),i,s);let a=this._createDisposable(o);if(s){const c=r.onDidChangeSemanticTokens(l=>this._proxy.$emitDocumentSemanticTokensEvent(s));a=pi.from(a,c)}return a}$provideDocumentSemanticTokens(e,t,r,i){return this._withAdapter(e,xu,o=>o.provideDocumentSemanticTokens(Te.revive(t),r,i),null,i)}$releaseDocumentSemanticTokens(e,t){this._withAdapter(e,xu,r=>r.releaseDocumentSemanticColoring(t),void 0,void 0)}registerDocumentRangeSemanticTokensProvider(e,t,r,i){const o=this._addNewAdapter(new ECe(this._documents,r),e);return this._proxy.$registerDocumentRangeSemanticTokensProvider(o,this._transformDocumentSelector(t,e),i),this._createDisposable(o)}$provideDocumentRangeSemanticTokens(e,t,r,i){return this._withAdapter(e,ECe,o=>o.provideDocumentRangeSemanticTokens(Te.revive(t),r,i),null,i)}registerCompletionItemProvider(e,t,r,i){const o=this._addNewAdapter(new f1(this._documents,this._commands.converter,r,this._apiDeprecation,e),e);return this._proxy.$registerCompletionsProvider(o,this._transformDocumentSelector(t,e),i,f1.supportsResolving(r),e.identifier),this._createDisposable(o)}$provideCompletionItems(e,t,r,i,o){return this._withAdapter(e,f1,s=>s.provideCompletionItems(Te.revive(t),r,i,o),void 0,o)}$resolveCompletionItem(e,t,r){return this._withAdapter(e,f1,i=>i.resolveCompletionItem(t,r),void 0,r)}$releaseCompletionItems(e,t){this._withAdapter(e,f1,r=>r.releaseCompletionItems(t),void 0,void 0)}registerInlineCompletionsProvider(e,t,r,i){var a;const o=new aon(e,this._documents,r,this._commands.converter),s=this._addNewAdapter(o,e);return this._proxy.$registerInlineCompletionsSupport(s,this._transformDocumentSelector(t,e),o.supportsHandleEvents,jc.toKey(e.identifier.value),((a=i==null?void 0:i.yieldTo)==null?void 0:a.map(c=>jc.toKey(c)))||[]),this._createDisposable(s)}$provideInlineCompletions(e,t,r,i,o){return this._withAdapter(e,TP,s=>s.provideInlineCompletions(Te.revive(t),r,i,o),void 0,o)}$handleInlineCompletionDidShow(e,t,r,i){this._withAdapter(e,TP,async o=>{o.handleDidShowCompletionItem(t,r,i)},void 0,void 0)}$handleInlineCompletionPartialAccept(e,t,r,i,o){this._withAdapter(e,TP,async s=>{s.handlePartialAccept(t,r,i,o)},void 0,void 0)}$freeInlineCompletionsList(e,t){this._withAdapter(e,TP,async r=>{r.disposeCompletions(t)},void 0,void 0)}registerInlineEditProvider(e,t,r){const i=new vV(e,this._documents,r,this._commands.converter),o=this._addNewAdapter(i,e);return this._proxy.$registerInlineEditProvider(o,this._transformDocumentSelector(t,e),e.identifier),this._createDisposable(o)}$provideInlineEdit(e,t,r,i){return this._withAdapter(e,vV,o=>o.provideInlineEdits(Te.revive(t),r,i),void 0,i)}$freeInlineEdit(e,t){this._withAdapter(e,vV,async r=>{r.disposeEdit(t)},void 0,void 0)}registerSignatureHelpProvider(e,t,r,i){const o=Array.isArray(i)?{triggerCharacters:i,retriggerCharacters:[]}:i,s=this._addNewAdapter(new yV(this._documents,r),e);return this._proxy.$registerSignatureHelpProvider(s,this._transformDocumentSelector(t,e),o),this._createDisposable(s)}$provideSignatureHelp(e,t,r,i,o){return this._withAdapter(e,yV,s=>s.provideSignatureHelp(Te.revive(t),r,i,o),void 0,o)}$releaseSignatureHelp(e,t){this._withAdapter(e,yV,r=>r.releaseSignatureHelp(t),void 0,void 0)}registerInlayHintsProvider(e,t,r){const i=typeof r.onDidChangeInlayHints=="function"?this._nextHandle():void 0,o=this._addNewAdapter(new e4(this._documents,this._commands.converter,r,this._logService,e),e);this._proxy.$registerInlayHintsProvider(o,this._transformDocumentSelector(t,e),typeof r.resolveInlayHint=="function",i,Zs._extLabel(e));let s=this._createDisposable(o);if(i!==void 0){const a=r.onDidChangeInlayHints(c=>this._proxy.$emitInlayHintsEvent(i));s=pi.from(s,a)}return s}$provideInlayHints(e,t,r,i){return this._withAdapter(e,e4,o=>o.provideInlayHints(Te.revive(t),r,i),void 0,i)}$resolveInlayHint(e,t,r){return this._withAdapter(e,e4,i=>i.resolveInlayHint(t,r),void 0,r)}$releaseInlayHints(e,t){this._withAdapter(e,e4,r=>r.releaseHints(t),void 0,void 0)}registerDocumentLinkProvider(e,t,r){const i=this._addNewAdapter(new X0(this._documents,r),e);return this._proxy.$registerDocumentLinkProvider(i,this._transformDocumentSelector(t,e),typeof r.resolveDocumentLink=="function"),this._createDisposable(i)}$provideDocumentLinks(e,t,r){return this._withAdapter(e,X0,i=>i.provideLinks(Te.revive(t),r),void 0,r,t.scheme==="output")}$resolveDocumentLink(e,t,r){return this._withAdapter(e,X0,i=>i.resolveLink(t,r),void 0,void 0,!0)}$releaseDocumentLinks(e,t){this._withAdapter(e,X0,r=>r.releaseLinks(t),void 0,void 0,!0)}registerColorProvider(e,t,r){const i=this._addNewAdapter(new bV(this._documents,r),e);return this._proxy.$registerDocumentColorProvider(i,this._transformDocumentSelector(t,e)),this._createDisposable(i)}$provideDocumentColors(e,t,r){return this._withAdapter(e,bV,i=>i.provideColors(Te.revive(t),r),[],r)}$provideColorPresentations(e,t,r,i){return this._withAdapter(e,bV,o=>o.provideColorPresentations(Te.revive(t),r,i),void 0,i)}registerFoldingRangeProvider(e,t,r){const i=this._nextHandle(),o=typeof r.onDidChangeFoldingRanges=="function"?this._nextHandle():void 0;this._adapter.set(i,new KI(new ICe(this._documents,r),e)),this._proxy.$registerFoldingRangeProvider(i,this._transformDocumentSelector(t,e),e.identifier,o);let s=this._createDisposable(i);if(o!==void 0){const a=r.onDidChangeFoldingRanges(()=>this._proxy.$emitFoldingRangeEvent(o));s=pi.from(s,a)}return s}$provideFoldingRanges(e,t,r,i){return this._withAdapter(e,ICe,o=>o.provideFoldingRanges(Te.revive(t),r,i),void 0,i)}registerSelectionRangeProvider(e,t,r){const i=this._addNewAdapter(new PCe(this._documents,r,this._logService),e);return this._proxy.$registerSelectionRangeProvider(i,this._transformDocumentSelector(t,e)),this._createDisposable(i)}$provideSelectionRanges(e,t,r,i){return this._withAdapter(e,PCe,o=>o.provideSelectionRanges(Te.revive(t),r,i),[],i)}registerCallHierarchyProvider(e,t,r){const i=this._addNewAdapter(new WI(this._documents,r),e);return this._proxy.$registerCallHierarchyProvider(i,this._transformDocumentSelector(t,e)),this._createDisposable(i)}$prepareCallHierarchy(e,t,r,i){return this._withAdapter(e,WI,o=>Promise.resolve(o.prepareSession(Te.revive(t),r,i)),void 0,i)}$provideCallHierarchyIncomingCalls(e,t,r,i){return this._withAdapter(e,WI,o=>o.provideCallsTo(t,r,i),void 0,i)}$provideCallHierarchyOutgoingCalls(e,t,r,i){return this._withAdapter(e,WI,o=>o.provideCallsFrom(t,r,i),void 0,i)}$releaseCallHierarchy(e,t){this._withAdapter(e,WI,r=>Promise.resolve(r.releaseSession(t)),void 0,void 0)}registerTypeHierarchyProvider(e,t,r){const i=this._addNewAdapter(new qI(this._documents,r),e);return this._proxy.$registerTypeHierarchyProvider(i,this._transformDocumentSelector(t,e)),this._createDisposable(i)}$prepareTypeHierarchy(e,t,r,i){return this._withAdapter(e,qI,o=>Promise.resolve(o.prepareSession(Te.revive(t),r,i)),void 0,i)}$provideTypeHierarchySupertypes(e,t,r,i){return this._withAdapter(e,qI,o=>o.provideSupertypes(t,r,i),void 0,i)}$provideTypeHierarchySubtypes(e,t,r,i){return this._withAdapter(e,qI,o=>o.provideSubtypes(t,r,i),void 0,i)}$releaseTypeHierarchy(e,t){this._withAdapter(e,qI,r=>Promise.resolve(r.releaseSession(t)),void 0,void 0)}registerDocumentOnDropEditProvider(e,t,r,i){const o=this._nextHandle();return this._adapter.set(o,new KI(new t4(this._proxy,this._documents,r,o,e),e)),this._proxy.$registerDocumentOnDropEditProvider(o,this._transformDocumentSelector(t,e),Oa(e,"documentPaste")&&i?{supportsResolve:!!r.resolveDocumentDropEdit,dropMimeTypes:i.dropMimeTypes}:void 0),this._createDisposable(o)}$provideDocumentOnDropEdits(e,t,r,i,o,s){return this._withAdapter(e,t4,a=>Promise.resolve(a.provideDocumentOnDropEdits(t,Te.revive(r),i,o,s)),void 0,void 0)}$resolveDropEdit(e,t,r){return this._withAdapter(e,t4,i=>i.resolveDropEdit(t,r),{},void 0)}$releaseDropEdits(e,t){this._withAdapter(e,t4,r=>Promise.resolve(r.releaseDropEdits(t)),void 0,void 0)}registerMappedEditsProvider(e,t,r){const i=this._addNewAdapter(new kCe(this._documents,r),e);return this._proxy.$registerMappedEditsProvider(i,this._transformDocumentSelector(t,e)),this._createDisposable(i)}$provideMappedEdits(e,t,r,i,o){return this._withAdapter(e,kCe,s=>Promise.resolve(s.provideMappedEdits(t,r,i,o)),null,o)}registerDocumentPasteEditProvider(e,t,r,i){var s;const o=this._nextHandle();return this._adapter.set(o,new KI(new VI(this._proxy,this._documents,r,o,e),e)),this._proxy.$registerPasteEditProvider(o,this._transformDocumentSelector(t,e),{supportsCopy:!!r.prepareDocumentPaste,supportsPaste:!!r.provideDocumentPasteEdits,supportsResolve:!!r.resolveDocumentPasteEdit,providedPasteEditKinds:(s=i.providedPasteEditKinds)==null?void 0:s.map(a=>a.value),copyMimeTypes:i.copyMimeTypes,pasteMimeTypes:i.pasteMimeTypes}),this._createDisposable(o)}$prepareDocumentPaste(e,t,r,i,o){return this._withAdapter(e,VI,s=>s.prepareDocumentPaste(Te.revive(t),r,i,o),void 0,o)}$providePasteEdits(e,t,r,i,o,s,a){return this._withAdapter(e,VI,c=>c.providePasteEdits(t,Te.revive(r),i,o,s,a),void 0,a)}$resolvePasteEdit(e,t,r){return this._withAdapter(e,VI,i=>i.resolvePasteEdit(t,r),{},void 0)}$releasePasteEdits(e,t){this._withAdapter(e,VI,r=>Promise.resolve(r.releasePasteEdits(t)),void 0,void 0)}static _serializeRegExp(e){return{pattern:e.source,flags:e.flags}}static _serializeIndentationRule(e){return{decreaseIndentPattern:Zs._serializeRegExp(e.decreaseIndentPattern),increaseIndentPattern:Zs._serializeRegExp(e.increaseIndentPattern),indentNextLinePattern:e.indentNextLinePattern?Zs._serializeRegExp(e.indentNextLinePattern):void 0,unIndentedLinePattern:e.unIndentedLinePattern?Zs._serializeRegExp(e.unIndentedLinePattern):void 0}}static _serializeOnEnterRule(e){return{beforeText:Zs._serializeRegExp(e.beforeText),afterText:e.afterText?Zs._serializeRegExp(e.afterText):void 0,previousLineText:e.previousLineText?Zs._serializeRegExp(e.previousLineText):void 0,action:e.action}}static _serializeOnEnterRules(e){return e.map(Zs._serializeOnEnterRule)}static _serializeAutoClosingPair(e){return{open:e.open,close:e.close,notIn:e.notIn?e.notIn.map(t=>iEe.toString(t)):void 0}}static _serializeAutoClosingPairs(e){return e.map(Zs._serializeAutoClosingPair)}setLanguageConfiguration(e,t,r){const{wordPattern:i}=r;if(i&&D2e(i))throw new Error(`Invalid language configuration: wordPattern '${i}' is not allowed to match the empty string.`);i?this._documents.setWordDefinitionFor(t,i):this._documents.setWordDefinitionFor(t,void 0),r.__electricCharacterSupport&&this._apiDeprecation.report("LanguageConfiguration.__electricCharacterSupport",e,"Do not use."),r.__characterPairSupport&&this._apiDeprecation.report("LanguageConfiguration.__characterPairSupport",e,"Do not use.");const o=this._nextHandle(),s={comments:r.comments,brackets:r.brackets,wordPattern:r.wordPattern?Zs._serializeRegExp(r.wordPattern):void 0,indentationRules:r.indentationRules?Zs._serializeIndentationRule(r.indentationRules):void 0,onEnterRules:r.onEnterRules?Zs._serializeOnEnterRules(r.onEnterRules):void 0,__electricCharacterSupport:r.__electricCharacterSupport,__characterPairSupport:r.__characterPairSupport,autoClosingPairs:r.autoClosingPairs?Zs._serializeAutoClosingPairs(r.autoClosingPairs):void 0};return this._proxy.$setLanguageConfiguration(o,t,s),this._createDisposable(o)}$setWordDefinitions(e){for(const t of e)this._documents.setWordDefinitionFor(t.languageId,new RegExp(t.regexSource,t.regexFlags))}};Zs._handlePool=0;let IQ=Zs;class con{constructor(e,t,r,i){this._documents=t,this._commands=r,this._uriTransformer=i,this._languageIds=[],this._handlePool=0,this._ids=new Set,this._proxy=e.getProxy(dn.MainThreadLanguages)}$acceptLanguageIds(e){this._languageIds=e}async getLanguages(){return this._languageIds.slice(0)}async changeLanguage(e,t){await this._proxy.$changeLanguage(e,t);const r=this._documents.getDocumentData(e);if(!r)throw new Error(`document '${e.toString()}' NOT found`);return r.document}async tokenAtPosition(e,t){const r=e.version,i=io.from(t),o=await this._proxy.$tokensAtPosition(e.uri,i),s={type:lEe.Other,range:e.getWordRangeAtPosition(t)??new _s(t.line,t.character,t.line,t.character)};if(!o)return s;const a={range:Rn.to(o.range),type:rJe.to(o.type)};return!a.range.contains(t)||r!==e.version?s:a}createLanguageStatusItem(e,t,r){const i=this._handlePool++,o=this._proxy,s=this._ids,a=`${e.identifier.value}/${t}`;if(s.has(a))throw new Error(`LanguageStatusItem with id '${t}' ALREADY exists`);s.add(a);const c={selector:r,id:t,name:e.displayName??e.name,severity:h4.Information,command:void 0,text:"",detail:"",busy:!1};let l;const u=new ei,d=()=>{if(l==null||l.dispose(),!s.has(a)){console.warn(`LanguageStatusItem (${t}) from ${e.identifier.value} has been disposed and CANNOT be updated anymore`);return}l=iJe(()=>{u.clear(),this._proxy.$setLanguageStatus(i,{id:a,name:c.name??e.displayName??e.name,source:e.displayName??e.name,selector:r7.from(c.selector,this._uriTransformer),label:c.text,detail:c.detail??"",severity:c.severity===h4.Error?$s.Error:c.severity===h4.Warning?$s.Warning:$s.Info,command:c.command&&this._commands.toInternal(c.command,u),accessibilityInfo:c.accessibilityInformation,busy:c.busy})},0)},h={dispose(){u.dispose(),l==null||l.dispose(),o.$removeLanguageStatus(i),s.delete(a)},get id(){return c.id},get name(){return c.name},set name(f){c.name=f,d()},get selector(){return c.selector},set selector(f){c.selector=f,d()},get text(){return c.text},set text(f){c.text=f,d()},set text2(f){vt(e,"languageStatusText"),c.text=f,d()},get text2(){return vt(e,"languageStatusText"),c.text},get detail(){return c.detail},set detail(f){c.detail=f,d()},get severity(){return c.severity},set severity(f){c.severity=f,d()},get accessibilityInformation(){return c.accessibilityInformation},set accessibilityInformation(f){c.accessibilityInformation=f,d()},get command(){return c.command},set command(f){c.command=f,d()},get busy(){return c.busy},set busy(f){c.busy=f,d()}};return d(),h}}function lon(n){return n&&n.title}let PQ=class{constructor(e,t){this._logService=t,this._proxy=e.getProxy(dn.MainThreadMessageService)}showMessage(e,t,r,i,o){const s={source:{identifier:e.identifier,label:e.displayName||e.name}};let a;typeof i=="string"||lon(i)?a=[i,...o]:(s.modal=i==null?void 0:i.modal,s.useCustom=i==null?void 0:i.useCustom,s.detail=i==null?void 0:i.detail,a=o),s.useCustom&&vt(e,"resolvers");const c=[];let l=!1;for(let u=0;u<a.length;u++){const d=a[u];if(typeof d=="string")c.push({title:d,handle:u,isCloseAffordance:!1});else if(typeof d=="object"){const{title:h,isCloseAffordance:f}=d;c.push({title:h,isCloseAffordance:!!f,handle:u}),f&&(l?this._logService.warn(`[${e.identifier}] Only one message item can have 'isCloseAffordance':`,d):l=!0)}else this._logService.warn(`[${e.identifier}] Invalid message item:`,d)}return this._proxy.$showMessage(t,r,s,c).then(u=>{if(typeof u=="number")return a[u]})}};PQ=An([Be(1,Li)],PQ);class SV{constructor(e,t,r,i){this.start=e,this.deletedCount=t,this.deletedItems=r,this.items=i}asApiEvent(){return{range:new e7(this.start,this.start+this.deletedCount),addedCells:this.items.map(e=>e.apiCell),removedCells:this.deletedItems}}}class kQ{static asModelAddData(e){return{EOL:e.eol,lines:e.source,languageId:e.language,uri:e.uri,isDirty:!1,versionId:1}}constructor(e,t,r){this.notebook=e,this._extHostDocument=t,this._cellData=r,this.handle=r.handle,this.uri=Te.revive(r.uri),this.cellKind=r.cellKind,this._outputs=r.outputs.map(LM.to),this._internalMetadata=r.internalMetadata??{},this._metadata=Object.freeze(r.metadata??{}),this._previousResult=Object.freeze(gle.to(r.internalMetadata??{}))}get internalMetadata(){return this._internalMetadata}get apiCell(){if(!this._apiCell){const e=this,t=this._extHostDocument.getDocument(this.uri);if(!t)throw new Error(`MISSING extHostDocument for notebook cell: ${this.uri}`);const r={get index(){return e.notebook.getCellIndex(e)},notebook:e.notebook.apiNotebook,kind:oJe.to(this._cellData.cellKind),document:t.document,get mime(){return e._mime},set mime(i){e._mime=i},get outputs(){return e._outputs.slice(0)},get metadata(){return e._metadata},get executionSummary(){return e._previousResult}};this._apiCell=Object.freeze(r)}return this._apiCell}setOutputs(e){this._outputs=e.map(LM.to)}setOutputItems(e,t,r){const i=r.map(uEe.to),o=this._outputs.find(s=>s.id===e);if(o&&(t||(o.items.length=0),o.items.push(...i),o.items.length>1&&o.items.every(s=>sJe(s.mime)))){const s=new Map,a=[];o.items.forEach(c=>{let l;s.has(c.mime)?l=s.get(c.mime):(l=[],s.set(c.mime,l),a.push(c.mime)),l.push(c.data)}),o.items.length=0,a.forEach(c=>{const l=aJe(s.get(c));o.items.push({mime:c,data:l.data.buffer})})}}setMetadata(e){this._metadata=Object.freeze(e)}setInternalMetadata(e){this._internalMetadata=e,this._previousResult=Object.freeze(gle.to(e))}setMime(e){}}const AL=class AL{constructor(e,t,r,i,o){this._proxy=e,this._textDocumentsAndEditors=t,this._textDocuments=r,this.uri=i,this.handle=AL._handlePool++,this._cells=[],this._versionId=0,this._isDirty=!1,this._disposed=!1,this._notebookType=o.viewType,this._metadata=Object.freeze(o.metadata??Object.create(null)),this._spliceNotebookCells([[0,0,o.cells]],!0,void 0),this._versionId=o.versionId}dispose(){this._disposed=!0}get versionId(){return this._versionId}get apiNotebook(){if(!this._notebook){const e=this,t={get uri(){return e.uri},get version(){return e._versionId},get notebookType(){return e._notebookType},get isDirty(){return e._isDirty},get isUntitled(){return e.uri.scheme===hr.untitled},get isClosed(){return e._disposed},get metadata(){return e._metadata},get cellCount(){return e._cells.length},cellAt(r){return r=e._validateIndex(r),e._cells[r].apiCell},getCells(r){return(r?e._getCells(r):e._cells).map(o=>o.apiCell)},save(){return e._save()}};this._notebook=Object.freeze(t)}return this._notebook}acceptDocumentPropertiesChanged(e){e.metadata&&(this._metadata=Object.freeze({...this._metadata,...e.metadata}))}acceptDirty(e){this._isDirty=e}acceptModelChanged(e,t,r){this._versionId=e.versionId,this._isDirty=t,this.acceptDocumentPropertiesChanged({metadata:r});const i={notebook:this.apiNotebook,metadata:r,cellChanges:[],contentChanges:[]},o=[];for(const a of e.rawEvents)a.kind===Jg.ModelChange?this._spliceNotebookCells(a.changes,!1,i.contentChanges):a.kind===Jg.Move?this._moveCells(a.index,a.length,a.newIdx,i.contentChanges):a.kind===Jg.Output?(this._setCellOutputs(a.index,a.outputs),o.push({cell:this._cells[a.index].apiCell,outputs:this._cells[a.index].apiCell.outputs})):a.kind===Jg.OutputItem?(this._setCellOutputItems(a.index,a.outputId,a.append,a.outputItems),o.push({cell:this._cells[a.index].apiCell,outputs:this._cells[a.index].apiCell.outputs})):a.kind===Jg.ChangeCellLanguage?(this._changeCellLanguage(a.index,a.language),o.push({cell:this._cells[a.index].apiCell,document:this._cells[a.index].apiCell.document})):a.kind===Jg.ChangeCellContent?o.push({cell:this._cells[a.index].apiCell,document:this._cells[a.index].apiCell.document}):a.kind===Jg.ChangeCellMime?this._changeCellMime(a.index,a.mime):a.kind===Jg.ChangeCellMetadata?(this._changeCellMetadata(a.index,a.metadata),o.push({cell:this._cells[a.index].apiCell,metadata:this._cells[a.index].apiCell.metadata})):a.kind===Jg.ChangeCellInternalMetadata&&(this._changeCellInternalMetadata(a.index,a.internalMetadata),o.push({cell:this._cells[a.index].apiCell,executionSummary:this._cells[a.index].apiCell.executionSummary}));const s=new Map;for(let a=0;a<o.length;a++){const c=o[a],l=s.get(c.cell);if(l===void 0){const u=i.cellChanges.push({document:void 0,executionSummary:void 0,metadata:void 0,outputs:void 0,...c});s.set(c.cell,u-1)}else i.cellChanges[l]={...i.cellChanges[l],...c}}return i}_validateIndex(e){return e=e|0,e<0?0:e>=this._cells.length?this._cells.length-1:e}_validateRange(e){let t=e.start|0,r=e.end|0;return t<0&&(t=0),r>this._cells.length&&(r=this._cells.length),e.with({start:t,end:r})}_getCells(e){e=this._validateRange(e);const t=[];for(let r=e.start;r<e.end;r++)t.push(this._cells[r]);return t}async _save(){return this._disposed?Promise.reject(new Error("Notebook has been closed")):this._proxy.$trySaveNotebook(this.uri)}_spliceNotebookCells(e,t,r){if(this._disposed)return;const i=[],o=[],s=[];if(e.reverse().forEach(a=>{const l=a[2].map(h=>{const f=new kQ(this,this._textDocumentsAndEditors,h);return t||o.push(kQ.asModelAddData(h)),f}),u=new SV(a[0],a[1],[],l),d=this._cells.splice(a[0],a[1],...l);for(const h of d)s.push(h.uri),u.deletedItems.push(h.apiCell);i.push(u)}),this._textDocumentsAndEditors.acceptDocumentsAndEditorsDelta({addedDocuments:o,removedDocuments:s}),r)for(const a of i)r.push(a.asApiEvent())}_moveCells(e,t,r,i){const o=this._cells.splice(e,t);this._cells.splice(r,0,...o);const s=[new SV(e,t,o.map(a=>a.apiCell),[]),new SV(r,0,[],o)];for(const a of s)i.push(a.asApiEvent())}_setCellOutputs(e,t){this._cells[e].setOutputs(t)}_setCellOutputItems(e,t,r,i){this._cells[e].setOutputItems(t,r,i)}_changeCellLanguage(e,t){const r=this._cells[e];r.apiCell.document.languageId!==t&&this._textDocuments.$acceptModelLanguageChanged(r.uri,t)}_changeCellMime(e,t){const r=this._cells[e];r.apiCell.mime=t}_changeCellMetadata(e,t){this._cells[e].setMetadata(t)}_changeCellInternalMetadata(e,t){this._cells[e].setInternalMetadata(t)}getCellFromApiCell(e){return this._cells.find(t=>t.apiCell===e)}getCellFromIndex(e){return this._cells[e]}getCell(e){return this._cells.find(t=>t.handle===e)}getCellIndex(e){return this._cells.indexOf(e)}};AL._handlePool=0;let TQ=AL;const OL=class OL{constructor(e,t,r,i,o,s){this.id=e,this._proxy=t,this.notebookData=r,this._selections=[],this._visibleRanges=[],this._visible=!1,this._selections=o,this._visibleRanges=i,this._viewColumn=s}get apiEditor(){if(!this._editor){const e=this;this._editor={get notebook(){return e.notebookData.apiNotebook},get selection(){return e._selections[0]},set selection(t){this.selections=[t]},get selections(){return e._selections},set selections(t){if(!Array.isArray(t)||!t.every(e7.isNotebookRange))throw yM("selections");e._selections=t,e._trySetSelections(t)},get visibleRanges(){return e._visibleRanges},revealRange(t,r){e._proxy.$tryRevealRange(e.id,J0.from(t),r??dEe.Default)},get viewColumn(){return e._viewColumn}},OL.apiEditorsToExtHost.set(this._editor,this)}return this._editor}get visible(){return this._visible}_acceptVisibility(e){this._visible=e}_acceptVisibleRanges(e){this._visibleRanges=e}_acceptSelections(e){this._selections=e}_trySetSelections(e){this._proxy.$trySetSelections(this.id,e.map(J0.from))}_acceptViewColumn(e){this._viewColumn=e}};OL.apiEditorsToExtHost=new WeakMap;let _T=OL;class uon extends Dr{constructor(e,t,r){super(),this._source=e,this._inputTextBuffer=t,this._outputs=r,this._outputTextBuffers=void 0}_getFullModelRange(e){const t=e.getLineCount();return new Sy(1,1,t,this._getLineMaxColumn(e,t))}_getLineMaxColumn(e,t){if(t<1||t>e.getLineCount())throw new Error("Illegal value for lineNumber");return e.getLineLength(t)+1}get inputTextBuffer(){if(!this._inputTextBuffer){const e=new mle;e.acceptChunk(this._source);const t=e.finish(!0),{textBuffer:r,disposable:i}=t.create(1);this._inputTextBuffer=r,this._register(i)}return this._inputTextBuffer}get outputTextBuffers(){return this._outputTextBuffers||(this._outputTextBuffers=this._outputs.map(e=>{const t=new mle;t.acceptChunk(e);const r=t.finish(!0),{textBuffer:i,disposable:o}=r.create(1);return this._register(o),i})),this._outputTextBuffers}findInInputs(e){const r=new vle(e,!1,!1,null).parseSearchRequest();if(!r)return[];const i=this._getFullModelRange(this.inputTextBuffer);return this.inputTextBuffer.findMatchesLineByLine(i,r,!0,5e3)}findInOutputs(e){const r=new vle(e,!1,!1,null).parseSearchRequest();return r?this.outputTextBuffers.map(i=>{const o=i.findMatchesLineByLine(this._getFullModelRange(i),r,!0,5e3);if(o.length!==0)return{textBuffer:i,matches:o}}).filter(i=>!!i):[]}}function TCe(n,e){let t=-1;const r=[];let i=[];return n.forEach(s=>{s.range.startLineNumber!==t&&i.length>0&&(r.push([...i]),i=[]),i.push(s),t=s.range.endLineNumber}),i.length>0&&r.push([...i]),r.map(s=>{const a=[],c=s[0].range.startLineNumber,l=s[s.length-1].range.endLineNumber;for(let u=c;u<=l;u++)a.push(e.getLineContent(u));return new cJe(a.join(`
`)+`
`,s.map(u=>new Sy(u.range.startLineNumber-1,u.range.startColumn-1,u.range.endLineNumber-1,u.range.endColumn-1)))})}const DCe="vs/workbench/api/common/extHostNotebook",g1=class g1{get activeNotebookEditor(){var e;return(e=this._activeNotebookEditor)==null?void 0:e.apiEditor}get visibleNotebookEditors(){return this._visibleNotebookEditors.map(e=>e.apiEditor)}constructor(e,t,r,i,o,s){this._textDocumentsAndEditors=r,this._textDocuments=i,this._extHostFileSystem=o,this._extHostSearch=s,this._notebookStatusBarItemProviders=new Map,this._documents=new Wl,this._editors=new Map,this._onDidChangeActiveNotebookEditor=new ft,this.onDidChangeActiveNotebookEditor=this._onDidChangeActiveNotebookEditor.event,this._visibleNotebookEditors=[],this._onDidOpenNotebookDocument=new ft,this.onDidOpenNotebookDocument=this._onDidOpenNotebookDocument.event,this._onDidCloseNotebookDocument=new ft,this.onDidCloseNotebookDocument=this._onDidCloseNotebookDocument.event,this._onDidChangeVisibleNotebookEditors=new ft,this.onDidChangeVisibleNotebookEditors=this._onDidChangeVisibleNotebookEditors.event,this._statusBarCache=new Kd("NotebookCellStatusBarCache"),this._handlePool=0,this._notebookSerializer=new Map,this._notebookProxy=e.getProxy(dn.MainThreadNotebook),this._notebookDocumentsProxy=e.getProxy(dn.MainThreadNotebookDocuments),this._notebookEditorsProxy=e.getProxy(dn.MainThreadNotebookEditors),this._commandsConverter=t.converter,t.registerArgumentProcessor({processArgument:a=>{var c;if(a&&a.$mid===13){const l=(c=a.notebookEditor)==null?void 0:c.notebookUri,u=a.cell.handle,d=this._documents.get(l),h=d==null?void 0:d.getCell(u);if(h)return h.apiCell}if(a&&a.$mid===14){const l=a.uri,u=this._documents.get(l);if(u)return u.apiNotebook}return a}}),g1._registerApiCommands(t)}getEditorById(e){const t=this._editors.get(e);if(!t)throw new Error(`unknown text editor: ${e}. known editors: ${[...this._editors.keys()]} `);return t}getIdByEditor(e){for(const[t,r]of this._editors)if(r.apiEditor===e)return t}get notebookDocuments(){return[...this._documents.values()]}getNotebookDocument(e,t){const r=this._documents.get(e);if(!r&&!t)throw new Error(`NO notebook document for '${e}'`);return r}static _convertNotebookRegistrationData(e,t){if(!t)return;const r=t.filenamePattern.map(i=>Wxe.from(i)).filter(i=>i!==void 0);if(t.filenamePattern&&!r){console.warn(`Notebook content provider view options file name pattern is invalid ${t.filenamePattern}`);return}return{extension:e.identifier,providerDisplayName:e.displayName||e.name,displayName:t.displayName,filenamePattern:r,exclusive:t.exclusive||!1}}registerNotebookCellStatusBarItemProvider(e,t,r){const i=g1._notebookStatusBarItemProviderHandlePool++,o=typeof r.onDidChangeCellStatusBarItems=="function"?g1._notebookStatusBarItemProviderHandlePool++:void 0;this._notebookStatusBarItemProviders.set(i,r),this._notebookProxy.$registerNotebookCellStatusBarItemProvider(i,o,t);let s;return o!==void 0&&(s=r.onDidChangeCellStatusBarItems(a=>this._notebookProxy.$emitCellStatusBarEvent(o))),new pi(()=>{this._notebookStatusBarItemProviders.delete(i),this._notebookProxy.$unregisterNotebookCellStatusBarItemProvider(i,o),s==null||s.dispose()})}async createNotebookDocument(e){const t=await this._notebookDocumentsProxy.$tryCreateNotebook({viewType:e.viewType,content:e.content&&L_.from(e.content)});return Te.revive(t)}async openNotebookDocument(e){const t=this._documents.get(e);if(t)return t.apiNotebook;const r=await this._notebookDocumentsProxy.$tryOpenNotebook(e),i=this._documents.get(Te.revive(r));return bM(i==null?void 0:i.apiNotebook)}async showNotebookDocument(e,t){var s;Te.isUri(e)&&(e=await this.openNotebookDocument(e));let r;typeof t=="object"?r={position:Ma.from(t.viewColumn),preserveFocus:t.preserveFocus,selections:t.selections&&t.selections.map(J0.from),pinned:typeof t.preview=="boolean"?!t.preview:void 0}:r={preserveFocus:!1};const i=await this._notebookEditorsProxy.$tryShowNotebookDocument(e.uri,e.notebookType,r),o=i&&((s=this._editors.get(i))==null?void 0:s.apiEditor);if(o)return o;throw i?new Error(`Could NOT open editor for "${e.uri.toString()}" because another editor opened in the meantime.`):new Error(`Could NOT open editor for "${e.uri.toString()}".`)}async $provideNotebookCellStatusBarItems(e,t,r,i){const o=this._notebookStatusBarItemProviders.get(e),s=Te.revive(t),a=this._documents.get(s);if(!a||!o)return;const c=a.getCellFromIndex(r);if(!c)return;const l=await o.provideCellStatusBarItems(c.apiCell,i);if(!l)return;const u=new ei,d=this._statusBarCache.add([u]),f=(Array.isArray(l)?l:[l]).map(p=>lJe.from(p,this._commandsConverter,u));return{cacheId:d,items:f}}$releaseNotebookCellStatusBarItems(e){this._statusBarCache.delete(e)}registerNotebookSerializer(e,t,r,i,o){if(oW(t))throw new Error("viewType cannot be empty or just whitespace");const s=this._handlePool++;return this._notebookSerializer.set(s,{viewType:t,serializer:r,options:i}),this._notebookProxy.$registerNotebookSerializer(s,{id:e.identifier,location:e.extensionLocation},t,uJe.from(i),g1._convertNotebookRegistrationData(e,o)),ho(()=>{this._notebookProxy.$unregisterNotebookSerializer(s)})}async $dataToNotebook(e,t,r){const i=this._notebookSerializer.get(e);if(!i)throw new Error("NO serializer found");const o=await i.serializer.deserializeNotebook(t.buffer,r);return new _y(L_.from(o))}async $notebookToData(e,t,r){const i=this._notebookSerializer.get(e);if(!i)throw new Error("NO serializer found");const o=await i.serializer.serializeNotebook(L_.to(t.value),r);return ac.wrap(o)}async $saveNotebook(e,t,r,i,o){var p;const s=Te.revive(t),a=this._notebookSerializer.get(e);if(!a)throw new Error("NO serializer found");const c=this._documents.get(s);if(!c)throw new Error("Document NOT found");if(c.versionId!==r)throw new Error("Document version mismatch");if(!this._extHostFileSystem.value.isWritableFileSystem(s.scheme))throw new Uce(Ve(DCe,0,"Unable to modify read-only file '{0}'",this._resourceForError(s)),6);await this._validateWriteFile(s,i);const l={metadata:yle(c.apiNotebook.metadata,g=>{var m;return!(((m=a.options)==null?void 0:m.transientDocumentMetadata)??{})[g]}),cells:[]};for(const g of c.apiNotebook.getCells()){const m=new hEe(g.kind,g.document.getText(),g.document.languageId,g.mime,(p=a.options)!=null&&p.transientOutputs?[]:[...g.outputs],g.metadata,g.executionSummary);m.metadata=yle(g.metadata,v=>{var b;return!(((b=a.options)==null?void 0:b.transientCellMetadata)??{})[v]}),l.cells.push(m)}const u=await a.serializer.serializeNotebook(l,o);await this._extHostFileSystem.value.writeFile(s,u);const d=this._extHostFileSystem.getFileSystemProviderExtUri(s.scheme),h=await this._extHostFileSystem.value.stat(s);return{name:d.basename(s),isFile:(h.type&RP.File)!==0,isDirectory:(h.type&RP.Directory)!==0,isSymbolicLink:(h.type&RP.SymbolicLink)!==0,mtime:h.mtime,ctime:h.ctime,size:h.size,readonly:!!((h.permissions??0)&gM.Readonly)||!this._extHostFileSystem.value.isWritableFileSystem(s.scheme),locked:!!((h.permissions??0)&gM.Locked),etag:zce({mtime:h.mtime,size:h.size}),children:void 0}}async $searchInNotebooks(e,t,r,i,o){var h;const s=(h=this._notebookSerializer.get(e))==null?void 0:h.serializer;if(!s)return{limitHit:!1,results:[]};const a=new nZe;await(async(f,p,g)=>{await Promise.all(f.map(async m=>await Promise.all(m.filenamePatterns.map(v=>{const b={_reason:g._reason,folderQueries:g.folderQueries,includePattern:g.includePattern,excludePattern:g.excludePattern,maxResults:g.maxResults,type:1,filePattern:v};return this._extHostSearch.doInternalFileSearchWithCustomCallback(b,p,S=>{S.forEach(E=>{a.has(E)||i.some(C=>m.isFromSettings&&!C.isFromSettings?!1:C.filenamePatterns.some(I=>dJe(I,E)))||a.add(E)})}).catch(S=>{if(S.code==="ENOENT")return console.warn("Could not find notebook search results, ignoring notebook results."),{limitHit:!1,messages:[]};throw S})}))))})(r,o,t);const l=new Wl;let u=!1;const d=Array.from(a).map(async f=>{const p=[];try{if(o.isCancellationRequested)return;if(t.maxResults&&[...l.values()].reduce((b,S)=>b+S.cellResults.length,0)>t.maxResults){u=!0;return}const g=[],m=this._documents.get(f);if(m)m.apiNotebook.getCells().forEach(S=>g.push({input:S.document.getText(),outputs:S.outputs.flatMap(E=>E.items.map(w=>w.data.toString()))}));else{const b=await this._extHostFileSystem.value.readFile(f),S=ac.fromString(b.toString()),E=await s.deserializeNotebook(S.buffer,o);if(o.isCancellationRequested)return;L_.from(E).cells.forEach(C=>g.push({input:C.source,outputs:C.outputs.flatMap(I=>I.items.map(T=>T.valueBytes.toString()))}))}if(o.isCancellationRequested)return;g.forEach((b,S)=>{const E=t.contentPattern.pattern,w=new uon(b.input,void 0,b.outputs),C=w.findInInputs(E),I=w.findInOutputs(E),T=I.flatMap(D=>TCe(D.matches,D.textBuffer)).map((D,O)=>(D.webviewIndex=O,D));if(C.length>0||I.length>0){const D={index:S,contentResults:TCe(C,w.inputTextBuffer),webviewResults:T};p.push(D)}});const v={resource:f,cellResults:p};l.set(f,v);return}catch{return}});return await Promise.all(d),{limitHit:u,results:[...l.values()]}}async _validateWriteFile(e,t){const r=await this._extHostFileSystem.value.stat(e);if(typeof(t==null?void 0:t.mtime)=="number"&&typeof t.etag=="string"&&t.etag!==rZe&&typeof r.mtime=="number"&&typeof r.size=="number"&&t.mtime<r.mtime&&t.etag!==zce({mtime:t.mtime,size:r.size}))throw new Uce(Ve(DCe,1,"File Modified Since"),3,t)}_resourceForError(e){return e.scheme===hr.file?e.fsPath:e.toString()}_createExtHostEditor(e,t,r){if(this._editors.has(t))throw new Error(`editor with id ALREADY EXSIST: ${t}`);const i=new _T(t,this._notebookEditorsProxy,e,r.visibleRanges.map(J0.to),r.selections.map(J0.to),typeof r.viewColumn=="number"?Ma.to(r.viewColumn):void 0);this._editors.set(t,i)}$acceptDocumentAndEditorsDelta(e){var t,r,i;if(e.value.removedDocuments)for(const o of e.value.removedDocuments){const s=Te.revive(o),a=this._documents.get(s);a&&(a.dispose(),this._documents.delete(s),this._textDocumentsAndEditors.$acceptDocumentsAndEditorsDelta({removedDocuments:a.apiNotebook.getCells().map(c=>c.document.uri)}),this._onDidCloseNotebookDocument.fire(a.apiNotebook));for(const c of this._editors.values())c.notebookData.uri.toString()===s.toString()&&this._editors.delete(c.id)}if(e.value.addedDocuments){const o=[];for(const s of e.value.addedDocuments){const a=Te.revive(s.uri);if(this._documents.has(a))throw new Error(`adding EXISTING notebook ${a} `);const c=new TQ(this._notebookDocumentsProxy,this._textDocumentsAndEditors,this._textDocuments,a,s);o.push(...s.cells.map(l=>kQ.asModelAddData(l))),(t=this._documents.get(a))==null||t.dispose(),this._documents.set(a,c),this._textDocumentsAndEditors.$acceptDocumentsAndEditorsDelta({addedDocuments:o}),this._onDidOpenNotebookDocument.fire(c.apiNotebook)}}if(e.value.addedEditors)for(const o of e.value.addedEditors){if(this._editors.has(o.id))return;const s=Te.revive(o.documentUri),a=this._documents.get(s);a&&this._createExtHostEditor(a,o.id,o)}if(e.value.removedEditors)for(const o of e.value.removedEditors){const s=this._editors.get(o);s&&(this._editors.delete(o),((r=this._activeNotebookEditor)==null?void 0:r.id)===s.id&&(this._activeNotebookEditor=void 0))}if(e.value.visibleEditors){this._visibleNotebookEditors=e.value.visibleEditors.map(s=>this._editors.get(s)).filter(s=>!!s);const o=new Set;this._visibleNotebookEditors.forEach(s=>o.add(s.id));for(const s of this._editors.values()){const a=o.has(s.id);s._acceptVisibility(a)}this._visibleNotebookEditors=[...this._editors.values()].map(s=>s).filter(s=>s.visible),this._onDidChangeVisibleNotebookEditors.fire(this.visibleNotebookEditors)}e.value.newActiveEditor===null?this._activeNotebookEditor=void 0:e.value.newActiveEditor&&(this._editors.get(e.value.newActiveEditor)||console.error(`FAILED to find active notebook editor ${e.value.newActiveEditor}`),this._activeNotebookEditor=this._editors.get(e.value.newActiveEditor)),e.value.newActiveEditor!==void 0&&this._onDidChangeActiveNotebookEditor.fire((i=this._activeNotebookEditor)==null?void 0:i.apiEditor)}static _registerApiCommands(e){const t=jt.String.with("notebookType","A notebook type"),r=new vr("vscode.executeDataToNotebook","_executeDataToNotebook","Invoke notebook serializer",[t,new jt("data","Bytes to convert to data",o=>o instanceof Uint8Array,o=>ac.wrap(o))],new ir("Notebook Data",o=>L_.to(o.value))),i=new vr("vscode.executeNotebookToData","_executeNotebookToData","Invoke notebook serializer",[t,new jt("NotebookData","Notebook data to convert to bytes",o=>!0,o=>new _y(L_.from(o)))],new ir("Bytes",o=>o.buffer));e.registerApiCommand(r),e.registerApiCommand(i)}};g1._notebookStatusBarItemProviderHandlePool=0;let DQ=g1;class don{constructor(e,t,r,i={timeout:1500,errors:3}){this._logService=e,this._notebooksAndEditors=t,this._mainThreadBulkEdits=r,this._thresholds=i,this._onWillSaveNotebookDocumentEvent=new AP}dispose(){}getOnWillSaveNotebookDocumentEvent(e){return(t,r,i)=>{const o=function(a){t.call(r,a)};return o.extension=e,this._onWillSaveNotebookDocumentEvent.event(o,void 0,i)}}async $participateInSave(e,t,r){const i=Te.revive(e),o=this._notebooksAndEditors.getNotebookDocument(i);if(!o)throw new Error("Unable to resolve notebook document");const s=[];if(await this._onWillSaveNotebookDocumentEvent.fireAsync({notebook:o.apiNotebook,reason:tEe.to(t)},r,async(c,l)=>{const u=Date.now(),d=await await Promise.resolve(c);Date.now()-u>this._thresholds.timeout&&this._logService.warn("onWillSaveNotebookDocument-listener from extension",l.extension.identifier),!r.isCancellationRequested&&d&&(d instanceof n7?s.push(d):this._logService.warn("onWillSaveNotebookDocument-listener from extension",l.extension.identifier,"ignored due to invalid data"))}),r.isCancellationRequested)return!1;if(s.length===0)return!0;const a={edits:[]};for(const c of s){const{edits:l}=Jl.from(c);a.edits=a.edits.concat(l)}return this._mainThreadBulkEdits.$tryApplyWorkspaceEdit(new _y(a))}}class hon{constructor(e){this._notebooksAndEditors=e,this._onDidSaveNotebookDocument=new ft,this.onDidSaveNotebookDocument=this._onDidSaveNotebookDocument.event,this._onDidChangeNotebookDocument=new ft,this.onDidChangeNotebookDocument=this._onDidChangeNotebookDocument.event}$acceptModelChanged(e,t,r,i){const s=this._notebooksAndEditors.getNotebookDocument(Te.revive(e)).acceptModelChanged(t.value,r,i);this._onDidChangeNotebookDocument.fire(s)}$acceptDirtyStateChanged(e,t){this._notebooksAndEditors.getNotebookDocument(Te.revive(e)).acceptDirty(t)}$acceptModelSaved(e){const t=this._notebooksAndEditors.getNotebookDocument(Te.revive(e));this._onDidSaveNotebookDocument.fire(t.apiNotebook)}}let RQ=class{constructor(e,t){this._logService=e,this._notebooksAndEditors=t,this._onDidChangeNotebookEditorSelection=new ft,this._onDidChangeNotebookEditorVisibleRanges=new ft,this.onDidChangeNotebookEditorSelection=this._onDidChangeNotebookEditorSelection.event,this.onDidChangeNotebookEditorVisibleRanges=this._onDidChangeNotebookEditorVisibleRanges.event}$acceptEditorPropertiesChanged(e,t){this._logService.debug("ExtHostNotebook#$acceptEditorPropertiesChanged",e,t);const r=this._notebooksAndEditors.getEditorById(e);t.visibleRanges&&r._acceptVisibleRanges(t.visibleRanges.ranges.map(J0.to)),t.selections&&r._acceptSelections(t.selections.selections.map(J0.to)),t.visibleRanges&&this._onDidChangeNotebookEditorVisibleRanges.fire({notebookEditor:r.apiEditor,visibleRanges:r.apiEditor.visibleRanges}),t.selections&&this._onDidChangeNotebookEditorSelection.fire(Object.freeze({notebookEditor:r.apiEditor,selections:r.apiEditor.selections}))}$acceptEditorViewColumns(e){for(const t in e)this._notebooksAndEditors.getEditorById(t)._acceptViewColumn(Ma.to(e[t]))}};RQ=An([Be(0,Li)],RQ);const fon=100;let AQ=class{constructor(e,t,r,i,o){this._initData=t,this._extHostNotebook=r,this._commands=i,this._logService=o,this._activeExecutions=new Wl,this._activeNotebookExecutions=new Wl,this._kernelDetectionTask=new Map,this._kernelDetectionTaskHandlePool=0,this._kernelSourceActionProviders=new Map,this._kernelSourceActionProviderHandlePool=0,this._kernelData=new Map,this._handlePool=0,this._onDidChangeCellExecutionState=new ft,this.onDidChangeNotebookCellExecutionState=this._onDidChangeCellExecutionState.event,this.id=0,this.variableStore={},this._proxy=e.getProxy(dn.MainThreadNotebookKernels);const s=new vr("notebook.selectKernel","_notebook.selectKernel","Trigger kernel picker for specified notebook editor widget",[new jt("options","Select kernel options",c=>!0,c=>{if(c&&"notebookEditor"in c&&"id"in c){const l=this._extHostNotebook.getIdByEditor(c.notebookEditor);return{id:c.id,extension:c.extension,notebookEditorId:l}}else if(c&&"notebookEditor"in c){const l=this._extHostNotebook.getIdByEditor(c.notebookEditor);if(l===void 0)throw new Error(`Cannot invoke 'notebook.selectKernel' for unrecognized notebook editor ${c.notebookEditor.notebook.uri.toString()}`);return{notebookEditorId:l}}return c})],ir.Void),a=new vr("vscode.executeNotebookVariableProvider","_executeNotebookVariableProvider","Execute notebook variable provider",[jt.Uri],new ir("A promise that resolves to an array of variables",(c,l)=>c.map(u=>({variable:{name:u.name,value:u.value,expression:u.expression,type:u.type,language:u.language},hasNamedChildren:u.hasNamedChildren,indexedChildrenCount:u.indexedChildrenCount}))));this._commands.registerApiCommand(s),this._commands.registerApiCommand(a)}createNotebookController(e,t,r,i,o,s){for(const w of this._kernelData.values())if(w.controller.id===t&&jc.equals(e.identifier,w.extensionId))throw new Error(`notebook controller with id '${t}' ALREADY exist`);const a=this._handlePool++,c=this;this._logService.trace(`NotebookController[${a}], CREATED by ${e.identifier.value}, ${t}`);const l=()=>console.warn(`NO execute handler from notebook controller '${f.id}' of extension: '${e.identifier}'`);let u=!1;const d=new ft,h=new ft,f={id:n4(e.identifier,t),notebookType:r,extensionId:e.identifier,extensionLocation:e.extensionLocation,label:i||e.identifier.value,preloads:s?s.map(ble.from):[]};let p=o??l,g,m;this._proxy.$addKernel(a,f).catch(w=>{console.log(w),u=!0});let v=0;const b=()=>{if(u)return;const w=++v;Promise.resolve().then(()=>{w===v&&this._proxy.$updateKernel(a,f)})},S=new Wl,E={get id(){return t},get notebookType(){return f.notebookType},onDidChangeSelectedNotebooks:d.event,get label(){return f.label},set label(w){f.label=w??e.displayName??e.name,b()},get detail(){return f.detail??""},set detail(w){f.detail=w,b()},get description(){return f.description??""},set description(w){f.description=w,b()},get supportedLanguages(){return f.supportedLanguages},set supportedLanguages(w){f.supportedLanguages=w,b()},get supportsExecutionOrder(){return f.supportsExecutionOrder??!1},set supportsExecutionOrder(w){f.supportsExecutionOrder=w,b()},get rendererScripts(){return f.preloads?f.preloads.map(ble.to):[]},get executeHandler(){return p},set executeHandler(w){p=w??l},get interruptHandler(){return g},set interruptHandler(w){g=w,f.supportsInterrupt=!!w,b()},set variableProvider(w){vt(e,"notebookVariableProvider"),m=w,f.hasVariableProvider=!!w,w==null||w.onDidChangeVariables(C=>c._proxy.$variablesUpdated(C.uri)),b()},get variableProvider(){return m},createNotebookCellExecution(w){if(u)throw new Error("notebook controller is DISPOSED");if(!S.has(w.notebook.uri))throw c._logService.trace(`NotebookController[${a}] NOT associated to notebook, associated to THESE notebooks:`,Array.from(S.keys()).map(C=>C.toString())),new Error(`notebook controller is NOT associated to notebook: ${w.notebook.uri.toString()}`);return c._createNotebookCellExecution(w,n4(e.identifier,this.id))},createNotebookExecution(w){if(vt(e,"notebookExecution"),u)throw new Error("notebook controller is DISPOSED");if(!S.has(w.uri))throw c._logService.trace(`NotebookController[${a}] NOT associated to notebook, associated to THESE notebooks:`,Array.from(S.keys()).map(C=>C.toString())),new Error(`notebook controller is NOT associated to notebook: ${w.uri.toString()}`);return c._createNotebookExecution(w,n4(e.identifier,this.id))},dispose:()=>{u||(this._logService.trace(`NotebookController[${a}], DISPOSED`),u=!0,this._kernelData.delete(a),d.dispose(),h.dispose(),this._proxy.$removeKernel(a))},updateNotebookAffinity(w,C){C===fEe.Hidden&&vt(e,"notebookControllerAffinityHidden"),c._proxy.$updateNotebookPriority(a,w.uri,C)},onDidReceiveMessage:h.event,postMessage(w,C){return vt(e,"notebookMessaging"),c._proxy.$postMessage(a,C&&c._extHostNotebook.getIdByEditor(C),w)},asWebviewUri(w){return vt(e,"notebookMessaging"),Ck(w,c._initData.remote)}};return this._kernelData.set(a,{extensionId:e.identifier,controller:E,onDidReceiveMessage:h,onDidChangeSelection:d,associatedNotebooks:S}),E}getIdByController(e){for(const[t,r]of this._kernelData)if(r.controller===e)return n4(r.extensionId,e.id);return null}createNotebookControllerDetectionTask(e,t){const r=this._kernelDetectionTaskHandlePool++,i=this;this._logService.trace(`NotebookControllerDetectionTask[${r}], CREATED by ${e.identifier.value}`),this._proxy.$addKernelDetectionTask(r,t);const o={dispose:()=>{this._kernelDetectionTask.delete(r),i._proxy.$removeKernelDetectionTask(r)}};return this._kernelDetectionTask.set(r,o),o}registerKernelSourceActionProvider(e,t,r){const i=this._kernelSourceActionProviderHandlePool++,o=typeof r.onDidChangeNotebookKernelSourceActions=="function"?i:void 0,s=this;this._kernelSourceActionProviders.set(i,r),this._logService.trace(`NotebookKernelSourceActionProvider[${i}], CREATED by ${e.identifier.value}`),this._proxy.$addKernelSourceActionProvider(i,i,t);let a;return o!==void 0&&(a=r.onDidChangeNotebookKernelSourceActions(c=>this._proxy.$emitNotebookKernelSourceActionsChangeEvent(o))),{dispose:()=>{this._kernelSourceActionProviders.delete(i),s._proxy.$removeKernelSourceActionProvider(i,i),a==null||a.dispose()}}}async $provideKernelSourceActions(e,t){const r=this._kernelSourceActionProviders.get(e);if(r){const i=new ei;return(await r.provideNotebookKernelSourceActions(t)??[]).map(s=>hJe.from(s,this._commands.converter,i))}return[]}$acceptNotebookAssociation(e,t,r){const i=this._kernelData.get(e);if(i){const o=this._extHostNotebook.getNotebookDocument(Te.revive(t));r?i.associatedNotebooks.set(o.uri,!0):i.associatedNotebooks.delete(o.uri),this._logService.trace(`NotebookController[${e}] ASSOCIATE notebook`,o.uri.toString(),r),i.onDidChangeSelection.fire({selected:r,notebook:o.apiNotebook})}}async $executeCells(e,t,r){const i=this._kernelData.get(e);if(!i)return;const o=this._extHostNotebook.getNotebookDocument(Te.revive(t)),s=[];for(const a of r){const c=o.getCell(a);c&&s.push(c.apiCell)}try{this._logService.trace(`NotebookController[${e}] EXECUTE cells`,o.uri.toString(),s.length),await i.controller.executeHandler.call(i.controller,s,o.apiNotebook,i.controller)}catch(a){this._logService.error(`NotebookController[${e}] execute cells FAILED`,a),console.error(a)}}async $cancelCells(e,t,r){var s;const i=this._kernelData.get(e);if(!i)return;const o=this._extHostNotebook.getNotebookDocument(Te.revive(t));if(i.controller.interruptHandler)await i.controller.interruptHandler.call(i.controller,o.apiNotebook);else for(const a of r){const c=o.getCell(a);c&&((s=this._activeExecutions.get(c.uri))==null||s.cancel())}if(i.controller.interruptHandler){const a=this._activeNotebookExecutions.get(o.uri);r.length&&Array.isArray(a)&&a.length&&a.forEach(c=>c.dispose())}}async $provideVariables(e,t,r,i,o,s,a){const c=this._kernelData.get(e);if(!c)return;const l=this._extHostNotebook.getNotebookDocument(Te.revive(r)),u=c.controller.variableProvider;if(!u)return;let d;if(i!==void 0){if(d=this.variableStore[i],!d)return}else this.variableStore={};const h=o==="named"?zW.Named:zW.Indexed,f=u.provideVariables(l.apiNotebook,d,h,s,a);let p=0;for await(const g of f){if(a.isCancellationRequested)return;const m={id:this.id++,name:g.variable.name,value:g.variable.value,type:g.variable.type,interfaces:g.variable.interfaces,language:g.variable.language,expression:g.variable.expression,hasNamedChildren:g.hasNamedChildren,indexedChildrenCount:g.indexedChildrenCount,extensionId:c.extensionId.value};if(this.variableStore[m.id]=g.variable,this._proxy.$receiveVariable(t,m),p++>=fon)return}}$acceptKernelMessageFromRenderer(e,t,r){const i=this._kernelData.get(e);if(!i)return;const o=this._extHostNotebook.getEditorById(t);i.onDidReceiveMessage.fire(Object.freeze({editor:o.apiEditor,message:r}))}$cellExecutionChanged(e,t,r){const o=this._extHostNotebook.getNotebookDocument(Te.revive(e)).getCell(t);if(o){const s=r?fJe.to(r):pEe.Idle;s!==void 0&&this._onDidChangeCellExecutionState.fire({cell:o.apiCell,state:s})}}_createNotebookCellExecution(e,t){if(e.index<0)throw new Error("CANNOT execute cell that has been REMOVED from notebook");const i=this._extHostNotebook.getNotebookDocument(e.notebook.uri).getCellFromApiCell(e);if(!i)throw new Error("invalid cell");if(this._activeExecutions.has(i.uri))throw new Error(`duplicate execution for ${i.uri}`);const o=new OQ(t,i,this._proxy);this._activeExecutions.set(i.uri,o);const s=o.onDidChangeState(()=>{o.state===yf.Resolved&&(o.dispose(),s.dispose(),this._activeExecutions.delete(i.uri))});return o.asApiObject()}_createNotebookExecution(e,t){const r=this._extHostNotebook.getNotebookDocument(e.uri),i=e.getCells().find(a=>{const c=r.getCellFromApiCell(a);return c&&this._activeExecutions.has(c.uri)});if(i)throw new Error(`duplicate cell execution for ${i.document.uri}`);if(this._activeNotebookExecutions.has(r.uri))throw new Error(`duplicate notebook execution for ${r.uri}`);const o=new MQ(t,r,this._proxy),s=o.onDidChangeState(()=>{o.state===xm.Resolved&&(o.dispose(),s.dispose(),this._activeNotebookExecutions.delete(r.uri))});return this._activeNotebookExecutions.set(r.uri,[o,s]),o.asApiObject()}};AQ=An([Be(4,Li)],AQ);var yf;(function(n){n[n.Init=0]="Init",n[n.Started=1]="Started",n[n.Resolved=2]="Resolved"})(yf||(yf={}));const ML=class ML extends Dr{get state(){return this._state}constructor(e,t,r){super(),this._cell=t,this._proxy=r,this._handle=ML.HANDLE++,this._onDidChangeState=new ft,this.onDidChangeState=this._onDidChangeState.event,this._state=yf.Init,this._tokenSource=this._register(new Uc),this._collector=new pon(10,i=>this.update(i)),this._executionOrder=t.internalMetadata.executionOrder,this._proxy.$createExecution(this._handle,e,this._cell.notebook.uri,this._cell.handle)}cancel(){this._tokenSource.cancel()}async updateSoon(e){await this._collector.addItem(e)}async update(e){const t=Array.isArray(e)?e:[e];return this._proxy.$updateExecution(this._handle,new _y(t))}verifyStateForOutput(){if(this._state===yf.Init)throw new Error("Must call start before modifying cell output");if(this._state===yf.Resolved)throw new Error("Cannot modify cell output after calling resolve")}cellIndexToHandle(e){let t=this._cell;if(e&&(t=this._cell.notebook.getCellFromApiCell(e)),!t)throw new Error("INVALID cell");return t.handle}validateAndConvertOutputs(e){return e.map(t=>{const r=UW.ensureUniqueMimeTypes(t.items,!0);return r===t.items?LM.from(t):LM.from({items:r,id:t.id,metadata:t.metadata})})}async updateOutputs(e,t,r){const i=this.cellIndexToHandle(t),o=this.validateAndConvertOutputs(vM(e));return this.updateSoon({editType:GR.Output,cellHandle:i,append:r,outputs:o})}async updateOutputItems(e,t,r){return e=UW.ensureUniqueMimeTypes(vM(e),!0),this.updateSoon({editType:GR.OutputItems,items:e.map(uEe.from),outputId:t.id,append:r})}asApiObject(){const e=this;return Object.freeze({get token(){return e._tokenSource.token},get cell(){return e._cell.apiCell},get executionOrder(){return e._executionOrder},set executionOrder(r){e._executionOrder=r,e.update([{editType:GR.ExecutionState,executionOrder:e._executionOrder}])},start(r){if(e._state===yf.Resolved||e._state===yf.Started)throw new Error("Cannot call start again");e._state=yf.Started,e._onDidChangeState.fire(),e.update({editType:GR.ExecutionState,runStartTime:r})},end(r,i,o){if(e._state===yf.Resolved)throw new Error("Cannot call resolve twice");e._state=yf.Resolved,e._onDidChangeState.fire(),e._collector.flush();const s=o?{message:o.message,stack:o.stack,location:o!=null&&o.location?{startLineNumber:o.location.start.line,startColumn:o.location.start.character,endLineNumber:o.location.end.line,endColumn:o.location.end.character}:void 0,uri:o.uri}:void 0;e._proxy.$completeExecution(e._handle,new _y({runEndTime:i,lastRunSuccess:r,error:s}))},clearOutput(r){return e.verifyStateForOutput(),e.updateOutputs([],r,!1)},appendOutput(r,i){return e.verifyStateForOutput(),e.updateOutputs(r,i,!0)},replaceOutput(r,i){return e.verifyStateForOutput(),e.updateOutputs(r,i,!1)},appendOutputItems(r,i){return e.verifyStateForOutput(),e.updateOutputItems(r,i,!0)},replaceOutputItems(r,i){return e.verifyStateForOutput(),e.updateOutputItems(r,i,!1)}})}};ML.HANDLE=0;let OQ=ML;var xm;(function(n){n[n.Init=0]="Init",n[n.Started=1]="Started",n[n.Resolved=2]="Resolved"})(xm||(xm={}));const $L=class $L extends Dr{get state(){return this._state}constructor(e,t,r){super(),this._notebook=t,this._proxy=r,this._handle=$L.HANDLE++,this._onDidChangeState=new ft,this.onDidChangeState=this._onDidChangeState.event,this._state=xm.Init,this._tokenSource=this._register(new Uc),this._proxy.$createNotebookExecution(this._handle,e,this._notebook.uri)}cancel(){this._tokenSource.cancel()}asApiObject(){return Object.freeze({start:()=>{if(this._state===xm.Resolved||this._state===xm.Started)throw new Error("Cannot call start again");this._state=xm.Started,this._onDidChangeState.fire(),this._proxy.$beginNotebookExecution(this._handle)},end:()=>{if(this._state===xm.Resolved)throw new Error("Cannot call resolve twice");this._state=xm.Resolved,this._onDidChangeState.fire(),this._proxy.$completeNotebookExecution(this._handle)}})}};$L.HANDLE=0;let MQ=$L;class pon{constructor(e,t){this.delay=e,this.callback=t,this.batch=[],this.startedTimer=Date.now()}addItem(e){return this.batch.push(e),this.currentDeferred||(this.currentDeferred=new Nee,this.startedTimer=Date.now(),NP(this.delay).then(()=>this.flush())),Date.now()-this.startedTimer>this.delay?this.flush():this.currentDeferred.p}flush(){if(this.batch.length===0||!this.currentDeferred)return Promise.resolve();const e=this.currentDeferred;this.currentDeferred=void 0;const t=this.batch;return this.batch=[],this.callback(t).finally(()=>e.complete())}}function n4(n,e){return`${n.value}/${e}`}class gon{constructor(e,t){this._extHostNotebook=t,this._rendererMessageEmitters=new Map,this.proxy=e.getProxy(dn.MainThreadNotebookRenderers)}$postRendererMessage(e,t,r){var o;const i=this._extHostNotebook.getEditorById(e);(o=this._rendererMessageEmitters.get(t))==null||o.fire({editor:i.apiEditor,message:r})}createRendererMessaging(e,t){var i,o;if(!((o=(i=e.contributes)==null?void 0:i.notebookRenderer)!=null&&o.some(s=>s.id===t)))throw new Error(`Extensions may only call createRendererMessaging() for renderers they contribute (got ${t})`);return{onDidReceiveMessage:(s,a,c)=>this.getOrCreateEmitterFor(t).event(s,a,c),postMessage:(s,a)=>{_T.apiEditorsToExtHost.has(s)&&([s,a]=[a,s]);const c=a&&_T.apiEditorsToExtHost.get(a);return this.proxy.$postMessage(c==null?void 0:c.id,t,s)}}}getOrCreateEmitterFor(e){let t=this._rendererMessageEmitters.get(e);return t||(t=new ft({onDidRemoveLastListener:()=>{t==null||t.dispose(),this._rendererMessageEmitters.delete(e)}}),this._rendererMessageEmitters.set(e,t),t)}}class mon{constructor(e){this.handlers=new Map,this.proxy=e.getProxy(dn.MainThreadProfileContentHandlers)}registerProfileContentHandler(e,t,r){if(vt(e,"profileContentHandlers"),this.handlers.has(t))throw new Error(`Handler with id '${t}' already registered`);return this.handlers.set(t,r),this.proxy.$registerProfileContentHandler(t,r.name,r.description,e.identifier.value),ho(()=>{this.handlers.delete(t),this.proxy.$unregisterProfileContentHandler(t)})}async $saveProfile(e,t,r,i){const o=this.handlers.get(e);if(!o)throw new Error(`Unknown handler with id: ${e}`);return o.saveProfile(t,r,i)}async $readProfile(e,t,r){const i=this.handlers.get(e);if(!i)throw new Error(`Unknown handler with id: ${e}`);return i.readProfile(Hm(t)?t:Te.revive(t),r)}}class von{constructor(e){this._handles=0,this._mapHandleToCancellationSource=new Map,this._proxy=e}async withProgress(e,t,r){const i=this._handles++,{title:o,location:s,cancellable:a}=t,c={label:e.displayName||e.name,id:e.identifier.value};return this._proxy.$startProgress(i,{location:gJe.from(s),title:o,source:c,cancellable:a},e.isUnderDevelopment?void 0:e.identifier.value).catch(fee),this._withProgress(i,r,!!a)}_withProgress(e,t,r){let i;r&&(i=new Uc,this._mapHandleToCancellationSource.set(e,i));const o=a=>{this._proxy.$progressEnd(a),this._mapHandleToCancellationSource.delete(a),i==null||i.dispose()};let s;try{s=t(new $Q(this._proxy,e),r&&i?i.token:Xl.None)}catch(a){throw o(e),a}return s.then(a=>o(e),a=>o(e)),s}$acceptProgressCanceled(e){const t=this._mapHandleToCancellationSource.get(e);t&&(t.cancel(),this._mapHandleToCancellationSource.delete(e))}}function yon(n,e){return n.message=e.message,typeof e.increment=="number"&&(typeof n.increment=="number"?n.increment+=e.increment:n.increment=e.increment),n}class $Q extends Sxe{constructor(e,t){super(r=>this.throttledReport(r)),this._proxy=e,this._handle=t}throttledReport(e){this._proxy.$progressReport(this._handle,e)}}$Q.__decorator=An([pJe(100,(n,e)=>yon(n,e),()=>Object.create(null))],$Q.prototype,"throttledReport",null);const LL=class LL{constructor(e,t){this.uriTransformer=t,this.providers=new Map,this.proxy=e.getProxy(dn.MainThreadQuickDiff)}$provideOriginalResource(e,t,r){const i=Te.revive(t),o=this.providers.get(e);return o?Lc(()=>o.provideOriginalResource(i,r)).then(s=>s||null):Promise.resolve(null)}registerQuickDiffProvider(e,t,r,i){const o=LL.handlePool++;return this.providers.set(o,t),this.proxy.$registerQuickDiffProvider(o,r7.from(e,this.uriTransformer),r,i),{dispose:()=>{this.proxy.$unregisterQuickDiffProvider(o),this.providers.delete(o)}}}};LL.handlePool=0;let LQ=LL;function bon(n,e,t){const r=n.getProxy(dn.MainThreadQuickOpen);class i{constructor(p,g){this._sessions=new Map,this._instances=0,this._workspace=p,this._commands=g}showQuickPick(p,g,m,v=Xl.None){this._onDidSelectItem=void 0;const b=Promise.resolve(g),S=++this._instances,E=r.$show(S,{title:m==null?void 0:m.title,placeHolder:m==null?void 0:m.placeHolder,matchOnDescription:m==null?void 0:m.matchOnDescription,matchOnDetail:m==null?void 0:m.matchOnDetail,ignoreFocusLost:m==null?void 0:m.ignoreFocusOut,canPickMany:m==null?void 0:m.canPickMany},v),w={},C=E.then(()=>w);return Promise.race([C,b]).then(I=>{if(I===w)return;const T=Oa(p,"quickPickItemTooltip");return b.then(D=>{const O=[];for(let M=0;M<D.length;M++){const R=D[M];if(typeof R=="string")O.push({label:R,handle:M});else if(R.kind===VW.Separator)O.push({type:"separator",label:R.label});else{R.tooltip&&!T&&console.warn(`Extension '${p.identifier.value}' uses a tooltip which is proposed API that is only available when running out of dev or with the following command line switch: --enable-proposed-api ${p.identifier.value}`);const A=R.iconPath?l(R.iconPath):void 0;O.push({label:R.label,iconPath:A==null?void 0:A.iconPath,iconClass:A==null?void 0:A.iconClass,description:R.description,detail:R.detail,picked:R.picked,alwaysShow:R.alwaysShow,tooltip:T?$a.fromStrict(R.tooltip):void 0,handle:M})}}return m&&typeof m.onDidSelectItem=="function"&&(this._onDidSelectItem=M=>{m.onDidSelectItem(D[M])}),r.$setItems(S,O),E.then(M=>{if(typeof M=="number")return D[M];if(Array.isArray(M))return M.map(R=>D[R])})})}).then(void 0,I=>{if(!SM(I))return r.$setError(S,I),Promise.reject(I)})}$onItemSelected(p){var g;(g=this._onDidSelectItem)==null||g.call(this,p)}showInput(p,g=Xl.None){return this._validateInput=p==null?void 0:p.validateInput,r.$input(p,typeof this._validateInput=="function",g).then(void 0,m=>{if(!SM(m))return Promise.reject(m)})}async $validateInput(p){if(!this._validateInput)return;const g=await this._validateInput(p);if(!g||typeof g=="string")return g;let m;switch(g.severity){case f4.Info:m=$s.Info;break;case f4.Warning:m=$s.Warning;break;case f4.Error:m=$s.Error;break;default:m=g.message?$s.Error:$s.Ignore;break}return{content:g.message,severity:m}}async showWorkspaceFolderPick(p,g=Xl.None){const m=await this._commands.executeCommand("_workbench.pickWorkspaceFolder",[p]);if(!m)return;const v=await this._workspace.getWorkspaceFolders2();if(v)return v.find(b=>b.uri.toString()===m.uri.toString())}createQuickPick(p){const g=new u(p,()=>this._sessions.delete(g._id));return this._sessions.set(g._id,g),g}createInputBox(p){const g=new d(p,()=>this._sessions.delete(g._id));return this._sessions.set(g._id,g),g}$onDidChangeValue(p,g){const m=this._sessions.get(p);m==null||m._fireDidChangeValue(g)}$onDidAccept(p){const g=this._sessions.get(p);g==null||g._fireDidAccept()}$onDidChangeActive(p,g){const m=this._sessions.get(p);m instanceof u&&m._fireDidChangeActive(g)}$onDidChangeSelection(p,g){const m=this._sessions.get(p);m instanceof u&&m._fireDidChangeSelection(g)}$onDidTriggerButton(p,g){const m=this._sessions.get(p);m==null||m._fireDidTriggerButton(g)}$onDidTriggerItemButton(p,g,m){const v=this._sessions.get(p);v instanceof u&&v._fireDidTriggerItemButton(g,m)}$onDidHide(p){const g=this._sessions.get(p);g==null||g._fireDidHide()}}const h=class h{constructor(p,g){this._extensionId=p,this._onDidDispose=g,this._id=u._nextId++,this._visible=!1,this._expectingHide=!1,this._enabled=!0,this._busy=!1,this._ignoreFocusOut=!0,this._value="",this._buttons=[],this._handlesToButtons=new Map,this._onDidAcceptEmitter=new ft,this._onDidChangeValueEmitter=new ft,this._onDidTriggerButtonEmitter=new ft,this._onDidHideEmitter=new ft,this._pendingUpdate={id:this._id},this._disposed=!1,this._disposables=[this._onDidTriggerButtonEmitter,this._onDidHideEmitter,this._onDidAcceptEmitter,this._onDidChangeValueEmitter],this.onDidChangeValue=this._onDidChangeValueEmitter.event,this.onDidAccept=this._onDidAcceptEmitter.event,this.onDidTriggerButton=this._onDidTriggerButtonEmitter.event,this.onDidHide=this._onDidHideEmitter.event}get title(){return this._title}set title(p){this._title=p,this.update({title:p})}get step(){return this._steps}set step(p){this._steps=p,this.update({step:p})}get totalSteps(){return this._totalSteps}set totalSteps(p){this._totalSteps=p,this.update({totalSteps:p})}get enabled(){return this._enabled}set enabled(p){this._enabled=p,this.update({enabled:p})}get busy(){return this._busy}set busy(p){this._busy=p,this.update({busy:p})}get ignoreFocusOut(){return this._ignoreFocusOut}set ignoreFocusOut(p){this._ignoreFocusOut=p,this.update({ignoreFocusOut:p})}get value(){return this._value}set value(p){this._value=p,this.update({value:p})}get placeholder(){return this._placeholder}set placeholder(p){this._placeholder=p,this.update({placeholder:p})}get buttons(){return this._buttons}set buttons(p){this._buttons=p.slice(),this._handlesToButtons.clear(),p.forEach((g,m)=>{const v=g===WW.Back?-1:m;this._handlesToButtons.set(v,g)}),this.update({buttons:p.map((g,m)=>({...l(g.iconPath),tooltip:g.tooltip,handle:g===WW.Back?-1:m}))})}show(){this._visible=!0,this._expectingHide=!0,this.update({visible:!0})}hide(){this._visible=!1,this.update({visible:!1})}_fireDidAccept(){this._onDidAcceptEmitter.fire()}_fireDidChangeValue(p){this._value=p,this._onDidChangeValueEmitter.fire(p)}_fireDidTriggerButton(p){const g=this._handlesToButtons.get(p);g&&this._onDidTriggerButtonEmitter.fire(g)}_fireDidHide(){this._expectingHide&&(this._expectingHide=this._visible,this._onDidHideEmitter.fire())}dispose(){this._disposed||(this._disposed=!0,this._fireDidHide(),this._disposables=_S(this._disposables),this._updateTimeout&&(clearTimeout(this._updateTimeout),this._updateTimeout=void 0),this._onDidDispose(),r.$dispose(this._id))}update(p){if(!this._disposed){for(const g of Object.keys(p)){const m=p[g];this._pendingUpdate[g]=m===void 0?null:m}"visible"in this._pendingUpdate?(this._updateTimeout&&(clearTimeout(this._updateTimeout),this._updateTimeout=void 0),this.dispatchUpdate()):this._visible&&!this._updateTimeout&&(this._updateTimeout=setTimeout(()=>{this._updateTimeout=void 0,this.dispatchUpdate()},0))}}dispatchUpdate(){r.$createOrUpdate(this._pendingUpdate),this._pendingUpdate={id:this._id}}};h._nextId=1;let o=h;function s(f){if(f instanceof Q0)return{id:f.id};const p=c(f),g=a(f);return{dark:typeof p=="string"?Te.file(p):p,light:typeof g=="string"?Te.file(g):g}}function a(f){return typeof f=="object"&&"light"in f?f.light:f}function c(f){return typeof f=="object"&&"dark"in f?f.dark:f}function l(f){const p=s(f);let g,m;return"id"in p?m=t7.asClassName(p):g=p,{iconPath:g,iconClass:m}}class u extends o{constructor(p,g){super(p.identifier,g),this.extension=p,this._items=[],this._handlesToItems=new Map,this._itemsToHandles=new Map,this._canSelectMany=!1,this._matchOnDescription=!0,this._matchOnDetail=!0,this._sortByLabel=!0,this._keepScrollPosition=!1,this._activeItems=[],this._onDidChangeActiveEmitter=new ft,this._selectedItems=[],this._onDidChangeSelectionEmitter=new ft,this._onDidTriggerItemButtonEmitter=new ft,this.onDidChangeActive=this._onDidChangeActiveEmitter.event,this.onDidChangeSelection=this._onDidChangeSelectionEmitter.event,this.onDidTriggerItemButton=this._onDidTriggerItemButtonEmitter.event,this._disposables.push(this._onDidChangeActiveEmitter,this._onDidChangeSelectionEmitter,this._onDidTriggerItemButtonEmitter),this.update({type:"quickPick"})}get items(){return this._items}set items(p){var v;this._items=p.slice(),this._handlesToItems.clear(),this._itemsToHandles.clear(),p.forEach((b,S)=>{this._handlesToItems.set(S,b),this._itemsToHandles.set(b,S)});const g=Oa(this.extension,"quickPickItemTooltip"),m=[];for(let b=0;b<p.length;b++){const S=p[b];if(S.kind===VW.Separator)m.push({type:"separator",label:S.label});else{S.tooltip&&!g&&console.warn(`Extension '${this.extension.identifier.value}' uses a tooltip which is proposed API that is only available when running out of dev or with the following command line switch: --enable-proposed-api ${this.extension.identifier.value}`);const E=S.iconPath?l(S.iconPath):void 0;m.push({handle:b,label:S.label,iconPath:E==null?void 0:E.iconPath,iconClass:E==null?void 0:E.iconClass,description:S.description,detail:S.detail,picked:S.picked,alwaysShow:S.alwaysShow,tooltip:g?$a.fromStrict(S.tooltip):void 0,buttons:(v=S.buttons)==null?void 0:v.map((w,C)=>({...l(w.iconPath),tooltip:w.tooltip,handle:C}))})}}this.update({items:m})}get canSelectMany(){return this._canSelectMany}set canSelectMany(p){this._canSelectMany=p,this.update({canSelectMany:p})}get matchOnDescription(){return this._matchOnDescription}set matchOnDescription(p){this._matchOnDescription=p,this.update({matchOnDescription:p})}get matchOnDetail(){return this._matchOnDetail}set matchOnDetail(p){this._matchOnDetail=p,this.update({matchOnDetail:p})}get sortByLabel(){return this._sortByLabel}set sortByLabel(p){this._sortByLabel=p,this.update({sortByLabel:p})}get keepScrollPosition(){return this._keepScrollPosition}set keepScrollPosition(p){this._keepScrollPosition=p,this.update({keepScrollPosition:p})}get activeItems(){return this._activeItems}set activeItems(p){this._activeItems=p.filter(g=>this._itemsToHandles.has(g)),this.update({activeItems:this._activeItems.map(g=>this._itemsToHandles.get(g))})}get selectedItems(){return this._selectedItems}set selectedItems(p){this._selectedItems=p.filter(g=>this._itemsToHandles.has(g)),this.update({selectedItems:this._selectedItems.map(g=>this._itemsToHandles.get(g))})}_fireDidChangeActive(p){const g=Qp(p.map(m=>this._handlesToItems.get(m)));this._activeItems=g,this._onDidChangeActiveEmitter.fire(g)}_fireDidChangeSelection(p){const g=Qp(p.map(m=>this._handlesToItems.get(m)));this._selectedItems=g,this._onDidChangeSelectionEmitter.fire(g)}_fireDidTriggerItemButton(p,g){const m=this._handlesToItems.get(p);if(!m||!m.buttons||!m.buttons.length)return;const v=m.buttons[g];v&&this._onDidTriggerItemButtonEmitter.fire({button:v,item:m})}}class d extends o{constructor(p,g){super(p.identifier,g),this._password=!1,this.update({type:"inputBox"})}get password(){return this._password}set password(p){this._password=p,this.update({password:p})}get prompt(){return this._prompt}set prompt(p){this._prompt=p,this.update({prompt:p})}get valueSelection(){return this._valueSelection}set valueSelection(p){this._valueSelection=p,this.update({valueSelection:p})}get validationMessage(){return this._validationMessage}set validationMessage(p){this._validationMessage=p,p?typeof p=="string"?this.update({validationMessage:p,severity:$s.Error}):this.update({validationMessage:p.message,severity:p.severity??$s.Error}):this.update({validationMessage:void 0,severity:$s.Ignore})}}return new i(e,t)}var NQ;function RCe(n){return n instanceof Te}function Son(n,e){return n.scheme===hr.file&&e.scheme===hr.file&&lee?n.toString()===e.toString():n.toString().toLowerCase()===e.toString().toLowerCase()}function _V(n){if(n)return typeof n.iconPath=="string"?Te.file(n.iconPath):Te.isUri(n.iconPath)||t7.isThemeIcon(n.iconPath)?n.iconPath:void 0}function ACe(n){if(n.icon){if(Te.isUri(n.icon))return n.icon;if(t7.isThemeIcon(n.icon))return n.icon;{const e=n.icon;return{light:e.light,dark:e.dark}}}else return}function wV(n,e){if(!n.iconPath&&!e.iconPath)return 0;if(n.iconPath){if(!e.iconPath)return 1}else return-1;const t=typeof n.iconPath=="string"?n.iconPath:Te.isUri(n.iconPath)?n.iconPath.fsPath:n.iconPath.id,r=typeof e.iconPath=="string"?e.iconPath:Te.isUri(e.iconPath)?e.iconPath.fsPath:e.iconPath.id;return p4(t,r)}function _on(n,e){let t=0;if(n.strikeThrough!==e.strikeThrough)return n.strikeThrough?1:-1;if(n.faded!==e.faded)return n.faded?1:-1;if(n.tooltip!==e.tooltip)return(n.tooltip||"").localeCompare(e.tooltip||"");if(t=wV(n,e),t!==0)return t;if(n.light&&e.light)t=wV(n.light,e.light);else{if(n.light)return 1;if(e.light)return-1}if(t!==0)return t;if(n.dark&&e.dark)t=wV(n.dark,e.dark);else{if(n.dark)return 1;if(e.dark)return-1}return t}function won(n,e){if(n.command!==e.command)return n.command<e.command?-1:1;if(n.title!==e.title)return n.title<e.title?-1:1;if(n.tooltip!==e.tooltip){if(n.tooltip!==void 0&&e.tooltip!==void 0)return n.tooltip<e.tooltip?-1:1;if(n.tooltip!==void 0)return 1;if(e.tooltip!==void 0)return-1}if(n.arguments===e.arguments)return 0;if(n.arguments)if(e.arguments){if(n.arguments.length!==e.arguments.length)return n.arguments.length-e.arguments.length}else return 1;else return-1;for(let t=0;t<n.arguments.length;t++){const r=n.arguments[t],i=e.arguments[t];if(r!==i&&!(RCe(r)&&RCe(i)&&Son(r,i)))return r<i?-1:1}return 0}function OCe(n,e){let t=p4(n.resourceUri.fsPath,e.resourceUri.fsPath,!0);if(t!==0)return t;if(n.command&&e.command)t=won(n.command,e.command);else{if(n.command)return 1;if(e.command)return-1}if(t!==0)return t;if(n.decorations&&e.decorations)t=_on(n.decorations,e.decorations);else{if(n.decorations)return 1;if(e.decorations)return-1}if(n.multiFileDiffEditorModifiedUri&&e.multiFileDiffEditorModifiedUri)t=p4(n.multiFileDiffEditorModifiedUri.fsPath,e.multiFileDiffEditorModifiedUri.fsPath,!0);else{if(n.multiFileDiffEditorModifiedUri)return 1;if(e.multiFileDiffEditorModifiedUri)return-1}if(n.multiDiffEditorOriginalUri&&e.multiDiffEditorOriginalUri)t=p4(n.multiDiffEditorOriginalUri.fsPath,e.multiDiffEditorOriginalUri.fsPath,!0);else{if(n.multiDiffEditorOriginalUri)return 1;if(e.multiDiffEditorOriginalUri)return-1}return t}function Con(n,e){for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}function xon(n,e){return n.command===e.command&&n.title===e.title&&n.tooltip===e.tooltip&&(n.arguments&&e.arguments?Con(n.arguments,e.arguments):n.arguments===e.arguments)}function Eon(n,e){return qL(n,e,xon)}var Rp,$T;class Ion{constructor(e,t,r,i,o){Tn(this,Rp,void 0);Tn(this,$T,void 0);this._extension=e,this._sourceControlHandle=i,this._documentUri=o,this._value="",this._onDidChange=new ft,this._placeholder="",this._enabled=!0,this._visible=!0,gn(this,$T,t),gn(this,Rp,r)}get value(){return this._value}set value(e){e=e??"",Qe(this,Rp).$setInputBoxValue(this._sourceControlHandle,e),this.updateValue(e)}get onDidChange(){return this._onDidChange.event}get placeholder(){return this._placeholder}set placeholder(e){Qe(this,Rp).$setInputBoxPlaceholder(this._sourceControlHandle,e),this._placeholder=e}get validateInput(){return vt(this._extension,"scmValidation"),this._validateInput}set validateInput(e){if(vt(this._extension,"scmValidation"),e&&typeof e!="function")throw new Error(`[${this._extension.identifier.value}]: Invalid SCM input box validation function`);this._validateInput=e,Qe(this,Rp).$setValidationProviderIsEnabled(this._sourceControlHandle,!!e)}get enabled(){return this._enabled}set enabled(e){e=!!e,this._enabled!==e&&(this._enabled=e,Qe(this,Rp).$setInputBoxEnablement(this._sourceControlHandle,e))}get visible(){return this._visible}set visible(e){e=!!e,this._visible!==e&&(this._visible=e,Qe(this,Rp).$setInputBoxVisibility(this._sourceControlHandle,e))}get document(){return vt(this._extension,"scmTextDocument"),Qe(this,$T).getDocument(this._documentUri)}showValidationMessage(e,t){vt(this._extension,"scmValidation"),Qe(this,Rp).$showValidationMessage(this._sourceControlHandle,e,t)}$onInputBoxValueChange(e){this.updateValue(e)}updateValue(e){this._value=e,this._onDidChange.fire(e)}}Rp=new WeakMap,$T=new WeakMap;const NL=class NL{get disposed(){return this._disposed}get id(){return this._id}get label(){return this._label}set label(e){this._label=e,this._proxy.$updateGroupLabel(this._sourceControlHandle,this.handle,e)}get hideWhenEmpty(){return this._hideWhenEmpty}set hideWhenEmpty(e){this._hideWhenEmpty=e,this._proxy.$updateGroup(this._sourceControlHandle,this.handle,this.features)}get features(){return{hideWhenEmpty:this.hideWhenEmpty}}get resourceStates(){return[...this._resourceStates]}set resourceStates(e){this._resourceStates=[...e],this._onDidUpdateResourceStates.fire()}constructor(e,t,r,i,o,s,a){this._proxy=e,this._commands=t,this._sourceControlHandle=r,this._id=i,this._label=o,this.multiDiffEditorEnableViewChanges=s,this._extension=a,this._resourceHandlePool=0,this._resourceStates=[],this._resourceStatesMap=new Map,this._resourceStatesCommandsMap=new Map,this._resourceStatesDisposablesMap=new Map,this._onDidUpdateResourceStates=new ft,this.onDidUpdateResourceStates=this._onDidUpdateResourceStates.event,this._disposed=!1,this._onDidDispose=new ft,this.onDidDispose=this._onDidDispose.event,this._handlesSnapshot=[],this._resourceSnapshot=[],this._hideWhenEmpty=void 0,this.handle=NL._handlePool++}getResourceState(e){return this._resourceStatesMap.get(e)}$executeResourceCommand(e,t){const r=this._resourceStatesCommandsMap.get(e);return r?Lc(()=>this._commands.executeCommand(r.command,...r.arguments||[],t)):Promise.resolve(void 0)}_takeResourceStateSnapshot(){var s;const e=[...this._resourceStates].sort(OCe),r=iZe(this._resourceSnapshot,e,OCe).map(a=>{const c=a.toInsert.map(l=>{const u=this._resourceHandlePool++;this._resourceStatesMap.set(u,l);const d=l.resourceUri;let h;if(l.command)if(l.command.command==="vscode.open"||l.command.command==="vscode.diff"||l.command.command==="vscode.changes"){const D=new ei;h=this._commands.converter.toInternal(l.command,D),this._resourceStatesDisposablesMap.set(u,D)}else this._resourceStatesCommandsMap.set(u,l.command);const f=Oa(this._extension,"scmMultiDiffEditor"),p=f?l.multiDiffEditorOriginalUri:void 0,g=f?l.multiFileDiffEditorModifiedUri:void 0,m=_V(l.decorations),v=l.decorations&&_V(l.decorations.light)||m,b=l.decorations&&_V(l.decorations.dark)||m,S=[v,b],E=l.decorations&&l.decorations.tooltip||"",w=l.decorations&&!!l.decorations.strikeThrough,C=l.decorations&&!!l.decorations.faded,I=l.contextValue||"";return{rawResource:[u,d,S,E,w,C,I,h,p,g],handle:u}});return{start:a.start,deleteCount:a.deleteCount,toInsert:c}}),i=r.map(({start:a,deleteCount:c,toInsert:l})=>[a,c,l.map(u=>u.rawResource)]),o=r.reverse();for(const{start:a,deleteCount:c,toInsert:l}of o){const u=l.map(h=>h.handle),d=this._handlesSnapshot.splice(a,c,...u);for(const h of d)this._resourceStatesMap.delete(h),this._resourceStatesCommandsMap.delete(h),(s=this._resourceStatesDisposablesMap.get(h))==null||s.dispose(),this._resourceStatesDisposablesMap.delete(h)}return this._resourceSnapshot=e,i}dispose(){this._disposed=!0,this._onDidDispose.fire()}};NL._handlePool=0;let FQ=NL;var Ta;const FL=class FL{constructor(e,t,r,i,o,s,a){Tn(this,Ta,void 0);this._extension=e,this._commands=i,this._id=o,this._label=s,this._rootUri=a,this._groups=new Map,this._count=void 0,this._quickDiffProvider=void 0,this._historyProviderDisposable=new zp,this._commitTemplate=void 0,this._acceptInputDisposables=new zp,this._acceptInputCommand=void 0,this._actionButtonDisposables=new zp,this._statusBarDisposables=new zp,this._statusBarCommands=void 0,this._selected=!1,this._onDidChangeSelection=new ft,this.onDidChangeSelection=this._onDidChangeSelection.event,this.handle=FL._handlePool++,this.createdResourceGroups=new Map,this.updatedResourceGroups=new Set,gn(this,Ta,r);const c=Te.from({scheme:hr.vscodeSourceControl,path:`${o}/scm${this.handle}/input`,query:a?`rootUri=${encodeURIComponent(a.toString())}`:void 0});this._inputBox=new Ion(e,t,Qe(this,Ta),this.handle,c),Qe(this,Ta).$registerSourceControl(this.handle,o,s,a,c)}get id(){return this._id}get label(){return this._label}get rootUri(){return this._rootUri}get inputBox(){return this._inputBox}get count(){return this._count}set count(e){this._count!==e&&(this._count=e,Qe(this,Ta).$updateSourceControl(this.handle,{count:e}))}get quickDiffProvider(){return this._quickDiffProvider}set quickDiffProvider(e){this._quickDiffProvider=e;let t;Oa(this._extension,"quickDiffProvider")&&(t=e==null?void 0:e.label),Qe(this,Ta).$updateSourceControl(this.handle,{hasQuickDiffProvider:!!e,quickDiffLabel:t})}get historyProvider(){return vt(this._extension,"scmHistoryProvider"),this._historyProvider}set historyProvider(e){vt(this._extension,"scmHistoryProvider"),this._historyProvider=e,this._historyProviderDisposable.value=new ei,Qe(this,Ta).$updateSourceControl(this.handle,{hasHistoryProvider:!!e}),e&&this._historyProviderDisposable.value.add(e.onDidChangeCurrentHistoryItemGroup(()=>{this._historyProviderCurrentHistoryItemGroup=e==null?void 0:e.currentHistoryItemGroup,Qe(this,Ta).$onDidChangeHistoryProviderCurrentHistoryItemGroup(this.handle,this._historyProviderCurrentHistoryItemGroup)}))}get commitTemplate(){return this._commitTemplate}set commitTemplate(e){e!==this._commitTemplate&&(this._commitTemplate=e,Qe(this,Ta).$updateSourceControl(this.handle,{commitTemplate:e}))}get acceptInputCommand(){return this._acceptInputCommand}set acceptInputCommand(e){this._acceptInputDisposables.value=new ei,this._acceptInputCommand=e;const t=this._commands.converter.toInternal(e,this._acceptInputDisposables.value);Qe(this,Ta).$updateSourceControl(this.handle,{acceptInputCommand:t})}get actionButton(){return vt(this._extension,"scmActionButton"),this._actionButton}set actionButton(e){var r;vt(this._extension,"scmActionButton"),this._actionButtonDisposables.value=new ei,this._actionButton=e;const t=e!==void 0?{command:this._commands.converter.toInternal(e.command,this._actionButtonDisposables.value),secondaryCommands:(r=e.secondaryCommands)==null?void 0:r.map(i=>i.map(o=>this._commands.converter.toInternal(o,this._actionButtonDisposables.value))),description:e.description,enabled:e.enabled}:void 0;Qe(this,Ta).$updateSourceControl(this.handle,{actionButton:t??null})}get statusBarCommands(){return this._statusBarCommands}set statusBarCommands(e){if(this._statusBarCommands&&e&&Eon(this._statusBarCommands,e))return;this._statusBarDisposables.value=new ei,this._statusBarCommands=e;const t=(e||[]).map(r=>this._commands.converter.toInternal(r,this._statusBarDisposables.value));Qe(this,Ta).$updateSourceControl(this.handle,{statusBarCommands:t})}get selected(){return this._selected}createResourceGroup(e,t,r){const i=Oa(this._extension,"scmMultiDiffEditor")&&(r==null?void 0:r.multiDiffEditorEnableViewChanges)===!0,o=new FQ(Qe(this,Ta),this._commands,this.handle,e,t,i,this._extension),s=ns.once(o.onDidDispose)(()=>this.createdResourceGroups.delete(o));return this.createdResourceGroups.set(o,s),this.eventuallyAddResourceGroups(),o}eventuallyAddResourceGroups(){const e=[],t=[];for(const[r,i]of this.createdResourceGroups){i.dispose();const o=r.onDidUpdateResourceStates(()=>{this.updatedResourceGroups.add(r),this.eventuallyUpdateResourceStates()});ns.once(r.onDidDispose)(()=>{this.updatedResourceGroups.delete(r),o.dispose(),this._groups.delete(r.handle),Qe(this,Ta).$unregisterGroup(this.handle,r.handle)}),e.push([r.handle,r.id,r.label,r.features,r.multiDiffEditorEnableViewChanges]);const s=r._takeResourceStateSnapshot();s.length>0&&t.push([r.handle,s]),this._groups.set(r.handle,r)}Qe(this,Ta).$registerGroups(this.handle,e,t),this.createdResourceGroups.clear()}eventuallyUpdateResourceStates(){const e=[];this.updatedResourceGroups.forEach(t=>{const r=t._takeResourceStateSnapshot();r.length!==0&&e.push([t.handle,r])}),e.length>0&&Qe(this,Ta).$spliceResourceStates(this.handle,e),this.updatedResourceGroups.clear()}getResourceGroup(e){return this._groups.get(e)}setSelectionState(e){this._selected=e,this._onDidChangeSelection.fire(e)}dispose(){this._acceptInputDisposables.dispose(),this._actionButtonDisposables.dispose(),this._statusBarDisposables.dispose(),this._groups.forEach(e=>e.dispose()),Qe(this,Ta).$unregisterSourceControl(this.handle)}};Ta=new WeakMap,FL._handlePool=0;let o_=FL;o_.__decorator=An([gEe(100)],o_.prototype,"eventuallyAddResourceGroups",null);o_.__decorator=An([gEe(100)],o_.prototype,"eventuallyUpdateResourceStates",null);var Vx;let jQ=(Vx=class{get onDidChangeActiveProvider(){return this._onDidChangeActiveProvider.event}constructor(e,t,r,i){this._commands=t,this._extHostDocuments=r,this.logService=i,this._sourceControls=new Map,this._sourceControlsByExtension=new jy,this._onDidChangeActiveProvider=new ft,this._proxy=e.getProxy(dn.MainThreadSCM),this._telemetry=e.getProxy(dn.MainThreadTelemetry),t.registerArgumentProcessor({processArgument:o=>{if(o&&o.$mid===3){const s=this._sourceControls.get(o.sourceControlHandle);if(!s)return o;const a=s.getResourceGroup(o.groupHandle);return a?a.getResourceState(o.handle):o}else if(o&&o.$mid===4){const s=this._sourceControls.get(o.sourceControlHandle);return s?s.getResourceGroup(o.groupHandle):o}else if(o&&o.$mid===5){const s=this._sourceControls.get(o.handle);return s||o}return o}})}createSourceControl(e,t,r,i){this.logService.trace("ExtHostSCM#createSourceControl",e.identifier.value,t,r,i),this._telemetry.$publicLog2("api/scm/createSourceControl",{extensionId:e.identifier.value});const o=NQ._handlePool++,s=new o_(e,this._extHostDocuments,this._proxy,this._commands,t,r,i);this._sourceControls.set(o,s);const a=this._sourceControlsByExtension.get(e.identifier)||[];return a.push(s),this._sourceControlsByExtension.set(e.identifier,a),s}getLastInputBox(e){this.logService.trace("ExtHostSCM#getLastInputBox",e.identifier.value);const t=this._sourceControlsByExtension.get(e.identifier),r=t&&t[t.length-1];return r&&r.inputBox}$provideOriginalResource(e,t,r){const i=Te.revive(t);this.logService.trace("ExtHostSCM#$provideOriginalResource",e,i.toString());const o=this._sourceControls.get(e);return!o||!o.quickDiffProvider||!o.quickDiffProvider.provideOriginalResource?Promise.resolve(null):Lc(()=>o.quickDiffProvider.provideOriginalResource(i,r)).then(s=>s||null)}$onInputBoxValueChange(e,t){this.logService.trace("ExtHostSCM#$onInputBoxValueChange",e);const r=this._sourceControls.get(e);return r&&r.inputBox.$onInputBoxValueChange(t),Promise.resolve(void 0)}$executeResourceCommand(e,t,r,i){this.logService.trace("ExtHostSCM#$executeResourceCommand",e,t,r);const o=this._sourceControls.get(e);if(!o)return Promise.resolve(void 0);const s=o.getResourceGroup(t);return s?s.$executeResourceCommand(r,i):Promise.resolve(void 0)}$validateInput(e,t,r){this.logService.trace("ExtHostSCM#$validateInput",e);const i=this._sourceControls.get(e);return!i||!i.inputBox.validateInput?Promise.resolve(void 0):Lc(()=>i.inputBox.validateInput(t,r)).then(o=>{if(!o)return Promise.resolve(void 0);const s=$a.fromStrict(o.message);return s?Promise.resolve([s,o.type]):Promise.resolve(void 0)})}$setSelectedSourceControl(e){var t,r;return this.logService.trace("ExtHostSCM#$setSelectedSourceControl",e),e!==void 0&&((t=this._sourceControls.get(e))==null||t.setSelectionState(!0)),this._selectedSourceControlHandle!==void 0&&((r=this._sourceControls.get(this._selectedSourceControlHandle))==null||r.setSelectionState(!1)),this._selectedSourceControlHandle=e,Promise.resolve(void 0)}async $resolveHistoryItemGroupCommonAncestor(e,t,r,i){var s;const o=(s=this._sourceControls.get(e))==null?void 0:s.historyProvider;return await(o==null?void 0:o.resolveHistoryItemGroupCommonAncestor(t,r,i))??void 0}async $provideHistoryItems(e,t,r,i){var a;const o=(a=this._sourceControls.get(e))==null?void 0:a.historyProvider,s=await(o==null?void 0:o.provideHistoryItems(t,r,i));return(s==null?void 0:s.map(c=>({...c,icon:ACe(c)})))??void 0}async $provideHistoryItemSummary(e,t,r,i){var a;const o=(a=this._sourceControls.get(e))==null?void 0:a.historyProvider;if(typeof(o==null?void 0:o.provideHistoryItemSummary)!="function")return;const s=await o.provideHistoryItemSummary(t,r,i);return s?{...s,icon:ACe(s)}:void 0}async $provideHistoryItemChanges(e,t,r,i){var s;const o=(s=this._sourceControls.get(e))==null?void 0:s.historyProvider;return await(o==null?void 0:o.provideHistoryItemChanges(t,r,i))??void 0}},NQ=Vx,Vx._handlePool=0,Vx);jQ=NQ=An([Be(3,Li)],jQ);const jL=class jL{constructor(e,t){this.uriTransformer=t,this.providers=new Map,this.proxy=e.getProxy(dn.MainThreadShare)}async $provideShare(e,t,r){const i=this.providers.get(e);return await(i==null?void 0:i.provideShare({selection:Rn.to(t.selection),resourceUri:Te.revive(t.resourceUri)},r))??void 0}registerShareProvider(e,t){const r=jL.handlePool++;return this.providers.set(r,t),this.proxy.$registerShareProvider(r,r7.from(e,this.uriTransformer),t.id,t.label,t.priority),{dispose:()=>{this.proxy.$unregisterShareProvider(r),this.providers.delete(r)}}}};jL.handlePool=0;let BQ=jL;const BL=class BL{constructor(e){this.providers=new Map,this.sessions=new Map,this.proxy=e.getProxy(dn.MainThreadSpeech)}async $createSpeechToTextSession(e,t,r){const i=this.providers.get(e);if(!i)return;const o=new ei,s=new Uc;this.sessions.set(t,s);const a=o.add(i.provideSpeechToTextSession(s.token,r?{language:r}:void 0));o.add(a.onDidChange(c=>{s.token.isCancellationRequested||this.proxy.$emitSpeechToTextEvent(t,c)})),o.add(s.token.onCancellationRequested(()=>o.dispose()))}async $cancelSpeechToTextSession(e){var t;(t=this.sessions.get(e))==null||t.dispose(!0),this.sessions.delete(e)}async $createKeywordRecognitionSession(e,t){const r=this.providers.get(e);if(!r)return;const i=new ei,o=new Uc;this.sessions.set(t,o);const s=i.add(r.provideKeywordRecognitionSession(o.token));i.add(s.onDidChange(a=>{o.token.isCancellationRequested||this.proxy.$emitKeywordRecognitionEvent(t,a)})),i.add(o.token.onCancellationRequested(()=>i.dispose()))}async $cancelKeywordRecognitionSession(e){var t;(t=this.sessions.get(e))==null||t.dispose(!0),this.sessions.delete(e)}registerProvider(e,t,r){const i=BL.ID_POOL++;return this.providers.set(i,r),this.proxy.$registerProvider(i,t,{extension:e,displayName:e.value}),ho(()=>{this.proxy.$unregisterProvider(i),this.providers.delete(i)})}};BL.ID_POOL=1;let HQ=BL;const yHe="vs/workbench/api/common/extHostStatusBar";var a2,c2;const m1=class m1{constructor(e,t,r,i,o,s=Uw.Left,a){Tn(this,a2,void 0);Tn(this,c2,void 0);if(this._disposed=!1,this._text="",this._staleCommandRegistrations=new ei,gn(this,a2,e),gn(this,c2,t),o&&i){this._entryId=mJe(i.identifier,o);const c=r.get(this._entryId);c&&(s=c.alignLeft?Uw.Left:Uw.Right,a=c.priority,this._visible=!0,this.name=c.name,this.text=c.text,this.tooltip=c.tooltip,this.command=c.command,this.accessibilityInformation=c.accessibilityInformation)}else this._entryId=String(m1.ID_GEN++);this._extension=i,this._id=o,this._alignment=s,this._priority=this.validatePriority(a)}validatePriority(e){if(oZe(e))return e===Number.POSITIVE_INFINITY?Number.MAX_VALUE:e===Number.NEGATIVE_INFINITY?-Number.MAX_VALUE:e}get id(){return this._id??this._extension.identifier.value}get alignment(){return this._alignment}get priority(){return this._priority}get text(){return this._text}get name(){return this._name}get tooltip(){return this._tooltip}get color(){return this._color}get backgroundColor(){return this._backgroundColor}get command(){var e;return(e=this._command)==null?void 0:e.fromApi}get accessibilityInformation(){return this._accessibilityInformation}set text(e){this._text=e,this.update()}set name(e){this._name=e,this.update()}set tooltip(e){this._tooltip=e,this.update()}set color(e){this._color=e,this.update()}set backgroundColor(e){e&&!m1.ALLOWED_BACKGROUND_COLORS.has(e.id)&&(e=void 0),this._backgroundColor=e,this.update()}set command(e){var t;((t=this._command)==null?void 0:t.fromApi)!==e&&(this._latestCommandRegistration&&this._staleCommandRegistrations.add(this._latestCommandRegistration),this._latestCommandRegistration=new ei,typeof e=="string"?this._command={fromApi:e,internal:Qe(this,c2).toInternal({title:"",command:e},this._latestCommandRegistration)}:e?this._command={fromApi:e,internal:Qe(this,c2).toInternal(e,this._latestCommandRegistration)}:this._command=void 0,this.update())}set accessibilityInformation(e){this._accessibilityInformation=e,this.update()}show(){this._visible=!0,this.update()}hide(){clearTimeout(this._timeoutHandle),this._visible=!1,Qe(this,a2).$disposeEntry(this._entryId)}update(){this._disposed||!this._visible||(clearTimeout(this._timeoutHandle),this._timeoutHandle=setTimeout(()=>{var o,s;this._timeoutHandle=void 0;let e;this._extension?this._id?e=`${this._extension.identifier.value}.${this._id}`:e=this._extension.identifier.value:e=this._id;let t;this._name?t=this._name:t=Ve(yHe,0,"{0} (Extension)",this._extension.displayName||this._extension.name);let r=this._color;this._backgroundColor&&(r=m1.ALLOWED_BACKGROUND_COLORS.get(this._backgroundColor.id));const i=$a.fromStrict(this._tooltip);Qe(this,a2).$setEntry(this._entryId,e,(o=this._extension)==null?void 0:o.identifier.value,t,this._text,i,(s=this._command)==null?void 0:s.internal,r,this._backgroundColor,this._alignment===Uw.Left,this._priority,this._accessibilityInformation),this._staleCommandRegistrations.clear()},0))}dispose(){this.hide(),this._disposed=!0}};a2=new WeakMap,c2=new WeakMap,m1.ID_GEN=0,m1.ALLOWED_BACKGROUND_COLORS=new Map([["statusBarItem.errorBackground",new qW("statusBarItem.errorForeground")],["statusBarItem.warningBackground",new qW("statusBarItem.warningForeground")]]);let UQ=m1;class Pon{constructor(e){this._messages=[],this._item=e.createStatusBarEntry(void 0,"status.extensionMessage",Uw.Left,Number.MIN_VALUE),this._item.name=Ve(yHe,1,"Extension Status")}dispose(){this._messages.length=0,this._item.dispose()}setMessage(e){const t={message:e};return this._messages.unshift(t),this._update(),new pi(()=>{const r=this._messages.indexOf(t);r>=0&&(this._messages.splice(r,1),this._update())})}_update(){this._messages.length>0?(this._item.text=this._messages[0].message,this._item.show()):this._item.hide()}}class kon{constructor(e,t){this._existingItems=new Map,this._proxy=e.getProxy(dn.MainThreadStatusBar),this._commands=t,this._statusMessage=new Pon(this)}$acceptStaticEntries(e){for(const t of e)this._existingItems.set(t.entryId,t)}createStatusBarEntry(e,t,r,i){return new UQ(this._proxy,this._commands,this._existingItems,e,t,r,i)}setStatusBarMessage(e,t){const r=this._statusMessage.setMessage(e);let i;return typeof t=="number"?i=setTimeout(()=>r.dispose(),t):typeof t<"u"&&t.then(()=>r.dispose(),()=>r.dispose()),new pi(()=>{r.dispose(),clearTimeout(i)})}}let zQ=class extends Dr{constructor(e,t,r,i){super(),this.editors=i,this.resultsChangedEmitter=this._register(new ft),this.controllers=new Map,this.defaultProfilesChangedEmitter=this._register(new ft),this.onResultsChanged=this.resultsChangedEmitter.event,this.results=[],this.proxy=e.getProxy(dn.MainThreadTesting),this.observer=new Mon(this.proxy),this.runTracker=new Ron(this.proxy,t),r.registerArgumentProcessor({processArgument:o=>{var s,a,c;switch(o==null?void 0:o.$mid){case 16:{const l=o,u=l.tests[l.tests.length-1].item.extId,d=this.controllers.get(Mo.root(u));return((s=d==null?void 0:d.collection.tree.get(u))==null?void 0:s.actual)??Jwe(o)}case 18:{const{test:l,message:u}=o,d=l.item.extId;return{test:((c=(a=this.controllers.get(Mo.root(d)))==null?void 0:a.collection.tree.get(d))==null?void 0:c.actual)??Jwe({$mid:16,tests:[l]}),message:KW.to(u)}}default:return o}}}),r.registerCommand(!1,"testing.getExplorerSelection",async()=>{const o=await r.executeCommand("_testing.getExplorerSelection"),s=a=>{var l;const c=this.controllers.get(Mo.root(a));if(c)return Mo.isRoot(a)?c.controller:(l=c.collection.tree.get(a))==null?void 0:l.actual};return{include:(o==null?void 0:o.include.map(s).filter(XI))||[],exclude:(o==null?void 0:o.exclude.map(s).filter(XI))||[]}})}createTestController(e,t,r,i){if(this.controllers.has(t))throw new Error(`Attempt to insert a duplicate controller with ID "${t}"`);const o=new ei,s=o.add(new Hrn(t,r,this.editors));s.root.label=r;const a=new Map,c=new Set,l=this.proxy,u={items:s.root.children,get label(){return r},set label(h){r=h,s.root.label=h,l.$updateController(t,{label:r})},get refreshHandler(){return i},set refreshHandler(h){i=h,l.$updateController(t,{canRefresh:!!h})},get id(){return t},createRunProfile:(h,f,p,g,m,v)=>{let b=YL(h);for(;a.has(b);)b++;return new SHe(this.proxy,a,c,this.defaultProfilesChangedEmitter.event,t,b,h,f,p,g,m,v)},createTestItem(h,f,p){return new __(t,h,f,p)},createTestRun:(h,f,p=!0)=>this.runTracker.createTestRun(t,s,h,f,p),invalidateTestResults:h=>{if(h===void 0)this.proxy.$markTestRetired(void 0);else{const f=h instanceof Array?h:[h];this.proxy.$markTestRetired(f.map(p=>Mo.fromExtHostTestItem(p,t).toString()))}},set resolveHandler(h){s.resolveHandler=h},get resolveHandler(){return s.resolveHandler},dispose:()=>{o.dispose()}};l.$registerTestController(t,r,!!i),o.add(ho(()=>l.$unregisterTestController(t)));const d={controller:u,collection:s,profiles:a,extension:e,activeProfiles:c};return this.controllers.set(t,d),o.add(ho(()=>this.controllers.delete(t))),o.add(s.onDidGenerateDiff(h=>l.$publishDiff(t,h.map(Sle.serialize)))),u}createTestObserver(){return this.observer.checkout()}async runTests(e,t=Xl.None){var o,s;const r=bHe(e);if(!r)throw new Error("The request passed to `vscode.test.runTests` must include a profile");const i=this.controllers.get(r.controllerId);if(!i)throw new Error("Controller not found");await this.proxy.$runTests({preserveFocus:e.preserveFocus??!0,targets:[{testIds:((o=e.include)==null?void 0:o.map(a=>Mo.fromExtHostTestItem(a,i.collection.root.id).toString()))??[i.collection.root.id],profileGroup:Ose[r.kind],profileId:r.profileId,controllerId:r.controllerId}],exclude:(s=e.exclude)==null?void 0:s.map(a=>a.id)},t)}$syncTests(){for(const{collection:e}of this.controllers.values())e.flushDiff();return Promise.resolve()}async $getCoverageDetails(e,t){const r=await this.runTracker.getCoverageDetails(e,t);return r==null?void 0:r.map(mEe.fromDetails)}async $disposeRun(e){this.runTracker.disposeTestRun(e)}$configureRunProfile(e,t){var r,i,o;(o=(i=(r=this.controllers.get(e))==null?void 0:r.profiles.get(t))==null?void 0:i.configureHandler)==null||o.call(i)}$setDefaultRunProfiles(e){const t=new Map;for(const[r,i]of Object.entries(e)){const o=this.controllers.get(r);if(!o)continue;const s=new Map,a=i.filter(l=>!o.activeProfiles.has(l)),c=[...o.activeProfiles].filter(l=>!i.includes(l));for(const l of a)s.set(l,!0),o.activeProfiles.add(l);for(const l of c)s.set(l,!1),o.activeProfiles.delete(l);s.size&&t.set(r,s)}this.defaultProfilesChangedEmitter.fire(t)}async $refreshTests(e,t){var r,i,o;await((o=(r=this.controllers.get(e))==null?void 0:(i=r.controller).refreshHandler)==null?void 0:o.call(i,t))}$publishTestResults(e){this.results=Object.freeze(e.map(vJe.to).concat(this.results).sort((t,r)=>r.completedAt-t.completedAt).slice(0,32)),this.resultsChangedEmitter.fire()}async $expandTest(e,t){var i;const r=(i=this.controllers.get(Mo.fromString(e).controllerId))==null?void 0:i.collection;r&&(await r.expand(e,t<0?1/0:t),r.flushDiff())}$acceptDiff(e){this.observer.applyDiff(e.map(t=>Sle.deserialize({asCanonicalUri:r=>r},t)))}async $runControllerTests(e,t){return Promise.all(e.map(r=>this.runControllerTestRequest(r,!1,t)))}async $startContinuousRun(e,t){const r=new Uc(t),i=await Promise.all(e.map(o=>this.runControllerTestRequest(o,!0,r.token)));return!t.isCancellationRequested&&!i.some(o=>o.error)&&await new Promise(o=>t.onCancellationRequested(o)),r.dispose(!0),i}async runControllerTestRequest(e,t,r){const i=this.controllers.get(e.controllerId);if(!i)return{};const{collection:o,profiles:s}=i,a=s.get(e.profileId);if(!a)return{};const c=e.testIds.map(h=>o.tree.get(h)).filter(XI),l=e.excludeExtIds.map(h=>i.collection.tree.get(h)).filter(XI).filter(h=>c.some(f=>f.fullId.compare(h.fullId)===2));if(!c.length)return{};const u=new GW(c.some(h=>h.actual instanceof Cse)?void 0:c.map(h=>h.actual),l.map(h=>h.actual),a,t),d=yJe(e)&&this.runTracker.prepareForMainThreadTestRun(u,wT.fromInternal(e,i.collection),a,r);try{return await a.runHandler(u,r),{}}catch(h){return{error:String(h)}}finally{d&&d.hasRunningTasks&&!r.isCancellationRequested&&await ns.toPromise(d.onEnd)}}$cancelExtensionTestRun(e){e===void 0?this.runTracker.cancelAllRuns():this.runTracker.cancelRunById(e)}};zQ=An([Be(0,Ii),Be(1,Li)],zQ);const Ton=1e4;class Don extends Dr{get hasRunningTasks(){return this.running>0}get id(){return this.dto.id}constructor(e,t,r,i,o){super(),this.dto=e,this.proxy=t,this.logService=r,this.profile=i,this.state=0,this.running=0,this.tasks=new Map,this.sharedTestIds=new Set,this.endEmitter=this._register(new ft),this.publishedCoverage=new Map,this.onEnd=this.endEmitter.event,this.cts=this._register(new Uc(o));const s=this._register(new Zx(()=>this.forciblyEndTasks(),Ton));this._register(this.cts.token.onCancellationRequested(()=>s.schedule()));const a=new ft;this.onDidDispose=a.event,this._register(ho(()=>{a.fire(),a.dispose()}))}cancel(){this.state===0?(this.cts.cancel(),this.state=1):this.state===1&&this.forciblyEndTasks()}getCoverageDetails(e,t){var a,c;const[,r,i]=Mo.fromString(e).path,o=this.publishedCoverage.get(i);if(!o)return[];const s=this.tasks.get(r);if(!s)throw new Error("unreachable: run task was not found");return((c=(a=this.profile)==null?void 0:a.loadDetailedCoverage)==null?void 0:c.call(a,s.run,o,t))??[]}createRun(e){const t=this.dto.id,r=this.dto.controllerId,i=Yx(),o=l=>(u,...d)=>{if(a){this.logService.warn(`Setting the state of test "${u.id}" is a no-op after the run ends.`);return}this.dto.isIncluded(u)&&(this.ensureTestIsKnown(u),l(u,...d))},s=(l,u)=>{const d=u instanceof Array?u.map(KW.from):[KW.from(u)];if(l.uri&&l.range){const h={range:Rn.from(l.range),uri:l.uri};for(const f of d)f.location=f.location||h}this.proxy.$appendTestMessagesInRun(t,i,Mo.fromExtHostTestItem(l,r).toString(),d)};let a=!1;const c={isPersisted:this.dto.isPersisted,token:this.cts.token,name:e,onDidDispose:this.onDidDispose,addCoverage:l=>{const u=l.uri.toString(),d=new Mo([t,i,u]).toString();this.publishedCoverage.set(u,l),this.proxy.$appendCoverage(t,i,mEe.fromFile(d,l))},enqueued:o(l=>{this.proxy.$updateTestStateInRun(t,i,Mo.fromExtHostTestItem(l,r).toString(),1)}),skipped:o(l=>{this.proxy.$updateTestStateInRun(t,i,Mo.fromExtHostTestItem(l,r).toString(),5)}),started:o(l=>{this.proxy.$updateTestStateInRun(t,i,Mo.fromExtHostTestItem(l,r).toString(),2)}),errored:o((l,u,d)=>{s(l,u),this.proxy.$updateTestStateInRun(t,i,Mo.fromExtHostTestItem(l,r).toString(),6,d)}),failed:o((l,u,d)=>{s(l,u),this.proxy.$updateTestStateInRun(t,i,Mo.fromExtHostTestItem(l,r).toString(),4,d)}),passed:o((l,u)=>{this.proxy.$updateTestStateInRun(t,i,Mo.fromExtHostTestItem(l,this.dto.controllerId).toString(),3,u)}),appendOutput:(l,u,d)=>{a||(d&&(this.dto.isIncluded(d)?this.ensureTestIsKnown(d):d=void 0),this.proxy.$appendOutputToRun(t,i,ac.fromString(l),u&&CS.from(u),d&&Mo.fromExtHostTestItem(d,r).toString()))},end:()=>{a||(a=!0,this.proxy.$finishedTestRunTask(t,i),--this.running||this.markEnded())}};return this.running++,this.tasks.set(i,{run:c}),this.proxy.$startedTestRunTask(t,{id:i,name:e,running:!0}),c}forciblyEndTasks(){for(const{run:e}of this.tasks.values())e.end()}markEnded(){this.state!==2&&(this.state=2,this.endEmitter.fire())}ensureTestIsKnown(e){if(!(e instanceof __))throw new bJe(e.id);if(this.sharedTestIds.has(Mo.fromExtHostTestItem(e,this.dto.controllerId).toString()))return;const t=[],r=this.dto.colllection.root;for(;;){const i=qT.from(e);if(t.unshift(i),this.sharedTestIds.has(i.extId)||(this.sharedTestIds.add(i.extId),e===r))break;e=e.parent||r}this.proxy.$addTestsToRun(this.dto.controllerId,this.dto.id,t)}dispose(){this.markEnded(),super.dispose()}}class Ron{get trackers(){return this.tracked.values()}constructor(e,t){this.proxy=e,this.logService=t,this.tracked=new Map,this.trackedById=new Map}getCoverageDetails(e,t){var i;const r=Mo.root(e);return((i=this.trackedById.get(r))==null?void 0:i.getCoverageDetails(e,t))||[]}disposeTestRun(e){var t;(t=this.trackedById.get(e))==null||t.dispose(),this.trackedById.delete(e);for(const[r,{id:i}]of this.tracked)i===e&&this.tracked.delete(r)}prepareForMainThreadTestRun(e,t,r,i){return this.getTracker(e,t,r,i)}cancelRunById(e){var t;(t=this.trackedById.get(e))==null||t.cancel()}cancelAllRuns(){for(const e of this.tracked.values())e.cancel()}createTestRun(e,t,r,i,o){var u,d;const s=this.tracked.get(r);if(s)return s.createRun(i);const a=wT.fromPublic(e,t,r,o),c=bHe(r);this.proxy.$startedExtensionTestRun({controllerId:e,continuous:!!r.continuous,profile:c&&{group:Ose[c.kind],id:c.profileId},exclude:((u=r.exclude)==null?void 0:u.map(h=>Mo.fromExtHostTestItem(h,t.root.id).toString()))??[],id:a.id,include:((d=r.include)==null?void 0:d.map(h=>Mo.fromExtHostTestItem(h,t.root.id).toString()))??[t.root.id],preserveFocus:r.preserveFocus??!0,persist:o});const l=this.getTracker(r,a,r.profile);return ns.once(l.onEnd)(()=>{this.proxy.$finishedExtensionTestRun(a.id)}),l.createRun(i)}getTracker(e,t,r,i){const o=new Don(t,this.proxy,this.logService,r,i);return this.tracked.set(e,o),this.trackedById.set(o.id,o),o}}const bHe=n=>{if(n.profile){if(!(n.profile instanceof SHe))throw new Error("TestRunRequest.profile is not an instance created from TestController.createRunProfile");return n.profile}};class wT{static fromPublic(e,t,r,i){var o,s;return new wT(e,Yx(),((o=r.include)==null?void 0:o.map(a=>Mo.fromExtHostTestItem(a,e).toString()))??[e],((s=r.exclude)==null?void 0:s.map(a=>Mo.fromExtHostTestItem(a,e).toString()))??[],i,t)}static fromInternal(e,t){return new wT(e.controllerId,e.runId,e.testIds,e.excludeExtIds,!0,t)}constructor(e,t,r,i,o,s){this.controllerId=e,this.id=t,this.isPersisted=o,this.colllection=s,this.includePrefix=r.map(a=>a+"\0"),this.excludePrefix=i.map(a=>a+"\0")}isIncluded(e){const t=Mo.fromExtHostTestItem(e,this.controllerId).toString()+"\0";for(const r of this.excludePrefix)if(t===r||t.startsWith(r))return!1;for(const r of this.includePrefix)if(t===r||t.startsWith(r))return!0;return!1}}class Aon{get isEmpty(){return this.added.size===0&&this.removed.size===0&&this.updated.size===0}constructor(e){this.emitter=e,this.added=new Set,this.updated=new Set,this.removed=new Set,this.alreadyRemoved=new Set}add(e){this.added.add(e)}update(e){Object.assign(e.revived,qT.toPlain(e.item)),this.added.has(e)||this.updated.add(e)}remove(e){if(this.added.has(e)){this.added.delete(e);return}this.updated.delete(e);const t=Mo.parentId(e.item.extId);if(t&&this.alreadyRemoved.has(t.toString())){this.alreadyRemoved.add(e.item.extId);return}this.removed.add(e)}getChangeEvent(){const{added:e,updated:t,removed:r}=this;return{get added(){return[...e].map(i=>i.revived)},get updated(){return[...t].map(i=>i.revived)},get removed(){return[...r].map(i=>i.revived)}}}complete(){this.isEmpty||this.emitter.fire(this.getChangeEvent())}}class Oon extends SJe{constructor(){super(...arguments),this.changeEmitter=new ft,this.onDidChangeTests=this.changeEmitter.event}get rootTests(){return this.roots}getMirroredTestDataById(e){return this.items.get(e)}getMirroredTestDataByReference(e){return this.items.get(e.id)}createItem(e,t){return{...e,revived:qT.toPlain(e.item),depth:t?t.depth+1:0,children:new Set}}createChangeCollector(){return new Aon(this.changeEmitter)}}class Mon{constructor(e){this.proxy=e}checkout(){this.current||(this.current=this.createObserverData());const e=this.current;return e.observers++,{onDidChangeTest:e.tests.onDidChangeTests,get tests(){return[...e.tests.rootTests].map(t=>t.revived)},dispose:sZe(()=>{--e.observers===0&&(this.proxy.$unsubscribeFromDiffs(),this.current=void 0)})}}getMirroredTestDataByReference(e){var t;return(t=this.current)==null?void 0:t.tests.getMirroredTestDataByReference(e)}applyDiff(e){var t;(t=this.current)==null||t.tests.apply(e)}createObserverData(){const e=new Oon({asCanonicalUri:t=>t});return this.proxy.$subscribeToDiffs(),{observers:0,tests:e}}}const GI=(n,e,t,r)=>{t?Object.assign(t,r):e.$updateTestRunConfig(n.controllerId,n.profileId,r)};var bf,K1,LT,yd,l2;class SHe{constructor(e,t,r,i,o,s,a,c,l,u=!1,d=void 0,h=!1){Tn(this,bf,void 0);Tn(this,K1,void 0);Tn(this,LT,void 0);Tn(this,yd,void 0);Tn(this,l2,void 0);this.controllerId=o,this.profileId=s,this._label=a,this.kind=c,this.runHandler=l,this._tag=d,this._supportsContinuousRun=h,gn(this,bf,e),gn(this,l2,t),gn(this,K1,r),gn(this,LT,i),t.set(s,this);const f=Ose[c];if(typeof f!="number")throw new Error(`Unknown TestRunProfile.group ${c}`);u&&r.add(s),gn(this,yd,{profileId:s,controllerId:o,tag:d?Ak.namespace(this.controllerId,d.id):null,label:a,group:f,isDefault:u,hasConfigurationHandler:!1,supportsContinuousRun:h}),queueMicrotask(()=>{Qe(this,yd)&&(Qe(this,bf).$publishTestRunProfile(Qe(this,yd)),gn(this,yd,void 0))})}get label(){return this._label}set label(e){e!==this._label&&(this._label=e,GI(this,Qe(this,bf),Qe(this,yd),{label:e}))}get supportsContinuousRun(){return this._supportsContinuousRun}set supportsContinuousRun(e){e!==this._supportsContinuousRun&&(this._supportsContinuousRun=e,GI(this,Qe(this,bf),Qe(this,yd),{supportsContinuousRun:e}))}get isDefault(){return Qe(this,K1).has(this.profileId)}set isDefault(e){e!==this.isDefault&&(e?Qe(this,K1).add(this.profileId):Qe(this,K1).delete(this.profileId),GI(this,Qe(this,bf),Qe(this,yd),{isDefault:e}))}get tag(){return this._tag}set tag(e){var t;(e==null?void 0:e.id)!==((t=this._tag)==null?void 0:t.id)&&(this._tag=e,GI(this,Qe(this,bf),Qe(this,yd),{tag:e?Ak.namespace(this.controllerId,e.id):null}))}get configureHandler(){return this._configureHandler}set configureHandler(e){e!==this._configureHandler&&(this._configureHandler=e,GI(this,Qe(this,bf),Qe(this,yd),{hasConfigurationHandler:!!e}))}get onDidChangeDefault(){return ns.chain(Qe(this,LT),e=>e.map(t=>{var r;return(r=t.get(this.controllerId))==null?void 0:r.get(this.profileId)}).filter(XI))}dispose(){var e;(e=Qe(this,l2))!=null&&e.delete(this.profileId)&&(gn(this,l2,void 0),Qe(this,bf).$removeTestProfile(this.controllerId,this.profileId)),gn(this,yd,void 0)}}bf=new WeakMap,K1=new WeakMap,LT=new WeakMap,yd=new WeakMap,l2=new WeakMap;const Ose={[g4.Coverage]:8,[g4.Debug]:4,[g4.Run]:2};class $on{constructor(e,t){this._extHostDocumentsAndEditors=t,this._onDidChangeTextEditorSelection=new ft,this._onDidChangeTextEditorOptions=new ft,this._onDidChangeTextEditorVisibleRanges=new ft,this._onDidChangeTextEditorViewColumn=new ft,this._onDidChangeActiveTextEditor=new ft,this._onDidChangeVisibleTextEditors=new ft,this.onDidChangeTextEditorSelection=this._onDidChangeTextEditorSelection.event,this.onDidChangeTextEditorOptions=this._onDidChangeTextEditorOptions.event,this.onDidChangeTextEditorVisibleRanges=this._onDidChangeTextEditorVisibleRanges.event,this.onDidChangeTextEditorViewColumn=this._onDidChangeTextEditorViewColumn.event,this.onDidChangeActiveTextEditor=this._onDidChangeActiveTextEditor.event,this.onDidChangeVisibleTextEditors=this._onDidChangeVisibleTextEditors.event,this._proxy=e.getProxy(dn.MainThreadTextEditors),this._extHostDocumentsAndEditors.onDidChangeVisibleTextEditors(r=>this._onDidChangeVisibleTextEditors.fire(r)),this._extHostDocumentsAndEditors.onDidChangeActiveTextEditor(r=>this._onDidChangeActiveTextEditor.fire(r))}getActiveTextEditor(){return this._extHostDocumentsAndEditors.activeEditor()}getVisibleTextEditors(e){const t=this._extHostDocumentsAndEditors.allEditors();return e?t:t.map(r=>r.value)}async showTextDocument(e,t,r){let i;typeof t=="number"?i={position:Ma.from(t),preserveFocus:r}:typeof t=="object"?i={position:Ma.from(t.viewColumn),preserveFocus:t.preserveFocus,selection:typeof t.selection=="object"?Rn.from(t.selection):void 0,pinned:typeof t.preview=="boolean"?!t.preview:void 0}:i={preserveFocus:!1};const o=await this._proxy.$tryShowTextDocument(e.uri,i),s=o&&this._extHostDocumentsAndEditors.getEditor(o);if(s)return s.value;throw o?new Error(`Could NOT open editor for "${e.uri.toString()}" because another editor opened in the meantime.`):new Error(`Could NOT open editor for "${e.uri.toString()}".`)}createTextEditorDecorationType(e,t){return new jJ(this._proxy,e,t).value}$acceptEditorPropertiesChanged(e,t){const r=this._extHostDocumentsAndEditors.getEditor(e);if(!r)throw new Error("unknown text editor");if(t.options&&r._acceptOptions(t.options),t.selections){const i=t.selections.selections.map(eg.to);r._acceptSelections(i)}if(t.visibleRanges){const i=Qp(t.visibleRanges.map(Rn.to));r._acceptVisibleRanges(i)}if(t.options&&this._onDidChangeTextEditorOptions.fire({textEditor:r.value,options:{...t.options,lineNumbers:s4.to(t.options.lineNumbers)}}),t.selections){const i=vEe.fromValue(t.selections.source),o=t.selections.selections.map(eg.to);this._onDidChangeTextEditorSelection.fire({textEditor:r.value,selections:o,kind:i})}if(t.visibleRanges){const i=Qp(t.visibleRanges.map(Rn.to));this._onDidChangeTextEditorVisibleRanges.fire({textEditor:r.value,visibleRanges:i})}}$acceptEditorPositionData(e){for(const t in e){const r=this._extHostDocumentsAndEditors.getEditor(t);if(!r)throw new Error("Unknown text editor");const i=Ma.to(e[t]);r.value.viewColumn!==i&&(r._acceptViewColumn(i),this._onDidChangeTextEditorViewColumn.fire({textEditor:r.value,viewColumn:i}))}}getDiffInformation(e){return Promise.resolve(this._proxy.$getDiffInformation(e))}}let VQ=class{constructor(e){this._actual=new _le(Dw.Dark),this._onDidChangeActiveColorTheme=new ft}get activeColorTheme(){return this._actual}$onColorThemeChange(e){let t;switch(e){case"light":t=Dw.Light;break;case"hcDark":t=Dw.HighContrast;break;case"hcLight":t=Dw.HighContrastLight;break;default:t=Dw.Dark}this._actual=new _le(t),this._onDidChangeActiveColorTheme.fire(this._actual)}get onDidChangeActiveColorTheme(){return this._onDidChangeActiveColorTheme.event}};VQ=An([Be(0,Ii)],VQ);class Lon{constructor(e,t){this._providers=new Map,this._itemsBySourceAndUriMap=new Map,this._proxy=e.getProxy(dn.MainThreadTimeline),t.registerArgumentProcessor({processArgument:(r,i)=>{var o,s,a;if(r&&r.$mid===12)if(this._providers.get(r.source)&&jc.equals(i,(o=this._providers.get(r.source))==null?void 0:o.extension)){const c=r.uri===void 0?void 0:Te.revive(r.uri);return(a=(s=this._itemsBySourceAndUriMap.get(r.source))==null?void 0:s.get(MCe(c)))==null?void 0:a.get(r.handle)}else return;return r}})}async $getTimeline(e,t,r,i){const o=this._providers.get(e);return o==null?void 0:o.provider.provideTimeline(Te.revive(t),r,i)}registerTimelineProvider(e,t,r,i){const o=new ei,s=this.convertTimelineItem(t.id,i,o).bind(this);let a;t.onDidChange&&(a=t.onDidChange(l=>this._proxy.$emitTimelineChangeEvent({uri:void 0,reset:!0,...l,id:t.id}),this));const c=this._itemsBySourceAndUriMap;return this.registerTimelineProviderCore({...t,scheme:e,onDidChange:void 0,async provideTimeline(l,u,d){var p;u!=null&&u.resetCache&&(o.clear(),(p=c.get(t.id))==null||p.clear());const h=await t.provideTimeline(l,u,d);if(h==null)return;const f=s(l,u);return{...h,source:t.id,items:h.items.map(f)}},dispose(){var l;for(const u of c.values())(l=u.get(t.id))==null||l.clear();a==null||a.dispose(),o.dispose()}},r)}convertTimelineItem(e,t,r){return(i,o)=>{let s;if(o!=null&&o.cacheResults){let a=this._itemsBySourceAndUriMap.get(e);a===void 0&&(a=new Map,this._itemsBySourceAndUriMap.set(e,a));const c=MCe(i);s=a.get(c),s===void 0&&(s=new Map,a.set(c,s))}return a=>{const{iconPath:c,...l}=a,u=`${e}|${a.id??a.timestamp}`;s==null||s.set(u,a);let d,h,f;a.iconPath&&(c instanceof Q0?f={id:c.id,color:c.color}:Te.isUri(c)?(d=c,h=c):{light:d,dark:h}=c);let p;return T2.isMarkdownString(l.tooltip)?p=$a.from(l.tooltip):Hm(l.tooltip)?p=l.tooltip:T2.isMarkdownString(l.detail)?(console.warn("Using deprecated TimelineItem.detail, migrate to TimelineItem.tooltip"),p=$a.from(l.detail)):Hm(l.detail)&&(console.warn("Using deprecated TimelineItem.detail, migrate to TimelineItem.tooltip"),p=l.detail),{...l,id:l.id??void 0,handle:u,source:e,command:a.command?t.toInternal(a.command,r):void 0,icon:d,iconDark:h,themeIcon:f,tooltip:p,accessibilityInformation:a.accessibilityInformation}}}}registerTimelineProviderCore(e,t){if(this._providers.get(e.id))throw new Error(`Timeline Provider ${e.id} already exists.`);return this._proxy.$registerTimelineProvider({id:e.id,label:e.label,scheme:e.scheme}),this._providers.set(e.id,{provider:e,extension:t}),ho(()=>{var i;for(const o of this._itemsBySourceAndUriMap.values())(i=o.get(e.id))==null||i.clear();this._providers.delete(e.id),this._proxy.$unregisterTimelineProvider(e.id),e.dispose()})}}function MCe(n){return n==null?void 0:n.toString()}const Non="vs/workbench/api/common/extHostTreeViews";function $Ce(n,e){if(Hm(n))return{label:n};if(n&&typeof n=="object"&&typeof n.label=="string"){let t;return Array.isArray(n.highlights)&&(t=n.highlights.filter(r=>r.length===2&&typeof r[0]=="number"&&typeof r[1]=="number"),t=t.length?t:void 0),{label:n.label,highlights:t}}}class Fon extends Dr{constructor(e,t,r){super(),this._proxy=e,this.commands=t,this.logService=r,this.treeViews=new Map,this.treeDragAndDropService=new _Je;function i(o){return o&&o.$treeViewId&&(o.$treeItemHandle||o.$selectedTreeItems||o.$focusedTreeItem)}t.registerArgumentProcessor({processArgument:o=>i(o)?this.convertArgument(o):Array.isArray(o)&&o.length>0?o.map(s=>i(s)?this.convertArgument(s):s):o})}registerTreeDataProvider(e,t,r){const i=this.createTreeView(e,{treeDataProvider:t},r);return{dispose:()=>i.dispose()}}createTreeView(e,t,r){var h,f,p,g;if(!t||!t.treeDataProvider)throw new Error("Options with treeDataProvider is mandatory");const i=((h=t.dragAndDropController)==null?void 0:h.dropMimeTypes)??[],o=((f=t.dragAndDropController)==null?void 0:f.dragMimeTypes)??[],s=!!((p=t.dragAndDropController)!=null&&p.handleDrag),a=!!((g=t.dragAndDropController)!=null&&g.handleDrop),c=this.createExtHostTreeView(e,t,r),l={showCollapseAll:!!t.showCollapseAll,canSelectMany:!!t.canSelectMany,dropMimeTypes:i,dragMimeTypes:o,hasHandleDrag:s,hasHandleDrop:a,manuallyManageCheckboxes:!!t.manageCheckboxStateManually},u=this._proxy.$registerTreeViewDataProvider(e,l),d={get onDidCollapseElement(){return c.onDidCollapseElement},get onDidExpandElement(){return c.onDidExpandElement},get selection(){return c.selectedElements},get onDidChangeSelection(){return c.onDidChangeSelection},get activeItem(){return vt(r,"treeViewActiveItem"),c.focusedElement},get onDidChangeActiveItem(){return vt(r,"treeViewActiveItem"),c.onDidChangeActiveItem},get visible(){return c.visible},get onDidChangeVisibility(){return c.onDidChangeVisibility},get onDidChangeCheckboxState(){return c.onDidChangeCheckboxState},get message(){return c.message},set message(m){rEe(m)&&vt(r,"treeViewMarkdownMessage"),c.message=m},get title(){return c.title},set title(m){c.title=m},get description(){return c.description},set description(m){c.description=m},get badge(){return c.badge},set badge(m){m!==void 0&&wJe.isViewBadge(m)?c.badge={value:Math.floor(Math.abs(m.value)),tooltip:m.tooltip}:m===void 0&&(c.badge=void 0)},reveal:(m,v)=>c.reveal(m,v),dispose:async()=>{await u,this.treeViews.delete(e),c.dispose()}};return this._register(d),d}$getChildren(e,t){const r=this.treeViews.get(e);return r?r.getChildren(t):Promise.reject(new Qg(e))}async $handleDrop(e,t,r,i,o,s,a,c){const l=this.treeViews.get(e);if(!l)return Promise.reject(new Qg(e));const u=IC.toDataTransfer(r,async d=>(await this._proxy.$resolveDropFileData(e,t,d)).buffer);return a===e&&c&&await this.addAdditionalTransferItems(u,l,c,o,s),l.onDrop(u,i,o)}async addAdditionalTransferItems(e,t,r,i,o){var a;const s=this.treeDragAndDropService.removeDragOperationTransfer(o);if(s)(a=await s)==null||a.forEach((c,l)=>{c&&e.set(l,c)});else if(o&&t.handleDrag){const c=t.handleDrag(r,e,i);this.treeDragAndDropService.addDragOperationTransfer(o,c),await c}return e}async $handleDrag(e,t,r,i){const o=this.treeViews.get(e);if(!o)return Promise.reject(new Qg(e));const s=await this.addAdditionalTransferItems(new _Ee,o,t,i,r);if(!(!s||i.isCancellationRequested))return IC.from(s)}async $hasResolve(e){const t=this.treeViews.get(e);if(!t)throw new Qg(e);return t.hasResolve}$resolve(e,t,r){const i=this.treeViews.get(e);if(!i)throw new Qg(e);return i.resolveTreeItem(t,r)}$setExpanded(e,t,r){const i=this.treeViews.get(e);if(!i)throw new Qg(e);i.setExpanded(t,r)}$setSelectionAndFocus(e,t,r){const i=this.treeViews.get(e);if(!i)throw new Qg(e);i.setSelectionAndFocus(t,r)}$setVisible(e,t){const r=this.treeViews.get(e);if(!r){if(!t)return;throw new Qg(e)}r.setVisible(t)}$changeCheckboxState(e,t){const r=this.treeViews.get(e);if(!r)throw new Qg(e);r.setCheckboxState(t)}createExtHostTreeView(e,t,r){const i=this._register(new WQ(e,t,this._proxy,this.commands.converter,this.logService,r));return this.treeViews.set(e,i),i}convertArgument(e){const t=this.treeViews.get(e.$treeViewId);return t&&"$treeItemHandle"in e?t.getExtensionElement(e.$treeItemHandle):t&&"$focusedTreeItem"in e&&e.$focusedTreeItem?t.focusedElement:null}}const wC=class wC extends Dr{get visible(){return this._visible}get selectedElements(){return this._selectedHandles.map(e=>this.getExtensionElement(e)).filter(e=>!Pw(e))}get focusedElement(){return this._focusedHandle?this.getExtensionElement(this._focusedHandle):void 0}constructor(e,t,r,i,o,s){if(super(),this.viewId=e,this.proxy=r,this.commands=i,this.logService=o,this.extension=s,this.roots=void 0,this.elements=new Map,this.nodes=new Map,this._visible=!1,this._selectedHandles=[],this._focusedHandle=void 0,this._onDidExpandElement=this._register(new ft),this.onDidExpandElement=this._onDidExpandElement.event,this._onDidCollapseElement=this._register(new ft),this.onDidCollapseElement=this._onDidCollapseElement.event,this._onDidChangeSelection=this._register(new ft),this.onDidChangeSelection=this._onDidChangeSelection.event,this._onDidChangeActiveItem=this._register(new ft),this.onDidChangeActiveItem=this._onDidChangeActiveItem.event,this._onDidChangeVisibility=this._register(new ft),this.onDidChangeVisibility=this._onDidChangeVisibility.event,this._onDidChangeCheckboxState=this._register(new ft),this.onDidChangeCheckboxState=this._onDidChangeCheckboxState.event,this._onDidChangeData=this._register(new ft),this.refreshPromise=Promise.resolve(),this.refreshQueue=Promise.resolve(),this._message="",this._title="",this._refreshCancellationSource=new Uc,s.contributes&&s.contributes.views)for(const u in s.contributes.views)for(const d of s.contributes.views[u])d.id===e&&(this._title=d.name);this.dataProvider=t.treeDataProvider,this.dndController=t.dragAndDropController,this.dataProvider.onDidChangeTreeData&&this._register(this.dataProvider.onDidChangeTreeData(u=>{Array.isArray(u)&&u.length===0||this._onDidChangeData.fire({message:!1,element:u})}));let a,c;const l=ns.debounce(this._onDidChangeData.event,(u,d)=>(u||(u={message:!1,elements:[]}),d.element!==!1&&(a||(a=new Promise(h=>c=h),this.refreshPromise=this.refreshPromise.then(()=>a)),Array.isArray(d.element)?u.elements.push(...d.element):u.elements.push(d.element)),d.message&&(u.message=!0),u),200,!0);this._register(l(({message:u,elements:d})=>{d.length&&(this.refreshQueue=this.refreshQueue.then(()=>{const h=c;return a=null,this.refresh(d).then(()=>h())})),u&&this.proxy.$setMessage(this.viewId,$a.fromStrict(this._message)??"")}))}async getChildren(e){const t=e?this.getExtensionElement(e):void 0;if(e&&!t)return this.logService.error(`No tree item with id '${e}' found.`),Promise.resolve([]);let r=this.getChildrenNodes(e);return r||(r=await this.fetchChildrenNodes(t)),r?r.map(i=>i.item):void 0}getExtensionElement(e){return this.elements.get(e)}reveal(e,t){t=t||{select:!0,focus:!1};const r=Pw(t.select)?!0:t.select,i=Pw(t.focus)?!1:t.focus,o=Pw(t.expand)?!1:t.expand;return typeof this.dataProvider.getParent!="function"?Promise.reject(new Error("Required registered TreeDataProvider to implement 'getParent' method to access 'reveal' method")):e?this.refreshPromise.then(()=>this.resolveUnknownParentChain(e)).then(s=>this.resolveTreeNode(e,s[s.length-1]).then(a=>this.proxy.$reveal(this.viewId,{item:a.item,parentChain:s.map(c=>c.item)},{select:r,focus:i,expand:o})),s=>this.logService.error(s)):this.proxy.$reveal(this.viewId,void 0,{select:r,focus:i,expand:o})}get message(){return this._message}set message(e){this._message=e,this._onDidChangeData.fire({message:!0,element:!1})}get title(){return this._title}set title(e){this._title=e,this.proxy.$setTitle(this.viewId,e,this._description)}get description(){return this._description}set description(e){this._description=e,this.proxy.$setTitle(this.viewId,this._title,e)}get badge(){return this._badge}set badge(e){var t,r;((t=this._badge)==null?void 0:t.value)===(e==null?void 0:e.value)&&((r=this._badge)==null?void 0:r.tooltip)===(e==null?void 0:e.tooltip)||(this._badge=yEe.from(e),this.proxy.$setBadge(this.viewId,e))}setExpanded(e,t){const r=this.getExtensionElement(e);r&&(t?this._onDidExpandElement.fire(Object.freeze({element:r})):this._onDidCollapseElement.fire(Object.freeze({element:r})))}setSelectionAndFocus(e,t){const r=!qL(this._selectedHandles,e);this._selectedHandles=e;const i=this._focusedHandle!==t;this._focusedHandle=t,r&&this._onDidChangeSelection.fire(Object.freeze({selection:this.selectedElements})),i&&this._onDidChangeActiveItem.fire(Object.freeze({activeItem:this.focusedElement}))}setVisible(e){e!==this._visible&&(this._visible=e,this._onDidChangeVisibility.fire(Object.freeze({visible:this._visible})))}async setCheckboxState(e){const t=(await Promise.all(e.map(async r=>{const i=this.getExtensionElement(r.treeItemHandle);return i?{extensionItem:i,treeItem:await this.dataProvider.getTreeItem(i),newState:r.newState?Rw.Checked:Rw.Unchecked}:Promise.resolve(void 0)}))).filter(r=>r!==void 0);t.forEach(r=>{r.treeItem.checkboxState=r.newState?Rw.Checked:Rw.Unchecked}),this._onDidChangeCheckboxState.fire({items:t.map(r=>[r.extensionItem,r.newState])})}async handleDrag(e,t,r){var o;const i=[];for(const s of e){const a=this.getExtensionElement(s);a&&i.push(a)}if(!(!((o=this.dndController)!=null&&o.handleDrag)||i.length===0))return await this.dndController.handleDrag(i,t,r),t}get hasHandleDrag(){var e;return!!((e=this.dndController)!=null&&e.handleDrag)}async onDrop(e,t,r){var o;const i=t?this.getExtensionElement(t):void 0;if(!(!i&&t||!((o=this.dndController)!=null&&o.handleDrop)))return Lc(()=>{var s;return(s=this.dndController)!=null&&s.handleDrop?this.dndController.handleDrop(i,e,r):void 0})}get hasResolve(){return!!this.dataProvider.resolveTreeItem}async resolveTreeItem(e,t){if(!this.dataProvider.resolveTreeItem)return;const r=this.elements.get(e);if(r){const i=this.nodes.get(r);if(i){const o=await this.dataProvider.resolveTreeItem(i.extensionItem,r,t)??i.extensionItem;return this.validateTreeItem(o),i.item.tooltip=this.getTooltip(o.tooltip),i.item.command=this.getCommand(i.disposableStore,o.command),i.item}}}resolveUnknownParentChain(e){return this.resolveParent(e).then(t=>t?this.resolveUnknownParentChain(t).then(r=>this.resolveTreeNode(t,r[r.length-1]).then(i=>(r.push(i),r))):Promise.resolve([]))}resolveParent(e){const t=this.nodes.get(e);return t?Promise.resolve(t.parent?this.elements.get(t.parent.item.handle):void 0):Lc(()=>this.dataProvider.getParent(e))}resolveTreeNode(e,t){const r=this.nodes.get(e);return r?Promise.resolve(r):Lc(()=>this.dataProvider.getTreeItem(e)).then(i=>this.createHandle(e,i,t,!0)).then(i=>this.getChildren(t?t.item.handle:void 0).then(()=>{const o=this.getExtensionElement(i);if(o){const s=this.nodes.get(o);if(s)return Promise.resolve(s)}throw new Error(`Cannot resolve tree item for element ${i} from extension ${this.extension.identifier.value}`)}))}getChildrenNodes(e){if(e){let t;if(typeof e=="string"){const r=this.getExtensionElement(e);t=r?this.nodes.get(r):void 0}else t=e;return t&&t.children||void 0}return this.roots}async fetchChildrenNodes(e){this.clearChildren(e);const t=new Uc(this._refreshCancellationSource.token);try{const r=e?this.nodes.get(e):void 0,i=await this.dataProvider.getChildren(e);if(t.token.isCancellationRequested)return;const o=Qp(i||[]),s=await Promise.all(Qp(o).map(c=>this.dataProvider.getTreeItem(c)));if(t.token.isCancellationRequested)return;const a=s.map((c,l)=>c?this.createAndRegisterTreeNode(o[l],c,r):null);return Qp(a)}finally{t.dispose()}}refresh(e){if(e.some(r=>!r))return this._refreshCancellationSource.dispose(!0),this._refreshCancellationSource=new Uc,this.clearAll(),this.proxy.$refresh(this.viewId);{const r=this.getHandlesToRefresh(e);if(r.length)return this.refreshHandles(r)}return Promise.resolve(void 0)}getHandlesToRefresh(e){const t=new Set,r=e.map(o=>this.nodes.get(o));for(const o of r)if(o&&!t.has(o.item.handle)){let s=o;for(;s&&s.parent&&r.findIndex(a=>s&&s.parent&&a&&a.item.handle===s.parent.item.handle)===-1;){const a=this.elements.get(s.parent.item.handle);s=a?this.nodes.get(a):void 0}s&&!s.parent&&t.add(o.item.handle)}const i=[];return t.forEach(o=>{const s=this.elements.get(o);if(s){const a=this.nodes.get(s);a&&(!a.parent||!t.has(a.parent.item.handle))&&i.push(o)}}),i}refreshHandles(e){const t={};return Promise.all(e.map(r=>this.refreshNode(r).then(i=>{i&&(t[r]=i.item)}))).then(()=>Object.keys(t).length?this.proxy.$refresh(this.viewId,t):void 0)}refreshNode(e){const t=this.getExtensionElement(e);if(t){const r=this.nodes.get(t);if(r)return this.clearChildren(t),Lc(()=>this.dataProvider.getTreeItem(t)).then(i=>{if(i){const o=this.createTreeNode(t,i,r.parent);return this.updateNodeCache(t,o,r,r.parent),r.dispose(),o}return null})}return Promise.resolve(null)}createAndRegisterTreeNode(e,t,r){const i=this.createTreeNode(e,t,r);if(t.id&&this.elements.has(i.item.handle))throw new Error(Ve(Non,0,"Element with id {0} is already registered",t.id));return this.addNodeToCache(e,i),this.addNodeToParentCache(i,r),i}getTooltip(e){return T2.isMarkdownString(e)?$a.from(e):e}getCommand(e,t){return t?{...this.commands.toInternal(t,e),originalId:t.command}:void 0}getCheckbox(e){if(e.checkboxState===void 0)return;let t,r,i;return typeof e.checkboxState=="number"?t=e.checkboxState:(t=e.checkboxState.state,r=e.checkboxState.tooltip,i=e.checkboxState.accessibilityInformation),{isChecked:t===Rw.Checked,tooltip:r,accessibilityInformation:i}}validateTreeItem(e){if(!bEe.isTreeItem(e,this.extension))throw new Error(`Extension ${this.extension.identifier.value} has provided an invalid tree item.`)}createTreeNode(e,t,r){this.validateTreeItem(t);const i=this._register(new ei),o=this.createHandle(e,t,r),s=this.getLightIconPath(t);return{item:{handle:o,parentHandle:r?r.item.handle:void 0,label:$Ce(t.label),description:t.description,resourceUri:t.resourceUri,tooltip:this.getTooltip(t.tooltip),command:this.getCommand(i,t.command),contextValue:t.contextValue,icon:s,iconDark:this.getDarkIconPath(t)||s,themeIcon:this.getThemeIcon(t),collapsibleState:Pw(t.collapsibleState)?SEe.None:t.collapsibleState,accessibilityInformation:t.accessibilityInformation,checkbox:this.getCheckbox(t)},extensionItem:t,parent:r,children:void 0,disposableStore:i,dispose(){i.dispose()}}}getThemeIcon(e){return e.iconPath instanceof Q0?e.iconPath:void 0}createHandle(e,{id:t,label:r,resourceUri:i},o,s){if(t)return`${wC.ID_HANDLE_PREFIX}/${t}`;const a=$Ce(r),c=o?o.item.handle:wC.LABEL_HANDLE_PREFIX;let l=a?a.label:i?I2(i):"";l=l.indexOf("/")!==-1?l.replace("/","//"):l;const u=this.nodes.has(e)?this.nodes.get(e).item.handle:void 0,d=this.getChildrenNodes(o)||[];let h,f=0;do{if(h=`${c}/${f}:${l}`,s||!this.elements.has(h)||u===h)break;f++}while(f<=d.length);return h}getLightIconPath(e){if(e.iconPath&&!(e.iconPath instanceof Q0))return typeof e.iconPath=="string"||Te.isUri(e.iconPath)?this.getIconPath(e.iconPath):this.getIconPath(e.iconPath.light)}getDarkIconPath(e){if(e.iconPath&&!(e.iconPath instanceof Q0)&&e.iconPath.dark)return this.getIconPath(e.iconPath.dark)}getIconPath(e){return Te.isUri(e)?e:Te.file(e)}addNodeToCache(e,t){this.elements.set(t.item.handle,e),this.nodes.set(e,t)}updateNodeCache(e,t,r,i){this.elements.delete(t.item.handle),this.nodes.delete(e),t.item.handle!==r.item.handle&&this.elements.delete(r.item.handle),this.addNodeToCache(e,t);const o=this.getChildrenNodes(i)||[],s=o.filter(a=>a.item.handle===r.item.handle)[0];s&&o.splice(o.indexOf(s),1,t)}addNodeToParentCache(e,t){t?(t.children||(t.children=[]),t.children.push(e)):(this.roots||(this.roots=[]),this.roots.push(e))}clearChildren(e){if(e){const t=this.nodes.get(e);if(t){if(t.children)for(const r of t.children){const i=this.elements.get(r.item.handle);i&&this.clear(i)}t.children=void 0}}else this.clearAll()}clear(e){const t=this.nodes.get(e);if(t){if(t.children)for(const r of t.children){const i=this.elements.get(r.item.handle);i&&this.clear(i)}this.nodes.delete(e),this.elements.delete(t.item.handle),t.dispose()}}clearAll(){this.roots=void 0,this.elements.clear(),this.nodes.forEach(e=>e.dispose()),this.nodes.clear()}dispose(){super.dispose(),this._refreshCancellationSource.dispose(),this.clearAll(),this.proxy.$disposeTree(this.viewId)}};wC.LABEL_HANDLE_PREFIX="0",wC.ID_HANDLE_PREFIX="1";let WQ=wC;const HL=class HL{constructor(e){this._openers=new Map,this._proxy=e.getProxy(dn.MainThreadUriOpeners)}registerExternalUriOpener(e,t,r,i){if(this._openers.has(t))throw new Error(`Opener with id '${t}' already registered`);const o=i.schemes.find(s=>!HL.supportedSchemes.has(s));if(o)throw new Error(`Scheme '${o}' is not supported. Only http and https are currently supported.`);return this._openers.set(t,r),this._proxy.$registerUriOpener(t,i.schemes,e,i.label),ho(()=>{this._openers.delete(t),this._proxy.$unregisterUriOpener(t)})}async $canOpenUri(e,t,r){const i=this._openers.get(e);if(!i)throw new Error(`Unknown opener with id: ${e}`);const o=Te.revive(t);return i.canOpenExternalUri(o,r)}async $openUri(e,t,r){const i=this._openers.get(e);if(!i)throw new Error(`Unknown opener id: '${e}'`);return i.openExternalUri(Te.revive(t.resolvedUri),{sourceUri:Te.revive(t.sourceUri)},r)}};HL.supportedSchemes=new Set([hr.http,hr.https]);let qQ=HL;const UL=class UL{constructor(e){this.handles=new KT,this.handlers=new Map,this._proxy=e.getProxy(dn.MainThreadUrls)}registerUriHandler(e,t){const r=e.identifier;if(this.handles.has(r))throw new Error(`Protocol handler already registered for extension ${r}`);const i=UL.HandlePool++;return this.handles.add(r),this.handlers.set(i,t),this._proxy.$registerUriHandler(i,r,e.displayName||e.name),ho(()=>{this.handles.delete(r),this.handlers.delete(i),this._proxy.$unregisterUriHandler(i)})}$handleExternalUri(e,t){const r=this.handlers.get(e);if(!r)return Promise.resolve(void 0);try{r.handleUri(Te.revive(t))}catch(i){dee(i)}return Promise.resolve(void 0)}async createAppUri(e){return Te.revive(await this._proxy.$createAppUri(e))}};UL.HandlePool=0;let KQ=UL;var I0,P0,NT,u2,FT,G1,d2,Pm,h2,f2,k0,p2,g2;class jon extends Dr{constructor(t,r,i,o){super();Tn(this,I0,void 0);Tn(this,P0,void 0);Tn(this,NT,void 0);Tn(this,u2,void 0);Tn(this,FT,void 0);Tn(this,G1,void 0);Tn(this,d2,void 0);Tn(this,Pm,void 0);Tn(this,h2,void 0);Tn(this,f2,void 0);Tn(this,k0,void 0);Tn(this,p2,void 0);Tn(this,g2,void 0);gn(this,Pm,void 0),gn(this,h2,!0),gn(this,k0,!1),gn(this,p2,this._register(new ft)),this.onDidDispose=Qe(this,p2).event,gn(this,g2,this._register(new ft)),this.onDidChangeViewState=Qe(this,g2).event,gn(this,I0,t),gn(this,P0,r),gn(this,u2,i),gn(this,NT,o.viewType),gn(this,FT,o.panelOptions),gn(this,Pm,o.viewColumn),gn(this,G1,o.title),gn(this,f2,o.active)}dispose(){Qe(this,k0)||(gn(this,k0,!0),Qe(this,p2).fire(),Qe(this,P0).$disposeWebview(Qe(this,I0)),Qe(this,u2).dispose(),super.dispose())}get webview(){return this.assertNotDisposed(),Qe(this,u2)}get viewType(){return this.assertNotDisposed(),Qe(this,NT)}get title(){return this.assertNotDisposed(),Qe(this,G1)}set title(t){this.assertNotDisposed(),Qe(this,G1)!==t&&(gn(this,G1,t),Qe(this,P0).$setTitle(Qe(this,I0),t))}get iconPath(){return this.assertNotDisposed(),Qe(this,d2)}set iconPath(t){this.assertNotDisposed(),Qe(this,d2)!==t&&(gn(this,d2,t),Qe(this,P0).$setIconPath(Qe(this,I0),Te.isUri(t)?{light:t,dark:t}:t))}get options(){return Qe(this,FT)}get viewColumn(){if(this.assertNotDisposed(),!(typeof Qe(this,Pm)=="number"&&Qe(this,Pm)<0))return Qe(this,Pm)}get active(){return this.assertNotDisposed(),Qe(this,f2)}get visible(){return this.assertNotDisposed(),Qe(this,h2)}_updateViewState(t){Qe(this,k0)||(this.active!==t.active||this.visible!==t.visible||this.viewColumn!==t.viewColumn)&&(gn(this,f2,t.active),gn(this,h2,t.visible),gn(this,Pm,t.viewColumn),Qe(this,g2).fire({webviewPanel:this}))}reveal(t,r){this.assertNotDisposed(),Qe(this,P0).$reveal(Qe(this,I0),{viewColumn:typeof t>"u"?void 0:Ma.from(t),preserveFocus:!!r})}assertNotDisposed(){if(Qe(this,k0))throw new Error("Webview is disposed")}}I0=new WeakMap,P0=new WeakMap,NT=new WeakMap,u2=new WeakMap,FT=new WeakMap,G1=new WeakMap,d2=new WeakMap,Pm=new WeakMap,h2=new WeakMap,f2=new WeakMap,k0=new WeakMap,p2=new WeakMap,g2=new WeakMap;class Mse extends Dr{static newHandle(){return Yx()}constructor(e,t,r){super(),this.webviews=t,this.workspace=r,this._webviewPanels=new Map,this._serializers=new Map,this._proxy=e.getProxy(dn.MainThreadWebviewPanels)}dispose(){super.dispose(),this._webviewPanels.forEach(e=>e.dispose()),this._webviewPanels.clear()}createWebviewPanel(e,t,r,i,o={}){const s=typeof i=="object"?i.viewColumn:i,a={viewColumn:Ma.from(s),preserveFocus:typeof i=="object"&&!!i.preserveFocus},c=jx(e),l=Mse.newHandle();this._proxy.$createWebviewPanel(dL(e),l,t,{title:r,panelOptions:Bon(o),webviewOptions:gHe(e,this.workspace,o),serializeBuffersForPostMessage:c},a);const u=this.webviews.createNewWebview(l,o,e);return this.createNewWebviewPanel(l,t,r,s,o,u,!0)}$onDidChangeWebviewPanelViewStates(e){const t=Object.keys(e);t.sort((r,i)=>{const o=e[r],s=e[i];return o.active?1:s.active?-1:+o.visible-+s.visible});for(const r of t){const i=this.getWebviewPanel(r);if(!i)continue;const o=e[r];i._updateViewState({active:o.active,visible:o.visible,viewColumn:Ma.to(o.position)})}}async $onDidDisposeWebviewPanel(e){const t=this.getWebviewPanel(e);t==null||t.dispose(),this._webviewPanels.delete(e),this.webviews.deleteWebview(e)}registerWebviewPanelSerializer(e,t,r){if(this._serializers.has(t))throw new Error(`Serializer for '${t}' already registered`);return this._serializers.set(t,{serializer:r,extension:e}),this._proxy.$registerSerializer(t,{serializeBuffersForPostMessage:jx(e)}),new pi(()=>{this._serializers.delete(t),this._proxy.$unregisterSerializer(t)})}async $deserializeWebviewPanel(e,t,r,i){const o=this._serializers.get(t);if(!o)throw new Error(`No serializer found for '${t}'`);const{serializer:s,extension:a}=o,c=this.webviews.createNewWebview(e,r.webviewOptions,a),l=this.createNewWebviewPanel(e,t,r.title,i,r.panelOptions,c,r.active);await s.deserializeWebviewPanel(l,r.state)}createNewWebviewPanel(e,t,r,i,o,s,a){const c=new jon(e,this._proxy,s,{viewType:t,title:r,viewColumn:i,panelOptions:o,active:a});return this._webviewPanels.set(e,c),c}getWebviewPanel(e){return this._webviewPanels.get(e)}}function Bon(n){return{enableFindWidget:n.enableFindWidget,retainContextWhenHidden:n.retainContextWhenHidden}}var T0,D0,jT,m2,R0,Z1,X1,v2,Y1,y2,b2;class Hon extends Dr{constructor(t,r,i,o,s,a){super();Tn(this,T0,void 0);Tn(this,D0,void 0);Tn(this,jT,void 0);Tn(this,m2,void 0);Tn(this,R0,void 0);Tn(this,Z1,void 0);Tn(this,X1,void 0);Tn(this,v2,void 0);Tn(this,Y1,void 0);Tn(this,y2,void 0);Tn(this,b2,void 0);gn(this,R0,!1),gn(this,y2,this._register(new ft)),this.onDidChangeVisibility=Qe(this,y2).event,gn(this,b2,this._register(new ft)),this.onDidDispose=Qe(this,b2).event,gn(this,jT,i),gn(this,X1,o),gn(this,T0,t),gn(this,D0,r),gn(this,m2,s),gn(this,Z1,a)}dispose(){Qe(this,R0)||(gn(this,R0,!0),Qe(this,b2).fire(),Qe(this,m2).dispose(),super.dispose())}get title(){return this.assertNotDisposed(),Qe(this,X1)}set title(t){this.assertNotDisposed(),Qe(this,X1)!==t&&(gn(this,X1,t),Qe(this,D0).$setWebviewViewTitle(Qe(this,T0),t))}get description(){return this.assertNotDisposed(),Qe(this,v2)}set description(t){this.assertNotDisposed(),Qe(this,v2)!==t&&(gn(this,v2,t),Qe(this,D0).$setWebviewViewDescription(Qe(this,T0),t))}get visible(){return Qe(this,Z1)}get webview(){return Qe(this,m2)}get viewType(){return Qe(this,jT)}_setVisible(t){t===Qe(this,Z1)||Qe(this,R0)||(gn(this,Z1,t),Qe(this,y2).fire())}get badge(){return this.assertNotDisposed(),Qe(this,Y1)}set badge(t){var r,i;this.assertNotDisposed(),!((t==null?void 0:t.value)===((r=Qe(this,Y1))==null?void 0:r.value)&&(t==null?void 0:t.tooltip)===((i=Qe(this,Y1))==null?void 0:i.tooltip))&&(gn(this,Y1,yEe.from(t)),Qe(this,D0).$setWebviewViewBadge(Qe(this,T0),t))}show(t){this.assertNotDisposed(),Qe(this,D0).$show(Qe(this,T0),!!t)}assertNotDisposed(){if(Qe(this,R0))throw new Error("Webview is disposed")}}T0=new WeakMap,D0=new WeakMap,jT=new WeakMap,m2=new WeakMap,R0=new WeakMap,Z1=new WeakMap,X1=new WeakMap,v2=new WeakMap,Y1=new WeakMap,y2=new WeakMap,b2=new WeakMap;class Uon{constructor(e,t){this._extHostWebview=t,this._viewProviders=new Map,this._webviewViews=new Map,this._proxy=e.getProxy(dn.MainThreadWebviewViews)}registerWebviewViewProvider(e,t,r,i){if(this._viewProviders.has(t))throw new Error(`View provider for '${t}' already registered`);return this._viewProviders.set(t,{provider:r,extension:e}),this._proxy.$registerWebviewViewProvider(dL(e),t,{retainContextWhenHidden:i==null?void 0:i.retainContextWhenHidden,serializeBuffersForPostMessage:jx(e)}),new pi(()=>{this._viewProviders.delete(t),this._proxy.$unregisterWebviewViewProvider(t)})}async $resolveWebviewView(e,t,r,i,o){const s=this._viewProviders.get(t);if(!s)throw new Error(`No view provider found for '${t}'`);const{provider:a,extension:c}=s,l=this._extHostWebview.createNewWebview(e,{},c),u=new Hon(e,this._proxy,t,r,l,!0);this._webviewViews.set(e,u),await a.resolveWebviewView(u,{state:i},o)}async $onDidChangeWebviewViewVisibility(e,t){this.getWebviewView(e)._setVisible(t)}async $disposeWebviewView(e){const t=this.getWebviewView(e);this._webviewViews.delete(e),t.dispose(),this._extHostWebview.deleteWebview(e)}getWebviewView(e){const t=this._webviewViews.get(e);if(!t)throw new Error("No webview found");return t}}function zon(n){const e=n.get(Cl),t=n.get(IE),r=n.get(g9),i=n.get(rb),o=n.get(Av),s=n.get(v9),a=n.get(Ov),c=n.get(m9),l=n.get(Ii),u=n.get(xse),d=n.get(Ese),h=n.get(s_),f=n.get(Li),p=n.get(Fee),g=n.get(y9),m=n.get(hHe),v=n.get(kse),b=n.get(oR),S=n.get(Dse),E=n.get(Ise),w=n.get(Pse);l.set(Pn.ExtHostFileSystemInfo,t),l.set(Pn.ExtHostLogLevelServiceShape,h),l.set(Pn.ExtHostWorkspace,o),l.set(Pn.ExtHostConfiguration,a),l.set(Pn.ExtHostExtensionService,i),l.set(Pn.ExtHostStorage,u),l.set(Pn.ExtHostTunnelService,p),l.set(Pn.ExtHostWindow,m),l.set(Pn.ExtHostSecretState,v),l.set(Pn.ExtHostTelemetry,s),l.set(Pn.ExtHostEditorTabs,b),l.set(Pn.ExtHostManagedSockets,S),l.set(Pn.ExtHostAuthentication,E),l.set(Pn.ExtHostChatProvider,w);const C=l.set(Pn.ExtHostDecorations,n.get(eHe)),I=l.set(Pn.ExtHostDocumentsAndEditors,n.get(iR)),T=l.set(Pn.ExtHostCommands,n.get(PE)),D=l.set(Pn.ExtHostTerminalService,n.get(kE)),O=l.set(Pn.ExtHostTerminalShellIntegration,n.get(fHe)),M=l.set(Pn.ExtHostDebugService,n.get(uHe)),R=l.set(Pn.ExtHostSearch,n.get(dHe)),A=l.set(Pn.ExtHostTask,n.get(iHe)),k=l.set(Pn.ExtHostOutputService,n.get(JBe)),L=l.set(Pn.ExtHostLocalization,n.get(Tse)),j=l.set(Pn.ExtHostUrls,new KQ(l)),N=l.set(Pn.ExtHostDocuments,new Jin(l,I)),B=l.set(Pn.ExtHostDocumentContentProviders,new CQ(l,I,f)),U=l.set(Pn.ExtHostDocumentSaveParticipant,new Yin(f,N,l.getProxy(dn.MainThreadBulkEdits))),K=l.set(Pn.ExtHostNotebook,new DQ(l,T,I,N,r,R)),z=l.set(Pn.ExtHostNotebookDocuments,new hon(K)),G=l.set(Pn.ExtHostNotebookEditors,new RQ(f,K)),te=l.set(Pn.ExtHostNotebookKernels,new AQ(l,e,K,T,f)),ie=l.set(Pn.ExtHostNotebookRenderers,new gon(l,K)),Q=l.set(Pn.ExtHostNotebookDocumentSaveParticipant,new don(f,K,l.getProxy(dn.MainThreadBulkEdits))),ge=l.set(Pn.ExtHostEditors,new $on(l,I)),_e=l.set(Pn.ExtHostTreeViews,new Fon(l.getProxy(dn.MainThreadTreeViews),T,f)),Se=l.set(Pn.ExtHostEditorInsets,new $in(l.getProxy(dn.MainThreadEditorInsets),ge,e.remote)),se=l.set(Pn.ExtHostDiagnostics,new wQ(l,f,t,I)),ee=l.set(Pn.ExtHostLanguages,new con(l,N,T.converter,c)),Y=l.set(Pn.ExtHostLanguageFeatures,new IQ(l,c,N,T,se,f,g,s)),ue=l.set(Pn.ExtHostFileSystem,new fL(l,Y)),ye=l.set(Pn.ExtHostFileSystemEventService,new ron(l,f,I)),V=l.set(Pn.ExtHostQuickOpen,bon(l,o,T)),le=l.set(Pn.ExtHostSCM,new jQ(l,T,N,f)),he=l.set(Pn.ExtHostQuickDiff,new LQ(l,c)),oe=l.set(Pn.ExtHostShare,new BQ(l,c)),ne=l.set(Pn.ExtHostComments,Lin(l,T,N)),ce=l.set(Pn.ExtHostProgress,new von(l.getProxy(dn.MainThreadProgress))),Ae=l.set(Pn.ExtHostLabelService,new son(l)),Ie=l.set(Pn.ExtHostTheming,new VQ(l)),be=l.set(Pn.ExtHostTimeline,new Lon(l,T)),De=l.set(Pn.ExtHostWebviews,new jin(l,e.remote,o,f,g)),Me=l.set(Pn.ExtHostWebviewPanels,new Mse(l,De,o)),He=l.set(Pn.ExtHostCustomEditors,new Win(l,N,d,De,Me)),Je=l.set(Pn.ExtHostWebviewViews,new Uon(l,De)),qe=l.set(Pn.ExtHostTesting,new zQ(l,f,T,I)),Ge=l.set(Pn.ExtHostUriOpeners,new qQ(l)),St=l.set(Pn.ExtHostProfileContentHandlers,new mon(l));l.set(Pn.ExtHostInteractive,new oon(l,K,I,T,f));const Pt=l.set(Pn.ExtHostInlineChat,new EQ(l,T,N,f)),on=l.set(Pn.ExtHostChatAgents2,new bQ(l,f,T)),an=l.set(Pn.ExtHostChatVariables,new SQ(l)),Rt=l.set(Pn.ExtHostAiRelatedInformation,new Pin(l)),Xt=l.set(Pn.ExtHostAiEmbeddingVector,new Qin(l)),yn=l.set(Pn.ExtHostStatusBar,new kon(l,T.converter)),bn=l.set(Pn.ExtHostSpeech,new HQ(l)),Kn=Object.values(Pn);l.assertRegistered(Kn);const lr=new yQ(l,I),Rr=new Ain(l),Lr=new PQ(l,f),er=new Xin(l);return Tin.register(T),function(ke,Qn,Gn){function J(W){return(X,fe,xt)=>{const Zt=W(or=>{try{X.call(fe,or)}catch(tr){fee(new Error(`[ExtensionListenerError] Extension '${ke.identifier.value}' FAILED to handle event: ${tr.toString()}`,{cause:tr})),s.onExtensionError(ke.identifier,tr)}});return xt==null||xt.push(Zt),Zt}}const ze=function(){let W=!ke.isUnderDevelopment;function X(){W||(f.info(`Extension '${ke.identifier.value}' uses a document selector without scheme. Learn more about this: https://go.microsoft.com/fwlink/?linkid=872305`),W=!0)}return function fe(xt){if(Array.isArray(xt))xt.forEach(fe);else if(typeof xt=="string")X();else{const Zt=xt;typeof Zt.scheme>"u"&&X(),typeof Zt.exclusive=="boolean"&&vt(ke,"documentFiltersExclusive")}return xt}}(),it={getSession(W,X,fe){return typeof(fe==null?void 0:fe.forceNewSession)=="object"&&fe.forceNewSession.learnMore&&vt(ke,"authLearnMore"),E.getSession(ke,W,X,fe)},getSessions(W,X){return vt(ke,"authGetSessions"),E.getSessions(ke,W,X)},async hasSession(W,X){return vt(ke,"authSession"),!!await E.getSession(ke,W,X,{silent:!0})},get onDidChangeSessions(){return J(E.onDidChangeSessions)},registerAuthenticationProvider(W,X,fe,xt){return E.registerAuthenticationProvider(W,X,fe,xt)}},at={registerCommand(W,X,fe){return T.registerCommand(!0,W,X,fe,void 0,ke)},registerTextEditorCommand(W,X,fe){return T.registerCommand(!0,W,(...xt)=>{const Zt=ge.getActiveTextEditor();if(!Zt){f.warn("Cannot execute "+W+" because there is no active text editor.");return}return Zt.edit(or=>{X.apply(fe,[Zt,or,...xt])}).then(or=>{or||f.warn("Edits from command "+W+" were not applied.")},or=>{f.warn("An error occurred while running command "+W,or)})},void 0,void 0,ke)},registerDiffInformationCommand:(W,X,fe)=>(vt(ke,"diffCommand"),T.registerCommand(!0,W,async(...xt)=>{const Zt=I.activeEditor(!0);if(!Zt){f.warn("Cannot execute "+W+" because there is no active text editor.");return}const or=await ge.getDiffInformation(Zt.id);X.apply(fe,[or,...xt])},void 0,void 0,ke)),executeCommand(W,...X){return T.executeCommand(W,...X)},getCommands(W=!1){return T.getCommands(W)}},Lt={get machineId(){return e.telemetryInfo.machineId},get sessionId(){return e.telemetryInfo.sessionId},get language(){return e.environment.appLanguage},get appName(){return e.environment.appName},get appRoot(){var W;return((W=e.environment.appRoot)==null?void 0:W.fsPath)??""},get appHost(){return e.environment.appHost},get uriScheme(){return e.environment.appUriScheme},get clipboard(){return Rr.value},get shell(){return D.getDefaultShell(!1)},get onDidChangeShell(){return J(D.onDidChangeShell)},get isTelemetryEnabled(){return s.getTelemetryConfiguration()},get onDidChangeTelemetryEnabled(){return J(s.onDidChangeTelemetryEnabled)},get telemetryConfiguration(){return vt(ke,"telemetry"),s.getTelemetryDetails()},get onDidChangeTelemetryConfiguration(){return vt(ke,"telemetry"),J(s.onDidChangeTelemetryConfiguration)},get isNewAppInstall(){return nHe(e.telemetryInfo.firstSessionDate)},createTelemetryLogger(W,X){return tHe.validateSender(W),s.instantiateLogger(ke,W,X)},openExternal(W,X){return m.openUri(W,{allowTunneling:!!e.remote.authority,allowContributedOpeners:X==null?void 0:X.allowContributedOpeners})},async asExternalUri(W){if(W.scheme===e.environment.appUriScheme)return j.createAppUri(W);try{return await m.asExternalUri(W,{allowTunneling:!!e.remote.authority})}catch(X){if(Vce(W,hr.http)||Vce(W,hr.https))return W;throw X}},get remoteName(){return oxe(e.remote.authority)},get remoteAuthority(){return vt(ke,"resolvers"),e.remote.authority},get uiKind(){return e.uiKind},get logLevel(){return f.getLevel()},get onDidChangeLogLevel(){return J(f.onDidChangeLogLevel)},get appQuality(){return vt(ke,"resolvers"),e.quality},get appCommit(){return vt(ke,"resolvers"),e.commit}},fn={createTestController(W,X,fe){return qe.createTestController(ke,W,X,fe)},createTestObserver(){return vt(ke,"testObserver"),qe.createTestObserver()},runTests(W){return vt(ke,"testObserver"),qe.runTests(W)},get onDidChangeTestResults(){return vt(ke,"testObserver"),J(qe.onResultsChanged)},get testResults(){return vt(ke,"testObserver"),qe.results}},hn=e.remote.isRemote?FP.Workspace:FP.UI,Ut={getExtension(W,X){Oa(ke,"extensionsAny")||(X=!1);const fe=Qn.mine.getExtensionDescription(W);if(fe)return new PP(i,ke.identifier,fe,hn,!1);if(X){const xt=Qn.all.getExtensionDescription(W);if(xt)return new PP(i,ke.identifier,xt,hn,!0)}},get all(){const W=[];for(const X of Qn.mine.getAllExtensionDescriptions())W.push(new PP(i,ke.identifier,X,hn,!1));return W},get allAcrossExtensionHosts(){vt(ke,"extensionsAny");const W=new KT(Qn.mine.getAllExtensionDescriptions().map(fe=>fe.identifier)),X=[];for(const fe of Qn.all.getAllExtensionDescriptions()){const xt=!W.has(fe.identifier);X.push(new PP(i,ke.identifier,fe,hn,xt))}return X},get onDidChange(){return Oa(ke,"extensionsAny")?J(ns.any(Qn.mine.onDidChange,Qn.all.onDidChange)):J(Qn.mine.onDidChange)}},sn={createDiagnosticCollection(W){return se.createDiagnosticCollection(ke.identifier,W)},get onDidChangeDiagnostics(){return J(se.onDidChangeDiagnostics)},getDiagnostics:W=>se.getDiagnostics(W),getLanguages(){return ee.getLanguages()},setTextDocumentLanguage(W,X){return ee.changeLanguage(W.uri,X)},match(W,X){var Zt;const fe=bet.from(W);let xt;return _et(fe)&&(xt=(Zt=K.notebookDocuments.find(or=>or.apiNotebook.getCells().find(tr=>tr.document===X)))==null?void 0:Zt.apiNotebook),wet(fe,X.uri,X.languageId,!0,xt==null?void 0:xt.uri,xt==null?void 0:xt.notebookType)},registerCodeActionsProvider(W,X,fe){return Y.registerCodeActionProvider(ke,ze(W),X,fe)},registerDocumentPasteEditProvider(W,X,fe){return vt(ke,"documentPaste"),Y.registerDocumentPasteEditProvider(ke,ze(W),X,fe)},registerCodeLensProvider(W,X){return Y.registerCodeLensProvider(ke,ze(W),X)},registerDefinitionProvider(W,X){return Y.registerDefinitionProvider(ke,ze(W),X)},registerDeclarationProvider(W,X){return Y.registerDeclarationProvider(ke,ze(W),X)},registerImplementationProvider(W,X){return Y.registerImplementationProvider(ke,ze(W),X)},registerTypeDefinitionProvider(W,X){return Y.registerTypeDefinitionProvider(ke,ze(W),X)},registerHoverProvider(W,X){return Y.registerHoverProvider(ke,ze(W),X,ke.identifier)},registerEvaluatableExpressionProvider(W,X){return Y.registerEvaluatableExpressionProvider(ke,ze(W),X,ke.identifier)},registerInlineValuesProvider(W,X){return Y.registerInlineValuesProvider(ke,ze(W),X,ke.identifier)},registerDocumentHighlightProvider(W,X){return Y.registerDocumentHighlightProvider(ke,ze(W),X)},registerMultiDocumentHighlightProvider(W,X){return Y.registerMultiDocumentHighlightProvider(ke,ze(W),X)},registerLinkedEditingRangeProvider(W,X){return Y.registerLinkedEditingRangeProvider(ke,ze(W),X)},registerReferenceProvider(W,X){return Y.registerReferenceProvider(ke,ze(W),X)},registerRenameProvider(W,X){return Y.registerRenameProvider(ke,ze(W),X)},registerNewSymbolNamesProvider(W,X){return vt(ke,"newSymbolNamesProvider"),Y.registerNewSymbolNamesProvider(ke,ze(W),X)},registerDocumentSymbolProvider(W,X,fe){return Y.registerDocumentSymbolProvider(ke,ze(W),X,fe)},registerWorkspaceSymbolProvider(W){return Y.registerWorkspaceSymbolProvider(ke,W)},registerDocumentFormattingEditProvider(W,X){return Y.registerDocumentFormattingEditProvider(ke,ze(W),X)},registerDocumentRangeFormattingEditProvider(W,X){return Y.registerDocumentRangeFormattingEditProvider(ke,ze(W),X)},registerOnTypeFormattingEditProvider(W,X,fe,...xt){return Y.registerOnTypeFormattingEditProvider(ke,ze(W),X,[fe].concat(xt))},registerDocumentSemanticTokensProvider(W,X,fe){return Y.registerDocumentSemanticTokensProvider(ke,ze(W),X,fe)},registerDocumentRangeSemanticTokensProvider(W,X,fe){return Y.registerDocumentRangeSemanticTokensProvider(ke,ze(W),X,fe)},registerSignatureHelpProvider(W,X,fe,...xt){return typeof fe=="object"?Y.registerSignatureHelpProvider(ke,ze(W),X,fe):Y.registerSignatureHelpProvider(ke,ze(W),X,typeof fe>"u"?[]:[fe,...xt])},registerCompletionItemProvider(W,X,...fe){return Y.registerCompletionItemProvider(ke,ze(W),X,fe)},registerInlineCompletionItemProvider(W,X,fe){return X.handleDidShowCompletionItem&&vt(ke,"inlineCompletionsAdditions"),X.handleDidPartiallyAcceptCompletionItem&&vt(ke,"inlineCompletionsAdditions"),fe&&vt(ke,"inlineCompletionsAdditions"),Y.registerInlineCompletionsProvider(ke,ze(W),X,fe)},registerInlineEditProvider(W,X){return vt(ke,"inlineEdit"),Y.registerInlineEditProvider(ke,ze(W),X)},registerDocumentLinkProvider(W,X){return Y.registerDocumentLinkProvider(ke,ze(W),X)},registerColorProvider(W,X){return Y.registerColorProvider(ke,ze(W),X)},registerFoldingRangeProvider(W,X){return Y.registerFoldingRangeProvider(ke,ze(W),X)},registerSelectionRangeProvider(W,X){return Y.registerSelectionRangeProvider(ke,W,X)},registerCallHierarchyProvider(W,X){return Y.registerCallHierarchyProvider(ke,W,X)},registerTypeHierarchyProvider(W,X){return Y.registerTypeHierarchyProvider(ke,W,X)},setLanguageConfiguration:(W,X)=>Y.setLanguageConfiguration(ke,W,X),getTokenInformationAtPosition(W,X){return vt(ke,"tokenInformation"),ee.tokenAtPosition(W,X)},registerInlayHintsProvider(W,X){return Y.registerInlayHintsProvider(ke,W,X)},createLanguageStatusItem(W,X){return ee.createLanguageStatusItem(ke,W,X)},registerDocumentDropEditProvider(W,X,fe){return Y.registerDocumentOnDropEditProvider(ke,W,X,Oa(ke,"documentPaste")?fe:void 0)}},ae={get activeTextEditor(){return ge.getActiveTextEditor()},get visibleTextEditors(){return ge.getVisibleTextEditors()},get activeTerminal(){return D.activeTerminal},get terminals(){return D.terminals},async showTextDocument(W,X,fe){Te.isUri(W)&&W.scheme===hr.vscodeRemote&&!W.authority&&g.report("workspace.showTextDocument",ke,"A URI of 'vscode-remote' scheme requires an authority.");const xt=await(Te.isUri(W)?Promise.resolve(Wt.openTextDocument(W)):Promise.resolve(W));return ge.showTextDocument(xt,X,fe)},createTextEditorDecorationType(W){return ge.createTextEditorDecorationType(ke,W)},onDidChangeActiveTextEditor(W,X,fe){return J(ge.onDidChangeActiveTextEditor)(W,X,fe)},onDidChangeVisibleTextEditors(W,X,fe){return J(ge.onDidChangeVisibleTextEditors)(W,X,fe)},onDidChangeTextEditorSelection(W,X,fe){return J(ge.onDidChangeTextEditorSelection)(W,X,fe)},onDidChangeTextEditorOptions(W,X,fe){return J(ge.onDidChangeTextEditorOptions)(W,X,fe)},onDidChangeTextEditorVisibleRanges(W,X,fe){return J(ge.onDidChangeTextEditorVisibleRanges)(W,X,fe)},onDidChangeTextEditorViewColumn(W,X,fe){return J(ge.onDidChangeTextEditorViewColumn)(W,X,fe)},onDidCloseTerminal(W,X,fe){return J(D.onDidCloseTerminal)(W,X,fe)},onDidOpenTerminal(W,X,fe){return J(D.onDidOpenTerminal)(W,X,fe)},onDidChangeActiveTerminal(W,X,fe){return J(D.onDidChangeActiveTerminal)(W,X,fe)},onDidChangeTerminalDimensions(W,X,fe){return vt(ke,"terminalDimensions"),J(D.onDidChangeTerminalDimensions)(W,X,fe)},onDidChangeTerminalState(W,X,fe){return J(D.onDidChangeTerminalState)(W,X,fe)},onDidWriteTerminalData(W,X,fe){return vt(ke,"terminalDataWriteEvent"),J(D.onDidWriteTerminalData)(W,X,fe)},onDidExecuteTerminalCommand(W,X,fe){return vt(ke,"terminalExecuteCommandEvent"),J(D.onDidExecuteTerminalCommand)(W,X,fe)},onDidChangeTerminalShellIntegration(W,X,fe){return vt(ke,"terminalShellIntegration"),J(O.onDidChangeTerminalShellIntegration)(W,X,fe)},onDidStartTerminalShellExecution(W,X,fe){return vt(ke,"terminalShellIntegration"),J(O.onDidStartTerminalShellExecution)(W,X,fe)},onDidEndTerminalShellExecution(W,X,fe){return vt(ke,"terminalShellIntegration"),J(O.onDidEndTerminalShellExecution)(W,X,fe)},get state(){return m.getState()},onDidChangeWindowState(W,X,fe){return J(m.onDidChangeWindowState)(W,X,fe)},showInformationMessage(W,...X){return Lr.showMessage(ke,$s.Info,W,X[0],X.slice(1))},showWarningMessage(W,...X){return Lr.showMessage(ke,$s.Warning,W,X[0],X.slice(1))},showErrorMessage(W,...X){return Lr.showMessage(ke,$s.Error,W,X[0],X.slice(1))},showQuickPick(W,X,fe){return V.showQuickPick(ke,W,X,fe)},showWorkspaceFolderPick(W){return V.showWorkspaceFolderPick(W)},showInputBox(W,X){return V.showInput(W,X)},showOpenDialog(W){return er.showOpenDialog(ke,W)},showSaveDialog(W){return er.showSaveDialog(W)},createStatusBarItem(W,X,fe){let xt,Zt,or;return typeof W=="string"?(xt=W,Zt=X,or=fe):(Zt=W,or=X),yn.createStatusBarEntry(ke,xt,Zt,or)},setStatusBarMessage(W,X){return yn.setStatusBarMessage(W,X)},withScmProgress(W){return g.report("window.withScmProgress",ke,"Use 'withProgress' instead."),ce.withProgress(ke,{location:Cle.SourceControl},(X,fe)=>W({report(xt){}}))},withProgress(W,X){return ce.withProgress(ke,W,X)},createOutputChannel(W,X){return k.createOutputChannel(W,X,ke)},createWebviewPanel(W,X,fe,xt){return Me.createWebviewPanel(ke,W,X,fe,xt)},createWebviewTextEditorInset(W,X,fe,xt){return vt(ke,"editorInsets"),Se.createWebviewEditorInset(W,X,fe,xt,ke)},createTerminal(W,X,fe){return typeof W=="object"?"pty"in W?D.createExtensionTerminal(W):D.createTerminalFromOptions(W):D.createTerminal(W,X,fe)},registerTerminalLinkProvider(W){return D.registerLinkProvider(W)},registerTerminalProfileProvider(W,X){return D.registerProfileProvider(ke,W,X)},registerTerminalQuickFixProvider(W,X){return vt(ke,"terminalQuickFixProvider"),D.registerTerminalQuickFixProvider(W,ke.identifier.value,X)},registerTreeDataProvider(W,X){return _e.registerTreeDataProvider(W,X,ke)},createTreeView(W,X){return _e.createTreeView(W,X,ke)},registerWebviewPanelSerializer:(W,X)=>Me.registerWebviewPanelSerializer(ke,W,X),registerCustomEditorProvider:(W,X,fe={})=>He.registerCustomEditorProvider(ke,W,X,fe),registerFileDecorationProvider(W){return C.registerFileDecorationProvider(W,ke)},registerUriHandler(W){return j.registerUriHandler(ke,W)},createQuickPick(){return V.createQuickPick(ke)},createInputBox(){return V.createInputBox(ke)},get activeColorTheme(){return Ie.activeColorTheme},onDidChangeActiveColorTheme(W,X,fe){return J(Ie.onDidChangeActiveColorTheme)(W,X,fe)},registerWebviewViewProvider(W,X,fe){return Je.registerWebviewViewProvider(ke,W,X,fe==null?void 0:fe.webviewOptions)},get activeNotebookEditor(){return K.activeNotebookEditor},onDidChangeActiveNotebookEditor(W,X,fe){return J(K.onDidChangeActiveNotebookEditor)(W,X,fe)},get visibleNotebookEditors(){return K.visibleNotebookEditors},get onDidChangeVisibleNotebookEditors(){return J(K.onDidChangeVisibleNotebookEditors)},onDidChangeNotebookEditorSelection(W,X,fe){return J(G.onDidChangeNotebookEditorSelection)(W,X,fe)},onDidChangeNotebookEditorVisibleRanges(W,X,fe){return J(G.onDidChangeNotebookEditorVisibleRanges)(W,X,fe)},showNotebookDocument(W,X){return K.showNotebookDocument(W,X)},registerExternalUriOpener(W,X,fe){return vt(ke,"externalUriOpener"),Ge.registerExternalUriOpener(ke.identifier,W,X,fe)},registerProfileContentHandler(W,X){return vt(ke,"profileContentHandlers"),St.registerProfileContentHandler(ke,W,X)},registerQuickDiffProvider(W,X,fe,xt){return vt(ke,"quickDiffProvider"),he.registerQuickDiffProvider(ze(W),X,fe,xt)},get tabGroups(){return b.tabGroups},registerShareProvider(W,X){return vt(ke,"shareProvider"),oe.registerShareProvider(ze(W),X)}},Wt={get rootPath(){return g.report("workspace.rootPath",ke,"Please use 'workspace.workspaceFolders' instead. More details: https://aka.ms/vscode-eliminating-rootpath"),o.getPath()},set rootPath(W){throw new y1("rootPath")},getWorkspaceFolder(W){return o.getWorkspaceFolder(W)},get workspaceFolders(){return o.getWorkspaceFolders()},get name(){return o.name},set name(W){throw new y1("name")},get workspaceFile(){return o.workspaceFile},set workspaceFile(W){throw new y1("workspaceFile")},updateWorkspaceFolders:(W,X,...fe)=>o.updateWorkspaceFolders(ke,W,X||0,...fe),onDidChangeWorkspaceFolders:function(W,X,fe){return J(o.onDidChangeWorkspace)(W,X,fe)},asRelativePath:(W,X)=>o.getRelativePath(W,X),findFiles:(W,X,fe,xt)=>o.findFiles(W,X,fe,ke.identifier,xt),findFiles2:(W,X,fe)=>(vt(ke,"findFiles2"),o.findFiles2(W,X,ke.identifier,fe)),findTextInFiles:(W,X,fe,xt)=>{vt(ke,"findTextInFiles");let Zt,or;return typeof X=="object"?(Zt=X,or=fe):(Zt={},or=X,xt=fe),o.findTextInFiles(W,Zt||{},or,ke.identifier,xt)},save:W=>o.save(W),saveAs:W=>o.saveAs(W),saveAll:W=>o.saveAll(W),applyEdit(W,X){return lr.applyWorkspaceEdit(W,ke,X)},createFileSystemWatcher:(W,X,fe,xt)=>{let Zt;return typeof X=="boolean"?Zt={ignoreCreateEvents:!!X,ignoreChangeEvents:!!fe,ignoreDeleteEvents:!!xt,correlate:!1}:X&&(vt(ke,"createFileSystemWatcher"),Zt={...X,correlate:!0}),ye.createFileSystemWatcher(o,ke,W,Zt)},get textDocuments(){return N.getAllDocumentData().map(W=>W.document)},set textDocuments(W){throw new y1("textDocuments")},openTextDocument(W){let X;const fe=W;if(typeof W=="string")X=Promise.resolve(Te.file(W));else if(Te.isUri(W))X=Promise.resolve(W);else if(!fe||typeof fe=="object")X=N.createDocumentData(fe);else throw new Error("illegal argument - uriOrFileNameOrOptions");return X.then(xt=>(xt.scheme===hr.vscodeRemote&&!xt.authority&&g.report("workspace.openTextDocument",ke,"A URI of 'vscode-remote' scheme requires an authority."),N.ensureDocumentData(xt).then(Zt=>Zt.document)))},onDidOpenTextDocument:(W,X,fe)=>J(N.onDidAddDocument)(W,X,fe),onDidCloseTextDocument:(W,X,fe)=>J(N.onDidRemoveDocument)(W,X,fe),onDidChangeTextDocument:(W,X,fe)=>J(N.onDidChangeDocument)(W,X,fe),onDidSaveTextDocument:(W,X,fe)=>J(N.onDidSaveDocument)(W,X,fe),onWillSaveTextDocument:(W,X,fe)=>J(U.getOnWillSaveTextDocumentEvent(ke))(W,X,fe),get notebookDocuments(){return K.notebookDocuments.map(W=>W.apiNotebook)},async openNotebookDocument(W,X){let fe;if(Te.isUri(W))fe=W,await K.openNotebookDocument(W);else if(typeof W=="string")fe=Te.revive(await K.createNotebookDocument({viewType:W,content:X}));else throw new Error("Invalid arguments");return K.getNotebookDocument(fe).apiNotebook},onDidSaveNotebookDocument(W,X,fe){return J(z.onDidSaveNotebookDocument)(W,X,fe)},onDidChangeNotebookDocument(W,X,fe){return J(z.onDidChangeNotebookDocument)(W,X,fe)},onWillSaveNotebookDocument(W,X,fe){return J(Q.getOnWillSaveNotebookDocumentEvent(ke))(W,X,fe)},get onDidOpenNotebookDocument(){return J(K.onDidOpenNotebookDocument)},get onDidCloseNotebookDocument(){return J(K.onDidCloseNotebookDocument)},registerNotebookSerializer(W,X,fe,xt){return K.registerNotebookSerializer(ke,W,X,fe,Oa(ke,"notebookLiveShare")?xt:void 0)},onDidChangeConfiguration:(W,X,fe)=>J(Gn.onDidChangeConfiguration)(W,X,fe),getConfiguration(W,X){return X=arguments.length===1?void 0:X,Gn.getConfiguration(W,X,ke)},registerTextDocumentContentProvider(W,X){return B.registerTextDocumentContentProvider(W,X)},registerTaskProvider:(W,X)=>(g.report("window.registerTaskProvider",ke,"Use the corresponding function on the 'tasks' namespace instead"),A.registerTaskProvider(ke,W,X)),registerFileSystemProvider(W,X,fe){return QV(ue.registerFileSystemProvider(ke,W,X,fe),r.addFileSystemProvider(W,X,fe))},get fs(){return r.value},registerFileSearchProvider:(W,X)=>(vt(ke,"fileSearchProvider"),R.registerFileSearchProvider(W,X)),registerTextSearchProvider:(W,X)=>(vt(ke,"textSearchProvider"),R.registerTextSearchProvider(W,X)),registerAITextSearchProvider:(W,X)=>(vt(ke,"aiTextSearchProvider"),vt(ke,"textSearchProvider"),R.registerAITextSearchProvider(W,X)),registerRemoteAuthorityResolver:(W,X)=>(vt(ke,"resolvers"),i.registerRemoteAuthorityResolver(W,X)),registerResourceLabelFormatter:W=>(vt(ke,"resolvers"),Ae.$registerResourceLabelFormatter(W)),getRemoteExecServer:W=>(vt(ke,"resolvers"),i.getRemoteExecServer(W)),onDidCreateFiles:(W,X,fe)=>J(ye.onDidCreateFile)(W,X,fe),onDidDeleteFiles:(W,X,fe)=>J(ye.onDidDeleteFile)(W,X,fe),onDidRenameFiles:(W,X,fe)=>J(ye.onDidRenameFile)(W,X,fe),onWillCreateFiles:(W,X,fe)=>J(ye.getOnWillCreateFileEvent(ke))(W,X,fe),onWillDeleteFiles:(W,X,fe)=>J(ye.getOnWillDeleteFileEvent(ke))(W,X,fe),onWillRenameFiles:(W,X,fe)=>J(ye.getOnWillRenameFileEvent(ke))(W,X,fe),openTunnel:W=>(vt(ke,"tunnels"),p.openTunnel(ke,W).then(X=>{if(!X)throw new Error("cannot open tunnel");return X})),get tunnels(){return vt(ke,"tunnels"),p.getTunnels()},onDidChangeTunnels:(W,X,fe)=>(vt(ke,"tunnels"),J(p.onDidChangeTunnels)(W,X,fe)),registerPortAttributesProvider:(W,X)=>(vt(ke,"portsAttributes"),p.registerPortsAttributesProvider(W,X)),registerTunnelProvider:(W,X)=>(vt(ke,"tunnelFactory"),p.registerTunnelProvider(W,X)),registerTimelineProvider:(W,X)=>(vt(ke,"timeline"),be.registerTimelineProvider(W,X,ke.identifier,T.converter)),get isTrusted(){return o.trusted},requestWorkspaceTrust:W=>(vt(ke,"workspaceTrust"),o.requestWorkspaceTrust(W)),onDidGrantWorkspaceTrust:(W,X,fe)=>J(o.onDidGrantWorkspaceTrust)(W,X,fe),registerEditSessionIdentityProvider:(W,X)=>(vt(ke,"editSessionIdentityProvider"),o.registerEditSessionIdentityProvider(W,X)),onWillCreateEditSessionIdentity:(W,X,fe)=>(vt(ke,"editSessionIdentityProvider"),J(o.getOnWillCreateEditSessionIdentityEvent(ke))(W,X,fe)),registerCanonicalUriProvider:(W,X)=>(vt(ke,"canonicalUriProvider"),o.registerCanonicalUriProvider(W,X)),getCanonicalUri:(W,X,fe)=>(vt(ke,"canonicalUriProvider"),o.provideCanonicalUri(W,X,fe))},un={get inputBox(){return g.report("scm.inputBox",ke,"Use 'SourceControl.inputBox' instead"),le.getLastInputBox(ke)},createSourceControl(W,X,fe){return le.createSourceControl(ke,W,X,fe)}},qt={createCommentController(W,X){return ne.createCommentController(ke,W,X)}},Ce={get activeDebugSession(){return M.activeDebugSession},get activeDebugConsole(){return M.activeDebugConsole},get breakpoints(){return M.breakpoints},get activeStackItem(){if(Oa(ke,"debugFocus"))return M.activeStackItem},registerDebugVisualizationProvider(W,X){return vt(ke,"debugVisualization"),M.registerDebugVisualizationProvider(ke,W,X)},registerDebugVisualizationTreeProvider(W,X){return vt(ke,"debugVisualization"),M.registerDebugVisualizationTree(ke,W,X)},onDidStartDebugSession(W,X,fe){return J(M.onDidStartDebugSession)(W,X,fe)},onDidTerminateDebugSession(W,X,fe){return J(M.onDidTerminateDebugSession)(W,X,fe)},onDidChangeActiveDebugSession(W,X,fe){return J(M.onDidChangeActiveDebugSession)(W,X,fe)},onDidReceiveDebugSessionCustomEvent(W,X,fe){return J(M.onDidReceiveDebugSessionCustomEvent)(W,X,fe)},onDidChangeBreakpoints(W,X,fe){return J(M.onDidChangeBreakpoints)(W,X,fe)},onDidChangeActiveStackItem(W,X,fe){return vt(ke,"debugFocus"),J(M.onDidChangeActiveStackItem)(W,X,fe)},registerDebugConfigurationProvider(W,X,fe){return M.registerDebugConfigurationProvider(W,X,fe||wle.Initial)},registerDebugAdapterDescriptorFactory(W,X){return M.registerDebugAdapterDescriptorFactory(ke,W,X)},registerDebugAdapterTrackerFactory(W,X){return M.registerDebugAdapterTrackerFactory(W,X)},startDebugging(W,X,fe){return!fe||typeof fe=="object"&&"configuration"in fe?M.startDebugging(W,X,{parentSession:fe}):M.startDebugging(W,X,fe||{})},stopDebugging(W){return M.stopDebugging(W)},addBreakpoints(W){return M.addBreakpoints(W)},removeBreakpoints(W){return M.removeBreakpoints(W)},asDebugSourceUri(W,X){return M.asDebugSourceUri(W,X)}},ct={registerTaskProvider:(W,X)=>A.registerTaskProvider(ke,W,X),fetchTasks:W=>A.fetchTasks(W),executeTask:W=>A.executeTask(ke,W),get taskExecutions(){return A.taskExecutions},onDidStartTask:(W,X,fe)=>J(A.onDidStartTask)(W,X,fe),onDidEndTask:(W,X,fe)=>J(A.onDidEndTask)(W,X,fe),onDidStartTaskProcess:(W,X,fe)=>J(A.onDidStartTaskProcess)(W,X,fe),onDidEndTaskProcess:(W,X,fe)=>J(A.onDidEndTaskProcess)(W,X,fe)},At={createNotebookController(W,X,fe,xt,Zt){return te.createNotebookController(ke,W,X,fe,xt,Oa(ke,"notebookMessaging")?Zt:void 0)},registerNotebookCellStatusBarItemProvider:(W,X)=>K.registerNotebookCellStatusBarItemProvider(ke,W,X),createRendererMessaging(W){return ie.createRendererMessaging(ke,W)},createNotebookControllerDetectionTask(W){return vt(ke,"notebookKernelSource"),te.createNotebookControllerDetectionTask(ke,W)},registerKernelSourceActionProvider(W,X){return vt(ke,"notebookKernelSource"),te.registerKernelSourceActionProvider(ke,W,X)},onDidChangeNotebookCellExecutionState(W,X,fe){return vt(ke,"notebookCellExecutionState"),J(te.onDidChangeNotebookCellExecutionState)(W,X,fe)}},$t={t(...W){if(typeof W[0]=="string"){const X=W.shift(),fe=!W||typeof W[0]!="object"?W:W[0];return L.getMessage(ke.identifier.value,{message:X,args:fe})}return L.getMessage(ke.identifier.value,W[0])},get bundle(){return L.getBundle(ke.identifier.value)},get uri(){return L.getBundleUri(ke.identifier.value)}},_n={_version:1,registerInteractiveEditorSessionProvider(W,X){return vt(ke,"interactive"),Pt.registerProvider(ke,W,X)},transferActiveChat(W){return vt(ke,"interactive"),on.transferActiveChat(W)}},jn={getRelatedInformation(W,X){return vt(ke,"aiRelatedInformation"),Rt.getRelatedInformation(ke,W,X)},registerRelatedInformationProvider(W,X){return vt(ke,"aiRelatedInformation"),Rt.registerRelatedInformationProvider(ke,W,X)},registerEmbeddingVectorProvider(W,X){return vt(ke,"aiRelatedInformation"),Xt.registerEmbeddingVectorProvider(ke,W,X)}},Zn={registerChatResponseProvider(W,X,fe){return vt(ke,"chatProvider"),w.registerLanguageModel(ke,W,X,fe)},registerChatVariableResolver(W,X,fe){return vt(ke,"chatVariableResolver"),an.registerVariableResolver(ke,W,X,fe)},registerMappedEditsProvider(W,X){return vt(ke,"mappedEditsProvider"),Y.registerMappedEditsProvider(ke,W,X)},createChatParticipant(W,X){return vt(ke,"chatParticipant"),on.createChatAgent(ke,W,X)},createDynamicChatParticipant(W,X,fe,xt){return vt(ke,"chatParticipantAdditions"),on.createDynamicChatAgent(ke,W,X,fe,xt)}},Z={get languageModels(){return vt(ke,"languageModels"),w.getLanguageModelIds()},onDidChangeLanguageModels:(W,X,fe)=>(vt(ke,"languageModels"),w.onDidChangeProviders(W,X,fe)),sendChatRequest(W,X,fe,xt){return vt(ke,"languageModels"),w.sendChatRequest(ke,W,X,fe,xt)},computeTokenLength(W,X,fe){return vt(ke,"languageModels"),fe??(fe=Xl.None),w.computeTokenLength(W,X,fe)},getLanguageModelInformation(W){return vt(ke,"languageModels"),w.getLanguageModelInfo(W)}},ve={registerSpeechProvider(W,X){return vt(ke,"speech"),bn.registerProvider(ke.identifier,W,X)}};return{version:e.version,ai:jn,authentication:it,commands:at,comments:qt,chat:Zn,debug:Ce,env:Lt,extensions:Ut,interactive:_n,l10n:$t,languages:sn,lm:Z,notebooks:At,scm:un,speech:ve,tasks:ct,tests:fn,window:ae,workspace:Wt,Breakpoint:CJe,TerminalOutputAnchor:xJe,ChatResultFeedbackKind:TW,ChatVariableLevel:EJe,ChatCompletionItem:IJe,CallHierarchyIncomingCall:PJe,CallHierarchyItem:sxe,CallHierarchyOutgoingCall:kJe,CancellationError:R2e,CancellationTokenSource:Uc,CandidatePortSource:TJe,CodeAction:Vxe,CodeActionKind:jee,CodeActionTriggerKind:DJe,CodeLens:zxe,Color:Lxe,ColorInformation:$xe,ColorPresentation:RJe,ColorThemeKind:Dw,CommentMode:AJe,CommentState:OJe,CommentThreadCollapsibleState:MW,CommentThreadState:$W,CommentThreadApplicability:LW,CompletionItem:MJe,CompletionItemKind:$Je,CompletionItemTag:LJe,CompletionList:RM,CompletionTriggerKind:NJe,ConfigurationTarget:o4,CustomExecution:dxe,DebugAdapterExecutable:Ixe,DebugAdapterInlineImplementation:kxe,DebugAdapterNamedPipeServer:Pxe,DebugAdapterServer:wW,DebugConfigurationProviderTriggerKind:wle,DebugConsoleMode:Cxe,DebugVisualization:FJe,DecorationRangeBehavior:jJe,Diagnostic:BJe,DiagnosticRelatedInformation:HJe,DiagnosticSeverity:eP,DiagnosticTag:UJe,Disposable:pi,DocumentHighlight:zJe,DocumentHighlightKind:VJe,MultiDocumentHighlight:WJe,DocumentLink:qJe,DocumentSymbol:oEe,EndOfLine:Mk,EnvironmentVariableMutatorType:a4,EvaluatableExpression:KJe,InlineValueText:GJe,InlineValueVariableLookup:ZJe,InlineValueEvaluatableExpression:XJe,InlineCompletionTriggerKind:BW,EventEmitter:ft,ExtensionKind:FP,ExtensionMode:c4,ExternalUriOpenerPriority:YJe,FileChangeType:u4,FileDecoration:vW,FileDecoration2:vW,FileSystemError:Pa,FileType:RP,FilePermission:gM,FoldingRange:JJe,FoldingRangeKind:QJe,FunctionBreakpoint:QI,InlineCompletionItem:eQe,InlineCompletionList:tQe,Hover:nQe,VerboseHover:rQe,HoverVerbosityAction:iQe,IndentAction:tP,Location:k2,MarkdownString:T2,OverviewRulerLane:oQe,ParameterInformation:sQe,PortAutoForwardAction:aQe,Position:Ah,ProcessExecution:Aee,ProgressLocation:Cle,QuickInputButtons:WW,Range:_s,RelativePattern:cQe,Selection:P2,SelectionRange:Mxe,SemanticTokens:DM,SemanticTokensBuilder:lQe,SemanticTokensEdit:aEe,SemanticTokensEdits:d4,SemanticTokensLegend:EW,ShellExecution:PM,ShellQuoting:uQe,SignatureHelp:dQe,SignatureHelpTriggerKind:hQe,SignatureInformation:fQe,SnippetString:cEe,SourceBreakpoint:JI,StandardTokenType:lEe,StatusBarAlignment:Uw,SymbolInformation:Hxe,SymbolKind:pQe,SymbolTag:gQe,Task:hxe,TaskGroup:SW,TaskPanelKind:mQe,TaskRevealKind:vQe,TaskScope:bW,TerminalLink:yQe,TerminalQuickFixTerminalCommand:bQe,TerminalQuickFixOpener:SQe,TerminalLocation:_Qe,TerminalProfile:wQe,TerminalExitReason:CQe,TerminalShellExecutionCommandLineConfidence:Dxe,TextDocumentSaveReason:xQe,TextEdit:nEe,SnippetTextEdit:EQe,TextEditorCursorStyle:IQe,TextEditorLineNumbersStyle:PQe,TextEditorRevealType:lxe,TextEditorSelectionChangeKind:vEe,SyntaxTokenType:iEe,TextDocumentChangeReason:NW,ThemeColor:qW,ThemeIcon:Q0,TreeItem:bEe,TreeItemCheckboxState:Rw,TreeItemCollapsibleState:SEe,TypeHierarchyItem:axe,UIKind:Ok,Uri:Te,ViewColumn:kQe,WorkspaceEdit:n7,DocumentPasteTriggerKind:TQe,DocumentDropEdit:DQe,DocumentDropOrPasteEditKind:sEe,DocumentPasteEdit:RQe,InlayHint:AQe,InlayHintLabelPart:OQe,InlayHintKind:MQe,RemoteAuthorityResolverError:Tw,ResolvedAuthority:$Qe,ManagedResolvedAuthority:l4,SourceControlInputBoxValidationType:LQe,ExtensionRuntime:wEe,TimelineItem:NQe,NotebookRange:e7,NotebookCellKind:FQe,NotebookCellExecutionState:pEe,NotebookCellData:hEe,NotebookData:jQe,NotebookRendererScript:BQe,NotebookCellStatusBarAlignment:HQe,NotebookEditorRevealType:dEe,NotebookCellOutput:UW,NotebookCellOutputItem:UQe,NotebookCellStatusBarItem:zQe,NotebookControllerAffinity:VQe,NotebookControllerAffinity2:fEe,NotebookEdit:WQe,NotebookKernelSourceAction:qQe,NotebookVariablesRequestKind:zW,PortAttributes:KQe,LinkedEditingRanges:GQe,TestResultState:ZQe,TestRunRequest:GW,TestRunRequest2:GW,TestMessage:XQe,TestTag:YQe,TestRunProfileKind:g4,TextSearchCompleteMessageType:JQe,DataTransfer:_Ee,DataTransferItem:QQe,TestCoverageCount:eet,FileCoverage:tet,StatementCoverage:net,BranchCoverage:ret,DeclarationCoverage:iet,WorkspaceTrustState:oet,LanguageStatusSeverity:h4,QuickPickItemKind:VW,InputBoxValidationSeverity:f4,TabInputText:Lee,TabInputTextDiff:kM,TabInputTextMerge:yxe,TabInputCustom:$ee,TabInputNotebook:Mee,TabInputNotebookDiff:Oee,TabInputWebview:vxe,TabInputTerminal:mxe,TabInputInteractiveWindow:gxe,TabInputChat:pxe,TabInputTextMultiDiff:fxe,TelemetryTrustedValue:cxe,LogLevel:ixe,EditSessionIdentityMatch:set,InteractiveSessionVoteDirection:aet,ChatCopyKind:cet,InteractiveEditorResponseFeedbackKind:uet,DebugStackFrame:Exe,DebugThread:xxe,RelatedInformationType:det,SpeechToTextStatus:het,PartialAcceptTriggerKind:fet,KeywordRecognitionStatus:pet,ChatResponseMarkdownPart:Zxe,ChatResponseFileTreePart:Xxe,ChatResponseAnchorPart:Yxe,ChatResponseProgressPart:MM,ChatResponseReferencePart:EC,ChatResponseTextEditPart:AW,ChatResponseMarkdownWithVulnerabilitiesPart:DW,ChatResponseCommandButtonPart:Jxe,ChatResponseDetectedParticipantPart:OW,ChatRequestTurn:qxe,ChatResponseTurn:Gxe,ChatLocation:get,LanguageModelChatSystemMessage:xle,LanguageModelChatUserMessage:Ele,LanguageModelChatAssistantMessage:Ile,LanguageModelSystemMessage:xle,LanguageModelUserMessage:Ele,LanguageModelAssistantMessage:Ile,LanguageModelError:YI,NewSymbolName:met,NewSymbolNameTag:vet,NewSymbolNameTriggerKind:FW,InlineEdit:yet,InlineEditTriggerKind:HW}}}var hM;let GQ=class{constructor(e,t,r,i,o,s,a){this._apiFactory=e,this._extensionRegistry=t,this._instaService=r,this._extHostConfiguration=i,this._extHostExtensionService=o,this._initData=s,this._logService=a,this._factories=new Map,this._alternatives=[]}async install(){this._installInterceptor(),Rc("code/extHost/willWaitForConfig");const e=await this._extHostConfiguration.getConfigProvider();Rc("code/extHost/didWaitForConfig");const t=await this._extHostExtensionService.getExtensionPathIndex();this.register(new Von(this._apiFactory,t,this._extensionRegistry,e,this._logService)),this.register(this._instaService.createInstance(ZQ)),this._initData.remote.isRemote&&this.register(this._instaService.createInstance(XQ,t,this._initData.environment.appUriScheme))}register(e){if("nodeModuleName"in e)if(Array.isArray(e.nodeModuleName))for(const t of e.nodeModuleName)this._factories.set(t,e);else this._factories.set(e.nodeModuleName,e);typeof e.alternativeModuleName=="function"&&this._alternatives.push(t=>e.alternativeModuleName(t))}};GQ=An([Be(2,Kx),Be(3,Ov),Be(4,rb),Be(5,Cl),Be(6,Li)],GQ);var Wx;let ZQ=(Wx=class{constructor(e){if(e.environment.appRoot&&hM.aliased.size){const t=aZe(this.forceForwardSlashes(e.environment.appRoot.fsPath)),r="[a-z0-9_.-]",i=`@${r}+\\/${r}+|${r}+`,o="node_modules|node_modules\\.asar(?:\\.unpacked)?";this.re=new RegExp(`^(${t}/${o}\\/)(${i})(.*)$`,"i")}}alternativeModuleName(e){if(!this.re)return;const t=this.re.exec(this.forceForwardSlashes(e));if(!t)return;const[,r,i,o]=t,s=hM.aliased.get(i);if(s!==void 0)return console.warn(`${i} as been renamed to ${s}, please update your imports`),r+s+o}forceForwardSlashes(e){return e.replace(/\\/g,"/")}},hM=Wx,Wx.aliased=new Map([["vscode-ripgrep","@vscode/ripgrep"],["vscode-windows-registry","@vscode/windows-registry"]]),Wx);ZQ=hM=An([Be(0,Cl)],ZQ);class Von{constructor(e,t,r,i,o){this._apiFactory=e,this._extensionPaths=t,this._extensionRegistry=r,this._configProvider=i,this._logService=o,this.nodeModuleName="vscode",this._extApiImpl=new jy}load(e,t){const r=this._extensionPaths.findSubstr(t);if(r){let i=this._extApiImpl.get(r.identifier);return i||(i=this._apiFactory(r,this._extensionRegistry,this._configProvider),this._extApiImpl.set(r.identifier,i)),i}if(!this._defaultApiImpl){let i="";this._extensionPaths.forEach((o,s)=>i+=`	${s} -> ${o.identifier.value}
`),this._logService.warn(`Could not identify extension for 'vscode' require call from ${t}. These are the extension path mappings: 
${i}`),this._defaultApiImpl=this._apiFactory(CEe,this._extensionRegistry,this._configProvider)}return this._defaultApiImpl}}let XQ=class{constructor(e,t,r){this._extensionPaths=e,this._appUriScheme=t,this.nodeModuleName=["open","opn"],this._mainThreadTelemetry=r.getProxy(dn.MainThreadTelemetry);const i=r.getProxy(dn.MainThreadWindow);this._impl=(o,s)=>{const a=Te.parse(o);return s?this.callOriginal(o,s):a.scheme==="http"||a.scheme==="https"?i.$openUri(a,o,{allowTunneling:!0}):a.scheme==="mailto"||a.scheme===this._appUriScheme?i.$openUri(a,o,{}):this.callOriginal(o,s)}}load(e,t,r){const i=this._extensionPaths.findSubstr(t);return i&&(this._extensionId=i.identifier.value,this.sendShimmingTelemetry()),this._original=r(e),this._impl}callOriginal(e,t){return this.sendNoForwardTelemetry(),this._original(e,t)}sendShimmingTelemetry(){this._extensionId&&this._mainThreadTelemetry.$publicLog2("shimming.open",{extension:this._extensionId})}sendNoForwardTelemetry(){this._extensionId&&this._mainThreadTelemetry.$publicLog2("shimming.open.call.noForward",{extension:this._extensionId})}};XQ=An([Be(2,Ii)],XQ);let YQ=class{constructor(e,t){this._mainThreadConsole=e.getProxy(dn.MainThreadConsole),this._includeStack=t.consoleForward.includeStack,this._logNative=t.consoleForward.logNative,this._wrapConsoleMethod("info","log"),this._wrapConsoleMethod("log","log"),this._wrapConsoleMethod("warn","warn"),this._wrapConsoleMethod("debug","debug"),this._wrapConsoleMethod("error","error")}_wrapConsoleMethod(e,t){const r=this,i=console[e];Object.defineProperty(console,e,{set:()=>{},get:()=>function(){r._handleConsoleCall(e,t,i,arguments)}})}_handleConsoleCall(e,t,r,i){this._mainThreadConsole.$logExtensionHostMessage({type:"__$console",severity:t,arguments:qon(i,this._includeStack)}),this._logNative&&this._nativeConsoleLogMessage(e,r,i)}};YQ=An([Be(0,Ii),Be(1,Cl)],YQ);const Won=1e5;function qon(n,e){const t=[];if(n.length)for(let r=0;r<n.length;r++){let i=n[r];if(typeof i>"u")i="undefined";else if(i instanceof Error){const o=i;o.stack?i=o.stack:i=o.toString()}t.push(i)}if(e){const r=new Error().stack;r&&t.push({__$stack:r.split(`
`).slice(3).join(`
`)})}try{const r=Cet(t);return r.length>Won?"Output omitted for a large object that exceeds the limits":r}catch(r){return`Output omitted for an object that cannot be inspected ('${r.toString()}')`}}let JQ=class extends YQ{constructor(e,t){super(e,t)}_nativeConsoleLogMessage(e,t,r){t.apply(console,r)}};JQ=An([Be(0,Ii),Be(1,Cl)],JQ);class Kon extends GQ{_installInterceptor(){}getModule(e,t){for(const r of this._alternatives){const i=r(e);if(i){e=i;break}}if(this._factories.has(e))return this._factories.get(e).load(e,t,()=>{throw new Error("CANNOT LOAD MODULE from here.")})}}class Gon extends sQ{constructor(){super(...arguments),this.extensionRuntime=wEe.Webworker}async _beforeAlmostReadyToRunExtensions(){_M&&this._instaService.createInstance(JQ),this._apiFactory=this._instaService.invokeFunction(zon),this._fakeModules=this._instaService.createInstance(Kon,this._apiFactory,{mine:this._myRegistry,all:this._globalRegistry}),await this._fakeModules.install(),performance.mark("code/extHost/didInitAPI"),await this._waitForDebuggerAttachment()}_getEntryPoint(e){return e.browser}async _loadCommonJSModule(e,t,r){t=t.with({path:Zon(t.path,".js")});const i=e==null?void 0:e.identifier.value;i&&performance.mark(`code/extHost/willFetchExtensionCode/${i}`);const o=Te.revive(await this._mainThreadExtensionsProxy.$asBrowserUri(t)),s=await fetch(o.toString(!0));if(i&&performance.mark(`code/extHost/didFetchExtensionCode/${i}`),s.status!==200)throw new Error(s.statusText);const a=await s.text(),c=`${t.toString(!0)}#vscode-extension`,l=`${a}
//# sourceURL=${c}`;let u;try{u=new Function("module","exports","require",l)}catch(p){throw console.error(i?`Loading code for extension ${i} failed: ${p.message}`:`Loading code failed: ${p.message}`),console.error(`${t.toString(!0)}${typeof p.line=="number"?` line ${p.line}`:""}${typeof p.column=="number"?` column ${p.column}`:""}`),console.error(p),p}e&&await this._extHostLocalizationService.initializeLocalizedMessages(e);const d={},h={exports:d},f=p=>{const g=this._fakeModules.getModule(p,t);if(g===void 0)throw new Error(`Cannot load module '${p}'`);return g};try{return r.codeLoadingStart(),i&&performance.mark(`code/extHost/willLoadExtensionCode/${i}`),u(h,d,f),h.exports!==d?h.exports:d}finally{i&&performance.mark(`code/extHost/didLoadExtensionCode/${i}`),r.codeLoadingStop()}}async $setRemoteEnvironment(e){}async _waitForDebuggerAttachment(e=5e3){if(!this._initData.environment.isExtensionDevelopmentDebug)return;const t=Date.now()+e;for(;Date.now()<t&&!("__jsDebugIsReady"in globalThis);)await NP(10)}}function Zon(n,e){return n.endsWith(e)?n:n+e}const _He=new Nee;class Xon extends Gon{constructor(){super(...arguments),this._extApiImpl=new jy}async getApi(e){const[t,r]=await Promise.all([this.getExtensionRegistry(),this._extHostConfiguration.getConfigProvider()]),i={mine:t,all:this._globalRegistry};if(e==null)return this._defaultApiImpl==null&&(this._defaultApiImpl=this._apiFactory(CEe,i,r)),this._defaultApiImpl;const o=t.getExtensionDescription(e);if(o==null)throw new Error(`Extension ${e} does not exist or is disabled`);let s=this._extApiImpl.get(o.identifier);return s==null&&(s=this._apiFactory(o,i,r),this._extApiImpl.set(o.identifier,s)),s}}mo(rb,Xon,0);mo(Ese,QJ,0);function Yon(){const n=new Ple,e=new Ple;class t{constructor(i,o){this.emitterIn=i,this.emitterOut=o,this.onMessage=this.emitterIn.event}send(i){this.emitterOut.fire(i)}}return[new t(n,e),new t(e,n)]}const Jon=new class{constructor(){this.pid=void 0,this.exit=Tet}async exists(n){return!0}async realpath(n){return n}};let QQ=class{constructor(e,t,r,i,o,s,a,c,l,u,d){this.runningLocation=e,this.startup=t,this._initDataProvider=r,this._telemetryService=i,this._contextService=o,this._labelService=s,this._logService=a,this._loggerService=c,this._environmentService=l,this._productService=u,this._userDataProfilesService=d,this.remoteAuthority=null,this.extensions=null,this.pid=null,this.onExit=ns.None,this._protocolPromise=null,this._extensionHostLogsLocation=jh(this._environmentService.extHostLogsPath,"local")}async start(){return this._protocolPromise==null&&(this._protocolPromise=this._start()),this._protocolPromise}async _start(){const[e,t]=Yon(),r=await this._createExtHostInitData(),o=new Ase(t,r,Jon,null).getExtHostExtensionService();return await _He.complete(s=>o.getApi(s)),e}async _createExtHostInitData(){var o;const e=await this._initDataProvider.getInitData();this.extensions=e.extensions;const t=this._contextService.getWorkspace(),r=(o=this._productService.extensionsGallery)==null?void 0:o.nlsBaseUrl;let i;return r!=null&&this._productService.commit!=null&&!Wce.isDefaultVariant()&&(i=Te.joinPath(Te.parse(r),this._productService.commit,this._productService.version,Wce.value())),{commit:this._productService.commit,version:this._productService.version,quality:this._productService.quality,parentPid:0,environment:{isExtensionDevelopmentDebug:this._environmentService.debugRenderer,appName:this._productService.nameLong,appHost:this._productService.embedderIdentifier??(qce?"web":"desktop"),appUriScheme:this._productService.urlProtocol,appLanguage:cZe,extensionTelemetryLogResource:this._environmentService.extHostTelemetryLogFile,isExtensionTelemetryLoggingOnly:xet(this._productService,this._environmentService),extensionDevelopmentLocationURI:this._environmentService.extensionDevelopmentLocationURI,extensionTestsLocationURI:this._environmentService.extensionTestsLocationURI,globalStorageHome:this._userDataProfilesService.defaultProfile.globalStorageHome,workspaceStorageHome:this._environmentService.workspaceStorageHome,extensionLogLevel:this._environmentService.extensionLogLevel},workspace:this._contextService.getWorkbenchState()===1?void 0:{configuration:t.configuration??void 0,id:t.id,name:this._labelService.getWorkspaceLabel(t),transient:t.transient},consoleForward:{includeStack:!1,logNative:this._environmentService.debugRenderer},extensions:e.extensions.toSnapshot(),nlsBaseUrl:i,telemetryInfo:{sessionId:this._telemetryService.sessionId,machineId:this._telemetryService.machineId,firstSessionDate:this._telemetryService.firstSessionDate,msftInternal:this._telemetryService.msftInternal,sqmId:this._telemetryService.sqmId},logLevel:this._logService.getLevel(),loggers:[...this._loggerService.getRegisteredLoggers()],logsLocation:this._extensionHostLogsLocation,autoStart:this.startup===1,remote:{authority:this._environmentService.remoteAuthority,connectionData:null,isRemote:!1},uiKind:qce?Ok.Web:Ok.Desktop}}getInspectPort(){}enableInspectPort(){return Promise.resolve(!1)}dispose(){}};QQ=An([Be(3,Eet),Be(4,kg),Be(5,Pee),Be(6,Li),Be(7,s_),Be(8,Iet),Be(9,Pet),Be(10,Gx)],QQ);async function wHe(n){return(await _He.p)(n)}ket(QQ);Det(wHe);Ret(async n=>{n.get(JL),Aet(await wHe())});class Qon{constructor(){this._provider=new Oet,this.onDidChange=this._provider.onDidChange}addStatus(e){return this._provider.register(e.selector,e)}getLanguageStatus(e){return this._provider.ordered(e).sort((t,r)=>{let i=r.severity-t.severity;return i===0&&(i=x2(t.source,r.source)),i===0&&(i=x2(t.id,r.id)),i})}}var eee;const On="vs/workbench/contrib/codeEditor/common/languageConfigurationExtensionPoint";function CHe(n){if(!Array.isArray(n))return!1;for(let e=0,t=n.length;e<t;e++)if(typeof n[e]!="string")return!1;return!0}function ZI(n){return CHe(n)&&n.length===2}let tee=eee=class extends Dr{constructor(e,t,r,i){super(),this._languageService=e,this._extensionResourceLoaderService=t,this._extensionService=r,this._languageConfigurationService=i,this._done=new Map,this._register(this._languageService.onDidRequestBasicLanguageFeatures(async o=>{this._extensionService.whenInstalledExtensionsRegistered().then(()=>{this._loadConfigurationsForMode(o)})})),this._register(this._languageService.onDidChange(()=>{for(const[o]of this._done)this._loadConfigurationsForMode(o)}))}async _loadConfigurationsForMode(e){const t=this._languageService.getConfigurationFiles(e),r=YL(t.map(o=>o.toString()));if(this._done.get(e)===r)return;this._done.set(e,r);const i=await Promise.all(t.map(o=>this._readConfigFile(o)));for(const o of i)this._handleConfig(e,o)}async _readConfigFile(e){try{const t=await this._extensionResourceLoaderService.readExtensionResource(e),r=[];let i=wee(t,r);return r.length&&console.error(Ve(On,0,"Errors parsing {0}: {1}",e.toString(),r.map(o=>`[${o.offset}, ${o.length}] ${Met(o.error)}`).join(`
`))),$et(i)!=="object"&&(console.error(Ve(On,1,"{0}: Invalid format, JSON object expected.",e.toString())),i={}),i}catch(t){return console.error(t),{}}}static _extractValidCommentRule(e,t){const r=t.comments;if(typeof r>"u")return;if(!xd(r)){console.warn(`[${e}]: language configuration: expected \`comments\` to be an object.`);return}let i;return typeof r.lineComment<"u"&&(typeof r.lineComment!="string"?console.warn(`[${e}]: language configuration: expected \`comments.lineComment\` to be a string.`):(i=i||{},i.lineComment=r.lineComment)),typeof r.blockComment<"u"&&(ZI(r.blockComment)?(i=i||{},i.blockComment=r.blockComment):console.warn(`[${e}]: language configuration: expected \`comments.blockComment\` to be an array of two strings.`)),i}static _extractValidBrackets(e,t){const r=t.brackets;if(typeof r>"u")return;if(!Array.isArray(r)){console.warn(`[${e}]: language configuration: expected \`brackets\` to be an array.`);return}let i;for(let o=0,s=r.length;o<s;o++){const a=r[o];if(!ZI(a)){console.warn(`[${e}]: language configuration: expected \`brackets[${o}]\` to be an array of two strings.`);continue}i=i||[],i.push(a)}return i}static _extractValidAutoClosingPairs(e,t){const r=t.autoClosingPairs;if(typeof r>"u")return;if(!Array.isArray(r)){console.warn(`[${e}]: language configuration: expected \`autoClosingPairs\` to be an array.`);return}let i;for(let o=0,s=r.length;o<s;o++){const a=r[o];if(Array.isArray(a)){if(!ZI(a)){console.warn(`[${e}]: language configuration: expected \`autoClosingPairs[${o}]\` to be an array of two strings or an object.`);continue}i=i||[],i.push({open:a[0],close:a[1]})}else{if(!xd(a)){console.warn(`[${e}]: language configuration: expected \`autoClosingPairs[${o}]\` to be an array of two strings or an object.`);continue}if(typeof a.open!="string"){console.warn(`[${e}]: language configuration: expected \`autoClosingPairs[${o}].open\` to be a string.`);continue}if(typeof a.close!="string"){console.warn(`[${e}]: language configuration: expected \`autoClosingPairs[${o}].close\` to be a string.`);continue}if(typeof a.notIn<"u"&&!CHe(a.notIn)){console.warn(`[${e}]: language configuration: expected \`autoClosingPairs[${o}].notIn\` to be a string array.`);continue}i=i||[],i.push({open:a.open,close:a.close,notIn:a.notIn})}}return i}static _extractValidSurroundingPairs(e,t){const r=t.surroundingPairs;if(typeof r>"u")return;if(!Array.isArray(r)){console.warn(`[${e}]: language configuration: expected \`surroundingPairs\` to be an array.`);return}let i;for(let o=0,s=r.length;o<s;o++){const a=r[o];if(Array.isArray(a)){if(!ZI(a)){console.warn(`[${e}]: language configuration: expected \`surroundingPairs[${o}]\` to be an array of two strings or an object.`);continue}i=i||[],i.push({open:a[0],close:a[1]})}else{if(!xd(a)){console.warn(`[${e}]: language configuration: expected \`surroundingPairs[${o}]\` to be an array of two strings or an object.`);continue}if(typeof a.open!="string"){console.warn(`[${e}]: language configuration: expected \`surroundingPairs[${o}].open\` to be a string.`);continue}if(typeof a.close!="string"){console.warn(`[${e}]: language configuration: expected \`surroundingPairs[${o}].close\` to be a string.`);continue}i=i||[],i.push({open:a.open,close:a.close})}}return i}static _extractValidColorizedBracketPairs(e,t){const r=t.colorizedBracketPairs;if(typeof r>"u")return;if(!Array.isArray(r)){console.warn(`[${e}]: language configuration: expected \`colorizedBracketPairs\` to be an array.`);return}const i=[];for(let o=0,s=r.length;o<s;o++){const a=r[o];if(!ZI(a)){console.warn(`[${e}]: language configuration: expected \`colorizedBracketPairs[${o}]\` to be an array of two strings.`);continue}i.push([a[0],a[1]])}return i}static _extractValidOnEnterRules(e,t){const r=t.onEnterRules;if(typeof r>"u")return;if(!Array.isArray(r)){console.warn(`[${e}]: language configuration: expected \`onEnterRules\` to be an array.`);return}let i;for(let o=0,s=r.length;o<s;o++){const a=r[o];if(!xd(a)){console.warn(`[${e}]: language configuration: expected \`onEnterRules[${o}]\` to be an object.`);continue}if(!xd(a.action)){console.warn(`[${e}]: language configuration: expected \`onEnterRules[${o}].action\` to be an object.`);continue}let c;if(a.action.indent==="none")c=tP.None;else if(a.action.indent==="indent")c=tP.Indent;else if(a.action.indent==="indentOutdent")c=tP.IndentOutdent;else if(a.action.indent==="outdent")c=tP.Outdent;else{console.warn(`[${e}]: language configuration: expected \`onEnterRules[${o}].action.indent\` to be 'none', 'indent', 'indentOutdent' or 'outdent'.`);continue}const l={indentAction:c};a.action.appendText&&(typeof a.action.appendText=="string"?l.appendText=a.action.appendText:console.warn(`[${e}]: language configuration: expected \`onEnterRules[${o}].action.appendText\` to be undefined or a string.`)),a.action.removeText&&(typeof a.action.removeText=="number"?l.removeText=a.action.removeText:console.warn(`[${e}]: language configuration: expected \`onEnterRules[${o}].action.removeText\` to be undefined or a number.`));const u=this._parseRegex(e,`onEnterRules[${o}].beforeText`,a.beforeText);if(!u)continue;const d={beforeText:u,action:l};if(a.afterText){const h=this._parseRegex(e,`onEnterRules[${o}].afterText`,a.afterText);h&&(d.afterText=h)}if(a.previousLineText){const h=this._parseRegex(e,`onEnterRules[${o}].previousLineText`,a.previousLineText);h&&(d.previousLineText=h)}i=i||[],i.push(d)}return i}static extractValidConfig(e,t){const r=this._extractValidCommentRule(e,t),i=this._extractValidBrackets(e,t),o=this._extractValidAutoClosingPairs(e,t),s=this._extractValidSurroundingPairs(e,t),a=this._extractValidColorizedBracketPairs(e,t),c=typeof t.autoCloseBefore=="string"?t.autoCloseBefore:void 0,l=t.wordPattern?this._parseRegex(e,"wordPattern",t.wordPattern):void 0,u=t.indentationRules?this._mapIndentationRules(e,t.indentationRules):void 0;let d;if(t.folding){const p=t.folding.markers,g=p&&p.start?this._parseRegex(e,"folding.markers.start",p.start):void 0,m=p&&p.end?this._parseRegex(e,"folding.markers.end",p.end):void 0,v=g&&m?{start:g,end:m}:void 0;d={offSide:t.folding.offSide,markers:v}}const h=this._extractValidOnEnterRules(e,t);return{comments:r,brackets:i,wordPattern:l,indentationRules:u,onEnterRules:h,autoClosingPairs:o,surroundingPairs:s,colorizedBracketPairs:a,autoCloseBefore:c,folding:d,__electricCharacterSupport:void 0}}_handleConfig(e,t){const r=eee.extractValidConfig(e,t);this._languageConfigurationService.register(e,r,50)}static _parseRegex(e,t,r){if(typeof r=="string")try{return new RegExp(r,"")}catch(i){console.warn(`[${e}]: Invalid regular expression in \`${t}\`: `,i);return}if(xd(r)){if(typeof r.pattern!="string"){console.warn(`[${e}]: language configuration: expected \`${t}.pattern\` to be a string.`);return}if(typeof r.flags<"u"&&typeof r.flags!="string"){console.warn(`[${e}]: language configuration: expected \`${t}.flags\` to be a string.`);return}try{return new RegExp(r.pattern,r.flags)}catch(i){console.warn(`[${e}]: Invalid regular expression in \`${t}\`: `,i);return}}console.warn(`[${e}]: language configuration: expected \`${t}\` to be a string or an object.`)}static _mapIndentationRules(e,t){const r=this._parseRegex(e,"indentationRules.increaseIndentPattern",t.increaseIndentPattern);if(!r)return;const i=this._parseRegex(e,"indentationRules.decreaseIndentPattern",t.decreaseIndentPattern);if(!i)return;const o={increaseIndentPattern:r,decreaseIndentPattern:i};return t.indentNextLinePattern&&(o.indentNextLinePattern=this._parseRegex(e,"indentationRules.indentNextLinePattern",t.indentNextLinePattern)),t.unIndentedLinePattern&&(o.unIndentedLinePattern=this._parseRegex(e,"indentationRules.unIndentedLinePattern",t.unIndentedLinePattern)),o}};tee=eee=An([Be(0,mee),Be(1,Let),Be(2,JL),Be(3,Net)],tee);const esn="vscode://schemas/language-configuration",tsn={allowComments:!0,allowTrailingCommas:!0,default:{comments:{blockComment:["/*","*/"],lineComment:"//"},brackets:[["(",")"],["[","]"],["{","}"]],autoClosingPairs:[["(",")"],["[","]"],["{","}"]],surroundingPairs:[["(",")"],["[","]"],["{","}"]]},definitions:{openBracket:{type:"string",description:Ve(On,2,"The opening bracket character or string sequence.")},closeBracket:{type:"string",description:Ve(On,3,"The closing bracket character or string sequence.")},bracketPair:{type:"array",items:[{$ref:"#/definitions/openBracket"},{$ref:"#/definitions/closeBracket"}]}},properties:{comments:{default:{blockComment:["/*","*/"],lineComment:"//"},description:Ve(On,4,"Defines the comment symbols"),type:"object",properties:{blockComment:{type:"array",description:Ve(On,5,"Defines how block comments are marked."),items:[{type:"string",description:Ve(On,6,"The character sequence that starts a block comment.")},{type:"string",description:Ve(On,7,"The character sequence that ends a block comment.")}]},lineComment:{type:"string",description:Ve(On,8,"The character sequence that starts a line comment.")}}},brackets:{default:[["(",")"],["[","]"],["{","}"]],markdownDescription:Ve(On,9,"Defines the bracket symbols that increase or decrease the indentation. When bracket pair colorization is enabled and {0} is not defined, this also defines the bracket pairs that are colorized by their nesting level.","`colorizedBracketPairs`"),type:"array",items:{$ref:"#/definitions/bracketPair"}},colorizedBracketPairs:{default:[["(",")"],["[","]"],["{","}"]],markdownDescription:Ve(On,10,"Defines the bracket pairs that are colorized by their nesting level if bracket pair colorization is enabled. Any brackets included here that are not included in {0} will be automatically included in {0}.","`brackets`"),type:"array",items:{$ref:"#/definitions/bracketPair"}},autoClosingPairs:{default:[["(",")"],["[","]"],["{","}"]],description:Ve(On,11,"Defines the bracket pairs. When a opening bracket is entered, the closing bracket is inserted automatically."),type:"array",items:{oneOf:[{$ref:"#/definitions/bracketPair"},{type:"object",properties:{open:{$ref:"#/definitions/openBracket"},close:{$ref:"#/definitions/closeBracket"},notIn:{type:"array",description:Ve(On,12,"Defines a list of scopes where the auto pairs are disabled."),items:{enum:["string","comment"]}}}}]}},autoCloseBefore:{default:`;:.,=}])> 
	`,description:Ve(On,13,"Defines what characters must be after the cursor in order for bracket or quote autoclosing to occur when using the 'languageDefined' autoclosing setting. This is typically the set of characters which can not start an expression."),type:"string"},surroundingPairs:{default:[["(",")"],["[","]"],["{","}"]],description:Ve(On,14,"Defines the bracket pairs that can be used to surround a selected string."),type:"array",items:{oneOf:[{$ref:"#/definitions/bracketPair"},{type:"object",properties:{open:{$ref:"#/definitions/openBracket"},close:{$ref:"#/definitions/closeBracket"}}}]}},wordPattern:{default:"",description:Ve(On,15,"Defines what is considered to be a word in the programming language."),type:["string","object"],properties:{pattern:{type:"string",description:Ve(On,16,"The RegExp pattern used to match words."),default:""},flags:{type:"string",description:Ve(On,17,"The RegExp flags used to match words."),default:"g",pattern:"^([gimuy]+)$",patternErrorMessage:Ve(On,18,"Must match the pattern `/^([gimuy]+)$/`.")}}},indentationRules:{default:{increaseIndentPattern:"",decreaseIndentPattern:""},description:Ve(On,19,"The language's indentation settings."),type:"object",properties:{increaseIndentPattern:{type:["string","object"],description:Ve(On,20,"If a line matches this pattern, then all the lines after it should be indented once (until another rule matches)."),properties:{pattern:{type:"string",description:Ve(On,21,"The RegExp pattern for increaseIndentPattern."),default:""},flags:{type:"string",description:Ve(On,22,"The RegExp flags for increaseIndentPattern."),default:"",pattern:"^([gimuy]+)$",patternErrorMessage:Ve(On,23,"Must match the pattern `/^([gimuy]+)$/`.")}}},decreaseIndentPattern:{type:["string","object"],description:Ve(On,24,"If a line matches this pattern, then all the lines after it should be unindented once (until another rule matches)."),properties:{pattern:{type:"string",description:Ve(On,25,"The RegExp pattern for decreaseIndentPattern."),default:""},flags:{type:"string",description:Ve(On,26,"The RegExp flags for decreaseIndentPattern."),default:"",pattern:"^([gimuy]+)$",patternErrorMessage:Ve(On,27,"Must match the pattern `/^([gimuy]+)$/`.")}}},indentNextLinePattern:{type:["string","object"],description:Ve(On,28,"If a line matches this pattern, then **only the next line** after it should be indented once."),properties:{pattern:{type:"string",description:Ve(On,29,"The RegExp pattern for indentNextLinePattern."),default:""},flags:{type:"string",description:Ve(On,30,"The RegExp flags for indentNextLinePattern."),default:"",pattern:"^([gimuy]+)$",patternErrorMessage:Ve(On,31,"Must match the pattern `/^([gimuy]+)$/`.")}}},unIndentedLinePattern:{type:["string","object"],description:Ve(On,32,"If a line matches this pattern, then its indentation should not be changed and it should not be evaluated against the other rules."),properties:{pattern:{type:"string",description:Ve(On,33,"The RegExp pattern for unIndentedLinePattern."),default:""},flags:{type:"string",description:Ve(On,34,"The RegExp flags for unIndentedLinePattern."),default:"",pattern:"^([gimuy]+)$",patternErrorMessage:Ve(On,35,"Must match the pattern `/^([gimuy]+)$/`.")}}}}},folding:{type:"object",description:Ve(On,36,"The language's folding settings."),properties:{offSide:{type:"boolean",description:Ve(On,37,"A language adheres to the off-side rule if blocks in that language are expressed by their indentation. If set, empty lines belong to the subsequent block.")},markers:{type:"object",description:Ve(On,38,"Language specific folding markers such as '#region' and '#endregion'. The start and end regexes will be tested against the contents of all lines and must be designed efficiently"),properties:{start:{type:"string",description:Ve(On,39,"The RegExp pattern for the start marker. The regexp must start with '^'.")},end:{type:"string",description:Ve(On,40,"The RegExp pattern for the end marker. The regexp must start with '^'.")}}}}},onEnterRules:{type:"array",description:Ve(On,41,"The language's rules to be evaluated when pressing Enter."),items:{type:"object",description:Ve(On,41,"The language's rules to be evaluated when pressing Enter."),required:["beforeText","action"],properties:{beforeText:{type:["string","object"],description:Ve(On,42,"This rule will only execute if the text before the cursor matches this regular expression."),properties:{pattern:{type:"string",description:Ve(On,43,"The RegExp pattern for beforeText."),default:""},flags:{type:"string",description:Ve(On,44,"The RegExp flags for beforeText."),default:"",pattern:"^([gimuy]+)$",patternErrorMessage:Ve(On,45,"Must match the pattern `/^([gimuy]+)$/`.")}}},afterText:{type:["string","object"],description:Ve(On,46,"This rule will only execute if the text after the cursor matches this regular expression."),properties:{pattern:{type:"string",description:Ve(On,47,"The RegExp pattern for afterText."),default:""},flags:{type:"string",description:Ve(On,48,"The RegExp flags for afterText."),default:"",pattern:"^([gimuy]+)$",patternErrorMessage:Ve(On,49,"Must match the pattern `/^([gimuy]+)$/`.")}}},previousLineText:{type:["string","object"],description:Ve(On,50,"This rule will only execute if the text above the line matches this regular expression."),properties:{pattern:{type:"string",description:Ve(On,51,"The RegExp pattern for previousLineText."),default:""},flags:{type:"string",description:Ve(On,52,"The RegExp flags for previousLineText."),default:"",pattern:"^([gimuy]+)$",patternErrorMessage:Ve(On,53,"Must match the pattern `/^([gimuy]+)$/`.")}}},action:{type:["string","object"],description:Ve(On,54,"The action to execute."),required:["indent"],default:{indent:"indent"},properties:{indent:{type:"string",description:Ve(On,55,"Describe what to do with the indentation"),default:"indent",enum:["none","indent","indentOutdent","outdent"],markdownEnumDescriptions:[Ve(On,56,"Insert new line and copy the previous line's indentation."),Ve(On,57,"Insert new line and indent once (relative to the previous line's indentation)."),Ve(On,58,`Insert two new lines:
 - the first one indented which will hold the cursor
 - the second one at the same indentation level`),Ve(On,59,"Insert new line and outdent once (relative to the previous line's indentation).")]},appendText:{type:"string",description:Ve(On,60,"Describes text to be appended after the new line and after the indentation."),default:""},removeText:{type:"number",description:Ve(On,61,"Describes the number of characters to remove from the new line's indentation."),default:0}}}}}}}},nsn=Gc.as(vee.JSONContribution);nsn.registerSchema(esn,tsn);var BT;let gL=(BT=class{constructor(e){this.instantiationService=e,this.instantiationService.createInstance(tee)}},BT.ID="workbench.contrib.languageConfigurationExtensionPoint",BT);gL=An([Be(0,Kx)],gL);q2e(gL.ID,gL,1);function rsn(){return{...exe(),[mee.toString()]:new wd(Fet,[],!1),[jet.toString()]:new wd(Qon,[],!0)}}let nee=class extends Dr{constructor(e,t,r){super(),this._modelService=e,this._textModelService=t,this._undoRedoService=r,this._register(this._modelService.onModelRemoved(i=>{const o=this._undoRedoService.getElements(i.uri);if(!(o.past.length===0&&o.future.length===0)){for(const s of o.past)s instanceof kle&&s.setDelegate(this);for(const s of o.future)s instanceof kle&&s.setDelegate(this)}}))}prepareUndoRedo(e){const t=e.getMissingModels();if(t.length===0)return Dr.None;const r=t.map(async i=>{try{return await this._textModelService.createModelReference(i)}catch{return Dr.None}});return Promise.all(r).then(i=>({dispose:()=>_S(i)}))}};nee=An([Be(0,GL),Be(1,Eee),Be(2,xEe)],nee);let ree=class extends lZe{constructor(e,t,r,i){super(),this.instantiationService=e,this.textFileService=t,this.fileService=r,this.modelService=i,this.providers=new Map,this.modelsToDispose=new Set}createReferencedObject(e){return this.doCreateReferencedObject(e)}async doCreateReferencedObject(e,t){this.modelsToDispose.delete(e);const r=Te.parse(e);if(r.scheme===hr.inMemory){if(!this.modelService.getModel(r))throw new Error(`Unable to resolve inMemory resource ${e}`);const o=this.instantiationService.createInstance(Tle,r);if(this.ensureResolvedModel(o,e))return o}if(r.scheme===hr.untitled){const i=await this.textFileService.untitled.resolve({untitledResource:r});if(this.ensureResolvedModel(i,e))return i}if(this.fileService.hasProvider(r)){const i=await this.textFileService.files.resolve(r,{reason:2});if(this.ensureResolvedModel(i,e))return i}if(this.providers.has(r.scheme)){await this.resolveTextModelContent(e);const i=this.instantiationService.createInstance(Tle,r);if(this.ensureResolvedModel(i,e))return i}if(!t)return await this.fileService.activateProvider(r.scheme),this.doCreateReferencedObject(e,!0);throw new Error(`Unable to resolve resource ${e}`)}ensureResolvedModel(e,t){if(Bet(e))return!0;throw new Error(`Unable to resolve resource ${t}`)}destroyReferencedObject(e,t){Te.parse(e).scheme!==hr.inMemory&&(this.modelsToDispose.add(e),(async()=>{try{const i=await t;if(!this.modelsToDispose.has(e)||(i instanceof Het?await this.textFileService.files.canDispose(i):i instanceof Uet&&await this.textFileService.untitled.canDispose(i),!this.modelsToDispose.has(e)))return;i.dispose()}catch{}finally{this.modelsToDispose.delete(e)}})())}registerTextModelContentProvider(e,t){let r=this.providers.get(e);return r||(r=[],this.providers.set(e,r)),r.unshift(t),ho(()=>{const i=this.providers.get(e);if(!i)return;const o=i.indexOf(t);o!==-1&&(i.splice(o,1),i.length===0&&this.providers.delete(e))})}hasTextModelContentProvider(e){return this.providers.get(e)!==void 0}async resolveTextModelContent(e){const t=Te.parse(e),r=this.providers.get(t.scheme)||[];for(const i of r){const o=await i.provideTextContent(t);if(o)return o}throw new Error(`Unable to resolve text model content for resource ${e}`)}};ree=An([Be(0,Kx),Be(1,Iee),Be(2,Tg),Be(3,GL)],ree);let iee=class extends Dr{get resourceModelCollection(){return this._resourceModelCollection||(this._resourceModelCollection=this.instantiationService.createInstance(ree)),this._resourceModelCollection}get asyncModelCollection(){return this._asyncModelCollection||(this._asyncModelCollection=new uZe(this.resourceModelCollection)),this._asyncModelCollection}constructor(e,t,r,i,o){super(),this.instantiationService=e,this.fileService=t,this.undoRedoService=r,this.modelService=i,this.uriIdentityService=o,this._resourceModelCollection=void 0,this._asyncModelCollection=void 0,this._register(new nee(this.modelService,this,this.undoRedoService))}async createModelReference(e){return e=this.uriIdentityService.asCanonicalUri(e),await this.asyncModelCollection.acquire(e.toString())}registerTextModelContentProvider(e,t){return this.resourceModelCollection.registerTextModelContentProvider(e,t)}canHandleResource(e){return this.fileService.hasProvider(e)||e.scheme===hr.untitled||e.scheme===hr.inMemory?!0:this.resourceModelCollection.hasTextModelContentProvider(e.scheme)}};iee=An([Be(0,Kx),Be(1,Tg),Be(2,xEe),Be(3,GL),Be(4,WT)],iee);function isn(){return{[Eee.toString()]:new wd(iee,void 0,!0)}}class osn{constructor(e,t){$(this,"url");$(this,"options");this.url=e,this.options=t}}class xHe{constructor(e){$(this,"enabled");$(this,"debugEnabled");this.updateConfig(e)}updateConfig(e){this.enabled=e?e.enabled===!0:!0,this.debugEnabled=this.enabled&&(e==null?void 0:e.debugEnabled)===!0}isEnabled(){return this.enabled}isDebugEnabled(){return this.debugEnabled}info(e){this.enabled&&console.log(e)}debug(e,t){this.enabled&&(this.debugEnabled||t===!0)&&console.debug(e)}}const EHe=()=>{const n=self;n.MonacoEnvironment||(n.MonacoEnvironment={});const e=n.MonacoEnvironment;return e.vscodeApiInitialised===void 0&&(e.vscodeApiInitialised=!1),e.vscodeInitialising===void 0&&(e.vscodeInitialising=!1),e},ssn=async()=>({...rsn(),...isn()}),asn=(n,e)=>{for(const t of Object.keys(n))e==null||e.debug(`Loading service: ${t}`)},mL=(n,e)=>{for(const[t,r]of Object.entries(n))e[t]=r},csn=async n=>{var t,r,i,o;const e=EHe();((t=n.serviceConfig)==null?void 0:t.debugLogging)===!0&&!n.logger&&(n.logger=new xHe({enabled:!0,debugEnabled:!0})),e.vscodeInitialising||(e.vscodeApiInitialised?(r=n.logger)==null||r.debug("Initialization of vscode services can only performed once!"):(e.vscodeInitialising=!0,(i=n.logger)==null||i.debug(`Initializing vscode services. Caller: ${n.caller??"unknown"}`),await lsn(n),(o=n.logger)==null||o.debug("Initialization of vscode services completed successfully."),e.vscodeApiInitialised=!0))},lsn=async n=>{var i,o,s;const e=n.serviceConfig??{},t=e.userServices??{},r=await ssn();if(mL(r,t),await usn(((i=n.serviceConfig)==null?void 0:i.enableExtHostWorker)===!0,t),asn(t,n.logger),n.performChecks===void 0||n.performChecks()){await zet(t);const a=(s=(o=e.workspaceConfig)==null?void 0:o.developmentOptions)==null?void 0:s.logLevel;a&&Vet.get(Li).setLevel(a)}},usn=async(n,e)=>{if(n){const t=new osn(new URL(""+new URL("../workers/extensionHost.worker-B_tGA6q2.js",import.meta.url).href,import.meta.url),{type:"module"}),r={url:t.url.toString(),options:t.options},i={...Wet(r)};mL(i,e)}},dsn=async n=>{var i,o;const e=n.serviceConfig??{};e.debugLogging=((i=n.logger)==null?void 0:i.isEnabled())===!0&&(e.debugLogging===!0||((o=n.logger)==null?void 0:o.isDebugEnabled())===!0),e.userServices=e.userServices??{};const t=e.userServices.configurationService??void 0,r=e.workspaceConfig??void 0;if(!t){const s={...rJt()};if(mL(s,e.userServices),r)throw new Error("You provided a workspaceConfig without using the configurationServiceOverride")}return r||(e.workspaceConfig={workspaceProvider:{trusted:!0,workspace:{workspaceUri:Rk.file("/workspace")},async open(){return!1}}}),mL(n.specificServices??{},e.userServices),e},hsn=n=>{const e=Object.keys(n??{}).includes("themeService"),t=Object.keys(n??{}).includes("textMateTokenizationFeature"),r=Object.keys(n??{}).includes("markersService"),i=Object.keys(n??{}).includes("viewsService");if(e&&!t)throw new Error('"theme" service requires "textmate" service. Please add it to the "userServices".');if(r&&!i)throw new Error('"markers" service requires "views" service. Please add it to the "userServices".');return!0};class fsn{constructor(){$(this,"id");$(this,"editorApp");$(this,"languageClientWrapper");$(this,"logger",new xHe);$(this,"initDone",!1)}async init(e){var o,s;if(this.initDone)throw new Error("init was already performed. Please call dispose first if you want to re-start.");const t=e.wrapperConfig.editorAppConfig;if(t.useDiffEditor&&!t.codeResources.original)throw new Error(`Use diff editor was used without a valid config. code: ${t.codeResources.main} codeOriginal: ${t.codeResources.original}`);(o=this.editorApp)==null||o.disposeApp(),this.id=e.id??Math.floor(Math.random()*101).toString(),this.logger.updateConfig(e.loggerConfig),t.$type==="classic"?this.editorApp=new cJt(this.id,e,this.logger):this.editorApp=new lJt(this.id,e,this.logger);const r=await((s=this.editorApp)==null?void 0:s.specifyServices()),i=await dsn({serviceConfig:e.wrapperConfig.serviceConfig,specificServices:r,logger:this.logger});await csn({serviceConfig:i,caller:`monaco-editor (${this.id})`,performChecks:hsn,logger:this.logger}),e.languageClientConfig&&(this.languageClientWrapper=new Prn,await this.languageClientWrapper.init({languageClientConfig:e.languageClientConfig,logger:this.logger})),this.initDone=!0}async initAndStart(e,t){await this.init(e),await this.start(t)}async start(e){var t,r,i;if(!this.initDone)throw new Error("No init was performed. Please call init() before start()");if(!e)throw new Error("No HTMLElement provided for monaco-editor.");this.logger.info(`Starting monaco-editor (${this.id})`),await((t=this.editorApp)==null?void 0:t.init()),await((r=this.editorApp)==null?void 0:r.createEditors(e)),(i=this.languageClientWrapper)!=null&&i.haveLanguageClientConfig()&&await this.languageClientWrapper.start()}isInitDone(){return this.initDone}isStarted(){var e,t;return(e=this.editorApp)!=null&&e.haveEditor()?(t=this.languageClientWrapper)!=null&&t.haveLanguageClient()?this.languageClientWrapper.isStarted():!0:!1}haveLanguageClient(){return this.languageClientWrapper!==void 0}getMonacoEditorApp(){return this.editorApp}getEditor(){var e;return(e=this.editorApp)==null?void 0:e.getEditor()}getDiffEditor(){var e;return(e=this.editorApp)==null?void 0:e.getDiffEditor()}getLanguageClientWrapper(){return this.languageClientWrapper}getLanguageClient(){var e;return(e=this.languageClientWrapper)==null?void 0:e.getLanguageClient()}getTextModels(){var e;return(e=this.editorApp)==null?void 0:e.getTextModels()}getModelRefs(){var e;return(e=this.editorApp)==null?void 0:e.getModelRefs()}getWorker(){var e;return(e=this.languageClientWrapper)==null?void 0:e.getWorker()}async updateCodeResources(e){var t;return(t=this.editorApp)==null?void 0:t.updateCodeResources(e)}async updateEditorModels(e){var t;return(t=this.editorApp)==null?void 0:t.updateEditorModels(e)}reportStatus(){var t,r,i,o;const e=[];return e.push("Wrapper status:"),e.push(`Editor: ${(r=(t=this.editorApp)==null?void 0:t.getEditor())==null?void 0:r.getId()}`),e.push(`DiffEditor: ${(o=(i=this.editorApp)==null?void 0:i.getDiffEditor())==null?void 0:o.getId()}`),e}async dispose(){var e,t;(e=this.editorApp)==null||e.disposeApp(),(t=this.languageClientWrapper)!=null&&t.haveLanguageClient()?(await this.languageClientWrapper.disposeLanguageClient(!1),this.editorApp=void 0,await Promise.resolve("Monaco editor and languageclient completed disposed.")):await Promise.resolve("Monaco editor has been disposed."),this.initDone=!1}updateLayout(){var e;(e=this.editorApp)==null||e.updateLayout()}isReInitRequired(e,t){var h,f;let r=!1;const i=e.wrapperConfig.editorAppConfig,o=t.wrapperConfig.editorAppConfig,s=(h=t.languageClientConfig)==null?void 0:h.options,a=(f=e.languageClientConfig)==null?void 0:f.options,c=(s==null?void 0:s.$type)==="WorkerDirect",l=(a==null?void 0:a.$type)==="WorkerDirect",u=(s==null?void 0:s.$type)==="WorkerConfig",d=(a==null?void 0:a.$type)==="WorkerConfig";return u&&c===void 0&&d&&l===void 0?r=s.url!==a.url:u===void 0&&c&&d===void 0&&l?r=s.worker!==a.worker:(c&&d||u&&l)&&(r=!0),o.$type!==i.$type?r=!0:o.$type==="classic"&&i.$type==="classic"?r=this.getMonacoEditorApp().isAppConfigDifferent(o,i,!1)===!0:o.$type==="extended"&&i.$type==="extended"&&(r=this.getMonacoEditorApp().isAppConfigDifferent(o,i,!1)===!0),r}}function psn(n){return new Worker(""+new URL("../workers/editor.worker-CJTASt1G.js",import.meta.url).href,{type:"module",name:n==null?void 0:n.name})}var oee={},see={};(function(n){var e=Ir&&Ir.__createBinding||(Object.create?function(i,o,s,a){a===void 0&&(a=s);var c=Object.getOwnPropertyDescriptor(o,s);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,a,c)}:function(i,o,s,a){a===void 0&&(a=s),i[a]=o[s]}),t=Ir&&Ir.__exportStar||function(i,o){for(var s in i)s!=="default"&&!Object.prototype.hasOwnProperty.call(o,s)&&e(o,i,s)};Object.defineProperty(n,"__esModule",{value:!0}),n.DiagnosticPullMode=n.vsdiag=void 0,t(Pr,n),t(yr,n);var r=ev;Object.defineProperty(n,"vsdiag",{enumerable:!0,get:function(){return r.vsdiag}}),Object.defineProperty(n,"DiagnosticPullMode",{enumerable:!0,get:function(){return r.DiagnosticPullMode}}),t(tc,n)})(see);(function(n){var e=Ir&&Ir.__createBinding||(Object.create?function(s,a,c,l){l===void 0&&(l=c);var u=Object.getOwnPropertyDescriptor(a,c);(!u||("get"in u?!a.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return a[c]}}),Object.defineProperty(s,l,u)}:function(s,a,c,l){l===void 0&&(l=c),s[l]=a[c]}),t=Ir&&Ir.__exportStar||function(s,a){for(var c in s)c!=="default"&&!Object.prototype.hasOwnProperty.call(a,c)&&e(a,s,c)};Object.defineProperty(n,"__esModule",{value:!0}),n.LanguageClient=void 0;const r=see,i=Nx;t(Nx,n),t(see,n);class o extends r.BaseLanguageClient{constructor(a,c,l,u){super(a,c,l),this.worker=u}createMessageTransports(a){const c=new i.BrowserMessageReader(this.worker),l=new i.BrowserMessageWriter(this.worker);return Promise.resolve({reader:c,writer:l})}}n.LanguageClient=o})(oee);const gsn=(n,e)=>{e!=null&&e.rootPath&&(n.rootPath=e.rootPath),e!=null&&e.basePath&&(n.basePath=e.basePath);let t=n.workerFile;n.basePath&&(t=`${n.basePath}/${n.workerFile}`);const r=new URL(t,n.rootPath).href;console.log(`Creating worker: ${r}`);const i=n.options??{};i.type||(i.type="module");const o=i.type==="module"?`import '${r}';`:`importScripts('${r}');`,s=new Blob([o],{type:"application/javascript"});return new Worker(URL.createObjectURL(s),i)},msn=n=>{const e=EHe(),t=(r,i)=>{console.log(`getWorker: moduleId: ${r} label: ${i}`);let o=i,s;s={...n==null?void 0:n.workerLoaders};const a=s[o];if(a){const c=a();return Object.hasOwn(c,"workerFile")?gsn(c,n):c}throw new Error(`Unimplemented worker ${i} (${r})`)};e.getWorker=t};var IHe={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(n,e){(function(t){n.exports=t()})(function(){return function t(r,i,o){function s(l,u){if(!i[l]){if(!r[l]){var d=typeof rP=="function"&&rP;if(!u&&d)return d(l,!0);if(a)return a(l,!0);var h=new Error("Cannot find module '"+l+"'");throw h.code="MODULE_NOT_FOUND",h}var f=i[l]={exports:{}};r[l][0].call(f.exports,function(p){var g=r[l][1][p];return s(g||p)},f,f.exports,t,r,i,o)}return i[l].exports}for(var a=typeof rP=="function"&&rP,c=0;c<o.length;c++)s(o[c]);return s}({1:[function(t,r,i){var o=t("./utils"),s=t("./support"),a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.encode=function(c){for(var l,u,d,h,f,p,g,m=[],v=0,b=c.length,S=b,E=o.getTypeOf(c)!=="string";v<c.length;)S=b-v,d=E?(l=c[v++],u=v<b?c[v++]:0,v<b?c[v++]:0):(l=c.charCodeAt(v++),u=v<b?c.charCodeAt(v++):0,v<b?c.charCodeAt(v++):0),h=l>>2,f=(3&l)<<4|u>>4,p=1<S?(15&u)<<2|d>>6:64,g=2<S?63&d:64,m.push(a.charAt(h)+a.charAt(f)+a.charAt(p)+a.charAt(g));return m.join("")},i.decode=function(c){var l,u,d,h,f,p,g=0,m=0,v="data:";if(c.substr(0,v.length)===v)throw new Error("Invalid base64 input, it looks like a data url.");var b,S=3*(c=c.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(c.charAt(c.length-1)===a.charAt(64)&&S--,c.charAt(c.length-2)===a.charAt(64)&&S--,S%1!=0)throw new Error("Invalid base64 input, bad content length.");for(b=s.uint8array?new Uint8Array(0|S):new Array(0|S);g<c.length;)l=a.indexOf(c.charAt(g++))<<2|(h=a.indexOf(c.charAt(g++)))>>4,u=(15&h)<<4|(f=a.indexOf(c.charAt(g++)))>>2,d=(3&f)<<6|(p=a.indexOf(c.charAt(g++))),b[m++]=l,f!==64&&(b[m++]=u),p!==64&&(b[m++]=d);return b}},{"./support":30,"./utils":32}],2:[function(t,r,i){var o=t("./external"),s=t("./stream/DataWorker"),a=t("./stream/Crc32Probe"),c=t("./stream/DataLengthProbe");function l(u,d,h,f,p){this.compressedSize=u,this.uncompressedSize=d,this.crc32=h,this.compression=f,this.compressedContent=p}l.prototype={getContentWorker:function(){var u=new s(o.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new c("data_length")),d=this;return u.on("end",function(){if(this.streamInfo.data_length!==d.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),u},getCompressedWorker:function(){return new s(o.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},l.createWorkerFrom=function(u,d,h){return u.pipe(new a).pipe(new c("uncompressedSize")).pipe(d.compressWorker(h)).pipe(new c("compressedSize")).withStreamInfo("compression",d)},r.exports=l},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,r,i){var o=t("./stream/GenericWorker");i.STORE={magic:"\0\0",compressWorker:function(){return new o("STORE compression")},uncompressWorker:function(){return new o("STORE decompression")}},i.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,r,i){var o=t("./utils"),s=function(){for(var a,c=[],l=0;l<256;l++){a=l;for(var u=0;u<8;u++)a=1&a?3988292384^a>>>1:a>>>1;c[l]=a}return c}();r.exports=function(a,c){return a!==void 0&&a.length?o.getTypeOf(a)!=="string"?function(l,u,d,h){var f=s,p=h+d;l^=-1;for(var g=h;g<p;g++)l=l>>>8^f[255&(l^u[g])];return-1^l}(0|c,a,a.length,0):function(l,u,d,h){var f=s,p=h+d;l^=-1;for(var g=h;g<p;g++)l=l>>>8^f[255&(l^u.charCodeAt(g))];return-1^l}(0|c,a,a.length,0):0}},{"./utils":32}],5:[function(t,r,i){i.base64=!1,i.binary=!1,i.dir=!1,i.createFolders=!0,i.date=null,i.compression=null,i.compressionOptions=null,i.comment=null,i.unixPermissions=null,i.dosPermissions=null},{}],6:[function(t,r,i){var o=null;o=typeof Promise<"u"?Promise:t("lie"),r.exports={Promise:o}},{lie:37}],7:[function(t,r,i){var o=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",s=t("pako"),a=t("./utils"),c=t("./stream/GenericWorker"),l=o?"uint8array":"array";function u(d,h){c.call(this,"FlateWorker/"+d),this._pako=null,this._pakoAction=d,this._pakoOptions=h,this.meta={}}i.magic="\b\0",a.inherits(u,c),u.prototype.processChunk=function(d){this.meta=d.meta,this._pako===null&&this._createPako(),this._pako.push(a.transformTo(l,d.data),!1)},u.prototype.flush=function(){c.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},u.prototype.cleanUp=function(){c.prototype.cleanUp.call(this),this._pako=null},u.prototype._createPako=function(){this._pako=new s[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var d=this;this._pako.onData=function(h){d.push({data:h,meta:d.meta})}},i.compressWorker=function(d){return new u("Deflate",d)},i.uncompressWorker=function(){return new u("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,r,i){function o(f,p){var g,m="";for(g=0;g<p;g++)m+=String.fromCharCode(255&f),f>>>=8;return m}function s(f,p,g,m,v,b){var S,E,w=f.file,C=f.compression,I=b!==l.utf8encode,T=a.transformTo("string",b(w.name)),D=a.transformTo("string",l.utf8encode(w.name)),O=w.comment,M=a.transformTo("string",b(O)),R=a.transformTo("string",l.utf8encode(O)),A=D.length!==w.name.length,k=R.length!==O.length,L="",j="",N="",B=w.dir,U=w.date,K={crc32:0,compressedSize:0,uncompressedSize:0};p&&!g||(K.crc32=f.crc32,K.compressedSize=f.compressedSize,K.uncompressedSize=f.uncompressedSize);var z=0;p&&(z|=8),I||!A&&!k||(z|=2048);var G=0,te=0;B&&(G|=16),v==="UNIX"?(te=798,G|=function(Q,ge){var _e=Q;return Q||(_e=ge?16893:33204),(65535&_e)<<16}(w.unixPermissions,B)):(te=20,G|=function(Q){return 63&(Q||0)}(w.dosPermissions)),S=U.getUTCHours(),S<<=6,S|=U.getUTCMinutes(),S<<=5,S|=U.getUTCSeconds()/2,E=U.getUTCFullYear()-1980,E<<=4,E|=U.getUTCMonth()+1,E<<=5,E|=U.getUTCDate(),A&&(j=o(1,1)+o(u(T),4)+D,L+="up"+o(j.length,2)+j),k&&(N=o(1,1)+o(u(M),4)+R,L+="uc"+o(N.length,2)+N);var ie="";return ie+=`
\0`,ie+=o(z,2),ie+=C.magic,ie+=o(S,2),ie+=o(E,2),ie+=o(K.crc32,4),ie+=o(K.compressedSize,4),ie+=o(K.uncompressedSize,4),ie+=o(T.length,2),ie+=o(L.length,2),{fileRecord:d.LOCAL_FILE_HEADER+ie+T+L,dirRecord:d.CENTRAL_FILE_HEADER+o(te,2)+ie+o(M.length,2)+"\0\0\0\0"+o(G,4)+o(m,4)+T+L+M}}var a=t("../utils"),c=t("../stream/GenericWorker"),l=t("../utf8"),u=t("../crc32"),d=t("../signature");function h(f,p,g,m){c.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=p,this.zipPlatform=g,this.encodeFileName=m,this.streamFiles=f,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}a.inherits(h,c),h.prototype.push=function(f){var p=f.meta.percent||0,g=this.entriesCount,m=this._sources.length;this.accumulate?this.contentBuffer.push(f):(this.bytesWritten+=f.data.length,c.prototype.push.call(this,{data:f.data,meta:{currentFile:this.currentFile,percent:g?(p+100*(g-m-1))/g:100}}))},h.prototype.openedSource=function(f){this.currentSourceOffset=this.bytesWritten,this.currentFile=f.file.name;var p=this.streamFiles&&!f.file.dir;if(p){var g=s(f,p,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:g.fileRecord,meta:{percent:0}})}else this.accumulate=!0},h.prototype.closedSource=function(f){this.accumulate=!1;var p=this.streamFiles&&!f.file.dir,g=s(f,p,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(g.dirRecord),p)this.push({data:function(m){return d.DATA_DESCRIPTOR+o(m.crc32,4)+o(m.compressedSize,4)+o(m.uncompressedSize,4)}(f),meta:{percent:100}});else for(this.push({data:g.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},h.prototype.flush=function(){for(var f=this.bytesWritten,p=0;p<this.dirRecords.length;p++)this.push({data:this.dirRecords[p],meta:{percent:100}});var g=this.bytesWritten-f,m=function(v,b,S,E,w){var C=a.transformTo("string",w(E));return d.CENTRAL_DIRECTORY_END+"\0\0\0\0"+o(v,2)+o(v,2)+o(b,4)+o(S,4)+o(C.length,2)+C}(this.dirRecords.length,g,f,this.zipComment,this.encodeFileName);this.push({data:m,meta:{percent:100}})},h.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},h.prototype.registerPrevious=function(f){this._sources.push(f);var p=this;return f.on("data",function(g){p.processChunk(g)}),f.on("end",function(){p.closedSource(p.previous.streamInfo),p._sources.length?p.prepareNextSource():p.end()}),f.on("error",function(g){p.error(g)}),this},h.prototype.resume=function(){return!!c.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},h.prototype.error=function(f){var p=this._sources;if(!c.prototype.error.call(this,f))return!1;for(var g=0;g<p.length;g++)try{p[g].error(f)}catch{}return!0},h.prototype.lock=function(){c.prototype.lock.call(this);for(var f=this._sources,p=0;p<f.length;p++)f[p].lock()},r.exports=h},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,r,i){var o=t("../compressions"),s=t("./ZipFileWorker");i.generateWorker=function(a,c,l){var u=new s(c.streamFiles,l,c.platform,c.encodeFileName),d=0;try{a.forEach(function(h,f){d++;var p=function(b,S){var E=b||S,w=o[E];if(!w)throw new Error(E+" is not a valid compression method !");return w}(f.options.compression,c.compression),g=f.options.compressionOptions||c.compressionOptions||{},m=f.dir,v=f.date;f._compressWorker(p,g).withStreamInfo("file",{name:h,dir:m,date:v,comment:f.comment||"",unixPermissions:f.unixPermissions,dosPermissions:f.dosPermissions}).pipe(u)}),u.entriesCount=d}catch(h){u.error(h)}return u}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,r,i){function o(){if(!(this instanceof o))return new o;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var s=new o;for(var a in this)typeof this[a]!="function"&&(s[a]=this[a]);return s}}(o.prototype=t("./object")).loadAsync=t("./load"),o.support=t("./support"),o.defaults=t("./defaults"),o.version="3.10.1",o.loadAsync=function(s,a){return new o().loadAsync(s,a)},o.external=t("./external"),r.exports=o},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,r,i){var o=t("./utils"),s=t("./external"),a=t("./utf8"),c=t("./zipEntries"),l=t("./stream/Crc32Probe"),u=t("./nodejsUtils");function d(h){return new s.Promise(function(f,p){var g=h.decompressed.getContentWorker().pipe(new l);g.on("error",function(m){p(m)}).on("end",function(){g.streamInfo.crc32!==h.decompressed.crc32?p(new Error("Corrupted zip : CRC32 mismatch")):f()}).resume()})}r.exports=function(h,f){var p=this;return f=o.extend(f||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:a.utf8decode}),u.isNode&&u.isStream(h)?s.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):o.prepareContent("the loaded zip file",h,!0,f.optimizedBinaryString,f.base64).then(function(g){var m=new c(f);return m.load(g),m}).then(function(g){var m=[s.Promise.resolve(g)],v=g.files;if(f.checkCRC32)for(var b=0;b<v.length;b++)m.push(d(v[b]));return s.Promise.all(m)}).then(function(g){for(var m=g.shift(),v=m.files,b=0;b<v.length;b++){var S=v[b],E=S.fileNameStr,w=o.resolve(S.fileNameStr);p.file(w,S.decompressed,{binary:!0,optimizedBinaryString:!0,date:S.date,dir:S.dir,comment:S.fileCommentStr.length?S.fileCommentStr:null,unixPermissions:S.unixPermissions,dosPermissions:S.dosPermissions,createFolders:f.createFolders}),S.dir||(p.file(w).unsafeOriginalName=E)}return m.zipComment.length&&(p.comment=m.zipComment),p})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,r,i){var o=t("../utils"),s=t("../stream/GenericWorker");function a(c,l){s.call(this,"Nodejs stream input adapter for "+c),this._upstreamEnded=!1,this._bindStream(l)}o.inherits(a,s),a.prototype._bindStream=function(c){var l=this;(this._stream=c).pause(),c.on("data",function(u){l.push({data:u,meta:{percent:0}})}).on("error",function(u){l.isPaused?this.generatedError=u:l.error(u)}).on("end",function(){l.isPaused?l._upstreamEnded=!0:l.end()})},a.prototype.pause=function(){return!!s.prototype.pause.call(this)&&(this._stream.pause(),!0)},a.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},r.exports=a},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,r,i){var o=t("readable-stream").Readable;function s(a,c,l){o.call(this,c),this._helper=a;var u=this;a.on("data",function(d,h){u.push(d)||u._helper.pause(),l&&l(h)}).on("error",function(d){u.emit("error",d)}).on("end",function(){u.push(null)})}t("../utils").inherits(s,o),s.prototype._read=function(){this._helper.resume()},r.exports=s},{"../utils":32,"readable-stream":16}],14:[function(t,r,i){r.exports={isNode:typeof Buffer<"u",newBufferFrom:function(o,s){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(o,s);if(typeof o=="number")throw new Error('The "data" argument must not be a number');return new Buffer(o,s)},allocBuffer:function(o){if(Buffer.alloc)return Buffer.alloc(o);var s=new Buffer(o);return s.fill(0),s},isBuffer:function(o){return Buffer.isBuffer(o)},isStream:function(o){return o&&typeof o.on=="function"&&typeof o.pause=="function"&&typeof o.resume=="function"}}},{}],15:[function(t,r,i){function o(w,C,I){var T,D=a.getTypeOf(C),O=a.extend(I||{},u);O.date=O.date||new Date,O.compression!==null&&(O.compression=O.compression.toUpperCase()),typeof O.unixPermissions=="string"&&(O.unixPermissions=parseInt(O.unixPermissions,8)),O.unixPermissions&&16384&O.unixPermissions&&(O.dir=!0),O.dosPermissions&&16&O.dosPermissions&&(O.dir=!0),O.dir&&(w=v(w)),O.createFolders&&(T=m(w))&&b.call(this,T,!0);var M=D==="string"&&O.binary===!1&&O.base64===!1;I&&I.binary!==void 0||(O.binary=!M),(C instanceof d&&C.uncompressedSize===0||O.dir||!C||C.length===0)&&(O.base64=!1,O.binary=!0,C="",O.compression="STORE",D="string");var R=null;R=C instanceof d||C instanceof c?C:p.isNode&&p.isStream(C)?new g(w,C):a.prepareContent(w,C,O.binary,O.optimizedBinaryString,O.base64);var A=new h(w,R,O);this.files[w]=A}var s=t("./utf8"),a=t("./utils"),c=t("./stream/GenericWorker"),l=t("./stream/StreamHelper"),u=t("./defaults"),d=t("./compressedObject"),h=t("./zipObject"),f=t("./generate"),p=t("./nodejsUtils"),g=t("./nodejs/NodejsStreamInputAdapter"),m=function(w){w.slice(-1)==="/"&&(w=w.substring(0,w.length-1));var C=w.lastIndexOf("/");return 0<C?w.substring(0,C):""},v=function(w){return w.slice(-1)!=="/"&&(w+="/"),w},b=function(w,C){return C=C!==void 0?C:u.createFolders,w=v(w),this.files[w]||o.call(this,w,null,{dir:!0,createFolders:C}),this.files[w]};function S(w){return Object.prototype.toString.call(w)==="[object RegExp]"}var E={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(w){var C,I,T;for(C in this.files)T=this.files[C],(I=C.slice(this.root.length,C.length))&&C.slice(0,this.root.length)===this.root&&w(I,T)},filter:function(w){var C=[];return this.forEach(function(I,T){w(I,T)&&C.push(T)}),C},file:function(w,C,I){if(arguments.length!==1)return w=this.root+w,o.call(this,w,C,I),this;if(S(w)){var T=w;return this.filter(function(O,M){return!M.dir&&T.test(O)})}var D=this.files[this.root+w];return D&&!D.dir?D:null},folder:function(w){if(!w)return this;if(S(w))return this.filter(function(D,O){return O.dir&&w.test(D)});var C=this.root+w,I=b.call(this,C),T=this.clone();return T.root=I.name,T},remove:function(w){w=this.root+w;var C=this.files[w];if(C||(w.slice(-1)!=="/"&&(w+="/"),C=this.files[w]),C&&!C.dir)delete this.files[w];else for(var I=this.filter(function(D,O){return O.name.slice(0,w.length)===w}),T=0;T<I.length;T++)delete this.files[I[T].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(w){var C,I={};try{if((I=a.extend(w||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:s.utf8encode})).type=I.type.toLowerCase(),I.compression=I.compression.toUpperCase(),I.type==="binarystring"&&(I.type="string"),!I.type)throw new Error("No output type specified.");a.checkSupport(I.type),I.platform!=="darwin"&&I.platform!=="freebsd"&&I.platform!=="linux"&&I.platform!=="sunos"||(I.platform="UNIX"),I.platform==="win32"&&(I.platform="DOS");var T=I.comment||this.comment||"";C=f.generateWorker(this,I,T)}catch(D){(C=new c("error")).error(D)}return new l(C,I.type||"string",I.mimeType)},generateAsync:function(w,C){return this.generateInternalStream(w).accumulate(C)},generateNodeStream:function(w,C){return(w=w||{}).type||(w.type="nodebuffer"),this.generateInternalStream(w).toNodejsStream(C)}};r.exports=E},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,r,i){r.exports=t("stream")},{stream:void 0}],17:[function(t,r,i){var o=t("./DataReader");function s(a){o.call(this,a);for(var c=0;c<this.data.length;c++)a[c]=255&a[c]}t("../utils").inherits(s,o),s.prototype.byteAt=function(a){return this.data[this.zero+a]},s.prototype.lastIndexOfSignature=function(a){for(var c=a.charCodeAt(0),l=a.charCodeAt(1),u=a.charCodeAt(2),d=a.charCodeAt(3),h=this.length-4;0<=h;--h)if(this.data[h]===c&&this.data[h+1]===l&&this.data[h+2]===u&&this.data[h+3]===d)return h-this.zero;return-1},s.prototype.readAndCheckSignature=function(a){var c=a.charCodeAt(0),l=a.charCodeAt(1),u=a.charCodeAt(2),d=a.charCodeAt(3),h=this.readData(4);return c===h[0]&&l===h[1]&&u===h[2]&&d===h[3]},s.prototype.readData=function(a){if(this.checkOffset(a),a===0)return[];var c=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,c},r.exports=s},{"../utils":32,"./DataReader":18}],18:[function(t,r,i){var o=t("../utils");function s(a){this.data=a,this.length=a.length,this.index=0,this.zero=0}s.prototype={checkOffset:function(a){this.checkIndex(this.index+a)},checkIndex:function(a){if(this.length<this.zero+a||a<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+a+"). Corrupted zip ?")},setIndex:function(a){this.checkIndex(a),this.index=a},skip:function(a){this.setIndex(this.index+a)},byteAt:function(){},readInt:function(a){var c,l=0;for(this.checkOffset(a),c=this.index+a-1;c>=this.index;c--)l=(l<<8)+this.byteAt(c);return this.index+=a,l},readString:function(a){return o.transformTo("string",this.readData(a))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var a=this.readInt(4);return new Date(Date.UTC(1980+(a>>25&127),(a>>21&15)-1,a>>16&31,a>>11&31,a>>5&63,(31&a)<<1))}},r.exports=s},{"../utils":32}],19:[function(t,r,i){var o=t("./Uint8ArrayReader");function s(a){o.call(this,a)}t("../utils").inherits(s,o),s.prototype.readData=function(a){this.checkOffset(a);var c=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,c},r.exports=s},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,r,i){var o=t("./DataReader");function s(a){o.call(this,a)}t("../utils").inherits(s,o),s.prototype.byteAt=function(a){return this.data.charCodeAt(this.zero+a)},s.prototype.lastIndexOfSignature=function(a){return this.data.lastIndexOf(a)-this.zero},s.prototype.readAndCheckSignature=function(a){return a===this.readData(4)},s.prototype.readData=function(a){this.checkOffset(a);var c=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,c},r.exports=s},{"../utils":32,"./DataReader":18}],21:[function(t,r,i){var o=t("./ArrayReader");function s(a){o.call(this,a)}t("../utils").inherits(s,o),s.prototype.readData=function(a){if(this.checkOffset(a),a===0)return new Uint8Array(0);var c=this.data.subarray(this.zero+this.index,this.zero+this.index+a);return this.index+=a,c},r.exports=s},{"../utils":32,"./ArrayReader":17}],22:[function(t,r,i){var o=t("../utils"),s=t("../support"),a=t("./ArrayReader"),c=t("./StringReader"),l=t("./NodeBufferReader"),u=t("./Uint8ArrayReader");r.exports=function(d){var h=o.getTypeOf(d);return o.checkSupport(h),h!=="string"||s.uint8array?h==="nodebuffer"?new l(d):s.uint8array?new u(o.transformTo("uint8array",d)):new a(o.transformTo("array",d)):new c(d)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,r,i){i.LOCAL_FILE_HEADER="PK",i.CENTRAL_FILE_HEADER="PK",i.CENTRAL_DIRECTORY_END="PK",i.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",i.ZIP64_CENTRAL_DIRECTORY_END="PK",i.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(t,r,i){var o=t("./GenericWorker"),s=t("../utils");function a(c){o.call(this,"ConvertWorker to "+c),this.destType=c}s.inherits(a,o),a.prototype.processChunk=function(c){this.push({data:s.transformTo(this.destType,c.data),meta:c.meta})},r.exports=a},{"../utils":32,"./GenericWorker":28}],25:[function(t,r,i){var o=t("./GenericWorker"),s=t("../crc32");function a(){o.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}t("../utils").inherits(a,o),a.prototype.processChunk=function(c){this.streamInfo.crc32=s(c.data,this.streamInfo.crc32||0),this.push(c)},r.exports=a},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,r,i){var o=t("../utils"),s=t("./GenericWorker");function a(c){s.call(this,"DataLengthProbe for "+c),this.propName=c,this.withStreamInfo(c,0)}o.inherits(a,s),a.prototype.processChunk=function(c){if(c){var l=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=l+c.data.length}s.prototype.processChunk.call(this,c)},r.exports=a},{"../utils":32,"./GenericWorker":28}],27:[function(t,r,i){var o=t("../utils"),s=t("./GenericWorker");function a(c){s.call(this,"DataWorker");var l=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,c.then(function(u){l.dataIsReady=!0,l.data=u,l.max=u&&u.length||0,l.type=o.getTypeOf(u),l.isPaused||l._tickAndRepeat()},function(u){l.error(u)})}o.inherits(a,s),a.prototype.cleanUp=function(){s.prototype.cleanUp.call(this),this.data=null},a.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,o.delay(this._tickAndRepeat,[],this)),!0)},a.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(o.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},a.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var c=null,l=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":c=this.data.substring(this.index,l);break;case"uint8array":c=this.data.subarray(this.index,l);break;case"array":case"nodebuffer":c=this.data.slice(this.index,l)}return this.index=l,this.push({data:c,meta:{percent:this.max?this.index/this.max*100:0}})},r.exports=a},{"../utils":32,"./GenericWorker":28}],28:[function(t,r,i){function o(s){this.name=s||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}o.prototype={push:function(s){this.emit("data",s)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(s){this.emit("error",s)}return!0},error:function(s){return!this.isFinished&&(this.isPaused?this.generatedError=s:(this.isFinished=!0,this.emit("error",s),this.previous&&this.previous.error(s),this.cleanUp()),!0)},on:function(s,a){return this._listeners[s].push(a),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(s,a){if(this._listeners[s])for(var c=0;c<this._listeners[s].length;c++)this._listeners[s][c].call(this,a)},pipe:function(s){return s.registerPrevious(this)},registerPrevious:function(s){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=s.streamInfo,this.mergeStreamInfo(),this.previous=s;var a=this;return s.on("data",function(c){a.processChunk(c)}),s.on("end",function(){a.end()}),s.on("error",function(c){a.error(c)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var s=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),s=!0),this.previous&&this.previous.resume(),!s},flush:function(){},processChunk:function(s){this.push(s)},withStreamInfo:function(s,a){return this.extraStreamInfo[s]=a,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var s in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,s)&&(this.streamInfo[s]=this.extraStreamInfo[s])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var s="Worker "+this.name;return this.previous?this.previous+" -> "+s:s}},r.exports=o},{}],29:[function(t,r,i){var o=t("../utils"),s=t("./ConvertWorker"),a=t("./GenericWorker"),c=t("../base64"),l=t("../support"),u=t("../external"),d=null;if(l.nodestream)try{d=t("../nodejs/NodejsStreamOutputAdapter")}catch{}function h(p,g){return new u.Promise(function(m,v){var b=[],S=p._internalType,E=p._outputType,w=p._mimeType;p.on("data",function(C,I){b.push(C),g&&g(I)}).on("error",function(C){b=[],v(C)}).on("end",function(){try{var C=function(I,T,D){switch(I){case"blob":return o.newBlob(o.transformTo("arraybuffer",T),D);case"base64":return c.encode(T);default:return o.transformTo(I,T)}}(E,function(I,T){var D,O=0,M=null,R=0;for(D=0;D<T.length;D++)R+=T[D].length;switch(I){case"string":return T.join("");case"array":return Array.prototype.concat.apply([],T);case"uint8array":for(M=new Uint8Array(R),D=0;D<T.length;D++)M.set(T[D],O),O+=T[D].length;return M;case"nodebuffer":return Buffer.concat(T);default:throw new Error("concat : unsupported type '"+I+"'")}}(S,b),w);m(C)}catch(I){v(I)}b=[]}).resume()})}function f(p,g,m){var v=g;switch(g){case"blob":case"arraybuffer":v="uint8array";break;case"base64":v="string"}try{this._internalType=v,this._outputType=g,this._mimeType=m,o.checkSupport(v),this._worker=p.pipe(new s(v)),p.lock()}catch(b){this._worker=new a("error"),this._worker.error(b)}}f.prototype={accumulate:function(p){return h(this,p)},on:function(p,g){var m=this;return p==="data"?this._worker.on(p,function(v){g.call(m,v.data,v.meta)}):this._worker.on(p,function(){o.delay(g,arguments,m)}),this},resume:function(){return o.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(p){if(o.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new d(this,{objectMode:this._outputType!=="nodebuffer"},p)}},r.exports=f},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,r,i){if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",i.nodebuffer=typeof Buffer<"u",i.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")i.blob=!1;else{var o=new ArrayBuffer(0);try{i.blob=new Blob([o],{type:"application/zip"}).size===0}catch{try{var s=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);s.append(o),i.blob=s.getBlob("application/zip").size===0}catch{i.blob=!1}}}try{i.nodestream=!!t("readable-stream").Readable}catch{i.nodestream=!1}},{"readable-stream":16}],31:[function(t,r,i){for(var o=t("./utils"),s=t("./support"),a=t("./nodejsUtils"),c=t("./stream/GenericWorker"),l=new Array(256),u=0;u<256;u++)l[u]=252<=u?6:248<=u?5:240<=u?4:224<=u?3:192<=u?2:1;l[254]=l[254]=1;function d(){c.call(this,"utf-8 decode"),this.leftOver=null}function h(){c.call(this,"utf-8 encode")}i.utf8encode=function(f){return s.nodebuffer?a.newBufferFrom(f,"utf-8"):function(p){var g,m,v,b,S,E=p.length,w=0;for(b=0;b<E;b++)(64512&(m=p.charCodeAt(b)))==55296&&b+1<E&&(64512&(v=p.charCodeAt(b+1)))==56320&&(m=65536+(m-55296<<10)+(v-56320),b++),w+=m<128?1:m<2048?2:m<65536?3:4;for(g=s.uint8array?new Uint8Array(w):new Array(w),b=S=0;S<w;b++)(64512&(m=p.charCodeAt(b)))==55296&&b+1<E&&(64512&(v=p.charCodeAt(b+1)))==56320&&(m=65536+(m-55296<<10)+(v-56320),b++),m<128?g[S++]=m:(m<2048?g[S++]=192|m>>>6:(m<65536?g[S++]=224|m>>>12:(g[S++]=240|m>>>18,g[S++]=128|m>>>12&63),g[S++]=128|m>>>6&63),g[S++]=128|63&m);return g}(f)},i.utf8decode=function(f){return s.nodebuffer?o.transformTo("nodebuffer",f).toString("utf-8"):function(p){var g,m,v,b,S=p.length,E=new Array(2*S);for(g=m=0;g<S;)if((v=p[g++])<128)E[m++]=v;else if(4<(b=l[v]))E[m++]=65533,g+=b-1;else{for(v&=b===2?31:b===3?15:7;1<b&&g<S;)v=v<<6|63&p[g++],b--;1<b?E[m++]=65533:v<65536?E[m++]=v:(v-=65536,E[m++]=55296|v>>10&1023,E[m++]=56320|1023&v)}return E.length!==m&&(E.subarray?E=E.subarray(0,m):E.length=m),o.applyFromCharCode(E)}(f=o.transformTo(s.uint8array?"uint8array":"array",f))},o.inherits(d,c),d.prototype.processChunk=function(f){var p=o.transformTo(s.uint8array?"uint8array":"array",f.data);if(this.leftOver&&this.leftOver.length){if(s.uint8array){var g=p;(p=new Uint8Array(g.length+this.leftOver.length)).set(this.leftOver,0),p.set(g,this.leftOver.length)}else p=this.leftOver.concat(p);this.leftOver=null}var m=function(b,S){var E;for((S=S||b.length)>b.length&&(S=b.length),E=S-1;0<=E&&(192&b[E])==128;)E--;return E<0||E===0?S:E+l[b[E]]>S?E:S}(p),v=p;m!==p.length&&(s.uint8array?(v=p.subarray(0,m),this.leftOver=p.subarray(m,p.length)):(v=p.slice(0,m),this.leftOver=p.slice(m,p.length))),this.push({data:i.utf8decode(v),meta:f.meta})},d.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:i.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},i.Utf8DecodeWorker=d,o.inherits(h,c),h.prototype.processChunk=function(f){this.push({data:i.utf8encode(f.data),meta:f.meta})},i.Utf8EncodeWorker=h},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,r,i){var o=t("./support"),s=t("./base64"),a=t("./nodejsUtils"),c=t("./external");function l(g){return g}function u(g,m){for(var v=0;v<g.length;++v)m[v]=255&g.charCodeAt(v);return m}t("setimmediate"),i.newBlob=function(g,m){i.checkSupport("blob");try{return new Blob([g],{type:m})}catch{try{var v=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return v.append(g),v.getBlob(m)}catch{throw new Error("Bug : can't construct the Blob.")}}};var d={stringifyByChunk:function(g,m,v){var b=[],S=0,E=g.length;if(E<=v)return String.fromCharCode.apply(null,g);for(;S<E;)m==="array"||m==="nodebuffer"?b.push(String.fromCharCode.apply(null,g.slice(S,Math.min(S+v,E)))):b.push(String.fromCharCode.apply(null,g.subarray(S,Math.min(S+v,E)))),S+=v;return b.join("")},stringifyByChar:function(g){for(var m="",v=0;v<g.length;v++)m+=String.fromCharCode(g[v]);return m},applyCanBeUsed:{uint8array:function(){try{return o.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return o.nodebuffer&&String.fromCharCode.apply(null,a.allocBuffer(1)).length===1}catch{return!1}}()}};function h(g){var m=65536,v=i.getTypeOf(g),b=!0;if(v==="uint8array"?b=d.applyCanBeUsed.uint8array:v==="nodebuffer"&&(b=d.applyCanBeUsed.nodebuffer),b)for(;1<m;)try{return d.stringifyByChunk(g,v,m)}catch{m=Math.floor(m/2)}return d.stringifyByChar(g)}function f(g,m){for(var v=0;v<g.length;v++)m[v]=g[v];return m}i.applyFromCharCode=h;var p={};p.string={string:l,array:function(g){return u(g,new Array(g.length))},arraybuffer:function(g){return p.string.uint8array(g).buffer},uint8array:function(g){return u(g,new Uint8Array(g.length))},nodebuffer:function(g){return u(g,a.allocBuffer(g.length))}},p.array={string:h,array:l,arraybuffer:function(g){return new Uint8Array(g).buffer},uint8array:function(g){return new Uint8Array(g)},nodebuffer:function(g){return a.newBufferFrom(g)}},p.arraybuffer={string:function(g){return h(new Uint8Array(g))},array:function(g){return f(new Uint8Array(g),new Array(g.byteLength))},arraybuffer:l,uint8array:function(g){return new Uint8Array(g)},nodebuffer:function(g){return a.newBufferFrom(new Uint8Array(g))}},p.uint8array={string:h,array:function(g){return f(g,new Array(g.length))},arraybuffer:function(g){return g.buffer},uint8array:l,nodebuffer:function(g){return a.newBufferFrom(g)}},p.nodebuffer={string:h,array:function(g){return f(g,new Array(g.length))},arraybuffer:function(g){return p.nodebuffer.uint8array(g).buffer},uint8array:function(g){return f(g,new Uint8Array(g.length))},nodebuffer:l},i.transformTo=function(g,m){if(m=m||"",!g)return m;i.checkSupport(g);var v=i.getTypeOf(m);return p[v][g](m)},i.resolve=function(g){for(var m=g.split("/"),v=[],b=0;b<m.length;b++){var S=m[b];S==="."||S===""&&b!==0&&b!==m.length-1||(S===".."?v.pop():v.push(S))}return v.join("/")},i.getTypeOf=function(g){return typeof g=="string"?"string":Object.prototype.toString.call(g)==="[object Array]"?"array":o.nodebuffer&&a.isBuffer(g)?"nodebuffer":o.uint8array&&g instanceof Uint8Array?"uint8array":o.arraybuffer&&g instanceof ArrayBuffer?"arraybuffer":void 0},i.checkSupport=function(g){if(!o[g.toLowerCase()])throw new Error(g+" is not supported by this platform")},i.MAX_VALUE_16BITS=65535,i.MAX_VALUE_32BITS=-1,i.pretty=function(g){var m,v,b="";for(v=0;v<(g||"").length;v++)b+="\\x"+((m=g.charCodeAt(v))<16?"0":"")+m.toString(16).toUpperCase();return b},i.delay=function(g,m,v){setImmediate(function(){g.apply(v||null,m||[])})},i.inherits=function(g,m){function v(){}v.prototype=m.prototype,g.prototype=new v},i.extend=function(){var g,m,v={};for(g=0;g<arguments.length;g++)for(m in arguments[g])Object.prototype.hasOwnProperty.call(arguments[g],m)&&v[m]===void 0&&(v[m]=arguments[g][m]);return v},i.prepareContent=function(g,m,v,b,S){return c.Promise.resolve(m).then(function(E){return o.blob&&(E instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(E))!==-1)&&typeof FileReader<"u"?new c.Promise(function(w,C){var I=new FileReader;I.onload=function(T){w(T.target.result)},I.onerror=function(T){C(T.target.error)},I.readAsArrayBuffer(E)}):E}).then(function(E){var w=i.getTypeOf(E);return w?(w==="arraybuffer"?E=i.transformTo("uint8array",E):w==="string"&&(S?E=s.decode(E):v&&b!==!0&&(E=function(C){return u(C,o.uint8array?new Uint8Array(C.length):new Array(C.length))}(E))),E):c.Promise.reject(new Error("Can't read the data of '"+g+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(t,r,i){var o=t("./reader/readerFor"),s=t("./utils"),a=t("./signature"),c=t("./zipEntry"),l=t("./support");function u(d){this.files=[],this.loadOptions=d}u.prototype={checkSignature:function(d){if(!this.reader.readAndCheckSignature(d)){this.reader.index-=4;var h=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+s.pretty(h)+", expected "+s.pretty(d)+")")}},isSignature:function(d,h){var f=this.reader.index;this.reader.setIndex(d);var p=this.reader.readString(4)===h;return this.reader.setIndex(f),p},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var d=this.reader.readData(this.zipCommentLength),h=l.uint8array?"uint8array":"array",f=s.transformTo(h,d);this.zipComment=this.loadOptions.decodeFileName(f)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var d,h,f,p=this.zip64EndOfCentralSize-44;0<p;)d=this.reader.readInt(2),h=this.reader.readInt(4),f=this.reader.readData(h),this.zip64ExtensibleData[d]={id:d,length:h,value:f}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var d,h;for(d=0;d<this.files.length;d++)h=this.files[d],this.reader.setIndex(h.localHeaderOffset),this.checkSignature(a.LOCAL_FILE_HEADER),h.readLocalPart(this.reader),h.handleUTF8(),h.processAttributes()},readCentralDir:function(){var d;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(a.CENTRAL_FILE_HEADER);)(d=new c({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(d);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var d=this.reader.lastIndexOfSignature(a.CENTRAL_DIRECTORY_END);if(d<0)throw this.isSignature(0,a.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(d);var h=d;if(this.checkSignature(a.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===s.MAX_VALUE_16BITS||this.diskWithCentralDirStart===s.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===s.MAX_VALUE_16BITS||this.centralDirRecords===s.MAX_VALUE_16BITS||this.centralDirSize===s.MAX_VALUE_32BITS||this.centralDirOffset===s.MAX_VALUE_32BITS){if(this.zip64=!0,(d=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(d),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,a.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var f=this.centralDirOffset+this.centralDirSize;this.zip64&&(f+=20,f+=12+this.zip64EndOfCentralSize);var p=h-f;if(0<p)this.isSignature(h,a.CENTRAL_FILE_HEADER)||(this.reader.zero=p);else if(p<0)throw new Error("Corrupted zip: missing "+Math.abs(p)+" bytes.")},prepareReader:function(d){this.reader=o(d)},load:function(d){this.prepareReader(d),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},r.exports=u},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(t,r,i){var o=t("./reader/readerFor"),s=t("./utils"),a=t("./compressedObject"),c=t("./crc32"),l=t("./utf8"),u=t("./compressions"),d=t("./support");function h(f,p){this.options=f,this.loadOptions=p}h.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(f){var p,g;if(f.skip(22),this.fileNameLength=f.readInt(2),g=f.readInt(2),this.fileName=f.readData(this.fileNameLength),f.skip(g),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((p=function(m){for(var v in u)if(Object.prototype.hasOwnProperty.call(u,v)&&u[v].magic===m)return u[v];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+s.pretty(this.compressionMethod)+" unknown (inner file : "+s.transformTo("string",this.fileName)+")");this.decompressed=new a(this.compressedSize,this.uncompressedSize,this.crc32,p,f.readData(this.compressedSize))},readCentralPart:function(f){this.versionMadeBy=f.readInt(2),f.skip(2),this.bitFlag=f.readInt(2),this.compressionMethod=f.readString(2),this.date=f.readDate(),this.crc32=f.readInt(4),this.compressedSize=f.readInt(4),this.uncompressedSize=f.readInt(4);var p=f.readInt(2);if(this.extraFieldsLength=f.readInt(2),this.fileCommentLength=f.readInt(2),this.diskNumberStart=f.readInt(2),this.internalFileAttributes=f.readInt(2),this.externalFileAttributes=f.readInt(4),this.localHeaderOffset=f.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");f.skip(p),this.readExtraFields(f),this.parseZIP64ExtraField(f),this.fileComment=f.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var f=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),f==0&&(this.dosPermissions=63&this.externalFileAttributes),f==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var f=o(this.extraFields[1].value);this.uncompressedSize===s.MAX_VALUE_32BITS&&(this.uncompressedSize=f.readInt(8)),this.compressedSize===s.MAX_VALUE_32BITS&&(this.compressedSize=f.readInt(8)),this.localHeaderOffset===s.MAX_VALUE_32BITS&&(this.localHeaderOffset=f.readInt(8)),this.diskNumberStart===s.MAX_VALUE_32BITS&&(this.diskNumberStart=f.readInt(4))}},readExtraFields:function(f){var p,g,m,v=f.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});f.index+4<v;)p=f.readInt(2),g=f.readInt(2),m=f.readData(g),this.extraFields[p]={id:p,length:g,value:m};f.setIndex(v)},handleUTF8:function(){var f=d.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=l.utf8decode(this.fileName),this.fileCommentStr=l.utf8decode(this.fileComment);else{var p=this.findExtraFieldUnicodePath();if(p!==null)this.fileNameStr=p;else{var g=s.transformTo(f,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(g)}var m=this.findExtraFieldUnicodeComment();if(m!==null)this.fileCommentStr=m;else{var v=s.transformTo(f,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(v)}}},findExtraFieldUnicodePath:function(){var f=this.extraFields[28789];if(f){var p=o(f.value);return p.readInt(1)!==1||c(this.fileName)!==p.readInt(4)?null:l.utf8decode(p.readData(f.length-5))}return null},findExtraFieldUnicodeComment:function(){var f=this.extraFields[25461];if(f){var p=o(f.value);return p.readInt(1)!==1||c(this.fileComment)!==p.readInt(4)?null:l.utf8decode(p.readData(f.length-5))}return null}},r.exports=h},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,r,i){function o(p,g,m){this.name=p,this.dir=m.dir,this.date=m.date,this.comment=m.comment,this.unixPermissions=m.unixPermissions,this.dosPermissions=m.dosPermissions,this._data=g,this._dataBinary=m.binary,this.options={compression:m.compression,compressionOptions:m.compressionOptions}}var s=t("./stream/StreamHelper"),a=t("./stream/DataWorker"),c=t("./utf8"),l=t("./compressedObject"),u=t("./stream/GenericWorker");o.prototype={internalStream:function(p){var g=null,m="string";try{if(!p)throw new Error("No output type specified.");var v=(m=p.toLowerCase())==="string"||m==="text";m!=="binarystring"&&m!=="text"||(m="string"),g=this._decompressWorker();var b=!this._dataBinary;b&&!v&&(g=g.pipe(new c.Utf8EncodeWorker)),!b&&v&&(g=g.pipe(new c.Utf8DecodeWorker))}catch(S){(g=new u("error")).error(S)}return new s(g,m,"")},async:function(p,g){return this.internalStream(p).accumulate(g)},nodeStream:function(p,g){return this.internalStream(p||"nodebuffer").toNodejsStream(g)},_compressWorker:function(p,g){if(this._data instanceof l&&this._data.compression.magic===p.magic)return this._data.getCompressedWorker();var m=this._decompressWorker();return this._dataBinary||(m=m.pipe(new c.Utf8EncodeWorker)),l.createWorkerFrom(m,p,g)},_decompressWorker:function(){return this._data instanceof l?this._data.getContentWorker():this._data instanceof u?this._data:new a(this._data)}};for(var d=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],h=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},f=0;f<d.length;f++)o.prototype[d[f]]=h;r.exports=o},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,r,i){(function(o){var s,a,c=o.MutationObserver||o.WebKitMutationObserver;if(c){var l=0,u=new c(p),d=o.document.createTextNode("");u.observe(d,{characterData:!0}),s=function(){d.data=l=++l%2}}else if(o.setImmediate||o.MessageChannel===void 0)s="document"in o&&"onreadystatechange"in o.document.createElement("script")?function(){var g=o.document.createElement("script");g.onreadystatechange=function(){p(),g.onreadystatechange=null,g.parentNode.removeChild(g),g=null},o.document.documentElement.appendChild(g)}:function(){setTimeout(p,0)};else{var h=new o.MessageChannel;h.port1.onmessage=p,s=function(){h.port2.postMessage(0)}}var f=[];function p(){var g,m;a=!0;for(var v=f.length;v;){for(m=f,f=[],g=-1;++g<v;)m[g]();v=f.length}a=!1}r.exports=function(g){f.push(g)!==1||a||s()}}).call(this,typeof Ir<"u"?Ir:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(t,r,i){var o=t("immediate");function s(){}var a={},c=["REJECTED"],l=["FULFILLED"],u=["PENDING"];function d(v){if(typeof v!="function")throw new TypeError("resolver must be a function");this.state=u,this.queue=[],this.outcome=void 0,v!==s&&g(this,v)}function h(v,b,S){this.promise=v,typeof b=="function"&&(this.onFulfilled=b,this.callFulfilled=this.otherCallFulfilled),typeof S=="function"&&(this.onRejected=S,this.callRejected=this.otherCallRejected)}function f(v,b,S){o(function(){var E;try{E=b(S)}catch(w){return a.reject(v,w)}E===v?a.reject(v,new TypeError("Cannot resolve promise with itself")):a.resolve(v,E)})}function p(v){var b=v&&v.then;if(v&&(typeof v=="object"||typeof v=="function")&&typeof b=="function")return function(){b.apply(v,arguments)}}function g(v,b){var S=!1;function E(I){S||(S=!0,a.reject(v,I))}function w(I){S||(S=!0,a.resolve(v,I))}var C=m(function(){b(w,E)});C.status==="error"&&E(C.value)}function m(v,b){var S={};try{S.value=v(b),S.status="success"}catch(E){S.status="error",S.value=E}return S}(r.exports=d).prototype.finally=function(v){if(typeof v!="function")return this;var b=this.constructor;return this.then(function(S){return b.resolve(v()).then(function(){return S})},function(S){return b.resolve(v()).then(function(){throw S})})},d.prototype.catch=function(v){return this.then(null,v)},d.prototype.then=function(v,b){if(typeof v!="function"&&this.state===l||typeof b!="function"&&this.state===c)return this;var S=new this.constructor(s);return this.state!==u?f(S,this.state===l?v:b,this.outcome):this.queue.push(new h(S,v,b)),S},h.prototype.callFulfilled=function(v){a.resolve(this.promise,v)},h.prototype.otherCallFulfilled=function(v){f(this.promise,this.onFulfilled,v)},h.prototype.callRejected=function(v){a.reject(this.promise,v)},h.prototype.otherCallRejected=function(v){f(this.promise,this.onRejected,v)},a.resolve=function(v,b){var S=m(p,b);if(S.status==="error")return a.reject(v,S.value);var E=S.value;if(E)g(v,E);else{v.state=l,v.outcome=b;for(var w=-1,C=v.queue.length;++w<C;)v.queue[w].callFulfilled(b)}return v},a.reject=function(v,b){v.state=c,v.outcome=b;for(var S=-1,E=v.queue.length;++S<E;)v.queue[S].callRejected(b);return v},d.resolve=function(v){return v instanceof this?v:a.resolve(new this(s),v)},d.reject=function(v){var b=new this(s);return a.reject(b,v)},d.all=function(v){var b=this;if(Object.prototype.toString.call(v)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=v.length,E=!1;if(!S)return this.resolve([]);for(var w=new Array(S),C=0,I=-1,T=new this(s);++I<S;)D(v[I],I);return T;function D(O,M){b.resolve(O).then(function(R){w[M]=R,++C!==S||E||(E=!0,a.resolve(T,w))},function(R){E||(E=!0,a.reject(T,R))})}},d.race=function(v){var b=this;if(Object.prototype.toString.call(v)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=v.length,E=!1;if(!S)return this.resolve([]);for(var w=-1,C=new this(s);++w<S;)I=v[w],b.resolve(I).then(function(T){E||(E=!0,a.resolve(C,T))},function(T){E||(E=!0,a.reject(C,T))});var I;return C}},{immediate:36}],38:[function(t,r,i){var o={};(0,t("./lib/utils/common").assign)(o,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),r.exports=o},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,r,i){var o=t("./zlib/deflate"),s=t("./utils/common"),a=t("./utils/strings"),c=t("./zlib/messages"),l=t("./zlib/zstream"),u=Object.prototype.toString,d=0,h=-1,f=0,p=8;function g(v){if(!(this instanceof g))return new g(v);this.options=s.assign({level:h,method:p,chunkSize:16384,windowBits:15,memLevel:8,strategy:f,to:""},v||{});var b=this.options;b.raw&&0<b.windowBits?b.windowBits=-b.windowBits:b.gzip&&0<b.windowBits&&b.windowBits<16&&(b.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var S=o.deflateInit2(this.strm,b.level,b.method,b.windowBits,b.memLevel,b.strategy);if(S!==d)throw new Error(c[S]);if(b.header&&o.deflateSetHeader(this.strm,b.header),b.dictionary){var E;if(E=typeof b.dictionary=="string"?a.string2buf(b.dictionary):u.call(b.dictionary)==="[object ArrayBuffer]"?new Uint8Array(b.dictionary):b.dictionary,(S=o.deflateSetDictionary(this.strm,E))!==d)throw new Error(c[S]);this._dict_set=!0}}function m(v,b){var S=new g(b);if(S.push(v,!0),S.err)throw S.msg||c[S.err];return S.result}g.prototype.push=function(v,b){var S,E,w=this.strm,C=this.options.chunkSize;if(this.ended)return!1;E=b===~~b?b:b===!0?4:0,typeof v=="string"?w.input=a.string2buf(v):u.call(v)==="[object ArrayBuffer]"?w.input=new Uint8Array(v):w.input=v,w.next_in=0,w.avail_in=w.input.length;do{if(w.avail_out===0&&(w.output=new s.Buf8(C),w.next_out=0,w.avail_out=C),(S=o.deflate(w,E))!==1&&S!==d)return this.onEnd(S),!(this.ended=!0);w.avail_out!==0&&(w.avail_in!==0||E!==4&&E!==2)||(this.options.to==="string"?this.onData(a.buf2binstring(s.shrinkBuf(w.output,w.next_out))):this.onData(s.shrinkBuf(w.output,w.next_out)))}while((0<w.avail_in||w.avail_out===0)&&S!==1);return E===4?(S=o.deflateEnd(this.strm),this.onEnd(S),this.ended=!0,S===d):E!==2||(this.onEnd(d),!(w.avail_out=0))},g.prototype.onData=function(v){this.chunks.push(v)},g.prototype.onEnd=function(v){v===d&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=v,this.msg=this.strm.msg},i.Deflate=g,i.deflate=m,i.deflateRaw=function(v,b){return(b=b||{}).raw=!0,m(v,b)},i.gzip=function(v,b){return(b=b||{}).gzip=!0,m(v,b)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,r,i){var o=t("./zlib/inflate"),s=t("./utils/common"),a=t("./utils/strings"),c=t("./zlib/constants"),l=t("./zlib/messages"),u=t("./zlib/zstream"),d=t("./zlib/gzheader"),h=Object.prototype.toString;function f(g){if(!(this instanceof f))return new f(g);this.options=s.assign({chunkSize:16384,windowBits:0,to:""},g||{});var m=this.options;m.raw&&0<=m.windowBits&&m.windowBits<16&&(m.windowBits=-m.windowBits,m.windowBits===0&&(m.windowBits=-15)),!(0<=m.windowBits&&m.windowBits<16)||g&&g.windowBits||(m.windowBits+=32),15<m.windowBits&&m.windowBits<48&&!(15&m.windowBits)&&(m.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var v=o.inflateInit2(this.strm,m.windowBits);if(v!==c.Z_OK)throw new Error(l[v]);this.header=new d,o.inflateGetHeader(this.strm,this.header)}function p(g,m){var v=new f(m);if(v.push(g,!0),v.err)throw v.msg||l[v.err];return v.result}f.prototype.push=function(g,m){var v,b,S,E,w,C,I=this.strm,T=this.options.chunkSize,D=this.options.dictionary,O=!1;if(this.ended)return!1;b=m===~~m?m:m===!0?c.Z_FINISH:c.Z_NO_FLUSH,typeof g=="string"?I.input=a.binstring2buf(g):h.call(g)==="[object ArrayBuffer]"?I.input=new Uint8Array(g):I.input=g,I.next_in=0,I.avail_in=I.input.length;do{if(I.avail_out===0&&(I.output=new s.Buf8(T),I.next_out=0,I.avail_out=T),(v=o.inflate(I,c.Z_NO_FLUSH))===c.Z_NEED_DICT&&D&&(C=typeof D=="string"?a.string2buf(D):h.call(D)==="[object ArrayBuffer]"?new Uint8Array(D):D,v=o.inflateSetDictionary(this.strm,C)),v===c.Z_BUF_ERROR&&O===!0&&(v=c.Z_OK,O=!1),v!==c.Z_STREAM_END&&v!==c.Z_OK)return this.onEnd(v),!(this.ended=!0);I.next_out&&(I.avail_out!==0&&v!==c.Z_STREAM_END&&(I.avail_in!==0||b!==c.Z_FINISH&&b!==c.Z_SYNC_FLUSH)||(this.options.to==="string"?(S=a.utf8border(I.output,I.next_out),E=I.next_out-S,w=a.buf2string(I.output,S),I.next_out=E,I.avail_out=T-E,E&&s.arraySet(I.output,I.output,S,E,0),this.onData(w)):this.onData(s.shrinkBuf(I.output,I.next_out)))),I.avail_in===0&&I.avail_out===0&&(O=!0)}while((0<I.avail_in||I.avail_out===0)&&v!==c.Z_STREAM_END);return v===c.Z_STREAM_END&&(b=c.Z_FINISH),b===c.Z_FINISH?(v=o.inflateEnd(this.strm),this.onEnd(v),this.ended=!0,v===c.Z_OK):b!==c.Z_SYNC_FLUSH||(this.onEnd(c.Z_OK),!(I.avail_out=0))},f.prototype.onData=function(g){this.chunks.push(g)},f.prototype.onEnd=function(g){g===c.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=g,this.msg=this.strm.msg},i.Inflate=f,i.inflate=p,i.inflateRaw=function(g,m){return(m=m||{}).raw=!0,p(g,m)},i.ungzip=p},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,r,i){var o=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";i.assign=function(c){for(var l=Array.prototype.slice.call(arguments,1);l.length;){var u=l.shift();if(u){if(typeof u!="object")throw new TypeError(u+"must be non-object");for(var d in u)u.hasOwnProperty(d)&&(c[d]=u[d])}}return c},i.shrinkBuf=function(c,l){return c.length===l?c:c.subarray?c.subarray(0,l):(c.length=l,c)};var s={arraySet:function(c,l,u,d,h){if(l.subarray&&c.subarray)c.set(l.subarray(u,u+d),h);else for(var f=0;f<d;f++)c[h+f]=l[u+f]},flattenChunks:function(c){var l,u,d,h,f,p;for(l=d=0,u=c.length;l<u;l++)d+=c[l].length;for(p=new Uint8Array(d),l=h=0,u=c.length;l<u;l++)f=c[l],p.set(f,h),h+=f.length;return p}},a={arraySet:function(c,l,u,d,h){for(var f=0;f<d;f++)c[h+f]=l[u+f]},flattenChunks:function(c){return[].concat.apply([],c)}};i.setTyped=function(c){c?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,s)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,a))},i.setTyped(o)},{}],42:[function(t,r,i){var o=t("./common"),s=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch{s=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{a=!1}for(var c=new o.Buf8(256),l=0;l<256;l++)c[l]=252<=l?6:248<=l?5:240<=l?4:224<=l?3:192<=l?2:1;function u(d,h){if(h<65537&&(d.subarray&&a||!d.subarray&&s))return String.fromCharCode.apply(null,o.shrinkBuf(d,h));for(var f="",p=0;p<h;p++)f+=String.fromCharCode(d[p]);return f}c[254]=c[254]=1,i.string2buf=function(d){var h,f,p,g,m,v=d.length,b=0;for(g=0;g<v;g++)(64512&(f=d.charCodeAt(g)))==55296&&g+1<v&&(64512&(p=d.charCodeAt(g+1)))==56320&&(f=65536+(f-55296<<10)+(p-56320),g++),b+=f<128?1:f<2048?2:f<65536?3:4;for(h=new o.Buf8(b),g=m=0;m<b;g++)(64512&(f=d.charCodeAt(g)))==55296&&g+1<v&&(64512&(p=d.charCodeAt(g+1)))==56320&&(f=65536+(f-55296<<10)+(p-56320),g++),f<128?h[m++]=f:(f<2048?h[m++]=192|f>>>6:(f<65536?h[m++]=224|f>>>12:(h[m++]=240|f>>>18,h[m++]=128|f>>>12&63),h[m++]=128|f>>>6&63),h[m++]=128|63&f);return h},i.buf2binstring=function(d){return u(d,d.length)},i.binstring2buf=function(d){for(var h=new o.Buf8(d.length),f=0,p=h.length;f<p;f++)h[f]=d.charCodeAt(f);return h},i.buf2string=function(d,h){var f,p,g,m,v=h||d.length,b=new Array(2*v);for(f=p=0;f<v;)if((g=d[f++])<128)b[p++]=g;else if(4<(m=c[g]))b[p++]=65533,f+=m-1;else{for(g&=m===2?31:m===3?15:7;1<m&&f<v;)g=g<<6|63&d[f++],m--;1<m?b[p++]=65533:g<65536?b[p++]=g:(g-=65536,b[p++]=55296|g>>10&1023,b[p++]=56320|1023&g)}return u(b,p)},i.utf8border=function(d,h){var f;for((h=h||d.length)>d.length&&(h=d.length),f=h-1;0<=f&&(192&d[f])==128;)f--;return f<0||f===0?h:f+c[d[f]]>h?f:h}},{"./common":41}],43:[function(t,r,i){r.exports=function(o,s,a,c){for(var l=65535&o|0,u=o>>>16&65535|0,d=0;a!==0;){for(a-=d=2e3<a?2e3:a;u=u+(l=l+s[c++]|0)|0,--d;);l%=65521,u%=65521}return l|u<<16|0}},{}],44:[function(t,r,i){r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,r,i){var o=function(){for(var s,a=[],c=0;c<256;c++){s=c;for(var l=0;l<8;l++)s=1&s?3988292384^s>>>1:s>>>1;a[c]=s}return a}();r.exports=function(s,a,c,l){var u=o,d=l+c;s^=-1;for(var h=l;h<d;h++)s=s>>>8^u[255&(s^a[h])];return-1^s}},{}],46:[function(t,r,i){var o,s=t("../utils/common"),a=t("./trees"),c=t("./adler32"),l=t("./crc32"),u=t("./messages"),d=0,h=4,f=0,p=-2,g=-1,m=4,v=2,b=8,S=9,E=286,w=30,C=19,I=2*E+1,T=15,D=3,O=258,M=O+D+1,R=42,A=113,k=1,L=2,j=3,N=4;function B(V,le){return V.msg=u[le],le}function U(V){return(V<<1)-(4<V?9:0)}function K(V){for(var le=V.length;0<=--le;)V[le]=0}function z(V){var le=V.state,he=le.pending;he>V.avail_out&&(he=V.avail_out),he!==0&&(s.arraySet(V.output,le.pending_buf,le.pending_out,he,V.next_out),V.next_out+=he,le.pending_out+=he,V.total_out+=he,V.avail_out-=he,le.pending-=he,le.pending===0&&(le.pending_out=0))}function G(V,le){a._tr_flush_block(V,0<=V.block_start?V.block_start:-1,V.strstart-V.block_start,le),V.block_start=V.strstart,z(V.strm)}function te(V,le){V.pending_buf[V.pending++]=le}function ie(V,le){V.pending_buf[V.pending++]=le>>>8&255,V.pending_buf[V.pending++]=255&le}function Q(V,le){var he,oe,ne=V.max_chain_length,ce=V.strstart,Ae=V.prev_length,Ie=V.nice_match,be=V.strstart>V.w_size-M?V.strstart-(V.w_size-M):0,De=V.window,Me=V.w_mask,He=V.prev,Je=V.strstart+O,qe=De[ce+Ae-1],Ge=De[ce+Ae];V.prev_length>=V.good_match&&(ne>>=2),Ie>V.lookahead&&(Ie=V.lookahead);do if(De[(he=le)+Ae]===Ge&&De[he+Ae-1]===qe&&De[he]===De[ce]&&De[++he]===De[ce+1]){ce+=2,he++;do;while(De[++ce]===De[++he]&&De[++ce]===De[++he]&&De[++ce]===De[++he]&&De[++ce]===De[++he]&&De[++ce]===De[++he]&&De[++ce]===De[++he]&&De[++ce]===De[++he]&&De[++ce]===De[++he]&&ce<Je);if(oe=O-(Je-ce),ce=Je-O,Ae<oe){if(V.match_start=le,Ie<=(Ae=oe))break;qe=De[ce+Ae-1],Ge=De[ce+Ae]}}while((le=He[le&Me])>be&&--ne!=0);return Ae<=V.lookahead?Ae:V.lookahead}function ge(V){var le,he,oe,ne,ce,Ae,Ie,be,De,Me,He=V.w_size;do{if(ne=V.window_size-V.lookahead-V.strstart,V.strstart>=He+(He-M)){for(s.arraySet(V.window,V.window,He,He,0),V.match_start-=He,V.strstart-=He,V.block_start-=He,le=he=V.hash_size;oe=V.head[--le],V.head[le]=He<=oe?oe-He:0,--he;);for(le=he=He;oe=V.prev[--le],V.prev[le]=He<=oe?oe-He:0,--he;);ne+=He}if(V.strm.avail_in===0)break;if(Ae=V.strm,Ie=V.window,be=V.strstart+V.lookahead,De=ne,Me=void 0,Me=Ae.avail_in,De<Me&&(Me=De),he=Me===0?0:(Ae.avail_in-=Me,s.arraySet(Ie,Ae.input,Ae.next_in,Me,be),Ae.state.wrap===1?Ae.adler=c(Ae.adler,Ie,Me,be):Ae.state.wrap===2&&(Ae.adler=l(Ae.adler,Ie,Me,be)),Ae.next_in+=Me,Ae.total_in+=Me,Me),V.lookahead+=he,V.lookahead+V.insert>=D)for(ce=V.strstart-V.insert,V.ins_h=V.window[ce],V.ins_h=(V.ins_h<<V.hash_shift^V.window[ce+1])&V.hash_mask;V.insert&&(V.ins_h=(V.ins_h<<V.hash_shift^V.window[ce+D-1])&V.hash_mask,V.prev[ce&V.w_mask]=V.head[V.ins_h],V.head[V.ins_h]=ce,ce++,V.insert--,!(V.lookahead+V.insert<D)););}while(V.lookahead<M&&V.strm.avail_in!==0)}function _e(V,le){for(var he,oe;;){if(V.lookahead<M){if(ge(V),V.lookahead<M&&le===d)return k;if(V.lookahead===0)break}if(he=0,V.lookahead>=D&&(V.ins_h=(V.ins_h<<V.hash_shift^V.window[V.strstart+D-1])&V.hash_mask,he=V.prev[V.strstart&V.w_mask]=V.head[V.ins_h],V.head[V.ins_h]=V.strstart),he!==0&&V.strstart-he<=V.w_size-M&&(V.match_length=Q(V,he)),V.match_length>=D)if(oe=a._tr_tally(V,V.strstart-V.match_start,V.match_length-D),V.lookahead-=V.match_length,V.match_length<=V.max_lazy_match&&V.lookahead>=D){for(V.match_length--;V.strstart++,V.ins_h=(V.ins_h<<V.hash_shift^V.window[V.strstart+D-1])&V.hash_mask,he=V.prev[V.strstart&V.w_mask]=V.head[V.ins_h],V.head[V.ins_h]=V.strstart,--V.match_length!=0;);V.strstart++}else V.strstart+=V.match_length,V.match_length=0,V.ins_h=V.window[V.strstart],V.ins_h=(V.ins_h<<V.hash_shift^V.window[V.strstart+1])&V.hash_mask;else oe=a._tr_tally(V,0,V.window[V.strstart]),V.lookahead--,V.strstart++;if(oe&&(G(V,!1),V.strm.avail_out===0))return k}return V.insert=V.strstart<D-1?V.strstart:D-1,le===h?(G(V,!0),V.strm.avail_out===0?j:N):V.last_lit&&(G(V,!1),V.strm.avail_out===0)?k:L}function Se(V,le){for(var he,oe,ne;;){if(V.lookahead<M){if(ge(V),V.lookahead<M&&le===d)return k;if(V.lookahead===0)break}if(he=0,V.lookahead>=D&&(V.ins_h=(V.ins_h<<V.hash_shift^V.window[V.strstart+D-1])&V.hash_mask,he=V.prev[V.strstart&V.w_mask]=V.head[V.ins_h],V.head[V.ins_h]=V.strstart),V.prev_length=V.match_length,V.prev_match=V.match_start,V.match_length=D-1,he!==0&&V.prev_length<V.max_lazy_match&&V.strstart-he<=V.w_size-M&&(V.match_length=Q(V,he),V.match_length<=5&&(V.strategy===1||V.match_length===D&&4096<V.strstart-V.match_start)&&(V.match_length=D-1)),V.prev_length>=D&&V.match_length<=V.prev_length){for(ne=V.strstart+V.lookahead-D,oe=a._tr_tally(V,V.strstart-1-V.prev_match,V.prev_length-D),V.lookahead-=V.prev_length-1,V.prev_length-=2;++V.strstart<=ne&&(V.ins_h=(V.ins_h<<V.hash_shift^V.window[V.strstart+D-1])&V.hash_mask,he=V.prev[V.strstart&V.w_mask]=V.head[V.ins_h],V.head[V.ins_h]=V.strstart),--V.prev_length!=0;);if(V.match_available=0,V.match_length=D-1,V.strstart++,oe&&(G(V,!1),V.strm.avail_out===0))return k}else if(V.match_available){if((oe=a._tr_tally(V,0,V.window[V.strstart-1]))&&G(V,!1),V.strstart++,V.lookahead--,V.strm.avail_out===0)return k}else V.match_available=1,V.strstart++,V.lookahead--}return V.match_available&&(oe=a._tr_tally(V,0,V.window[V.strstart-1]),V.match_available=0),V.insert=V.strstart<D-1?V.strstart:D-1,le===h?(G(V,!0),V.strm.avail_out===0?j:N):V.last_lit&&(G(V,!1),V.strm.avail_out===0)?k:L}function se(V,le,he,oe,ne){this.good_length=V,this.max_lazy=le,this.nice_length=he,this.max_chain=oe,this.func=ne}function ee(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=b,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new s.Buf16(2*I),this.dyn_dtree=new s.Buf16(2*(2*w+1)),this.bl_tree=new s.Buf16(2*(2*C+1)),K(this.dyn_ltree),K(this.dyn_dtree),K(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new s.Buf16(T+1),this.heap=new s.Buf16(2*E+1),K(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new s.Buf16(2*E+1),K(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Y(V){var le;return V&&V.state?(V.total_in=V.total_out=0,V.data_type=v,(le=V.state).pending=0,le.pending_out=0,le.wrap<0&&(le.wrap=-le.wrap),le.status=le.wrap?R:A,V.adler=le.wrap===2?0:1,le.last_flush=d,a._tr_init(le),f):B(V,p)}function ue(V){var le=Y(V);return le===f&&function(he){he.window_size=2*he.w_size,K(he.head),he.max_lazy_match=o[he.level].max_lazy,he.good_match=o[he.level].good_length,he.nice_match=o[he.level].nice_length,he.max_chain_length=o[he.level].max_chain,he.strstart=0,he.block_start=0,he.lookahead=0,he.insert=0,he.match_length=he.prev_length=D-1,he.match_available=0,he.ins_h=0}(V.state),le}function ye(V,le,he,oe,ne,ce){if(!V)return p;var Ae=1;if(le===g&&(le=6),oe<0?(Ae=0,oe=-oe):15<oe&&(Ae=2,oe-=16),ne<1||S<ne||he!==b||oe<8||15<oe||le<0||9<le||ce<0||m<ce)return B(V,p);oe===8&&(oe=9);var Ie=new ee;return(V.state=Ie).strm=V,Ie.wrap=Ae,Ie.gzhead=null,Ie.w_bits=oe,Ie.w_size=1<<Ie.w_bits,Ie.w_mask=Ie.w_size-1,Ie.hash_bits=ne+7,Ie.hash_size=1<<Ie.hash_bits,Ie.hash_mask=Ie.hash_size-1,Ie.hash_shift=~~((Ie.hash_bits+D-1)/D),Ie.window=new s.Buf8(2*Ie.w_size),Ie.head=new s.Buf16(Ie.hash_size),Ie.prev=new s.Buf16(Ie.w_size),Ie.lit_bufsize=1<<ne+6,Ie.pending_buf_size=4*Ie.lit_bufsize,Ie.pending_buf=new s.Buf8(Ie.pending_buf_size),Ie.d_buf=1*Ie.lit_bufsize,Ie.l_buf=3*Ie.lit_bufsize,Ie.level=le,Ie.strategy=ce,Ie.method=he,ue(V)}o=[new se(0,0,0,0,function(V,le){var he=65535;for(he>V.pending_buf_size-5&&(he=V.pending_buf_size-5);;){if(V.lookahead<=1){if(ge(V),V.lookahead===0&&le===d)return k;if(V.lookahead===0)break}V.strstart+=V.lookahead,V.lookahead=0;var oe=V.block_start+he;if((V.strstart===0||V.strstart>=oe)&&(V.lookahead=V.strstart-oe,V.strstart=oe,G(V,!1),V.strm.avail_out===0)||V.strstart-V.block_start>=V.w_size-M&&(G(V,!1),V.strm.avail_out===0))return k}return V.insert=0,le===h?(G(V,!0),V.strm.avail_out===0?j:N):(V.strstart>V.block_start&&(G(V,!1),V.strm.avail_out),k)}),new se(4,4,8,4,_e),new se(4,5,16,8,_e),new se(4,6,32,32,_e),new se(4,4,16,16,Se),new se(8,16,32,32,Se),new se(8,16,128,128,Se),new se(8,32,128,256,Se),new se(32,128,258,1024,Se),new se(32,258,258,4096,Se)],i.deflateInit=function(V,le){return ye(V,le,b,15,8,0)},i.deflateInit2=ye,i.deflateReset=ue,i.deflateResetKeep=Y,i.deflateSetHeader=function(V,le){return V&&V.state?V.state.wrap!==2?p:(V.state.gzhead=le,f):p},i.deflate=function(V,le){var he,oe,ne,ce;if(!V||!V.state||5<le||le<0)return V?B(V,p):p;if(oe=V.state,!V.output||!V.input&&V.avail_in!==0||oe.status===666&&le!==h)return B(V,V.avail_out===0?-5:p);if(oe.strm=V,he=oe.last_flush,oe.last_flush=le,oe.status===R)if(oe.wrap===2)V.adler=0,te(oe,31),te(oe,139),te(oe,8),oe.gzhead?(te(oe,(oe.gzhead.text?1:0)+(oe.gzhead.hcrc?2:0)+(oe.gzhead.extra?4:0)+(oe.gzhead.name?8:0)+(oe.gzhead.comment?16:0)),te(oe,255&oe.gzhead.time),te(oe,oe.gzhead.time>>8&255),te(oe,oe.gzhead.time>>16&255),te(oe,oe.gzhead.time>>24&255),te(oe,oe.level===9?2:2<=oe.strategy||oe.level<2?4:0),te(oe,255&oe.gzhead.os),oe.gzhead.extra&&oe.gzhead.extra.length&&(te(oe,255&oe.gzhead.extra.length),te(oe,oe.gzhead.extra.length>>8&255)),oe.gzhead.hcrc&&(V.adler=l(V.adler,oe.pending_buf,oe.pending,0)),oe.gzindex=0,oe.status=69):(te(oe,0),te(oe,0),te(oe,0),te(oe,0),te(oe,0),te(oe,oe.level===9?2:2<=oe.strategy||oe.level<2?4:0),te(oe,3),oe.status=A);else{var Ae=b+(oe.w_bits-8<<4)<<8;Ae|=(2<=oe.strategy||oe.level<2?0:oe.level<6?1:oe.level===6?2:3)<<6,oe.strstart!==0&&(Ae|=32),Ae+=31-Ae%31,oe.status=A,ie(oe,Ae),oe.strstart!==0&&(ie(oe,V.adler>>>16),ie(oe,65535&V.adler)),V.adler=1}if(oe.status===69)if(oe.gzhead.extra){for(ne=oe.pending;oe.gzindex<(65535&oe.gzhead.extra.length)&&(oe.pending!==oe.pending_buf_size||(oe.gzhead.hcrc&&oe.pending>ne&&(V.adler=l(V.adler,oe.pending_buf,oe.pending-ne,ne)),z(V),ne=oe.pending,oe.pending!==oe.pending_buf_size));)te(oe,255&oe.gzhead.extra[oe.gzindex]),oe.gzindex++;oe.gzhead.hcrc&&oe.pending>ne&&(V.adler=l(V.adler,oe.pending_buf,oe.pending-ne,ne)),oe.gzindex===oe.gzhead.extra.length&&(oe.gzindex=0,oe.status=73)}else oe.status=73;if(oe.status===73)if(oe.gzhead.name){ne=oe.pending;do{if(oe.pending===oe.pending_buf_size&&(oe.gzhead.hcrc&&oe.pending>ne&&(V.adler=l(V.adler,oe.pending_buf,oe.pending-ne,ne)),z(V),ne=oe.pending,oe.pending===oe.pending_buf_size)){ce=1;break}ce=oe.gzindex<oe.gzhead.name.length?255&oe.gzhead.name.charCodeAt(oe.gzindex++):0,te(oe,ce)}while(ce!==0);oe.gzhead.hcrc&&oe.pending>ne&&(V.adler=l(V.adler,oe.pending_buf,oe.pending-ne,ne)),ce===0&&(oe.gzindex=0,oe.status=91)}else oe.status=91;if(oe.status===91)if(oe.gzhead.comment){ne=oe.pending;do{if(oe.pending===oe.pending_buf_size&&(oe.gzhead.hcrc&&oe.pending>ne&&(V.adler=l(V.adler,oe.pending_buf,oe.pending-ne,ne)),z(V),ne=oe.pending,oe.pending===oe.pending_buf_size)){ce=1;break}ce=oe.gzindex<oe.gzhead.comment.length?255&oe.gzhead.comment.charCodeAt(oe.gzindex++):0,te(oe,ce)}while(ce!==0);oe.gzhead.hcrc&&oe.pending>ne&&(V.adler=l(V.adler,oe.pending_buf,oe.pending-ne,ne)),ce===0&&(oe.status=103)}else oe.status=103;if(oe.status===103&&(oe.gzhead.hcrc?(oe.pending+2>oe.pending_buf_size&&z(V),oe.pending+2<=oe.pending_buf_size&&(te(oe,255&V.adler),te(oe,V.adler>>8&255),V.adler=0,oe.status=A)):oe.status=A),oe.pending!==0){if(z(V),V.avail_out===0)return oe.last_flush=-1,f}else if(V.avail_in===0&&U(le)<=U(he)&&le!==h)return B(V,-5);if(oe.status===666&&V.avail_in!==0)return B(V,-5);if(V.avail_in!==0||oe.lookahead!==0||le!==d&&oe.status!==666){var Ie=oe.strategy===2?function(be,De){for(var Me;;){if(be.lookahead===0&&(ge(be),be.lookahead===0)){if(De===d)return k;break}if(be.match_length=0,Me=a._tr_tally(be,0,be.window[be.strstart]),be.lookahead--,be.strstart++,Me&&(G(be,!1),be.strm.avail_out===0))return k}return be.insert=0,De===h?(G(be,!0),be.strm.avail_out===0?j:N):be.last_lit&&(G(be,!1),be.strm.avail_out===0)?k:L}(oe,le):oe.strategy===3?function(be,De){for(var Me,He,Je,qe,Ge=be.window;;){if(be.lookahead<=O){if(ge(be),be.lookahead<=O&&De===d)return k;if(be.lookahead===0)break}if(be.match_length=0,be.lookahead>=D&&0<be.strstart&&(He=Ge[Je=be.strstart-1])===Ge[++Je]&&He===Ge[++Je]&&He===Ge[++Je]){qe=be.strstart+O;do;while(He===Ge[++Je]&&He===Ge[++Je]&&He===Ge[++Je]&&He===Ge[++Je]&&He===Ge[++Je]&&He===Ge[++Je]&&He===Ge[++Je]&&He===Ge[++Je]&&Je<qe);be.match_length=O-(qe-Je),be.match_length>be.lookahead&&(be.match_length=be.lookahead)}if(be.match_length>=D?(Me=a._tr_tally(be,1,be.match_length-D),be.lookahead-=be.match_length,be.strstart+=be.match_length,be.match_length=0):(Me=a._tr_tally(be,0,be.window[be.strstart]),be.lookahead--,be.strstart++),Me&&(G(be,!1),be.strm.avail_out===0))return k}return be.insert=0,De===h?(G(be,!0),be.strm.avail_out===0?j:N):be.last_lit&&(G(be,!1),be.strm.avail_out===0)?k:L}(oe,le):o[oe.level].func(oe,le);if(Ie!==j&&Ie!==N||(oe.status=666),Ie===k||Ie===j)return V.avail_out===0&&(oe.last_flush=-1),f;if(Ie===L&&(le===1?a._tr_align(oe):le!==5&&(a._tr_stored_block(oe,0,0,!1),le===3&&(K(oe.head),oe.lookahead===0&&(oe.strstart=0,oe.block_start=0,oe.insert=0))),z(V),V.avail_out===0))return oe.last_flush=-1,f}return le!==h?f:oe.wrap<=0?1:(oe.wrap===2?(te(oe,255&V.adler),te(oe,V.adler>>8&255),te(oe,V.adler>>16&255),te(oe,V.adler>>24&255),te(oe,255&V.total_in),te(oe,V.total_in>>8&255),te(oe,V.total_in>>16&255),te(oe,V.total_in>>24&255)):(ie(oe,V.adler>>>16),ie(oe,65535&V.adler)),z(V),0<oe.wrap&&(oe.wrap=-oe.wrap),oe.pending!==0?f:1)},i.deflateEnd=function(V){var le;return V&&V.state?(le=V.state.status)!==R&&le!==69&&le!==73&&le!==91&&le!==103&&le!==A&&le!==666?B(V,p):(V.state=null,le===A?B(V,-3):f):p},i.deflateSetDictionary=function(V,le){var he,oe,ne,ce,Ae,Ie,be,De,Me=le.length;if(!V||!V.state||(ce=(he=V.state).wrap)===2||ce===1&&he.status!==R||he.lookahead)return p;for(ce===1&&(V.adler=c(V.adler,le,Me,0)),he.wrap=0,Me>=he.w_size&&(ce===0&&(K(he.head),he.strstart=0,he.block_start=0,he.insert=0),De=new s.Buf8(he.w_size),s.arraySet(De,le,Me-he.w_size,he.w_size,0),le=De,Me=he.w_size),Ae=V.avail_in,Ie=V.next_in,be=V.input,V.avail_in=Me,V.next_in=0,V.input=le,ge(he);he.lookahead>=D;){for(oe=he.strstart,ne=he.lookahead-(D-1);he.ins_h=(he.ins_h<<he.hash_shift^he.window[oe+D-1])&he.hash_mask,he.prev[oe&he.w_mask]=he.head[he.ins_h],he.head[he.ins_h]=oe,oe++,--ne;);he.strstart=oe,he.lookahead=D-1,ge(he)}return he.strstart+=he.lookahead,he.block_start=he.strstart,he.insert=he.lookahead,he.lookahead=0,he.match_length=he.prev_length=D-1,he.match_available=0,V.next_in=Ie,V.input=be,V.avail_in=Ae,he.wrap=ce,f},i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,r,i){r.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(t,r,i){r.exports=function(o,s){var a,c,l,u,d,h,f,p,g,m,v,b,S,E,w,C,I,T,D,O,M,R,A,k,L;a=o.state,c=o.next_in,k=o.input,l=c+(o.avail_in-5),u=o.next_out,L=o.output,d=u-(s-o.avail_out),h=u+(o.avail_out-257),f=a.dmax,p=a.wsize,g=a.whave,m=a.wnext,v=a.window,b=a.hold,S=a.bits,E=a.lencode,w=a.distcode,C=(1<<a.lenbits)-1,I=(1<<a.distbits)-1;e:do{S<15&&(b+=k[c++]<<S,S+=8,b+=k[c++]<<S,S+=8),T=E[b&C];t:for(;;){if(b>>>=D=T>>>24,S-=D,(D=T>>>16&255)===0)L[u++]=65535&T;else{if(!(16&D)){if(!(64&D)){T=E[(65535&T)+(b&(1<<D)-1)];continue t}if(32&D){a.mode=12;break e}o.msg="invalid literal/length code",a.mode=30;break e}O=65535&T,(D&=15)&&(S<D&&(b+=k[c++]<<S,S+=8),O+=b&(1<<D)-1,b>>>=D,S-=D),S<15&&(b+=k[c++]<<S,S+=8,b+=k[c++]<<S,S+=8),T=w[b&I];n:for(;;){if(b>>>=D=T>>>24,S-=D,!(16&(D=T>>>16&255))){if(!(64&D)){T=w[(65535&T)+(b&(1<<D)-1)];continue n}o.msg="invalid distance code",a.mode=30;break e}if(M=65535&T,S<(D&=15)&&(b+=k[c++]<<S,(S+=8)<D&&(b+=k[c++]<<S,S+=8)),f<(M+=b&(1<<D)-1)){o.msg="invalid distance too far back",a.mode=30;break e}if(b>>>=D,S-=D,(D=u-d)<M){if(g<(D=M-D)&&a.sane){o.msg="invalid distance too far back",a.mode=30;break e}if(A=v,(R=0)===m){if(R+=p-D,D<O){for(O-=D;L[u++]=v[R++],--D;);R=u-M,A=L}}else if(m<D){if(R+=p+m-D,(D-=m)<O){for(O-=D;L[u++]=v[R++],--D;);if(R=0,m<O){for(O-=D=m;L[u++]=v[R++],--D;);R=u-M,A=L}}}else if(R+=m-D,D<O){for(O-=D;L[u++]=v[R++],--D;);R=u-M,A=L}for(;2<O;)L[u++]=A[R++],L[u++]=A[R++],L[u++]=A[R++],O-=3;O&&(L[u++]=A[R++],1<O&&(L[u++]=A[R++]))}else{for(R=u-M;L[u++]=L[R++],L[u++]=L[R++],L[u++]=L[R++],2<(O-=3););O&&(L[u++]=L[R++],1<O&&(L[u++]=L[R++]))}break}}break}}while(c<l&&u<h);c-=O=S>>3,b&=(1<<(S-=O<<3))-1,o.next_in=c,o.next_out=u,o.avail_in=c<l?l-c+5:5-(c-l),o.avail_out=u<h?h-u+257:257-(u-h),a.hold=b,a.bits=S}},{}],49:[function(t,r,i){var o=t("../utils/common"),s=t("./adler32"),a=t("./crc32"),c=t("./inffast"),l=t("./inftrees"),u=1,d=2,h=0,f=-2,p=1,g=852,m=592;function v(R){return(R>>>24&255)+(R>>>8&65280)+((65280&R)<<8)+((255&R)<<24)}function b(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new o.Buf16(320),this.work=new o.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function S(R){var A;return R&&R.state?(A=R.state,R.total_in=R.total_out=A.total=0,R.msg="",A.wrap&&(R.adler=1&A.wrap),A.mode=p,A.last=0,A.havedict=0,A.dmax=32768,A.head=null,A.hold=0,A.bits=0,A.lencode=A.lendyn=new o.Buf32(g),A.distcode=A.distdyn=new o.Buf32(m),A.sane=1,A.back=-1,h):f}function E(R){var A;return R&&R.state?((A=R.state).wsize=0,A.whave=0,A.wnext=0,S(R)):f}function w(R,A){var k,L;return R&&R.state?(L=R.state,A<0?(k=0,A=-A):(k=1+(A>>4),A<48&&(A&=15)),A&&(A<8||15<A)?f:(L.window!==null&&L.wbits!==A&&(L.window=null),L.wrap=k,L.wbits=A,E(R))):f}function C(R,A){var k,L;return R?(L=new b,(R.state=L).window=null,(k=w(R,A))!==h&&(R.state=null),k):f}var I,T,D=!0;function O(R){if(D){var A;for(I=new o.Buf32(512),T=new o.Buf32(32),A=0;A<144;)R.lens[A++]=8;for(;A<256;)R.lens[A++]=9;for(;A<280;)R.lens[A++]=7;for(;A<288;)R.lens[A++]=8;for(l(u,R.lens,0,288,I,0,R.work,{bits:9}),A=0;A<32;)R.lens[A++]=5;l(d,R.lens,0,32,T,0,R.work,{bits:5}),D=!1}R.lencode=I,R.lenbits=9,R.distcode=T,R.distbits=5}function M(R,A,k,L){var j,N=R.state;return N.window===null&&(N.wsize=1<<N.wbits,N.wnext=0,N.whave=0,N.window=new o.Buf8(N.wsize)),L>=N.wsize?(o.arraySet(N.window,A,k-N.wsize,N.wsize,0),N.wnext=0,N.whave=N.wsize):(L<(j=N.wsize-N.wnext)&&(j=L),o.arraySet(N.window,A,k-L,j,N.wnext),(L-=j)?(o.arraySet(N.window,A,k-L,L,0),N.wnext=L,N.whave=N.wsize):(N.wnext+=j,N.wnext===N.wsize&&(N.wnext=0),N.whave<N.wsize&&(N.whave+=j))),0}i.inflateReset=E,i.inflateReset2=w,i.inflateResetKeep=S,i.inflateInit=function(R){return C(R,15)},i.inflateInit2=C,i.inflate=function(R,A){var k,L,j,N,B,U,K,z,G,te,ie,Q,ge,_e,Se,se,ee,Y,ue,ye,V,le,he,oe,ne=0,ce=new o.Buf8(4),Ae=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!R||!R.state||!R.output||!R.input&&R.avail_in!==0)return f;(k=R.state).mode===12&&(k.mode=13),B=R.next_out,j=R.output,K=R.avail_out,N=R.next_in,L=R.input,U=R.avail_in,z=k.hold,G=k.bits,te=U,ie=K,le=h;e:for(;;)switch(k.mode){case p:if(k.wrap===0){k.mode=13;break}for(;G<16;){if(U===0)break e;U--,z+=L[N++]<<G,G+=8}if(2&k.wrap&&z===35615){ce[k.check=0]=255&z,ce[1]=z>>>8&255,k.check=a(k.check,ce,2,0),G=z=0,k.mode=2;break}if(k.flags=0,k.head&&(k.head.done=!1),!(1&k.wrap)||(((255&z)<<8)+(z>>8))%31){R.msg="incorrect header check",k.mode=30;break}if((15&z)!=8){R.msg="unknown compression method",k.mode=30;break}if(G-=4,V=8+(15&(z>>>=4)),k.wbits===0)k.wbits=V;else if(V>k.wbits){R.msg="invalid window size",k.mode=30;break}k.dmax=1<<V,R.adler=k.check=1,k.mode=512&z?10:12,G=z=0;break;case 2:for(;G<16;){if(U===0)break e;U--,z+=L[N++]<<G,G+=8}if(k.flags=z,(255&k.flags)!=8){R.msg="unknown compression method",k.mode=30;break}if(57344&k.flags){R.msg="unknown header flags set",k.mode=30;break}k.head&&(k.head.text=z>>8&1),512&k.flags&&(ce[0]=255&z,ce[1]=z>>>8&255,k.check=a(k.check,ce,2,0)),G=z=0,k.mode=3;case 3:for(;G<32;){if(U===0)break e;U--,z+=L[N++]<<G,G+=8}k.head&&(k.head.time=z),512&k.flags&&(ce[0]=255&z,ce[1]=z>>>8&255,ce[2]=z>>>16&255,ce[3]=z>>>24&255,k.check=a(k.check,ce,4,0)),G=z=0,k.mode=4;case 4:for(;G<16;){if(U===0)break e;U--,z+=L[N++]<<G,G+=8}k.head&&(k.head.xflags=255&z,k.head.os=z>>8),512&k.flags&&(ce[0]=255&z,ce[1]=z>>>8&255,k.check=a(k.check,ce,2,0)),G=z=0,k.mode=5;case 5:if(1024&k.flags){for(;G<16;){if(U===0)break e;U--,z+=L[N++]<<G,G+=8}k.length=z,k.head&&(k.head.extra_len=z),512&k.flags&&(ce[0]=255&z,ce[1]=z>>>8&255,k.check=a(k.check,ce,2,0)),G=z=0}else k.head&&(k.head.extra=null);k.mode=6;case 6:if(1024&k.flags&&(U<(Q=k.length)&&(Q=U),Q&&(k.head&&(V=k.head.extra_len-k.length,k.head.extra||(k.head.extra=new Array(k.head.extra_len)),o.arraySet(k.head.extra,L,N,Q,V)),512&k.flags&&(k.check=a(k.check,L,Q,N)),U-=Q,N+=Q,k.length-=Q),k.length))break e;k.length=0,k.mode=7;case 7:if(2048&k.flags){if(U===0)break e;for(Q=0;V=L[N+Q++],k.head&&V&&k.length<65536&&(k.head.name+=String.fromCharCode(V)),V&&Q<U;);if(512&k.flags&&(k.check=a(k.check,L,Q,N)),U-=Q,N+=Q,V)break e}else k.head&&(k.head.name=null);k.length=0,k.mode=8;case 8:if(4096&k.flags){if(U===0)break e;for(Q=0;V=L[N+Q++],k.head&&V&&k.length<65536&&(k.head.comment+=String.fromCharCode(V)),V&&Q<U;);if(512&k.flags&&(k.check=a(k.check,L,Q,N)),U-=Q,N+=Q,V)break e}else k.head&&(k.head.comment=null);k.mode=9;case 9:if(512&k.flags){for(;G<16;){if(U===0)break e;U--,z+=L[N++]<<G,G+=8}if(z!==(65535&k.check)){R.msg="header crc mismatch",k.mode=30;break}G=z=0}k.head&&(k.head.hcrc=k.flags>>9&1,k.head.done=!0),R.adler=k.check=0,k.mode=12;break;case 10:for(;G<32;){if(U===0)break e;U--,z+=L[N++]<<G,G+=8}R.adler=k.check=v(z),G=z=0,k.mode=11;case 11:if(k.havedict===0)return R.next_out=B,R.avail_out=K,R.next_in=N,R.avail_in=U,k.hold=z,k.bits=G,2;R.adler=k.check=1,k.mode=12;case 12:if(A===5||A===6)break e;case 13:if(k.last){z>>>=7&G,G-=7&G,k.mode=27;break}for(;G<3;){if(U===0)break e;U--,z+=L[N++]<<G,G+=8}switch(k.last=1&z,G-=1,3&(z>>>=1)){case 0:k.mode=14;break;case 1:if(O(k),k.mode=20,A!==6)break;z>>>=2,G-=2;break e;case 2:k.mode=17;break;case 3:R.msg="invalid block type",k.mode=30}z>>>=2,G-=2;break;case 14:for(z>>>=7&G,G-=7&G;G<32;){if(U===0)break e;U--,z+=L[N++]<<G,G+=8}if((65535&z)!=(z>>>16^65535)){R.msg="invalid stored block lengths",k.mode=30;break}if(k.length=65535&z,G=z=0,k.mode=15,A===6)break e;case 15:k.mode=16;case 16:if(Q=k.length){if(U<Q&&(Q=U),K<Q&&(Q=K),Q===0)break e;o.arraySet(j,L,N,Q,B),U-=Q,N+=Q,K-=Q,B+=Q,k.length-=Q;break}k.mode=12;break;case 17:for(;G<14;){if(U===0)break e;U--,z+=L[N++]<<G,G+=8}if(k.nlen=257+(31&z),z>>>=5,G-=5,k.ndist=1+(31&z),z>>>=5,G-=5,k.ncode=4+(15&z),z>>>=4,G-=4,286<k.nlen||30<k.ndist){R.msg="too many length or distance symbols",k.mode=30;break}k.have=0,k.mode=18;case 18:for(;k.have<k.ncode;){for(;G<3;){if(U===0)break e;U--,z+=L[N++]<<G,G+=8}k.lens[Ae[k.have++]]=7&z,z>>>=3,G-=3}for(;k.have<19;)k.lens[Ae[k.have++]]=0;if(k.lencode=k.lendyn,k.lenbits=7,he={bits:k.lenbits},le=l(0,k.lens,0,19,k.lencode,0,k.work,he),k.lenbits=he.bits,le){R.msg="invalid code lengths set",k.mode=30;break}k.have=0,k.mode=19;case 19:for(;k.have<k.nlen+k.ndist;){for(;se=(ne=k.lencode[z&(1<<k.lenbits)-1])>>>16&255,ee=65535&ne,!((Se=ne>>>24)<=G);){if(U===0)break e;U--,z+=L[N++]<<G,G+=8}if(ee<16)z>>>=Se,G-=Se,k.lens[k.have++]=ee;else{if(ee===16){for(oe=Se+2;G<oe;){if(U===0)break e;U--,z+=L[N++]<<G,G+=8}if(z>>>=Se,G-=Se,k.have===0){R.msg="invalid bit length repeat",k.mode=30;break}V=k.lens[k.have-1],Q=3+(3&z),z>>>=2,G-=2}else if(ee===17){for(oe=Se+3;G<oe;){if(U===0)break e;U--,z+=L[N++]<<G,G+=8}G-=Se,V=0,Q=3+(7&(z>>>=Se)),z>>>=3,G-=3}else{for(oe=Se+7;G<oe;){if(U===0)break e;U--,z+=L[N++]<<G,G+=8}G-=Se,V=0,Q=11+(127&(z>>>=Se)),z>>>=7,G-=7}if(k.have+Q>k.nlen+k.ndist){R.msg="invalid bit length repeat",k.mode=30;break}for(;Q--;)k.lens[k.have++]=V}}if(k.mode===30)break;if(k.lens[256]===0){R.msg="invalid code -- missing end-of-block",k.mode=30;break}if(k.lenbits=9,he={bits:k.lenbits},le=l(u,k.lens,0,k.nlen,k.lencode,0,k.work,he),k.lenbits=he.bits,le){R.msg="invalid literal/lengths set",k.mode=30;break}if(k.distbits=6,k.distcode=k.distdyn,he={bits:k.distbits},le=l(d,k.lens,k.nlen,k.ndist,k.distcode,0,k.work,he),k.distbits=he.bits,le){R.msg="invalid distances set",k.mode=30;break}if(k.mode=20,A===6)break e;case 20:k.mode=21;case 21:if(6<=U&&258<=K){R.next_out=B,R.avail_out=K,R.next_in=N,R.avail_in=U,k.hold=z,k.bits=G,c(R,ie),B=R.next_out,j=R.output,K=R.avail_out,N=R.next_in,L=R.input,U=R.avail_in,z=k.hold,G=k.bits,k.mode===12&&(k.back=-1);break}for(k.back=0;se=(ne=k.lencode[z&(1<<k.lenbits)-1])>>>16&255,ee=65535&ne,!((Se=ne>>>24)<=G);){if(U===0)break e;U--,z+=L[N++]<<G,G+=8}if(se&&!(240&se)){for(Y=Se,ue=se,ye=ee;se=(ne=k.lencode[ye+((z&(1<<Y+ue)-1)>>Y)])>>>16&255,ee=65535&ne,!(Y+(Se=ne>>>24)<=G);){if(U===0)break e;U--,z+=L[N++]<<G,G+=8}z>>>=Y,G-=Y,k.back+=Y}if(z>>>=Se,G-=Se,k.back+=Se,k.length=ee,se===0){k.mode=26;break}if(32&se){k.back=-1,k.mode=12;break}if(64&se){R.msg="invalid literal/length code",k.mode=30;break}k.extra=15&se,k.mode=22;case 22:if(k.extra){for(oe=k.extra;G<oe;){if(U===0)break e;U--,z+=L[N++]<<G,G+=8}k.length+=z&(1<<k.extra)-1,z>>>=k.extra,G-=k.extra,k.back+=k.extra}k.was=k.length,k.mode=23;case 23:for(;se=(ne=k.distcode[z&(1<<k.distbits)-1])>>>16&255,ee=65535&ne,!((Se=ne>>>24)<=G);){if(U===0)break e;U--,z+=L[N++]<<G,G+=8}if(!(240&se)){for(Y=Se,ue=se,ye=ee;se=(ne=k.distcode[ye+((z&(1<<Y+ue)-1)>>Y)])>>>16&255,ee=65535&ne,!(Y+(Se=ne>>>24)<=G);){if(U===0)break e;U--,z+=L[N++]<<G,G+=8}z>>>=Y,G-=Y,k.back+=Y}if(z>>>=Se,G-=Se,k.back+=Se,64&se){R.msg="invalid distance code",k.mode=30;break}k.offset=ee,k.extra=15&se,k.mode=24;case 24:if(k.extra){for(oe=k.extra;G<oe;){if(U===0)break e;U--,z+=L[N++]<<G,G+=8}k.offset+=z&(1<<k.extra)-1,z>>>=k.extra,G-=k.extra,k.back+=k.extra}if(k.offset>k.dmax){R.msg="invalid distance too far back",k.mode=30;break}k.mode=25;case 25:if(K===0)break e;if(Q=ie-K,k.offset>Q){if((Q=k.offset-Q)>k.whave&&k.sane){R.msg="invalid distance too far back",k.mode=30;break}ge=Q>k.wnext?(Q-=k.wnext,k.wsize-Q):k.wnext-Q,Q>k.length&&(Q=k.length),_e=k.window}else _e=j,ge=B-k.offset,Q=k.length;for(K<Q&&(Q=K),K-=Q,k.length-=Q;j[B++]=_e[ge++],--Q;);k.length===0&&(k.mode=21);break;case 26:if(K===0)break e;j[B++]=k.length,K--,k.mode=21;break;case 27:if(k.wrap){for(;G<32;){if(U===0)break e;U--,z|=L[N++]<<G,G+=8}if(ie-=K,R.total_out+=ie,k.total+=ie,ie&&(R.adler=k.check=k.flags?a(k.check,j,ie,B-ie):s(k.check,j,ie,B-ie)),ie=K,(k.flags?z:v(z))!==k.check){R.msg="incorrect data check",k.mode=30;break}G=z=0}k.mode=28;case 28:if(k.wrap&&k.flags){for(;G<32;){if(U===0)break e;U--,z+=L[N++]<<G,G+=8}if(z!==(4294967295&k.total)){R.msg="incorrect length check",k.mode=30;break}G=z=0}k.mode=29;case 29:le=1;break e;case 30:le=-3;break e;case 31:return-4;case 32:default:return f}return R.next_out=B,R.avail_out=K,R.next_in=N,R.avail_in=U,k.hold=z,k.bits=G,(k.wsize||ie!==R.avail_out&&k.mode<30&&(k.mode<27||A!==4))&&M(R,R.output,R.next_out,ie-R.avail_out)?(k.mode=31,-4):(te-=R.avail_in,ie-=R.avail_out,R.total_in+=te,R.total_out+=ie,k.total+=ie,k.wrap&&ie&&(R.adler=k.check=k.flags?a(k.check,j,ie,R.next_out-ie):s(k.check,j,ie,R.next_out-ie)),R.data_type=k.bits+(k.last?64:0)+(k.mode===12?128:0)+(k.mode===20||k.mode===15?256:0),(te==0&&ie===0||A===4)&&le===h&&(le=-5),le)},i.inflateEnd=function(R){if(!R||!R.state)return f;var A=R.state;return A.window&&(A.window=null),R.state=null,h},i.inflateGetHeader=function(R,A){var k;return R&&R.state&&2&(k=R.state).wrap?((k.head=A).done=!1,h):f},i.inflateSetDictionary=function(R,A){var k,L=A.length;return R&&R.state?(k=R.state).wrap!==0&&k.mode!==11?f:k.mode===11&&s(1,A,L,0)!==k.check?-3:M(R,A,L,L)?(k.mode=31,-4):(k.havedict=1,h):f},i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,r,i){var o=t("../utils/common"),s=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],c=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],l=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function(u,d,h,f,p,g,m,v){var b,S,E,w,C,I,T,D,O,M=v.bits,R=0,A=0,k=0,L=0,j=0,N=0,B=0,U=0,K=0,z=0,G=null,te=0,ie=new o.Buf16(16),Q=new o.Buf16(16),ge=null,_e=0;for(R=0;R<=15;R++)ie[R]=0;for(A=0;A<f;A++)ie[d[h+A]]++;for(j=M,L=15;1<=L&&ie[L]===0;L--);if(L<j&&(j=L),L===0)return p[g++]=20971520,p[g++]=20971520,v.bits=1,0;for(k=1;k<L&&ie[k]===0;k++);for(j<k&&(j=k),R=U=1;R<=15;R++)if(U<<=1,(U-=ie[R])<0)return-1;if(0<U&&(u===0||L!==1))return-1;for(Q[1]=0,R=1;R<15;R++)Q[R+1]=Q[R]+ie[R];for(A=0;A<f;A++)d[h+A]!==0&&(m[Q[d[h+A]]++]=A);if(I=u===0?(G=ge=m,19):u===1?(G=s,te-=257,ge=a,_e-=257,256):(G=c,ge=l,-1),R=k,C=g,B=A=z=0,E=-1,w=(K=1<<(N=j))-1,u===1&&852<K||u===2&&592<K)return 1;for(;;){for(T=R-B,O=m[A]<I?(D=0,m[A]):m[A]>I?(D=ge[_e+m[A]],G[te+m[A]]):(D=96,0),b=1<<R-B,k=S=1<<N;p[C+(z>>B)+(S-=b)]=T<<24|D<<16|O|0,S!==0;);for(b=1<<R-1;z&b;)b>>=1;if(b!==0?(z&=b-1,z+=b):z=0,A++,--ie[R]==0){if(R===L)break;R=d[h+m[A]]}if(j<R&&(z&w)!==E){for(B===0&&(B=j),C+=k,U=1<<(N=R-B);N+B<L&&!((U-=ie[N+B])<=0);)N++,U<<=1;if(K+=1<<N,u===1&&852<K||u===2&&592<K)return 1;p[E=z&w]=j<<24|N<<16|C-g|0}}return z!==0&&(p[C+z]=R-B<<24|64<<16|0),v.bits=j,0}},{"../utils/common":41}],51:[function(t,r,i){r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,r,i){var o=t("../utils/common"),s=0,a=1;function c(ne){for(var ce=ne.length;0<=--ce;)ne[ce]=0}var l=0,u=29,d=256,h=d+1+u,f=30,p=19,g=2*h+1,m=15,v=16,b=7,S=256,E=16,w=17,C=18,I=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],T=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],D=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],O=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],M=new Array(2*(h+2));c(M);var R=new Array(2*f);c(R);var A=new Array(512);c(A);var k=new Array(256);c(k);var L=new Array(u);c(L);var j,N,B,U=new Array(f);function K(ne,ce,Ae,Ie,be){this.static_tree=ne,this.extra_bits=ce,this.extra_base=Ae,this.elems=Ie,this.max_length=be,this.has_stree=ne&&ne.length}function z(ne,ce){this.dyn_tree=ne,this.max_code=0,this.stat_desc=ce}function G(ne){return ne<256?A[ne]:A[256+(ne>>>7)]}function te(ne,ce){ne.pending_buf[ne.pending++]=255&ce,ne.pending_buf[ne.pending++]=ce>>>8&255}function ie(ne,ce,Ae){ne.bi_valid>v-Ae?(ne.bi_buf|=ce<<ne.bi_valid&65535,te(ne,ne.bi_buf),ne.bi_buf=ce>>v-ne.bi_valid,ne.bi_valid+=Ae-v):(ne.bi_buf|=ce<<ne.bi_valid&65535,ne.bi_valid+=Ae)}function Q(ne,ce,Ae){ie(ne,Ae[2*ce],Ae[2*ce+1])}function ge(ne,ce){for(var Ae=0;Ae|=1&ne,ne>>>=1,Ae<<=1,0<--ce;);return Ae>>>1}function _e(ne,ce,Ae){var Ie,be,De=new Array(m+1),Me=0;for(Ie=1;Ie<=m;Ie++)De[Ie]=Me=Me+Ae[Ie-1]<<1;for(be=0;be<=ce;be++){var He=ne[2*be+1];He!==0&&(ne[2*be]=ge(De[He]++,He))}}function Se(ne){var ce;for(ce=0;ce<h;ce++)ne.dyn_ltree[2*ce]=0;for(ce=0;ce<f;ce++)ne.dyn_dtree[2*ce]=0;for(ce=0;ce<p;ce++)ne.bl_tree[2*ce]=0;ne.dyn_ltree[2*S]=1,ne.opt_len=ne.static_len=0,ne.last_lit=ne.matches=0}function se(ne){8<ne.bi_valid?te(ne,ne.bi_buf):0<ne.bi_valid&&(ne.pending_buf[ne.pending++]=ne.bi_buf),ne.bi_buf=0,ne.bi_valid=0}function ee(ne,ce,Ae,Ie){var be=2*ce,De=2*Ae;return ne[be]<ne[De]||ne[be]===ne[De]&&Ie[ce]<=Ie[Ae]}function Y(ne,ce,Ae){for(var Ie=ne.heap[Ae],be=Ae<<1;be<=ne.heap_len&&(be<ne.heap_len&&ee(ce,ne.heap[be+1],ne.heap[be],ne.depth)&&be++,!ee(ce,Ie,ne.heap[be],ne.depth));)ne.heap[Ae]=ne.heap[be],Ae=be,be<<=1;ne.heap[Ae]=Ie}function ue(ne,ce,Ae){var Ie,be,De,Me,He=0;if(ne.last_lit!==0)for(;Ie=ne.pending_buf[ne.d_buf+2*He]<<8|ne.pending_buf[ne.d_buf+2*He+1],be=ne.pending_buf[ne.l_buf+He],He++,Ie===0?Q(ne,be,ce):(Q(ne,(De=k[be])+d+1,ce),(Me=I[De])!==0&&ie(ne,be-=L[De],Me),Q(ne,De=G(--Ie),Ae),(Me=T[De])!==0&&ie(ne,Ie-=U[De],Me)),He<ne.last_lit;);Q(ne,S,ce)}function ye(ne,ce){var Ae,Ie,be,De=ce.dyn_tree,Me=ce.stat_desc.static_tree,He=ce.stat_desc.has_stree,Je=ce.stat_desc.elems,qe=-1;for(ne.heap_len=0,ne.heap_max=g,Ae=0;Ae<Je;Ae++)De[2*Ae]!==0?(ne.heap[++ne.heap_len]=qe=Ae,ne.depth[Ae]=0):De[2*Ae+1]=0;for(;ne.heap_len<2;)De[2*(be=ne.heap[++ne.heap_len]=qe<2?++qe:0)]=1,ne.depth[be]=0,ne.opt_len--,He&&(ne.static_len-=Me[2*be+1]);for(ce.max_code=qe,Ae=ne.heap_len>>1;1<=Ae;Ae--)Y(ne,De,Ae);for(be=Je;Ae=ne.heap[1],ne.heap[1]=ne.heap[ne.heap_len--],Y(ne,De,1),Ie=ne.heap[1],ne.heap[--ne.heap_max]=Ae,ne.heap[--ne.heap_max]=Ie,De[2*be]=De[2*Ae]+De[2*Ie],ne.depth[be]=(ne.depth[Ae]>=ne.depth[Ie]?ne.depth[Ae]:ne.depth[Ie])+1,De[2*Ae+1]=De[2*Ie+1]=be,ne.heap[1]=be++,Y(ne,De,1),2<=ne.heap_len;);ne.heap[--ne.heap_max]=ne.heap[1],function(Ge,St){var Pt,on,an,Rt,Xt,yn,bn=St.dyn_tree,Kn=St.max_code,lr=St.stat_desc.static_tree,Rr=St.stat_desc.has_stree,Lr=St.stat_desc.extra_bits,er=St.stat_desc.extra_base,ke=St.stat_desc.max_length,Qn=0;for(Rt=0;Rt<=m;Rt++)Ge.bl_count[Rt]=0;for(bn[2*Ge.heap[Ge.heap_max]+1]=0,Pt=Ge.heap_max+1;Pt<g;Pt++)ke<(Rt=bn[2*bn[2*(on=Ge.heap[Pt])+1]+1]+1)&&(Rt=ke,Qn++),bn[2*on+1]=Rt,Kn<on||(Ge.bl_count[Rt]++,Xt=0,er<=on&&(Xt=Lr[on-er]),yn=bn[2*on],Ge.opt_len+=yn*(Rt+Xt),Rr&&(Ge.static_len+=yn*(lr[2*on+1]+Xt)));if(Qn!==0){do{for(Rt=ke-1;Ge.bl_count[Rt]===0;)Rt--;Ge.bl_count[Rt]--,Ge.bl_count[Rt+1]+=2,Ge.bl_count[ke]--,Qn-=2}while(0<Qn);for(Rt=ke;Rt!==0;Rt--)for(on=Ge.bl_count[Rt];on!==0;)Kn<(an=Ge.heap[--Pt])||(bn[2*an+1]!==Rt&&(Ge.opt_len+=(Rt-bn[2*an+1])*bn[2*an],bn[2*an+1]=Rt),on--)}}(ne,ce),_e(De,qe,ne.bl_count)}function V(ne,ce,Ae){var Ie,be,De=-1,Me=ce[1],He=0,Je=7,qe=4;for(Me===0&&(Je=138,qe=3),ce[2*(Ae+1)+1]=65535,Ie=0;Ie<=Ae;Ie++)be=Me,Me=ce[2*(Ie+1)+1],++He<Je&&be===Me||(He<qe?ne.bl_tree[2*be]+=He:be!==0?(be!==De&&ne.bl_tree[2*be]++,ne.bl_tree[2*E]++):He<=10?ne.bl_tree[2*w]++:ne.bl_tree[2*C]++,De=be,qe=(He=0)===Me?(Je=138,3):be===Me?(Je=6,3):(Je=7,4))}function le(ne,ce,Ae){var Ie,be,De=-1,Me=ce[1],He=0,Je=7,qe=4;for(Me===0&&(Je=138,qe=3),Ie=0;Ie<=Ae;Ie++)if(be=Me,Me=ce[2*(Ie+1)+1],!(++He<Je&&be===Me)){if(He<qe)for(;Q(ne,be,ne.bl_tree),--He!=0;);else be!==0?(be!==De&&(Q(ne,be,ne.bl_tree),He--),Q(ne,E,ne.bl_tree),ie(ne,He-3,2)):He<=10?(Q(ne,w,ne.bl_tree),ie(ne,He-3,3)):(Q(ne,C,ne.bl_tree),ie(ne,He-11,7));De=be,qe=(He=0)===Me?(Je=138,3):be===Me?(Je=6,3):(Je=7,4)}}c(U);var he=!1;function oe(ne,ce,Ae,Ie){ie(ne,(l<<1)+(Ie?1:0),3),function(be,De,Me,He){se(be),te(be,Me),te(be,~Me),o.arraySet(be.pending_buf,be.window,De,Me,be.pending),be.pending+=Me}(ne,ce,Ae)}i._tr_init=function(ne){he||(function(){var ce,Ae,Ie,be,De,Me=new Array(m+1);for(be=Ie=0;be<u-1;be++)for(L[be]=Ie,ce=0;ce<1<<I[be];ce++)k[Ie++]=be;for(k[Ie-1]=be,be=De=0;be<16;be++)for(U[be]=De,ce=0;ce<1<<T[be];ce++)A[De++]=be;for(De>>=7;be<f;be++)for(U[be]=De<<7,ce=0;ce<1<<T[be]-7;ce++)A[256+De++]=be;for(Ae=0;Ae<=m;Ae++)Me[Ae]=0;for(ce=0;ce<=143;)M[2*ce+1]=8,ce++,Me[8]++;for(;ce<=255;)M[2*ce+1]=9,ce++,Me[9]++;for(;ce<=279;)M[2*ce+1]=7,ce++,Me[7]++;for(;ce<=287;)M[2*ce+1]=8,ce++,Me[8]++;for(_e(M,h+1,Me),ce=0;ce<f;ce++)R[2*ce+1]=5,R[2*ce]=ge(ce,5);j=new K(M,I,d+1,h,m),N=new K(R,T,0,f,m),B=new K(new Array(0),D,0,p,b)}(),he=!0),ne.l_desc=new z(ne.dyn_ltree,j),ne.d_desc=new z(ne.dyn_dtree,N),ne.bl_desc=new z(ne.bl_tree,B),ne.bi_buf=0,ne.bi_valid=0,Se(ne)},i._tr_stored_block=oe,i._tr_flush_block=function(ne,ce,Ae,Ie){var be,De,Me=0;0<ne.level?(ne.strm.data_type===2&&(ne.strm.data_type=function(He){var Je,qe=4093624447;for(Je=0;Je<=31;Je++,qe>>>=1)if(1&qe&&He.dyn_ltree[2*Je]!==0)return s;if(He.dyn_ltree[18]!==0||He.dyn_ltree[20]!==0||He.dyn_ltree[26]!==0)return a;for(Je=32;Je<d;Je++)if(He.dyn_ltree[2*Je]!==0)return a;return s}(ne)),ye(ne,ne.l_desc),ye(ne,ne.d_desc),Me=function(He){var Je;for(V(He,He.dyn_ltree,He.l_desc.max_code),V(He,He.dyn_dtree,He.d_desc.max_code),ye(He,He.bl_desc),Je=p-1;3<=Je&&He.bl_tree[2*O[Je]+1]===0;Je--);return He.opt_len+=3*(Je+1)+5+5+4,Je}(ne),be=ne.opt_len+3+7>>>3,(De=ne.static_len+3+7>>>3)<=be&&(be=De)):be=De=Ae+5,Ae+4<=be&&ce!==-1?oe(ne,ce,Ae,Ie):ne.strategy===4||De===be?(ie(ne,2+(Ie?1:0),3),ue(ne,M,R)):(ie(ne,4+(Ie?1:0),3),function(He,Je,qe,Ge){var St;for(ie(He,Je-257,5),ie(He,qe-1,5),ie(He,Ge-4,4),St=0;St<Ge;St++)ie(He,He.bl_tree[2*O[St]+1],3);le(He,He.dyn_ltree,Je-1),le(He,He.dyn_dtree,qe-1)}(ne,ne.l_desc.max_code+1,ne.d_desc.max_code+1,Me+1),ue(ne,ne.dyn_ltree,ne.dyn_dtree)),Se(ne),Ie&&se(ne)},i._tr_tally=function(ne,ce,Ae){return ne.pending_buf[ne.d_buf+2*ne.last_lit]=ce>>>8&255,ne.pending_buf[ne.d_buf+2*ne.last_lit+1]=255&ce,ne.pending_buf[ne.l_buf+ne.last_lit]=255&Ae,ne.last_lit++,ce===0?ne.dyn_ltree[2*Ae]++:(ne.matches++,ce--,ne.dyn_ltree[2*(k[Ae]+d+1)]++,ne.dyn_dtree[2*G(ce)]++),ne.last_lit===ne.lit_bufsize-1},i._tr_align=function(ne){ie(ne,2,3),Q(ne,S,M),function(ce){ce.bi_valid===16?(te(ce,ce.bi_buf),ce.bi_buf=0,ce.bi_valid=0):8<=ce.bi_valid&&(ce.pending_buf[ce.pending++]=255&ce.bi_buf,ce.bi_buf>>=8,ce.bi_valid-=8)}(ne)}},{"../utils/common":41}],53:[function(t,r,i){r.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(t,r,i){(function(o){(function(s,a){if(!s.setImmediate){var c,l,u,d,h=1,f={},p=!1,g=s.document,m=Object.getPrototypeOf&&Object.getPrototypeOf(s);m=m&&m.setTimeout?m:s,c={}.toString.call(s.process)==="[object process]"?function(E){process.nextTick(function(){b(E)})}:function(){if(s.postMessage&&!s.importScripts){var E=!0,w=s.onmessage;return s.onmessage=function(){E=!1},s.postMessage("","*"),s.onmessage=w,E}}()?(d="setImmediate$"+Math.random()+"$",s.addEventListener?s.addEventListener("message",S,!1):s.attachEvent("onmessage",S),function(E){s.postMessage(d+E,"*")}):s.MessageChannel?((u=new MessageChannel).port1.onmessage=function(E){b(E.data)},function(E){u.port2.postMessage(E)}):g&&"onreadystatechange"in g.createElement("script")?(l=g.documentElement,function(E){var w=g.createElement("script");w.onreadystatechange=function(){b(E),w.onreadystatechange=null,l.removeChild(w),w=null},l.appendChild(w)}):function(E){setTimeout(b,0,E)},m.setImmediate=function(E){typeof E!="function"&&(E=new Function(""+E));for(var w=new Array(arguments.length-1),C=0;C<w.length;C++)w[C]=arguments[C+1];var I={callback:E,args:w};return f[h]=I,c(h),h++},m.clearImmediate=v}function v(E){delete f[E]}function b(E){if(p)setTimeout(b,0,E);else{var w=f[E];if(w){p=!0;try{(function(C){var I=C.callback,T=C.args;switch(T.length){case 0:I();break;case 1:I(T[0]);break;case 2:I(T[0],T[1]);break;case 3:I(T[0],T[1],T[2]);break;default:I.apply(a,T)}})(w)}finally{v(E),p=!1}}}}function S(E){E.source===s&&typeof E.data=="string"&&E.data.indexOf(d)===0&&b(+E.data.slice(d.length))}})(typeof self>"u"?o===void 0?this:o:self)}).call(this,typeof Ir<"u"?Ir:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(IHe);var vsn=IHe.exports;const ysn=([n])=>!n.endsWith("/"),bsn=async(n,e)=>{try{const r=await(await fetch(n)).arrayBuffer(),i={},o=await vsn.loadAsync(r),s=Object.entries(o.files);for(let[a,c]of s.filter(ysn))i[e(a)]=await c.async("text");return i}catch(t){return console.error(t),{}}};let LCe;const Ssn="stdlib-source-with-typeshed-pyi.zip",_sn=n=>n.replace(/^(stdlib|stubs)/,"/$1"),wsn=()=>(LCe??(LCe=bsn(new URL(`https://mitmedialab.github.io/pytutor-static/${Ssn}`,window.location.href).href,_sn)),LCe),Csn=new URL("https://mitmedialab.github.io/pytutor-static/pyright.worker.js",window.location.href),xsn=()=>new Worker(Csn);let Esn=0,NCe=!1;const PHe=new Map;async function Isn({target:n,code:e,uuid:t}){NCe||(msn({ignoreMapping:!0,workerLoaders:{editorWorkerService:()=>new psn}}),NCe=!0);const r=`/workspace${Esn++}`,i=Rk.parse(r),o=await wsn(),s=xsn();s.postMessage({type:"browser/boot",mode:"foreground"});const a=new Nx.BrowserMessageReader(s),c=new Nx.BrowserMessageWriter(s),l={name:"Pyright Language Client",languageId:"python",options:{$type:"WorkerDirect",worker:s},clientOptions:{documentSelector:["python"],workspaceFolder:{index:0,name:"workspace",uri:i},initializationOptions:{files:o},errorHandler:{error:()=>({action:oee.ErrorAction.Continue}),closed:()=>({action:oee.CloseAction.DoNotRestart})}},connectionProvider:{get:()=>Promise.resolve({reader:a,writer:c})}},u={code:e??'print("Hello World!")',uri:Rk.file(`${i.path}/file.py`)},d=new qet(!1);Ket(1,d),d.registerFile(new Get(u.uri,u.code));const h={editorAppConfig:{$type:"extended",useDiffEditor:!1,codeResources:{main:{uri:u.uri.toString(),text:u.code}}}},f={enabled:!0,debugEnabled:!0},p=new fsn;return await p.init({wrapperConfig:h,languageClientConfig:l,loggerConfig:f}),await Zet.openTextDocument(u.uri),await p.start(n),PHe.set(t,()=>{a.dispose(),c.dispose(),d.dispose(),p.dispose(),s.terminate()}),p}const Psn=n=>{var e;return(e=PHe.get(n))==null?void 0:e()},ksn=async(n,e,t)=>{const i=(await Isn({target:n,code:"",uuid:e})).getEditor();if(!i)throw alert("INTERNAL PYTUTOR ERROR: Editor not created, please notify your instructor."),new Error("Editor not created");return i.onDidChangeModelContent(o=>{const s=(i==null?void 0:i.getValue())??"";t(s.trim().length>0,s)}),i};function CV(n){return x.jsx($2e,{...n,children:x.jsx("div",{className:cM.container,children:x.jsx(Tsn,{...n})})})}function Tsn({runCode:n,identifier:e,roomID:t,onContentUpdate:r,setEditor:i,terminateRunningCode:o}){const s=M2e(),[a,c]=y.useState(),[l,u]=y.useState(!1),d=y.useRef(null),[h,f]=y.useState(),[p,g]=y.useState(!0);y.useEffect(()=>{let v,b,S;if(h){b=new y_;const E=b.getText(`monaco${e??""}`);v=new rBe(s,b),c(v),v.once("sync",()=>{u(!0),h.setScrollPosition({scrollTop:0})}),v.connect(),S=new ZXt(E,h.getModel(),new Set([h]),v.awareness)}return()=>{b==null||b.destroy(),v==null||v.destroy(),S==null||S.destroy()}},[h,s]),y.useEffect(()=>{const v=d.current,b=t+e;return ksn(v,b,r).then(S=>{f(S),i(S)}),()=>Psn(b)},[]);const m=async()=>{var v;g(!1),await n(((v=h==null?void 0:h.getModel())==null?void 0:v.getValue())??"",h),g(!0)};return x.jsxs("div",{className:cM.container,style:{position:"relative"},children:[a?x.jsx(eYt,{yProvider:a}):null,x.jsxs("div",{className:cM.editorHeader,children:[x.jsx("div",{children:h?x.jsx(sYt,{editor:h,run:m,canRun:p,terminate:o}):null}),x.jsx(QXt,{})]}),x.jsx("div",{className:cM.editorContainer,ref:d}),l?null:x.jsx("div",{style:{position:"absolute",width:"100%",height:"100%"},className:"flex items-center justify-center",children:x.jsx("span",{className:"loading loading-ring loading-lg align-middle w-1/2 h-1/2"})})]})}function Dsn(n){let e,t,r;return{c(){e=J1("svg"),t=J1("path"),r=J1("path"),this.h()},l(i){e=Q1(i,"svg",{class:!0,fill:!0,height:!0,stroke:!0,"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,viewBox:!0,width:!0,xmlns:!0});var o=tt(e);t=Q1(o,"path",{d:!0}),tt(t).forEach(Ee),r=Q1(o,"path",{d:!0}),tt(r).forEach(Ee),o.forEach(Ee),this.h()},h(){Re(t,"d","M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"),Re(r,"d","M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"),Re(e,"class","feather feather-edit"),Re(e,"fill","none"),Re(e,"height",n[1]),Re(e,"stroke","currentColor"),Re(e,"stroke-linecap","round"),Re(e,"stroke-linejoin","round"),Re(e,"stroke-width","2"),Re(e,"viewBox","0 0 24 24"),Re(e,"width",n[0]),Re(e,"xmlns","http://www.w3.org/2000/svg")},m(i,o){Ft(i,e,o),we(e,t),we(e,r)},p(i,[o]){o&2&&Re(e,"height",i[1]),o&1&&Re(e,"width",i[0])},i:Dt,o:Dt,d(i){i&&Ee(e)}}}function Rsn(n,e,t){let{width:r=24}=e,{height:i=24}=e;return n.$$set=o=>{"width"in o&&t(0,r=o.width),"height"in o&&t(1,i=o.height)},[r,i]}class kHe extends fo{constructor(e){super(),po(this,e,Rsn,Dsn,Hi,{width:0,height:1})}}function FCe(n){let e,t;return{c(){e=Ne("img"),this.h()},l(r){e=Fe(r,"IMG",{src:!0,class:!0,alt:!0}),this.h()},h(){_2(e.src,t=n[2])||Re(e,"src",t),Re(e,"class","w-4 h-4 mr-1"),Re(e,"alt","whiteboard attachment icon indicator")},m(r,i){Ft(r,e,i)},p(r,i){i&4&&!_2(e.src,t=r[2])&&Re(e,"src",t)},d(r){r&&Ee(e)}}}function Asn(n){let e,t,r,i,o,s,a,c,l,u,d,h,f,p;a=new kHe({props:{height:16}});let g=n[2]&&FCe(n);return{c(){e=Ne("div"),t=Ne("span"),r=Ne("input"),i=Kt(),o=Ne("span"),s=Ne("button"),Bo(a.$$.fragment),c=Kt(),g&&g.c(),l=Kt(),u=Jr(n[1]),this.h()},l(m){e=Fe(m,"DIV",{class:!0});var v=tt(e);t=Fe(v,"SPAN",{class:!0});var b=tt(t);r=Fe(b,"INPUT",{style:!0,type:!0,class:!0}),b.forEach(Ee),i=Gt(v),o=Fe(v,"SPAN",{class:!0});var S=tt(o);s=Fe(S,"BUTTON",{class:!0});var E=tt(s);Ho(a.$$.fragment,E),E.forEach(Ee),c=Gt(S),g&&g.l(S),l=Gt(S),u=Qr(S,n[1]),S.forEach(Ee),v.forEach(Ee),this.h()},h(){Fn(r,"--chkbg","var(--primary-medium)"),Re(r,"type","checkbox"),Re(r,"class","checkbox checkbox-xs check"),r.checked=n[0],Re(t,"class","indicator-item badge h-4 border-none p-0"),Re(s,"class","btn btn-xs rounded-l-md px-0 bg-inherit border-none hover:shadow-md"),Fn(s,"color","white"),Re(o,"class","content badge px-0 pr-1 py-3 bg-primary-medium border-none text-white rounded-md shadow-md"),Kr(o,"opacity-50",!n[0]),Re(e,"class","indicator mx-1")},m(m,v){Ft(m,e,v),we(e,t),we(t,r),we(e,i),we(e,o),we(o,s),Uo(a,s,null),we(o,c),g&&g.m(o,null),we(o,l),we(o,u),h=!0,f||(p=[_r(r,"input",n[6]),_r(s,"click",function(){S2(n[3])&&n[3].apply(this,arguments)})],f=!0)},p(m,[v]){n=m,(!h||v&1)&&(r.checked=n[0]),n[2]?g?g.p(n,v):(g=FCe(n),g.c(),g.m(o,l)):g&&(g.d(1),g=null),(!h||v&2)&&yl(u,n[1]),(!h||v&1)&&Kr(o,"opacity-50",!n[0])},i(m){h||(cn(a.$$.fragment,m),m&&ov(()=>{h&&(d||(d=yy(e,C2,{},!0)),d.run(1))}),h=!0)},o(m){Sn(a.$$.fragment,m),m&&(d||(d=yy(e,C2,{},!1)),d.run(0)),h=!1},d(m){m&&Ee(e),zo(a),g&&g.d(),m&&d&&d.end(),f=!1,qh(p)}}}function Osn(n,e,t){let{label:r}=e,{iconSrc:i}=e,{onClick:o}=e,{included:s=!0}=e,{setIncluded:a=()=>{}}=e;const c=()=>s,l=()=>{t(0,s=!s),a(s)};return n.$$set=u=>{"label"in u&&t(1,r=u.label),"iconSrc"in u&&t(2,i=u.iconSrc),"onClick"in u&&t(3,o=u.onClick),"included"in u&&t(0,s=u.included),"setIncluded"in u&&t(4,a=u.setIncluded)},[s,r,i,o,a,c,l]}class Msn extends fo{constructor(e){super(),po(this,e,Osn,Asn,Hi,{label:1,iconSrc:2,onClick:3,included:0,setIncluded:4,getIncluded:5})}get getIncluded(){return this.$$.ctx[5]}}const THe=(n,e=!1)=>{const t=n.getDomNode();if(!t)throw new Error("Editor has no DOM node");n.layout({width:window.screen.width,height:window.screen.height});const i=t.getElementsByClassName("view-lines")[0].cloneNode(!0);return i.style.height="auto",i.style.width="auto",i.setAttribute("contenteditable",JSON.stringify(e)),i},jCe=5,Tk=class Tk{constructor(e=jCe){$(this,"content",{code:new Map,editorNodes:new Map,executions:new Map});$(this,"ids",{code:new Map,executions:new Map});$(this,"queue",new Array);$(this,"maps");this.size=e,this.maps=[this.content.code,this.content.executions,this.content.editorNodes,this.ids.code,this.ids.executions]}store(e,t,r,i,o){if(this.content.code.has(e)||this.content.code.set(e,t),this.content.editorNodes.has(e)||this.content.editorNodes.set(e,THe(r)),this.content.executions.has(e)||this.content.executions.set(e,[]),this.content.executions.get(e).push(i),this.ids.code.has(e)||this.ids.code.set(e,o.then(({code_id:s})=>s)),this.ids.executions.has(e)||this.ids.executions.set(e,[]),this.ids.executions.get(e).push(o.then(({execution_id:s})=>s)),this.queue.length===0)this.queue.push(e);else if(this.queue.at(-1)!==e){if(this.queue.push(e)>this.size){const[s]=this.queue.splice(0,1);this.maps.forEach(a=>a.delete(s))}}}get(e){return this.ids.code.get(e)}validate(){this.queue.forEach(e=>{const t=this.content.code.get(e),r=this.content.editorNodes.get(e),i=this.content.executions.get(e),o=this.ids.code.get(e),s=this.ids.executions.get(e);(!t||!r||!i||!o||!s)&&console.error(`Cache entry for ${e} is missing data: ${{code:t,editorNode:r,executions:i,codeID:o,executionIDs:s}}`)})}executionCount(e){var t;return((t=this.content.executions.get(e))==null?void 0:t.length)??0}static Get(e,t=jCe){const r=Tk.instances;if(r.has(e))return r.get(e);const i=new Tk(t);return r.set(e,i),i}};$(Tk,"instances",new Map);let CT=Tk;function BCe(n,e,t){const r=n.slice();return r[13]=e[t],r}function HCe(n){let e,t;return{c(){e=Ne("img"),this.h()},l(r){e=Fe(r,"IMG",{src:!0,class:!0,alt:!0}),this.h()},h(){_2(e.src,t=n[3])||Re(e,"src",t),Re(e,"class","w-4 h-4 mr-1"),Re(e,"alt","code attachment icon indicator")},m(r,i){Ft(r,e,i)},p(r,i){i&8&&!_2(e.src,t=r[3])&&Re(e,"src",t)},d(r){r&&Ee(e)}}}function $sn(n){let e,t,r="&nbsp;",i,o,s,a,c,l,u=Fs(Array(n[0]+1).keys()),d=[];for(let h=0;h<u.length;h+=1)d[h]=UCe(BCe(n,u,h));return{c(){e=Ne("span"),t=new zL(!1),i=Jr(`&
                `),o=Ne("select");for(let h=0;h<d.length;h+=1)d[h].c();s=Jr(`
                Run(s)`),this.h()},l(h){e=Fe(h,"SPAN",{});var f=tt(e);t=VL(f,!1),i=Qr(f,`&
                `),o=Fe(f,"SELECT",{class:!0});var p=tt(o);for(let g=0;g<d.length;g+=1)d[g].l(p);p.forEach(Ee),s=Qr(f,`
                Run(s)`),f.forEach(Ee),this.h()},h(){t.a=i,Re(o,"class","w-fit p-0 text-xs focus:outline-none"),n[5]===void 0&&ov(()=>n[12].call(o)),Fn(o,"background-color","var(--primary-medium)"),Fn(o,"text-indent","0px"),Fn(o,"margin-left","-3px"),Fn(o,"margin-right","-3px")},m(h,f){Ft(h,e,f),t.m(r,e),we(e,i),we(e,o);for(let p=0;p<d.length;p+=1)d[p]&&d[p].m(o,null);Lce(o,n[5],!0),we(e,s),c||(l=_r(o,"change",n[12]),c=!0)},p(h,f){if(f&1){u=Fs(Array(h[0]+1).keys());let p;for(p=0;p<u.length;p+=1){const g=BCe(h,u,p);d[p]?d[p].p(g,f):(d[p]=UCe(g),d[p].c(),d[p].m(o,null))}for(;p<d.length;p+=1)d[p].d(1);d.length=u.length}f&33&&Lce(o,h[5])},i(h){h&&(a||ov(()=>{a=cee(e,C2,{}),a.start()}))},o:Dt,d(h){h&&Ee(e),Kf(d,h),c=!1,l()}}}function Lsn(n){let e,t,r="&nbsp;",i,o;return{c(){e=Ne("span"),t=new zL(!1),i=Jr(" (Custom)"),this.h()},l(s){e=Fe(s,"SPAN",{});var a=tt(e);t=VL(a,!1),i=Qr(a," (Custom)"),a.forEach(Ee),this.h()},h(){t.a=i},m(s,a){Ft(s,e,a),t.m(r,e),we(e,i)},p:Dt,i(s){s&&(o||ov(()=>{o=cee(e,C2,{}),o.start()}))},o:Dt,d(s){s&&Ee(e)}}}function UCe(n){let e,t=n[13]+"",r,i,o;return{c(){e=Ne("option"),r=Jr(t),i=Kt(),this.h()},l(s){e=Fe(s,"OPTION",{});var a=tt(e);r=Qr(a,t),i=Gt(a),a.forEach(Ee),this.h()},h(){e.__value=o=n[13],iv(e,e.__value)},m(s,a){Ft(s,e,a),we(e,r),we(e,i)},p(s,a){a&1&&t!==(t=s[13]+"")&&yl(r,t),a&1&&o!==(o=s[13])&&(e.__value=o,iv(e,e.__value))},d(s){s&&Ee(e)}}}function Nsn(n){let e,t,r,i,o,s,a,c,l,u,d="Code",h,f,p,g,m,v;a=new kHe({props:{height:16}});let b=n[3]&&HCe(n);function S(C,I){if(C[1])return Lsn;if(C[0])return $sn}let E=S(n),w=E&&E(n);return{c(){e=Ne("div"),t=Ne("span"),r=Ne("input"),i=Kt(),o=Ne("span"),s=Ne("button"),Bo(a.$$.fragment),c=Kt(),b&&b.c(),l=Kt(),u=Ne("span"),u.textContent=d,h=Kt(),w&&w.c(),this.h()},l(C){e=Fe(C,"DIV",{class:!0});var I=tt(e);t=Fe(I,"SPAN",{class:!0});var T=tt(t);r=Fe(T,"INPUT",{style:!0,type:!0,class:!0}),T.forEach(Ee),i=Gt(I),o=Fe(I,"SPAN",{class:!0});var D=tt(o);s=Fe(D,"BUTTON",{class:!0});var O=tt(s);Ho(a.$$.fragment,O),O.forEach(Ee),c=Gt(D),b&&b.l(D),l=Gt(D),u=Fe(D,"SPAN",{"data-svelte-h":!0}),Fr(u)!=="svelte-1xw5f77"&&(u.textContent=d),h=Gt(D),w&&w.l(D),D.forEach(Ee),I.forEach(Ee),this.h()},h(){Fn(r,"--chkbg","var(--primary-medium)"),Re(r,"type","checkbox"),Re(r,"class","checkbox checkbox-xs check"),r.checked=n[2],Re(t,"class","indicator-item badge h-4 border-none p-0"),Re(s,"class","btn btn-xs rounded-l-md px-0 bg-inherit border-none hover:shadow-md"),Fn(s,"color","white"),Re(o,"class","content badge px-0 pr-1 py-3 bg-primary-medium border-none text-white rounded-md shadow-md"),Kr(o,"opacity-50",!n[2]),Re(e,"class","indicator mx-1")},m(C,I){Ft(C,e,I),we(e,t),we(t,r),we(e,i),we(e,o),we(o,s),Uo(a,s,null),we(o,c),b&&b.m(o,null),we(o,l),we(o,u),we(o,h),w&&w.m(o,null),g=!0,m||(v=[_r(r,"input",n[11]),_r(s,"click",function(){S2(n[4])&&n[4].apply(this,arguments)})],m=!0)},p(C,[I]){n=C,(!g||I&4)&&(r.checked=n[2]),n[3]?b?b.p(n,I):(b=HCe(n),b.c(),b.m(o,l)):b&&(b.d(1),b=null),E===(E=S(n))&&w?w.p(n,I):(w&&w.d(1),w=E&&E(n),w&&(w.c(),cn(w,1),w.m(o,null))),(!g||I&4)&&Kr(o,"opacity-50",!n[2])},i(C){g||(cn(a.$$.fragment,C),cn(w),C&&ov(()=>{g&&(p&&p.end(1),f=cee(e,C2,{}),f.start())}),g=!0)},o(C){Sn(a.$$.fragment,C),f&&f.invalidate(),C&&(p=DGe(e,C2,{})),g=!1},d(C){C&&Ee(e),zo(a),b&&b.d(),w&&w.d(),C&&p&&p.end(),m=!1,qh(v)}}}function Fsn(n,e,t){let{runCount:r=0}=e,{isCustom:i=!1}=e,{iconSrc:o=void 0}=e;const s=m=>{t(0,r=m)},a=m=>{t(1,i=m)},c=()=>{t(0,r++,r)},l=()=>r;let{onClick:u}=e,{included:d=!0}=e;const h=()=>d;let f=0;const p=()=>{t(2,d=!d)};function g(){f=SGe(this),t(5,f),t(0,r),t(0,r)}return n.$$set=m=>{"runCount"in m&&t(0,r=m.runCount),"isCustom"in m&&t(1,i=m.isCustom),"iconSrc"in m&&t(3,o=m.iconSrc),"onClick"in m&&t(4,u=m.onClick),"included"in m&&t(2,d=m.included)},n.$$.update=()=>{n.$$.dirty&33&&(r===0?t(5,f=-1):r>0&&f===-1&&t(5,f=1))},[r,i,d,o,u,f,s,a,c,l,h,p,g]}class jsn extends fo{constructor(e){super(),po(this,e,Fsn,Nsn,Hi,{runCount:0,isCustom:1,iconSrc:3,setRunCount:6,setIsCustom:7,incrementRunCount:8,getRunCount:9,onClick:4,included:2,getIncluded:10})}get setRunCount(){return this.$$.ctx[6]}get setIsCustom(){return this.$$.ctx[7]}get incrementRunCount(){return this.$$.ctx[8]}get getRunCount(){return this.$$.ctx[9]}get getIncluded(){return this.$$.ctx[10]}}function Bsn(n){let e,t,r,i;return{c(){e=Ne("div"),t=Ne("div"),this.h()},l(o){e=Fe(o,"DIV",{class:!0});var s=tt(e);t=Fe(s,"DIV",{class:!0}),tt(t).forEach(Ee),s.forEach(Ee),this.h()},h(){Re(t,"class","wrapper h-full overflow-hidden svelte-10vxbm6"),Re(e,"class","flex flex-col h-full w-full overflow-y-hidden svelte-10vxbm6")},m(o,s){Ft(o,e,s),we(e,t),n[5](t),r||(i=[_r(t,"mouseup",n[2]),_r(t,"keyup",n[1])],r=!0)},p:Dt,i:Dt,o:Dt,d(o){o&&Ee(e),n[5](null),r=!1,qh(i)}}}const gC="highlight-snippet",vL=n=>n.nodeType===Node.TEXT_NODE,Bx=n=>n.nodeType===Node.ELEMENT_NODE,zCe=(n,e)=>{const t=n.getRangeAt(0),r=t.startContainer,i=t.endContainer;if(vL(r)&&t.startOffset<r.length){let o=r.splitText(t.startOffset);t.setStart(o,0)}vL(i)&&t.endOffset<i.length&&i.splitText(t.endOffset),e(t,Bx(t.commonAncestorContainer)?t.commonAncestorContainer:t.commonAncestorContainer.parentNode),n.removeAllRanges()},Hsn=(n,e)=>{const t=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,{acceptNode(i){return n.intersectsNode(i)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}}),r=[];for(;t.nextNode();)r.push(t.currentNode);r.filter(vL).forEach(function(i){if(!i.parentNode)return;const o=Vsn();i.parentNode.replaceChild(o,i),o.appendChild(i)})},Usn=(n,e)=>{const t=[];e.classList.contains(gC)&&t.push(e);const r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode(i){return!Bx(i)||!n.intersectsNode(i)?NodeFilter.FILTER_REJECT:i.classList.contains(gC)||i.querySelector(`.${gC}`)?(console.log("ACCEPTED"),NodeFilter.FILTER_ACCEPT):NodeFilter.FILTER_REJECT}});for(;r.nextNode();)t.push(r.currentNode);t.filter(Bx).forEach(function(i){i.classList.contains(gC)&&zsn(i)})},zsn=n=>{var e,t;for(;n.firstChild;)(e=n.parentNode)==null||e.insertBefore(n.firstChild,n);(t=n.parentNode)==null||t.removeChild(n)},Vsn=()=>{const n=document.createElement("span");return n.className=gC,n};function Wsn(n){var a,c,l,u;const e=document.createTreeWalker(n,NodeFilter.SHOW_ALL),t=[];let r=0,i=0,o=null;for(;e.nextNode();){const d=e.currentNode;if(d.nodeType===Node.TEXT_NODE){const h=d,f=h.parentElement;if(f&&f.classList.contains(gC)){const g=h.textContent||"",m=g.split(`
`),v=r,b=i,S=b+m.length-1,E=m.length>1?m[m.length-1].length:v+g.length;if(o&&o.node===h.previousSibling){const w=t[t.length-1];w.textContent+=g,w.end_char=E,w.end_line=S}else t.push({textContent:g,start_line:b,end_line:S,start_char:v,end_char:E});o={node:h,offset:E}}const p=(((a=h.textContent)==null?void 0:a.match(/\n/g))||[]).length;p>0?(i+=p,r=(((c=h.textContent)==null?void 0:c.length)??0)-((((l=h.textContent)==null?void 0:l.lastIndexOf(`
`))??0)+1)||0):r+=((u=h.textContent)==null?void 0:u.length)||0}else d.nodeType===Node.ELEMENT_NODE&&d.tagName==="DIV"&&(r=0,i++)}const s=[];for(let d=0;d<t.length;d++){const h=t[d];if(d===0)s.push(h);else{const f=s[s.length-1];h.start_line===f.end_line&&h.start_char===f.end_char?(f.textContent+=h.textContent,f.end_line=h.end_line,f.end_char=h.end_char):s.push(h)}}return s}function qsn(n){let e="";function t(r){vL(r)?e+=r.textContent:Bx(r)&&r.childNodes.forEach(i=>{t(i),Bx(i)&&i.tagName==="DIV"&&(e+=`
`)})}return t(n),e}function Ksn(n,e,t){let{node:r}=e;const i=WL();let o=[];const s=()=>Wsn(c.firstChild),a=({shiftKey:d})=>{const h=window.getSelection();if(!(h!=null&&h.rangeCount))return;let f=h.toString();((f==null?void 0:f.length)??!1)&&(d?zCe(h,Usn):zCe(h,Hsn)),o=s(),i("highlight",o)};let c;HT(()=>{var d;Bx(r)&&(c.appendChild(r),(d=c.firstChild)==null||d.classList.add("line-numbered"),t(0,c.firstChild.style.position="relative",c))});const l=()=>({value:qsn(c),highlights:o});function u(d){na[d?"unshift":"push"](()=>{c=d,t(0,c)})}return n.$$set=d=>{"node"in d&&t(3,r=d.node)},[c,s,a,r,l,u]}class Gsn extends fo{constructor(e){super(),po(this,e,Ksn,Bsn,Hi,{node:3,getUpdatedValue:4})}get getUpdatedValue(){return this.$$.ctx[4]}}function VCe(n,e,t){const r=n.slice();r[21]=e[t].readout,r[22]=e[t].index;const i=r[2][r[22]];r[23]=i;const o=function(){return n[15](r[22])};return r[24]=o,r}function WCe(n,e,t){const r=n.slice();return r[27]=e[t],r[22]=t,r}function Zsn(n){let e,t=Fs(n[6]),r=[];for(let i=0;i<t.length;i+=1)r[i]=qCe(WCe(n,t,i));return{c(){e=Ne("div");for(let i=0;i<r.length;i+=1)r[i].c();this.h()},l(i){e=Fe(i,"DIV",{role:!0,class:!0});var o=tt(e);for(let s=0;s<r.length;s+=1)r[s].l(o);o.forEach(Ee),this.h()},h(){Re(e,"role","tablist"),Re(e,"class","tabs tabs-lifted mb-2")},m(i,o){Ft(i,e,o);for(let s=0;s<r.length;s+=1)r[s]&&r[s].m(e,null)},p(i,o){if(o&66){t=Fs(i[6]);let s;for(s=0;s<t.length;s+=1){const a=WCe(i,t,s);r[s]?r[s].p(a,o):(r[s]=qCe(a),r[s].c(),r[s].m(e,null))}for(;s<r.length;s+=1)r[s].d(1);r.length=t.length}},d(i){i&&Ee(e),Kf(r,i)}}}function Xsn(n){let e;return{c(){e=Jr("(Oldest)")},l(t){e=Qr(t,"(Oldest)")},m(t,r){Ft(t,e,r)},d(t){t&&Ee(e)}}}function Ysn(n){let e;return{c(){e=Jr("(Current)")},l(t){e=Qr(t,"(Current)")},m(t,r){Ft(t,e,r)},d(t){t&&Ee(e)}}}function qCe(n){let e,t=n[22]+1+"",r,i,o,s,a;function c(h,f){if(h[22]===0)return Ysn;if(h[22]===h[6].length-1)return Xsn}let l=c(n),u=l&&l(n);function d(){return n[13](n[27])}return{c(){e=Ne("button"),r=Jr(t),i=Kt(),u&&u.c(),o=Kt(),this.h()},l(h){e=Fe(h,"BUTTON",{role:!0,class:!0});var f=tt(e);r=Qr(f,t),i=Gt(f),u&&u.l(f),o=Gt(f),f.forEach(Ee),this.h()},h(){Re(e,"role","tab"),Re(e,"class","tab tab-active [--tab-bg:var(--primary-light)]"),Kr(e,"tab-active",n[27]===n[1])},m(h,f){Ft(h,e,f),we(e,r),we(e,i),u&&u.m(e,null),we(e,o),s||(a=_r(e,"click",d),s=!0)},p(h,f){n=h,f&66&&Kr(e,"tab-active",n[27]===n[1])},d(h){h&&Ee(e),u&&u.d(),s=!1,a()}}}function KCe(n){let e,t;return e=new Gsn({props:{node:n[5]}}),e.$on("highlight",n[14]),{c(){Bo(e.$$.fragment)},l(r){Ho(e.$$.fragment,r)},m(r,i){Uo(e,r,i),t=!0},p(r,i){const o={};i&32&&(o.node=r[5]),e.$set(o)},i(r){t||(cn(e.$$.fragment,r),t=!0)},o(r){Sn(e.$$.fragment,r),t=!1},d(r){zo(e,r)}}}function GCe(n){let e,t,r,i,o,s,a,c,l,u,d;return a=new ZW({props:{clearCallback:void 0,rounded:!0,opacity:n[23]?1:.5,doRegister:!1,items:n[21].split(`
`).map(YCe)}}),{c(){e=Ne("h2"),t=Ne("input"),i=Jr(`
                            Include Run`),o=Kt(),s=Ne("div"),Bo(a.$$.fragment),c=Kt(),this.h()},l(h){e=Fe(h,"H2",{class:!0});var f=tt(e);t=Fe(f,"INPUT",{type:!0,class:!0}),i=Qr(f,`
                            Include Run`),f.forEach(Ee),o=Gt(h),s=Fe(h,"DIV",{class:!0});var p=tt(s);Ho(a.$$.fragment,p),c=Gt(p),p.forEach(Ee),this.h()},h(){Re(t,"type","checkbox"),t.checked=r=n[23],Re(t,"class","checkbox"),Re(e,"class","card-title"),Re(s,"class","rounded-lg mt-1")},m(h,f){Ft(h,e,f),we(e,t),we(e,i),Ft(h,o,f),Ft(h,s,f),Uo(a,s,null),we(s,c),l=!0,u||(d=_r(t,"input",function(){S2(n[24])&&n[24].apply(this,arguments)}),u=!0)},p(h,f){n=h,(!l||f&20&&r!==(r=n[23]))&&(t.checked=r);const p={};f&20&&(p.opacity=n[23]?1:.5),f&16&&(p.items=n[21].split(`
`).map(YCe)),a.$set(p)},i(h){l||(cn(a.$$.fragment,h),l=!0)},o(h){Sn(a.$$.fragment,h),l=!1},d(h){h&&(Ee(e),Ee(o),Ee(s)),zo(a),u=!1,d()}}}function ZCe(n){let e=n[1]+n[22],t,r,i=GCe(n);return{c(){i.c(),t=Ji()},l(o){i.l(o),t=Ji()},m(o,s){i.m(o,s),Ft(o,t,s),r=!0},p(o,s){s&18&&Hi(e,e=o[1]+o[22])?(ja(),Sn(i,1,1,Dt),Ba(),i=GCe(o),i.c(),cn(i,1),i.m(t.parentNode,t)):i.p(o,s)},i(o){r||(cn(i),r=!0)},o(o){Sn(i),r=!1},d(o){o&&Ee(t),i.d(o)}}}function XCe(n){let e,t,r=Fs(n[4]),i=[];for(let s=0;s<r.length;s+=1)i[s]=ZCe(VCe(n,r,s));const o=s=>Sn(i[s],1,1,()=>{i[s]=null});return{c(){for(let s=0;s<i.length;s+=1)i[s].c();e=Ji()},l(s){for(let a=0;a<i.length;a+=1)i[a].l(s);e=Ji()},m(s,a){for(let c=0;c<i.length;c+=1)i[c]&&i[c].m(s,a);Ft(s,e,a),t=!0},p(s,a){if(a&278){r=Fs(s[4]);let c;for(c=0;c<r.length;c+=1){const l=VCe(s,r,c);i[c]?(i[c].p(l,a),cn(i[c],1)):(i[c]=ZCe(l),i[c].c(),cn(i[c],1),i[c].m(e.parentNode,e))}for(ja(),c=r.length;c<i.length;c+=1)o(c);Ba()}},i(s){if(!t){for(let a=0;a<r.length;a+=1)cn(i[a]);t=!0}},o(s){i=i.filter(Boolean);for(let a=0;a<i.length;a+=1)Sn(i[a]);t=!1},d(s){s&&Ee(e),Kf(i,s)}}}function Jsn(n){let e,t,r,i,o,s,a,c,l,u=n[1],d,h,f=`<p>Highlight a region by selecting it. Remove a highlight by
                    selecting it while holding
                    <kbd class="kbd kbd-sm">Shift</kbd></p> <br/>`,p,g,m=n[1],v,b,S,E=n[6].length>1&&Zsn(n),w=KCe(n),C=XCe(n);return{c(){e=Ne("div"),E&&E.c(),t=Kt(),r=Ne("div"),i=Ne("div"),o=Ne("h2"),s=Ne("input"),a=Jr(`
                Include Code`),c=Kt(),l=Ne("div"),w.c(),d=Kt(),h=Ne("div"),h.innerHTML=f,p=Kt(),g=Ne("div"),C.c(),this.h()},l(I){e=Fe(I,"DIV",{class:!0});var T=tt(e);E&&E.l(T),t=Gt(T),r=Fe(T,"DIV",{class:!0});var D=tt(r);i=Fe(D,"DIV",{class:!0});var O=tt(i);o=Fe(O,"H2",{class:!0});var M=tt(o);s=Fe(M,"INPUT",{type:!0,class:!0}),a=Qr(M,`
                Include Code`),M.forEach(Ee),c=Gt(O),l=Fe(O,"DIV",{class:!0});var R=tt(l);w.l(R),R.forEach(Ee),d=Gt(O),h=Fe(O,"DIV",{"data-svelte-h":!0}),Fr(h)!=="svelte-1f3v8yd"&&(h.innerHTML=f),O.forEach(Ee),p=Gt(D),g=Fe(D,"DIV",{class:!0});var A=tt(g);C.l(A),A.forEach(Ee),D.forEach(Ee),T.forEach(Ee),this.h()},h(){Re(s,"type","checkbox"),s.checked=n[3],Re(s,"class","checkbox"),Re(o,"class","card-title"),Re(l,"class","flex-grow border border-black overflow-y-hidden rounded-lg mt-1"),Fn(l,"transition","opacity 0.2s"),Fn(l,"opacity",n[3]?1:.5),Re(i,"class","h-full flex flex-col"),Re(g,"class","w-1/2 mx-2 h-full flex flex-col overflow-scroll"),Re(r,"class","flex flex-row w-full h-full max-h-full overflow-y-hidden"),Re(e,"class","flex flex-col h-full px-2")},m(I,T){Ft(I,e,T),E&&E.m(e,null),we(e,t),we(e,r),we(r,i),we(i,o),we(o,s),we(o,a),we(i,c),we(i,l),w.m(l,null),we(i,d),we(i,h),we(r,p),we(r,g),C.m(g,null),v=!0,b||(S=_r(s,"input",n[7]),b=!0)},p(I,[T]){I[6].length>1&&E.p(I,T),(!v||T&8)&&(s.checked=I[3]),T&2&&Hi(u,u=I[1])?(ja(),Sn(w,1,1,Dt),Ba(),w=KCe(I),w.c(),cn(w,1),w.m(l,null)):w.p(I,T),T&8&&Fn(l,"opacity",I[3]?1:.5),T&2&&Hi(m,m=I[1])?(ja(),Sn(C,1,1,Dt),Ba(),C=XCe(I),C.c(),cn(C,1),C.m(g,null)):C.p(I,T)},i(I){v||(cn(w),cn(C),v=!0)},o(I){Sn(w),Sn(C),v=!1},d(I){I&&Ee(e),E&&E.d(),w.d(I),C.d(I),b=!1,S()}}}const YCe=n=>({content:n.replace(/^-/,""),type:"default"});function Qsn(n,e,t){let r,i,o,s,a,{current:c}=e,{codeExecutionCache:l}=e,{state:u}=e;const{queue:d,content:h}=l,p=(d.includes(c.identifier)?[...d]:[...d,c.identifier]).reverse();let g=p[0];const m=()=>u,v=T=>{if(t(3,s=T),u.includeCodeByIdentifier.set(g,T),!T)for(let D=0;D<i.length;D++)S(D,!1)},b=()=>v(!s),S=(T,D)=>{var O,M;t(2,a[T]=D,a),D?((O=u.includeExecutionByIdentifier.get(g))==null||O.add(T),s||v(!0)):(M=u.includeExecutionByIdentifier.get(g))==null||M.delete(T)},E=T=>S(T,!a[T]),w=T=>t(1,g=T),C=({detail:T})=>u.highlightsByIdentifier.set(g,T),I=T=>E(T);return n.$$set=T=>{"current"in T&&t(9,c=T.current),"codeExecutionCache"in T&&t(10,l=T.codeExecutionCache),"state"in T&&t(0,u=T.state)},n.$$.update=()=>{n.$$.dirty&514&&t(5,r=h.editorNodes.get(g)??c.node),n.$$.dirty&2&&t(12,i=h.executions.get(g)??[]),n.$$.dirty&4096&&t(4,o=[...i].map((T,D)=>({readout:T,index:D})).reverse()),n.$$.dirty&3&&t(3,s=u.includeCodeByIdentifier.get(g)),n.$$.dirty&4099&&t(2,a=i.map((T,D)=>{var O;return((O=u.includeExecutionByIdentifier.get(g))==null?void 0:O.has(D))??!1}))},[u,g,a,s,o,r,p,b,E,c,l,m,i,w,C,I]}class ean extends fo{constructor(e){super(),po(this,e,Qsn,Jsn,Hi,{current:9,codeExecutionCache:10,state:0,getState:11})}get getState(){return this.$$.ctx[11]}}function JCe(n,e,t){const r=n.slice();return r[26]=e[t],r}function QCe(n,e,t){const r=n.slice();return r[29]=e[t],r}function e2e(n){let e,t,r,i;function o(){return n[18](n[29])}return{c(){e=Ne("div"),this.h()},l(s){e=Fe(s,"DIV",{style:!0,class:!0}),tt(e).forEach(Ee),this.h()},h(){Re(e,"style",t=n[6](n[29])),Re(e,"class","svelte-1o02ur2"),Kr(e,"grabber",DHe),Kr(e,"active",n[29].direction===n[0])},m(s,a){Ft(s,e,a),r||(i=_r(e,"mousedown",o),r=!0)},p(s,a){n=s,a[0]&2&&t!==(t=n[6](n[29]))&&Re(e,"style",t),a[0]&3&&Kr(e,"active",n[29].direction===n[0])},d(s){s&&Ee(e),r=!1,i()}}}function t2e(n){let e,t,r,i;function o(){return n[19](n[26])}return{c(){e=Ne("div"),this.h()},l(s){e=Fe(s,"DIV",{style:!0,class:!0}),tt(e).forEach(Ee),this.h()},h(){Re(e,"style",t=n[7](n[26])),Re(e,"class","svelte-1o02ur2"),Kr(e,"grabber",DHe)},m(s,a){Ft(s,e,a),r||(i=_r(e,"mousedown",o),r=!0)},p(s,a){n=s,a[0]&4&&t!==(t=n[7](n[26]))&&Re(e,"style",t)},d(s){s&&Ee(e),r=!1,i()}}}function tan(n){let e,t,r,i,o=Fs(n[1]),s=[];for(let l=0;l<o.length;l+=1)s[l]=e2e(QCe(n,o,l));let a=Fs(n[2]),c=[];for(let l=0;l<a.length;l+=1)c[l]=t2e(JCe(n,a,l));return{c(){for(let l=0;l<s.length;l+=1)s[l].c();e=Kt();for(let l=0;l<c.length;l+=1)c[l].c();t=Ji()},l(l){for(let u=0;u<s.length;u+=1)s[u].l(l);e=Gt(l);for(let u=0;u<c.length;u+=1)c[u].l(l);t=Ji()},m(l,u){for(let d=0;d<s.length;d+=1)s[d]&&s[d].m(l,u);Ft(l,e,u);for(let d=0;d<c.length;d+=1)c[d]&&c[d].m(l,u);Ft(l,t,u),r||(i=[_r(window,"mouseup",n[5]),_r(window,"mousemove",n[4])],r=!0)},p(l,u){if(u[0]&75){o=Fs(l[1]);let d;for(d=0;d<o.length;d+=1){const h=QCe(l,o,d);s[d]?s[d].p(h,u):(s[d]=e2e(h),s[d].c(),s[d].m(e.parentNode,e))}for(;d<s.length;d+=1)s[d].d(1);s.length=o.length}if(u[0]&140){a=Fs(l[2]);let d;for(d=0;d<a.length;d+=1){const h=JCe(l,a,d);c[d]?c[d].p(h,u):(c[d]=t2e(h),c[d].c(),c[d].m(t.parentNode,t))}for(;d<c.length;d+=1)c[d].d(1);c.length=a.length}},i:Dt,o:Dt,d(l){l&&(Ee(e),Ee(t)),Kf(s,l),Kf(c,l),r=!1,qh(i)}}}var mm=(n=>(n[n.Top=0]="Top",n[n.Bottom=1]="Bottom",n[n.Left=2]="Left",n[n.Right=3]="Right",n[n.TopRight=4]="TopRight",n[n.TopLeft=5]="TopLeft",n[n.BottomRight=6]="BottomRight",n[n.BottomLeft=7]="BottomLeft",n))(mm||{});const n2e={0:"row-resize",1:"row-resize",3:"col-resize",2:"col-resize",4:"ne-resize",5:"nw-resize",6:"se-resize",7:"sw-resize"},nan=[0,4,5],ran=[1,6,7],ian=[3,4,6],oan=[2,5,7],DHe=!0,jl=6,xV="var(--primary-medium)",EV=10;function san(n,e,t){let{width:r}=e,{height:i}=e;const o=WL();let s,a;const c=M=>M.includes(a);function l(M){s=!0,t(0,a=M)}function u(M){if(s){let R=c(nan)?M.movementY:0,A=c(ran)?M.movementY:0,k=c(ian)?M.movementX:0,L=c(oan)?M.movementX:0;o("resize",{upward:R,downward:A,leftward:L,rightward:k})}}function d(){s=!1}const h=M=>`repeating-linear-gradient(
    ${M}deg, 
    ${xV}, 
    ${xV} ${EV}px, 
    transparent ${EV}px, 
    transparent ${2*EV}px)`,f=M=>{const{height:R,width:A,left:k,top:L,angle:j,direction:N}=M,B=n2e[N],U=h(j);return`height: ${R}px; width: ${A}px; left: ${k}px; top: ${L}px; background: ${U}; cursor: ${B}`},p=M=>{const{left:R,top:A,direction:k}=M,L=jl*2,j=n2e[k];return`height: ${L}px; width: ${L}px; left: ${R}px; top: ${A}px; background-color: ${xV}; cursor: ${j}`};let g,m,v,b,S,E,w,C,I,T;const D=M=>l(M.direction),O=M=>l(M.direction);return n.$$set=M=>{"width"in M&&t(8,r=M.width),"height"in M&&t(9,i=M.height)},n.$$.update=()=>{n.$$.dirty[0]&768&&t(10,g={height:i,width:jl,left:r,top:0,angle:0,direction:mm.Right}),n.$$.dirty[0]&512&&t(11,m={height:i,width:jl,left:-jl,top:0,angle:0,direction:mm.Left}),n.$$.dirty[0]&256&&t(12,v={height:jl,width:r,left:0,top:-jl,angle:90,direction:mm.Top}),n.$$.dirty[0]&768&&t(13,b={height:jl,width:r,left:0,top:i,angle:90,direction:mm.Bottom}),n.$$.dirty[0]&15360&&t(1,S=[g,m,v,b]),n.$$.dirty[0]&256&&t(14,E={left:r-jl,top:-jl,direction:mm.TopRight}),n.$$.dirty[0]&768&&t(16,C={left:r-jl,top:i-jl,direction:mm.BottomRight}),n.$$.dirty[0]&512&&t(17,I={left:-jl,top:i-jl,direction:mm.BottomLeft}),n.$$.dirty[0]&245760&&t(2,T=[E,w,I,C])},t(15,w={left:-jl,top:-jl,direction:mm.TopLeft}),[a,S,T,l,u,d,f,p,r,i,g,m,v,b,E,w,C,I,D,O]}class aan extends fo{constructor(e){super(),po(this,e,san,tan,Hi,{width:8,height:9},null,[-1,-1])}}function can(n){let e,t,r,i,o,s,a,c,l;function u(g){n[14](g)}function d(g){n[15](g)}let h={};n[0]!==void 0&&(h.width=n[0]),n[1]!==void 0&&(h.height=n[1]),t=new aan({props:h}),na.push(()=>YV(t,"width",u)),na.push(()=>YV(t,"height",d)),t.$on("resize",n[7]);const f=n[13].default,p=_Ge(f,n,n[12],null);return{c(){e=Ne("div"),Bo(t.$$.fragment),o=Kt(),s=Ne("div"),p&&p.c(),this.h()},l(g){e=Fe(g,"DIV",{class:!0,style:!0});var m=tt(e);Ho(t.$$.fragment,m),o=Gt(m),s=Fe(m,"DIV",{class:!0,style:!0});var v=tt(s);p&&p.l(v),v.forEach(Ee),m.forEach(Ee),this.h()},h(){Re(s,"class","draggable svelte-1dw4u5z"),Fn(s,"width",n[0]+"px"),Fn(s,"height",n[1]+"px"),Re(e,"class","container svelte-1dw4u5z"),Fn(e,"left",n[2]+"px"),Fn(e,"top",n[3]+"px")},m(g,m){Ft(g,e,m),Uo(t,e,null),we(e,o),we(e,s),p&&p.m(s,null),a=!0,c||(l=[_r(window,"mouseup",n[6]),_r(window,"mousemove",n[5]),_r(s,"mousedown",n[4])],c=!0)},p(g,[m]){const v={};!r&&m&1&&(r=!0,v.width=g[0],GV(()=>r=!1)),!i&&m&2&&(i=!0,v.height=g[1],GV(()=>i=!1)),t.$set(v),p&&p.p&&(!a||m&4096)&&wGe(p,f,g,g[12],a?xGe(f,g[12],m,null):CGe(g[12]),null),(!a||m&1)&&Fn(s,"width",g[0]+"px"),(!a||m&2)&&Fn(s,"height",g[1]+"px"),(!a||m&4)&&Fn(e,"left",g[2]+"px"),(!a||m&8)&&Fn(e,"top",g[3]+"px")},i(g){a||(cn(t.$$.fragment,g),cn(p,g),a=!0)},o(g){Sn(t.$$.fragment,g),Sn(p,g),a=!1},d(g){g&&Ee(e),zo(t),p&&p.d(g),c=!1,qh(l)}}}const Su=(n,e,t)=>Math.min(Math.max(n,e),t);function lan(n,e,t){let{$$slots:r={},$$scope:i}=e,{containerWidth:o}=e,{containerHeight:s}=e,{left:a=0}=e,{top:c=0}=e,{width:l=50}=e,{height:u=50}=e,{modified:d=!1}=e,{clipInfo:h}=e;const f=()=>({containerSize:{width:o,height:s},frameSize:{width:l,height:u},framePosition:{left:a,top:c}}),p=()=>t(9,h=f());let g,m;function v(D){o>0&&s>0&&(t(2,a=Su(a,a,g)),t(3,c=Su(c,c,m)),p())}let b=!1;function S(){b=!0}function E(D){b&&(t(8,d=!0),t(2,a=Su(a+D.movementX,0,g)),t(3,c=Su(c+D.movementY,0,m)),p())}function w(){b&&p(),b=!1}function C(D){t(8,d=!0);const O=a+D.detail.leftward,M=c+D.detail.upward;t(2,a=Su(O,0,g)),t(3,c=Su(M,0,m)),(a<g||D.detail.rightward<0)&&t(0,l=Su(l+D.detail.rightward,0,o-O)),a>0&&t(0,l=Su(l-D.detail.leftward,0,o-O)),(c<m||D.detail.downward<0)&&t(1,u=Su(u+D.detail.downward,0,s-M)),c>0&&t(1,u=Su(u-D.detail.upward,0,s-M)),t(2,a=Su(O,1,g)),t(3,c=Su(M,1,m)),t(0,l=Su(l,1,o-O)),t(1,u=Su(u,1,s-M)),p()}HT(p);function I(D){l=D,t(0,l)}function T(D){u=D,t(1,u)}return n.$$set=D=>{"containerWidth"in D&&t(10,o=D.containerWidth),"containerHeight"in D&&t(11,s=D.containerHeight),"left"in D&&t(2,a=D.left),"top"in D&&t(3,c=D.top),"width"in D&&t(0,l=D.width),"height"in D&&t(1,u=D.height),"modified"in D&&t(8,d=D.modified),"clipInfo"in D&&t(9,h=D.clipInfo),"$$scope"in D&&t(12,i=D.$$scope)},n.$$.update=()=>{n.$$.dirty&1025&&(g=o-l-1),n.$$.dirty&2050&&(m=s-u-1),n.$$.dirty&3072&&v()},[l,u,a,c,S,E,w,C,d,h,o,s,i,r,I,T]}class uan extends fo{constructor(e){super(),po(this,e,lan,can,Hi,{containerWidth:10,containerHeight:11,left:2,top:3,width:0,height:1,modified:8,clipInfo:9})}}function dan(n){let e,t=n[23].message+"",r;return{c(){e=Ne("div"),r=Jr(t)},l(i){e=Fe(i,"DIV",{});var o=tt(e);r=Qr(o,t),o.forEach(Ee)},m(i,o){Ft(i,e,o),we(e,r)},p:Dt,i:Dt,o:Dt,d(i){i&&Ee(e)}}}function han(n){let e,t,r,i=`Click, drag, and resize the region to select a portion of your
                whiteboard.`,o,s,a,c="<span>Zoom:</span>",l,u,d,h,f,p,g,m,v,b,S,E,w,C,I,T,D,O,M,R="Done",A,k,L;function j(B){n[18](B)}let N={containerHeight:n[3],containerWidth:n[4],height:.95*n[3]*n[2],width:.95*n[4]*n[2]};return n[0]!==void 0&&(N.clipInfo=n[0]),m=new uan({props:N}),na.push(()=>YV(m,"clipInfo",j)),{c(){e=Ne("div"),t=Ne("div"),r=Ne("h2"),r.textContent=i,o=Kt(),s=Ne("div"),a=Ne("div"),a.innerHTML=c,l=Kt(),u=Ne("div"),d=Ne("input"),h=Kt(),f=Ne("div"),p=Ne("div"),g=Ne("div"),Bo(m.$$.fragment),b=Kt(),S=Ne("img"),w=Kt(),C=Ne("img"),D=Kt(),O=Ne("center"),M=Ne("button"),M.textContent=R,this.h()},l(B){e=Fe(B,"DIV",{class:!0});var U=tt(e);t=Fe(U,"DIV",{class:!0});var K=tt(t);r=Fe(K,"H2",{class:!0,"data-svelte-h":!0}),Fr(r)!=="svelte-tt9gny"&&(r.textContent=i),o=Gt(K),s=Fe(K,"DIV",{class:!0});var z=tt(s);a=Fe(z,"DIV",{class:!0,"data-svelte-h":!0}),Fr(a)!=="svelte-1xmpnl8"&&(a.innerHTML=c),l=Gt(z),u=Fe(z,"DIV",{class:!0});var G=tt(u);d=Fe(G,"INPUT",{type:!0,min:!0,max:!0,class:!0}),G.forEach(Ee),z.forEach(Ee),K.forEach(Ee),h=Gt(U),f=Fe(U,"DIV",{class:!0});var te=tt(f);p=Fe(te,"DIV",{class:!0});var ie=tt(p);g=Fe(ie,"DIV",{class:!0,style:!0});var Q=tt(g);Ho(m.$$.fragment,Q),b=Gt(Q),S=Fe(Q,"IMG",{src:!0,alt:!0,style:!0,class:!0}),w=Gt(Q),C=Fe(Q,"IMG",{src:!0,alt:!0,class:!0,style:!0}),Q.forEach(Ee),ie.forEach(Ee),te.forEach(Ee),D=Gt(U),O=Fe(U,"CENTER",{});var ge=tt(O);M=Fe(ge,"BUTTON",{class:!0,"data-svelte-h":!0}),Fr(M)!=="svelte-1e8gwds"&&(M.textContent=R),ge.forEach(Ee),U.forEach(Ee),this.h()},h(){Re(r,"class","card-title"),Re(a,"class","mr-1"),Re(d,"type","range"),Re(d,"min","0"),Re(d,"max","100"),Re(d,"class","range range-xs"),Re(u,"class","flex-grow"),Re(s,"class","flex flex-row w-full items-center mb-1"),Re(t,"class","h-18 bg-none"),_2(S.src,E=n[22])||Re(S,"src",E),Re(S,"alt","the cropped / selected portion of the whiteboard"),Re(S,"style",n[6]),Re(S,"class","z-10"),_2(C.src,I=n[22])||Re(C,"src",I),Re(C,"alt","the full whiteboard"),Re(C,"class","no-select full-size svelte-1bxifu4"),Fn(C,"width",n[8]+"px"),Fn(C,"height",n[7]+"px"),Re(g,"class","m-auto"),Fn(g,"width",n[8]+"px"),Fn(g,"height",n[7]+"px"),ov(()=>n[19].call(g)),Re(p,"class","flex-grow flex flex-col relative items-center justify-center"),Re(f,"class","flex-grow flex flex-col overflow-scroll py-1"),Fn(f,"max-height","calc(100% - 7.5rem);"),Re(M,"class","btn btn-primary w-full"),Re(e,"class","flex flex-col h-full")},m(B,U){Ft(B,e,U),we(e,t),we(t,r),we(t,o),we(t,s),we(s,a),we(s,l),we(s,u),we(u,d),iv(d,n[1]),we(e,h),we(e,f),we(f,p),we(p,g),Uo(m,g,null),we(g,b),we(g,S),we(g,w),we(g,C),T=IGe(g,n[19].bind(g)),we(e,D),we(e,O),we(O,M),A=!0,k||(L=[_r(d,"change",n[15]),_r(d,"input",n[15]),_r(d,"mousedown",n[16]),_r(d,"mouseup",n[17]),_r(C,"load",n[9]),_r(M,"click",i7)],k=!0)},p(B,U){U&2&&iv(d,B[1]);const K={};U&8&&(K.containerHeight=B[3]),U&16&&(K.containerWidth=B[4]),U&12&&(K.height=.95*B[3]*B[2]),U&20&&(K.width=.95*B[4]*B[2]),!v&&U&1&&(v=!0,K.clipInfo=B[0],GV(()=>v=!1)),m.$set(K),(!A||U&64)&&Re(S,"style",B[6]),(!A||U&256)&&Fn(C,"width",B[8]+"px"),(!A||U&128)&&Fn(C,"height",B[7]+"px"),(!A||U&256)&&Fn(g,"width",B[8]+"px"),(!A||U&128)&&Fn(g,"height",B[7]+"px")},i(B){A||(cn(m.$$.fragment,B),A=!0)},o(B){Sn(m.$$.fragment,B),A=!1},d(B){B&&Ee(e),zo(m),T(),k=!1,qh(L)}}}function fan(n){let e,t="Loading...";return{c(){e=Ne("div"),e.textContent=t},l(r){e=Fe(r,"DIV",{"data-svelte-h":!0}),Fr(e)!=="svelte-194gxkm"&&(e.textContent=t)},m(r,i){Ft(r,e,i)},p:Dt,i:Dt,o:Dt,d(r){r&&Ee(e)}}}function pan(n){let e,t,r={ctx:n,current:null,token:null,hasCatch:!0,pending:fan,then:han,catch:dan,value:22,error:23,blocks:[,,,]};return sv(n[10],r),{c(){e=Ji(),r.block.c()},l(i){e=Ji(),r.block.l(i)},m(i,o){Ft(i,e,o),r.block.m(i,r.anchor=o),r.mount=()=>e.parentNode,r.anchor=e,t=!0},p(i,[o]){n=i,qx(r,n,o)},i(i){t||(cn(r.block),t=!0)},o(i){for(let o=0;o<3;o+=1){const s=r.blocks[o];Sn(s)}t=!1},d(i){i&&Ee(e),r.block.d(i),r.token=null,r=null}}}function gan(n,e,t){let r,i,o,s,{getBlob:a}=e,c,l,u,d=70,h=0,f=0,p=!1;const g=()=>({clipInfo:u,displayWidth:i,displayHeight:o});function m(D){const O=D.target;t(13,h=O.naturalWidth),t(14,f=O.naturalHeight)}const b=a().then(D=>URL.createObjectURL(D)),S=D=>{if(!u)return"";const{top:O,left:M}=D.framePosition,{width:R,height:A}=D.frameSize,k=M+R,L=O+A;return`position: absolute; clip: rect(${O}px, ${k}px, ${L}px, ${M}px);`};function E(){d=EGe(this.value),t(1,d)}const w=()=>t(5,p=!0),C=()=>t(5,p=!1);function I(D){u=D,t(0,u)}function T(){c=this.clientHeight,l=this.clientWidth,t(3,c),t(4,l)}return n.$$set=D=>{"getBlob"in D&&t(11,a=D.getBlob)},n.$$.update=()=>{n.$$.dirty&2&&t(2,r=d/100),n.$$.dirty&8196&&t(8,i=h*r),n.$$.dirty&16388&&t(7,o=f*r),n.$$.dirty&1&&t(6,s=S(u))},[u,d,r,c,l,p,s,o,i,m,b,a,g,h,f,E,w,C,I,T]}class man extends fo{constructor(e){super(),po(this,e,gan,pan,Hi,{getBlob:11,getClipInfoAndDimensions:12})}get getClipInfoAndDimensions(){return this.$$.ctx[12]}}function van(n){let e,t,r={getBlob:n[0]};return e=new man({props:r}),n[3](e),{c(){Bo(e.$$.fragment)},l(i){Ho(e.$$.fragment,i)},m(i,o){Uo(e,i,o),t=!0},p(i,[o]){const s={};o&1&&(s.getBlob=i[0]),e.$set(s)},i(i){t||(cn(e.$$.fragment,i),t=!0)},o(i){Sn(e.$$.fragment,i),t=!1},d(i){n[3](null),zo(e,i)}}}function yan(n,e,t){let{getBlob:r}=e;const i=()=>{const{clipInfo:a,displayWidth:c,displayHeight:l}=o.getClipInfoAndDimensions();if(a)return{x:a.framePosition.top/l,y:a.framePosition.left/c,width:a.frameSize.width/c,height:a.frameSize.height/l}};let o;function s(a){na[a?"unshift":"push"](()=>{o=a,t(1,o)})}return n.$$set=a=>{"getBlob"in a&&t(0,r=a.getBlob)},[r,o,i,s]}class ban extends fo{constructor(e){super(),po(this,e,yan,van,Hi,{getBlob:0,getCrop:2})}get getCrop(){return this.$$.ctx[2]}}class r2e{constructor(e,t){$(this,"versions",new Map);$(this,"attachmentIndicators",new Map);$(this,"internals",new Map);$(this,"isShared",new Map);$(this,"attachmentStates",new Map);this.type=e,this.workspaceID=t}getAttachmentIndicator(e,t=!0){const r=this.attachmentIndicators.get(e);if(!r&&t)throw new Error(`No attachment indicator found for key: ${e}`);return r}setAttachmentIndicator(e,t){return this.attachmentIndicators.set(e,t),t}getOrCreateAttachmentIndicator(e,t){return this.attachmentIndicators.get(e)??this.setAttachmentIndicator(e,t())}deleteAttachmentIndicator(e){const t=this.attachmentIndicators.get(e);this.attachmentIndicators.delete(e),t&&t.$destroy()}incrementVersion(e){const t=this.versions.get(e)??0;this.versions.set(e,t+1)}getVersion(e){return this.versions.get(e)??0}getCacheIdentifier(e){return`${this.type}:${e}:${this.getVersion(e)}`}setInternal(e,t){return this.internals.set(e,t),t}getInternal(e,t=!0){const r=this.internals.get(e);if(!r&&t)throw new Error(`No internal found for key: ${e}`);return r}setIsShared(e,t){return this.isShared.set(e,t)}getIsShared(e,t=!0){const r=this.isShared.get(e);if(!r&&t)throw new Error(`No isShared found for key: ${e}`);return r}getItems(){const e=[];for(const[t,r]of this.internals.entries())e.push({shared:this.isShared.get(t)??!1,internal:r,version:this.versions.get(t)??0,identifier:t,cacheIdentifier:this.getCacheIdentifier(t),indicator:this.attachmentIndicators.get(t),state:this.attachmentStates.get(t)});return e}hasAttachmentState(e){return this.attachmentStates.has(e)}setAttachmentState(e,t){return this.attachmentStates.set(e,t),t}dropAttachmentState(e){this.attachmentStates.delete(e)}getAttachmentState(e,t=!0){const r=this.attachmentStates.get(e);if(!r&&t)throw new Error(`No attachment state found for key: ${e}`);return r}}const San=v1.object({content:v1.string().describe("The content of the option in a multiple choice question."),correct:v1.boolean().describe("Whether the option is correct or not. There should be only one correct option."),explanation:v1.string().describe("An explanation of why the option is correct or incorrect.")}),i2e=v1.object({question:v1.string().describe("The question component of a multiple choice question."),options:v1.array(San).describe("The options in a multiple choice question (typically a total of 4).")}),o2e="GeneratedMultipleChoiceQuestion",yL={structure:i2e,title:o2e,schema:fGe(i2e,o2e),parse:n=>pGe(n)};function s2e(n,e,t){const r=n.slice();r[9]=e[t].content,r[10]=e[t].correct,r[11]=e[t].explanation,r[17]=t;const i=r[3]===r[17];r[12]=i;const o=function(){return n[8](r[17],r[10])};r[13]=o;const s=r[12]&&r[10];r[14]=s;const a=r[12]&&!r[10];return r[15]=a,r}function a2e(n){let e,t='<div class="m-auto w-fit"><span class="loading loading-bars loading-lg"></span></div>';return{c(){e=Ne("div"),e.innerHTML=t,this.h()},l(r){e=Fe(r,"DIV",{class:!0,"data-svelte-h":!0}),Fr(e)!=="svelte-r545ml"&&(e.innerHTML=t),this.h()},h(){Re(e,"class","absolute w-full h-full z-40")},m(r,i){Ft(r,e,i)},d(r){r&&Ee(e)}}}function _an(n){let e;return{c(){e=Ne("span"),this.h()},l(t){e=Fe(t,"SPAN",{class:!0}),tt(e).forEach(Ee),this.h()},h(){Re(e,"class","loading loading-spinner loading-md")},m(t,r){Ft(t,e,r)},p:Dt,i:Dt,o:Dt,d(t){t&&Ee(e)}}}function wan(n){let e,t;return e=new By({props:{content:n[1]}}),{c(){Bo(e.$$.fragment)},l(r){Ho(e.$$.fragment,r)},m(r,i){Uo(e,r,i),t=!0},p(r,i){const o={};i&2&&(o.content=r[1]),e.$set(o)},i(r){t||(cn(e.$$.fragment,r),t=!0)},o(r){Sn(e.$$.fragment,r),t=!1},d(r){zo(e,r)}}}function c2e(n){let e;return{c(){e=Ne("div"),this.h()},l(t){e=Fe(t,"DIV",{class:!0}),tt(e).forEach(Ee),this.h()},h(){Re(e,"class","loading loading-spinner loading-lg")},m(t,r){Ft(t,e,r)},d(t){t&&Ee(e)}}}function l2e(n){let e,t,r=Fs(n[0]),i=[];for(let s=0;s<r.length;s+=1)i[s]=h2e(s2e(n,r,s));const o=s=>Sn(i[s],1,1,()=>{i[s]=null});return{c(){for(let s=0;s<i.length;s+=1)i[s].c();e=Ji()},l(s){for(let a=0;a<i.length;a+=1)i[a].l(s);e=Ji()},m(s,a){for(let c=0;c<i.length;c+=1)i[c]&&i[c].m(s,a);Ft(s,e,a),t=!0},p(s,a){if(a&25){r=Fs(s[0]);let c;for(c=0;c<r.length;c+=1){const l=s2e(s,r,c);i[c]?(i[c].p(l,a),cn(i[c],1)):(i[c]=h2e(l),i[c].c(),cn(i[c],1),i[c].m(e.parentNode,e))}for(ja(),c=r.length;c<i.length;c+=1)o(c);Ba()}},i(s){if(!t){for(let a=0;a<r.length;a+=1)cn(i[a]);t=!0}},o(s){i=i.filter(Boolean);for(let a=0;a<i.length;a+=1)Sn(i[a]);t=!1},d(s){s&&Ee(e),Kf(i,s)}}}function u2e(n){let e,t=n[14]?"Correct":"Incorrect",r;return{c(){e=Ne("span"),r=Jr(t),this.h()},l(i){e=Fe(i,"SPAN",{class:!0});var o=tt(e);r=Qr(o,t),o.forEach(Ee),this.h()},h(){Re(e,"class","indicator-item indicator-top indicator-center badge"),Kr(e,"badge-success",n[14]),Kr(e,"badge-error",n[15])},m(i,o){Ft(i,e,o),we(e,r)},p(i,o){o&9&&t!==(t=i[14]?"Correct":"Incorrect")&&yl(r,t),o&9&&Kr(e,"badge-success",i[14]),o&9&&Kr(e,"badge-error",i[15])},d(i){i&&Ee(e)}}}function Can(n){let e;return{c(){e=Ne("div"),this.h()},l(t){e=Fe(t,"DIV",{class:!0}),tt(e).forEach(Ee),this.h()},h(){Re(e,"class","loading loading-spinner loading-lg")},m(t,r){Ft(t,e,r)},p:Dt,i:Dt,o:Dt,d(t){t&&Ee(e)}}}function xan(n){let e,t;return e=new By({props:{content:n[9]}}),{c(){Bo(e.$$.fragment)},l(r){Ho(e.$$.fragment,r)},m(r,i){Uo(e,r,i),t=!0},p(r,i){const o={};i&1&&(o.content=r[9]),e.$set(o)},i(r){t||(cn(e.$$.fragment,r),t=!0)},o(r){Sn(e.$$.fragment,r),t=!1},d(r){zo(e,r)}}}function d2e(n){let e,t;return e=new By({props:{content:n[11]}}),{c(){Bo(e.$$.fragment)},l(r){Ho(e.$$.fragment,r)},m(r,i){Uo(e,r,i),t=!0},p(r,i){const o={};i&1&&(o.content=r[11]),e.$set(o)},i(r){t||(cn(e.$$.fragment,r),t=!0)},o(r){Sn(e.$$.fragment,r),t=!1},d(r){zo(e,r)}}}function h2e(n){let e,t,r,i,o,s,a,c,l,u,d,h,f,p,g,m,v,b,S,E=n[12]&&u2e(n);const w=[xan,Can],C=[];function I(D,O){return D[9]?0:1}h=I(n),f=C[h]=w[h](n);let T=n[11]&&d2e(n);return{c(){e=Ne("div"),E&&E.c(),t=Kt(),r=Ne("div"),i=Ne("input"),s=Kt(),a=Ne("div"),c=Ne("input"),u=Kt(),d=Ne("div"),f.c(),p=Kt(),g=Ne("div"),T&&T.c(),m=Kt(),this.h()},l(D){e=Fe(D,"DIV",{class:!0});var O=tt(e);E&&E.l(O),t=Gt(O),r=Fe(O,"DIV",{class:!0});var M=tt(r);i=Fe(M,"INPUT",{type:!0,class:!0}),M.forEach(Ee),s=Gt(O),a=Fe(O,"DIV",{class:!0});var R=tt(a);c=Fe(R,"INPUT",{type:!0}),u=Gt(R),d=Fe(R,"DIV",{class:!0});var A=tt(d);f.l(A),A.forEach(Ee),p=Gt(R),g=Fe(R,"DIV",{class:!0});var k=tt(g);T&&T.l(k),k.forEach(Ee),R.forEach(Ee),m=Gt(O),O.forEach(Ee),this.h()},h(){Re(i,"type","radio"),Re(i,"class","radio"),i.checked=o=n[12],Kr(i,"radio-success",n[14]),Kr(i,"radio-error",n[15]),Re(r,"class","clickable svelte-1f8bu55"),Re(c,"type","radio"),c.checked=l=n[12],Re(d,"class","collapse-title text-m font-medium text-base-content"),Re(g,"class","collapse-content text-base-content"),Re(a,"class","collapse"),Re(e,"class","bg-base-200 flex flex-row indicator w-full"),Kr(e,"border",n[12]),Kr(e,"border-success",n[10]),Kr(e,"border-error",!n[10])},m(D,O){Ft(D,e,O),E&&E.m(e,null),we(e,t),we(e,r),we(r,i),we(e,s),we(e,a),we(a,c),we(a,u),we(a,d),C[h].m(d,null),we(a,p),we(a,g),T&&T.m(g,null),we(e,m),v=!0,b||(S=[_r(i,"click",function(){S2(n[13])&&n[13].apply(this,arguments)}),_r(c,"click",function(){S2(n[13])&&n[13].apply(this,arguments)})],b=!0)},p(D,O){n=D,n[12]?E?E.p(n,O):(E=u2e(n),E.c(),E.m(e,t)):E&&(E.d(1),E=null),(!v||O&8&&o!==(o=n[12]))&&(i.checked=o),(!v||O&9)&&Kr(i,"radio-success",n[14]),(!v||O&9)&&Kr(i,"radio-error",n[15]),(!v||O&8&&l!==(l=n[12]))&&(c.checked=l);let M=h;h=I(n),h===M?C[h].p(n,O):(ja(),Sn(C[M],1,1,()=>{C[M]=null}),Ba(),f=C[h],f?f.p(n,O):(f=C[h]=w[h](n),f.c()),cn(f,1),f.m(d,null)),n[11]?T?(T.p(n,O),O&1&&cn(T,1)):(T=d2e(n),T.c(),cn(T,1),T.m(g,null)):T&&(ja(),Sn(T,1,1,()=>{T=null}),Ba()),(!v||O&8)&&Kr(e,"border",n[12]),(!v||O&1)&&Kr(e,"border-success",n[10]),(!v||O&1)&&Kr(e,"border-error",!n[10])},i(D){v||(cn(f),cn(T),v=!0)},o(D){Sn(f),Sn(T),v=!1},d(D){D&&Ee(e),E&&E.d(),C[h].d(),T&&T.d(),b=!1,qh(S)}}}function Ean(n){var N;let e,t,r,i,o="Question",s,a,c,l,u,d,h,f,p,g,m,v,b="&nbsp;",S,E,w,C,I,T,D,O,M=!n[2]&&a2e();const R=[wan,_an],A=[];function k(B,U){return B[1]?0:1}c=k(n),l=A[c]=R[c](n);let L=(((N=n[0])==null?void 0:N.length)??0)===0&&c2e(),j=n[0]&&l2e(n);return{c(){e=Ne("div"),M&&M.c(),t=Kt(),r=Ne("div"),i=Ne("div"),i.textContent=o,s=Kt(),a=Ne("div"),l.c(),u=Kt(),d=Ne("div"),h=Jr(`You've selected
            `),f=Ne("span"),p=Ne("span"),g=Ne("span"),m=Kt(),v=new zL(!1),S=Jr("of "),E=Jr(n[5]),w=Jr(`
            correct answers`),C=Kt(),I=Ne("div"),T=Kt(),L&&L.c(),D=Kt(),j&&j.c(),this.h()},l(B){e=Fe(B,"DIV",{});var U=tt(e);M&&M.l(U),t=Gt(U),r=Fe(U,"DIV",{class:!0});var K=tt(r);i=Fe(K,"DIV",{class:!0,"data-svelte-h":!0}),Fr(i)!=="svelte-1uahftz"&&(i.textContent=o),s=Gt(K),a=Fe(K,"DIV",{class:!0});var z=tt(a);l.l(z),z.forEach(Ee),u=Gt(K),d=Fe(K,"DIV",{class:!0});var G=tt(d);h=Qr(G,`You've selected
            `),f=Fe(G,"SPAN",{class:!0});var te=tt(f);p=Fe(te,"SPAN",{class:!0});var ie=tt(p);g=Fe(ie,"SPAN",{style:!0,class:!0}),tt(g).forEach(Ee),ie.forEach(Ee),m=Gt(te),v=VL(te,!1),S=Qr(te,"of "),E=Qr(te,n[5]),te.forEach(Ee),w=Qr(G,`
            correct answers`),G.forEach(Ee),K.forEach(Ee),C=Gt(U),I=Fe(U,"DIV",{class:!0,style:!0}),tt(I).forEach(Ee),T=Gt(U),L&&L.l(U),D=Gt(U),j&&j.l(U),U.forEach(Ee),this.h()},h(){Re(i,"class","stat-title text-lg text-center text-gray-300"),Re(a,"class","bg-neutral-medium text-white w-full mt-1"),Fn(g,"--value",n[4].length),Re(g,"class","svelte-1f8bu55"),Re(p,"class","countdown mr-0 svelte-1f8bu55"),v.a=S,Re(f,"class","badge badge-primary"),Kr(f,"bg-primary-dark",n[4].length<n[5]),Kr(f,"badge-success",n[4].length===n[5]),Re(d,"class","bg-neutral-medium text-xs w-full mt-2 text-gray-200"),Re(r,"class","chat-header"),Re(I,"class","divider divider-primary mt-0"),Fn(I,"--fallback-p","var(--primary-dark)")},m(B,U){Ft(B,e,U),M&&M.m(e,null),we(e,t),we(e,r),we(r,i),we(r,s),we(r,a),A[c].m(a,null),we(r,u),we(r,d),we(d,h),we(d,f),we(f,p),we(p,g),we(f,m),v.m(b,f),we(f,S),we(f,E),we(d,w),we(e,C),we(e,I),we(e,T),L&&L.m(e,null),we(e,D),j&&j.m(e,null),O=!0},p(B,[U]){var z;B[2]?M&&(M.d(1),M=null):M||(M=a2e(),M.c(),M.m(e,t));let K=c;c=k(B),c===K?A[c].p(B,U):(ja(),Sn(A[K],1,1,()=>{A[K]=null}),Ba(),l=A[c],l?l.p(B,U):(l=A[c]=R[c](B),l.c()),cn(l,1),l.m(a,null)),(!O||U&16)&&Fn(g,"--value",B[4].length),(!O||U&32)&&yl(E,B[5]),(!O||U&48)&&Kr(f,"bg-primary-dark",B[4].length<B[5]),(!O||U&48)&&Kr(f,"badge-success",B[4].length===B[5]),(((z=B[0])==null?void 0:z.length)??0)===0?L||(L=c2e(),L.c(),L.m(e,D)):L&&(L.d(1),L=null),B[0]?j?(j.p(B,U),U&1&&cn(j,1)):(j=l2e(B),j.c(),cn(j,1),j.m(e,null)):j&&(ja(),Sn(j,1,1,()=>{j=null}),Ba())},i(B){O||(cn(l),cn(j),O=!0)},o(B){Sn(l),Sn(j),O=!1},d(B){B&&Ee(e),M&&M.d(),A[c].d(),L&&L.d(),j&&j.d()}}}function Ian(n,e,t){let r,{question:i=""}=e,{options:o=[]}=e,{isReady:s=!0}=e;const a=(h,f)=>{t(1,i=h),t(0,o=f)},c=h=>{s!==h&&t(2,s=h)};let l=-1,u=new Array;const d=(h,f)=>{t(3,l=h),f&&!u.includes(h)&&(u.push(h),t(4,u))};return n.$$set=h=>{"question"in h&&t(1,i=h.question),"options"in h&&t(0,o=h.options),"isReady"in h&&t(2,s=h.isReady)},n.$$.update=()=>{n.$$.dirty&1&&t(5,r=(o==null?void 0:o.filter(h=>h.correct).length)??0)},[o,i,s,l,u,r,a,c,d]}class RHe extends fo{constructor(e){super(),po(this,e,Ian,Ean,Hi,{question:1,options:0,isReady:2,set:6,ready:7})}get set(){return this.$$.ctx[6]}get ready(){return this.$$.ctx[7]}}const Iw=n=>{if(n.startsWith("public"))return"/shared.png";if(n.startsWith("private"))return"/private.png"},Pan=n=>{const e=new r2e("code",n),t=new r2e("whiteboard",n);return{codeEditors:e,whiteboardEditors:t}},kan=async(n,{state:e,identifier:t,indicator:r,cacheIdentifier:i})=>{if(!(r!=null&&r.getIncluded()))return null;const o=CT.Get(t);if(!e){const s=r.getRunCount(),a=n.get(i)??await o.ids.code.get(i),c=s<=0?null:await Promise.all(Array.from({length:s},(l,u)=>o.executionCount(i)-1-u).map(l=>o.ids.executions.get(i)[l]));return[{code_id:a,highlights:null,code_execution_ids:c}]}return Promise.all(e.includeCodeByIdentifier.entries().filter(([s,a])=>a).map(async([s])=>{var h;const a=n.get(s)??await o.ids.code.get(s),c=e.highlightsByIdentifier.get(s)??null,l=o.ids.executions.get(s),u=l?((h=e.includeExecutionByIdentifier.get(s))==null?void 0:h.values().map(f=>l[f]).toArray())??null:null,d=u?await Promise.all(u):null;return{code_id:a,highlights:c,code_execution_ids:d}}).toArray())},Tan=(n,e)=>Promise.all(n.getItems().map(async t=>{const r=await kan(e,t);return r?await Promise.all(r):null})).then(t=>t.flat()).then(t=>t.filter(r=>r!==null)),Dan=n=>n.getItems().map(e=>{const{identifier:t,shared:r,cacheIdentifier:i,internal:o}=e;return o.getValue().trim()===""?Promise.resolve(null):(CT.Get(t).ids.code.get(i)??Ra("artifactsCode","body",{code:e.internal.getValue(),shared:r,workspace_id:n.workspaceID}).then(({id:c})=>c)).then(c=>({type:"code",cacheIdentifier:i,id:c}))}),Ran=n=>n.getItems().map(({internal:e,shared:t,cacheIdentifier:r})=>e.getCurrentPageShapes().length===0?Promise.resolve(null):iBe(e).then(i=>Ra("artifactsWhiteboard","form",{image:i,shared:t,workspace_id:n.workspaceID})).then(({id:i})=>({type:"whiteboard",cacheIdentifier:r,id:i}))),Aan=n=>Promise.all([...Dan(n.codeEditors),...Ran(n.whiteboardEditors)]).then(e=>e.filter(t=>t!==null)),Oan=(n,e,t)=>{const r=e.getCacheIdentifier(n),i=t.queue,o=i.length-1,s=i[o];if(r!==s){const a=[r,...i];return{includeCodeByIdentifier:new Map(a.map((c,l)=>[c,l===0])),includeExecutionByIdentifier:new Map(a.map(c=>[c,new Set])),highlightsByIdentifier:new Map(a.map(c=>[c,[]]))}}else{const a=t.executionCount(s)-1;return{includeCodeByIdentifier:new Map(i.map((c,l)=>[c,l===o])),includeExecutionByIdentifier:new Map(i.map((c,l)=>[c,l===o&&a>=0?new Set([a]):new Set])),highlightsByIdentifier:new Map(i.map(c=>[c,[]]))}}},Man=async(n,e)=>{const t=await Ra("chatHistory","query",{workspaceId:n,count:10});e&&t.messages.filter(({content:r})=>!!r).forEach(({content:r,role:i,id:o,stamp:s})=>{const[a,c]=qV(r,"schema_title"),l=!!c,u=e.prependMessage(l?"":r,i==="user"?"you":"tutor",new Date(s),o,l);if(c)switch(c){case yL.title:{const h=yL.parse(a).at(-1);new RHe({target:u.getChildTarget(),props:{question:h.question,options:h.options,isReady:!0}});break}}})};function $an(n){let e,t;return e=new TGe({props:{configuration:n[1]}}),{c(){Bo(e.$$.fragment)},l(r){Ho(e.$$.fragment,r)},m(r,i){Uo(e,r,i),t=!0},p:Dt,i(r){t||(cn(e.$$.fragment,r),t=!0)},o(r){Sn(e.$$.fragment,r),t=!1},d(r){zo(e,r)}}}function Lan(n){let e,t,r,i;const o=[n[0]];let s={$$slots:{default:[$an]},$$scope:{ctx:n}};for(let a=0;a<o.length;a+=1)s=KV(s,o[a]);return t=new n[2]({props:s}),{c(){e=Ne("div"),Bo(t.$$.fragment)},l(a){e=Fe(a,"DIV",{});var c=tt(e);Ho(t.$$.fragment,c),c.forEach(Ee)},m(a,c){Ft(a,e,c),Uo(t,e,null),i=!0},p(a,[c]){const l=c&1?aW(o,[cW(a[0])]):{};c&1048576&&(l.$$scope={dirty:c,ctx:a}),t.$set(l)},i(a){i||(cn(t.$$.fragment,a),a&&ov(()=>{i&&(r||(r=yy(e,w2,{},!0)),r.run(1))}),i=!0)},o(a){Sn(t.$$.fragment,a),a&&(r||(r=yy(e,w2,{},!1)),r.run(0)),i=!1},d(a){a&&Ee(e),zo(t),a&&r&&r.end()}}}function Nan(n,e,t){let{workspace:r}=e,{tokenPromise:i}=e;const o={authEndpoint:I=>i.then(T=>({token:T}))},s=r.public;let a,c;const l=Pan(s),{codeEditors:u,whiteboardEditors:d}=l,h=I=>{var T;u.dropAttachmentState(I),(T=u.getAttachmentIndicator(I,!1))==null||T.setIsCustom(!1)},f=async I=>{const T=await Aan(l),D=new Map(T.filter(({type:B})=>B==="code").map(({cacheIdentifier:B,id:U})=>[B,U])),O=new Map(T.filter(({type:B})=>B==="whiteboard").map(({cacheIdentifier:B,id:U})=>[B,U])),M=await Tan(u,D),R=await gGe("chatDefault","body",{query:I.query.getMessage(),response_json_schema:I.responseMode==="multichoice"?yL.schema:void 0,workspace_id:s,codes:M,whiteboards:d.getItems().filter(({indicator:B})=>B==null?void 0:B.getIncluded()).map(({cacheIdentifier:B,state:U})=>({whiteboard_id:O.get(B),crop:U??null}))},"/chat/");let A,k,L=null,j=null;I.setCancelCallback(()=>{k&&Ra("chatCancel","body",{workspace_id:s,chat_message_id:k})});async function N(){try{const B=await R.read();if(B.done)return L;let U=new TextDecoder().decode(B.value);switch(A||([U,A]=qV(U,"request_id"),A&&I.query.setID(A)),k||([U,k]=qV(U,"response_id"),k&&I.response.setID(k)),I.responseMode){case"message":L??(L=""),L+=U,I.response.setMessage(L),I.scrollDown();break;case"multichoice":j??(j=new RHe({target:I.response.getChildTarget()})),j.ready(!0);const z=yL.parse(U).at(-1);z&&j.set(z.question,z.options),I.scrollDown();break}return N()}catch(B){if(B instanceof Error)throw B;return`Error: ${XV(B)}`}}await N(),I.finish()},p={name:"AI Chat",enableClose:!1,helpText:"Ask questions to your AI Tutor",onCreate:I=>{c=I,I.$on(hIe,({detail:T})=>f(T)),Man(s,I)}},g=async(I,T,D,O,M,R)=>{var L;h(T);const{runCode:A}=await nq,k=Yot(a);a.append(est()+" (user)","divider");try{const j=D.getCacheIdentifier(T);await A(M,k);const N="-"+k.result.map(({line:B})=>B.trim()).join(`
-`);(L=D.getAttachmentIndicator(T,!1))==null||L.incrementRunCount(),O.store(j,M,R,N,Ra("artifactsExecution","body",{code:M,readout:N,shared:I,workspace_id:s}))}catch(j){console.error(j),a.append(`INTERNAL PYTUTOR ERROR: ${xIe(XV(j))}`,"error")}},m=(I,T,D,O)=>{const M=()=>{u.hasAttachmentState(I)||u.setAttachmentState(I,Oan(I,u,D)),ey({Component:ean,props:{codeExecutionCache:D,current:{code:T,identifier:u.getCacheIdentifier(I),node:THe(u.getInternal(I))},state:u.getAttachmentState(I)},onClose:A=>{u.getAttachmentIndicator(I).setIsCustom(!0)}})},R=O?Iw(I):void 0;return new jsn({target:c.getContextContainer(),props:{iconSrc:R,onClick:M}})},v=(I,T,D=!0)=>{u.setIsShared(I,T);const O=CT.Get(I);return{roomID:T?r.public:r.private,runCode:g.bind(null,T,I,u,O),terminateRunningCode:EIe,setEditor:M=>u.setInternal(I,M),onContentUpdate:(M,R)=>{u.incrementVersion(I),h(I),M?u.getOrCreateAttachmentIndicator(I,m.bind(null,I,R,O,D)).setRunCount(0):u.deleteAttachmentIndicator(I)},identifier:I}},b=(I,T)=>new Msn({target:c.getContextContainer(),props:{label:"Whiteboard",iconSrc:T?Iw(I):void 0,onClick:()=>ey({Component:ban,props:{getBlob:()=>iBe(d.getInternal(I))},onClose:D=>d.setAttachmentState(I,D.getCrop())})}}),S=(I,T,D=!0)=>(d.setIsShared(I,T),{identifier:I,roomID:T?r.public:r.private,setEditor:O=>d.setInternal(I,O),contentUpdate:O=>{d.dropAttachmentState(I),O?d.getOrCreateAttachmentIndicator(I,b.bind(null,I,D)):d.deleteAttachmentIndicator(I)}}),E={shared:({panel:I,split:T,tabs:D})=>T(D(I("react",CV,{props:v("public",!0),name:"Code Editor",enableClose:!1,helpText:"Write your code here, which all collaborators can see",icon:Iw("public")}),I("react",CV,{props:v("private",!1),name:"Code Editor",enableClose:!1,helpText:"Write your code here, which only you can see",icon:Iw("private")})),T(D(I("react",wz,{name:"Whiteboard",enableClose:!1,props:S("public",!0),icon:Iw("public")}),I("react",wz,{name:"Whiteboard",enableClose:!1,props:S("private",!1),icon:Iw("private")})),I("svelte",ZW,{name:"Code Output",enableClose:!1,tabset:{height:250},props:{clearCallback:()=>{}},onCreate:O=>{a=O}})),T(T({weight:20},I("svelte",BIt,{name:"Audio Chat",enableClose:!1,props:{userEmail:"test",roomID:r.public}})),I("svelte",Iue,p))),solo:({panel:I,split:T,tabs:D})=>T(T(I("react",CV,{props:v("private",!1,!1),name:"Code Editor",enableClose:!1,helpText:"Write your code here"})),T(I("react",wz,{name:"Whiteboard",enableClose:!1,props:S("private",!1,!1)}),I("svelte",ZW,{name:"Code Output",enableClose:!1,tabset:{height:250},props:{clearCallback:()=>{}},onCreate:O=>{a=O}})),T(I("svelte",Iue,p)))},w=kGe(r.shared?E.shared:E.solo,{rootOrientationVertical:!1}),C=lW(vZe,Wu.createPortal,dW,uW);return n.$$set=I=>{"workspace"in I&&t(3,r=I.workspace),"tokenPromise"in I&&t(4,i=I.tokenPromise)},[o,w,C,r,i]}class Fan extends fo{constructor(e){super(),po(this,e,Nan,Lan,Hi,{workspace:3,tokenPromise:4})}}function jan(n){let e,t,r="You don't have any workspaces!!",i,o,s=`After closing this panel, please select a course event on the left, and
        then create a workspace tied to that event where you can code and talk
        with your AI tutor.`,a,c,l,u="Close",d,h;return{c(){e=Ne("div"),t=Ne("h2"),t.textContent=r,i=Kt(),o=Ne("p"),o.textContent=s,a=Kt(),c=Ne("center"),l=Ne("button"),l.textContent=u,this.h()},l(f){e=Fe(f,"DIV",{class:!0});var p=tt(e);t=Fe(p,"H2",{class:!0,"data-svelte-h":!0}),Fr(t)!=="svelte-1iqvzp3"&&(t.textContent=r),i=Gt(p),o=Fe(p,"P",{"data-svelte-h":!0}),Fr(o)!=="svelte-8ya2vd"&&(o.textContent=s),a=Gt(p),c=Fe(p,"CENTER",{});var g=tt(c);l=Fe(g,"BUTTON",{class:!0,"data-svelte-h":!0}),Fr(l)!=="svelte-r7olz3"&&(l.textContent=u),g.forEach(Ee),p.forEach(Ee),this.h()},h(){Re(t,"class","card-title"),Re(l,"class","btn btn-primary w-full rounded-md"),Re(e,"class","card-body h-full w-full")},m(f,p){Ft(f,e,p),we(e,t),we(e,i),we(e,o),we(e,a),we(e,c),we(c,l),d||(h=_r(l,"click",i7),d=!0)},p:Dt,i:Dt,o:Dt,d(f){f&&Ee(e),d=!1,h()}}}class Ban extends fo{constructor(e){super(),po(this,e,null,jan,Hi,{})}}function Han(n){let e;return{c(){e=Jr(`Send the below URL to your friends to have them join you in your
            workspace.`)},l(t){e=Qr(t,`Send the below URL to your friends to have them join you in your
            workspace.`)},m(t,r){Ft(t,e,r)},d(t){t&&Ee(e)}}}function Uan(n){let e,t,r=`NOTE: You will not be able to share your workspace with fellow
                students.`;return{c(){e=Jr(`Send the below URL to your course instructors to have them join you
            in your workspace.

            `),t=Ne("strong"),t.textContent=r},l(i){e=Qr(i,`Send the below URL to your course instructors to have them join you
            in your workspace.

            `),t=Fe(i,"STRONG",{"data-svelte-h":!0}),Fr(t)!=="svelte-z5nxpm"&&(t.textContent=r)},m(i,o){Ft(i,e,o),Ft(i,t,o)},d(i){i&&(Ee(e),Ee(t))}}}function zan(n){let e,t,r,i=n[1]?"":" course instructors",o,s,a,c,l,u,d,h,f="Label",p,g,m,v,b,S='<svg class="w-3 h-3 me-1.5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 18 20"><path d="M16 1h-3.278A1.992 1.992 0 0 0 11 0H7a1.993 1.993 0 0 0-1.722 1H2a2 2 0 0 0-2 2v15a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2Zm-3 14H5a1 1 0 0 1 0-2h8a1 1 0 0 1 0 2Zm0-4H5a1 1 0 0 1 0-2h8a1 1 0 1 1 0 2Zm0-5H5a1 1 0 0 1 0-2h2V2h4v2h2a1 1 0 1 1 0 2Z"></path></svg> <span class="text-xs font-semibold">Copy</span>',E,w,C='<svg class="w-3 h-3 text-blue-700 dark:text-blue-500 me-1.5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 12"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M1 5.917 5.724 10.5 15 1.5"></path></svg> <span class="text-xs font-semibold text-blue-700 dark:text-blue-500">Copied</span>',I,T;function D(R,A){return R[1]?Han:Uan}let O=D(n),M=O(n);return{c(){e=Ne("div"),t=Ne("h2"),r=Jr("Share your workspace"),o=Jr(i),s=Jr("!"),a=Kt(),c=Ne("p"),M.c(),l=Kt(),u=Ne("div"),d=Ne("div"),h=Ne("label"),h.textContent=f,p=Kt(),g=Ne("input"),m=Kt(),v=Ne("button"),b=Ne("span"),b.innerHTML=S,E=Kt(),w=Ne("span"),w.innerHTML=C,this.h()},l(R){e=Fe(R,"DIV",{class:!0});var A=tt(e);t=Fe(A,"H2",{class:!0});var k=tt(t);r=Qr(k,"Share your workspace"),o=Qr(k,i),s=Qr(k,"!"),k.forEach(Ee),a=Gt(A),c=Fe(A,"P",{});var L=tt(c);M.l(L),L.forEach(Ee),l=Gt(A),u=Fe(A,"DIV",{class:!0});var j=tt(u);d=Fe(j,"DIV",{class:!0});var N=tt(d);h=Fe(N,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),Fr(h)!=="svelte-1t6wybw"&&(h.textContent=f),p=Gt(N),g=Fe(N,"INPUT",{type:!0,class:!0}),m=Gt(N),v=Fe(N,"BUTTON",{class:!0});var B=tt(v);b=Fe(B,"SPAN",{class:!0,"data-svelte-h":!0}),Fr(b)!=="svelte-1da8313"&&(b.innerHTML=S),E=Gt(B),w=Fe(B,"SPAN",{class:!0,"data-svelte-h":!0}),Fr(w)!=="svelte-kjqyvc"&&(w.innerHTML=C),B.forEach(Ee),N.forEach(Ee),j.forEach(Ee),A.forEach(Ee),this.h()},h(){Re(t,"class","card-title"),Re(h,"for","npm-install-copy-text"),Re(h,"class","sr-only"),Re(g,"type","text"),Re(g,"class","col-span-6 bg-gray-50 border border-gray-300 text-gray-500 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full px-2.5 py-4 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-gray-400 dark:focus:ring-blue-500 dark:focus:border-blue-500"),g.value=n[0],g.disabled=!0,g.readOnly=!0,Re(b,"class","inline-flex items-center"),Re(w,"class","hidden inline-flex items-center"),Re(v,"class","absolute end-2.5 top-1/2 -translate-y-1/2 text-gray-900 dark:text-gray-400 hover:bg-gray-100 dark:bg-gray-800 dark:border-gray-600 dark:hover:bg-gray-700 rounded-lg py-2 px-2.5 inline-flex items-center justify-center bg-white border-gray-200 border"),Re(d,"class","relative"),Re(u,"class","w-full mx-auto"),Re(e,"class","w-full h-full flex flex-col align-middle items-center")},m(R,A){Ft(R,e,A),we(e,t),we(t,r),we(t,o),we(t,s),we(e,a),we(e,c),M.m(c,null),we(e,l),we(e,u),we(u,d),we(d,h),we(d,p),we(d,g),we(d,m),we(d,v),we(v,b),n[5](b),we(v,E),we(v,w),n[6](w),I||(T=_r(v,"click",n[4]),I=!0)},p(R,[A]){A&2&&i!==(i=R[1]?"":" course instructors")&&yl(o,i),O!==(O=D(R))&&(M.d(1),M=O(R),M&&(M.c(),M.m(c,null))),A&1&&g.value!==R[0]&&(g.value=R[0])},i:Dt,o:Dt,d(R){R&&Ee(e),M.d(),n[5](null),n[6](null),I=!1,T()}}}function Van(n,e,t){let{url:r}=e,{peer2peer:i}=e,o,s;const a=()=>{navigator.clipboard.writeText(r),c(),setTimeout(()=>{l()},2e3)},c=()=>{o.classList.add("hidden"),s.classList.remove("hidden")},l=()=>{o.classList.remove("hidden"),s.classList.add("hidden")};function u(h){na[h?"unshift":"push"](()=>{o=h,t(2,o)})}function d(h){na[h?"unshift":"push"](()=>{s=h,t(3,s)})}return n.$$set=h=>{"url"in h&&t(0,r=h.url),"peer2peer"in h&&t(1,i=h.peer2peer)},[r,i,o,s,a,u,d]}class Wan extends fo{constructor(e){super(),po(this,e,Van,zan,Hi,{url:0,peer2peer:1})}}function qan(n){let e,t,r="Unable to subscribe to workspace!",i,o,s=`Are you a student? If so, it&#39;s possible your classmate is sharing a
        workspace tied to a course event that is <string>NOT</string> allowed to
        be shared peer-to-peer.`,a,c,l,u="Close",d,h;return{c(){e=Ne("div"),t=Ne("h2"),t.textContent=r,i=Kt(),o=Ne("p"),o.innerHTML=s,a=Kt(),c=Ne("center"),l=Ne("button"),l.textContent=u,this.h()},l(f){e=Fe(f,"DIV",{class:!0});var p=tt(e);t=Fe(p,"H2",{class:!0,"data-svelte-h":!0}),Fr(t)!=="svelte-yrrqqh"&&(t.textContent=r),i=Gt(p),o=Fe(p,"P",{"data-svelte-h":!0}),Fr(o)!=="svelte-15cc7fj"&&(o.innerHTML=s),a=Gt(p),c=Fe(p,"CENTER",{});var g=tt(c);l=Fe(g,"BUTTON",{class:!0,"data-svelte-h":!0}),Fr(l)!=="svelte-r7olz3"&&(l.textContent=u),g.forEach(Ee),p.forEach(Ee),this.h()},h(){Re(t,"class","card-title"),Re(l,"class","btn btn-primary w-full rounded-md"),Re(e,"class","card-body h-full w-full")},m(f,p){Ft(f,e,p),we(e,t),we(e,i),we(e,o),we(e,a),we(e,c),we(c,l),d||(h=_r(l,"click",i7),d=!0)},p:Dt,i:Dt,o:Dt,d(f){f&&Ee(e),d=!1,h()}}}class Kan extends fo{constructor(e){super(),po(this,e,null,qan,Hi,{})}}function f2e(n){let e,t,r={ctx:n,current:null,token:null,hasCatch:!1,pending:Jan,then:Zan,catch:Gan,value:18};return sv(t=n[1],r),{c(){e=Ji(),r.block.c()},l(i){e=Ji(),r.block.l(i)},m(i,o){Ft(i,e,o),r.block.m(i,r.anchor=o),r.mount=()=>e.parentNode,r.anchor=e},p(i,o){n=i,r.ctx=n,o&2&&t!==(t=n[1])&&sv(t,r)||qx(r,n,o)},d(i){i&&Ee(e),r.block.d(i),r.token=null,r=null}}}function Gan(n){return{c:Dt,l:Dt,m:Dt,p:Dt,d:Dt}}function Zan(n){let e;function t(o,s){return o[18]?Yan:Xan}let r=t(n),i=r(n);return{c(){i.c(),e=Ji()},l(o){i.l(o),e=Ji()},m(o,s){i.m(o,s),Ft(o,e,s)},p(o,s){r===(r=t(o))&&i?i.p(o,s):(i.d(1),i=r(o),i&&(i.c(),i.m(e.parentNode,e)))},d(o){o&&Ee(e),i.d(o)}}}function Xan(n){let e,t='<center><span class="text-lg font-bold m-0 p-0">Uh oh! Unable to load workspace.</span></center>',r,i,o="Please try a different one or create a new one.";return{c(){e=Ne("div"),e.innerHTML=t,r=Kt(),i=Ne("div"),i.textContent=o,this.h()},l(s){e=Fe(s,"DIV",{class:!0,"data-svelte-h":!0}),Fr(e)!=="svelte-1esn267"&&(e.innerHTML=t),r=Gt(s),i=Fe(s,"DIV",{class:!0,"data-svelte-h":!0}),Fr(i)!=="svelte-wptal1"&&(i.textContent=o),this.h()},h(){Re(e,"class","h-1/2 align-top top-0"),Re(i,"class","h-1/2 text-sm m-19")},m(s,a){Ft(s,e,a),Ft(s,r,a),Ft(s,i,a)},p:Dt,d(s){s&&(Ee(e),Ee(r),Ee(i))}}}function Yan(n){let e,t,r,i=(n[18].is_owner?n[18].name:`peer's "${n[18].name}"`)+"",o,s,a,c;return{c(){e=Ne("div"),t=Ne("center"),r=Ne("span"),o=Jr(i),s=Kt(),a=Ne("div"),c=Jr(n[3]),this.h()},l(l){e=Fe(l,"DIV",{class:!0});var u=tt(e);t=Fe(u,"CENTER",{});var d=tt(t);r=Fe(d,"SPAN",{class:!0});var h=tt(r);o=Qr(h,i),h.forEach(Ee),d.forEach(Ee),u.forEach(Ee),s=Gt(l),a=Fe(l,"DIV",{class:!0});var f=tt(a);c=Qr(f,n[3]),f.forEach(Ee),this.h()},h(){Re(r,"class","text-lg font-bold m-0 p-0"),Re(e,"class","h-1/2 align-top top-0"),Re(a,"class","h-1/2 text-sm")},m(l,u){Ft(l,e,u),we(e,t),we(t,r),we(r,o),Ft(l,s,u),Ft(l,a,u),we(a,c)},p(l,u){u&2&&i!==(i=(l[18].is_owner?l[18].name:`peer's "${l[18].name}"`)+"")&&yl(o,i),u&8&&yl(c,l[3])},d(l){l&&(Ee(e),Ee(s),Ee(a))}}}function Jan(n){return{c:Dt,l:Dt,m:Dt,p:Dt,d:Dt}}function p2e(n){let e,t,r={ctx:n,current:null,token:null,hasCatch:!1,pending:rcn,then:ecn,catch:Qan,value:18};return sv(t=n[1],r),{c(){e=Ji(),r.block.c()},l(i){e=Ji(),r.block.l(i)},m(i,o){Ft(i,e,o),r.block.m(i,r.anchor=o),r.mount=()=>e.parentNode,r.anchor=e},p(i,o){n=i,r.ctx=n,o&2&&t!==(t=n[1])&&sv(t,r)||qx(r,n,o)},d(i){i&&Ee(e),r.block.d(i),r.token=null,r=null}}}function Qan(n){return{c:Dt,l:Dt,m:Dt,p:Dt,d:Dt}}function ecn(n){let e,t=n[18]&&g2e(n);return{c(){t&&t.c(),e=Ji()},l(r){t&&t.l(r),e=Ji()},m(r,i){t&&t.m(r,i),Ft(r,e,i)},p(r,i){r[18]?t?t.p(r,i):(t=g2e(r),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(r){r&&Ee(e),t&&t.d(r)}}}function g2e(n){let e;function t(o,s){return o[18].shared?ncn:tcn}let r=t(n),i=r(n);return{c(){i.c(),e=Ji()},l(o){i.l(o),e=Ji()},m(o,s){i.m(o,s),Ft(o,e,s)},p(o,s){r===(r=t(o))&&i?i.p(o,s):(i.d(1),i=r(o),i&&(i.c(),i.m(e.parentNode,e)))},d(o){o&&Ee(e),i.d(o)}}}function tcn(n){let e,t="Share Workspace",r,i;function o(){return n[13](n[18])}return{c(){e=Ne("button"),e.textContent=t,this.h()},l(s){e=Fe(s,"BUTTON",{class:!0,"data-svelte-h":!0}),Fr(e)!=="svelte-ljzk85"&&(e.textContent=t),this.h()},h(){Re(e,"class","btn btn-sm px-2 py-0 mr-2 float-right text-white border-none"),Fn(e,"background-color",tS.feedback.success)},m(s,a){Ft(s,e,a),r||(i=_r(e,"click",o),r=!0)},p(s,a){n=s},d(s){s&&Ee(e),r=!1,i()}}}function ncn(n){let e,t="Get Shareable Link",r,i;function o(){return n[12](n[18])}return{c(){e=Ne("button"),e.textContent=t,this.h()},l(s){e=Fe(s,"BUTTON",{class:!0,"data-svelte-h":!0}),Fr(e)!=="svelte-yv8qka"&&(e.textContent=t),this.h()},h(){Re(e,"class","btn btn-sm px-2 py-0 mr-2 float-right text-white border-none"),Fn(e,"background-color",tS.accent.blue)},m(s,a){Ft(s,e,a),r||(i=_r(e,"click",o),r=!0)},p(s,a){n=s},d(s){s&&Ee(e),r=!1,i()}}}function rcn(n){return{c:Dt,l:Dt,m:Dt,p:Dt,d:Dt}}function icn(n){return{c:Dt,l:Dt,m:Dt,p:Dt,i:Dt,o:Dt,d:Dt}}function ocn(n){let e,t,r=n[19]&&scn(n);return{c(){r&&r.c(),e=Ji()},l(i){r&&r.l(i),e=Ji()},m(i,o){r&&r.m(i,o),Ft(i,e,o),t=!0},p(i,o){i[19]&&r.p(i,o)},i(i){t||(cn(r),t=!0)},o(i){Sn(r),t=!1},d(i){i&&Ee(e),r&&r.d(i)}}}function scn(n){let e,t,r={closedText:"Workspaces",addText:"Add Workspace",items:n[19],onSelectSubItem:n[14],addSubItem:n[7],getSubItems:AHe};return e=new dZe({props:r}),n[15](e),{c(){Bo(e.$$.fragment)},l(i){Ho(e.$$.fragment,i)},m(i,o){Uo(e,i,o),t=!0},p(i,o){const s={};e.$set(s)},i(i){t||(cn(e.$$.fragment,i),t=!0)},o(i){Sn(e.$$.fragment,i),t=!1},d(i){n[15](null),zo(e,i)}}}function acn(n){return{c:Dt,l:Dt,m:Dt,p:Dt,i:Dt,o:Dt,d:Dt}}function ccn(n){let e;return{c(){e=Ne("span"),this.h()},l(t){e=Fe(t,"SPAN",{class:!0}),tt(e).forEach(Ee),this.h()},h(){Re(e,"class","loading loading-spinner loading-lg")},m(t,r){Ft(t,e,r)},p:Dt,i:Dt,o:Dt,d(t){t&&Ee(e)}}}function lcn(n){let e,t,r,i={ctx:n,current:null,token:null,hasCatch:!1,pending:hcn,then:dcn,catch:ucn,value:18,blocks:[,,,]};return sv(t=n[1],i),{c(){e=Ji(),i.block.c()},l(o){e=Ji(),i.block.l(o)},m(o,s){Ft(o,e,s),i.block.m(o,i.anchor=s),i.mount=()=>e.parentNode,i.anchor=e,r=!0},p(o,s){n=o,i.ctx=n,s&2&&t!==(t=n[1])&&sv(t,i)||qx(i,n,s)},i(o){r||(cn(i.block),r=!0)},o(o){for(let s=0;s<3;s+=1){const a=i.blocks[s];Sn(a)}r=!1},d(o){o&&Ee(e),i.block.d(o),i.token=null,i=null}}}function ucn(n){return{c:Dt,l:Dt,m:Dt,p:Dt,i:Dt,o:Dt,d:Dt}}function dcn(n){let e,t,r=n[18]&&m2e(n);return{c(){r&&r.c(),e=Ji()},l(i){r&&r.l(i),e=Ji()},m(i,o){r&&r.m(i,o),Ft(i,e,o),t=!0},p(i,o){i[18]?r?(r.p(i,o),o&2&&cn(r,1)):(r=m2e(i),r.c(),cn(r,1),r.m(e.parentNode,e)):r&&(ja(),Sn(r,1,1,()=>{r=null}),Ba())},i(i){t||(cn(r),t=!0)},o(i){Sn(r),t=!1},d(i){i&&Ee(e),r&&r.d(i)}}}function m2e(n){let e,t;return e=new Fan({props:{workspace:n[18],tokenPromise:n[2]}}),{c(){Bo(e.$$.fragment)},l(r){Ho(e.$$.fragment,r)},m(r,i){Uo(e,r,i),t=!0},p(r,i){const o={};i&2&&(o.workspace=r[18]),i&4&&(o.tokenPromise=r[2]),e.$set(o)},i(r){t||(cn(e.$$.fragment,r),t=!0)},o(r){Sn(e.$$.fragment,r),t=!1},d(r){zo(e,r)}}}function hcn(n){let e,t='<span class="loading loading-dots w-1/2"></span>',r,i;return{c(){e=Ne("center"),e.innerHTML=t},l(o){e=Fe(o,"CENTER",{"data-svelte-h":!0}),Fr(e)!=="svelte-ina4lf"&&(e.innerHTML=t)},m(o,s){Ft(o,e,s),i=!0},p:Dt,i(o){i||(o&&ov(()=>{i&&(r||(r=yy(e,w2,{delay:.5},!0)),r.run(1))}),i=!0)},o(o){o&&(r||(r=yy(e,w2,{delay:.5},!1)),r.run(0)),i=!1},d(o){o&&Ee(e),o&&r&&r.end()}}}function fcn(n){let e,t,r,i,o="Logout",s,a,c="Feedback",l,u,d,h="PyTutor",f,p,g,m,v,b,S,E,w,C,I,T,D,O,M,R,A,k,L,j,N,B,U=n[1]&&f2e(n),K=n[1]&&p2e(n),z={ctx:n,current:null,token:null,hasCatch:!1,pending:acn,then:ocn,catch:icn,value:19,blocks:[,,,]};sv(n[5],z);const G=[lcn,ccn],te=[];function ie(Q,ge){return Q[1]?0:1}return T=ie(n),D=te[T]=G[T](n),L=new ott({}),{c(){e=Ne("div"),t=Ne("div"),r=Ne("div"),i=Ne("button"),i.textContent=o,s=Kt(),a=Ne("a"),a.textContent=c,l=Kt(),u=Ne("span"),d=Ne("button"),d.textContent=h,f=Kt(),p=Ne("div"),U&&U.c(),g=Kt(),m=Ne("div"),K&&K.c(),v=Kt(),b=Ne("div"),S=Ne("div"),z.block.c(),E=Kt(),w=Ne("div"),C=Kt(),I=Ne("div"),D.c(),O=Kt(),M=Ne("div"),R=Kt(),A=Ne("div"),k=Kt(),Bo(L.$$.fragment),this.h()},l(Q){e=Fe(Q,"DIV",{class:!0});var ge=tt(e);t=Fe(ge,"DIV",{class:!0});var _e=tt(t);r=Fe(_e,"DIV",{class:!0});var Se=tt(r);i=Fe(Se,"BUTTON",{class:!0,"data-svelte-h":!0}),Fr(i)!=="svelte-10s3ms2"&&(i.textContent=o),s=Gt(Se),a=Fe(Se,"A",{class:!0,href:!0,target:!0,"data-svelte-h":!0}),Fr(a)!=="svelte-1e49m75"&&(a.textContent=c),l=Gt(Se),u=Fe(Se,"SPAN",{class:!0});var se=tt(u);d=Fe(se,"BUTTON",{"data-svelte-h":!0}),Fr(d)!=="svelte-vj99sv"&&(d.textContent=h),se.forEach(Ee),Se.forEach(Ee),f=Gt(_e),p=Fe(_e,"DIV",{class:!0});var ee=tt(p);U&&U.l(ee),ee.forEach(Ee),g=Gt(_e),m=Fe(_e,"DIV",{class:!0});var Y=tt(m);K&&K.l(Y),Y.forEach(Ee),_e.forEach(Ee),v=Gt(ge),b=Fe(ge,"DIV",{class:!0});var ue=tt(b);S=Fe(ue,"DIV",{});var ye=tt(S);z.block.l(ye),ye.forEach(Ee),E=Gt(ue),w=Fe(ue,"DIV",{class:!0}),tt(w).forEach(Ee),C=Gt(ue),I=Fe(ue,"DIV",{class:!0});var V=tt(I);D.l(V),V.forEach(Ee),O=Gt(ue),M=Fe(ue,"DIV",{class:!0}),tt(M).forEach(Ee),ue.forEach(Ee),R=Gt(ge),A=Fe(ge,"DIV",{}),tt(A).forEach(Ee),ge.forEach(Ee),k=Gt(Q),Ho(L.$$.fragment,Q),this.h()},h(){Re(i,"class","align-middle justify-start btn btn-sm px-1 py-0 ml-2 text-white border-none"),Fn(i,"background-color",tS.accent.pink),Re(a,"class","align-middle justify-start btn btn-sm px-1 py-0 ml-1 text-white border-none"),Re(a,"href","https://forms.gle/Lguptte8WiehMFyUA"),Re(a,"target","_blank"),Fn(a,"background-color",tS.primary.dark),Re(u,"class","mx-1 font-bold align-middle justify-start"),Re(r,"class","w-1/3"),Re(p,"class","w-1/3 h-full flex flex-col align-baseline text-center"),Re(m,"class","w-1/3"),Re(t,"class","items-center justify-items-center flex"),Fn(t,"height",b2e),Re(w,"class","w-1"),Re(I,"class","relative flex-grow h-full"),Re(M,"class","w-1"),Re(b,"class","flex-grow flex flex-row"),Fn(b,"position","relative"),Fn(b,"max-height",`calc(100vh - ${b2e} - ${S2e})`),Fn(A,"height",S2e),Re(e,"class","flex flex-col w-screen h-screen overflow-hidden bg-neutral-light")},m(Q,ge){Ft(Q,e,ge),we(e,t),we(t,r),we(r,i),we(r,s),we(r,a),we(r,l),we(r,u),we(u,d),we(t,f),we(t,p),U&&U.m(p,null),we(t,g),we(t,m),K&&K.m(m,null),we(e,v),we(e,b),we(b,S),z.block.m(S,z.anchor=null),z.mount=()=>S,z.anchor=null,we(b,E),we(b,w),we(b,C),we(b,I),te[T].m(I,null),we(b,O),we(b,M),we(e,R),we(e,A),Ft(Q,k,ge),Uo(L,Q,ge),j=!0,N||(B=[_r(i,"click",n[10]),_r(d,"click",n[11])],N=!0)},p(Q,[ge]){n=Q,n[1]?U?U.p(n,ge):(U=f2e(n),U.c(),U.m(p,null)):U&&(U.d(1),U=null),n[1]?K?K.p(n,ge):(K=p2e(n),K.c(),K.m(m,null)):K&&(K.d(1),K=null),qx(z,n,ge);let _e=T;T=ie(n),T===_e?te[T].p(n,ge):(ja(),Sn(te[_e],1,1,()=>{te[_e]=null}),Ba(),D=te[T],D?D.p(n,ge):(D=te[T]=G[T](n),D.c()),cn(D,1),D.m(I,null))},i(Q){j||(cn(z.block),cn(D),cn(L.$$.fragment,Q),j=!0)},o(Q){for(let ge=0;ge<3;ge+=1){const _e=z.blocks[ge];Sn(_e)}Sn(D),Sn(L.$$.fragment,Q),j=!1},d(Q){Q&&(Ee(e),Ee(k)),U&&U.d(),K&&K.d(),z.block.d(),z.token=null,z=null,te[T].d(),zo(L,Q),N=!1,qh(B)}}}const Pc={workspace:new Map,workspacesForEvent:new Map,eventByID:new Map},v2e=n=>Pc.workspace.has(n)?Promise.resolve(Pc.workspace.get(n)):Ra("workspaceGet","query",{workspaceId:n}).then(e=>(Pc.workspace.set(n,e),e)).catch(e=>(console.error("Workspace error:",e),NM.workspace=null,null)),AHe=async n=>{if(Pc.workspacesForEvent.has(n))return Pc.workspacesForEvent.get(n);const{workspaces:e}=await Ra("workspacesForEvent","query",{eventId:n});return Pc.workspacesForEvent.set(n,e),e},y2e=n=>{for(const[e,t]of Pc.workspacesForEvent.entries())for(const{id:r}of t)if(r===n)return e},b2e="3rem",S2e="4px";function pcn(n,e,t){let{data:r}=e;const{workspace:i}=r;let o,s=null,a;const c=Ra("userInfo");let l;const u=Ra("courseEventsAll").then(E=>{const{course_events_by_course:w}=E,C=0;for(const T in w)for(const D of w[T])Pc.eventByID.set(D.id,D);const I=Object.values(w)[C].sort((T,D)=>T.name.localeCompare(D.name));if(!i){const D=I[0];AHe(D.id).then(O=>{O.length===0?(t(1,s=null),o==null||o.open(),o.setFirstActive(),ey({Component:Ban})):s||d(O[0].id,D.id)})}return I}),d=async(E,w)=>{t(2,a=new Promise(async C=>{s&&await s,t(1,s=v2e(E));const I=await s;if(!I)return;NM.workspace=E,w??(w=await u.then(D=>y2e(E))),w??(w=await Ra("workspaceParent","query",{workspaceId:E}).then(D=>D.id)),w&&(o==null||o.setActive(w,E),t(3,l=Pc.eventByID.get(w).name));const{token:T}=await Ra("liveblocksToken","query",{rooms:I.shared?[I.private,I.public]:[I.private]});C(T)}))},h=async E=>{const w=prompt("What name do you want for your workspace?")??"",C=await Ra("workspaceCreate","body",{course_event_id:E,name:w}),I=C.public;Pc.workspace.set(I,C),Pc.workspacesForEvent.has(E)||Pc.workspacesForEvent.set(E,[]),Pc.workspacesForEvent.get(E).push({id:I,name:w,shared:!1}),o.setActive(E,I),o.open(!1),d(I,E)},f=async E=>{await Ra("workspaceShare","body",{workspace_id:E}),Pc.workspace.delete(E);const w=y2e(E);if(w&&Pc.workspacesForEvent.has(w)){const I=Pc.workspacesForEvent.get(w).find(T=>T.id===E);I&&(I.shared=!0)}d(E)};HT(async()=>{i&&(t(1,s=v2e(i).then(E=>E||Ra("workspaceSubscribe","body",{workspace_id:i}).then(w=>(Pc.workspace.set(i,w),w)).catch(w=>(ey({Component:Kan}),console.error("Workspace error",w),NM.workspace=null,null)))),await d(i))});const p=()=>Ra("authLogout").then(()=>{mGe(),Dle("/login")}),g=()=>c.then(({role:E})=>E==="admin"?Dle("/admin"):void 0),m=E=>{ey({Component:Wan,props:{url:window.location.href+"?workspace="+E.public,peer2peer:E.peer_to_peer}})},v=E=>f(E.public),b=(E,w)=>d(w,E);function S(E){na[E?"unshift":"push"](()=>{o=E,t(0,o)})}return n.$$set=E=>{"data"in E&&t(9,r=E.data)},[o,s,a,l,c,u,d,h,f,r,p,g,m,v,b,S]}class Yun extends fo{constructor(e){super(),po(this,e,pcn,fcn,Hi,{data:9})}}export{Yun as component,Pcn as universal};
//# sourceMappingURL=2.CtW3Pn-b.js.map

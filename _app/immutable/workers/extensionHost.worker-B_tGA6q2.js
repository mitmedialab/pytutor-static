var Fg=(r,e,t)=>{if(!e.has(r))throw TypeError("Cannot "+t)};var P=(r,e,t)=>(Fg(r,e,"read from private field"),t?t.call(r):e.get(r)),ue=(r,e,t)=>{if(e.has(r))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(r):e.set(r,t)},K=(r,e,t,i)=>(Fg(r,e,"write to private field"),i?i.call(r,t):e.set(r,t),t);var Rc=(r,e,t)=>(Fg(r,e,"access private method"),t);class Xn{constructor(e){this.executor=e,this._didRun=!1}get hasValue(){return this._didRun}get value(){if(!this._didRun)try{this._value=this.executor()}catch(e){this._error=e}finally{this._didRun=!0}if(this._error)throw this._error;return this._value}get rawValue(){return this._value}}let GS=class{constructor(){this.listeners=[],this.unexpectedErrorHandler=function(e){setTimeout(()=>{throw e.stack?jr.isErrorNoTelemetry(e)?new jr(e.message+`

`+e.stack):new Error(e.message+`

`+e.stack):e},0)}}addListener(e){return this.listeners.push(e),()=>{this._removeListener(e)}}emit(e){this.listeners.forEach(t=>{t(e)})}_removeListener(e){this.listeners.splice(this.listeners.indexOf(e),1)}setUnexpectedErrorHandler(e){this.unexpectedErrorHandler=e}getUnexpectedErrorHandler(){return this.unexpectedErrorHandler}onUnexpectedError(e){this.unexpectedErrorHandler(e),this.emit(e)}onUnexpectedExternalError(e){this.unexpectedErrorHandler(e)}};const dw=new GS;function wm(r){dw.setUnexpectedErrorHandler(r)}function nn(r){ho(r)||dw.onUnexpectedError(r)}function hw(r){ho(r)||dw.onUnexpectedExternalError(r)}function lh(r){if(r instanceof Error){const{name:e,message:t}=r,i=r.stacktrace||r.stack;return{$isError:!0,name:e,message:t,stack:i,noTelemetry:jr.isErrorNoTelemetry(r)}}return r}const uh="Canceled";function ho(r){return r instanceof is?!0:r instanceof Error&&r.name===uh&&r.message===uh}class is extends Error{constructor(){super(uh),this.name=this.message}}function m0(){const r=new Error(uh);return r.name=r.message,r}function Se(r){return r?new Error(`Illegal argument: ${r}`):new Error("Illegal argument")}function fw(r){return r?new Error(`Illegal state: ${r}`):new Error("Illegal state")}class Ss extends TypeError{constructor(e){super(e?`${e} is read-only and cannot be changed`:"Cannot change read-only property")}}class QS extends Error{constructor(e){super("NotImplemented"),e&&(this.message=e)}}class bm extends Error{constructor(e){super("NotSupported"),e&&(this.message=e)}}class jr extends Error{constructor(e){super(e),this.name="CodeExpectedError"}static fromError(e){if(e instanceof jr)return e;const t=new jr;return t.message=e.message,t.stack=e.stack,t}static isErrorNoTelemetry(e){return e.name==="CodeExpectedError"}}function qr(r,e,t=(i,n)=>i===n){if(r===e)return!0;if(!r||!e||r.length!==e.length)return!1;for(let i=0,n=r.length;i<n;i++)if(!t(r[i],e[i]))return!1;return!0}function JS(r,e){const t=[];let i;for(const n of r.slice(0).sort(e))!i||e(i[0],n)!==0?(i=[n],t.push(i)):i.push(n);return t}function cx(r,e,t){const i=[];function n(a,c,l){if(c===0&&l.length===0)return;const u=i[i.length-1];u&&u.start+u.deleteCount===a?(u.deleteCount+=c,u.toInsert.push(...l)):i.push({start:a,deleteCount:c,toInsert:l})}let s=0,o=0;for(;;){if(s===r.length){n(s,0,e.slice(o));break}if(o===e.length){n(s,r.length-s,[]);break}const a=r[s],c=e[o],l=t(a,c);l===0?(s+=1,o+=1):l<0?(n(s,1,[]),s+=1):l>0&&(n(s,0,[c]),o+=1)}return i}function KS(r,e,t){const i=cx(r,e,t),n=[],s=[];for(const o of i)n.push(...r.slice(o.start,o.start+o.deleteCount)),s.push(...o.toInsert);return{removed:n,added:s}}function ci(r){return r.filter(e=>!!e)}function XS(r){let e=0;for(let t=0;t<r.length;t++)r[t]&&(r[e]=r[t],e+=1);r.length=e}function pw(r){return!Array.isArray(r)||r.length===0}function Zu(r){return Array.isArray(r)&&r.length>0}function Wo(r,e=t=>t){const t=new Set;return r.filter(i=>{const n=e(i);return t.has(n)?!1:(t.add(n),!0)})}function dh(r){return[].concat(...r)}function v0(r,e){let t;t=Math.random;for(let i=r.length-1;i>0;i-=1){const n=Math.floor(t()*(i+1)),s=r[i];r[i]=r[n],r[n]=s}}function Pl(r,e){return Array.isArray(r)?r.map(e):e(r)}function $a(r){return Array.isArray(r)?r:[r]}var ym;(function(r){function e(s){return s<0}r.isLessThan=e;function t(s){return s<=0}r.isLessThanOrEqual=t;function i(s){return s>0}r.isGreaterThan=i;function n(s){return s===0}r.isNeitherLessOrGreaterThan=n,r.greaterThan=1,r.lessThan=-1,r.neitherLessOrGreaterThan=0})(ym||(ym={}));function ZS(r,e){return(t,i)=>e(r(t),r(i))}const YS=(r,e)=>r-e,Ko=class Ko{constructor(e){this.iterate=e}forEach(e){this.iterate(t=>(e(t),!0))}toArray(){const e=[];return this.iterate(t=>(e.push(t),!0)),e}filter(e){return new Ko(t=>this.iterate(i=>e(i)?t(i):!0))}map(e){return new Ko(t=>this.iterate(i=>t(e(i))))}some(e){let t=!1;return this.iterate(i=>(t=e(i),!t)),t}findFirst(e){let t;return this.iterate(i=>e(i)?(t=i,!1):!0),t}findLast(e){let t;return this.iterate(i=>(e(i)&&(t=i),!0)),t}findLastMaxBy(e){let t,i=!0;return this.iterate(n=>((i||ym.isGreaterThan(e(n,t)))&&(i=!1,t=n),!0)),t}};Ko.empty=new Ko(e=>{});let _0=Ko;function lx(r,e){const t=Object.create(null);for(const i of r){const n=e(i);let s=t[n];s||(s=t[n]=[]),s.push(i)}return t}function e4(r,e){const t=[],i=[];for(const n of r)e.has(n)||t.push(n);for(const n of e)r.has(n)||i.push(n);return{removed:t,added:i}}var w0,b0,y0;function t4(r,e,t){let i=r.get(e);return i===void 0&&(i=t,r.set(e,i)),i}class i4{constructor(e,t){this.uri=e,this.value=t}}function n4(r){return Array.isArray(r)}const _s=class _s{constructor(e,t){if(this[w0]="ResourceMap",e instanceof _s)this.map=new Map(e.map),this.toKey=t??_s.defaultToKey;else if(n4(e)){this.map=new Map,this.toKey=t??_s.defaultToKey;for(const[i,n]of e)this.set(i,n)}else this.map=new Map,this.toKey=e??_s.defaultToKey}set(e,t){return this.map.set(this.toKey(e),new i4(e,t)),this}get(e){var t;return(t=this.map.get(this.toKey(e)))==null?void 0:t.value}has(e){return this.map.has(this.toKey(e))}get size(){return this.map.size}clear(){this.map.clear()}delete(e){return this.map.delete(this.toKey(e))}forEach(e,t){typeof t<"u"&&(e=e.bind(t));for(const[i,n]of this.map)e(n.value,n.uri,this)}*values(){for(const e of this.map.values())yield e.value}*keys(){for(const e of this.map.values())yield e.uri}*entries(){for(const e of this.map.values())yield[e.uri,e.value]}*[(w0=Symbol.toStringTag,Symbol.iterator)](){for(const[,e]of this.map)yield[e.uri,e.value]}};_s.defaultToKey=e=>e.toString();let Pt=_s;class ux{constructor(e,t){this[b0]="ResourceSet",!e||typeof e=="function"?this._map=new Pt(e):(this._map=new Pt(t),e.forEach(this.add,this))}get size(){return this._map.size}add(e){return this._map.set(e,e),this}clear(){this._map.clear()}delete(e){return this._map.delete(e)}forEach(e,t){this._map.forEach((i,n)=>e.call(t,n,n,this))}has(e){return this._map.has(e)}entries(){return this._map.entries()}keys(){return this._map.keys()}values(){return this._map.keys()}[(b0=Symbol.toStringTag,Symbol.iterator)](){return this.keys()}}class r4{constructor(){this[y0]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){var e;return(e=this._head)==null?void 0:e.value}get last(){var e;return(e=this._tail)==null?void 0:e.value}has(e){return this._map.has(e)}get(e,t=0){const i=this._map.get(e);if(i)return t!==0&&this.touch(i,t),i.value}set(e,t,i=0){let n=this._map.get(e);if(n)n.value=t,i!==0&&this.touch(n,i);else{switch(n={key:e,value:t,next:void 0,previous:void 0},i){case 0:this.addItemLast(n);break;case 1:this.addItemFirst(n);break;case 2:this.addItemLast(n);break;default:this.addItemLast(n);break}this._map.set(e,n),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){const t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){const i=this._state;let n=this._head;for(;n;){if(t?e.bind(t)(n.value,n.key,this):e(n.value,n.key,this),this._state!==i)throw new Error("LinkedMap got modified during iteration.");n=n.next}}keys(){const e=this,t=this._state;let i=this._head;const n={[Symbol.iterator](){return n},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(i){const s={value:i.key,done:!1};return i=i.next,s}else return{value:void 0,done:!0}}};return n}values(){const e=this,t=this._state;let i=this._head;const n={[Symbol.iterator](){return n},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(i){const s={value:i.value,done:!1};return i=i.next,s}else return{value:void 0,done:!0}}};return n}entries(){const e=this,t=this._state;let i=this._head;const n={[Symbol.iterator](){return n},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(i){const s={value:[i.key,i.value],done:!1};return i=i.next,s}else return{value:void 0,done:!0}}};return n}[(y0=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._head,i=this.size;for(;t&&i>e;)this._map.delete(t.key),t=t.next,i--;this._head=t,this._size=i,t&&(t.previous=void 0),this._state++}trimNew(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._tail,i=this.size;for(;t&&i>e;)this._map.delete(t.key),t=t.previous,i--;this._tail=t,this._size=i,t&&(t.next=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{const t=e.next,i=e.previous;if(!t||!i)throw new Error("Invalid list");t.previous=i,i.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(t!==1&&t!==2)){if(t===1){if(e===this._head)return;const i=e.next,n=e.previous;e===this._tail?(n.next=void 0,this._tail=n):(i.previous=n,n.next=i),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===2){if(e===this._tail)return;const i=e.next,n=e.previous;e===this._head?(i.previous=void 0,this._head=i):(i.previous=n,n.next=i),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){const e=[];return this.forEach((t,i)=>{e.push([i,t])}),e}fromJSON(e){this.clear();for(const[t,i]of e)this.set(t,i)}}let s4=class extends r4{constructor(e,t=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,t=2){return super.get(e,t)}peek(e){return super.get(e,0)}set(e,t){return super.set(e,t,2),this}checkTrim(){this.size>this._limit&&this.trim(Math.round(this._limit*this._ratio))}};class gw extends s4{constructor(e,t=1){super(e,t)}trim(e){this.trimOld(e)}set(e,t){return super.set(e,t),this.checkTrim(),this}}class dx{constructor(){this.map=new Map}add(e,t){let i=this.map.get(e);i||(i=new Set,this.map.set(e,i)),i.add(t)}delete(e,t){const i=this.map.get(e);i&&(i.delete(t),i.size===0&&this.map.delete(e))}forEach(e,t){const i=this.map.get(e);i&&i.forEach(t)}get(e){const t=this.map.get(e);return t||new Set}}function mw(r,e){const t=this;let i=!1,n;return function(){return i||(i=!0,n=r.apply(t,arguments)),n}}var nr;(function(r){function e(E){return E&&typeof E=="object"&&typeof E[Symbol.iterator]=="function"}r.is=e;const t=Object.freeze([]);function i(){return t}r.empty=i;function*n(E){yield E}r.single=n;function s(E){return e(E)?E:n(E)}r.wrap=s;function o(E){return E||t}r.from=o;function*a(E){for(let N=E.length-1;N>=0;N--)yield E[N]}r.reverse=a;function c(E){return!E||E[Symbol.iterator]().next().done===!0}r.isEmpty=c;function l(E){return E[Symbol.iterator]().next().value}r.first=l;function u(E,N){for(const A of E)if(N(A))return!0;return!1}r.some=u;function d(E,N){for(const A of E)if(N(A))return A}r.find=d;function*f(E,N){for(const A of E)N(A)&&(yield A)}r.filter=f;function*m(E,N){let A=0;for(const j of E)yield N(j,A++)}r.map=m;function*b(...E){for(const N of E)yield*N}r.concat=b;function _(E,N,A){let j=A;for(const re of E)j=N(j,re);return j}r.reduce=_;function*v(E,N,A=E.length){for(N<0&&(N+=E.length),A<0?A+=E.length:A>E.length&&(A=E.length);N<A;N++)yield E[N]}r.slice=v;function k(E,N=Number.POSITIVE_INFINITY){const A=[];if(N===0)return[A,E];const j=E[Symbol.iterator]();for(let re=0;re<N;re++){const te=j.next();if(te.done)return[A,r.empty()];A.push(te.value)}return[A,{[Symbol.iterator](){return j}}]}r.consume=k;async function D(E){const N=[];for await(const A of E)N.push(A);return Promise.resolve(N)}r.asyncToArray=D})(nr||(nr={}));const wp=class wp{constructor(){this.livingDisposables=new Map}getDisposableData(e){let t=this.livingDisposables.get(e);return t||(t={parent:null,source:null,isSingleton:!1,value:e,idx:wp.idx++},this.livingDisposables.set(e,t)),t}trackDisposable(e){const t=this.getDisposableData(e);t.source||(t.source=new Error().stack)}setParent(e,t){const i=this.getDisposableData(e);i.parent=t}markAsDisposed(e){this.livingDisposables.delete(e)}markAsSingleton(e){this.getDisposableData(e).isSingleton=!0}getRootParent(e,t){const i=t.get(e);if(i)return i;const n=e.parent?this.getRootParent(this.getDisposableData(e.parent),t):e;return t.set(e,n),n}getTrackedDisposables(){const e=new Map;return[...this.livingDisposables.entries()].filter(([,i])=>i.source!==null&&!this.getRootParent(i,e).isSingleton).flatMap(([i])=>i)}computeLeakingDisposables(e=10,t){let i;if(t)i=t;else{const c=new Map,l=[...this.livingDisposables.values()].filter(d=>d.source!==null&&!this.getRootParent(d,c).isSingleton);if(l.length===0)return;const u=new Set(l.map(d=>d.value));if(i=l.filter(d=>!(d.parent&&u.has(d.parent))),i.length===0)throw new Error("There are cyclic diposable chains!")}if(!i)return;function n(c){function l(d,f){for(;d.length>0&&f.some(m=>typeof m=="string"?m===d[0]:d[0].match(m));)d.shift()}const u=c.source.split(`
`).map(d=>d.trim().replace("at ","")).filter(d=>d!=="");return l(u,["Error",/^trackDisposable \(.*\)$/,/^DisposableTracker.trackDisposable \(.*\)$/]),u.reverse()}const s=new dx;for(const c of i){const l=n(c);for(let u=0;u<=l.length;u++)s.add(l.slice(0,u).join(`
`),c)}i.sort(ZS(c=>c.idx,YS));let o="",a=0;for(const c of i.slice(0,e)){a++;const l=n(c),u=[];for(let d=0;d<l.length;d++){let f=l[d];f=`(shared with ${s.get(l.slice(0,d+1).join(`
`)).size}/${i.length} leaks) at ${f}`;const b=s.get(l.slice(0,d).join(`
`)),_=lx([...b].map(v=>n(v)[d]),v=>v);delete _[l[d]];for(const[v,k]of Object.entries(_))u.unshift(`    - stacktraces of ${k.length} other leaks continue with ${v}`);u.unshift(f)}o+=`


==================== Leaking disposable ${a}/${i.length}: ${c.value.constructor.name} ====================
${u.join(`
`)}
============================================================

`}return i.length>e&&(o+=`


... and ${i.length-e} more leaking disposables

`),{leaks:i,details:o}}};wp.idx=0;let x0=wp;function o4(r){return typeof r=="object"&&r!==null&&typeof r.dispose=="function"&&r.dispose.length===0}function Gr(r){if(nr.is(r)){const e=[];for(const t of r)if(t)try{t.dispose()}catch(i){e.push(i)}if(e.length===1)throw e[0];if(e.length>1)throw new AggregateError(e,"Encountered errors while disposing of store");return Array.isArray(r)?[]:r}else if(r)return r.dispose(),r}function hx(...r){return De(()=>Gr(r))}function De(r){return{dispose:mw(()=>{r()})}}const bp=class bp{constructor(){this._toDispose=new Set,this._isDisposed=!1}dispose(){this._isDisposed||(this._isDisposed=!0,this.clear())}get isDisposed(){return this._isDisposed}clear(){if(this._toDispose.size!==0)try{Gr(this._toDispose)}finally{this._toDispose.clear()}}add(e){if(!e)return e;if(e===this)throw new Error("Cannot register a disposable on itself!");return this._isDisposed?bp.DISABLE_DISPOSED_WARNING||console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this._toDispose.add(e),e}delete(e){if(e){if(e===this)throw new Error("Cannot dispose a disposable on itself!");this._toDispose.delete(e),e.dispose()}}deleteAndLeak(e){e&&this._toDispose.has(e)&&this._toDispose.delete(e)}};bp.DISABLE_DISPOSED_WARNING=!1;let Te=bp;var Lu;let Fe=(Lu=class{constructor(){this._store=new Te,this._store}dispose(){this._store.dispose()}_register(e){if(e===this)throw new Error("Cannot register a disposable on itself!");return this._store.add(e)}},Lu.None=Object.freeze({dispose(){}}),Lu);class zo{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(e){var t;this._isDisposed||e===this._value||((t=this._value)==null||t.dispose(),this._value=e)}clear(){this.value=void 0}dispose(){var e;this._isDisposed=!0,(e=this._value)==null||e.dispose(),this._value=void 0}clearAndLeak(){const e=this._value;return this._value=void 0,e}}class fx{constructor(){this._store=new Map,this._isDisposed=!1}dispose(){this._isDisposed=!0,this.clearAndDisposeAll()}clearAndDisposeAll(){if(this._store.size)try{Gr(this._store.values())}finally{this._store.clear()}}has(e){return this._store.has(e)}get size(){return this._store.size}get(e){return this._store.get(e)}set(e,t,i=!1){var n;this._isDisposed&&console.warn(new Error("Trying to add a disposable to a DisposableMap that has already been disposed of. The added object will be leaked!").stack),i||(n=this._store.get(e))==null||n.dispose(),this._store.set(e,t)}deleteAndDispose(e){var t;(t=this._store.get(e))==null||t.dispose(),this._store.delete(e)}keys(){return this._store.keys()}values(){return this._store.values()}[Symbol.iterator](){return this._store[Symbol.iterator]()}}function a4(r,e){return new Promise((t,i)=>{const n=[];c4(r,{onData:s=>{e&&n.push(s)},onError:s=>{e?i(s):t(void 0)},onEnd:()=>{t(e?e(n):void 0)}})})}function c4(r,e,t){r.on("error",i=>{e.onError(i)}),r.on("end",()=>{e.onEnd()}),r.on("data",i=>{e.onData(i)})}const xd=typeof Buffer<"u",l4=new Xn(()=>new Uint8Array(256));let Og,Hg;class _e{static alloc(e){return xd?new _e(Buffer.allocUnsafe(e)):new _e(new Uint8Array(e))}static wrap(e){return xd&&!Buffer.isBuffer(e)&&(e=Buffer.from(e.buffer,e.byteOffset,e.byteLength)),new _e(e)}static fromString(e,t){return!((t==null?void 0:t.dontUseNodeBuffer)||!1)&&xd?new _e(Buffer.from(e)):(Og||(Og=new TextEncoder),new _e(Og.encode(e)))}static fromByteArray(e){const t=_e.alloc(e.length);for(let i=0,n=e.length;i<n;i++)t.buffer[i]=e[i];return t}static concat(e,t){if(typeof t>"u"){t=0;for(let s=0,o=e.length;s<o;s++)t+=e[s].byteLength}const i=_e.alloc(t);let n=0;for(let s=0,o=e.length;s<o;s++){const a=e[s];i.set(a,n),n+=a.byteLength}return i}constructor(e){this.buffer=e,this.byteLength=this.buffer.byteLength}clone(){const e=_e.alloc(this.byteLength);return e.set(this),e}toString(){return xd?this.buffer.toString():(Hg||(Hg=new TextDecoder),Hg.decode(this.buffer))}slice(e,t){return new _e(this.buffer.subarray(e,t))}set(e,t){if(e instanceof _e)this.buffer.set(e.buffer,t);else if(e instanceof Uint8Array)this.buffer.set(e,t);else if(e instanceof ArrayBuffer)this.buffer.set(new Uint8Array(e),t);else if(ArrayBuffer.isView(e))this.buffer.set(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),t);else throw new Error("Unknown argument 'array'")}readUInt32BE(e){return Wd(this.buffer,e)}writeUInt32BE(e,t){zd(this.buffer,e,t)}readUInt32LE(e){return f4(this.buffer,e)}writeUInt32LE(e,t){p4(this.buffer,e,t)}readUInt8(e){return g4(this.buffer,e)}writeUInt8(e,t){m4(this.buffer,e,t)}indexOf(e,t=0){return u4(this.buffer,e instanceof _e?e.buffer:e,t)}}function u4(r,e,t=0){const i=e.byteLength,n=r.byteLength;if(i===0)return 0;if(i===1)return r.indexOf(e[0]);if(i>n-t)return-1;const s=l4.value;s.fill(e.length);for(let l=0;l<e.length;l++)s[e[l]]=e.length-l-1;let o=t+e.length-1,a=o,c=-1;for(;o<n;)if(r[o]===e[a]){if(a===0){c=o;break}o--,a--}else o+=Math.max(e.length-a,s[r[o]]),a=e.length-1;return c}function d4(r,e){return r[e+0]<<0>>>0|r[e+1]<<8>>>0}function h4(r,e,t){r[t+0]=e&255,e=e>>>8,r[t+1]=e&255}function Wd(r,e){return r[e]*2**24+r[e+1]*2**16+r[e+2]*2**8+r[e+3]}function zd(r,e,t){r[t+3]=e,e=e>>>8,r[t+2]=e,e=e>>>8,r[t+1]=e,e=e>>>8,r[t]=e}function f4(r,e){return r[e+0]<<0>>>0|r[e+1]<<8>>>0|r[e+2]<<16>>>0|r[e+3]<<24>>>0}function p4(r,e,t){r[t+0]=e&255,e=e>>>8,r[t+1]=e&255,e=e>>>8,r[t+2]=e&255,e=e>>>8,r[t+3]=e&255}function g4(r,e){return r[e]}function m4(r,e,t){r[t]=e}function v4(r){return a4(r,e=>_e.concat(e))}function _4(r){let e=0,t=0,i=0;const n=new Uint8Array(Math.floor(r.length/4*3)),s=a=>{switch(t){case 3:n[i++]=e|a,t=0;break;case 2:n[i++]=e|a>>>2,e=a<<6,t=3;break;case 1:n[i++]=e|a>>>4,e=a<<4,t=2;break;default:e=a<<2,t=1}};for(let a=0;a<r.length;a++){const c=r.charCodeAt(a);if(c>=65&&c<=90)s(c-65);else if(c>=97&&c<=122)s(c-97+26);else if(c>=48&&c<=57)s(c-48+52);else if(c===43||c===45)s(62);else if(c===47||c===95)s(63);else{if(c===61)break;throw new SyntaxError(`Unexpected base64 character ${r[a]}`)}}const o=i;for(;t>0;)s(0);return _e.wrap(n).slice(0,o)}const w4="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",b4="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_";function px({buffer:r},e=!0,t=!1){const i=t?b4:w4;let n="";const s=r.byteLength%3;let o=0;for(;o<r.byteLength-s;o+=3){const a=r[o+0],c=r[o+1],l=r[o+2];n+=i[a>>>2],n+=i[(a<<4|c>>>4)&63],n+=i[(c<<2|l>>>6)&63],n+=i[l&63]}if(s===1){const a=r[o+0];n+=i[a>>>2],n+=i[a<<4&63],e&&(n+="==")}else if(s===2){const a=r[o+0],c=r[o+1];n+=i[a>>>2],n+=i[(a<<4|c>>>4)&63],n+=i[c<<2&63],e&&(n+="=")}return n}var Or;let mt=(Or=class{constructor(e){this.element=e,this.next=Or.Undefined,this.prev=Or.Undefined}},Or.Undefined=new Or(void 0),Or);class Yu{constructor(){this._first=mt.Undefined,this._last=mt.Undefined,this._size=0}get size(){return this._size}isEmpty(){return this._first===mt.Undefined}clear(){let e=this._first;for(;e!==mt.Undefined;){const t=e.next;e.prev=mt.Undefined,e.next=mt.Undefined,e=t}this._first=mt.Undefined,this._last=mt.Undefined,this._size=0}unshift(e){return this._insert(e,!1)}push(e){return this._insert(e,!0)}_insert(e,t){const i=new mt(e);if(this._first===mt.Undefined)this._first=i,this._last=i;else if(t){const s=this._last;this._last=i,i.prev=s,s.next=i}else{const s=this._first;this._first=i,i.next=s,s.prev=i}this._size+=1;let n=!1;return()=>{n||(n=!0,this._remove(i))}}shift(){if(this._first!==mt.Undefined){const e=this._first.element;return this._remove(this._first),e}}pop(){if(this._last!==mt.Undefined){const e=this._last.element;return this._remove(this._last),e}}_remove(e){if(e.prev!==mt.Undefined&&e.next!==mt.Undefined){const t=e.prev;t.next=e.next,e.next.prev=t}else e.prev===mt.Undefined&&e.next===mt.Undefined?(this._first=mt.Undefined,this._last=mt.Undefined):e.next===mt.Undefined?(this._last=this._last.prev,this._last.next=mt.Undefined):e.prev===mt.Undefined&&(this._first=this._first.next,this._first.prev=mt.Undefined);this._size-=1}*[Symbol.iterator](){let e=this._first;for(;e!==mt.Undefined;)yield e.element,e=e.next}}const y4=globalThis.performance&&typeof globalThis.performance.now=="function";class rr{static create(e){return new rr(e)}constructor(e){this._now=y4&&e===!1?Date.now:globalThis.performance.now.bind(globalThis.performance),this._startTime=this._now(),this._stopTime=-1}stop(){this._stopTime=this._now()}reset(){this._startTime=this._now(),this._stopTime=-1}elapsed(){return this._stopTime!==-1?this._stopTime-this._startTime:this._now()-this._startTime}}var It;(function(r){r.None=()=>Fe.None;function e(V,B){return d(V,()=>{},0,void 0,!0,void 0,B)}r.defer=e;function t(V){return(B,Q=null,Y)=>{let ie=!1,me;return me=V(ge=>{if(!ie)return me?me.dispose():ie=!0,B.call(Q,ge)},null,Y),ie&&me.dispose(),me}}r.once=t;function i(V,B,Q){return l((Y,ie=null,me)=>V(ge=>Y.call(ie,B(ge)),null,me),Q)}r.map=i;function n(V,B,Q){return l((Y,ie=null,me)=>V(ge=>{B(ge),Y.call(ie,ge)},null,me),Q)}r.forEach=n;function s(V,B,Q){return l((Y,ie=null,me)=>V(ge=>B(ge)&&Y.call(ie,ge),null,me),Q)}r.filter=s;function o(V){return V}r.signal=o;function a(...V){return(B,Q=null,Y)=>{const ie=hx(...V.map(me=>me(ge=>B.call(Q,ge))));return u(ie,Y)}}r.any=a;function c(V,B,Q,Y){let ie=Q;return i(V,me=>(ie=B(ie,me),ie),Y)}r.reduce=c;function l(V,B){let Q;const Y={onWillAddFirstListener(){Q=V(ie.fire,ie)},onDidRemoveLastListener(){Q==null||Q.dispose()}},ie=new R(Y);return B==null||B.add(ie),ie.event}function u(V,B){return B instanceof Array?B.push(V):B&&B.add(V),V}function d(V,B,Q=100,Y=!1,ie=!1,me,ge){let tt,nt,He,Ot=0,gt;const Zt={leakWarningThreshold:me,onWillAddFirstListener(){tt=V(_i=>{Ot++,nt=B(nt,_i),Y&&!He&&(_t.fire(nt),nt=void 0),gt=()=>{const rt=nt;nt=void 0,He=void 0,(!Y||Ot>1)&&_t.fire(rt),Ot=0},typeof Q=="number"?(clearTimeout(He),He=setTimeout(gt,Q)):He===void 0&&(He=0,queueMicrotask(gt))})},onWillRemoveListener(){ie&&Ot>0&&(gt==null||gt())},onDidRemoveLastListener(){gt=void 0,tt.dispose()}},_t=new R(Zt);return ge==null||ge.add(_t),_t.event}r.debounce=d;function f(V,B=0,Q){return r.debounce(V,(Y,ie)=>Y?(Y.push(ie),Y):[ie],B,void 0,!0,void 0,Q)}r.accumulate=f;function m(V,B=(Y,ie)=>Y===ie,Q){let Y=!0,ie;return s(V,me=>{const ge=Y||!B(me,ie);return Y=!1,ie=me,ge},Q)}r.latch=m;function b(V,B,Q){return[r.filter(V,B,Q),r.filter(V,Y=>!B(Y),Q)]}r.split=b;function _(V,B=!1,Q=[],Y){let ie=Q.slice(),me=V(nt=>{ie?ie.push(nt):tt.fire(nt)});Y&&Y.add(me);const ge=()=>{ie==null||ie.forEach(nt=>tt.fire(nt)),ie=null},tt=new R({onWillAddFirstListener(){me||(me=V(nt=>tt.fire(nt)),Y&&Y.add(me))},onDidAddFirstListener(){ie&&(B?setTimeout(ge):ge())},onDidRemoveLastListener(){me&&me.dispose(),me=null}});return Y&&Y.add(tt),tt.event}r.buffer=_;function v(V,B){return(Y,ie,me)=>{const ge=B(new D);return V(function(tt){const nt=ge.evaluate(tt);nt!==k&&Y.call(ie,nt)},void 0,me)}}r.chain=v;const k=Symbol("HaltChainable");class D{constructor(){this.steps=[]}map(B){return this.steps.push(B),this}forEach(B){return this.steps.push(Q=>(B(Q),Q)),this}filter(B){return this.steps.push(Q=>B(Q)?Q:k),this}reduce(B,Q){let Y=Q;return this.steps.push(ie=>(Y=B(Y,ie),Y)),this}latch(B=(Q,Y)=>Q===Y){let Q=!0,Y;return this.steps.push(ie=>{const me=Q||!B(ie,Y);return Q=!1,Y=ie,me?ie:k}),this}evaluate(B){for(const Q of this.steps)if(B=Q(B),B===k)break;return B}}function E(V,B,Q=Y=>Y){const Y=(...tt)=>ge.fire(Q(...tt)),ie=()=>V.on(B,Y),me=()=>V.removeListener(B,Y),ge=new R({onWillAddFirstListener:ie,onDidRemoveLastListener:me});return ge.event}r.fromNodeEventEmitter=E;function N(V,B,Q=Y=>Y){const Y=(...tt)=>ge.fire(Q(...tt)),ie=()=>V.addEventListener(B,Y),me=()=>V.removeEventListener(B,Y),ge=new R({onWillAddFirstListener:ie,onDidRemoveLastListener:me});return ge.event}r.fromDOMEventEmitter=N;function A(V){return new Promise(B=>t(V)(B))}r.toPromise=A;function j(V){const B=new R;return V.then(Q=>{B.fire(Q)},()=>{B.fire(void 0)}).finally(()=>{B.dispose()}),B.event}r.fromPromise=j;function re(V,B,Q){return B(Q),V(Y=>B(Y))}r.runAndSubscribe=re;class te{constructor(B,Q){this._observable=B,this._counter=0,this._hasChanged=!1;const Y={onWillAddFirstListener:()=>{B.addObserver(this)},onDidRemoveLastListener:()=>{B.removeObserver(this)}};this.emitter=new R(Y),Q&&Q.add(this.emitter)}beginUpdate(B){this._counter++}handlePossibleChange(B){}handleChange(B,Q){this._hasChanged=!0}endUpdate(B){this._counter--,this._counter===0&&(this._observable.reportChanges(),this._hasChanged&&(this._hasChanged=!1,this.emitter.fire(this._observable.get())))}}function q(V,B){return new te(V,B).emitter.event}r.fromObservable=q;function We(V){return(B,Q,Y)=>{let ie=0,me=!1;const ge={beginUpdate(){ie++},endUpdate(){ie--,ie===0&&(V.reportChanges(),me&&(me=!1,B.call(Q)))},handlePossibleChange(){},handleChange(){me=!0}};V.addObserver(ge),V.reportChanges();const tt={dispose(){V.removeObserver(ge)}};return Y instanceof Te?Y.add(tt):Array.isArray(Y)&&Y.push(tt),tt}}r.fromObservableLight=We})(It||(It={}));const Xo=class Xo{constructor(e){this.listenerCount=0,this.invocationCount=0,this.elapsedOverall=0,this.durations=[],this.name=`${e}_${Xo._idPool++}`,Xo.all.add(this)}start(e){this._stopWatch=new rr,this.listenerCount=e}stop(){if(this._stopWatch){const e=this._stopWatch.elapsed();this.durations.push(e),this.elapsedOverall+=e,this.invocationCount+=1,this._stopWatch=void 0}}};Xo.all=new Set,Xo._idPool=0;let xm=Xo,x4=-1;class C4{constructor(e,t=Math.random().toString(18).slice(2,5)){this.threshold=e,this.name=t,this._warnCountdown=0}dispose(){var e;(e=this._stacks)==null||e.clear()}check(e,t){const i=this.threshold;if(i<=0||t<i)return;this._stacks||(this._stacks=new Map);const n=this._stacks.get(e.value)||0;if(this._stacks.set(e.value,n+1),this._warnCountdown-=1,this._warnCountdown<=0){this._warnCountdown=i*.5;let s,o=0;for(const[a,c]of this._stacks)(!s||o<c)&&(s=a,o=c);console.warn(`[${this.name}] potential listener LEAK detected, having ${t} listeners already. MOST frequent listener (${o}):`),console.warn(s)}return()=>{const s=this._stacks.get(e.value)||0;this._stacks.set(e.value,s-1)}}}class vw{static create(){return new vw(new Error().stack??"")}constructor(e){this.value=e}print(){console.warn(this.value.split(`
`).slice(2).join(`
`))}}let S4=0;class jd{constructor(e){this.value=e,this.id=S4++}}const E4=2,k4=(r,e)=>{if(r instanceof jd)e(r);else for(let t=0;t<r.length;t++){const i=r[t];i&&e(i)}};class R{constructor(e){var t,i,n,s;this._size=0,this._options=e,this._leakageMon=(t=this._options)!=null&&t.leakWarningThreshold?new C4(((i=this._options)==null?void 0:i.leakWarningThreshold)??x4):void 0,this._perfMon=(n=this._options)!=null&&n._profName?new xm(this._options._profName):void 0,this._deliveryQueue=(s=this._options)==null?void 0:s.deliveryQueue}dispose(){var e,t,i,n;this._disposed||(this._disposed=!0,((e=this._deliveryQueue)==null?void 0:e.current)===this&&this._deliveryQueue.reset(),this._listeners&&(this._listeners=void 0,this._size=0),(i=(t=this._options)==null?void 0:t.onDidRemoveLastListener)==null||i.call(t),(n=this._leakageMon)==null||n.dispose())}get event(){return this._event??(this._event=(e,t,i)=>{var a,c,l,u;if(this._leakageMon&&this._size>this._leakageMon.threshold*3)return console.warn(`[${this._leakageMon.name}] REFUSES to accept new listeners because it exceeded its threshold by far`),Fe.None;if(this._disposed)return Fe.None;t&&(e=e.bind(t));const n=new jd(e);let s;this._leakageMon&&this._size>=Math.ceil(this._leakageMon.threshold*.2)&&(n.stack=vw.create(),s=this._leakageMon.check(n.stack,this._size+1)),this._listeners?this._listeners instanceof jd?(this._deliveryQueue??(this._deliveryQueue=new D4),this._listeners=[this._listeners,n]):this._listeners.push(n):((c=(a=this._options)==null?void 0:a.onWillAddFirstListener)==null||c.call(a,this),this._listeners=n,(u=(l=this._options)==null?void 0:l.onDidAddFirstListener)==null||u.call(l,this)),this._size++;const o=De(()=>{s==null||s(),this._removeListener(n)});return i instanceof Te?i.add(o):Array.isArray(i)&&i.push(o),o}),this._event}_removeListener(e){var s,o,a,c;if((o=(s=this._options)==null?void 0:s.onWillRemoveListener)==null||o.call(s,this),!this._listeners)return;if(this._size===1){this._listeners=void 0,(c=(a=this._options)==null?void 0:a.onDidRemoveLastListener)==null||c.call(a,this),this._size=0;return}const t=this._listeners,i=t.indexOf(e);if(i===-1)throw console.log("disposed?",this._disposed),console.log("size?",this._size),console.log("arr?",JSON.stringify(this._listeners)),new Error("Attempted to dispose unknown listener");this._size--,t[i]=void 0;const n=this._deliveryQueue.current===this;if(this._size*E4<=t.length){let l=0;for(let u=0;u<t.length;u++)t[u]?t[l++]=t[u]:n&&(this._deliveryQueue.end--,l<this._deliveryQueue.i&&this._deliveryQueue.i--);t.length=l}}_deliver(e,t){var n;if(!e)return;const i=((n=this._options)==null?void 0:n.onListenerError)||nn;if(!i){e.value(t);return}try{e.value(t)}catch(s){i(s)}}_deliverQueue(e){const t=e.current._listeners;for(;e.i<e.end;)this._deliver(t[e.i++],e.value);e.reset()}fire(e){var t,i,n,s;if((t=this._deliveryQueue)!=null&&t.current&&(this._deliverQueue(this._deliveryQueue),(i=this._perfMon)==null||i.stop()),(n=this._perfMon)==null||n.start(this._size),this._listeners)if(this._listeners instanceof jd)this._deliver(this._listeners,e);else{const o=this._deliveryQueue;o.enqueue(this,e,this._listeners.length),this._deliverQueue(o)}(s=this._perfMon)==null||s.stop()}hasListeners(){return this._size>0}}class D4{constructor(){this.i=-1,this.end=0}enqueue(e,t,i){this.i=0,this.end=i,this.current=e,this.value=t}reset(){this.i=this.end,this.current=void 0,this.value=void 0}}class il extends R{async fireAsync(e,t,i){if(this._listeners)for(this._asyncDeliveryQueue||(this._asyncDeliveryQueue=new Yu),k4(this._listeners,n=>this._asyncDeliveryQueue.push([n.value,e]));this._asyncDeliveryQueue.size>0&&!t.isCancellationRequested;){const[n,s]=this._asyncDeliveryQueue.shift(),o=[],a={...s,token:t,waitUntil:c=>{if(Object.isFrozen(o))throw new Error("waitUntil can NOT be called asynchronous");i&&(c=i(c,n)),o.push(c)}};try{n(a)}catch(c){nn(c);continue}await Promise.allSettled(o).then(c=>{for(const l of c)l.status==="rejected"&&nn(l.reason)})}}}class I4 extends R{get isPaused(){return this._isPaused!==0}constructor(e){super(e),this._isPaused=0,this._eventQueue=new Yu,this._mergeFn=e==null?void 0:e.merge}pause(){this._isPaused++}resume(){if(this._isPaused!==0&&--this._isPaused===0)if(this._mergeFn){if(this._eventQueue.size>0){const e=Array.from(this._eventQueue);this._eventQueue.clear(),super.fire(this._mergeFn(e))}}else for(;!this._isPaused&&this._eventQueue.size!==0;)super.fire(this._eventQueue.shift())}fire(e){this._size&&(this._isPaused!==0?this._eventQueue.push(e):super.fire(e))}}class P4 extends I4{constructor(e){super(e),this._delay=e.delay??100}fire(e){this._handle||(this.pause(),this._handle=setTimeout(()=>{this._handle=void 0,this.resume()},this._delay)),super.fire(e)}}var Tl;(function(r){r[r.Desktop=1]="Desktop",r[r.Web=2]="Web"})(Tl||(Tl={}));function C0(r){const e=_e.alloc(1);switch(r){case 0:e.writeUInt8(1,0);break;case 1:e.writeUInt8(2,0);break;case 2:e.writeUInt8(3,0);break}return e}function T4(r,e){if(r.byteLength!==1)return!1;switch(r.readUInt8(0)){case 1:return e===0;case 2:return e===1;case 3:return e===2;default:return!1}}const Si=r=>{performance.mark(r)},A4=()=>{let r=performance.timeOrigin;typeof r!="number"&&(r=performance.timing.navigationStart||performance.timing.redirectStart||performance.timing.fetchStart);const e=[{name:"code/timeOrigin",startTime:Math.round(r)}];for(const t of performance.getEntriesByType("mark"))e.push({name:t.name,startTime:Math.round(r+t.startTime)});return e};let R4=typeof document<"u"&&document.location&&document.location.hash.indexOf("pseudo=true")>=0;function Cm(r,e){let t;return e.length===0?t=r:t=r.replace(/\{(\d+)\}/g,(i,n)=>{const s=n[0],o=e[s];let a=i;return typeof o=="string"?a=o:(typeof o=="number"||typeof o=="boolean"||o===void 0||o===null)&&(a=String(o)),a}),R4&&(t="［"+t.replace(/[aouei]/g,"$&$&")+"］"),t}let gx={};function h(r,e,t,...i){const n=typeof e=="object"?e.key:e,s=(gx[r]??{})[n]??t;return Cm(s,i)}function _w(r,e,t,...i){const n=typeof e=="object"?e.key:e,s=(gx[r]??{})[n]??t;return{value:Cm(s,i),original:Cm(t,i)}}const Es="en";let Sm=!1,Em=!1,km=!1,mx=!1,ww=!1,vx=!1,Cd,qd=Es,S0=Es,Vi;const Zn=globalThis;let ai;var ix;typeof Zn.vscode<"u"&&typeof Zn.vscode.process<"u"?ai=Zn.vscode.process:typeof process<"u"&&typeof((ix=process==null?void 0:process.versions)==null?void 0:ix.node)=="string"&&(ai=process);var nx;const L4=typeof((nx=ai==null?void 0:ai.versions)==null?void 0:nx.electron)=="string",$4=L4&&(ai==null?void 0:ai.type)==="renderer";if(typeof ai=="object"){Sm=ai.platform==="win32",Em=ai.platform==="darwin",km=ai.platform==="linux",vx=!!ai.env.CI||!!ai.env.BUILD_ARTIFACTSTAGINGDIRECTORY,Cd=Es,qd=Es;const r=ai.env.VSCODE_NLS_CONFIG;if(r)try{const e=JSON.parse(r),t=e.availableLanguages["*"];Cd=e.locale,S0=e.osLocale,qd=t||Es}catch{}mx=!0}else typeof navigator=="object"&&!$4?(Vi=navigator.userAgent,Sm=Vi.indexOf("Windows")>=0,Em=Vi.indexOf("Macintosh")>=0,(Vi.indexOf("Macintosh")>=0||Vi.indexOf("iPad")>=0||Vi.indexOf("iPhone")>=0)&&navigator.maxTouchPoints&&navigator.maxTouchPoints>0,km=Vi.indexOf("Linux")>=0,(Vi==null?void 0:Vi.indexOf("Mobi"))>=0,ww=!0,Cd=Es,qd=Cd,S0=navigator.language):console.error("Unable to resolve platform.");function N4(r){switch(r){case 0:return"Web";case 1:return"Mac";case 2:return"Linux";case 3:return"Windows"}}const Ii=Sm,rn=Em,Qr=km,M4=mx,bw=ww,Al=ww&&typeof Zn.importScripts=="function",F4=Al?Zn.origin:void 0,as=vx,Sn=Vi,hr=qd;var E0;(function(r){function e(){return hr}r.value=e;function t(){return hr.length===2?hr==="en":hr.length>=3?hr[0]==="e"&&hr[1]==="n"&&hr[2]==="-":!1}r.isDefaultVariant=t;function i(){return hr==="en"}r.isDefault=i})(E0||(E0={}));const O4=typeof Zn.postMessage=="function"&&!Zn.importScripts,_x=(()=>{if(O4){const r=[];Zn.addEventListener("message",t=>{if(t.data&&t.data.vscodeScheduleAsyncWork)for(let i=0,n=r.length;i<n;i++){const s=r[i];if(s.id===t.data.vscodeScheduleAsyncWork){r.splice(i,1),s.callback();return}}});let e=0;return t=>{const i=++e;r.push({id:i,callback:t}),Zn.postMessage({vscodeScheduleAsyncWork:i},"*")}}return r=>setTimeout(r)})();let k0=!0,D0=!1;function wx(){if(!D0){D0=!0;const r=new Uint8Array(2);r[0]=1,r[1]=2,k0=new Uint16Array(r.buffer)[0]===513}return k0}const bx=!!(Sn&&Sn.indexOf("Chrome")>=0),H4=!!(Sn&&Sn.indexOf("Firefox")>=0),U4=!!(!bx&&Sn&&Sn.indexOf("Safari")>=0),B4=!!(Sn&&Sn.indexOf("Edg/")>=0);Sn&&Sn.indexOf("Android")>=0;var I0={};let Zs;const Ug=globalThis.vscode;if(typeof Ug<"u"&&typeof Ug.process<"u"){const r=Ug.process;Zs={get platform(){return r.platform},get arch(){return r.arch},get env(){return r.env},cwd(){return r.cwd()}}}else typeof process<"u"?Zs={get platform(){return process.platform},get arch(){return process.arch},get env(){return I0},cwd(){return I0.VSCODE_CWD||process.cwd()}}:Zs={get platform(){return Ii?"win32":rn?"darwin":"linux"},get arch(){},get env(){return{}},cwd(){return"/"}};const Na=Zs.cwd,Dm=Zs.env,V4=Zs.platform;Zs.arch;const W4=65,z4=97,j4=90,q4=122,Ur=46,Mt=47,di=92,fr=58,G4=63;class yx extends Error{constructor(e,t,i){let n;typeof t=="string"&&t.indexOf("not ")===0?(n="must not be",t=t.replace(/^not /,"")):n="must be";const s=e.indexOf(".")!==-1?"property":"argument";let o=`The "${e}" ${s} ${n} of type ${t}`;o+=`. Received type ${typeof i}`,super(o),this.code="ERR_INVALID_ARG_TYPE"}}function Q4(r,e){if(r===null||typeof r!="object")throw new yx(e,"Object",r)}function wt(r,e){if(typeof r!="string")throw new yx(e,"string",r)}const Hi=V4==="win32";function Ae(r){return r===Mt||r===di}function Im(r){return r===Mt}function pr(r){return r>=W4&&r<=j4||r>=z4&&r<=q4}function hh(r,e,t,i){let n="",s=0,o=-1,a=0,c=0;for(let l=0;l<=r.length;++l){if(l<r.length)c=r.charCodeAt(l);else{if(i(c))break;c=Mt}if(i(c)){if(!(o===l-1||a===1))if(a===2){if(n.length<2||s!==2||n.charCodeAt(n.length-1)!==Ur||n.charCodeAt(n.length-2)!==Ur){if(n.length>2){const u=n.lastIndexOf(t);u===-1?(n="",s=0):(n=n.slice(0,u),s=n.length-1-n.lastIndexOf(t)),o=l,a=0;continue}else if(n.length!==0){n="",s=0,o=l,a=0;continue}}e&&(n+=n.length>0?`${t}..`:"..",s=2)}else n.length>0?n+=`${t}${r.slice(o+1,l)}`:n=r.slice(o+1,l),s=l-o-1;o=l,a=0}else c===Ur&&a!==-1?++a:a=-1}return n}function xx(r,e){Q4(e,"pathObject");const t=e.dir||e.root,i=e.base||`${e.name||""}${e.ext||""}`;return t?t===e.root?`${t}${i}`:`${t}${r}${i}`:i}const $t={resolve(...r){let e="",t="",i=!1;for(let n=r.length-1;n>=-1;n--){let s;if(n>=0){if(s=r[n],wt(s,"path"),s.length===0)continue}else e.length===0?s=Na():(s=Dm[`=${e}`]||Na(),(s===void 0||s.slice(0,2).toLowerCase()!==e.toLowerCase()&&s.charCodeAt(2)===di)&&(s=`${e}\\`));const o=s.length;let a=0,c="",l=!1;const u=s.charCodeAt(0);if(o===1)Ae(u)&&(a=1,l=!0);else if(Ae(u))if(l=!0,Ae(s.charCodeAt(1))){let d=2,f=d;for(;d<o&&!Ae(s.charCodeAt(d));)d++;if(d<o&&d!==f){const m=s.slice(f,d);for(f=d;d<o&&Ae(s.charCodeAt(d));)d++;if(d<o&&d!==f){for(f=d;d<o&&!Ae(s.charCodeAt(d));)d++;(d===o||d!==f)&&(c=`\\\\${m}\\${s.slice(f,d)}`,a=d)}}}else a=1;else pr(u)&&s.charCodeAt(1)===fr&&(c=s.slice(0,2),a=2,o>2&&Ae(s.charCodeAt(2))&&(l=!0,a=3));if(c.length>0)if(e.length>0){if(c.toLowerCase()!==e.toLowerCase())continue}else e=c;if(i){if(e.length>0)break}else if(t=`${s.slice(a)}\\${t}`,i=l,l&&e.length>0)break}return t=hh(t,!i,"\\",Ae),i?`${e}\\${t}`:`${e}${t}`||"."},normalize(r){wt(r,"path");const e=r.length;if(e===0)return".";let t=0,i,n=!1;const s=r.charCodeAt(0);if(e===1)return Im(s)?"\\":r;if(Ae(s))if(n=!0,Ae(r.charCodeAt(1))){let a=2,c=a;for(;a<e&&!Ae(r.charCodeAt(a));)a++;if(a<e&&a!==c){const l=r.slice(c,a);for(c=a;a<e&&Ae(r.charCodeAt(a));)a++;if(a<e&&a!==c){for(c=a;a<e&&!Ae(r.charCodeAt(a));)a++;if(a===e)return`\\\\${l}\\${r.slice(c)}\\`;a!==c&&(i=`\\\\${l}\\${r.slice(c,a)}`,t=a)}}}else t=1;else pr(s)&&r.charCodeAt(1)===fr&&(i=r.slice(0,2),t=2,e>2&&Ae(r.charCodeAt(2))&&(n=!0,t=3));let o=t<e?hh(r.slice(t),!n,"\\",Ae):"";return o.length===0&&!n&&(o="."),o.length>0&&Ae(r.charCodeAt(e-1))&&(o+="\\"),i===void 0?n?`\\${o}`:o:n?`${i}\\${o}`:`${i}${o}`},isAbsolute(r){wt(r,"path");const e=r.length;if(e===0)return!1;const t=r.charCodeAt(0);return Ae(t)||e>2&&pr(t)&&r.charCodeAt(1)===fr&&Ae(r.charCodeAt(2))},join(...r){if(r.length===0)return".";let e,t;for(let s=0;s<r.length;++s){const o=r[s];wt(o,"path"),o.length>0&&(e===void 0?e=t=o:e+=`\\${o}`)}if(e===void 0)return".";let i=!0,n=0;if(typeof t=="string"&&Ae(t.charCodeAt(0))){++n;const s=t.length;s>1&&Ae(t.charCodeAt(1))&&(++n,s>2&&(Ae(t.charCodeAt(2))?++n:i=!1))}if(i){for(;n<e.length&&Ae(e.charCodeAt(n));)n++;n>=2&&(e=`\\${e.slice(n)}`)}return $t.normalize(e)},relative(r,e){if(wt(r,"from"),wt(e,"to"),r===e)return"";const t=$t.resolve(r),i=$t.resolve(e);if(t===i||(r=t.toLowerCase(),e=i.toLowerCase(),r===e))return"";let n=0;for(;n<r.length&&r.charCodeAt(n)===di;)n++;let s=r.length;for(;s-1>n&&r.charCodeAt(s-1)===di;)s--;const o=s-n;let a=0;for(;a<e.length&&e.charCodeAt(a)===di;)a++;let c=e.length;for(;c-1>a&&e.charCodeAt(c-1)===di;)c--;const l=c-a,u=o<l?o:l;let d=-1,f=0;for(;f<u;f++){const b=r.charCodeAt(n+f);if(b!==e.charCodeAt(a+f))break;b===di&&(d=f)}if(f!==u){if(d===-1)return i}else{if(l>u){if(e.charCodeAt(a+f)===di)return i.slice(a+f+1);if(f===2)return i.slice(a+f)}o>u&&(r.charCodeAt(n+f)===di?d=f:f===2&&(d=3)),d===-1&&(d=0)}let m="";for(f=n+d+1;f<=s;++f)(f===s||r.charCodeAt(f)===di)&&(m+=m.length===0?"..":"\\..");return a+=d,m.length>0?`${m}${i.slice(a,c)}`:(i.charCodeAt(a)===di&&++a,i.slice(a,c))},toNamespacedPath(r){if(typeof r!="string"||r.length===0)return r;const e=$t.resolve(r);if(e.length<=2)return r;if(e.charCodeAt(0)===di){if(e.charCodeAt(1)===di){const t=e.charCodeAt(2);if(t!==G4&&t!==Ur)return`\\\\?\\UNC\\${e.slice(2)}`}}else if(pr(e.charCodeAt(0))&&e.charCodeAt(1)===fr&&e.charCodeAt(2)===di)return`\\\\?\\${e}`;return r},dirname(r){wt(r,"path");const e=r.length;if(e===0)return".";let t=-1,i=0;const n=r.charCodeAt(0);if(e===1)return Ae(n)?r:".";if(Ae(n)){if(t=i=1,Ae(r.charCodeAt(1))){let a=2,c=a;for(;a<e&&!Ae(r.charCodeAt(a));)a++;if(a<e&&a!==c){for(c=a;a<e&&Ae(r.charCodeAt(a));)a++;if(a<e&&a!==c){for(c=a;a<e&&!Ae(r.charCodeAt(a));)a++;if(a===e)return r;a!==c&&(t=i=a+1)}}}}else pr(n)&&r.charCodeAt(1)===fr&&(t=e>2&&Ae(r.charCodeAt(2))?3:2,i=t);let s=-1,o=!0;for(let a=e-1;a>=i;--a)if(Ae(r.charCodeAt(a))){if(!o){s=a;break}}else o=!1;if(s===-1){if(t===-1)return".";s=t}return r.slice(0,s)},basename(r,e){e!==void 0&&wt(e,"ext"),wt(r,"path");let t=0,i=-1,n=!0,s;if(r.length>=2&&pr(r.charCodeAt(0))&&r.charCodeAt(1)===fr&&(t=2),e!==void 0&&e.length>0&&e.length<=r.length){if(e===r)return"";let o=e.length-1,a=-1;for(s=r.length-1;s>=t;--s){const c=r.charCodeAt(s);if(Ae(c)){if(!n){t=s+1;break}}else a===-1&&(n=!1,a=s+1),o>=0&&(c===e.charCodeAt(o)?--o===-1&&(i=s):(o=-1,i=a))}return t===i?i=a:i===-1&&(i=r.length),r.slice(t,i)}for(s=r.length-1;s>=t;--s)if(Ae(r.charCodeAt(s))){if(!n){t=s+1;break}}else i===-1&&(n=!1,i=s+1);return i===-1?"":r.slice(t,i)},extname(r){wt(r,"path");let e=0,t=-1,i=0,n=-1,s=!0,o=0;r.length>=2&&r.charCodeAt(1)===fr&&pr(r.charCodeAt(0))&&(e=i=2);for(let a=r.length-1;a>=e;--a){const c=r.charCodeAt(a);if(Ae(c)){if(!s){i=a+1;break}continue}n===-1&&(s=!1,n=a+1),c===Ur?t===-1?t=a:o!==1&&(o=1):t!==-1&&(o=-1)}return t===-1||n===-1||o===0||o===1&&t===n-1&&t===i+1?"":r.slice(t,n)},format:xx.bind(null,"\\"),parse(r){wt(r,"path");const e={root:"",dir:"",base:"",ext:"",name:""};if(r.length===0)return e;const t=r.length;let i=0,n=r.charCodeAt(0);if(t===1)return Ae(n)?(e.root=e.dir=r,e):(e.base=e.name=r,e);if(Ae(n)){if(i=1,Ae(r.charCodeAt(1))){let d=2,f=d;for(;d<t&&!Ae(r.charCodeAt(d));)d++;if(d<t&&d!==f){for(f=d;d<t&&Ae(r.charCodeAt(d));)d++;if(d<t&&d!==f){for(f=d;d<t&&!Ae(r.charCodeAt(d));)d++;d===t?i=d:d!==f&&(i=d+1)}}}}else if(pr(n)&&r.charCodeAt(1)===fr){if(t<=2)return e.root=e.dir=r,e;if(i=2,Ae(r.charCodeAt(2))){if(t===3)return e.root=e.dir=r,e;i=3}}i>0&&(e.root=r.slice(0,i));let s=-1,o=i,a=-1,c=!0,l=r.length-1,u=0;for(;l>=i;--l){if(n=r.charCodeAt(l),Ae(n)){if(!c){o=l+1;break}continue}a===-1&&(c=!1,a=l+1),n===Ur?s===-1?s=l:u!==1&&(u=1):s!==-1&&(u=-1)}return a!==-1&&(s===-1||u===0||u===1&&s===a-1&&s===o+1?e.base=e.name=r.slice(o,a):(e.name=r.slice(o,s),e.base=r.slice(o,a),e.ext=r.slice(s,a))),o>0&&o!==i?e.dir=r.slice(0,o-1):e.dir=e.root,e},sep:"\\",delimiter:";",win32:null,posix:null},J4=(()=>{if(Hi){const r=/\\/g;return()=>{const e=Na().replace(r,"/");return e.slice(e.indexOf("/"))}}return()=>Na()})(),Be={resolve(...r){let e="",t=!1;for(let i=r.length-1;i>=-1&&!t;i--){const n=i>=0?r[i]:J4();wt(n,"path"),n.length!==0&&(e=`${n}/${e}`,t=n.charCodeAt(0)===Mt)}return e=hh(e,!t,"/",Im),t?`/${e}`:e.length>0?e:"."},normalize(r){if(wt(r,"path"),r.length===0)return".";const e=r.charCodeAt(0)===Mt,t=r.charCodeAt(r.length-1)===Mt;return r=hh(r,!e,"/",Im),r.length===0?e?"/":t?"./":".":(t&&(r+="/"),e?`/${r}`:r)},isAbsolute(r){return wt(r,"path"),r.length>0&&r.charCodeAt(0)===Mt},join(...r){if(r.length===0)return".";let e;for(let t=0;t<r.length;++t){const i=r[t];wt(i,"path"),i.length>0&&(e===void 0?e=i:e+=`/${i}`)}return e===void 0?".":Be.normalize(e)},relative(r,e){if(wt(r,"from"),wt(e,"to"),r===e||(r=Be.resolve(r),e=Be.resolve(e),r===e))return"";const t=1,i=r.length,n=i-t,s=1,o=e.length-s,a=n<o?n:o;let c=-1,l=0;for(;l<a;l++){const d=r.charCodeAt(t+l);if(d!==e.charCodeAt(s+l))break;d===Mt&&(c=l)}if(l===a)if(o>a){if(e.charCodeAt(s+l)===Mt)return e.slice(s+l+1);if(l===0)return e.slice(s+l)}else n>a&&(r.charCodeAt(t+l)===Mt?c=l:l===0&&(c=0));let u="";for(l=t+c+1;l<=i;++l)(l===i||r.charCodeAt(l)===Mt)&&(u+=u.length===0?"..":"/..");return`${u}${e.slice(s+c)}`},toNamespacedPath(r){return r},dirname(r){if(wt(r,"path"),r.length===0)return".";const e=r.charCodeAt(0)===Mt;let t=-1,i=!0;for(let n=r.length-1;n>=1;--n)if(r.charCodeAt(n)===Mt){if(!i){t=n;break}}else i=!1;return t===-1?e?"/":".":e&&t===1?"//":r.slice(0,t)},basename(r,e){e!==void 0&&wt(e,"ext"),wt(r,"path");let t=0,i=-1,n=!0,s;if(e!==void 0&&e.length>0&&e.length<=r.length){if(e===r)return"";let o=e.length-1,a=-1;for(s=r.length-1;s>=0;--s){const c=r.charCodeAt(s);if(c===Mt){if(!n){t=s+1;break}}else a===-1&&(n=!1,a=s+1),o>=0&&(c===e.charCodeAt(o)?--o===-1&&(i=s):(o=-1,i=a))}return t===i?i=a:i===-1&&(i=r.length),r.slice(t,i)}for(s=r.length-1;s>=0;--s)if(r.charCodeAt(s)===Mt){if(!n){t=s+1;break}}else i===-1&&(n=!1,i=s+1);return i===-1?"":r.slice(t,i)},extname(r){wt(r,"path");let e=-1,t=0,i=-1,n=!0,s=0;for(let o=r.length-1;o>=0;--o){const a=r.charCodeAt(o);if(a===Mt){if(!n){t=o+1;break}continue}i===-1&&(n=!1,i=o+1),a===Ur?e===-1?e=o:s!==1&&(s=1):e!==-1&&(s=-1)}return e===-1||i===-1||s===0||s===1&&e===i-1&&e===t+1?"":r.slice(e,i)},format:xx.bind(null,"/"),parse(r){wt(r,"path");const e={root:"",dir:"",base:"",ext:"",name:""};if(r.length===0)return e;const t=r.charCodeAt(0)===Mt;let i;t?(e.root="/",i=1):i=0;let n=-1,s=0,o=-1,a=!0,c=r.length-1,l=0;for(;c>=i;--c){const u=r.charCodeAt(c);if(u===Mt){if(!a){s=c+1;break}continue}o===-1&&(a=!1,o=c+1),u===Ur?n===-1?n=c:l!==1&&(l=1):n!==-1&&(l=-1)}if(o!==-1){const u=s===0&&t?1:s;n===-1||l===0||l===1&&n===o-1&&n===s+1?e.base=e.name=r.slice(u,o):(e.name=r.slice(u,n),e.base=r.slice(u,o),e.ext=r.slice(n,o))}return s>0?e.dir=r.slice(0,s-1):t&&(e.dir="/"),e},sep:"/",delimiter:":",win32:null,posix:null};Be.win32=$t.win32=$t;Be.posix=$t.posix=Be;const Ma=Hi?$t.normalize:Be.normalize,Pm=Hi?$t.isAbsolute:Be.isAbsolute,P0=Hi?$t.join:Be.join,K4=Hi?$t.resolve:Be.resolve,Rl=Hi?$t.relative:Be.relative,Ys=Hi?$t.dirname:Be.dirname,gi=Hi?$t.basename:Be.basename,Tm=Hi?$t.extname:Be.extname;Hi?$t.parse:Be.parse;const en=Hi?$t.sep:Be.sep;Hi?$t.delimiter:Be.delimiter;const X4=/^\w[\w\d+.-]*$/,Z4=/^\//,Y4=/^\/\//;function eE(r,e){if(!r.scheme&&e)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${r.authority}", path: "${r.path}", query: "${r.query}", fragment: "${r.fragment}"}`);if(r.scheme&&!X4.test(r.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(r.path){if(r.authority){if(!Z4.test(r.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(Y4.test(r.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}}function tE(r,e){return!r&&!e?"file":r}function iE(r,e){switch(r){case"https":case"http":case"file":e?e[0]!==Ji&&(e=Ji+e):e=Ji;break}return e}const st="",Ji="/",nE=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/;class x{static isUri(e){return e instanceof x?!0:e?typeof e.authority=="string"&&typeof e.fragment=="string"&&typeof e.path=="string"&&typeof e.query=="string"&&typeof e.scheme=="string"&&typeof e.fsPath=="string"&&typeof e.with=="function"&&typeof e.toString=="function":!1}constructor(e,t,i,n,s,o=!1){typeof e=="object"?(this.scheme=e.scheme||st,this.authority=e.authority||st,this.path=e.path||st,this.query=e.query||st,this.fragment=e.fragment||st):(this.scheme=tE(e,o),this.authority=t||st,this.path=iE(this.scheme,i||st),this.query=n||st,this.fragment=s||st,eE(this,o))}get fsPath(){return fh(this,!1)}with(e){if(!e)return this;let{scheme:t,authority:i,path:n,query:s,fragment:o}=e;return t===void 0?t=this.scheme:t===null&&(t=st),i===void 0?i=this.authority:i===null&&(i=st),n===void 0?n=this.path:n===null&&(n=st),s===void 0?s=this.query:s===null&&(s=st),o===void 0?o=this.fragment:o===null&&(o=st),t===this.scheme&&i===this.authority&&n===this.path&&s===this.query&&o===this.fragment?this:new No(t,i,n,s,o)}static parse(e,t=!1){const i=nE.exec(e);return i?new No(i[2]||st,Sd(i[4]||st),Sd(i[5]||st),Sd(i[7]||st),Sd(i[9]||st),t):new No(st,st,st,st,st)}static file(e){let t=st;if(Ii&&(e=e.replace(/\\/g,Ji)),e[0]===Ji&&e[1]===Ji){const i=e.indexOf(Ji,2);i===-1?(t=e.substring(2),e=Ji):(t=e.substring(2,i),e=e.substring(i)||Ji)}return new No("file",t,e,st,st)}static from(e,t){return new No(e.scheme,e.authority,e.path,e.query,e.fragment,t)}static joinPath(e,...t){if(!e.path)throw new Error("[UriError]: cannot call joinPath on URI without path");let i;return Ii&&e.scheme==="file"?i=x.file($t.join(fh(e,!0),...t)).path:i=Be.join(e.path,...t),e.with({path:i})}toString(e=!1){return Am(this,e)}toJSON(){return this}static revive(e){if(e){if(e instanceof x)return e;{const t=new No(e);return t._formatted=e.external??null,t._fsPath=e._sep===Sx?e.fsPath??null:null,t}}else return e}}function Cx(r){return!r||typeof r!="object"?!1:typeof r.scheme=="string"&&(typeof r.authority=="string"||typeof r.authority>"u")&&(typeof r.path=="string"||typeof r.path>"u")&&(typeof r.query=="string"||typeof r.query>"u")&&(typeof r.fragment=="string"||typeof r.fragment>"u")}const Sx=Ii?1:void 0;class No extends x{constructor(){super(...arguments),this._formatted=null,this._fsPath=null}get fsPath(){return this._fsPath||(this._fsPath=fh(this,!1)),this._fsPath}toString(e=!1){return e?Am(this,!0):(this._formatted||(this._formatted=Am(this,!1)),this._formatted)}toJSON(){const e={$mid:1};return this._fsPath&&(e.fsPath=this._fsPath,e._sep=Sx),this._formatted&&(e.external=this._formatted),this.path&&(e.path=this.path),this.scheme&&(e.scheme=this.scheme),this.authority&&(e.authority=this.authority),this.query&&(e.query=this.query),this.fragment&&(e.fragment=this.fragment),e}}const Ex={58:"%3A",47:"%2F",63:"%3F",35:"%23",91:"%5B",93:"%5D",64:"%40",33:"%21",36:"%24",38:"%26",39:"%27",40:"%28",41:"%29",42:"%2A",43:"%2B",44:"%2C",59:"%3B",61:"%3D",32:"%20"};function T0(r,e,t){let i,n=-1;for(let s=0;s<r.length;s++){const o=r.charCodeAt(s);if(o>=97&&o<=122||o>=65&&o<=90||o>=48&&o<=57||o===45||o===46||o===95||o===126||e&&o===47||t&&o===91||t&&o===93||t&&o===58)n!==-1&&(i+=encodeURIComponent(r.substring(n,s)),n=-1),i!==void 0&&(i+=r.charAt(s));else{i===void 0&&(i=r.substr(0,s));const a=Ex[o];a!==void 0?(n!==-1&&(i+=encodeURIComponent(r.substring(n,s)),n=-1),i+=a):n===-1&&(n=s)}}return n!==-1&&(i+=encodeURIComponent(r.substring(n))),i!==void 0?i:r}function rE(r){let e;for(let t=0;t<r.length;t++){const i=r.charCodeAt(t);i===35||i===63?(e===void 0&&(e=r.substr(0,t)),e+=Ex[i]):e!==void 0&&(e+=r[t])}return e!==void 0?e:r}function fh(r,e){let t;return r.authority&&r.path.length>1&&r.scheme==="file"?t=`//${r.authority}${r.path}`:r.path.charCodeAt(0)===47&&(r.path.charCodeAt(1)>=65&&r.path.charCodeAt(1)<=90||r.path.charCodeAt(1)>=97&&r.path.charCodeAt(1)<=122)&&r.path.charCodeAt(2)===58?e?t=r.path.substr(1):t=r.path[1].toLowerCase()+r.path.substr(2):t=r.path,Ii&&(t=t.replace(/\//g,"\\")),t}function Am(r,e){const t=e?rE:T0;let i="",{scheme:n,authority:s,path:o,query:a,fragment:c}=r;if(n&&(i+=n,i+=":"),(s||n==="file")&&(i+=Ji,i+=Ji),s){let l=s.indexOf("@");if(l!==-1){const u=s.substr(0,l);s=s.substr(l+1),l=u.lastIndexOf(":"),l===-1?i+=t(u,!1,!1):(i+=t(u.substr(0,l),!1,!1),i+=":",i+=t(u.substr(l+1),!1,!0)),i+="@"}s=s.toLowerCase(),l=s.lastIndexOf(":"),l===-1?i+=t(s,!1,!0):(i+=t(s.substr(0,l),!1,!0),i+=s.substr(l))}if(o){if(o.length>=3&&o.charCodeAt(0)===47&&o.charCodeAt(2)===58){const l=o.charCodeAt(1);l>=65&&l<=90&&(o=`/${String.fromCharCode(l+32)}:${o.substr(3)}`)}else if(o.length>=2&&o.charCodeAt(1)===58){const l=o.charCodeAt(0);l>=65&&l<=90&&(o=`${String.fromCharCode(l+32)}:${o.substr(2)}`)}i+=t(o,!0,!1)}return a&&(i+="?",i+=t(a,!1,!1)),c&&(i+="#",i+=e?c:T0(c,!1,!1)),i}function kx(r){try{return decodeURIComponent(r)}catch{return r.length>3?r.substr(0,3)+kx(r.substr(3)):r}}const A0=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function Sd(r){return r.match(A0)?r.replace(A0,e=>kx(e)):r}const yp=class yp{constructor(e){this._proxyIdentifierBrand=void 0,this.sid=e,this.nid=++yp.count}};yp.count=0;let ph=yp;const Dx=[];function F(r){const e=new ph(r);return Dx[e.nid]=e,e}function Ed(r){return Dx[r].sid}class Di{constructor(e){this.value=e}}var R0;(function(r){r[r.Default=0]="Default",r[r.InCenter=1]="InCenter",r[r.InCenterIfOutsideViewport=2]="InCenterIfOutsideViewport",r[r.AtTop=3]="AtTop"})(R0||(R0={}));var L0;(function(r){r[r.Default=0]="Default",r[r.InCenter=1]="InCenter",r[r.InCenterIfOutsideViewport=2]="InCenterIfOutsideViewport",r[r.AtTop=3]="AtTop"})(L0||(L0={}));var Rm;(function(r){r[r.None=0]="None",r[r.Process=1]="Process",r[r.Output=2]="Output"})(Rm||(Rm={}));const J={MainThreadAuthentication:F("MainThreadAuthentication"),MainThreadBulkEdits:F("MainThreadBulkEdits"),MainThreadLanguageModels:F("MainThreadLanguageModels"),MainThreadChatAgents2:F("MainThreadChatAgents2"),MainThreadChatVariables:F("MainThreadChatVariables"),MainThreadClipboard:F("MainThreadClipboard"),MainThreadCommands:F("MainThreadCommands"),MainThreadComments:F("MainThreadComments"),MainThreadConfiguration:F("MainThreadConfiguration"),MainThreadConsole:F("MainThreadConsole"),MainThreadDebugService:F("MainThreadDebugService"),MainThreadDecorations:F("MainThreadDecorations"),MainThreadDiagnostics:F("MainThreadDiagnostics"),MainThreadDialogs:F("MainThreadDiaglogs"),MainThreadDocuments:F("MainThreadDocuments"),MainThreadDocumentContentProviders:F("MainThreadDocumentContentProviders"),MainThreadTextEditors:F("MainThreadTextEditors"),MainThreadEditorInsets:F("MainThreadEditorInsets"),MainThreadEditorTabs:F("MainThreadEditorTabs"),MainThreadErrors:F("MainThreadErrors"),MainThreadTreeViews:F("MainThreadTreeViews"),MainThreadDownloadService:F("MainThreadDownloadService"),MainThreadLanguageFeatures:F("MainThreadLanguageFeatures"),MainThreadLanguages:F("MainThreadLanguages"),MainThreadLogger:F("MainThreadLogger"),MainThreadMessageService:F("MainThreadMessageService"),MainThreadOutputService:F("MainThreadOutputService"),MainThreadProgress:F("MainThreadProgress"),MainThreadQuickDiff:F("MainThreadQuickDiff"),MainThreadQuickOpen:F("MainThreadQuickOpen"),MainThreadStatusBar:F("MainThreadStatusBar"),MainThreadSecretState:F("MainThreadSecretState"),MainThreadStorage:F("MainThreadStorage"),MainThreadSpeech:F("MainThreadSpeechProvider"),MainThreadTelemetry:F("MainThreadTelemetry"),MainThreadTerminalService:F("MainThreadTerminalService"),MainThreadTerminalShellIntegration:F("MainThreadTerminalShellIntegration"),MainThreadWebviews:F("MainThreadWebviews"),MainThreadWebviewPanels:F("MainThreadWebviewPanels"),MainThreadWebviewViews:F("MainThreadWebviewViews"),MainThreadCustomEditors:F("MainThreadCustomEditors"),MainThreadUrls:F("MainThreadUrls"),MainThreadUriOpeners:F("MainThreadUriOpeners"),MainThreadProfileContentHandlers:F("MainThreadProfileContentHandlers"),MainThreadWorkspace:F("MainThreadWorkspace"),MainThreadFileSystem:F("MainThreadFileSystem"),MainThreadFileSystemEventService:F("MainThreadFileSystemEventService"),MainThreadExtensionService:F("MainThreadExtensionService"),MainThreadSCM:F("MainThreadSCM"),MainThreadSearch:F("MainThreadSearch"),MainThreadShare:F("MainThreadShare"),MainThreadTask:F("MainThreadTask"),MainThreadWindow:F("MainThreadWindow"),MainThreadLabelService:F("MainThreadLabelService"),MainThreadNotebook:F("MainThreadNotebook"),MainThreadNotebookDocuments:F("MainThreadNotebookDocumentsShape"),MainThreadNotebookEditors:F("MainThreadNotebookEditorsShape"),MainThreadNotebookKernels:F("MainThreadNotebookKernels"),MainThreadNotebookRenderers:F("MainThreadNotebookRenderers"),MainThreadInteractive:F("MainThreadInteractive"),MainThreadInlineChat:F("MainThreadInlineChatShape"),MainThreadTheming:F("MainThreadTheming"),MainThreadTunnelService:F("MainThreadTunnelService"),MainThreadManagedSockets:F("MainThreadManagedSockets"),MainThreadTimeline:F("MainThreadTimeline"),MainThreadTesting:F("MainThreadTesting"),MainThreadLocalization:F("MainThreadLocalizationShape"),MainThreadAiRelatedInformation:F("MainThreadAiRelatedInformation"),MainThreadAiEmbeddingVector:F("MainThreadAiEmbeddingVector")},se={ExtHostCommands:F("ExtHostCommands"),ExtHostConfiguration:F("ExtHostConfiguration"),ExtHostDiagnostics:F("ExtHostDiagnostics"),ExtHostDebugService:F("ExtHostDebugService"),ExtHostDecorations:F("ExtHostDecorations"),ExtHostDocumentsAndEditors:F("ExtHostDocumentsAndEditors"),ExtHostDocuments:F("ExtHostDocuments"),ExtHostDocumentContentProviders:F("ExtHostDocumentContentProviders"),ExtHostDocumentSaveParticipant:F("ExtHostDocumentSaveParticipant"),ExtHostEditors:F("ExtHostEditors"),ExtHostTreeViews:F("ExtHostTreeViews"),ExtHostFileSystem:F("ExtHostFileSystem"),ExtHostFileSystemInfo:F("ExtHostFileSystemInfo"),ExtHostFileSystemEventService:F("ExtHostFileSystemEventService"),ExtHostLanguages:F("ExtHostLanguages"),ExtHostLanguageFeatures:F("ExtHostLanguageFeatures"),ExtHostQuickOpen:F("ExtHostQuickOpen"),ExtHostQuickDiff:F("ExtHostQuickDiff"),ExtHostStatusBar:F("ExtHostStatusBar"),ExtHostShare:F("ExtHostShare"),ExtHostExtensionService:F("ExtHostExtensionService"),ExtHostLogLevelServiceShape:F("ExtHostLogLevelServiceShape"),ExtHostTerminalService:F("ExtHostTerminalService"),ExtHostTerminalShellIntegration:F("ExtHostTerminalShellIntegration"),ExtHostSCM:F("ExtHostSCM"),ExtHostSearch:F("ExtHostSearch"),ExtHostTask:F("ExtHostTask"),ExtHostWorkspace:F("ExtHostWorkspace"),ExtHostWindow:F("ExtHostWindow"),ExtHostWebviews:F("ExtHostWebviews"),ExtHostWebviewPanels:F("ExtHostWebviewPanels"),ExtHostCustomEditors:F("ExtHostCustomEditors"),ExtHostWebviewViews:F("ExtHostWebviewViews"),ExtHostEditorInsets:F("ExtHostEditorInsets"),ExtHostEditorTabs:F("ExtHostEditorTabs"),ExtHostProgress:F("ExtHostProgress"),ExtHostComments:F("ExtHostComments"),ExtHostSecretState:F("ExtHostSecretState"),ExtHostStorage:F("ExtHostStorage"),ExtHostUrls:F("ExtHostUrls"),ExtHostUriOpeners:F("ExtHostUriOpeners"),ExtHostProfileContentHandlers:F("ExtHostProfileContentHandlers"),ExtHostOutputService:F("ExtHostOutputService"),ExtHostLabelService:F("ExtHostLabelService"),ExtHostNotebook:F("ExtHostNotebook"),ExtHostNotebookDocuments:F("ExtHostNotebookDocuments"),ExtHostNotebookEditors:F("ExtHostNotebookEditors"),ExtHostNotebookKernels:F("ExtHostNotebookKernels"),ExtHostNotebookRenderers:F("ExtHostNotebookRenderers"),ExtHostNotebookDocumentSaveParticipant:F("ExtHostNotebookDocumentSaveParticipant"),ExtHostInteractive:F("ExtHostInteractive"),ExtHostInlineChat:F("ExtHostInlineChatShape"),ExtHostChatAgents2:F("ExtHostChatAgents"),ExtHostChatVariables:F("ExtHostChatVariables"),ExtHostChatProvider:F("ExtHostChatProvider"),ExtHostSpeech:F("ExtHostSpeech"),ExtHostAiRelatedInformation:F("ExtHostAiRelatedInformation"),ExtHostAiEmbeddingVector:F("ExtHostAiEmbeddingVector"),ExtHostTheming:F("ExtHostTheming"),ExtHostTunnelService:F("ExtHostTunnelService"),ExtHostManagedSockets:F("ExtHostManagedSockets"),ExtHostAuthentication:F("ExtHostAuthentication"),ExtHostTimeline:F("ExtHostTimeline"),ExtHostTesting:F("ExtHostTesting"),ExtHostTelemetry:F("ExtHostTelemetry"),ExtHostLocalization:F("ExtHostLocalization")},Ix=Object.freeze(function(r,e){const t=setTimeout(r.bind(e),0);return{dispose(){clearTimeout(t)}}});var bt;(function(r){function e(t){return t===r.None||t===r.Cancelled||t instanceof Gd?!0:!t||typeof t!="object"?!1:typeof t.isCancellationRequested=="boolean"&&typeof t.onCancellationRequested=="function"}r.isCancellationToken=e,r.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:It.None}),r.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:Ix})})(bt||(bt={}));class Gd{constructor(){this._isCancelled=!1,this._emitter=null}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?Ix:(this._emitter||(this._emitter=new R),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=null)}}class Tt{constructor(e){this._token=void 0,this._parentListener=void 0,this._parentListener=e&&e.onCancellationRequested(this.cancel,this)}get token(){return this._token||(this._token=new Gd),this._token}cancel(){this._token?this._token instanceof Gd&&this._token.cancel():this._token=bt.Cancelled}dispose(e=!1){var t;e&&this.cancel(),(t=this._parentListener)==null||t.dispose(),this._token?this._token instanceof Gd&&this._token.dispose():this._token=bt.None}}function sE(r){return r}class oE{constructor(e,t){this.lastCache=void 0,this.lastArgKey=void 0,typeof e=="function"?(this._fn=e,this._computeKey=sE):(this._fn=t,this._computeKey=e.getCacheKey)}get(e){const t=this._computeKey(e);return this.lastArgKey!==t&&(this.lastArgKey=t,this.lastCache=this._fn(e)),this.lastCache}}function gh(r){return!r||typeof r!="string"?!0:r.trim().length===0}const aE=/{([^}]+)}/g;function $0(r,e){return Object.keys(e).length===0?r:r.replace(aE,(t,i)=>e[i]??t)}function Fa(r){return r.replace(/[\\\{\}\*\+\?\|\^\$\.\[\]\(\)]/g,"\\$&")}function cE(r,e){let t=0;const i=e.charCodeAt(0);for(let n=r.length-1;n>=0;n--)r.charCodeAt(n)===i&&t++;return t}function lE(r,e){if(!r||!e)return r;const t=e.length;if(t===0||r.length===0)return r;let i=0;for(;r.indexOf(e,i)===i;)i=i+t;return r.substring(i)}function N0(r,e){if(!r||!e)return r;const t=e.length,i=r.length;if(t===0||i===0)return r;let n=i,s=-1;for(;s=r.lastIndexOf(e,n-1),!(s===-1||s+t!==n);){if(s===0)return"";n=s}return r.substring(0,n)}function uE(r,e,t={}){if(!r)throw new Error("Cannot create regex from empty string");e||(r=Fa(r)),t.wholeWord&&(/\B/.test(r.charAt(0))||(r="\\b"+r),/\B/.test(r.charAt(r.length-1))||(r=r+"\\b"));let i="";return t.global&&(i+="g"),t.matchCase||(i+="i"),t.multiline&&(i+="m"),t.unicode&&(i+="u"),new RegExp(r,i)}function Px(r){return r.source==="^"||r.source==="^$"||r.source==="$"||r.source==="^\\s*$"?!1:!!(r.exec("")&&r.lastIndex===0)}function Tx(r){return r.split(/\r\n|\r|\n/)}function Bg(r){for(let e=0,t=r.length;e<t;e++){const i=r.charCodeAt(e);if(i!==32&&i!==9)return e}return-1}function dE(r,e=r.length-1){for(let t=e;t>=0;t--){const i=r.charCodeAt(t);if(i!==32&&i!==9)return t}return-1}function hE(r,e,t){const i=[];let n=0;for(const s of r.matchAll(e)){if(i.push(r.slice(n,s.index)),s.index===void 0)throw new Error("match.index should be defined");n=s.index+s[0].length,i.push(t(s[0],...s.slice(1),s.index,r,s.groups))}return i.push(r.slice(n)),Promise.all(i).then(s=>s.join(""))}function fo(r,e){return r<e?-1:r>e?1:0}function yw(r,e,t=0,i=r.length,n=0,s=e.length){for(;t<i&&n<s;t++,n++){const c=r.charCodeAt(t),l=e.charCodeAt(n);if(c<l)return-1;if(c>l)return 1}const o=i-t,a=s-n;return o<a?-1:o>a?1:0}function M0(r,e){return ed(r,e,0,r.length,0,e.length)}function ed(r,e,t=0,i=r.length,n=0,s=e.length){for(;t<i&&n<s;t++,n++){let c=r.charCodeAt(t),l=e.charCodeAt(n);if(c===l)continue;if(c>=128||l>=128)return yw(r.toLowerCase(),e.toLowerCase(),t,i,n,s);F0(c)&&(c-=32),F0(l)&&(l-=32);const u=c-l;if(u!==0)return u}const o=i-t,a=s-n;return o<a?-1:o>a?1:0}function F0(r){return r>=97&&r<=122}function Rr(r,e){return r.length===e.length&&ed(r,e)===0}function xw(r,e){const t=e.length;return e.length>r.length?!1:ed(r,e,0,t)===0}function fE(r,e){const t=Math.min(r.length,e.length);let i;for(i=0;i<t;i++)if(r.charCodeAt(i)!==e.charCodeAt(i))return i;return t}function Gp(r){return 55296<=r&&r<=56319}function mh(r){return 56320<=r&&r<=57343}function Cw(r,e){return(r-55296<<10)+(e-56320)+65536}function Ax(r,e,t){const i=r.charCodeAt(t);if(Gp(i)&&t+1<e){const n=r.charCodeAt(t+1);if(mh(n))return Cw(i,n)}return i}function pE(r,e){const t=r.charCodeAt(e-1);if(mh(t)&&e>1){const i=r.charCodeAt(e-2);if(Gp(i))return Cw(i,t)}return t}class gE{get offset(){return this._offset}constructor(e,t=0){this._str=e,this._len=e.length,this._offset=t}setOffset(e){this._offset=e}prevCodePoint(){const e=pE(this._str,this._offset);return this._offset-=e>=65536?2:1,e}nextCodePoint(){const e=Ax(this._str,this._len,this._offset);return this._offset+=e>=65536?2:1,e}eol(){return this._offset>=this._len}}class mE{get offset(){return this._iterator.offset}constructor(e,t=0){this._iterator=new gE(e,t)}nextGraphemeLength(){const e=vh.getInstance(),t=this._iterator,i=t.offset;let n=e.getGraphemeBreakType(t.nextCodePoint());for(;!t.eol();){const s=t.offset,o=e.getGraphemeBreakType(t.nextCodePoint());if(U0(n,o)){t.setOffset(s);break}n=o}return t.offset-i}prevGraphemeLength(){const e=vh.getInstance(),t=this._iterator,i=t.offset;let n=e.getGraphemeBreakType(t.prevCodePoint());for(;t.offset>0;){const s=t.offset,o=e.getGraphemeBreakType(t.prevCodePoint());if(U0(o,n)){t.setOffset(s);break}n=o}return i-t.offset}eol(){return this._iterator.eol()}}function O0(r,e){return new mE(r,e).nextGraphemeLength()}let Vg;function vE(){return/(?:[\u05BE\u05C0\u05C3\u05C6\u05D0-\u05F4\u0608\u060B\u060D\u061B-\u064A\u066D-\u066F\u0671-\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u0710\u0712-\u072F\u074D-\u07A5\u07B1-\u07EA\u07F4\u07F5\u07FA\u07FE-\u0815\u081A\u0824\u0828\u0830-\u0858\u085E-\u088E\u08A0-\u08C9\u200F\uFB1D\uFB1F-\uFB28\uFB2A-\uFD3D\uFD50-\uFDC7\uFDF0-\uFDFC\uFE70-\uFEFC]|\uD802[\uDC00-\uDD1B\uDD20-\uDE00\uDE10-\uDE35\uDE40-\uDEE4\uDEEB-\uDF35\uDF40-\uDFFF]|\uD803[\uDC00-\uDD23\uDE80-\uDEA9\uDEAD-\uDF45\uDF51-\uDF81\uDF86-\uDFF6]|\uD83A[\uDC00-\uDCCF\uDD00-\uDD43\uDD4B-\uDFFF]|\uD83B[\uDC00-\uDEBB])/}function Rx(r){return Vg||(Vg=vE()),Vg.test(r)}const _E=/^[\t\n\r\x20-\x7E]*$/;function wE(r){return _E.test(r)}const bE=/[\u2028\u2029]/;function Lx(r){return bE.test(r)}const yE="\uFEFF";function xE(r){return!!(r&&r.length>0&&r.charCodeAt(0)===65279)}function H0(r,e=!1){return r?(e&&(r=r.replace(/\\./g,"")),r.toLowerCase()!==r):!1}function CE(r,e=1){if(e===0)return"";let t=-1;do t=r.indexOf(`
`,t+1),e--;while(e>0&&t>=0);return t===-1?r:(r[t-1]==="\r"&&t--,r.substr(0,t))}function U0(r,e){return r===0?e!==5&&e!==7:r===2&&e===3?!1:r===4||r===2||r===3||e===4||e===2||e===3?!0:!(r===8&&(e===8||e===9||e===11||e===12)||(r===11||r===9)&&(e===9||e===10)||(r===12||r===10)&&e===10||e===5||e===13||e===7||r===1||r===13&&e===14||r===6&&e===6)}const ws=class ws{static getInstance(){return ws._INSTANCE||(ws._INSTANCE=new ws),ws._INSTANCE}constructor(){this._data=SE()}getGraphemeBreakType(e){if(e<32)return e===10?3:e===13?2:4;if(e<127)return 0;const t=this._data,i=t.length/3;let n=1;for(;n<=i;)if(e<t[3*n])n=2*n;else if(e>t[3*n+1])n=2*n+1;else return t[3*n+2];return 0}};ws._INSTANCE=null;let vh=ws;function SE(){return JSON.parse("[0,0,0,51229,51255,12,44061,44087,12,127462,127487,6,7083,7085,5,47645,47671,12,54813,54839,12,128678,128678,14,3270,3270,5,9919,9923,14,45853,45879,12,49437,49463,12,53021,53047,12,71216,71218,7,128398,128399,14,129360,129374,14,2519,2519,5,4448,4519,9,9742,9742,14,12336,12336,14,44957,44983,12,46749,46775,12,48541,48567,12,50333,50359,12,52125,52151,12,53917,53943,12,69888,69890,5,73018,73018,5,127990,127990,14,128558,128559,14,128759,128760,14,129653,129655,14,2027,2035,5,2891,2892,7,3761,3761,5,6683,6683,5,8293,8293,4,9825,9826,14,9999,9999,14,43452,43453,5,44509,44535,12,45405,45431,12,46301,46327,12,47197,47223,12,48093,48119,12,48989,49015,12,49885,49911,12,50781,50807,12,51677,51703,12,52573,52599,12,53469,53495,12,54365,54391,12,65279,65279,4,70471,70472,7,72145,72147,7,119173,119179,5,127799,127818,14,128240,128244,14,128512,128512,14,128652,128652,14,128721,128722,14,129292,129292,14,129445,129450,14,129734,129743,14,1476,1477,5,2366,2368,7,2750,2752,7,3076,3076,5,3415,3415,5,4141,4144,5,6109,6109,5,6964,6964,5,7394,7400,5,9197,9198,14,9770,9770,14,9877,9877,14,9968,9969,14,10084,10084,14,43052,43052,5,43713,43713,5,44285,44311,12,44733,44759,12,45181,45207,12,45629,45655,12,46077,46103,12,46525,46551,12,46973,46999,12,47421,47447,12,47869,47895,12,48317,48343,12,48765,48791,12,49213,49239,12,49661,49687,12,50109,50135,12,50557,50583,12,51005,51031,12,51453,51479,12,51901,51927,12,52349,52375,12,52797,52823,12,53245,53271,12,53693,53719,12,54141,54167,12,54589,54615,12,55037,55063,12,69506,69509,5,70191,70193,5,70841,70841,7,71463,71467,5,72330,72342,5,94031,94031,5,123628,123631,5,127763,127765,14,127941,127941,14,128043,128062,14,128302,128317,14,128465,128467,14,128539,128539,14,128640,128640,14,128662,128662,14,128703,128703,14,128745,128745,14,129004,129007,14,129329,129330,14,129402,129402,14,129483,129483,14,129686,129704,14,130048,131069,14,173,173,4,1757,1757,1,2200,2207,5,2434,2435,7,2631,2632,5,2817,2817,5,3008,3008,5,3201,3201,5,3387,3388,5,3542,3542,5,3902,3903,7,4190,4192,5,6002,6003,5,6439,6440,5,6765,6770,7,7019,7027,5,7154,7155,7,8205,8205,13,8505,8505,14,9654,9654,14,9757,9757,14,9792,9792,14,9852,9853,14,9890,9894,14,9937,9937,14,9981,9981,14,10035,10036,14,11035,11036,14,42654,42655,5,43346,43347,7,43587,43587,5,44006,44007,7,44173,44199,12,44397,44423,12,44621,44647,12,44845,44871,12,45069,45095,12,45293,45319,12,45517,45543,12,45741,45767,12,45965,45991,12,46189,46215,12,46413,46439,12,46637,46663,12,46861,46887,12,47085,47111,12,47309,47335,12,47533,47559,12,47757,47783,12,47981,48007,12,48205,48231,12,48429,48455,12,48653,48679,12,48877,48903,12,49101,49127,12,49325,49351,12,49549,49575,12,49773,49799,12,49997,50023,12,50221,50247,12,50445,50471,12,50669,50695,12,50893,50919,12,51117,51143,12,51341,51367,12,51565,51591,12,51789,51815,12,52013,52039,12,52237,52263,12,52461,52487,12,52685,52711,12,52909,52935,12,53133,53159,12,53357,53383,12,53581,53607,12,53805,53831,12,54029,54055,12,54253,54279,12,54477,54503,12,54701,54727,12,54925,54951,12,55149,55175,12,68101,68102,5,69762,69762,7,70067,70069,7,70371,70378,5,70720,70721,7,71087,71087,5,71341,71341,5,71995,71996,5,72249,72249,7,72850,72871,5,73109,73109,5,118576,118598,5,121505,121519,5,127245,127247,14,127568,127569,14,127777,127777,14,127872,127891,14,127956,127967,14,128015,128016,14,128110,128172,14,128259,128259,14,128367,128368,14,128424,128424,14,128488,128488,14,128530,128532,14,128550,128551,14,128566,128566,14,128647,128647,14,128656,128656,14,128667,128673,14,128691,128693,14,128715,128715,14,128728,128732,14,128752,128752,14,128765,128767,14,129096,129103,14,129311,129311,14,129344,129349,14,129394,129394,14,129413,129425,14,129466,129471,14,129511,129535,14,129664,129666,14,129719,129722,14,129760,129767,14,917536,917631,5,13,13,2,1160,1161,5,1564,1564,4,1807,1807,1,2085,2087,5,2307,2307,7,2382,2383,7,2497,2500,5,2563,2563,7,2677,2677,5,2763,2764,7,2879,2879,5,2914,2915,5,3021,3021,5,3142,3144,5,3263,3263,5,3285,3286,5,3398,3400,7,3530,3530,5,3633,3633,5,3864,3865,5,3974,3975,5,4155,4156,7,4229,4230,5,5909,5909,7,6078,6085,7,6277,6278,5,6451,6456,7,6744,6750,5,6846,6846,5,6972,6972,5,7074,7077,5,7146,7148,7,7222,7223,5,7416,7417,5,8234,8238,4,8417,8417,5,9000,9000,14,9203,9203,14,9730,9731,14,9748,9749,14,9762,9763,14,9776,9783,14,9800,9811,14,9831,9831,14,9872,9873,14,9882,9882,14,9900,9903,14,9929,9933,14,9941,9960,14,9974,9974,14,9989,9989,14,10006,10006,14,10062,10062,14,10160,10160,14,11647,11647,5,12953,12953,14,43019,43019,5,43232,43249,5,43443,43443,5,43567,43568,7,43696,43696,5,43765,43765,7,44013,44013,5,44117,44143,12,44229,44255,12,44341,44367,12,44453,44479,12,44565,44591,12,44677,44703,12,44789,44815,12,44901,44927,12,45013,45039,12,45125,45151,12,45237,45263,12,45349,45375,12,45461,45487,12,45573,45599,12,45685,45711,12,45797,45823,12,45909,45935,12,46021,46047,12,46133,46159,12,46245,46271,12,46357,46383,12,46469,46495,12,46581,46607,12,46693,46719,12,46805,46831,12,46917,46943,12,47029,47055,12,47141,47167,12,47253,47279,12,47365,47391,12,47477,47503,12,47589,47615,12,47701,47727,12,47813,47839,12,47925,47951,12,48037,48063,12,48149,48175,12,48261,48287,12,48373,48399,12,48485,48511,12,48597,48623,12,48709,48735,12,48821,48847,12,48933,48959,12,49045,49071,12,49157,49183,12,49269,49295,12,49381,49407,12,49493,49519,12,49605,49631,12,49717,49743,12,49829,49855,12,49941,49967,12,50053,50079,12,50165,50191,12,50277,50303,12,50389,50415,12,50501,50527,12,50613,50639,12,50725,50751,12,50837,50863,12,50949,50975,12,51061,51087,12,51173,51199,12,51285,51311,12,51397,51423,12,51509,51535,12,51621,51647,12,51733,51759,12,51845,51871,12,51957,51983,12,52069,52095,12,52181,52207,12,52293,52319,12,52405,52431,12,52517,52543,12,52629,52655,12,52741,52767,12,52853,52879,12,52965,52991,12,53077,53103,12,53189,53215,12,53301,53327,12,53413,53439,12,53525,53551,12,53637,53663,12,53749,53775,12,53861,53887,12,53973,53999,12,54085,54111,12,54197,54223,12,54309,54335,12,54421,54447,12,54533,54559,12,54645,54671,12,54757,54783,12,54869,54895,12,54981,55007,12,55093,55119,12,55243,55291,10,66045,66045,5,68325,68326,5,69688,69702,5,69817,69818,5,69957,69958,7,70089,70092,5,70198,70199,5,70462,70462,5,70502,70508,5,70750,70750,5,70846,70846,7,71100,71101,5,71230,71230,7,71351,71351,5,71737,71738,5,72000,72000,7,72160,72160,5,72273,72278,5,72752,72758,5,72882,72883,5,73031,73031,5,73461,73462,7,94192,94193,7,119149,119149,7,121403,121452,5,122915,122916,5,126980,126980,14,127358,127359,14,127535,127535,14,127759,127759,14,127771,127771,14,127792,127793,14,127825,127867,14,127897,127899,14,127945,127945,14,127985,127986,14,128000,128007,14,128021,128021,14,128066,128100,14,128184,128235,14,128249,128252,14,128266,128276,14,128335,128335,14,128379,128390,14,128407,128419,14,128444,128444,14,128481,128481,14,128499,128499,14,128526,128526,14,128536,128536,14,128543,128543,14,128556,128556,14,128564,128564,14,128577,128580,14,128643,128645,14,128649,128649,14,128654,128654,14,128660,128660,14,128664,128664,14,128675,128675,14,128686,128689,14,128695,128696,14,128705,128709,14,128717,128719,14,128725,128725,14,128736,128741,14,128747,128748,14,128755,128755,14,128762,128762,14,128981,128991,14,129009,129023,14,129160,129167,14,129296,129304,14,129320,129327,14,129340,129342,14,129356,129356,14,129388,129392,14,129399,129400,14,129404,129407,14,129432,129442,14,129454,129455,14,129473,129474,14,129485,129487,14,129648,129651,14,129659,129660,14,129671,129679,14,129709,129711,14,129728,129730,14,129751,129753,14,129776,129782,14,917505,917505,4,917760,917999,5,10,10,3,127,159,4,768,879,5,1471,1471,5,1536,1541,1,1648,1648,5,1767,1768,5,1840,1866,5,2070,2073,5,2137,2139,5,2274,2274,1,2363,2363,7,2377,2380,7,2402,2403,5,2494,2494,5,2507,2508,7,2558,2558,5,2622,2624,7,2641,2641,5,2691,2691,7,2759,2760,5,2786,2787,5,2876,2876,5,2881,2884,5,2901,2902,5,3006,3006,5,3014,3016,7,3072,3072,5,3134,3136,5,3157,3158,5,3260,3260,5,3266,3266,5,3274,3275,7,3328,3329,5,3391,3392,7,3405,3405,5,3457,3457,5,3536,3537,7,3551,3551,5,3636,3642,5,3764,3772,5,3895,3895,5,3967,3967,7,3993,4028,5,4146,4151,5,4182,4183,7,4226,4226,5,4253,4253,5,4957,4959,5,5940,5940,7,6070,6070,7,6087,6088,7,6158,6158,4,6432,6434,5,6448,6449,7,6679,6680,5,6742,6742,5,6754,6754,5,6783,6783,5,6912,6915,5,6966,6970,5,6978,6978,5,7042,7042,7,7080,7081,5,7143,7143,7,7150,7150,7,7212,7219,5,7380,7392,5,7412,7412,5,8203,8203,4,8232,8232,4,8265,8265,14,8400,8412,5,8421,8432,5,8617,8618,14,9167,9167,14,9200,9200,14,9410,9410,14,9723,9726,14,9733,9733,14,9745,9745,14,9752,9752,14,9760,9760,14,9766,9766,14,9774,9774,14,9786,9786,14,9794,9794,14,9823,9823,14,9828,9828,14,9833,9850,14,9855,9855,14,9875,9875,14,9880,9880,14,9885,9887,14,9896,9897,14,9906,9916,14,9926,9927,14,9935,9935,14,9939,9939,14,9962,9962,14,9972,9972,14,9978,9978,14,9986,9986,14,9997,9997,14,10002,10002,14,10017,10017,14,10055,10055,14,10071,10071,14,10133,10135,14,10548,10549,14,11093,11093,14,12330,12333,5,12441,12442,5,42608,42610,5,43010,43010,5,43045,43046,5,43188,43203,7,43302,43309,5,43392,43394,5,43446,43449,5,43493,43493,5,43571,43572,7,43597,43597,7,43703,43704,5,43756,43757,5,44003,44004,7,44009,44010,7,44033,44059,12,44089,44115,12,44145,44171,12,44201,44227,12,44257,44283,12,44313,44339,12,44369,44395,12,44425,44451,12,44481,44507,12,44537,44563,12,44593,44619,12,44649,44675,12,44705,44731,12,44761,44787,12,44817,44843,12,44873,44899,12,44929,44955,12,44985,45011,12,45041,45067,12,45097,45123,12,45153,45179,12,45209,45235,12,45265,45291,12,45321,45347,12,45377,45403,12,45433,45459,12,45489,45515,12,45545,45571,12,45601,45627,12,45657,45683,12,45713,45739,12,45769,45795,12,45825,45851,12,45881,45907,12,45937,45963,12,45993,46019,12,46049,46075,12,46105,46131,12,46161,46187,12,46217,46243,12,46273,46299,12,46329,46355,12,46385,46411,12,46441,46467,12,46497,46523,12,46553,46579,12,46609,46635,12,46665,46691,12,46721,46747,12,46777,46803,12,46833,46859,12,46889,46915,12,46945,46971,12,47001,47027,12,47057,47083,12,47113,47139,12,47169,47195,12,47225,47251,12,47281,47307,12,47337,47363,12,47393,47419,12,47449,47475,12,47505,47531,12,47561,47587,12,47617,47643,12,47673,47699,12,47729,47755,12,47785,47811,12,47841,47867,12,47897,47923,12,47953,47979,12,48009,48035,12,48065,48091,12,48121,48147,12,48177,48203,12,48233,48259,12,48289,48315,12,48345,48371,12,48401,48427,12,48457,48483,12,48513,48539,12,48569,48595,12,48625,48651,12,48681,48707,12,48737,48763,12,48793,48819,12,48849,48875,12,48905,48931,12,48961,48987,12,49017,49043,12,49073,49099,12,49129,49155,12,49185,49211,12,49241,49267,12,49297,49323,12,49353,49379,12,49409,49435,12,49465,49491,12,49521,49547,12,49577,49603,12,49633,49659,12,49689,49715,12,49745,49771,12,49801,49827,12,49857,49883,12,49913,49939,12,49969,49995,12,50025,50051,12,50081,50107,12,50137,50163,12,50193,50219,12,50249,50275,12,50305,50331,12,50361,50387,12,50417,50443,12,50473,50499,12,50529,50555,12,50585,50611,12,50641,50667,12,50697,50723,12,50753,50779,12,50809,50835,12,50865,50891,12,50921,50947,12,50977,51003,12,51033,51059,12,51089,51115,12,51145,51171,12,51201,51227,12,51257,51283,12,51313,51339,12,51369,51395,12,51425,51451,12,51481,51507,12,51537,51563,12,51593,51619,12,51649,51675,12,51705,51731,12,51761,51787,12,51817,51843,12,51873,51899,12,51929,51955,12,51985,52011,12,52041,52067,12,52097,52123,12,52153,52179,12,52209,52235,12,52265,52291,12,52321,52347,12,52377,52403,12,52433,52459,12,52489,52515,12,52545,52571,12,52601,52627,12,52657,52683,12,52713,52739,12,52769,52795,12,52825,52851,12,52881,52907,12,52937,52963,12,52993,53019,12,53049,53075,12,53105,53131,12,53161,53187,12,53217,53243,12,53273,53299,12,53329,53355,12,53385,53411,12,53441,53467,12,53497,53523,12,53553,53579,12,53609,53635,12,53665,53691,12,53721,53747,12,53777,53803,12,53833,53859,12,53889,53915,12,53945,53971,12,54001,54027,12,54057,54083,12,54113,54139,12,54169,54195,12,54225,54251,12,54281,54307,12,54337,54363,12,54393,54419,12,54449,54475,12,54505,54531,12,54561,54587,12,54617,54643,12,54673,54699,12,54729,54755,12,54785,54811,12,54841,54867,12,54897,54923,12,54953,54979,12,55009,55035,12,55065,55091,12,55121,55147,12,55177,55203,12,65024,65039,5,65520,65528,4,66422,66426,5,68152,68154,5,69291,69292,5,69633,69633,5,69747,69748,5,69811,69814,5,69826,69826,5,69932,69932,7,70016,70017,5,70079,70080,7,70095,70095,5,70196,70196,5,70367,70367,5,70402,70403,7,70464,70464,5,70487,70487,5,70709,70711,7,70725,70725,7,70833,70834,7,70843,70844,7,70849,70849,7,71090,71093,5,71103,71104,5,71227,71228,7,71339,71339,5,71344,71349,5,71458,71461,5,71727,71735,5,71985,71989,7,71998,71998,5,72002,72002,7,72154,72155,5,72193,72202,5,72251,72254,5,72281,72283,5,72344,72345,5,72766,72766,7,72874,72880,5,72885,72886,5,73023,73029,5,73104,73105,5,73111,73111,5,92912,92916,5,94095,94098,5,113824,113827,4,119142,119142,7,119155,119162,4,119362,119364,5,121476,121476,5,122888,122904,5,123184,123190,5,125252,125258,5,127183,127183,14,127340,127343,14,127377,127386,14,127491,127503,14,127548,127551,14,127744,127756,14,127761,127761,14,127769,127769,14,127773,127774,14,127780,127788,14,127796,127797,14,127820,127823,14,127869,127869,14,127894,127895,14,127902,127903,14,127943,127943,14,127947,127950,14,127972,127972,14,127988,127988,14,127992,127994,14,128009,128011,14,128019,128019,14,128023,128041,14,128064,128064,14,128102,128107,14,128174,128181,14,128238,128238,14,128246,128247,14,128254,128254,14,128264,128264,14,128278,128299,14,128329,128330,14,128348,128359,14,128371,128377,14,128392,128393,14,128401,128404,14,128421,128421,14,128433,128434,14,128450,128452,14,128476,128478,14,128483,128483,14,128495,128495,14,128506,128506,14,128519,128520,14,128528,128528,14,128534,128534,14,128538,128538,14,128540,128542,14,128544,128549,14,128552,128555,14,128557,128557,14,128560,128563,14,128565,128565,14,128567,128576,14,128581,128591,14,128641,128642,14,128646,128646,14,128648,128648,14,128650,128651,14,128653,128653,14,128655,128655,14,128657,128659,14,128661,128661,14,128663,128663,14,128665,128666,14,128674,128674,14,128676,128677,14,128679,128685,14,128690,128690,14,128694,128694,14,128697,128702,14,128704,128704,14,128710,128714,14,128716,128716,14,128720,128720,14,128723,128724,14,128726,128727,14,128733,128735,14,128742,128744,14,128746,128746,14,128749,128751,14,128753,128754,14,128756,128758,14,128761,128761,14,128763,128764,14,128884,128895,14,128992,129003,14,129008,129008,14,129036,129039,14,129114,129119,14,129198,129279,14,129293,129295,14,129305,129310,14,129312,129319,14,129328,129328,14,129331,129338,14,129343,129343,14,129351,129355,14,129357,129359,14,129375,129387,14,129393,129393,14,129395,129398,14,129401,129401,14,129403,129403,14,129408,129412,14,129426,129431,14,129443,129444,14,129451,129453,14,129456,129465,14,129472,129472,14,129475,129482,14,129484,129484,14,129488,129510,14,129536,129647,14,129652,129652,14,129656,129658,14,129661,129663,14,129667,129670,14,129680,129685,14,129705,129708,14,129712,129718,14,129723,129727,14,129731,129733,14,129744,129750,14,129754,129759,14,129768,129775,14,129783,129791,14,917504,917504,4,917506,917535,4,917632,917759,4,918000,921599,4,0,9,4,11,12,4,14,31,4,169,169,14,174,174,14,1155,1159,5,1425,1469,5,1473,1474,5,1479,1479,5,1552,1562,5,1611,1631,5,1750,1756,5,1759,1764,5,1770,1773,5,1809,1809,5,1958,1968,5,2045,2045,5,2075,2083,5,2089,2093,5,2192,2193,1,2250,2273,5,2275,2306,5,2362,2362,5,2364,2364,5,2369,2376,5,2381,2381,5,2385,2391,5,2433,2433,5,2492,2492,5,2495,2496,7,2503,2504,7,2509,2509,5,2530,2531,5,2561,2562,5,2620,2620,5,2625,2626,5,2635,2637,5,2672,2673,5,2689,2690,5,2748,2748,5,2753,2757,5,2761,2761,7,2765,2765,5,2810,2815,5,2818,2819,7,2878,2878,5,2880,2880,7,2887,2888,7,2893,2893,5,2903,2903,5,2946,2946,5,3007,3007,7,3009,3010,7,3018,3020,7,3031,3031,5,3073,3075,7,3132,3132,5,3137,3140,7,3146,3149,5,3170,3171,5,3202,3203,7,3262,3262,7,3264,3265,7,3267,3268,7,3271,3272,7,3276,3277,5,3298,3299,5,3330,3331,7,3390,3390,5,3393,3396,5,3402,3404,7,3406,3406,1,3426,3427,5,3458,3459,7,3535,3535,5,3538,3540,5,3544,3550,7,3570,3571,7,3635,3635,7,3655,3662,5,3763,3763,7,3784,3789,5,3893,3893,5,3897,3897,5,3953,3966,5,3968,3972,5,3981,3991,5,4038,4038,5,4145,4145,7,4153,4154,5,4157,4158,5,4184,4185,5,4209,4212,5,4228,4228,7,4237,4237,5,4352,4447,8,4520,4607,10,5906,5908,5,5938,5939,5,5970,5971,5,6068,6069,5,6071,6077,5,6086,6086,5,6089,6099,5,6155,6157,5,6159,6159,5,6313,6313,5,6435,6438,7,6441,6443,7,6450,6450,5,6457,6459,5,6681,6682,7,6741,6741,7,6743,6743,7,6752,6752,5,6757,6764,5,6771,6780,5,6832,6845,5,6847,6862,5,6916,6916,7,6965,6965,5,6971,6971,7,6973,6977,7,6979,6980,7,7040,7041,5,7073,7073,7,7078,7079,7,7082,7082,7,7142,7142,5,7144,7145,5,7149,7149,5,7151,7153,5,7204,7211,7,7220,7221,7,7376,7378,5,7393,7393,7,7405,7405,5,7415,7415,7,7616,7679,5,8204,8204,5,8206,8207,4,8233,8233,4,8252,8252,14,8288,8292,4,8294,8303,4,8413,8416,5,8418,8420,5,8482,8482,14,8596,8601,14,8986,8987,14,9096,9096,14,9193,9196,14,9199,9199,14,9201,9202,14,9208,9210,14,9642,9643,14,9664,9664,14,9728,9729,14,9732,9732,14,9735,9741,14,9743,9744,14,9746,9746,14,9750,9751,14,9753,9756,14,9758,9759,14,9761,9761,14,9764,9765,14,9767,9769,14,9771,9773,14,9775,9775,14,9784,9785,14,9787,9791,14,9793,9793,14,9795,9799,14,9812,9822,14,9824,9824,14,9827,9827,14,9829,9830,14,9832,9832,14,9851,9851,14,9854,9854,14,9856,9861,14,9874,9874,14,9876,9876,14,9878,9879,14,9881,9881,14,9883,9884,14,9888,9889,14,9895,9895,14,9898,9899,14,9904,9905,14,9917,9918,14,9924,9925,14,9928,9928,14,9934,9934,14,9936,9936,14,9938,9938,14,9940,9940,14,9961,9961,14,9963,9967,14,9970,9971,14,9973,9973,14,9975,9977,14,9979,9980,14,9982,9985,14,9987,9988,14,9992,9996,14,9998,9998,14,10000,10001,14,10004,10004,14,10013,10013,14,10024,10024,14,10052,10052,14,10060,10060,14,10067,10069,14,10083,10083,14,10085,10087,14,10145,10145,14,10175,10175,14,11013,11015,14,11088,11088,14,11503,11505,5,11744,11775,5,12334,12335,5,12349,12349,14,12951,12951,14,42607,42607,5,42612,42621,5,42736,42737,5,43014,43014,5,43043,43044,7,43047,43047,7,43136,43137,7,43204,43205,5,43263,43263,5,43335,43345,5,43360,43388,8,43395,43395,7,43444,43445,7,43450,43451,7,43454,43456,7,43561,43566,5,43569,43570,5,43573,43574,5,43596,43596,5,43644,43644,5,43698,43700,5,43710,43711,5,43755,43755,7,43758,43759,7,43766,43766,5,44005,44005,5,44008,44008,5,44012,44012,7,44032,44032,11,44060,44060,11,44088,44088,11,44116,44116,11,44144,44144,11,44172,44172,11,44200,44200,11,44228,44228,11,44256,44256,11,44284,44284,11,44312,44312,11,44340,44340,11,44368,44368,11,44396,44396,11,44424,44424,11,44452,44452,11,44480,44480,11,44508,44508,11,44536,44536,11,44564,44564,11,44592,44592,11,44620,44620,11,44648,44648,11,44676,44676,11,44704,44704,11,44732,44732,11,44760,44760,11,44788,44788,11,44816,44816,11,44844,44844,11,44872,44872,11,44900,44900,11,44928,44928,11,44956,44956,11,44984,44984,11,45012,45012,11,45040,45040,11,45068,45068,11,45096,45096,11,45124,45124,11,45152,45152,11,45180,45180,11,45208,45208,11,45236,45236,11,45264,45264,11,45292,45292,11,45320,45320,11,45348,45348,11,45376,45376,11,45404,45404,11,45432,45432,11,45460,45460,11,45488,45488,11,45516,45516,11,45544,45544,11,45572,45572,11,45600,45600,11,45628,45628,11,45656,45656,11,45684,45684,11,45712,45712,11,45740,45740,11,45768,45768,11,45796,45796,11,45824,45824,11,45852,45852,11,45880,45880,11,45908,45908,11,45936,45936,11,45964,45964,11,45992,45992,11,46020,46020,11,46048,46048,11,46076,46076,11,46104,46104,11,46132,46132,11,46160,46160,11,46188,46188,11,46216,46216,11,46244,46244,11,46272,46272,11,46300,46300,11,46328,46328,11,46356,46356,11,46384,46384,11,46412,46412,11,46440,46440,11,46468,46468,11,46496,46496,11,46524,46524,11,46552,46552,11,46580,46580,11,46608,46608,11,46636,46636,11,46664,46664,11,46692,46692,11,46720,46720,11,46748,46748,11,46776,46776,11,46804,46804,11,46832,46832,11,46860,46860,11,46888,46888,11,46916,46916,11,46944,46944,11,46972,46972,11,47000,47000,11,47028,47028,11,47056,47056,11,47084,47084,11,47112,47112,11,47140,47140,11,47168,47168,11,47196,47196,11,47224,47224,11,47252,47252,11,47280,47280,11,47308,47308,11,47336,47336,11,47364,47364,11,47392,47392,11,47420,47420,11,47448,47448,11,47476,47476,11,47504,47504,11,47532,47532,11,47560,47560,11,47588,47588,11,47616,47616,11,47644,47644,11,47672,47672,11,47700,47700,11,47728,47728,11,47756,47756,11,47784,47784,11,47812,47812,11,47840,47840,11,47868,47868,11,47896,47896,11,47924,47924,11,47952,47952,11,47980,47980,11,48008,48008,11,48036,48036,11,48064,48064,11,48092,48092,11,48120,48120,11,48148,48148,11,48176,48176,11,48204,48204,11,48232,48232,11,48260,48260,11,48288,48288,11,48316,48316,11,48344,48344,11,48372,48372,11,48400,48400,11,48428,48428,11,48456,48456,11,48484,48484,11,48512,48512,11,48540,48540,11,48568,48568,11,48596,48596,11,48624,48624,11,48652,48652,11,48680,48680,11,48708,48708,11,48736,48736,11,48764,48764,11,48792,48792,11,48820,48820,11,48848,48848,11,48876,48876,11,48904,48904,11,48932,48932,11,48960,48960,11,48988,48988,11,49016,49016,11,49044,49044,11,49072,49072,11,49100,49100,11,49128,49128,11,49156,49156,11,49184,49184,11,49212,49212,11,49240,49240,11,49268,49268,11,49296,49296,11,49324,49324,11,49352,49352,11,49380,49380,11,49408,49408,11,49436,49436,11,49464,49464,11,49492,49492,11,49520,49520,11,49548,49548,11,49576,49576,11,49604,49604,11,49632,49632,11,49660,49660,11,49688,49688,11,49716,49716,11,49744,49744,11,49772,49772,11,49800,49800,11,49828,49828,11,49856,49856,11,49884,49884,11,49912,49912,11,49940,49940,11,49968,49968,11,49996,49996,11,50024,50024,11,50052,50052,11,50080,50080,11,50108,50108,11,50136,50136,11,50164,50164,11,50192,50192,11,50220,50220,11,50248,50248,11,50276,50276,11,50304,50304,11,50332,50332,11,50360,50360,11,50388,50388,11,50416,50416,11,50444,50444,11,50472,50472,11,50500,50500,11,50528,50528,11,50556,50556,11,50584,50584,11,50612,50612,11,50640,50640,11,50668,50668,11,50696,50696,11,50724,50724,11,50752,50752,11,50780,50780,11,50808,50808,11,50836,50836,11,50864,50864,11,50892,50892,11,50920,50920,11,50948,50948,11,50976,50976,11,51004,51004,11,51032,51032,11,51060,51060,11,51088,51088,11,51116,51116,11,51144,51144,11,51172,51172,11,51200,51200,11,51228,51228,11,51256,51256,11,51284,51284,11,51312,51312,11,51340,51340,11,51368,51368,11,51396,51396,11,51424,51424,11,51452,51452,11,51480,51480,11,51508,51508,11,51536,51536,11,51564,51564,11,51592,51592,11,51620,51620,11,51648,51648,11,51676,51676,11,51704,51704,11,51732,51732,11,51760,51760,11,51788,51788,11,51816,51816,11,51844,51844,11,51872,51872,11,51900,51900,11,51928,51928,11,51956,51956,11,51984,51984,11,52012,52012,11,52040,52040,11,52068,52068,11,52096,52096,11,52124,52124,11,52152,52152,11,52180,52180,11,52208,52208,11,52236,52236,11,52264,52264,11,52292,52292,11,52320,52320,11,52348,52348,11,52376,52376,11,52404,52404,11,52432,52432,11,52460,52460,11,52488,52488,11,52516,52516,11,52544,52544,11,52572,52572,11,52600,52600,11,52628,52628,11,52656,52656,11,52684,52684,11,52712,52712,11,52740,52740,11,52768,52768,11,52796,52796,11,52824,52824,11,52852,52852,11,52880,52880,11,52908,52908,11,52936,52936,11,52964,52964,11,52992,52992,11,53020,53020,11,53048,53048,11,53076,53076,11,53104,53104,11,53132,53132,11,53160,53160,11,53188,53188,11,53216,53216,11,53244,53244,11,53272,53272,11,53300,53300,11,53328,53328,11,53356,53356,11,53384,53384,11,53412,53412,11,53440,53440,11,53468,53468,11,53496,53496,11,53524,53524,11,53552,53552,11,53580,53580,11,53608,53608,11,53636,53636,11,53664,53664,11,53692,53692,11,53720,53720,11,53748,53748,11,53776,53776,11,53804,53804,11,53832,53832,11,53860,53860,11,53888,53888,11,53916,53916,11,53944,53944,11,53972,53972,11,54000,54000,11,54028,54028,11,54056,54056,11,54084,54084,11,54112,54112,11,54140,54140,11,54168,54168,11,54196,54196,11,54224,54224,11,54252,54252,11,54280,54280,11,54308,54308,11,54336,54336,11,54364,54364,11,54392,54392,11,54420,54420,11,54448,54448,11,54476,54476,11,54504,54504,11,54532,54532,11,54560,54560,11,54588,54588,11,54616,54616,11,54644,54644,11,54672,54672,11,54700,54700,11,54728,54728,11,54756,54756,11,54784,54784,11,54812,54812,11,54840,54840,11,54868,54868,11,54896,54896,11,54924,54924,11,54952,54952,11,54980,54980,11,55008,55008,11,55036,55036,11,55064,55064,11,55092,55092,11,55120,55120,11,55148,55148,11,55176,55176,11,55216,55238,9,64286,64286,5,65056,65071,5,65438,65439,5,65529,65531,4,66272,66272,5,68097,68099,5,68108,68111,5,68159,68159,5,68900,68903,5,69446,69456,5,69632,69632,7,69634,69634,7,69744,69744,5,69759,69761,5,69808,69810,7,69815,69816,7,69821,69821,1,69837,69837,1,69927,69931,5,69933,69940,5,70003,70003,5,70018,70018,7,70070,70078,5,70082,70083,1,70094,70094,7,70188,70190,7,70194,70195,7,70197,70197,7,70206,70206,5,70368,70370,7,70400,70401,5,70459,70460,5,70463,70463,7,70465,70468,7,70475,70477,7,70498,70499,7,70512,70516,5,70712,70719,5,70722,70724,5,70726,70726,5,70832,70832,5,70835,70840,5,70842,70842,5,70845,70845,5,70847,70848,5,70850,70851,5,71088,71089,7,71096,71099,7,71102,71102,7,71132,71133,5,71219,71226,5,71229,71229,5,71231,71232,5,71340,71340,7,71342,71343,7,71350,71350,7,71453,71455,5,71462,71462,7,71724,71726,7,71736,71736,7,71984,71984,5,71991,71992,7,71997,71997,7,71999,71999,1,72001,72001,1,72003,72003,5,72148,72151,5,72156,72159,7,72164,72164,7,72243,72248,5,72250,72250,1,72263,72263,5,72279,72280,7,72324,72329,1,72343,72343,7,72751,72751,7,72760,72765,5,72767,72767,5,72873,72873,7,72881,72881,7,72884,72884,7,73009,73014,5,73020,73021,5,73030,73030,1,73098,73102,7,73107,73108,7,73110,73110,7,73459,73460,5,78896,78904,4,92976,92982,5,94033,94087,7,94180,94180,5,113821,113822,5,118528,118573,5,119141,119141,5,119143,119145,5,119150,119154,5,119163,119170,5,119210,119213,5,121344,121398,5,121461,121461,5,121499,121503,5,122880,122886,5,122907,122913,5,122918,122922,5,123566,123566,5,125136,125142,5,126976,126979,14,126981,127182,14,127184,127231,14,127279,127279,14,127344,127345,14,127374,127374,14,127405,127461,14,127489,127490,14,127514,127514,14,127538,127546,14,127561,127567,14,127570,127743,14,127757,127758,14,127760,127760,14,127762,127762,14,127766,127768,14,127770,127770,14,127772,127772,14,127775,127776,14,127778,127779,14,127789,127791,14,127794,127795,14,127798,127798,14,127819,127819,14,127824,127824,14,127868,127868,14,127870,127871,14,127892,127893,14,127896,127896,14,127900,127901,14,127904,127940,14,127942,127942,14,127944,127944,14,127946,127946,14,127951,127955,14,127968,127971,14,127973,127984,14,127987,127987,14,127989,127989,14,127991,127991,14,127995,127999,5,128008,128008,14,128012,128014,14,128017,128018,14,128020,128020,14,128022,128022,14,128042,128042,14,128063,128063,14,128065,128065,14,128101,128101,14,128108,128109,14,128173,128173,14,128182,128183,14,128236,128237,14,128239,128239,14,128245,128245,14,128248,128248,14,128253,128253,14,128255,128258,14,128260,128263,14,128265,128265,14,128277,128277,14,128300,128301,14,128326,128328,14,128331,128334,14,128336,128347,14,128360,128366,14,128369,128370,14,128378,128378,14,128391,128391,14,128394,128397,14,128400,128400,14,128405,128406,14,128420,128420,14,128422,128423,14,128425,128432,14,128435,128443,14,128445,128449,14,128453,128464,14,128468,128475,14,128479,128480,14,128482,128482,14,128484,128487,14,128489,128494,14,128496,128498,14,128500,128505,14,128507,128511,14,128513,128518,14,128521,128525,14,128527,128527,14,128529,128529,14,128533,128533,14,128535,128535,14,128537,128537,14]")}const un=class un{static getInstance(e){return un.cache.get(Array.from(e))}static getLocales(){return un._locales.value}constructor(e){this.confusableDictionary=e}isAmbiguous(e){return this.confusableDictionary.has(e)}getPrimaryConfusable(e){return this.confusableDictionary.get(e)}getConfusableCodePoints(){return new Set(this.confusableDictionary.keys())}};un.ambiguousCharacterData=new Xn(()=>JSON.parse('{"_common":[8232,32,8233,32,5760,32,8192,32,8193,32,8194,32,8195,32,8196,32,8197,32,8198,32,8200,32,8201,32,8202,32,8287,32,8199,32,8239,32,2042,95,65101,95,65102,95,65103,95,8208,45,8209,45,8210,45,65112,45,1748,45,8259,45,727,45,8722,45,10134,45,11450,45,1549,44,1643,44,8218,44,184,44,42233,44,894,59,2307,58,2691,58,1417,58,1795,58,1796,58,5868,58,65072,58,6147,58,6153,58,8282,58,1475,58,760,58,42889,58,8758,58,720,58,42237,58,451,33,11601,33,660,63,577,63,2429,63,5038,63,42731,63,119149,46,8228,46,1793,46,1794,46,42510,46,68176,46,1632,46,1776,46,42232,46,1373,96,65287,96,8219,96,8242,96,1370,96,1523,96,8175,96,65344,96,900,96,8189,96,8125,96,8127,96,8190,96,697,96,884,96,712,96,714,96,715,96,756,96,699,96,701,96,700,96,702,96,42892,96,1497,96,2036,96,2037,96,5194,96,5836,96,94033,96,94034,96,65339,91,10088,40,10098,40,12308,40,64830,40,65341,93,10089,41,10099,41,12309,41,64831,41,10100,123,119060,123,10101,125,65342,94,8270,42,1645,42,8727,42,66335,42,5941,47,8257,47,8725,47,8260,47,9585,47,10187,47,10744,47,119354,47,12755,47,12339,47,11462,47,20031,47,12035,47,65340,92,65128,92,8726,92,10189,92,10741,92,10745,92,119311,92,119355,92,12756,92,20022,92,12034,92,42872,38,708,94,710,94,5869,43,10133,43,66203,43,8249,60,10094,60,706,60,119350,60,5176,60,5810,60,5120,61,11840,61,12448,61,42239,61,8250,62,10095,62,707,62,119351,62,5171,62,94015,62,8275,126,732,126,8128,126,8764,126,65372,124,65293,45,120784,50,120794,50,120804,50,120814,50,120824,50,130034,50,42842,50,423,50,1000,50,42564,50,5311,50,42735,50,119302,51,120785,51,120795,51,120805,51,120815,51,120825,51,130035,51,42923,51,540,51,439,51,42858,51,11468,51,1248,51,94011,51,71882,51,120786,52,120796,52,120806,52,120816,52,120826,52,130036,52,5070,52,71855,52,120787,53,120797,53,120807,53,120817,53,120827,53,130037,53,444,53,71867,53,120788,54,120798,54,120808,54,120818,54,120828,54,130038,54,11474,54,5102,54,71893,54,119314,55,120789,55,120799,55,120809,55,120819,55,120829,55,130039,55,66770,55,71878,55,2819,56,2538,56,2666,56,125131,56,120790,56,120800,56,120810,56,120820,56,120830,56,130040,56,547,56,546,56,66330,56,2663,57,2920,57,2541,57,3437,57,120791,57,120801,57,120811,57,120821,57,120831,57,130041,57,42862,57,11466,57,71884,57,71852,57,71894,57,9082,97,65345,97,119834,97,119886,97,119938,97,119990,97,120042,97,120094,97,120146,97,120198,97,120250,97,120302,97,120354,97,120406,97,120458,97,593,97,945,97,120514,97,120572,97,120630,97,120688,97,120746,97,65313,65,119808,65,119860,65,119912,65,119964,65,120016,65,120068,65,120120,65,120172,65,120224,65,120276,65,120328,65,120380,65,120432,65,913,65,120488,65,120546,65,120604,65,120662,65,120720,65,5034,65,5573,65,42222,65,94016,65,66208,65,119835,98,119887,98,119939,98,119991,98,120043,98,120095,98,120147,98,120199,98,120251,98,120303,98,120355,98,120407,98,120459,98,388,98,5071,98,5234,98,5551,98,65314,66,8492,66,119809,66,119861,66,119913,66,120017,66,120069,66,120121,66,120173,66,120225,66,120277,66,120329,66,120381,66,120433,66,42932,66,914,66,120489,66,120547,66,120605,66,120663,66,120721,66,5108,66,5623,66,42192,66,66178,66,66209,66,66305,66,65347,99,8573,99,119836,99,119888,99,119940,99,119992,99,120044,99,120096,99,120148,99,120200,99,120252,99,120304,99,120356,99,120408,99,120460,99,7428,99,1010,99,11429,99,43951,99,66621,99,128844,67,71922,67,71913,67,65315,67,8557,67,8450,67,8493,67,119810,67,119862,67,119914,67,119966,67,120018,67,120174,67,120226,67,120278,67,120330,67,120382,67,120434,67,1017,67,11428,67,5087,67,42202,67,66210,67,66306,67,66581,67,66844,67,8574,100,8518,100,119837,100,119889,100,119941,100,119993,100,120045,100,120097,100,120149,100,120201,100,120253,100,120305,100,120357,100,120409,100,120461,100,1281,100,5095,100,5231,100,42194,100,8558,68,8517,68,119811,68,119863,68,119915,68,119967,68,120019,68,120071,68,120123,68,120175,68,120227,68,120279,68,120331,68,120383,68,120435,68,5024,68,5598,68,5610,68,42195,68,8494,101,65349,101,8495,101,8519,101,119838,101,119890,101,119942,101,120046,101,120098,101,120150,101,120202,101,120254,101,120306,101,120358,101,120410,101,120462,101,43826,101,1213,101,8959,69,65317,69,8496,69,119812,69,119864,69,119916,69,120020,69,120072,69,120124,69,120176,69,120228,69,120280,69,120332,69,120384,69,120436,69,917,69,120492,69,120550,69,120608,69,120666,69,120724,69,11577,69,5036,69,42224,69,71846,69,71854,69,66182,69,119839,102,119891,102,119943,102,119995,102,120047,102,120099,102,120151,102,120203,102,120255,102,120307,102,120359,102,120411,102,120463,102,43829,102,42905,102,383,102,7837,102,1412,102,119315,70,8497,70,119813,70,119865,70,119917,70,120021,70,120073,70,120125,70,120177,70,120229,70,120281,70,120333,70,120385,70,120437,70,42904,70,988,70,120778,70,5556,70,42205,70,71874,70,71842,70,66183,70,66213,70,66853,70,65351,103,8458,103,119840,103,119892,103,119944,103,120048,103,120100,103,120152,103,120204,103,120256,103,120308,103,120360,103,120412,103,120464,103,609,103,7555,103,397,103,1409,103,119814,71,119866,71,119918,71,119970,71,120022,71,120074,71,120126,71,120178,71,120230,71,120282,71,120334,71,120386,71,120438,71,1292,71,5056,71,5107,71,42198,71,65352,104,8462,104,119841,104,119945,104,119997,104,120049,104,120101,104,120153,104,120205,104,120257,104,120309,104,120361,104,120413,104,120465,104,1211,104,1392,104,5058,104,65320,72,8459,72,8460,72,8461,72,119815,72,119867,72,119919,72,120023,72,120179,72,120231,72,120283,72,120335,72,120387,72,120439,72,919,72,120494,72,120552,72,120610,72,120668,72,120726,72,11406,72,5051,72,5500,72,42215,72,66255,72,731,105,9075,105,65353,105,8560,105,8505,105,8520,105,119842,105,119894,105,119946,105,119998,105,120050,105,120102,105,120154,105,120206,105,120258,105,120310,105,120362,105,120414,105,120466,105,120484,105,618,105,617,105,953,105,8126,105,890,105,120522,105,120580,105,120638,105,120696,105,120754,105,1110,105,42567,105,1231,105,43893,105,5029,105,71875,105,65354,106,8521,106,119843,106,119895,106,119947,106,119999,106,120051,106,120103,106,120155,106,120207,106,120259,106,120311,106,120363,106,120415,106,120467,106,1011,106,1112,106,65322,74,119817,74,119869,74,119921,74,119973,74,120025,74,120077,74,120129,74,120181,74,120233,74,120285,74,120337,74,120389,74,120441,74,42930,74,895,74,1032,74,5035,74,5261,74,42201,74,119844,107,119896,107,119948,107,120000,107,120052,107,120104,107,120156,107,120208,107,120260,107,120312,107,120364,107,120416,107,120468,107,8490,75,65323,75,119818,75,119870,75,119922,75,119974,75,120026,75,120078,75,120130,75,120182,75,120234,75,120286,75,120338,75,120390,75,120442,75,922,75,120497,75,120555,75,120613,75,120671,75,120729,75,11412,75,5094,75,5845,75,42199,75,66840,75,1472,108,8739,73,9213,73,65512,73,1633,108,1777,73,66336,108,125127,108,120783,73,120793,73,120803,73,120813,73,120823,73,130033,73,65321,73,8544,73,8464,73,8465,73,119816,73,119868,73,119920,73,120024,73,120128,73,120180,73,120232,73,120284,73,120336,73,120388,73,120440,73,65356,108,8572,73,8467,108,119845,108,119897,108,119949,108,120001,108,120053,108,120105,73,120157,73,120209,73,120261,73,120313,73,120365,73,120417,73,120469,73,448,73,120496,73,120554,73,120612,73,120670,73,120728,73,11410,73,1030,73,1216,73,1493,108,1503,108,1575,108,126464,108,126592,108,65166,108,65165,108,1994,108,11599,73,5825,73,42226,73,93992,73,66186,124,66313,124,119338,76,8556,76,8466,76,119819,76,119871,76,119923,76,120027,76,120079,76,120131,76,120183,76,120235,76,120287,76,120339,76,120391,76,120443,76,11472,76,5086,76,5290,76,42209,76,93974,76,71843,76,71858,76,66587,76,66854,76,65325,77,8559,77,8499,77,119820,77,119872,77,119924,77,120028,77,120080,77,120132,77,120184,77,120236,77,120288,77,120340,77,120392,77,120444,77,924,77,120499,77,120557,77,120615,77,120673,77,120731,77,1018,77,11416,77,5047,77,5616,77,5846,77,42207,77,66224,77,66321,77,119847,110,119899,110,119951,110,120003,110,120055,110,120107,110,120159,110,120211,110,120263,110,120315,110,120367,110,120419,110,120471,110,1400,110,1404,110,65326,78,8469,78,119821,78,119873,78,119925,78,119977,78,120029,78,120081,78,120185,78,120237,78,120289,78,120341,78,120393,78,120445,78,925,78,120500,78,120558,78,120616,78,120674,78,120732,78,11418,78,42208,78,66835,78,3074,111,3202,111,3330,111,3458,111,2406,111,2662,111,2790,111,3046,111,3174,111,3302,111,3430,111,3664,111,3792,111,4160,111,1637,111,1781,111,65359,111,8500,111,119848,111,119900,111,119952,111,120056,111,120108,111,120160,111,120212,111,120264,111,120316,111,120368,111,120420,111,120472,111,7439,111,7441,111,43837,111,959,111,120528,111,120586,111,120644,111,120702,111,120760,111,963,111,120532,111,120590,111,120648,111,120706,111,120764,111,11423,111,4351,111,1413,111,1505,111,1607,111,126500,111,126564,111,126596,111,65259,111,65260,111,65258,111,65257,111,1726,111,64428,111,64429,111,64427,111,64426,111,1729,111,64424,111,64425,111,64423,111,64422,111,1749,111,3360,111,4125,111,66794,111,71880,111,71895,111,66604,111,1984,79,2534,79,2918,79,12295,79,70864,79,71904,79,120782,79,120792,79,120802,79,120812,79,120822,79,130032,79,65327,79,119822,79,119874,79,119926,79,119978,79,120030,79,120082,79,120134,79,120186,79,120238,79,120290,79,120342,79,120394,79,120446,79,927,79,120502,79,120560,79,120618,79,120676,79,120734,79,11422,79,1365,79,11604,79,4816,79,2848,79,66754,79,42227,79,71861,79,66194,79,66219,79,66564,79,66838,79,9076,112,65360,112,119849,112,119901,112,119953,112,120005,112,120057,112,120109,112,120161,112,120213,112,120265,112,120317,112,120369,112,120421,112,120473,112,961,112,120530,112,120544,112,120588,112,120602,112,120646,112,120660,112,120704,112,120718,112,120762,112,120776,112,11427,112,65328,80,8473,80,119823,80,119875,80,119927,80,119979,80,120031,80,120083,80,120187,80,120239,80,120291,80,120343,80,120395,80,120447,80,929,80,120504,80,120562,80,120620,80,120678,80,120736,80,11426,80,5090,80,5229,80,42193,80,66197,80,119850,113,119902,113,119954,113,120006,113,120058,113,120110,113,120162,113,120214,113,120266,113,120318,113,120370,113,120422,113,120474,113,1307,113,1379,113,1382,113,8474,81,119824,81,119876,81,119928,81,119980,81,120032,81,120084,81,120188,81,120240,81,120292,81,120344,81,120396,81,120448,81,11605,81,119851,114,119903,114,119955,114,120007,114,120059,114,120111,114,120163,114,120215,114,120267,114,120319,114,120371,114,120423,114,120475,114,43847,114,43848,114,7462,114,11397,114,43905,114,119318,82,8475,82,8476,82,8477,82,119825,82,119877,82,119929,82,120033,82,120189,82,120241,82,120293,82,120345,82,120397,82,120449,82,422,82,5025,82,5074,82,66740,82,5511,82,42211,82,94005,82,65363,115,119852,115,119904,115,119956,115,120008,115,120060,115,120112,115,120164,115,120216,115,120268,115,120320,115,120372,115,120424,115,120476,115,42801,115,445,115,1109,115,43946,115,71873,115,66632,115,65331,83,119826,83,119878,83,119930,83,119982,83,120034,83,120086,83,120138,83,120190,83,120242,83,120294,83,120346,83,120398,83,120450,83,1029,83,1359,83,5077,83,5082,83,42210,83,94010,83,66198,83,66592,83,119853,116,119905,116,119957,116,120009,116,120061,116,120113,116,120165,116,120217,116,120269,116,120321,116,120373,116,120425,116,120477,116,8868,84,10201,84,128872,84,65332,84,119827,84,119879,84,119931,84,119983,84,120035,84,120087,84,120139,84,120191,84,120243,84,120295,84,120347,84,120399,84,120451,84,932,84,120507,84,120565,84,120623,84,120681,84,120739,84,11430,84,5026,84,42196,84,93962,84,71868,84,66199,84,66225,84,66325,84,119854,117,119906,117,119958,117,120010,117,120062,117,120114,117,120166,117,120218,117,120270,117,120322,117,120374,117,120426,117,120478,117,42911,117,7452,117,43854,117,43858,117,651,117,965,117,120534,117,120592,117,120650,117,120708,117,120766,117,1405,117,66806,117,71896,117,8746,85,8899,85,119828,85,119880,85,119932,85,119984,85,120036,85,120088,85,120140,85,120192,85,120244,85,120296,85,120348,85,120400,85,120452,85,1357,85,4608,85,66766,85,5196,85,42228,85,94018,85,71864,85,8744,118,8897,118,65366,118,8564,118,119855,118,119907,118,119959,118,120011,118,120063,118,120115,118,120167,118,120219,118,120271,118,120323,118,120375,118,120427,118,120479,118,7456,118,957,118,120526,118,120584,118,120642,118,120700,118,120758,118,1141,118,1496,118,71430,118,43945,118,71872,118,119309,86,1639,86,1783,86,8548,86,119829,86,119881,86,119933,86,119985,86,120037,86,120089,86,120141,86,120193,86,120245,86,120297,86,120349,86,120401,86,120453,86,1140,86,11576,86,5081,86,5167,86,42719,86,42214,86,93960,86,71840,86,66845,86,623,119,119856,119,119908,119,119960,119,120012,119,120064,119,120116,119,120168,119,120220,119,120272,119,120324,119,120376,119,120428,119,120480,119,7457,119,1121,119,1309,119,1377,119,71434,119,71438,119,71439,119,43907,119,71919,87,71910,87,119830,87,119882,87,119934,87,119986,87,120038,87,120090,87,120142,87,120194,87,120246,87,120298,87,120350,87,120402,87,120454,87,1308,87,5043,87,5076,87,42218,87,5742,120,10539,120,10540,120,10799,120,65368,120,8569,120,119857,120,119909,120,119961,120,120013,120,120065,120,120117,120,120169,120,120221,120,120273,120,120325,120,120377,120,120429,120,120481,120,5441,120,5501,120,5741,88,9587,88,66338,88,71916,88,65336,88,8553,88,119831,88,119883,88,119935,88,119987,88,120039,88,120091,88,120143,88,120195,88,120247,88,120299,88,120351,88,120403,88,120455,88,42931,88,935,88,120510,88,120568,88,120626,88,120684,88,120742,88,11436,88,11613,88,5815,88,42219,88,66192,88,66228,88,66327,88,66855,88,611,121,7564,121,65369,121,119858,121,119910,121,119962,121,120014,121,120066,121,120118,121,120170,121,120222,121,120274,121,120326,121,120378,121,120430,121,120482,121,655,121,7935,121,43866,121,947,121,8509,121,120516,121,120574,121,120632,121,120690,121,120748,121,1199,121,4327,121,71900,121,65337,89,119832,89,119884,89,119936,89,119988,89,120040,89,120092,89,120144,89,120196,89,120248,89,120300,89,120352,89,120404,89,120456,89,933,89,978,89,120508,89,120566,89,120624,89,120682,89,120740,89,11432,89,1198,89,5033,89,5053,89,42220,89,94019,89,71844,89,66226,89,119859,122,119911,122,119963,122,120015,122,120067,122,120119,122,120171,122,120223,122,120275,122,120327,122,120379,122,120431,122,120483,122,7458,122,43923,122,71876,122,66293,90,71909,90,65338,90,8484,90,8488,90,119833,90,119885,90,119937,90,119989,90,120041,90,120197,90,120249,90,120301,90,120353,90,120405,90,120457,90,918,90,120493,90,120551,90,120609,90,120667,90,120725,90,5059,90,42204,90,71849,90,65282,34,65284,36,65285,37,65286,38,65290,42,65291,43,65294,46,65295,47,65296,48,65297,49,65298,50,65299,51,65300,52,65301,53,65302,54,65303,55,65304,56,65305,57,65308,60,65309,61,65310,62,65312,64,65316,68,65318,70,65319,71,65324,76,65329,81,65330,82,65333,85,65334,86,65335,87,65343,95,65346,98,65348,100,65350,102,65355,107,65357,109,65358,110,65361,113,65362,114,65364,116,65365,117,65367,119,65370,122,65371,123,65373,125,119846,109],"_default":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"cs":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"de":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"es":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"fr":[65374,126,65306,58,65281,33,8216,96,8245,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"it":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ja":[8211,45,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65292,44,65307,59],"ko":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pl":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pt-BR":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"qps-ploc":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ru":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,305,105,921,73,1009,112,215,120,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"tr":[160,32,8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"zh-hans":[65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41],"zh-hant":[8211,45,65374,126,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65307,59]}')),un.cache=new oE({getCacheKey:JSON.stringify},e=>{function t(u){const d=new Map;for(let f=0;f<u.length;f+=2)d.set(u[f],u[f+1]);return d}function i(u,d){const f=new Map(u);for(const[m,b]of d)f.set(m,b);return f}function n(u,d){if(!u)return d;const f=new Map;for(const[m,b]of u)d.has(m)&&f.set(m,b);return f}const s=un.ambiguousCharacterData.value;let o=e.filter(u=>!u.startsWith("_")&&u in s);o.length===0&&(o=["_default"]);let a;for(const u of o){const d=t(s[u]);a=n(a,d)}const c=t(s._common),l=i(c,a);return new un(l)}),un._locales=new Xn(()=>Object.keys(un.ambiguousCharacterData.value).filter(e=>!e.startsWith("_")));let B0=un;function $e(r){return typeof r=="string"}function EE(r){return Array.isArray(r)&&r.every(e=>$e(e))}function Vt(r){return typeof r=="object"&&r!==null&&!Array.isArray(r)&&!(r instanceof RegExp)&&!(r instanceof Date)}function kE(r){const e=Object.getPrototypeOf(Uint8Array);return typeof r=="object"&&r instanceof e}function Br(r){return typeof r=="number"&&!isNaN(r)}function Lm(r){return typeof r>"u"}function ks(r){return!Qt(r)}function Qt(r){return Lm(r)||r===null}function $x(r,e){if(!r)throw new Error(e?`Unexpected type, expected '${e}'`:"Unexpected type")}function Oa(r){if(Qt(r))throw new Error("Assertion Failed: argument is undefined or null");return r}const DE=Object.prototype.hasOwnProperty;function IE(r){if(!Vt(r))return!1;for(const e in r)if(DE.call(r,e))return!1;return!0}function PE(r){return typeof r=="function"}function TE(r,e){if($e(e)){if(typeof r!==e)throw new Error(`argument does not match constraint: typeof ${e}`)}else if(PE(e)){try{if(r instanceof e)return}catch{}if(!Qt(r)&&r.constructor===e||e.length===1&&e.call(void 0,r)===!0)return;throw new Error("argument does not match one of these constraints: arg instanceof constraint, arg.constructor === constraint, nor constraint(arg) === true")}}function gr(r){return r===47||r===92}function Nx(r){return r.replace(/[\\/]/g,Be.sep)}function AE(r){return r.indexOf("/")===-1&&(r=Nx(r)),/^[a-zA-Z]:(\/|$)/.test(r)&&(r="/"+r),r}function V0(r,e=Be.sep){if(!r)return"";const t=r.length,i=r.charCodeAt(0);if(gr(i)){if(gr(r.charCodeAt(1))&&!gr(r.charCodeAt(2))){let s=3;const o=s;for(;s<t&&!gr(r.charCodeAt(s));s++);if(o!==s&&!gr(r.charCodeAt(s+1))){for(s+=1;s<t;s++)if(gr(r.charCodeAt(s)))return r.slice(0,s+1).replace(/[\\/]/g,e)}}return e}else if(Mx(i)&&r.charCodeAt(1)===58)return gr(r.charCodeAt(2))?r.slice(0,2)+e:r.slice(0,2);let n=r.indexOf("://");if(n!==-1){for(n+=3;n<t;n++)if(gr(r.charCodeAt(n)))return r.slice(0,n+1)}return""}function _h(r,e,t,i=en){if(r===e)return!0;if(!r||!e||e.length>r.length)return!1;if(t){if(!xw(r,e))return!1;if(e.length===r.length)return!0;let s=e.length;return e.charAt(e.length-1)===i&&s--,r.charAt(s)===i}return e.charAt(e.length-1)!==i&&(e+=i),r.indexOf(e)===0}function Mx(r){return r>=65&&r<=90||r>=97&&r<=122}function RE(r,e=Ii){return e?Mx(r.charCodeAt(0))&&r.charCodeAt(1)===58:!1}var ne;(function(r){r.inMemory="inmemory",r.vscode="vscode",r.internal="private",r.walkThrough="walkThrough",r.walkThroughSnippet="walkThroughSnippet",r.http="http",r.https="https",r.file="file",r.mailto="mailto",r.untitled="untitled",r.data="data",r.command="command",r.vscodeRemote="vscode-remote",r.vscodeRemoteResource="vscode-remote-resource",r.vscodeManagedRemoteResource="vscode-managed-remote-resource",r.vscodeUserData="vscode-userdata",r.vscodeCustomEditor="vscode-custom-editor",r.vscodeNotebookCell="vscode-notebook-cell",r.vscodeNotebookCellMetadata="vscode-notebook-cell-metadata",r.vscodeNotebookCellOutput="vscode-notebook-cell-output",r.vscodeInteractiveInput="vscode-interactive-input",r.vscodeSettings="vscode-settings",r.vscodeWorkspaceTrust="vscode-workspace-trust",r.vscodeTerminal="vscode-terminal",r.vscodeChatCodeBlock="vscode-chat-code-block",r.vscodeChatCodeCompreBlock="vscode-chat-code-compare-block",r.vscodeChatSesssion="vscode-chat-editor",r.webviewPanel="webview-panel",r.vscodeWebview="vscode-webview",r.extension="extension",r.vscodeFileResource="vscode-file",r.tmp="tmp",r.vsls="vsls",r.vscodeSourceControl="vscode-scm",r.commentsInput="comment",r.codeSetting="code-setting"})(ne||(ne={}));function $m(r,e){return x.isUri(r)?Rr(r.scheme,e):xw(r,e+":")}function LE(r,...e){return e.some(t=>$m(r,t))}const $E="tkn";class NE{constructor(){this._hosts=Object.create(null),this._ports=Object.create(null),this._connectionTokens=Object.create(null),this._preferredWebSchema="http",this._delegate=null,this._serverRootPath="/"}setPreferredWebSchema(e){this._preferredWebSchema=e}setDelegate(e){this._delegate=e}setServerRootPath(e,t){this._serverRootPath=FE(e,t)}getServerRootPath(){return this._serverRootPath}get _remoteResourcesPath(){return Be.join(this._serverRootPath,ne.vscodeRemoteResource)}set(e,t,i){this._hosts[e]=t,this._ports[e]=i}setConnectionToken(e,t){this._connectionTokens[e]=t}getPreferredWebSchema(){return this._preferredWebSchema}rewrite(e){if(this._delegate)try{return this._delegate(e)}catch(a){return nn(a),e}const t=e.authority;let i=this._hosts[t];i&&i.indexOf(":")!==-1&&i.indexOf("[")===-1&&(i=`[${i}]`);const n=this._ports[t],s=this._connectionTokens[t];let o=`path=${encodeURIComponent(e.path)}`;return typeof s=="string"&&(o+=`&${$E}=${encodeURIComponent(s)}`),x.from({scheme:bw?this._preferredWebSchema:ne.vscodeRemoteResource,authority:`${i}:${n}`,path:this._remoteResourcesPath,query:o})}}const ME=new NE;function FE(r,e){return Be.join(e??"/",`${r.quality??"oss"}-${r.commit??"dev"}`)}const OE="vscode-app",Zo=class Zo{constructor(){this.staticBrowserUris=new Pt,this.appResourcePathUrls=new Map,this.moduleContentProvider=new Map}registerModuleContentProvider(e,t){this.moduleContentProvider.set(e,t)}toModuleContent(e){return this.moduleContentProvider.get(e)()}registerAppResourcePathUrl(e,t){this.appResourcePathUrls.set(e,t)}toUrl(e){var i;let t=this.appResourcePathUrls.get(e);return typeof t=="function"&&(t=t()),new URL(t??e,((i=globalThis.location)==null?void 0:i.href)??import.meta.url).toString()}asBrowserUri(e){const t=this.toUri(e,{toUrl:this.toUrl.bind(this)});return this.uriToBrowserUri(t)}uriToBrowserUri(e){return e.scheme===ne.vscodeRemote?ME.rewrite(e):e.scheme===ne.file&&(M4||F4===`${ne.vscodeFileResource}://${Zo.FALLBACK_AUTHORITY}`)?e.with({scheme:ne.vscodeFileResource,authority:e.authority||Zo.FALLBACK_AUTHORITY,query:null,fragment:null}):this.staticBrowserUris.get(e)??e}asFileUri(e){const t=this.toUri(e,{toUrl:this.toUrl.bind(this)});return this.uriToFileUri(t)}uriToFileUri(e){return e.scheme===ne.vscodeFileResource?e.with({scheme:ne.file,authority:e.authority!==Zo.FALLBACK_AUTHORITY?e.authority:null,query:null,fragment:null}):e}toUri(e,t){return x.isUri(e)?e:x.parse(t.toUrl(e))}registerStaticBrowserUri(e,t){return this.staticBrowserUris.set(e,t),De(()=>{this.staticBrowserUris.get(e)===t&&this.staticBrowserUris.delete(e)})}getRegisteredBrowserUris(){return this.staticBrowserUris.keys()}};Zo.FALLBACK_AUTHORITY=OE;let Nm=Zo;new Nm;var W0;(function(r){const e=new Map([["1",{"Cross-Origin-Opener-Policy":"same-origin"}],["2",{"Cross-Origin-Embedder-Policy":"require-corp"}],["3",{"Cross-Origin-Opener-Policy":"same-origin","Cross-Origin-Embedder-Policy":"require-corp"}]]);r.CoopAndCoep=Object.freeze(e.get("3"));const t="vscode-coi";function i(s){let o;typeof s=="string"?o=new URL(s).searchParams:s instanceof URL?o=s.searchParams:x.isUri(s)&&(o=new URL(s.toString(!0)).searchParams);const a=o==null?void 0:o.get(t);if(a)return e.get(a)}r.getHeadersFromQuery=i;function n(s,o,a){if(!globalThis.crossOriginIsolated)return;const c=o&&a?"3":a?"2":"1";s instanceof URLSearchParams?s.set(t,c):s[t]=c}r.addSearchParam=n})(W0||(W0={}));function Wi(r){return fh(r,!0)}class td{constructor(e){this._ignorePathCasing=e}compare(e,t,i=!1){return e===t?0:fo(this.getComparisonKey(e,i),this.getComparisonKey(t,i))}isEqual(e,t,i=!1){return e===t?!0:!e||!t?!1:this.getComparisonKey(e,i)===this.getComparisonKey(t,i)}getComparisonKey(e,t=!1){return e.with({path:this._ignorePathCasing(e)?e.path.toLowerCase():void 0,fragment:t?null:void 0}).toString()}ignorePathCasing(e){return this._ignorePathCasing(e)}isEqualOrParent(e,t,i=!1){if(e.scheme===t.scheme){if(e.scheme===ne.file)return _h(Wi(e),Wi(t),this._ignorePathCasing(e))&&e.query===t.query&&(i||e.fragment===t.fragment);if(z0(e.authority,t.authority))return _h(e.path,t.path,this._ignorePathCasing(e),"/")&&e.query===t.query&&(i||e.fragment===t.fragment)}return!1}joinPath(e,...t){return x.joinPath(e,...t)}basenameOrAuthority(e){return _c(e)||e.authority}basename(e){return Be.basename(e.path)}extname(e){return Be.extname(e.path)}dirname(e){if(e.path.length===0)return e;let t;return e.scheme===ne.file?t=x.file(Ys(Wi(e))).path:(t=Be.dirname(e.path),e.authority&&t.length&&t.charCodeAt(0)!==47&&(console.error(`dirname("${e.toString})) resulted in a relative path`),t="/")),e.with({path:t})}normalizePath(e){if(!e.path.length)return e;let t;return e.scheme===ne.file?t=x.file(Ma(Wi(e))).path:t=Be.normalize(e.path),e.with({path:t})}relativePath(e,t){if(e.scheme!==t.scheme||!z0(e.authority,t.authority))return;if(e.scheme===ne.file){const s=Rl(Wi(e),Wi(t));return Ii?Nx(s):s}let i=e.path||"/";const n=t.path||"/";if(this._ignorePathCasing(e)){let s=0;for(const o=Math.min(i.length,n.length);s<o&&!(i.charCodeAt(s)!==n.charCodeAt(s)&&i.charAt(s).toLowerCase()!==n.charAt(s).toLowerCase());s++);i=n.substr(0,s)+i.substr(s)}return Be.relative(i,n)}resolvePath(e,t){if(e.scheme===ne.file){const i=x.file(K4(Wi(e),t));return e.with({authority:i.authority,path:i.path})}return t=AE(t),e.with({path:Be.resolve(e.path,t)})}isAbsolutePath(e){return!!e.path&&e.path[0]==="/"}isEqualAuthority(e,t){return e===t||e!==void 0&&t!==void 0&&Rr(e,t)}hasTrailingPathSeparator(e,t=en){if(e.scheme===ne.file){const i=Wi(e);return i.length>V0(i).length&&i[i.length-1]===t}else{const i=e.path;return i.length>1&&i.charCodeAt(i.length-1)===47&&!/^[a-zA-Z]:(\/$|\\$)/.test(e.fsPath)}}removeTrailingPathSeparator(e,t=en){return j0(e,t)?e.with({path:e.path.substr(0,e.path.length-1)}):e}addTrailingPathSeparator(e,t=en){let i=!1;if(e.scheme===ne.file){const n=Wi(e);i=n!==void 0&&n.length===V0(n).length&&n[n.length-1]===t}else{t="/";const n=e.path;i=n.length===1&&n.charCodeAt(n.length-1)===47}return!i&&!j0(e,t)?e.with({path:e.path+"/"}):e}}const Ue=new td(()=>!1),HE=new td(r=>r.scheme===ne.file?!Qr:!0),UE=new td(r=>!0),Fx=Ue.isEqual.bind(Ue);Ue.isEqualOrParent.bind(Ue);Ue.getComparisonKey.bind(Ue);const Mm=Ue.basenameOrAuthority.bind(Ue),_c=Ue.basename.bind(Ue);Ue.extname.bind(Ue);const Sw=Ue.dirname.bind(Ue),wc=Ue.joinPath.bind(Ue);Ue.normalizePath.bind(Ue);const Ox=Ue.relativePath.bind(Ue);Ue.resolvePath.bind(Ue);const BE=Ue.isAbsolutePath.bind(Ue),z0=Ue.isEqualAuthority.bind(Ue),j0=Ue.hasTrailingPathSeparator.bind(Ue);Ue.removeTrailingPathSeparator.bind(Ue);Ue.addTrailingPathSeparator.bind(Ue);var q0;(function(r){r.META_DATA_LABEL="label",r.META_DATA_DESCRIPTION="description",r.META_DATA_SIZE="size",r.META_DATA_MIME="mime";function e(t){const i=new Map;t.path.substring(t.path.indexOf(";")+1,t.path.lastIndexOf(";")).split(";").forEach(o=>{const[a,c]=o.split(":");a&&c&&i.set(a,c)});const s=t.path.substring(0,t.path.indexOf(";"));return s&&i.set(r.META_DATA_MIME,s),i}r.parseMetaData=e})(q0||(q0={}));function Jr(r){return!!r&&typeof r.then=="function"}function VE(r){const e=new Tt,t=r(e.token),i=new Promise((n,s)=>{const o=e.token.onCancellationRequested(()=>{o.dispose(),s(new is)});Promise.resolve(t).then(a=>{o.dispose(),e.dispose(),n(a)},a=>{o.dispose(),e.dispose(),s(a)})});return new class{cancel(){e.cancel(),e.dispose()}then(n,s){return i.then(n,s)}catch(n){return this.then(void 0,n)}finally(n){return i.finally(n)}}}function Fm(r,e,t){return new Promise((i,n)=>{const s=e.onCancellationRequested(()=>{s.dispose(),i(t)});r.then(i,n).finally(()=>s.dispose())})}function WE(r,e){return new Promise((t,i)=>{const n=e.onCancellationRequested(()=>{n.dispose(),i(new is)});r.then(t,i).finally(()=>n.dispose())})}function Bt(r){return new Promise((e,t)=>{const i=r();Jr(i)?i.then(e,t):e(i)})}function zE(){let r,e;return{promise:new Promise((i,n)=>{r=i,e=n}),resolve:r,reject:e}}class Ki{constructor(){this._isOpen=!1,this._promise=new Promise((e,t)=>{this._completePromise=e})}isOpen(){return this._isOpen}open(){this._isOpen=!0,this._completePromise(!0)}wait(){return this._promise}}function Yn(r,e){return e?new Promise((t,i)=>{const n=setTimeout(()=>{s.dispose(),t()},r),s=e.onCancellationRequested(()=>{clearTimeout(n),s.dispose(),i(new is)})}):VE(t=>Yn(r,t))}function jE(r,e=0,t){const i=setTimeout(()=>{r()},e);return De(()=>{clearTimeout(i)})}class qE{constructor(e){this._size=0,this._isDisposed=!1,this.maxDegreeOfParalellism=e,this.outstandingPromises=[],this.runningPromises=0,this._onDrained=new R}whenIdle(){return this.size>0?It.toPromise(this.onDrained):Promise.resolve()}get onDrained(){return this._onDrained.event}get size(){return this._size}queue(e){if(this._isDisposed)throw new Error("Object has been disposed");return this._size++,new Promise((t,i)=>{this.outstandingPromises.push({factory:e,c:t,e:i}),this.consume()})}consume(){for(;this.outstandingPromises.length&&this.runningPromises<this.maxDegreeOfParalellism;){const e=this.outstandingPromises.shift();this.runningPromises++;const t=e.factory();t.then(e.c,e.e),t.then(()=>this.consumed(),()=>this.consumed())}}consumed(){this._isDisposed||(this.runningPromises--,--this._size===0&&this._onDrained.fire(),this.outstandingPromises.length>0&&this.consume())}clear(){if(this._isDisposed)throw new Error("Object has been disposed");this.outstandingPromises.length=0,this._size=this.runningPromises}dispose(){this._isDisposed=!0,this.outstandingPromises.length=0,this._size=0,this._onDrained.dispose()}}class GE extends qE{constructor(){super(1)}}class QE{constructor(){this.queues=new Map,this.drainers=new Set,this.drainListeners=void 0,this.drainListenerCount=0}async whenDrained(){if(this.isDrained())return;const e=new bc;return this.drainers.add(e),e.p}isDrained(){for(const[,e]of this.queues)if(e.size>0)return!1;return!0}queueSize(e,t=Ue){var n;const i=t.getComparisonKey(e);return((n=this.queues.get(i))==null?void 0:n.size)??0}queueFor(e,t,i=Ue){const n=i.getComparisonKey(e);let s=this.queues.get(n);if(!s){s=new GE;const o=this.drainListenerCount++,a=It.once(s.onDrained)(()=>{var c,l;s==null||s.dispose(),this.queues.delete(n),this.onDidQueueDrain(),(c=this.drainListeners)==null||c.deleteAndDispose(o),((l=this.drainListeners)==null?void 0:l.size)===0&&(this.drainListeners.dispose(),this.drainListeners=void 0)});this.drainListeners||(this.drainListeners=new fx),this.drainListeners.set(o,a),this.queues.set(n,s)}return s.queue(t)}onDidQueueDrain(){this.isDrained()&&this.releaseDrainers()}releaseDrainers(){for(const e of this.drainers)e.complete();this.drainers.clear()}dispose(){var e;for(const[,t]of this.queues)t.dispose();this.queues.clear(),this.releaseDrainers(),(e=this.drainListeners)==null||e.dispose()}}class JE{constructor(){this.disposable=void 0}cancel(){var e;(e=this.disposable)==null||e.dispose(),this.disposable=void 0}cancelAndSet(e,t,i=globalThis){this.cancel();const n=i.setInterval(()=>{e()},t);this.disposable=De(()=>{i.clearInterval(n),this.disposable=void 0})}dispose(){this.cancel()}}class id{constructor(e,t){this.timeoutToken=-1,this.runner=e,this.timeout=t,this.timeoutHandler=this.onTimeout.bind(this)}dispose(){this.cancel(),this.runner=null}cancel(){this.isScheduled()&&(clearTimeout(this.timeoutToken),this.timeoutToken=-1)}schedule(e=this.timeout){this.cancel(),this.timeoutToken=setTimeout(this.timeoutHandler,e)}get delay(){return this.timeout}set delay(e){this.timeout=e}isScheduled(){return this.timeoutToken!==-1}flush(){this.isScheduled()&&(this.cancel(),this.doRun())}onTimeout(){this.timeoutToken=-1,this.runner&&this.doRun()}doRun(){var e;(e=this.runner)==null||e.call(this)}}let Om;(function(){typeof globalThis.requestIdleCallback!="function"||typeof globalThis.cancelIdleCallback!="function"?Om=(r,e)=>{_x(()=>{if(t)return;const i=Date.now()+15;e(Object.freeze({didTimeout:!0,timeRemaining(){return Math.max(0,i-Date.now())}}))});let t=!1;return{dispose(){t||(t=!0)}}}:Om=(r,e,t)=>{const i=r.requestIdleCallback(e,typeof t=="number"?{timeout:t}:void 0);let n=!1;return{dispose(){n||(n=!0,r.cancelIdleCallback(i))}}}})();class KE{constructor(e,t){this._didRun=!1,this._executor=()=>{try{this._value=t()}catch(i){this._error=i}finally{this._didRun=!0}},this._handle=Om(e,()=>this._executor())}dispose(){this._handle.dispose()}get value(){if(this._didRun||(this._handle.dispose(),this._executor()),this._error)throw this._error;return this._value}get isInitialized(){return this._didRun}}class XE extends KE{constructor(e){super(globalThis,e)}}class bc{get isRejected(){var e;return((e=this.outcome)==null?void 0:e.outcome)===1}get isResolved(){var e;return((e=this.outcome)==null?void 0:e.outcome)===0}get isSettled(){return!!this.outcome}get value(){var e,t;return((e=this.outcome)==null?void 0:e.outcome)===0?(t=this.outcome)==null?void 0:t.value:void 0}constructor(){this.p=new Promise((e,t)=>{this.completeCallback=e,this.errorCallback=t})}complete(e){return new Promise(t=>{this.completeCallback(e),this.outcome={outcome:0,value:e},t()})}error(e){return new Promise(t=>{this.errorCallback(e),this.outcome={outcome:1,value:e},t()})}cancel(){return this.error(new is)}}var Hm;(function(r){async function e(i){let n;const s=await Promise.all(i.map(o=>o.then(a=>a,a=>{n||(n=a)})));if(typeof n<"u")throw n;return s}r.settled=e;function t(i){return new Promise(async(n,s)=>{try{await i(n,s)}catch(o){s(o)}})}r.withAsyncBody=t})(Hm||(Hm={}));const ri=class ri{static fromArray(e){return new ri(t=>{t.emitMany(e)})}static fromPromise(e){return new ri(async t=>{t.emitMany(await e)})}static fromPromises(e){return new ri(async t=>{await Promise.all(e.map(async i=>t.emitOne(await i)))})}static merge(e){return new ri(async t=>{await Promise.all(e.map(async i=>{for await(const n of i)t.emitOne(n)}))})}constructor(e,t){this._state=0,this._results=[],this._error=null,this._onReturn=t,this._onStateChanged=new R,queueMicrotask(async()=>{const i={emitOne:n=>this.emitOne(n),emitMany:n=>this.emitMany(n),reject:n=>this.reject(n)};try{await Promise.resolve(e(i)),this.resolve()}catch(n){this.reject(n)}finally{i.emitOne=void 0,i.emitMany=void 0,i.reject=void 0}})}[Symbol.asyncIterator](){let e=0;return{next:async()=>{do{if(this._state===2)throw this._error;if(e<this._results.length)return{done:!1,value:this._results[e++]};if(this._state===1)return{done:!0,value:void 0};await It.toPromise(this._onStateChanged.event)}while(!0)},return:async()=>{var t;return(t=this._onReturn)==null||t.call(this),{done:!0,value:void 0}}}}static map(e,t){return new ri(async i=>{for await(const n of e)i.emitOne(t(n))})}map(e){return ri.map(this,e)}static filter(e,t){return new ri(async i=>{for await(const n of e)t(n)&&i.emitOne(n)})}filter(e){return ri.filter(this,e)}static coalesce(e){return ri.filter(e,t=>!!t)}coalesce(){return ri.coalesce(this)}static async toPromise(e){const t=[];for await(const i of e)t.push(i);return t}toPromise(){return ri.toPromise(this)}emitOne(e){this._state===0&&(this._results.push(e),this._onStateChanged.fire())}emitMany(e){this._state===0&&(this._results=this._results.concat(e),this._onStateChanged.fire())}resolve(){this._state===0&&(this._state=1,this._onStateChanged.fire())}reject(e){this._state===0&&(this._state=2,this._error=e,this._onStateChanged.fire())}};ri.EMPTY=ri.fromArray([]);let Ll=ri;class Um{constructor(e){this._deferred=new bc,this._asyncIterable=new Ll(n=>{if(t){n.reject(t);return}return i&&n.emitMany(i),this._errorFn=s=>n.reject(s),this._emitFn=s=>n.emitOne(s),this._deferred.p},e);let t,i;this._emitFn=n=>{i||(i=[]),i.push(n)},this._errorFn=n=>{t||(t=n)}}get asyncIterable(){return this._asyncIterable}resolve(){this._deferred.complete()}reject(e){this._errorFn(e),this._deferred.complete()}emitOne(e){this._emitFn(e)}}function Hx(r,e,t,i){if(!r||i>200)return null;if(typeof r=="object"){if(r.$mid===1)return t?x.revive(e.transformIncoming(r)):e.transformIncoming(r);if(r instanceof _e)return null;for(const n in r)if(Object.hasOwnProperty.call(r,n)){const s=Hx(r[n],e,t,i+1);s!==null&&(r[n]=s)}}return null}function Lc(r,e){const t=Hx(r,e,!1,0);return t===null?r:t}class Ux{constructor(){this._actual=null,this._actualOk=null,this._actualErr=null,this._hasValue=!1,this._value=null,this._hasErr=!1,this._err=null}get[Symbol.toStringTag](){return this.toString()}_ensureActual(){return this._actual||(this._actual=new Promise((e,t)=>{this._actualOk=e,this._actualErr=t,this._hasValue&&this._actualOk(this._value),this._hasErr&&this._actualErr(this._err)})),this._actual}resolveOk(e){this._hasValue||this._hasErr||(this._hasValue=!0,this._value=e,this._actual&&this._actualOk(e))}resolveErr(e){this._hasValue||this._hasErr||(this._hasErr=!0,this._err=e,this._actual?this._actualErr(e):nn(e))}then(e,t){return this._ensureActual().then(e,t)}catch(e){return this._ensureActual().then(void 0,e)}finally(e){return this._ensureActual().finally(e)}}class ZE extends Ux{constructor(){super(),this._hasErr=!0,this._err=new is}}var G0;function Bm(r,e){try{return JSON.stringify(r,e)}catch{return"null"}}const Ew="$$ref$$",YE={[Ew]:-1};function Q0(r,e=null,t=!1){const i=[];return{jsonString:(t?Bm:JSON.stringify)(r,(s,o)=>{if(typeof o>"u")return YE;if(typeof o=="object"){if(o instanceof _e){const a=i.push(o)-1;return{[Ew]:a}}if(e)return e(s,o)}return o}),referencedBuffers:i}}function Bx(r,e,t){return JSON.parse(r,(i,n)=>{if(n){const s=n[Ew];if(typeof s=="number")return e[s];if(t&&n.$mid===1)return t.transformIncoming(n)}return n})}function J0(r,e){return JSON.stringify(r,e)}function ek(r){return r?(e,t)=>t&&t.$mid===1?r.transformOutgoing(t):t:null}const tk=()=>{},ik=Symbol.for("rpcProtocol"),nk=Symbol.for("rpcProxy"),Sl=class Sl extends Fe{constructor(e,t=null,i=null){super(),this[G0]=!0,this._onDidChangeResponsiveState=this._register(new R),this.onDidChangeResponsiveState=this._onDidChangeResponsiveState.event,this._protocol=e,this._logger=t,this._uriTransformer=i,this._uriReplacer=ek(this._uriTransformer),this._isDisposed=!1,this._locals=[],this._proxies=[];for(let n=0,s=ph.count;n<s;n++)this._locals[n]=null,this._proxies[n]=null;this._lastMessageId=0,this._cancelInvokedHandlers=Object.create(null),this._pendingRPCReplies={},this._responsiveState=0,this._unacknowledgedCount=0,this._unresponsiveTime=0,this._asyncCheckUresponsive=this._register(new id(()=>this._checkUnresponsive(),1e3)),this._protocol.onMessage(n=>this._receiveOneMessage(n))}dispose(){this._isDisposed=!0,Object.keys(this._pendingRPCReplies).forEach(e=>{const t=this._pendingRPCReplies[e];delete this._pendingRPCReplies[e],t.resolveErr(m0())}),super.dispose()}drain(){return typeof this._protocol.drain=="function"?this._protocol.drain():Promise.resolve()}_onWillSendRequest(e){this._unacknowledgedCount===0&&(this._unresponsiveTime=Date.now()+Sl.UNRESPONSIVE_TIME),this._unacknowledgedCount++,this._asyncCheckUresponsive.isScheduled()||this._asyncCheckUresponsive.schedule()}_onDidReceiveAcknowledge(e){this._unresponsiveTime=Date.now()+Sl.UNRESPONSIVE_TIME,this._unacknowledgedCount--,this._unacknowledgedCount===0&&this._asyncCheckUresponsive.cancel(),this._setResponsiveState(0)}_checkUnresponsive(){this._unacknowledgedCount!==0&&(Date.now()>this._unresponsiveTime?this._setResponsiveState(1):this._asyncCheckUresponsive.schedule())}_setResponsiveState(e){this._responsiveState!==e&&(this._responsiveState=e,this._onDidChangeResponsiveState.fire(this._responsiveState))}get responsiveState(){return this._responsiveState}transformIncomingURIs(e){return this._uriTransformer?Lc(e,this._uriTransformer):e}getProxy(e){const{nid:t,sid:i}=e;return this._proxies[t]||(this._proxies[t]=this._createProxy(t,i)),this._proxies[t]}_createProxy(e,t){const i={get:(n,s)=>(typeof s=="string"&&!n[s]&&s.charCodeAt(0)===36&&(n[s]=(...o)=>this._remoteCall(e,s,o)),s===nk?t:n[s])};return new Proxy(Object.create(null),i)}set(e,t){return this._locals[e.nid]=t,t}assertRegistered(e){for(let t=0,i=e.length;t<i;t++){const n=e[t];if(!this._locals[n.nid])throw new Error(`Missing proxy instance ${n.sid}`)}}_receiveOneMessage(e){var o;if(this._isDisposed)return;const t=e.byteLength,i=ht.read(e,0),n=i.readUInt8(),s=i.readUInt32();switch(n){case 1:case 2:{let{rpcId:a,method:c,args:l}=yi.deserializeRequestJSONArgs(i);this._uriTransformer&&(l=Lc(l,this._uriTransformer)),this._receiveRequest(t,s,a,c,l,n===2);break}case 3:case 4:{let{rpcId:a,method:c,args:l}=yi.deserializeRequestMixedArgs(i);this._uriTransformer&&(l=Lc(l,this._uriTransformer)),this._receiveRequest(t,s,a,c,l,n===4);break}case 5:{(o=this._logger)==null||o.logIncoming(t,s,0,"ack"),this._onDidReceiveAcknowledge(s);break}case 6:{this._receiveCancel(t,s);break}case 7:{this._receiveReply(t,s,void 0);break}case 9:{let a=yi.deserializeReplyOKJSON(i);this._uriTransformer&&(a=Lc(a,this._uriTransformer)),this._receiveReply(t,s,a);break}case 10:{const a=yi.deserializeReplyOKJSONWithBuffers(i,this._uriTransformer);this._receiveReply(t,s,a);break}case 8:{const a=yi.deserializeReplyOKVSBuffer(i);this._receiveReply(t,s,a);break}case 11:{let a=yi.deserializeReplyErrError(i);this._uriTransformer&&(a=Lc(a,this._uriTransformer)),this._receiveReplyErr(t,s,a);break}case 12:{this._receiveReplyErr(t,s,void 0);break}default:console.error("received unexpected message"),console.error(e)}}_receiveRequest(e,t,i,n,s,o){var d,f;(d=this._logger)==null||d.logIncoming(e,t,1,`receiveRequest ${Ed(i)}.${n}(`,s);const a=String(t);let c,l;if(o){const m=new Tt;s.push(m.token),c=this._invokeHandler(i,n,s),l=()=>m.cancel()}else c=this._invokeHandler(i,n,s),l=tk;this._cancelInvokedHandlers[a]=l;const u=yi.serializeAcknowledged(t);(f=this._logger)==null||f.logOutgoing(u.byteLength,t,1,"ack"),this._protocol.send(u),c.then(m=>{var _;delete this._cancelInvokedHandlers[a];const b=yi.serializeReplyOK(t,m,this._uriReplacer);(_=this._logger)==null||_.logOutgoing(b.byteLength,t,1,"reply:",m),this._protocol.send(b)},m=>{var _;delete this._cancelInvokedHandlers[a];const b=yi.serializeReplyErr(t,m);(_=this._logger)==null||_.logOutgoing(b.byteLength,t,1,"replyErr:",m),this._protocol.send(b)})}_receiveCancel(e,t){var n,s,o;(n=this._logger)==null||n.logIncoming(e,t,1,"receiveCancel");const i=String(t);(o=(s=this._cancelInvokedHandlers)[i])==null||o.call(s)}_receiveReply(e,t,i){var o;(o=this._logger)==null||o.logIncoming(e,t,0,"receiveReply:",i);const n=String(t);if(!this._pendingRPCReplies.hasOwnProperty(n))return;const s=this._pendingRPCReplies[n];delete this._pendingRPCReplies[n],s.resolveOk(i)}_receiveReplyErr(e,t,i){var a;(a=this._logger)==null||a.logIncoming(e,t,0,"receiveReplyErr:",i);const n=String(t);if(!this._pendingRPCReplies.hasOwnProperty(n))return;const s=this._pendingRPCReplies[n];delete this._pendingRPCReplies[n];let o;i&&(i.$isError?(o=new Error,o.name=i.name,o.message=i.message,o.stack=i.stack):o=i),s.resolveErr(o)}_invokeHandler(e,t,i){try{return Promise.resolve(this._doInvokeHandler(e,t,i))}catch(n){return Promise.reject(n)}}_doInvokeHandler(e,t,i){const n=this._locals[e];if(!n)throw new Error("Unknown actor "+Ed(e));const s=n[t];if(typeof s!="function")throw new Error("Unknown method "+t+" on actor "+Ed(e));return s.apply(n,i)}_remoteCall(e,t,i){var d;if(this._isDisposed)return new ZE;let n=null;if(i.length>0&&bt.isCancellationToken(i[i.length-1])&&(n=i.pop()),n&&n.isCancellationRequested)return Promise.reject(m0());const s=yi.serializeRequestArguments(i,this._uriReplacer),o=++this._lastMessageId,a=String(o),c=new Ux,l=new Te;n&&l.add(n.onCancellationRequested(()=>{var m;const f=yi.serializeCancel(o);(m=this._logger)==null||m.logOutgoing(f.byteLength,o,0,"cancel"),this._protocol.send(yi.serializeCancel(o))})),this._pendingRPCReplies[a]=new rk(c,l),this._onWillSendRequest(o);const u=yi.serializeRequest(o,e,t,s,!!n);return(d=this._logger)==null||d.logOutgoing(u.byteLength,o,0,`request: ${Ed(e)}.${t}(`,i),this._protocol.send(u),c}};G0=ik,Sl.UNRESPONSIVE_TIME=3*1e3;let Vm=Sl;class rk{constructor(e,t){this._promise=e,this._disposable=t}resolveOk(e){this._promise.resolveOk(e),this._disposable.dispose()}resolveErr(e){this._promise.resolveErr(e),this._disposable.dispose()}}const El=class El{static alloc(e,t,i){const n=new El(_e.alloc(i+1+4),0);return n.writeUInt8(e),n.writeUInt32(t),n}static read(e,t){return new El(e,t)}get buffer(){return this._buff}constructor(e,t){this._buff=e,this._offset=t}static sizeUInt8(){return 1}writeUInt8(e){this._buff.writeUInt8(e,this._offset),this._offset+=1}readUInt8(){const e=this._buff.readUInt8(this._offset);return this._offset+=1,e}writeUInt32(e){this._buff.writeUInt32BE(e,this._offset),this._offset+=4}readUInt32(){const e=this._buff.readUInt32BE(this._offset);return this._offset+=4,e}static sizeShortString(e){return 1+e.byteLength}writeShortString(e){this._buff.writeUInt8(e.byteLength,this._offset),this._offset+=1,this._buff.set(e,this._offset),this._offset+=e.byteLength}readShortString(){const e=this._buff.readUInt8(this._offset);this._offset+=1;const i=this._buff.slice(this._offset,this._offset+e).toString();return this._offset+=e,i}static sizeLongString(e){return 4+e.byteLength}writeLongString(e){this._buff.writeUInt32BE(e.byteLength,this._offset),this._offset+=4,this._buff.set(e,this._offset),this._offset+=e.byteLength}readLongString(){const e=this._buff.readUInt32BE(this._offset);this._offset+=4;const i=this._buff.slice(this._offset,this._offset+e).toString();return this._offset+=e,i}writeBuffer(e){this._buff.writeUInt32BE(e.byteLength,this._offset),this._offset+=4,this._buff.set(e,this._offset),this._offset+=e.byteLength}static sizeVSBuffer(e){return 4+e.byteLength}writeVSBuffer(e){this._buff.writeUInt32BE(e.byteLength,this._offset),this._offset+=4,this._buff.set(e,this._offset),this._offset+=e.byteLength}readVSBuffer(){const e=this._buff.readUInt32BE(this._offset);this._offset+=4;const t=this._buff.slice(this._offset,this._offset+e);return this._offset+=e,t}static sizeMixedArray(e){let t=0;t+=1;for(let i=0,n=e.length;i<n;i++){const s=e[i];switch(t+=1,s.type){case 1:t+=this.sizeLongString(s.value);break;case 2:t+=this.sizeVSBuffer(s.value);break;case 3:t+=this.sizeUInt32,t+=this.sizeLongString(s.value);for(let o=0;o<s.buffers.length;++o)t+=this.sizeVSBuffer(s.buffers[o]);break}}return t}writeMixedArray(e){this._buff.writeUInt8(e.length,this._offset),this._offset+=1;for(let t=0,i=e.length;t<i;t++){const n=e[t];switch(n.type){case 1:this.writeUInt8(1),this.writeLongString(n.value);break;case 2:this.writeUInt8(2),this.writeVSBuffer(n.value);break;case 3:this.writeUInt8(3),this.writeUInt32(n.buffers.length),this.writeLongString(n.value);for(let s=0;s<n.buffers.length;++s)this.writeBuffer(n.buffers[s]);break;case 4:this.writeUInt8(4);break}}}readMixedArray(){const e=this._buff.readUInt8(this._offset);this._offset+=1;const t=new Array(e);for(let i=0;i<e;i++)switch(this.readUInt8()){case 1:t[i]=this.readLongString();break;case 2:t[i]=this.readVSBuffer();break;case 3:{const s=this.readUInt32(),o=this.readLongString(),a=[];for(let c=0;c<s;++c)a.push(this.readVSBuffer());t[i]=new Di(Bx(o,a,null));break}case 4:t[i]=void 0;break}return t}};El.sizeUInt32=4;let ht=El;class yi{static _useMixedArgSerialization(e){for(let t=0,i=e.length;t<i;t++)if(e[t]instanceof _e||e[t]instanceof Di||typeof e[t]>"u")return!0;return!1}static serializeRequestArguments(e,t){if(this._useMixedArgSerialization(e)){const i=[];for(let n=0,s=e.length;n<s;n++){const o=e[n];if(o instanceof _e)i[n]={type:2,value:o};else if(typeof o>"u")i[n]={type:4};else if(o instanceof Di){const{jsonString:a,referencedBuffers:c}=Q0(o.value,t);i[n]={type:3,value:_e.fromString(a),buffers:c}}else i[n]={type:1,value:_e.fromString(J0(o,t))}}return{type:1,args:i}}return{type:0,args:J0(e,t)}}static serializeRequest(e,t,i,n,s){switch(n.type){case 0:return this._requestJSONArgs(e,t,i,n.args,s);case 1:return this._requestMixedArgs(e,t,i,n.args,s)}}static _requestJSONArgs(e,t,i,n,s){const o=_e.fromString(i),a=_e.fromString(n);let c=0;c+=ht.sizeUInt8(),c+=ht.sizeShortString(o),c+=ht.sizeLongString(a);const l=ht.alloc(s?2:1,e,c);return l.writeUInt8(t),l.writeShortString(o),l.writeLongString(a),l.buffer}static deserializeRequestJSONArgs(e){const t=e.readUInt8(),i=e.readShortString(),n=e.readLongString();return{rpcId:t,method:i,args:JSON.parse(n)}}static _requestMixedArgs(e,t,i,n,s){const o=_e.fromString(i);let a=0;a+=ht.sizeUInt8(),a+=ht.sizeShortString(o),a+=ht.sizeMixedArray(n);const c=ht.alloc(s?4:3,e,a);return c.writeUInt8(t),c.writeShortString(o),c.writeMixedArray(n),c.buffer}static deserializeRequestMixedArgs(e){const t=e.readUInt8(),i=e.readShortString(),n=e.readMixedArray(),s=new Array(n.length);for(let o=0,a=n.length;o<a;o++){const c=n[o];typeof c=="string"?s[o]=JSON.parse(c):s[o]=c}return{rpcId:t,method:i,args:s}}static serializeAcknowledged(e){return ht.alloc(5,e,0).buffer}static serializeCancel(e){return ht.alloc(6,e,0).buffer}static serializeReplyOK(e,t,i){if(typeof t>"u")return this._serializeReplyOKEmpty(e);if(t instanceof _e)return this._serializeReplyOKVSBuffer(e,t);if(t instanceof Di){const{jsonString:n,referencedBuffers:s}=Q0(t.value,i,!0);return this._serializeReplyOKJSONWithBuffers(e,n,s)}else return this._serializeReplyOKJSON(e,Bm(t,i))}static _serializeReplyOKEmpty(e){return ht.alloc(7,e,0).buffer}static _serializeReplyOKVSBuffer(e,t){let i=0;i+=ht.sizeVSBuffer(t);const n=ht.alloc(8,e,i);return n.writeVSBuffer(t),n.buffer}static deserializeReplyOKVSBuffer(e){return e.readVSBuffer()}static _serializeReplyOKJSON(e,t){const i=_e.fromString(t);let n=0;n+=ht.sizeLongString(i);const s=ht.alloc(9,e,n);return s.writeLongString(i),s.buffer}static _serializeReplyOKJSONWithBuffers(e,t,i){const n=_e.fromString(t);let s=0;s+=ht.sizeUInt32,s+=ht.sizeLongString(n);for(const a of i)s+=ht.sizeVSBuffer(a);const o=ht.alloc(10,e,s);o.writeUInt32(i.length),o.writeLongString(n);for(const a of i)o.writeBuffer(a);return o.buffer}static deserializeReplyOKJSON(e){const t=e.readLongString();return JSON.parse(t)}static deserializeReplyOKJSONWithBuffers(e,t){const i=e.readUInt32(),n=e.readLongString(),s=[];for(let o=0;o<i;++o)s.push(e.readVSBuffer());return new Di(Bx(n,s,t))}static serializeReplyErr(e,t){const i=t?Bm(lh(t),null):void 0;if(typeof i!="string")return this._serializeReplyErrEmpty(e);const n=_e.fromString(i);let s=0;s+=ht.sizeLongString(n);const o=ht.alloc(11,e,s);return o.writeLongString(n),o.buffer}static deserializeReplyErrError(e){const t=e.readLongString();return JSON.parse(t)}static _serializeReplyErrEmpty(e){return ht.alloc(12,e,0).buffer}}var Xi;(function(r){r.serviceIds=new Map,r.DI_TARGET="$di$target",r.DI_DEPENDENCIES="$di$dependencies";function e(t){return t[r.DI_DEPENDENCIES]||[]}r.getServiceDependencies=e})(Xi||(Xi={}));const Qp=Ce("instantiationService");function sk(r,e,t){e[Xi.DI_TARGET]===e?e[Xi.DI_DEPENDENCIES].push({id:r,index:t}):(e[Xi.DI_DEPENDENCIES]=[{id:r,index:t}],e[Xi.DI_TARGET]=e)}function Ce(r){if(Xi.serviceIds.has(r))return Xi.serviceIds.get(r);const e=function(t,i,n){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");sk(e,t,n)};return e.toString=()=>r,Xi.serviceIds.set(r,e),e}const Je=Ce("logService"),yc=Ce("loggerService");class pn{constructor(e,t=[],i=!1){this.ctor=e,this.staticArguments=t,this.supportsDelayedInstantiation=i}}const Vx=[];function it(r,e,t){e instanceof pn||(e=new pn(e,[],!!t)),Vx.push([r,e])}function ok(){return Vx}class kw{constructor(...e){this._entries=new Map;for(const[t,i]of e)this.set(t,i)}set(e,t){const i=this._entries.get(e);return this._entries.set(e,t),i}has(e){return this._entries.has(e)}get(e){return this._entries.get(e)}}const jt=Ce("IExtHostInitDataService");let ak=class{constructor(e,t){this.key=e,this.data=t,this.incoming=new Map,this.outgoing=new Map}};class K0{constructor(e){this._hashFn=e,this._nodes=new Map}roots(){const e=[];for(const t of this._nodes.values())t.outgoing.size===0&&e.push(t);return e}insertEdge(e,t){const i=this.lookupOrInsertNode(e),n=this.lookupOrInsertNode(t);i.outgoing.set(n.key,n),n.incoming.set(i.key,i)}removeNode(e){const t=this._hashFn(e);this._nodes.delete(t);for(const i of this._nodes.values())i.outgoing.delete(t),i.incoming.delete(t)}lookupOrInsertNode(e){const t=this._hashFn(e);let i=this._nodes.get(t);return i||(i=new ak(t,e),this._nodes.set(t,i)),i}lookup(e){return this._nodes.get(this._hashFn(e))}isEmpty(){return this._nodes.size===0}toString(){const e=[];for(const[t,i]of this._nodes)e.push(`${t}
	(-> incoming)[${[...i.incoming.keys()].join(", ")}]
	(outgoing ->)[${[...i.outgoing.keys()].join(",")}]
`);return e.join(`
`)}findCycleSlow(){for(const[e,t]of this._nodes){const i=new Set([e]),n=this._findCycle(t,i);if(n)return n}}_findCycle(e,t){for(const[i,n]of e.outgoing){if(t.has(i))return[...t,i].join(" -> ");t.add(i);const s=this._findCycle(n,t);if(s)return s;t.delete(i)}}}const ck=!1;class X0 extends Error{constructor(e){super("cyclic dependency between services"),this.message=e.findCycleSlow()??`UNABLE to detect cycle, dumping graph: 
${e.toString()}`}}class wh{constructor(e=new kw,t=!1,i,n=ck){this._services=e,this._strict=t,this._parent=i,this._enableTracing=n,this._isDisposed=!1,this._servicesToMaybeDispose=new Set,this._children=new Set,this._activeInstantiations=new Set,this._services.set(Qp,this),this._globalGraph=n?(i==null?void 0:i._globalGraph)??new K0(s=>s):void 0}dispose(){if(!this._isDisposed){this._isDisposed=!0,Gr(this._children),this._children.clear();for(const e of this._servicesToMaybeDispose)o4(e)&&e.dispose();this._servicesToMaybeDispose.clear()}}_throwIfDisposed(){if(this._isDisposed)throw new Error("InstantiationService has been disposed")}createChild(e){this._throwIfDisposed();const t=new class extends wh{dispose(){this._children.delete(t),super.dispose()}}(e,this._strict,this,this._enableTracing);return this._children.add(t),t}invokeFunction(e,...t){this._throwIfDisposed();const i=nl.traceInvocation(this._enableTracing,e);let n=!1;try{return e({get:o=>{if(n)throw fw("service accessor is only valid during the invocation of its target method");const a=this._getOrCreateServiceInstance(o,i);if(!a)throw new Error(`[invokeFunction] unknown service '${o}'`);return a}},...t)}finally{n=!0,i.stop()}}createInstance(e,...t){this._throwIfDisposed();let i,n;return e instanceof pn?(i=nl.traceCreation(this._enableTracing,e.ctor),n=this._createInstance(e.ctor,e.staticArguments.concat(t),i)):(i=nl.traceCreation(this._enableTracing,e),n=this._createInstance(e,t,i)),i.stop(),n}_createInstance(e,t=[],i){const n=Xi.getServiceDependencies(e).sort((a,c)=>a.index-c.index),s=[];for(const a of n){const c=this._getOrCreateServiceInstance(a.id,i);c||this._throwIfStrict(`[createInstance] ${e.name} depends on UNKNOWN service ${a.id}.`,!1),s.push(c)}const o=n.length>0?n[0].index:t.length;if(t.length!==o){console.trace(`[createInstance] First service dependency of ${e.name} at position ${o+1} conflicts with ${t.length} static arguments`);const a=o-t.length;a>0?t=t.concat(new Array(a)):t=t.slice(0,o)}return Reflect.construct(e,t.concat(s))}_setCreatedServiceInstance(e,t){if(this._services.get(e)instanceof pn)this._services.set(e,t);else if(this._parent)this._parent._setCreatedServiceInstance(e,t);else throw new Error("illegalState - setting UNKNOWN service instance")}_getServiceInstanceOrDescriptor(e){const t=this._services.get(e);return!t&&this._parent?this._parent._getServiceInstanceOrDescriptor(e):t}_getOrCreateServiceInstance(e,t){this._globalGraph&&this._globalGraphImplicitDependency&&this._globalGraph.insertEdge(this._globalGraphImplicitDependency,String(e));const i=this._getServiceInstanceOrDescriptor(e);return i instanceof pn?this._safeCreateAndCacheServiceInstance(e,i,t.branch(e,!0)):(t.branch(e,!1),i)}_safeCreateAndCacheServiceInstance(e,t,i){if(this._activeInstantiations.has(e))throw new Error(`illegal state - RECURSIVELY instantiating service '${e}'`);this._activeInstantiations.add(e);try{return this._createAndCacheServiceInstance(e,t,i)}finally{this._activeInstantiations.delete(e)}}_createAndCacheServiceInstance(e,t,i){var a;const n=new K0(c=>c.id.toString());let s=0;const o=[{id:e,desc:t,_trace:i}];for(;o.length;){const c=o.pop();if(n.lookupOrInsertNode(c),s++>1e3)throw new X0(n);for(const l of Xi.getServiceDependencies(c.desc.ctor)){const u=this._getServiceInstanceOrDescriptor(l.id);if(u||this._throwIfStrict(`[createInstance] ${e} depends on ${l.id} which is NOT registered.`,!0),(a=this._globalGraph)==null||a.insertEdge(String(c.id),String(l.id)),u instanceof pn){const d={id:l.id,desc:u,_trace:c._trace.branch(l.id,!0)};n.lookup(d)||o.push(d),n.insertEdge(c,d)}}}for(;;){const c=n.roots();if(c.length===0){if(!n.isEmpty())throw new X0(n);break}for(const{data:l}of c){if(this._getServiceInstanceOrDescriptor(l.id)instanceof pn){const d=this._createServiceInstanceWithOwner(l.id,l.desc.ctor,l.desc.staticArguments,l.desc.supportsDelayedInstantiation,l._trace);this._setCreatedServiceInstance(l.id,d)}n.removeNode(l)}}return this._getServiceInstanceOrDescriptor(e)}_createServiceInstanceWithOwner(e,t,i=[],n,s){if(this._services.get(e)instanceof pn)return this._createServiceInstance(e,t,i,n,s,this._servicesToMaybeDispose);if(this._parent)return this._parent._createServiceInstanceWithOwner(e,t,i,n,s);throw new Error(`illegalState - creating UNKNOWN service instance ${t.name}`)}_createServiceInstance(e,t,i=[],n,s,o){if(n){const a=new wh(void 0,this._strict,this,this._enableTracing);a._globalGraphImplicitDependency=String(e);const c=new Map,l=new XE(()=>{const u=a._createInstance(t,i,s);for(const[d,f]of c){const m=u[d];if(typeof m=="function")for(const b of f)b.disposable=m.apply(u,b.listener)}return c.clear(),o.add(u),u});return new Proxy(Object.create(null),{get(u,d){if(!l.isInitialized&&typeof d=="string"&&(d.startsWith("onDid")||d.startsWith("onWill"))){let b=c.get(d);return b||(b=new Yu,c.set(d,b)),(v,k,D)=>{if(l.isInitialized)return l.value[d](v,k,D);{const E={listener:[v,k,D],disposable:void 0},N=b.push(E);return De(()=>{var j;N(),(j=E.disposable)==null||j.dispose()})}}}if(d in u)return u[d];const f=l.value;let m=f[d];return typeof m!="function"||(m=m.bind(f),u[d]=m),m},set(u,d,f){return l.value[d]=f,!0},getPrototypeOf(u){return t.prototype}})}else{const a=this._createInstance(t,i,s);return o.add(a),a}}_throwIfStrict(e,t){if(t&&console.warn(e),this._strict)throw new Error(e)}}const hi=class hi{static traceInvocation(e,t){return e?new hi(2,t.name||new Error().stack.split(`
`).slice(3,4).join(`
`)):hi._None}static traceCreation(e,t){return e?new hi(1,t.name):hi._None}constructor(e,t){this.type=e,this.name=t,this._start=Date.now(),this._dep=[]}branch(e,t){const i=new hi(3,e.toString());return this._dep.push([e,t,i]),i}stop(){const e=Date.now()-this._start;hi._totals+=e;let t=!1;function i(s,o){const a=[],c=new Array(s+1).join("	");for(const[l,u,d]of o._dep)if(u&&d){t=!0,a.push(`${c}CREATES -> ${l}`);const f=i(s+1,d);f&&a.push(f)}else a.push(`${c}uses -> ${l}`);return a.join(`
`)}const n=[`${this.type===1?"CREATE":"CALL"} ${this.name}`,`${i(1,this)}`,`DONE, took ${e.toFixed(2)}ms (grand total ${hi._totals.toFixed(2)}ms)`];(e>2||t)&&hi.all.add(n.join(`
`))}};hi.all=new Set,hi._None=new class extends hi{constructor(){super(0,null)}stop(){}branch(){return this}},hi._totals=0;let nl=hi;const Ve=Ce("IExtHostRpcService");class lk{constructor(e){this.getProxy=e.getProxy.bind(e),this.set=e.set.bind(e),this.dispose=e.dispose.bind(e),this.assertRegistered=e.assertRegistered.bind(e),this.drain=e.drain.bind(e)}}const Jp=Ce("IURITransformerService");class uk{constructor(e){e?(this.transformIncoming=e.transformIncoming.bind(e),this.transformOutgoing=e.transformOutgoing.bind(e),this.transformOutgoingURI=e.transformOutgoingURI.bind(e),this.transformOutgoingScheme=e.transformOutgoingScheme.bind(e)):(this.transformIncoming=t=>t,this.transformOutgoing=t=>t,this.transformOutgoingURI=t=>t,this.transformOutgoingScheme=t=>t)}}function U(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(n<3?o(s):n>3?o(e,t,s):o(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s}function M(r,e){return function(t,i){e(t,i,r)}}class dk{constructor(){this._value="",this._pos=0}reset(e){return this._value=e,this._pos=0,this}next(){return this._pos+=1,this}hasNext(){return this._pos<this._value.length-1}cmp(e){const t=e.charCodeAt(0),i=this._value.charCodeAt(this._pos);return t-i}value(){return this._value[this._pos]}}class hk{constructor(e=!0){this._caseSensitive=e}reset(e){return this._value=e,this._from=0,this._to=0,this.next()}hasNext(){return this._to<this._value.length}next(){this._from=this._to;let e=!0;for(;this._to<this._value.length;this._to++)if(this._value.charCodeAt(this._to)===46)if(e)this._from++;else break;else e=!1;return this}cmp(e){return this._caseSensitive?yw(e,this._value,0,e.length,this._from,this._to):ed(e,this._value,0,e.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}}class Wx{constructor(e=!0,t=!0){this._splitOnBackslash=e,this._caseSensitive=t}reset(e){this._from=0,this._to=0,this._value=e,this._valueLen=e.length;for(let t=e.length-1;t>=0;t--,this._valueLen--){const i=this._value.charCodeAt(t);if(!(i===47||this._splitOnBackslash&&i===92))break}return this.next()}hasNext(){return this._to<this._valueLen}next(){this._from=this._to;let e=!0;for(;this._to<this._valueLen;this._to++){const t=this._value.charCodeAt(this._to);if(t===47||this._splitOnBackslash&&t===92)if(e)this._from++;else break;else e=!1}return this}cmp(e){return this._caseSensitive?yw(e,this._value,0,e.length,this._from,this._to):ed(e,this._value,0,e.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}}class fk{constructor(e,t){this._ignorePathCasing=e,this._ignoreQueryAndFragment=t,this._states=[],this._stateIdx=0}reset(e){return this._value=e,this._states=[],this._value.scheme&&this._states.push(1),this._value.authority&&this._states.push(2),this._value.path&&(this._pathIterator=new Wx(!1,!this._ignorePathCasing(e)),this._pathIterator.reset(e.path),this._pathIterator.value()&&this._states.push(3)),this._ignoreQueryAndFragment(e)||(this._value.query&&this._states.push(4),this._value.fragment&&this._states.push(5)),this._stateIdx=0,this}next(){return this._states[this._stateIdx]===3&&this._pathIterator.hasNext()?this._pathIterator.next():this._stateIdx+=1,this}hasNext(){return this._states[this._stateIdx]===3&&this._pathIterator.hasNext()||this._stateIdx<this._states.length-1}cmp(e){if(this._states[this._stateIdx]===1)return M0(e,this._value.scheme);if(this._states[this._stateIdx]===2)return M0(e,this._value.authority);if(this._states[this._stateIdx]===3)return this._pathIterator.cmp(e);if(this._states[this._stateIdx]===4)return fo(e,this._value.query);if(this._states[this._stateIdx]===5)return fo(e,this._value.fragment);throw new Error}value(){if(this._states[this._stateIdx]===1)return this._value.scheme;if(this._states[this._stateIdx]===2)return this._value.authority;if(this._states[this._stateIdx]===3)return this._pathIterator.value();if(this._states[this._stateIdx]===4)return this._value.query;if(this._states[this._stateIdx]===5)return this._value.fragment;throw new Error}}class kd{constructor(){this.height=1}isEmpty(){return!this.left&&!this.mid&&!this.right&&!this.value}rotateLeft(){const e=this.right;return this.right=e.left,e.left=this,this.updateHeight(),e.updateHeight(),e}rotateRight(){const e=this.left;return this.left=e.right,e.right=this,this.updateHeight(),e.updateHeight(),e}updateHeight(){this.height=1+Math.max(this.heightLeft,this.heightRight)}balanceFactor(){return this.heightRight-this.heightLeft}get heightLeft(){var e;return((e=this.left)==null?void 0:e.height)??0}get heightRight(){var e;return((e=this.right)==null?void 0:e.height)??0}}class Gn{static forUris(e=()=>!1,t=()=>!1){return new Gn(new fk(e,t))}static forPaths(e=!1){return new Gn(new Wx(void 0,!e))}static forStrings(){return new Gn(new dk)}static forConfigKeys(){return new Gn(new hk)}constructor(e){this._iter=e}clear(){this._root=void 0}fill(e,t){if(t){const i=t.slice(0);v0(i);for(const n of i)this.set(n,e)}else{const i=e.slice(0);v0(i);for(const n of i)this.set(n[0],n[1])}}set(e,t){const i=this._iter.reset(e);let n;this._root||(this._root=new kd,this._root.segment=i.value());const s=[];for(n=this._root;;){const a=i.cmp(n.segment);if(a>0)n.left||(n.left=new kd,n.left.segment=i.value()),s.push([-1,n]),n=n.left;else if(a<0)n.right||(n.right=new kd,n.right.segment=i.value()),s.push([1,n]),n=n.right;else if(i.hasNext())i.next(),n.mid||(n.mid=new kd,n.mid.segment=i.value()),s.push([0,n]),n=n.mid;else break}const o=n.value;n.value=t,n.key=e;for(let a=s.length-1;a>=0;a--){const c=s[a][1];c.updateHeight();const l=c.balanceFactor();if(l<-1||l>1){const u=s[a][0],d=s[a+1][0];if(u===1&&d===1)s[a][1]=c.rotateLeft();else if(u===-1&&d===-1)s[a][1]=c.rotateRight();else if(u===1&&d===-1)c.right=s[a+1][1]=s[a+1][1].rotateRight(),s[a][1]=c.rotateLeft();else if(u===-1&&d===1)c.left=s[a+1][1]=s[a+1][1].rotateLeft(),s[a][1]=c.rotateRight();else throw new Error;if(a>0)switch(s[a-1][0]){case-1:s[a-1][1].left=s[a][1];break;case 1:s[a-1][1].right=s[a][1];break;case 0:s[a-1][1].mid=s[a][1];break}else this._root=s[0][1]}}return o}get(e){var t;return(t=this._getNode(e))==null?void 0:t.value}_getNode(e){const t=this._iter.reset(e);let i=this._root;for(;i;){const n=t.cmp(i.segment);if(n>0)i=i.left;else if(n<0)i=i.right;else if(t.hasNext())t.next(),i=i.mid;else break}return i}has(e){const t=this._getNode(e);return!((t==null?void 0:t.value)===void 0&&(t==null?void 0:t.mid)===void 0)}delete(e){return this._delete(e,!1)}deleteSuperstr(e){return this._delete(e,!0)}_delete(e,t){const i=this._iter.reset(e),n=[];let s=this._root;for(;s;){const o=i.cmp(s.segment);if(o>0)n.push([-1,s]),s=s.left;else if(o<0)n.push([1,s]),s=s.right;else if(i.hasNext())i.next(),n.push([0,s]),s=s.mid;else break}if(s){if(t?(s.left=void 0,s.mid=void 0,s.right=void 0,s.height=1):(s.key=void 0,s.value=void 0),!s.mid&&!s.value)if(s.left&&s.right){const o=this._min(s.right);if(o.key){const{key:a,value:c,segment:l}=o;this._delete(o.key,!1),s.key=a,s.value=c,s.segment=l}}else{const o=s.left??s.right;if(n.length>0){const[a,c]=n[n.length-1];switch(a){case-1:c.left=o;break;case 0:c.mid=o;break;case 1:c.right=o;break}}else this._root=o}for(let o=n.length-1;o>=0;o--){const a=n[o][1];a.updateHeight();const c=a.balanceFactor();if(c>1?(a.right.balanceFactor()>=0||(a.right=a.right.rotateRight()),n[o][1]=a.rotateLeft()):c<-1&&(a.left.balanceFactor()<=0||(a.left=a.left.rotateLeft()),n[o][1]=a.rotateRight()),o>0)switch(n[o-1][0]){case-1:n[o-1][1].left=n[o][1];break;case 1:n[o-1][1].right=n[o][1];break;case 0:n[o-1][1].mid=n[o][1];break}else this._root=n[0][1]}}}_min(e){for(;e.left;)e=e.left;return e}findSubstr(e){const t=this._iter.reset(e);let i=this._root,n;for(;i;){const s=t.cmp(i.segment);if(s>0)i=i.left;else if(s<0)i=i.right;else if(t.hasNext())t.next(),n=i.value||n,i=i.mid;else break}return i&&i.value||n}findSuperstr(e){return this._findSuperstrOrElement(e,!1)}_findSuperstrOrElement(e,t){const i=this._iter.reset(e);let n=this._root;for(;n;){const s=i.cmp(n.segment);if(s>0)n=n.left;else if(s<0)n=n.right;else if(i.hasNext())i.next(),n=n.mid;else return n.mid?this._entries(n.mid):t?n.value:void 0}}hasElementOrSubtree(e){return this._findSuperstrOrElement(e,!0)!==void 0}forEach(e){for(const[t,i]of this)e(i,t)}*[Symbol.iterator](){yield*this._entries(this._root)}_entries(e){const t=[];return this._dfsEntries(e,t),t[Symbol.iterator]()}_dfsEntries(e,t){e&&(e.left&&this._dfsEntries(e.left,t),e.value&&t.push([e.key,e.value]),e.mid&&this._dfsEntries(e.mid,t),e.right&&this._dfsEntries(e.right,t))}_isBalanced(){const e=t=>{if(!t)return!0;const i=t.balanceFactor();return i<-1||i>1?!1:e(t.left)&&e(t.right)};return e(this._root)}}function ot(r){if(!r||typeof r!="object"||r instanceof RegExp)return r;const e=Array.isArray(r)?[]:{};return Object.entries(r).forEach(([t,i])=>{e[t]=i&&typeof i=="object"?ot(i):i}),e}function zx(r){if(!r||typeof r!="object")return r;const e=[r];for(;e.length>0;){const t=e.shift();for(const i in t)if(jx.call(t,i)){const n=t[i];typeof n=="object"&&!Object.isFrozen(n)&&!kE(n)&&e.push(n)}}return r}const jx=Object.prototype.hasOwnProperty;function bh(r,e){return Wm(r,e,new Set)}function Wm(r,e,t){if(Qt(r))return r;const i=e(r);if(typeof i<"u")return i;if(Array.isArray(r)){const n=[];for(const s of r)n.push(Wm(s,e,t));return n}if(Vt(r)){if(t.has(r))throw new Error("Cannot clone recursive data-structure");t.add(r);const n={};for(const s in r)jx.call(r,s)&&(n[s]=Wm(r[s],e,t));return t.delete(r),n}return r}function po(r,e,t=!0){return Vt(r)?(Vt(e)&&Object.keys(e).forEach(i=>{i in r?t&&(Vt(r[i])&&Vt(e[i])?po(r[i],e[i],t):r[i]=e[i]):r[i]=e[i]}),r):e}function tn(r,e){if(r===e)return!0;if(r==null||e===null||e===void 0||typeof r!=typeof e||typeof r!="object"||Array.isArray(r)!==Array.isArray(e))return!1;let t,i;if(Array.isArray(r)){if(r.length!==e.length)return!1;for(t=0;t<r.length;t++)if(!tn(r[t],e[t]))return!1}else{const n=[];for(i in r)n.push(i);n.sort();const s=[];for(i in e)s.push(i);if(s.sort(),!tn(n,s))return!1;for(t=0;t<n.length;t++)if(!tn(r[n[t]],e[n[t]]))return!1}return!0}function pk(r){const e=new Set;return JSON.stringify(r,(t,i)=>{if(Vt(i)||Array.isArray(i)){if(e.has(i))return"[Circular]";e.add(i)}return typeof i=="bigint"?`[BigInt ${i.toString()}]`:i})}function Z0(r,e){const t=Object.create(null);for(const[i,n]of Object.entries(r))e(i,n)&&(t[i]=n);return t}class gk{constructor(){this._next=0}getNext(){return this._next++}}var $l;(function(r){r[r.Ignore=0]="Ignore",r[r.Info=1]="Info",r[r.Warning=2]="Warning",r[r.Error=3]="Error"})($l||($l={}));(function(r){const e="error",t="warning",i="warn",n="info",s="ignore";function o(c){return c?Rr(e,c)?r.Error:Rr(t,c)||Rr(i,c)?r.Warning:Rr(n,c)?r.Info:r.Ignore:r.Ignore}r.fromValue=o;function a(c){switch(c){case r.Error:return e;case r.Warning:return t;case r.Info:return n;default:return s}}r.toString=a})($l||($l={}));var vt=$l,Y0;(function(r){r[r.DEFAULT=0]="DEFAULT",r[r.SILENT=1]="SILENT",r[r.URGENT=2]="URGENT"})(Y0||(Y0={}));var eb;(function(r){r[r.WORKSPACE=0]="WORKSPACE",r[r.PROFILE=1]="PROFILE",r[r.APPLICATION=2]="APPLICATION"})(eb||(eb={}));var tb;(function(r){r[r.OFF=0]="OFF",r[r.ERROR=1]="ERROR"})(tb||(tb={}));const mk="vs/platform/workspace/common/workspace";let vk=class{constructor(e,t,i,n,s){this._id=e,this._transient=i,this._configuration=n,this._ignorePathCasing=s,this._foldersMap=Gn.forUris(this._ignorePathCasing,()=>!0),this.folders=t}update(e){this._id=e.id,this._configuration=e.configuration,this._transient=e.transient,this._ignorePathCasing=e._ignorePathCasing,this.folders=e.folders}get folders(){return this._folders}set folders(e){this._folders=e,this.updateFoldersMap()}get id(){return this._id}get transient(){return this._transient}get configuration(){return this._configuration}set configuration(e){this._configuration=e}getFolder(e){return e&&this._foldersMap.findSubstr(e)||null}updateFoldersMap(){this._foldersMap=Gn.forUris(this._ignorePathCasing,()=>!0);for(const e of this.folders)this._foldersMap.set(e.uri,e)}toJSON(){return{id:this.id,folders:this.folders,transient:this.transient,configuration:this.configuration}}};class qx{constructor(e,t){this.raw=t,this.uri=e.uri,this.index=e.index,this.name=e.name}toResource(e){return wc(this.uri,e)}toJSON(){return{uri:this.uri,name:this.name,index:this.index}}}function ib(r){return new qx({uri:r,index:0,name:Mm(r)},{uri:r.toString()})}const _k="code-workspace";h(mk,0,"Code Workspace");class wk{constructor(){this._systemSchemes=new Set(Object.keys(ne)),this._providerInfo=new Map,this.extUri=new td(e=>{const t=this._providerInfo.get(e.scheme);return!(t===void 0||t&1024)})}$acceptProviderInfos(e,t){t===null?this._providerInfo.delete(e.scheme):this._providerInfo.set(e.scheme,t)}isFreeScheme(e){return!this._providerInfo.has(e)&&!this._systemSchemes.has(e)}getCapabilities(e){return this._providerInfo.get(e)}}const xc=Ce("IExtHostFileSystemInfo"),ar=function(){if(typeof crypto=="object"&&typeof crypto.randomUUID=="function")return crypto.randomUUID.bind(crypto);let r;typeof crypto=="object"&&typeof crypto.getRandomValues=="function"?r=crypto.getRandomValues.bind(crypto):r=function(i){for(let n=0;n<i.length;n++)i[n]=Math.floor(Math.random()*256);return i};const e=new Uint8Array(16),t=[];for(let i=0;i<256;i++)t.push(i.toString(16).padStart(2,"0"));return function(){r(e),e[6]=e[6]&15|64,e[8]=e[8]&63|128;let n=0,s="";return s+=t[e[n++]],s+=t[e[n++]],s+=t[e[n++]],s+=t[e[n++]],s+="-",s+=t[e[n++]],s+=t[e[n++]],s+="-",s+=t[e[n++]],s+=t[e[n++]],s+="-",s+=t[e[n++]],s+=t[e[n++]],s+="-",s+=t[e[n++]],s+=t[e[n++]],s+=t[e[n++]],s+=t[e[n++]],s+=t[e[n++]],s+=t[e[n++]],s}}(),zm=Object.freeze({create:r=>Wo(r.map(e=>e.toString())).join(`\r
`),split:r=>r.split(`\r
`),parse:r=>zm.split(r).filter(e=>!e.startsWith("#"))});Gx.bind(void 0,!1);Gx.bind(void 0,!0);function Gx(r,e,t){if(!t||t.length<e.length)return null;let i;return r?i=xw(t,e):i=t.indexOf(e)===0,i?e.length>0?[{start:0,end:e.length}]:[]:null}const bk=new Set;"()[]{}<>`'\"-/;:,.?!".split("").forEach(r=>bk.add(r.charCodeAt(0)));new gw(1e4);const nb=128;function Dw(){const r=[],e=[];for(let t=0;t<=nb;t++)e[t]=0;for(let t=0;t<=nb;t++)r.push(e.slice(0));return r}Dw();Dw();Dw();var rb;(function(r){r.Default=[-100,0];function e(t){return!t||t.length===2&&t[0]===-100&&t[1]===0}r.isDefault=e})(rb||(rb={}));const jm=Object.create(null);function p(r,e){if($e(e)){const t=jm[e];if(t===void 0)throw new Error(`${r} references an unknown codicon: ${e}`);e=t}return jm[r]=e,{id:r}}function yk(){return jm}const xk={add:p("add",6e4),plus:p("plus",6e4),gistNew:p("gist-new",6e4),repoCreate:p("repo-create",6e4),lightbulb:p("lightbulb",60001),lightBulb:p("light-bulb",60001),repo:p("repo",60002),repoDelete:p("repo-delete",60002),gistFork:p("gist-fork",60003),repoForked:p("repo-forked",60003),gitPullRequest:p("git-pull-request",60004),gitPullRequestAbandoned:p("git-pull-request-abandoned",60004),recordKeys:p("record-keys",60005),keyboard:p("keyboard",60005),tag:p("tag",60006),gitPullRequestLabel:p("git-pull-request-label",60006),tagAdd:p("tag-add",60006),tagRemove:p("tag-remove",60006),person:p("person",60007),personFollow:p("person-follow",60007),personOutline:p("person-outline",60007),personFilled:p("person-filled",60007),gitBranch:p("git-branch",60008),gitBranchCreate:p("git-branch-create",60008),gitBranchDelete:p("git-branch-delete",60008),sourceControl:p("source-control",60008),mirror:p("mirror",60009),mirrorPublic:p("mirror-public",60009),star:p("star",60010),starAdd:p("star-add",60010),starDelete:p("star-delete",60010),starEmpty:p("star-empty",60010),comment:p("comment",60011),commentAdd:p("comment-add",60011),alert:p("alert",60012),warning:p("warning",60012),search:p("search",60013),searchSave:p("search-save",60013),logOut:p("log-out",60014),signOut:p("sign-out",60014),logIn:p("log-in",60015),signIn:p("sign-in",60015),eye:p("eye",60016),eyeUnwatch:p("eye-unwatch",60016),eyeWatch:p("eye-watch",60016),circleFilled:p("circle-filled",60017),primitiveDot:p("primitive-dot",60017),closeDirty:p("close-dirty",60017),debugBreakpoint:p("debug-breakpoint",60017),debugBreakpointDisabled:p("debug-breakpoint-disabled",60017),debugHint:p("debug-hint",60017),terminalDecorationSuccess:p("terminal-decoration-success",60017),primitiveSquare:p("primitive-square",60018),edit:p("edit",60019),pencil:p("pencil",60019),info:p("info",60020),issueOpened:p("issue-opened",60020),gistPrivate:p("gist-private",60021),gitForkPrivate:p("git-fork-private",60021),lock:p("lock",60021),mirrorPrivate:p("mirror-private",60021),close:p("close",60022),removeClose:p("remove-close",60022),x:p("x",60022),repoSync:p("repo-sync",60023),sync:p("sync",60023),clone:p("clone",60024),desktopDownload:p("desktop-download",60024),beaker:p("beaker",60025),microscope:p("microscope",60025),vm:p("vm",60026),deviceDesktop:p("device-desktop",60026),file:p("file",60027),fileText:p("file-text",60027),more:p("more",60028),ellipsis:p("ellipsis",60028),kebabHorizontal:p("kebab-horizontal",60028),mailReply:p("mail-reply",60029),reply:p("reply",60029),organization:p("organization",60030),organizationFilled:p("organization-filled",60030),organizationOutline:p("organization-outline",60030),newFile:p("new-file",60031),fileAdd:p("file-add",60031),newFolder:p("new-folder",60032),fileDirectoryCreate:p("file-directory-create",60032),trash:p("trash",60033),trashcan:p("trashcan",60033),history:p("history",60034),clock:p("clock",60034),folder:p("folder",60035),fileDirectory:p("file-directory",60035),symbolFolder:p("symbol-folder",60035),logoGithub:p("logo-github",60036),markGithub:p("mark-github",60036),github:p("github",60036),terminal:p("terminal",60037),console:p("console",60037),repl:p("repl",60037),zap:p("zap",60038),symbolEvent:p("symbol-event",60038),error:p("error",60039),stop:p("stop",60039),variable:p("variable",60040),symbolVariable:p("symbol-variable",60040),array:p("array",60042),symbolArray:p("symbol-array",60042),symbolModule:p("symbol-module",60043),symbolPackage:p("symbol-package",60043),symbolNamespace:p("symbol-namespace",60043),symbolObject:p("symbol-object",60043),symbolMethod:p("symbol-method",60044),symbolFunction:p("symbol-function",60044),symbolConstructor:p("symbol-constructor",60044),symbolBoolean:p("symbol-boolean",60047),symbolNull:p("symbol-null",60047),symbolNumeric:p("symbol-numeric",60048),symbolNumber:p("symbol-number",60048),symbolStructure:p("symbol-structure",60049),symbolStruct:p("symbol-struct",60049),symbolParameter:p("symbol-parameter",60050),symbolTypeParameter:p("symbol-type-parameter",60050),symbolKey:p("symbol-key",60051),symbolText:p("symbol-text",60051),symbolReference:p("symbol-reference",60052),goToFile:p("go-to-file",60052),symbolEnum:p("symbol-enum",60053),symbolValue:p("symbol-value",60053),symbolRuler:p("symbol-ruler",60054),symbolUnit:p("symbol-unit",60054),activateBreakpoints:p("activate-breakpoints",60055),archive:p("archive",60056),arrowBoth:p("arrow-both",60057),arrowDown:p("arrow-down",60058),arrowLeft:p("arrow-left",60059),arrowRight:p("arrow-right",60060),arrowSmallDown:p("arrow-small-down",60061),arrowSmallLeft:p("arrow-small-left",60062),arrowSmallRight:p("arrow-small-right",60063),arrowSmallUp:p("arrow-small-up",60064),arrowUp:p("arrow-up",60065),bell:p("bell",60066),bold:p("bold",60067),book:p("book",60068),bookmark:p("bookmark",60069),debugBreakpointConditionalUnverified:p("debug-breakpoint-conditional-unverified",60070),debugBreakpointConditional:p("debug-breakpoint-conditional",60071),debugBreakpointConditionalDisabled:p("debug-breakpoint-conditional-disabled",60071),debugBreakpointDataUnverified:p("debug-breakpoint-data-unverified",60072),debugBreakpointData:p("debug-breakpoint-data",60073),debugBreakpointDataDisabled:p("debug-breakpoint-data-disabled",60073),debugBreakpointLogUnverified:p("debug-breakpoint-log-unverified",60074),debugBreakpointLog:p("debug-breakpoint-log",60075),debugBreakpointLogDisabled:p("debug-breakpoint-log-disabled",60075),briefcase:p("briefcase",60076),broadcast:p("broadcast",60077),browser:p("browser",60078),bug:p("bug",60079),calendar:p("calendar",60080),caseSensitive:p("case-sensitive",60081),check:p("check",60082),checklist:p("checklist",60083),chevronDown:p("chevron-down",60084),chevronLeft:p("chevron-left",60085),chevronRight:p("chevron-right",60086),chevronUp:p("chevron-up",60087),chromeClose:p("chrome-close",60088),chromeMaximize:p("chrome-maximize",60089),chromeMinimize:p("chrome-minimize",60090),chromeRestore:p("chrome-restore",60091),circleOutline:p("circle-outline",60092),circle:p("circle",60092),debugBreakpointUnverified:p("debug-breakpoint-unverified",60092),terminalDecorationIncomplete:p("terminal-decoration-incomplete",60092),circleSlash:p("circle-slash",60093),circuitBoard:p("circuit-board",60094),clearAll:p("clear-all",60095),clippy:p("clippy",60096),closeAll:p("close-all",60097),cloudDownload:p("cloud-download",60098),cloudUpload:p("cloud-upload",60099),code:p("code",60100),collapseAll:p("collapse-all",60101),colorMode:p("color-mode",60102),commentDiscussion:p("comment-discussion",60103),creditCard:p("credit-card",60105),dash:p("dash",60108),dashboard:p("dashboard",60109),database:p("database",60110),debugContinue:p("debug-continue",60111),debugDisconnect:p("debug-disconnect",60112),debugPause:p("debug-pause",60113),debugRestart:p("debug-restart",60114),debugStart:p("debug-start",60115),debugStepInto:p("debug-step-into",60116),debugStepOut:p("debug-step-out",60117),debugStepOver:p("debug-step-over",60118),debugStop:p("debug-stop",60119),debug:p("debug",60120),deviceCameraVideo:p("device-camera-video",60121),deviceCamera:p("device-camera",60122),deviceMobile:p("device-mobile",60123),diffAdded:p("diff-added",60124),diffIgnored:p("diff-ignored",60125),diffModified:p("diff-modified",60126),diffRemoved:p("diff-removed",60127),diffRenamed:p("diff-renamed",60128),diff:p("diff",60129),diffSidebyside:p("diff-sidebyside",60129),discard:p("discard",60130),editorLayout:p("editor-layout",60131),emptyWindow:p("empty-window",60132),exclude:p("exclude",60133),extensions:p("extensions",60134),eyeClosed:p("eye-closed",60135),fileBinary:p("file-binary",60136),fileCode:p("file-code",60137),fileMedia:p("file-media",60138),filePdf:p("file-pdf",60139),fileSubmodule:p("file-submodule",60140),fileSymlinkDirectory:p("file-symlink-directory",60141),fileSymlinkFile:p("file-symlink-file",60142),fileZip:p("file-zip",60143),files:p("files",60144),filter:p("filter",60145),flame:p("flame",60146),foldDown:p("fold-down",60147),foldUp:p("fold-up",60148),fold:p("fold",60149),folderActive:p("folder-active",60150),folderOpened:p("folder-opened",60151),gear:p("gear",60152),gift:p("gift",60153),gistSecret:p("gist-secret",60154),gist:p("gist",60155),gitCommit:p("git-commit",60156),gitCompare:p("git-compare",60157),compareChanges:p("compare-changes",60157),gitMerge:p("git-merge",60158),githubAction:p("github-action",60159),githubAlt:p("github-alt",60160),globe:p("globe",60161),grabber:p("grabber",60162),graph:p("graph",60163),gripper:p("gripper",60164),heart:p("heart",60165),home:p("home",60166),horizontalRule:p("horizontal-rule",60167),hubot:p("hubot",60168),inbox:p("inbox",60169),issueReopened:p("issue-reopened",60171),issues:p("issues",60172),italic:p("italic",60173),jersey:p("jersey",60174),json:p("json",60175),kebabVertical:p("kebab-vertical",60176),key:p("key",60177),law:p("law",60178),lightbulbAutofix:p("lightbulb-autofix",60179),linkExternal:p("link-external",60180),link:p("link",60181),listOrdered:p("list-ordered",60182),listUnordered:p("list-unordered",60183),liveShare:p("live-share",60184),loading:p("loading",60185),location:p("location",60186),mailRead:p("mail-read",60187),mail:p("mail",60188),markdown:p("markdown",60189),megaphone:p("megaphone",60190),mention:p("mention",60191),milestone:p("milestone",60192),gitPullRequestMilestone:p("git-pull-request-milestone",60192),mortarBoard:p("mortar-board",60193),move:p("move",60194),multipleWindows:p("multiple-windows",60195),mute:p("mute",60196),noNewline:p("no-newline",60197),note:p("note",60198),octoface:p("octoface",60199),openPreview:p("open-preview",60200),package:p("package",60201),paintcan:p("paintcan",60202),pin:p("pin",60203),play:p("play",60204),run:p("run",60204),plug:p("plug",60205),preserveCase:p("preserve-case",60206),preview:p("preview",60207),project:p("project",60208),pulse:p("pulse",60209),question:p("question",60210),quote:p("quote",60211),radioTower:p("radio-tower",60212),reactions:p("reactions",60213),references:p("references",60214),refresh:p("refresh",60215),regex:p("regex",60216),remoteExplorer:p("remote-explorer",60217),remote:p("remote",60218),remove:p("remove",60219),replaceAll:p("replace-all",60220),replace:p("replace",60221),repoClone:p("repo-clone",60222),repoForcePush:p("repo-force-push",60223),repoPull:p("repo-pull",60224),repoPush:p("repo-push",60225),report:p("report",60226),requestChanges:p("request-changes",60227),rocket:p("rocket",60228),rootFolderOpened:p("root-folder-opened",60229),rootFolder:p("root-folder",60230),rss:p("rss",60231),ruby:p("ruby",60232),saveAll:p("save-all",60233),saveAs:p("save-as",60234),save:p("save",60235),screenFull:p("screen-full",60236),screenNormal:p("screen-normal",60237),searchStop:p("search-stop",60238),server:p("server",60240),settingsGear:p("settings-gear",60241),settings:p("settings",60242),shield:p("shield",60243),smiley:p("smiley",60244),sortPrecedence:p("sort-precedence",60245),splitHorizontal:p("split-horizontal",60246),splitVertical:p("split-vertical",60247),squirrel:p("squirrel",60248),starFull:p("star-full",60249),starHalf:p("star-half",60250),symbolClass:p("symbol-class",60251),symbolColor:p("symbol-color",60252),symbolConstant:p("symbol-constant",60253),symbolEnumMember:p("symbol-enum-member",60254),symbolField:p("symbol-field",60255),symbolFile:p("symbol-file",60256),symbolInterface:p("symbol-interface",60257),symbolKeyword:p("symbol-keyword",60258),symbolMisc:p("symbol-misc",60259),symbolOperator:p("symbol-operator",60260),symbolProperty:p("symbol-property",60261),wrench:p("wrench",60261),wrenchSubaction:p("wrench-subaction",60261),symbolSnippet:p("symbol-snippet",60262),tasklist:p("tasklist",60263),telescope:p("telescope",60264),textSize:p("text-size",60265),threeBars:p("three-bars",60266),thumbsdown:p("thumbsdown",60267),thumbsup:p("thumbsup",60268),tools:p("tools",60269),triangleDown:p("triangle-down",60270),triangleLeft:p("triangle-left",60271),triangleRight:p("triangle-right",60272),triangleUp:p("triangle-up",60273),twitter:p("twitter",60274),unfold:p("unfold",60275),unlock:p("unlock",60276),unmute:p("unmute",60277),unverified:p("unverified",60278),verified:p("verified",60279),versions:p("versions",60280),vmActive:p("vm-active",60281),vmOutline:p("vm-outline",60282),vmRunning:p("vm-running",60283),watch:p("watch",60284),whitespace:p("whitespace",60285),wholeWord:p("whole-word",60286),window:p("window",60287),wordWrap:p("word-wrap",60288),zoomIn:p("zoom-in",60289),zoomOut:p("zoom-out",60290),listFilter:p("list-filter",60291),listFlat:p("list-flat",60292),listSelection:p("list-selection",60293),selection:p("selection",60293),listTree:p("list-tree",60294),debugBreakpointFunctionUnverified:p("debug-breakpoint-function-unverified",60295),debugBreakpointFunction:p("debug-breakpoint-function",60296),debugBreakpointFunctionDisabled:p("debug-breakpoint-function-disabled",60296),debugStackframeActive:p("debug-stackframe-active",60297),circleSmallFilled:p("circle-small-filled",60298),debugStackframeDot:p("debug-stackframe-dot",60298),terminalDecorationMark:p("terminal-decoration-mark",60298),debugStackframe:p("debug-stackframe",60299),debugStackframeFocused:p("debug-stackframe-focused",60299),debugBreakpointUnsupported:p("debug-breakpoint-unsupported",60300),symbolString:p("symbol-string",60301),debugReverseContinue:p("debug-reverse-continue",60302),debugStepBack:p("debug-step-back",60303),debugRestartFrame:p("debug-restart-frame",60304),debugAlt:p("debug-alt",60305),callIncoming:p("call-incoming",60306),callOutgoing:p("call-outgoing",60307),menu:p("menu",60308),expandAll:p("expand-all",60309),feedback:p("feedback",60310),gitPullRequestReviewer:p("git-pull-request-reviewer",60310),groupByRefType:p("group-by-ref-type",60311),ungroupByRefType:p("ungroup-by-ref-type",60312),account:p("account",60313),gitPullRequestAssignee:p("git-pull-request-assignee",60313),bellDot:p("bell-dot",60314),debugConsole:p("debug-console",60315),library:p("library",60316),output:p("output",60317),runAll:p("run-all",60318),syncIgnored:p("sync-ignored",60319),pinned:p("pinned",60320),githubInverted:p("github-inverted",60321),serverProcess:p("server-process",60322),serverEnvironment:p("server-environment",60323),pass:p("pass",60324),issueClosed:p("issue-closed",60324),stopCircle:p("stop-circle",60325),playCircle:p("play-circle",60326),record:p("record",60327),debugAltSmall:p("debug-alt-small",60328),vmConnect:p("vm-connect",60329),cloud:p("cloud",60330),merge:p("merge",60331),export:p("export",60332),graphLeft:p("graph-left",60333),magnet:p("magnet",60334),notebook:p("notebook",60335),redo:p("redo",60336),checkAll:p("check-all",60337),pinnedDirty:p("pinned-dirty",60338),passFilled:p("pass-filled",60339),circleLargeFilled:p("circle-large-filled",60340),circleLarge:p("circle-large",60341),circleLargeOutline:p("circle-large-outline",60341),combine:p("combine",60342),gather:p("gather",60342),table:p("table",60343),variableGroup:p("variable-group",60344),typeHierarchy:p("type-hierarchy",60345),typeHierarchySub:p("type-hierarchy-sub",60346),typeHierarchySuper:p("type-hierarchy-super",60347),gitPullRequestCreate:p("git-pull-request-create",60348),runAbove:p("run-above",60349),runBelow:p("run-below",60350),notebookTemplate:p("notebook-template",60351),debugRerun:p("debug-rerun",60352),workspaceTrusted:p("workspace-trusted",60353),workspaceUntrusted:p("workspace-untrusted",60354),workspaceUnknown:p("workspace-unknown",60355),terminalCmd:p("terminal-cmd",60356),terminalDebian:p("terminal-debian",60357),terminalLinux:p("terminal-linux",60358),terminalPowershell:p("terminal-powershell",60359),terminalTmux:p("terminal-tmux",60360),terminalUbuntu:p("terminal-ubuntu",60361),terminalBash:p("terminal-bash",60362),arrowSwap:p("arrow-swap",60363),copy:p("copy",60364),personAdd:p("person-add",60365),filterFilled:p("filter-filled",60366),wand:p("wand",60367),debugLineByLine:p("debug-line-by-line",60368),inspect:p("inspect",60369),layers:p("layers",60370),layersDot:p("layers-dot",60371),layersActive:p("layers-active",60372),compass:p("compass",60373),compassDot:p("compass-dot",60374),compassActive:p("compass-active",60375),azure:p("azure",60376),issueDraft:p("issue-draft",60377),gitPullRequestClosed:p("git-pull-request-closed",60378),gitPullRequestDraft:p("git-pull-request-draft",60379),debugAll:p("debug-all",60380),debugCoverage:p("debug-coverage",60381),runErrors:p("run-errors",60382),folderLibrary:p("folder-library",60383),debugContinueSmall:p("debug-continue-small",60384),beakerStop:p("beaker-stop",60385),graphLine:p("graph-line",60386),graphScatter:p("graph-scatter",60387),pieChart:p("pie-chart",60388),bracket:p("bracket",60175),bracketDot:p("bracket-dot",60389),bracketError:p("bracket-error",60390),lockSmall:p("lock-small",60391),azureDevops:p("azure-devops",60392),verifiedFilled:p("verified-filled",60393),newline:p("newline",60394),layout:p("layout",60395),layoutActivitybarLeft:p("layout-activitybar-left",60396),layoutActivitybarRight:p("layout-activitybar-right",60397),layoutPanelLeft:p("layout-panel-left",60398),layoutPanelCenter:p("layout-panel-center",60399),layoutPanelJustify:p("layout-panel-justify",60400),layoutPanelRight:p("layout-panel-right",60401),layoutPanel:p("layout-panel",60402),layoutSidebarLeft:p("layout-sidebar-left",60403),layoutSidebarRight:p("layout-sidebar-right",60404),layoutStatusbar:p("layout-statusbar",60405),layoutMenubar:p("layout-menubar",60406),layoutCentered:p("layout-centered",60407),target:p("target",60408),indent:p("indent",60409),recordSmall:p("record-small",60410),errorSmall:p("error-small",60411),terminalDecorationError:p("terminal-decoration-error",60411),arrowCircleDown:p("arrow-circle-down",60412),arrowCircleLeft:p("arrow-circle-left",60413),arrowCircleRight:p("arrow-circle-right",60414),arrowCircleUp:p("arrow-circle-up",60415),layoutSidebarRightOff:p("layout-sidebar-right-off",60416),layoutPanelOff:p("layout-panel-off",60417),layoutSidebarLeftOff:p("layout-sidebar-left-off",60418),blank:p("blank",60419),heartFilled:p("heart-filled",60420),map:p("map",60421),mapHorizontal:p("map-horizontal",60421),foldHorizontal:p("fold-horizontal",60421),mapFilled:p("map-filled",60422),mapHorizontalFilled:p("map-horizontal-filled",60422),foldHorizontalFilled:p("fold-horizontal-filled",60422),circleSmall:p("circle-small",60423),bellSlash:p("bell-slash",60424),bellSlashDot:p("bell-slash-dot",60425),commentUnresolved:p("comment-unresolved",60426),gitPullRequestGoToChanges:p("git-pull-request-go-to-changes",60427),gitPullRequestNewChanges:p("git-pull-request-new-changes",60428),searchFuzzy:p("search-fuzzy",60429),commentDraft:p("comment-draft",60430),send:p("send",60431),sparkle:p("sparkle",60432),insert:p("insert",60433),mic:p("mic",60434),thumbsdownFilled:p("thumbsdown-filled",60435),thumbsupFilled:p("thumbsup-filled",60436),coffee:p("coffee",60437),snake:p("snake",60438),game:p("game",60439),vr:p("vr",60440),chip:p("chip",60441),piano:p("piano",60442),music:p("music",60443),micFilled:p("mic-filled",60444),repoFetch:p("repo-fetch",60445),copilot:p("copilot",60446),lightbulbSparkle:p("lightbulb-sparkle",60447),robot:p("robot",60448),sparkleFilled:p("sparkle-filled",60449),diffSingle:p("diff-single",60450),diffMultiple:p("diff-multiple",60451),surroundWith:p("surround-with",60452),share:p("share",60453),gitStash:p("git-stash",60454),gitStashApply:p("git-stash-apply",60455),gitStashPop:p("git-stash-pop",60456),vscode:p("vscode",60457),vscodeInsiders:p("vscode-insiders",60458),codeOss:p("code-oss",60459),runCoverage:p("run-coverage",60460),runAllCoverage:p("run-all-coverage",60461),coverage:p("coverage",60462),githubProject:p("github-project",60463),mapVertical:p("map-vertical",60464),foldVertical:p("fold-vertical",60464),mapVerticalFilled:p("map-vertical-filled",60465),foldVerticalFilled:p("fold-vertical-filled",60465),goToSearch:p("go-to-search",60466),percentage:p("percentage",60467),sortPercentage:p("sort-percentage",60467)},Ck={dialogError:p("dialog-error","error"),dialogWarning:p("dialog-warning","warning"),dialogInfo:p("dialog-info","info"),dialogClose:p("dialog-close","close"),treeItemExpanded:p("tree-item-expanded","chevron-down"),treeFilterOnTypeOn:p("tree-filter-on-type-on","list-filter"),treeFilterOnTypeOff:p("tree-filter-on-type-off","list-selection"),treeFilterClear:p("tree-filter-clear","close"),treeItemLoading:p("tree-item-loading","loading"),menuSelection:p("menu-selection","check"),menuSubmenu:p("menu-submenu","chevron-right"),menuBarMore:p("menubar-more","more"),scrollbarButtonLeft:p("scrollbar-button-left","triangle-left"),scrollbarButtonRight:p("scrollbar-button-right","triangle-right"),scrollbarButtonUp:p("scrollbar-button-up","triangle-up"),scrollbarButtonDown:p("scrollbar-button-down","triangle-down"),toolBarMore:p("toolbar-more","more"),quickInputBack:p("quick-input-back","arrow-left"),dropDownButton:p("drop-down-button",60084),symbolCustomColor:p("symbol-customcolor",60252),exportIcon:p("export",60332),workspaceUnspecified:p("workspace-unspecified",60355),newLine:p("newline",60394),thumbsDownFilled:p("thumbsdown-filled",60435),thumbsUpFilled:p("thumbsup-filled",60436),gitFetch:p("git-fetch",60445),lightbulbSparkleAutofix:p("lightbulb-sparkle-autofix",60447),debugBreakpointPending:p("debug-breakpoint-pending",60377)},de={...xk,...Ck};var Ha;(function(r){function e(t){return t&&typeof t=="object"&&typeof t.id=="string"}r.isThemeColor=e})(Ha||(Ha={}));var Jt;(function(r){r.iconNameSegment="[A-Za-z0-9]+",r.iconNameExpression="[A-Za-z0-9-]+",r.iconModifierExpression="~[A-Za-z]+",r.iconNameCharacter="[A-Za-z0-9~-]";const e=new RegExp(`^(${r.iconNameExpression})(${r.iconModifierExpression})?$`);function t(f){const m=e.exec(f.id);if(!m)return t(de.error);const[,b,_]=m,v=["codicon","codicon-"+b];return _&&v.push("codicon-modifier-"+_.substring(1)),v}r.asClassNameArray=t;function i(f){return t(f).join(" ")}r.asClassName=i;function n(f){return"."+t(f).join(".")}r.asCSSSelector=n;function s(f){return f&&typeof f=="object"&&typeof f.id=="string"&&(typeof f.color>"u"||Ha.isThemeColor(f.color))}r.isThemeIcon=s;const o=new RegExp(`^\\$\\((${r.iconNameExpression}(?:${r.iconModifierExpression})?)\\)$`);function a(f){const m=o.exec(f);if(!m)return;const[,b]=m;return{id:b}}r.fromString=a;function c(f){return{id:f}}r.fromId=c;function l(f,m){let b=f.id;const _=b.lastIndexOf("~");return _!==-1&&(b=b.substring(0,_)),m&&(b=`${b}~${m}`),{id:b}}r.modify=l;function u(f){const m=f.id.lastIndexOf("~");if(m!==-1)return f.id.substring(m+1)}r.getModifier=u;function d(f,m){var b,_;return f.id===m.id&&((b=f.color)==null?void 0:b.id)===((_=m.color)==null?void 0:_.id)}r.isEqual=d})(Jt||(Jt={}));const Iw=new RegExp(`\\$\\(${Jt.iconNameExpression}(?:${Jt.iconModifierExpression})?\\)`,"g"),Sk=new RegExp(`(\\\\)?${Iw.source}`,"g");function Ek(r){return r.replace(Sk,(e,t)=>t?e:`\\${e}`)}new RegExp(`\\\\${Iw.source}`,"g");new RegExp(`(\\s)?(\\\\)?${Iw.source}(\\s)?`,"g");new RegExp(`\\$\\(${Jt.iconNameCharacter}+\\)`,"g");let Qx=class{constructor(e="",t=!1){if(this.value=e,typeof this.value!="string")throw Se("value");typeof t=="boolean"?(this.isTrusted=t,this.supportThemeIcons=!1,this.supportHtml=!1):(this.isTrusted=t.isTrusted??void 0,this.supportThemeIcons=t.supportThemeIcons??!1,this.supportHtml=t.supportHtml??!1)}appendText(e,t=0){return this.value+=kk(this.supportThemeIcons?Ek(e):e).replace(/([ \t]+)/g,(i,n)=>"&nbsp;".repeat(n.length)).replace(/\>/gm,"\\>").replace(/\n/g,t===1?`\\
`:`

`),this}appendMarkdown(e){return this.value+=e,this}appendCodeblock(e,t){return this.value+=`
${Dk(t,e)}
`,this}appendLink(e,t,i){return this.value+="[",this.value+=this._escape(t,"]"),this.value+="](",this.value+=this._escape(String(e),")"),i&&(this.value+=` "${this._escape(this._escape(i,'"'),")")}"`),this.value+=")",this}_escape(e,t){const i=new RegExp(Fa(t),"g");return e.replace(i,(n,s)=>e.charAt(s-1)!=="\\"?`\\${n}`:n)}};function bo(r){return r instanceof Qx?!0:r&&typeof r=="object"?typeof r.value=="string"&&(typeof r.isTrusted=="boolean"||typeof r.isTrusted=="object"||r.isTrusted===void 0)&&(typeof r.supportThemeIcons=="boolean"||r.supportThemeIcons===void 0):!1}function kk(r){return r.replace(/[\\`*_{}[\]()#+\-!~]/g,"\\$&")}function Dk(r,e){var n;const t=((n=r.match(/^`+/gm))==null?void 0:n.reduce((s,o)=>s.length>o.length?s:o).length)??0,i=t>=3?t+1:3;return[`${"`".repeat(i)}${e}`,r,`${"`".repeat(i)}`].join(`
`)}function Ik(r){const e=[],t=r.split("|").map(n=>n.trim());r=t[0];const i=t[1];if(i){const n=/height=(\d+)/.exec(i),s=/width=(\d+)/.exec(i),o=n?n[1]:"",a=s?s[1]:"",c=isFinite(parseInt(a)),l=isFinite(parseInt(o));c&&e.push(`width="${a}"`),l&&e.push(`height="${o}"`)}return{href:r,dimensions:e}}var yo={exports:{}};function sb(){return{baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}function Pk(r){yo.exports.defaults=r}yo.exports={defaults:sb(),getDefaults:sb,changeDefaults:Pk};const Tk=/[&<>"']/,Ak=/[&<>"']/g,Rk=/[<>"']|&(?!#?\w+;)/,Lk=/[<>"']|&(?!#?\w+;)/g,$k={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},ob=r=>$k[r];function Nk(r,e){if(e){if(Tk.test(r))return r.replace(Ak,ob)}else if(Rk.test(r))return r.replace(Lk,ob);return r}const Mk=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;function Jx(r){return r.replace(Mk,(e,t)=>(t=t.toLowerCase(),t==="colon"?":":t.charAt(0)==="#"?t.charAt(1)==="x"?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""))}const Fk=/(^|[^\[])\^/g;function Ok(r,e){r=r.source||r,e=e||"";const t={replace:(i,n)=>(n=n.source||n,n=n.replace(Fk,"$1"),r=r.replace(i,n),t),getRegex:()=>new RegExp(r,e)};return t}const Hk=/[^\w:]/g,Uk=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function Bk(r,e,t){if(r){let i;try{i=decodeURIComponent(Jx(t)).replace(Hk,"").toLowerCase()}catch{return null}if(i.indexOf("javascript:")===0||i.indexOf("vbscript:")===0||i.indexOf("data:")===0)return null}e&&!Uk.test(t)&&(t=Kx(e,t));try{t=encodeURI(t).replace(/%25/g,"%")}catch{return null}return t}const Dd={},Vk=/^[^:]+:\/*[^/]*$/,Wk=/^([^:]+:)[\s\S]*$/,zk=/^([^:]+:\/*[^/]*)[\s\S]*$/;function Kx(r,e){Dd[" "+r]||(Vk.test(r)?Dd[" "+r]=r+"/":Dd[" "+r]=Xx(r,"/",!0)),r=Dd[" "+r];const t=r.indexOf(":")===-1;return e.substring(0,2)==="//"?t?e:r.replace(Wk,"$1")+e:e.charAt(0)==="/"?t?e:r.replace(zk,"$1")+e:r+e}const jk={exec:function(){}};function qk(r){let e=1,t,i;for(;e<arguments.length;e++){t=arguments[e];for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=t[i])}return r}function Gk(r,e){const t=r.replace(/\|/g,(s,o,a)=>{let c=!1,l=o;for(;--l>=0&&a[l]==="\\";)c=!c;return c?"|":" |"}),i=t.split(/ \|/);let n=0;if(i[0].trim()||i.shift(),i[i.length-1].trim()||i.pop(),i.length>e)i.splice(e);else for(;i.length<e;)i.push("");for(;n<i.length;n++)i[n]=i[n].trim().replace(/\\\|/g,"|");return i}function Xx(r,e,t){const i=r.length;if(i===0)return"";let n=0;for(;n<i;){const s=r.charAt(i-n-1);if(s===e&&!t)n++;else if(s!==e&&t)n++;else break}return r.substr(0,i-n)}function Qk(r,e){if(r.indexOf(e[1])===-1)return-1;const t=r.length;let i=0,n=0;for(;n<t;n++)if(r[n]==="\\")n++;else if(r[n]===e[0])i++;else if(r[n]===e[1]&&(i--,i<0))return n;return-1}function Jk(r){r&&r.sanitize&&!r.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")}function Kk(r,e){if(e<1)return"";let t="";for(;e>1;)e&1&&(t+=r),e>>=1,r+=r;return t+r}var Cc={escape:Nk,unescape:Jx,edit:Ok,cleanUrl:Bk,resolveUrl:Kx,noopTest:jk,merge:qk,splitCells:Gk,rtrim:Xx,findClosingBracket:Qk,checkSanitizeDeprecation:Jk,repeatString:Kk};const{defaults:Xk}=yo.exports,{rtrim:Wg,splitCells:ab,escape:Ni,findClosingBracket:Zk}=Cc;function cb(r,e,t,i){const n=e.href,s=e.title?Ni(e.title):null,o=r[1].replace(/\\([\[\]])/g,"$1");if(r[0].charAt(0)!=="!"){i.state.inLink=!0;const a={type:"link",raw:t,href:n,title:s,text:o,tokens:i.inlineTokens(o,[])};return i.state.inLink=!1,a}else return{type:"image",raw:t,href:n,title:s,text:Ni(o)}}function Yk(r,e){const t=r.match(/^(\s+)(?:```)/);if(t===null)return e;const i=t[1];return e.split(`
`).map(n=>{const s=n.match(/^\s+/);if(s===null)return n;const[o]=s;return o.length>=i.length?n.slice(i.length):n}).join(`
`)}var Zx=class{constructor(e){this.options=e||Xk}space(e){const t=this.rules.block.newline.exec(e);if(t)return t[0].length>1?{type:"space",raw:t[0]}:{raw:`
`}}code(e){const t=this.rules.block.code.exec(e);if(t){const i=t[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?i:Wg(i,`
`)}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const i=t[0],n=Yk(i,t[3]||"");return{type:"code",raw:i,lang:t[2]?t[2].trim():t[2],text:n}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let i=t[2].trim();if(/#$/.test(i)){const s=Wg(i,"#");(this.options.pedantic||!s||/ $/.test(s))&&(i=s.trim())}const n={type:"heading",raw:t[0],depth:t[1].length,text:i,tokens:[]};return this.lexer.inline(n.text,n.tokens),n}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:t[0]}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){const i=t[0].replace(/^ *> ?/gm,"");return{type:"blockquote",raw:t[0],tokens:this.lexer.blockTokens(i,[]),text:i}}}list(e){let t=this.rules.block.list.exec(e);if(t){let i,n,s,o,a,c,l,u,d,f,m=t[1].trim();const b=m.length>1,_={type:"list",raw:"",ordered:b,start:b?+m.slice(0,-1):"",loose:!1,items:[]};m=b?`\\d{1,9}\\${m.slice(-1)}`:`\\${m}`,this.options.pedantic&&(m=b?m:"[*+-]");const v=new RegExp(`^( {0,3}${m})((?: [^\\n]*| *)(?:\\n[^\\n]*)*(?:\\n|$))`);for(;e&&!(this.rules.block.hr.test(e)||!(t=v.exec(e)));){d=t[2].split(`
`),this.options.pedantic?(o=2,f=d[0].trimLeft()):(o=t[2].search(/[^ ]/),o=t[1].length+(o>4?1:o),f=d[0].slice(o-t[1].length)),c=!1,i=t[0],!d[0]&&/^ *$/.test(d[1])&&(i=t[1]+d.slice(0,2).join(`
`)+`
`,_.loose=!0,d=[]);const D=new RegExp(`^ {0,${Math.min(3,o-1)}}(?:[*+-]|\\d{1,9}[.)])`);for(a=1;a<d.length;a++){if(u=d[a],this.options.pedantic&&(u=u.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),D.test(u)){i=t[1]+d.slice(0,a).join(`
`)+`
`;break}if(!c){u.trim()||(c=!0),u.search(/[^ ]/)>=o?f+=`
`+u.slice(o):f+=`
`+u;continue}if(u.search(/[^ ]/)>=o||!u.trim()){f+=`
`+u.slice(o);continue}else{i=t[1]+d.slice(0,a).join(`
`)+`
`;break}}_.loose||(l?_.loose=!0:/\n *\n *$/.test(i)&&(l=!0)),this.options.gfm&&(n=/^\[[ xX]\] /.exec(f),n&&(s=n[0]!=="[ ] ",f=f.replace(/^\[[ xX]\] +/,""))),_.items.push({type:"list_item",raw:i,task:!!n,checked:s,loose:!1,text:f}),_.raw+=i,e=e.slice(i.length)}_.items[_.items.length-1].raw=i.trimRight(),_.items[_.items.length-1].text=f.trimRight(),_.raw=_.raw.trimRight();const k=_.items.length;for(a=0;a<k;a++)this.lexer.state.top=!1,_.items[a].tokens=this.lexer.blockTokens(_.items[a].text,[]),_.items[a].tokens.some(D=>D.type==="space")&&(_.loose=!0,_.items[a].loose=!0);return _}}html(e){const t=this.rules.block.html.exec(e);if(t){const i={type:"html",raw:t[0],pre:!this.options.sanitizer&&(t[1]==="pre"||t[1]==="script"||t[1]==="style"),text:t[0]};return this.options.sanitize&&(i.type="paragraph",i.text=this.options.sanitizer?this.options.sanitizer(t[0]):Ni(t[0]),i.tokens=[],this.lexer.inline(i.text,i.tokens)),i}}def(e){const t=this.rules.block.def.exec(e);if(t)return t[3]&&(t[3]=t[3].substring(1,t[3].length-1)),{type:"def",tag:t[1].toLowerCase().replace(/\s+/g," "),raw:t[0],href:t[2],title:t[3]}}table(e){const t=this.rules.block.table.exec(e);if(t){const i={type:"table",header:ab(t[1]).map(n=>({text:n})),align:t[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:t[3]?t[3].replace(/\n$/,"").split(`
`):[]};if(i.header.length===i.align.length){i.raw=t[0];let n=i.align.length,s,o,a,c;for(s=0;s<n;s++)/^ *-+: *$/.test(i.align[s])?i.align[s]="right":/^ *:-+: *$/.test(i.align[s])?i.align[s]="center":/^ *:-+ *$/.test(i.align[s])?i.align[s]="left":i.align[s]=null;for(n=i.rows.length,s=0;s<n;s++)i.rows[s]=ab(i.rows[s],i.header.length).map(l=>({text:l}));for(n=i.header.length,o=0;o<n;o++)i.header[o].tokens=[],this.lexer.inlineTokens(i.header[o].text,i.header[o].tokens);for(n=i.rows.length,o=0;o<n;o++)for(c=i.rows[o],a=0;a<c.length;a++)c[a].tokens=[],this.lexer.inlineTokens(c[a].text,c[a].tokens);return i}}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t){const i={type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:[]};return this.lexer.inline(i.text,i.tokens),i}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const i={type:"paragraph",raw:t[0],text:t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1],tokens:[]};return this.lexer.inline(i.text,i.tokens),i}}text(e){const t=this.rules.block.text.exec(e);if(t){const i={type:"text",raw:t[0],text:t[0],tokens:[]};return this.lexer.inline(i.text,i.tokens),i}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:Ni(t[1])}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&/^<a /i.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:this.options.sanitize?"text":"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(t[0]):Ni(t[0]):t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const i=t[2].trim();if(!this.options.pedantic&&/^</.test(i)){if(!/>$/.test(i))return;const o=Wg(i.slice(0,-1),"\\");if((i.length-o.length)%2===0)return}else{const o=Zk(t[2],"()");if(o>-1){const c=(t[0].indexOf("!")===0?5:4)+t[1].length+o;t[2]=t[2].substring(0,o),t[0]=t[0].substring(0,c).trim(),t[3]=""}}let n=t[2],s="";if(this.options.pedantic){const o=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(n);o&&(n=o[1],s=o[3])}else s=t[3]?t[3].slice(1,-1):"";return n=n.trim(),/^</.test(n)&&(this.options.pedantic&&!/>$/.test(i)?n=n.slice(1):n=n.slice(1,-1)),cb(t,{href:n&&n.replace(this.rules.inline._escapes,"$1"),title:s&&s.replace(this.rules.inline._escapes,"$1")},t[0],this.lexer)}}reflink(e,t){let i;if((i=this.rules.inline.reflink.exec(e))||(i=this.rules.inline.nolink.exec(e))){let n=(i[2]||i[1]).replace(/\s+/g," ");if(n=t[n.toLowerCase()],!n||!n.href){const s=i[0].charAt(0);return{type:"text",raw:s,text:s}}return cb(i,n,i[0],this.lexer)}}emStrong(e,t,i=""){let n=this.rules.inline.emStrong.lDelim.exec(e);if(!n||n[3]&&i.match(/[\p{L}\p{N}]/u))return;const s=n[1]||n[2]||"";if(!s||s&&(i===""||this.rules.inline.punctuation.exec(i))){const o=n[0].length-1;let a,c,l=o,u=0;const d=n[0][0]==="*"?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(d.lastIndex=0,t=t.slice(-1*e.length+o);(n=d.exec(t))!=null;){if(a=n[1]||n[2]||n[3]||n[4]||n[5]||n[6],!a)continue;if(c=a.length,n[3]||n[4]){l+=c;continue}else if((n[5]||n[6])&&o%3&&!((o+c)%3)){u+=c;continue}if(l-=c,l>0)continue;if(c=Math.min(c,c+l+u),Math.min(o,c)%2){const m=e.slice(1,o+n.index+c);return{type:"em",raw:e.slice(0,o+n.index+c+1),text:m,tokens:this.lexer.inlineTokens(m,[])}}const f=e.slice(2,o+n.index+c-1);return{type:"strong",raw:e.slice(0,o+n.index+c+1),text:f,tokens:this.lexer.inlineTokens(f,[])}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let i=t[2].replace(/\n/g," ");const n=/[^ ]/.test(i),s=/^ /.test(i)&&/ $/.test(i);return n&&s&&(i=i.substring(1,i.length-1)),i=Ni(i,!0),{type:"codespan",raw:t[0],text:i}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2],[])}}autolink(e,t){const i=this.rules.inline.autolink.exec(e);if(i){let n,s;return i[2]==="@"?(n=Ni(this.options.mangle?t(i[1]):i[1]),s="mailto:"+n):(n=Ni(i[1]),s=n),{type:"link",raw:i[0],text:n,href:s,tokens:[{type:"text",raw:n,text:n}]}}}url(e,t){let i;if(i=this.rules.inline.url.exec(e)){let n,s;if(i[2]==="@")n=Ni(this.options.mangle?t(i[0]):i[0]),s="mailto:"+n;else{let o;do o=i[0],i[0]=this.rules.inline._backpedal.exec(i[0])[0];while(o!==i[0]);n=Ni(i[0]),i[1]==="www."?s="http://"+n:s=n}return{type:"link",raw:i[0],text:n,href:s,tokens:[{type:"text",raw:n,text:n}]}}}inlineText(e,t){const i=this.rules.inline.text.exec(e);if(i){let n;return this.lexer.state.inRawBlock?n=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(i[0]):Ni(i[0]):i[0]:n=Ni(this.options.smartypants?t(i[0]):i[0]),{type:"text",raw:i[0],text:n}}}};const{noopTest:yh,edit:ft,merge:xo}=Cc,Pe={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\* *){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)( [^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *\n? *<?([^\s>]+)>?(?:(?: +\n? *| *\n *)(title))? *(?:\n+|$)/,table:yh,lheading:/^([^\n]+)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html| +\n)[^\n]+)*)/,text:/^[^\n]+/};Pe._label=/(?!\s*\])(?:\\[\[\]]|[^\[\]])+/;Pe._title=/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/;Pe.def=ft(Pe.def).replace("label",Pe._label).replace("title",Pe._title).getRegex();Pe.bullet=/(?:[*+-]|\d{1,9}[.)])/;Pe.listItemStart=ft(/^( *)(bull) */).replace("bull",Pe.bullet).getRegex();Pe.list=ft(Pe.list).replace(/bull/g,Pe.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+Pe.def.source+")").getRegex();Pe._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul";Pe._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/;Pe.html=ft(Pe.html,"i").replace("comment",Pe._comment).replace("tag",Pe._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex();Pe.paragraph=ft(Pe._paragraph).replace("hr",Pe.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Pe._tag).getRegex();Pe.blockquote=ft(Pe.blockquote).replace("paragraph",Pe.paragraph).getRegex();Pe.normal=xo({},Pe);Pe.gfm=xo({},Pe.normal,{table:"^ *([^\\n ].*\\|.*)\\n {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)\\|?(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"});Pe.gfm.table=ft(Pe.gfm.table).replace("hr",Pe.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Pe._tag).getRegex();Pe.pedantic=xo({},Pe.normal,{html:ft(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Pe._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:yh,paragraph:ft(Pe.normal._paragraph).replace("hr",Pe.hr).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Pe.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()});const fe={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:yh,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(?!\s*\])((?:\\[\[\]]?|[^\[\]\\])+)\]/,nolink:/^!?\[(?!\s*\])((?:\[[^\[\]]*\]|\\[\[\]]|[^\[\]])*)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/\_\_[^_*]*?\*[^_*]*?\_\_|[punct_](\*+)(?=[\s]|$)|[^punct*_\s](\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|[^punct*_\s](\*+)(?=[^punct*_\s])/,rDelimUnd:/\*\*[^_*]*?\_[^_*]*?\*\*|[punct*](\_+)(?=[\s]|$)|[^punct*_\s](\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:yh,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/};fe._punctuation="!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~";fe.punctuation=ft(fe.punctuation).replace(/punctuation/g,fe._punctuation).getRegex();fe.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g;fe.escapedEmSt=/\\\*|\\_/g;fe._comment=ft(Pe._comment).replace("(?:-->|$)","-->").getRegex();fe.emStrong.lDelim=ft(fe.emStrong.lDelim).replace(/punct/g,fe._punctuation).getRegex();fe.emStrong.rDelimAst=ft(fe.emStrong.rDelimAst,"g").replace(/punct/g,fe._punctuation).getRegex();fe.emStrong.rDelimUnd=ft(fe.emStrong.rDelimUnd,"g").replace(/punct/g,fe._punctuation).getRegex();fe._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g;fe._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/;fe._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/;fe.autolink=ft(fe.autolink).replace("scheme",fe._scheme).replace("email",fe._email).getRegex();fe._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/;fe.tag=ft(fe.tag).replace("comment",fe._comment).replace("attribute",fe._attribute).getRegex();fe._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/;fe._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/;fe._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/;fe.link=ft(fe.link).replace("label",fe._label).replace("href",fe._href).replace("title",fe._title).getRegex();fe.reflink=ft(fe.reflink).replace("label",fe._label).getRegex();fe.reflinkSearch=ft(fe.reflinkSearch,"g").replace("reflink",fe.reflink).replace("nolink",fe.nolink).getRegex();fe.normal=xo({},fe);fe.pedantic=xo({},fe.normal,{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:ft(/^!?\[(label)\]\((.*?)\)/).replace("label",fe._label).getRegex(),reflink:ft(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",fe._label).getRegex()});fe.gfm=xo({},fe.normal,{escape:ft(fe.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/});fe.gfm.url=ft(fe.gfm.url,"i").replace("email",fe.gfm._extended_email).getRegex();fe.breaks=xo({},fe.gfm,{br:ft(fe.br).replace("{2,}","*").getRegex(),text:ft(fe.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()});var e5={block:Pe,inline:fe};const t5=Zx,{defaults:i5}=yo.exports,{block:Id,inline:$c}=e5,{repeatString:lb}=Cc;function n5(r){return r.replace(/---/g,"—").replace(/--/g,"–").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…")}function ub(r){let e="",t,i;const n=r.length;for(t=0;t<n;t++)i=r.charCodeAt(t),Math.random()>.5&&(i="x"+i.toString(16)),e+="&#"+i+";";return e}var r5=class qm{constructor(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||i5,this.options.tokenizer=this.options.tokenizer||new t5,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={block:Id.normal,inline:$c.normal};this.options.pedantic?(t.block=Id.pedantic,t.inline=$c.pedantic):this.options.gfm&&(t.block=Id.gfm,this.options.breaks?t.inline=$c.breaks:t.inline=$c.gfm),this.tokenizer.rules=t}static get rules(){return{block:Id,inline:$c}}static lex(e,t){return new qm(t).lex(e)}static lexInline(e,t){return new qm(t).inlineTokens(e)}lex(e){e=e.replace(/\r\n|\r/g,`
`).replace(/\t/g,"    "),this.blockTokens(e,this.tokens);let t;for(;t=this.inlineQueue.shift();)this.inlineTokens(t.src,t.tokens);return this.tokens}blockTokens(e,t=[]){this.options.pedantic&&(e=e.replace(/^ +$/gm,""));let i,n,s,o;for(;e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(a=>(i=a.call({lexer:this},e,t))?(e=e.substring(i.raw.length),t.push(i),!0):!1))){if(i=this.tokenizer.space(e)){e=e.substring(i.raw.length),i.type&&t.push(i);continue}if(i=this.tokenizer.code(e)){e=e.substring(i.raw.length),n=t[t.length-1],n&&(n.type==="paragraph"||n.type==="text")?(n.raw+=`
`+i.raw,n.text+=`
`+i.text,this.inlineQueue[this.inlineQueue.length-1].src=n.text):t.push(i);continue}if(i=this.tokenizer.fences(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.heading(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.hr(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.blockquote(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.list(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.html(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.def(e)){e=e.substring(i.raw.length),n=t[t.length-1],n&&(n.type==="paragraph"||n.type==="text")?(n.raw+=`
`+i.raw,n.text+=`
`+i.raw,this.inlineQueue[this.inlineQueue.length-1].src=n.text):this.tokens.links[i.tag]||(this.tokens.links[i.tag]={href:i.href,title:i.title});continue}if(i=this.tokenizer.table(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.lheading(e)){e=e.substring(i.raw.length),t.push(i);continue}if(s=e,this.options.extensions&&this.options.extensions.startBlock){let a=1/0;const c=e.slice(1);let l;this.options.extensions.startBlock.forEach(function(u){l=u.call({lexer:this},c),typeof l=="number"&&l>=0&&(a=Math.min(a,l))}),a<1/0&&a>=0&&(s=e.substring(0,a+1))}if(this.state.top&&(i=this.tokenizer.paragraph(s))){n=t[t.length-1],o&&n.type==="paragraph"?(n.raw+=`
`+i.raw,n.text+=`
`+i.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=n.text):t.push(i),o=s.length!==e.length,e=e.substring(i.raw.length);continue}if(i=this.tokenizer.text(e)){e=e.substring(i.raw.length),n=t[t.length-1],n&&n.type==="text"?(n.raw+=`
`+i.raw,n.text+=`
`+i.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=n.text):t.push(i);continue}if(e){const a="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(a);break}else throw new Error(a)}}return this.state.top=!0,t}inline(e,t){this.inlineQueue.push({src:e,tokens:t})}inlineTokens(e,t=[]){let i,n,s,o=e,a,c,l;if(this.tokens.links){const u=Object.keys(this.tokens.links);if(u.length>0)for(;(a=this.tokenizer.rules.inline.reflinkSearch.exec(o))!=null;)u.includes(a[0].slice(a[0].lastIndexOf("[")+1,-1))&&(o=o.slice(0,a.index)+"["+lb("a",a[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(a=this.tokenizer.rules.inline.blockSkip.exec(o))!=null;)o=o.slice(0,a.index)+"["+lb("a",a[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(a=this.tokenizer.rules.inline.escapedEmSt.exec(o))!=null;)o=o.slice(0,a.index)+"++"+o.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex);for(;e;)if(c||(l=""),c=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(u=>(i=u.call({lexer:this},e,t))?(e=e.substring(i.raw.length),t.push(i),!0):!1))){if(i=this.tokenizer.escape(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.tag(e)){e=e.substring(i.raw.length),n=t[t.length-1],n&&i.type==="text"&&n.type==="text"?(n.raw+=i.raw,n.text+=i.text):t.push(i);continue}if(i=this.tokenizer.link(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(i.raw.length),n=t[t.length-1],n&&i.type==="text"&&n.type==="text"?(n.raw+=i.raw,n.text+=i.text):t.push(i);continue}if(i=this.tokenizer.emStrong(e,o,l)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.codespan(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.br(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.del(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.autolink(e,ub)){e=e.substring(i.raw.length),t.push(i);continue}if(!this.state.inLink&&(i=this.tokenizer.url(e,ub))){e=e.substring(i.raw.length),t.push(i);continue}if(s=e,this.options.extensions&&this.options.extensions.startInline){let u=1/0;const d=e.slice(1);let f;this.options.extensions.startInline.forEach(function(m){f=m.call({lexer:this},d),typeof f=="number"&&f>=0&&(u=Math.min(u,f))}),u<1/0&&u>=0&&(s=e.substring(0,u+1))}if(i=this.tokenizer.inlineText(s,n5)){e=e.substring(i.raw.length),i.raw.slice(-1)!=="_"&&(l=i.raw.slice(-1)),c=!0,n=t[t.length-1],n&&n.type==="text"?(n.raw+=i.raw,n.text+=i.text):t.push(i);continue}if(e){const u="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(u);break}else throw new Error(u)}}return t}};const{defaults:s5}=yo.exports,{cleanUrl:db,escape:Pd}=Cc;var Yx=class{constructor(e){this.options=e||s5}code(e,t,i){const n=(t||"").match(/\S*/)[0];if(this.options.highlight){const s=this.options.highlight(e,n);s!=null&&s!==e&&(i=!0,e=s)}return e=e.replace(/\n$/,"")+`
`,n?'<pre><code class="'+this.options.langPrefix+Pd(n,!0)+'">'+(i?e:Pd(e,!0))+`</code></pre>
`:"<pre><code>"+(i?e:Pd(e,!0))+`</code></pre>
`}blockquote(e){return`<blockquote>
`+e+`</blockquote>
`}html(e){return e}heading(e,t,i,n){return this.options.headerIds?"<h"+t+' id="'+this.options.headerPrefix+n.slug(i)+'">'+e+"</h"+t+`>
`:"<h"+t+">"+e+"</h"+t+`>
`}hr(){return this.options.xhtml?`<hr/>
`:`<hr>
`}list(e,t,i){const n=t?"ol":"ul",s=t&&i!==1?' start="'+i+'"':"";return"<"+n+s+`>
`+e+"</"+n+`>
`}listitem(e){return"<li>"+e+`</li>
`}checkbox(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "}paragraph(e){return"<p>"+e+`</p>
`}table(e,t){return t&&(t="<tbody>"+t+"</tbody>"),`<table>
<thead>
`+e+`</thead>
`+t+`</table>
`}tablerow(e){return`<tr>
`+e+`</tr>
`}tablecell(e,t){const i=t.header?"th":"td";return(t.align?"<"+i+' align="'+t.align+'">':"<"+i+">")+e+"</"+i+`>
`}strong(e){return"<strong>"+e+"</strong>"}em(e){return"<em>"+e+"</em>"}codespan(e){return"<code>"+e+"</code>"}br(){return this.options.xhtml?"<br/>":"<br>"}del(e){return"<del>"+e+"</del>"}link(e,t,i){if(e=db(this.options.sanitize,this.options.baseUrl,e),e===null)return i;let n='<a href="'+Pd(e)+'"';return t&&(n+=' title="'+t+'"'),n+=">"+i+"</a>",n}image(e,t,i){if(e=db(this.options.sanitize,this.options.baseUrl,e),e===null)return i;let n='<img src="'+e+'" alt="'+i+'"';return t&&(n+=' title="'+t+'"'),n+=this.options.xhtml?"/>":">",n}text(e){return e}},eC=class{strong(e){return e}em(e){return e}codespan(e){return e}del(e){return e}html(e){return e}text(e){return e}link(e,t,i){return""+i}image(e,t,i){return""+i}br(){return""}},tC=class{constructor(){this.seen={}}serialize(e){return e.toLowerCase().trim().replace(/<[!\/a-z].*?>/ig,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")}getNextSafeSlug(e,t){let i=e,n=0;if(this.seen.hasOwnProperty(i)){n=this.seen[e];do n++,i=e+"-"+n;while(this.seen.hasOwnProperty(i))}return t||(this.seen[e]=n,this.seen[i]=0),i}slug(e,t={}){const i=this.serialize(e);return this.getNextSafeSlug(i,t.dryrun)}};const o5=Yx,a5=eC,c5=tC,{defaults:l5}=yo.exports,{unescape:u5}=Cc;var d5=class Gm{constructor(e){this.options=e||l5,this.options.renderer=this.options.renderer||new o5,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new a5,this.slugger=new c5}static parse(e,t){return new Gm(t).parse(e)}static parseInline(e,t){return new Gm(t).parseInline(e)}parse(e,t=!0){let i="",n,s,o,a,c,l,u,d,f,m,b,_,v,k,D,E,N,A,j;const re=e.length;for(n=0;n<re;n++){if(m=e[n],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[m.type]&&(j=this.options.extensions.renderers[m.type].call({parser:this},m),j!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(m.type))){i+=j||"";continue}switch(m.type){case"space":continue;case"hr":{i+=this.renderer.hr();continue}case"heading":{i+=this.renderer.heading(this.parseInline(m.tokens),m.depth,u5(this.parseInline(m.tokens,this.textRenderer)),this.slugger);continue}case"code":{i+=this.renderer.code(m.text,m.lang,m.escaped);continue}case"table":{for(d="",u="",a=m.header.length,s=0;s<a;s++)u+=this.renderer.tablecell(this.parseInline(m.header[s].tokens),{header:!0,align:m.align[s]});for(d+=this.renderer.tablerow(u),f="",a=m.rows.length,s=0;s<a;s++){for(l=m.rows[s],u="",c=l.length,o=0;o<c;o++)u+=this.renderer.tablecell(this.parseInline(l[o].tokens),{header:!1,align:m.align[o]});f+=this.renderer.tablerow(u)}i+=this.renderer.table(d,f);continue}case"blockquote":{f=this.parse(m.tokens),i+=this.renderer.blockquote(f);continue}case"list":{for(b=m.ordered,_=m.start,v=m.loose,a=m.items.length,f="",s=0;s<a;s++)D=m.items[s],E=D.checked,N=D.task,k="",D.task&&(A=this.renderer.checkbox(E),v?D.tokens.length>0&&D.tokens[0].type==="paragraph"?(D.tokens[0].text=A+" "+D.tokens[0].text,D.tokens[0].tokens&&D.tokens[0].tokens.length>0&&D.tokens[0].tokens[0].type==="text"&&(D.tokens[0].tokens[0].text=A+" "+D.tokens[0].tokens[0].text)):D.tokens.unshift({type:"text",text:A}):k+=A),k+=this.parse(D.tokens,v),f+=this.renderer.listitem(k,N,E);i+=this.renderer.list(f,b,_);continue}case"html":{i+=this.renderer.html(m.text);continue}case"paragraph":{i+=this.renderer.paragraph(this.parseInline(m.tokens));continue}case"text":{for(f=m.tokens?this.parseInline(m.tokens):m.text;n+1<re&&e[n+1].type==="text";)m=e[++n],f+=`
`+(m.tokens?this.parseInline(m.tokens):m.text);i+=t?this.renderer.paragraph(f):f;continue}default:{const te='Token with "'+m.type+'" type was not found.';if(this.options.silent){console.error(te);return}else throw new Error(te)}}}return i}parseInline(e,t){t=t||this.renderer;let i="",n,s,o;const a=e.length;for(n=0;n<a;n++){if(s=e[n],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[s.type]&&(o=this.options.extensions.renderers[s.type].call({parser:this},s),o!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(s.type))){i+=o||"";continue}switch(s.type){case"escape":{i+=t.text(s.text);break}case"html":{i+=t.html(s.text);break}case"link":{i+=t.link(s.href,s.title,this.parseInline(s.tokens,t));break}case"image":{i+=t.image(s.href,s.title,s.text);break}case"strong":{i+=t.strong(this.parseInline(s.tokens,t));break}case"em":{i+=t.em(this.parseInline(s.tokens,t));break}case"codespan":{i+=t.codespan(s.text);break}case"br":{i+=t.br();break}case"del":{i+=t.del(this.parseInline(s.tokens,t));break}case"text":{i+=t.text(s.text);break}default:{const c='Token with "'+s.type+'" type was not found.';if(this.options.silent){console.error(c);return}else throw new Error(c)}}}return i}};const Nl=r5,Ml=d5,iC=Zx,nC=Yx,h5=eC,f5=tC,{merge:Kp,checkSanitizeDeprecation:rC,escape:sC}=Cc,{getDefaults:p5,changeDefaults:g5,defaults:m5}=yo.exports;function Re(r,e,t){if(typeof r>"u"||r===null)throw new Error("marked(): input parameter is undefined or null");if(typeof r!="string")throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(r)+", string expected");if(typeof e=="function"&&(t=e,e=null),e=Kp({},Re.defaults,e||{}),rC(e),t){const i=e.highlight;let n;try{n=Nl.lex(r,e)}catch(a){return t(a)}const s=function(a){let c;if(!a)try{e.walkTokens&&Re.walkTokens(n,e.walkTokens),c=Ml.parse(n,e)}catch(l){a=l}return e.highlight=i,a?t(a):t(null,c)};if(!i||i.length<3||(delete e.highlight,!n.length))return s();let o=0;Re.walkTokens(n,function(a){a.type==="code"&&(o++,setTimeout(()=>{i(a.text,a.lang,function(c,l){if(c)return s(c);l!=null&&l!==a.text&&(a.text=l,a.escaped=!0),o--,o===0&&s()})},0))}),o===0&&s();return}try{const i=Nl.lex(r,e);return e.walkTokens&&Re.walkTokens(i,e.walkTokens),Ml.parse(i,e)}catch(i){if(i.message+=`
Please report this to https://github.com/markedjs/marked.`,e.silent)return"<p>An error occurred:</p><pre>"+sC(i.message+"",!0)+"</pre>";throw i}}Re.options=Re.setOptions=function(r){return Kp(Re.defaults,r),g5(Re.defaults),Re};Re.getDefaults=p5;Re.defaults=m5;Re.use=function(...r){const e=Kp({},...r),t=Re.defaults.extensions||{renderers:{},childTokens:{}};let i;r.forEach(n=>{if(n.extensions&&(i=!0,n.extensions.forEach(s=>{if(!s.name)throw new Error("extension name required");if(s.renderer){const o=t.renderers?t.renderers[s.name]:null;o?t.renderers[s.name]=function(...a){let c=s.renderer.apply(this,a);return c===!1&&(c=o.apply(this,a)),c}:t.renderers[s.name]=s.renderer}if(s.tokenizer){if(!s.level||s.level!=="block"&&s.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");t[s.level]?t[s.level].unshift(s.tokenizer):t[s.level]=[s.tokenizer],s.start&&(s.level==="block"?t.startBlock?t.startBlock.push(s.start):t.startBlock=[s.start]:s.level==="inline"&&(t.startInline?t.startInline.push(s.start):t.startInline=[s.start]))}s.childTokens&&(t.childTokens[s.name]=s.childTokens)})),n.renderer){const s=Re.defaults.renderer||new nC;for(const o in n.renderer){const a=s[o];s[o]=(...c)=>{let l=n.renderer[o].apply(s,c);return l===!1&&(l=a.apply(s,c)),l}}e.renderer=s}if(n.tokenizer){const s=Re.defaults.tokenizer||new iC;for(const o in n.tokenizer){const a=s[o];s[o]=(...c)=>{let l=n.tokenizer[o].apply(s,c);return l===!1&&(l=a.apply(s,c)),l}}e.tokenizer=s}if(n.walkTokens){const s=Re.defaults.walkTokens;e.walkTokens=o=>{n.walkTokens.call(this,o),s&&s(o)}}i&&(e.extensions=t),Re.setOptions(e)})};Re.walkTokens=function(r,e){for(const t of r)switch(e(t),t.type){case"table":{for(const i of t.header)Re.walkTokens(i.tokens,e);for(const i of t.rows)for(const n of i)Re.walkTokens(n.tokens,e);break}case"list":{Re.walkTokens(t.items,e);break}default:Re.defaults.extensions&&Re.defaults.extensions.childTokens&&Re.defaults.extensions.childTokens[t.type]?Re.defaults.extensions.childTokens[t.type].forEach(function(i){Re.walkTokens(t[i],e)}):t.tokens&&Re.walkTokens(t.tokens,e)}};Re.parseInline=function(r,e){if(typeof r>"u"||r===null)throw new Error("marked.parseInline(): input parameter is undefined or null");if(typeof r!="string")throw new Error("marked.parseInline(): input parameter is of type "+Object.prototype.toString.call(r)+", string expected");e=Kp({},Re.defaults,e||{}),rC(e);try{const t=Nl.lexInline(r,e);return e.walkTokens&&Re.walkTokens(t,e.walkTokens),Ml.parseInline(t,e)}catch(t){if(t.message+=`
Please report this to https://github.com/markedjs/marked.`,e.silent)return"<p>An error occurred:</p><pre>"+sC(t.message+"",!0)+"</pre>";throw t}};Re.Parser=Ml;Re.parser=Ml.parse;Re.Renderer=nC;Re.TextRenderer=h5;Re.Lexer=Nl;Re.lexer=Nl.lex;Re.Tokenizer=iC;Re.Slugger=f5;Re.parse=Re;var hb=Re;function v5(r){let e=JSON.parse(r);return e=En(e),e}function En(r,e=0){if(!r||e>200)return r;if(typeof r=="object"){switch(r.$mid){case 1:return x.revive(r);case 2:return new RegExp(r.source,r.flags);case 17:return new Date(r.source)}if(r instanceof _e||r instanceof Uint8Array)return r;if(Array.isArray(r))for(let t=0;t<r.length;++t)r[t]=En(r[t],e+1);else for(const t in r)Object.hasOwnProperty.call(r,t)&&(r[t]=En(r[t],e+1))}return r}const er=Object.freeze({text:"text/plain",binary:"application/octet-stream",unknown:"application/unknown",markdown:"text/markdown",latex:"text/latex",uriList:"text/uri-list"}),_5=/^(.+)\/(.+?)(;.+)?$/;function oC(r,e){const t=_5.exec(r);return t?`${t[1].toLowerCase()}/${t[2].toLowerCase()}${t[3]??""}`:e?void 0:r}const si=Symbol("unset");class w5{constructor(){this.root=new zg,this._size=0}get size(){return this._size}get nodes(){var e;return((e=this.root.children)==null?void 0:e.values())||nr.empty()}insert(e,t,i){this.opNode(e,n=>n._value=t,i)}mutate(e,t){this.opNode(e,i=>i._value=t(i._value===si?void 0:i._value))}delete(e){var s;const t=this.getPathToKey(e);if(!t)return;let i=t.length-1;const n=t[i].node._value;if(n!==si){for(this._size--,t[i].node._value=si;i>0;i--){const{node:o,part:a}=t[i];if((s=o.children)!=null&&s.size||o._value!==si)break;t[i-1].node.children.delete(a)}return n}}*deleteRecursive(e){const t=this.getPathToKey(e);if(!t)return;const i=t[t.length-1].node;for(let n=t.length-1;n>0;n--){const s=t[n-1];if(s.node.children.delete(t[n].part),s.node.children.size>0||s.node._value!==si)break}for(const n of fb(i))n._value!==si&&(this._size--,yield n._value)}find(e){var i;let t=this.root;for(const n of e){const s=(i=t.children)==null?void 0:i.get(n);if(!s)return;t=s}return t._value===si?void 0:t._value}hasKeyOrParent(e){var i;let t=this.root;for(const n of e){const s=(i=t.children)==null?void 0:i.get(n);if(!s)return!1;if(s._value!==si)return!0;t=s}return!1}hasKeyOrChildren(e){var i;let t=this.root;for(const n of e){const s=(i=t.children)==null?void 0:i.get(n);if(!s)return!1;t=s}return!0}hasKey(e){var i;let t=this.root;for(const n of e){const s=(i=t.children)==null?void 0:i.get(n);if(!s)return!1;t=s}return t._value!==si}getPathToKey(e){var n;const t=[{part:"",node:this.root}];let i=0;for(const s of e){const o=(n=t[i].node.children)==null?void 0:n.get(s);if(!o)return;t.push({part:s,node:o}),i++}return t}opNode(e,t,i){let n=this.root;for(const a of e){if(n.children)if(n.children.has(a))n=n.children.get(a);else{const c=new zg;n.children.set(a,c),n=c}else{const c=new zg;n.children=new Map([[a,c]]),n=c}i==null||i(n)}const s=n._value===si?0:1;t(n);const o=n._value===si?0:1;this._size+=o-s}*values(){for(const{_value:e}of fb(this.root))e!==si&&(yield e)}}function*fb(r){const e=[r];for(;e.length>0;){const t=e.pop();if(yield t,t.children)for(const i of t.children.values())e.push(i)}}class zg{constructor(){this._value=si}get value(){return this._value===si?void 0:this._value}set value(e){this._value=e===void 0?si:e}}let Mi=class ds{constructor(e,t){this.lineNumber=e,this.column=t}with(e=this.lineNumber,t=this.column){return e===this.lineNumber&&t===this.column?this:new ds(e,t)}delta(e=0,t=0){return this.with(this.lineNumber+e,this.column+t)}equals(e){return ds.equals(this,e)}static equals(e,t){return!e&&!t?!0:!!e&&!!t&&e.lineNumber===t.lineNumber&&e.column===t.column}isBefore(e){return ds.isBefore(this,e)}static isBefore(e,t){return e.lineNumber<t.lineNumber?!0:t.lineNumber<e.lineNumber?!1:e.column<t.column}isBeforeOrEqual(e){return ds.isBeforeOrEqual(this,e)}static isBeforeOrEqual(e,t){return e.lineNumber<t.lineNumber?!0:t.lineNumber<e.lineNumber?!1:e.column<=t.column}static compare(e,t){const i=e.lineNumber|0,n=t.lineNumber|0;if(i===n){const s=e.column|0,o=t.column|0;return s-o}return i-n}clone(){return new ds(this.lineNumber,this.column)}toString(){return"("+this.lineNumber+","+this.column+")"}static lift(e){return new ds(e.lineNumber,e.column)}static isIPosition(e){return e&&typeof e.lineNumber=="number"&&typeof e.column=="number"}toJSON(){return{lineNumber:this.lineNumber,column:this.column}}},Qe=class xt{constructor(e,t,i,n){e>i||e===i&&t>n?(this.startLineNumber=i,this.startColumn=n,this.endLineNumber=e,this.endColumn=t):(this.startLineNumber=e,this.startColumn=t,this.endLineNumber=i,this.endColumn=n)}isEmpty(){return xt.isEmpty(this)}static isEmpty(e){return e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn}containsPosition(e){return xt.containsPosition(this,e)}static containsPosition(e,t){return!(t.lineNumber<e.startLineNumber||t.lineNumber>e.endLineNumber||t.lineNumber===e.startLineNumber&&t.column<e.startColumn||t.lineNumber===e.endLineNumber&&t.column>e.endColumn)}static strictContainsPosition(e,t){return!(t.lineNumber<e.startLineNumber||t.lineNumber>e.endLineNumber||t.lineNumber===e.startLineNumber&&t.column<=e.startColumn||t.lineNumber===e.endLineNumber&&t.column>=e.endColumn)}containsRange(e){return xt.containsRange(this,e)}static containsRange(e,t){return!(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber||t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber||t.startLineNumber===e.startLineNumber&&t.startColumn<e.startColumn||t.endLineNumber===e.endLineNumber&&t.endColumn>e.endColumn)}strictContainsRange(e){return xt.strictContainsRange(this,e)}static strictContainsRange(e,t){return!(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber||t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber||t.startLineNumber===e.startLineNumber&&t.startColumn<=e.startColumn||t.endLineNumber===e.endLineNumber&&t.endColumn>=e.endColumn)}plusRange(e){return xt.plusRange(this,e)}static plusRange(e,t){let i,n,s,o;return t.startLineNumber<e.startLineNumber?(i=t.startLineNumber,n=t.startColumn):t.startLineNumber===e.startLineNumber?(i=t.startLineNumber,n=Math.min(t.startColumn,e.startColumn)):(i=e.startLineNumber,n=e.startColumn),t.endLineNumber>e.endLineNumber?(s=t.endLineNumber,o=t.endColumn):t.endLineNumber===e.endLineNumber?(s=t.endLineNumber,o=Math.max(t.endColumn,e.endColumn)):(s=e.endLineNumber,o=e.endColumn),new xt(i,n,s,o)}intersectRanges(e){return xt.intersectRanges(this,e)}static intersectRanges(e,t){let i=e.startLineNumber,n=e.startColumn,s=e.endLineNumber,o=e.endColumn;const a=t.startLineNumber,c=t.startColumn,l=t.endLineNumber,u=t.endColumn;return i<a?(i=a,n=c):i===a&&(n=Math.max(n,c)),s>l?(s=l,o=u):s===l&&(o=Math.min(o,u)),i>s||i===s&&n>o?null:new xt(i,n,s,o)}equalsRange(e){return xt.equalsRange(this,e)}static equalsRange(e,t){return!e&&!t?!0:!!e&&!!t&&e.startLineNumber===t.startLineNumber&&e.startColumn===t.startColumn&&e.endLineNumber===t.endLineNumber&&e.endColumn===t.endColumn}getEndPosition(){return xt.getEndPosition(this)}static getEndPosition(e){return new Mi(e.endLineNumber,e.endColumn)}getStartPosition(){return xt.getStartPosition(this)}static getStartPosition(e){return new Mi(e.startLineNumber,e.startColumn)}toString(){return"["+this.startLineNumber+","+this.startColumn+" -> "+this.endLineNumber+","+this.endColumn+"]"}setEndPosition(e,t){return new xt(this.startLineNumber,this.startColumn,e,t)}setStartPosition(e,t){return new xt(e,t,this.endLineNumber,this.endColumn)}collapseToStart(){return xt.collapseToStart(this)}static collapseToStart(e){return new xt(e.startLineNumber,e.startColumn,e.startLineNumber,e.startColumn)}collapseToEnd(){return xt.collapseToEnd(this)}static collapseToEnd(e){return new xt(e.endLineNumber,e.endColumn,e.endLineNumber,e.endColumn)}delta(e){return new xt(this.startLineNumber+e,this.startColumn,this.endLineNumber+e,this.endColumn)}static fromPositions(e,t=e){return new xt(e.lineNumber,e.column,t.lineNumber,t.column)}static lift(e){return e?new xt(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn):null}static isIRange(e){return e&&typeof e.startLineNumber=="number"&&typeof e.startColumn=="number"&&typeof e.endLineNumber=="number"&&typeof e.endColumn=="number"}static areIntersectingOrTouching(e,t){return!(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<t.startColumn||t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<e.startColumn)}static areIntersecting(e,t){return!(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<=t.startColumn||t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<=e.startColumn)}static compareRangesUsingStarts(e,t){if(e&&t){const s=e.startLineNumber|0,o=t.startLineNumber|0;if(s===o){const a=e.startColumn|0,c=t.startColumn|0;if(a===c){const l=e.endLineNumber|0,u=t.endLineNumber|0;if(l===u){const d=e.endColumn|0,f=t.endColumn|0;return d-f}return l-u}return a-c}return s-o}return(e?1:0)-(t?1:0)}static compareRangesUsingEnds(e,t){return e.endLineNumber===t.endLineNumber?e.endColumn===t.endColumn?e.startLineNumber===t.startLineNumber?e.startColumn-t.startColumn:e.startLineNumber-t.startLineNumber:e.endColumn-t.endColumn:e.endLineNumber-t.endLineNumber}static spansMultipleLines(e){return e.endLineNumber>e.startLineNumber}toJSON(){return this}};class b5{constructor(){this._tokenizationSupports=new Map,this._factories=new Map,this._onDidChange=new R,this.onDidChange=this._onDidChange.event,this._colorMap=null}handleChange(e){this._onDidChange.fire({changedLanguages:e,changedColorMap:!1})}register(e,t){return this._tokenizationSupports.set(e,t),this.handleChange([e]),De(()=>{this._tokenizationSupports.get(e)===t&&(this._tokenizationSupports.delete(e),this.handleChange([e]))})}get(e){return this._tokenizationSupports.get(e)||null}registerFactory(e,t){var n;(n=this._factories.get(e))==null||n.dispose();const i=new y5(this,e,t);return this._factories.set(e,i),De(()=>{const s=this._factories.get(e);!s||s!==i||(this._factories.delete(e),s.dispose())})}async getOrCreate(e){const t=this.get(e);if(t)return t;const i=this._factories.get(e);return!i||i.isResolved?null:(await i.resolve(),this.get(e))}isResolved(e){if(this.get(e))return!0;const i=this._factories.get(e);return!!(!i||i.isResolved)}setColorMap(e){this._colorMap=e,this._onDidChange.fire({changedLanguages:Array.from(this._tokenizationSupports.keys()),changedColorMap:!0})}getColorMap(){return this._colorMap}getDefaultBackground(){return this._colorMap&&this._colorMap.length>2?this._colorMap[2]:null}}class y5 extends Fe{get isResolved(){return this._isResolved}constructor(e,t,i){super(),this._registry=e,this._languageId=t,this._factory=i,this._isDisposed=!1,this._resolvePromise=null,this._isResolved=!1}dispose(){this._isDisposed=!0,super.dispose()}async resolve(){return this._resolvePromise||(this._resolvePromise=this._create()),this._resolvePromise}async _create(){const e=await this._factory.tokenizationSupport;this._isResolved=!0,e&&!this._isDisposed&&this._register(this._registry.register(this._languageId,e))}}const ut="vs/editor/common/languages";var pb;(function(r){r[r.Increase=0]="Increase",r[r.Decrease=1]="Decrease"})(pb||(pb={}));var gb;(function(r){const e=new Map;e.set(0,de.symbolMethod),e.set(1,de.symbolFunction),e.set(2,de.symbolConstructor),e.set(3,de.symbolField),e.set(4,de.symbolVariable),e.set(5,de.symbolClass),e.set(6,de.symbolStruct),e.set(7,de.symbolInterface),e.set(8,de.symbolModule),e.set(9,de.symbolProperty),e.set(10,de.symbolEvent),e.set(11,de.symbolOperator),e.set(12,de.symbolUnit),e.set(13,de.symbolValue),e.set(15,de.symbolEnum),e.set(14,de.symbolConstant),e.set(15,de.symbolEnum),e.set(16,de.symbolEnumMember),e.set(17,de.symbolKeyword),e.set(27,de.symbolSnippet),e.set(18,de.symbolText),e.set(19,de.symbolColor),e.set(20,de.symbolFile),e.set(21,de.symbolReference),e.set(22,de.symbolCustomColor),e.set(23,de.symbolFolder),e.set(24,de.symbolTypeParameter),e.set(25,de.account),e.set(26,de.issues);function t(s){let o=e.get(s);return o||(console.info("No codicon found for CompletionItemKind "+s),o=de.symbolProperty),o}r.toIcon=t;const i=new Map;i.set("method",0),i.set("function",1),i.set("constructor",2),i.set("field",3),i.set("variable",4),i.set("class",5),i.set("struct",6),i.set("interface",7),i.set("module",8),i.set("property",9),i.set("event",10),i.set("operator",11),i.set("unit",12),i.set("value",13),i.set("constant",14),i.set("enum",15),i.set("enum-member",16),i.set("enumMember",16),i.set("keyword",17),i.set("snippet",27),i.set("text",18),i.set("color",19),i.set("file",20),i.set("reference",21),i.set("customcolor",22),i.set("folder",23),i.set("type-parameter",24),i.set("typeParameter",24),i.set("account",25),i.set("issue",26);function n(s,o){let a=i.get(s);return typeof a>"u"&&!o&&(a=9),a}r.fromString=n})(gb||(gb={}));var xh;(function(r){r[r.Automatic=0]="Automatic",r[r.Explicit=1]="Explicit"})(xh||(xh={}));var mb;(function(r){r[r.Automatic=0]="Automatic",r[r.PasteAs=1]="PasteAs"})(mb||(mb={}));var vb;(function(r){r[r.Invoke=1]="Invoke",r[r.TriggerCharacter=2]="TriggerCharacter",r[r.ContentChange=3]="ContentChange"})(vb||(vb={}));var _b;(function(r){r[r.Text=0]="Text",r[r.Read=1]="Read",r[r.Write=2]="Write"})(_b||(_b={}));function x5(r){return r&&x.isUri(r.uri)&&Qe.isIRange(r.range)&&(Qe.isIRange(r.originSelectionRange)||Qe.isIRange(r.targetSelectionRange))}h(ut,0,"array"),h(ut,1,"boolean"),h(ut,2,"class"),h(ut,3,"constant"),h(ut,4,"constructor"),h(ut,5,"enumeration"),h(ut,6,"enumeration member"),h(ut,7,"event"),h(ut,8,"field"),h(ut,9,"file"),h(ut,10,"function"),h(ut,11,"interface"),h(ut,12,"key"),h(ut,13,"method"),h(ut,14,"module"),h(ut,15,"namespace"),h(ut,16,"null"),h(ut,17,"number"),h(ut,18,"object"),h(ut,19,"operator"),h(ut,20,"package"),h(ut,21,"property"),h(ut,22,"string"),h(ut,23,"struct"),h(ut,24,"type parameter"),h(ut,25,"variable");var wb;(function(r){const e=new Map;e.set(0,de.symbolFile),e.set(1,de.symbolModule),e.set(2,de.symbolNamespace),e.set(3,de.symbolPackage),e.set(4,de.symbolClass),e.set(5,de.symbolMethod),e.set(6,de.symbolProperty),e.set(7,de.symbolField),e.set(8,de.symbolConstructor),e.set(9,de.symbolEnum),e.set(10,de.symbolInterface),e.set(11,de.symbolFunction),e.set(12,de.symbolVariable),e.set(13,de.symbolConstant),e.set(14,de.symbolString),e.set(15,de.symbolNumber),e.set(16,de.symbolBoolean),e.set(17,de.symbolArray),e.set(18,de.symbolObject),e.set(19,de.symbolKey),e.set(20,de.symbolNull),e.set(21,de.symbolEnumMember),e.set(22,de.symbolStruct),e.set(23,de.symbolEvent),e.set(24,de.symbolOperator),e.set(25,de.symbolTypeParameter);function t(i){let n=e.get(i);return n||(console.info("No codicon found for SymbolKind "+i),n=de.symbolProperty),n}r.toIcon=t})(wb||(wb={}));var pi;let Mo=(pi=class{static fromValue(e){switch(e){case"comment":return pi.Comment;case"imports":return pi.Imports;case"region":return pi.Region}return new pi(e)}constructor(e){this.value=e}},pi.Comment=new pi("comment"),pi.Imports=new pi("imports"),pi.Region=new pi("region"),pi);var bb;(function(r){r[r.AIGenerated=1]="AIGenerated"})(bb||(bb={}));var Ch;(function(r){r[r.Invoke=0]="Invoke",r[r.Automatic=1]="Automatic"})(Ch||(Ch={}));var Qm;(function(r){function e(t){return!t||typeof t!="object"?!1:typeof t.id=="string"&&typeof t.title=="string"}r.is=e})(Qm||(Qm={}));var jo;(function(r){r[r.Collapsed=0]="Collapsed",r[r.Expanded=1]="Expanded"})(jo||(jo={}));var rl;(function(r){r[r.Unresolved=0]="Unresolved",r[r.Resolved=1]="Resolved"})(rl||(rl={}));var sl;(function(r){r[r.Current=0]="Current",r[r.Outdated=1]="Outdated"})(sl||(sl={}));var yb;(function(r){r[r.Editing=0]="Editing",r[r.Preview=1]="Preview"})(yb||(yb={}));var xb;(function(r){r[r.Type=1]="Type",r[r.Parameter=2]="Parameter"})(xb||(xb={}));new b5;var Cb;(function(r){r[r.None=0]="None",r[r.Option=1]="Option",r[r.Default=2]="Default",r[r.Preferred=3]="Preferred"})(Cb||(Cb={}));var Sh;(function(r){r[r.Invoke=0]="Invoke",r[r.Automatic=1]="Automatic"})(Sh||(Sh={}));const jg="vs/platform/markers/common/markers";var oi;(function(r){r[r.Hint=1]="Hint",r[r.Info=2]="Info",r[r.Warning=4]="Warning",r[r.Error=8]="Error"})(oi||(oi={}));(function(r){function e(o,a){return a-o}r.compare=e;const t=Object.create(null);t[r.Error]=h(jg,0,"Error"),t[r.Warning]=h(jg,1,"Warning"),t[r.Info]=h(jg,2,"Info");function i(o){return t[o]||""}r.toString=i;function n(o){switch(o){case vt.Error:return r.Error;case vt.Warning:return r.Warning;case vt.Info:return r.Info;case vt.Ignore:return r.Hint}}r.fromSeverity=n;function s(o){switch(o){case r.Error:return vt.Error;case r.Warning:return vt.Warning;case r.Info:return vt.Info;case r.Hint:return vt.Ignore}}r.toSeverity=s})(oi||(oi={}));var Sb;(function(r){const e="";function t(n){return i(n,!0)}r.makeKey=t;function i(n,s){const o=[e];return n.source?o.push(n.source.replace("¦","\\¦")):o.push(e),n.code?typeof n.code=="string"?o.push(n.code.replace("¦","\\¦")):o.push(n.code.value.replace("¦","\\¦")):o.push(e),n.severity!==void 0&&n.severity!==null?o.push(oi.toString(n.severity)):o.push(e),n.message&&s?o.push(n.message.replace("¦","\\¦")):o.push(e),n.startLineNumber!==void 0&&n.startLineNumber!==null?o.push(n.startLineNumber.toString()):o.push(e),n.startColumn!==void 0&&n.startColumn!==null?o.push(n.startColumn.toString()):o.push(e),n.endLineNumber!==void 0&&n.endLineNumber!==null?o.push(n.endLineNumber.toString()):o.push(e),n.endColumn!==void 0&&n.endColumn!==null?o.push(n.endColumn.toString()):o.push(e),o.push(e),o.join("¦")}r.makeKeyOptionalMessage=i})(Sb||(Sb={}));function vi(r,e){if(!r)throw new Error(e?`Assertion failed (${e})`:"Assertion Failed")}function C5(r,e="Unreachable"){throw new Error(e)}class ye{static fromExtHostTestItem(e,t,i=e.parent){if(e._isRoot)return new ye([t]);const n=[e.id];for(let s=i;s&&s.id!==t;s=s.parent)n.push(s.id);return n.push(t),new ye(n.reverse())}static isRoot(e){return!e.includes("\0")}static root(e){const t=e.indexOf("\0");return t===-1?e:e.slice(0,t)}static fromString(e){return new ye(e.split("\0"))}static join(e,t){return new ye([...e.path,t])}static joinToString(e,t){return e.toString()+"\0"+t}static parentId(e){const t=e.lastIndexOf("\0");return t===-1?void 0:e.slice(0,t)}static localId(e){const t=e.lastIndexOf("\0");return t===-1?e:e.slice(t+1)}static isChild(e,t){return t.startsWith(e)&&t[e.length]==="\0"}static compare(e,t){return e===t?0:ye.isChild(e,t)?2:ye.isChild(t,e)?3:1}constructor(e,t=e.length){if(this.path=e,this.viewEnd=t,e.length===0||t<1)throw new Error("cannot create test with empty path")}get rootId(){return new ye(this.path,1)}get parentId(){return this.viewEnd>1?new ye(this.path,this.viewEnd-1):void 0}get localId(){return this.path[this.viewEnd-1]}get controllerId(){return this.path[0]}get isRoot(){return this.viewEnd===1}*idsFromRoot(){for(let e=1;e<=this.viewEnd;e++)yield new ye(this.path,e)}*idsToRoot(){for(let e=this.viewEnd;e>0;e--)yield new ye(this.path,e)}compare(e){if(typeof e=="string")return ye.compare(this.toString(),e);for(let t=0;t<e.viewEnd&&t<this.viewEnd;t++)if(e.path[t]!==this.path[t])return 1;return e.viewEnd>this.viewEnd?2:e.viewEnd<this.viewEnd?3:0}toJSON(){return this.toString()}toString(){if(!this.stringifed){this.stringifed=this.path[0];for(let e=1;e<this.viewEnd;e++)this.stringifed+="\0",this.stringifed+=this.path[e]}return this.stringifed}}const S5=r=>"runId"in r;var Ua;(function(r){r.serialize=e=>({range:e.range.toJSON(),uri:e.uri.toJSON()}),r.deserialize=(e,t)=>({range:Qe.lift(t.range),uri:e.asCanonicalUri(x.revive(t.uri))})})(Ua||(Ua={}));var Eh;(function(r){r.serialize=e=>({message:e.message,type:0,expected:e.expected,actual:e.actual,contextValue:e.contextValue,location:e.location&&Ua.serialize(e.location)}),r.deserialize=(e,t)=>({message:t.message,type:0,expected:t.expected,actual:t.actual,contextValue:t.contextValue,location:t.location&&Ua.deserialize(e,t.location)})})(Eh||(Eh={}));var kh;(function(r){r.serialize=e=>({message:e.message,type:1,offset:e.offset,length:e.length,location:e.location&&Ua.serialize(e.location)}),r.deserialize=(e,t)=>({message:t.message,type:1,offset:t.offset,length:t.length,location:t.location&&Ua.deserialize(e,t.location)})})(kh||(kh={}));var Dh;(function(r){r.serialize=e=>e.type===0?Eh.serialize(e):kh.serialize(e),r.deserialize=(e,t)=>t.type===0?Eh.deserialize(e,t):kh.deserialize(e,t)})(Dh||(Dh={}));var ol;(function(r){r.serializeWithoutMessages=e=>({state:e.state,duration:e.duration,messages:[]}),r.serialize=e=>({state:e.state,duration:e.duration,messages:e.messages.map(Dh.serialize)}),r.deserialize=(e,t)=>({state:t.state,duration:t.duration,messages:t.messages.map(i=>Dh.deserialize(e,i))})})(ol||(ol={}));const aC="\0",Qd=(r,e)=>r+aC+e,cC=r=>{const e=r.indexOf(aC);return{ctrlId:r.slice(0,e),tagId:r.slice(e+1)}};var Ih;(function(r){r.serialize=e=>{var t,i;return{extId:e.extId,label:e.label,tags:e.tags,busy:e.busy,children:void 0,uri:(t=e.uri)==null?void 0:t.toJSON(),range:((i=e.range)==null?void 0:i.toJSON())||null,description:e.description,error:e.error,sortText:e.sortText}},r.deserialize=(e,t)=>({extId:t.extId,label:t.label,tags:t.tags,busy:t.busy,children:void 0,uri:t.uri?e.asCanonicalUri(x.revive(t.uri)):void 0,range:t.range?Qe.lift(t.range):null,description:t.description,error:t.error,sortText:t.sortText})})(Ih||(Ih={}));var Vr;(function(r){r.serialize=e=>({expand:e.expand,item:Ih.serialize(e.item)}),r.deserialize=(e,t)=>({controllerId:ye.root(t.item.extId),expand:t.expand,item:Ih.deserialize(e,t.item)})})(Vr||(Vr={}));var Fl;(function(r){r.serialize=e=>{var i,n;let t;return e.item&&(t={},e.item.label!==void 0&&(t.label=e.item.label),e.item.tags!==void 0&&(t.tags=e.item.tags),e.item.busy!==void 0&&(t.busy=e.item.busy),e.item.uri!==void 0&&(t.uri=(i=e.item.uri)==null?void 0:i.toJSON()),e.item.range!==void 0&&(t.range=(n=e.item.range)==null?void 0:n.toJSON()),e.item.description!==void 0&&(t.description=e.item.description),e.item.error!==void 0&&(t.error=e.item.error),e.item.sortText!==void 0&&(t.sortText=e.item.sortText)),{extId:e.extId,expand:e.expand,item:t}},r.deserialize=e=>{let t;return e.item&&(t={},e.item.label!==void 0&&(t.label=e.item.label),e.item.tags!==void 0&&(t.tags=e.item.tags),e.item.busy!==void 0&&(t.busy=e.item.busy),e.item.range!==void 0&&(t.range=e.item.range?Qe.lift(e.item.range):null),e.item.description!==void 0&&(t.description=e.item.description),e.item.error!==void 0&&(t.error=e.item.error),e.item.sortText!==void 0&&(t.sortText=e.item.sortText)),{extId:e.extId,expand:e.expand,item:t}}})(Fl||(Fl={}));const Jm=(r,e)=>{e.expand!==void 0&&(r.expand=e.expand),e.item!==void 0&&(r.item=r.item?Object.assign(r.item,e.item):e.item)};var Eb;(function(r){r.serializeWithoutMessages=e=>({...Vr.serialize(e),ownComputedState:e.ownComputedState,computedState:e.computedState,tasks:e.tasks.map(ol.serializeWithoutMessages)}),r.serialize=e=>({...Vr.serialize(e),ownComputedState:e.ownComputedState,computedState:e.computedState,tasks:e.tasks.map(ol.serialize)}),r.deserialize=(e,t)=>({...Vr.deserialize(e,t),ownComputedState:t.ownComputedState,computedState:t.computedState,tasks:t.tasks.map(i=>ol.deserialize(e,i)),retired:!0})})(Eb||(Eb={}));var kb;(function(r){r.serialize=e=>({id:e.id,statement:e.statement,branch:e.branch,declaration:e.declaration,uri:e.uri.toJSON()}),r.deserialize=(e,t)=>({id:t.id,statement:t.statement,branch:t.branch,declaration:t.declaration,uri:e.asCanonicalUri(x.revive(t.uri))})})(kb||(kb={}));function Pw(r){var e;return{...r,location:(e=r.location)==null?void 0:e.toJSON()}}function Tw(r){return r.location=r.location?Mi.isIPosition(r.location)?Mi.lift(r.location):Qe.lift(r.location):void 0,r}var Db;(function(r){r.serialize=e=>e.type===0?Th.serialize(e):Ah.serialize(e),r.deserialize=e=>e.type===0?Th.deserialize(e):Ah.deserialize(e)})(Db||(Db={}));var Ph;(function(r){r.serialize=Pw,r.deserialize=Tw})(Ph||(Ph={}));var Th;(function(r){r.serialize=Pw,r.deserialize=Tw})(Th||(Th={}));var Ah;(function(r){r.serialize=e=>{var t;return{...Pw(e),branches:(t=e.branches)==null?void 0:t.map(Ph.serialize)}},r.deserialize=e=>{var t;return{...Tw(e),branches:(t=e.branches)==null?void 0:t.map(Ph.deserialize)}}})(Ah||(Ah={}));var Rh;(function(r){r.deserialize=(e,t)=>t.op===0?{op:t.op,item:Vr.deserialize(e,t.item)}:t.op===1?{op:t.op,item:Fl.deserialize(t.item)}:t.op===2?{op:t.op,uri:e.asCanonicalUri(x.revive(t.uri)),docv:t.docv}:t,r.serialize=e=>e.op===0?{op:e.op,item:Vr.serialize(e.item)}:e.op===1?{op:e.op,item:Fl.serialize(e.item)}:e})(Rh||(Rh={}));class E5{constructor(e){this.uriIdentity=e,this._tags=new Map,this.items=new Map,this.roots=new Set,this.busyControllerCount=0,this.pendingRootCount=0,this.tags=this._tags}apply(e){var i;const t=this.createChangeCollector();for(const n of e)switch(n.op){case 0:this.add(Vr.deserialize(this.uriIdentity,n.item),t);break;case 1:this.update(Fl.deserialize(n.item),t);break;case 3:this.remove(n.itemId,t);break;case 5:this.retireTest(n.itemId);break;case 4:this.updatePendingRoots(n.amount);break;case 6:this._tags.set(n.tag.id,n.tag);break;case 7:this._tags.delete(n.id);break}(i=t.complete)==null||i.call(t)}add(e,t){var s,o;const i=(s=ye.parentId(e.item.extId))==null?void 0:s.toString();let n;if(!i)n=this.createItem(e),this.roots.add(n),this.items.set(e.item.extId,n);else if(this.items.has(i)){const a=this.items.get(i);a.children.add(e.item.extId),n=this.createItem(e,a),this.items.set(e.item.extId,n)}else{console.error(`Test with unknown parent ID: ${JSON.stringify(e)}`);return}return(o=t.add)==null||o.call(t,n),e.expand===2&&this.busyControllerCount++,n}update(e,t){var n;const i=this.items.get(e.extId);if(i)return e.expand!==void 0&&(i.expand===2&&this.busyControllerCount--,e.expand===2&&this.busyControllerCount++),Jm(i,e),(n=t.update)==null||n.call(t,i),i}remove(e,t){var o,a;const i=this.items.get(e);if(!i)return;const n=(o=ye.parentId(i.item.extId))==null?void 0:o.toString();n?this.items.get(n).children.delete(i.item.extId):this.roots.delete(i);const s=[[e]];for(;s.length;)for(const c of s.pop()){const l=this.items.get(c);l&&(s.push(l.children),this.items.delete(c),(a=t.remove)==null||a.call(t,l,l!==i),l.expand===2&&this.busyControllerCount--)}}retireTest(e){}updatePendingRoots(e){this.pendingRootCount+=e}createChangeCollector(){return{}}}const Nc=(r,e)=>r===e,k5={range:(r,e)=>r===e?!0:!r||!e?!1:r.equalsRange(e),busy:Nc,label:Nc,description:Nc,error:Nc,sortText:Nc,tags:(r,e)=>!(r.length!==e.length||r.some(t=>!e.includes(t)))},D5=Object.entries(k5),I5=(r,e)=>{let t;for(const[i,n]of D5)n(r[i],e[i])||(t?t[i]=e[i]:t={[i]:e[i]});return t};class P5 extends Fe{get root(){return this.options.root}constructor(e){super(),this.options=e,this.debounceSendDiff=this._register(new id(()=>this.flushDiff(),200)),this.diffOpEmitter=this._register(new R),this.tree=new Map,this.tags=new Map,this.diff=[],this.onDidGenerateDiff=this.diffOpEmitter.event,this.root.canResolveChildren=!0,this.upsertItem(this.root,void 0)}set resolveHandler(e){this._resolveHandler=e;for(const t of this.tree.values())this.updateExpandability(t)}get resolveHandler(){return this._resolveHandler}collectDiff(){const e=this.diff;return this.diff=[],e}pushDiff(e){switch(e.op){case 2:{for(const t of this.diff)if(t.op===2&&t.uri===e.uri){t.docv=e.docv;return}break}case 1:{const t=this.diff[this.diff.length-1];if(t){if(t.op===1&&t.item.extId===e.item.extId){Jm(t.item,e.item);return}if(t.op===0&&t.item.item.extId===e.item.extId){Jm(t.item,e.item);return}}break}}this.diff.push(e),this.debounceSendDiff.isScheduled()||this.debounceSendDiff.schedule()}expand(e,t){var n;const i=this.tree.get(e);if(i){if((i.expandLevels===void 0||t>i.expandLevels)&&(i.expandLevels=t),i.expand===1){const s=this.resolveChildren(i);return s.isOpen()?this.expandChildren(i,t-1):s.wait().then(()=>this.expandChildren(i,t-1))}else if(i.expand===3)return((n=i.resolveBarrier)==null?void 0:n.isOpen())===!1?i.resolveBarrier.wait().then(()=>this.expandChildren(i,t-1)):this.expandChildren(i,t-1)}}dispose(){for(const e of this.tree.values())this.options.getApiFor(e.actual).listener=void 0;this.tree.clear(),this.diff=[],super.dispose()}onTestItemEvent(e,t){switch(t.op){case 3:this.removeItem(ye.joinToString(e.fullId,t.id));break;case 0:this.upsertItem(t.item,e);break;case 5:for(const i of t.ops)this.onTestItemEvent(e,i);break;case 1:this.diffTagRefs(t.new,t.old,e.fullId.toString());break;case 2:this.updateExpandability(e);break;case 4:this.pushDiff({op:1,item:{extId:e.fullId.toString(),item:t.update}});break;case 6:this.documentSynced(e.actual.uri);break;default:C5()}}documentSynced(e){e&&this.pushDiff({op:2,uri:e,docv:this.options.getDocumentVersion(e)})}upsertItem(e,t){var u,d;const i=ye.fromExtHostTestItem(e,this.root.id,t==null?void 0:t.actual),n=this.options.getApiFor(e);n.parent&&n.parent!==(t==null?void 0:t.actual)&&this.options.getChildren(n.parent).delete(e.id);let s=this.tree.get(i.toString());if(!s){s={fullId:i,actual:e,expandLevels:t!=null&&t.expandLevels?t.expandLevels-1:void 0,expand:0},e.tags.forEach(this.incrementTagRefs,this),this.tree.set(s.fullId.toString(),s),this.setItemParent(e,t),this.pushDiff({op:0,item:{controllerId:this.options.controllerId,expand:s.expand,item:this.options.toITestItem(e)}}),this.connectItemAndChildren(e,s,t);return}if(s.actual===e){this.connectItem(e,s,t);return}if(((u=s.actual.uri)==null?void 0:u.toString())!==((d=e.uri)==null?void 0:d.toString()))return this.removeItem(i.toString()),this.upsertItem(e,t);const o=this.options.getChildren(s.actual),a=s.actual,c=I5(this.options.toITestItem(a),this.options.toITestItem(e));this.options.getApiFor(a).listener=void 0,s.actual=e,s.resolveBarrier=void 0,s.expand=0,c&&(c.hasOwnProperty("tags")&&(this.diffTagRefs(e.tags,a.tags,i.toString()),delete c.tags),this.onTestItemEvent(s,{op:4,update:c})),this.connectItemAndChildren(e,s,t);for(const[f,m]of o)this.options.getChildren(e).get(m.id)||this.removeItem(ye.joinToString(i,m.id));const l=s.expandLevels;l!==void 0&&queueMicrotask(()=>{s.expand===1&&(s.expandLevels=void 0,this.expand(i.toString(),l))}),this.documentSynced(s.actual.uri)}diffTagRefs(e,t,i){const n=new Set(t.map(s=>s.id));for(const s of e)n.delete(s.id)||this.incrementTagRefs(s);this.pushDiff({op:1,item:{extId:i,item:{tags:e.map(s=>Qd(this.options.controllerId,s.id))}}}),n.forEach(this.decrementTagRefs,this)}incrementTagRefs(e){const t=this.tags.get(e.id);t?t.refCount++:(this.tags.set(e.id,{refCount:1}),this.pushDiff({op:6,tag:{id:Qd(this.options.controllerId,e.id)}}))}decrementTagRefs(e){const t=this.tags.get(e);t&&!--t.refCount&&(this.tags.delete(e),this.pushDiff({op:7,id:Qd(this.options.controllerId,e)}))}setItemParent(e,t){this.options.getApiFor(e).parent=t&&t.actual!==this.root?t.actual:void 0}connectItem(e,t,i){this.setItemParent(e,i);const n=this.options.getApiFor(e);n.parent=i==null?void 0:i.actual,n.listener=s=>this.onTestItemEvent(t,s),this.updateExpandability(t)}connectItemAndChildren(e,t,i){this.connectItem(e,t,i);for(const[n,s]of this.options.getChildren(e))this.upsertItem(s,t)}updateExpandability(e){let t;this._resolveHandler?e.resolveBarrier?t=e.resolveBarrier.isOpen()?3:2:t=e.actual.canResolveChildren?1:0:t=0,t!==e.expand&&(e.expand=t,this.pushDiff({op:1,item:{extId:e.fullId.toString(),expand:t}}),t===1&&e.expandLevels!==void 0&&this.resolveChildren(e))}expandChildren(e,t){if(t<0)return;const i=[];for(const[n,s]of this.options.getChildren(e.actual)){const o=this.expand(ye.joinToString(e.fullId,s.id),t);Jr(o)&&i.push(o)}if(i.length)return Promise.all(i).then(()=>{})}resolveChildren(e){if(e.resolveBarrier)return e.resolveBarrier;if(!this._resolveHandler){const s=new Ki;return s.open(),s}e.expand=2,this.pushExpandStateUpdate(e);const t=e.resolveBarrier=new Ki,i=s=>{console.error(`Unhandled error in resolveHandler of test controller "${this.options.controllerId}"`,s)};let n;try{n=this._resolveHandler(e.actual===this.root?void 0:e.actual)}catch(s){i(s)}return Jr(n)?n.catch(i).then(()=>{t.open(),this.updateExpandability(e)}):(t.open(),this.updateExpandability(e)),e.resolveBarrier}pushExpandStateUpdate(e){this.pushDiff({op:1,item:{extId:e.fullId.toString(),expand:e.expand}})}removeItem(e){const t=this.tree.get(e);if(!t)throw new Error("attempting to remove non-existent child");this.pushDiff({op:3,itemId:e});const i=[t];for(;i.length;){const n=i.pop();if(n){this.options.getApiFor(n.actual).listener=void 0;for(const s of n.actual.tags)this.decrementTagRefs(s.id);this.tree.delete(n.fullId.toString());for(const[s,o]of this.options.getChildren(n.actual))i.push(this.tree.get(ye.joinToString(n.fullId,o.id)))}}}flushDiff(){const e=this.collectDiff();e.length&&this.diffOpEmitter.fire(e)}}class T5 extends Error{constructor(e){super(`Attempted to insert a duplicate test item ID ${e}`)}}class Lh extends Error{constructor(e){super(`TestItem with ID "${e}" is invalid. Make sure to create it from the createTestItem method.`)}}class A5 extends Error{constructor(e,t,i){super(`TestItem with ID "${e}" is from controller "${t}" and cannot be added as a child of an item from controller "${i}".`)}}const R5=(r,e,t)=>{let i=new Map;return{get size(){return i.size},forEach(n,s){for(const o of i.values())n.call(s,o,this)},[Symbol.iterator](){return i.entries()},replace(n){var c;const s=new Map,o=new Set(i.keys()),a={op:5,ops:[]};for(const l of n){if(!(l instanceof t))throw new Lh(l.id);const u=e(l).controllerId;if(u!==r.controllerId)throw new A5(l.id,u,r.controllerId);if(s.has(l.id))throw new T5(l.id);s.set(l.id,l),o.delete(l.id),a.ops.push({op:0,item:l})}for(const l of o.keys())a.ops.push({op:3,id:l});(c=r.listener)==null||c.call(r,a),i=s},add(n){var s;if(!(n instanceof t))throw new Lh(n.id);i.set(n.id,n),(s=r.listener)==null||s.call(r,{op:0,item:n})},delete(n){var s;i.delete(n)&&((s=r.listener)==null||s.call(r,{op:3,id:n}))},get(n){return i.get(n)},toJSON(){return Array.from(i.values())}}},lC=new WeakMap,L5=(r,e)=>{const t={controllerId:e};return lC.set(r,t),t},Xp=r=>{const e=lC.get(r);if(!e)throw new Lh((r==null?void 0:r.id)||"<unknown>");return e};class $5{constructor(){this.data=new Map}add(e,t){vi($e(e)),vi(Vt(t)),vi(!this.data.has(e),"There is already an extension with this id"),this.data.set(e,t)}knows(e){return this.data.has(e)}as(e){return this.data.get(e)||null}}const qt=new $5,Mc="vs/platform/files/common/files";var eo;(function(r){r[r.Unknown=0]="Unknown",r[r.File=1]="File",r[r.Directory=2]="Directory",r[r.SymbolicLink=64]="SymbolicLink"})(eo||(eo={}));var Ba;(function(r){r[r.Readonly=1]="Readonly",r[r.Locked=2]="Locked"})(Ba||(Ba={}));var Ib;(function(r){r[r.None=0]="None",r[r.FileReadWrite=2]="FileReadWrite",r[r.FileOpenReadWriteClose=4]="FileOpenReadWriteClose",r[r.FileReadStream=16]="FileReadStream",r[r.FileFolderCopy=8]="FileFolderCopy",r[r.PathCaseSensitive=1024]="PathCaseSensitive",r[r.Readonly=2048]="Readonly",r[r.Trash=4096]="Trash",r[r.FileWriteUnlock=8192]="FileWriteUnlock",r[r.FileAtomicRead=16384]="FileAtomicRead",r[r.FileAtomicWrite=32768]="FileAtomicWrite",r[r.FileAtomicDelete=65536]="FileAtomicDelete",r[r.FileClone=131072]="FileClone"})(Ib||(Ib={}));var Ee;(function(r){r.FileExists="EntryExists",r.FileNotFound="EntryNotFound",r.FileNotADirectory="EntryNotADirectory",r.FileIsADirectory="EntryIsADirectory",r.FileExceedsStorageQuota="EntryExceedsStorageQuota",r.FileTooLarge="EntryTooLarge",r.FileWriteLocked="EntryWriteLocked",r.NoPermissions="NoPermissions",r.Unavailable="Unavailable",r.Unknown="Unknown"})(Ee||(Ee={}));class Zp extends Error{static create(e,t){const i=new Zp(e.toString(),t);return uC(i,t),i}constructor(e,t){super(e),this.code=t}}function uC(r,e){return r.name=e?`${e} (FileSystemError)`:"FileSystemError",r}function Km(r){if(!r)return Ee.Unknown;if(r instanceof Zp)return r.code;const e=/^(.+) \(FileSystemError\)$/.exec(r.name);if(!e)return Ee.Unknown;switch(e[1]){case Ee.FileExists:return Ee.FileExists;case Ee.FileIsADirectory:return Ee.FileIsADirectory;case Ee.FileNotADirectory:return Ee.FileNotADirectory;case Ee.FileNotFound:return Ee.FileNotFound;case Ee.FileTooLarge:return Ee.FileTooLarge;case Ee.FileWriteLocked:return Ee.FileWriteLocked;case Ee.NoPermissions:return Ee.NoPermissions;case Ee.Unavailable:return Ee.Unavailable}return Ee.Unknown}var Pb;(function(r){r[r.UPDATED=0]="UPDATED",r[r.ADDED=1]="ADDED",r[r.DELETED=2]="DELETED"})(Pb||(Pb={}));class Tb extends Error{constructor(e,t,i){super(e),this.fileOperationResult=t,this.options=i}}var Ab;(function(r){r[r.FILE=0]="FILE",r[r.FOLDER=1]="FOLDER",r[r.ROOT_FOLDER=2]="ROOT_FOLDER"})(Ab||(Ab={}));const N5="";function Rb(r){if(!(typeof r.size!="number"||typeof r.mtime!="number"))return r.mtime.toString(29)+r.size.toString(31)}const kt=class kt{static formatSize(e){return Br(e)||(e=0),e<kt.KB?h(Mc,1,"{0}B",e.toFixed(0)):e<kt.MB?h(Mc,2,"{0}KB",(e/kt.KB).toFixed(2)):e<kt.GB?h(Mc,3,"{0}MB",(e/kt.MB).toFixed(2)):e<kt.TB?h(Mc,4,"{0}GB",(e/kt.GB).toFixed(2)):h(Mc,5,"{0}TB",(e/kt.TB).toFixed(2))}};kt.KB=1024,kt.MB=kt.KB*kt.KB,kt.GB=kt.MB*kt.KB,kt.TB=kt.GB*kt.KB;let Lb=kt;const sa="vs/base/common/errorMessage";function qg(r,e){return e&&(r.stack||r.stacktrace)?h(sa,0,"{0}: {1}",Nb(r),$b(r.stack)||$b(r.stacktrace)):Nb(r)}function $b(r){return Array.isArray(r)?r.join(`
`):r}function Nb(r){return r.code==="ERR_UNC_HOST_NOT_ALLOWED"?`${r.message}. Please update the 'security.allowedUNCHosts' setting if you want to allow this host.`:typeof r.code=="string"&&typeof r.errno=="number"&&typeof r.syscall=="string"?h(sa,1,"A system error occurred ({0})",r.message):r.message||h(sa,2,"An unknown error occurred. Please consult the log for more details.")}function Sc(r=null,e=!1){if(!r)return h(sa,2,"An unknown error occurred. Please consult the log for more details.");if(Array.isArray(r)){const t=ci(r),i=Sc(t[0],e);return t.length>1?h(sa,3,"{0} ({1} errors in total)",i,t.length):i}if($e(r))return r;if(r.detail){const t=r.detail;if(t.error)return qg(t.error,e);if(t.exception)return qg(t.exception,e)}return r.stack?qg(r,e):r.message?r.message:h(sa,2,"An unknown error occurred. Please consult the log for more details.")}const M5="vs/base/common/actions";class F5 extends Fe{constructor(e,t="",i="",n=!0,s){super(),this._onDidChange=this._register(new R),this.onDidChange=this._onDidChange.event,this._enabled=!0,this._id=e,this._label=t,this._cssClass=i,this._enabled=n,this._actionCallback=s}get id(){return this._id}get label(){return this._label}set label(e){this._setLabel(e)}_setLabel(e){this._label!==e&&(this._label=e,this._onDidChange.fire({label:e}))}get tooltip(){return this._tooltip||""}set tooltip(e){this._setTooltip(e)}_setTooltip(e){this._tooltip!==e&&(this._tooltip=e,this._onDidChange.fire({tooltip:e}))}get class(){return this._cssClass}set class(e){this._setClass(e)}_setClass(e){this._cssClass!==e&&(this._cssClass=e,this._onDidChange.fire({class:e}))}get enabled(){return this._enabled}set enabled(e){this._setEnabled(e)}_setEnabled(e){this._enabled!==e&&(this._enabled=e,this._onDidChange.fire({enabled:e}))}get checked(){return this._checked}set checked(e){this._setChecked(e)}_setChecked(e){this._checked!==e&&(this._checked=e,this._onDidChange.fire({checked:e}))}async run(e,t){this._actionCallback&&await this._actionCallback(e)}}const xp=class xp extends F5{constructor(){super(xp.ID,h(M5,0,"(empty)"),void 0,!1)}};xp.ID="vs.actions.empty";let Mb=xp;const Fb="vs/workbench/common/editor",O5={EditorPane:"workbench.contributions.editors",EditorFactory:"workbench.contributions.editor.inputFactories"},H5={id:"default",displayName:h(Fb,0,"Text Editor"),providerDisplayName:h(Fb,1,"Built-in")};var Ob;(function(r){r[r.None=0]="None",r[r.Readonly=2]="Readonly",r[r.Untitled=4]="Untitled",r[r.Singleton=8]="Singleton",r[r.RequiresTrust=16]="RequiresTrust",r[r.CanSplitInGroup=32]="CanSplitInGroup",r[r.ForceDescription=64]="ForceDescription",r[r.CanDropIntoEditor=128]="CanDropIntoEditor",r[r.MultipleEditors=256]="MultipleEditors",r[r.Scratchpad=512]="Scratchpad"})(Ob||(Ob={}));var Hb;(function(r){r[r.UNKNOWN=0]="UNKNOWN",r[r.REPLACE=1]="REPLACE",r[r.MOVE=2]="MOVE",r[r.UNPIN=3]="UNPIN"})(Hb||(Hb={}));var Ub;(function(r){r[r.PRIMARY=1]="PRIMARY",r[r.SECONDARY=2]="SECONDARY",r[r.BOTH=3]="BOTH",r[r.ANY=4]="ANY"})(Ub||(Ub={}));var Bb;(function(r){r[r.UNKNOWN=0]="UNKNOWN",r[r.KEYBOARD=1]="KEYBOARD",r[r.MOUSE=2]="MOUSE"})(Bb||(Bb={}));var Vb;(function(r){r[r.LEFT=0]="LEFT",r[r.RIGHT=1]="RIGHT"})(Vb||(Vb={}));class U5{constructor(){this.editorSerializerConstructors=new Map,this.editorSerializerInstances=new Map}start(e){const t=this.instantiationService=e.get(Qp);for(const[i,n]of this.editorSerializerConstructors)this.createEditorSerializer(i,n,t);this.editorSerializerConstructors.clear()}createEditorSerializer(e,t,i){const n=i.createInstance(t);this.editorSerializerInstances.set(e,n)}registerFileEditorFactory(e){if(this.fileEditorFactory)throw new Error("Can only register one file editor factory.");this.fileEditorFactory=e}getFileEditorFactory(){return Oa(this.fileEditorFactory)}registerEditorSerializer(e,t){if(this.editorSerializerConstructors.has(e)||this.editorSerializerInstances.has(e))throw new Error(`A editor serializer with type ID '${e}' was already registered.`);return this.instantiationService?this.createEditorSerializer(e,t,this.instantiationService):this.editorSerializerConstructors.set(e,t),De(()=>{this.editorSerializerConstructors.delete(e),this.editorSerializerInstances.delete(e)})}getEditorSerializer(e){return this.editorSerializerInstances.get(typeof e=="string"?e:e.typeId)}}qt.add(O5.EditorFactory,new U5);var Wb;(function(r){r[r.MOST_RECENTLY_ACTIVE=0]="MOST_RECENTLY_ACTIVE",r[r.SEQUENTIAL=1]="SEQUENTIAL"})(Wb||(Wb={}));const B5=(r,e)=>r===e;class zb{constructor(e,t,i){this.owner=e,this.debugNameSource=t,this.referenceFn=i}getDebugName(e){return V5(e,this)}}const jb=new Map,Xm=new WeakMap;function V5(r,e){const t=Xm.get(r);if(t)return t;const i=W5(r,e);if(i){let n=jb.get(i)??0;n++,jb.set(i,n);const s=n===1?i:`${i}#${n}`;return Xm.set(r,s),s}}function W5(r,e){const t=Xm.get(r);if(t)return t;const i=e.owner?j5(e.owner)+".":"";let n;const s=e.debugNameSource;if(s!==void 0)if(typeof s=="function"){if(n=s(),n!==void 0)return i+n}else return i+s;const o=e.referenceFn;if(o!==void 0&&(n=Aw(o),n!==void 0))return i+n;if(e.owner!==void 0){const a=z5(e.owner,r);if(a!==void 0)return i+a}}function z5(r,e){for(const t in r)if(r[t]===e)return t}const qb=new Map,Gb=new WeakMap;function j5(r){const e=Gb.get(r);if(e)return e;const t=q5(r);let i=qb.get(t)??0;i++,qb.set(t,i);const n=i===1?t:`${t}#${i}`;return Gb.set(r,n),n}function q5(r){const e=r.constructor;return e?e.name:"Object"}function Aw(r){const e=r.toString(),i=/\/\*\*\s*@description\s*([^*]*)\*\//.exec(e),n=i?i[1]:void 0;return n==null?void 0:n.trim()}let G5,Q5,J5;class K5{get TChange(){return null}reportChanges(){this.get()}read(e){return e?e.readObservable(this):this.get()}map(e,t){const i=t===void 0?void 0:e,n=t===void 0?e:t;return J5({owner:i,debugName:()=>{const s=Aw(n);if(s!==void 0)return s;const a=/^\s*\(?\s*([a-zA-Z_$][a-zA-Z_$0-9]*)\s*\)?\s*=>\s*\1(?:\??)\.([a-zA-Z_$][a-zA-Z_$0-9]*)\s*$/.exec(n.toString());if(a)return`${this.debugName}.${a[2]}`;if(!i)return`${this.debugName} (mapped)`},debugReferenceFn:n},s=>n(this.read(s),s))}recomputeInitiallyAndOnChange(e,t){return e.add(G5(this,t)),this}keepObserved(e){return e.add(Q5(this)),this}get debugValue(){return this.get()}}class X5 extends K5{constructor(){super(...arguments),this.observers=new Set}addObserver(e){const t=this.observers.size;this.observers.add(e),t===0&&this.onFirstObserverAdded()}removeObserver(e){this.observers.delete(e)&&this.observers.size===0&&this.onLastObserverRemoved()}onFirstObserverAdded(){}onLastObserverRemoved(){}}class Z5{constructor(e,t){this._fn=e,this._getDebugName=t,this.updatingObservers=[]}getDebugName(){return this._getDebugName?this._getDebugName():Aw(this._fn)}updateObserver(e,t){this.updatingObservers.push({observer:e,observable:t}),e.beginUpdate(t)}finish(){const e=this.updatingObservers;for(let t=0;t<e.length;t++){const{observer:i,observable:n}=e[t];i.endUpdate(n)}this.updatingObservers=null}}function Y5(r,e){let t;return typeof r=="string"?t=new zb(void 0,r,void 0):t=new zb(r,void 0,void 0),new eD(t,e,B5)}class eD extends X5{get debugName(){return this._debugNameData.getDebugName(this)??"ObservableValue"}constructor(e,t,i){super(),this._debugNameData=e,this._equalityComparator=i,this._value=t}get(){return this._value}set(e,t,i){if(this._equalityComparator(this._value,e))return;let n;t||(t=n=new Z5(()=>{},()=>`Setting ${this.debugName}`));try{this._setValue(e);for(const s of this.observers)t.updateObserver(s,this),s.handleChange(this,i)}finally{n&&n.finish()}}toString(){return`${this.debugName}: ${this._value}`}_setValue(e){this._value=e}}const al="vs/platform/contextkey/common/scanner";function Gg(...r){switch(r.length){case 1:return h(al,0,"Did you mean {0}?",r[0]);case 2:return h(al,1,"Did you mean {0} or {1}?",r[0],r[1]);case 3:return h(al,2,"Did you mean {0}, {1} or {2}?",r[0],r[1],r[2]);default:return}}const tD=h(al,3,"Did you forget to open or close the quote?"),iD=h(al,4,"Did you forget to escape the '/' (slash) character? Put two backslashes before it to escape, e.g., '\\\\/'."),Yo=class Yo{constructor(){this._input="",this._start=0,this._current=0,this._tokens=[],this._errors=[],this.stringRe=/[a-zA-Z0-9_<>\-\./\\:\*\?\+\[\]\^,#@;"%\$\p{L}-]+/uy}static getLexeme(e){switch(e.type){case 0:return"(";case 1:return")";case 2:return"!";case 3:return e.isTripleEq?"===":"==";case 4:return e.isTripleEq?"!==":"!=";case 5:return"<";case 6:return"<=";case 7:return">=";case 8:return">=";case 9:return"=~";case 10:return e.lexeme;case 11:return"true";case 12:return"false";case 13:return"in";case 14:return"not";case 15:return"&&";case 16:return"||";case 17:return e.lexeme;case 18:return e.lexeme;case 19:return e.lexeme;case 20:return"EOF";default:throw fw(`unhandled token type: ${JSON.stringify(e)}; have you forgotten to add a case?`)}}get errors(){return this._errors}reset(e){return this._input=e,this._start=0,this._current=0,this._tokens=[],this._errors=[],this}scan(){for(;!this._isAtEnd();)switch(this._start=this._current,this._advance()){case 40:this._addToken(0);break;case 41:this._addToken(1);break;case 33:if(this._match(61)){const t=this._match(61);this._tokens.push({type:4,offset:this._start,isTripleEq:t})}else this._addToken(2);break;case 39:this._quotedString();break;case 47:this._regex();break;case 61:if(this._match(61)){const t=this._match(61);this._tokens.push({type:3,offset:this._start,isTripleEq:t})}else this._match(126)?this._addToken(9):this._error(Gg("==","=~"));break;case 60:this._addToken(this._match(61)?6:5);break;case 62:this._addToken(this._match(61)?8:7);break;case 38:this._match(38)?this._addToken(15):this._error(Gg("&&"));break;case 124:this._match(124)?this._addToken(16):this._error(Gg("||"));break;case 32:case 13:case 9:case 10:case 160:break;default:this._string()}return this._start=this._current,this._addToken(20),Array.from(this._tokens)}_match(e){return this._isAtEnd()||this._input.charCodeAt(this._current)!==e?!1:(this._current++,!0)}_advance(){return this._input.charCodeAt(this._current++)}_peek(){return this._isAtEnd()?0:this._input.charCodeAt(this._current)}_addToken(e){this._tokens.push({type:e,offset:this._start})}_error(e){const t=this._start,i=this._input.substring(this._start,this._current),n={type:19,offset:this._start,lexeme:i};this._errors.push({offset:t,lexeme:i,additionalInfo:e}),this._tokens.push(n)}_string(){this.stringRe.lastIndex=this._start;const e=this.stringRe.exec(this._input);if(e){this._current=this._start+e[0].length;const t=this._input.substring(this._start,this._current),i=Yo._keywords.get(t);i?this._addToken(i):this._tokens.push({type:17,lexeme:t,offset:this._start})}}_quotedString(){for(;this._peek()!==39&&!this._isAtEnd();)this._advance();if(this._isAtEnd()){this._error(tD);return}this._advance(),this._tokens.push({type:18,lexeme:this._input.substring(this._start+1,this._current-1),offset:this._start+1})}_regex(){let e=this._current,t=!1,i=!1;for(;;){if(e>=this._input.length){this._current=e,this._error(iD);return}const s=this._input.charCodeAt(e);if(t)t=!1;else if(s===47&&!i){e++;break}else s===91?i=!0:s===92?t=!0:s===93&&(i=!1);e++}for(;e<this._input.length&&Yo._regexFlags.has(this._input.charCodeAt(e));)e++;this._current=e;const n=this._input.substring(this._start,this._current);this._tokens.push({type:10,lexeme:n,offset:this._start})}_isAtEnd(){return this._current>=this._input.length}};Yo._regexFlags=new Set(["i","g","s","m","y","u"].map(e=>e.charCodeAt(0))),Yo._keywords=new Map([["not",14],["in",13],["false",12],["true",11]]);let gs=Yo;const sn="vs/platform/contextkey/common/contextkey",Nt=new Map;Nt.set("false",!1);Nt.set("true",!0);Nt.set("isMac",rn);Nt.set("isLinux",Qr);Nt.set("isWindows",Ii);Nt.set("isWeb",bw);Nt.set("isMacNative",rn&&!bw);Nt.set("isEdge",B4);Nt.set("isFirefox",H4);Nt.set("isChrome",bx);Nt.set("isSafari",U4);const nD=Object.prototype.hasOwnProperty,rD={regexParsingWithErrorRecovery:!0},sD=h(sn,0,"Empty context key expression"),oD=h(sn,1,"Did you forget to write an expression? You can also put 'false' or 'true' to always evaluate to false or true, respectively."),aD=h(sn,2,"'in' after 'not'."),Qb=h(sn,3,"closing parenthesis ')'"),cD=h(sn,4,"Unexpected token"),lD=h(sn,5,"Did you forget to put && or || before the token?"),uD=h(sn,6,"Unexpected end of expression"),dD=h(sn,7,"Did you forget to put a context key?"),bs=class bs{get lexingErrors(){return this._scanner.errors}get parsingErrors(){return this._parsingErrors}constructor(e=rD){this._config=e,this._scanner=new gs,this._tokens=[],this._current=0,this._parsingErrors=[],this._flagsGYRe=/g|y/g}parse(e){if(e===""){this._parsingErrors.push({message:sD,offset:0,lexeme:"",additionalInfo:oD});return}this._tokens=this._scanner.reset(e).scan(),this._current=0,this._parsingErrors=[];try{const t=this._expr();if(!this._isAtEnd()){const i=this._peek(),n=i.type===17?lD:void 0;throw this._parsingErrors.push({message:cD,offset:i.offset,lexeme:gs.getLexeme(i),additionalInfo:n}),bs._parseError}return t}catch(t){if(t!==bs._parseError)throw t;return}}_expr(){return this._or()}_or(){const e=[this._and()];for(;this._matchOne(16);){const t=this._and();e.push(t)}return e.length===1?e[0]:Dt.or(...e)}_and(){const e=[this._term()];for(;this._matchOne(15);){const t=this._term();e.push(t)}return e.length===1?e[0]:Dt.and(...e)}_term(){if(this._matchOne(2)){const e=this._peek();switch(e.type){case 11:return this._advance(),zt.INSTANCE;case 12:return this._advance(),Xt.INSTANCE;case 0:{this._advance();const t=this._expr();return this._consume(1,Qb),t==null?void 0:t.negate()}case 17:return this._advance(),So.create(e.lexeme);default:throw this._errExpectedButGot("KEY | true | false | '(' expression ')'",e)}}return this._primary()}_primary(){const e=this._peek();switch(e.type){case 11:return this._advance(),Dt.true();case 12:return this._advance(),Dt.false();case 0:{this._advance();const t=this._expr();return this._consume(1,Qb),t}case 17:{const t=e.lexeme;if(this._advance(),this._matchOne(9)){const n=this._peek();if(!this._config.regexParsingWithErrorRecovery){if(this._advance(),n.type!==10)throw this._errExpectedButGot("REGEX",n);const s=n.lexeme,o=s.lastIndexOf("/"),a=o===s.length-1?void 0:this._removeFlagsGY(s.substring(o+1));let c;try{c=new RegExp(s.substring(1,o),a)}catch{throw this._errExpectedButGot("REGEX",n)}return Ol.create(t,c)}switch(n.type){case 10:case 19:{const s=[n.lexeme];this._advance();let o=this._peek(),a=0;for(let f=0;f<n.lexeme.length;f++)n.lexeme.charCodeAt(f)===40?a++:n.lexeme.charCodeAt(f)===41&&a--;for(;!this._isAtEnd()&&o.type!==15&&o.type!==16;){switch(o.type){case 0:a++;break;case 1:a--;break;case 10:case 18:for(let f=0;f<o.lexeme.length;f++)o.lexeme.charCodeAt(f)===40?a++:n.lexeme.charCodeAt(f)===41&&a--}if(a<0)break;s.push(gs.getLexeme(o)),this._advance(),o=this._peek()}const c=s.join(""),l=c.lastIndexOf("/"),u=l===c.length-1?void 0:this._removeFlagsGY(c.substring(l+1));let d;try{d=new RegExp(c.substring(1,l),u)}catch{throw this._errExpectedButGot("REGEX",n)}return Dt.regex(t,d)}case 18:{const s=n.lexeme;this._advance();let o=null;if(!gh(s)){const a=s.indexOf("/"),c=s.lastIndexOf("/");if(a!==c&&a>=0){const l=s.slice(a+1,c),u=s[c+1]==="i"?"i":"";try{o=new RegExp(l,u)}catch{throw this._errExpectedButGot("REGEX",n)}}}if(o===null)throw this._errExpectedButGot("REGEX",n);return Ol.create(t,o)}default:throw this._errExpectedButGot("REGEX",this._peek())}}if(this._matchOne(14)){this._consume(13,aD);const n=this._value();return Dt.notIn(t,n)}switch(this._peek().type){case 3:{this._advance();const n=this._value();if(this._previous().type===18)return Dt.equals(t,n);switch(n){case"true":return Dt.has(t);case"false":return Dt.not(t);default:return Dt.equals(t,n)}}case 4:{this._advance();const n=this._value();if(this._previous().type===18)return Dt.notEquals(t,n);switch(n){case"true":return Dt.not(t);case"false":return Dt.has(t);default:return Dt.notEquals(t,n)}}case 5:return this._advance(),ad.create(t,this._value());case 6:return this._advance(),cd.create(t,this._value());case 7:return this._advance(),sd.create(t,this._value());case 8:return this._advance(),od.create(t,this._value());case 13:return this._advance(),Dt.in(t,this._value());default:return Dt.has(t)}}case 20:throw this._parsingErrors.push({message:uD,offset:e.offset,lexeme:"",additionalInfo:dD}),bs._parseError;default:throw this._errExpectedButGot(`true | false | KEY 
	| KEY '=~' REGEX 
	| KEY ('==' | '!=' | '<' | '<=' | '>' | '>=' | 'in' | 'not' 'in') value`,this._peek())}}_value(){const e=this._peek();switch(e.type){case 17:case 18:return this._advance(),e.lexeme;case 11:return this._advance(),"true";case 12:return this._advance(),"false";case 13:return this._advance(),"in";default:return""}}_removeFlagsGY(e){return e.replaceAll(this._flagsGYRe,"")}_previous(){return this._tokens[this._current-1]}_matchOne(e){return this._check(e)?(this._advance(),!0):!1}_advance(){return this._isAtEnd()||this._current++,this._previous()}_consume(e,t){if(this._check(e))return this._advance();throw this._errExpectedButGot(t,this._peek())}_errExpectedButGot(e,t,i){const n=h(sn,8,`Expected: {0}
Received: '{1}'.`,e,gs.getLexeme(t)),s=t.offset,o=gs.getLexeme(t);return this._parsingErrors.push({message:n,offset:s,lexeme:o,additionalInfo:i}),bs._parseError}_check(e){return this._peek().type===e}_peek(){return this._tokens[this._current]}_isAtEnd(){return this._peek().type===20}};bs._parseError=new Error;let $h=bs;const f0=class f0{static false(){return zt.INSTANCE}static true(){return Xt.INSTANCE}static has(e){return Co.create(e)}static equals(e,t){return nd.create(e,t)}static notEquals(e,t){return rd.create(e,t)}static regex(e,t){return Ol.create(e,t)}static in(e,t){return Yp.create(e,t)}static notIn(e,t){return eg.create(e,t)}static not(e){return So.create(e)}static and(...e){return yr.create(e,null,!0)}static or(...e){return gn.create(e,null,!0)}static greater(e,t){return sd.create(e,t)}static greaterEquals(e,t){return od.create(e,t)}static smaller(e,t){return ad.create(e,t)}static smallerEquals(e,t){return cd.create(e,t)}static deserialize(e){return e==null?void 0:this._parser.parse(e)}};f0._parser=new $h({regexParsingWithErrorRecovery:!1});let Dt=f0;function hD(r){const e=new $h({regexParsingWithErrorRecovery:!1});return r.map(t=>(e.parse(t),e.lexingErrors.length>0?e.lexingErrors.map(i=>({errorMessage:i.additionalInfo?h(sn,9,"Unexpected token. Hint: {0}",i.additionalInfo):h(sn,10,"Unexpected token."),offset:i.offset,length:i.lexeme.length})):e.parsingErrors.length>0?e.parsingErrors.map(i=>({errorMessage:i.additionalInfo?`${i.message}. ${i.additionalInfo}`:i.message,offset:i.offset,length:i.lexeme.length})):[]))}function cl(r,e){return r.cmp(e)}const Cp=class Cp{constructor(){this.type=0}cmp(e){return this.type-e.type}equals(e){return e.type===this.type}substituteConstants(){return this}evaluate(e){return!1}serialize(){return"false"}keys(){return[]}map(e){return this}negate(){return Xt.INSTANCE}};Cp.INSTANCE=new Cp;let zt=Cp;const Sp=class Sp{constructor(){this.type=1}cmp(e){return this.type-e.type}equals(e){return e.type===this.type}substituteConstants(){return this}evaluate(e){return!0}serialize(){return"true"}keys(){return[]}map(e){return this}negate(){return zt.INSTANCE}};Sp.INSTANCE=new Sp;let Xt=Sp;class Co{static create(e,t=null){const i=Nt.get(e);return typeof i=="boolean"?i?Xt.INSTANCE:zt.INSTANCE:new Co(e,t)}constructor(e,t){this.key=e,this.negated=t,this.type=2}cmp(e){return e.type!==this.type?this.type-e.type:hC(this.key,e.key)}equals(e){return e.type===this.type?this.key===e.key:!1}substituteConstants(){const e=Nt.get(this.key);return typeof e=="boolean"?e?Xt.INSTANCE:zt.INSTANCE:this}evaluate(e){return!!e.getValue(this.key)}serialize(){return this.key}keys(){return[this.key]}map(e){return e.mapDefined(this.key)}negate(){return this.negated||(this.negated=So.create(this.key,this)),this.negated}}class nd{static create(e,t,i=null){if(typeof t=="boolean")return t?Co.create(e,i):So.create(e,i);const n=Nt.get(e);return typeof n=="boolean"?t===(n?"true":"false")?Xt.INSTANCE:zt.INSTANCE:new nd(e,t,i)}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=4}cmp(e){return e.type!==this.type?this.type-e.type:Eo(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){const e=Nt.get(this.key);if(typeof e=="boolean"){const t=e?"true":"false";return this.value===t?Xt.INSTANCE:zt.INSTANCE}return this}evaluate(e){return e.getValue(this.key)==this.value}serialize(){return`${this.key} == '${this.value}'`}keys(){return[this.key]}map(e){return e.mapEquals(this.key,this.value)}negate(){return this.negated||(this.negated=rd.create(this.key,this.value,this)),this.negated}}class Yp{static create(e,t){return new Yp(e,t)}constructor(e,t){this.key=e,this.valueKey=t,this.type=10,this.negated=null}cmp(e){return e.type!==this.type?this.type-e.type:Eo(this.key,this.valueKey,e.key,e.valueKey)}equals(e){return e.type===this.type?this.key===e.key&&this.valueKey===e.valueKey:!1}substituteConstants(){return this}evaluate(e){const t=e.getValue(this.valueKey),i=e.getValue(this.key);return Array.isArray(t)?t.includes(i):typeof i=="string"&&typeof t=="object"&&t!==null?nD.call(t,i):!1}serialize(){return`${this.key} in '${this.valueKey}'`}keys(){return[this.key,this.valueKey]}map(e){return e.mapIn(this.key,this.valueKey)}negate(){return this.negated||(this.negated=eg.create(this.key,this.valueKey)),this.negated}}class eg{static create(e,t){return new eg(e,t)}constructor(e,t){this.key=e,this.valueKey=t,this.type=11,this._negated=Yp.create(e,t)}cmp(e){return e.type!==this.type?this.type-e.type:this._negated.cmp(e._negated)}equals(e){return e.type===this.type?this._negated.equals(e._negated):!1}substituteConstants(){return this}evaluate(e){return!this._negated.evaluate(e)}serialize(){return`${this.key} not in '${this.valueKey}'`}keys(){return this._negated.keys()}map(e){return e.mapNotIn(this.key,this.valueKey)}negate(){return this._negated}}class rd{static create(e,t,i=null){if(typeof t=="boolean")return t?So.create(e,i):Co.create(e,i);const n=Nt.get(e);return typeof n=="boolean"?t===(n?"true":"false")?zt.INSTANCE:Xt.INSTANCE:new rd(e,t,i)}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=5}cmp(e){return e.type!==this.type?this.type-e.type:Eo(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){const e=Nt.get(this.key);if(typeof e=="boolean"){const t=e?"true":"false";return this.value===t?zt.INSTANCE:Xt.INSTANCE}return this}evaluate(e){return e.getValue(this.key)!=this.value}serialize(){return`${this.key} != '${this.value}'`}keys(){return[this.key]}map(e){return e.mapNotEquals(this.key,this.value)}negate(){return this.negated||(this.negated=nd.create(this.key,this.value,this)),this.negated}}class So{static create(e,t=null){const i=Nt.get(e);return typeof i=="boolean"?i?zt.INSTANCE:Xt.INSTANCE:new So(e,t)}constructor(e,t){this.key=e,this.negated=t,this.type=3}cmp(e){return e.type!==this.type?this.type-e.type:hC(this.key,e.key)}equals(e){return e.type===this.type?this.key===e.key:!1}substituteConstants(){const e=Nt.get(this.key);return typeof e=="boolean"?e?zt.INSTANCE:Xt.INSTANCE:this}evaluate(e){return!e.getValue(this.key)}serialize(){return`!${this.key}`}keys(){return[this.key]}map(e){return e.mapNot(this.key)}negate(){return this.negated||(this.negated=Co.create(this.key,this)),this.negated}}function tg(r,e){if(typeof r=="string"){const t=parseFloat(r);isNaN(t)||(r=t)}return typeof r=="string"||typeof r=="number"?e(r):zt.INSTANCE}class sd{static create(e,t,i=null){return tg(t,n=>new sd(e,n,i))}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=12}cmp(e){return e.type!==this.type?this.type-e.type:Eo(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))>this.value}serialize(){return`${this.key} > ${this.value}`}keys(){return[this.key]}map(e){return e.mapGreater(this.key,this.value)}negate(){return this.negated||(this.negated=cd.create(this.key,this.value,this)),this.negated}}class od{static create(e,t,i=null){return tg(t,n=>new od(e,n,i))}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=13}cmp(e){return e.type!==this.type?this.type-e.type:Eo(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))>=this.value}serialize(){return`${this.key} >= ${this.value}`}keys(){return[this.key]}map(e){return e.mapGreaterEquals(this.key,this.value)}negate(){return this.negated||(this.negated=ad.create(this.key,this.value,this)),this.negated}}class ad{static create(e,t,i=null){return tg(t,n=>new ad(e,n,i))}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=14}cmp(e){return e.type!==this.type?this.type-e.type:Eo(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))<this.value}serialize(){return`${this.key} < ${this.value}`}keys(){return[this.key]}map(e){return e.mapSmaller(this.key,this.value)}negate(){return this.negated||(this.negated=od.create(this.key,this.value,this)),this.negated}}class cd{static create(e,t,i=null){return tg(t,n=>new cd(e,n,i))}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=15}cmp(e){return e.type!==this.type?this.type-e.type:Eo(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))<=this.value}serialize(){return`${this.key} <= ${this.value}`}keys(){return[this.key]}map(e){return e.mapSmallerEquals(this.key,this.value)}negate(){return this.negated||(this.negated=sd.create(this.key,this.value,this)),this.negated}}class Ol{static create(e,t){return new Ol(e,t)}constructor(e,t){this.key=e,this.regexp=t,this.type=7,this.negated=null}cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.key<e.key)return-1;if(this.key>e.key)return 1;const t=this.regexp?this.regexp.source:"",i=e.regexp?e.regexp.source:"";return t<i?-1:t>i?1:0}equals(e){if(e.type===this.type){const t=this.regexp?this.regexp.source:"",i=e.regexp?e.regexp.source:"";return this.key===e.key&&t===i}return!1}substituteConstants(){return this}evaluate(e){const t=e.getValue(this.key);return this.regexp?this.regexp.test(t):!1}serialize(){const e=this.regexp?`/${this.regexp.source}/${this.regexp.flags}`:"/invalid/";return`${this.key} =~ ${e}`}keys(){return[this.key]}map(e){return e.mapRegex(this.key,this.regexp)}negate(){return this.negated||(this.negated=Nh.create(this)),this.negated}}class Nh{static create(e){return new Nh(e)}constructor(e){this._actual=e,this.type=8}cmp(e){return e.type!==this.type?this.type-e.type:this._actual.cmp(e._actual)}equals(e){return e.type===this.type?this._actual.equals(e._actual):!1}substituteConstants(){return this}evaluate(e){return!this._actual.evaluate(e)}serialize(){return`!(${this._actual.serialize()})`}keys(){return this._actual.keys()}map(e){return new Nh(this._actual.map(e))}negate(){return this._actual}}function dC(r){let e=null;for(let t=0,i=r.length;t<i;t++){const n=r[t].substituteConstants();if(r[t]!==n&&e===null){e=[];for(let s=0;s<t;s++)e[s]=r[s]}e!==null&&(e[t]=n)}return e===null?r:e}class yr{static create(e,t,i){return yr._normalizeArr(e,t,i)}constructor(e,t){this.expr=e,this.negated=t,this.type=6}cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.expr.length<e.expr.length)return-1;if(this.expr.length>e.expr.length)return 1;for(let t=0,i=this.expr.length;t<i;t++){const n=cl(this.expr[t],e.expr[t]);if(n!==0)return n}return 0}equals(e){if(e.type===this.type){if(this.expr.length!==e.expr.length)return!1;for(let t=0,i=this.expr.length;t<i;t++)if(!this.expr[t].equals(e.expr[t]))return!1;return!0}return!1}substituteConstants(){const e=dC(this.expr);return e===this.expr?this:yr.create(e,this.negated,!1)}evaluate(e){for(let t=0,i=this.expr.length;t<i;t++)if(!this.expr[t].evaluate(e))return!1;return!0}static _normalizeArr(e,t,i){const n=[];let s=!1;for(const o of e)if(o){if(o.type===1){s=!0;continue}if(o.type===0)return zt.INSTANCE;if(o.type===6){n.push(...o.expr);continue}n.push(o)}if(n.length===0&&s)return Xt.INSTANCE;if(n.length!==0){if(n.length===1)return n[0];n.sort(cl);for(let o=1;o<n.length;o++)n[o-1].equals(n[o])&&(n.splice(o,1),o--);if(n.length===1)return n[0];for(;n.length>1;){const o=n[n.length-1];if(o.type!==9)break;n.pop();const a=n.pop(),c=n.length===0,l=gn.create(o.expr.map(u=>yr.create([u,a],null,i)),null,c);l&&(n.push(l),n.sort(cl))}if(n.length===1)return n[0];if(i){for(let o=0;o<n.length;o++)for(let a=o+1;a<n.length;a++)if(n[o].negate().equals(n[a]))return zt.INSTANCE;if(n.length===1)return n[0]}return new yr(n,t)}}serialize(){return this.expr.map(e=>e.serialize()).join(" && ")}keys(){const e=[];for(const t of this.expr)e.push(...t.keys());return e}map(e){return new yr(this.expr.map(t=>t.map(e)),null)}negate(){if(!this.negated){const e=[];for(const t of this.expr)e.push(t.negate());this.negated=gn.create(e,this,!0)}return this.negated}}class gn{static create(e,t,i){return gn._normalizeArr(e,t,i)}constructor(e,t){this.expr=e,this.negated=t,this.type=9}cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.expr.length<e.expr.length)return-1;if(this.expr.length>e.expr.length)return 1;for(let t=0,i=this.expr.length;t<i;t++){const n=cl(this.expr[t],e.expr[t]);if(n!==0)return n}return 0}equals(e){if(e.type===this.type){if(this.expr.length!==e.expr.length)return!1;for(let t=0,i=this.expr.length;t<i;t++)if(!this.expr[t].equals(e.expr[t]))return!1;return!0}return!1}substituteConstants(){const e=dC(this.expr);return e===this.expr?this:gn.create(e,this.negated,!1)}evaluate(e){for(let t=0,i=this.expr.length;t<i;t++)if(this.expr[t].evaluate(e))return!0;return!1}static _normalizeArr(e,t,i){let n=[],s=!1;if(e){for(let o=0,a=e.length;o<a;o++){const c=e[o];if(c){if(c.type===0){s=!0;continue}if(c.type===1)return Xt.INSTANCE;if(c.type===9){n=n.concat(c.expr);continue}n.push(c)}}if(n.length===0&&s)return zt.INSTANCE;n.sort(cl)}if(n.length!==0){if(n.length===1)return n[0];for(let o=1;o<n.length;o++)n[o-1].equals(n[o])&&(n.splice(o,1),o--);if(n.length===1)return n[0];if(i){for(let o=0;o<n.length;o++)for(let a=o+1;a<n.length;a++)if(n[o].negate().equals(n[a]))return Xt.INSTANCE;if(n.length===1)return n[0]}return new gn(n,t)}}serialize(){return this.expr.map(e=>e.serialize()).join(" || ")}keys(){const e=[];for(const t of this.expr)e.push(...t.keys());return e}map(e){return new gn(this.expr.map(t=>t.map(e)),null)}negate(){if(!this.negated){const e=[];for(const t of this.expr)e.push(t.negate());for(;e.length>1;){const t=e.shift(),i=e.shift(),n=[];for(const s of Jb(t))for(const o of Jb(i))n.push(yr.create([s,o],null,!1));e.unshift(gn.create(n,null,!1))}this.negated=gn.create(e,this,!0)}return this.negated}}const ea=class ea extends Co{static all(){return ea._info.values()}constructor(e,t,i){super(e,null),this._defaultValue=t,typeof i=="object"?ea._info.push({...i,key:e}):i!==!0&&ea._info.push({key:e,description:i,type:t!=null?typeof t:void 0})}bindTo(e){return e.createKey(this.key,this._defaultValue)}getValue(e){return e.getContextKeyValue(this.key)}toNegated(){return this.negate()}isEqualTo(e){return nd.create(this.key,e)}notEqualsTo(e){return rd.create(this.key,e)}};ea._info=[];let G=ea;function hC(r,e){return r<e?-1:r>e?1:0}function Eo(r,e,t,i){return r<t?-1:r>t?1:e<i?-1:e>i?1:0}function Jb(r){return r.type===9?r.expr:[r]}const fD=Ce("contextKeyService"),pD=Ce("productService");function Zm(r,e){const t=Object.create(null);for(const i in r)fC(t,i,r[i],e);return t}function fC(r,e,t,i){const n=e.split("."),s=n.pop();let o=r;for(let a=0;a<n.length;a++){const c=n[a];let l=o[c];switch(typeof l){case"undefined":l=o[c]=Object.create(null);break;case"object":if(l===null){i(`Ignoring ${e} as ${n.slice(0,a+1).join(".")} is null`);return}break;default:i(`Ignoring ${e} as ${n.slice(0,a+1).join(".")} is ${JSON.stringify(l)}`);return}o=l}if(typeof o=="object"&&o!==null)try{o[s]=t}catch{i(`Ignoring ${e} as ${n.join(".")} is ${JSON.stringify(o)}`)}else i(`Ignoring ${e} as ${n.join(".")} is ${JSON.stringify(o)}`)}function gD(r,e){const t=e.split(".");pC(r,t)}function pC(r,e){const t=e.shift();if(e.length===0){delete r[t];return}if(Object.keys(r).indexOf(t)!==-1){const i=r[t];typeof i=="object"&&!Array.isArray(i)&&(pC(i,e),Object.keys(i).length===0&&delete r[t])}}function Mh(r,e,t){function i(o,a){let c=o;for(const l of a){if(typeof c!="object"||c===null)return;c=c[l]}return c}const n=e.split("."),s=i(r,n);return typeof s>"u"?t:s}function mD(r){return r.replace(/[\[\]]/g,"")}const ig={JSONContribution:"base.contributions.json"};function vD(r){return r.length>0&&r.charAt(r.length-1)==="#"?r.substring(0,r.length-1):r}class _D{constructor(){this._onDidChangeSchema=new R,this.onDidChangeSchema=this._onDidChangeSchema.event,this.schemasById={}}registerSchema(e,t){this.schemasById[vD(e)]=t,this._onDidChangeSchema.fire(e)}notifySchemaChanged(e){this._onDidChangeSchema.fire(e)}getSchemaContributions(){return{schemas:this.schemasById}}}const wD=new _D;qt.add(ig.JSONContribution,wD);const mn="vs/platform/configuration/common/configurationRegistry";var Kb;(function(r){r.Multiline="multilineText",r.Singleline="singlelineText"})(Kb||(Kb={}));const ld={Configuration:"base.contributions.configuration"};var Xb;(function(r){r[r.APPLICATION=1]="APPLICATION",r[r.MACHINE=2]="MACHINE",r[r.WINDOW=3]="WINDOW",r[r.RESOURCE=4]="RESOURCE",r[r.LANGUAGE_OVERRIDABLE=5]="LANGUAGE_OVERRIDABLE",r[r.MACHINE_OVERRIDABLE=6]="MACHINE_OVERRIDABLE"})(Xb||(Xb={}));const cs="vscode://schemas/settings/resourceLanguage",Td=qt.as(ig.JSONContribution);class bD{constructor(){this.overrideIdentifiers=new Set,this._onDidSchemaChange=new R,this.onDidSchemaChange=this._onDidSchemaChange.event,this._onDidUpdateConfiguration=new R,this.onDidUpdateConfiguration=this._onDidUpdateConfiguration.event,this.configurationDefaultsOverrides=new Map,this.defaultLanguageConfigurationOverridesNode={id:"defaultOverrides",title:h(mn,0,"Default Language Configuration Overrides"),properties:{}},this.configurationContributors=[this.defaultLanguageConfigurationOverridesNode],this.resourceLanguageSettingsSchema={properties:{},patternProperties:{},additionalProperties:!0,allowTrailingCommas:!0,allowComments:!0},this.configurationProperties={},this.policyConfigurations=new Map,this.excludedConfigurationProperties={},Td.registerSchema(cs,this.resourceLanguageSettingsSchema),this.registerOverridePropertyPatternKey()}registerConfiguration(e,t=!0){this.registerConfigurations([e],t)}registerConfigurations(e,t=!0){const i=new Set;this.doRegisterConfigurations(e,t,i),Td.registerSchema(cs,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:i})}deregisterConfigurations(e){const t=new Set;this.doDeregisterConfigurations(e,t),Td.registerSchema(cs,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:t})}updateConfigurations({add:e,remove:t}){const i=new Set;this.doDeregisterConfigurations(t,i),this.doRegisterConfigurations(e,!1,i),Td.registerSchema(cs,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:i})}registerDefaultConfigurations(e){const t=new Set;this.doRegisterDefaultConfigurations(e,t),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:t,defaultsOverrides:!0})}doRegisterDefaultConfigurations(e,t){const i=[];for(const{overrides:n,source:s}of e)for(const o in n)if(t.add(o),yn.test(o)){const a=this.configurationDefaultsOverrides.get(o),c=(a==null?void 0:a.valuesSources)??new Map;if(s)for(const f of Object.keys(n[o]))c.set(f,s);const l={...(a==null?void 0:a.value)||{},...n[o]};this.configurationDefaultsOverrides.set(o,{source:s,value:l,valuesSources:c});const u=mD(o),d={type:"object",default:l,description:h(mn,1,"Configure settings to be overridden for the {0} language.",u),$ref:cs,defaultDefaultValue:l,source:$e(s)?void 0:s,defaultValueSource:s};i.push(...Hl(o)),this.configurationProperties[o]=d,this.defaultLanguageConfigurationOverridesNode.properties[o]=d}else{this.configurationDefaultsOverrides.set(o,{value:n[o],source:s});const a=this.configurationProperties[o];a&&(this.updatePropertyDefaultValue(o,a),this.updateSchema(o,a))}this.doRegisterOverrideIdentifiers(i)}deregisterDefaultConfigurations(e){const t=new Set;this.doDeregisterDefaultConfigurations(e,t),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:t,defaultsOverrides:!0})}doDeregisterDefaultConfigurations(e,t){var i;for(const{overrides:n,source:s}of e)for(const o in n){const a=this.configurationDefaultsOverrides.get(o),c=$e(s)?s:s==null?void 0:s.id,l=$e(a==null?void 0:a.source)?a==null?void 0:a.source:(i=a==null?void 0:a.source)==null?void 0:i.id;if(c===l)if(t.add(o),this.configurationDefaultsOverrides.delete(o),yn.test(o))delete this.configurationProperties[o],delete this.defaultLanguageConfigurationOverridesNode.properties[o];else{const u=this.configurationProperties[o];u&&(this.updatePropertyDefaultValue(o,u),this.updateSchema(o,u))}}this.updateOverridePropertyPatternKey()}deltaConfiguration(e){let t=!1;const i=new Set;e.removedDefaults&&(this.doDeregisterDefaultConfigurations(e.removedDefaults,i),t=!0),e.addedDefaults&&(this.doRegisterDefaultConfigurations(e.addedDefaults,i),t=!0),e.removedConfigurations&&this.doDeregisterConfigurations(e.removedConfigurations,i),e.addedConfigurations&&this.doRegisterConfigurations(e.addedConfigurations,!1,i),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:i,defaultsOverrides:t})}notifyConfigurationSchemaUpdated(...e){this._onDidSchemaChange.fire()}registerOverrideIdentifiers(e){this.doRegisterOverrideIdentifiers(e),this._onDidSchemaChange.fire()}doRegisterOverrideIdentifiers(e){for(const t of e)this.overrideIdentifiers.add(t);this.updateOverridePropertyPatternKey()}doRegisterConfigurations(e,t,i){e.forEach(n=>{this.validateAndRegisterProperties(n,t,n.extensionInfo,n.restrictedProperties,void 0,i),this.configurationContributors.push(n),this.registerJSONConfiguration(n)})}doDeregisterConfigurations(e,t){const i=n=>{var s,o;if(n.properties)for(const a in n.properties){t.add(a);const c=this.configurationProperties[a];(s=c==null?void 0:c.policy)!=null&&s.name&&this.policyConfigurations.delete(c.policy.name),delete this.configurationProperties[a],this.removeFromSchema(a,n.properties[a])}(o=n.allOf)==null||o.forEach(a=>i(a))};for(const n of e){i(n);const s=this.configurationContributors.indexOf(n);s!==-1&&this.configurationContributors.splice(s,1)}}validateAndRegisterProperties(e,t=!0,i,n,s=3,o){var l;s=Qt(e.scope)?s:e.scope;const a=e.properties;if(a)for(const u in a){const d=a[u];if(t&&CD(u,d)){delete a[u];continue}if(d.source=i,d.defaultDefaultValue=a[u].default,this.updatePropertyDefaultValue(u,d),yn.test(u)?d.scope=void 0:(d.scope=Qt(d.scope)?s:d.scope,d.restricted=Qt(d.restricted)?!!(n!=null&&n.includes(u)):d.restricted),a[u].hasOwnProperty("included")&&!a[u].included){this.excludedConfigurationProperties[u]=a[u],delete a[u];continue}else this.configurationProperties[u]=a[u],(l=a[u].policy)!=null&&l.name&&this.policyConfigurations.set(a[u].policy.name,u);!a[u].deprecationMessage&&a[u].markdownDeprecationMessage&&(a[u].deprecationMessage=a[u].markdownDeprecationMessage),o.add(u)}const c=e.allOf;if(c)for(const u of c)this.validateAndRegisterProperties(u,t,i,n,s,o)}getConfigurations(){return this.configurationContributors}getConfigurationProperties(){return this.configurationProperties}getPolicyConfigurations(){return this.policyConfigurations}getExcludedConfigurationProperties(){return this.excludedConfigurationProperties}getConfigurationDefaultsOverrides(){return this.configurationDefaultsOverrides}registerJSONConfiguration(e){const t=i=>{const n=i.properties;if(n)for(const o in n)this.updateSchema(o,n[o]);const s=i.allOf;s==null||s.forEach(t)};t(e)}updateSchema(e,t){switch(t.scope){case 1:break;case 2:break;case 6:break;case 3:break;case 4:break;case 5:this.resourceLanguageSettingsSchema.properties[e]=t;break}}removeFromSchema(e,t){switch(t.scope){case 1:break;case 2:break;case 6:break;case 3:break;case 4:case 5:delete this.resourceLanguageSettingsSchema.properties[e];break}}updateOverridePropertyPatternKey(){for(const e of this.overrideIdentifiers.values()){const t=`[${e}]`,i={type:"object",description:h(mn,2,"Configure editor settings to be overridden for a language."),errorMessage:h(mn,3,"This setting does not support per-language configuration."),$ref:cs};this.updatePropertyDefaultValue(t,i)}}registerOverridePropertyPatternKey(){h(mn,2,"Configure editor settings to be overridden for a language."),h(mn,3,"This setting does not support per-language configuration."),this._onDidSchemaChange.fire()}updatePropertyDefaultValue(e,t){const i=this.configurationDefaultsOverrides.get(e);let n=i==null?void 0:i.value,s=i==null?void 0:i.source;Lm(n)&&(n=t.defaultDefaultValue,s=void 0),Lm(n)&&(n=xD(t.type)),t.default=n,t.defaultValueSource=s}}const gC="\\[([^\\]]+)\\]",Zb=new RegExp(gC,"g"),yD=`^(${gC})+$`,yn=new RegExp(yD);function Hl(r){const e=[];if(yn.test(r)){let t=Zb.exec(r);for(;t!=null&&t.length;){const i=t[1].trim();i&&e.push(i),t=Zb.exec(r)}}return Wo(e)}function xD(r){switch(Array.isArray(r)?r[0]:r){case"boolean":return!1;case"integer":case"number":return 0;case"string":return"";case"array":return[];case"object":return{};default:return null}}const Jd=new bD;qt.add(ld.Configuration,Jd);function CD(r,e){var t,i,n,s;return r.trim()?yn.test(r)?h(mn,5,"Cannot register '{0}'. This matches property pattern '\\\\[.*\\\\]$' for describing language specific editor settings. Use 'configurationDefaults' contribution.",r):Jd.getConfigurationProperties()[r]!==void 0?h(mn,6,"Cannot register '{0}'. This property is already registered.",r):(t=e.policy)!=null&&t.name&&Jd.getPolicyConfigurations().get((i=e.policy)==null?void 0:i.name)!==void 0?h(mn,7,"Cannot register '{0}'. The associated policy {1} is already registered with {2}.",r,(n=e.policy)==null?void 0:n.name,Jd.getPolicyConfigurations().get((s=e.policy)==null?void 0:s.name)):null:h(mn,4,"Cannot register an empty property")}function Rw(r){return Lw(r,0)}function Lw(r,e){switch(typeof r){case"object":return r===null?Qn(349,e):Array.isArray(r)?ED(r,e):kD(r,e);case"string":return mC(r,e);case"boolean":return SD(r,e);case"number":return Qn(r,e);case"undefined":return Qn(937,e);default:return Qn(617,e)}}function Qn(r,e){return(e<<5)-e+r|0}function SD(r,e){return Qn(r?433:863,e)}function mC(r,e){e=Qn(149417,e);for(let t=0,i=r.length;t<i;t++)e=Qn(r.charCodeAt(t),e);return e}function ED(r,e){return e=Qn(104579,e),r.reduce((t,i)=>Lw(i,t),e)}function kD(r,e){return e=Qn(181387,e),Object.keys(r).sort().reduce((t,i)=>(t=mC(i,t),Lw(r[i],t)),e)}function Qg(r,e,t=32){const i=t-e,n=~((1<<i)-1);return(r<<e|(n&r)>>>i)>>>0}function Yb(r,e=0,t=r.byteLength,i=0){for(let n=0;n<t;n++)r[e+n]=i}function DD(r,e,t="0"){for(;r.length<e;)r=t+r;return r}function Fc(r,e=32){return r instanceof ArrayBuffer?Array.from(new Uint8Array(r)).map(t=>t.toString(16).padStart(2,"0")).join(""):DD((r>>>0).toString(16),e/4)}const Ep=class Ep{constructor(){this._h0=1732584193,this._h1=4023233417,this._h2=2562383102,this._h3=271733878,this._h4=3285377520,this._buff=new Uint8Array(67),this._buffDV=new DataView(this._buff.buffer),this._buffLen=0,this._totalLen=0,this._leftoverHighSurrogate=0,this._finished=!1}update(e){const t=e.length;if(t===0)return;const i=this._buff;let n=this._buffLen,s=this._leftoverHighSurrogate,o,a;for(s!==0?(o=s,a=-1,s=0):(o=e.charCodeAt(0),a=0);;){let c=o;if(Gp(o))if(a+1<t){const l=e.charCodeAt(a+1);mh(l)?(a++,c=Cw(o,l)):c=65533}else{s=o;break}else mh(o)&&(c=65533);if(n=this._push(i,n,c),a++,a<t)o=e.charCodeAt(a);else break}this._buffLen=n,this._leftoverHighSurrogate=s}_push(e,t,i){return i<128?e[t++]=i:i<2048?(e[t++]=192|(i&1984)>>>6,e[t++]=128|(i&63)>>>0):i<65536?(e[t++]=224|(i&61440)>>>12,e[t++]=128|(i&4032)>>>6,e[t++]=128|(i&63)>>>0):(e[t++]=240|(i&1835008)>>>18,e[t++]=128|(i&258048)>>>12,e[t++]=128|(i&4032)>>>6,e[t++]=128|(i&63)>>>0),t>=64&&(this._step(),t-=64,this._totalLen+=64,e[0]=e[64],e[1]=e[65],e[2]=e[66]),t}digest(){return this._finished||(this._finished=!0,this._leftoverHighSurrogate&&(this._leftoverHighSurrogate=0,this._buffLen=this._push(this._buff,this._buffLen,65533)),this._totalLen+=this._buffLen,this._wrapUp()),Fc(this._h0)+Fc(this._h1)+Fc(this._h2)+Fc(this._h3)+Fc(this._h4)}_wrapUp(){this._buff[this._buffLen++]=128,Yb(this._buff,this._buffLen),this._buffLen>56&&(this._step(),Yb(this._buff));const e=8*this._totalLen;this._buffDV.setUint32(56,Math.floor(e/4294967296),!1),this._buffDV.setUint32(60,e%4294967296,!1),this._step()}_step(){const e=Ep._bigBlock32,t=this._buffDV;for(let d=0;d<64;d+=4)e.setUint32(d,t.getUint32(d,!1),!1);for(let d=64;d<320;d+=4)e.setUint32(d,Qg(e.getUint32(d-12,!1)^e.getUint32(d-32,!1)^e.getUint32(d-56,!1)^e.getUint32(d-64,!1),1),!1);let i=this._h0,n=this._h1,s=this._h2,o=this._h3,a=this._h4,c,l,u;for(let d=0;d<80;d++)d<20?(c=n&s|~n&o,l=1518500249):d<40?(c=n^s^o,l=1859775393):d<60?(c=n&s|n&o|s&o,l=2400959708):(c=n^s^o,l=3395469782),u=Qg(i,5)+c+a+l+e.getUint32(d*4,!1)&4294967295,a=o,o=s,s=Qg(n,30),n=i,i=u;this._h0=this._h0+i&4294967295,this._h1=this._h1+n&4294967295,this._h2=this._h2+s&4294967295,this._h3=this._h3+o&4294967295,this._h4=this._h4+a&4294967295}};Ep._bigBlock32=new DataView(new ArrayBuffer(320));let ey=Ep;function ID(r){return Br(r)}var Me;(function(r){r[r.Off=0]="Off",r[r.Trace=1]="Trace",r[r.Debug=2]="Debug",r[r.Info=3]="Info",r[r.Warning=4]="Warning",r[r.Error=5]="Error"})(Me||(Me={}));const PD=Me.Info;function TD(r,e,t){switch(e){case Me.Trace:r.trace(t);break;case Me.Debug:r.debug(t);break;case Me.Info:r.info(t);break;case Me.Warning:r.warn(t);break;case Me.Error:r.error(t);break;case Me.Off:break;default:throw new Error(`Invalid log level ${e}`)}}function Fo(r,e=!1){let t="";for(let i=0;i<r.length;i++){let n=r[i];if(n instanceof Error&&(n=Sc(n,e)),typeof n=="object")try{n=JSON.stringify(n)}catch{}t+=(i>0?" ":"")+n}return t}class vC extends Fe{constructor(){super(...arguments),this.level=PD,this._onDidChangeLogLevel=this._register(new R),this.onDidChangeLogLevel=this._onDidChangeLogLevel.event}setLevel(e){this.level!==e&&(this.level=e,this._onDidChangeLogLevel.fire(this.level))}getLevel(){return this.level}checkLogLevel(e){return this.level!==Me.Off&&this.level<=e}}class _C extends vC{constructor(e){super(),this.logAlways=e}checkLogLevel(e){return this.logAlways||super.checkLogLevel(e)}trace(e,...t){this.checkLogLevel(Me.Trace)&&this.log(Me.Trace,Fo([e,...t],!0))}debug(e,...t){this.checkLogLevel(Me.Debug)&&this.log(Me.Debug,Fo([e,...t]))}info(e,...t){this.checkLogLevel(Me.Info)&&this.log(Me.Info,Fo([e,...t]))}warn(e,...t){this.checkLogLevel(Me.Warning)&&this.log(Me.Warning,Fo([e,...t]))}error(e,...t){if(this.checkLogLevel(Me.Error))if(e instanceof Error){const i=Array.prototype.slice.call(arguments);i[0]=e.stack,this.log(Me.Error,Fo(i))}else this.log(Me.Error,Fo([e,...t]))}flush(){}}class AD extends vC{constructor(e){super(),this.loggers=e,e.length&&this.setLevel(e[0].getLevel())}setLevel(e){for(const t of this.loggers)t.setLevel(e);super.setLevel(e)}trace(e,...t){for(const i of this.loggers)i.trace(e,...t)}debug(e,...t){for(const i of this.loggers)i.debug(e,...t)}info(e,...t){for(const i of this.loggers)i.info(e,...t)}warn(e,...t){for(const i of this.loggers)i.warn(e,...t)}error(e,...t){for(const i of this.loggers)i.error(e,...t)}flush(){for(const e of this.loggers)e.flush()}dispose(){for(const e of this.loggers)e.dispose();super.dispose()}}class RD extends Fe{constructor(e,t,i){if(super(),this.logLevel=e,this.logsHome=t,this._loggers=new Pt,this._onDidChangeLoggers=this._register(new R),this.onDidChangeLoggers=this._onDidChangeLoggers.event,this._onDidChangeLogLevel=this._register(new R),this.onDidChangeLogLevel=this._onDidChangeLogLevel.event,this._onDidChangeVisibility=this._register(new R),this.onDidChangeVisibility=this._onDidChangeVisibility.event,i)for(const n of i)this._loggers.set(n.resource,{logger:void 0,info:n})}getLoggerEntry(e){return $e(e)?[...this._loggers.values()].find(t=>t.info.id===e):this._loggers.get(e)}getLogger(e){var t;return(t=this.getLoggerEntry(e))==null?void 0:t.logger}createLogger(e,t){var c;const i=this.toResource(e),n=$e(e)?e:(t==null?void 0:t.id)??Rw(i.toString()).toString(16);let s=(c=this._loggers.get(i))==null?void 0:c.logger;const o=(t==null?void 0:t.logLevel)==="always"?Me.Trace:t==null?void 0:t.logLevel;s||(s=this.doCreateLogger(i,o??this.getLogLevel(i)??this.logLevel,{...t,id:n}));const a={logger:s,info:{resource:i,id:n,logLevel:o,name:t==null?void 0:t.name,hidden:t==null?void 0:t.hidden,extensionId:t==null?void 0:t.extensionId,when:t==null?void 0:t.when}};return this.registerLogger(a.info),this._loggers.set(i,a),s}toResource(e){return $e(e)?wc(this.logsHome,`${e}.log`):e}setLogLevel(e,t){var i,n,s;if(x.isUri(e)){const o=e,a=t,c=this._loggers.get(o);c&&a!==c.info.logLevel&&(c.info.logLevel=a===this.logLevel?void 0:a,(i=c.logger)==null||i.setLevel(a),this._loggers.set(c.info.resource,c),this._onDidChangeLogLevel.fire([o,a]))}else{this.logLevel=e;for(const[o,a]of this._loggers.entries())((n=this._loggers.get(o))==null?void 0:n.info.logLevel)===void 0&&((s=a.logger)==null||s.setLevel(this.logLevel));this._onDidChangeLogLevel.fire(this.logLevel)}}setVisibility(e,t){const i=this.getLoggerEntry(e);i&&t!==!i.info.hidden&&(i.info.hidden=!t,this._loggers.set(i.info.resource,i),this._onDidChangeVisibility.fire([i.info.resource,t]))}getLogLevel(e){var i;let t;return e&&(t=(i=this._loggers.get(e))==null?void 0:i.info.logLevel),t??this.logLevel}registerLogger(e){const t=this._loggers.get(e.resource);t?t.info.hidden!==e.hidden&&this.setVisibility(e.resource,!e.hidden):(this._loggers.set(e.resource,{info:e,logger:void 0}),this._onDidChangeLoggers.fire({added:[e],removed:[]}))}deregisterLogger(e){const t=this._loggers.get(e);t&&(t.logger&&t.logger.dispose(),this._loggers.delete(e),this._onDidChangeLoggers.fire({added:[],removed:[t.info]}))}*getRegisteredLoggers(){for(const e of this._loggers.values())yield e.info}getRegisteredLogger(e){var t;return(t=this._loggers.get(e))==null?void 0:t.info}dispose(){this._loggers.forEach(e=>{var t;return(t=e.logger)==null?void 0:t.dispose()}),this._loggers.clear(),super.dispose()}}function LD(r){switch(r){case Me.Trace:return"trace";case Me.Debug:return"debug";case Me.Info:return"info";case Me.Warning:return"warn";case Me.Error:return"error";case Me.Off:return"off"}}function $D(r){switch(r){case"trace":return Me.Trace;case"debug":return Me.Debug;case"info":return Me.Info;case"warn":return Me.Warning;case"error":return Me.Error;case"critical":return Me.Error;case"off":return Me.Off}}new G("logLevel",LD(Me.Info));const $i="vs/platform/request/common/request";function ND(r){return r.res.statusCode&&r.res.statusCode>=200&&r.res.statusCode<300||r.res.statusCode===1223}function MD(r){return r.res.statusCode===204}async function FD(r){if(!ND(r))throw new Error("Server returned "+r.res.statusCode);if(MD(r))return null;const t=(await v4(r.stream)).toString();try{return JSON.parse(t)}catch(i){throw i.message+=`:
`+t,i}}let Jg;function OD(r){const e=qt.as(ld.Configuration),t=Jg;Jg={id:"http",order:15,title:h($i,1,"HTTP"),type:"object",scope:r,properties:{"http.proxy":{type:"string",pattern:"^(https?|socks|socks4a?|socks5h?)://([^:]*(:[^@]*)?@)?([^:]+|\\[[:0-9a-fA-F]+\\])(:\\d+)?/?$|^$",markdownDescription:h($i,2,"The proxy setting to use. If not set, will be inherited from the `http_proxy` and `https_proxy` environment variables."),restricted:!0},"http.proxyStrictSSL":{type:"boolean",default:!0,description:h($i,3,"Controls whether the proxy server certificate should be verified against the list of supplied CAs."),restricted:!0},"http.proxyKerberosServicePrincipal":{type:"string",markdownDescription:h($i,4,"Overrides the principal service name for Kerberos authentication with the HTTP proxy. A default based on the proxy hostname is used when this is not set."),restricted:!0},"http.proxyAuthorization":{type:["null","string"],default:null,markdownDescription:h($i,5,"The value to send as the `Proxy-Authorization` header for every network request."),restricted:!0},"http.proxySupport":{type:"string",enum:["off","on","fallback","override"],enumDescriptions:[h($i,6,"Disable proxy support for extensions."),h($i,7,"Enable proxy support for extensions."),h($i,8,"Enable proxy support for extensions, fall back to request options, when no proxy found."),h($i,9,"Enable proxy support for extensions, override request options.")],default:"override",description:h($i,10,"Use the proxy support for extensions."),restricted:!0},"http.systemCertificates":{type:"boolean",default:!0,description:h($i,11,"Controls whether CA certificates should be loaded from the OS. (On Windows and macOS, a reload of the window is required after turning this off.)"),restricted:!0},"http.experimental.systemCertificatesV2":{type:"boolean",tags:["experimental"],default:!1,description:h($i,12,"Controls whether experimental loading of CA certificates from the OS should be enabled. This uses a more general approach than the default implemenation."),restricted:!0}}},e.updateConfigurations({add:[Jg],remove:t?[t]:[]})}OD(1);const HD=Ce("requestService"),UD=Ce("storageService"),Li="vs/workbench/contrib/chat/common/chatContextKeys";new G("chatSessionResponseVote","",{type:"string",description:h(Li,0,"When the response has been voted up, is set to 'up'. When voted down, is set to 'down'. Otherwise an empty string.")});new G("chatSessionResponseDetectedAgentOrCommand",!1,{type:"boolean",description:h(Li,1,"When the agent or command was automatically detected")});new G("chatResponseSupportsIssueReporting",!1,{type:"boolean",description:h(Li,2,"True when the current chat response supports issue reporting.")});new G("chatSessionResponseFiltered",!1,{type:"boolean",description:h(Li,3,"True when the chat response was filtered out by the server.")});new G("chatSessionRequestInProgress",!1,{type:"boolean",description:h(Li,4,"True when the current request is still in progress.")});new G("chatResponse",!1,{type:"boolean",description:h(Li,5,"The chat item is a response.")});new G("chatRequest",!1,{type:"boolean",description:h(Li,6,"The chat item is a request")});new G("chatEditApplied",!1,{type:"boolean",description:h(Li,7,"True when the chat text edits have been applied.")});new G("chatInputHasText",!1,{type:"boolean",description:h(Li,8,"True when the chat input has text.")});new G("chatInputHasFocus",!1,{type:"boolean",description:h(Li,9,"True when the chat input has focus.")});new G("inChatInput",!1,{type:"boolean",description:h(Li,10,"True when focus is in the chat input, false otherwise.")});new G("inChat",!1,{type:"boolean",description:h(Li,11,"True when focus is in the chat widget, false otherwise.")});const BD=new G("chatIsEnabled",!1,{type:"boolean",description:h(Li,12,"True when chat is enabled because a default chat participant is registered.")});new G("chatCursorAtTop",!1);new G("chatInputHasAgent",!1);new G("chatLocation",void 0);var qc,Lr;(function(r){r.Panel="panel",r.Terminal="terminal",r.Notebook="notebook",r.Editor="editor"})(Lr||(Lr={}));(function(r){function e(t){switch(t){case"panel":return r.Panel;case"terminal":return r.Terminal;case"notebook":return r.Notebook;case"editor":return r.Editor}return r.Panel}r.fromRaw=e})(Lr||(Lr={}));var $u;let ty=($u=class{constructor(e){this.contextKeyService=e,this._agents=[],this._onDidChangeAgents=new R,this.onDidChangeAgents=this._onDidChangeAgents.event,this._hasDefaultAgent=BD.bindTo(this.contextKeyService)}registerAgent(e,t){if(this.getAgent(e))throw new Error(`Agent already registered: ${JSON.stringify(e)}`);const n=this,s=t.slashCommands;t={...t,get slashCommands(){return s.filter(a=>!a.when||n.contextKeyService.contextMatchesRules(Dt.deserialize(a.when)))}};const o={data:t};return this._agents.push(o),De(()=>{this._agents=this._agents.filter(a=>a!==o),this._onDidChangeAgents.fire(void 0)})}registerAgentImplementation(e,t){const i=this._getAgentEntry(e);if(!i)throw new Error(`Unknown agent: ${JSON.stringify(e)}`);if(i.impl)throw new Error(`Agent already has implementation: ${JSON.stringify(e)}`);return i.data.isDefault&&this._hasDefaultAgent.set(!0),i.impl=t,this._onDidChangeAgents.fire(new Ad(i.data,t)),De(()=>{i.impl=void 0,this._onDidChangeAgents.fire(void 0),i.data.isDefault&&this._hasDefaultAgent.set(!1)})}registerDynamicAgent(e,t){const i={data:e,impl:t};return this._agents.push(i),this._onDidChangeAgents.fire(new Ad(e,t)),De(()=>{this._agents=this._agents.filter(n=>n!==i),this._onDidChangeAgents.fire(void 0)})}updateAgent(e,t){const i=this._getAgentEntry(e);if(!(i!=null&&i.impl))throw new Error(`No activated agent with id ${JSON.stringify(e)} registered`);i.data.metadata={...i.data.metadata,...t},this._onDidChangeAgents.fire(new Ad(i.data,i.impl))}getDefaultAgent(e){return this.getActivatedAgents().find(t=>!!t.isDefault&&t.locations.includes(e))}getContributedDefaultAgent(e){return this.getAgents().find(t=>!!t.isDefault&&t.locations.includes(e))}getSecondaryAgent(){var e;return(e=nr.find(this._agents.values(),t=>!!t.data.metadata.isSecondary))==null?void 0:e.data}_getAgentEntry(e){return this._agents.find(t=>t.data.id===e)}getAgent(e){var t;return(t=this._getAgentEntry(e))==null?void 0:t.data}getAgents(){return this._agents.map(e=>e.data)}getActivatedAgents(){return Array.from(this._agents.values()).filter(e=>!!e.impl).map(e=>new Ad(e.data,e.impl))}getAgentsByName(e){return this.getAgents().filter(t=>t.name===e)}async invokeAgent(e,t,i,n,s){const o=this._getAgentEntry(e);if(!(o!=null&&o.impl))throw new Error(`No activated agent with id ${e}`);return await o.impl.invoke(t,i,n,s)}async getFollowups(e,t,i,n,s){var a;const o=this._getAgentEntry(e);if(!(o!=null&&o.impl))throw new Error(`No activated agent with id ${e}`);return(a=o.impl)!=null&&a.provideFollowups?o.impl.provideFollowups(t,i,n,s):[]}},$u.AGENT_LEADER="@",$u);ty=U([M(0,fD)],ty);class Ad{constructor(e,t){this.data=e,this.impl=t}get id(){return this.data.id}get name(){return this.data.name??""}get description(){return this.data.description??""}get extensionId(){return this.data.extensionId}get extensionPublisherId(){return this.data.extensionPublisherId}get extensionPublisherDisplayName(){return this.data.extensionPublisherDisplayName}get extensionDisplayName(){return this.data.extensionDisplayName}get isDefault(){return this.data.isDefault}get metadata(){return this.data.metadata}get slashCommands(){return this.data.slashCommands}get defaultImplicitVariables(){return this.data.defaultImplicitVariables}get locations(){return this.data.locations}async invoke(e,t,i,n){return this.impl.invoke(e,t,i,n)}async provideFollowups(e,t,i,n){return this.impl.provideFollowups?this.impl.provideFollowups(e,t,i,n):[]}provideWelcomeMessage(e,t){if(this.impl.provideWelcomeMessage)return this.impl.provideWelcomeMessage(e,t)}provideSampleQuestions(e,t){if(this.impl.provideSampleQuestions)return this.impl.provideSampleQuestions(e,t)}}var hc;let iy=(hc=class{constructor(e,t,i,n){if(this.requestService=t,this.logService=i,this.storageService=n,this.registry=Y5(this,Object.create(null)),this.disposed=!1,!e.chatParticipantRegistry)return;this.url=e.chatParticipantRegistry;const s=n.get(qc.StorageKey,-1);try{this.registry.set(JSON.parse(s??"{}"),void 0)}catch{n.remove(qc.StorageKey,-1)}this.refresh()}refresh(){this.disposed||this.update().catch(e=>this.logService.warn("Failed to fetch chat participant registry",e)).then(()=>Yn(5*60*1e3)).then(()=>this.refresh())}async update(){const e=await this.requestService.request({type:"GET",url:this.url},bt.None);if(e.res.statusCode!==200)throw new Error("Could not get extensions report.");const t=await FD(e);if(!t||t.version!==1)throw new Error("Unexpected chat participant registry response.");const i=t.restrictedChatParticipants;this.registry.set(i,void 0),this.storageService.store(qc.StorageKey,JSON.stringify(i),-1,1)}getAgentNameRestriction(e){return this.registry.map(i=>i[e.name.toLowerCase()]).map(i=>i?i.some(n=>Rr(n,n.includes(".")?e.extensionId.value:e.extensionPublisherId)):!0)}dispose(){this.disposed=!0}},qc=hc,hc.StorageKey="chat.participantNameRegistry",hc);iy=qc=U([M(0,pD),M(1,HD),M(2,Je),M(3,UD)],iy);const Gc="**",Ym="/",Kd="[/\\\\]",Xd="[^/\\\\]",VD=/\//g;function ny(r,e){switch(r){case 0:return"";case 1:return`${Xd}*?`;default:return`(?:${Kd}|${Xd}+${Kd}${e?`|${Kd}${Xd}+`:""})*?`}}function e1(r,e){if(!r)return[];const t=[];let i=!1,n=!1,s="";for(const o of r){switch(o){case e:if(!i&&!n){t.push(s),s="";continue}break;case"{":i=!0;break;case"}":i=!1;break;case"[":n=!0;break;case"]":n=!1;break}s+=o}return s&&t.push(s),t}function wC(r){if(!r)return"";let e="";const t=e1(r,Ym);if(t.every(i=>i===Gc))e=".*";else{let i=!1;t.forEach((n,s)=>{if(n===Gc){if(i)return;e+=ny(2,s===t.length-1)}else{let o=!1,a="",c=!1,l="";for(const u of n){if(u!=="}"&&o){a+=u;continue}if(c&&(u!=="]"||!l)){let d;u==="-"?d=u:(u==="^"||u==="!")&&!l?d="^":u===Ym?d="":d=Fa(u),l+=d;continue}switch(u){case"{":o=!0;continue;case"[":c=!0;continue;case"}":{const f=`(?:${e1(a,",").map(m=>wC(m)).join("|")})`;e+=f,o=!1,a="";break}case"]":{e+="["+l+"]",c=!1,l="";break}case"?":e+=Xd;continue;case"*":e+=ny(1);continue;default:e+=Fa(u)}}s<t.length-1&&(t[s+1]!==Gc||s+2<t.length)&&(e+=Kd)}i=n===Gc})}return e}const WD=/^\*\*\/\*\.[\w\.-]+$/,zD=/^\*\*\/([\w\.-]+)\/?$/,jD=/^{\*\*\/\*?[\w\.-]+\/?(,\*\*\/\*?[\w\.-]+\/?)*}$/,qD=/^{\*\*\/\*?[\w\.-]+(\/(\*\*)?)?(,\*\*\/\*?[\w\.-]+(\/(\*\*)?)?)*}$/,GD=/^\*\*((\/[\w\.-]+)+)\/?$/,QD=/^([\w\.-]+(\/[\w\.-]+)*)\/?$/,ry=new gw(1e4),sy=function(){return!1},xn=function(){return null};function $w(r,e){if(!r)return xn;let t;typeof r!="string"?t=r.pattern:t=r,t=t.trim();const i=`${t}_${!!e.trimForExclusions}`;let n=ry.get(i);if(n)return oy(n,r);let s;return WD.test(t)?n=JD(t.substr(4),t):(s=zD.exec(Kg(t,e)))?n=KD(s[1],t):(e.trimForExclusions?qD:jD).test(t)?n=XD(t,e):(s=GD.exec(Kg(t,e)))?n=ay(s[1].substr(1),t,!0):(s=QD.exec(Kg(t,e)))?n=ay(s[1],t,!1):n=ZD(t),ry.set(i,n),oy(n,r)}function oy(r,e){if(typeof e=="string")return r;const t=function(i,n){return _h(i,e.base,!Qr)?r(lE(i.substr(e.base.length),en),n):null};return t.allBasenames=r.allBasenames,t.allPaths=r.allPaths,t.basenames=r.basenames,t.patterns=r.patterns,t}function Kg(r,e){return e.trimForExclusions&&r.endsWith("/**")?r.substr(0,r.length-2):r}function JD(r,e){return function(t,i){return typeof t=="string"&&t.endsWith(r)?e:null}}function KD(r,e){const t=`/${r}`,i=`\\${r}`,n=function(o,a){return typeof o!="string"?null:a?a===r?e:null:o===r||o.endsWith(t)||o.endsWith(i)?e:null},s=[r];return n.basenames=s,n.patterns=[e],n.allBasenames=s,n}function XD(r,e){const t=bC(r.slice(1,-1).split(",").map(a=>$w(a,e)).filter(a=>a!==xn),r),i=t.length;if(!i)return xn;if(i===1)return t[0];const n=function(a,c){for(let l=0,u=t.length;l<u;l++)if(t[l](a,c))return r;return null},s=t.find(a=>!!a.allBasenames);s&&(n.allBasenames=s.allBasenames);const o=t.reduce((a,c)=>c.allPaths?a.concat(c.allPaths):a,[]);return o.length&&(n.allPaths=o),n}function ay(r,e,t){const i=en===Be.sep,n=i?r:r.replace(VD,en),s=en+n,o=Be.sep+r;let a;return t?a=function(c,l){return typeof c=="string"&&(c===n||c.endsWith(s)||!i&&(c===r||c.endsWith(o)))?e:null}:a=function(c,l){return typeof c=="string"&&(c===n||!i&&c===r)?e:null},a.allPaths=[(t?"*/":"./")+r],a}function ZD(r){try{const e=new RegExp(`^${wC(r)}$`);return function(t){return e.lastIndex=0,typeof t=="string"&&e.test(t)?r:null}}catch{return xn}}function ll(r,e,t){return!r||typeof e!="string"?!1:Va(r)(e,void 0,t)}function Va(r,e={}){if(!r)return sy;if(typeof r=="string"||YD(r)){const t=$w(r,e);if(t===xn)return sy;const i=function(n,s){return!!t(n,s)};return t.allBasenames&&(i.allBasenames=t.allBasenames),t.allPaths&&(i.allPaths=t.allPaths),i}return eI(r,e)}function YD(r){const e=r;return e?typeof e.base=="string"&&typeof e.pattern=="string":!1}function eI(r,e){const t=bC(Object.getOwnPropertyNames(r).map(a=>tI(a,r[a],e)).filter(a=>a!==xn)),i=t.length;if(!i)return xn;if(!t.some(a=>!!a.requiresSiblings)){if(i===1)return t[0];const a=function(u,d){let f;for(let m=0,b=t.length;m<b;m++){const _=t[m](u,d);if(typeof _=="string")return _;Jr(_)&&(f||(f=[]),f.push(_))}return f?(async()=>{for(const m of f){const b=await m;if(typeof b=="string")return b}return null})():null},c=t.find(u=>!!u.allBasenames);c&&(a.allBasenames=c.allBasenames);const l=t.reduce((u,d)=>d.allPaths?u.concat(d.allPaths):u,[]);return l.length&&(a.allPaths=l),a}const n=function(a,c,l){let u,d;for(let f=0,m=t.length;f<m;f++){const b=t[f];b.requiresSiblings&&l&&(c||(c=gi(a)),u||(u=c.substr(0,c.length-Tm(a).length)));const _=b(a,c,u,l);if(typeof _=="string")return _;Jr(_)&&(d||(d=[]),d.push(_))}return d?(async()=>{for(const f of d){const m=await f;if(typeof m=="string")return m}return null})():null},s=t.find(a=>!!a.allBasenames);s&&(n.allBasenames=s.allBasenames);const o=t.reduce((a,c)=>c.allPaths?a.concat(c.allPaths):a,[]);return o.length&&(n.allPaths=o),n}function tI(r,e,t){if(e===!1)return xn;const i=$w(r,t);if(i===xn)return xn;if(typeof e=="boolean")return i;if(e){const n=e.when;if(typeof n=="string"){const s=(o,a,c,l)=>{if(!l||!i(o,a))return null;const u=n.replace("$(basename)",()=>c),d=l(u);return Jr(d)?d.then(f=>f?r:null):d?r:null};return s.requiresSiblings=!0,s}}return i}function bC(r,e){const t=r.filter(a=>!!a.basenames);if(t.length<2)return r;const i=t.reduce((a,c)=>{const l=c.basenames;return l?a.concat(l):a},[]);let n;if(e){n=[];for(let a=0,c=i.length;a<c;a++)n.push(e)}else n=t.reduce((a,c)=>{const l=c.patterns;return l?a.concat(l):a},[]);const s=function(a,c){if(typeof a!="string")return null;if(!c){let u;for(u=a.length;u>0;u--){const d=a.charCodeAt(u-1);if(d===47||d===92)break}c=a.substr(u)}const l=i.indexOf(c);return l!==-1?n[l]:null};s.basenames=i,s.patterns=n,s.allBasenames=i;const o=r.filter(a=>!a.basenames);return o.push(s),o}const t1=["W","X","Y","Z","a","b","c","d","e","f"],iI=new RegExp(`^[${t1.join("")}]+`),yC=7;function nI(r){if(r.scheme!==ne.vscodeNotebookCell)return;const e=r.fragment.indexOf("s");if(e<0)return;const t=parseInt(r.fragment.substring(0,e).replace(iI,""),yC),i=_4(r.fragment.substring(e+1)).toString();if(!isNaN(t))return{handle:t,notebook:r.with({scheme:i,fragment:null})}}function rI(r,e){const t=e.toString(yC),n=`${t.length<t1.length?t1[t.length-1]:"z"}${t}s${px(_e.fromString(r.scheme),!0,!0)}`;return r.with({scheme:ne.vscodeNotebookCell,fragment:n})}var qo;(function(r){r[r.Markup=1]="Markup",r[r.Code=2]="Code"})(qo||(qo={}));er.latex,er.markdown,er.text;er.latex,er.markdown,er.text;var ul;(function(r){r[r.Unconfirmed=1]="Unconfirmed",r[r.Pending=2]="Pending",r[r.Executing=3]="Executing"})(ul||(ul={}));var cy;(function(r){r[r.Unconfirmed=1]="Unconfirmed",r[r.Pending=2]="Pending",r[r.Executing=3]="Executing"})(cy||(cy={}));var zi;(function(r){r[r.ModelChange=1]="ModelChange",r[r.Move=2]="Move",r[r.ChangeCellLanguage=5]="ChangeCellLanguage",r[r.Initialize=6]="Initialize",r[r.ChangeCellMetadata=7]="ChangeCellMetadata",r[r.Output=8]="Output",r[r.OutputItem=9]="OutputItem",r[r.ChangeCellContent=10]="ChangeCellContent",r[r.ChangeDocumentMetadata=11]="ChangeDocumentMetadata",r[r.ChangeCellInternalMetadata=12]="ChangeCellInternalMetadata",r[r.ChangeCellMime=13]="ChangeCellMime",r[r.Unknown=100]="Unknown"})(zi||(zi={}));var ly;(function(r){r[r.Handle=0]="Handle",r[r.Index=1]="Index"})(ly||(ly={}));var uy;(function(r){r.scheme=ne.vscodeNotebookCell;function e(a,c){return rI(a,c)}r.generate=e;function t(a){return nI(a)}r.parse=t;function i(a,c){return a.with({scheme:ne.vscodeNotebookCellOutput,fragment:`op${c??""},${a.scheme!==ne.file?a.scheme:""}`})}r.generateCellOutputUri=i;function n(a){if(a.scheme!==ne.vscodeNotebookCellOutput)return;const c=/^op([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})?\,(.*)$/i.exec(a.fragment);if(!c)return;const l=c[1]&&c[1]!==""?c[1]:void 0,u=c[2];return{outputId:l,notebook:a.with({scheme:u||ne.file,fragment:null})}}r.parseCellOutputUri=n;function s(a,c,l){return r.generate(a,c).with({scheme:l})}r.generateCellPropertyUri=s;function o(a,c){if(a.scheme===c)return r.parse(a.with({scheme:r.scheme}))}r.parseCellPropertyUri=o})(uy||(uy={}));new G("notebookEditorCursorAtBoundary","none");new G("notebookEditorCursorAtLineBoundary","none");var dy;(function(r){r.default="default",r.option="option"})(dy||(dy={}));function xC(r){return["application/vnd.code.notebook.stdout","application/vnd.code.notebook.stderr"].includes(r)}const sI=new TextDecoder;function oI(r){const e=[];let t=!1;for(const o of r)(e.length===0||t)&&(e.push(o),t=!0);let i=cI(e);const n=_e.concat(e.map(o=>_e.wrap(o))),s=fI(n);return i=i||s.byteLength!==n.byteLength,{data:s,didCompression:i}}const Zd="\x1B[A",Xg=Zd.split("").map(r=>r.charCodeAt(0)),aI=10;function cI(r){let e=!1;return r.forEach((t,i)=>{if(i===0||t.length<Zd.length)return;const n=r[i-1],s=t.subarray(0,Zd.length);if(s[0]===Xg[0]&&s[1]===Xg[1]&&s[2]===Xg[2]){const o=n.lastIndexOf(aI);if(o===-1)return;e=!0,r[i-1]=n.subarray(0,o),r[i]=t.subarray(Zd.length)}}),e}function lI(r){let e=r;do r=e,e=r.replace(/[^\n]\x08/gm,"");while(e.length<r.length);return r}function uI(r){for(r=r.replace(/\r+\n/gm,`
`);r.search(/\r[^$]/g)>-1;){const e=r.match(/^(.*)\r+/m)[1];let t=r.match(/\r+(.*)$/m)[1];t=t+e.slice(t.length,e.length),r=r.replace(/\r+.*$/m,"\r").replace(/^.*\r/m,t)}return r}const dI=8,hI=13;function fI(r){return!r.buffer.includes(dI)&&!r.buffer.includes(hI)?r:_e.fromString(uI(lI(sI.decode(r.buffer))))}var hy;(function(r){r[r.UP=0]="UP",r[r.DOWN=1]="DOWN",r[r.LEFT=2]="LEFT",r[r.RIGHT=3]="RIGHT"})(hy||(hy={}));var fy;(function(r){r[r.HORIZONTAL=0]="HORIZONTAL",r[r.VERTICAL=1]="VERTICAL"})(fy||(fy={}));var py;(function(r){r[r.FIRST=0]="FIRST",r[r.LAST=1]="LAST",r[r.NEXT=2]="NEXT",r[r.PREVIOUS=3]="PREVIOUS"})(py||(py={}));var gy;(function(r){r[r.MAXIMIZE=0]="MAXIMIZE",r[r.EXPAND=1]="EXPAND",r[r.EVEN=2]="EVEN"})(gy||(gy={}));var my;(function(r){r[r.COPY_EDITORS=0]="COPY_EDITORS",r[r.MOVE_EDITORS=1]="MOVE_EDITORS"})(my||(my={}));var vy;(function(r){r[r.CREATION_TIME=0]="CREATION_TIME",r[r.MOST_RECENTLY_ACTIVE=1]="MOST_RECENTLY_ACTIVE",r[r.GRID_APPEARANCE=2]="GRID_APPEARANCE"})(vy||(vy={}));const pI=-1,gI=-2;function Nw(r){if(!r)return;const e=r.indexOf("+");return e<0?r:r.substr(0,e)}const mI=["Azure","Data Science","Debuggers","Extension Packs","Education","Formatters","Keymaps","Language Packs","Linters","Machine Learning","Notebooks","Programming Languages","SCM Providers","Snippets","Testing","Themes","Visualization","AI","Chat","Other"];class Xe{constructor(e){this.value=e,this._lower=e.toLowerCase()}static equals(e,t){if(typeof e>"u"||e===null)return typeof t>"u"||t===null;if(typeof t>"u"||t===null)return!1;if(typeof e=="string"||typeof t=="string"){const i=typeof e=="string"?e:e.value,n=typeof t=="string"?t:t.value;return Rr(i,n)}return e._lower===t._lower}static toKey(e){return typeof e=="string"?e.toLowerCase():e._lower}}class ko{get size(){return this._set.size}constructor(e){if(this._set=new Set,e)for(const t of e)this.add(t)}add(e){this._set.add(Xe.toKey(e))}delete(e){return this._set.delete(Xe.toKey(e))}has(e){return this._set.has(Xe.toKey(e))}}class Kr{constructor(){this._map=new Map}clear(){this._map.clear()}delete(e){this._map.delete(Xe.toKey(e))}get(e){return this._map.get(Xe.toKey(e))}has(e){return this._map.has(Xe.toKey(e))}set(e,t){this._map.set(Xe.toKey(e),t)}values(){return this._map.values()}forEach(e){this._map.forEach(e)}[Symbol.iterator](){return this._map[Symbol.iterator]()}}class vI{constructor(e){this.id=e,this.type=1}toString(){return`Managed(${this.id})`}}class _I{constructor(e,t){this.host=e,this.port=t,this.type=0}toString(){return`WebSocket(${this.host}:${this.port})`}}var Jn;(function(r){r.Unknown="Unknown",r.NotAvailable="NotAvailable",r.TemporarilyNotAvailable="TemporarilyNotAvailable",r.NoResolverFound="NoResolverFound",r.InvalidAuthority="InvalidAuthority"})(Jn||(Jn={}));function _y(r){const e=r.indexOf("+");return e===-1?r:r.substring(0,e)}var i1,hs,Rn,n1,fs,_r,ps,r1,s1,Yd,Qc,o1,an,cn,a1,ni,c1;function ae(r){return Object.assign(r,{apply:function(...t){if(t.length===0)return Reflect.construct(r,[]);{const i=t.length===1?[]:t[1];return Reflect.construct(r,i,t[0].constructor)}},call:function(...t){if(t.length===0)return Reflect.construct(r,[]);{const[i,...n]=t;return Reflect.construct(r,n,i.constructor)}}})}var l1;(function(r){r[r.Top=0]="Top",r[r.Bottom=1]="Bottom"})(l1||(l1={}));var Ms,rx;let Ne=i1=(rx=class{constructor(e){ue(this,Ms,void 0);K(this,Ms,e)}static from(...e){let t=e;return new i1(function(){if(t){for(const i of t)i&&typeof i.dispose=="function"&&i.dispose();t=void 0}})}dispose(){typeof P(this,Ms)=="function"&&(P(this,Ms).call(this),K(this,Ms,void 0))}},Ms=new WeakMap,rx);Ne=i1=U([ae],Ne);let ke=hs=class{static Min(...e){if(e.length===0)throw new TypeError;let t=e[0];for(let i=1;i<e.length;i++){const n=e[i];n.isBefore(t)&&(t=n)}return t}static Max(...e){if(e.length===0)throw new TypeError;let t=e[0];for(let i=1;i<e.length;i++){const n=e[i];n.isAfter(t)&&(t=n)}return t}static isPosition(e){if(!e)return!1;if(e instanceof hs)return!0;const{line:t,character:i}=e;return typeof t=="number"&&typeof i=="number"}static of(e){if(e instanceof hs)return e;if(this.isPosition(e))return new hs(e.line,e.character);throw new Error("Invalid argument, is NOT a position-like object")}get line(){return this._line}get character(){return this._character}constructor(e,t){if(e<0)throw Se("line must be non-negative");if(t<0)throw Se("character must be non-negative");this._line=e,this._character=t}isBefore(e){return this._line<e._line?!0:e._line<this._line?!1:this._character<e._character}isBeforeOrEqual(e){return this._line<e._line?!0:e._line<this._line?!1:this._character<=e._character}isAfter(e){return!this.isBeforeOrEqual(e)}isAfterOrEqual(e){return!this.isBefore(e)}isEqual(e){return this._line===e._line&&this._character===e._character}compareTo(e){return this._line<e._line?-1:this._line>e.line?1:this._character<e._character?-1:this._character>e._character?1:0}translate(e,t=0){if(e===null||t===null)throw Se();let i;return typeof e>"u"?i=0:typeof e=="number"?i=e:(i=typeof e.lineDelta=="number"?e.lineDelta:0,t=typeof e.characterDelta=="number"?e.characterDelta:0),i===0&&t===0?this:new hs(this.line+i,this.character+t)}with(e,t=this.character){if(e===null||t===null)throw Se();let i;return typeof e>"u"?i=this.line:typeof e=="number"?i=e:(i=typeof e.line=="number"?e.line:this.line,t=typeof e.character=="number"?e.character:this.character),i===this.line&&t===this.character?this:new hs(i,t)}toJSON(){return{line:this.line,character:this.character}}};ke=hs=U([ae],ke);let xe=Rn=class{static isRange(e){return e instanceof Rn?!0:e?ke.isPosition(e.start)&&ke.isPosition(e.end):!1}static of(e){if(e instanceof Rn)return e;if(this.isRange(e))return new Rn(e.start,e.end);throw new Error("Invalid argument, is NOT a range-like object")}get start(){return this._start}get end(){return this._end}constructor(e,t,i,n){let s,o;if(typeof e=="number"&&typeof t=="number"&&typeof i=="number"&&typeof n=="number"?(s=new ke(e,t),o=new ke(i,n)):ke.isPosition(e)&&ke.isPosition(t)&&(s=ke.of(e),o=ke.of(t)),!s||!o)throw new Error("Invalid arguments");s.isBefore(o)?(this._start=s,this._end=o):(this._start=o,this._end=s)}contains(e){return Rn.isRange(e)?this.contains(e.start)&&this.contains(e.end):ke.isPosition(e)?!(ke.of(e).isBefore(this._start)||this._end.isBefore(e)):!1}isEqual(e){return this._start.isEqual(e._start)&&this._end.isEqual(e._end)}intersection(e){const t=ke.Max(e.start,this._start),i=ke.Min(e.end,this._end);if(!t.isAfter(i))return new Rn(t,i)}union(e){if(this.contains(e))return this;if(e.contains(this))return e;const t=ke.Min(e.start,this._start),i=ke.Max(e.end,this.end);return new Rn(t,i)}get isEmpty(){return this._start.isEqual(this._end)}get isSingleLine(){return this._start.line===this._end.line}with(e,t=this.end){if(e===null||t===null)throw Se();let i;return e?ke.isPosition(e)?i=e:(i=e.start||this.start,t=e.end||this.end):i=this.start,i.isEqual(this._start)&&t.isEqual(this.end)?this:new Rn(i,t)}toJSON(){return[this.start,this.end]}};xe=Rn=U([ae],xe);let sr=n1=class extends xe{static isSelection(e){return e instanceof n1?!0:e?xe.isRange(e)&&ke.isPosition(e.anchor)&&ke.isPosition(e.active)&&typeof e.isReversed=="boolean":!1}get anchor(){return this._anchor}get active(){return this._active}constructor(e,t,i,n){let s,o;if(typeof e=="number"&&typeof t=="number"&&typeof i=="number"&&typeof n=="number"?(s=new ke(e,t),o=new ke(i,n)):ke.isPosition(e)&&ke.isPosition(t)&&(s=ke.of(e),o=ke.of(t)),!s||!o)throw new Error("Invalid arguments");super(s,o),this._anchor=s,this._active=o}get isReversed(){return this._anchor===this._end}toJSON(){return{start:this.start,end:this.end,active:this.active,anchor:this.anchor}}};sr=n1=U([ae],sr);const CC=r=>{if(typeof r!="string"||r.length===0||!/^[0-9A-Za-z_\-]+$/.test(r))throw Se("connectionToken")};class wI{static isResolvedAuthority(e){return e&&typeof e=="object"&&typeof e.host=="string"&&typeof e.port=="number"&&(e.connectionToken===void 0||typeof e.connectionToken=="string")}constructor(e,t,i){if(typeof e!="string"||e.length===0)throw Se("host");if(typeof t!="number"||t===0||Math.round(t)!==t)throw Se("port");typeof i<"u"&&CC(i),this.host=e,this.port=Math.round(t),this.connectionToken=i}}class eh{static isManagedResolvedAuthority(e){return e&&typeof e=="object"&&typeof e.makeConnection=="function"&&(e.connectionToken===void 0||typeof e.connectionToken=="string")}constructor(e,t){this.makeConnection=e,this.connectionToken=t,typeof t<"u"&&CC(t)}}class _n extends Error{static NotAvailable(e,t){return new _n(e,Jn.NotAvailable,t)}static TemporarilyNotAvailable(e){return new _n(e,Jn.TemporarilyNotAvailable)}constructor(e,t=Jn.Unknown,i){super(e),this._message=e,this._code=t,this._detail=i,Object.setPrototypeOf(this,_n.prototype)}}var Zi;(function(r){r[r.LF=1]="LF",r[r.CRLF=2]="CRLF"})(Zi||(Zi={}));var oa;(function(r){r[r.Replace=1]="Replace",r[r.Append=2]="Append",r[r.Prepend=3]="Prepend"})(oa||(oa={}));let Xr=fs=class{static isTextEdit(e){return e instanceof fs?!0:e?xe.isRange(e)&&typeof e.newText=="string":!1}static replace(e,t){return new fs(e,t)}static insert(e,t){return fs.replace(new xe(e,e),t)}static delete(e){return fs.replace(e,"")}static setEndOfLine(e){const t=new fs(new xe(new ke(0,0),new ke(0,0)),"");return t.newEol=e,t}get range(){return this._range}set range(e){if(e&&!xe.isRange(e))throw Se("range");this._range=e}get newText(){return this._newText||""}set newText(e){if(e&&typeof e!="string")throw Se("newText");this._newText=e}get newEol(){return this._newEol}set newEol(e){if(e&&typeof e!="number")throw Se("newEol");this._newEol=e}constructor(e,t){this._range=e,this._newText=t}toJSON(){return{range:this.range,newText:this.newText,newEol:this._newEol}}};Xr=fs=U([ae],Xr);let Fh=_r=class{static isNotebookCellEdit(e){return e instanceof _r?!0:e?Kn.isNotebookRange(e)&&Array.isArray(e.newCells):!1}static replaceCells(e,t){return new _r(e,t)}static insertCells(e,t){return new _r(new Kn(e,e),t)}static deleteCells(e){return new _r(e,[])}static updateCellMetadata(e,t){const i=new _r(new Kn(e,e),[]);return i.newCellMetadata=t,i}static updateNotebookMetadata(e){const t=new _r(new Kn(0,0),[]);return t.newNotebookMetadata=e,t}constructor(e,t){this.range=e,this.newCells=t}};Fh=_r=U([ae],Fh);class to{static isSnippetTextEdit(e){return e instanceof to?!0:e?xe.isRange(e.range)&&go.isSnippetString(e.snippet):!1}static replace(e,t){return new to(e,t)}static insert(e,t){return to.replace(new xe(e,e),t)}constructor(e,t){this.range=e,this.snippet=t}}let Zr=class{constructor(){this._edits=[]}_allEntries(){return this._edits}renameFile(e,t,i,n){this._edits.push({_type:1,from:e,to:t,options:i,metadata:n})}createFile(e,t,i){this._edits.push({_type:1,from:void 0,to:e,options:t,metadata:i})}deleteFile(e,t,i){this._edits.push({_type:1,from:e,to:void 0,options:t,metadata:i})}replaceNotebookMetadata(e,t,i){this._edits.push({_type:3,metadata:i,uri:e,edit:{editType:5,metadata:t},notebookMetadata:t})}replaceNotebookCells(e,t,i,n){const s=t.start,o=t.end;(s!==o||i.length>0)&&this._edits.push({_type:5,uri:e,index:s,count:o-s,cells:i,metadata:n})}replaceNotebookCellMetadata(e,t,i,n){this._edits.push({_type:3,metadata:n,uri:e,edit:{editType:3,index:t,metadata:i}})}replace(e,t,i,n){this._edits.push({_type:2,uri:e,edit:new Xr(t,i),metadata:n})}insert(e,t,i,n){this.replace(e,new xe(t,t),i,n)}delete(e,t,i){this.replace(e,t,"",i)}has(e){return this._edits.some(t=>t._type===2&&t.uri.toString()===e.toString())}set(e,t){if(t)for(const i of t){if(!i)continue;let n,s;Array.isArray(i)?(n=i[0],s=i[1]):n=i,Fh.isNotebookCellEdit(n)?n.newCellMetadata?this.replaceNotebookCellMetadata(e,n.range.start,n.newCellMetadata,s):n.newNotebookMetadata?this.replaceNotebookMetadata(e,n.newNotebookMetadata,s):this.replaceNotebookCells(e,n.range,n.newCells,s):to.isSnippetTextEdit(n)?this._edits.push({_type:6,uri:e,range:n.range,edit:n.snippet,metadata:s}):this._edits.push({_type:2,uri:e,edit:n,metadata:s})}else{for(let i=0;i<this._edits.length;i++){const n=this._edits[i];switch(n._type){case 2:case 6:case 3:case 5:n.uri.toString()===e.toString()&&(this._edits[i]=void 0);break}}XS(this._edits)}}get(e){const t=[];for(const i of this._edits)i._type===2&&i.uri.toString()===e.toString()&&t.push(i.edit);return t}entries(){const e=new Pt;for(const t of this._edits)if(t._type===2){let i=e.get(t.uri);i||(i=[t.uri,[]],e.set(t.uri,i)),i[1].push(t.edit)}return[...e.values()]}get size(){return this.entries().length}toJSON(){return this.entries()}};Zr=U([ae],Zr);let go=ps=class{static isSnippetString(e){return e instanceof ps?!0:e?typeof e.value=="string":!1}static _escape(e){return e.replace(/\$|}|\\/g,"\\$&")}constructor(e){this._tabstop=1,this.value=e||""}appendText(e){return this.value+=ps._escape(e),this}appendTabstop(e=this._tabstop++){return this.value+="$",this.value+=e,this}appendPlaceholder(e,t=this._tabstop++){if(typeof e=="function"){const i=new ps;i._tabstop=this._tabstop,e(i),this._tabstop=i._tabstop,e=i.value}else e=ps._escape(e);return this.value+="${",this.value+=t,this.value+=":",this.value+=e,this.value+="}",this}appendChoice(e,t=this._tabstop++){const i=e.map(n=>n.replaceAll(/[|\\,]/g,"\\$&")).join(",");return this.value+="${",this.value+=t,this.value+="|",this.value+=i,this.value+="|}",this}appendVariable(e,t){if(typeof t=="function"){const i=new ps;i._tabstop=this._tabstop,t(i),this._tabstop=i._tabstop,t=i.value}else typeof t=="string"&&(t=t.replace(/\$|}/g,"\\$&"));return this.value+="${",this.value+=e,t&&(this.value+=":",this.value+=t),this.value+="}",this}};go=ps=U([ae],go);var Ds;(function(r){r[r.Unnecessary=1]="Unnecessary",r[r.Deprecated=2]="Deprecated"})(Ds||(Ds={}));var Ft;(function(r){r[r.Hint=3]="Hint",r[r.Information=2]="Information",r[r.Warning=1]="Warning",r[r.Error=0]="Error"})(Ft||(Ft={}));let Pi=r1=class{static isLocation(e){return e instanceof r1?!0:e?xe.isRange(e.range)&&x.isUri(e.uri):!1}constructor(e,t){if(this.uri=e,t)if(xe.isRange(t))this.range=xe.of(t);else if(ke.isPosition(t))this.range=new xe(t,t);else throw new Error("Illegal argument")}toJSON(){return{uri:this.uri,range:this.range}}};Pi=r1=U([ae],Pi);let Ul=class{static is(e){return e?typeof e.message=="string"&&e.location&&xe.isRange(e.location.range)&&x.isUri(e.location.uri):!1}constructor(e,t){this.location=e,this.message=t}static isEqual(e,t){return e===t?!0:!e||!t?!1:e.message===t.message&&e.location.range.isEqual(t.location.range)&&e.location.uri.toString()===t.location.uri.toString()}};Ul=U([ae],Ul);let Oh=class{constructor(e,t,i=Ft.Error){if(!xe.isRange(e))throw new TypeError("range must be set");if(!t)throw new TypeError("message must be set");this.range=e,this.message=t,this.severity=i}toJSON(){return{severity:Ft[this.severity],message:this.message,range:this.range,source:this.source,code:this.code}}static isEqual(e,t){return e===t?!0:!e||!t?!1:e.message===t.message&&e.severity===t.severity&&e.code===t.code&&e.severity===t.severity&&e.source===t.source&&e.range.isEqual(t.range)&&qr(e.tags,t.tags)&&qr(e.relatedInformation,t.relatedInformation,Ul.isEqual)}};Oh=U([ae],Oh);let Hh=class{constructor(e,t){if(!e)throw new Error("Illegal argument, contents must be defined");Array.isArray(e)?this.contents=e:this.contents=[e],this.range=t}};Hh=U([ae],Hh);let Uh=class extends Hh{constructor(e,t,i,n){super(e,t),this.canIncreaseHover=i,this.canDecreaseHover=n}};Uh=U([ae],Uh);var u1;(function(r){r[r.Increase=0]="Increase",r[r.Decrease=1]="Decrease"})(u1||(u1={}));var Bl;(function(r){r[r.Text=0]="Text",r[r.Read=1]="Read",r[r.Write=2]="Write"})(Bl||(Bl={}));let Bh=class{constructor(e,t=Bl.Text){this.range=e,this.kind=t}toJSON(){return{range:this.range,kind:Bl[this.kind]}}};Bh=U([ae],Bh);let Vh=class{constructor(e,t){this.uri=e,this.highlights=t}toJSON(){return{uri:this.uri,highlights:this.highlights.map(e=>e.toJSON())}}};Vh=U([ae],Vh);var Ke;(function(r){r[r.File=0]="File",r[r.Module=1]="Module",r[r.Namespace=2]="Namespace",r[r.Package=3]="Package",r[r.Class=4]="Class",r[r.Method=5]="Method",r[r.Property=6]="Property",r[r.Field=7]="Field",r[r.Constructor=8]="Constructor",r[r.Enum=9]="Enum",r[r.Interface=10]="Interface",r[r.Function=11]="Function",r[r.Variable=12]="Variable",r[r.Constant=13]="Constant",r[r.String=14]="String",r[r.Number=15]="Number",r[r.Boolean=16]="Boolean",r[r.Array=17]="Array",r[r.Object=18]="Object",r[r.Key=19]="Key",r[r.Null=20]="Null",r[r.EnumMember=21]="EnumMember",r[r.Struct=22]="Struct",r[r.Event=23]="Event",r[r.Operator=24]="Operator",r[r.TypeParameter=25]="TypeParameter"})(Ke||(Ke={}));var Vl;(function(r){r[r.Deprecated=1]="Deprecated"})(Vl||(Vl={}));let Wl=s1=class{static validate(e){if(!e.name)throw new Error("name must not be falsy")}constructor(e,t,i,n,s){this.name=e,this.kind=t,this.containerName=s,typeof i=="string"&&(this.containerName=i),n instanceof Pi?this.location=n:i instanceof xe&&(this.location=new Pi(n,i)),s1.validate(this)}toJSON(){return{name:this.name,kind:Ke[this.kind],location:this.location,containerName:this.containerName}}};Wl=s1=U([ae],Wl);let zl=Yd=class{static validate(e){var t;if(!e.name)throw new Error("name must not be falsy");if(!e.range.contains(e.selectionRange))throw new Error("selectionRange must be contained in fullRange");(t=e.children)==null||t.forEach(Yd.validate)}constructor(e,t,i,n,s){this.name=e,this.detail=t,this.kind=i,this.range=n,this.selectionRange=s,this.children=[],Yd.validate(this)}};zl=Yd=U([ae],zl);var jl;(function(r){r[r.Invoke=1]="Invoke",r[r.Automatic=2]="Automatic"})(jl||(jl={}));let Wh=class{constructor(e,t){this.title=e,this.kind=t}};Wh=U([ae],Wh);var fc;let ct=(fc=class{constructor(e){this.value=e}append(e){return new Qc(this.value?this.value+Qc.sep+e:e)}intersects(e){return this.contains(e)||e.contains(this)}contains(e){return this.value===e.value||e.value.startsWith(this.value+Qc.sep)}},Qc=fc,fc.sep=".",fc);ct=Qc=U([ae],ct);ct.Empty=new ct("");ct.QuickFix=ct.Empty.append("quickfix");ct.Refactor=ct.Empty.append("refactor");ct.RefactorExtract=ct.Refactor.append("extract");ct.RefactorInline=ct.Refactor.append("inline");ct.RefactorMove=ct.Refactor.append("move");ct.RefactorRewrite=ct.Refactor.append("rewrite");ct.Source=ct.Empty.append("source");ct.SourceOrganizeImports=ct.Source.append("organizeImports");ct.SourceFixAll=ct.Source.append("fixAll");ct.Notebook=ct.Empty.append("notebook");let ql=class{constructor(e,t){if(this.range=e,this.parent=t,t&&!t.range.contains(this.range))throw new Error("Invalid argument: parent must contain this range")}};ql=U([ae],ql);let Mw=class{constructor(e,t,i,n,s,o){this.kind=e,this.name=t,this.detail=i,this.uri=n,this.range=s,this.selectionRange=o}},SC=class{constructor(e,t){this.fromRanges=t,this.from=e}},EC=class{constructor(e,t){this.fromRanges=t,this.to=e}};var aa;(function(r){r[r.Information=0]="Information",r[r.Warning=1]="Warning",r[r.Error=2]="Error"})(aa||(aa={}));let zh=class{constructor(e,t){this.range=e,this.command=t}get isResolved(){return!!this.command}};zh=U([ae],zh);var Ht,sx;let Ti=o1=(sx=class{constructor(e,t=!1){ue(this,Ht,void 0);K(this,Ht,new Qx(e,{supportThemeIcons:t}))}static isMarkdownString(e){return e instanceof o1?!0:e&&e.appendCodeblock&&e.appendMarkdown&&e.appendText&&e.value!==void 0}get value(){return P(this,Ht).value}set value(e){P(this,Ht).value=e}get isTrusted(){return P(this,Ht).isTrusted}set isTrusted(e){P(this,Ht).isTrusted=e}get supportThemeIcons(){return P(this,Ht).supportThemeIcons}set supportThemeIcons(e){P(this,Ht).supportThemeIcons=e}get supportHtml(){return P(this,Ht).supportHtml}set supportHtml(e){P(this,Ht).supportHtml=e}get baseUri(){return P(this,Ht).baseUri}set baseUri(e){P(this,Ht).baseUri=e}appendText(e){return P(this,Ht).appendText(e),this}appendMarkdown(e){return P(this,Ht).appendMarkdown(e),this}appendCodeblock(e,t){return P(this,Ht).appendCodeblock(t??"",e),this}},Ht=new WeakMap,sx);Ti=o1=U([ae],Ti);let d1=class{constructor(e,t){this.label=e,this.documentation=t}};d1=U([ae],d1);let h1=class{constructor(e,t){this.label=e,this.documentation=t,this.parameters=[]}};h1=U([ae],h1);let f1=class{constructor(){this.activeSignature=0,this.activeParameter=0,this.signatures=[]}};f1=U([ae],f1);var p1;(function(r){r[r.Invoke=1]="Invoke",r[r.TriggerCharacter=2]="TriggerCharacter",r[r.ContentChange=3]="ContentChange"})(p1||(p1={}));var g1;(function(r){r[r.Type=1]="Type",r[r.Parameter=2]="Parameter"})(g1||(g1={}));let jh=class{constructor(e){this.value=e}};jh=U([ae],jh);let qh=class{constructor(e,t,i){this.position=e,this.label=t,this.kind=i}};qh=U([ae],qh);var ca;(function(r){r[r.Invoke=0]="Invoke",r[r.TriggerCharacter=1]="TriggerCharacter",r[r.TriggerForIncompleteCompletions=2]="TriggerForIncompleteCompletions"})(ca||(ca={}));var pe;(function(r){r[r.Text=0]="Text",r[r.Method=1]="Method",r[r.Function=2]="Function",r[r.Constructor=3]="Constructor",r[r.Field=4]="Field",r[r.Variable=5]="Variable",r[r.Class=6]="Class",r[r.Interface=7]="Interface",r[r.Module=8]="Module",r[r.Property=9]="Property",r[r.Unit=10]="Unit",r[r.Value=11]="Value",r[r.Enum=12]="Enum",r[r.Keyword=13]="Keyword",r[r.Snippet=14]="Snippet",r[r.Color=15]="Color",r[r.File=16]="File",r[r.Reference=17]="Reference",r[r.Folder=18]="Folder",r[r.EnumMember=19]="EnumMember",r[r.Constant=20]="Constant",r[r.Struct=21]="Struct",r[r.Event=22]="Event",r[r.Operator=23]="Operator",r[r.TypeParameter=24]="TypeParameter",r[r.User=25]="User",r[r.Issue=26]="Issue"})(pe||(pe={}));var Gl;(function(r){r[r.Deprecated=1]="Deprecated"})(Gl||(Gl={}));let Gh=class{constructor(e,t){this.label=e,this.kind=t}toJSON(){return{label:this.label,kind:this.kind&&pe[this.kind],detail:this.detail,documentation:this.documentation,sortText:this.sortText,filterText:this.filterText,preselect:this.preselect,insertText:this.insertText,textEdit:this.textEdit}}};Gh=U([ae],Gh);let Wa=class{constructor(e=[],t=!1){this.items=e,this.isIncomplete=t}};Wa=U([ae],Wa);let m1=class{constructor(e,t,i){this.insertText=e,this.range=t,this.command=i}};m1=U([ae],m1);let v1=class{constructor(e){this.commands=void 0,this.suppressSuggestions=void 0,this.items=e}};v1=U([ae],v1);var Is;(function(r){r[r.Unknown=0]="Unknown",r[r.Word=1]="Word",r[r.Line=2]="Line",r[r.Suggest=3]="Suggest"})(Is||(Is={}));var Ql;(function(r){r[r.Active=-1]="Active",r[r.Beside=-2]="Beside",r[r.One=1]="One",r[r.Two=2]="Two",r[r.Three=3]="Three",r[r.Four=4]="Four",r[r.Five=5]="Five",r[r.Six=6]="Six",r[r.Seven=7]="Seven",r[r.Eight=8]="Eight",r[r.Nine=9]="Nine"})(Ql||(Ql={}));var $r;(function(r){r[r.Left=1]="Left",r[r.Right=2]="Right"})($r||($r={}));function bI(r,e){return`${Xe.toKey(r)}.${e}`}var qi;(function(r){r[r.Off=0]="Off",r[r.On=1]="On",r[r.Relative=2]="Relative",r[r.Interval=3]="Interval"})(qi||(qi={}));var la;(function(r){r[r.Manual=1]="Manual",r[r.AfterDelay=2]="AfterDelay",r[r.FocusOut=3]="FocusOut"})(la||(la={}));var Qh;(function(r){r[r.Default=0]="Default",r[r.InCenter=1]="InCenter",r[r.InCenterIfOutsideViewport=2]="InCenterIfOutsideViewport",r[r.AtTop=3]="AtTop"})(Qh||(Qh={}));var za;(function(r){r[r.Keyboard=1]="Keyboard",r[r.Mouse=2]="Mouse",r[r.Command=3]="Command"})(za||(za={}));var Jl;(function(r){r[r.Undo=1]="Undo",r[r.Redo=2]="Redo"})(Jl||(Jl={}));var Ps;(function(r){r[r.OpenOpen=0]="OpenOpen",r[r.ClosedClosed=1]="ClosedClosed",r[r.OpenClosed=2]="OpenClosed",r[r.ClosedOpen=3]="ClosedOpen"})(Ps||(Ps={}));(function(r){function e(t){switch(t){case"keyboard":return r.Keyboard;case"mouse":return r.Mouse;case"api":return r.Command}}r.fromValue=e})(za||(za={}));var ja;(function(r){r[r.Other=0]="Other",r[r.Comment=1]="Comment",r[r.String=2]="String",r[r.RegEx=3]="RegEx"})(ja||(ja={}));(function(r){function e(t){switch(t){case r.Other:return"other";case r.Comment:return"comment";case r.String:return"string";case r.RegEx:return"regex"}return"other"}r.toString=e})(ja||(ja={}));let Jh=class{constructor(e,t){if(t&&!x.isUri(t))throw Se("target");if(!xe.isRange(e)||e.isEmpty)throw Se("range");this.range=e,this.target=t}};Jh=U([ae],Jh);let qa=class{constructor(e,t,i,n){this.red=e,this.green=t,this.blue=i,this.alpha=n}};qa=U([ae],qa);let Kh=class{constructor(e,t){if(t&&!(t instanceof qa))throw Se("color");if(!xe.isRange(e)||e.isEmpty)throw Se("range");this.range=e,this.color=t}};Kh=U([ae],Kh);let Xh=class{constructor(e){if(!e||typeof e!="string")throw Se("label");this.label=e}};Xh=U([ae],Xh);var _1;(function(r){r[r.Error=0]="Error",r[r.Warning=1]="Warning",r[r.Information=2]="Information"})(_1||(_1={}));var w1;(function(r){r[r.Unknown=0]="Unknown",r[r.Shutdown=1]="Shutdown",r[r.Process=2]="Process",r[r.User=3]="User",r[r.Extension=4]="Extension"})(w1||(w1={}));var Zh;(function(r){r[r.Low=0]="Low",r[r.Medium=1]="Medium",r[r.High=2]="High"})(Zh||(Zh={}));class yI{constructor(e,t,i){if(this.startIndex=e,this.length=t,this.tooltip=i,typeof e!="number"||e<0)throw Se("startIndex");if(typeof t!="number"||t<1)throw Se("length");if(i!==void 0&&typeof i!="string")throw Se("tooltip")}}class xI{constructor(e){this.uri=e}}class CI{constructor(e){this.terminalCommand=e}}var b1;(function(r){r[r.Panel=1]="Panel",r[r.Editor=2]="Editor"})(b1||(b1={}));class SI{constructor(e){if(this.options=e,typeof e!="object")throw Se("options")}}var y1;(function(r){r[r.Always=1]="Always",r[r.Silent=2]="Silent",r[r.Never=3]="Never"})(y1||(y1={}));var x1;(function(r){r[r.Shared=1]="Shared",r[r.Dedicated=2]="Dedicated",r[r.New=3]="New"})(x1||(x1={}));var jn;let Kl=(jn=class{static from(e){switch(e){case"clean":return an.Clean;case"build":return an.Build;case"rebuild":return an.Rebuild;case"test":return an.Test;default:return}}constructor(e,t){if(this.label=t,typeof e!="string"||typeof t!="string")throw Se("name");this._id=e}get id(){return this._id}},an=jn,jn.Clean=new an("clean","Clean"),jn.Build=new an("build","Build"),jn.Rebuild=new an("rebuild","Rebuild"),jn.Test=new an("test","Test"),jn);Kl=an=U([ae],Kl);function kC(r){let e="";for(let t=0;t<r.length;t++)e+=r[t].replace(/,/g,",,")+",";return e}let Ga=class{constructor(e,t,i){if(typeof e!="string")throw Se("process");this._args=[],this._process=e,t!==void 0&&(Array.isArray(t)?(this._args=t,this._options=i):this._options=t)}get process(){return this._process}set process(e){if(typeof e!="string")throw Se("process");this._process=e}get args(){return this._args}set args(e){Array.isArray(e)||(e=[]),this._args=e}get options(){return this._options}set options(e){this._options=e}computeId(){const e=[];if(e.push("process"),this._process!==void 0&&e.push(this._process),this._args&&this._args.length>0)for(const t of this._args)e.push(t);return kC(e)}};Ga=U([ae],Ga);let mo=class{constructor(e,t,i){if(this._args=[],Array.isArray(t)){if(!e)throw Se("command can't be undefined or null");if(typeof e!="string"&&typeof e.value!="string")throw Se("command");this._command=e,this._args=t,this._options=i}else{if(typeof e!="string")throw Se("commandLine");this._commandLine=e,this._options=t}}get commandLine(){return this._commandLine}set commandLine(e){if(typeof e!="string")throw Se("commandLine");this._commandLine=e}get command(){return this._command?this._command:""}set command(e){if(typeof e!="string"&&typeof e.value!="string")throw Se("command");this._command=e}get args(){return this._args}set args(e){this._args=e||[]}get options(){return this._options}set options(e){this._options=e}computeId(){const e=[];if(e.push("shell"),this._commandLine!==void 0&&e.push(this._commandLine),this._command!==void 0&&e.push(typeof this._command=="string"?this._command:this._command.value),this._args&&this._args.length>0)for(const t of this._args)e.push(typeof t=="string"?t:t.value);return kC(e)}};mo=U([ae],mo);var C1;(function(r){r[r.Escape=1]="Escape",r[r.Strong=2]="Strong",r[r.Weak=3]="Weak"})(C1||(C1={}));var vo;(function(r){r[r.Global=1]="Global",r[r.Workspace=2]="Workspace"})(vo||(vo={}));class Fw{constructor(e){this._callback=e}computeId(){return"customExecution"+ar()}set callback(e){this._callback=e}get callback(){return this._callback}}var qn;let Yh=(qn=class{constructor(e,t,i,n,s,o){this.__deprecated=!1,this._definition=this.definition=e;let a;typeof t=="string"?(this._name=this.name=t,this._source=this.source=i,this.execution=n,a=s,this.__deprecated=!0):t===vo.Global||t===vo.Workspace?(this.target=t,this._name=this.name=i,this._source=this.source=n,this.execution=s,a=o):(this.target=t,this._name=this.name=i,this._source=this.source=n,this.execution=s,a=o),typeof a=="string"?(this._problemMatchers=[a],this._hasDefinedMatchers=!0):Array.isArray(a)?(this._problemMatchers=a,this._hasDefinedMatchers=!0):(this._problemMatchers=[],this._hasDefinedMatchers=!1),this._isBackground=!1,this._presentationOptions=Object.create(null),this._runOptions=Object.create(null)}get _id(){return this.__id}set _id(e){this.__id=e}get _deprecated(){return this.__deprecated}clear(){this.__id!==void 0&&(this.__id=void 0,this._scope=void 0,this.computeDefinitionBasedOnExecution())}computeDefinitionBasedOnExecution(){this._execution instanceof Ga?this._definition={type:cn.ProcessType,id:this._execution.computeId()}:this._execution instanceof mo?this._definition={type:cn.ShellType,id:this._execution.computeId()}:this._execution instanceof Fw?this._definition={type:cn.ExtensionCallbackType,id:this._execution.computeId()}:this._definition={type:cn.EmptyType,id:ar()}}get definition(){return this._definition}set definition(e){if(e==null)throw Se("Kind can't be undefined or null");this.clear(),this._definition=e}get scope(){return this._scope}set target(e){this.clear(),this._scope=e}get name(){return this._name}set name(e){if(typeof e!="string")throw Se("name");this.clear(),this._name=e}get execution(){return this._execution}set execution(e){e===null&&(e=void 0),this.clear(),this._execution=e;const t=this._definition.type;(cn.EmptyType===t||cn.ProcessType===t||cn.ShellType===t||cn.ExtensionCallbackType===t)&&this.computeDefinitionBasedOnExecution()}get problemMatchers(){return this._problemMatchers}set problemMatchers(e){if(Array.isArray(e))this.clear(),this._problemMatchers=e,this._hasDefinedMatchers=!0;else{this.clear(),this._problemMatchers=[],this._hasDefinedMatchers=!1;return}}get hasDefinedMatchers(){return this._hasDefinedMatchers}get isBackground(){return this._isBackground}set isBackground(e){e!==!0&&e!==!1&&(e=!1),this.clear(),this._isBackground=e}get source(){return this._source}set source(e){if(typeof e!="string"||e.length===0)throw Se("source must be a string of length > 0");this.clear(),this._source=e}get group(){return this._group}set group(e){e===null&&(e=void 0),this.clear(),this._group=e}get detail(){return this._detail}set detail(e){e===null&&(e=void 0),this._detail=e}get presentationOptions(){return this._presentationOptions}set presentationOptions(e){e==null&&(e=Object.create(null)),this.clear(),this._presentationOptions=e}get runOptions(){return this._runOptions}set runOptions(e){e==null&&(e=Object.create(null)),this.clear(),this._runOptions=e}},cn=qn,qn.ExtensionCallbackType="customExecution",qn.ProcessType="process",qn.ShellType="shell",qn.EmptyType="$empty",qn);Yh=cn=U([ae],Yh);var io;(function(r){r[r.SourceControl=1]="SourceControl",r[r.Window=10]="Window",r[r.Notification=15]="Notification"})(io||(io={}));var S1;(function(r){function e(t){const i=t;return Br(i.value)?i.tooltip&&!$e(i.tooltip)?(console.log("INVALID view badge, invalid tooltip",i.tooltip),!1):!0:(console.log("INVALID view badge, invalid value",i.value),!1)}r.isViewBadge=e})(S1||(S1={}));let ef=a1=class{static isTreeItem(e,t){var n,s;const i=e;if(i.checkboxState!==void 0){const o=Br(i.checkboxState)?i.checkboxState:Vt(i.checkboxState)&&Br(i.checkboxState.state)?i.checkboxState.state:void 0,a=!Br(i.checkboxState)&&Vt(i.checkboxState)?i.checkboxState.tooltip:void 0;if(o===void 0||o!==wn.Checked&&o!==wn.Unchecked||a!==void 0&&!$e(a))return console.log("INVALID tree item, invalid checkboxState",i.checkboxState),!1}if(e instanceof a1)return!0;if(i.label!==void 0&&!$e(i.label)&&!((n=i.label)!=null&&n.label))return console.log("INVALID tree item, invalid label",i.label),!1;if(i.id!==void 0&&!$e(i.id))return console.log("INVALID tree item, invalid id",i.id),!1;if(i.iconPath!==void 0&&!$e(i.iconPath)&&!x.isUri(i.iconPath)&&(!i.iconPath||!$e(i.iconPath.id))){const o=i.iconPath;if(!o||!$e(o.light)&&!x.isUri(o.light)&&!$e(o.dark)&&!x.isUri(o.dark))return console.log("INVALID tree item, invalid iconPath",i.iconPath),!1}return i.description!==void 0&&!$e(i.description)&&typeof i.description!="boolean"?(console.log("INVALID tree item, invalid description",i.description),!1):i.resourceUri!==void 0&&!x.isUri(i.resourceUri)?(console.log("INVALID tree item, invalid resourceUri",i.resourceUri),!1):i.tooltip!==void 0&&!$e(i.tooltip)&&!(i.tooltip instanceof Ti)?(console.log("INVALID tree item, invalid tooltip",i.tooltip),!1):i.command!==void 0&&!i.command.command?(console.log("INVALID tree item, invalid command",i.command),!1):i.collapsibleState!==void 0&&i.collapsibleState<no.None&&i.collapsibleState>no.Expanded?(console.log("INVALID tree item, invalid collapsibleState",i.collapsibleState),!1):i.contextValue!==void 0&&!$e(i.contextValue)?(console.log("INVALID tree item, invalid contextValue",i.contextValue),!1):i.accessibilityInformation!==void 0&&!((s=i.accessibilityInformation)!=null&&s.label)?(console.log("INVALID tree item, invalid accessibilityInformation",i.accessibilityInformation),!1):!0}constructor(e,t=no.None){this.collapsibleState=t,x.isUri(e)?this.resourceUri=e:this.label=e}};ef=a1=U([ae],ef);var no;(function(r){r[r.None=0]="None",r[r.Collapsed=1]="Collapsed",r[r.Expanded=2]="Expanded"})(no||(no={}));var wn;(function(r){r[r.Unchecked=0]="Unchecked",r[r.Checked=1]="Checked"})(wn||(wn={}));let tf=class{async asString(){return typeof this.value=="string"?this.value:JSON.stringify(this.value)}asFile(){}constructor(e){this.value=e}};tf=U([ae],tf);class nf extends tf{}var Nu;class EI extends nf{constructor(t){super("");ue(this,Nu,void 0);K(this,Nu,t)}asFile(){return P(this,Nu)}}Nu=new WeakMap;class kI{constructor(e,t,i,n){this.name=e,this.uri=t,this._itemId=i,this._getData=n}data(){return this._getData()}}var Bn,Fs,Jc,ox;let Xl=(ox=class{constructor(e){ue(this,Fs);ue(this,Bn,new Map);for(const[t,i]of e??[]){const n=P(this,Bn).get(Rc(this,Fs,Jc).call(this,t));n?n.push(i):P(this,Bn).set(Rc(this,Fs,Jc).call(this,t),[i])}}get(e){var t;return(t=P(this,Bn).get(Rc(this,Fs,Jc).call(this,e)))==null?void 0:t[0]}set(e,t){P(this,Bn).set(Rc(this,Fs,Jc).call(this,e),[t])}forEach(e,t){for(const[i,n]of P(this,Bn))for(const s of n)e.call(t,s,i,this)}*[Symbol.iterator](){for(const[e,t]of P(this,Bn))for(const i of t)yield[e,i]}},Bn=new WeakMap,Fs=new WeakSet,Jc=function(e){return e.toLowerCase()},ox);Xl=U([ae],Xl);let E1=class{constructor(e,t,i){this.insertText=e,this.title=t,this.kind=i}};E1=U([ae],E1);var k1;(function(r){r[r.Automatic=0]="Automatic",r[r.PasteAs=1]="PasteAs"})(k1||(k1={}));const ta=class ta{constructor(e){this.value=e}append(...e){return new ta((this.value?[this.value,...e]:e).join(ta.sep))}intersects(e){return this.contains(e)||e.contains(this)}contains(e){return this.value===e.value||e.value.startsWith(this.value+ta.sep)}};ta.sep=".";let Qa=ta;Qa.Empty=new Qa("");class DI{constructor(e,t,i){this.title=t,this.insertText=e,this.kind=i}}let Kt=class{constructor(e,t){this.id=e,this.color=t}static isThemeIcon(e){return typeof e.id!="string"?(console.log("INVALID ThemeIcon, invalid id",e.id),!1):!0}};Kt=U([ae],Kt);Kt.File=new Kt("file");Kt.Folder=new Kt("folder");let Zl=class{constructor(e){this.id=e}};Zl=U([ae],Zl);var ua;(function(r){r[r.Global=1]="Global",r[r.Workspace=2]="Workspace",r[r.WorkspaceFolder=3]="WorkspaceFolder"})(ua||(ua={}));let da=class{get base(){return this._base}set base(e){this._base=e,this._baseUri=x.file(e)}get baseUri(){return this._baseUri}set baseUri(e){this._baseUri=e,this._base=e.fsPath}constructor(e,t){if(typeof e!="string"&&(!e||!x.isUri(e)&&!x.isUri(e.uri)))throw Se("base");if(typeof t!="string")throw Se("pattern");typeof e=="string"?this.baseUri=x.file(e):x.isUri(e)?this.baseUri=e:this.baseUri=e.uri,this.pattern=t}toJSON(){return{pattern:this.pattern,base:this.base,baseUri:this.baseUri.toJSON()}}};da=U([ae],da);const DC=new WeakMap;function II(r,e){DC.set(r,e)}let Ja=class{constructor(e,t,i,n,s){this.enabled=typeof e=="boolean"?e:!0,typeof t=="string"&&(this.condition=t),typeof i=="string"&&(this.hitCondition=i),typeof n=="string"&&(this.logMessage=n),typeof s=="string"&&(this.mode=s)}get id(){return this._id||(this._id=DC.get(this)??ar()),this._id}};Ja=U([ae],Ja);let Ts=class extends Ja{constructor(e,t,i,n,s,o){if(super(t,i,n,s,o),e===null)throw Se("location");this.location=e}};Ts=U([ae],Ts);let As=class extends Ja{constructor(e,t,i,n,s,o){super(t,i,n,s,o),this.functionName=e}};As=U([ae],As);let rf=class extends Ja{constructor(e,t,i,n,s,o,a,c){if(super(n,s,o,a,c),!t)throw Se("dataId");this.label=e,this.dataId=t,this.canPersist=i}};rf=U([ae],rf);let sf=class{constructor(e,t,i){this.command=e,this.args=t||[],this.options=i}};sf=U([ae],sf);let Yl=class{constructor(e,t){this.port=e,this.host=t}};Yl=U([ae],Yl);let of=class{constructor(e){this.path=e}};of=U([ae],of);let af=class{constructor(e){this.implementation=e}};af=U([ae],af);class IC{constructor(e,t,i){this.session=e,this.threadId=t,this.frameId=i}}class PC{constructor(e,t){this.session=e,this.threadId=t}}let cf=class{constructor(e,t){this.range=e,this.expression=t}};cf=U([ae],cf);var eu;(function(r){r[r.Invoke=0]="Invoke",r[r.Automatic=1]="Automatic"})(eu||(eu={}));let lf=class{constructor(e,t){this.range=e,this.text=t}};lf=U([ae],lf);let uf=class{constructor(e,t,i=!0){this.range=e,this.variableName=t,this.caseSensitiveLookup=i}};uf=U([ae],uf);let df=class{constructor(e,t){this.range=e,this.expression=t}};df=U([ae],df);let D1=class{constructor(e,t){this.frameId=e,this.stoppedLocation=t}};D1=U([ae],D1);var I1;(function(r){r[r.AIGenerated=1]="AIGenerated"})(I1||(I1={}));var tu;(function(r){r[r.Invoke=0]="Invoke",r[r.Automatic=1]="Automatic"})(tu||(tu={}));class PI{constructor(e,t){this.newSymbolName=e,this.tags=t}}var ha;(function(r){r[r.Changed=1]="Changed",r[r.Created=2]="Created",r[r.Deleted=3]="Deleted"})(ha||(ha={}));let St=ni=class extends Error{static FileExists(e){return new ni(e,Ee.FileExists,ni.FileExists)}static FileNotFound(e){return new ni(e,Ee.FileNotFound,ni.FileNotFound)}static FileNotADirectory(e){return new ni(e,Ee.FileNotADirectory,ni.FileNotADirectory)}static FileIsADirectory(e){return new ni(e,Ee.FileIsADirectory,ni.FileIsADirectory)}static NoPermissions(e){return new ni(e,Ee.NoPermissions,ni.NoPermissions)}static Unavailable(e){return new ni(e,Ee.Unavailable,ni.Unavailable)}constructor(e,t=Ee.Unknown,i){super(x.isUri(e)?e.toString(!0):e),this.code=(i==null?void 0:i.name)??"Unknown",uC(this,t),Object.setPrototypeOf(this,ni.prototype),typeof Error.captureStackTrace=="function"&&typeof i=="function"&&Error.captureStackTrace(this,i)}};St=ni=U([ae],St);let P1=class{constructor(e,t,i){this.start=e,this.end=t,this.kind=i}};P1=U([ae],P1);var On;(function(r){r[r.Comment=1]="Comment",r[r.Imports=2]="Imports",r[r.Region=3]="Region"})(On||(On={}));var iu;(function(r){r[r.Collapsed=0]="Collapsed",r[r.Expanded=1]="Expanded"})(iu||(iu={}));var T1;(function(r){r[r.Editing=0]="Editing",r[r.Preview=1]="Preview"})(T1||(T1={}));var A1;(function(r){r[r.Published=0]="Published",r[r.Draft=1]="Draft"})(A1||(A1={}));var nu;(function(r){r[r.Unresolved=0]="Unresolved",r[r.Resolved=1]="Resolved"})(nu||(nu={}));var ru;(function(r){r[r.Current=0]="Current",r[r.Outdated=1]="Outdated"})(ru||(ru={}));class R1{constructor(e,t=[]){this.tokenTypes=e,this.tokenModifiers=t}}function TI(r){return typeof r>"u"||EE(r)}class Ow{constructor(e){if(this._prevLine=0,this._prevChar=0,this._dataIsSortedAndDeltaEncoded=!0,this._data=[],this._dataLen=0,this._tokenTypeStrToInt=new Map,this._tokenModifierStrToInt=new Map,this._hasLegend=!1,e){this._hasLegend=!0;for(let t=0,i=e.tokenTypes.length;t<i;t++)this._tokenTypeStrToInt.set(e.tokenTypes[t],t);for(let t=0,i=e.tokenModifiers.length;t<i;t++)this._tokenModifierStrToInt.set(e.tokenModifiers[t],t)}}push(e,t,i,n,s){if(typeof e=="number"&&typeof t=="number"&&typeof i=="number"&&typeof n=="number"&&(typeof s=="number"||typeof s>"u"))return typeof s>"u"&&(s=0),this._pushEncoded(e,t,i,n,s);if(xe.isRange(e)&&typeof t=="string"&&TI(i))return this._push(e,t,i);throw Se()}_push(e,t,i){if(!this._hasLegend)throw new Error("Legend must be provided in constructor");if(e.start.line!==e.end.line)throw new Error("`range` cannot span multiple lines");if(!this._tokenTypeStrToInt.has(t))throw new Error("`tokenType` is not in the provided legend");const n=e.start.line,s=e.start.character,o=e.end.character-e.start.character,a=this._tokenTypeStrToInt.get(t);let c=0;if(i)for(const l of i){if(!this._tokenModifierStrToInt.has(l))throw new Error("`tokenModifier` is not in the provided legend");const u=this._tokenModifierStrToInt.get(l);c|=1<<u>>>0}this._pushEncoded(n,s,o,a,c)}_pushEncoded(e,t,i,n,s){if(this._dataIsSortedAndDeltaEncoded&&(e<this._prevLine||e===this._prevLine&&t<this._prevChar)){this._dataIsSortedAndDeltaEncoded=!1;const c=this._data.length/5|0;let l=0,u=0;for(let d=0;d<c;d++){let f=this._data[5*d],m=this._data[5*d+1];f===0?(f=l,m+=u):f+=l,this._data[5*d]=f,this._data[5*d+1]=m,l=f,u=m}}let o=e,a=t;this._dataIsSortedAndDeltaEncoded&&this._dataLen>0&&(o-=this._prevLine,o===0&&(a-=this._prevChar)),this._data[this._dataLen++]=o,this._data[this._dataLen++]=a,this._data[this._dataLen++]=i,this._data[this._dataLen++]=n,this._data[this._dataLen++]=s,this._prevLine=e,this._prevChar=t}static _sortAndDeltaEncode(e){const t=[],i=e.length/5|0;for(let a=0;a<i;a++)t[a]=a;t.sort((a,c)=>{const l=e[5*a],u=e[5*c];if(l===u){const d=e[5*a+1],f=e[5*c+1];return d-f}return l-u});const n=new Uint32Array(e.length);let s=0,o=0;for(let a=0;a<i;a++){const c=5*t[a],l=e[c+0],u=e[c+1],d=e[c+2],f=e[c+3],m=e[c+4],b=l-s,_=b===0?u-o:u,v=5*a;n[v+0]=b,n[v+1]=_,n[v+2]=d,n[v+3]=f,n[v+4]=m,s=l,o=u}return n}build(e){return this._dataIsSortedAndDeltaEncoded?new Ka(new Uint32Array(this._data),e):new Ka(Ow._sortAndDeltaEncode(this._data),e)}}class Ka{constructor(e,t){this.resultId=t,this.data=e}}class TC{constructor(e,t,i){this.start=e,this.deleteCount=t,this.data=i}}class th{constructor(e,t){this.resultId=t,this.edits=e}}var hf;(function(r){r[r.Separate=0]="Separate",r[r.MergeWithParent=1]="MergeWithParent"})(hf||(hf={}));class AI{constructor(e){this.name=e}}var Mu;let su=(Mu=class{constructor(){}},Mu.Back={iconPath:new Kt("arrow-left")},Mu);su=U([ae],su);var ou;(function(r){r[r.Separator=-1]="Separator",r[r.Default=0]="Default"})(ou||(ou={}));var fa;(function(r){r[r.Info=1]="Info",r[r.Warning=2]="Warning",r[r.Error=3]="Error"})(fa||(fa={}));var ro;(function(r){r[r.UI=1]="UI",r[r.Workspace=2]="Workspace"})(ro||(ro={}));class L1{static validate(e){if(typeof e.badge=="string"){let t=O0(e.badge,0);if(t<e.badge.length&&(t+=O0(e.badge,t)),e.badge.length>t)throw new Error("The 'badge'-property must be undefined or a short character")}else if(e.badge&&!Kt.isThemeIcon(e.badge))throw new Error("The 'badge'-property is not a valid ThemeIcon");if(!e.color&&!e.badge&&!e.tooltip)throw new Error("The decoration is empty");return!0}constructor(e,t,i){this.badge=e,this.tooltip=t,this.color=i}}let ff=class{constructor(e){this.kind=e}};ff=U([ae],ff);var xr;(function(r){r[r.Light=1]="Light",r[r.Dark=2]="Dark",r[r.HighContrast=3]="HighContrast",r[r.HighContrastLight=4]="HighContrastLight"})(xr||(xr={}));let Kn=class $1{static isNotebookRange(e){return e instanceof $1?!0:e?typeof e.start=="number"&&typeof e.end=="number":!1}get start(){return this._start}get end(){return this._end}get isEmpty(){return this._start===this._end}constructor(e,t){if(e<0)throw Se("start must be positive");if(t<0)throw Se("end must be positive");e<=t?(this._start=e,this._end=t):(this._start=t,this._end=e)}with(e){let t=this._start,i=this._end;return e.start!==void 0&&(t=e.start),e.end!==void 0&&(i=e.end),t===this._start&&i===this._end?this:new $1(t,i)}},ng=class N1{static validate(e){if(typeof e.kind!="number")throw new Error("NotebookCellData MUST have 'kind' property");if(typeof e.value!="string")throw new Error("NotebookCellData MUST have 'value' property");if(typeof e.languageId!="string")throw new Error("NotebookCellData MUST have 'languageId' property")}static isNotebookCellDataArray(e){return Array.isArray(e)&&e.every(t=>N1.isNotebookCellData(t))}static isNotebookCellData(e){return!0}constructor(e,t,i,n,s,o,a){this.kind=e,this.value=t,this.languageId=i,this.mime=n,this.outputs=s??[],this.metadata=o,this.executionSummary=a,N1.validate(this)}},AC=class{constructor(e){this.cells=e}};var Ei,kp;let RC=(Ei=class{static isNotebookCellOutputItem(e){return e instanceof Ei?!0:e?typeof e.mime=="string"&&e.data instanceof Uint8Array:!1}static error(e){const t={name:e.name,message:e.message,stack:e.stack};return Ei.json(t,"application/vnd.code.notebook.error")}static stdout(e){return Ei.text(e,"application/vnd.code.notebook.stdout")}static stderr(e){return Ei.text(e,"application/vnd.code.notebook.stderr")}static bytes(e,t="application/octet-stream"){return new Ei(e,t)}static text(e,t=er.text){const i=P(Ei,kp).encode(String(e));return new Ei(i,t)}static json(e,t="text/x-json"){const i=JSON.stringify(e,void 0,"	");return Ei.text(i,t)}constructor(e,t){this.data=e,this.mime=t;const i=oC(t,!0);if(!i)throw new Error(`INVALID mime type: ${t}. Must be in the format "type/subtype[;optionalparameter]"`);this.mime=i}},kp=new WeakMap,ue(Ei,kp,new TextEncoder),Ei),pf=class M1{static isNotebookCellOutput(e){return e instanceof M1?!0:!e||typeof e!="object"?!1:typeof e.id=="string"&&Array.isArray(e.items)}static ensureUniqueMimeTypes(e,t=!1){const i=new Set,n=new Set;for(let s=0;s<e.length;s++){const o=e[s],a=oC(o.mime);if(!i.has(a)||xC(a)){i.add(a);continue}n.add(s),t&&console.warn(`DUPLICATED mime type '${o.mime}' will be dropped`)}return n.size===0?e:e.filter((s,o)=>!n.has(o))}constructor(e,t,i){this.items=M1.ensureUniqueMimeTypes(e,!0),typeof t=="string"?(this.id=t,this.metadata=i):(this.id=ar(),this.metadata=t??i)}};var Rs;(function(r){r[r.Markup=1]="Markup",r[r.Code=2]="Code"})(Rs||(Rs={}));var Xa;(function(r){r[r.Idle=1]="Idle",r[r.Pending=2]="Pending",r[r.Executing=3]="Executing"})(Xa||(Xa={}));var gf;(function(r){r[r.Left=1]="Left",r[r.Right=2]="Right"})(gf||(gf={}));var mf;(function(r){r[r.Default=0]="Default",r[r.InCenter=1]="InCenter",r[r.InCenterIfOutsideViewport=2]="InCenterIfOutsideViewport",r[r.AtTop=3]="AtTop"})(mf||(mf={}));class RI{constructor(e,t){this.text=e,this.alignment=t}}var F1;(function(r){r[r.Default=1]="Default",r[r.Preferred=2]="Preferred"})(F1||(F1={}));var vf;(function(r){r[r.Default=1]="Default",r[r.Preferred=2]="Preferred",r[r.Hidden=-1]="Hidden"})(vf||(vf={}));let LC=class{constructor(e,t=[]){this.uri=e,this.provides=$a(t)}},LI=class{constructor(e){this.label=e}};var au;(function(r){r[r.Named=1]="Named",r[r.Indexed=2]="Indexed"})(au||(au={}));let O1=class{constructor(e,t){this.label=e,this.timestamp=t}};O1=U([ae],O1);var pa;(function(r){r[r.Production=1]="Production",r[r.Development=2]="Development",r[r.Test=3]="Test"})(pa||(pa={}));var _f;(function(r){r[r.Node=1]="Node",r[r.Webworker=2]="Webworker"})(_f||(_f={}));var Nr;(function(r){r[r.Other=0]="Other",r[r.Comment=1]="Comment",r[r.String=2]="String",r[r.RegEx=3]="RegEx"})(Nr||(Nr={}));class $I{constructor(e,t){this.ranges=e,this.wordPattern=t}}class NI{constructor(e){this._autoForwardAction=e}get autoForwardAction(){return this._autoForwardAction}}var H1;(function(r){r[r.Queued=1]="Queued",r[r.Running=2]="Running",r[r.Passed=3]="Passed",r[r.Failed=4]="Failed",r[r.Skipped=5]="Skipped",r[r.Errored=6]="Errored"})(H1||(H1={}));var ga;(function(r){r[r.Run=1]="Run",r[r.Debug=2]="Debug",r[r.Coverage=3]="Coverage"})(ga||(ga={}));let cu=class{constructor(e=void 0,t=void 0,i=void 0,n=!1,s=!0){this.include=e,this.exclude=t,this.profile=i,this.continuous=n,this.preserveFocus=s}};cu=U([ae],cu);let wf=c1=class{static diff(e,t,i){const n=new c1(e);return n.expectedOutput=t,n.actualOutput=i,n}constructor(e){this.message=e}};wf=c1=U([ae],wf);let lu=class{constructor(e){this.id=e}};lu=U([ae],lu);class ih{constructor(e,t){this.covered=e,this.total=t,nh(this)}}function nh(r){if(r){if(r.covered>r.total)throw new Error(`The total number of covered items (${r.covered}) cannot be greater than the total (${r.total})`);if(r.total<0)throw new Error(`The number of covered items (${r.total}) cannot be negative`)}}class Hw{static fromDetails(e,t){const i=new ih(0,0),n=new ih(0,0),s=new ih(0,0);for(const a of t)if("branches"in a){i.total+=1,i.covered+=a.executed?1:0;for(const c of a.branches)n.total+=1,n.covered+=c.executed?1:0}else s.total+=1,s.covered+=a.executed?1:0;const o=new Hw(e,i,n.total>0?n:void 0,s.total>0?s:void 0);return o.detailedCoverage=t,o}constructor(e,t,i,n){this.uri=e,this.statementCoverage=t,this.branchCoverage=i,this.declarationCoverage=n}}class MI{get executionCount(){return+this.executed}set executionCount(e){this.executed=e}constructor(e,t,i=[]){this.executed=e,this.location=t,this.branches=i}}class FI{get executionCount(){return+this.executed}set executionCount(e){this.executed=e}constructor(e,t,i){this.executed=e,this.location=t,this.label=i}}class OI{get executionCount(){return+this.executed}set executionCount(e){this.executed=e}constructor(e,t,i){this.name=e,this.executed=t,this.location=i}}var U1;(function(r){r[r.None=0]="None",r[r.Option=1]="Option",r[r.Default=2]="Default",r[r.Preferred=3]="Preferred"})(U1||(U1={}));var B1;(function(r){r[r.Untrusted=0]="Untrusted",r[r.Trusted=1]="Trusted",r[r.Unspecified=2]="Unspecified"})(B1||(B1={}));var V1;(function(r){r[r.Notify=1]="Notify",r[r.OpenBrowser=2]="OpenBrowser",r[r.OpenPreview=3]="OpenPreview",r[r.Silent=4]="Silent",r[r.Ignore=5]="Ignore",r[r.OpenBrowserOnce=6]="OpenBrowserOnce"})(V1||(V1={}));let Uw=class{constructor(e,t,i,n,s,o){this.kind=e,this.name=t,this.detail=i,this.uri=n,this.range=s,this.selectionRange=o}};class Bw{constructor(e){this.uri=e}}class bf{constructor(e,t){this.original=e,this.modified=t}}class $C{constructor(e,t,i,n){this.base=e,this.input1=t,this.input2=i,this.result=n}}class Vw{constructor(e,t){this.uri=e,this.viewType=t}}class NC{constructor(e){this.viewType=e}}class Ww{constructor(e,t){this.uri=e,this.notebookType=t}}class zw{constructor(e,t,i){this.original=e,this.modified=t,this.notebookType=i}}class MC{constructor(){}}class FC{constructor(e,t){this.uri=e,this.inputBoxUri=t}}class OC{constructor(){}}class HC{constructor(e){this.textDiffs=e}}var W1;(function(r){r[r.Down=0]="Down",r[r.Up=1]="Up"})(W1||(W1={}));var z1;(function(r){r[r.Action=1]="Action",r[r.Toolbar=2]="Toolbar"})(z1||(z1={}));var Hn;(function(r){r[r.Short=1]="Short",r[r.Medium=2]="Medium",r[r.Full=3]="Full"})(Hn||(Hn={}));class HI{constructor(e,t){this.label=e,this.values=t}}var Cr;(function(r){r[r.Unhelpful=0]="Unhelpful",r[r.Helpful=1]="Helpful",r[r.Undone=2]="Undone",r[r.Accepted=3]="Accepted",r[r.Bug=4]="Bug"})(Cr||(Cr={}));var uu;(function(r){r[r.Unhelpful=0]="Unhelpful",r[r.Helpful=1]="Helpful"})(uu||(uu={}));let rg=class{constructor(e){if(typeof e!="string"&&e.isTrusted===!0)throw new Error("The boolean form of MarkdownString.isTrusted is NOT supported for chat participants.");this.value=typeof e=="string"?new Ti(e):e}},du=class{constructor(e,t){if(typeof e!="string"&&e.isTrusted===!0)throw new Error("The boolean form of MarkdownString.isTrusted is NOT supported for chat participants.");this.value=typeof e=="string"?new Ti(e):e,this.vulnerabilities=t}},hu=class{constructor(e,t){this.participant=e,this.command=t}};class sg{constructor(e,t){this.value=e,this.baseUri=t}}let og=class{constructor(e,t){this.value=e,this.title=t}},Za=class{constructor(e){this.value=e}},ag=class{constructor(e){this.value=e}},Wr=class{constructor(e,t){this.value=e,this.iconPath=t}},fu=class{constructor(e,t){this.uri=e,this.edits=Array.isArray(t)?t:[t]}};class UC{constructor(e,t,i,n){this.prompt=e,this.command=t,this.variables=i,this.participant=n}}class BC{constructor(e,t,i,n){this.response=e,this.result=t,this.participant=i,this.command=n}}var Ls;(function(r){r[r.Panel=1]="Panel",r[r.Terminal=2]="Terminal",r[r.Notebook=3]="Notebook",r[r.Editor=4]="Editor"})(Ls||(Ls={}));class yf{constructor(e){this.content=e}}class xf{constructor(e,t){this.content=e,this.name=t}}class Cf{constructor(e,t){this.content=e,this.name=t}}class bn extends Error{static NotFound(e){return new bn(e,bn.NotFound.name)}static NoPermissions(e){return new bn(e,bn.NoPermissions.name)}constructor(e,t,i){super(e,{cause:i}),this.name="LanguageModelError",this.code=t??""}}var j1;(function(r){r[r.SymbolInformation=1]="SymbolInformation",r[r.CommandInformation=2]="CommandInformation",r[r.SearchInformation=3]="SearchInformation",r[r.SettingInformation=4]="SettingInformation"})(j1||(j1={}));var q1;(function(r){r[r.Started=1]="Started",r[r.Recognizing=2]="Recognizing",r[r.Recognized=3]="Recognized",r[r.Stopped=4]="Stopped",r[r.Error=5]="Error"})(q1||(q1={}));var G1;(function(r){r[r.Recognized=1]="Recognized",r[r.Stopped=2]="Stopped"})(G1||(G1={}));class UI{constructor(e,t){this.text=e,this.range=t}}var pu;(function(r){r[r.Invoke=0]="Invoke",r[r.Automatic=1]="Automatic"})(pu||(pu={}));var Fi;(function(r){function e(i){const{selectionStartLineNumber:n,selectionStartColumn:s,positionLineNumber:o,positionColumn:a}=i,c=new ke(n-1,s-1),l=new ke(o-1,a-1);return new sr(c,l)}r.to=e;function t(i){const{anchor:n,active:s}=i;return{selectionStartLineNumber:n.line+1,selectionStartColumn:n.character+1,positionLineNumber:s.line+1,positionColumn:s.character+1}}r.from=t})(Fi||(Fi={}));var H;(function(r){function e(i){if(!i)return;const{start:n,end:s}=i;return{startLineNumber:n.line+1,startColumn:n.character+1,endLineNumber:s.line+1,endColumn:s.character+1}}r.from=e;function t(i){if(!i)return;const{startLineNumber:n,startColumn:s,endLineNumber:o,endColumn:a}=i;return new xe(n-1,s-1,o-1,a-1)}r.to=t})(H||(H={}));var so;(function(r){function e(i){return{uri:i.uri,range:H.from(i.range)}}r.from=e;function t(i){return new Pi(x.revive(i.uri),H.to(i.range))}r.to=t})(so||(so={}));var Q1;(function(r){function e(t){switch(t){case 1:return Nr.Comment;case 0:return Nr.Other;case 3:return Nr.RegEx;case 2:return Nr.String}}r.to=e})(Q1||(Q1={}));var qe;(function(r){function e(i){return new ke(i.lineNumber-1,i.column-1)}r.to=e;function t(i){return{lineNumber:i.line+1,column:i.character+1}}r.from=t})(qe||(qe={}));var Ya;(function(r){function e(n,s,o){return ci($a(n).map(a=>t(a,s,o)))}r.from=e;function t(n,s,o){if(typeof n=="string")return{$serialized:!0,language:n,isBuiltin:o==null?void 0:o.isBuiltin};if(n)return{$serialized:!0,language:n.language,scheme:i(n.scheme,s),pattern:mi.from(n.pattern)??void 0,exclusive:n.exclusive,notebookType:n.notebookType,isBuiltin:o==null?void 0:o.isBuiltin}}function i(n,s){return s&&typeof n=="string"?s.transformOutgoingScheme(n):n}})(Ya||(Ya={}));var Sf;(function(r){function e(i){switch(i){case Ds.Unnecessary:return 1;case Ds.Deprecated:return 2}}r.from=e;function t(i){switch(i){case 1:return Ds.Unnecessary;case 2:return Ds.Deprecated;default:return}}r.to=t})(Sf||(Sf={}));var ec;(function(r){function e(i){let n;return i.code&&($e(i.code)||Br(i.code)?n=String(i.code):n={value:String(i.code.value),target:i.code.target}),{...H.from(i.range),message:i.message,source:i.source,code:n,severity:kf.from(i.severity),relatedInformation:i.relatedInformation&&i.relatedInformation.map(Ef.from),tags:Array.isArray(i.tags)?ci(i.tags.map(Sf.from)):void 0}}r.from=e;function t(i){var s;const n=new Oh(H.to(i),i.message,kf.to(i.severity));return n.source=i.source,n.code=$e(i.code)?i.code:(s=i.code)==null?void 0:s.value,n.relatedInformation=i.relatedInformation&&i.relatedInformation.map(Ef.to),n.tags=i.tags&&ci(i.tags.map(Sf.to)),n}r.to=t})(ec||(ec={}));var Ef;(function(r){function e(i){return{...H.from(i.location.range),message:i.message,resource:i.location.uri}}r.from=e;function t(i){return new Ul(new Pi(i.resource,H.to(i)),i.message)}r.to=t})(Ef||(Ef={}));var kf;(function(r){function e(i){switch(i){case Ft.Error:return oi.Error;case Ft.Warning:return oi.Warning;case Ft.Information:return oi.Info;case Ft.Hint:return oi.Hint}return oi.Error}r.from=e;function t(i){switch(i){case oi.Info:return Ft.Information;case oi.Warning:return Ft.Warning;case oi.Error:return Ft.Error;case oi.Hint:return Ft.Hint;default:return Ft.Error}}r.to=t})(kf||(kf={}));var Et;(function(r){function e(i){return typeof i=="number"&&i>=Ql.One?i-1:i===Ql.Beside?gI:pI}r.from=e;function t(i){if(typeof i=="number"&&i>=0)return i+1;throw new Error("invalid 'EditorGroupColumn'")}r.to=t})(Et||(Et={}));function BI(r){return typeof r.range<"u"}function VC(r){return r.length===0?!0:!!BI(r[0])}var Le;(function(r){function e(a){return a.map(r.from)}r.fromMany=e;function t(a){return a&&typeof a=="object"&&typeof a.language=="string"&&typeof a.value=="string"}function i(a){let c;if(t(a)){const{language:f,value:m}=a;c={value:"```"+f+`
`+m+"\n```\n"}}else Ti.isMarkdownString(a)?c={value:a.value,isTrusted:a.isTrusted,supportThemeIcons:a.supportThemeIcons,supportHtml:a.supportHtml,baseUri:a.baseUri}:typeof a=="string"?c={value:a}:c={value:""};const l=Object.create(null);c.uris=l;const u=f=>{try{let m=x.parse(f,!0);m=m.with({query:n(m.query,l)}),l[f]=m}catch{}return""},d=new hb.Renderer;return d.link=u,d.image=f=>typeof f=="string"?u(Ik(f).href):"",hb(c.value,{renderer:d}),c}r.from=i;function n(a,c){if(!a)return a;let l;try{l=v5(a)}catch{}if(!l)return a;let u=!1;return l=bh(l,d=>{if(x.isUri(d)){const f=`__uri_${Math.random().toString(16).slice(2,8)}`;return c[f]=d,u=!0,f}else return}),u?JSON.stringify(l):a}function s(a){const c=new Ti(a.value,a.supportThemeIcons);return c.isTrusted=a.isTrusted,c.supportHtml=a.supportHtml,c.baseUri=a.baseUri?x.from(a.baseUri):void 0,c}r.to=s;function o(a){if(a)return typeof a=="string"?a:r.from(a)}r.fromStrict=o})(Le||(Le={}));function VI(r){return VC(r)?r.map(e=>({range:H.from(e.range),hoverMessage:Array.isArray(e.hoverMessage)?Le.fromMany(e.hoverMessage):e.hoverMessage?Le.from(e.hoverMessage):void 0,renderOptions:e.renderOptions})):r.map(e=>({range:H.from(e)}))}function cg(r){return typeof r>"u"?r:typeof r=="string"?x.file(r):r}var tc;(function(r){function e(t){return typeof t>"u"?t:{contentText:t.contentText,contentIconPath:t.contentIconPath?cg(t.contentIconPath):void 0,border:t.border,borderColor:t.borderColor,fontStyle:t.fontStyle,fontWeight:t.fontWeight,textDecoration:t.textDecoration,color:t.color,backgroundColor:t.backgroundColor,margin:t.margin,width:t.width,height:t.height}}r.from=e})(tc||(tc={}));var Df;(function(r){function e(t){return typeof t>"u"?t:{backgroundColor:t.backgroundColor,outline:t.outline,outlineColor:t.outlineColor,outlineStyle:t.outlineStyle,outlineWidth:t.outlineWidth,border:t.border,borderColor:t.borderColor,borderRadius:t.borderRadius,borderSpacing:t.borderSpacing,borderStyle:t.borderStyle,borderWidth:t.borderWidth,fontStyle:t.fontStyle,fontWeight:t.fontWeight,textDecoration:t.textDecoration,cursor:t.cursor,color:t.color,opacity:t.opacity,letterSpacing:t.letterSpacing,gutterIconPath:t.gutterIconPath?cg(t.gutterIconPath):void 0,gutterIconSize:t.gutterIconSize,overviewRulerColor:t.overviewRulerColor,before:t.before?tc.from(t.before):void 0,after:t.after?tc.from(t.after):void 0}}r.from=e})(Df||(Df={}));var J1;(function(r){function e(t){if(typeof t>"u")return t;switch(t){case Ps.OpenOpen:return 0;case Ps.ClosedClosed:return 1;case Ps.OpenClosed:return 2;case Ps.ClosedOpen:return 3}}r.from=e})(J1||(J1={}));var K1;(function(r){function e(t){return{isWholeLine:t.isWholeLine,rangeBehavior:t.rangeBehavior?J1.from(t.rangeBehavior):void 0,overviewRulerLane:t.overviewRulerLane,light:t.light?Df.from(t.light):void 0,dark:t.dark?Df.from(t.dark):void 0,backgroundColor:t.backgroundColor,outline:t.outline,outlineColor:t.outlineColor,outlineStyle:t.outlineStyle,outlineWidth:t.outlineWidth,border:t.border,borderColor:t.borderColor,borderRadius:t.borderRadius,borderSpacing:t.borderSpacing,borderStyle:t.borderStyle,borderWidth:t.borderWidth,fontStyle:t.fontStyle,fontWeight:t.fontWeight,textDecoration:t.textDecoration,cursor:t.cursor,color:t.color,opacity:t.opacity,letterSpacing:t.letterSpacing,gutterIconPath:t.gutterIconPath?cg(t.gutterIconPath):void 0,gutterIconSize:t.gutterIconSize,overviewRulerColor:t.overviewRulerColor,before:t.before?tc.from(t.before):void 0,after:t.after?tc.from(t.after):void 0}}r.from=e})(K1||(K1={}));var yt;(function(r){function e(i){return{text:i.newText,eol:i.newEol&&rc.from(i.newEol),range:H.from(i.range)}}r.from=e;function t(i){const n=new Xr(H.to(i.range),i.text);return n.newEol=typeof i.eol>"u"?void 0:rc.to(i.eol),n}r.to=t})(yt||(yt={}));var Wt;(function(r){function e(i,n){var o;const s={edits:[]};if(i instanceof Zr){const a=new ux;for(const c of i._allEntries())c._type===1&&x.isUri(c.to)&&c.from===void 0&&a.add(c.to);for(const c of i._allEntries())if(c._type===1){let l;(o=c.options)!=null&&o.contents&&(ArrayBuffer.isView(c.options.contents)?l={type:"base64",value:px(_e.wrap(c.options.contents))}:l={type:"dataTransferItem",id:c.options.contents._itemId}),s.edits.push({oldResource:c.from,newResource:c.to,options:{...c.options,contents:l},metadata:c.metadata})}else c._type===2?s.edits.push({resource:c.uri,textEdit:yt.from(c.edit),versionId:a.has(c.uri)||n==null?void 0:n.getTextDocumentVersion(c.uri),metadata:c.metadata}):c._type===6?s.edits.push({resource:c.uri,textEdit:{range:H.from(c.range),text:c.edit.value,insertAsSnippet:!0},versionId:a.has(c.uri)||n==null?void 0:n.getTextDocumentVersion(c.uri),metadata:c.metadata}):c._type===3?s.edits.push({metadata:c.metadata,resource:c.uri,cellEdit:c.edit,notebookMetadata:c.notebookMetadata,notebookVersionId:n==null?void 0:n.getNotebookDocumentVersion(c.uri)}):c._type===5&&s.edits.push({metadata:c.metadata,resource:c.uri,notebookVersionId:n==null?void 0:n.getNotebookDocumentVersion(c.uri),cellEdit:{editType:1,index:c.index,count:c.count,cells:c.cells.map(wu.from)}})}return s}r.from=e;function t(i){const n=new Zr,s=new Pt;for(const o of i.edits)if(o.textEdit){const a=o,c=x.revive(a.resource),l=H.to(a.textEdit.range),u=a.textEdit.text,d=a.textEdit.insertAsSnippet;let f;d?f=to.replace(l,new go(u)):f=Xr.replace(l,u);const m=s.get(c);m?m.push(f):s.set(c,[f])}else n.renameFile(x.revive(o.oldResource),x.revive(o.newResource),o.options);for(const[o,a]of s)n.set(o,a);return n}r.to=t})(Wt||(Wt={}));var Oi;(function(r){const e=Object.create(null);e[Ke.File]=0,e[Ke.Module]=1,e[Ke.Namespace]=2,e[Ke.Package]=3,e[Ke.Class]=4,e[Ke.Method]=5,e[Ke.Property]=6,e[Ke.Field]=7,e[Ke.Constructor]=8,e[Ke.Enum]=9,e[Ke.Interface]=10,e[Ke.Function]=11,e[Ke.Variable]=12,e[Ke.Constant]=13,e[Ke.String]=14,e[Ke.Number]=15,e[Ke.Boolean]=16,e[Ke.Array]=17,e[Ke.Object]=18,e[Ke.Key]=19,e[Ke.Null]=20,e[Ke.EnumMember]=21,e[Ke.Struct]=22,e[Ke.Event]=23,e[Ke.Operator]=24,e[Ke.TypeParameter]=25;function t(n){return typeof e[n]=="number"?e[n]:6}r.from=t;function i(n){for(const s in e)if(e[s]===n)return Number(s);return Ke.Property}r.to=i})(Oi||(Oi={}));var or;(function(r){function e(i){switch(i){case Vl.Deprecated:return 1}}r.from=e;function t(i){switch(i){case 1:return Vl.Deprecated}}r.to=t})(or||(or={}));var gu;(function(r){function e(i){return{name:i.name,kind:Oi.from(i.kind),tags:i.tags&&i.tags.map(or.from),containerName:i.containerName,location:Ai.from(i.location)}}r.from=e;function t(i){const n=new Wl(i.name,Oi.to(i.kind),i.containerName,Ai.to(i.location));return n.tags=i.tags&&i.tags.map(or.to),n}r.to=t})(gu||(gu={}));var X1;(function(r){function e(i){var s;const n={name:i.name||"!!MISSING: name!!",detail:i.detail,range:H.from(i.range),selectionRange:H.from(i.selectionRange),kind:Oi.from(i.kind),tags:((s=i.tags)==null?void 0:s.map(or.from))??[]};return i.children&&(n.children=i.children.map(e)),n}r.from=e;function t(i){const n=new zl(i.name,i.detail,Oi.to(i.kind),H.to(i.range),H.to(i.selectionRange));return Zu(i.tags)&&(n.tags=i.tags.map(or.to)),i.children&&(n.children=i.children.map(t)),n}r.to=t})(X1||(X1={}));var _o;(function(r){function e(i){const n=new Mw(Oi.to(i.kind),i.name,i.detail||"",x.revive(i.uri),H.to(i.range),H.to(i.selectionRange));return n._sessionId=i._sessionId,n._itemId=i._itemId,n}r.to=e;function t(i,n,s){var o;if(n=n??i._sessionId,s=s??i._itemId,n===void 0||s===void 0)throw new Error("invalid item");return{_sessionId:n,_itemId:s,name:i.name,detail:i.detail,kind:Oi.from(i.kind),uri:i.uri,range:H.from(i.range),selectionRange:H.from(i.selectionRange),tags:(o=i.tags)==null?void 0:o.map(or.from)}}r.from=t})(_o||(_o={}));var Z1;(function(r){function e(t){return new SC(_o.to(t.from),t.fromRanges.map(i=>H.to(i)))}r.to=e})(Z1||(Z1={}));var Y1;(function(r){function e(t){return new EC(_o.to(t.to),t.fromRanges.map(i=>H.to(i)))}r.to=e})(Y1||(Y1={}));var Ai;(function(r){function e(i){return{range:i.range&&H.from(i.range),uri:i.uri}}r.from=e;function t(i){return new Pi(x.revive(i.uri),H.to(i.range))}r.to=t})(Ai||(Ai={}));var mu;(function(r){function e(i){const n=i,s=i;return{originSelectionRange:n.originSelectionRange?H.from(n.originSelectionRange):void 0,uri:n.targetUri?n.targetUri:s.uri,range:H.from(n.targetRange?n.targetRange:s.range),targetSelectionRange:n.targetSelectionRange?H.from(n.targetSelectionRange):void 0}}r.from=e;function t(i){return{targetUri:x.revive(i.uri),targetRange:H.to(i.range),targetSelectionRange:i.targetSelectionRange?H.to(i.targetSelectionRange):void 0,originSelectionRange:i.originSelectionRange?H.to(i.originSelectionRange):void 0}}r.to=t})(mu||(mu={}));var If;(function(r){function e(i){return{range:H.from(i.range),contents:Le.fromMany(i.contents),canIncreaseVerbosity:i.canIncreaseVerbosity,canDecreaseVerbosity:i.canDecreaseVerbosity}}r.from=e;function t(i){const n=i.contents.map(Le.to),s=H.to(i.range),o=i.canIncreaseVerbosity,a=i.canDecreaseVerbosity;return new Uh(n,s,o,a)}r.to=t})(If||(If={}));var ev;(function(r){function e(i){return{range:H.from(i.range),expression:i.expression}}r.from=e;function t(i){return new cf(H.to(i.range),i.expression)}r.to=t})(ev||(ev={}));var Pf;(function(r){function e(i){if(i instanceof lf)return{type:"text",range:H.from(i.range),text:i.text};if(i instanceof uf)return{type:"variable",range:H.from(i.range),variableName:i.variableName,caseSensitiveLookup:i.caseSensitiveLookup};if(i instanceof df)return{type:"expression",range:H.from(i.range),expression:i.expression};throw new Error("Unknown 'InlineValue' type")}r.from=e;function t(i){switch(i.type){case"text":return{range:H.to(i.range),text:i.text};case"variable":return{range:H.to(i.range),variableName:i.variableName,caseSensitiveLookup:i.caseSensitiveLookup};case"expression":return{range:H.to(i.range),expression:i.expression}}}r.to=t})(Pf||(Pf={}));var Tf;(function(r){function e(i){return{frameId:i.frameId,stoppedLocation:H.from(i.stoppedLocation)}}r.from=e;function t(i){return new D1(i.frameId,H.to(i.stoppedLocation))}r.to=t})(Tf||(Tf={}));var ic;(function(r){function e(i){return{range:H.from(i.range),kind:i.kind}}r.from=e;function t(i){return new Bh(H.to(i.range),i.kind)}r.to=t})(ic||(ic={}));var tv;(function(r){function e(i){return{uri:i.uri,highlights:i.highlights.map(ic.from)}}r.from=e;function t(i){return new Vh(x.revive(i.uri),i.highlights.map(ic.to))}r.to=t})(tv||(tv={}));var iv;(function(r){function e(t){switch(t){case 1:return ca.TriggerCharacter;case 2:return ca.TriggerForIncompleteCompletions;case 0:default:return ca.Invoke}}r.to=e})(iv||(iv={}));var nv;(function(r){function e(t){return{triggerKind:iv.to(t.triggerKind),triggerCharacter:t.triggerCharacter}}r.to=e})(nv||(nv={}));var Af;(function(r){function e(i){switch(i){case Gl.Deprecated:return 1}}r.from=e;function t(i){switch(i){case 1:return Gl.Deprecated}}r.to=t})(Af||(Af={}));var Rf;(function(r){const e=new Map([[pe.Method,0],[pe.Function,1],[pe.Constructor,2],[pe.Field,3],[pe.Variable,4],[pe.Class,5],[pe.Interface,7],[pe.Struct,6],[pe.Module,8],[pe.Property,9],[pe.Unit,12],[pe.Value,13],[pe.Constant,14],[pe.Enum,15],[pe.EnumMember,16],[pe.Keyword,17],[pe.Snippet,27],[pe.Text,18],[pe.Color,19],[pe.File,20],[pe.Reference,21],[pe.Folder,23],[pe.Event,10],[pe.Operator,11],[pe.TypeParameter,24],[pe.Issue,26],[pe.User,25]]);function t(s){return e.get(s)??9}r.from=t;const i=new Map([[0,pe.Method],[1,pe.Function],[2,pe.Constructor],[3,pe.Field],[4,pe.Variable],[5,pe.Class],[7,pe.Interface],[6,pe.Struct],[8,pe.Module],[9,pe.Property],[12,pe.Unit],[13,pe.Value],[14,pe.Constant],[15,pe.Enum],[16,pe.EnumMember],[17,pe.Keyword],[27,pe.Snippet],[18,pe.Text],[19,pe.Color],[20,pe.File],[21,pe.Reference],[23,pe.Folder],[10,pe.Event],[11,pe.Operator],[24,pe.TypeParameter],[25,pe.User],[26,pe.Issue]]);function n(s){return i.get(s)??pe.Property}r.to=n})(Rf||(Rf={}));var rv;(function(r){function e(t,i){var s;const n=new Gh(t.label);return n.insertText=t.insertText,n.kind=Rf.to(t.kind),n.tags=(s=t.tags)==null?void 0:s.map(Af.to),n.detail=t.detail,n.documentation=bo(t.documentation)?Le.to(t.documentation):t.documentation,n.sortText=t.sortText,n.filterText=t.filterText,n.preselect=t.preselect,n.commitCharacters=t.commitCharacters,Qe.isIRange(t.range)?n.range=H.to(t.range):typeof t.range=="object"&&(n.range={inserting:H.to(t.range.insert),replacing:H.to(t.range.replace)}),n.keepWhitespace=typeof t.insertTextRules>"u"?!1:!!(t.insertTextRules&1),typeof t.insertTextRules<"u"&&t.insertTextRules&4?n.insertText=new go(t.insertText):(n.insertText=t.insertText,n.textEdit=n.range instanceof xe?new Xr(n.range,n.insertText):void 0),t.additionalTextEdits&&t.additionalTextEdits.length>0&&(n.additionalTextEdits=t.additionalTextEdits.map(o=>yt.to(o))),n.command=i&&t.command?i.fromInternal(t.command):void 0,n}r.to=e})(rv||(rv={}));var Lf;(function(r){function e(i){if(typeof i.label!="string"&&!Array.isArray(i.label))throw new TypeError("Invalid label");return{label:i.label,documentation:Le.fromStrict(i.documentation)}}r.from=e;function t(i){return{label:i.label,documentation:bo(i.documentation)?Le.to(i.documentation):i.documentation}}r.to=t})(Lf||(Lf={}));var $f;(function(r){function e(i){return{label:i.label,documentation:Le.fromStrict(i.documentation),parameters:Array.isArray(i.parameters)?i.parameters.map(Lf.from):[],activeParameter:i.activeParameter}}r.from=e;function t(i){return{label:i.label,documentation:bo(i.documentation)?Le.to(i.documentation):i.documentation,parameters:Array.isArray(i.parameters)?i.parameters.map(Lf.to):[],activeParameter:i.activeParameter}}r.to=t})($f||($f={}));var vu;(function(r){function e(i){return{activeSignature:i.activeSignature,activeParameter:i.activeParameter,signatures:Array.isArray(i.signatures)?i.signatures.map($f.from):[]}}r.from=e;function t(i){return{activeSignature:i.activeSignature,activeParameter:i.activeParameter,signatures:Array.isArray(i.signatures)?i.signatures.map($f.to):[]}}r.to=t})(vu||(vu={}));var sv;(function(r){function e(t,i){const n=new qh(qe.to(i.position),typeof i.label=="string"?i.label:i.label.map(ov.to.bind(void 0,t)),i.kind&&Nf.to(i.kind));return n.textEdits=i.textEdits&&i.textEdits.map(yt.to),n.tooltip=bo(i.tooltip)?Le.to(i.tooltip):i.tooltip,n.paddingLeft=i.paddingLeft,n.paddingRight=i.paddingRight,n}r.to=e})(sv||(sv={}));var ov;(function(r){function e(t,i){const n=new jh(i.label);return n.tooltip=bo(i.tooltip)?Le.to(i.tooltip):i.tooltip,Qm.is(i.command)&&(n.command=t.fromInternal(i.command)),i.location&&(n.location=Ai.to(i.location)),n}r.to=e})(ov||(ov={}));var Nf;(function(r){function e(i){return i}r.from=e;function t(i){return i}r.to=t})(Nf||(Nf={}));var oo;(function(r){function e(i){return{range:H.from(i.range),url:i.target,tooltip:i.tooltip}}r.from=e;function t(i){let n;if(i.url)try{n=typeof i.url=="string"?x.parse(i.url,!0):x.revive(i.url)}catch{}return new Jh(H.to(i.range),n)}r.to=t})(oo||(oo={}));var Mf;(function(r){function e(i){const n=new Xh(i.label);return i.textEdit&&(n.textEdit=yt.to(i.textEdit)),i.additionalTextEdits&&(n.additionalTextEdits=i.additionalTextEdits.map(s=>yt.to(s))),n}r.to=e;function t(i){return{label:i.label,textEdit:i.textEdit?yt.from(i.textEdit):void 0,additionalTextEdits:i.additionalTextEdits?i.additionalTextEdits.map(n=>yt.from(n)):void 0}}r.from=t})(Mf||(Mf={}));var nc;(function(r){function e(i){return new qa(i[0],i[1],i[2],i[3])}r.to=e;function t(i){return[i.red,i.green,i.blue,i.alpha]}r.from=t})(nc||(nc={}));var av;(function(r){function e(i){return{range:H.from(i.range)}}r.from=e;function t(i){return new ql(H.to(i.range))}r.to=t})(av||(av={}));var Ff;(function(r){function e(t){switch(t){case 2:return la.AfterDelay;case 1:return la.Manual;case 3:case 4:return la.FocusOut}}r.to=e})(Ff||(Ff={}));var ma;(function(r){function e(i){switch(i){case qi.Off:return 0;case qi.Relative:return 2;case qi.Interval:return 3;case qi.On:default:return 1}}r.from=e;function t(i){switch(i){case 0:return qi.Off;case 2:return qi.Relative;case 3:return qi.Interval;case 1:default:return qi.On}}r.to=t})(ma||(ma={}));var rc;(function(r){function e(i){if(i===Zi.CRLF)return 1;if(i===Zi.LF)return 0}r.from=e;function t(i){if(i===1)return Zi.CRLF;if(i===0)return Zi.LF}r.to=t})(rc||(rc={}));var cv;(function(r){function e(t){if(typeof t=="object")return t.viewId;switch(t){case io.SourceControl:return 3;case io.Window:return 10;case io.Notification:return 15}throw new Error("Unknown 'ProgressLocation'")}r.from=e})(cv||(cv={}));var Of;(function(r){function e(i){const n={start:i.start+1,end:i.end+1};return i.kind&&(n.kind=Hf.from(i.kind)),n}r.from=e;function t(i){const n={start:i.start-1,end:i.end-1};return i.kind&&(n.kind=Hf.to(i.kind)),n}r.to=t})(Of||(Of={}));var Hf;(function(r){function e(i){if(i)switch(i){case On.Comment:return Mo.Comment;case On.Imports:return Mo.Imports;case On.Region:return Mo.Region}}r.from=e;function t(i){if(i)switch(i.value){case Mo.Comment.value:return On.Comment;case Mo.Imports.value:return On.Imports;case Mo.Region.value:return On.Region}}r.to=t})(Hf||(Hf={}));var dl;(function(r){function e(t){if(t)return{pinned:typeof t.preview=="boolean"?!t.preview:void 0,inactive:t.background,preserveFocus:t.preserveFocus,selection:typeof t.selection=="object"?H.from(t.selection):void 0,override:typeof t.override=="boolean"?H5.id:void 0}}r.from=e})(dl||(dl={}));var mi;(function(r){function e(s){return s instanceof da?s.toJSON():typeof s=="string"?s:t(s)||i(s)?new da(s.baseUri??s.base,s.pattern).toJSON():s}r.from=e;function t(s){const o=s;return o?x.isUri(o.baseUri)&&typeof o.pattern=="string":!1}function i(s){const o=s;return o?typeof o.base=="string"&&typeof o.pattern=="string":!1}function n(s){return typeof s=="string"?s:new da(x.revive(s.baseUri),s.pattern)}r.to=n})(mi||(mi={}));var lv;(function(r){function e(t){if(t){if(Array.isArray(t))return t.map(e);if(typeof t=="string")return t;{const i=t;return{language:i.language,scheme:i.scheme,pattern:mi.from(i.pattern),exclusive:i.exclusive,notebookType:i.notebookType}}}else return}r.from=e})(lv||(lv={}));var Uf;(function(r){function e(i){return!!i&&typeof i=="object"&&"documents"in i&&Array.isArray(i.documents)&&i.documents.every(n=>Array.isArray(n)&&n.every(s=>s&&typeof s=="object"&&"uri"in s&&x.isUri(s.uri)&&"version"in s&&typeof s.version=="number"&&"ranges"in s&&Array.isArray(s.ranges)&&s.ranges.every(o=>o instanceof xe)))}r.is=e;function t(i){return{documents:i.documents.map(n=>n.map(s=>({uri:x.from(s.uri),version:s.version,ranges:s.ranges.map(o=>H.from(o))})))}}r.from=t})(Uf||(Uf={}));var Cn;(function(r){function e(i){return{start:i.start,end:i.end}}r.from=e;function t(i){return new Kn(i.start,i.end)}r.to=t})(Cn||(Cn={}));var sc;(function(r){function e(i){return{timing:typeof i.runStartTime=="number"&&typeof i.runEndTime=="number"?{startTime:i.runStartTime,endTime:i.runEndTime}:void 0,executionOrder:i.executionOrder,success:i.lastRunSuccess}}r.to=e;function t(i){var n,s;return{lastRunSuccess:i.success,runStartTime:(n=i.timing)==null?void 0:n.startTime,runEndTime:(s=i.timing)==null?void 0:s.endTime,executionOrder:i.executionOrder}}r.from=t})(sc||(sc={}));var uv;(function(r){function e(t){if(t===ul.Unconfirmed)return Xa.Pending;if(t===ul.Pending)return;if(t===ul.Executing)return Xa.Executing;throw new Error(`Unknown state: ${t}`)}r.to=e})(uv||(uv={}));var _u;(function(r){function e(i){switch(i){case Rs.Markup:return qo.Markup;case Rs.Code:default:return qo.Code}}r.from=e;function t(i){switch(i){case qo.Markup:return Rs.Markup;case qo.Code:default:return Rs.Code}}r.to=t})(_u||(_u={}));var br;(function(r){function e(i){const n={metadata:i.metadata??Object.create(null),cells:[]};for(const s of i.cells)ng.validate(s),n.cells.push(wu.from(s));return n}r.from=e;function t(i){const n=new AC(i.cells.map(wu.to));return IE(i.metadata)||(n.metadata=i.metadata),n}r.to=t})(br||(br={}));var wu;(function(r){function e(i){return{cellKind:_u.from(i.kind),language:i.languageId,mime:i.mime,source:i.value,metadata:i.metadata,internalMetadata:sc.from(i.executionSummary??{}),outputs:i.outputs?i.outputs.map(Yr.from):[]}}r.from=e;function t(i){return new ng(_u.to(i.cellKind),i.source,i.language,i.mime,i.outputs?i.outputs.map(Yr.to):void 0,i.metadata,i.internalMetadata?sc.to(i.internalMetadata):void 0)}r.to=t})(wu||(wu={}));var oc;(function(r){function e(i){return{mime:i.mime,valueBytes:_e.wrap(i.data)}}r.from=e;function t(i){return new RC(i.valueBytes.buffer,i.mime)}r.to=t})(oc||(oc={}));var Yr;(function(r){function e(i){return{outputId:i.id,items:i.items.map(oc.from),metadata:i.metadata}}r.from=e;function t(i){const n=i.items.map(oc.to);return new pf(n,i.outputId,i.metadata)}r.to=t})(Yr||(Yr={}));var Bf;(function(r){function e(n){return i(n)?{include:mi.from(n.include)??void 0,exclude:mi.from(n.exclude)??void 0}:mi.from(n)??void 0}r.from=e;function t(n){return i(n)?{include:mi.to(n.include),exclude:mi.to(n.exclude)}:mi.to(n)}r.to=t;function i(n){const s=n;return s?!Qt(s.include)&&!Qt(s.exclude):!1}})(Bf||(Bf={}));var dv;(function(r){function e(t,i,n){const s=typeof t.command=="string"?{title:"",command:t.command}:t.command;return{alignment:t.alignment===gf.Left?1:2,command:i.toInternal(s,n),text:t.text,tooltip:t.tooltip,accessibilityInformation:t.accessibilityInformation,priority:t.priority}}r.from=e})(dv||(dv={}));var hv;(function(r){function e(t,i,n){const s=typeof t.command=="string"?{title:"",command:t.command}:t.command;return{command:i.toInternal(s,n),label:t.label,description:t.description,detail:t.detail,documentation:t.documentation}}r.from=e})(hv||(hv={}));var fv;(function(r){function e(t){return{transientOutputs:(t==null?void 0:t.transientOutputs)??!1,transientCellMetadata:(t==null?void 0:t.transientCellMetadata)??{},transientDocumentMetadata:(t==null?void 0:t.transientDocumentMetadata)??{},cellContentMetadata:(t==null?void 0:t.cellContentMetadata)??{}}}r.from=e})(fv||(fv={}));var Vf;(function(r){function e(i){return{uri:i.uri,provides:i.provides}}r.from=e;function t(i){return new LC(x.revive(i.uri),i.provides)}r.to=t})(Vf||(Vf={}));var ac;(function(r){function e(i){return{message:Le.fromStrict(i.message)||"",type:0,expected:i.expectedOutput,actual:i.actualOutput,contextValue:i.contextValue,location:i.location&&{range:H.from(i.location.range),uri:i.location.uri}}}r.from=e;function t(i){const n=new wf(typeof i.message=="string"?i.message:Le.to(i.message));return n.actualOutput=i.actual,n.expectedOutput=i.expected,n.contextValue=i.contextValue,n.location=i.location?Ai.to(i.location):void 0,n}r.to=t})(ac||(ac={}));var on;(function(r){r.namespace=Qd,r.denamespace=cC})(on||(on={}));var es;(function(r){function e(i){const n=Xp(i).controllerId;return{extId:ye.fromExtHostTestItem(i,n).toString(),label:i.label,uri:x.revive(i.uri),busy:i.busy,tags:i.tags.map(s=>on.namespace(n,s.id)),range:Qe.lift(H.from(i.range)),description:i.description||null,sortText:i.sortText||null,error:i.error&&Le.fromStrict(i.error)||null}}r.from=e;function t(i){return{parent:void 0,error:void 0,id:ye.fromString(i.extId).localId,label:i.label,uri:x.revive(i.uri),tags:(i.tags||[]).map(n=>{const{tagId:s}=on.denamespace(n);return new lu(s)}),children:{add:()=>{},delete:()=>{},forEach:()=>{},*[Symbol.iterator](){},get:()=>{},replace:()=>{},size:0},range:H.to(i.range||void 0),canResolveChildren:!1,busy:i.busy,description:i.description||void 0,sortText:i.sortText||void 0}}r.toPlain=t})(es||(es={}));(function(r){function e(i){return{id:i.id}}r.from=e;function t(i){return new lu(i.id)}r.to=t})(on||(on={}));var pv;(function(r){const e=(i,n)=>{const s=i.value;if(!s)return;const o={...es.toPlain(s.item),parent:n,taskStates:s.tasks.map(a=>({state:a.state,duration:a.duration,messages:a.messages.filter(c=>c.type===0).map(ac.to)})),children:[]};if(i.children)for(const a of i.children.values()){const c=e(a,o);c&&o.children.push(c)}return o};function t(i){const n=new w5;for(const a of i.items)n.insert(ye.fromString(a.item.extId).path,a);const s=[n.nodes],o=[];for(;s.length;)for(const a of s.pop())a.value?o.push(a):a.children&&s.push(a.children.values());return{completedAt:i.completedAt,results:o.map(a=>e(a)).filter(ks)}}r.to=t})(pv||(pv={}));var Wf;(function(r){function e(s){return{covered:s.covered,total:s.total}}function t(s){return"line"in s?qe.from(s):H.from(s)}function i(s){if(typeof s.executed=="number"&&s.executed<0)throw new Error(`Invalid coverage count ${s.executed}`);return"branches"in s?{count:s.executed,location:t(s.location),type:1,branches:s.branches.length?s.branches.map(o=>({count:o.executed,location:o.location&&t(o.location),label:o.label})):void 0}:{type:0,name:s.name,count:s.executed,location:t(s.location)}}r.fromDetails=i;function n(s,o){return nh(o.statementCoverage),nh(o.branchCoverage),nh(o.declarationCoverage),{id:s,uri:o.uri,statement:e(o.statementCoverage),branch:o.branchCoverage&&e(o.branchCoverage),declaration:o.declarationCoverage&&e(o.declarationCoverage)}}r.fromFile=n})(Wf||(Wf={}));var gv;(function(r){function e(t){switch(t){case 1:return jl.Invoke;case 2:return jl.Automatic}}r.to=e})(gv||(gv={}));var ao;(function(r){function e(i){const n=new Uw(Oi.to(i.kind),i.name,i.detail||"",x.revive(i.uri),H.to(i.range),H.to(i.selectionRange));return n._sessionId=i._sessionId,n._itemId=i._itemId,n}r.to=e;function t(i,n,s){var o;if(n=n??i._sessionId,s=s??i._itemId,n===void 0||s===void 0)throw new Error("invalid item");return{_sessionId:n,_itemId:s,kind:Oi.from(i.kind),name:i.name,detail:i.detail??"",uri:i.uri,range:H.from(i.range),selectionRange:H.from(i.selectionRange),tags:(o=i.tags)==null?void 0:o.map(or.from)}}r.from=t})(ao||(ao={}));var zf;(function(r){function e(t){if(t)return{value:t.value,tooltip:t.tooltip}}r.from=e})(zf||(zf={}));var jf;(function(r){function e(s,o,a){const c=o.fileData;return c?new EI(new kI(c.name,x.revive(c.uri),c.id,mw(()=>a(c.id)))):s===er.uriList&&o.uriListData?new nf(n(o.uriListData)):new nf(o.asString)}r.to=e;async function t(s,o){const a=await o.asString();if(s===er.uriList)return{asString:a,fileData:void 0,uriListData:i(a)};const c=o.asFile();return{asString:a,fileData:c?{name:c.name,uri:c.uri,id:c._itemId??c.id}:void 0}}r.from=t;function i(s){return zm.split(s).map(o=>{if(o.startsWith("#"))return o;try{return x.parse(o)}catch{}return o})}function n(s){return zm.create(s.map(o=>typeof o=="string"?o:x.revive(o)))}})(jf||(jf={}));var zr;(function(r){function e(i,n){const s=i.items.map(([o,a])=>[o,jf.to(o,a,n)]);return new Xl(s)}r.toDataTransfer=e;async function t(i){const n={items:[]},s=[];for(const[o,a]of i)s.push((async()=>{n.items.push([o,await jf.from(o,a)])})());return await Promise.all(s),n}r.from=t})(zr||(zr={}));var bu;(function(r){function e(i,n){return{kind:"reply",agentId:i.participant??(n==null?void 0:n.agentId)??"",subCommand:i.command??(n==null?void 0:n.command),message:i.prompt,title:i.label}}r.from=e;function t(i){return{prompt:i.message,label:i.title,participant:i.agentId,command:i.subCommand}}r.to=t})(bu||(bu={}));var mv;(function(r){function e(t){return"commandId"in t?{kind:"command",title:t.title??"",commandId:t.commandId??"",when:t.when??"",args:t.args}:{kind:"reply",message:t.message,title:t.title,tooltip:t.tooltip}}r.from=e})(mv||(mv={}));var hl;(function(r){function e(i){switch(i.role){case 0:return new yf(i.content);case 1:return new xf(i.content);case 2:return new Cf(i.content)}}r.to=e;function t(i){if(i instanceof yf)return{role:0,content:i.content};if(i instanceof xf)return{role:1,content:i.content};if(i instanceof Cf)return{role:2,content:i.content};throw new Error("Invalid LanguageModelMessage")}r.from=t})(hl||(hl={}));var cc;(function(r){function e(n){const s={};for(const o of Object.keys(n))s[o]=n[o].map(r.to);return s}r.objectTo=e;function t(n){return{level:qf.to(n.level),kind:n.kind,value:Cx(n.value)?x.revive(n.value):n.value,description:n.description}}r.to=t;function i(n){return{level:qf.from(n.level),kind:n.kind,value:n.value,description:n.description}}r.from=i})(cc||(cc={}));var qf;(function(r){function e(i){switch(i){case"short":return Hn.Short;case"medium":return Hn.Medium;case"full":default:return Hn.Full}}r.to=e;function t(i){switch(i){case Hn.Short:return"short";case Hn.Medium:return"medium";case Hn.Full:default:return"full"}}r.from=t})(qf||(qf={}));var vv;(function(r){function e(t){switch(t){case 1:return Cr.Helpful;case 0:return Cr.Unhelpful;case 2:return Cr.Undone;case 3:return Cr.Accepted;case 4:return Cr.Bug}}r.to=e})(vv||(vv={}));var yu;(function(r){function e(i){return{kind:"markdownContent",content:Le.from(i.value)}}r.from=e;function t(i){return new rg(Le.to(i.content))}r.to=t})(yu||(yu={}));var Gf;(function(r){function e(i){return{kind:"markdownVuln",content:Le.from(i.value),vulnerabilities:i.vulnerabilities}}r.from=e;function t(i){return new du(Le.to(i.content),i.vulnerabilities)}r.to=t})(Gf||(Gf={}));var Qf;(function(r){function e(i){return{kind:"agentDetection",agentId:i.participant,command:i.command}}r.from=e;function t(i){return new hu(i.agentId,i.command)}r.to=t})(Qf||(Qf={}));var xu;(function(r){function e(i){const{value:n,baseUri:s}=i;function o(a,c){return a.map(l=>{const u=x.joinPath(c,l.name);return{label:l.name,uri:u,children:l.children&&o(l.children,u)}})}return{kind:"treeData",treeData:{label:_c(s),uri:s,children:o(n,s)}}}r.from=e;function t(i){const n=En(i.treeData);function s(c){return c.map(l=>({name:l.label,children:l.children&&s(l.children)}))}const o=n.uri,a=n.children?s(n.children):[];return new sg(a,o)}r.to=t})(xu||(xu={}));var Cu;(function(r){function e(i){return{kind:"inlineReference",name:i.title,inlineReference:x.isUri(i.value)?i.value:so.from(i.value)}}r.from=e;function t(i){const n=En(i);return new og(x.isUri(n.inlineReference)?n.inlineReference:so.to(n.inlineReference),i.name)}r.to=t})(Cu||(Cu={}));var lc;(function(r){function e(i){return{kind:"progressMessage",content:Le.from(i.value)}}r.from=e;function t(i){return new Za(i.content.value)}r.to=t})(lc||(lc={}));var Su;(function(r){function e(i,n,s){return{kind:"command",command:n.toInternal(i.value,s)??{command:i.value.command,title:i.value.title}}}r.from=e;function t(i,n){return new ag(n.fromInternal(i.command)??{command:i.command.id,title:i.command.title})}r.to=t})(Su||(Su={}));var Jf;(function(r){function e(i){return{kind:"textEdit",uri:i.uri,edits:i.edits.map(n=>yt.from(n))}}r.from=e;function t(i){return new fu(x.revive(i.uri),i.edits.map(n=>yt.to(n)))}r.to=t})(Jf||(Jf={}));var ts;(function(r){function e(i){const n=Jt.isThemeIcon(i.iconPath)?i.iconPath:void 0;return"variableName"in i.value?{kind:"reference",reference:{variableName:i.value.variableName,value:x.isUri(i.value.value)||!i.value.value?i.value.value:so.from(i.value.value)},iconPath:n}:{kind:"reference",reference:x.isUri(i.value)?i.value:so.from(i.value),iconPath:n}}r.from=e;function t(i){const n=En(i),s=o=>x.isUri(o)?o:so.to(o);return new Wr("variableName"in n.reference?{variableName:n.reference.variableName,value:n.reference.value&&s(n.reference.value)}:s(n.reference))}r.to=t})(ts||(ts={}));var Kf;(function(r){function e(n,s,o){return n instanceof rg?yu.from(n):n instanceof og?Cu.from(n):n instanceof Wr?ts.from(n):n instanceof Za?lc.from(n):n instanceof sg?xu.from(n):n instanceof ag?Su.from(n,s,o):n instanceof fu?Jf.from(n):n instanceof du?Gf.from(n):n instanceof hu?Qf.from(n):{kind:"markdownContent",content:Le.from("")}}r.from=e;function t(n,s){switch(n.kind){case"reference":return ts.to(n);case"markdownContent":case"inlineReference":case"progressMessage":case"treeData":case"command":return i(n,s)}}r.to=t;function i(n,s){switch(n.kind){case"markdownContent":return yu.to(n);case"inlineReference":return Cu.to(n);case"progressMessage":return;case"treeData":return xu.to(n);case"command":return Su.to(n,s)}}r.toContent=i})(Kf||(Kf={}));var _v;(function(r){function e(t){return{prompt:t.message,command:t.command,attempt:t.attempt??0,enableCommandDetection:t.enableCommandDetection??!0,variables:t.variables.variables.map(Xf.to),location:Eu.to(t.location)}}r.to=e})(_v||(_v={}));var Eu;(function(r){function e(t){switch(t){case Lr.Notebook:return Ls.Notebook;case Lr.Terminal:return Ls.Terminal;case Lr.Panel:return Ls.Panel;case Lr.Editor:return Ls.Editor}}r.to=e})(Eu||(Eu={}));var Xf;(function(r){function e(t){return{name:t.name,range:t.range&&[t.range.start,t.range.endExclusive],values:t.values.map(cc.to)}}r.to=e})(Xf||(Xf={}));var wv;(function(r){function e(t,i,n){return{label:t.label,values:t.values.map(cc.from),insertText:t.insertText,detail:t.detail,documentation:t.documentation,command:i.toInternal(t.command,n)}}r.from=e})(wv||(wv={}));var va;(function(r){function e(t){return{errorDetails:t.errorDetails,metadata:t.metadata}}r.to=e})(va||(va={}));var bv;(function(r){function e(t,i,n){if(i.action.kind==="vote")return;const s=va.to(t);if(i.action.kind==="command"){const o=i.action.commandButton.command;return{action:{kind:"command",commandButton:{command:n.fromInternal(o)??{command:o.id,title:o.title}}},result:s}}else return i.action.kind==="followUp"?{action:{kind:"followUp",followup:bu.to(i.action.followup)},result:s}:i.action.kind==="inlineChat"?{action:{kind:"editor",accepted:i.action.action==="accepted"},result:s}:{action:i.action,result:s}}r.to=e})(bv||(bv={}));var Zf;(function(r){function e(t,i,n){return"terminalCommand"in t?{terminalCommand:t.terminalCommand,shouldExecute:t.shouldExecute}:"uri"in t?{uri:t.uri}:i.toInternal(t,n)}r.from=e})(Zf||(Zf={}));var yv;(function(r){function e(t){return{kind:xv.to(t.kind)}}r.to=e})(yv||(yv={}));var xv;(function(r){function e(t){switch(t){case 0:return Is.Word;case 1:return Is.Line;case 2:return Is.Suggest;default:return Is.Unknown}}r.to=e})(xv||(xv={}));var Cv;(function(r){function e(t,i){return{id:i,label:t.label,description:t.description,canEdit:t.canEdit,collapsibleState:t.collapsibleState||0,contextValue:t.contextValue}}r.from=e})(Cv||(Cv={}));var Sv;(function(r){r[r.Information=1]="Information",r[r.Warning=2]="Warning"})(Sv||(Sv={}));const WC="⟪ ",zC=" characters skipped ⟫",WI=(WC.length+zC.length+5)*2;function zI(r){return!!r.preview}class jI{constructor(e,t,i,n){this.ranges=t,this.webviewIndex=n;const s=Array.isArray(t)?t:[t];if(i&&i.matchLines===1&&qI(s)){e=CE(e,i.matchLines);let o="",a=0,c=0;const l=Math.floor(i.charsPerLine/5),u=[];for(const d of s){const f=Math.max(d.startColumn-l,0),m=d.startColumn+i.charsPerLine;if(f>c+l+WI){const b=WC+(f-c)+zC;o+=b+e.slice(f,m),a+=f-(c+b.length)}else o+=e.slice(c,m);u.push(new GI(0,d.startColumn-a,d.endColumn-a)),c=m}this.preview={text:o,matches:Array.isArray(this.ranges)?u:u[0]}}else{const o=Array.isArray(t)?t[0].startLineNumber:t.startLineNumber;this.preview={text:e,matches:Pl(t,a=>new jC(a.startLineNumber-o,a.startColumn,a.endLineNumber-o,a.endColumn))}}}}function qI(r){const e=r[0].startLineNumber;for(const t of r)if(t.startLineNumber!==e||t.endLineNumber!==e)return!1;return!0}class jC{constructor(e,t,i,n){this.startLineNumber=e,this.startColumn=t,this.endLineNumber=i,this.endColumn=n}}class GI extends jC{constructor(e,t,i){super(e,t,e,i)}}function QI(r,e=!0){const t=r&&r.files&&r.files.exclude,i=e&&r&&r.search&&r.search.exclude;if(!t&&!i)return;if(!t||!i)return t||i;let n=Object.create(null);return n=po(n,ot(t)),n=po(n,ot(i),!0),n}function wy(r,e){return r.excludePattern&&ll(r.excludePattern,e)?!1:r.includePattern||r.usingSearchPaths?r.includePattern&&ll(r.includePattern,e)?!0:r.usingSearchPaths?!!r.folderQueries&&r.folderQueries.some(t=>{const i=t.folder.fsPath;if(_h(e,i)){const n=Rl(i,e);return!t.includePattern||!!ll(t.includePattern,n)}else return!1}):!1:!0}var by;(function(r){r[r.unknownEncoding=1]="unknownEncoding",r[r.regexParseError=2]="regexParseError",r[r.globParseError=3]="globParseError",r[r.invalidLiteral=4]="invalidLiteral",r[r.rgProcessError=5]="rgProcessError",r[r.other=6]="other",r[r.canceled=7]="canceled"})(by||(by={}));function Yf(r,e){const t={...r||{},...e||{}};return Object.keys(t).filter(i=>{const n=t[i];return typeof n=="boolean"&&n})}class qC{constructor(e,t){this._parsedIncludeExpression=null,this._excludeExpression={...e.excludePattern||{},...t.excludePattern||{}},this._parsedExcludeExpression=Va(this._excludeExpression);let i=e.includePattern;t.includePattern&&(i?i={...i,...t.includePattern}:i=t.includePattern),i&&(this._parsedIncludeExpression=Va(i))}matchesExcludesSync(e,t,i){return!!(this._parsedExcludeExpression&&this._parsedExcludeExpression(e,t,i))}includedInQuerySync(e,t,i){return!(this._parsedExcludeExpression&&this._parsedExcludeExpression(e,t,i)||this._parsedIncludeExpression&&!this._parsedIncludeExpression(e,t,i))}includedInQuery(e,t,i){const n=this._parsedExcludeExpression(e,t,i),s=()=>this._parsedIncludeExpression?!!this._parsedIncludeExpression(e,t,i):!0;return Jr(n)?n.then(o=>o?!1:s()):s()}hasSiblingExcludeClauses(){return JI(this._excludeExpression)}}function JI(r){for(const e in r)if(typeof r[e]!="boolean")return!0;return!1}function KI(r){if(!r)return;let e;return t=>(e||(e=(r()||Promise.resolve([])).then(i=>i?GC(i):{})),e.then(i=>!!i[t]))}function XI(r){if(!r)return;let e;return t=>{if(!e){const i=r();e=i?GC(i):{}}return!!e[t]}}function GC(r){const e={};for(const t of r)e[t]=!0;return e}const ZI="vs/workbench/api/common/extHostWorkspace";function ku(r,e,t){return new td(i=>jw(i,t)).isEqual(r,e)}function YI(r,e,t){return ku(r.uri,e.uri,t)?0:fo(r.uri.toString(),e.uri.toString())}function e7(r,e,t){return r.index!==e.index?r.index<e.index?-1:1:ku(r.uri,e.uri,t)?fo(r.name,e.name):fo(r.uri.toString(),e.uri.toString())}function QC(r,e,t,i){const n=r.slice(0).sort((o,a)=>t(o,a,i)),s=e.slice(0).sort((o,a)=>t(o,a,i));return KS(n,s,(o,a)=>t(o,a,i))}function jw(r,e){const t=e.getCapabilities(r.scheme);return!(t&&t&1024)}class _a extends vk{static toExtHostWorkspace(e,t,i,n){if(!e)return{workspace:null,added:[],removed:[]};const{id:s,name:o,folders:a,configuration:c,transient:l,isUntitled:u}=e,d=[],f=t;t?a.forEach((v,k)=>{const D=x.revive(v.uri),E=_a._findFolder(i||t,D,n);E?(E.name=v.name,E.index=v.index,d.push(E)):d.push({uri:D,name:v.name,index:k})}):d.push(...a.map(({uri:v,name:k,index:D})=>({uri:x.revive(v),name:k,index:D}))),d.sort((v,k)=>v.index<k.index?-1:1);const m=new _a(s,o,d,!!l,c?x.revive(c):null,!!u,v=>jw(v,n)),{added:b,removed:_}=QC(f?f.workspaceFolders:[],m.workspaceFolders,YI,n);return{workspace:m,added:b,removed:_}}static _findFolder(e,t,i){for(let n=0;n<e.folders.length;n++){const s=e.workspaceFolders[n];if(ku(s.uri,t,i))return s}}constructor(e,t,i,n,s,o,a){super(e,i.map(c=>new qx(c)),n,s,a),this._name=t,this._isUntitled=o,this._workspaceFolders=[],this._structure=Gn.forUris(a),i.forEach(c=>{this._workspaceFolders.push(c),this._structure.set(c.uri,c)})}get name(){return this._name}get isUntitled(){return this._isUntitled}get workspaceFolders(){return this._workspaceFolders.slice(0)}getWorkspaceFolder(e,t){return t&&this._structure.get(e)&&(e=Sw(e)),this._structure.findSubstr(e)}resolveWorkspaceFolder(e){return this._structure.get(e)}}let Ev=class{constructor(e,t,i,n,s){this._onDidChangeWorkspace=new R,this.onDidChangeWorkspace=this._onDidChangeWorkspace.event,this._onDidGrantWorkspaceTrust=new R,this.onDidGrantWorkspaceTrust=this._onDidGrantWorkspaceTrust.event,this._activeSearchCallbacks=[],this._trusted=!1,this._editSessionIdentityProviders=new Map,this._providerHandlePool=0,this._onWillCreateEditSessionIdentityEvent=new il,this._canonicalUriProviders=new Map,this._logService=n,this._extHostFileSystemInfo=i,this._uriTransformerService=s,this._requestIdProvider=new gk,this._barrier=new Ki,this._proxy=e.getProxy(J.MainThreadWorkspace),this._messageService=e.getProxy(J.MainThreadMessageService);const o=t.workspace;this._confirmedWorkspace=o?new _a(o.id,o.name,[],!!o.transient,o.configuration?x.revive(o.configuration):null,!!o.isUntitled,a=>jw(a,i)):void 0}$initializeWorkspace(e,t){this._trusted=t,this.$acceptWorkspaceData(e),this._barrier.open()}waitForInitializeCall(){return this._barrier.wait()}get workspace(){return this._actualWorkspace}get name(){return this._actualWorkspace?this._actualWorkspace.name:void 0}get workspaceFile(){if(this._actualWorkspace&&this._actualWorkspace.configuration)return this._actualWorkspace.isUntitled?x.from({scheme:ne.untitled,path:_c(Sw(this._actualWorkspace.configuration))}):this._actualWorkspace.configuration}get _actualWorkspace(){return this._unconfirmedWorkspace||this._confirmedWorkspace}getWorkspaceFolders(){if(this._actualWorkspace)return this._actualWorkspace.workspaceFolders.slice(0)}async getWorkspaceFolders2(){if(await this._barrier.wait(),!!this._actualWorkspace)return this._actualWorkspace.workspaceFolders.slice(0)}updateWorkspaceFolders(e,t,i,...n){const s=[];if(Array.isArray(n)&&n.forEach(u=>{x.isUri(u.uri)&&!s.some(d=>ku(d.uri,u.uri,this._extHostFileSystemInfo))&&s.push({uri:u.uri,name:u.name||Mm(u.uri)})}),this._unconfirmedWorkspace||[t,i].some(u=>typeof u!="number"||u<0)||i===0&&s.length===0)return!1;const o=this._actualWorkspace?this._actualWorkspace.workspaceFolders:[];if(t+i>o.length)return!1;const a=o.slice(0);a.splice(t,i,...s.map(u=>({uri:u.uri,name:u.name||Mm(u.uri),index:void 0})));for(let u=0;u<a.length;u++){const d=a[u];if(a.some((f,m)=>m!==u&&ku(d.uri,f.uri,this._extHostFileSystemInfo)))return!1}a.forEach((u,d)=>u.index=d);const{added:c,removed:l}=QC(o,a,e7,this._extHostFileSystemInfo);if(c.length===0&&l.length===0)return!1;if(this._proxy){const u=e.displayName||e.name;this._proxy.$updateWorkspaceFolders(u,t,i,s).then(void 0,d=>{this._unconfirmedWorkspace=void 0;const f={source:{identifier:e.identifier,label:e.displayName||e.name}};this._messageService.$showMessage(vt.Error,h(ZI,0,"Extension '{0}' failed to update workspace folders: {1}",u,d.toString()),f,[])})}return this.trySetWorkspaceFolders(a),!0}getWorkspaceFolder(e,t){if(this._actualWorkspace)return this._actualWorkspace.getWorkspaceFolder(e,t)}async getWorkspaceFolder2(e,t){if(await this._barrier.wait(),!!this._actualWorkspace)return this._actualWorkspace.getWorkspaceFolder(e,t)}async resolveWorkspaceFolder(e){if(await this._barrier.wait(),!!this._actualWorkspace)return this._actualWorkspace.resolveWorkspaceFolder(e)}getPath(){if(!this._actualWorkspace)return;const{folders:e}=this._actualWorkspace;if(e.length!==0)return e[0].uri.fsPath}getRelativePath(e,t){let i,n="";if(typeof e=="string"?(i=x.file(e),n=e):typeof e<"u"&&(i=e,n=e.fsPath),!i)return n;const s=this.getWorkspaceFolder(i,!0);if(!s)return n;typeof t>"u"&&this._actualWorkspace&&(t=this._actualWorkspace.folders.length>1);let o=Ox(s.uri,i);return t&&s.name&&(o=`${s.name}/${o}`),o}trySetWorkspaceFolders(e){this._actualWorkspace&&(this._unconfirmedWorkspace=_a.toExtHostWorkspace({id:this._actualWorkspace.id,name:this._actualWorkspace.name,configuration:this._actualWorkspace.configuration,folders:e,isUntitled:this._actualWorkspace.isUntitled},this._actualWorkspace,void 0,this._extHostFileSystemInfo).workspace||void 0)}$acceptWorkspaceData(e){const{workspace:t,added:i,removed:n}=_a.toExtHostWorkspace(e,this._confirmedWorkspace,this._unconfirmedWorkspace,this._extHostFileSystemInfo);this._confirmedWorkspace=t||void 0,this._unconfirmedWorkspace=void 0,this._onDidChangeWorkspace.fire(Object.freeze({added:i,removed:n}))}findFiles(e,t,i,n,s=bt.None){this._logService.trace(`extHostWorkspace#findFiles: fileSearch, extension: ${n.value}, entryPoint: findFiles`);let o="",a=!0;return t===null?a=!1:t!==void 0&&(typeof t=="string"?o=t:o=t.pattern),this._findFilesImpl(e,void 0,{exclude:o,maxResults:i,useDefaultExcludes:a,useDefaultSearchExcludes:!1,useIgnoreFiles:!1},s)}findFiles2(e,t={},i,n=bt.None){return this._logService.trace(`extHostWorkspace#findFiles2: fileSearch, extension: ${i.value}, entryPoint: findFiles2`),this._findFilesImpl(void 0,e,t,n)}async _findFilesImpl(e,t,i,n=bt.None){if(n&&n.isCancellationRequested)return Promise.resolve([]);const s=typeof i.exclude=="string"?i.exclude:i.exclude?i.exclude.pattern:void 0,o={ignoreSymlinks:typeof i.followSymlinks=="boolean"?!i.followSymlinks:void 0,disregardIgnoreFiles:typeof i.useIgnoreFiles=="boolean"?!i.useIgnoreFiles:void 0,disregardGlobalIgnoreFiles:typeof i.useGlobalIgnoreFiles=="boolean"?!i.useGlobalIgnoreFiles:void 0,disregardParentIgnoreFiles:typeof i.useParentIgnoreFiles=="boolean"?!i.useParentIgnoreFiles:void 0,disregardExcludeSettings:typeof i.useDefaultExcludes=="boolean"?!i.useDefaultExcludes:!1,disregardSearchExcludeSettings:typeof i.useDefaultSearchExcludes=="boolean"?!i.useDefaultSearchExcludes:!1,maxResults:i.maxResults,excludePattern:s,shouldGlobSearch:typeof i.fuzzy=="boolean"?!i.fuzzy:!0,_reason:"startFileSearch"};let a;if(e){const{includePattern:c,folder:l}=Zg(mi.from(e));a=l,o.includePattern=c}else{const{includePattern:c,folder:l}=Zg(mi.from(t));a=l,o.filePattern=c}return this._proxy.$startFileSearch(a??null,o,n).then(c=>Array.isArray(c)?c.map(l=>x.revive(l)):[])}async findTextInFiles(e,t,i,n,s=bt.None){this._logService.trace(`extHostWorkspace#findTextInFiles: textSearch, extension: ${n.value}, entryPoint: findTextInFiles`);const o=this._requestIdProvider.getNext(),a=typeof t.previewOptions>"u"?{matchLines:100,charsPerLine:1e4}:t.previewOptions,{includePattern:c,folder:l}=Zg(mi.from(t.include)),u=typeof t.exclude=="string"?t.exclude:t.exclude?t.exclude.pattern:void 0,d={ignoreSymlinks:typeof t.followSymlinks=="boolean"?!t.followSymlinks:void 0,disregardIgnoreFiles:typeof t.useIgnoreFiles=="boolean"?!t.useIgnoreFiles:void 0,disregardGlobalIgnoreFiles:typeof t.useGlobalIgnoreFiles=="boolean"?!t.useGlobalIgnoreFiles:void 0,disregardParentIgnoreFiles:typeof t.useParentIgnoreFiles=="boolean"?!t.useParentIgnoreFiles:void 0,disregardExcludeSettings:typeof t.useDefaultExcludes=="boolean"?!t.useDefaultExcludes:!0,fileEncoding:t.encoding,maxResults:t.maxResults,previewOptions:a,afterContext:t.afterContext,beforeContext:t.beforeContext,includePattern:c,excludePattern:u};if(this._activeSearchCallbacks[o]=f=>{const m=x.revive(f.resource);f.results.forEach(b=>{const _=En(b);zI(_)?i({uri:m,preview:{text:_.preview.text,matches:Pl(_.preview.matches,v=>new xe(v.startLineNumber,v.startColumn,v.endLineNumber,v.endColumn))},ranges:Pl(_.ranges,v=>new xe(v.startLineNumber,v.startColumn,v.endLineNumber,v.endColumn))}):i({uri:m,text:_.text,lineNumber:_.lineNumber})})},s.isCancellationRequested)return{};try{const f=await this._proxy.$startTextSearch(e,l??null,d,o,s);return delete this._activeSearchCallbacks[o],f||{}}catch(f){throw delete this._activeSearchCallbacks[o],f}}$handleTextSearchResult(e,t){var i,n;(n=(i=this._activeSearchCallbacks)[t])==null||n.call(i,e)}async save(e){const t=await this._proxy.$save(e,{saveAs:!1});return x.revive(t)}async saveAs(e){const t=await this._proxy.$save(e,{saveAs:!0});return x.revive(t)}saveAll(e){return this._proxy.$saveAll(e)}resolveProxy(e){return this._proxy.$resolveProxy(e)}loadCertificates(){return this._proxy.$loadCertificates()}get trusted(){return this._trusted}requestWorkspaceTrust(e){return this._proxy.$requestWorkspaceTrust(e)}$onDidGrantWorkspaceTrust(){this._trusted||(this._trusted=!0,this._onDidGrantWorkspaceTrust.fire())}registerEditSessionIdentityProvider(e,t){if(this._editSessionIdentityProviders.has(e))throw new Error(`A provider has already been registered for scheme ${e}`);this._editSessionIdentityProviders.set(e,t);const i=this._uriTransformerService.transformOutgoingScheme(e),n=this._providerHandlePool++;return this._proxy.$registerEditSessionIdentityProvider(n,i),De(()=>{this._editSessionIdentityProviders.delete(e),this._proxy.$unregisterEditSessionIdentityProvider(n)})}async $getEditSessionIdentifier(e,t){this._logService.info("Getting edit session identifier for workspaceFolder",e);const i=await this.resolveWorkspaceFolder(x.revive(e));if(!i){this._logService.warn("Unable to resolve workspace folder");return}this._logService.info("Invoking #provideEditSessionIdentity for workspaceFolder",i);const n=this._editSessionIdentityProviders.get(i.uri.scheme);if(this._logService.info(`Provider for scheme ${i.uri.scheme} is defined: `,!!n),!n)return;const s=await n.provideEditSessionIdentity(i,t);if(this._logService.info("Provider returned edit session identifier: ",s),!!s)return s}async $provideEditSessionIdentityMatch(e,t,i,n){var c;this._logService.info("Getting edit session identifier for workspaceFolder",e);const s=await this.resolveWorkspaceFolder(x.revive(e));if(!s){this._logService.warn("Unable to resolve workspace folder");return}this._logService.info("Invoking #provideEditSessionIdentity for workspaceFolder",s);const o=this._editSessionIdentityProviders.get(s.uri.scheme);if(this._logService.info(`Provider for scheme ${s.uri.scheme} is defined: `,!!o),!o)return;const a=await((c=o.provideEditSessionIdentityMatch)==null?void 0:c.call(o,t,i,n));if(this._logService.info("Provider returned edit session identifier match result: ",a),!!a)return a}getOnWillCreateEditSessionIdentityEvent(e){return(t,i,n)=>{const s=function(a){t.call(i,a)};return s.extension=e,this._onWillCreateEditSessionIdentityEvent.event(s,void 0,n)}}async $onWillCreateEditSessionIdentity(e,t,i){const n=await this.resolveWorkspaceFolder(x.revive(e));if(n===void 0)throw new Error("Unable to resolve workspace folder");await this._onWillCreateEditSessionIdentityEvent.fireAsync({workspaceFolder:n},t,async(s,o)=>{const a=Date.now();await Promise.resolve(s),Date.now()-a>i&&this._logService.warn("SLOW edit session create-participant",o.extension.identifier)}),t.isCancellationRequested}registerCanonicalUriProvider(e,t){if(this._canonicalUriProviders.has(e))throw new Error(`A provider has already been registered for scheme ${e}`);this._canonicalUriProviders.set(e,t);const i=this._uriTransformerService.transformOutgoingScheme(e),n=this._providerHandlePool++;return this._proxy.$registerCanonicalUriProvider(n,i),De(()=>{this._canonicalUriProviders.delete(e),this._proxy.$unregisterCanonicalUriProvider(n)})}async provideCanonicalUri(e,t,i){var o;const n=this._canonicalUriProviders.get(e.scheme);if(!n)return;const s=await((o=n.provideCanonicalUri)==null?void 0:o.call(n,x.revive(e),t,i));if(s)return s}async $provideCanonicalUri(e,t,i){return this.provideCanonicalUri(x.revive(e),{targetScheme:t},i)}};Ev=U([M(0,Ve),M(1,jt),M(2,xc),M(3,Je),M(4,Jp)],Ev);const cr=Ce("IExtHostWorkspace");function Zg(r){let e,t;return r&&(typeof r=="string"?e=r:(e=r.pattern,t=x.revive(r.baseUri))),{includePattern:e,folder:t}}var kv;(function(r){r.DEFAULT={allowTrailingComma:!0}})(kv||(kv={}));function t7(r,e=!1){let t=0;const i=r.length;let n="",s=0,o=16,a=0;function c(_){let v=0,k=0;for(;v<_;){const D=r.charCodeAt(t);if(D>=48&&D<=57)k=k*16+D-48;else if(D>=65&&D<=70)k=k*16+D-65+10;else if(D>=97&&D<=102)k=k*16+D-97+10;else break;t++,v++}return v<_&&(k=-1),k}function l(_){t=_,n="",s=0,o=16,a=0}function u(){const _=t;if(r.charCodeAt(t)===48)t++;else for(t++;t<r.length&&Oo(r.charCodeAt(t));)t++;if(t<r.length&&r.charCodeAt(t)===46)if(t++,t<r.length&&Oo(r.charCodeAt(t)))for(t++;t<r.length&&Oo(r.charCodeAt(t));)t++;else return a=3,r.substring(_,t);let v=t;if(t<r.length&&(r.charCodeAt(t)===69||r.charCodeAt(t)===101))if(t++,(t<r.length&&r.charCodeAt(t)===43||r.charCodeAt(t)===45)&&t++,t<r.length&&Oo(r.charCodeAt(t))){for(t++;t<r.length&&Oo(r.charCodeAt(t));)t++;v=t}else a=3;return r.substring(_,v)}function d(){let _="",v=t;for(;;){if(t>=i){_+=r.substring(v,t),a=2;break}const k=r.charCodeAt(t);if(k===34){_+=r.substring(v,t),t++;break}if(k===92){if(_+=r.substring(v,t),t++,t>=i){a=2;break}switch(r.charCodeAt(t++)){case 34:_+='"';break;case 92:_+="\\";break;case 47:_+="/";break;case 98:_+="\b";break;case 102:_+="\f";break;case 110:_+=`
`;break;case 114:_+="\r";break;case 116:_+="	";break;case 117:{const E=c(4);E>=0?_+=String.fromCharCode(E):a=4;break}default:a=5}v=t;continue}if(k>=0&&k<=31)if(Rd(k)){_+=r.substring(v,t),a=2;break}else a=6;t++}return _}function f(){if(n="",a=0,s=t,t>=i)return s=i,o=17;let _=r.charCodeAt(t);if(Yg(_)){do t++,n+=String.fromCharCode(_),_=r.charCodeAt(t);while(Yg(_));return o=15}if(Rd(_))return t++,n+=String.fromCharCode(_),_===13&&r.charCodeAt(t)===10&&(t++,n+=`
`),o=14;switch(_){case 123:return t++,o=1;case 125:return t++,o=2;case 91:return t++,o=3;case 93:return t++,o=4;case 58:return t++,o=6;case 44:return t++,o=5;case 34:return t++,n=d(),o=10;case 47:{const v=t-1;if(r.charCodeAt(t+1)===47){for(t+=2;t<i&&!Rd(r.charCodeAt(t));)t++;return n=r.substring(v,t),o=12}if(r.charCodeAt(t+1)===42){t+=2;const k=i-1;let D=!1;for(;t<k;){if(r.charCodeAt(t)===42&&r.charCodeAt(t+1)===47){t+=2,D=!0;break}t++}return D||(t++,a=1),n=r.substring(v,t),o=13}return n+=String.fromCharCode(_),t++,o=16}case 45:if(n+=String.fromCharCode(_),t++,t===i||!Oo(r.charCodeAt(t)))return o=16;case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return n+=u(),o=11;default:for(;t<i&&m(_);)t++,_=r.charCodeAt(t);if(s!==t){switch(n=r.substring(s,t),n){case"true":return o=8;case"false":return o=9;case"null":return o=7}return o=16}return n+=String.fromCharCode(_),t++,o=16}}function m(_){if(Yg(_)||Rd(_))return!1;switch(_){case 125:case 93:case 123:case 91:case 34:case 58:case 44:case 47:return!1}return!0}function b(){let _;do _=f();while(_>=12&&_<=15);return _}return{setPosition:l,getPosition:()=>t,scan:e?b:f,getToken:()=>o,getTokenValue:()=>n,getTokenOffset:()=>s,getTokenLength:()=>t-s,getTokenError:()=>a}}function Yg(r){return r===32||r===9||r===11||r===12||r===160||r===5760||r>=8192&&r<=8203||r===8239||r===8287||r===12288||r===65279}function Rd(r){return r===10||r===13||r===8232||r===8233}function Oo(r){return r>=48&&r<=57}function i7(r,e,t=kv.DEFAULT){const i=t7(r,!1);function n(q){return q?()=>q(i.getTokenOffset(),i.getTokenLength()):()=>!0}function s(q){return q?We=>q(We,i.getTokenOffset(),i.getTokenLength()):()=>!0}const o=n(e.onObjectBegin),a=s(e.onObjectProperty),c=n(e.onObjectEnd),l=n(e.onArrayBegin),u=n(e.onArrayEnd),d=s(e.onLiteralValue),f=s(e.onSeparator),m=n(e.onComment),b=s(e.onError),_=t&&t.disallowComments,v=t&&t.allowTrailingComma;function k(){for(;;){const q=i.scan();switch(i.getTokenError()){case 4:D(14);break;case 5:D(15);break;case 3:D(13);break;case 1:_||D(11);break;case 2:D(12);break;case 6:D(16);break}switch(q){case 12:case 13:_?D(10):m();break;case 16:D(1);break;case 15:case 14:break;default:return q}}}function D(q,We=[],V=[]){if(b(q),We.length+V.length>0){let B=i.getToken();for(;B!==17;){if(We.indexOf(B)!==-1){k();break}else if(V.indexOf(B)!==-1)break;B=k()}}}function E(q){const We=i.getTokenValue();return q?d(We):a(We),k(),!0}function N(){switch(i.getToken()){case 11:{let q=0;try{q=JSON.parse(i.getTokenValue()),typeof q!="number"&&(D(2),q=0)}catch{D(2)}d(q);break}case 7:d(null);break;case 8:d(!0);break;case 9:d(!1);break;default:return!1}return k(),!0}function A(){return i.getToken()!==10?(D(3,[],[2,5]),!1):(E(!1),i.getToken()===6?(f(":"),k(),te()||D(4,[],[2,5])):D(5,[],[2,5]),!0)}function j(){o(),k();let q=!1;for(;i.getToken()!==2&&i.getToken()!==17;){if(i.getToken()===5){if(q||D(4,[],[]),f(","),k(),i.getToken()===2&&v)break}else q&&D(6,[],[]);A()||D(4,[],[2,5]),q=!0}return c(),i.getToken()!==2?D(7,[2],[]):k(),!0}function re(){l(),k();let q=!1;for(;i.getToken()!==4&&i.getToken()!==17;){if(i.getToken()===5){if(q||D(4,[],[]),f(","),k(),i.getToken()===4&&v)break}else q&&D(6,[],[]);te()||D(4,[],[4,5]),q=!0}return u(),i.getToken()!==4?D(8,[4],[]):k(),!0}function te(){switch(i.getToken()){case 3:return re();case 1:return j();case 10:return E(!0);default:return N()}}return k(),i.getToken()===17?t.allowEmptyContent?!0:(D(4,[],[]),!1):te()?(i.getToken()!==17&&D(9,[],[]),!0):(D(4,[],[]),!1)}function Kc(r){return Object.isFrozen(r)?r:zx(r)}class ki{static createEmptyModel(e){return new ki({},[],[],void 0,e)}constructor(e,t,i,n,s){this._contents=e,this._keys=t,this._overrides=i,this.raw=n,this.logService=s,this.overrideConfigurations=new Map}get rawConfiguration(){var e;if(!this._rawConfiguration)if((e=this.raw)!=null&&e.length){const t=this.raw.map(i=>{if(i instanceof ki)return i;const n=new n7("",this.logService);return n.parseRaw(i),n.configurationModel});this._rawConfiguration=t.reduce((i,n)=>n===i?n:i.merge(n),t[0])}else this._rawConfiguration=this;return this._rawConfiguration}get contents(){return this._contents}get overrides(){return this._overrides}get keys(){return this._keys}isEmpty(){return this._keys.length===0&&Object.keys(this._contents).length===0&&this._overrides.length===0}getValue(e){return e?Mh(this.contents,e):this.contents}inspect(e,t){const i=this;return{get value(){return Kc(i.rawConfiguration.getValue(e))},get override(){return t?Kc(i.rawConfiguration.getOverrideValue(e,t)):void 0},get merged(){return Kc(t?i.rawConfiguration.override(t).getValue(e):i.rawConfiguration.getValue(e))},get overrides(){const n=[];for(const{contents:s,identifiers:o,keys:a}of i.rawConfiguration.overrides){const c=new ki(s,a,[],void 0,i.logService).getValue(e);c!==void 0&&n.push({identifiers:o,value:c})}return n.length?Kc(n):void 0}}}getOverrideValue(e,t){const i=this.getContentsForOverrideIdentifer(t);return i?e?Mh(i,e):i:void 0}getKeysForOverrideIdentifier(e){const t=[];for(const i of this.overrides)i.identifiers.includes(e)&&t.push(...i.keys);return Wo(t)}getAllOverrideIdentifiers(){const e=[];for(const t of this.overrides)e.push(...t.identifiers);return Wo(e)}override(e){let t=this.overrideConfigurations.get(e);return t||(t=this.createOverrideConfigurationModel(e),this.overrideConfigurations.set(e,t)),t}merge(...e){var o,a;const t=ot(this.contents),i=ot(this.overrides),n=[...this.keys],s=(o=this.raw)!=null&&o.length?[...this.raw]:[this];for(const c of e)if(s.push(...(a=c.raw)!=null&&a.length?c.raw:[c]),!c.isEmpty()){this.mergeContents(t,c.contents);for(const l of c.overrides){const[u]=i.filter(d=>qr(d.identifiers,l.identifiers));u?(this.mergeContents(u.contents,l.contents),u.keys.push(...l.keys),u.keys=Wo(u.keys)):i.push(ot(l))}for(const l of c.keys)n.indexOf(l)===-1&&n.push(l)}return new ki(t,n,i,s.every(c=>c instanceof ki)?void 0:s,this.logService)}createOverrideConfigurationModel(e){const t=this.getContentsForOverrideIdentifer(e);if(!t||typeof t!="object"||!Object.keys(t).length)return this;const i={};for(const n of Wo([...Object.keys(this.contents),...Object.keys(t)])){let s=this.contents[n];const o=t[n];o&&(typeof s=="object"&&typeof o=="object"?(s=ot(s),this.mergeContents(s,o)):s=o),i[n]=s}return new ki(i,this.keys,this.overrides,void 0,this.logService)}mergeContents(e,t){for(const i of Object.keys(t)){if(i in e&&Vt(e[i])&&Vt(t[i])){this.mergeContents(e[i],t[i]);continue}e[i]=ot(t[i])}}getContentsForOverrideIdentifer(e){let t=null,i=null;const n=s=>{s&&(i?this.mergeContents(i,s):i=ot(s))};for(const s of this.overrides)s.identifiers.length===1&&s.identifiers[0]===e?t=s.contents:s.identifiers.includes(e)&&n(s.contents);return n(t),i}toJSON(){return{contents:this.contents,overrides:this.overrides,keys:this.keys}}addValue(e,t){this.updateValue(e,t,!0)}setValue(e,t){this.updateValue(e,t,!1)}removeValue(e){const t=this.keys.indexOf(e);t!==-1&&(this.keys.splice(t,1),gD(this.contents,e),yn.test(e)&&this.overrides.splice(this.overrides.findIndex(i=>qr(i.identifiers,Hl(e))),1))}updateValue(e,t,i){fC(this.contents,e,t,n=>this.logService.error(n)),i=i||this.keys.indexOf(e)===-1,i&&this.keys.push(e),yn.test(e)&&this.overrides.push({identifiers:Hl(e),keys:Object.keys(this.contents[e]),contents:Zm(this.contents[e],n=>this.logService.error(n))})}}class n7{constructor(e,t){this._name=e,this.logService=t,this._raw=null,this._configurationModel=null,this._restrictedConfigurations=[],this._parseErrors=[]}get configurationModel(){return this._configurationModel||ki.createEmptyModel(this.logService)}get restrictedConfigurations(){return this._restrictedConfigurations}get errors(){return this._parseErrors}parse(e,t){if(!Qt(e)){const i=this.doParseContent(e);this.parseRaw(i,t)}}reparse(e){this._raw&&this.parseRaw(this._raw,e)}parseRaw(e,t){this._raw=e;const{contents:i,keys:n,overrides:s,restricted:o,hasExcludedProperties:a}=this.doParseRaw(e,t);this._configurationModel=new ki(i,n,s,a?[e]:void 0,this.logService),this._restrictedConfigurations=o||[]}doParseContent(e){let t={},i=null,n=[];const s=[];function o(c){Array.isArray(n)?n.push(c):i!==null&&(n[i]=c)}const a={onObjectBegin:()=>{const c={};o(c),s.push(n),n=c,i=null},onObjectProperty:c=>{i=c},onObjectEnd:()=>{n=s.pop()},onArrayBegin:()=>{const c=[];o(c),s.push(n),n=c,i=null},onArrayEnd:()=>{n=s.pop()},onLiteralValue:o,onError:(c,l,u)=>{}};if(e)try{i7(e,a),t=n[0]||{}}catch(c){this.logService.error(`Error while parsing settings file ${this._name}: ${c}`),this._parseErrors=[c]}return t}doParseRaw(e,t){const i=qt.as(ld.Configuration).getConfigurationProperties(),n=this.filter(e,i,!0,t);e=n.raw;const s=Zm(e,c=>this.logService.error(`Conflict in settings file ${this._name}: ${c}`)),o=Object.keys(e),a=this.toOverrides(e,c=>this.logService.error(`Conflict in settings file ${this._name}: ${c}`));return{contents:s,keys:o,overrides:a,restricted:n.restricted,hasExcludedProperties:n.hasExcludedProperties}}filter(e,t,i,n){var c,l,u;let s=!1;if(!(n!=null&&n.scopes)&&!(n!=null&&n.skipRestricted)&&!((c=n==null?void 0:n.exclude)!=null&&c.length))return{raw:e,restricted:[],hasExcludedProperties:s};const o={},a=[];for(const d in e)if(yn.test(d)&&i){const f=this.filter(e[d],t,!1,n);o[d]=f.raw,s=s||f.hasExcludedProperties,a.push(...f.restricted)}else{const f=t[d],m=f?typeof f.scope<"u"?f.scope:3:void 0;f!=null&&f.restricted&&a.push(d),!((l=n.exclude)!=null&&l.includes(d))&&((u=n.include)!=null&&u.includes(d)||(m===void 0||n.scopes===void 0||n.scopes.includes(m))&&!(n.skipRestricted&&(f!=null&&f.restricted)))?o[d]=e[d]:s=!0}return{raw:o,restricted:a,hasExcludedProperties:s}}toOverrides(e,t){const i=[];for(const n of Object.keys(e))if(yn.test(n)){const s={};for(const o in e[n])s[o]=e[n][o];i.push({identifiers:Hl(n),keys:Object.keys(s),contents:Zm(s,t)})}return i}}class r7{constructor(e,t,i,n,s,o,a,c,l,u,d,f,m){this.key=e,this.overrides=t,this._value=i,this.overrideIdentifiers=n,this.defaultConfiguration=s,this.policyConfiguration=o,this.applicationConfiguration=a,this.userConfiguration=c,this.localUserConfiguration=l,this.remoteUserConfiguration=u,this.workspaceConfiguration=d,this.folderConfigurationModel=f,this.memoryConfigurationModel=m}get value(){return Kc(this._value)}toInspectValue(e){return(e==null?void 0:e.value)!==void 0||(e==null?void 0:e.override)!==void 0||(e==null?void 0:e.overrides)!==void 0?e:void 0}get defaultInspectValue(){return this._defaultInspectValue||(this._defaultInspectValue=this.defaultConfiguration.inspect(this.key,this.overrides.overrideIdentifier)),this._defaultInspectValue}get defaultValue(){return this.defaultInspectValue.merged}get default(){return this.toInspectValue(this.defaultInspectValue)}get policyInspectValue(){return this._policyInspectValue===void 0&&(this._policyInspectValue=this.policyConfiguration?this.policyConfiguration.inspect(this.key):null),this._policyInspectValue}get policyValue(){var e;return(e=this.policyInspectValue)==null?void 0:e.merged}get policy(){var e;return((e=this.policyInspectValue)==null?void 0:e.value)!==void 0?{value:this.policyInspectValue.value}:void 0}get applicationInspectValue(){return this._applicationInspectValue===void 0&&(this._applicationInspectValue=this.applicationConfiguration?this.applicationConfiguration.inspect(this.key):null),this._applicationInspectValue}get applicationValue(){var e;return(e=this.applicationInspectValue)==null?void 0:e.merged}get application(){return this.toInspectValue(this.applicationInspectValue)}get userInspectValue(){return this._userInspectValue||(this._userInspectValue=this.userConfiguration.inspect(this.key,this.overrides.overrideIdentifier)),this._userInspectValue}get userValue(){return this.userInspectValue.merged}get user(){return this.toInspectValue(this.userInspectValue)}get userLocalInspectValue(){return this._userLocalInspectValue||(this._userLocalInspectValue=this.localUserConfiguration.inspect(this.key,this.overrides.overrideIdentifier)),this._userLocalInspectValue}get userLocalValue(){return this.userLocalInspectValue.merged}get userLocal(){return this.toInspectValue(this.userLocalInspectValue)}get userRemoteInspectValue(){return this._userRemoteInspectValue||(this._userRemoteInspectValue=this.remoteUserConfiguration.inspect(this.key,this.overrides.overrideIdentifier)),this._userRemoteInspectValue}get userRemoteValue(){return this.userRemoteInspectValue.merged}get userRemote(){return this.toInspectValue(this.userRemoteInspectValue)}get workspaceInspectValue(){return this._workspaceInspectValue===void 0&&(this._workspaceInspectValue=this.workspaceConfiguration?this.workspaceConfiguration.inspect(this.key,this.overrides.overrideIdentifier):null),this._workspaceInspectValue}get workspaceValue(){var e;return(e=this.workspaceInspectValue)==null?void 0:e.merged}get workspace(){return this.toInspectValue(this.workspaceInspectValue)}get workspaceFolderInspectValue(){return this._workspaceFolderInspectValue===void 0&&(this._workspaceFolderInspectValue=this.folderConfigurationModel?this.folderConfigurationModel.inspect(this.key,this.overrides.overrideIdentifier):null),this._workspaceFolderInspectValue}get workspaceFolderValue(){var e;return(e=this.workspaceFolderInspectValue)==null?void 0:e.merged}get workspaceFolder(){return this.toInspectValue(this.workspaceFolderInspectValue)}get memoryInspectValue(){return this._memoryInspectValue===void 0&&(this._memoryInspectValue=this.memoryConfigurationModel.inspect(this.key,this.overrides.overrideIdentifier)),this._memoryInspectValue}get memoryValue(){return this.memoryInspectValue.merged}get memory(){return this.toInspectValue(this.memoryInspectValue)}}let Dv=class JC{constructor(e,t,i,n,s,o,a,c,l,u){this._defaultConfiguration=e,this._policyConfiguration=t,this._applicationConfiguration=i,this._localUserConfiguration=n,this._remoteUserConfiguration=s,this._workspaceConfiguration=o,this._folderConfigurations=a,this._memoryConfiguration=c,this._memoryConfigurationByResource=l,this.logService=u,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations=new Pt,this._userConfiguration=null}getValue(e,t,i){return this.getConsolidatedConfigurationModel(e,t,i).getValue(e)}updateValue(e,t,i={}){let n;i.resource?(n=this._memoryConfigurationByResource.get(i.resource),n||(n=ki.createEmptyModel(this.logService),this._memoryConfigurationByResource.set(i.resource,n))):n=this._memoryConfiguration,t===void 0?n.removeValue(e):n.setValue(e,t),i.resource||(this._workspaceConsolidatedConfiguration=null)}inspect(e,t,i){const n=this.getConsolidatedConfigurationModel(e,t,i),s=this.getFolderConfigurationModelForResource(t.resource,i),o=t.resource?this._memoryConfigurationByResource.get(t.resource)||this._memoryConfiguration:this._memoryConfiguration,a=new Set;for(const c of n.overrides)for(const l of c.identifiers)n.getOverrideValue(e,l)!==void 0&&a.add(l);return new r7(e,t,n.getValue(e),a.size?[...a]:void 0,this._defaultConfiguration,this._policyConfiguration.isEmpty()?void 0:this._policyConfiguration,this.applicationConfiguration.isEmpty()?void 0:this.applicationConfiguration,this.userConfiguration,this.localUserConfiguration,this.remoteUserConfiguration,i?this._workspaceConfiguration:void 0,s||void 0,o)}keys(e){const t=this.getFolderConfigurationModelForResource(void 0,e);return{default:this._defaultConfiguration.keys.slice(0),user:this.userConfiguration.keys.slice(0),workspace:this._workspaceConfiguration.keys.slice(0),workspaceFolder:t?t.keys.slice(0):[]}}updateDefaultConfiguration(e){this._defaultConfiguration=e,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations.clear()}updatePolicyConfiguration(e){this._policyConfiguration=e}updateApplicationConfiguration(e){this._applicationConfiguration=e,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations.clear()}updateLocalUserConfiguration(e){this._localUserConfiguration=e,this._userConfiguration=null,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations.clear()}updateRemoteUserConfiguration(e){this._remoteUserConfiguration=e,this._userConfiguration=null,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations.clear()}updateWorkspaceConfiguration(e){this._workspaceConfiguration=e,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations.clear()}updateFolderConfiguration(e,t){this._folderConfigurations.set(e,t),this._foldersConsolidatedConfigurations.delete(e)}deleteFolderConfiguration(e){this.folderConfigurations.delete(e),this._foldersConsolidatedConfigurations.delete(e)}compareAndUpdateDefaultConfiguration(e,t){const i=[];if(!t){const{added:n,updated:s,removed:o}=mr(this._defaultConfiguration,e);t=[...n,...s,...o]}for(const n of t)for(const s of Hl(n)){const o=this._defaultConfiguration.getKeysForOverrideIdentifier(s),a=e.getKeysForOverrideIdentifier(s),c=[...a.filter(l=>o.indexOf(l)===-1),...o.filter(l=>a.indexOf(l)===-1),...o.filter(l=>!tn(this._defaultConfiguration.override(s).getValue(l),e.override(s).getValue(l)))];i.push([s,c])}return this.updateDefaultConfiguration(e),{keys:t,overrides:i}}compareAndUpdatePolicyConfiguration(e){const{added:t,updated:i,removed:n}=mr(this._policyConfiguration,e),s=[...t,...i,...n];return s.length&&this.updatePolicyConfiguration(e),{keys:s,overrides:[]}}compareAndUpdateApplicationConfiguration(e){const{added:t,updated:i,removed:n,overrides:s}=mr(this.applicationConfiguration,e),o=[...t,...i,...n];return o.length&&this.updateApplicationConfiguration(e),{keys:o,overrides:s}}compareAndUpdateLocalUserConfiguration(e){const{added:t,updated:i,removed:n,overrides:s}=mr(this.localUserConfiguration,e),o=[...t,...i,...n];return o.length&&this.updateLocalUserConfiguration(e),{keys:o,overrides:s}}compareAndUpdateRemoteUserConfiguration(e){const{added:t,updated:i,removed:n,overrides:s}=mr(this.remoteUserConfiguration,e),o=[...t,...i,...n];return o.length&&this.updateRemoteUserConfiguration(e),{keys:o,overrides:s}}compareAndUpdateWorkspaceConfiguration(e){const{added:t,updated:i,removed:n,overrides:s}=mr(this.workspaceConfiguration,e),o=[...t,...i,...n];return o.length&&this.updateWorkspaceConfiguration(e),{keys:o,overrides:s}}compareAndUpdateFolderConfiguration(e,t){const i=this.folderConfigurations.get(e),{added:n,updated:s,removed:o,overrides:a}=mr(i,t),c=[...n,...s,...o];return(c.length||!i)&&this.updateFolderConfiguration(e,t),{keys:c,overrides:a}}compareAndDeleteFolderConfiguration(e){const t=this.folderConfigurations.get(e);if(!t)throw new Error("Unknown folder");this.deleteFolderConfiguration(e);const{added:i,updated:n,removed:s,overrides:o}=mr(t,void 0);return{keys:[...i,...n,...s],overrides:o}}get defaults(){return this._defaultConfiguration}get applicationConfiguration(){return this._applicationConfiguration}get userConfiguration(){return this._userConfiguration||(this._userConfiguration=this._remoteUserConfiguration.isEmpty()?this._localUserConfiguration:this._localUserConfiguration.merge(this._remoteUserConfiguration)),this._userConfiguration}get localUserConfiguration(){return this._localUserConfiguration}get remoteUserConfiguration(){return this._remoteUserConfiguration}get workspaceConfiguration(){return this._workspaceConfiguration}get folderConfigurations(){return this._folderConfigurations}getConsolidatedConfigurationModel(e,t,i){let n=this.getConsolidatedConfigurationModelForResource(t,i);return t.overrideIdentifier&&(n=n.override(t.overrideIdentifier)),!this._policyConfiguration.isEmpty()&&this._policyConfiguration.getValue(e)!==void 0&&(n=n.merge(this._policyConfiguration)),n}getConsolidatedConfigurationModelForResource({resource:e},t){let i=this.getWorkspaceConsolidatedConfiguration();if(t&&e){const n=t.getFolder(e);n&&(i=this.getFolderConsolidatedConfiguration(n.uri)||i);const s=this._memoryConfigurationByResource.get(e);s&&(i=i.merge(s))}return i}getWorkspaceConsolidatedConfiguration(){return this._workspaceConsolidatedConfiguration||(this._workspaceConsolidatedConfiguration=this._defaultConfiguration.merge(this.applicationConfiguration,this.userConfiguration,this._workspaceConfiguration,this._memoryConfiguration)),this._workspaceConsolidatedConfiguration}getFolderConsolidatedConfiguration(e){let t=this._foldersConsolidatedConfigurations.get(e);if(!t){const i=this.getWorkspaceConsolidatedConfiguration(),n=this._folderConfigurations.get(e);n?(t=i.merge(n),this._foldersConsolidatedConfigurations.set(e,t)):t=i}return t}getFolderConfigurationModelForResource(e,t){if(t&&e){const i=t.getFolder(e);if(i)return this._folderConfigurations.get(i.uri)}}toData(){return{defaults:{contents:this._defaultConfiguration.contents,overrides:this._defaultConfiguration.overrides,keys:this._defaultConfiguration.keys},policy:{contents:this._policyConfiguration.contents,overrides:this._policyConfiguration.overrides,keys:this._policyConfiguration.keys},application:{contents:this.applicationConfiguration.contents,overrides:this.applicationConfiguration.overrides,keys:this.applicationConfiguration.keys},user:{contents:this.userConfiguration.contents,overrides:this.userConfiguration.overrides,keys:this.userConfiguration.keys},workspace:{contents:this._workspaceConfiguration.contents,overrides:this._workspaceConfiguration.overrides,keys:this._workspaceConfiguration.keys},folders:[...this._folderConfigurations.keys()].reduce((e,t)=>{const{contents:i,overrides:n,keys:s}=this._folderConfigurations.get(t);return e.push([t,{contents:i,overrides:n,keys:s}]),e},[])}}allKeys(){const e=new Set;return this._defaultConfiguration.keys.forEach(t=>e.add(t)),this.userConfiguration.keys.forEach(t=>e.add(t)),this._workspaceConfiguration.keys.forEach(t=>e.add(t)),this._folderConfigurations.forEach(t=>t.keys.forEach(i=>e.add(i))),[...e.values()]}allOverrideIdentifiers(){const e=new Set;return this._defaultConfiguration.getAllOverrideIdentifiers().forEach(t=>e.add(t)),this.userConfiguration.getAllOverrideIdentifiers().forEach(t=>e.add(t)),this._workspaceConfiguration.getAllOverrideIdentifiers().forEach(t=>e.add(t)),this._folderConfigurations.forEach(t=>t.getAllOverrideIdentifiers().forEach(i=>e.add(i))),[...e.values()]}getAllKeysForOverrideIdentifier(e){const t=new Set;return this._defaultConfiguration.getKeysForOverrideIdentifier(e).forEach(i=>t.add(i)),this.userConfiguration.getKeysForOverrideIdentifier(e).forEach(i=>t.add(i)),this._workspaceConfiguration.getKeysForOverrideIdentifier(e).forEach(i=>t.add(i)),this._folderConfigurations.forEach(i=>i.getKeysForOverrideIdentifier(e).forEach(n=>t.add(n))),[...t.values()]}static parse(e,t){const i=this.parseConfigurationModel(e.defaults,t),n=this.parseConfigurationModel(e.policy,t),s=this.parseConfigurationModel(e.application,t),o=this.parseConfigurationModel(e.user,t),a=this.parseConfigurationModel(e.workspace,t),c=e.folders.reduce((l,u)=>(l.set(x.revive(u[0]),this.parseConfigurationModel(u[1],t)),l),new Pt);return new JC(i,n,s,o,ki.createEmptyModel(t),a,c,ki.createEmptyModel(t),new Pt,t)}static parseConfigurationModel(e,t){return new ki(e.contents,e.keys,e.overrides,void 0,t)}};class s7{constructor(e,t,i,n,s){this.change=e,this.previous=t,this.currentConfiguraiton=i,this.currentWorkspace=n,this.logService=s,this._marker=`
`,this._markerCode1=this._marker.charCodeAt(0),this._markerCode2=46,this.affectedKeys=new Set,this._previousConfiguration=void 0;for(const o of e.keys)this.affectedKeys.add(o);for(const[,o]of e.overrides)for(const a of o)this.affectedKeys.add(a);this._affectsConfigStr=this._marker;for(const o of this.affectedKeys)this._affectsConfigStr+=o+this._marker}get previousConfiguration(){return!this._previousConfiguration&&this.previous&&(this._previousConfiguration=Dv.parse(this.previous.data,this.logService)),this._previousConfiguration}affectsConfiguration(e,t){var a;const i=this._marker+e,n=this._affectsConfigStr.indexOf(i);if(n<0)return!1;const s=n+i.length;if(s>=this._affectsConfigStr.length)return!1;const o=this._affectsConfigStr.charCodeAt(s);if(o!==this._markerCode1&&o!==this._markerCode2)return!1;if(t){const c=this.previousConfiguration?this.previousConfiguration.getValue(e,t,(a=this.previous)==null?void 0:a.workspace):void 0,l=this.currentConfiguraiton.getValue(e,t,this.currentWorkspace);return!tn(c,l)}return!0}}function mr(r,e){const{added:t,removed:i,updated:n}=yy(e==null?void 0:e.rawConfiguration,r==null?void 0:r.rawConfiguration),s=[],o=(r==null?void 0:r.getAllOverrideIdentifiers())||[],a=(e==null?void 0:e.getAllOverrideIdentifiers())||[];if(e){const c=a.filter(l=>!o.includes(l));for(const l of c)s.push([l,e.getKeysForOverrideIdentifier(l)])}if(r){const c=o.filter(l=>!a.includes(l));for(const l of c)s.push([l,r.getKeysForOverrideIdentifier(l)])}if(e&&r){for(const c of o)if(a.includes(c)){const l=yy({contents:r.getOverrideValue(void 0,c)||{},keys:r.getKeysForOverrideIdentifier(c)},{contents:e.getOverrideValue(void 0,c)||{},keys:e.getKeysForOverrideIdentifier(c)});s.push([c,[...l.added,...l.removed,...l.updated]])}}return{added:t,removed:i,updated:n,overrides:s}}function yy(r,e){const t=r?e?r.keys.filter(s=>e.keys.indexOf(s)===-1):[...r.keys]:[],i=e?r?e.keys.filter(s=>r.keys.indexOf(s)===-1):[...e.keys]:[],n=[];if(r&&e){for(const s of e.keys)if(r.keys.indexOf(s)!==-1){const o=Mh(e.contents,s),a=Mh(r.contents,s);tn(o,a)||n.push(s)}}return{added:t,removed:i,updated:n}}function Oc(r,e){if(e){const t=e.split(".");let i=r;for(let n=0;i&&n<t.length;n++)i=i[t[n]];return i}}function o7(r){return r instanceof x}function a7(r){return r&&r.uri instanceof x&&r.languageId&&typeof r.languageId=="string"}function c7(r){return r&&!r.uri&&r.languageId&&typeof r.languageId=="string"}function l7(r){return r&&r.uri instanceof x&&(!r.name||typeof r.name=="string")&&(!r.index||typeof r.index=="number")}function xy(r){if(o7(r))return{resource:r};if(a7(r))return{resource:r.uri,overrideIdentifier:r.languageId};if(c7(r))return{overrideIdentifier:r.languageId};if(l7(r))return{resource:r.uri};if(r===null)return{resource:null}}let Iv=class{constructor(e,t,i){this._proxy=e.getProxy(J.MainThreadConfiguration),this._extHostWorkspace=t,this._logService=i,this._barrier=new Ki,this._actual=null}getConfigProvider(){return this._barrier.wait().then(e=>this._actual)}$initializeConfiguration(e){this._actual=new u7(this._proxy,this._extHostWorkspace,e,this._logService),this._barrier.open()}$acceptConfigurationChanged(e,t){this.getConfigProvider().then(i=>i.$acceptConfigurationChanged(e,t))}};Iv=U([M(0,Ve),M(1,cr),M(2,Je)],Iv);class u7{constructor(e,t,i,n){this._onDidChangeConfiguration=new R,this._proxy=e,this._logService=n,this._extHostWorkspace=t,this._configuration=Dv.parse(i,n),this._configurationScopes=this._toMap(i.configurationScopes)}get onDidChangeConfiguration(){return this._onDidChangeConfiguration&&this._onDidChangeConfiguration.event}$acceptConfigurationChanged(e,t){const i={data:this._configuration.toData(),workspace:this._extHostWorkspace.workspace};this._configuration=Dv.parse(e,this._logService),this._configurationScopes=this._toMap(e.configurationScopes),this._onDidChangeConfiguration.fire(this._toConfigurationChangeEvent(t,i))}getConfiguration(e,t,i){const n=xy(t)||{},s=this._toReadonlyValue(e?Oc(this._configuration.getValue(void 0,n,this._extHostWorkspace.workspace),e):this._configuration.getValue(void 0,n,this._extHostWorkspace.workspace));e&&this._validateConfigurationAccess(e,n,i==null?void 0:i.identifier);function o(c){if(c==null)return null;if(typeof c=="boolean")return c?2:5;switch(c){case ua.Global:return 2;case ua.Workspace:return 5;case ua.WorkspaceFolder:return 6}}const a={has(c){return typeof Oc(s,c)<"u"},get:(c,l)=>{this._validateConfigurationAccess(e?`${e}.${c}`:c,n,i==null?void 0:i.identifier);let u=Oc(s,c);if(typeof u>"u")u=l;else{let d;const f=(m,b)=>{if(Vt(m)){let _;const v=()=>{d=d||ot(s),_=_||Oc(d,b)};return new Proxy(m,{get:(k,D)=>{if(typeof D=="string"&&D.toLowerCase()==="tojson")return v(),()=>_;if(d)return _=_||Oc(d,b),_[D];const E=k[D];return typeof D=="string"?f(E,`${b}.${D}`):E},set:(k,D,E)=>(v(),_&&(_[D]=E),!0),deleteProperty:(k,D)=>(v(),_&&delete _[D],!0),defineProperty:(k,D,E)=>(v(),_&&Object.defineProperty(_,D,E),!0)})}return Array.isArray(m)?ot(m):m};u=f(u,c)}return u},update:(c,l,u,d)=>{c=e?`${e}.${c}`:c;const f=o(u);return l!==void 0?this._proxy.$updateConfigurationOption(f,c,l,n,d):this._proxy.$removeConfigurationOption(f,c,n,d)},inspect:c=>{var u,d,f,m,b,_,v,k,D,E,N;c=e?`${e}.${c}`:c;const l=this._configuration.inspect(c,n,this._extHostWorkspace.workspace);if(l)return{key:c,defaultValue:ot(((u=l.policy)==null?void 0:u.value)??((d=l.default)==null?void 0:d.value)),globalValue:ot(((f=l.user)==null?void 0:f.value)??((m=l.application)==null?void 0:m.value)),workspaceValue:ot((b=l.workspace)==null?void 0:b.value),workspaceFolderValue:ot((_=l.workspaceFolder)==null?void 0:_.value),defaultLanguageValue:ot((v=l.default)==null?void 0:v.override),globalLanguageValue:ot(((k=l.user)==null?void 0:k.override)??((D=l.application)==null?void 0:D.override)),workspaceLanguageValue:ot((E=l.workspace)==null?void 0:E.override),workspaceFolderLanguageValue:ot((N=l.workspaceFolder)==null?void 0:N.override),languageIds:ot(l.overrideIdentifiers)}}};return typeof s=="object"&&po(a,s,!1),Object.freeze(a)}_toReadonlyValue(e){const t=i=>Vt(i)?new Proxy(i,{get:(n,s)=>t(n[s]),set:(n,s,o)=>{throw new Error(`TypeError: Cannot assign to read only property '${String(s)}' of object`)},deleteProperty:(n,s)=>{throw new Error(`TypeError: Cannot delete read only property '${String(s)}' of object`)},defineProperty:(n,s)=>{throw new Error(`TypeError: Cannot define property '${String(s)}' for a readonly object`)},setPrototypeOf:n=>{throw new Error("TypeError: Cannot set prototype for a readonly object")},isExtensible:()=>!1,preventExtensions:()=>!0}):i;return t(e)}_validateConfigurationAccess(e,t,i){const n=yn.test(e)?4:this._configurationScopes.get(e),s=i?`[${i.value}] `:"";if(n===4){typeof(t==null?void 0:t.resource)>"u"&&this._logService.warn(`${s}Accessing a resource scoped configuration without providing a resource is not expected. To get the effective value for '${e}', provide the URI of a resource or 'null' for any resource.`);return}if(n===3){t!=null&&t.resource&&this._logService.warn(`${s}Accessing a window scoped configuration for a resource is not expected. To associate '${e}' to a resource, define its scope to 'resource' in configuration contributions in 'package.json'.`);return}}_toConfigurationChangeEvent(e,t){const i=new s7(e,t,this._configuration,this._extHostWorkspace.workspace,this._logService);return Object.freeze({affectsConfiguration:(n,s)=>i.affectsConfiguration(n,xy(s))})}_toMap(e){return e.reduce((t,i)=>(t.set(i[0],i[1]),t),new Map)}}const lr=Ce("IExtHostConfiguration");class d7{constructor(e,t){this.versionId=e,this.removedDueToLooping=t}}class co{static isHostExtension(e,t,i){if(t.getExtensionDescription(e))return!1;const n=i.getExtensionDescription(e);return n?!!((n.main||n.browser)&&n.api==="none"):!1}constructor(e,t){this._activationEventsReader=e,this._onDidChange=new R,this.onDidChange=this._onDidChange.event,this._versionId=0,this._extensionDescriptions=t,this._initialize()}_initialize(){this._extensionDescriptions.sort(f7),this._extensionsMap=new Kr,this._extensionsArr=[],this._activationMap=new Map;for(const e of this._extensionDescriptions){if(this._extensionsMap.has(e.identifier)){console.error("Extension `"+e.identifier.value+"` is already registered");continue}this._extensionsMap.set(e.identifier,e),this._extensionsArr.push(e);const t=this._activationEventsReader.readActivationEvents(e);for(const i of t)this._activationMap.has(i)||this._activationMap.set(i,[]),this._activationMap.get(i).push(e)}}set(e){return this._extensionDescriptions=e,this._initialize(),this._versionId++,this._onDidChange.fire(void 0),{versionId:this._versionId}}deltaExtensions(e,t){this._extensionDescriptions=Cy(this._extensionDescriptions,t),this._extensionDescriptions=this._extensionDescriptions.concat(e);const i=co._findLoopingExtensions(this._extensionDescriptions);return this._extensionDescriptions=Cy(this._extensionDescriptions,i.map(n=>n.identifier)),this._initialize(),this._versionId++,this._onDidChange.fire(void 0),new d7(this._versionId,i)}static _findLoopingExtensions(e){const t=new class{constructor(){this._arcs=new Map,this._nodesSet=new Set,this._nodesArr=[]}addNode(a){this._nodesSet.has(a)||(this._nodesSet.add(a),this._nodesArr.push(a))}addArc(a,c){this.addNode(a),this.addNode(c),this._arcs.has(a)?this._arcs.get(a).push(c):this._arcs.set(a,[c])}getArcs(a){return this._arcs.has(a)?this._arcs.get(a):[]}hasOnlyGoodArcs(a,c){const l=t.getArcs(a);for(let u=0;u<l.length;u++)if(!c.has(l[u]))return!1;return!0}getNodes(){return this._nodesArr}},i=new Kr;for(const a of e)if(i.set(a.identifier,a),a.extensionDependencies)for(const c of a.extensionDependencies)t.addArc(Xe.toKey(a.identifier),Xe.toKey(c));const n=new Set;t.getNodes().filter(a=>t.getArcs(a).length===0).forEach(a=>n.add(a));const s=t.getNodes().filter(a=>!n.has(a));let o;do{o=!1;for(let a=0;a<s.length;a++){const c=s[a];t.hasOnlyGoodArcs(c,n)&&(s.splice(a,1),a--,n.add(c),o=!0)}}while(o);return s.map(a=>i.get(a))}containsActivationEvent(e){return this._activationMap.has(e)}containsExtension(e){return this._extensionsMap.has(e)}getExtensionDescriptionsForActivationEvent(e){const t=this._activationMap.get(e);return t?t.slice(0):[]}getAllExtensionDescriptions(){return this._extensionsArr.slice(0)}getSnapshot(){return new h7(this._versionId,this.getAllExtensionDescriptions())}getExtensionDescription(e){const t=this._extensionsMap.get(e);return t||void 0}getExtensionDescriptionByUUID(e){for(const t of this._extensionsArr)if(t.uuid===e)return t}getExtensionDescriptionByIdOrUUID(e,t){return this.getExtensionDescription(e)??(t?this.getExtensionDescriptionByUUID(t):void 0)}}class h7{constructor(e,t){this.versionId=e,this.extensions=t}}function f7(r,e){const t=r.isBuiltin?0:r.isUnderDevelopment?2:1,i=e.isBuiltin?0:e.isUnderDevelopment?2:1;if(t!==i)return t-i;const n=Be.basename(r.extensionLocation.path),s=Be.basename(e.extensionLocation.path);return n<s?-1:n>s?1:0}function Cy(r,e){const t=new ko(e);return r.filter(i=>!t.has(i.identifier))}const KC="vs/platform/extensionManagement/common/extensionManagement",Sy="^([a-z0-9A-Z][a-z0-9-A-Z]*)\\.([a-z0-9A-Z][a-z0-9-A-Z]*)$";var Ey;(function(r){r.Unsupported="Unsupported",r.Deprecated="Deprecated",r.Malicious="Malicious",r.Incompatible="Incompatible",r.IncompatibleTargetPlatform="IncompatibleTargetPlatform",r.ReleaseVersionNotFound="ReleaseVersionNotFound",r.Invalid="Invalid",r.Download="Download",r.DownloadSignature="DownloadSignature",r.UpdateMetadata="UpdateMetadata",r.Extract="Extract",r.Scanning="Scanning",r.Delete="Delete",r.Rename="Rename",r.CorruptZip="CorruptZip",r.IncompleteZip="IncompleteZip",r.Signature="Signature",r.NotAllowed="NotAllowed",r.Gallery="Gallery",r.Cancelled="Cancelled",r.Unknown="Unknown",r.Internal="Internal"})(Ey||(Ey={}));var ky;(function(r){r.Timeout="Timeout",r.Cancelled="Cancelled",r.Failed="Failed"})(ky||(ky={}));_w(KC,0,"Extensions");_w(KC,1,"Preferences");class qw{constructor(e){this.value=e,this.isTrustedTelemetryValue=!0}}const p7="extensionTelemetryLog",g7=new Set(["ssh-remote","dev-container","attached-container","wsl","tunnel","codespaces","amlext"]);function m7(r){if(!r)return"none";const e=Nw(r);return g7.has(e)?e:"other"}function v7(r,e){if(!r||!r.includes("/")&&!r.includes("\\"))return r;let t=r;const i=[];for(const a of e)for(;;){const c=a.exec(r);if(!c)break;i.push([c.index,a.lastIndex])}const n=/^[\\\/]?(node_modules|node_modules\.asar)[\\\/]/,s=/(file:\/\/)?([a-zA-Z]:(\\\\|\\|\/)|(\\\\|\\|\/))?([\w-\._]+(\\\\|\\|\/))+[\w-\._]*/g;let o=0;for(t="";;){const a=s.exec(r);if(!a)break;const c=i.some(([l,u])=>a.index<u&&l<s.lastIndex);!n.test(a[0])&&!c&&(t+=r.substring(o,a.index)+"<REDACTED: user-file-path>",o=s.lastIndex)}return o<r.length&&(t+=r.substr(o)),t}function _7(r){if(!r)return r;const e=[{label:"Google API Key",regex:/AIza[A-Za-z0-9_\\\-]{35}/},{label:"Slack Token",regex:/xox[pbar]\-[A-Za-z0-9]/},{label:"GitHub Token",regex:/(gh[psuro]_[a-zA-Z0-9]{36}|github_pat_[a-zA-Z0-9]{22}_[a-zA-Z0-9]{59})/},{label:"Generic Secret",regex:/(key|token|sig|secret|signature|password|passwd|pwd|android:value)[^a-zA-Z0-9]/i},{label:"CLI Credentials",regex:/((login|psexec|(certutil|psexec)\.exe).{1,50}(\s-u(ser(name)?)?\s+.{3,100})?\s-(admin|user|vm|root)?p(ass(word)?)?\s+["']?[^$\-\/\s]|(^|[\s\r\n\\])net(\.exe)?.{1,5}(user\s+|share\s+\/user:| user -? secrets ? set) \s + [^ $\s \/])/},{label:"Email",regex:/@[a-zA-Z0-9-]+\.[a-zA-Z0-9-]+/}];for(const t of e)if(t.regex.test(r))return`<REDACTED: ${t.label}>`;return r}function Dy(r,e){return bh(r,t=>{if(t instanceof qw||Object.hasOwnProperty.call(t,"isTrustedTelemetryValue"))return t.value;if(typeof t=="string"){let i=t.replaceAll("%20"," ");i=v7(i,e);for(const n of e)i=i.replace(n,"");return i=_7(i),i}})}new Xe("pprice.better-merge");class w7{constructor(){this._generators=new Map,this._cache=new WeakMap}register(e,t){this._generators.set(e,t)}readActivationEvents(e){return this._cache.has(e)||this._cache.set(e,this._readActivationEvents(e)),this._cache.get(e)}createActivationEventsMap(e){const t=Object.create(null);for(const i of e){const n=this.readActivationEvents(i);n.length>0&&(t[Xe.toKey(i.identifier)]=n)}return t}_readActivationEvents(e){if(typeof e.main>"u"&&typeof e.browser>"u")return[];const t=Array.isArray(e.activationEvents)?e.activationEvents.slice(0):[];for(let i=0;i<t.length;i++)t[i]==="onUri"&&(t[i]=`onUri:${Xe.toKey(e.identifier)}`);if(!e.contributes)return t;for(const i in e.contributes){const n=this._generators.get(i);if(!n)continue;const s=e.contributes[i],o=Array.isArray(s)?s:[s];try{n(o,t)}catch(a){nn(a)}}return t}}const b7=new w7,y7=Object.freeze({identifier:new Xe("nullExtensionDescription"),name:"Null Extension Description",version:"0.0.0",publisher:"vscode",engines:{vscode:""},extensionLocation:x.parse("void:location"),isBuiltin:!1,targetPlatform:"undefined",isUserBuiltin:!1,isUnderDevelopment:!1});class Iy{constructor(e){this.dependency=e}}function Lt(r,e){return r.enabledApiProposals?r.enabledApiProposals.includes(e):!1}function O(r,e){var t;if(!Lt(r,e))throw new Error(`Extension '${r.identifier.value}' CANNOT use API proposal: ${e}.
Its package.json#enabledApiProposals-property declares: ${((t=r.enabledApiProposals)==null?void 0:t.join(", "))??"[]"} but NOT ${e}.
 The missing proposal MUST be added and you must start in extension development mode or use the following command line switch: --enable-proposed-api ${r.identifier.value}`)}const Dp=class Dp{constructor(e,t,i,n){this.startup=e,this.codeLoadingTime=t,this.activateCallTime=i,this.activateResolvedTime=n}};Dp.NONE=new Dp(!1,-1,-1,-1);let uc=Dp;class Py{constructor(e){this._startup=e,this._codeLoadingStart=-1,this._codeLoadingStop=-1,this._activateCallStart=-1,this._activateCallStop=-1,this._activateResolveStart=-1,this._activateResolveStop=-1}_delta(e,t){return e===-1||t===-1?-1:t-e}build(){return new uc(this._startup,this._delta(this._codeLoadingStart,this._codeLoadingStop),this._delta(this._activateCallStart,this._activateCallStop),this._delta(this._activateResolveStart,this._activateResolveStop))}codeLoadingStart(){this._codeLoadingStart=Date.now()}codeLoadingStop(){this._codeLoadingStop=Date.now()}activateCallStart(){this._activateCallStart=Date.now()}activateCallStop(){this._activateCallStop=Date.now()}activateResolveStart(){this._activateResolveStart=Date.now()}activateResolveStop(){this._activateResolveStop=Date.now()}}class lg{constructor(e,t,i,n,s,o){this.activationFailed=e,this.activationFailedError=t,this.activationTimes=i,this.module=n,this.exports=s,this.subscriptions=o}}class x7 extends lg{constructor(e){super(!1,null,e,{activate:void 0,deactivate:void 0},void 0,[])}}class C7 extends lg{constructor(){super(!1,null,uc.NONE,{activate:void 0,deactivate:void 0},void 0,[])}}class ep extends lg{constructor(e){super(!0,e,uc.NONE,{activate:void 0,deactivate:void 0},void 0,[])}}let Pv=class{constructor(e,t,i,n){this._logService=n,this._registry=e,this._globalRegistry=t,this._host=i,this._operations=new Kr,this._alreadyActivatedEvents=Object.create(null)}dispose(){for(const[e,t]of this._operations)t.dispose()}async waitForActivatingExtensions(){const e=[];for(const[t,i]of this._operations)e.push(i.wait());await Promise.all(e)}isActivated(e){const t=this._operations.get(e);return!!(t&&t.value)}getActivatedExtension(e){const t=this._operations.get(e);if(!t||!t.value)throw new Error(`Extension '${e.value}' is not known or not activated`);return t.value}async activateByEvent(e,t){if(this._alreadyActivatedEvents[e])return;const i=this._registry.getExtensionDescriptionsForActivationEvent(e);await this._activateExtensions(i.map(n=>({id:n.identifier,reason:{startup:t,extensionId:n.identifier,activationEvent:e}}))),this._alreadyActivatedEvents[e]=!0}activateById(e,t){const i=this._registry.getExtensionDescription(e);if(!i)throw new Error(`Extension '${e.value}' is not known`);return this._activateExtensions([{id:i.identifier,reason:t}])}async _activateExtensions(e){const t=e.filter(i=>!this.isActivated(i.id)).map(i=>this._handleActivationRequest(i));await Promise.all(t.map(i=>i.wait()))}_handleActivationRequest(e){if(this._operations.has(e.id))return this._operations.get(e.id);if(this._isHostExtension(e.id))return this._createAndSaveOperation(e,null,[],null);const t=this._registry.getExtensionDescription(e.id);if(!t){const s=new Error(`Cannot activate unknown extension '${e.id.value}'`),o=this._createAndSaveOperation(e,null,[],new ep(s));return this._host.onExtensionActivationError(e.id,s,new Iy(e.id.value)),o}const i=[],n=typeof t.extensionDependencies>"u"?[]:t.extensionDependencies;for(const s of n){if(this._isResolvedExtension(s))continue;const o=this._operations.get(s);if(o){i.push(o);continue}if(this._isHostExtension(s)){i.push(this._handleActivationRequest({id:this._globalRegistry.getExtensionDescription(s).identifier,reason:e.reason}));continue}const a=this._registry.getExtensionDescription(s);if(a){if(!a.main&&!a.browser)continue;i.push(this._handleActivationRequest({id:a.identifier,reason:e.reason}));continue}const c=t.displayName||t.identifier.value,l=new Error(`Cannot activate the '${c}' extension because it depends on unknown extension '${s}'`),u=this._createAndSaveOperation(e,t.displayName,[],new ep(l));return this._host.onExtensionActivationError(t.identifier,l,new Iy(s)),u}return this._createAndSaveOperation(e,t.displayName,i,null)}_createAndSaveOperation(e,t,i,n){const s=new Tv(e.id,t,e.reason,i,n,this._host,this._logService);return this._operations.set(e.id,s),s}_isHostExtension(e){return co.isHostExtension(e,this._registry,this._globalRegistry)}_isResolvedExtension(e){const t=this._globalRegistry.getExtensionDescription(e);return t?!t.main&&!t.browser:!1}};Pv=U([M(3,Je)],Pv);let Tv=class{get value(){return this._value}get friendlyName(){return this._displayName||this._id.value}constructor(e,t,i,n,s,o,a){this._id=e,this._displayName=t,this._reason=i,this._deps=n,this._value=s,this._host=o,this._logService=a,this._barrier=new Ki,this._isDisposed=!1,this._initialize()}dispose(){this._isDisposed=!0}wait(){return this._barrier.wait()}async _initialize(){await this._waitForDepsThenActivate(),this._barrier.open()}async _waitForDepsThenActivate(){if(!this._value){for(;this._deps.length>0;){for(let e=0;e<this._deps.length;e++){const t=this._deps[e];if(t.value&&!t.value.activationFailed){this._deps.splice(e,1),e--;continue}if(t.value&&t.value.activationFailed){const i=new Error(`Cannot activate the '${this.friendlyName}' extension because its dependency '${t.friendlyName}' failed to activate`);i.detail=t.value.activationFailedError,this._value=new ep(i),this._host.onExtensionActivationError(this._id,i,null);return}}this._deps.length>0&&await Promise.race(this._deps.map(e=>e.wait()))}await this._activate()}}async _activate(){try{this._value=await this._host.actualActivateExtension(this._id,this._reason)}catch(e){const t=new Error;if(e&&e.name&&(t.name=e.name),e&&e.message?t.message=`Activating extension '${this._id.value}' failed: ${e.message}.`:t.message=`Activating extension '${this._id.value}' failed: ${e}.`,e&&e.stack&&(t.stack=e.stack),this._value=new ep(t),this._isDisposed&&ho(e))return;this._host.onExtensionActivationError(this._id,t,null),this._logService.error(`Activating extension ${this._id.value} failed due to an error:`),this._logService.error(e)}}};Tv=U([M(6,Je)],Tv);class XC{constructor(e,t){this._logService=t,this._onDidChangeStorage=new R,this.onDidChangeStorage=this._onDidChangeStorage.event,this._proxy=e.getProxy(J.MainThreadStorage)}registerExtensionStorageKeysToSync(e,t){this._proxy.$registerExtensionStorageKeysToSync(e,t)}async initializeExtensionStorage(e,t,i){const n=await this._proxy.$initializeExtensionStorage(e,t);let s;return n&&(s=this.safeParseValue(e,t,n)),s||i}setValue(e,t,i){return this._proxy.$setValue(e,t,i)}$acceptValue(e,t,i){const n=this.safeParseValue(e,t,i);n&&this._onDidChangeStorage.fire({shared:e,key:t,value:n})}safeParseValue(e,t,i){try{return JSON.parse(i)}catch(n){this._logService.error(`[extHostStorage] unexpected error parsing storage contents (extensionId: ${t}, global: ${e}): ${n}`)}}}const Gw=Ce("IExtHostStorage");class ZC{constructor(e,t,i){this._deferredPromises=new Map,this._id=e,this._shared=t,this._storage=i,this._init=this._storage.initializeExtensionStorage(this._shared,this._id,Object.create(null)).then(n=>(this._value=n,this)),this._storageListener=this._storage.onDidChangeStorage(n=>{n.shared===this._shared&&n.key===this._id&&(this._value=n.value)}),this._scheduler=new id(()=>{const n=this._deferredPromises;this._deferredPromises=new Map,(async()=>{try{await this._storage.setValue(this._shared,this._id,this._value);for(const s of n.values())s.complete()}catch(s){for(const o of n.values())o.error(s)}})()},0)}keys(){return Object.entries(this._value??{}).filter(([,e])=>e!==void 0).map(([e])=>e)}get whenReady(){return this._init}get(e,t){let i=this._value[e];return typeof i>"u"&&(i=t),i}update(e,t){this._value[e]=t;const i=this._deferredPromises.get(e);if(i!==void 0)return i.p;const n=new bc;return this._deferredPromises.set(e,n),this._scheduler.isScheduled()||this._scheduler.schedule(),n.p}dispose(){this._storageListener.dispose()}}class S7 extends ZC{setKeysForSync(e){this._storage.registerExtensionStorageKeysToSync({id:this._id,version:this._extension.version},e)}constructor(e,t){super(e.identifier.value,!0,t),this._extension=e}}var ln;let Av=ln=class{constructor(e,t){this._fileSystemProvider=new Map,this._writeQueue=new QE,this._proxy=e.getProxy(J.MainThreadFileSystem);const i=this;this.value=Object.freeze({async stat(n){try{let s;const o=i._fileSystemProvider.get(n.scheme);return o?(await i._proxy.$ensureActivation(n.scheme),s=await o.impl.stat(n)):s=await i._proxy.$stat(n),{type:s.type,ctime:s.ctime,mtime:s.mtime,size:s.size,permissions:s.permissions===Ba.Readonly?1:void 0}}catch(s){ln._handleError(s)}},async readDirectory(n){try{const s=i._fileSystemProvider.get(n.scheme);return s?(await i._proxy.$ensureActivation(n.scheme),(await s.impl.readDirectory(n)).slice()):await i._proxy.$readdir(n)}catch(s){return ln._handleError(s)}},async createDirectory(n){try{const s=i._fileSystemProvider.get(n.scheme);return s&&!s.isReadonly?(await i._proxy.$ensureActivation(n.scheme),await i.mkdirp(s.impl,s.extUri,n)):await i._proxy.$mkdir(n)}catch(s){return ln._handleError(s)}},async readFile(n){try{const s=i._fileSystemProvider.get(n.scheme);return s?(await i._proxy.$ensureActivation(n.scheme),(await s.impl.readFile(n)).slice()):(await i._proxy.$readFile(n)).buffer}catch(s){return ln._handleError(s)}},async writeFile(n,s){try{const o=i._fileSystemProvider.get(n.scheme);return o&&!o.isReadonly?(await i._proxy.$ensureActivation(n.scheme),await i.mkdirp(o.impl,o.extUri,o.extUri.dirname(n)),await i._writeQueue.queueFor(n,()=>Promise.resolve(o.impl.writeFile(n,s,{create:!0,overwrite:!0})))):await i._proxy.$writeFile(n,_e.wrap(s))}catch(o){return ln._handleError(o)}},async delete(n,s){try{const o=i._fileSystemProvider.get(n.scheme);return o&&!o.isReadonly&&!(s!=null&&s.useTrash)?(await i._proxy.$ensureActivation(n.scheme),await o.impl.delete(n,{recursive:!1,...s})):await i._proxy.$delete(n,{recursive:!1,useTrash:!1,atomic:!1,...s})}catch(o){return ln._handleError(o)}},async rename(n,s,o){try{return await i._proxy.$rename(n,s,{overwrite:!1,...o})}catch(a){return ln._handleError(a)}},async copy(n,s,o){try{return await i._proxy.$copy(n,s,{overwrite:!1,...o})}catch(a){return ln._handleError(a)}},isWritableFileSystem(n){const s=t.getCapabilities(n);if(typeof s=="number")return!(s&2048)}})}async mkdirp(e,t,i){const n=[];for(;!t.isEqual(i,t.dirname(i));)try{if(!((await e.stat(i)).type&eo.Directory))throw St.FileExists(`Unable to create folder '${i.scheme===ne.file?i.fsPath:i.toString(!0)}' that already exists but is not a directory`);break}catch(s){if(Km(s)!==Ee.FileNotFound)throw s;n.push(t.basename(i)),i=t.dirname(i)}for(let s=n.length-1;s>=0;s--){i=t.joinPath(i,n[s]);try{await e.createDirectory(i)}catch(o){if(Km(o)!==Ee.FileExists)throw o}}}static _handleError(e){if(e instanceof St)throw e;if(e instanceof Zp)switch(e.code){case Ee.FileExists:throw St.FileExists(e.message);case Ee.FileNotFound:throw St.FileNotFound(e.message);case Ee.FileNotADirectory:throw St.FileNotADirectory(e.message);case Ee.FileIsADirectory:throw St.FileIsADirectory(e.message);case Ee.NoPermissions:throw St.NoPermissions(e.message);case Ee.Unavailable:throw St.Unavailable(e.message);default:throw new St(e.message,e.name)}if(!(e instanceof Error))throw new St(String(e));if(e.name==="ENOPRO"||e.message.includes("ENOPRO"))throw St.Unavailable(e.message);switch(e.name){case Ee.FileExists:throw St.FileExists(e.message);case Ee.FileNotFound:throw St.FileNotFound(e.message);case Ee.FileNotADirectory:throw St.FileNotADirectory(e.message);case Ee.FileIsADirectory:throw St.FileIsADirectory(e.message);case Ee.NoPermissions:throw St.NoPermissions(e.message);case Ee.Unavailable:throw St.Unavailable(e.message);default:throw new St(e.message,e.name)}}addFileSystemProvider(e,t,i){return this._fileSystemProvider.set(e,{impl:t,extUri:i!=null&&i.isCaseSensitive?Ue:UE,isReadonly:!!(i!=null&&i.isReadonly)}),De(()=>this._fileSystemProvider.delete(e))}getFileSystemProviderExtUri(e){var t;return((t=this._fileSystemProvider.get(e))==null?void 0:t.extUri)??Ue}};Av=ln=U([M(0,Ve),M(1,xc)],Av);const ug=Ce("IExtHostConsumerFileSystem"),Qw=Ce("IExtensionStoragePaths");let Rv=class{constructor(e,t,i){this._logService=t,this._extHostFileSystem=i,this._workspace=e.workspace??void 0,this._environment=e.environment,this.whenReady=this._getOrCreateWorkspaceStoragePath().then(n=>this._value=n)}async _getWorkspaceStorageURI(e){return x.joinPath(this._environment.workspaceStorageHome,e)}async _getOrCreateWorkspaceStoragePath(){var i;if(!this._workspace)return Promise.resolve(void 0);const e=this._workspace.id,t=await this._getWorkspaceStorageURI(e);try{return await this._extHostFileSystem.value.stat(t),this._logService.trace("[ExtHostStorage] storage dir already exists",t),t}catch{}try{return this._logService.trace("[ExtHostStorage] creating dir and metadata-file",t),await this._extHostFileSystem.value.createDirectory(t),await this._extHostFileSystem.value.writeFile(x.joinPath(t,"meta.json"),new TextEncoder().encode(JSON.stringify({id:this._workspace.id,configuration:(i=x.revive(this._workspace.configuration))==null?void 0:i.toString(),name:this._workspace.name},void 0,2))),t}catch(n){this._logService.error("[ExtHostStorage]",n);return}}workspaceValue(e){if(this._value)return x.joinPath(this._value,e.identifier.value)}globalValue(e){return x.joinPath(this._environment.globalStorageHome,e.identifier.value.toLowerCase())}onWillDeactivateAll(){}};Rv=U([M(0,jt),M(1,Je),M(2,ug)],Rv);const Jw=Ce("configurationService");var Ty;(function(r){r.Http="http",r.Https="https"})(Ty||(Ty={}));var $s;(function(r){r.ConstantPrivate="constantPrivate",r.Private="private",r.Public="public"})($s||($s={}));var Ay;(function(r){r[r.Notify=1]="Notify",r[r.OpenBrowser=2]="OpenBrowser",r[r.OpenPreview=3]="OpenPreview",r[r.Silent=4]="Silent",r[r.Ignore=5]="Ignore",r[r.OpenBrowserOnce=6]="OpenBrowserOnce"})(Ay||(Ay={}));function E7(r){if(r.scheme!=="http"&&r.scheme!=="https")return;const e=/^(localhost|127\.0\.0\.1|0\.0\.0\.0):(\d+)$/.exec(r.authority);if(e)return{address:e[1],port:+e[2]}}const Lv=["localhost","127.0.0.1","0:0:0:0:0:0:0:1","::1"];function Ry(r){return Lv.indexOf(r)>=0}const $v=["0.0.0.0","0:0:0:0:0:0:0:0","::"];function Ly(r){return $v.indexOf(r)>=0}class k7{constructor(e,t,i){this.remoteAddress=e,this.localAddress=t,this._dispose=i,this._onDispose=new R,this.onDidDispose=this._onDispose.event}dispose(){return this._onDispose.fire(),this._dispose()}}let $y=class{constructor(e,t){this.logService=e,this.configurationService=t,this._onTunnelOpened=new R,this.onTunnelOpened=this._onTunnelOpened.event,this._onTunnelClosed=new R,this.onTunnelClosed=this._onTunnelClosed.event,this._onAddedTunnelProvider=new R,this.onAddedTunnelProvider=this._onAddedTunnelProvider.event,this._tunnels=new Map,this._canElevate=!1,this._canChangeProtocol=!0,this._privacyOptions=[],this._factoryInProgress=new Set}get hasTunnelProvider(){return!!this._tunnelProvider}get defaultTunnelHost(){const e=this.configurationService.getValue("remote.localPortHost");return!e||e==="localhost"?"127.0.0.1":"0.0.0.0"}setTunnelProvider(e){return this._tunnelProvider=e,e?(this._onAddedTunnelProvider.fire(),{dispose:()=>{this._tunnelProvider=void 0,this._canElevate=!1,this._privacyOptions=[]}}):(this._canElevate=!1,this._privacyOptions=[],this._onAddedTunnelProvider.fire(),{dispose:()=>{}})}setTunnelFeatures(e){this._canElevate=e.elevation,this._privacyOptions=e.privacyOptions,this._canChangeProtocol=e.protocol}get canChangeProtocol(){return this._canChangeProtocol}get canElevate(){return this._canElevate}get canChangePrivacy(){return this._privacyOptions.length>0}get privacyOptions(){return this._privacyOptions}get tunnels(){return this.getTunnels()}async getTunnels(){const e=[],t=Array.from(this._tunnels.values());for(const i of t){const n=Array.from(i.values());for(const s of n){const o=await s.value;o&&typeof o!="string"&&e.push(o)}}return e}async dispose(){for(const e of this._tunnels.values()){for(const{value:t}of e.values())await t.then(i=>typeof i!="string"?i==null?void 0:i.dispose():void 0);e.clear()}this._tunnels.clear()}setEnvironmentTunnel(e,t,i,n,s){this.addTunnelToMap(e,t,Promise.resolve({tunnelRemoteHost:e,tunnelRemotePort:t,localAddress:i,privacy:n,protocol:s,dispose:()=>Promise.resolve()}))}async getExistingTunnel(e,t){(Ly(e)||Ry(e))&&(e=Lv[0]);const i=this.getTunnelFromMap(e,t);if(i)return++i.refcount,i.value}openTunnel(e,t,i,n,s,o=!1,a,c){this.logService.trace(`ForwardedPorts: (TunnelService) openTunnel request for ${t}:${i} on local port ${s}.`);const l=this._tunnelProvider??e;if(!l)return;if(t||(t="localhost"),n||(n=this.defaultTunnelHost),this._tunnelProvider&&this._factoryInProgress.has(i)){this.logService.debug("ForwardedPorts: (TunnelService) Another call to create a tunnel with the same address has occurred before the last one completed. This call will be ignored.");return}const u=this.retainOrCreateTunnel(l,t,i,n,s,o,a,c);return u?u.then(d=>{if(d){if(typeof d=="string")return this.logService.trace("ForwardedPorts: (TunnelService) The tunnel provider returned an error when creating the tunnel."),this.removeEmptyOrErrorTunnelFromMap(t,i),d}else{this.logService.trace("ForwardedPorts: (TunnelService) New tunnel is undefined."),this.removeEmptyOrErrorTunnelFromMap(t,i);return}this.logService.trace("ForwardedPorts: (TunnelService) New tunnel established.");const f=this.makeTunnel(d);return(d.tunnelRemoteHost!==t||d.tunnelRemotePort!==i)&&this.logService.warn("ForwardedPorts: (TunnelService) Created tunnel does not match requirements of requested tunnel. Host or port mismatch."),a&&d.privacy!==a&&this.logService.warn("ForwardedPorts: (TunnelService) Created tunnel does not match requirements of requested tunnel. Privacy mismatch."),this._onTunnelOpened.fire(f),f}):(this.logService.trace("ForwardedPorts: (TunnelService) Tunnel was not created."),u)}makeTunnel(e){return{tunnelRemotePort:e.tunnelRemotePort,tunnelRemoteHost:e.tunnelRemoteHost,tunnelLocalPort:e.tunnelLocalPort,localAddress:e.localAddress,privacy:e.privacy,protocol:e.protocol,dispose:async()=>{this.logService.trace(`ForwardedPorts: (TunnelService) dispose request for ${e.tunnelRemoteHost}:${e.tunnelRemotePort} `);const t=this._tunnels.get(e.tunnelRemoteHost);if(t){const i=t.get(e.tunnelRemotePort);i&&(i.refcount--,await this.tryDisposeTunnel(e.tunnelRemoteHost,e.tunnelRemotePort,i))}}}}async tryDisposeTunnel(e,t,i){if(i.refcount<=0){this.logService.trace(`ForwardedPorts: (TunnelService) Tunnel is being disposed ${e}:${t}.`);const n=i.value.then(async s=>{s&&typeof s!="string"&&(await s.dispose(!0),this._onTunnelClosed.fire({host:s.tunnelRemoteHost,port:s.tunnelRemotePort}))});return this._tunnels.has(e)&&this._tunnels.get(e).delete(t),n}}async closeTunnel(e,t){this.logService.trace(`ForwardedPorts: (TunnelService) close request for ${e}:${t} `);const i=this._tunnels.get(e);if(i&&i.has(t)){const n=i.get(t);n.refcount=0,await this.tryDisposeTunnel(e,t,n)}}addTunnelToMap(e,t,i){this._tunnels.has(e)||this._tunnels.set(e,new Map),this._tunnels.get(e).set(t,{refcount:1,value:i})}async removeEmptyOrErrorTunnelFromMap(e,t){const i=this._tunnels.get(e);if(i){const n=i.get(t),s=n?await n.value:void 0;(!s||typeof s=="string")&&i.delete(t),i.size===0&&this._tunnels.delete(e)}}getTunnelFromMap(e,t){const i=[e];Ry(e)?(i.push(...Lv),i.push(...$v)):Ly(e)&&i.push(...$v);const n=i.map(s=>this._tunnels.get(s));for(const s of n){const o=s==null?void 0:s.get(t);if(o)return o}}canTunnel(e){return!!E7(e)}createWithProvider(e,t,i,n,s,o,a){this.logService.trace(`ForwardedPorts: (TunnelService) Creating tunnel with provider ${t}:${i} on local port ${n}.`);const c=i;this._factoryInProgress.add(c);const l=n===void 0?i:n,u={elevationRequired:s?this.isPortPrivileged(l):!1},d={remoteAddress:{host:t,port:i},localAddressPort:n,privacy:o,public:o?o!==$s.Private:void 0,protocol:a},f=e.forwardPort(d,u);return f?(this.addTunnelToMap(t,i,f),f.finally(()=>{this.logService.trace("ForwardedPorts: (TunnelService) Tunnel created by provider."),this._factoryInProgress.delete(c)})):this._factoryInProgress.delete(c),f}};$y=U([M(0,Je),M(1,Jw)],$y);const Ny="vs/workbench/api/common/extHostTunnelService";class D7 extends k7{}var Nv;(function(r){function e(i){return{remoteAddress:i.remoteAddress,localAddress:i.localAddress,public:!!i.public,privacy:i.privacy??(i.public?$s.Public:$s.Private),protocol:i.protocol}}r.fromApiTunnel=e;function t(i){return{remoteAddress:{host:i.tunnelRemoteHost,port:i.tunnelRemotePort},localAddress:i.localAddress,public:i.privacy!==$s.ConstantPrivate&&i.privacy!==$s.ConstantPrivate,privacy:i.privacy,protocol:i.protocol}}r.fromServiceTunnel=t})(Nv||(Nv={}));const Kw=Ce("IExtHostTunnelService");let Mv=class extends Fe{constructor(e,t,i){super(),this.logService=i,this._showCandidatePort=()=>Promise.resolve(!0),this._extensionTunnels=new Map,this._onDidChangeTunnels=new R,this.onDidChangeTunnels=this._onDidChangeTunnels.event,this._providerHandleCounter=0,this._portAttributesProviders=new Map,this._proxy=e.getProxy(J.MainThreadTunnelService)}async openTunnel(e,t){this.logService.trace(`ForwardedPorts: (ExtHostTunnelService) ${e.identifier.value} called openTunnel API for ${t.remoteAddress.host}:${t.remoteAddress.port}.`);const i=await this._proxy.$openTunnel(t,e.displayName);if(i){const n=new D7(i.remoteAddress,i.localAddress,()=>this._proxy.$closeTunnel(i.remoteAddress));return this._register(n),n}}async getTunnels(){return this._proxy.$getTunnels()}nextPortAttributesProviderHandle(){return this._providerHandleCounter++}registerPortsAttributesProvider(e,t){e.portRange===void 0&&e.commandPattern===void 0&&this.logService.error("PortAttributesProvider must specify either a portRange or a commandPattern");const i=this.nextPortAttributesProviderHandle();return this._portAttributesProviders.set(i,{selector:e,provider:t}),this._proxy.$registerPortsAttributesProvider(e,i),new Ne(()=>{this._portAttributesProviders.delete(i),this._proxy.$unregisterPortsAttributesProvider(i)})}async $providePortAttributes(e,t,i,n,s){const o=[];for(const c of e){const l=this._portAttributesProviders.get(c);if(!l)return[];o.push(...await Promise.all(t.map(async u=>{let d;try{d=await l.provider.providePortAttributes({port:u,pid:i,commandLine:n},s)}catch{d=await l.provider.providePortAttributes(u,i,n,s)}return{providedAttributes:d,port:u}})))}const a=o.filter(c=>!!c.providedAttributes);return a.length>0?a.map(c=>({autoForwardAction:c.providedAttributes.autoForwardAction,port:c.port})):[]}async $registerCandidateFinder(e){}registerTunnelProvider(e,t){var n,s;if(this._forwardPortProvider)throw new Error("A tunnel provider has already been registered. Only the first tunnel provider to be registered will be used.");this._forwardPortProvider=async(o,a)=>await e.provideTunnel(o,a,bt.None)??void 0;const i=t.tunnelFeatures?{elevation:!!((n=t.tunnelFeatures)!=null&&n.elevation),privacyOptions:(s=t.tunnelFeatures)==null?void 0:s.privacyOptions,protocol:t.tunnelFeatures.protocol===void 0?!0:t.tunnelFeatures.protocol}:void 0;return this._proxy.$setTunnelProvider(i),Promise.resolve(De(()=>{this._forwardPortProvider=void 0,this._proxy.$setTunnelProvider(void 0)}))}async setTunnelFactory(e,t){var i,n,s,o;if(e){e.candidatePortSource!==void 0&&this._proxy.$setCandidatePortSource(e.candidatePortSource),e.showCandidatePort&&(this._showCandidatePort=e.showCandidatePort,this._proxy.$setCandidateFilter());const a=e.tunnelFactory??(t?this.makeManagedTunnelFactory(t):void 0);if(a){this._forwardPortProvider=a;let c=((i=e.tunnelFeatures)==null?void 0:i.privacyOptions)??[];(n=e.tunnelFeatures)!=null&&n.public&&c.length===0&&(c=[{id:"private",label:h(Ny,0,"Private"),themeIcon:"lock"},{id:"public",label:h(Ny,1,"Public"),themeIcon:"eye"}]);const l=e.tunnelFeatures?{elevation:!!((s=e.tunnelFeatures)!=null&&s.elevation),public:!!((o=e.tunnelFeatures)!=null&&o.public),privacyOptions:c,protocol:!0}:void 0;this._proxy.$setTunnelProvider(l)}}else this._forwardPortProvider=void 0;return De(()=>{this._forwardPortProvider=void 0})}makeManagedTunnelFactory(e){}async $closeTunnel(e,t){if(this._extensionTunnels.has(e.host)){const i=this._extensionTunnels.get(e.host);i.has(e.port)&&(t&&i.get(e.port).disposeListener.dispose(),await i.get(e.port).tunnel.dispose(),i.delete(e.port))}}async $onDidTunnelsChange(){this._onDidChangeTunnels.fire()}async $forwardPort(e,t){if(this._forwardPortProvider)try{this.logService.trace("ForwardedPorts: (ExtHostTunnelService) Getting tunnel from provider.");const i=this._forwardPortProvider(e,t);if(this.logService.trace("ForwardedPorts: (ExtHostTunnelService) Got tunnel promise from provider."),i!==void 0){const n=await i;if(this.logService.trace("ForwardedPorts: (ExtHostTunnelService) Successfully awaited tunnel from provider."),n===void 0){this.logService.error("ForwardedPorts: (ExtHostTunnelService) Resolved tunnel is undefined");return}this._extensionTunnels.has(e.remoteAddress.host)||this._extensionTunnels.set(e.remoteAddress.host,new Map);const s=this._register(n.onDidDispose(()=>(this.logService.trace("ForwardedPorts: (ExtHostTunnelService) Extension fired tunnel's onDidDispose."),this._proxy.$closeTunnel(n.remoteAddress))));return this._extensionTunnels.get(e.remoteAddress.host).set(e.remoteAddress.port,{tunnel:n,disposeListener:s}),Nv.fromApiTunnel(n)}else this.logService.trace("ForwardedPorts: (ExtHostTunnelService) Tunnel is undefined")}catch(i){if(this.logService.trace("ForwardedPorts: (ExtHostTunnelService) tunnel provider error"),i instanceof Error)return i.message}}async $applyCandidateFilter(e){const t=await Promise.all(e.map(n=>this._showCandidatePort(n.host,n.port,n.detail??""))),i=e.filter((n,s)=>t[s]);return this.logService.trace(`ForwardedPorts: (ExtHostTunnelService) filtered from ${e.map(n=>n.port).join(", ")} to ${i.map(n=>n.port).join(", ")}`),i}};Mv=U([M(0,Ve),M(1,jt),M(2,Je)],Mv);function I7(r){return[...r.entries()]}function P7(r){return r?[...r.entries()]:[]}class T7{constructor(e){this._callback=e,this._terminalBufferMap=new Map}dispose(){for(const e of this._terminalBufferMap.values())e.dispose()}startBuffering(e,t,i=5){const n=t(s=>{const o=typeof s=="string"?s:s.data;let a=this._terminalBufferMap.get(e);if(a){a.data.push(o);return}const c=setTimeout(()=>this.flushBuffer(e),i);a={data:[o],timeoutId:c,dispose:()=>{clearTimeout(c),this.flushBuffer(e),n.dispose()}},this._terminalBufferMap.set(e,a)});return n}stopBuffering(e){const t=this._terminalBufferMap.get(e);t==null||t.dispose()}flushBuffer(e){const t=this._terminalBufferMap.get(e);t&&(this._terminalBufferMap.delete(e),this._callback(e,t.data.join("")))}}const ls=(r,e,t,i)=>{let n=e;return{enumerable:!0,configurable:!1,get(){return n},set(s){var o;if(!t(n,s)){const a=n;n=s,(o=r.listener)==null||o.call(r,i(s,a))}}}},Ho=(r,e)=>r===e,vr={range:(r,e)=>r===e?!0:!r||!e?!1:r.isEqual(e),label:Ho,description:Ho,sortText:Ho,busy:Ho,error:Ho,canResolveChildren:Ho,tags:(r,e)=>!(r.length!==e.length||r.some(t=>!e.find(i=>t.id===i.id)))},Uo=r=>e=>({op:4,update:r(e)}),A7=(r,e)=>({range:(()=>{let t;const i=Uo(n=>({range:Qe.lift(H.from(n))}));return{enumerable:!0,configurable:!1,get(){return t},set(n){var s,o;(s=r.listener)==null||s.call(r,{op:6}),vr.range(t,n)||(t=n,(o=r.listener)==null||o.call(r,i(n)))}}})(),label:ls(r,e,vr.label,Uo(t=>({label:t}))),description:ls(r,void 0,vr.description,Uo(t=>({description:t}))),sortText:ls(r,void 0,vr.sortText,Uo(t=>({sortText:t}))),canResolveChildren:ls(r,!1,vr.canResolveChildren,t=>({op:2,state:t})),busy:ls(r,!1,vr.busy,Uo(t=>({busy:t}))),error:ls(r,void 0,vr.error,Uo(t=>({error:Le.fromStrict(t)||null}))),tags:ls(r,[],vr.tags,(t,i)=>({op:1,new:t.map(on.from),old:i.map(on.from)}))}),R7=r=>{const e=ye.fromString(r.extId),t=new Do(e.controllerId,e.localId,r.label,x.revive(r.uri)||void 0);return t.range=H.to(r.range||void 0),t.description=r.description||void 0,t.sortText=r.sortText||void 0,t.tags=r.tags.map(i=>on.to({id:cC(i).tagId})),t},My=r=>{let e;for(const t of r.tests){const i=R7(t.item);Xp(i).parent=e,e=i}return e};class Do{constructor(e,t,i,n){if(t.includes("\0"))throw new Error(`Test IDs may not include the ${JSON.stringify(t)} symbol`);const s=L5(this,e);Object.defineProperties(this,{id:{value:t,enumerable:!0,writable:!1},uri:{value:n,enumerable:!0,writable:!1},parent:{enumerable:!1,get(){return s.parent instanceof Xw?void 0:s.parent}},children:{value:R5(s,Xp,Do),enumerable:!0,writable:!1},...A7(s,i)})}}class Xw extends Do{constructor(e,t){super(e,e,t,void 0),this._isRoot=!0}}class L7 extends P5{constructor(e,t,i){super({controllerId:e,getDocumentVersion:n=>{var s;return n&&((s=i.getDocument(n))==null?void 0:s.version)},getApiFor:Xp,getChildren:n=>n.children,root:new Xw(e,t),toITestItem:es.from})}}const $7="vs/workbench/api/common/extHostTelemetry";let Fv=class extends Fe{constructor(e,t){super(),this.initData=e,this.loggerService=t,this._onDidChangeTelemetryEnabled=this._register(new R),this.onDidChangeTelemetryEnabled=this._onDidChangeTelemetryEnabled.event,this._onDidChangeTelemetryConfiguration=this._register(new R),this.onDidChangeTelemetryConfiguration=this._onDidChangeTelemetryConfiguration.event,this._productConfig={usage:!0,error:!0},this._level=0,this._telemetryIsSupported=!1,this._inLoggingOnlyMode=!1,this._telemetryLoggers=new Map,this.extHostTelemetryLogFile=x.revive(this.initData.environment.extensionTelemetryLogResource),this._inLoggingOnlyMode=this.initData.environment.isExtensionTelemetryLoggingOnly,this._outputLogger=t.createLogger(this.extHostTelemetryLogFile,{id:p7,name:h($7,0,"Extension Telemetry{0}",this._inLoggingOnlyMode?" (Not Sent)":""),hidden:!0}),this._register(this._outputLogger),this._register(t.onDidChangeLogLevel(i=>{ID(i)&&this.updateLoggerVisibility()})),this._outputLogger.info("Below are logs for extension telemetry events sent to the telemetry output channel API once the log level is set to trace."),this._outputLogger.info("===========================================================")}updateLoggerVisibility(){this.loggerService.setVisibility(this.extHostTelemetryLogFile,this._telemetryIsSupported&&this.loggerService.getLogLevel()===Me.Trace)}getTelemetryConfiguration(){return this._level===3}getTelemetryDetails(){return{isCrashEnabled:this._level>=1,isErrorsEnabled:this._productConfig.error?this._level>=2:!1,isUsageEnabled:this._productConfig.usage?this._level>=3:!1}}instantiateLogger(e,t,i){const n=this.getTelemetryDetails(),s=new YC(t,i,e,this._outputLogger,this._inLoggingOnlyMode,this.getBuiltInCommonProperties(e),{isUsageEnabled:n.isUsageEnabled,isErrorsEnabled:n.isErrorsEnabled}),o=this._telemetryLoggers.get(e.identifier.value)??[];return this._telemetryLoggers.set(e.identifier.value,[...o,s]),s.apiTelemetryLogger}$initializeTelemetryLevel(e,t,i){this._level=e,this._telemetryIsSupported=t,this._productConfig=i??{usage:!0,error:!0},this.updateLoggerVisibility()}getBuiltInCommonProperties(e){const t=Object.create(null);switch(t["common.extname"]=`${e.publisher}.${e.name}`,t["common.extversion"]=e.version,t["common.vscodemachineid"]=this.initData.telemetryInfo.machineId,t["common.vscodesessionid"]=this.initData.telemetryInfo.sessionId,t["common.sqmid"]=this.initData.telemetryInfo.sqmId,t["common.vscodeversion"]=this.initData.version,t["common.isnewappinstall"]=eS(this.initData.telemetryInfo.firstSessionDate),t["common.product"]=this.initData.environment.appHost,this.initData.uiKind){case Tl.Web:t["common.uikind"]="web";break;case Tl.Desktop:t["common.uikind"]="desktop";break;default:t["common.uikind"]="unknown"}return t["common.remotename"]=Nw(m7(this.initData.remote.authority)),t}$onDidChangeTelemetryLevel(e){this._oldTelemetryEnablement=this.getTelemetryConfiguration(),this._level=e;const t=this.getTelemetryDetails();this._telemetryLoggers.forEach((i,n)=>{const s=i.filter(o=>!o.isDisposed);s.length===0?this._telemetryLoggers.delete(n):this._telemetryLoggers.set(n,s)}),this._telemetryLoggers.forEach(i=>{for(const n of i)n.updateTelemetryEnablements(t.isUsageEnabled,t.isErrorsEnabled)}),this._oldTelemetryEnablement!==this.getTelemetryConfiguration()&&this._onDidChangeTelemetryEnabled.fire(this.getTelemetryConfiguration()),this._onDidChangeTelemetryConfiguration.fire(this.getTelemetryDetails()),this.updateLoggerVisibility()}onExtensionError(e,t){const i=this._telemetryLoggers.get(e.value),n=i==null?void 0:i.filter(o=>!o.isDisposed);if(!n)return this._telemetryLoggers.delete(e.value),!1;let s=!1;for(const o of n)o.ignoreUnhandledExtHostErrors||(o.logError(t),s=!0);return s}};Fv=U([M(0,jt),M(1,yc)],Fv);class YC{static validateSender(e){if(typeof e!="object")throw new TypeError("TelemetrySender argument is invalid");if(typeof e.sendEventData!="function")throw new TypeError("TelemetrySender.sendEventData must be a function");if(typeof e.sendErrorData!="function")throw new TypeError("TelemetrySender.sendErrorData must be a function");if(typeof e.flush<"u"&&typeof e.flush!="function")throw new TypeError("TelemetrySender.flush must be a function or undefined")}constructor(e,t,i,n,s,o,a){this._extension=i,this._logger=n,this._inLoggingOnlyMode=s,this._commonProperties=o,this._onDidChangeEnableStates=new R,this.ignoreUnhandledExtHostErrors=(t==null?void 0:t.ignoreUnhandledErrors)??!1,this._ignoreBuiltinCommonProperties=(t==null?void 0:t.ignoreBuiltInCommonProperties)??!1,this._additionalCommonProperties=t==null?void 0:t.additionalCommonProperties,this._sender=e,this._telemetryEnablements={isUsageEnabled:a.isUsageEnabled,isErrorsEnabled:a.isErrorsEnabled}}updateTelemetryEnablements(e,t){this._apiObject&&(this._telemetryEnablements={isUsageEnabled:e,isErrorsEnabled:t},this._onDidChangeEnableStates.fire(this._apiObject))}mixInCommonPropsAndCleanData(e){let t="properties"in e?e.properties??{}:e;return t=Dy(t,[]),this._additionalCommonProperties&&(t=po(t,this._additionalCommonProperties)),this._ignoreBuiltinCommonProperties||(t=po(t,this._commonProperties)),"properties"in e?e.properties=t:e=t,e}logEvent(e,t){var i;this._sender&&(this._extension.publisher==="vscode"?e=this._extension.name+"/"+e:e=this._extension.identifier.value+"/"+e,t=this.mixInCommonPropsAndCleanData(t||{}),this._inLoggingOnlyMode||(i=this._sender)==null||i.sendEventData(e,t),this._logger.trace(e,t))}logUsage(e,t){this._telemetryEnablements.isUsageEnabled&&this.logEvent(e,t)}logError(e,t){if(!(!this._telemetryEnablements.isErrorsEnabled||!this._sender))if(typeof e=="string")this.logEvent(e,t);else{const i={name:e.name,message:e.message,stack:e.stack,cause:e.cause},n=Dy(i,[]),s=new Error(n.message,{cause:n.cause});s.stack=n.stack,s.name=n.name,t=this.mixInCommonPropsAndCleanData(t||{}),this._inLoggingOnlyMode||this._sender.sendErrorData(s,t),this._logger.trace("exception",t)}}get apiTelemetryLogger(){if(!this._apiObject){const e=this,t={logUsage:e.logUsage.bind(e),get isUsageEnabled(){return e._telemetryEnablements.isUsageEnabled},get isErrorsEnabled(){return e._telemetryEnablements.isErrorsEnabled},logError:e.logError.bind(e),dispose:e.dispose.bind(e),onDidChangeEnableStates:e._onDidChangeEnableStates.event.bind(e)};this._apiObject=Object.freeze(t)}return this._apiObject}get isDisposed(){return!this._sender}dispose(){var e;if((e=this._sender)!=null&&e.flush){let t=this._sender;this._sender=void 0,Promise.resolve(t.flush()).then(t=void 0),this._apiObject=void 0}else this._sender=void 0}}function eS(r){const e=Date.now()-new Date(r).getTime();return isNaN(e)?!1:e<1e3*60*60*24}const dg=Ce("IExtHostTelemetry");var Vn,Fu,Ou,ax;let Ov=(ax=class{constructor(e,t,i){ue(this,Vn,void 0);ue(this,Fu,void 0);ue(this,Ou,void 0);this._commands=new Map,this._apiCommands=new Map,K(this,Vn,e.getProxy(J.MainThreadCommands)),this._logService=t,K(this,Ou,i),K(this,Fu,e.getProxy(J.MainThreadTelemetry)),this.converter=new N7(this,n=>{const s=this._apiCommands.get(n);return(s==null?void 0:s.result)===ve.Void?s:void 0},t),this._argumentProcessors=[{processArgument(n){return En(n)}},{processArgument(n){return bh(n,function(s){if(Qe.isIRange(s))return H.to(s);if(Mi.isIPosition(s))return qe.to(s);if(Qe.isIRange(s.range)&&x.isUri(s.uri))return Ai.to(s);if(s instanceof _e)return s.buffer.buffer;if(!Array.isArray(s))return s})}}]}registerArgumentProcessor(e){this._argumentProcessors.push(e)}registerApiCommand(e){const t=this.registerCommand(!1,e.id,async(...i)=>{const n=e.args.map((o,a)=>{if(!o.validate(i[a]))throw new Error(`Invalid argument '${o.name}' when running '${e.id}', received: ${typeof i[a]=="object"?JSON.stringify(i[a],null,"	"):i[a]} `);return o.convert(i[a])}),s=await this.executeCommand(e.internalId,...n);return e.result.convert(s,i,this.converter)},void 0,{description:e.description,args:e.args,returns:e.result.description});return this._apiCommands.set(e.id,e),new Ne(()=>{t.dispose(),this._apiCommands.delete(e.id)})}registerCommand(e,t,i,n,s,o){if(this._logService.trace("ExtHostCommands#registerCommand",t),!t.trim().length)throw new Error("invalid id");if(this._commands.has(t))throw new Error(`command '${t}' already exists`);return this._commands.set(t,{callback:i,thisArg:n,metadata:s,extension:o}),e&&P(this,Vn).$registerCommand(t),new Ne(()=>{this._commands.delete(t)&&e&&P(this,Vn).$unregisterCommand(t)})}executeCommand(e,...t){return this._logService.trace("ExtHostCommands#executeCommand",e),this._doExecuteCommand(e,t,!0)}async _doExecuteCommand(e,t,i){if(this._commands.has(e))return P(this,Vn).$fireCommandActivationEvent(e),this._executeContributedCommand(e,t,!1);{let n=!1;const s=bh(t,function(o){if(o instanceof ke)return qe.from(o);if(o instanceof xe)return H.from(o);if(o instanceof Pi)return Ai.from(o);if(Kn.isNotebookRange(o))return Cn.from(o);if(o instanceof ArrayBuffer)return n=!0,_e.wrap(new Uint8Array(o));if(o instanceof Uint8Array)return n=!0,_e.wrap(o);if(o instanceof _e)return n=!0,o;if(!Array.isArray(o))return o});try{const o=await P(this,Vn).$executeCommand(e,n?new Di(s):s,i);return En(o)}catch(o){if(o instanceof Error&&o.message==="$executeCommand:retry")return this._doExecuteCommand(e,t,!1);throw o}}}async _executeContributedCommand(e,t,i){var l,u,d;const n=this._commands.get(e);if(!n)throw new Error("Unknown command");const{callback:s,thisArg:o,metadata:a}=n;if(a!=null&&a.args)for(let f=0;f<a.args.length;f++)try{TE(t[f],a.args[f].constraint)}catch{throw new Error(`Running the contributed command: '${e}' failed. Illegal argument '${a.args[f].name}' - ${a.args[f].description}`)}const c=rr.create();try{return await s.apply(o,t)}catch(f){if(e===this.converter.delegatingCommandId){const m=this.converter.getActualCommand(...t);m&&(e=m.command)}if(this._logService.error(f,e,(l=n.extension)==null?void 0:l.identifier),!i)throw f;if((u=n.extension)!=null&&u.identifier){const m=P(this,Ou).onExtensionError(n.extension.identifier,f);this._logService.trace("forwarded error to extension?",m,(d=n.extension)==null?void 0:d.identifier)}throw new class extends Error{constructor(){var b,_;super(Sc(f)),this.id=e,this.source=((b=n.extension)==null?void 0:b.displayName)??((_=n.extension)==null?void 0:_.name)}}}finally{this._reportTelemetry(n,e,c.elapsed())}}_reportTelemetry(e,t,i){e.extension&&P(this,Fu).$publicLog2("Extension:ActionExecuted",{extensionId:e.extension.identifier.value,id:new qw(t),duration:i})}$executeContributedCommand(e,...t){this._logService.trace("ExtHostCommands#$executeContributedCommand",e);const i=this._commands.get(e);return i?(t=t.map(n=>this._argumentProcessors.reduce((s,o)=>{var a;return o.processArgument(s,(a=i.extension)==null?void 0:a.identifier)},n)),this._executeContributedCommand(e,t,!0)):Promise.reject(new Error(`Contributed command '${e}' does not exist.`))}getCommands(e=!1){return this._logService.trace("ExtHostCommands#getCommands",e),P(this,Vn).$getCommands().then(t=>(e&&(t=t.filter(i=>i[0]!=="_")),t))}$getContributedCommandMetadata(){const e=Object.create(null);for(const[t,i]of this._commands){const{metadata:n}=i;n&&(e[t]=n)}return Promise.resolve(e)}},Vn=new WeakMap,Fu=new WeakMap,Ou=new WeakMap,ax);Ov=U([M(0,Ve),M(1,Je),M(2,dg)],Ov);const Ec=Ce("IExtHostCommands");class N7{constructor(e,t,i){this._commands=e,this._lookupApiCommand=t,this._logService=i,this.delegatingCommandId=`__vsc${ar()}`,this._cache=new Map,this._cachIdPool=0,this._commands.registerCommand(!0,this.delegatingCommandId,this._executeConvertedCommand,this)}toInternal(e,t){if(!e)return;const i={$ident:void 0,id:e.command,title:e.title,tooltip:e.tooltip};if(!e.command)return i;const n=this._lookupApiCommand(e.command);if(n)i.id=n.internalId,i.arguments=n.args.map((s,o)=>s.convert(e.arguments&&e.arguments[o]));else if(Zu(e.arguments)){const s=`${e.command} /${++this._cachIdPool}`;this._cache.set(s,e),t.add(De(()=>{this._cache.delete(s),this._logService.trace("CommandsConverter#DISPOSE",s)})),i.$ident=s,i.id=this.delegatingCommandId,i.arguments=[s],this._logService.trace("CommandsConverter#CREATE",e.command,s)}return i}fromInternal(e){return typeof e.$ident=="string"?this._cache.get(e.$ident):{command:e.id,title:e.title,arguments:e.arguments}}getActualCommand(...e){return this._cache.get(e[0])}_executeConvertedCommand(...e){const t=this.getActualCommand(...e);return this._logService.trace("CommandsConverter#EXECUTE",e[0],t?t.command:"MISSING"),t?this._commands.executeCommand(t.command,...t.arguments||[]):Promise.reject(`Actual command not found, wanted to execute ${e[0]}`)}}const dt=class dt{static Arr(e){return new dt(`${e.name}_array`,`Array of ${e.name}, ${e.description}`,t=>Array.isArray(t)&&t.every(i=>e.validate(i)),t=>t.map(i=>e.convert(i)))}constructor(e,t,i,n){this.name=e,this.description=t,this.validate=i,this.convert=n}optional(){return new dt(this.name,`(optional) ${this.description}`,e=>e==null||this.validate(e),e=>e===void 0?void 0:e===null?null:this.convert(e))}with(e,t){return new dt(e??this.name,t??this.description,this.validate,this.convert)}};dt.Uri=new dt("uri","Uri of a text document",e=>x.isUri(e),e=>e),dt.Position=new dt("position","A position in a text document",e=>ke.isPosition(e),qe.from),dt.Range=new dt("range","A range in a text document",e=>xe.isRange(e),H.from),dt.Selection=new dt("selection","A selection in a text document",e=>sr.isSelection(e),Fi.from),dt.Number=new dt("number","",e=>typeof e=="number",e=>e),dt.String=new dt("string","",e=>typeof e=="string",e=>e),dt.StringArray=dt.Arr(dt.String),dt.CallHierarchyItem=new dt("item","A call hierarchy item",e=>e instanceof Mw,_o.from),dt.TypeHierarchyItem=new dt("item","A type hierarchy item",e=>e instanceof Uw,ao.from),dt.TestItem=new dt("testItem","A VS Code TestItem",e=>e instanceof Do,es.from);let z=dt;const Ip=class Ip{constructor(e,t){this.description=e,this.convert=t}};Ip.Void=new Ip("no result",e=>e);let ve=Ip;class be{constructor(e,t,i,n,s){this.id=e,this.internalId=t,this.description=i,this.args=n,this.result=s}}const M7="vs/workbench/api/common/extHostTerminalService",kc=Ce("IExtHostTerminalService");class Fy extends Fe{constructor(e,t,i,n){super(),this._proxy=e,this._id=t,this._creationOptions=i,this._name=n,this._disposed=!1,this._state={isInteractedWith:!1},this.isOpen=!1,this._onWillDispose=this._register(new R),this.onWillDispose=this._onWillDispose.event,this._creationOptions=Object.freeze(this._creationOptions),this._pidPromise=new Promise(o=>this._pidPromiseComplete=o);const s=this;this.value={get name(){return s._name||""},get processId(){return s._pidPromise},get creationOptions(){return s._creationOptions},get exitStatus(){return s._exitStatus},get state(){return s._state},get selection(){return s._selection},get shellIntegration(){return s.shellIntegration},sendText(o,a=!0){s._checkDisposed(),s._proxy.$sendText(s._id,o,a)},show(o){s._checkDisposed(),s._proxy.$show(s._id,o)},hide(){s._checkDisposed(),s._proxy.$hide(s._id)},dispose(){s._disposed||(s._disposed=!0,s._proxy.$dispose(s._id))},get dimensions(){if(!(s._cols===void 0||s._rows===void 0))return{columns:s._cols,rows:s._rows}}}}dispose(){this._onWillDispose.fire(),super.dispose()}async create(e,t){if(typeof this._id!="string")throw new Error("Terminal has already been created");await this._proxy.$createTerminal(this._id,{name:e.name,shellPath:e.shellPath??void 0,shellArgs:e.shellArgs??void 0,cwd:e.cwd??(t==null?void 0:t.cwd)??void 0,env:e.env??void 0,icon:tS(e.iconPath)??void 0,color:Ha.isThemeColor(e.color)?e.color.id:void 0,initialText:e.message??void 0,strictEnv:e.strictEnv??void 0,hideFromUser:e.hideFromUser??void 0,forceShellIntegration:(t==null?void 0:t.forceShellIntegration)??void 0,isFeatureTerminal:(t==null?void 0:t.isFeatureTerminal)??void 0,isExtensionOwnedTerminal:!0,useShellEnvironment:(t==null?void 0:t.useShellEnvironment)??void 0,location:(t==null?void 0:t.location)||this._serializeParentTerminal(e.location,t==null?void 0:t.resolvedExtHostIdentifier),isTransient:e.isTransient??void 0})}async createExtensionTerminal(e,t,i,n,s){if(typeof this._id!="string")throw new Error("Terminal has already been created");if(await this._proxy.$createTerminal(this._id,{name:this._name,isExtensionCustomPtyTerminal:!0,icon:n,color:Ha.isThemeColor(s)?s.id:void 0,location:(t==null?void 0:t.location)||this._serializeParentTerminal(e,i),isTransient:!0}),typeof this._id=="string")throw new Error("Terminal creation failed");return this._id}_serializeParentTerminal(e,t){return typeof e=="object"?"parentTerminal"in e&&e.parentTerminal&&t?{parentTerminal:t}:"viewColumn"in e?{viewColumn:Et.from(e.viewColumn),preserveFocus:e.preserveFocus}:void 0:e}_checkDisposed(){if(this._disposed)throw new Error("Terminal has already been disposed")}set name(e){this._name=e}setExitStatus(e,t){this._exitStatus=Object.freeze({code:e,reason:t})}setDimensions(e,t){return e===this._cols&&t===this._rows||e===0||t===0?!1:(this._cols=e,this._rows=t,!0)}setInteractedWith(){return this._state.isInteractedWith?!1:(this._state={isInteractedWith:!0},!0)}setSelection(e){this._selection=e}_setProcessId(e){this._pidPromiseComplete?(this._pidPromiseComplete(e),this._pidPromiseComplete=void 0):this._pidPromise.then(t=>{t!==e&&(this._pidPromise=Promise.resolve(e))})}}class em{get onProcessReady(){return this._onProcessReady.event}constructor(e){this._pty=e,this.id=0,this.shouldPersist=!1,this._onProcessData=new R,this.onProcessData=this._onProcessData.event,this._onProcessReady=new R,this._onDidChangeProperty=new R,this.onDidChangeProperty=this._onDidChangeProperty.event,this._onProcessExit=new R,this.onProcessExit=this._onProcessExit.event}refreshProperty(e){throw new Error(`refreshProperty is not suppported in extension owned terminals. property: ${e}`)}updateProperty(e,t){throw new Error(`updateProperty is not suppported in extension owned terminals. property: ${e}, value: ${t}`)}async start(){}shutdown(){this._pty.close()}input(e){var t,i;(i=(t=this._pty).handleInput)==null||i.call(t,e)}resize(e,t){var i,n;(n=(i=this._pty).setDimensions)==null||n.call(i,{columns:e,rows:t})}clearBuffer(){}async processBinary(e){}acknowledgeDataEvent(e){}async setUnicodeVersion(e){}getInitialCwd(){return Promise.resolve("")}getCwd(){return Promise.resolve("")}startSendingEvents(e){var t,i,n,s,o,a,c,l;this._pty.onDidWrite(u=>this._onProcessData.fire(u)),(i=(t=this._pty).onDidClose)==null||i.call(t,(u=void 0)=>{this._onProcessExit.fire(u===void 0?void 0:u)}),(s=(n=this._pty).onDidOverrideDimensions)==null||s.call(n,u=>{u&&this._onDidChangeProperty.fire({type:"overrideDimensions",value:{cols:u.columns,rows:u.rows}})}),(a=(o=this._pty).onDidChangeName)==null||a.call(o,u=>{this._onDidChangeProperty.fire({type:"title",value:u})}),this._pty.open(e||void 0),e&&((l=(c=this._pty).setDimensions)==null||l.call(c,e)),this._onProcessReady.fire({pid:-1,cwd:"",windowsPty:void 0})}}let F7=1,Hv=class extends Fe{get activeTerminal(){var e;return(e=this._activeTerminal)==null?void 0:e.value}get terminals(){return this._terminals.map(e=>e.value)}constructor(e,t,i){super(),this._extHostCommands=t,this._terminals=[],this._terminalProcesses=new Map,this._terminalProcessDisposables={},this._extensionTerminalAwaitingStart={},this._getTerminalPromises={},this._environmentVariableCollections=new Map,this._lastQuickFixCommands=this._register(new zo),this._linkProviders=new Set,this._profileProviders=new Map,this._quickFixProviders=new Map,this._terminalLinkCache=new Map,this._terminalLinkCancellationSource=new Map,this._onDidCloseTerminal=new R,this.onDidCloseTerminal=this._onDidCloseTerminal.event,this._onDidOpenTerminal=new R,this.onDidOpenTerminal=this._onDidOpenTerminal.event,this._onDidChangeActiveTerminal=new R,this.onDidChangeActiveTerminal=this._onDidChangeActiveTerminal.event,this._onDidChangeTerminalDimensions=new R,this.onDidChangeTerminalDimensions=this._onDidChangeTerminalDimensions.event,this._onDidChangeTerminalState=new R,this.onDidChangeTerminalState=this._onDidChangeTerminalState.event,this._onDidChangeShell=new R,this.onDidChangeShell=this._onDidChangeShell.event,this._onDidWriteTerminalData=new R({onWillAddFirstListener:()=>this._proxy.$startSendingDataEvents(),onDidRemoveLastListener:()=>this._proxy.$stopSendingDataEvents()}),this.onDidWriteTerminalData=this._onDidWriteTerminalData.event,this._onDidExecuteCommand=new R({onWillAddFirstListener:()=>this._proxy.$startSendingCommandEvents(),onDidRemoveLastListener:()=>this._proxy.$stopSendingCommandEvents()}),this.onDidExecuteTerminalCommand=this._onDidExecuteCommand.event,this._proxy=i.getProxy(J.MainThreadTerminalService),this._bufferer=new T7(this._proxy.$sendProcessData),this._proxy.$registerProcessSupport(e),this._extHostCommands.registerArgumentProcessor({processArgument:n=>{const s=o=>{var c;const a=o;return(c=this.getTerminalById(a.instanceId))==null?void 0:c.value};switch(n==null?void 0:n.$mid){case 15:return s(n);default:{if(Array.isArray(n))for(let o=0;o<n.length&&n[o].$mid===15;o++)n[o]=s(n[o]);return n}}}}),this._register({dispose:()=>{for(const[n,s]of this._terminalProcesses)s.shutdown(!0)}})}getDefaultShell(e){const t=e?this._defaultAutomationProfile:this._defaultProfile;return(t==null?void 0:t.path)||""}getDefaultShellArgs(e){const t=e?this._defaultAutomationProfile:this._defaultProfile;return(t==null?void 0:t.args)||[]}createExtensionTerminal(e,t){const i=new Fy(this._proxy,ar(),e,e.name),n=new em(e.pty);return i.createExtensionTerminal(e.location,t,this._serializeParentTerminal(e,t).resolvedExtHostIdentifier,tS(e.iconPath),H7(e.color)).then(s=>{const o=this._setupExtHostProcessListeners(s,n);this._terminalProcessDisposables[s]=o}),this._terminals.push(i),i.value}_serializeParentTerminal(e,t){if(t=t||{},e.location&&typeof e.location=="object"&&"parentTerminal"in e.location){const i=e.location.parentTerminal;if(i){const n=this._terminals.find(s=>s.value===i);n&&(t.resolvedExtHostIdentifier=n._id)}}else e.location&&typeof e.location!="object"?t.location=e.location:t.location&&typeof t.location=="object"&&"splitActiveTerminal"in t.location&&(t.location={splitActiveTerminal:!0});return t}attachPtyToTerminal(e,t){if(!this.getTerminalById(e))throw new Error(`Cannot resolve terminal with id ${e} for virtual process`);const n=new em(t),s=this._setupExtHostProcessListeners(e,n);this._terminalProcessDisposables[e]=s}async $acceptActiveTerminalChanged(e){const t=this._activeTerminal;if(e===null){this._activeTerminal=void 0,t!==this._activeTerminal&&this._onDidChangeActiveTerminal.fire(this._activeTerminal);return}const i=this.getTerminalById(e);i&&(this._activeTerminal=i,t!==this._activeTerminal&&this._onDidChangeActiveTerminal.fire(this._activeTerminal.value))}async $acceptTerminalProcessData(e,t){const i=this.getTerminalById(e);i&&this._onDidWriteTerminalData.fire({terminal:i.value,data:t})}async $acceptTerminalDimensions(e,t,i){const n=this.getTerminalById(e);n&&n.setDimensions(t,i)&&this._onDidChangeTerminalDimensions.fire({terminal:n.value,dimensions:n.value.dimensions})}async $acceptDidExecuteCommand(e,t){const i=this.getTerminalById(e);i&&this._onDidExecuteCommand.fire({terminal:i.value,...t})}async $acceptTerminalMaximumDimensions(e,t,i){var n;(n=this._terminalProcesses.get(e))==null||n.resize(t,i)}async $acceptTerminalTitleChange(e,t){const i=this.getTerminalById(e);i&&(i.name=t)}async $acceptTerminalClosed(e,t,i){const n=this._getTerminalObjectIndexById(this._terminals,e);if(n!==null){const s=this._terminals.splice(n,1)[0];s.setExitStatus(t,i),this._onDidCloseTerminal.fire(s.value)}}$acceptTerminalOpened(e,t,i,n){if(t){const a=this._getTerminalObjectIndexById(this._terminals,t);if(a!==null){this._terminals[a]._id=e,this._onDidOpenTerminal.fire(this.terminals[a]),this._terminals[a].isOpen=!0;return}}const s={name:n.name,shellPath:n.executable,shellArgs:n.args,cwd:typeof n.cwd=="string"?n.cwd:x.revive(n.cwd),env:n.env,hideFromUser:n.hideFromUser},o=new Fy(this._proxy,e,s,i);this._terminals.push(o),this._onDidOpenTerminal.fire(o.value),o.isOpen=!0}async $acceptTerminalProcessId(e,t){const i=this.getTerminalById(e);i==null||i._setProcessId(t)}async $startExtensionTerminal(e,t){const i=this.getTerminalById(e);if(!i)return{message:h(M7,0,"Could not find the terminal with id {0} on the extension host",e)};i.isOpen||await new Promise(s=>{const o=this.onDidOpenTerminal(async a=>{a===i.value&&(o.dispose(),s())})});const n=this._terminalProcesses.get(e);n?n.startSendingEvents(t):this._extensionTerminalAwaitingStart[e]={initialDimensions:t}}_setupExtHostProcessListeners(e,t){const i=new Te;i.add(t.onProcessReady(s=>this._proxy.$sendProcessReady(e,s.pid,s.cwd,s.windowsPty))),i.add(t.onDidChangeProperty(s=>this._proxy.$sendProcessProperty(e,s))),this._bufferer.startBuffering(e,t.onProcessData),i.add(t.onProcessExit(s=>this._onProcessExit(e,s))),this._terminalProcesses.set(e,t);const n=this._extensionTerminalAwaitingStart[e];return n&&t instanceof em&&(t.startSendingEvents(n.initialDimensions),delete this._extensionTerminalAwaitingStart[e]),i}$acceptProcessAckDataEvent(e,t){var i;(i=this._terminalProcesses.get(e))==null||i.acknowledgeDataEvent(t)}$acceptProcessInput(e,t){var i;(i=this._terminalProcesses.get(e))==null||i.input(t)}$acceptTerminalInteraction(e){const t=this.getTerminalById(e);t!=null&&t.setInteractedWith()&&this._onDidChangeTerminalState.fire(t.value)}$acceptTerminalSelection(e,t){var i;(i=this.getTerminalById(e))==null||i.setSelection(t)}$acceptProcessResize(e,t,i){var n;try{(n=this._terminalProcesses.get(e))==null||n.resize(t,i)}catch(s){if(s.code!=="EPIPE"&&s.code!=="ERR_IPC_CHANNEL_CLOSED")throw s}}$acceptProcessShutdown(e,t){var i;(i=this._terminalProcesses.get(e))==null||i.shutdown(t)}$acceptProcessRequestInitialCwd(e){var t;(t=this._terminalProcesses.get(e))==null||t.getInitialCwd().then(i=>this._proxy.$sendProcessProperty(e,{type:"initialCwd",value:i}))}$acceptProcessRequestCwd(e){var t;(t=this._terminalProcesses.get(e))==null||t.getCwd().then(i=>this._proxy.$sendProcessProperty(e,{type:"cwd",value:i}))}$acceptProcessRequestLatency(e){return Promise.resolve(e)}registerLinkProvider(e){return this._linkProviders.add(e),this._linkProviders.size===1&&this._proxy.$startLinkProvider(),new Ne(()=>{this._linkProviders.delete(e),this._linkProviders.size===0&&this._proxy.$stopLinkProvider()})}registerProfileProvider(e,t,i){if(this._profileProviders.has(t))throw new Error(`Terminal profile provider "${t}" already registered`);return this._profileProviders.set(t,i),this._proxy.$registerProfileProvider(t,e.identifier.value),new Ne(()=>{this._profileProviders.delete(t),this._proxy.$unregisterProfileProvider(t)})}registerTerminalQuickFixProvider(e,t,i){if(this._quickFixProviders.has(e))throw new Error(`Terminal quick fix provider "${e}" is already registered`);return this._quickFixProviders.set(e,i),this._proxy.$registerQuickFixProvider(e,t),new Ne(()=>{this._quickFixProviders.delete(e),this._proxy.$unregisterQuickFixProvider(e)})}async $provideTerminalQuickFixes(e,t){const i=new Tt().token;if(i.isCancellationRequested)return;const n=this._quickFixProviders.get(e);if(!n)return;const s=await n.provideTerminalQuickFixes(t,i);if(s===null||Array.isArray(s)&&s.length===0)return;const o=new Te;if(this._lastQuickFixCommands.value=o,!Array.isArray(s))return s?Zf.from(s,this._extHostCommands.converter,o):void 0;const a=[];for(const c of s){const l=Zf.from(c,this._extHostCommands.converter,o);l&&a.push(l)}return a}async $createContributedProfileTerminal(e,t){var s;const i=new Tt().token;let n=await((s=this._profileProviders.get(e))==null?void 0:s.provideTerminalProfile(i));if(!i.isCancellationRequested){if(n&&!("options"in n)&&(n={options:n}),!n||!("options"in n))throw new Error(`No terminal profile options provided for id "${e}"`);if("pty"in n.options){this.createExtensionTerminal(n.options,t);return}this.createTerminalFromOptions(n.options,t)}}async $provideLinks(e,t){const i=this.getTerminalById(e);if(!i)return[];this._terminalLinkCache.delete(e);const n=this._terminalLinkCancellationSource.get(e);n==null||n.dispose(!0);const s=new Tt;this._terminalLinkCancellationSource.set(e,s);const o=[],a={terminal:i.value,line:t},c=[];for(const d of this._linkProviders)c.push(Hm.withAsyncBody(async f=>{s.token.onCancellationRequested(()=>f({provider:d,links:[]}));const m=await d.provideTerminalLinks(a,s.token)||[];s.token.isCancellationRequested||f({provider:d,links:m})}));const l=await Promise.all(c);if(s.token.isCancellationRequested)return[];const u=new Map;for(const d of l)d&&d.links.length>0&&o.push(...d.links.map(f=>{const m={id:F7++,startIndex:f.startIndex,length:f.length,label:f.tooltip};return u.set(m.id,{provider:d.provider,link:f}),m}));return this._terminalLinkCache.set(e,u),o}$activateLink(e,t){var n;const i=(n=this._terminalLinkCache.get(e))==null?void 0:n.get(t);i&&i.provider.handleTerminalLink(i.link)}_onProcessExit(e,t){this._bufferer.stopBuffering(e),this._terminalProcesses.delete(e),delete this._extensionTerminalAwaitingStart[e];const i=this._terminalProcessDisposables[e];i&&(i.dispose(),delete this._terminalProcessDisposables[e]),this._proxy.$sendProcessExit(e,t)}getTerminalById(e){return this._getTerminalObjectById(this._terminals,e)}getTerminalIdByApiObject(e){const t=this._terminals.findIndex(i=>i.value===e);return t>=0?t:null}_getTerminalObjectById(e,t){const i=this._getTerminalObjectIndexById(e,t);return i!==null?e[i]:null}_getTerminalObjectIndexById(e,t){const i=e.findIndex(n=>n._id===t);return i>=0?i:null}getEnvironmentVariableCollection(e){let t=this._environmentVariableCollections.get(e.identifier.value);return t||(t=new Oy,this._setEnvironmentVariableCollection(e.identifier.value,t)),t.getScopedEnvironmentVariableCollection(void 0)}_syncEnvironmentVariableCollection(e,t){const i=I7(t.map),n=P7(t.descriptionMap);this._proxy.$setEnvironmentVariableCollection(e,t.persistent,i.length===0?void 0:i,n)}$initEnvironmentVariableCollections(e){e.forEach(t=>{const i=t[0],n=new Oy(t[1]);this._setEnvironmentVariableCollection(i,n)})}$acceptDefaultProfile(e,t){const i=this._defaultProfile;this._defaultProfile=e,this._defaultAutomationProfile=t,(i==null?void 0:i.path)!==e.path&&this._onDidChangeShell.fire(e.path)}_setEnvironmentVariableCollection(e,t){this._environmentVariableCollections.set(e,t),t.onDidChangeCollection(()=>{this._syncEnvironmentVariableCollection(e,t)})}};Hv=U([M(1,Ec),M(2,Ve)],Hv);class Oy{get persistent(){return this._persistent}set persistent(e){this._persistent=e,this._onDidChangeCollection.fire()}get onDidChangeCollection(){return this._onDidChangeCollection&&this._onDidChangeCollection.event}constructor(e){this.map=new Map,this.scopedCollections=new Map,this.descriptionMap=new Map,this._persistent=!0,this._onDidChangeCollection=new R,this.map=new Map(e)}getScopedEnvironmentVariableCollection(e){const t=this.getScopeKey(e);let i=this.scopedCollections.get(t);return i||(i=new O7(this,e),this.scopedCollections.set(t,i),i.onDidChangeCollection(()=>this._onDidChangeCollection.fire())),i}replace(e,t,i,n){this._setIfDiffers(e,{value:t,type:oa.Replace,options:i??{applyAtProcessCreation:!0},scope:n})}append(e,t,i,n){this._setIfDiffers(e,{value:t,type:oa.Append,options:i??{applyAtProcessCreation:!0},scope:n})}prepend(e,t,i,n){this._setIfDiffers(e,{value:t,type:oa.Prepend,options:i??{applyAtProcessCreation:!0},scope:n})}_setIfDiffers(e,t){var o,a,c,l,u,d;if(t.options&&t.options.applyAtProcessCreation===!1&&!t.options.applyAtShellIntegration)throw new Error("EnvironmentVariableMutatorOptions must apply at either process creation or shell integration");const i=this.getKey(e,t.scope),n=this.map.get(i),s=t.options?{applyAtProcessCreation:t.options.applyAtProcessCreation??!1,applyAtShellIntegration:t.options.applyAtShellIntegration??!1}:{applyAtProcessCreation:!0};if(!n||n.value!==t.value||n.type!==t.type||((o=n.options)==null?void 0:o.applyAtProcessCreation)!==s.applyAtProcessCreation||((a=n.options)==null?void 0:a.applyAtShellIntegration)!==s.applyAtShellIntegration||((l=(c=n.scope)==null?void 0:c.workspaceFolder)==null?void 0:l.index)!==((d=(u=t.scope)==null?void 0:u.workspaceFolder)==null?void 0:d.index)){const f=this.getKey(e,t.scope),m={variable:e,...t,options:s};this.map.set(f,m),this._onDidChangeCollection.fire()}}get(e,t){const i=this.getKey(e,t),n=this.map.get(i);return n?Hy(n):void 0}getKey(e,t){const i=this.getScopeKey(t);return i.length?`${e}:::${i}`:e}getScopeKey(e){return this.getWorkspaceKey(e==null?void 0:e.workspaceFolder)??""}getWorkspaceKey(e){return e?e.uri.toString():void 0}getVariableMap(e){const t=new Map;for(const[i,n]of this.map)this.getScopeKey(n.scope)===this.getScopeKey(e)&&t.set(n.variable,Hy(n));return t}delete(e,t){const i=this.getKey(e,t);this.map.delete(i),this._onDidChangeCollection.fire()}clear(e){var t,i;if(e!=null&&e.workspaceFolder){for(const[n,s]of this.map)((i=(t=s.scope)==null?void 0:t.workspaceFolder)==null?void 0:i.index)===e.workspaceFolder.index&&this.map.delete(n);this.clearDescription(e)}else this.map.clear(),this.descriptionMap.clear();this._onDidChangeCollection.fire()}setDescription(e,t){const i=this.getScopeKey(t),n=this.descriptionMap.get(i);if(!n||n.description!==e){let s;typeof e=="string"?s=e:s=e==null?void 0:e.value.split(`

`)[0];const o={description:s,scope:t};this.descriptionMap.set(i,o),this._onDidChangeCollection.fire()}}getDescription(e){var i;const t=this.getScopeKey(e);return(i=this.descriptionMap.get(t))==null?void 0:i.description}clearDescription(e){const t=this.getScopeKey(e);this.descriptionMap.delete(t)}}class O7{get persistent(){return this.collection.persistent}set persistent(e){this.collection.persistent=e}get onDidChangeCollection(){return this._onDidChangeCollection&&this._onDidChangeCollection.event}constructor(e,t){this.collection=e,this.scope=t,this._onDidChangeCollection=new R}getScoped(e){return this.collection.getScopedEnvironmentVariableCollection(e)}replace(e,t,i){this.collection.replace(e,t,i,this.scope)}append(e,t,i){this.collection.append(e,t,i,this.scope)}prepend(e,t,i){this.collection.prepend(e,t,i,this.scope)}get(e){return this.collection.get(e,this.scope)}forEach(e,t){this.collection.getVariableMap(this.scope).forEach((i,n)=>e.call(t,n,i,this),this.scope)}[Symbol.iterator](){return this.collection.getVariableMap(this.scope).entries()}delete(e){this.collection.delete(e,this.scope),this._onDidChangeCollection.fire(void 0)}clear(){this.collection.clear(this.scope)}set description(e){this.collection.setDescription(e,this.scope)}get description(){return this.collection.getDescription(this.scope)}}let Uv=class extends Hv{constructor(e,t){super(!1,e,t)}createTerminal(e,t,i){throw new bm}createTerminalFromOptions(e,t){throw new bm}};Uv=U([M(0,Ec),M(1,Ve)],Uv);function tS(r){if(!(!r||typeof r=="string"))return"id"in r?{id:r.id,color:r.color}:r}function H7(r){return Ha.isThemeColor(r)?r:void 0}function Hy(r){const e={...r};return delete e.scope,e.options=e.options??void 0,delete e.variable,e}const U7=Ce("progressService");Ce("editorProgressService");const p0=class p0{get value(){return this._value}constructor(e){this.callback=e}report(e){this._value=e,this.callback(this._value)}};p0.None=Object.freeze({report(){}});let tp=p0,Uy=class extends Fe{constructor(e,t){super(),this.deferred=new bc,t.withProgress(e,i=>(this.reporter=i,this.lastStep&&i.report(this.lastStep),this.deferred.p)),this._register(De(()=>this.deferred.complete()))}report(e){this.reporter?this.reporter.report(e):this.lastStep=e}};Uy=U([M(1,U7)],Uy);const iS="__",Zw=Ce("IExtHostAuthentication");let Bv=class{constructor(e){this._authenticationProviders=new Map,this._onDidChangeSessions=new R,this.onDidChangeSessions=this._onDidChangeSessions.event,this._getSessionTaskSingler=new By,this._getSessionsTaskSingler=new By,this._proxy=e.getProxy(J.MainThreadAuthentication)}async getSession(e,t,i,n={}){const s=Xe.toKey(e.identifier),o=[...i].sort().join(" ");return await this._getSessionTaskSingler.getOrCreate(`${s} ${t} ${o}`,async()=>{await this._proxy.$ensureProvider(t);const a=e.displayName||e.name;return this._proxy.$getSession(t,i,s,a,n)})}async getSessions(e,t,i){const n=Xe.toKey(e.identifier),s=[...i].sort().join(" ");return await this._getSessionsTaskSingler.getOrCreate(`${n} ${s}`,async()=>{await this._proxy.$ensureProvider(t);const o=e.displayName||e.name;return this._proxy.$getSessions(t,i,n,o)})}async removeSession(e,t){const i=this._authenticationProviders.get(e);return i?i.provider.removeSession(t):this._proxy.$removeSession(e,t)}registerAuthenticationProvider(e,t,i,n){if(this._authenticationProviders.get(e))throw new Error(`An authentication provider with id '${e}' is already registered.`);this._authenticationProviders.set(e,{label:t,provider:i,options:n??{supportsMultipleAccounts:!1}});const s=i.onDidChangeSessions(o=>this._proxy.$sendDidChangeSessions(e,o));return this._proxy.$registerAuthenticationProvider(e,t,(n==null?void 0:n.supportsMultipleAccounts)??!1),new Ne(()=>{s.dispose(),this._authenticationProviders.delete(e),this._proxy.$unregisterAuthenticationProvider(e)})}$createSession(e,t,i){const n=this._authenticationProviders.get(e);if(n)return Promise.resolve(n.provider.createSession(t,i));throw new Error(`Unable to find authentication provider with handle: ${e}`)}$removeSession(e,t){const i=this._authenticationProviders.get(e);if(i)return Promise.resolve(i.provider.removeSession(t));throw new Error(`Unable to find authentication provider with handle: ${e}`)}$getSessions(e,t){const i=this._authenticationProviders.get(e);if(i)return Promise.resolve(i.provider.getSessions(t));throw new Error(`Unable to find authentication provider with handle: ${e}`)}$onDidChangeAuthenticationSessions(e,t){return e.startsWith(iS)||this._onDidChangeSessions.fire({provider:{id:e,label:t}}),Promise.resolve()}};Bv=U([M(0,Ve)],Bv);class By{constructor(){this._inFlightPromises=new Map}getOrCreate(e,t){const i=this._inFlightPromises.get(e);if(i)return i;const n=t().finally(()=>this._inFlightPromises.delete(e));return this._inFlightPromises.set(e,n),n}}var Vv;const Vy="vs/workbench/api/common/extHostLanguageModels",Yw=Ce("IExtHostLanguageModels");class Wy{constructor(e,t){this.option=e,this.stream=new Um,this.stream=t??new Um}}class B7{constructor(){this._responseStreams=new Map,this._defaultStream=new Um,this._isDone=!1,this._isStreaming=!1;const e=this;this.apiObject={stream:e._defaultStream.asyncIterable}}*_streams(){if(this._responseStreams.size>0)for(const[,e]of this._responseStreams)yield e.stream;else yield this._defaultStream}handleFragment(e){if(this._isDone)return;this._isStreaming=!0;let t=this._responseStreams.get(e.index);t||(this._responseStreams.size===0?t=new Wy(e.index,this._defaultStream):t=new Wy(e.index),this._responseStreams.set(e.index,t)),t.stream.emitOne(e.part)}get isStreaming(){return this._isStreaming}reject(e){this._isDone=!0;for(const t of this._streams())t.reject(e)}resolve(){this._isDone=!0;for(const e of this._streams())e.resolve()}}var pc;let Wv=(pc=class{constructor(e,t,i){this._logService=t,this._extHostAuthentication=i,this._onDidChangeModelAccess=new R,this._onDidChangeProviders=new R,this.onDidChangeProviders=this._onDidChangeProviders.event,this._languageModels=new Map,this._allLanguageModelData=new Map,this._modelAccessList=new Kr,this._pendingRequest=new Map,this._languageAccessInformationExtensions=new Set,this._proxy=e.getProxy(J.MainThreadLanguageModels)}dispose(){this._onDidChangeModelAccess.dispose(),this._onDidChangeProviders.dispose()}registerLanguageModel(e,t,i,n){var c;const s=Vv._idPool++;this._languageModels.set(s,{extension:e.identifier,provider:i,languageModelId:t});let o;n.auth&&(o={providerLabel:e.displayName||e.name,accountLabel:typeof n.auth=="object"?n.auth.label:void 0}),this._proxy.$registerLanguageModelProvider(s,t,{extension:e.identifier,identifier:t,name:n.name??"",version:n.version,tokens:n.tokens,auth:o});const a=(c=i.onDidReceiveLanguageModelResponse2)==null?void 0:c.call(i,({extensionId:l,participant:u,tokenCount:d})=>{this._proxy.$whenLanguageModelChatRequestMade(t,new Xe(l),u,d)});return De(()=>{this._languageModels.delete(s),this._proxy.$unregisterProvider(s),a==null||a.dispose()})}async $provideLanguageModelResponse(e,t,i,n,s,o){const a=this._languageModels.get(e);if(!a)return;const c=new tp(async l=>{if(o.isCancellationRequested){this._logService.warn(`[CHAT](${a.extension.value}) CANNOT send progress because the REQUEST IS CANCELLED`);return}this._proxy.$handleProgressChunk(t,{index:l.index,part:l.part})});return a.provider.provideLanguageModelResponse2(n.map(hl.to),s,Xe.toKey(i),c,o)}$provideTokenLength(e,t,i){const n=this._languageModels.get(e);return n?Promise.resolve(n.provider.provideTokenCount(t,i)):Promise.resolve(0)}$updateLanguageModels(e){var n;const t=[],i=[];if(e.added)for(const s of e.added)this._allLanguageModelData.set(s.identifier,s),t.push(s.identifier);if(e.removed)for(const s of e.removed){this._allLanguageModelData.delete(s),i.push(s);for(const[o,a]of this._pendingRequest)a.languageModelId===s&&(a.res.reject(new is),this._pendingRequest.delete(o))}this._onDidChangeProviders.fire(Object.freeze({added:Object.freeze(t),removed:Object.freeze(i)})),(n=e.added)==null||n.forEach(this._fakeAuthPopulate,this)}getLanguageModelIds(){return Array.from(this._allLanguageModelData.keys())}$updateModelAccesslist(e){const t=new Array;for(const{from:i,to:n,enabled:s}of e){const o=this._modelAccessList.get(i)??new ko;if(o.has(n)!==s){s?o.add(n):o.delete(n),this._modelAccessList.set(i,o);const c={from:i,to:n};t.push(c),this._onDidChangeModelAccess.fire(c)}}}async sendChatRequest(e,t,i,n,s){var m;const o=e.identifier,a=await this._proxy.$prepareChatAccess(o,t,n.justification);if(!a||!this._allLanguageModelData.has(t))throw bn.NotFound(`Language model '${t}' is unknown.`);if(this._isUsingAuth(o,a)&&(!await this._getAuthAccess(e,{identifier:a.extension,displayName:a.auth.providerLabel},n.justification,n.silent)||!((m=this._modelAccessList.get(o))!=null&&m.has(a.extension))))throw bn.NoPermissions(`Language model '${t}' cannot be used by '${o.value}'.`);const c=Math.random()*1e6|0,l=this._proxy.$fetchResponse(o,t,c,i.map(hl.from),n.modelOptions??{},s),u=new Ki,d=new B7;this._pendingRequest.set(c,{languageModelId:t,res:d});let f;if(l.catch(b=>{u.isOpen()?d.reject(b):f=b}).finally(()=>{this._pendingRequest.delete(c),d.resolve(),u.open()}),await u.wait(),f)throw new bn(`Language model '${t}' errored, check cause for more details`,"Unknown",f);return d.apiObject}async $handleResponseFragment(e,t){const i=this._pendingRequest.get(e);i&&i.res.handleFragment(t)}async _getAuthAccess(e,t,i,n){const s=iS+t.identifier.value;if(await this._extHostAuthentication.getSession(e,s,[],{silent:!0}))return this.$updateModelAccesslist([{from:e.identifier,to:t.identifier,enabled:!0}]),!0;if(n)return!1;try{const a=i?h(Vy,0,`To allow access to the language models provided by {0}. Justification:

{1}`,t.displayName,i):h(Vy,1,"To allow access to the language models provided by {0}",t.displayName);return await this._extHostAuthentication.getSession(e,s,[],{forceNewSession:{detail:a}}),this.$updateModelAccesslist([{from:e.identifier,to:t.identifier,enabled:!0}]),!0}catch{return!1}}_isUsingAuth(e,t){return!!t.auth&&!Xe.equals(t.extension,e)}async _fakeAuthPopulate(e){for(const t of this._languageAccessInformationExtensions)try{await this._getAuthAccess(t,{identifier:e.extension,displayName:""},void 0,!0)}catch(i){this._logService.error("Fake Auth request failed"),this._logService.error(i)}}async computeTokenLength(e,t,i){const n=this._allLanguageModelData.get(e);if(!n)throw bn.NotFound(`Language model '${e}' is unknown.`);const s=nr.find(this._languageModels.values(),o=>o.languageModelId===e);return s?s.provider.provideTokenCount(t,i):this._proxy.$countTokens(n.identifier,typeof t=="string"?t:hl.from(t),i)}getLanguageModelInfo(e){const t=this._allLanguageModelData.get(e);if(t)return{id:t.identifier,name:t.name,version:t.version,tokens:t.tokens}}createLanguageModelAccessInformation(e){this._languageAccessInformationExtensions.add(e);const t=this,i=It.signal(It.filter(this._onDidChangeModelAccess.event,s=>Xe.equals(s.from,e.identifier))),n=It.signal(this._onDidChangeProviders.event);return{get onDidChange(){return It.any(i,n)},canSendRequest(s){const o=t._allLanguageModelData.get(s);if(!o)return;if(!t._isUsingAuth(e.identifier,o))return!0;const a=t._modelAccessList.get(e.identifier);if(a)return a.has(o.extension)}}}},Vv=pc,pc._idPool=1,pc);Wv=Vv=U([M(0,Ve),M(1,Je),M(2,Zw)],Wv);function Hc(r,e=Ii){return RE(r,e)?r.charAt(0).toUpperCase()+r.slice(1):r}function V7(r,e){return r.replace(/^~($|\/|\\)/,`${e}$1`)}var zy;(function(r){r[r.TEXT=0]="TEXT",r[r.VARIABLE=1]="VARIABLE",r[r.SEPARATOR=2]="SEPARATOR"})(zy||(zy={}));function jy(r){return r<0?0:r>255?255:r|0}function Bo(r){return r<0?0:r>4294967295?4294967295:r|0}class hg{constructor(e){const t=jy(e);this._defaultValue=t,this._asciiMap=hg._createAsciiMap(t),this._map=new Map}static _createAsciiMap(e){const t=new Uint8Array(256);return t.fill(e),t}set(e,t){const i=jy(t);e>=0&&e<256?this._asciiMap[e]=i:this._map.set(e,i)}get(e){return e>=0&&e<256?this._asciiMap[e]:this._map.get(e)||this._defaultValue}clear(){this._asciiMap.fill(this._defaultValue),this._map.clear()}}class W7 extends hg{constructor(e,t){super(0),this._segmenter=null,this._cachedLine=null,this._cachedSegments=[],this.intlSegmenterLocales=t,this.intlSegmenterLocales.length>0?this._segmenter=new Intl.Segmenter(this.intlSegmenterLocales,{granularity:"word"}):this._segmenter=null;for(let i=0,n=e.length;i<n;i++)this.set(e.charCodeAt(i),2);this.set(32,1),this.set(9,1)}findPrevIntlWordBeforeOrAtOffset(e,t){let i=null;for(const n of this._getIntlSegmenterWordsOnLine(e)){if(n.index>t)break;i=n}return i}findNextIntlWordAtOrAfterOffset(e,t){for(const i of this._getIntlSegmenterWordsOnLine(e))if(!(i.index<t))return i;return null}_getIntlSegmenterWordsOnLine(e){return this._segmenter?this._cachedLine===e?this._cachedSegments:(this._cachedLine=e,this._cachedSegments=this._filterWordSegments(this._segmenter.segment(e)),this._cachedSegments):[]}_filterWordSegments(e){const t=[];for(const i of e)this._isWordLike(i)&&t.push(i);return t}_isWordLike(e){return!!e.isWordLike}}const qy=new gw(10);function z7(r,e){const t=`${r}/${e.join(",")}`;let i=qy.get(t);return i||(i=new W7(r,e),qy.set(t,i)),i}var zv;(function(r){r[r.Left=1]="Left",r[r.Center=2]="Center",r[r.Right=4]="Right",r[r.Full=7]="Full"})(zv||(zv={}));var Gy;(function(r){r[r.Left=1]="Left",r[r.Center=2]="Center",r[r.Right=3]="Right"})(Gy||(Gy={}));var Qy;(function(r){r[r.Both=0]="Both",r[r.Right=1]="Right",r[r.Left=2]="Left",r[r.None=3]="None"})(Qy||(Qy={}));class jv{constructor(e,t){this._findMatchBrand=void 0,this.range=e,this.matches=t}}class j7{constructor(e,t,i){this.regex=e,this.wordSeparators=t,this.simpleSearch=i}}class q7{constructor(e,t,i){this.reverseEdits=e,this.changes=t,this.trimAutoWhitespaceLineNumbers=i}}class Jy{constructor(e,t,i,n){this.searchString=e,this.isRegex=t,this.matchCase=i,this.wordSeparators=n}parseSearchRequest(){if(this.searchString==="")return null;let e;this.isRegex?e=nS(this.searchString):e=this.searchString.indexOf(`
`)>=0;let t=null;try{t=uE(this.searchString,this.isRegex,{matchCase:this.matchCase,wholeWord:!1,multiline:e,global:!0,unicode:!0})}catch{return null}if(!t)return null;let i=!this.isRegex&&!e;return i&&this.searchString.toLowerCase()!==this.searchString.toUpperCase()&&(i=this.matchCase),new j7(t,this.wordSeparators?z7(this.wordSeparators,[]):null,i?this.searchString:null)}}function nS(r){if(!r||r.length===0)return!1;for(let e=0,t=r.length;e<t;e++){const i=r.charCodeAt(e);if(i===10)return!0;if(i===92){if(e++,e>=t)break;const n=r.charCodeAt(e);if(n===110||n===114||n===87)return!0}}return!1}function Ky(r,e,t){if(!t)return new jv(r,null);const i=[];for(let n=0,s=e.length;n<s;n++)i[n]=e[n];return new jv(r,i)}function G7(r,e,t,i,n){if(i===0)return!0;const s=e.charCodeAt(i-1);if(r.get(s)!==0||s===13||s===10)return!0;if(n>0){const o=e.charCodeAt(i);if(r.get(o)!==0)return!0}return!1}function Q7(r,e,t,i,n){if(i+n===t)return!0;const s=e.charCodeAt(i+n);if(r.get(s)!==0||s===13||s===10)return!0;if(n>0){const o=e.charCodeAt(i+n-1);if(r.get(o)!==0)return!0}return!1}function rS(r,e,t,i,n){return G7(r,e,t,i,n)&&Q7(r,e,t,i,n)}class J7{constructor(e,t){this._wordSeparators=e,this._searchRegex=t,this._prevMatchStartIndex=-1,this._prevMatchLength=0}reset(e){this._searchRegex.lastIndex=e,this._prevMatchStartIndex=-1,this._prevMatchLength=0}next(e){const t=e.length;let i;do{if(this._prevMatchStartIndex+this._prevMatchLength===t||(i=this._searchRegex.exec(e),!i))return null;const n=i.index,s=i[0].length;if(n===this._prevMatchStartIndex&&s===this._prevMatchLength){if(s===0){Ax(e,t,this._searchRegex.lastIndex)>65535?this._searchRegex.lastIndex+=2:this._searchRegex.lastIndex+=1;continue}return null}if(this._prevMatchStartIndex=n,this._prevMatchLength=s,!this._wordSeparators||rS(this._wordSeparators,e,t,n,s))return i}while(i);return null}}const sS=Ce("contextService"),K7=Ce("editorGroupsService"),X7=Ce("pathService"),Z7="vs/workbench/services/search/common/queryBuilder";let Xy=class{constructor(e,t,i,n,s){this.configurationService=e,this.workspaceContextService=t,this.editorGroupsService=i,this.logService=n,this.pathService=s}text(e,t,i={}){e=this.getContentPattern(e,i);const n=this.configurationService.getValue(),s=t&&t.some(a=>!this.configurationService.getValue({resource:a}).search.useRipgrep);return{...this.commonQuery(t==null?void 0:t.map(ib),i),type:2,contentPattern:e,previewOptions:i.previewOptions,maxFileSize:i.maxFileSize,usePCRE2:n.search.usePCRE2||s||!1,beforeContext:i.beforeContext,afterContext:i.afterContext,userDisabledExcludesAndIgnoreFiles:i.disregardExcludeSettings&&i.disregardIgnoreFiles}}getContentPattern(e,t){var s,o,a,c;const i=this.configurationService.getValue();e.isRegExp&&(e.pattern=e.pattern.replace(/\r?\n/g,"\\n"));const n={...e,wordSeparators:i.editor.wordSeparators};return this.isCaseSensitive(e,t)&&(n.isCaseSensitive=!0),this.isMultiline(e)&&(n.isMultiline=!0),(s=t.notebookSearchConfig)!=null&&s.includeMarkupInput&&(n.notebookInfo||(n.notebookInfo={}),n.notebookInfo.isInNotebookMarkdownInput=t.notebookSearchConfig.includeMarkupInput),(o=t.notebookSearchConfig)!=null&&o.includeMarkupPreview&&(n.notebookInfo||(n.notebookInfo={}),n.notebookInfo.isInNotebookMarkdownPreview=t.notebookSearchConfig.includeMarkupPreview),(a=t.notebookSearchConfig)!=null&&a.includeCodeInput&&(n.notebookInfo||(n.notebookInfo={}),n.notebookInfo.isInNotebookCellInput=t.notebookSearchConfig.includeCodeInput),(c=t.notebookSearchConfig)!=null&&c.includeOutput&&(n.notebookInfo||(n.notebookInfo={}),n.notebookInfo.isInNotebookCellOutput=t.notebookSearchConfig.includeOutput),n}file(e,t={}){return{...this.commonQuery(e,t),type:1,filePattern:t.filePattern?t.filePattern.trim():t.filePattern,exists:t.exists,sortByScore:t.sortByScore,cacheKey:t.cacheKey,shouldGlobMatchFilePattern:t.shouldGlobSearch}}handleIncludeExclude(e,t){return e?(e=Array.isArray(e)?e.map(rh):rh(e),t?this.parseSearchPaths(e):{pattern:tm(...Array.isArray(e)?e:[e])}):{}}commonQuery(e=[],t={}){const i=this.handleIncludeExclude(t.includePattern,t.expandPatterns),n=this.handleIncludeExclude(t.excludePattern,t.expandPatterns),s=e.length>1,o=(i.searchPaths&&i.searchPaths.length?i.searchPaths.map(l=>this.getFolderQueryForSearchPath(l,t,n)):e.map(l=>this.getFolderQueryForRoot(l,t,n,s))).filter(l=>!!l),a={_reason:t._reason,folderQueries:o,usingSearchPaths:!!(i.searchPaths&&i.searchPaths.length),extraFileResources:t.extraFileResources,excludePattern:n.pattern,includePattern:i.pattern,onlyOpenEditors:t.onlyOpenEditors,maxResults:t.maxResults};if(t.onlyOpenEditors){const l=ci(dh(this.editorGroupsService.groups.map(f=>f.editors.map(m=>m.resource))));this.logService.trace("QueryBuilder#commonQuery - openEditor URIs",JSON.stringify(l));const u=l.filter(f=>wy(a,f.fsPath)),d=this.commonQueryFromFileList(u);return this.logService.trace("QueryBuilder#commonQuery - openEditor Query",JSON.stringify(d)),{...a,...d}}const c=t.extraFileResources&&t.extraFileResources.filter(l=>wy(a,l.fsPath));return a.extraFileResources=c&&c.length?c:void 0,a}commonQueryFromFileList(e){const t=[],i=new Pt,n={};let s=!1;return e.forEach(o=>{var c;if(o.scheme===ne.walkThrough)return;if(BE(o)){const l=((c=this.workspaceContextService.getWorkspaceFolder(o))==null?void 0:c.uri)??o.with({path:Ys(o.fsPath)});let u=i.get(l);u||(s=!0,u={folder:l,includePattern:{}},t.push(u),i.set(l,u));const d=Rl(l.fsPath,o.fsPath);Oa(u.includePattern)[d.replace(/\\/g,"/")]=!0}else o.fsPath&&(s=!0,n[o.fsPath]=!0)}),{folderQueries:t,includePattern:n,usingSearchPaths:!0,excludePattern:s?void 0:{"**/*":!0}}}isCaseSensitive(e,t){if(t.isSmartCase){if(e.isRegExp){if(H0(e.pattern,!0))return!0}else if(H0(e.pattern))return!0}return!!e.isCaseSensitive}isMultiline(e){return e.isMultiline||e.isRegExp&&nS(e.pattern)||e.pattern.indexOf(`
`)>=0?!0:!!e.isMultiline}parseSearchPaths(e){const t=d=>Pm(d)||/^\.\.?([\/\\]|$)/.test(d),n=(Array.isArray(e)?e:e8(e)).map(d=>{const f=this.pathService.resolvedUserHome;return f?V7(d,f.scheme===ne.file?f.fsPath:f.path):d}),s=lx(n,d=>t(d)?"searchPaths":"exprSegments"),o=(s.exprSegments||[]).map(d=>N0(d,"/")).map(d=>N0(d,"\\")).map(d=>(d[0]==="."&&(d="*"+d),t8(d))),a={},c=this.expandSearchPathPatterns(s.searchPaths||[]);c&&c.length&&(a.searchPaths=c);const l=dh(o),u=tm(...l);return u&&(a.pattern=u),a}getExcludesForFolder(e,t){return t.disregardExcludeSettings?void 0:QI(e,!t.disregardSearchExcludeSettings)}expandSearchPathPatterns(e){if(!e||!e.length)return[];const t=e.flatMap(n=>{let{pathPortion:s,globPortion:o}=Y7(n);return o&&(o=im(o)),this.expandOneSearchPath(s).flatMap(c=>this.resolveOneSearchPathPattern(c,o))}),i=new Map;return t.forEach(n=>{const s=n.searchPath.toString(),o=i.get(s);o?n.pattern&&(o.pattern=o.pattern||{},o.pattern[n.pattern]=!0):i.set(s,{searchPath:n.searchPath,pattern:n.pattern?tm(n.pattern):void 0})}),Array.from(i.values())}expandOneSearchPath(e){if(Pm(e)){const t=this.workspaceContextService.getWorkspace().folders;return t[0]&&t[0].uri.scheme!==ne.file?[{searchPath:t[0].uri.with({path:e})}]:[{searchPath:x.file(Ma(e))}]}if(this.workspaceContextService.getWorkbenchState()===2){const t=this.workspaceContextService.getWorkspace().folders[0].uri;if(e=rh(e),e.startsWith("../")||e===".."){const n=Be.resolve(t.path,e);return[{searchPath:t.with({path:n})}]}const i=im(e);return[{searchPath:t,pattern:i}]}else{if(e==="./"||e===".\\")return[];{const t=e.replace(/^\.[\/\\]/,""),n=this.workspaceContextService.getWorkspace().folders.map(s=>{const o=t.match(new RegExp(`^${Fa(s.name)}(?:/(.*)|$)`));return o?{match:o,folder:s}:null}).filter(ks);if(n.length)return n.map(s=>{const o=s.match[1];return{searchPath:s.folder.uri,pattern:o&&im(o)}});{const s=e.match(/\.[\/\\](.+)[\/\\]?/),o=s?s[1]:e,a=h(Z7,0,"Workspace folder does not exist: {0}",o);throw new Error(a)}}}}resolveOneSearchPathPattern(e,t){const i=e.pattern&&t?`${e.pattern}/${t}`:e.pattern||t,n=[{searchPath:e.searchPath,pattern:i}];return i&&!i.endsWith("**")&&n.push({searchPath:e.searchPath,pattern:i+"/**"}),n}getFolderQueryForSearchPath(e,t,i){const n=this.getFolderQueryForRoot(ib(e.searchPath),t,i,!1);return n?{...n,includePattern:e.pattern}:null}getFolderQueryForRoot(e,t,i,n){var d,f,m,b;let s;const o=x.isUri(e)?e:e.uri;if(i.searchPaths){const _=i.searchPaths.filter(v=>Fx(v.searchPath,o))[0];if(_&&!_.pattern)return null;_&&(s=_.pattern)}const a=this.configurationService.getValue({resource:o}),l={...this.getExcludesForFolder(a,t)||{},...s||{}},u=x.isUri(e)?_c(e):e.name;return{folder:o,folderName:n?u:void 0,excludePattern:Object.keys(l).length>0?l:void 0,fileEncoding:a.files&&a.files.encoding,disregardIgnoreFiles:typeof t.disregardIgnoreFiles=="boolean"?t.disregardIgnoreFiles:!((d=a.search)!=null&&d.useIgnoreFiles),disregardGlobalIgnoreFiles:typeof t.disregardGlobalIgnoreFiles=="boolean"?t.disregardGlobalIgnoreFiles:!((f=a.search)!=null&&f.useGlobalIgnoreFiles),disregardParentIgnoreFiles:typeof t.disregardParentIgnoreFiles=="boolean"?t.disregardParentIgnoreFiles:!((m=a.search)!=null&&m.useParentIgnoreFiles),ignoreSymlinks:typeof t.ignoreSymlinks=="boolean"?t.ignoreSymlinks:!((b=a.search)!=null&&b.followSymlinks)}}};Xy=U([M(0,Jw),M(1,sS),M(2,K7),M(3,Je),M(4,X7)],Xy);function Y7(r){const e=r.match(/[\*\{\}\(\)\[\]\?]/);if(e){const t=e.index,i=r.substr(0,t).match(/[/|\\][^/\\]*$/);if(i){let n=r.substr(0,i.index);return n.match(/[/\\]/)||(n+="/"),{pathPortion:n,globPortion:r.substr((i.index||0)+1)}}}return{pathPortion:r}}function tm(...r){return r.length?r.reduce((e,t)=>(e[t]=!0,e),Object.create(null)):void 0}function e8(r){return e1(r,",").map(e=>e.trim()).filter(e=>!!e.length)}function t8(r){return[`**/${r}/**`,`**/${r}`].map(t=>t.replace(/\*\*\/\*\*/g,"**"))}function rh(r){return r.replace(/\\/g,"/")}function im(r){return rh(r).replace(/^\.\//,"").replace(/\/+$/g,"")}Ce("searchService");const i8=7e3;function n8(r,e){const t=e.activationEvents;if(!t)return Promise.resolve(void 0);const i=[],n=[];for(const u of t)if(/^workspaceContains:/.test(u)){const d=u.substr(18);d.indexOf("*")>=0||d.indexOf("?")>=0||r.forceUsingSearch?n.push(d):i.push(d)}if(i.length===0&&n.length===0)return Promise.resolve(void 0);const{promise:s,resolve:o}=zE(),a=u=>o({activationEvent:u}),c=Promise.all(i.map(u=>r8(r,u,a))).then(()=>{}),l=s8(r,e.identifier,n,a);return Promise.all([c,l]).then(()=>{o(void 0)}),s}async function r8(r,e,t){for(const i of r.folders)if(await r.exists(wc(x.revive(i),e))){t(`workspaceContains:${e}`);return}}async function s8(r,e,t,i){if(t.length===0)return Promise.resolve(void 0);const n=new Tt,s=r.checkExists(r.folders,t,n.token),o=setTimeout(async()=>{n.cancel(),r.logService.info(`Not activating extension '${e.value}': Timed out while searching for 'workspaceContains' pattern ${t.join(",")}`)},i8);let a=!1;try{a=await s}catch(c){ho(c)||nn(c)}n.dispose(),clearTimeout(o),a&&i(`workspaceContains:${t.join(",")}`)}class oS{constructor(e){this._onDidChangePassword=new R,this.onDidChangePassword=this._onDidChangePassword.event,this._proxy=e.getProxy(J.MainThreadSecretState)}async $onDidChangePassword(e){this._onDidChangePassword.fire(e)}get(e,t){return this._proxy.$getPassword(e,t)}store(e,t,i){return this._proxy.$setPassword(e,t,i)}delete(e,t){return this._proxy.$deletePassword(e,t)}}const e0=Ce("IExtHostSecretState");var Sr;class o8{constructor(e,t){ue(this,Sr,void 0);this._onDidChange=new R,this.onDidChange=this._onDidChange.event,this._id=Xe.toKey(e.identifier),K(this,Sr,t),P(this,Sr).onDidChangePassword(i=>{i.extensionId===this._id&&this._onDidChange.fire({key:i.key})})}get(e){return P(this,Sr).get(this._id,e)}store(e,t){return P(this,Sr).store(this._id,e,t)}delete(e){return P(this,Sr).delete(this._id,e)}}Sr=new WeakMap;let qv=class{constructor(e,t,i){this.logService=i,this.bundleCache=new Map,this._proxy=t.getProxy(J.MainThreadLocalization),this.currentLanguage=e.environment.appLanguage,this.isDefaultLanguage=this.currentLanguage===Es}getMessage(e,t){var c;const{message:i,args:n,comment:s}=t;if(this.isDefaultLanguage)return $0(i,n??{});let o=i;s&&s.length>0&&(o+=`/${Array.isArray(s)?s.join(""):s}`);const a=(c=this.bundleCache.get(e))==null?void 0:c.contents[o];return a||this.logService.warn(`Using default string since no string found in i18n bundle that has the key: ${o}`),$0(a??i,n??{})}getBundle(e){var t;return(t=this.bundleCache.get(e))==null?void 0:t.contents}getBundleUri(e){var t;return(t=this.bundleCache.get(e))==null?void 0:t.uri}async initializeLocalizedMessages(e){var n;if(this.isDefaultLanguage||!e.l10n&&!e.isBuiltin||this.bundleCache.has(e.identifier.value))return;let t;const i=await this.getBundleLocation(e);if(!i){this.logService.error(`No bundle location found for extension ${e.identifier.value}`);return}try{const s=await this._proxy.$fetchBundleContents(i),o=JSON.parse(s);t=e.isBuiltin?(n=o.contents)==null?void 0:n.bundle:o}catch(s){this.logService.error(`Failed to load translations for ${e.identifier.value} from ${i}: ${s.message}`);return}t&&this.bundleCache.set(e.identifier.value,{contents:t,uri:i})}async getBundleLocation(e){if(e.isBuiltin){const t=await this._proxy.$fetchBuiltInBundleUri(e.identifier.value,this.currentLanguage);return x.revive(t)}return e.l10n?x.joinPath(e.extensionLocation,e.l10n,`bundle.l10n.${this.currentLanguage}.json`):void 0}};qv=U([M(0,jt),M(1,Ve),M(2,Je)],qv);const t0=Ce("IExtHostLocalizationService"),i0=Ce("IExtHostManagedSockets");let Gv=class{constructor(e){this._remoteSocketIdCounter=0,this._factory=null,this._managedRemoteSockets=new Map,this._proxy=e.getProxy(J.MainThreadManagedSockets)}setFactory(e,t){for(const i of this._managedRemoteSockets.values())i.dispose();this._factory&&this._proxy.$unregisterSocketFactory(this._factory.socketFactoryId),this._factory=new a8(e,t),this._proxy.$registerSocketFactory(this._factory.socketFactoryId)}async $openRemoteSocket(e){if(!this._factory||this._factory.socketFactoryId!==e)throw new Error(`No socket factory with id ${e}`);const t=++this._remoteSocketIdCounter,i=await this._factory.makeConnection(),n=new Te;return this._managedRemoteSockets.set(t,new c8(t,i,n)),n.add(De(()=>this._managedRemoteSockets.delete(t))),n.add(i.onDidEnd(()=>{this._proxy.$onDidManagedSocketEnd(t),n.dispose()})),n.add(i.onDidClose(s=>{this._proxy.$onDidManagedSocketClose(t,(s==null?void 0:s.stack)??(s==null?void 0:s.message)),n.dispose()})),n.add(i.onDidReceiveMessage(s=>this._proxy.$onDidManagedSocketHaveData(t,_e.wrap(s)))),t}$remoteSocketWrite(e,t){var i;(i=this._managedRemoteSockets.get(e))==null||i.actual.send(t.buffer)}$remoteSocketEnd(e){const t=this._managedRemoteSockets.get(e);t&&(t.actual.end(),t.dispose())}async $remoteSocketDrain(e){var t,i,n;await((n=(t=this._managedRemoteSockets.get(e))==null?void 0:(i=t.actual).drain)==null?void 0:n.call(i))}};Gv=U([M(0,Ve)],Gv);class a8{constructor(e,t){this.socketFactoryId=e,this.makeConnection=t}}class c8 extends Fe{constructor(e,t,i){super(),this.socketId=e,this.actual=t,this._register(i)}}var Qv;const Zy="vs/workbench/api/common/extHostExtensionService",aS=Ce("IHostUtils");let Jv=Qv=class extends Fe{constructor(e,t,i,n,s,o,a,c,l,u,d,f,m){super(),this._extHostManagedSockets=f,this._extHostLanguageModels=m,this._onDidChangeRemoteConnectionData=this._register(new R),this.onDidChangeRemoteConnectionData=this._onDidChangeRemoteConnectionData.event,this._realPathCache=new Map,this._isTerminating=!1,this._hostUtils=t,this._extHostContext=i,this._initData=a,this._extHostWorkspace=n,this._extHostConfiguration=s,this._logService=o,this._extHostTunnelService=l,this._extHostTerminalService=u,this._extHostLocalizationService=d,this._mainThreadWorkspaceProxy=this._extHostContext.getProxy(J.MainThreadWorkspace),this._mainThreadTelemetryProxy=this._extHostContext.getProxy(J.MainThreadTelemetry),this._mainThreadExtensionsProxy=this._extHostContext.getProxy(J.MainThreadExtensionService),this._almostReadyToRunExtensions=new Ki,this._readyToStartExtensionHost=new Ki,this._readyToRunExtensions=new Ki,this._eagerExtensionsActivated=new Ki,this._activationEventsReader=new u8(this._initData.extensions.activationEvents),this._globalRegistry=new co(this._activationEventsReader,this._initData.extensions.allExtensions);const b=new ko(this._initData.extensions.myExtensions);this._myRegistry=new co(this._activationEventsReader,cS(this._globalRegistry,b)),as&&(this._logService.info(`Creating extension host with the following global extensions: ${Vo(this._globalRegistry)}`),this._logService.info(`Creating extension host with the following local extensions: ${Vo(this._myRegistry)}`)),this._storage=new XC(this._extHostContext,this._logService),this._secretState=new oS(this._extHostContext),this._storagePath=c,this._instaService=e.createChild(new kw([Gw,this._storage],[e0,this._secretState])),this._activator=this._register(new Pv(this._myRegistry,this._globalRegistry,{onExtensionActivationError:(_,v,k)=>{this._mainThreadExtensionsProxy.$onExtensionActivationError(_,lh(v),k)},actualActivateExtension:async(_,v)=>{if(co.isHostExtension(_,this._myRegistry,this._globalRegistry))return await this._mainThreadExtensionsProxy.$activateExtension(_,v),new C7;const k=this._myRegistry.getExtensionDescription(_);return this._activateExtension(k,v)}},this._logService)),this._extensionPathIndex=null,this._resolvers=Object.create(null),this._started=!1,this._remoteConnectionData=this._initData.remote.connectionData}getRemoteConnectionData(){return this._remoteConnectionData}async initialize(){try{await this._beforeAlmostReadyToRunExtensions(),this._almostReadyToRunExtensions.open(),await this._extHostWorkspace.waitForInitializeCall(),Si("code/extHost/ready"),this._readyToStartExtensionHost.open(),this._initData.autoStart&&this._startExtensionHost()}catch(e){nn(e)}}async _deactivateAll(){this._storagePath.onWillDeactivateAll();let e=[];try{e=this._myRegistry.getAllExtensionDescriptions().map(s=>s.identifier).filter(s=>this.isActivated(s)).map(s=>this._deactivate(s))}catch{}await Promise.all(e)}terminate(e,t=0){if(this._isTerminating)return;this._isTerminating=!0,this._logService.info(`Extension host terminating: ${e}`),this._logService.flush(),this._extHostTerminalService.dispose(),this._activator.dispose(),Al&&wm(n=>{this._logService.error(n)}),this._extHostContext.dispose();const i=this._deactivateAll();Promise.race([Yn(5e3),i]).finally(()=>{this._hostUtils.pid?this._logService.info(`Extension host with pid ${this._hostUtils.pid} exiting with code ${t}`):this._logService.info(`Extension host exiting with code ${t}`),this._logService.flush(),this._logService.dispose(),this._hostUtils.exit(t)})}isActivated(e){return this._readyToRunExtensions.isOpen()?this._activator.isActivated(e):!1}async getExtension(e){const t=await this._mainThreadExtensionsProxy.$getExtension(e);return t&&{...t,identifier:new Xe(t.identifier.value),extensionLocation:x.revive(t.extensionLocation)}}_activateByEvent(e,t){return this._activator.activateByEvent(e,t)}_activateById(e,t){return this._activator.activateById(e,t)}activateByIdWithErrors(e,t){return this._activateById(e,t).then(()=>{const i=this._activator.getActivatedExtension(e);if(i.activationFailed)return Promise.reject(i.activationFailedError)})}getExtensionRegistry(){return this._readyToRunExtensions.wait().then(e=>this._myRegistry)}getExtensionExports(e){if(this._readyToRunExtensions.isOpen())return this._activator.getActivatedExtension(e).exports;try{return this._activator.getActivatedExtension(e).exports}catch{return null}}async _realPathExtensionUri(e){if(e.scheme===ne.file&&this._hostUtils.fsRealpath){const t=e.fsPath;this._realPathCache.has(t)||this._realPathCache.set(t,this._hostUtils.fsRealpath(t));const i=await this._realPathCache.get(t);return x.file(i)}return e}async getExtensionPathIndex(){return this._extensionPathIndex||(this._extensionPathIndex=this._createExtensionPathIndex(this._myRegistry.getAllExtensionDescriptions()).then(e=>new l8(e))),this._extensionPathIndex}async _createExtensionPathIndex(e){const t=Gn.forUris(i=>HE.ignorePathCasing(i));return await Promise.all(e.map(async i=>{if(this._getEntryPoint(i)){const n=await this._realPathExtensionUri(i.extensionLocation);t.set(n,i)}})),t}_deactivate(e){let t=Promise.resolve(void 0);if(!this._readyToRunExtensions.isOpen()||!this._activator.isActivated(e))return t;const i=this._activator.getActivatedExtension(e);if(!i)return t;try{typeof i.module.deactivate=="function"&&(t=Promise.resolve(i.module.deactivate()).then(void 0,n=>(this._logService.error(n),Promise.resolve(void 0))))}catch(n){this._logService.error(`An error occurred when deactivating the extension '${e.value}':`),this._logService.error(n)}try{Gr(i.subscriptions)}catch(n){this._logService.error(`An error occurred when deactivating the subscriptions for extension '${e.value}':`),this._logService.error(n)}return t}async _activateExtension(e,t){return this._initData.remote.isRemote?this._mainThreadExtensionsProxy.$onWillActivateExtension(e.identifier):await this._mainThreadExtensionsProxy.$onWillActivateExtension(e.identifier),this._doActivateExtension(e,t).then(i=>{const n=i.activationTimes;return this._mainThreadExtensionsProxy.$onDidActivateExtension(e.identifier,n.codeLoadingTime,n.activateCallTime,n.activateResolvedTime,t),this._logExtensionActivationTimes(e,t,"success",n),i},i=>{throw this._logExtensionActivationTimes(e,t,"failure"),i})}_logExtensionActivationTimes(e,t,i,n){const s=e2(e,t);this._mainThreadTelemetryProxy.$publicLog2("extensionActivationTimes",{...s,...n||{},outcome:i})}_doActivateExtension(e,t){const i=e2(e,t);this._mainThreadTelemetryProxy.$publicLog2("activatePlugin",i);const n=this._getEntryPoint(e);if(!n)return Promise.resolve(new x7(uc.NONE));this._logService.info(`ExtensionService#_doActivateExtension ${e.identifier.value}, startup: ${t.startup}, activationEvent: '${t.activationEvent}'${e.identifier.value!==t.extensionId.value?`, root cause: ${t.extensionId.value}`:""}`),this._logService.flush();const s=new Py(t.startup);return Promise.all([this._loadCommonJSModule(e,wc(e.extensionLocation,n),s),this._loadExtensionContext(e)]).then(o=>(Si(`code/extHost/willActivateExtension/${e.identifier.value}`),Qv._callActivate(this._logService,e.identifier,o[0],o[1],s))).then(o=>(Si(`code/extHost/didActivateExtension/${e.identifier.value}`),o))}_loadExtensionContext(e){const t=this._extHostLanguageModels.createLanguageModelAccessInformation(e),i=new S7(e,this._storage),n=new ZC(e.identifier.value,!1,this._storage),s=new o8(e,this._secretState),o=e.isUnderDevelopment?this._initData.environment.extensionTestsLocationURI?pa.Test:pa.Development:pa.Production,a=this._initData.remote.isRemote?ro.Workspace:ro.UI;return this._logService.trace(`ExtensionService#loadExtensionContext ${e.identifier.value}`),Promise.all([i.whenReady,n.whenReady,this._storagePath.whenReady]).then(()=>{var f;const c=this;let l,u;const d=Lt(e,"ipc")?(f=this._initData.messagePorts)==null?void 0:f.get(Xe.toKey(e.identifier)):void 0;return Object.freeze({globalState:i,workspaceState:n,secrets:s,subscriptions:[],get languageModelAccessInformation(){return t},get extensionUri(){return e.extensionLocation},get extensionPath(){return e.extensionLocation.fsPath},asAbsolutePath(m){return P0(e.extensionLocation.fsPath,m)},get storagePath(){var m;return(m=c._storagePath.workspaceValue(e))==null?void 0:m.fsPath},get globalStoragePath(){return c._storagePath.globalValue(e).fsPath},get logPath(){return P0(c._initData.logsLocation.fsPath,e.identifier.value)},get logUri(){return x.joinPath(c._initData.logsLocation,e.identifier.value)},get storageUri(){return c._storagePath.workspaceValue(e)},get globalStorageUri(){return c._storagePath.globalValue(e)},get extensionMode(){return o},get extension(){return l===void 0&&(l=new Xc(c,e.identifier,e,a,!1)),l},get extensionRuntime(){return O(e,"extensionRuntime"),c.extensionRuntime},get environmentVariableCollection(){return c._extHostTerminalService.getEnvironmentVariableCollection(e)},get messagePassingProtocol(){if(!u){if(!d)return;const m=It.buffer(It.fromDOMEventEmitter(d,"message",b=>b.data));d.start(),u={onDidReceiveMessage:m,postMessage:d.postMessage.bind(d)}}return u}})})}static _callActivate(e,t,i,n,s){return i=i||{activate:void 0,deactivate:void 0},this._callActivateOptional(e,t,i,n,s).then(o=>new lg(!1,null,s.build(),i,o,n.subscriptions))}static _callActivateOptional(e,t,i,n,s){if(typeof i.activate=="function")try{s.activateCallStart(),e.trace(`ExtensionService#_callActivateOptional ${t.value}`);const o=typeof global=="object"?global:self,a=i.activate.apply(o,[n]);return s.activateCallStop(),s.activateResolveStart(),Promise.resolve(a).then(c=>(s.activateResolveStop(),c))}catch(o){return Promise.reject(o)}else return Promise.resolve(i)}_activateOneStartupFinished(e,t){this._activateById(e.identifier,{startup:!1,extensionId:e.identifier,activationEvent:t}).then(void 0,i=>{this._logService.error(i)})}_activateAllStartupFinishedDeferred(e,t=0){const n=Date.now();_x(()=>{for(let s=t;s<e.length;s+=1){const o=e[s];for(const a of o.activationEvents??[])if(a==="onStartupFinished")if(Date.now()-n>50){this._activateAllStartupFinishedDeferred(e,s);break}else this._activateOneStartupFinished(o,a)}})}_activateAllStartupFinished(){this._mainThreadExtensionsProxy.$setPerformanceMarks(A4()),this._extHostConfiguration.getConfigProvider().then(e=>{const t=e.getConfiguration("extensions.experimental").get("deferredStartupFinishedActivation"),i=this._myRegistry.getAllExtensionDescriptions();if(t)this._activateAllStartupFinishedDeferred(i);else for(const n of i)if(n.activationEvents)for(const s of n.activationEvents)s==="onStartupFinished"&&this._activateOneStartupFinished(n,s)})}_handleEagerExtensions(){const e=this._activateByEvent("*",!0).then(void 0,o=>{this._logService.error(o)});this._register(this._extHostWorkspace.onDidChangeWorkspace(o=>this._handleWorkspaceContainsEagerExtensions(o.added)));const t=this._extHostWorkspace.workspace?this._extHostWorkspace.workspace.folders:[],i=this._handleWorkspaceContainsEagerExtensions(t),n=this._handleRemoteResolverEagerExtensions(),s=Promise.all([n,e,i]).then(()=>{});return Promise.race([s,Yn(1e4)]).then(()=>{this._activateAllStartupFinished()}),s}_handleWorkspaceContainsEagerExtensions(e){return e.length===0?Promise.resolve(void 0):Promise.all(this._myRegistry.getAllExtensionDescriptions().map(t=>this._handleWorkspaceContainsEagerExtension(e,t))).then(()=>{})}async _handleWorkspaceContainsEagerExtension(e,t){if(this.isActivated(t.identifier))return;const i=!this._initData.remote.isRemote&&!!this._initData.remote.authority,n={logService:this._logService,folders:e.map(o=>o.uri),forceUsingSearch:i||!this._hostUtils.fsExists,exists:o=>this._hostUtils.fsExists(o.fsPath),checkExists:(o,a,c)=>this._mainThreadWorkspaceProxy.$checkExists(o,a,c)},s=await n8(n,t);if(s)return this._activateById(t.identifier,{startup:!0,extensionId:t.identifier,activationEvent:s.activationEvent}).then(void 0,o=>this._logService.error(o))}async _handleRemoteResolverEagerExtensions(){if(this._initData.remote.authority)return this._activateByEvent(`onResolveRemoteAuthority:${this._initData.remote.authority}`,!1)}async $extensionTestsExecute(){await this._eagerExtensionsActivated.wait();try{return await this._doHandleExtensionTests()}catch(e){throw console.error(e),e}}async _doHandleExtensionTests(){const{extensionDevelopmentLocationURI:e,extensionTestsLocationURI:t}=this._initData.environment;if(!e||!t)throw new Error(h(Zy,0,"Cannot load test runner."));const i=await this._loadCommonJSModule(null,t,new Py(!1));if(!i||typeof i.run!="function")throw new Error(h(Zy,1,"Path {0} does not point to a valid extension test runner.",t.toString()));return new Promise((n,s)=>{const o=(l,u)=>{l?(as&&this._logService.error("Test runner called back with error",l),s(l)):(as&&(u?this._logService.info(`Test runner called back with ${u} failures.`):this._logService.info("Test runner called back with successful outcome.")),n(typeof u=="number"&&u>0?1:0))},a=Wi(t),c=i.run(a,o);c&&c.then&&c.then(()=>{as&&this._logService.info("Test runner finished successfully."),n(0)}).catch(l=>{as&&this._logService.error("Test runner finished with error",l),s(l instanceof Error&&l.stack?l.stack:String(l))})})}_startExtensionHost(){if(this._started)throw new Error("Extension host is already started!");return this._started=!0,this._readyToStartExtensionHost.wait().then(()=>this._readyToRunExtensions.open()).then(()=>Promise.race([this._activator.waitForActivatingExtensions(),Yn(1e3)])).then(()=>this._handleEagerExtensions()).then(()=>{this._eagerExtensionsActivated.open(),this._logService.info("Eager extensions activated")})}registerRemoteAuthorityResolver(e,t){return this._resolvers[e]=t,De(()=>{delete this._resolvers[e]})}async getRemoteExecServer(e){var i;const{resolver:t}=await this._activateAndGetResolver(e);return(i=t==null?void 0:t.resolveExecServer)==null?void 0:i.call(t,e,{resolveAttempt:0})}async _activateAndGetResolver(e){const t=e.indexOf("+");if(t===-1)throw new _n("Not an authority that can be resolved!",Jn.InvalidAuthority);const i=e.substr(0,t);return await this._almostReadyToRunExtensions.wait(),await this._activateByEvent(`onResolveRemoteAuthority:${i}`,!1),{authorityPrefix:i,resolver:this._resolvers[i]}}async $resolveAuthority(e,t){var D;const i=rr.create(!1),n=()=>`[resolveAuthority(${_y(e)},${t})][${i.elapsed()}ms] `,s=E=>this._logService.info(`${n()}${E}`),o=E=>this._logService.warn(`${n()}${E}`),a=(E,N=void 0)=>this._logService.error(`${n()}${E}`,N),c=E=>{if(E instanceof _n)return{type:"error",error:{code:E._code,message:E._message,detail:E._detail}};throw E},l=async E=>{s(`activating resolver for ${E}...`);const{resolver:N,authorityPrefix:A}=await this._activateAndGetResolver(E);if(!N)throw a(`no resolver for ${A}`),new _n(`No remote extension installed to resolve ${A}.`,Jn.NoResolverFound);return{resolver:N,authorityPrefix:A,remoteAuthority:E}},u=e.split(/@|%40/g).reverse();s(`activating remote resolvers ${u.join(" -> ")}`);let d;try{d=await Promise.all(u.map(l)).catch(async E=>{if(!(E instanceof _n)||E._code!==Jn.InvalidAuthority)throw E;return o(`resolving nested authorities failed: ${E.message}`),[await l(e)]})}catch(E){return c(E)}const f=new JE;f.cancelAndSet(()=>s("waiting..."),1e3);let m,b;for(const[E,{authorityPrefix:N,resolver:A,remoteAuthority:j}]of d.entries())try{if(E===d.length-1)s("invoking final resolve()..."),Si(`code/extHost/willResolveAuthority/${N}`),m=await A.resolve(j,{resolveAttempt:t,execServer:b}),Si(`code/extHost/didResolveAuthorityOK/${N}`),s("setting tunnel factory..."),this._register(await this._extHostTunnelService.setTunnelFactory(A,eh.isManagedResolvedAuthority(m)?m:void 0));else{if(s(`invoking resolveExecServer() for ${j}`),Si(`code/extHost/willResolveExecServer/${N}`),b=await((D=A.resolveExecServer)==null?void 0:D.call(A,j,{resolveAttempt:t,execServer:b})),!b)throw new _n(`Exec server was not available for ${j}`,Jn.NoResolverFound);Si(`code/extHost/didResolveExecServerOK/${N}`)}}catch(re){return Si(`code/extHost/didResolveAuthorityError/${N}`),a("returned an error",re),f.dispose(),c(re)}f.dispose();const _={environmentTunnels:m.environmentTunnels,features:m.tunnelFeatures?{elevation:m.tunnelFeatures.elevation,privacyOptions:m.tunnelFeatures.privacyOptions,protocol:m.tunnelFeatures.protocol===void 0?!0:m.tunnelFeatures.protocol}:void 0},v={extensionHostEnv:m.extensionHostEnv,isTrusted:m.isTrusted,authenticationSession:m.authenticationSessionForInitializingExtensions?{id:m.authenticationSessionForInitializingExtensions.id,providerId:m.authenticationSessionForInitializingExtensions.providerId}:void 0};s(`returned ${eh.isManagedResolvedAuthority(m)?"managed authority":`${m.host}:${m.port}`}`);let k;if(eh.isManagedResolvedAuthority(m)){const E=t;this._extHostManagedSockets.setFactory(E,m.makeConnection),k={authority:e,connectTo:new vI(E),connectionToken:m.connectionToken}}else k={authority:e,connectTo:new _I(m.host,m.port),connectionToken:m.connectionToken};return{type:"ok",value:{authority:k,options:v,tunnelInformation:_}}}async $getCanonicalURI(e,t){this._logService.info(`$getCanonicalURI invoked for authority (${_y(e)})`);const{resolver:i}=await this._activateAndGetResolver(e);if(!i)return null;const n=x.revive(t);if(typeof i.getCanonicalURI>"u")return n;const s=await Bt(()=>i.getCanonicalURI(n));return s||n}async $startExtensionHost(e){e.toAdd.forEach(o=>o.extensionLocation=x.revive(o.extensionLocation));const{globalRegistry:t,myExtensions:i}=Yy(this._activationEventsReader,this._globalRegistry,this._myRegistry,e),n=await this._createExtensionPathIndex(i);return(await this.getExtensionPathIndex()).setSearchTree(n),this._globalRegistry.set(t.getAllExtensionDescriptions()),this._myRegistry.set(i),as&&(this._logService.info(`$startExtensionHost: global extensions: ${Vo(this._globalRegistry)}`),this._logService.info(`$startExtensionHost: local extensions: ${Vo(this._myRegistry)}`)),this._startExtensionHost()}$activateByEvent(e,t){return t===1?this._almostReadyToRunExtensions.wait().then(i=>this._activateByEvent(e,!1)):this._readyToRunExtensions.wait().then(i=>this._activateByEvent(e,!1))}async $activate(e,t){return await this._readyToRunExtensions.wait(),this._myRegistry.getExtensionDescription(e)?(await this._activateById(e,t),!0):!1}async $deltaExtensions(e){e.toAdd.forEach(o=>o.extensionLocation=x.revive(o.extensionLocation));const{globalRegistry:t,myExtensions:i}=Yy(this._activationEventsReader,this._globalRegistry,this._myRegistry,e),n=await this._createExtensionPathIndex(i);return(await this.getExtensionPathIndex()).setSearchTree(n),this._globalRegistry.set(t.getAllExtensionDescriptions()),this._myRegistry.set(i),as&&(this._logService.info(`$deltaExtensions: global extensions: ${Vo(this._globalRegistry)}`),this._logService.info(`$deltaExtensions: local extensions: ${Vo(this._myRegistry)}`)),Promise.resolve(void 0)}async $test_latency(e){return e}async $test_up(e){return e.byteLength}async $test_down(e){const t=_e.alloc(e),i=Math.random()%256;for(let n=0;n<e;n++)t.writeUInt8(i,n);return t}async $updateRemoteConnectionData(e){this._remoteConnectionData=e,this._onDidChangeRemoteConnectionData.fire()}};Jv=Qv=U([M(0,Qp),M(1,aS),M(2,Ve),M(3,cr),M(4,lr),M(5,Je),M(6,jt),M(7,Qw),M(8,Kw),M(9,kc),M(10,t0),M(11,i0),M(12,Yw)],Jv);function Yy(r,e,t,i){r.addActivationEvents(i.addActivationEvents);const n=new co(r,e.getAllExtensionDescriptions());n.deltaExtensions(i.toAdd,i.toRemove);const s=new ko(t.getAllExtensionDescriptions().map(a=>a.identifier));for(const a of i.myToRemove)s.delete(a);for(const a of i.myToAdd)s.add(a);const o=cS(n,s);return{globalRegistry:n,myExtensions:o}}function e2(r,e){return{id:r.identifier.value,name:r.name,extensionVersion:r.version,publisherDisplayName:r.publisher,activationEvents:r.activationEvents?r.activationEvents.join(","):null,isBuiltin:r.isBuiltin,reason:e.activationEvent,reasonId:e.extensionId.value}}function Vo(r){return r.getAllExtensionDescriptions().map(e=>e.identifier.value).join(",")}const ns=Ce("IExtHostExtensionService");var Os,Hu,Hs;class Xc{constructor(e,t,i,n,s){ue(this,Os,void 0);ue(this,Hu,void 0);ue(this,Hs,void 0);K(this,Os,e),K(this,Hu,t),K(this,Hs,i.identifier),this.id=i.identifier.value,this.extensionUri=i.extensionLocation,this.extensionPath=Ma(Wi(i.extensionLocation)),this.packageJSON=i,this.extensionKind=n,this.isFromDifferentExtensionHost=s}get isActive(){return P(this,Os).isActivated(P(this,Hs))}get exports(){if(!(this.packageJSON.api==="none"||this.isFromDifferentExtensionHost))return P(this,Os).getExtensionExports(P(this,Hs))}async activate(){if(this.isFromDifferentExtensionHost)throw new Error("Cannot activate foreign extension");return await P(this,Os).activateByIdWithErrors(P(this,Hs),{startup:!1,extensionId:P(this,Hu),activationEvent:"api"}),this.exports}}Os=new WeakMap,Hu=new WeakMap,Hs=new WeakMap;function cS(r,e){return r.getAllExtensionDescriptions().filter(t=>e.has(t.identifier))}class l8{constructor(e){this._searchTree=e}setSearchTree(e){this._searchTree=e}findSubstr(e){return this._searchTree.findSubstr(e)}forEach(e){return this._searchTree.forEach(e)}}class u8{constructor(e){this._map=new Kr,this.addActivationEvents(e)}readActivationEvents(e){return this._map.get(e.identifier)??[]}addActivationEvents(e){for(const t of Object.keys(e))this._map.set(t,e[t])}}class d8 extends Fe{constructor(e,t=[]){super(),this.logger=new AD([e,...t]),this._register(e.onDidChangeLogLevel(i=>this.setLevel(i)))}get onDidChangeLogLevel(){return this.logger.onDidChangeLogLevel}setLevel(e){this.logger.setLevel(e)}getLevel(){return this.logger.getLevel()}trace(e,...t){this.logger.trace(e,...t)}debug(e,...t){this.logger.debug(e,...t)}info(e,...t){this.logger.info(e,...t)}warn(e,...t){this.logger.warn(e,...t)}error(e,...t){this.logger.error(e,...t)}flush(){this.logger.flush()}}const nm="vs/workbench/api/common/extHostLogService";let Kv=class extends d8{constructor(e,t,i){const n=i.remote.isRemote?"remoteexthost":e?"workerexthost":"exthost",s=i.remote.isRemote?h(nm,0,"Extension Host (Remote)"):e?h(nm,1,"Extension Host (Worker)"):h(nm,2,"Extension Host");super(t.createLogger(n,{name:s}))}};Kv=U([M(1,yc),M(2,jt)],Kv);let ip=class extends RD{constructor(e,t){super(t.logLevel,t.logsLocation,t.loggers.map(i=>En(i))),this._proxy=e.getProxy(J.MainThreadLogger)}$setLogLevel(e,t){t?this.setLogLevel(x.revive(t),e):this.setLogLevel(e)}setVisibility(e,t){super.setVisibility(e,t),this._proxy.$setVisibility(e,t)}doCreateLogger(e,t,i){return new h8(this._proxy,e,t,i)}};ip=U([M(0,Ve),M(1,jt)],ip);class h8 extends _C{constructor(e,t,i,n){super((n==null?void 0:n.logLevel)==="always"),this.proxy=e,this.file=t,this.isLoggerCreated=!1,this.buffer=[],this.setLevel(i),this.proxy.$createLogger(t,n).then(()=>{this.doLog(this.buffer),this.isLoggerCreated=!0})}log(e,t){const i=[[e,t]];this.isLoggerCreated?this.doLog(i):this.buffer.push(...i)}doLog(e){this.proxy.$log(this.file,e)}flush(){this.proxy.$flush(this.file)}}class t2{static async installEarlyHandler(e){Error.stackTraceLimit=100;const t=e.get(Je),n=e.get(Ve).getProxy(J.MainThreadErrors);wm(s=>{t.error(s);const o=lh(s);n.$onUnexpectedError(o)})}static async installFullHandler(e){const t=e.get(Je),i=e.get(Ve),n=e.get(ns),s=e.get(dg),o=i.getProxy(J.MainThreadExtensionService),a=i.getProxy(J.MainThreadErrors),c=await n.getExtensionPathIndex(),l=new WeakMap;function u(m,b){if(l.has(m))return l.get(m).stack;let _="",v,k;for(const E of b)_+=`
	at ${E.toString()}`,k=E.getFileName(),!v&&k&&(v=c.findSubstr(x.file(k)));const D=`${m.name||"Error"}: ${m.message||""}${_}`;return l.set(m,{extensionIdentifier:v==null?void 0:v.identifier,stack:D}),D}const d=Symbol("prepareStackTrace wrapped");let f=u;Object.defineProperty(Error,"prepareStackTrace",{configurable:!1,get(){return f},set(m){if(m===u||!m||m[d]){f=m||u;return}f=function(b,_){return u(b,_),m.call(Error,b,_)},Object.assign(f,{[d]:!0})}}),wm(m=>{t.error(m);const b=lh(m),_=l.get(m);if(!(_!=null&&_.extensionIdentifier)){a.$onUnexpectedError(b);return}o.$onExtensionRuntimeError(_.extensionIdentifier,b);const v=s.onExtensionError(_.extensionIdentifier,m);t.trace("forwarded error to extension?",v,_)})}}class n0{constructor(e,t,i,n,s){this._hostUtils=i,this._rpcProtocol=new Vm(e,null,n),t=n0._transform(t,this._rpcProtocol);const o=new kw(...ok());o.set(jt,{_serviceBrand:void 0,...t,messagePorts:s}),o.set(Ve,new lk(this._rpcProtocol)),o.set(Jp,new uk(n)),o.set(aS,i),o.set(Je,new pn(Kv,[!0],!0)),o.set(yc,new pn(ip,[],!0));const a=new wh(o,!0);Al&&a.invokeFunction(t2.installEarlyHandler),this._logService=a.invokeFunction(c=>c.get(Je)),Si("code/extHost/didCreateServices"),this._hostUtils.pid?this._logService.info(`Extension host with pid ${this._hostUtils.pid} started`):this._logService.info("Extension host started"),this._logService.trace("initData",t),this._extensionService=a.invokeFunction(c=>c.get(ns)),this._extensionService.initialize(),Al&&a.invokeFunction(t2.installFullHandler)}async asBrowserUri(e){const t=this._rpcProtocol.getProxy(J.MainThreadExtensionService);return x.revive(await t.$asBrowserUri(e))}async getAllStaticBrowserUris(){return(await this._rpcProtocol.getProxy(J.MainThreadExtensionService).$getAllStaticBrowserUris()).map(([t,i])=>[x.revive(t),x.revive(i)])}terminate(e){this._extensionService.terminate(e)}getExtHostExtensionService(){return this._extensionService}static _transform(e,t){e.extensions.allExtensions.forEach(n=>{n.extensionLocation=x.revive(t.transformIncomingURIs(n.extensionLocation))}),e.environment.appRoot=x.revive(t.transformIncomingURIs(e.environment.appRoot));const i=e.environment.extensionDevelopmentLocationURI;return i&&(e.environment.extensionDevelopmentLocationURI=i.map(n=>x.revive(t.transformIncomingURIs(n)))),e.environment.extensionTestsLocationURI=x.revive(t.transformIncomingURIs(e.environment.extensionTestsLocationURI)),e.environment.globalStorageHome=x.revive(t.transformIncomingURIs(e.environment.globalStorageHome)),e.environment.workspaceStorageHome=x.revive(t.transformIncomingURIs(e.environment.workspaceStorageHome)),e.environment.extensionTelemetryLogResource=x.revive(t.transformIncomingURIs(e.environment.extensionTelemetryLogResource)),e.nlsBaseUrl=x.revive(t.transformIncomingURIs(e.nlsBaseUrl)),e.logsLocation=x.revive(t.transformIncomingURIs(e.logsLocation)),e.workspace=t.transformIncomingURIs(e.workspace),e}}const f8=(function(e){const t=i=>{globalThis.removeEventListener("message",t);const n=i.data;Object.defineProperties(globalThis,{postMessage:{value(s,o){n.postMessage(s,o)}},onmessage:{get(){return n.onmessage},set(s){n.onmessage=s}}}),n.addEventListener("message",s=>{globalThis.dispatchEvent(new MessageEvent("message",{data:s.data,ports:s.ports?[...s.ports]:void 0}))}),n.start(),globalThis.Worker=class{constructor(){throw new TypeError("Nested workers from within nested worker are NOT supported.")}},importScripts(e)};globalThis.addEventListener("message",t)}).toString();class p8 extends EventTarget{constructor(e,t,i){super(),this.onmessage=null,this.onmessageerror=null,this.onerror=null;const n=`((${f8})('${t}'))`,s=new Blob([n],{type:"application/javascript"}),o=URL.createObjectURL(s),a=new MessageChannel,c=o,l={type:"_newWorker",id:c,port:a.port2,url:o,options:i};e(l,[a.port2]),this.postMessage=a.port1.postMessage.bind(a.port1),this.terminate=()=>{e({type:"_terminateWorker",id:c}),URL.revokeObjectURL(o),a.port1.close(),a.port2.close()},Object.defineProperties(this,{onmessage:{get(){return a.port1.onmessage},set(u){a.port1.onmessage=u}},onmessageerror:{get(){return a.port1.onmessageerror},set(u){a.port1.onmessageerror=u}}}),a.port1.addEventListener("messageerror",u=>{const d=new MessageEvent("messageerror",{data:u.data});this.dispatchEvent(d)}),a.port1.addEventListener("message",u=>{const d=new MessageEvent("message",{data:u.data});this.dispatchEvent(d)}),a.port1.start()}}new G("inOutput",!1);new G("activeLogOutput",!1);new G("activeLogOutput.levelSettable",!1);new G("activeLogOutput.level","");new G("activeLogOutput.levelIsDefault",!1);new G("outputView.scrollLock",!1);var fl;(function(r){r[r.Append=1]="Append",r[r.Replace=2]="Replace",r[r.Clear=3]="Clear"})(fl||(fl={}));const g8={OutputChannels:"workbench.contributions.outputChannels"};class m8{constructor(){this.channels=new Map,this._onDidRegisterChannel=new R,this.onDidRegisterChannel=this._onDidRegisterChannel.event,this._onDidRemoveChannel=new R,this.onDidRemoveChannel=this._onDidRemoveChannel.event}registerChannel(e){this.channels.has(e.id)||(this.channels.set(e.id,e),this._onDidRegisterChannel.fire(e.id))}getChannels(){const e=[];return this.channels.forEach(t=>e.push(t)),e}getChannel(e){return this.channels.get(e)}removeChannel(e){this.channels.delete(e),this._onDidRemoveChannel.fire(e)}}qt.add(g8.OutputChannels,new m8);new G("activeOutputChannel","");function v8(r){return r.getFullYear()+"-"+String(r.getMonth()+1).padStart(2,"0")+"-"+String(r.getDate()).padStart(2,"0")+"T"+String(r.getHours()).padStart(2,"0")+":"+String(r.getMinutes()).padStart(2,"0")+":"+String(r.getSeconds()).padStart(2,"0")+"."+(r.getMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}class lS extends _C{get disposed(){return this._disposed}constructor(e,t,i,n,s){super(),this.id=e,this.name=t,this.logger=i,this.proxy=n,this.extension=s,this.offset=0,this._disposed=!1,this.visible=!1,this.setLevel(i.getLevel()),this._register(i.onDidChangeLogLevel(o=>this.setLevel(o)))}get logLevel(){return this.getLevel()}appendLine(e){this.append(e+`
`)}append(e){this.info(e)}clear(){const e=this.offset;this.logger.flush(),this.proxy.$update(this.id,fl.Clear,e)}replace(e){const t=this.offset;this.info(e),this.proxy.$update(this.id,fl.Replace,t),this.visible&&this.logger.flush()}show(e,t){this.logger.flush(),this.proxy.$reveal(this.id,!!(typeof e=="boolean"?e:t))}hide(){this.proxy.$close(this.id)}log(e,t){this.offset+=_e.fromString(t).byteLength,TD(this.logger,e,t),this.visible&&(this.logger.flush(),this.proxy.$update(this.id,fl.Append))}dispose(){super.dispose(),this._disposed||(this.proxy.$dispose(this.id),this._disposed=!0)}}class _8 extends lS{appendLine(e){this.append(e)}}let Xv=class{constructor(e,t,i,n,s,o){this.initData=t,this.extHostFileSystem=i,this.extHostFileSystemInfo=n,this.loggerService=s,this.logService=o,this.extensionLogDirectoryPromise=new Map,this.namePool=1,this.channels=new Map,this.visibleChannelId=null,this.proxy=e.getProxy(J.MainThreadOutputService),this.outputsLocation=this.extHostFileSystemInfo.extUri.joinPath(t.logsLocation,`output_logging_${v8(new Date).replace(/-|:|\.\d+Z$/g,"")}`)}$setVisibleChannel(e){this.visibleChannelId=e;for(const[t,i]of this.channels)i.visible=t===this.visibleChannelId}createOutputChannel(e,t,i){var l,u;if(e=e.trim(),!e)throw new Error("illegal argument `name`. must not be falsy");const n=typeof t=="object"&&t.log,s=$e(t)?t:void 0;if($e(s)&&!s.trim())throw new Error("illegal argument `languageId`. must not be empty");let o;const a=(u=(l=this.initData.environment.extensionLogLevel)==null?void 0:l.find(([d])=>Xe.equals(i.identifier,d)))==null?void 0:u[1];a&&(o=$D(a));const c=n?this.doCreateLogOutputChannel(e,o,i):this.doCreateOutputChannel(e,s,i);return c.then(d=>{this.channels.set(d.id,d),d.visible=d.id===this.visibleChannelId}),n?this.createExtHostLogOutputChannel(e,o??this.logService.getLevel(),c):this.createExtHostOutputChannel(e,c)}async doCreateOutputChannel(e,t,i){this.outputDirectoryPromise||(this.outputDirectoryPromise=this.extHostFileSystem.value.createDirectory(this.outputsLocation).then(()=>this.outputsLocation));const n=await this.outputDirectoryPromise,s=this.extHostFileSystemInfo.extUri.joinPath(n,`${this.namePool++}-${e.replace(/[\\/:\*\?"<>\|]/g,"")}.log`),o=this.loggerService.createLogger(s,{logLevel:"always",donotRotate:!0,donotUseFormatters:!0,hidden:!0}),a=await this.proxy.$register(e,s,t,i.identifier.value);return new lS(a,e,o,this.proxy,i)}async doCreateLogOutputChannel(e,t,i){const n=await this.createExtensionLogDirectory(i),s=e.replace(/[\\/:\*\?"<>\|]/g,""),o=this.extHostFileSystemInfo.extUri.joinPath(n,`${s}.log`),a=`${i.identifier.value}.${s}`,c=this.loggerService.createLogger(o,{id:a,name:e,logLevel:t,extensionId:i.identifier.value});return new _8(a,e,c,this.proxy,i)}createExtensionLogDirectory(e){let t=this.extensionLogDirectoryPromise.get(e.identifier.value);if(!t){const i=this.extHostFileSystemInfo.extUri.joinPath(this.initData.logsLocation,e.identifier.value);this.extensionLogDirectoryPromise.set(e.identifier.value,t=(async()=>{try{await this.extHostFileSystem.value.createDirectory(i)}catch(n){if(Km(n)!==Ee.FileExists)throw n}return i})())}return t}createExtHostOutputChannel(e,t){let i=!1;const n=()=>{if(i)throw new Error("Channel has been closed")};return{get name(){return e},append(s){n(),t.then(o=>o.append(s))},appendLine(s){n(),t.then(o=>o.appendLine(s))},clear(){n(),t.then(s=>s.clear())},replace(s){n(),t.then(o=>o.replace(s))},show(s,o){n(),t.then(a=>a.show(s,o))},hide(){n(),t.then(s=>s.hide())},dispose(){i=!0,t.then(s=>s.dispose())}}}createExtHostLogOutputChannel(e,t,i){const n=new Te,s=()=>{if(n.isDisposed)throw new Error("Channel has been closed")},o=n.add(new R);function a(c){t=c,o.fire(c)}return i.then(c=>{n.add(c),c.logLevel!==t&&a(c.logLevel),n.add(c.onDidChangeLogLevel(l=>a(l)))}),{...this.createExtHostOutputChannel(e,i),get logLevel(){return t},onDidChangeLogLevel:o.event,trace(c,...l){s(),i.then(u=>u.trace(c,...l))},debug(c,...l){s(),i.then(u=>u.debug(c,...l))},info(c,...l){s(),i.then(u=>u.info(c,...l))},warn(c,...l){s(),i.then(u=>u.warn(c,...l))},error(c,...l){s(),i.then(u=>u.error(c,...l))},dispose(){n.dispose()}}}};Xv=U([M(0,Ve),M(1,jt),M(2,ug),M(3,xc),M(4,yc),M(5,Je)],Xv);const uS=Ce("IExtHostOutputService");var Zc,uo;let Zv=(uo=class{constructor(e,t){this._logService=t,this._provider=new Map,this._proxy=e.getProxy(J.MainThreadDecorations)}registerFileDecorationProvider(e,t){const i=Zc._handlePool++;this._provider.set(i,{provider:e,extensionDescription:t}),this._proxy.$registerDecorationProvider(i,t.identifier.value);const n=e.onDidChangeFileDecorations&&e.onDidChangeFileDecorations(s=>{if(!s){this._proxy.$onDidChange(i,null);return}const o=$a(s);if(o.length<=Zc._maxEventSize){this._proxy.$onDidChange(i,o);return}this._logService.warn("[Decorations] CAPPING events from decorations provider",t.identifier.value,o.length);const a=o.map(u=>({uri:u,rank:cE(u.path,"/")})),c=JS(a,(u,d)=>u.rank-d.rank||fo(u.uri.path,d.uri.path)),l=[];e:for(const u of c){let d;for(const f of u){const m=Ys(f.uri.path);if(d!==m&&(d=m,l.push(f.uri)>=Zc._maxEventSize))break e}}this._proxy.$onDidChange(i,l)});return new Ne(()=>{n==null||n.dispose(),this._proxy.$unregisterDecorationProvider(i),this._provider.delete(i)})}async $provideDecorations(e,t,i){if(!this._provider.has(e))return Object.create(null);const n=Object.create(null),{provider:s,extensionDescription:o}=this._provider.get(e);return await Promise.all(t.map(async a=>{try{const{uri:c,id:l}=a,u=await Promise.resolve(s.provideFileDecoration(x.revive(c),i));if(!u)return;try{L1.validate(u),u.badge&&typeof u.badge!="string"&&O(o,"codiconDecoration"),n[l]=[u.propagate,u.tooltip,u.badge,u.color]}catch(d){this._logService.warn(`INVALID decoration from extension '${o.identifier.value}': ${d}`)}}catch(c){this._logService.error(c)}})),n}},Zc=uo,uo._handlePool=0,uo._maxEventSize=250,uo);Zv=Zc=U([M(0,Ve),M(1,Je)],Zv);const dS=Ce("IExtHostDecorations");class w8{constructor(e){this.values=e,this.prefixSum=new Uint32Array(e.length),this.prefixSumValidIndex=new Int32Array(1),this.prefixSumValidIndex[0]=-1}getCount(){return this.values.length}insertValues(e,t){e=Bo(e);const i=this.values,n=this.prefixSum,s=t.length;return s===0?!1:(this.values=new Uint32Array(i.length+s),this.values.set(i.subarray(0,e),0),this.values.set(i.subarray(e),e+s),this.values.set(t,e),e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),this.prefixSum=new Uint32Array(this.values.length),this.prefixSumValidIndex[0]>=0&&this.prefixSum.set(n.subarray(0,this.prefixSumValidIndex[0]+1)),!0)}setValue(e,t){return e=Bo(e),t=Bo(t),this.values[e]===t?!1:(this.values[e]=t,e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),!0)}removeValues(e,t){e=Bo(e),t=Bo(t);const i=this.values,n=this.prefixSum;if(e>=i.length)return!1;const s=i.length-e;return t>=s&&(t=s),t===0?!1:(this.values=new Uint32Array(i.length-t),this.values.set(i.subarray(0,e),0),this.values.set(i.subarray(e+t),e),this.prefixSum=new Uint32Array(this.values.length),e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),this.prefixSumValidIndex[0]>=0&&this.prefixSum.set(n.subarray(0,this.prefixSumValidIndex[0]+1)),!0)}getTotalSum(){return this.values.length===0?0:this._getPrefixSum(this.values.length-1)}getPrefixSum(e){return e<0?0:(e=Bo(e),this._getPrefixSum(e))}_getPrefixSum(e){if(e<=this.prefixSumValidIndex[0])return this.prefixSum[e];let t=this.prefixSumValidIndex[0]+1;t===0&&(this.prefixSum[0]=this.values[0],t++),e>=this.values.length&&(e=this.values.length-1);for(let i=t;i<=e;i++)this.prefixSum[i]=this.prefixSum[i-1]+this.values[i];return this.prefixSumValidIndex[0]=Math.max(this.prefixSumValidIndex[0],e),this.prefixSum[e]}getIndexOf(e){e=Math.floor(e),this.getTotalSum();let t=0,i=this.values.length-1,n=0,s=0,o=0;for(;t<=i;)if(n=t+(i-t)/2|0,s=this.prefixSum[n],o=s-this.values[n],e<o)i=n-1;else if(e>=s)t=n+1;else break;return new b8(n,e-o)}}class b8{constructor(e,t){this.index=e,this.remainder=t,this._prefixSumIndexOfResultBrand=void 0,this.index=e,this.remainder=t}}class y8{constructor(e,t,i,n){this._uri=e,this._lines=t,this._eol=i,this._versionId=n,this._lineStarts=null,this._cachedTextValue=null}dispose(){this._lines.length=0}get version(){return this._versionId}getText(){return this._cachedTextValue===null&&(this._cachedTextValue=this._lines.join(this._eol)),this._cachedTextValue}onEvents(e){e.eol&&e.eol!==this._eol&&(this._eol=e.eol,this._lineStarts=null);const t=e.changes;for(const i of t)this._acceptDeleteRange(i.range),this._acceptInsertText(new Mi(i.range.startLineNumber,i.range.startColumn),i.text);this._versionId=e.versionId,this._cachedTextValue=null}_ensureLineStarts(){if(!this._lineStarts){const e=this._eol.length,t=this._lines.length,i=new Uint32Array(t);for(let n=0;n<t;n++)i[n]=this._lines[n].length+e;this._lineStarts=new w8(i)}}_setLineText(e,t){this._lines[e]=t,this._lineStarts&&this._lineStarts.setValue(e,this._lines[e].length+this._eol.length)}_acceptDeleteRange(e){if(e.startLineNumber===e.endLineNumber){if(e.startColumn===e.endColumn)return;this._setLineText(e.startLineNumber-1,this._lines[e.startLineNumber-1].substring(0,e.startColumn-1)+this._lines[e.startLineNumber-1].substring(e.endColumn-1));return}this._setLineText(e.startLineNumber-1,this._lines[e.startLineNumber-1].substring(0,e.startColumn-1)+this._lines[e.endLineNumber-1].substring(e.endColumn-1)),this._lines.splice(e.startLineNumber,e.endLineNumber-e.startLineNumber),this._lineStarts&&this._lineStarts.removeValues(e.startLineNumber,e.endLineNumber-e.startLineNumber)}_acceptInsertText(e,t){if(t.length===0)return;const i=Tx(t);if(i.length===1){this._setLineText(e.lineNumber-1,this._lines[e.lineNumber-1].substring(0,e.column-1)+i[0]+this._lines[e.lineNumber-1].substring(e.column-1));return}i[i.length-1]+=this._lines[e.lineNumber-1].substring(e.column-1),this._setLineText(e.lineNumber-1,this._lines[e.lineNumber-1].substring(0,e.column-1)+i[0]);const n=new Uint32Array(i.length-1);for(let s=1;s<i.length;s++)this._lines.splice(e.lineNumber+s-1,0,i[s]),n[s-1]=i[s].length+this._eol.length;this._lineStarts&&this._lineStarts.insertValues(e.lineNumber,n)}}const hS="`~!@#$%^&*()-=+[{]}\\|;:'\",.<>/?";function x8(r=""){let e="(-?\\d*\\.\\d\\w*)|([^";for(const t of hS)r.indexOf(t)>=0||(e+="\\"+t);return e+="\\s]+)",new RegExp(e,"g")}const C8=x8();function fS(r){let e=C8;if(r&&r instanceof RegExp)if(r.global)e=r;else{let t="g";r.ignoreCase&&(t+="i"),r.multiline&&(t+="m"),r.unicode&&(t+="u"),e=new RegExp(r.source,t)}return e.lastIndex=0,e}const pS=new Yu;pS.unshift({maxLen:1e3,windowSize:15,timeBudget:150});function gS(r,e,t,i,n){if(e=fS(e),n||(n=nr.first(pS)),t.length>n.maxLen){let l=r-n.maxLen/2;return l<0?l=0:i+=l,t=t.substring(l,r+n.maxLen/2),gS(r,e,t,i,n)}const s=Date.now(),o=r-1-i;let a=-1,c=null;for(let l=1;!(Date.now()-s>=n.timeBudget);l++){const u=o-n.windowSize*l;e.lastIndex=Math.max(0,u);const d=S8(e,t,o,a);if(!d&&c||(c=d,u<=0))break;a=u}if(c){const l={word:c[0],startColumn:i+1+c.index,endColumn:i+1+c.index+c[0].length};return e.lastIndex=0,l}return null}function S8(r,e,t,i){let n;for(;n=r.exec(e);){const s=n.index||0;if(s<=t&&r.lastIndex>=t)return n;if(i>0&&s>i)return null}return null}const Yv=new Map;function E8(r,e){e?Yv.set(r,e):Yv.delete(r)}function k8(r){return Yv.get(r)}class D8 extends y8{constructor(e,t,i,n,s,o,a){super(t,i,n,s),this._proxy=e,this._languageId=o,this._isDirty=a,this._isDisposed=!1}dispose(){vi(!this._isDisposed),this._isDisposed=!0,this._isDirty=!1}equalLines(e){return qr(this._lines,e)}get document(){if(!this._document){const e=this;this._document={get uri(){return e._uri},get fileName(){return e._uri.fsPath},get isUntitled(){return e._uri.scheme===ne.untitled},get languageId(){return e._languageId},get version(){return e._versionId},get isClosed(){return e._isDisposed},get isDirty(){return e._isDirty},save(){return e._save()},getText(t){return t?e._getTextInRange(t):e.getText()},get eol(){return e._eol===`
`?Zi.LF:Zi.CRLF},get lineCount(){return e._lines.length},lineAt(t){return e._lineAt(t)},offsetAt(t){return e._offsetAt(t)},positionAt(t){return e._positionAt(t)},validateRange(t){return e._validateRange(t)},validatePosition(t){return e._validatePosition(t)},getWordRangeAtPosition(t,i){return e._getWordRangeAtPosition(t,i)}}}return Object.freeze(this._document)}_acceptLanguageId(e){vi(!this._isDisposed),this._languageId=e}_acceptIsDirty(e){vi(!this._isDisposed),this._isDirty=e}_save(){return this._isDisposed?Promise.reject(new Error("Document has been closed")):this._proxy.$trySaveDocument(this._uri)}_getTextInRange(e){const t=this._validateRange(e);if(t.isEmpty)return"";if(t.isSingleLine)return this._lines[t.start.line].substring(t.start.character,t.end.character);const i=this._eol,n=t.start.line,s=t.end.line,o=[];o.push(this._lines[n].substring(t.start.character));for(let a=n+1;a<s;a++)o.push(this._lines[a]);return o.push(this._lines[s].substring(0,t.end.character)),o.join(i)}_lineAt(e){let t;if(e instanceof ke?t=e.line:typeof e=="number"&&(t=e),typeof t!="number"||t<0||t>=this._lines.length||Math.floor(t)!==t)throw new Error("Illegal value for `line`");return new I8(t,this._lines[t],t===this._lines.length-1)}_offsetAt(e){return e=this._validatePosition(e),this._ensureLineStarts(),this._lineStarts.getPrefixSum(e.line-1)+e.character}_positionAt(e){e=Math.floor(e),e=Math.max(0,e),this._ensureLineStarts();const t=this._lineStarts.getIndexOf(e),i=this._lines[t.index].length;return new ke(t.index,Math.min(t.remainder,i))}_validateRange(e){if(!(e instanceof xe))throw new Error("Invalid argument");const t=this._validatePosition(e.start),i=this._validatePosition(e.end);return t===e.start&&i===e.end?e:new xe(t.line,t.character,i.line,i.character)}_validatePosition(e){if(!(e instanceof ke))throw new Error("Invalid argument");if(this._lines.length===0)return e.with(0,0);let{line:t,character:i}=e,n=!1;if(t<0)t=0,i=0,n=!0;else if(t>=this._lines.length)t=this._lines.length-1,i=this._lines[t].length,n=!0;else{const s=this._lines[t].length;i<0?(i=0,n=!0):i>s&&(i=s,n=!0)}return n?new ke(t,i):e}_getWordRangeAtPosition(e,t){const i=this._validatePosition(e);if(!t)t=k8(this._languageId);else if(Px(t))throw new Error(`[getWordRangeAtPosition]: ignoring custom regexp '${t.source}' because it matches the empty string.`);const n=gS(i.character+1,fS(t),this._lines[i.line],0);if(n)return new xe(i.line,n.startColumn-1,i.line,n.endColumn-1)}}class I8{constructor(e,t,i){this._line=e,this._text=t,this._isLastLine=i}get lineNumber(){return this._line}get text(){return this._text}get range(){return new xe(this._line,0,this._line,this._text.length)}get rangeIncludingLineBreak(){return this._isLastLine?this.range:new xe(this._line,0,this._line+1,0)}get firstNonWhitespaceCharacterIndex(){return/^(\s*)/.exec(this._text)[1].length}get isEmptyOrWhitespace(){return this.firstNonWhitespaceCharacterIndex===this._text.length}}class r0{constructor(e){this._prefix=e,this._lastId=0}nextId(){return this._prefix+ ++this._lastId}}const Pp=class Pp{constructor(e,t,i){const n=Pp._Keys.nextId();e.$registerTextEditorDecorationType(t.identifier,n,K1.from(i)),this.value=Object.freeze({key:n,dispose(){e.$removeTextEditorDecorationType(n)}})}};Pp._Keys=new r0("TextEditorDecorationType");let e_=Pp;class P8{constructor(e,t){this._collectedEdits=[],this._setEndOfLine=void 0,this._finalized=!1,this._document=e,this._documentVersionId=e.version,this._undoStopBefore=t.undoStopBefore,this._undoStopAfter=t.undoStopAfter}finalize(){return this._finalized=!0,{documentVersionId:this._documentVersionId,edits:this._collectedEdits,setEndOfLine:this._setEndOfLine,undoStopBefore:this._undoStopBefore,undoStopAfter:this._undoStopAfter}}_throwIfFinalized(){if(this._finalized)throw new Error("Edit is only valid while callback runs")}replace(e,t){this._throwIfFinalized();let i=null;if(e instanceof ke)i=new xe(e,e);else if(e instanceof xe)i=e;else throw new Error("Unrecognized location");this._pushEdit(i,t,!1)}insert(e,t){this._throwIfFinalized(),this._pushEdit(new xe(e,e),t,!0)}delete(e){this._throwIfFinalized();let t=null;if(e instanceof xe)t=e;else throw new Error("Unrecognized location");this._pushEdit(t,null,!0)}_pushEdit(e,t,i){const n=this._document.validateRange(e);this._collectedEdits.push({range:n,text:t,forceMoveMarkers:i})}setEndOfLine(e){if(this._throwIfFinalized(),e!==Zi.LF&&e!==Zi.CRLF)throw Se("endOfLine");this._setEndOfLine=e}}class T8{constructor(e,t,i,n){this._proxy=e,this._id=t,this._accept(i),this._logService=n;const s=this;this.value={get tabSize(){return s._tabSize},set tabSize(o){s._setTabSize(o)},get indentSize(){return s._indentSize},set indentSize(o){s._setIndentSize(o)},get insertSpaces(){return s._insertSpaces},set insertSpaces(o){s._setInsertSpaces(o)},get cursorStyle(){return s._cursorStyle},set cursorStyle(o){s._setCursorStyle(o)},get lineNumbers(){return s._lineNumbers},set lineNumbers(o){s._setLineNumbers(o)}}}_accept(e){this._tabSize=e.tabSize,this._indentSize=e.indentSize,this._originalIndentSize=e.originalIndentSize,this._insertSpaces=e.insertSpaces,this._cursorStyle=e.cursorStyle,this._lineNumbers=ma.to(e.lineNumbers)}_validateTabSize(e){if(e==="auto")return"auto";if(typeof e=="number"){const t=Math.floor(e);return t>0?t:null}if(typeof e=="string"){const t=parseInt(e,10);return isNaN(t)?null:t>0?t:null}return null}_setTabSize(e){const t=this._validateTabSize(e);if(t!==null){if(typeof t=="number"){if(this._tabSize===t)return;this._tabSize=t}this._warnOnError("setTabSize",this._proxy.$trySetOptions(this._id,{tabSize:t}))}}_validateIndentSize(e){if(e==="tabSize")return"tabSize";if(typeof e=="number"){const t=Math.floor(e);return t>0?t:null}if(typeof e=="string"){const t=parseInt(e,10);return isNaN(t)?null:t>0?t:null}return null}_setIndentSize(e){const t=this._validateIndentSize(e);if(t!==null){if(typeof t=="number"){if(this._originalIndentSize===t)return;this._indentSize=t,this._originalIndentSize=t}this._warnOnError("setIndentSize",this._proxy.$trySetOptions(this._id,{indentSize:t}))}}_validateInsertSpaces(e){return e==="auto"?"auto":e==="false"?!1:!!e}_setInsertSpaces(e){const t=this._validateInsertSpaces(e);if(typeof t=="boolean"){if(this._insertSpaces===t)return;this._insertSpaces=t}this._warnOnError("setInsertSpaces",this._proxy.$trySetOptions(this._id,{insertSpaces:t}))}_setCursorStyle(e){this._cursorStyle!==e&&(this._cursorStyle=e,this._warnOnError("setCursorStyle",this._proxy.$trySetOptions(this._id,{cursorStyle:e})))}_setLineNumbers(e){this._lineNumbers!==e&&(this._lineNumbers=e,this._warnOnError("setLineNumbers",this._proxy.$trySetOptions(this._id,{lineNumbers:ma.from(e)})))}assign(e){const t={};let i=!1;if(typeof e.tabSize<"u"){const n=this._validateTabSize(e.tabSize);n==="auto"?(i=!0,t.tabSize=n):typeof n=="number"&&this._tabSize!==n&&(this._tabSize=n,i=!0,t.tabSize=n)}if(typeof e.indentSize<"u"){const n=this._validateIndentSize(e.indentSize);n==="tabSize"?(i=!0,t.indentSize=n):typeof n=="number"&&this._originalIndentSize!==n&&(this._indentSize=n,this._originalIndentSize=n,i=!0,t.indentSize=n)}if(typeof e.insertSpaces<"u"){const n=this._validateInsertSpaces(e.insertSpaces);n==="auto"?(i=!0,t.insertSpaces=n):this._insertSpaces!==n&&(this._insertSpaces=n,i=!0,t.insertSpaces=n)}typeof e.cursorStyle<"u"&&this._cursorStyle!==e.cursorStyle&&(this._cursorStyle=e.cursorStyle,i=!0,t.cursorStyle=e.cursorStyle),typeof e.lineNumbers<"u"&&this._lineNumbers!==e.lineNumbers&&(this._lineNumbers=e.lineNumbers,i=!0,t.lineNumbers=ma.from(e.lineNumbers)),i&&this._warnOnError("setOptions",this._proxy.$trySetOptions(this._id,t))}_warnOnError(e,t){t.catch(i=>{this._logService.warn(`ExtHostTextEditorOptions '${e}' failed:'`),this._logService.warn(i)})}}class A8{constructor(e,t,i,n,s,o,a,c){this.id=e,this._proxy=t,this._logService=i,this._disposed=!1,this._hasDecorationsForKey=new Set,this._selections=s,this._options=new T8(this._proxy,this.id,o,i),this._visibleRanges=a,this._viewColumn=c;const l=this;this.value=Object.freeze({get document(){return n.value},set document(u){throw new Ss("document")},get selection(){return l._selections&&l._selections[0]},set selection(u){if(!(u instanceof sr))throw Se("selection");l._selections=[u],l._trySetSelection()},get selections(){return l._selections},set selections(u){if(!Array.isArray(u)||u.some(d=>!(d instanceof sr)))throw Se("selections");l._selections=u,l._trySetSelection()},get visibleRanges(){return l._visibleRanges},set visibleRanges(u){throw new Ss("visibleRanges")},get options(){return l._options.value},set options(u){l._disposed||l._options.assign(u)},get viewColumn(){return l._viewColumn},set viewColumn(u){throw new Ss("viewColumn")},edit(u,d={undoStopBefore:!0,undoStopAfter:!0}){if(l._disposed)return Promise.reject(new Error("TextEditor#edit not possible on closed editors"));const f=new P8(n.value,d);return u(f),l._applyEdit(f)},insertSnippet(u,d,f={undoStopBefore:!0,undoStopAfter:!0}){if(l._disposed)return Promise.reject(new Error("TextEditor#insertSnippet not possible on closed editors"));let m;if(!d||Array.isArray(d)&&d.length===0)m=l._selections.map(b=>H.from(b));else if(d instanceof ke){const{lineNumber:b,column:_}=qe.from(d);m=[{startLineNumber:b,startColumn:_,endLineNumber:b,endColumn:_}]}else if(d instanceof xe)m=[H.from(d)];else{m=[];for(const b of d)if(b instanceof xe)m.push(H.from(b));else{const{lineNumber:_,column:v}=qe.from(b);m.push({startLineNumber:_,startColumn:v,endLineNumber:_,endColumn:v})}}return t.$tryInsertSnippet(e,n.value.version,u.value,m,f)},setDecorations(u,d){const f=d.length===0;f&&!l._hasDecorationsForKey.has(u.key)||(f?l._hasDecorationsForKey.delete(u.key):l._hasDecorationsForKey.add(u.key),l._runOnProxy(()=>{if(VC(d))return t.$trySetDecorations(e,u.key,VI(d));{const m=new Array(4*d.length);for(let b=0,_=d.length;b<_;b++){const v=d[b];m[4*b]=v.start.line+1,m[4*b+1]=v.start.character+1,m[4*b+2]=v.end.line+1,m[4*b+3]=v.end.character+1}return t.$trySetDecorationsFast(e,u.key,m)}}))},revealRange(u,d){l._runOnProxy(()=>t.$tryRevealRange(e,H.from(u),d||Qh.Default))},show(u){t.$tryShowEditor(e,Et.from(u))},hide(){t.$tryHideEditor(e)}})}dispose(){vi(!this._disposed),this._disposed=!0}_acceptOptions(e){vi(!this._disposed),this._options._accept(e)}_acceptVisibleRanges(e){vi(!this._disposed),this._visibleRanges=e}_acceptViewColumn(e){vi(!this._disposed),this._viewColumn=e}_acceptSelections(e){vi(!this._disposed),this._selections=e}async _trySetSelection(){const e=this._selections.map(Fi.from);return await this._runOnProxy(()=>this._proxy.$trySetSelections(this.id,e)),this.value}_applyEdit(e){const t=e.finalize();if(t.edits.length===0&&!t.setEndOfLine)return Promise.resolve(!0);const i=t.edits.map(s=>s.range);i.sort((s,o)=>s.end.line===o.end.line?s.end.character===o.end.character?s.start.line===o.start.line?s.start.character-o.start.character:s.start.line-o.start.line:s.end.character-o.end.character:s.end.line-o.end.line);for(let s=0,o=i.length-1;s<o;s++){const a=i[s].end;if(i[s+1].start.isBefore(a))return Promise.reject(new Error("Overlapping ranges are not allowed!"))}const n=t.edits.map(s=>({range:H.from(s.range),text:s.text,forceMoveMarkers:s.forceMoveMarkers}));return this._proxy.$tryApplyEdits(this.id,t.documentVersionId,n,{setEndOfLine:typeof t.setEndOfLine=="number"?rc.from(t.setEndOfLine):void 0,undoStopBefore:t.undoStopBefore,undoStopAfter:t.undoStopAfter})}_runOnProxy(e){return this._disposed?(this._logService.warn("TextEditor is closed/disposed"),Promise.resolve(void 0)):e().then(()=>this,t=>(t instanceof Error&&t.name==="DISPOSED"||this._logService.warn(t),null))}}class R8{constructor(e){this.value=e,this._count=0}ref(){this._count++}unref(){return--this._count===0}}let t_=class{constructor(e,t){this._extHostRpc=e,this._logService=t,this._activeEditorId=null,this._editors=new Map,this._documents=new Pt,this._onDidAddDocuments=new R,this._onDidRemoveDocuments=new R,this._onDidChangeVisibleTextEditors=new R,this._onDidChangeActiveTextEditor=new R,this.onDidAddDocuments=this._onDidAddDocuments.event,this.onDidRemoveDocuments=this._onDidRemoveDocuments.event,this.onDidChangeVisibleTextEditors=this._onDidChangeVisibleTextEditors.event,this.onDidChangeActiveTextEditor=this._onDidChangeActiveTextEditor.event}$acceptDocumentsAndEditorsDelta(e){this.acceptDocumentsAndEditorsDelta(e)}acceptDocumentsAndEditorsDelta(e){const t=[],i=[],n=[];if(e.removedDocuments)for(const s of e.removedDocuments){const o=x.revive(s),a=this._documents.get(o);a!=null&&a.unref()&&(this._documents.delete(o),t.push(a.value))}if(e.addedDocuments)for(const s of e.addedDocuments){const o=x.revive(s.uri);let a=this._documents.get(o);if(a&&o.scheme!==ne.vscodeNotebookCell&&o.scheme!==ne.vscodeInteractiveInput)throw new Error(`document '${o} already exists!'`);a||(a=new R8(new D8(this._extHostRpc.getProxy(J.MainThreadDocuments),o,s.lines,s.EOL,s.versionId,s.languageId,s.isDirty)),this._documents.set(o,a),i.push(a.value)),a.ref()}if(e.removedEditors)for(const s of e.removedEditors){const o=this._editors.get(s);this._editors.delete(s),o&&n.push(o)}if(e.addedEditors)for(const s of e.addedEditors){const o=x.revive(s.documentUri);vi(this._documents.has(o),`document '${o}' does not exist`),vi(!this._editors.has(s.id),`editor '${s.id}' already exists!`);const a=this._documents.get(o).value,c=new A8(s.id,this._extHostRpc.getProxy(J.MainThreadTextEditors),this._logService,new Xn(()=>a.document),s.selections.map(Fi.to),s.options,s.visibleRanges.map(l=>H.to(l)),typeof s.editorPosition=="number"?Et.to(s.editorPosition):void 0);this._editors.set(s.id,c)}e.newActiveEditor!==void 0&&(vi(e.newActiveEditor===null||this._editors.has(e.newActiveEditor),`active editor '${e.newActiveEditor}' does not exist`),this._activeEditorId=e.newActiveEditor),Gr(t),Gr(n),e.removedDocuments&&this._onDidRemoveDocuments.fire(t),e.addedDocuments&&this._onDidAddDocuments.fire(i),(e.removedEditors||e.addedEditors)&&this._onDidChangeVisibleTextEditors.fire(this.allEditors().map(s=>s.value)),e.newActiveEditor!==void 0&&this._onDidChangeActiveTextEditor.fire(this.activeEditor())}getDocument(e){var t;return(t=this._documents.get(e))==null?void 0:t.value}allDocuments(){return nr.map(this._documents.values(),e=>e.value)}getEditor(e){return this._editors.get(e)}activeEditor(e){if(!this._activeEditorId)return;const t=this._editors.get(this._activeEditorId);return e?t:t==null?void 0:t.value}allEditors(){return[...this._editors.values()]}};t_=U([M(0,Ve),M(1,Je)],t_);const ud=Ce("IExtHostDocumentsAndEditors"),fg=Ce("IExtHostApiDeprecationService");let i_=class{constructor(e,t){this._extHostLogService=t,this._reportedUsages=new Set,this._telemetryShape=e.getProxy(J.MainThreadTelemetry)}report(e,t,i){const n=this.getUsageKey(e,t);this._reportedUsages.has(n)||(this._reportedUsages.add(n),t.isUnderDevelopment&&this._extHostLogService.warn(`[Deprecation Warning] '${e}' is deprecated. ${i}`),this._telemetryShape.$publicLog2("extHostDeprecatedApiUsage",{extensionId:t.identifier.value,apiId:e}))}getUsageKey(e,t){return`${e}-${t.identifier.value}`}};i_=U([M(0,Ve),M(1,Je)],i_);const np=Object.freeze({activeComment:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.activeComment.d.ts",aiRelatedInformation:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.aiRelatedInformation.d.ts",aiTextSearchProvider:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.aiTextSearchProvider.d.ts",authGetSessions:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.authGetSessions.d.ts",authLearnMore:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.authLearnMore.d.ts",authSession:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.authSession.d.ts",canonicalUriProvider:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.canonicalUriProvider.d.ts",chatParticipant:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatParticipant.d.ts",chatParticipantAdditions:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatParticipantAdditions.d.ts",chatProvider:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatProvider.d.ts",chatTab:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatTab.d.ts",chatVariableResolver:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatVariableResolver.d.ts",codeActionAI:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.codeActionAI.d.ts",codeActionRanges:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.codeActionRanges.d.ts",codiconDecoration:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.codiconDecoration.d.ts",commentReactor:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentReactor.d.ts",commentThreadApplicability:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentThreadApplicability.d.ts",commentingRangeHint:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentingRangeHint.d.ts",commentsDraftState:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentsDraftState.d.ts",contribAccessibilityHelpContent:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribAccessibilityHelpContent.d.ts",contribCommentEditorActionsMenu:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentEditorActionsMenu.d.ts",contribCommentPeekContext:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentPeekContext.d.ts",contribCommentThreadAdditionalMenu:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentThreadAdditionalMenu.d.ts",contribCommentsViewThreadMenus:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentsViewThreadMenus.d.ts",contribDiffEditorGutterToolBarMenus:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribDiffEditorGutterToolBarMenus.d.ts",contribEditSessions:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribEditSessions.d.ts",contribEditorContentMenu:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribEditorContentMenu.d.ts",contribIssueReporter:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribIssueReporter.d.ts",contribLabelFormatterWorkspaceTooltip:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribLabelFormatterWorkspaceTooltip.d.ts",contribMenuBarHome:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribMenuBarHome.d.ts",contribMergeEditorMenus:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribMergeEditorMenus.d.ts",contribMultiDiffEditorMenus:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribMultiDiffEditorMenus.d.ts",contribNotebookStaticPreloads:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribNotebookStaticPreloads.d.ts",contribRemoteHelp:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribRemoteHelp.d.ts",contribShareMenu:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribShareMenu.d.ts",contribSourceControlHistoryItemGroupMenu:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlHistoryItemGroupMenu.d.ts",contribSourceControlHistoryItemMenu:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlHistoryItemMenu.d.ts",contribSourceControlInputBoxMenu:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlInputBoxMenu.d.ts",contribSourceControlTitleMenu:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlTitleMenu.d.ts",contribStatusBarItems:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribStatusBarItems.d.ts",contribViewsRemote:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribViewsRemote.d.ts",contribViewsWelcome:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribViewsWelcome.d.ts",createFileSystemWatcher:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.createFileSystemWatcher.d.ts",customEditorMove:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.customEditorMove.d.ts",debugFocus:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.debugFocus.d.ts",debugVisualization:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.debugVisualization.d.ts",defaultChatParticipant:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.defaultChatParticipant.d.ts",diffCommand:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.diffCommand.d.ts",diffContentOptions:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.diffContentOptions.d.ts",documentFiltersExclusive:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.documentFiltersExclusive.d.ts",documentPaste:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.documentPaste.d.ts",editSessionIdentityProvider:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.editSessionIdentityProvider.d.ts",editorHoverVerbosityLevel:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.editorHoverVerbosityLevel.d.ts",editorInsets:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.editorInsets.d.ts",extensionRuntime:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.extensionRuntime.d.ts",extensionsAny:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.extensionsAny.d.ts",externalUriOpener:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.externalUriOpener.d.ts",fileComments:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.fileComments.d.ts",fileSearchProvider:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.fileSearchProvider.d.ts",findFiles2:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.findFiles2.d.ts",findTextInFiles:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.findTextInFiles.d.ts",fsChunks:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.fsChunks.d.ts",idToken:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.idToken.d.ts",inlineCompletionsAdditions:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.inlineCompletionsAdditions.d.ts",inlineEdit:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.inlineEdit.d.ts",interactive:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.interactive.d.ts",interactiveWindow:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.interactiveWindow.d.ts",ipc:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.ipc.d.ts",languageModels:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageModels.d.ts",languageStatusText:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageStatusText.d.ts",mappedEditsProvider:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.mappedEditsProvider.d.ts",multiDocumentHighlightProvider:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.multiDocumentHighlightProvider.d.ts",newSymbolNamesProvider:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.newSymbolNamesProvider.d.ts",notebookCellExecution:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookCellExecution.d.ts",notebookCellExecutionState:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookCellExecutionState.d.ts",notebookControllerAffinityHidden:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookControllerAffinityHidden.d.ts",notebookDeprecated:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookDeprecated.d.ts",notebookExecution:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookExecution.d.ts",notebookKernelSource:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookKernelSource.d.ts",notebookLiveShare:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookLiveShare.d.ts",notebookMessaging:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookMessaging.d.ts",notebookMime:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookMime.d.ts",notebookVariableProvider:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookVariableProvider.d.ts",portsAttributes:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.portsAttributes.d.ts",profileContentHandlers:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.profileContentHandlers.d.ts",quickDiffProvider:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickDiffProvider.d.ts",quickPickItemTooltip:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickPickItemTooltip.d.ts",quickPickSortByLabel:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickPickSortByLabel.d.ts",resolvers:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.resolvers.d.ts",scmActionButton:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmActionButton.d.ts",scmHistoryProvider:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmHistoryProvider.d.ts",scmMultiDiffEditor:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmMultiDiffEditor.d.ts",scmSelectedProvider:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmSelectedProvider.d.ts",scmTextDocument:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmTextDocument.d.ts",scmValidation:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmValidation.d.ts",shareProvider:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.shareProvider.d.ts",showLocal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.showLocal.d.ts",speech:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.speech.d.ts",tabInputMultiDiff:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tabInputMultiDiff.d.ts",tabInputTextMerge:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tabInputTextMerge.d.ts",taskPresentationGroup:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.taskPresentationGroup.d.ts",telemetry:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.telemetry.d.ts",terminalDataWriteEvent:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalDataWriteEvent.d.ts",terminalDimensions:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalDimensions.d.ts",terminalExecuteCommandEvent:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalExecuteCommandEvent.d.ts",terminalQuickFixProvider:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalQuickFixProvider.d.ts",terminalSelection:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalSelection.d.ts",terminalShellIntegration:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalShellIntegration.d.ts",testObserver:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.testObserver.d.ts",testPreserveFocus:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.testPreserveFocus.d.ts",textSearchProvider:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textSearchProvider.d.ts",timeline:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.timeline.d.ts",tokenInformation:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tokenInformation.d.ts",treeViewActiveItem:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.treeViewActiveItem.d.ts",treeViewMarkdownMessage:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.treeViewMarkdownMessage.d.ts",treeViewReveal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.treeViewReveal.d.ts",tunnelFactory:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tunnelFactory.d.ts",tunnels:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tunnels.d.ts",workspaceTrust:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.workspaceTrust.d.ts"}),L8="vscode://schemas/vscode-product",X="vs/workbench/services/extensions/common/extensionsRegistry",s0=qt.as(ig.JSONContribution);class pl{static _toSet(e){const t=new ko;for(let i=0,n=e.length;i<n;i++)t.add(e[i].description.identifier);return t}static compute(e,t){if(!e||!e.length)return new pl(t,[]);if(!t||!t.length)return new pl([],e);const i=this._toSet(e),n=this._toSet(t),s=t.filter(a=>!i.has(a.description.identifier)),o=e.filter(a=>!n.has(a.description.identifier));return new pl(s,o)}constructor(e,t){this.added=e,this.removed=t}}class $8{constructor(e,t){this.name=e,this.defaultExtensionKind=t,this._handler=null,this._users=null,this._delta=null}setHandler(e){if(this._handler!==null)throw new Error("Handler already set!");this._handler=e,this._handle()}acceptUsers(e){this._delta=pl.compute(this._users,e),this._users=e,this._handle()}_handle(){if(!(this._handler===null||this._users===null||this._delta===null))try{this._handler(this._users,this._delta)}catch(e){nn(e)}}}const N8={type:"string",enum:["ui","workspace"],enumDescriptions:[h(X,0,"UI extension kind. In a remote window, such extensions are enabled only when available on the local machine."),h(X,1,"Workspace extension kind. In a remote window, such extensions are enabled only when available on the remote.")]},mS="vscode://schemas/vscode-extensions",n_={properties:{engines:{type:"object",description:h(X,2,"Engine compatibility."),properties:{vscode:{type:"string",description:h(X,3,"For VS Code extensions, specifies the VS Code version that the extension is compatible with. Cannot be *. For example: ^0.10.5 indicates compatibility with a minimum VS Code version of 0.10.5."),default:"^1.22.0"}}},publisher:{description:h(X,4,"The publisher of the VS Code extension."),type:"string"},displayName:{description:h(X,5,"The display name for the extension used in the VS Code gallery."),type:"string"},categories:{description:h(X,6,"The categories used by the VS Code gallery to categorize the extension."),type:"array",uniqueItems:!0,items:{oneOf:[{type:"string",enum:mI},{type:"string",const:"Languages",deprecationMessage:h(X,7,"Use 'Programming  Languages' instead")}]}},galleryBanner:{type:"object",description:h(X,8,"Banner used in the VS Code marketplace."),properties:{color:{description:h(X,9,"The banner color on the VS Code marketplace page header."),type:"string"},theme:{description:h(X,10,"The color theme for the font used in the banner."),type:"string",enum:["dark","light"]}}},contributes:{description:h(X,11,"All contributions of the VS Code extension represented by this package."),type:"object",properties:{},default:{}},preview:{type:"boolean",description:h(X,12,"Sets the extension to be flagged as a Preview in the Marketplace.")},enableProposedApi:{type:"boolean",deprecationMessage:h(X,13,"Use `enabledApiProposals` instead.")},enabledApiProposals:{markdownDescription:h(X,14,"Enable API proposals to try them out. Only valid **during development**. Extensions **cannot be published** with this property. For more details visit: https://code.visualstudio.com/api/advanced-topics/using-proposed-api"),type:"array",uniqueItems:!0,items:{type:"string",enum:Object.keys(np),markdownEnumDescriptions:Object.values(np)}},api:{markdownDescription:h(X,15,"Describe the API provided by this extension. For more details visit: https://code.visualstudio.com/api/advanced-topics/remote-extensions#handling-dependencies-with-remote-extensions"),type:"string",enum:["none"],enumDescriptions:[h(X,16,"Give up entirely the ability to export any APIs. This allows other extensions that depend on this extension to run in a separate extension host process or in a remote machine.")]},activationEvents:{description:h(X,17,"Activation events for the VS Code extension."),type:"array",items:{type:"string",defaultSnippets:[{label:"onWebviewPanel",description:h(X,18,"An activation event emmited when a webview is loaded of a certain viewType"),body:"onWebviewPanel:viewType"},{label:"onLanguage",description:h(X,19,"An activation event emitted whenever a file that resolves to the specified language gets opened."),body:"onLanguage:${1:languageId}"},{label:"onCommand",description:h(X,20,"An activation event emitted whenever the specified command gets invoked."),body:"onCommand:${2:commandId}"},{label:"onDebug",description:h(X,21,"An activation event emitted whenever a user is about to start debugging or about to setup debug configurations."),body:"onDebug"},{label:"onDebugInitialConfigurations",description:h(X,22,'An activation event emitted whenever a "launch.json" needs to be created (and all provideDebugConfigurations methods need to be called).'),body:"onDebugInitialConfigurations"},{label:"onDebugDynamicConfigurations",description:h(X,23,'An activation event emitted whenever a list of all debug configurations needs to be created (and all provideDebugConfigurations methods for the "dynamic" scope need to be called).'),body:"onDebugDynamicConfigurations"},{label:"onDebugResolve",description:h(X,24,"An activation event emitted whenever a debug session with the specific type is about to be launched (and a corresponding resolveDebugConfiguration method needs to be called)."),body:"onDebugResolve:${6:type}"},{label:"onDebugAdapterProtocolTracker",description:h(X,25,"An activation event emitted whenever a debug session with the specific type is about to be launched and a debug protocol tracker might be needed."),body:"onDebugAdapterProtocolTracker:${6:type}"},{label:"workspaceContains",description:h(X,26,"An activation event emitted whenever a folder is opened that contains at least a file matching the specified glob pattern."),body:"workspaceContains:${4:filePattern}"},{label:"onStartupFinished",description:h(X,27,"An activation event emitted after the start-up finished (after all `*` activated extensions have finished activating)."),body:"onStartupFinished"},{label:"onTaskType",description:h(X,28,"An activation event emitted whenever tasks of a certain type need to be listed or resolved."),body:"onTaskType:${1:taskType}"},{label:"onFileSystem",description:h(X,29,"An activation event emitted whenever a file or folder is accessed with the given scheme."),body:"onFileSystem:${1:scheme}"},{label:"onEditSession",description:h(X,30,"An activation event emitted whenever an edit session is accessed with the given scheme."),body:"onEditSession:${1:scheme}"},{label:"onSearch",description:h(X,31,"An activation event emitted whenever a search is started in the folder with the given scheme."),body:"onSearch:${7:scheme}"},{label:"onView",body:"onView:${5:viewId}",description:h(X,32,"An activation event emitted whenever the specified view is expanded.")},{label:"onUri",body:"onUri",description:h(X,33,"An activation event emitted whenever a system-wide Uri directed towards this extension is open.")},{label:"onOpenExternalUri",body:"onOpenExternalUri",description:h(X,34,"An activation event emitted whenever a external uri (such as an http or https link) is being opened.")},{label:"onCustomEditor",body:"onCustomEditor:${9:viewType}",description:h(X,35,"An activation event emitted whenever the specified custom editor becomes visible.")},{label:"onNotebook",body:"onNotebook:${1:type}",description:h(X,36,"An activation event emitted whenever the specified notebook document is opened.")},{label:"onAuthenticationRequest",body:"onAuthenticationRequest:${11:authenticationProviderId}",description:h(X,37,"An activation event emitted whenever sessions are requested from the specified authentication provider.")},{label:"onRenderer",description:h(X,38,"An activation event emitted whenever a notebook output renderer is used."),body:"onRenderer:${11:rendererId}"},{label:"onTerminalProfile",body:"onTerminalProfile:${1:terminalId}",description:h(X,39,"An activation event emitted when a specific terminal profile is launched.")},{label:"onTerminalQuickFixRequest",body:"onTerminalQuickFixRequest:${1:quickFixId}",description:h(X,40,"An activation event emitted when a command matches the selector associated with this ID")},{label:"onWalkthrough",body:"onWalkthrough:${1:walkthroughID}",description:h(X,41,"An activation event emitted when a specified walkthrough is opened.")},{label:"onIssueReporterOpened",body:"onIssueReporterOpened",description:h(X,42,"An activation event emitted when the issue reporter is opened.")},{label:"*",description:h(X,43,"An activation event emitted on VS Code startup. To ensure a great end user experience, please use this activation event in your extension only when no other activation events combination works in your use-case."),body:"*"}]}},badges:{type:"array",description:h(X,44,"Array of badges to display in the sidebar of the Marketplace's extension page."),items:{type:"object",required:["url","href","description"],properties:{url:{type:"string",description:h(X,45,"Badge image URL.")},href:{type:"string",description:h(X,46,"Badge link.")},description:{type:"string",description:h(X,47,"Badge description.")}}}},markdown:{type:"string",description:h(X,48,"Controls the Markdown rendering engine used in the Marketplace. Either github (default) or standard."),enum:["github","standard"],default:"github"},qna:{default:"marketplace",description:h(X,49,"Controls the Q&A link in the Marketplace. Set to marketplace to enable the default Marketplace Q & A site. Set to a string to provide the URL of a custom Q & A site. Set to false to disable Q & A altogether."),anyOf:[{type:["string","boolean"],enum:["marketplace",!1]},{type:"string"}]},extensionDependencies:{description:h(X,50,"Dependencies to other extensions. The identifier of an extension is always ${publisher}.${name}. For example: vscode.csharp."),type:"array",uniqueItems:!0,items:{type:"string",pattern:Sy}},extensionPack:{description:h(X,51,"A set of extensions that can be installed together. The identifier of an extension is always ${publisher}.${name}. For example: vscode.csharp."),type:"array",uniqueItems:!0,items:{type:"string",pattern:Sy}},extensionKind:{description:h(X,52,"Define the kind of an extension. `ui` extensions are installed and run on the local machine while `workspace` extensions run on the remote."),type:"array",items:N8,default:["workspace"],defaultSnippets:[{body:["ui"],description:h(X,53,"Define an extension which can run only on the local machine when connected to remote window.")},{body:["workspace"],description:h(X,54,"Define an extension which can run only on the remote machine when connected remote window.")},{body:["ui","workspace"],description:h(X,55,"Define an extension which can run on either side, with a preference towards running on the local machine.")},{body:["workspace","ui"],description:h(X,56,"Define an extension which can run on either side, with a preference towards running on the remote machine.")},{body:[],description:h(X,57,"Define an extension which cannot run in a remote context, neither on the local, nor on the remote machine.")}]},capabilities:{description:h(X,58,"Declare the set of supported capabilities by the extension."),type:"object",properties:{virtualWorkspaces:{description:h(X,59,"Declares whether the extension should be enabled in virtual workspaces. A virtual workspace is a workspace which is not backed by any on-disk resources. When false, this extension will be automatically disabled in virtual workspaces. Default is true."),type:["boolean","object"],defaultSnippets:[{label:"limited",body:{supported:"${1:limited}",description:"${2}"}},{label:"false",body:{supported:!1,description:"${2}"}}],default:(!0).valueOf,properties:{supported:{markdownDescription:h(X,60,"Declares the level of support for virtual workspaces by the extension."),type:["string","boolean"],enum:["limited",!0,!1],enumDescriptions:[h(X,61,"The extension will be enabled in virtual workspaces with some functionality disabled."),h(X,62,"The extension will be enabled in virtual workspaces with all functionality enabled."),h(X,63,"The extension will not be enabled in virtual workspaces.")]},description:{type:"string",markdownDescription:h(X,64,"A description of how virtual workspaces affects the extensions behavior and why it is needed. This only applies when `supported` is not `true`.")}}},untrustedWorkspaces:{description:h(X,65,"Declares how the extension should be handled in untrusted workspaces."),type:"object",required:["supported"],defaultSnippets:[{body:{supported:"${1:limited}",description:"${2}"}}],properties:{supported:{markdownDescription:h(X,66,"Declares the level of support for untrusted workspaces by the extension."),type:["string","boolean"],enum:["limited",!0,!1],enumDescriptions:[h(X,67,"The extension will be enabled in untrusted workspaces with some functionality disabled."),h(X,68,"The extension will be enabled in untrusted workspaces with all functionality enabled."),h(X,69,"The extension will not be enabled in untrusted workspaces.")]},restrictedConfigurations:{description:h(X,70,"A list of configuration keys contributed by the extension that should not use workspace values in untrusted workspaces."),type:"array",items:{type:"string"}},description:{type:"string",markdownDescription:h(X,71,"A description of how workspace trust affects the extensions behavior and why it is needed. This only applies when `supported` is not `true`.")}}}}},sponsor:{description:h(X,72,"Specify the location from where users can sponsor your extension."),type:"object",defaultSnippets:[{body:{url:"${1:https:}"}}],properties:{url:{description:h(X,73,"URL from where users can sponsor your extension. It must be a valid URL with a HTTP or HTTPS protocol. Example value: https://github.com/sponsors/nvaccess"),type:"string"}}},scripts:{type:"object",properties:{"vscode:prepublish":{description:h(X,74,"Script executed before the package is published as a VS Code extension."),type:"string"},"vscode:uninstall":{description:h(X,75,"Uninstall hook for VS Code extension. Script that gets executed when the extension is completely uninstalled from VS Code which is when VS Code is restarted (shutdown and start) after the extension is uninstalled. Only Node scripts are supported."),type:"string"}}},icon:{type:"string",description:h(X,76,"The path to a 128x128 pixel icon.")},l10n:{type:"string",description:h(X,77,"The relative path to a folder containing localization (bundle.l10n.*.json) files. Must be specified if you are using the vscode.l10n API.")},pricing:{type:"string",markdownDescription:h(X,78,"The pricing information for the extension. Can be Free (default) or Trial. For more details visit: https://code.visualstudio.com/api/working-with-extensions/publishing-extension#extension-pricing-label"),enum:["Free","Trial"],default:"Free"}}};class M8{constructor(){this._extensionPoints=new Map}registerExtensionPoint(e){if(this._extensionPoints.has(e.extensionPoint))throw new Error("Duplicate extension point: "+e.extensionPoint);const t=new $8(e.extensionPoint,e.defaultExtensionKind);return this._extensionPoints.set(e.extensionPoint,t),e.activationEventsGenerator&&b7.register(e.extensionPoint,e.activationEventsGenerator),n_.properties.contributes.properties[e.extensionPoint]=e.jsonSchema,s0.registerSchema(mS,n_),t}getExtensionPoints(){return Array.from(this._extensionPoints.values())}}const vS={ExtensionsRegistry:"ExtensionsRegistry"};qt.add(vS.ExtensionsRegistry,new M8);const F8=qt.as(vS.ExtensionsRegistry);s0.registerSchema(mS,n_);s0.registerSchema(L8,{properties:{extensionEnabledApiProposals:{description:h(X,79,"API proposals that the respective extensions can freely use."),type:"object",properties:{},additionalProperties:{anyOf:[{type:"array",uniqueItems:!0,items:{type:"string",enum:Object.keys(np),markdownEnumDescriptions:Object.values(np)}}]}}}});const gl="vs/workbench/contrib/tasks/common/taskDefinitionRegistry",O8={type:"object",additionalProperties:!1,properties:{type:{type:"string",description:h(gl,0,"The actual task type. Please note that types starting with a '$' are reserved for internal usage.")},required:{type:"array",items:{type:"string"}},properties:{type:"object",description:h(gl,1,"Additional properties of the task type"),additionalProperties:{$ref:"http://json-schema.org/draft-07/schema#"}},when:{type:"string",markdownDescription:h(gl,2,"Condition which must be true to enable this type of task. Consider using `shellExecutionSupported`, `processExecutionSupported`, and `customExecutionSupported` as appropriate for this task definition. See the [API documentation](https://code.visualstudio.com/api/extension-guides/task-provider#when-clause) for more information."),default:""}}};var r_;(function(r){function e(t,i,n){if(!t)return;const s=$e(t.type)?t.type:void 0;if(!s||s.length===0){n.error(h(gl,3,"The task type configuration is missing the required 'taskType' property"));return}const o=[];if(Array.isArray(t.required))for(const a of t.required)$e(a)&&o.push(a);return{extensionId:i.value,taskType:s,required:o,properties:t.properties?ot(t.properties):{},when:t.when?Dt.deserialize(t.when):void 0}}r.from=e})(r_||(r_={}));const H8=F8.registerExtensionPoint({extensionPoint:"taskDefinitions",activationEventsGenerator:(r,e)=>{for(const t of r)t.type&&e.push(`onTaskType:${t.type}`)},jsonSchema:{description:h(gl,4,"Contributes task kinds"),type:"array",items:O8}});class U8{constructor(){this._onDefinitionsChanged=new R,this.onDefinitionsChanged=this._onDefinitionsChanged.event,this.taskTypes=Object.create(null),this.readyPromise=new Promise((e,t)=>{H8.setHandler((i,n)=>{this._schema=void 0;try{for(const s of n.removed){const o=s.value;for(const a of o)this.taskTypes&&a.type&&this.taskTypes[a.type]&&delete this.taskTypes[a.type]}for(const s of n.added){const o=s.value;for(const a of o){const c=r_.from(a,s.description.identifier,s.collector);c&&(this.taskTypes[c.taskType]=c)}}(n.removed.length>0||n.added.length>0)&&this._onDefinitionsChanged.fire()}catch{}e(void 0)})})}onReady(){return this.readyPromise}get(e){return this.taskTypes[e]}all(){return Object.keys(this.taskTypes).map(e=>this.taskTypes[e])}getJsonSchema(){if(this._schema===void 0){const e=[];for(const t of this.all()){const i={type:"object",additionalProperties:!1};t.required.length>0&&(i.required=t.required.slice(0)),t.properties!==void 0?i.properties=ot(t.properties):i.properties=Object.create(null),i.properties.type={type:"string",enum:[t.taskType]},e.push(i)}this._schema={oneOf:e}}return this._schema}}const B8=new U8,o0="vs/workbench/contrib/tasks/common/tasks";new G("taskRunning",!1,h(o0,0,"Whether a task is currently running."));_w(o0,1,"Tasks");var rp;(function(r){r[r.Escape=1]="Escape",r[r.Strong=2]="Strong",r[r.Weak=3]="Weak"})(rp||(rp={}));(function(r){function e(t){if(!t)return r.Strong;switch(t.toLowerCase()){case"escape":return r.Escape;case"strong":return r.Strong;case"weak":return r.Weak;default:return r.Strong}}r.from=e})(rp||(rp={}));var i2;(function(r){r.defaults={cwd:"${workspaceFolder}"}})(i2||(i2={}));var Du;(function(r){r[r.Always=1]="Always",r[r.Silent=2]="Silent",r[r.Never=3]="Never"})(Du||(Du={}));(function(r){function e(t){switch(t.toLowerCase()){case"always":return r.Always;case"silent":return r.Silent;case"never":return r.Never;default:return r.Always}}r.fromString=e})(Du||(Du={}));var Iu;(function(r){r[r.Never=1]="Never",r[r.OnProblem=2]="OnProblem",r[r.Always=3]="Always"})(Iu||(Iu={}));(function(r){function e(t){switch(t.toLowerCase()){case"always":return r.Always;case"never":return r.Never;case"onproblem":return r.OnProblem;default:return r.OnProblem}}r.fromString=e})(Iu||(Iu={}));var Pu;(function(r){r[r.Shared=1]="Shared",r[r.Dedicated=2]="Dedicated",r[r.New=3]="New"})(Pu||(Pu={}));(function(r){function e(t){switch(t.toLowerCase()){case"shared":return r.Shared;case"dedicated":return r.Dedicated;case"new":return r.New;default:return r.Shared}}r.fromString=e})(Pu||(Pu={}));var n2;(function(r){r.defaults={echo:!0,reveal:Du.Always,revealProblems:Iu.Never,focus:!1,panel:Pu.Shared,showReuseMessage:!0,clear:!1}})(n2||(n2={}));var sp;(function(r){r[r.Shell=1]="Shell",r[r.Process=2]="Process",r[r.CustomExecution=3]="CustomExecution"})(sp||(sp={}));(function(r){function e(i){switch(i.toLowerCase()){case"shell":return r.Shell;case"process":return r.Process;case"customExecution":return r.CustomExecution;default:return r.Process}}r.fromString=e;function t(i){switch(i){case r.Shell:return"shell";case r.Process:return"process";case r.CustomExecution:return"customExecution";default:return"process"}}r.toString=t})(sp||(sp={}));var r2;(function(r){function e(t){return $e(t)?t:t.value}r.value=e})(r2||(r2={}));var s2;(function(r){r.Clean={_id:"clean",isDefault:!1},r.Build={_id:"build",isDefault:!1},r.Rebuild={_id:"rebuild",isDefault:!1},r.Test={_id:"test",isDefault:!1};function e(i){return i===r.Clean._id||i===r.Build._id||i===r.Rebuild._id||i===r.Test._id}r.is=e;function t(i){if(i!==void 0)return $e(i)?e(i)?{_id:i,isDefault:!1}:void 0:i}r.from=t})(s2||(s2={}));var o2;(function(r){r.Workspace="workspace",r.Extension="extension",r.InMemory="inMemory",r.WorkspaceFile="workspaceFile",r.User="user";function e(t){switch(t){case r.User:return 2;case r.WorkspaceFile:return 5;default:return 6}}r.toConfigurationTarget=e})(o2||(o2={}));var s_;(function(r){r[r.default=1]="default",r[r.folderOpen=2]="folderOpen"})(s_||(s_={}));var a2;(function(r){r.defaults={reevaluateOnRerun:!0,runOn:s_.default,instanceLimit:1}})(a2||(a2={}));var op;(function(r){r[r.Process=1]="Process",r[r.Terminal=2]="Terminal"})(op||(op={}));(function(r){r._default=r.Terminal})(op||(op={}));var c2;(function(r){function e(c){return{taskId:c._id,taskName:c.configurationProperties.name,runType:c.configurationProperties.isBackground?"background":"singleRun",group:c.configurationProperties.group,__task:c}}function t(c,l,u){return{...e(c),kind:"start",terminalId:l,resolvedVariables:u}}r.start=t;function i(c,l,u){return{...e(c),kind:"processStarted",terminalId:l,processId:u}}r.processStarted=i;function n(c,l,u){return{...e(c),kind:"processEnded",terminalId:l,exitCode:u}}r.processEnded=n;function s(c,l,u){return{...e(c),kind:"terminated",exitReason:u,terminalId:l}}r.terminated=s;function o(c,l,u){return{...e(l),kind:c,terminalId:u}}r.general=o;function a(){return{kind:"changed"}}r.changed=a})(c2||(c2={}));var ap;(function(r){function e(i){const n=Object.keys(i).sort();let s="";for(const o of n){let a=i[o];a instanceof Object?a=e(a):typeof a=="string"&&(a=a.replace(/,/g,",,")),s+=o+","+a+","}return s}function t(i){const s={_key:e(i),type:i.taskType};return Object.assign(s,i),s}r.create=t})(ap||(ap={}));var l2;(function(r){function e(t,i){const n=B8.get(t.type);if(n===void 0){const c=ot(t);return delete c._key,ap.create(c)}const s=Object.create(null);s.type=n.taskType;const o=new Set;n.required.forEach(c=>o.add(c));const a=n.properties;for(const c of Object.keys(a)){const l=t[c];if(l!=null)s[c]=l;else if(o.has(c)){const u=a[c];if(u.default!==void 0)s[c]=ot(u.default);else switch(u.type){case"boolean":s[c]=!1;break;case"number":case"integer":s[c]=0;break;case"string":s[c]="";break;default:i.error(h(o0,2,"Error: the task identifier '{0}' is missing the required property '{1}'. The task identifier will be ignored.",JSON.stringify(t,void 0,0),c));return}}}return ap.create(s)}r.createTaskIdentifier=e})(l2||(l2={}));var cp;(function(r){function e(i){if(i!=null)return i}r.from=e;function t(i){if(i!=null)return i}r.to=t})(cp||(cp={}));var lp;(function(r){function e(i){if(i!=null)return i}r.from=e;function t(i){if(i!=null)return i}r.to=t})(lp||(lp={}));var o_;(function(r){function e(i){if(i!=null)return i}r.from=e;function t(i){if(i!=null)return i}r.to=t})(o_||(o_={}));var ml;(function(r){function e(n){if(n){const s=n;return s&&!!s.process}else return!1}r.is=e;function t(n){if(n==null)return;const s={process:n.process,args:n.args};return n.options&&(s.options=o_.from(n.options)),s}r.from=t;function i(n){if(n!=null)return new Ga(n.process,n.args,n.options)}r.to=i})(ml||(ml={}));var a_;(function(r){function e(i){if(i!=null)return i}r.from=e;function t(i){if(i!=null)return i}r.to=t})(a_||(a_={}));var vl;(function(r){function e(n){if(n){const s=n;return s&&(!!s.commandLine||!!s.command)}else return!1}r.is=e;function t(n){if(n==null)return;const s={};return n.commandLine!==void 0?s.commandLine=n.commandLine:(s.command=n.command,s.args=n.args),n.options&&(s.options=a_.from(n.options)),s}r.from=t;function i(n){if(!(n==null||n.command===void 0&&n.commandLine===void 0))return n.commandLine?new mo(n.commandLine,n.options):new mo(n.command,n.args?n.args:[],n.options)}r.to=i})(vl||(vl={}));var tr;(function(r){function e(n){if(n){const s=n;return s&&s.customExecution==="customExecution"}else return!1}r.is=e;function t(n){return{customExecution:"customExecution"}}r.from=t;function i(n,s){return s.get(n)}r.to=i})(tr||(tr={}));var c_;(function(r){function e(t){if(t!=null)return{_id:t.id,isDefault:t.isDefault}}r.from=e})(c_||(c_={}));var Mr;(function(r){function e(n,s){if(n==null)return[];const o=[];for(const a of n){const c=t(a,s);c&&o.push(c)}return o}r.fromMany=e;function t(n,s){if(n==null)return;let o;n.execution instanceof Ga?o=ml.from(n.execution):n.execution instanceof mo?o=vl.from(n.execution):n.execution&&n.execution instanceof Fw&&(o=tr.from(n.execution));const a=cp.from(n.definition);let c;return n.scope?typeof n.scope=="number"?c=n.scope:c=n.scope.uri:c=vo.Workspace,!a||!c?void 0:{_id:n._id,definition:a,name:n.name,source:{extensionId:s.identifier.value,label:n.source,scope:c},execution:o,isBackground:n.isBackground,group:c_.from(n.group),presentationOptions:lp.from(n.presentationOptions),problemMatchers:n.problemMatchers,hasDefinedMatchers:n.hasDefinedMatchers,runOptions:n.runOptions?n.runOptions:{reevaluateOnRerun:!0},detail:n.detail}}r.from=t;async function i(n,s,o){if(n==null)return;let a;ml.is(n.execution)?a=ml.to(n.execution):vl.is(n.execution)?a=vl.to(n.execution):tr.is(n.execution)&&(a=tr.to(n._id,o));const c=cp.to(n.definition);let l;if(n.source&&(n.source.scope!==void 0?typeof n.source.scope=="number"?l=n.source.scope:l=await s.resolveWorkspaceFolder(x.revive(n.source.scope)):l=vo.Workspace),!c||!l)return;const u=new Yh(c,l,n.name,n.source.label,a,n.problemMatchers);return n.isBackground!==void 0&&(u.isBackground=n.isBackground),n.group!==void 0&&(u.group=Kl.from(n.group._id),u.group&&n.group.isDefault&&(u.group=new Kl(u.group.id,u.group.label),n.group.isDefault===!0&&(u.group.isDefault=n.group.isDefault))),n.presentationOptions&&(u.presentationOptions=lp.to(n.presentationOptions)),n._id&&(u._id=n._id),n.detail&&(u.detail=n.detail),u}r.to=i})(Mr||(Mr={}));var l_;(function(r){function e(i){return i}r.from=e;function t(i){if(i)return Object.assign(Object.create(null),i)}r.to=t})(l_||(l_={}));var Uu;class rm{constructor(e,t,i){ue(this,Uu,void 0);this._id=t,this._task=i,K(this,Uu,e)}get task(){return this._task}terminate(){P(this,Uu).terminateTask(this)}fireDidStartProcess(e){}fireDidEndProcess(e){}}Uu=new WeakMap;let u_=class{constructor(e,t,i,n,s,o,a,c){this._onDidExecuteTask=new R,this._onDidTerminateTask=new R,this._onDidTaskProcessStarted=new R,this._onDidTaskProcessEnded=new R,this._proxy=e.getProxy(J.MainThreadTask),this._workspaceProvider=i,this._editorService=n,this._configurationService=s,this._terminalService=o,this._handleCounter=0,this._handlers=new Map,this._taskExecutions=new Map,this._taskExecutionPromises=new Map,this._providedCustomExecutions2=new Map,this._notProvidedCustomExecutions=new Set,this._activeCustomExecutions2=new Map,this._logService=a,this._deprecationService=c,this._proxy.$registerSupportedExecutions(!0)}registerTaskProvider(e,t,i){if(!i)return new Ne(()=>{});const n=this.nextHandle();return this._handlers.set(n,{type:t,provider:i,extension:e}),this._proxy.$registerTaskProvider(n,t),new Ne(()=>{this._handlers.delete(n),this._proxy.$unregisterTaskProvider(n)})}registerTaskSystem(e,t){this._proxy.$registerTaskSystem(e,t)}fetchTasks(e){return this._proxy.$fetchTasks(l_.from(e)).then(async t=>{const i=[];for(const n of t){const s=await Mr.to(n,this._workspaceProvider,this._providedCustomExecutions2);s&&i.push(s)}return i})}get taskExecutions(){const e=[];return this._taskExecutions.forEach(t=>e.push(t)),e}terminateTask(e){if(!(e instanceof rm))throw new Error("No valid task execution provided");return this._proxy.$terminateTask(e._id)}get onDidStartTask(){return this._onDidExecuteTask.event}async $onDidStartTask(e,t,i){const n=this._providedCustomExecutions2.get(e.id);n&&(this._activeCustomExecutions2.set(e.id,n),this._terminalService.attachPtyToTerminal(t,await n.callback(i))),this._lastStartedTask=e.id,this._onDidExecuteTask.fire({execution:await this.getTaskExecution(e)})}get onDidEndTask(){return this._onDidTerminateTask.event}async $OnDidEndTask(e){if(!this._taskExecutionPromises.has(e.id))return;const t=await this.getTaskExecution(e);this._taskExecutionPromises.delete(e.id),this._taskExecutions.delete(e.id),this.customExecutionComplete(e),this._onDidTerminateTask.fire({execution:t})}get onDidStartTaskProcess(){return this._onDidTaskProcessStarted.event}async $onDidStartTaskProcess(e){const t=await this.getTaskExecution(e.id);this._onDidTaskProcessStarted.fire({execution:t,processId:e.processId})}get onDidEndTaskProcess(){return this._onDidTaskProcessEnded.event}async $onDidEndTaskProcess(e){const t=await this.getTaskExecution(e.id);this._onDidTaskProcessEnded.fire({execution:t,exitCode:e.exitCode})}$provideTasks(e,t){const i=this._handlers.get(e);if(!i)return Promise.reject(new Error("no handler found"));const n=[],s=Bt(()=>i.provider.provideTasks(bt.None)).then(o=>this.provideTasksInternal(t,n,i,o));return new Promise(o=>{s.then(a=>{Promise.all(n).then(()=>{o(a)})})})}async $resolveTask(e,t){const i=this._handlers.get(e);if(!i)return Promise.reject(new Error("no handler found"));if(t.definition.type!==i.type)throw new Error(`Unexpected: Task of type [${t.definition.type}] cannot be resolved by provider of type [${i.type}].`);const n=await Mr.to(t,this._workspaceProvider,this._providedCustomExecutions2);if(!n)throw new Error("Unexpected: Task cannot be resolved.");const s=await i.provider.resolveTask(n,bt.None);if(!s)return;this.checkDeprecation(s,i);const o=Mr.from(s,i.extension);if(!o)throw new Error("Unexpected: Task cannot be resolved.");if(s.definition!==n.definition)throw new Error("Unexpected: The resolved task definition must be the same object as the original task definition. The task definition cannot be changed.");return tr.is(o.execution)&&await this.addCustomExecution(o,s,!0),await this.resolveTaskInternal(o)}nextHandle(){return this._handleCounter++}async addCustomExecution(e,t,i){const n=await this._proxy.$createTaskId(e);!i&&!this._providedCustomExecutions2.has(n)&&(this._notProvidedCustomExecutions.add(n),this._activeCustomExecutions2.set(n,t.execution)),this._providedCustomExecutions2.set(n,t.execution)}async getTaskExecution(e,t){if(typeof e=="string"){const s=this._taskExecutionPromises.get(e);if(!s)throw new jr("Unexpected: The specified task is missing an execution");return s}const i=this._taskExecutionPromises.get(e.id);if(i)return i;let n;return t?n=Promise.resolve(new rm(this,e.id,t)):n=Mr.to(e.task,this._workspaceProvider,this._providedCustomExecutions2).then(s=>{if(!s)throw new jr("Unexpected: Task does not exist.");return new rm(this,e.id,s)}),this._taskExecutionPromises.set(e.id,n),n.then(s=>(this._taskExecutions.set(e.id,s),s))}checkDeprecation(e,t){e._deprecated&&this._deprecationService.report("Task.constructor",t.extension,"Use the Task constructor that takes a `scope` instead.")}customExecutionComplete(e){this._activeCustomExecutions2.get(e.id)&&this._activeCustomExecutions2.delete(e.id),this._notProvidedCustomExecutions.has(e.id)&&this._lastStartedTask!==e.id&&(this._providedCustomExecutions2.delete(e.id),this._notProvidedCustomExecutions.delete(e.id));const i=this._notProvidedCustomExecutions.values();let n=i.next();for(;!n.done;)!this._activeCustomExecutions2.has(n.value)&&this._lastStartedTask!==n.value&&(this._providedCustomExecutions2.delete(n.value),this._notProvidedCustomExecutions.delete(n.value)),n=i.next()}};u_=U([M(0,Ve),M(1,jt),M(2,cr),M(3,ud),M(4,lr),M(5,kc),M(6,Je),M(7,fg)],u_);let d_=class extends u_{constructor(e,t,i,n,s,o,a,c){super(e,t,i,n,s,o,a,c),this.registerTaskSystem(ne.vscodeRemote,{scheme:ne.vscodeRemote,authority:"",platform:N4(0)})}async executeTask(e,t){if(!t.execution)throw new Error("Tasks to execute must include an execution");const i=Mr.from(t,e);if(i===void 0)throw new Error("Task is not valid");if(tr.is(i.execution))await this.addCustomExecution(i,t,!1);else throw new bm;const n=await this.getTaskExecution(await this._proxy.$getTaskExecution(i),t);return this._proxy.$executeTask(i).catch(s=>{throw new Error(s)}),n}provideTasksInternal(e,t,i,n){const s=[];if(n)for(const o of n){if(this.checkDeprecation(o,i),!o.definition||!e[o.definition.type]){const c=o.source?o.source:"No task source";this._logService.warn(`The task [${c}, ${o.name}] uses an undefined task type. The task will be ignored in the future.`)}const a=Mr.from(o,i.extension);a&&tr.is(a.execution)?(s.push(a),t.push(this.addCustomExecution(a,o,!0))):this._logService.warn("Only custom execution tasks supported.")}return{tasks:s,extension:i.extension}}async resolveTaskInternal(e){if(tr.is(e.execution))return e;this._logService.warn("Only custom execution tasks supported.")}async $resolveVariables(e,t){return{process:void 0,variables:Object.create(null)}}async $jsonTasksSupported(){return!1}async $findExecutable(e,t,i){}};d_=U([M(0,Ve),M(1,jt),M(2,cr),M(3,ud),M(4,lr),M(5,kc),M(6,Je),M(7,fg)],d_);const _S=Ce("IExtHostTask"),dd=Ce("IExtHostEditorTabs");class u2{constructor(e,t,i){this._activeTabIdGetter=i,this._parentGroup=t,this.acceptDtoUpdate(e)}get apiObject(){if(!this._apiObject){const e=this,t={get isActive(){return e._dto.id===e._activeTabIdGetter()},get label(){return e._dto.label},get input(){return e._input},get isDirty(){return e._dto.isDirty},get isPinned(){return e._dto.isPinned},get isPreview(){return e._dto.isPreview},get group(){return e._parentGroup.apiObject}};this._apiObject=Object.freeze(t)}return this._apiObject}get tabId(){return this._dto.id}acceptDtoUpdate(e){this._dto=e,this._input=this._initInput()}_initInput(){switch(this._dto.input.kind){case 1:return new Bw(x.revive(this._dto.input.uri));case 2:return new bf(x.revive(this._dto.input.original),x.revive(this._dto.input.modified));case 3:return new $C(x.revive(this._dto.input.base),x.revive(this._dto.input.input1),x.revive(this._dto.input.input2),x.revive(this._dto.input.result));case 6:return new Vw(x.revive(this._dto.input.uri),this._dto.input.viewType);case 7:return new NC(this._dto.input.viewType);case 4:return new Ww(x.revive(this._dto.input.uri),this._dto.input.notebookType);case 5:return new zw(x.revive(this._dto.input.original),x.revive(this._dto.input.modified),this._dto.input.notebookType);case 8:return new MC;case 9:return new FC(x.revive(this._dto.input.uri),x.revive(this._dto.input.inputBoxUri));case 10:return new OC;case 11:return new HC(this._dto.input.diffEditors.map(e=>new bf(x.revive(e.original),x.revive(e.modified))));default:return}}}class V8{constructor(e,t){this._tabs=[],this._activeTabId="",this._dto=e,this._activeGroupIdGetter=t;for(const i of e.tabs)i.isActive&&(this._activeTabId=i.id),this._tabs.push(new u2(i,this,()=>this.activeTabId()))}get apiObject(){if(!this._apiObject){const e=this,t={get isActive(){return e._dto.groupId===e._activeGroupIdGetter()},get viewColumn(){return Et.to(e._dto.viewColumn)},get activeTab(){var i;return(i=e._tabs.find(n=>n.tabId===e._activeTabId))==null?void 0:i.apiObject},get tabs(){return Object.freeze(e._tabs.map(i=>i.apiObject))}};this._apiObject=Object.freeze(t)}return this._apiObject}get groupId(){return this._dto.groupId}get tabs(){return this._tabs}acceptGroupDtoUpdate(e){this._dto=e}acceptTabOperation(e){if(e.kind===0){const i=new u2(e.tabDto,this,()=>this.activeTabId());return this._tabs.splice(e.index,0,i),e.tabDto.isActive&&(this._activeTabId=i.tabId),i}else if(e.kind===1){const i=this._tabs.splice(e.index,1)[0];if(!i)throw new Error(`Tab close updated received for index ${e.index} which does not exist`);return i.tabId===this._activeTabId&&(this._activeTabId=""),i}else if(e.kind===3){if(e.oldIndex===void 0)throw new Error("Invalid old index on move IPC");const i=this._tabs.splice(e.oldIndex,1)[0];if(!i)throw new Error(`Tab move updated received for index ${e.oldIndex} which does not exist`);return this._tabs.splice(e.index,0,i),i}const t=this._tabs.find(i=>i.tabId===e.tabDto.id);if(!t)throw new Error("INVALID tab");return e.tabDto.isActive?this._activeTabId=e.tabDto.id:this._activeTabId===e.tabDto.id&&!e.tabDto.isActive&&(this._activeTabId=""),t.acceptDtoUpdate(e.tabDto),t}activeTabId(){return this._activeTabId}}let h_=class{constructor(e){this._onDidChangeTabs=new R,this._onDidChangeTabGroups=new R,this._extHostTabGroups=[],this._proxy=e.getProxy(J.MainThreadEditorTabs)}get tabGroups(){if(!this._apiObject){const e=this,t={onDidChangeTabGroups:e._onDidChangeTabGroups.event,onDidChangeTabs:e._onDidChangeTabs.event,get all(){return Object.freeze(e._extHostTabGroups.map(i=>i.apiObject))},get activeTabGroup(){var s;const i=e._activeGroupId;return Oa((s=e._extHostTabGroups.find(o=>o.groupId===i))==null?void 0:s.apiObject)},close:async(i,n)=>{const s=Array.isArray(i)?i:[i];return s.length?W8(s[0])?this._closeGroups(s,n):this._closeTabs(s,n):!0}};this._apiObject=Object.freeze(t)}return this._apiObject}$acceptEditorTabModel(e){var l;const t=new Set(this._extHostTabGroups.map(u=>u.groupId)),i=new Set(e.map(u=>u.groupId)),n=e4(t,i),s=this._extHostTabGroups.filter(u=>n.removed.includes(u.groupId)).map(u=>u.apiObject),o=[],a=[];this._extHostTabGroups=e.map(u=>{const d=new V8(u,()=>this._activeGroupId);return n.added.includes(d.groupId)?o.push(d.apiObject):a.push(d.apiObject),d});const c=Oa((l=e.find(u=>u.isActive===!0))==null?void 0:l.groupId);c!==void 0&&this._activeGroupId!==c&&(this._activeGroupId=c),this._onDidChangeTabGroups.fire(Object.freeze({opened:o,closed:s,changed:a}))}$acceptTabGroupUpdate(e){const t=this._extHostTabGroups.find(i=>i.groupId===e.groupId);if(!t)throw new Error("Update Group IPC call received before group creation.");t.acceptGroupDtoUpdate(e),e.isActive&&(this._activeGroupId=e.groupId),this._onDidChangeTabGroups.fire(Object.freeze({changed:[t.apiObject],opened:[],closed:[]}))}$acceptTabOperation(e){const t=this._extHostTabGroups.find(n=>n.groupId===e.groupId);if(!t)throw new Error("Update Tabs IPC call received before group creation.");const i=t.acceptTabOperation(e);switch(e.kind){case 0:this._onDidChangeTabs.fire(Object.freeze({opened:[i.apiObject],closed:[],changed:[]}));return;case 1:this._onDidChangeTabs.fire(Object.freeze({opened:[],closed:[i.apiObject],changed:[]}));return;case 3:case 2:this._onDidChangeTabs.fire(Object.freeze({opened:[],closed:[],changed:[i.apiObject]}));return}}_findExtHostTabFromApi(e){for(const t of this._extHostTabGroups)for(const i of t.tabs)if(i.apiObject===e)return i}_findExtHostTabGroupFromApi(e){return this._extHostTabGroups.find(t=>t.apiObject===e)}async _closeTabs(e,t){const i=[];for(const n of e){const s=this._findExtHostTabFromApi(n);if(!s)throw new Error("Tab close: Invalid tab not found!");i.push(s.tabId)}return this._proxy.$closeTab(i,t)}async _closeGroups(e,t){const i=[];for(const n of e){const s=this._findExtHostTabGroupFromApi(n);if(!s)throw new Error("Group close: Invalid group not found!");i.push(s.groupId)}return this._proxy.$closeGroup(i,t)}};h_=U([M(0,Ve)],h_);function W8(r){return r.tabs!==void 0}const z8="vs/workbench/contrib/debug/common/abstractDebugAdapter";class j8{constructor(){this.pendingRequests=new Map,this.queue=[],this._onError=new R,this._onExit=new R,this.sequence=1}get onError(){return this._onError.event}get onExit(){return this._onExit.event}onMessage(e){this.messageCallback&&this._onError.fire(new Error("attempt to set more than one 'Message' callback")),this.messageCallback=e}onEvent(e){this.eventCallback&&this._onError.fire(new Error("attempt to set more than one 'Event' callback")),this.eventCallback=e}onRequest(e){this.requestCallback&&this._onError.fire(new Error("attempt to set more than one 'Request' callback")),this.requestCallback=e}sendResponse(e){e.seq>0?this._onError.fire(new Error(`attempt to send more than one response for command ${e.command}`)):this.internalSend("response",e)}sendRequest(e,t,i,n){const s={command:e};if(t&&Object.keys(t).length>0&&(s.arguments=t),this.internalSend("request",s),typeof n=="number"){const o=setTimeout(()=>{clearTimeout(o);const a=this.pendingRequests.get(s.seq);if(a){this.pendingRequests.delete(s.seq);const c={type:"response",seq:0,request_seq:s.seq,success:!1,command:e,message:h(z8,0,"Timeout after {0} ms for '{1}'",n,e)};a(c)}},n)}return i&&this.pendingRequests.set(s.seq,i),s.seq}acceptMessage(e){this.messageCallback?this.messageCallback(e):(this.queue.push(e),this.queue.length===1&&this.processQueue())}needsTaskBoundaryBetween(e,t){return e.type!=="event"||t.type!=="event"}async processQueue(){var t,i;let e;for(;this.queue.length;){if((!e||this.needsTaskBoundaryBetween(this.queue[0],e))&&await Yn(0),e=this.queue.shift(),!e)return;switch(e.type){case"event":(t=this.eventCallback)==null||t.call(this,e);break;case"request":(i=this.requestCallback)==null||i.call(this,e);break;case"response":{const n=e,s=this.pendingRequests.get(n.request_seq);s&&(this.pendingRequests.delete(n.request_seq),s(n));break}}}}internalSend(e,t){t.type=e,t.seq=this.sequence++,this.sendMessage(t)}async cancelPendingRequests(){if(this.pendingRequests.size===0)return Promise.resolve();const e=new Map;this.pendingRequests.forEach((t,i)=>e.set(i,t)),await Yn(500),e.forEach((t,i)=>{t({type:"response",seq:0,request_seq:i,success:!1,command:"canceled",message:"canceled"}),this.pendingRequests.delete(i)})}getPendingRequestIds(){return Array.from(this.pendingRequests.keys())}dispose(){this.queue=[]}}function q8(r){return r.type&&(r.label||r.program||r.runtime)}const G8=/^[a-zA-Z][a-zA-Z0-9\+\-\.]+:/;function Q8(r){return!!(r&&r.match(G8))}function J8(r){if(typeof r.path=="string"&&!(typeof r.sourceReference=="number"&&r.sourceReference>0)){if(Q8(r.path))return x.parse(r.path);if(Pm(r.path))return x.file(r.path)}return r.path}function K8(r){if(typeof r.path=="object"){const e=x.revive(r.path);if(e)return e.scheme===ne.file?e.fsPath:e.toString()}return r.path}function X8(r,e){const t=K8,i=ot(r);return wS(i,(n,s)=>{n&&s&&(s.path=t(s))}),i}function Z8(r,e){const t=J8,i=ot(r);return wS(i,(n,s)=>{!n&&s&&(s.path=t(s))}),i}function wS(r,e){var t;switch(r.type){case"event":{const i=r;switch(i.event){case"output":e(!1,i.body.source);break;case"loadedSource":e(!1,i.body.source);break;case"breakpoint":e(!1,i.body.breakpoint.source);break}break}case"request":{const i=r;switch(i.command){case"setBreakpoints":e(!0,i.arguments.source);break;case"breakpointLocations":e(!0,i.arguments.source);break;case"source":e(!0,i.arguments.source);break;case"gotoTargets":e(!0,i.arguments.source);break;case"launchVSCode":i.arguments.args.forEach(n=>e(!1,n));break}break}case"response":{const i=r;if(i.success&&i.body)switch(i.command){case"stackTrace":i.body.stackFrames.forEach(n=>e(!1,n.source));break;case"loadedSources":i.body.sources.forEach(n=>e(!1,n));break;case"scopes":i.body.scopes.forEach(n=>e(!1,n.source));break;case"setFunctionBreakpoints":i.body.breakpoints.forEach(n=>e(!1,n.source));break;case"setBreakpoints":i.body.breakpoints.forEach(n=>e(!1,n.source));break;case"disassemble":(t=i.body)==null||t.instructions.forEach(s=>e(!1,s.location));break}break}}}var et;(function(r){r.Unknown="unknown",r.Env="env",r.Config="config",r.Command="command",r.Input="input",r.ExtensionInstallFolder="extensionInstallFolder",r.WorkspaceFolder="workspaceFolder",r.Cwd="cwd",r.WorkspaceFolderBasename="workspaceFolderBasename",r.UserHome="userHome",r.LineNumber="lineNumber",r.SelectedText="selectedText",r.File="file",r.FileWorkspaceFolder="fileWorkspaceFolder",r.FileWorkspaceFolderBasename="fileWorkspaceFolderBasename",r.RelativeFile="relativeFile",r.RelativeFileDirname="relativeFileDirname",r.FileDirname="fileDirname",r.FileExtname="fileExtname",r.FileBasename="fileBasename",r.FileBasenameNoExtension="fileBasenameNoExtension",r.FileDirnameBasename="fileDirnameBasename",r.ExecPath="execPath",r.ExecInstallFolder="execInstallFolder",r.PathSeparator="pathSeparator",r.PathSeparatorAlias="/"})(et||(et={}));class ei extends Error{constructor(e,t){super(t),this.variable=e}}const ti="vs/workbench/services/configurationResolver/common/variableResolver",ys=class ys{constructor(e,t,i,n){this._contributedVariables=new Map,this._context=e,this._labelService=t,this._userHomePromise=i,n&&(this._envVariablesPromise=n.then(s=>this.prepareEnv(s)))}prepareEnv(e){if(Ii){const t=Object.create(null);return Object.keys(e).forEach(i=>{t[i.toLowerCase()]=e[i]}),t}return e}resolveWithEnvironment(e,t,i){return this.recursiveResolve({env:this.prepareEnv(e),userHome:void 0},t?t.uri:void 0,i)}async resolveAsync(e,t){const i={env:await this._envVariablesPromise,userHome:await this._userHomePromise};return this.recursiveResolve(i,e?e.uri:void 0,t)}async resolveAnyBase(e,t,i,n){const s=ot(t);Ii&&s.windows?Object.keys(s.windows).forEach(a=>s[a]=s.windows[a]):rn&&s.osx?Object.keys(s.osx).forEach(a=>s[a]=s.osx[a]):Qr&&s.linux&&Object.keys(s.linux).forEach(a=>s[a]=s.linux[a]),delete s.windows,delete s.osx,delete s.linux;const o={env:await this._envVariablesPromise,userHome:await this._userHomePromise};return this.recursiveResolve(o,e?e.uri:void 0,s,i,n)}async resolveAnyAsync(e,t,i){return this.resolveAnyBase(e,t,i)}async resolveAnyMap(e,t,i){const n=new Map;return{newConfig:await this.resolveAnyBase(e,t,i,n),resolvedVariables:n}}resolveWithInteractionReplace(e,t,i,n){throw new Error("resolveWithInteractionReplace not implemented.")}resolveWithInteraction(e,t,i,n){throw new Error("resolveWithInteraction not implemented.")}contributeVariable(e,t){if(this._contributedVariables.has(e))throw new Error("Variable "+e+" is contributed twice.");this._contributedVariables.set(e,t)}async recursiveResolve(e,t,i,n,s){if($e(i))return this.resolveString(e,t,i,n,s);if(Array.isArray(i))return Promise.all(i.map(o=>this.recursiveResolve(e,t,o,n,s)));if(Vt(i)){const o=Object.create(null),a=await Promise.all(Object.keys(i).map(async c=>[await this.resolveString(e,t,c,n,s),await this.recursiveResolve(e,t,i[c],n,s)]));for(const[c,l]of a)o[c]=l;return o}return i}resolveString(e,t,i,n,s){return hE(i,ys.VARIABLE_REGEXP,async(o,a)=>{if(a.includes(ys.VARIABLE_LHS))return o;let c=await this.evaluateSingleVariable(e,o,a,t,n);return s==null||s.set(a,c),c!==o&&$e(c)&&c.match(ys.VARIABLE_REGEXP)&&(c=await this.resolveString(e,t,c,n,s)),c})}fsPath(e){return this._labelService?this._labelService.getUriLabel(e,{noPrefix:!0}):e.fsPath}async evaluateSingleVariable(e,t,i,n,s){let o;const a=i.split(":");a.length>1&&(i=a[0],o=a[1]);const c=d=>{const f=this._context.getFilePath();if(f)return Hc(f);throw new ei(d,h(ti,0,"Variable {0} can not be resolved. Please open an editor.",t))},l=d=>{const f=c(d);if(this._context.getWorkspaceFolderPathForFile){const m=this._context.getWorkspaceFolderPathForFile();if(m)return Hc(m)}throw new ei(d,h(ti,1,"Variable {0}: can not find workspace folder of '{1}'.",t,gi(f)))},u=d=>{if(o){const f=this._context.getFolderUri(o);if(f)return f;throw new ei(d,h(ti,2,"Variable {0} can not be resolved. No such folder '{1}'.",t,o))}if(n)return n;throw this._context.getWorkspaceFolderCount()>1?new ei(d,h(ti,3,"Variable {0} can not be resolved in a multi folder workspace. Scope this variable using ':' and a workspace folder name.",t)):new ei(d,h(ti,4,"Variable {0} can not be resolved. Please open a folder.",t))};switch(i){case"env":if(o){if(e.env){const d=e.env[Ii?o.toLowerCase():o];if($e(d))return d}return""}throw new ei(et.Env,h(ti,5,"Variable {0} can not be resolved because no environment variable name is given.",t));case"config":if(o){const d=this._context.getConfigurationValue(n,o);if(Qt(d))throw new ei(et.Config,h(ti,6,"Variable {0} can not be resolved because setting '{1}' not found.",t,o));if(Vt(d))throw new ei(et.Config,h(ti,7,"Variable {0} can not be resolved because '{1}' is a structured value.",t,o));return d}throw new ei(et.Config,h(ti,8,"Variable {0} can not be resolved because no settings name is given.",t));case"command":return this.resolveFromMap(et.Command,t,o,s,"command");case"input":return this.resolveFromMap(et.Input,t,o,s,"input");case"extensionInstallFolder":if(o){const d=await this._context.getExtension(o);if(!d)throw new ei(et.ExtensionInstallFolder,h(ti,9,"Variable {0} can not be resolved because the extension {1} is not installed.",t,o));return this.fsPath(d.extensionLocation)}throw new ei(et.ExtensionInstallFolder,h(ti,10,"Variable {0} can not be resolved because no extension name is given.",t));default:switch(i){case"workspaceRoot":case"workspaceFolder":return Hc(this.fsPath(u(et.WorkspaceFolder)));case"cwd":return n||o?Hc(this.fsPath(u(et.Cwd))):Na();case"workspaceRootFolderName":case"workspaceFolderBasename":return Hc(gi(this.fsPath(u(et.WorkspaceFolderBasename))));case"userHome":{if(e.userHome)return e.userHome;throw new ei(et.UserHome,h(ti,11,"Variable {0} can not be resolved. UserHome path is not defined",t))}case"lineNumber":{const d=this._context.getLineNumber();if(d)return d;throw new ei(et.LineNumber,h(ti,12,"Variable {0} can not be resolved. Make sure to have a line selected in the active editor.",t))}case"selectedText":{const d=this._context.getSelectedText();if(d)return d;throw new ei(et.SelectedText,h(ti,13,"Variable {0} can not be resolved. Make sure to have some text selected in the active editor.",t))}case"file":return c(et.File);case"fileWorkspaceFolder":return l(et.FileWorkspaceFolder);case"fileWorkspaceFolderBasename":return gi(l(et.FileWorkspaceFolderBasename));case"relativeFile":return n||o?Rl(this.fsPath(u(et.RelativeFile)),c(et.RelativeFile)):c(et.RelativeFile);case"relativeFileDirname":{const d=Ys(c(et.RelativeFileDirname));if(n||o){const f=Rl(this.fsPath(u(et.RelativeFileDirname)),d);return f.length===0?".":f}return d}case"fileDirname":return Ys(c(et.FileDirname));case"fileExtname":return Tm(c(et.FileExtname));case"fileBasename":return gi(c(et.FileBasename));case"fileBasenameNoExtension":{const d=gi(c(et.FileBasenameNoExtension));return d.slice(0,d.length-Tm(d).length)}case"fileDirnameBasename":return gi(Ys(c(et.FileDirnameBasename)));case"execPath":{const d=this._context.getExecPath();return d||t}case"execInstallFolder":{const d=this._context.getAppRoot();return d||t}case"pathSeparator":case"/":return en;default:try{const d=o?`${i}:${o}`:i;return this.resolveFromMap(et.Unknown,t,d,s,void 0)}catch{return t}}}}resolveFromMap(e,t,i,n,s){if(i&&n){const o=s===void 0?n[i]:n[s+":"+i];if(typeof o=="string")return o;throw new ei(e,h(ti,14,"Variable {0} can not be resolved because the command has no value.",t))}return t}};ys.VARIABLE_LHS="${",ys.VARIABLE_REGEXP=/\$\{(.*?)\}/g;let f_=ys;const a0=Ce("IExtHostVariableResolverProvider");class Y8 extends f_{constructor(e,t,i,n,s,o,a){function c(){var l;if(i){const u=i.activeEditor();if(u)return u.document.uri;const d=(l=n.tabGroups.all.find(f=>f.isActive))==null?void 0:l.activeTab;if(d!==void 0){if(d.input instanceof bf||d.input instanceof zw)return d.input.modified;if(d.input instanceof Bw||d.input instanceof Ww||d.input instanceof Vw)return d.input.uri}}}super({getFolderUri:l=>{const u=o.folders.filter(d=>d.name===l);if(u&&u.length>0)return u[0].uri},getWorkspaceFolderCount:()=>o.folders.length,getConfigurationValue:(l,u)=>s.getConfiguration(void 0,l).get(u),getAppRoot:()=>Na(),getExecPath:()=>Dm.VSCODE_EXEC_PATH,getFilePath:()=>{const l=c();if(l)return Ma(l.fsPath)},getWorkspaceFolderPathForFile:()=>{if(t){const l=c();if(l){const u=t.getWorkspaceFolder(l);if(u)return Ma(u.uri.fsPath)}}},getSelectedText:()=>{if(i){const l=i.activeEditor();if(l&&!l.selection.isEmpty)return l.document.getText(l.selection)}},getLineNumber:()=>{if(i){const l=i.activeEditor();if(l)return String(l.selection.end.line+1)}},getExtension:l=>e.getExtension(l)},void 0,a?Promise.resolve(a):void 0,Promise.resolve(Dm))}}let p_=class extends Fe{constructor(e,t,i,n,s){super(),this.extensionService=e,this.workspaceService=t,this.editorService=i,this.configurationService=n,this.editorTabs=s,this._resolver=new Xn(async()=>{const o=await this.configurationService.getConfigProvider(),c={folders:await this.workspaceService.getWorkspaceFolders2()||[]};return this._register(this.workspaceService.onDidChangeWorkspace(async l=>{c.folders=await this.workspaceService.getWorkspaceFolders2()||[]})),new Y8(this.extensionService,this.workspaceService,this.editorService,this.editorTabs,o,c,this.homeDir())})}getResolver(){return this._resolver.value}homeDir(){}};p_=U([M(0,ns),M(1,cr),M(2,ud),M(3,lr),M(4,dd)],p_);const bS=Ce("IExtHostDebugService");let g_=class{get onDidStartDebugSession(){return this._onDidStartDebugSession.event}get onDidTerminateDebugSession(){return this._onDidTerminateDebugSession.event}get onDidChangeActiveDebugSession(){return this._onDidChangeActiveDebugSession.event}get activeDebugSession(){var e;return(e=this._activeDebugSession)==null?void 0:e.api}get onDidReceiveDebugSessionCustomEvent(){return this._onDidReceiveDebugSessionCustomEvent.event}get activeDebugConsole(){return this._activeDebugConsole.value}constructor(e,t,i,n,s,o,a){this._workspaceService=t,this._extensionService=i,this._configurationService=n,this._editorTabs=s,this._variableResolver=o,this._commands=a,this._debugSessions=new Map,this._debugVisualizationTreeItemIdsCounter=0,this._debugVisualizationProviders=new Map,this._debugVisualizationTrees=new Map,this._debugVisualizationTreeItemIds=new WeakMap,this._debugVisualizationElements=new Map,this._visualizers=new Map,this._visualizerIdCounter=0,this._configProviderHandleCounter=0,this._configProviders=[],this._adapterFactoryHandleCounter=0,this._adapterFactories=[],this._trackerFactoryHandleCounter=0,this._trackerFactories=[],this._debugAdapters=new Map,this._debugAdaptersTrackers=new Map,this._onDidStartDebugSession=new R,this._onDidTerminateDebugSession=new R,this._onDidChangeActiveDebugSession=new R,this._onDidReceiveDebugSessionCustomEvent=new R,this._debugServiceProxy=e.getProxy(J.MainThreadDebugService),this._onDidChangeBreakpoints=new R,this._onDidChangeActiveStackItem=new R,this._activeDebugConsole=new t9(this._debugServiceProxy),this._breakpoints=new Map,this._extensionService.getExtensionRegistry().then(c=>{c.onDidChange(l=>{this.registerAllDebugTypes(c)}),this.registerAllDebugTypes(c)})}async $getVisualizerTreeItem(e,t){var s,o;const i=this.hydrateVisualizationContext(t);if(!i)return;const n=await((o=(s=this._debugVisualizationTrees.get(e))==null?void 0:s.getTreeItem)==null?void 0:o.call(s,i));return n?this.convertVisualizerTreeItem(e,n):void 0}registerDebugVisualizationTree(e,t,i){const n=Xe.toKey(e.identifier),s=this.extensionVisKey(n,t);if(this._debugVisualizationProviders.has(s))throw new Error(`A debug visualization provider with id '${t}' is already registered`);return this._debugVisualizationTrees.set(s,i),this._debugServiceProxy.$registerDebugVisualizerTree(s,!!i.editItem),De(()=>{this._debugServiceProxy.$unregisterDebugVisualizerTree(s),this._debugVisualizationTrees.delete(t)})}async $getVisualizerTreeItemChildren(e,t){var s,o,a;const i=(s=this._debugVisualizationElements.get(t))==null?void 0:s.item;if(!i)return[];const n=await((a=(o=this._debugVisualizationTrees.get(e))==null?void 0:o.getChildren)==null?void 0:a.call(o,i));return(n==null?void 0:n.map(c=>this.convertVisualizerTreeItem(e,c)))||[]}async $editVisualizerTreeItem(e,t){var s,o;const i=this._debugVisualizationElements.get(e);if(!i)return;const n=await((o=(s=this._debugVisualizationTrees.get(i.provider))==null?void 0:s.editItem)==null?void 0:o.call(s,i.item,t));return this.convertVisualizerTreeItem(i.provider,n||i.item)}$disposeVisualizedTree(e){var n;const t=this._debugVisualizationElements.get(e);if(!t)return;const i=[t.children];for(const s of i)if(s)for(const o of s)i.push((n=this._debugVisualizationElements.get(o))==null?void 0:n.children),this._debugVisualizationElements.delete(o)}convertVisualizerTreeItem(e,t){let i=this._debugVisualizationTreeItemIds.get(t);return i||(i=this._debugVisualizationTreeItemIdsCounter++,this._debugVisualizationTreeItemIds.set(t,i),this._debugVisualizationElements.set(i,{provider:e,item:t})),Cv.from(t,i)}asDebugSourceUri(e,t){const i=e;if(typeof i.sourceReference=="number"&&i.sourceReference>0){let n=`debug:${encodeURIComponent(i.path||"")}`,s="?";return t&&(n+=`${s}session=${encodeURIComponent(t.id)}`,s="&"),n+=`${s}ref=${i.sourceReference}`,x.parse(n)}else{if(i.path)return x.file(i.path);throw new Error("cannot create uri from DAP 'source' object; properties 'path' and 'sourceReference' are both missing.")}}registerAllDebugTypes(e){const t=[];for(const i of e.getAllExtensionDescriptions())if(i.contributes){const n=i.contributes.debuggers;if(n&&n.length>0)for(const s of n)q8(s)&&t.push(s.type)}this._debugServiceProxy.$registerDebugTypes(t)}get activeStackItem(){return this._activeStackItem}get onDidChangeActiveStackItem(){return this._onDidChangeActiveStackItem.event}get onDidChangeBreakpoints(){return this._onDidChangeBreakpoints.event}get breakpoints(){const e=[];return this._breakpoints.forEach(t=>e.push(t)),e}async $resolveDebugVisualizer(e,t){var a;const i=this._visualizers.get(e);if(!i)throw new Error(`No debug visualizer found with id '${e}'`);let{v:n,provider:s,extensionId:o}=i;if(n.visualization||(n=await((a=s.resolveDebugVisualization)==null?void 0:a.call(s,n,t))||n,i.v=n),!n.visualization)throw new Error(`No visualization returned from resolveDebugVisualization in '${s}'`);return this.serializeVisualization(o,n.visualization)}async $executeDebugVisualizerCommand(e){const t=this._visualizers.get(e);if(!t)throw new Error(`No debug visualizer found with id '${e}'`);const i=t.v.visualization;i&&"command"in i&&this._commands.executeCommand(i.command,...i.arguments||[])}hydrateVisualizationContext(e){const t=this._debugSessions.get(e.sessionId);return t&&{session:t.api,variable:e.variable,containerId:e.containerId,frameId:e.frameId,threadId:e.threadId}}async $provideDebugVisualizers(e,t,i,n){const s=this.hydrateVisualizationContext(i),o=this.extensionVisKey(e,t),a=this._debugVisualizationProviders.get(o);if(!s||!a)return[];const c=await a.provideDebugVisualization(s,n);return c?c.map(l=>{const u=++this._visualizerIdCounter;this._visualizers.set(u,{v:l,provider:a,extensionId:e});const d=l.iconPath?this.getIconPathOrClass(l.iconPath):void 0;return{id:u,name:l.name,iconClass:d==null?void 0:d.iconClass,iconPath:d==null?void 0:d.iconPath,visualization:this.serializeVisualization(e,l.visualization)}}):[]}$disposeDebugVisualizers(e){for(const t of e)this._visualizers.delete(t)}registerDebugVisualizationProvider(e,t,i){var o,a;if(!((a=(o=e.contributes)==null?void 0:o.debugVisualizers)!=null&&a.some(c=>c.id===t)))throw new Error(`Extensions may only call registerDebugVisualizationProvider() for renderers they contribute (got ${t})`);const n=Xe.toKey(e.identifier),s=this.extensionVisKey(n,t);if(this._debugVisualizationProviders.has(s))throw new Error(`A debug visualization provider with id '${t}' is already registered`);return this._debugVisualizationProviders.set(s,i),this._debugServiceProxy.$registerDebugVisualizer(n,t),De(()=>{this._debugServiceProxy.$unregisterDebugVisualizer(n,t),this._debugVisualizationProviders.delete(t)})}addBreakpoints(e){const t=e.filter(s=>{const o=s.id;return this._breakpoints.has(o)?!1:(this._breakpoints.set(o,s),!0)});this.fireBreakpointChanges(t,[],[]);const i=[],n=new Map;for(const s of t)if(s instanceof Ts){let o=n.get(s.location.uri.toString());o||(o={type:"sourceMulti",uri:s.location.uri,lines:[]},n.set(s.location.uri.toString(),o),i.push(o)),o.lines.push({id:s.id,enabled:s.enabled,condition:s.condition,hitCondition:s.hitCondition,logMessage:s.logMessage,line:s.location.range.start.line,character:s.location.range.start.character,mode:s.mode})}else s instanceof As&&i.push({type:"function",id:s.id,enabled:s.enabled,hitCondition:s.hitCondition,logMessage:s.logMessage,condition:s.condition,functionName:s.functionName,mode:s.mode});return this._debugServiceProxy.$registerBreakpoints(i)}removeBreakpoints(e){const t=e.filter(o=>this._breakpoints.delete(o.id));this.fireBreakpointChanges([],t,[]);const i=t.filter(o=>o instanceof Ts).map(o=>o.id),n=t.filter(o=>o instanceof As).map(o=>o.id),s=t.filter(o=>o instanceof rf).map(o=>o.id);return this._debugServiceProxy.$unregisterBreakpoints(i,n,s)}startDebugging(e,t,i){var n,s,o;return this._debugServiceProxy.$startDebugging(e?e.uri:void 0,t,{parentSessionID:i.parentSession?i.parentSession.id:void 0,lifecycleManagedByParent:i.lifecycleManagedByParent,repl:i.consoleMode===hf.MergeWithParent?"mergeWithParent":"separate",noDebug:i.noDebug,compact:i.compact,suppressSaveBeforeStart:i.suppressSaveBeforeStart,suppressDebugStatusbar:i.suppressDebugStatusbar??((n=i.debugUI)==null?void 0:n.simple),suppressDebugToolbar:i.suppressDebugToolbar??((s=i.debugUI)==null?void 0:s.simple),suppressDebugView:i.suppressDebugView??((o=i.debugUI)==null?void 0:o.simple)})}stopDebugging(e){return this._debugServiceProxy.$stopDebugging(e?e.id:void 0)}registerDebugConfigurationProvider(e,t,i){if(!t)return new Ne(()=>{});const n=this._configProviderHandleCounter++;return this._configProviders.push({type:e,handle:n,provider:t}),this._debugServiceProxy.$registerDebugConfigurationProvider(e,i,!!t.provideDebugConfigurations,!!t.resolveDebugConfiguration,!!t.resolveDebugConfigurationWithSubstitutedVariables,n),new Ne(()=>{this._configProviders=this._configProviders.filter(s=>s.provider!==t),this._debugServiceProxy.$unregisterDebugConfigurationProvider(n)})}registerDebugAdapterDescriptorFactory(e,t,i){if(!i)return new Ne(()=>{});if(!this.definesDebugType(e,t))throw new Error(`a DebugAdapterDescriptorFactory can only be registered from the extension that defines the '${t}' debugger.`);if(this.getAdapterDescriptorFactoryByType(t))throw new Error("a DebugAdapterDescriptorFactory can only be registered once per a type.");const n=this._adapterFactoryHandleCounter++;return this._adapterFactories.push({type:t,handle:n,factory:i}),this._debugServiceProxy.$registerDebugAdapterDescriptorFactory(t,n),new Ne(()=>{this._adapterFactories=this._adapterFactories.filter(s=>s.factory!==i),this._debugServiceProxy.$unregisterDebugAdapterDescriptorFactory(n)})}registerDebugAdapterTrackerFactory(e,t){if(!t)return new Ne(()=>{});const i=this._trackerFactoryHandleCounter++;return this._trackerFactories.push({type:e,handle:i,factory:t}),new Ne(()=>{this._trackerFactories=this._trackerFactories.filter(n=>n.factory!==t)})}async $runInTerminal(e,t){return Promise.resolve(void 0)}async $substituteVariables(e,t){let i;const n=await this.getFolder(e);return n&&(i={uri:n.uri,name:n.name,index:n.index,toResource:()=>{throw new Error("Not implemented")}}),(await this._variableResolver.getResolver()).resolveAnyAsync(i,t)}createDebugAdapter(e,t){if(e.type==="implementation")return new n9(e.implementation)}createSignService(){}async $startDASession(e,t){const i=this,n=await this.getSession(t);return this.getAdapterDescriptor(this.getAdapterDescriptorFactoryByType(n.type),n).then(s=>{if(!s)throw new Error(`Couldn't find a debug adapter descriptor for debug type '${n.type}' (extension might have failed to activate)`);const o=this.convertToDto(s),a=this.createDebugAdapter(o,n);if(!a)throw new Error(`Couldn't create a debug adapter for type '${n.type}'.`);const c=a;return this._debugAdapters.set(e,c),this.getDebugAdapterTrackers(n).then(l=>(l&&this._debugAdaptersTrackers.set(e,l),c.onMessage(async u=>{if(u.type==="request"&&u.command==="handshake"){const d=u,f={type:"response",seq:0,command:d.command,request_seq:d.seq,success:!0};this._signService||(this._signService=this.createSignService());try{if(this._signService){const m=await this._signService.sign(d.arguments.value);f.body={signature:m},c.sendResponse(f)}else throw new Error("no signer")}catch(m){f.success=!1,f.message=m.message,c.sendResponse(f)}}else l&&l.onDidSendMessage&&l.onDidSendMessage(u),u=Z8(u),i._debugServiceProxy.$acceptDAMessage(e,u)}),c.onError(u=>{l&&l.onError&&l.onError(u),this._debugServiceProxy.$acceptDAError(e,u.name,u.message,u.stack)}),c.onExit(u=>{l&&l.onExit&&l.onExit(u??void 0,void 0),this._debugServiceProxy.$acceptDAExit(e,u??void 0,void 0)}),l&&l.onWillStartSession&&l.onWillStartSession(),c.startSession()))})}$sendDAMessage(e,t){t=X8(t);const i=this._debugAdaptersTrackers.get(e);i&&i.onWillReceiveMessage&&i.onWillReceiveMessage(t);const n=this._debugAdapters.get(e);n==null||n.sendMessage(t)}$stopDASession(e){const t=this._debugAdaptersTrackers.get(e);this._debugAdaptersTrackers.delete(e),t&&t.onWillStopSession&&t.onWillStopSession();const i=this._debugAdapters.get(e);return this._debugAdapters.delete(e),i?i.stopSession():Promise.resolve(void 0)}$acceptBreakpointsDelta(e){const t=[],i=[],n=[];if(e.added)for(const s of e.added){const o=s.id;if(o&&!this._breakpoints.has(o)){let a;if(s.type==="function")a=new As(s.functionName,s.enabled,s.condition,s.hitCondition,s.logMessage,s.mode);else if(s.type==="data")a=new rf(s.label,s.dataId,s.canPersist,s.enabled,s.hitCondition,s.condition,s.logMessage,s.mode);else{const c=x.revive(s.uri);a=new Ts(new Pi(c,new ke(s.line,s.character)),s.enabled,s.condition,s.hitCondition,s.logMessage,s.mode)}II(a,o),this._breakpoints.set(o,a),t.push(a)}}if(e.removed)for(const s of e.removed){const o=this._breakpoints.get(s);o&&(this._breakpoints.delete(s),i.push(o))}if(e.changed){for(const s of e.changed)if(s.id){const o=this._breakpoints.get(s.id);if(o){if(o instanceof As&&s.type==="function"){const a=o;a.enabled=s.enabled,a.condition=s.condition,a.hitCondition=s.hitCondition,a.logMessage=s.logMessage,a.functionName=s.functionName}else if(o instanceof Ts&&s.type==="source"){const a=o;a.enabled=s.enabled,a.condition=s.condition,a.hitCondition=s.hitCondition,a.logMessage=s.logMessage,a.location=new Pi(x.revive(s.uri),new ke(s.line,s.character))}n.push(o)}}}this.fireBreakpointChanges(t,i,n)}async $acceptStackFrameFocus(e){let t;if(e){const i=await this.getSession(e.sessionId);e.kind==="thread"?t=new PC(i.api,e.threadId):t=new IC(i.api,e.threadId,e.frameId)}this._activeStackItem=t,this._onDidChangeActiveStackItem.fire(this._activeStackItem)}$provideDebugConfigurations(e,t,i){return Bt(async()=>{const n=this.getConfigProviderByHandle(e);if(!n)throw new Error("no DebugConfigurationProvider found");if(!n.provideDebugConfigurations)throw new Error("DebugConfigurationProvider has no method provideDebugConfigurations");const s=await this.getFolder(t);return n.provideDebugConfigurations(s,i)}).then(n=>{if(!n)throw new Error("nothing returned from DebugConfigurationProvider.provideDebugConfigurations");return n})}$resolveDebugConfiguration(e,t,i,n){return Bt(async()=>{const s=this.getConfigProviderByHandle(e);if(!s)throw new Error("no DebugConfigurationProvider found");if(!s.resolveDebugConfiguration)throw new Error("DebugConfigurationProvider has no method resolveDebugConfiguration");const o=await this.getFolder(t);return s.resolveDebugConfiguration(o,i,n)})}$resolveDebugConfigurationWithSubstitutedVariables(e,t,i,n){return Bt(async()=>{const s=this.getConfigProviderByHandle(e);if(!s)throw new Error("no DebugConfigurationProvider found");if(!s.resolveDebugConfigurationWithSubstitutedVariables)throw new Error("DebugConfigurationProvider has no method resolveDebugConfigurationWithSubstitutedVariables");const o=await this.getFolder(t);return s.resolveDebugConfigurationWithSubstitutedVariables(o,i,n)})}async $provideDebugAdapter(e,t){const i=this.getAdapterDescriptorFactoryByHandle(e);if(!i)return Promise.reject(new Error("no adapter descriptor factory found for handle"));const n=await this.getSession(t);return this.getAdapterDescriptor(i,n).then(s=>{if(!s)throw new Error(`Couldn't find a debug adapter descriptor for debug type '${n.type}'`);return this.convertToDto(s)})}async $acceptDebugSessionStarted(e){const t=await this.getSession(e);this._onDidStartDebugSession.fire(t.api)}async $acceptDebugSessionTerminated(e){const t=await this.getSession(e);t&&(this._onDidTerminateDebugSession.fire(t.api),this._debugSessions.delete(t.id))}async $acceptDebugSessionActiveChanged(e){var t;this._activeDebugSession=e?await this.getSession(e):void 0,this._onDidChangeActiveDebugSession.fire((t=this._activeDebugSession)==null?void 0:t.api)}async $acceptDebugSessionNameChanged(e,t){const i=await this.getSession(e);i==null||i._acceptNameChanged(t)}async $acceptDebugSessionCustomEvent(e,t){const n={session:(await this.getSession(e)).api,event:t.event,body:t.body};this._onDidReceiveDebugSessionCustomEvent.fire(n)}convertToDto(e){if(e instanceof sf)return{type:"executable",command:e.command,args:e.args,options:e.options};if(e instanceof Yl)return{type:"server",port:e.port,host:e.host};if(e instanceof of)return{type:"pipeServer",path:e.path};if(e instanceof af)return{type:"implementation",implementation:e.implementation};throw new Error("convertToDto unexpected type")}getAdapterDescriptorFactoryByType(e){const t=this._adapterFactories.filter(i=>i.type===e);if(t.length>0)return t[0].factory}getAdapterDescriptorFactoryByHandle(e){const t=this._adapterFactories.filter(i=>i.handle===e);if(t.length>0)return t[0].factory}getConfigProviderByHandle(e){const t=this._configProviders.filter(i=>i.handle===e);if(t.length>0)return t[0].provider}definesDebugType(e,t){if(e.contributes){const i=e.contributes.debuggers;if(i&&i.length>0){for(const n of i)if(n.label&&n.type&&n.type===t)return!0}}return!1}getDebugAdapterTrackers(e){const i=e.configuration.type,n=this._trackerFactories.filter(s=>s.type===i||s.type==="*").map(s=>Bt(()=>s.factory.createDebugAdapterTracker(e.api)).then(o=>o,o=>null));return Promise.race([Promise.all(n).then(s=>{const o=s.filter(a=>!!a);if(o.length>0)return new i9(o)}),new Promise(s=>setTimeout(()=>s(void 0),1e3))]).catch(s=>{})}async getAdapterDescriptor(e,t){const i=t.configuration.debugServer;if(typeof i=="number")return Promise.resolve(new Yl(i));if(e){const s=await this._extensionService.getExtensionRegistry();return Bt(()=>e.createDebugAdapterDescriptor(t.api,this.daExecutableFromPackage(t,s))).then(o=>{if(o)return o})}const n=await this._extensionService.getExtensionRegistry();return Promise.resolve(this.daExecutableFromPackage(t,n))}daExecutableFromPackage(e,t){}fireBreakpointChanges(e,t,i){(e.length>0||t.length>0||i.length>0)&&this._onDidChangeBreakpoints.fire(Object.freeze({added:e,removed:t,changed:i}))}async getSession(e){if(e)if(typeof e=="string"){const t=this._debugSessions.get(e);if(t)return t}else{let t=this._debugSessions.get(e.id);if(!t){const i=await this.getFolder(e.folderUri),n=e.parent?this._debugSessions.get(e.parent):void 0;t=new e9(this._debugServiceProxy,e.id,e.type,e.name,i,e.configuration,n==null?void 0:n.api),this._debugSessions.set(t.id,t),this._debugServiceProxy.$sessionCached(t.id)}return t}throw new Error("cannot find session")}getFolder(e){if(e){const t=x.revive(e);return this._workspaceService.resolveWorkspaceFolder(t)}return Promise.resolve(void 0)}extensionVisKey(e,t){return`${e}\0${t}`}serializeVisualization(e,t){if(t){if("title"in t&&"command"in t)return{type:0};if("treeId"in t)return{type:1,id:`${e}\0${t.treeId}`};throw new Error("Unsupported debug visualization type")}}getIconPathOrClass(e){const t=this.getIconUris(e);let i,n;return"id"in t?n=Jt.asClassName(t):i=t,{iconPath:i,iconClass:n}}getIconUris(e){if(e instanceof Kt)return{id:e.id};const t=typeof e=="object"&&"dark"in e?e.dark:e,i=typeof e=="object"&&"light"in e?e.light:e;return{dark:typeof t=="string"?x.file(t):t,light:typeof i=="string"?x.file(i):i}}};g_=U([M(0,Ve),M(1,cr),M(2,ns),M(3,lr),M(4,dd),M(5,a0),M(6,Ec)],g_);class e9{constructor(e,t,i,n,s,o,a){this._debugServiceProxy=e,this._id=t,this._type=i,this._name=n,this._workspaceFolder=s,this._configuration=o,this._parentSession=a}get api(){const e=this;return this.apiSession??(this.apiSession=Object.freeze({id:e._id,type:e._type,get name(){return e._name},set name(t){e._name=t,e._debugServiceProxy.$setDebugSessionName(e._id,t)},parentSession:e._parentSession,workspaceFolder:e._workspaceFolder,configuration:e._configuration,customRequest(t,i){return e._debugServiceProxy.$customDebugAdapterRequest(e._id,t,i)},getDebugProtocolBreakpoint(t){return e._debugServiceProxy.$getDebugProtocolBreakpoint(e._id,t.id)}}))}get id(){return this._id}get type(){return this._type}_acceptNameChanged(e){this._name=e}get configuration(){return this._configuration}}class t9{constructor(e){this.value=Object.freeze({append(t){e.$appendDebugConsole(t)},appendLine(t){this.append(t+`
`)}})}}class i9{constructor(e){this.trackers=e}onWillStartSession(){this.trackers.forEach(e=>e.onWillStartSession?e.onWillStartSession():void 0)}onWillReceiveMessage(e){this.trackers.forEach(t=>t.onWillReceiveMessage?t.onWillReceiveMessage(e):void 0)}onDidSendMessage(e){this.trackers.forEach(t=>t.onDidSendMessage?t.onDidSendMessage(e):void 0)}onWillStopSession(){this.trackers.forEach(e=>e.onWillStopSession?e.onWillStopSession():void 0)}onError(e){this.trackers.forEach(t=>t.onError?t.onError(e):void 0)}onExit(e,t){this.trackers.forEach(i=>i.onExit?i.onExit(e,t):void 0)}}class n9 extends j8{constructor(e){super(),this.implementation=e,e.onDidSendMessage(t=>{this.acceptMessage(t)})}startSession(){return Promise.resolve(void 0)}sendMessage(e){this.implementation.handleMessage(e)}stopSession(){return this.implementation.dispose(),Promise.resolve(void 0)}}let m_=class extends g_{constructor(e,t,i,n,s,o,a){super(e,t,i,n,s,o,a)}};m_=U([M(0,Ve),M(1,cr),M(2,ns),M(3,lr),M(4,dd),M(5,a0),M(6,Ec)],m_);class r9{constructor(e,t,i){this.config=e,this.provider=t,this.sessionToken=i,this.isLimitHit=!1,this.resultCount=0,this.isCanceled=!1,this.filePattern=e.filePattern,this.includePattern=e.includePattern&&Va(e.includePattern),this.maxResults=e.maxResults||void 0,this.exists=e.exists,this.activeCancellationTokens=new Set,this.globalExcludePattern=e.excludePattern&&Va(e.excludePattern)}cancel(){this.isCanceled=!0,this.activeCancellationTokens.forEach(e=>e.cancel()),this.activeCancellationTokens=new Set}search(e){const t=this.config.folderQueries||[];return new Promise((i,n)=>{const s=o=>{this.resultCount++,e(o)};if(this.isCanceled)return i({limitHit:this.isLimitHit});this.config.extraFileResources&&this.config.extraFileResources.forEach(o=>{const a=o.toString(),c=gi(a);this.globalExcludePattern&&this.globalExcludePattern(a,c)||this.matchFile(s,{base:o,basename:c})}),Promise.all(t.map(o=>this.searchInFolder(o,s))).then(o=>{i({limitHit:this.isLimitHit,stats:o[0]||void 0})},o=>{n(new Error(Sc(o)))})})}async searchInFolder(e,t){const i=new Tt,n=this.getSearchOptionsForFolder(e),s=this.initDirectoryTree(),o=new qC(this.config,e),a=!o.hasSiblingExcludeClauses();let c;try{this.activeCancellationTokens.add(i),c=rr.create();const l=await this.provider.provideFileSearchResults({pattern:this.config.filePattern||""},n,i.token),u=c.elapsed(),d=rr.create();return this.isCanceled&&!this.isLimitHit||(l&&l.forEach(f=>{const m=Be.relative(e.folder.path,f.path);if(a){const b=gi(f.path);this.matchFile(t,{base:e.folder,relativePath:m,basename:b});return}this.addDirectoryEntries(s,e.folder,m,t)}),this.isCanceled&&!this.isLimitHit)?null:(this.matchDirectoryTree(s,o,t),{providerTime:u,postProcessTime:d.elapsed()})}finally{i.dispose(),this.activeCancellationTokens.delete(i)}}getSearchOptionsForFolder(e){const t=Yf(this.config.includePattern,e.includePattern),i=Yf(this.config.excludePattern,e.excludePattern);return{folder:e.folder,excludes:i,includes:t,useIgnoreFiles:!e.disregardIgnoreFiles,useGlobalIgnoreFiles:!e.disregardGlobalIgnoreFiles,useParentIgnoreFiles:!e.disregardParentIgnoreFiles,followSymlinks:!e.ignoreSymlinks,maxResults:this.config.maxResults,session:this.sessionToken}}initDirectoryTree(){const e={rootEntries:[],pathToEntries:Object.create(null)};return e.pathToEntries["."]=e.rootEntries,e}addDirectoryEntries({pathToEntries:e},t,i,n){if(i===this.filePattern){const o=gi(this.filePattern);this.matchFile(n,{base:t,relativePath:this.filePattern,basename:o})}function s(o){const a=gi(o),c=Ys(o);let l=e[c];l||(l=e[c]=[],s(c)),l.push({base:t,relativePath:o,basename:a})}s(i)}matchDirectoryTree({rootEntries:e,pathToEntries:t},i,n){const s=this,o=this.filePattern;function a(c){const l=XI(()=>c.map(u=>u.basename));for(let u=0,d=c.length;u<d;u++){const f=c[u],{relativePath:m,basename:b}=f;if(i.matchesExcludesSync(m,b,o!==b?l:void 0))continue;const _=t[m];if(_)a(_);else{if(m===o)continue;s.matchFile(n,f)}if(s.isLimitHit)break}}a(e)}matchFile(e,t){(!this.includePattern||t.relativePath&&this.includePattern(t.relativePath,t.basename))&&((this.exists||this.maxResults&&this.resultCount>=this.maxResults)&&(this.isLimitHit=!0,this.cancel()),this.isLimitHit||e(t))}}const Tp=class Tp{constructor(){this.sessions=new Map}fileSearch(e,t,i,n){const s=this.getSessionTokenSource(e.cacheKey),o=new r9(e,t,s&&s.token);let a=0;const c=l=>{a+=l.length,i(l.map(u=>this.rawMatchToSearchItem(u)))};return this.doSearch(o,Tp.BATCH_SIZE,c,n).then(l=>({limitHit:l.limitHit,stats:{fromCache:!1,type:"fileSearchProvider",resultCount:a,detailStats:l.stats}}))}clearCache(e){const t=this.getSessionTokenSource(e);t==null||t.cancel()}getSessionTokenSource(e){if(e)return this.sessions.has(e)||this.sessions.set(e,new Tt),this.sessions.get(e)}rawMatchToSearchItem(e){return e.relativePath?{resource:wc(e.base,e.relativePath)}:{resource:e.base}}doSearch(e,t,i,n){const s=n.onCancellationRequested(()=>{e.cancel()}),o=c=>{c&&(a.push(c),t>0&&a.length>=t&&(i(a),a=[]))};let a=[];return e.search(o).then(c=>(a.length&&i(a),s.dispose(),c),c=>(a.length&&i(a),s.dispose(),Promise.reject(c)))}};Tp.BATCH_SIZE=512;let v_=Tp;class d2{constructor(e,t,i){this.queryProviderPair=e,this.fileUtils=t,this.processType=i,this.collector=null,this.isLimitHit=!1,this.resultCount=0}get query(){return this.queryProviderPair.query}search(e,t){const i=this.query.folderQueries||[],n=new Tt(t);return new Promise((s,o)=>{this.collector=new o9(e);let a=!1;const c=(l,u)=>{if(!a&&!this.isLimitHit){const d=this.resultSize(l);Yc(l)&&typeof this.query.maxResults=="number"&&this.resultCount+d>this.query.maxResults&&(this.isLimitHit=!0,a=!0,n.cancel(),l=this.trimResultToSize(l,this.query.maxResults-this.resultCount));const f=this.resultSize(l);this.resultCount+=f,(f>0||!Yc(l))&&this.collector.add(l,u)}};Promise.all(i.map((l,u)=>this.searchInFolder(l,d=>c(d,u),n.token))).then(l=>{n.dispose(),this.collector.flush();const u=l.some(d=>!!d&&!!d.limitHit);s({limitHit:this.isLimitHit||u,messages:dh(l.map(d=>d!=null&&d.message?Array.isArray(d.message)?d.message:[d.message]:[])),stats:{type:this.processType}})},l=>{n.dispose();const u=Sc(l);o(new Error(u))})})}resultSize(e){return Yc(e)?Array.isArray(e.ranges)?e.ranges.length:1:0}trimResultToSize(e,t){const i=Array.isArray(e.ranges)?e.ranges:[e.ranges],n=Array.isArray(e.preview.matches)?e.preview.matches:[e.preview.matches];return{ranges:i.slice(0,t),preview:{matches:n.slice(0,t),text:e.preview.text},uri:e.uri}}async searchInFolder(e,t,i){const n=new qC(this.query,e),s=[],o={report:l=>{if(!this.validateProviderResult(l))return;const u=e.folder.scheme===ne.file?KI(()=>this.fileUtils.readdir(Sw(l.uri))):void 0,d=Ox(e.folder,l.uri);if(d){const f=n.includedInQuery(d,gi(d),u);Jr(f)?s.push(f.then(m=>{m&&t(l)})):f&&t(l)}}},a=this.getSearchOptionsForFolder(e);let c;return this.queryProviderPair.query.type===3?c=await this.queryProviderPair.provider.provideAITextSearchResults(this.queryProviderPair.query.contentPattern,a,o,i):c=await this.queryProviderPair.provider.provideTextSearchResults(s9(this.queryProviderPair.query.contentPattern),a,o,i),s.length&&await Promise.all(s),c}validateProviderResult(e){if(Yc(e)){if(Array.isArray(e.ranges)){if(!Array.isArray(e.preview.matches))return console.warn("INVALID - A text search provider match's`ranges` and`matches` properties must have the same type."),!1;if(e.preview.matches.length!==e.ranges.length)return console.warn("INVALID - A text search provider match's`ranges` and`matches` properties must have the same length."),!1}else if(Array.isArray(e.preview.matches))return console.warn("INVALID - A text search provider match's`ranges` and`matches` properties must have the same length."),!1}return!0}getSearchOptionsForFolder(e){const t=Yf(this.query.includePattern,e.includePattern),i=Yf(this.query.excludePattern,e.excludePattern),n={folder:x.from(e.folder),excludes:i,includes:t,useIgnoreFiles:!e.disregardIgnoreFiles,useGlobalIgnoreFiles:!e.disregardGlobalIgnoreFiles,useParentIgnoreFiles:!e.disregardParentIgnoreFiles,followSymlinks:!e.ignoreSymlinks,encoding:e.fileEncoding&&this.fileUtils.toCanonicalName(e.fileEncoding),maxFileSize:this.query.maxFileSize,maxResults:this.query.maxResults,previewOptions:this.query.previewOptions,afterContext:this.query.afterContext,beforeContext:this.query.beforeContext};return"usePCRE2"in this.query&&(n.usePCRE2=this.query.usePCRE2),n}}function s9(r){return{isCaseSensitive:r.isCaseSensitive||!1,isRegExp:r.isRegExp||!1,isWordMatch:r.isWordMatch||!1,isMultiline:r.isMultiline||!1,pattern:r.pattern}}class o9{constructor(e){this._onResult=e,this._currentFolderIdx=-1,this._currentFileMatch=null,this._batchedCollector=new __(512,t=>this.sendItems(t))}add(e,t){this._currentFileMatch&&(this._currentFolderIdx!==t||!Fx(this._currentUri,e.uri))&&(this.pushToCollector(),this._currentFileMatch=null),this._currentFileMatch||(this._currentFolderIdx=t,this._currentFileMatch={resource:e.uri,results:[]}),this._currentFileMatch.results.push(a9(e))}pushToCollector(){const e=this._currentFileMatch&&this._currentFileMatch.results?this._currentFileMatch.results.length:0;this._batchedCollector.addItem(this._currentFileMatch,e)}flush(){this.pushToCollector(),this._batchedCollector.flush()}sendItems(e){this._onResult(e)}}function a9(r){return Yc(r)?{preview:{matches:Pl(r.preview.matches,e=>({startLineNumber:e.start.line,startColumn:e.start.character,endLineNumber:e.end.line,endColumn:e.end.character})),text:r.preview.text},ranges:Pl(r.ranges,e=>({startLineNumber:e.start.line,startColumn:e.start.character,endLineNumber:e.end.line,endColumn:e.end.character}))}:{text:r.text,lineNumber:r.lineNumber}}function Yc(r){return!!r.preview}const ia=class ia{constructor(e,t){this.maxBatchSize=e,this.cb=t,this.totalNumberCompleted=0,this.batch=[],this.batchSize=0}addItem(e,t){e&&this.addItemToBatch(e,t)}addItems(e,t){e&&this.addItemsToBatch(e,t)}addItemToBatch(e,t){this.batch.push(e),this.batchSize+=t,this.onUpdate()}addItemsToBatch(e,t){this.batch=this.batch.concat(e),this.batchSize+=t,this.onUpdate()}onUpdate(){this.totalNumberCompleted<ia.START_BATCH_AFTER_COUNT?this.flush():this.batchSize>=this.maxBatchSize?this.flush():this.timeoutHandle||(this.timeoutHandle=setTimeout(()=>{this.flush()},ia.TIMEOUT))}flush(){this.batchSize&&(this.totalNumberCompleted+=this.batchSize,this.cb(this.batch),this.batch=[],this.batchSize=0,this.timeoutHandle&&(clearTimeout(this.timeoutHandle),this.timeoutHandle=0))}};ia.TIMEOUT=4e3,ia.START_BATCH_AFTER_COUNT=50;let __=ia;const yS=Ce("IExtHostSearch");let w_=class{constructor(e,t,i){this.extHostRpc=e,this._uriTransformer=t,this._logService=i,this._proxy=this.extHostRpc.getProxy(J.MainThreadSearch),this._handlePool=0,this._textSearchProvider=new Map,this._textSearchUsedSchemes=new Set,this._aiTextSearchProvider=new Map,this._aiTextSearchUsedSchemes=new Set,this._fileSearchProvider=new Map,this._fileSearchUsedSchemes=new Set,this._fileSearchManager=new v_}_transformScheme(e){return this._uriTransformer.transformOutgoingScheme(e)}registerTextSearchProvider(e,t){if(this._textSearchUsedSchemes.has(e))throw new Error(`a text search provider for the scheme '${e}' is already registered`);this._textSearchUsedSchemes.add(e);const i=this._handlePool++;return this._textSearchProvider.set(i,t),this._proxy.$registerTextSearchProvider(i,this._transformScheme(e)),De(()=>{this._textSearchUsedSchemes.delete(e),this._textSearchProvider.delete(i),this._proxy.$unregisterProvider(i)})}registerAITextSearchProvider(e,t){if(this._aiTextSearchUsedSchemes.has(e))throw new Error(`an AI text search provider for the scheme '${e}'is already registered`);this._aiTextSearchUsedSchemes.add(e);const i=this._handlePool++;return this._aiTextSearchProvider.set(i,t),this._proxy.$registerAITextSearchProvider(i,this._transformScheme(e)),De(()=>{this._aiTextSearchUsedSchemes.delete(e),this._aiTextSearchProvider.delete(i),this._proxy.$unregisterProvider(i)})}registerFileSearchProvider(e,t){if(this._fileSearchUsedSchemes.has(e))throw new Error(`a file search provider for the scheme '${e}' is already registered`);this._fileSearchUsedSchemes.add(e);const i=this._handlePool++;return this._fileSearchProvider.set(i,t),this._proxy.$registerFileSearchProvider(i,this._transformScheme(e)),De(()=>{this._fileSearchUsedSchemes.delete(e),this._fileSearchProvider.delete(i),this._proxy.$unregisterProvider(i)})}$provideFileSearchResults(e,t,i,n){const s=sm(i),o=this._fileSearchProvider.get(e);if(o)return this._fileSearchManager.fileSearch(s,o,a=>{this._proxy.$handleFileMatch(e,t,a.map(c=>c.resource))},n);throw new Error("3 unknown provider: "+e)}async doInternalFileSearchWithCustomCallback(e,t,i){return{messages:[]}}$clearCache(e){return this._fileSearchManager.clearCache(e),Promise.resolve(void 0)}$provideTextSearchResults(e,t,i,n){const s=this._textSearchProvider.get(e);if(!s||!s.provideTextSearchResults)throw new Error(`2 Unknown provider ${e}`);const o=sm(i);return this.createTextSearchManager(o,s).search(c=>this._proxy.$handleTextMatch(e,t,c),n)}$provideAITextSearchResults(e,t,i,n){const s=this._aiTextSearchProvider.get(e);if(!s||!s.provideAITextSearchResults)throw new Error(`1 Unknown provider ${e}`);const o=sm(i);return this.createAITextSearchManager(o,s).search(c=>this._proxy.$handleTextMatch(e,t,c),n)}$enableExtensionHostSearch(){}createTextSearchManager(e,t){return new d2({query:e,provider:t},{readdir:i=>Promise.resolve([]),toCanonicalName:i=>i},"textSearchProvider")}createAITextSearchManager(e,t){return new d2({query:e,provider:t},{readdir:i=>Promise.resolve([]),toCanonicalName:i=>i},"aiTextSearchProvider")}};w_=U([M(0,Ve),M(1,Jp),M(2,Je)],w_);function sm(r){return{...r,folderQueries:r.folderQueries&&r.folderQueries.map(c9),extraFileResources:r.extraFileResources&&r.extraFileResources.map(e=>x.revive(e))}}function c9(r){return{...r,folder:x.revive(r.folder)}}var b_,gc;let y_=(gc=class{getState(){const e=this._state;return{get focused(){return e.focused},get active(){return e.active}}}constructor(e){this._onDidChangeWindowState=new R,this.onDidChangeWindowState=this._onDidChangeWindowState.event,this._state=b_.InitialState,this._proxy=e.getProxy(J.MainThreadWindow),this._proxy.$getInitialState().then(({isFocused:t,isActive:i})=>{this.onDidChangeWindowProperty("focused",t),this.onDidChangeWindowProperty("active",i)})}$onDidChangeWindowFocus(e){this.onDidChangeWindowProperty("focused",e)}$onDidChangeWindowActive(e){this.onDidChangeWindowProperty("active",e)}onDidChangeWindowProperty(e,t){t!==this._state[e]&&(this._state={...this._state,[e]:t},this._onDidChangeWindowState.fire(this._state))}openUri(e,t){let i;if(typeof e=="string"){i=e;try{e=x.parse(e)}catch{return Promise.reject(`Invalid uri - '${e}'`)}}return gh(e.scheme)?Promise.reject("Invalid scheme - cannot be empty"):e.scheme===ne.command?Promise.reject(`Invalid scheme '${e.scheme}'`):this._proxy.$openUri(e,i,t)}async asExternalUri(e,t){if(gh(e.scheme))return Promise.reject("Invalid scheme - cannot be empty");const i=await this._proxy.$asExternalUri(e,t);return x.from(i)}},b_=gc,gc.InitialState={focused:!0,active:!0},gc);y_=b_=U([M(0,Ve)],y_);const xS=Ce("IExtHostWindow"),CS=Ce("IExtHostTerminalShellIntegration");let x_=class extends Fe{constructor(e,t){super(),this._extHostTerminalService=t,this._activeShellIntegrations=new Map,this._onDidChangeTerminalShellIntegration=new R,this.onDidChangeTerminalShellIntegration=this._onDidChangeTerminalShellIntegration.event,this._onDidStartTerminalShellExecution=new R,this.onDidStartTerminalShellExecution=this._onDidStartTerminalShellExecution.event,this._onDidEndTerminalShellExecution=new R,this.onDidEndTerminalShellExecution=this._onDidEndTerminalShellExecution.event,this._proxy=e.getProxy(J.MainThreadTerminalShellIntegration),this._register(De(()=>{for(const[i,n]of this._activeShellIntegrations)n.dispose();this._activeShellIntegrations.clear()}))}$shellIntegrationChange(e){const t=this._extHostTerminalService.getTerminalById(e);if(!t)return;const i=t.value;let n=this._activeShellIntegrations.get(e);n||(n=new l9(t.value,this._onDidStartTerminalShellExecution),this._activeShellIntegrations.set(e,n),n.store.add(t.onWillDispose(()=>{var s;return(s=this._activeShellIntegrations.get(e))==null?void 0:s.dispose()})),n.store.add(n.onDidRequestShellExecution(s=>this._proxy.$executeCommand(e,s))),n.store.add(n.onDidRequestEndExecution(s=>this._onDidEndTerminalShellExecution.fire(s))),n.store.add(n.onDidRequestChangeShellIntegration(s=>this._onDidChangeTerminalShellIntegration.fire(s))),t.shellIntegration=n.value),this._onDidChangeTerminalShellIntegration.fire({terminal:i,shellIntegration:n.value})}$shellExecutionStart(e,t,i,n,s){var a;this._activeShellIntegrations.has(e)||this.$shellIntegrationChange(e);const o={value:t,confidence:i,isTrusted:n};(a=this._activeShellIntegrations.get(e))==null||a.startShellExecution(o,s)}$shellExecutionEnd(e,t,i,n,s){var a;const o={value:t,confidence:i,isTrusted:n};(a=this._activeShellIntegrations.get(e))==null||a.endShellExecution(o,s)}$shellExecutionData(e,t){var i;(i=this._activeShellIntegrations.get(e))==null||i.emitData(t)}$cwdChange(e,t){var i;(i=this._activeShellIntegrations.get(e))==null||i.setCwd(Cx(t)?x.revive(t):t)}$closeTerminal(e){var t;(t=this._activeShellIntegrations.get(e))==null||t.dispose(),this._activeShellIntegrations.delete(e)}};x_=U([M(0,Ve),M(1,kc)],x_);class l9 extends Fe{get currentExecution(){return this._currentExecution}constructor(e,t){super(),this._terminal=e,this._onDidStartTerminalShellExecution=t,this._ignoreNextExecution=!1,this.store=this._register(new Te),this._onDidRequestChangeShellIntegration=this._register(new R),this.onDidRequestChangeShellIntegration=this._onDidRequestChangeShellIntegration.event,this._onDidRequestShellExecution=this._register(new R),this.onDidRequestShellExecution=this._onDidRequestShellExecution.event,this._onDidRequestEndExecution=this._register(new R),this.onDidRequestEndExecution=this._onDidRequestEndExecution.event;const i=this;this.value={get cwd(){return i._cwd},executeCommand(n,s){let o=n;s&&(o+=` "${s.map(l=>`${l.replaceAll('"','\\"')}`).join('" "')}"`),i._onDidRequestShellExecution.fire(o);const a={value:o,confidence:Zh.High,isTrusted:!0},c=i.startShellExecution(a,i._cwd,!0).value;return i._ignoreNextExecution=!0,c}}}startShellExecution(e,t,i){if(this._ignoreNextExecution&&this._currentExecution)this._ignoreNextExecution=!1;else{this._currentExecution&&(this._currentExecution.endExecution(void 0),this._onDidRequestEndExecution.fire({terminal:this._terminal,shellIntegration:this.value,execution:this._currentExecution.value,exitCode:void 0}));const n=this._currentExecution=new u9(e,t);i?queueMicrotask(()=>this._onDidStartTerminalShellExecution.fire({terminal:this._terminal,shellIntegration:this.value,execution:n.value})):this._onDidStartTerminalShellExecution.fire({terminal:this._terminal,shellIntegration:this.value,execution:this._currentExecution.value})}return this._currentExecution}emitData(e){var t;(t=this.currentExecution)==null||t.emitData(e)}endShellExecution(e,t){this._currentExecution&&(this._currentExecution.endExecution(e),this._onDidRequestEndExecution.fire({terminal:this._terminal,shellIntegration:this.value,execution:this._currentExecution.value,exitCode:t}),this._currentExecution=void 0)}setCwd(e){let t=!1;x.isUri(this._cwd)?t=!x.isUri(e)||this._cwd.toString()!==e.toString():this._cwd!==e&&(t=!0),t&&(this._cwd=e,this._onDidRequestChangeShellIntegration.fire({terminal:this._terminal,shellIntegration:this.value}))}}class u9{constructor(e,t){this._commandLine=e,this.cwd=t,this._ended=!1;const i=this;this.value={get commandLine(){return i._commandLine},get cwd(){return i.cwd},read(){return i._createDataStream()}}}_createDataStream(){if(!this._dataStream){if(this._ended)return Ll.EMPTY;this._dataStream=new d9}return this._dataStream.createIterable()}emitData(e){var t;(t=this._dataStream)==null||t.emitData(e)}endExecution(e){var t;e&&(this._commandLine=e),(t=this._dataStream)==null||t.endExecution(),this._dataStream=void 0,this._ended=!0}}class d9 extends Fe{constructor(){super(...arguments),this._emitters=[]}createIterable(){this._barrier||(this._barrier=new Ki);const e=this._barrier;return new Ll(async i=>{this._emitters.push(i),await e.wait()})}emitData(e){for(const t of this._emitters)t.emitOne(e)}endExecution(){var e;(e=this._barrier)==null||e.open(),this._barrier=void 0}}it(t0,qv,1);it(yc,ip,1);it(fg,i_,1);it(Ec,Ov,0);it(Zw,Bv,0);it(Yw,Wv,0);it(lr,Iv,0);it(ug,Av,0);it(bS,m_,0);it(dS,Zv,0);it(ud,t_,0);it(i0,Gv,0);it(xc,wk,0);it(uS,Xv,1);it(yS,w_,0);it(Gw,XC,0);it(_S,d_,0);it(kc,Uv,0);it(CS,x_,0);it(Kw,Mv,0);it(xS,y_,0);it(cr,Ev,0);it(e0,oS,0);it(dg,Fv,0);it(dd,h_,0);it(a0,p_,0);const h2={tabSize:4,indentSize:4,insertSpaces:!0,detectIndentation:!0,trimAutoWhitespace:!0,largeFileOptimizations:!0,bracketPairColorizationOptions:{enabled:!0,independentColorPoolPerBracketType:!1}},y="vs/editor/common/config/editorOptions",h9=8;class f9{constructor(){this.stableMinimapLayoutInput=null,this.stableFitMaxMinimapScale=0,this.stableFitRemainingWidth=0}}class Ge{constructor(e,t,i,n){this.id=e,this.name=t,this.defaultValue=i,this.schema=n}applyUpdate(e,t){return pg(e,t)}compute(e,t,i){return i}}class sh{constructor(e,t){this.newValue=e,this.didChange=t}}function pg(r,e){if(typeof r!="object"||typeof e!="object"||!r||!e)return new sh(e,r!==e);if(Array.isArray(r)||Array.isArray(e)){const i=Array.isArray(r)&&Array.isArray(e)&&qr(r,e);return new sh(e,!i)}let t=!1;for(const i in e)if(e.hasOwnProperty(i)){const n=pg(r[i],e[i]);n.didChange&&(r[i]=n.newValue,t=!0)}return new sh(r,t)}class hd{constructor(e){this.schema=void 0,this.id=e,this.name="_never_",this.defaultValue=void 0}applyUpdate(e,t){return pg(e,t)}validate(e){return this.defaultValue}}class Dc{constructor(e,t,i,n){this.id=e,this.name=t,this.defaultValue=i,this.schema=n}applyUpdate(e,t){return pg(e,t)}validate(e){return typeof e>"u"?this.defaultValue:e}compute(e,t,i){return i}}function Z(r,e){return typeof r>"u"?e:r==="false"?!1:!!r}class we extends Dc{constructor(e,t,i,n=void 0){typeof n<"u"&&(n.type="boolean",n.default=i),super(e,t,i,n)}validate(e){return Z(e,this.defaultValue)}}function p9(r,e,t,i){if(typeof r>"u")return e;let n=parseInt(r,10);return isNaN(n)?e:(n=Math.max(t,n),n=Math.min(i,n),n|0)}class Oe extends Dc{static clampedInt(e,t,i,n){return p9(e,t,i,n)}constructor(e,t,i,n,s,o=void 0){typeof o<"u"&&(o.type="integer",o.default=i,o.minimum=n,o.maximum=s),super(e,t,i,o),this.minimum=n,this.maximum=s}validate(e){return Oe.clampedInt(e,this.defaultValue,this.minimum,this.maximum)}}class Yi extends Dc{static clamp(e,t,i){return e<t?t:e>i?i:e}static float(e,t){if(typeof e=="number")return e;if(typeof e>"u")return t;const i=parseFloat(e);return isNaN(i)?t:i}constructor(e,t,i,n,s){typeof s<"u"&&(s.type="number",s.default=i),super(e,t,i,s),this.validationFn=n}validate(e){return this.validationFn(Yi.float(e,this.defaultValue))}}class Ut extends Dc{static string(e,t){return typeof e!="string"?t:e}constructor(e,t,i,n=void 0){typeof n<"u"&&(n.type="string",n.default=i),super(e,t,i,n)}validate(e){return Ut.string(e,this.defaultValue)}}function at(r,e,t,i){return typeof r!="string"||t.indexOf(r)===-1?e:r}class Ye extends Dc{constructor(e,t,i,n,s=void 0){typeof s<"u"&&(s.type="string",s.enum=n,s.default=i),super(e,t,i,s),this._allowedValues=n}validate(e){return at(e,this.defaultValue,this._allowedValues)}}class Ld extends Ge{constructor(e,t,i,n,s,o,a=void 0){typeof a<"u"&&(a.type="string",a.enum=s,a.default=n),super(e,t,i,a),this._allowedValues=s,this._convert=o}validate(e){return typeof e!="string"?this.defaultValue:this._allowedValues.indexOf(e)===-1?this.defaultValue:this._convert(e)}}function g9(r){switch(r){case"none":return 0;case"keep":return 1;case"brackets":return 2;case"advanced":return 3;case"full":return 4}}class m9 extends Ge{constructor(){super(2,"accessibilitySupport",0,{type:"string",enum:["auto","on","off"],enumDescriptions:[h(y,0,"Use platform APIs to detect when a Screen Reader is attached."),h(y,1,"Optimize for usage with a Screen Reader."),h(y,2,"Assume a screen reader is not attached.")],default:"auto",tags:["accessibility"],description:h(y,3,"Controls if the UI should run in a mode where it is optimized for screen readers.")})}validate(e){switch(e){case"auto":return 0;case"off":return 1;case"on":return 2}return this.defaultValue}compute(e,t,i){return i===0?e.accessibilitySupport:i}}class v9 extends Ge{constructor(){const e={insertSpace:!0,ignoreEmptyLines:!0};super(23,"comments",e,{"editor.comments.insertSpace":{type:"boolean",default:e.insertSpace,description:h(y,4,"Controls whether a space character is inserted when commenting.")},"editor.comments.ignoreEmptyLines":{type:"boolean",default:e.ignoreEmptyLines,description:h(y,5,"Controls if empty lines should be ignored with toggle, add or remove actions for line comments.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{insertSpace:Z(t.insertSpace,this.defaultValue.insertSpace),ignoreEmptyLines:Z(t.ignoreEmptyLines,this.defaultValue.ignoreEmptyLines)}}}function _9(r){switch(r){case"blink":return 1;case"smooth":return 2;case"phase":return 3;case"expand":return 4;case"solid":return 5}}var vn;(function(r){r[r.Line=1]="Line",r[r.Block=2]="Block",r[r.Underline=3]="Underline",r[r.LineThin=4]="LineThin",r[r.BlockOutline=5]="BlockOutline",r[r.UnderlineThin=6]="UnderlineThin"})(vn||(vn={}));function w9(r){switch(r){case"line":return vn.Line;case"block":return vn.Block;case"underline":return vn.Underline;case"line-thin":return vn.LineThin;case"block-outline":return vn.BlockOutline;case"underline-thin":return vn.UnderlineThin}}class b9 extends hd{constructor(){super(142)}compute(e,t,i){const n=["monaco-editor"];return t.get(39)&&n.push(t.get(39)),e.extraEditorClassName&&n.push(e.extraEditorClassName),t.get(74)==="default"?n.push("mouse-default"):t.get(74)==="copy"&&n.push("mouse-copy"),t.get(111)&&n.push("showUnused"),t.get(140)&&n.push("showDeprecated"),n.join(" ")}}class y9 extends we{constructor(){super(37,"emptySelectionClipboard",!0,{description:h(y,6,"Controls whether copying without a selection copies the current line.")})}compute(e,t,i){return i&&e.emptySelectionClipboard}}class x9 extends Ge{constructor(){const e={cursorMoveOnType:!0,seedSearchStringFromSelection:"always",autoFindInSelection:"never",globalFindClipboard:!1,addExtraSpaceOnTop:!0,loop:!0};super(41,"find",e,{"editor.find.cursorMoveOnType":{type:"boolean",default:e.cursorMoveOnType,description:h(y,7,"Controls whether the cursor should jump to find matches while typing.")},"editor.find.seedSearchStringFromSelection":{type:"string",enum:["never","always","selection"],default:e.seedSearchStringFromSelection,enumDescriptions:[h(y,8,"Never seed search string from the editor selection."),h(y,9,"Always seed search string from the editor selection, including word at cursor position."),h(y,10,"Only seed search string from the editor selection.")],description:h(y,11,"Controls whether the search string in the Find Widget is seeded from the editor selection.")},"editor.find.autoFindInSelection":{type:"string",enum:["never","always","multiline"],default:e.autoFindInSelection,enumDescriptions:[h(y,12,"Never turn on Find in Selection automatically (default)."),h(y,13,"Always turn on Find in Selection automatically."),h(y,14,"Turn on Find in Selection automatically when multiple lines of content are selected.")],description:h(y,15,"Controls the condition for turning on Find in Selection automatically.")},"editor.find.globalFindClipboard":{type:"boolean",default:e.globalFindClipboard,description:h(y,16,"Controls whether the Find Widget should read or modify the shared find clipboard on macOS."),included:rn},"editor.find.addExtraSpaceOnTop":{type:"boolean",default:e.addExtraSpaceOnTop,description:h(y,17,"Controls whether the Find Widget should add extra lines on top of the editor. When true, you can scroll beyond the first line when the Find Widget is visible.")},"editor.find.loop":{type:"boolean",default:e.loop,description:h(y,18,"Controls whether the search automatically restarts from the beginning (or the end) when no further matches can be found.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{cursorMoveOnType:Z(t.cursorMoveOnType,this.defaultValue.cursorMoveOnType),seedSearchStringFromSelection:typeof e.seedSearchStringFromSelection=="boolean"?e.seedSearchStringFromSelection?"always":"never":at(t.seedSearchStringFromSelection,this.defaultValue.seedSearchStringFromSelection,["never","always","selection"]),autoFindInSelection:typeof e.autoFindInSelection=="boolean"?e.autoFindInSelection?"always":"never":at(t.autoFindInSelection,this.defaultValue.autoFindInSelection,["never","always","multiline"]),globalFindClipboard:Z(t.globalFindClipboard,this.defaultValue.globalFindClipboard),addExtraSpaceOnTop:Z(t.addExtraSpaceOnTop,this.defaultValue.addExtraSpaceOnTop),loop:Z(t.loop,this.defaultValue.loop)}}}const Mn=class Mn extends Ge{constructor(){super(51,"fontLigatures",Mn.OFF,{anyOf:[{type:"boolean",description:h(y,19,"Enables/Disables font ligatures ('calt' and 'liga' font features). Change this to a string for fine-grained control of the 'font-feature-settings' CSS property.")},{type:"string",description:h(y,20,"Explicit 'font-feature-settings' CSS property. A boolean can be passed instead if one only needs to turn on/off ligatures.")}],description:h(y,21,"Configures font ligatures or font features. Can be either a boolean to enable/disable ligatures or a string for the value of the CSS 'font-feature-settings' property."),default:!1})}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e==="false"||e.length===0?Mn.OFF:e==="true"?Mn.ON:e:e?Mn.ON:Mn.OFF}};Mn.OFF='"liga" off, "calt" off',Mn.ON='"liga" on, "calt" on';let C_=Mn;const Fn=class Fn extends Ge{constructor(){super(54,"fontVariations",Fn.OFF,{anyOf:[{type:"boolean",description:h(y,22,"Enables/Disables the translation from font-weight to font-variation-settings. Change this to a string for fine-grained control of the 'font-variation-settings' CSS property.")},{type:"string",description:h(y,23,"Explicit 'font-variation-settings' CSS property. A boolean can be passed instead if one only needs to translate font-weight to font-variation-settings.")}],description:h(y,24,"Configures font variations. Can be either a boolean to enable/disable the translation from font-weight to font-variation-settings or a string for the value of the CSS 'font-variation-settings' property."),default:!1})}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e==="false"?Fn.OFF:e==="true"?Fn.TRANSLATE:e:e?Fn.TRANSLATE:Fn.OFF}compute(e,t,i){return e.fontInfo.fontVariationSettings}};Fn.OFF="normal",Fn.TRANSLATE="translate";let S_=Fn;class C9 extends hd{constructor(){super(50)}compute(e,t,i){return e.fontInfo}}class S9 extends Dc{constructor(){super(52,"fontSize",ir.fontSize,{type:"number",minimum:6,maximum:100,default:ir.fontSize,description:h(y,25,"Controls the font size in pixels.")})}validate(e){const t=Yi.float(e,this.defaultValue);return t===0?ir.fontSize:Yi.clamp(t,6,100)}compute(e,t,i){return e.fontInfo.fontSize}}const dn=class dn extends Ge{constructor(){super(53,"fontWeight",ir.fontWeight,{anyOf:[{type:"number",minimum:dn.MINIMUM_VALUE,maximum:dn.MAXIMUM_VALUE,errorMessage:h(y,26,'Only "normal" and "bold" keywords or numbers between 1 and 1000 are allowed.')},{type:"string",pattern:"^(normal|bold|1000|[1-9][0-9]{0,2})$"},{enum:dn.SUGGESTION_VALUES}],default:ir.fontWeight,description:h(y,27,'Controls the font weight. Accepts "normal" and "bold" keywords or numbers between 1 and 1000.')})}validate(e){return e==="normal"||e==="bold"?e:String(Oe.clampedInt(e,ir.fontWeight,dn.MINIMUM_VALUE,dn.MAXIMUM_VALUE))}};dn.SUGGESTION_VALUES=["normal","bold","100","200","300","400","500","600","700","800","900"],dn.MINIMUM_VALUE=1,dn.MAXIMUM_VALUE=1e3;let E_=dn;class E9 extends Ge{constructor(){const e={multiple:"peek",multipleDefinitions:"peek",multipleTypeDefinitions:"peek",multipleDeclarations:"peek",multipleImplementations:"peek",multipleReferences:"peek",alternativeDefinitionCommand:"editor.action.goToReferences",alternativeTypeDefinitionCommand:"editor.action.goToReferences",alternativeDeclarationCommand:"editor.action.goToReferences",alternativeImplementationCommand:"",alternativeReferenceCommand:""},t={type:"string",enum:["peek","gotoAndPeek","goto"],default:e.multiple,enumDescriptions:[h(y,28,"Show Peek view of the results (default)"),h(y,29,"Go to the primary result and show a Peek view"),h(y,30,"Go to the primary result and enable Peek-less navigation to others")]},i=["","editor.action.referenceSearch.trigger","editor.action.goToReferences","editor.action.peekImplementation","editor.action.goToImplementation","editor.action.peekTypeDefinition","editor.action.goToTypeDefinition","editor.action.peekDeclaration","editor.action.revealDeclaration","editor.action.peekDefinition","editor.action.revealDefinitionAside","editor.action.revealDefinition"];super(58,"gotoLocation",e,{"editor.gotoLocation.multiple":{deprecationMessage:h(y,31,"This setting is deprecated, please use separate settings like 'editor.editor.gotoLocation.multipleDefinitions' or 'editor.editor.gotoLocation.multipleImplementations' instead.")},"editor.gotoLocation.multipleDefinitions":{description:h(y,32,"Controls the behavior the 'Go to Definition'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleTypeDefinitions":{description:h(y,33,"Controls the behavior the 'Go to Type Definition'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleDeclarations":{description:h(y,34,"Controls the behavior the 'Go to Declaration'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleImplementations":{description:h(y,35,"Controls the behavior the 'Go to Implementations'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleReferences":{description:h(y,36,"Controls the behavior the 'Go to References'-command when multiple target locations exist."),...t},"editor.gotoLocation.alternativeDefinitionCommand":{type:"string",default:e.alternativeDefinitionCommand,enum:i,description:h(y,37,"Alternative command id that is being executed when the result of 'Go to Definition' is the current location.")},"editor.gotoLocation.alternativeTypeDefinitionCommand":{type:"string",default:e.alternativeTypeDefinitionCommand,enum:i,description:h(y,38,"Alternative command id that is being executed when the result of 'Go to Type Definition' is the current location.")},"editor.gotoLocation.alternativeDeclarationCommand":{type:"string",default:e.alternativeDeclarationCommand,enum:i,description:h(y,39,"Alternative command id that is being executed when the result of 'Go to Declaration' is the current location.")},"editor.gotoLocation.alternativeImplementationCommand":{type:"string",default:e.alternativeImplementationCommand,enum:i,description:h(y,40,"Alternative command id that is being executed when the result of 'Go to Implementation' is the current location.")},"editor.gotoLocation.alternativeReferenceCommand":{type:"string",default:e.alternativeReferenceCommand,enum:i,description:h(y,41,"Alternative command id that is being executed when the result of 'Go to Reference' is the current location.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{multiple:at(t.multiple,this.defaultValue.multiple,["peek","gotoAndPeek","goto"]),multipleDefinitions:t.multipleDefinitions??at(t.multipleDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleTypeDefinitions:t.multipleTypeDefinitions??at(t.multipleTypeDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleDeclarations:t.multipleDeclarations??at(t.multipleDeclarations,"peek",["peek","gotoAndPeek","goto"]),multipleImplementations:t.multipleImplementations??at(t.multipleImplementations,"peek",["peek","gotoAndPeek","goto"]),multipleReferences:t.multipleReferences??at(t.multipleReferences,"peek",["peek","gotoAndPeek","goto"]),alternativeDefinitionCommand:Ut.string(t.alternativeDefinitionCommand,this.defaultValue.alternativeDefinitionCommand),alternativeTypeDefinitionCommand:Ut.string(t.alternativeTypeDefinitionCommand,this.defaultValue.alternativeTypeDefinitionCommand),alternativeDeclarationCommand:Ut.string(t.alternativeDeclarationCommand,this.defaultValue.alternativeDeclarationCommand),alternativeImplementationCommand:Ut.string(t.alternativeImplementationCommand,this.defaultValue.alternativeImplementationCommand),alternativeReferenceCommand:Ut.string(t.alternativeReferenceCommand,this.defaultValue.alternativeReferenceCommand)}}}class k9 extends Ge{constructor(){const e={enabled:!0,delay:300,hidingDelay:300,sticky:!0,above:!0};super(60,"hover",e,{"editor.hover.enabled":{type:"boolean",default:e.enabled,description:h(y,42,"Controls whether the hover is shown.")},"editor.hover.delay":{type:"number",default:e.delay,minimum:0,maximum:1e4,description:h(y,43,"Controls the delay in milliseconds after which the hover is shown.")},"editor.hover.sticky":{type:"boolean",default:e.sticky,description:h(y,44,"Controls whether the hover should remain visible when mouse is moved over it.")},"editor.hover.hidingDelay":{type:"integer",minimum:0,default:e.hidingDelay,description:h(y,45,"Controls the delay in milliseconds after which the hover is hidden. Requires `editor.hover.sticky` to be enabled.")},"editor.hover.above":{type:"boolean",default:e.above,description:h(y,46,"Prefer showing hovers above the line, if there's space.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Z(t.enabled,this.defaultValue.enabled),delay:Oe.clampedInt(t.delay,this.defaultValue.delay,0,1e4),sticky:Z(t.sticky,this.defaultValue.sticky),hidingDelay:Oe.clampedInt(t.hidingDelay,this.defaultValue.hidingDelay,0,6e5),above:Z(t.above,this.defaultValue.above)}}}class _l extends hd{constructor(){super(145)}compute(e,t,i){return _l.computeLayout(t,{memory:e.memory,outerWidth:e.outerWidth,outerHeight:e.outerHeight,isDominatedByLongLines:e.isDominatedByLongLines,lineHeight:e.fontInfo.lineHeight,viewLineCount:e.viewLineCount,lineNumbersDigitCount:e.lineNumbersDigitCount,typicalHalfwidthCharacterWidth:e.fontInfo.typicalHalfwidthCharacterWidth,maxDigitWidth:e.fontInfo.maxDigitWidth,pixelRatio:e.pixelRatio,glyphMarginDecorationLaneCount:e.glyphMarginDecorationLaneCount})}static computeContainedMinimapLineCount(e){const t=e.height/e.lineHeight,i=Math.floor(e.paddingTop/e.lineHeight);let n=Math.floor(e.paddingBottom/e.lineHeight);e.scrollBeyondLastLine&&(n=Math.max(n,t-1));const s=(i+e.viewLineCount+n)/(e.pixelRatio*e.height),o=Math.floor(e.viewLineCount/s);return{typicalViewportLineCount:t,extraLinesBeforeFirstLine:i,extraLinesBeyondLastLine:n,desiredRatio:s,minimapLineCount:o}}static _computeMinimapLayout(e,t){const i=e.outerWidth,n=e.outerHeight,s=e.pixelRatio;if(!e.minimap.enabled)return{renderMinimap:0,minimapLeft:0,minimapWidth:0,minimapHeightIsEditorHeight:!1,minimapIsSampling:!1,minimapScale:1,minimapLineHeight:1,minimapCanvasInnerWidth:0,minimapCanvasInnerHeight:Math.floor(s*n),minimapCanvasOuterWidth:0,minimapCanvasOuterHeight:n};const o=t.stableMinimapLayoutInput,a=o&&e.outerHeight===o.outerHeight&&e.lineHeight===o.lineHeight&&e.typicalHalfwidthCharacterWidth===o.typicalHalfwidthCharacterWidth&&e.pixelRatio===o.pixelRatio&&e.scrollBeyondLastLine===o.scrollBeyondLastLine&&e.paddingTop===o.paddingTop&&e.paddingBottom===o.paddingBottom&&e.minimap.enabled===o.minimap.enabled&&e.minimap.side===o.minimap.side&&e.minimap.size===o.minimap.size&&e.minimap.showSlider===o.minimap.showSlider&&e.minimap.renderCharacters===o.minimap.renderCharacters&&e.minimap.maxColumn===o.minimap.maxColumn&&e.minimap.scale===o.minimap.scale&&e.verticalScrollbarWidth===o.verticalScrollbarWidth&&e.isViewportWrapping===o.isViewportWrapping,c=e.lineHeight,l=e.typicalHalfwidthCharacterWidth,u=e.scrollBeyondLastLine,d=e.minimap.renderCharacters;let f=s>=2?Math.round(e.minimap.scale*2):e.minimap.scale;const m=e.minimap.maxColumn,b=e.minimap.size,_=e.minimap.side,v=e.verticalScrollbarWidth,k=e.viewLineCount,D=e.remainingWidth,E=e.isViewportWrapping,N=d?2:3;let A=Math.floor(s*n);const j=A/s;let re=!1,te=!1,q=N*f,We=f/s,V=1;if(b==="fill"||b==="fit"){const{typicalViewportLineCount:tt,extraLinesBeforeFirstLine:nt,extraLinesBeyondLastLine:He,desiredRatio:Ot,minimapLineCount:gt}=_l.computeContainedMinimapLineCount({viewLineCount:k,scrollBeyondLastLine:u,paddingTop:e.paddingTop,paddingBottom:e.paddingBottom,height:n,lineHeight:c,pixelRatio:s});if(k/gt>1)re=!0,te=!0,f=1,q=1,We=f/s;else{let _t=!1,_i=f+1;if(b==="fit"){const rt=Math.ceil((nt+k+He)*q);E&&a&&D<=t.stableFitRemainingWidth?(_t=!0,_i=t.stableFitMaxMinimapScale):_t=rt>A}if(b==="fill"||_t){re=!0;const rt=f;q=Math.min(c*s,Math.max(1,Math.floor(1/Ot))),E&&a&&D<=t.stableFitRemainingWidth&&(_i=t.stableFitMaxMinimapScale),f=Math.min(_i,Math.max(1,Math.floor(q/N))),f>rt&&(V=Math.min(2,f/rt)),We=f/s/V,A=Math.ceil(Math.max(tt,nt+k+He)*q),E?(t.stableMinimapLayoutInput=e,t.stableFitRemainingWidth=D,t.stableFitMaxMinimapScale=f):(t.stableMinimapLayoutInput=null,t.stableFitRemainingWidth=0)}}}const B=Math.floor(m*We),Q=Math.min(B,Math.max(0,Math.floor((D-v-2)*We/(l+We)))+h9);let Y=Math.floor(s*Q);const ie=Y/s;Y=Math.floor(Y*V);const me=d?1:2,ge=_==="left"?0:i-Q-v;return{renderMinimap:me,minimapLeft:ge,minimapWidth:Q,minimapHeightIsEditorHeight:re,minimapIsSampling:te,minimapScale:f,minimapLineHeight:q,minimapCanvasInnerWidth:Y,minimapCanvasInnerHeight:A,minimapCanvasOuterWidth:ie,minimapCanvasOuterHeight:j}}static computeLayout(e,t){const i=t.outerWidth|0,n=t.outerHeight|0,s=t.lineHeight|0,o=t.lineNumbersDigitCount|0,a=t.typicalHalfwidthCharacterWidth,c=t.maxDigitWidth,l=t.pixelRatio,u=t.viewLineCount,d=e.get(137),f=d==="inherit"?e.get(136):d,m=f==="inherit"?e.get(132):f,b=e.get(135),_=t.isDominatedByLongLines,v=e.get(57),k=e.get(68).renderType!==0,D=e.get(69),E=e.get(105),N=e.get(84),A=e.get(73),j=e.get(103),re=j.verticalScrollbarSize,te=j.verticalHasArrows,q=j.arrowSize,We=j.horizontalScrollbarSize,V=e.get(43),B=e.get(110)!=="never";let Q=e.get(66);V&&B&&(Q+=16);let Y=0;if(k){const Dn=Math.max(o,D);Y=Math.round(Dn*c)}let ie=0;v&&(ie=s*t.glyphMarginDecorationLaneCount);let me=0,ge=me+ie,tt=ge+Y,nt=tt+Q;const He=i-ie-Y-Q;let Ot=!1,gt=!1,Zt=-1;f==="inherit"&&_?(Ot=!0,gt=!0):m==="on"||m==="bounded"?gt=!0:m==="wordWrapColumn"&&(Zt=b);const _t=_l._computeMinimapLayout({outerWidth:i,outerHeight:n,lineHeight:s,typicalHalfwidthCharacterWidth:a,pixelRatio:l,scrollBeyondLastLine:E,paddingTop:N.top,paddingBottom:N.bottom,minimap:A,verticalScrollbarWidth:re,viewLineCount:u,remainingWidth:He,isViewportWrapping:gt},t.memory||new f9);_t.renderMinimap!==0&&_t.minimapLeft===0&&(me+=_t.minimapWidth,ge+=_t.minimapWidth,tt+=_t.minimapWidth,nt+=_t.minimapWidth);const _i=He-_t.minimapWidth,rt=Math.max(1,Math.floor((_i-re-2)/a)),kn=te?q:0;return gt&&(Zt=Math.max(1,rt),m==="bounded"&&(Zt=Math.min(Zt,b))),{width:i,height:n,glyphMarginLeft:me,glyphMarginWidth:ie,glyphMarginDecorationLaneCount:t.glyphMarginDecorationLaneCount,lineNumbersLeft:ge,lineNumbersWidth:Y,decorationsLeft:tt,decorationsWidth:Q,contentLeft:nt,contentWidth:_i,minimap:_t,viewportColumn:rt,isWordWrapMinified:Ot,isViewportWrapping:gt,wrappingColumn:Zt,verticalScrollbarWidth:re,horizontalScrollbarHeight:We,overviewRuler:{top:kn,width:re,height:n-2*kn,right:0}}}}class D9 extends Ge{constructor(){super(139,"wrappingStrategy","simple",{"editor.wrappingStrategy":{enumDescriptions:[h(y,47,"Assumes that all characters are of the same width. This is a fast algorithm that works correctly for monospace fonts and certain scripts (like Latin characters) where glyphs are of equal width."),h(y,48,"Delegates wrapping points computation to the browser. This is a slow algorithm, that might cause freezes for large files, but it works correctly in all cases.")],type:"string",enum:["simple","advanced"],default:"simple",description:h(y,49,"Controls the algorithm that computes wrapping points. Note that when in accessibility mode, advanced will be used for the best experience.")}})}validate(e){return at(e,"simple",["simple","advanced"])}compute(e,t,i){return t.get(2)===2?"advanced":i}}var $n;(function(r){r.Off="off",r.OnCode="onCode",r.On="on"})($n||($n={}));class I9 extends Ge{constructor(){const e={enabled:$n.On};super(65,"lightbulb",e,{"editor.lightbulb.enabled":{type:"string",tags:["experimental"],enum:[$n.Off,$n.OnCode,$n.On],default:e.enabled,enumDescriptions:[h(y,50,"Disable the code action menu."),h(y,51,"Show the code action menu when the cursor is on lines with code."),h(y,52,"Show the code action menu when the cursor is on lines with code or on empty lines.")],description:h(y,53,"Enables the Code Action lightbulb in the editor.")}})}validate(e){return!e||typeof e!="object"?this.defaultValue:{enabled:at(e.enabled,this.defaultValue.enabled,[$n.Off,$n.OnCode,$n.On])}}}class P9 extends Ge{constructor(){const e={enabled:!0,maxLineCount:5,defaultModel:"outlineModel",scrollWithEditor:!0};super(115,"stickyScroll",e,{"editor.stickyScroll.enabled":{type:"boolean",default:e.enabled,description:h(y,54,"Shows the nested current scopes during the scroll at the top of the editor."),tags:["experimental"]},"editor.stickyScroll.maxLineCount":{type:"number",default:e.maxLineCount,minimum:1,maximum:20,description:h(y,55,"Defines the maximum number of sticky lines to show.")},"editor.stickyScroll.defaultModel":{type:"string",enum:["outlineModel","foldingProviderModel","indentationModel"],default:e.defaultModel,description:h(y,56,"Defines the model to use for determining which lines to stick. If the outline model does not exist, it will fall back on the folding provider model which falls back on the indentation model. This order is respected in all three cases.")},"editor.stickyScroll.scrollWithEditor":{type:"boolean",default:e.scrollWithEditor,description:h(y,57,"Enable scrolling of Sticky Scroll with the editor's horizontal scrollbar.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Z(t.enabled,this.defaultValue.enabled),maxLineCount:Oe.clampedInt(t.maxLineCount,this.defaultValue.maxLineCount,1,20),defaultModel:at(t.defaultModel,this.defaultValue.defaultModel,["outlineModel","foldingProviderModel","indentationModel"]),scrollWithEditor:Z(t.scrollWithEditor,this.defaultValue.scrollWithEditor)}}}class T9 extends Ge{constructor(){const e={enabled:"on",fontSize:0,fontFamily:"",padding:!1};super(141,"inlayHints",e,{"editor.inlayHints.enabled":{type:"string",default:e.enabled,description:h(y,58,"Enables the inlay hints in the editor."),enum:["on","onUnlessPressed","offUnlessPressed","off"],markdownEnumDescriptions:[h(y,59,"Inlay hints are enabled"),h(y,60,"Inlay hints are showing by default and hide when holding {0}",rn?"Ctrl+Option":"Ctrl+Alt"),h(y,61,"Inlay hints are hidden by default and show when holding {0}",rn?"Ctrl+Option":"Ctrl+Alt"),h(y,62,"Inlay hints are disabled")]},"editor.inlayHints.fontSize":{type:"number",default:e.fontSize,markdownDescription:h(y,63,"Controls font size of inlay hints in the editor. As default the {0} is used when the configured value is less than {1} or greater than the editor font size.","`#editor.fontSize#`","`5`")},"editor.inlayHints.fontFamily":{type:"string",default:e.fontFamily,markdownDescription:h(y,64,"Controls font family of inlay hints in the editor. When set to empty, the {0} is used.","`#editor.fontFamily#`")},"editor.inlayHints.padding":{type:"boolean",default:e.padding,description:h(y,65,"Enables the padding around the inlay hints in the editor.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return typeof t.enabled=="boolean"&&(t.enabled=t.enabled?"on":"off"),{enabled:at(t.enabled,this.defaultValue.enabled,["on","off","offUnlessPressed","onUnlessPressed"]),fontSize:Oe.clampedInt(t.fontSize,this.defaultValue.fontSize,0,100),fontFamily:Ut.string(t.fontFamily,this.defaultValue.fontFamily),padding:Z(t.padding,this.defaultValue.padding)}}}class A9 extends Ge{constructor(){super(66,"lineDecorationsWidth",10)}validate(e){return typeof e=="string"&&/^\d+(\.\d+)?ch$/.test(e)?-parseFloat(e.substring(0,e.length-2)):Oe.clampedInt(e,this.defaultValue,0,1e3)}compute(e,t,i){return i<0?Oe.clampedInt(-i*e.fontInfo.typicalHalfwidthCharacterWidth,this.defaultValue,0,1e3):i}}class R9 extends Yi{constructor(){super(67,"lineHeight",ir.lineHeight,e=>Yi.clamp(e,0,150),{markdownDescription:h(y,66,`Controls the line height. 
 - Use 0 to automatically compute the line height from the font size.
 - Values between 0 and 8 will be used as a multiplier with the font size.
 - Values greater than or equal to 8 will be used as effective values.`)})}compute(e,t,i){return e.fontInfo.lineHeight}}class L9 extends Ge{constructor(){const e={enabled:!0,size:"proportional",side:"right",showSlider:"mouseover",autohide:!1,renderCharacters:!0,maxColumn:120,scale:1,showRegionSectionHeaders:!0,showMarkSectionHeaders:!0,sectionHeaderFontSize:9};super(73,"minimap",e,{"editor.minimap.enabled":{type:"boolean",default:e.enabled,description:h(y,67,"Controls whether the minimap is shown.")},"editor.minimap.autohide":{type:"boolean",default:e.autohide,description:h(y,68,"Controls whether the minimap is hidden automatically.")},"editor.minimap.size":{type:"string",enum:["proportional","fill","fit"],enumDescriptions:[h(y,69,"The minimap has the same size as the editor contents (and might scroll)."),h(y,70,"The minimap will stretch or shrink as necessary to fill the height of the editor (no scrolling)."),h(y,71,"The minimap will shrink as necessary to never be larger than the editor (no scrolling).")],default:e.size,description:h(y,72,"Controls the size of the minimap.")},"editor.minimap.side":{type:"string",enum:["left","right"],default:e.side,description:h(y,73,"Controls the side where to render the minimap.")},"editor.minimap.showSlider":{type:"string",enum:["always","mouseover"],default:e.showSlider,description:h(y,74,"Controls when the minimap slider is shown.")},"editor.minimap.scale":{type:"number",default:e.scale,minimum:1,maximum:3,enum:[1,2,3],description:h(y,75,"Scale of content drawn in the minimap: 1, 2 or 3.")},"editor.minimap.renderCharacters":{type:"boolean",default:e.renderCharacters,description:h(y,76,"Render the actual characters on a line as opposed to color blocks.")},"editor.minimap.maxColumn":{type:"number",default:e.maxColumn,description:h(y,77,"Limit the width of the minimap to render at most a certain number of columns.")},"editor.minimap.showRegionSectionHeaders":{type:"boolean",default:e.showRegionSectionHeaders,description:h(y,78,"Controls whether named regions are shown as section headers in the minimap.")},"editor.minimap.showMarkSectionHeaders":{type:"boolean",default:e.showMarkSectionHeaders,description:h(y,79,"Controls whether MARK: comments are shown as section headers in the minimap.")},"editor.minimap.sectionHeaderFontSize":{type:"number",default:e.sectionHeaderFontSize,description:h(y,80,"Controls the font size of section headers in the minimap.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Z(t.enabled,this.defaultValue.enabled),autohide:Z(t.autohide,this.defaultValue.autohide),size:at(t.size,this.defaultValue.size,["proportional","fill","fit"]),side:at(t.side,this.defaultValue.side,["right","left"]),showSlider:at(t.showSlider,this.defaultValue.showSlider,["always","mouseover"]),renderCharacters:Z(t.renderCharacters,this.defaultValue.renderCharacters),scale:Oe.clampedInt(t.scale,1,1,3),maxColumn:Oe.clampedInt(t.maxColumn,this.defaultValue.maxColumn,1,1e4),showRegionSectionHeaders:Z(t.showRegionSectionHeaders,this.defaultValue.showRegionSectionHeaders),showMarkSectionHeaders:Z(t.showMarkSectionHeaders,this.defaultValue.showMarkSectionHeaders),sectionHeaderFontSize:Yi.clamp(t.sectionHeaderFontSize??this.defaultValue.sectionHeaderFontSize,4,32)}}}function $9(r){return r==="ctrlCmd"?rn?"metaKey":"ctrlKey":"altKey"}class N9 extends Ge{constructor(){super(84,"padding",{top:0,bottom:0},{"editor.padding.top":{type:"number",default:0,minimum:0,maximum:1e3,description:h(y,81,"Controls the amount of space between the top edge of the editor and the first line.")},"editor.padding.bottom":{type:"number",default:0,minimum:0,maximum:1e3,description:h(y,82,"Controls the amount of space between the bottom edge of the editor and the last line.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{top:Oe.clampedInt(t.top,0,0,1e3),bottom:Oe.clampedInt(t.bottom,0,0,1e3)}}}class M9 extends Ge{constructor(){const e={enabled:!0,cycle:!0};super(86,"parameterHints",e,{"editor.parameterHints.enabled":{type:"boolean",default:e.enabled,description:h(y,83,"Enables a pop-up that shows parameter documentation and type information as you type.")},"editor.parameterHints.cycle":{type:"boolean",default:e.cycle,description:h(y,84,"Controls whether the parameter hints menu cycles or closes when reaching the end of the list.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Z(t.enabled,this.defaultValue.enabled),cycle:Z(t.cycle,this.defaultValue.cycle)}}}class F9 extends hd{constructor(){super(143)}compute(e,t,i){return e.pixelRatio}}class O9 extends Ge{constructor(){const e={other:"on",comments:"off",strings:"off"},t=[{type:"boolean"},{type:"string",enum:["on","inline","off"],enumDescriptions:[h(y,85,"Quick suggestions show inside the suggest widget"),h(y,86,"Quick suggestions show as ghost text"),h(y,87,"Quick suggestions are disabled")]}];super(89,"quickSuggestions",e,{type:"object",additionalProperties:!1,properties:{strings:{anyOf:t,default:e.strings,description:h(y,88,"Enable quick suggestions inside strings.")},comments:{anyOf:t,default:e.comments,description:h(y,89,"Enable quick suggestions inside comments.")},other:{anyOf:t,default:e.other,description:h(y,90,"Enable quick suggestions outside of strings and comments.")}},default:e,markdownDescription:h(y,91,"Controls whether suggestions should automatically show up while typing. This can be controlled for typing in comments, strings, and other code. Quick suggestion can be configured to show as ghost text or with the suggest widget. Also be aware of the '{0}'-setting which controls if suggestions are triggered by special characters.","#editor.suggestOnTriggerCharacters#")}),this.defaultValue=e}validate(e){if(typeof e=="boolean"){const l=e?"on":"off";return{comments:l,strings:l,other:l}}if(!e||typeof e!="object")return this.defaultValue;const{other:t,comments:i,strings:n}=e,s=["on","inline","off"];let o,a,c;return typeof t=="boolean"?o=t?"on":"off":o=at(t,this.defaultValue.other,s),typeof i=="boolean"?a=i?"on":"off":a=at(i,this.defaultValue.comments,s),typeof n=="boolean"?c=n?"on":"off":c=at(n,this.defaultValue.strings,s),{other:o,comments:a,strings:c}}}class H9 extends Ge{constructor(){super(68,"lineNumbers",{renderType:1,renderFn:null},{type:"string",enum:["off","on","relative","interval"],enumDescriptions:[h(y,92,"Line numbers are not rendered."),h(y,93,"Line numbers are rendered as absolute number."),h(y,94,"Line numbers are rendered as distance in lines to cursor position."),h(y,95,"Line numbers are rendered every 10 lines.")],default:"on",description:h(y,96,"Controls the display of line numbers.")})}validate(e){let t=this.defaultValue.renderType,i=this.defaultValue.renderFn;return typeof e<"u"&&(typeof e=="function"?(t=4,i=e):e==="interval"?t=3:e==="relative"?t=2:e==="on"?t=1:t=0),{renderType:t,renderFn:i}}}class U9 extends Ge{constructor(){const e=[],t={type:"number",description:h(y,97,"Number of monospace characters at which this editor ruler will render.")};super(102,"rulers",e,{type:"array",items:{anyOf:[t,{type:["object"],properties:{column:t,color:{type:"string",description:h(y,98,"Color of this editor ruler."),format:"color-hex"}}}]},default:e,description:h(y,99,"Render vertical rulers after a certain number of monospace characters. Use multiple values for multiple rulers. No rulers are drawn if array is empty.")})}validate(e){if(Array.isArray(e)){const t=[];for(const i of e)if(typeof i=="number")t.push({column:Oe.clampedInt(i,0,0,1e4),color:null});else if(i&&typeof i=="object"){const n=i;t.push({column:Oe.clampedInt(n.column,0,0,1e4),color:n.color})}return t.sort((i,n)=>i.column-n.column),t}return this.defaultValue}}class B9 extends Ge{constructor(){super(92,"readOnlyMessage",void 0)}validate(e){return!e||typeof e!="object"?this.defaultValue:e}}function f2(r,e){if(typeof r!="string")return e;switch(r){case"hidden":return 2;case"visible":return 3;default:return 1}}class V9 extends Ge{constructor(){const e={vertical:1,horizontal:1,arrowSize:11,useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,horizontalScrollbarSize:12,horizontalSliderSize:12,verticalScrollbarSize:14,verticalSliderSize:14,handleMouseWheel:!0,alwaysConsumeMouseWheel:!0,scrollByPage:!1,ignoreHorizontalScrollbarInContentHeight:!1};super(103,"scrollbar",e,{"editor.scrollbar.vertical":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[h(y,100,"The vertical scrollbar will be visible only when necessary."),h(y,101,"The vertical scrollbar will always be visible."),h(y,102,"The vertical scrollbar will always be hidden.")],default:"auto",description:h(y,103,"Controls the visibility of the vertical scrollbar.")},"editor.scrollbar.horizontal":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[h(y,104,"The horizontal scrollbar will be visible only when necessary."),h(y,105,"The horizontal scrollbar will always be visible."),h(y,106,"The horizontal scrollbar will always be hidden.")],default:"auto",description:h(y,107,"Controls the visibility of the horizontal scrollbar.")},"editor.scrollbar.verticalScrollbarSize":{type:"number",default:e.verticalScrollbarSize,description:h(y,108,"The width of the vertical scrollbar.")},"editor.scrollbar.horizontalScrollbarSize":{type:"number",default:e.horizontalScrollbarSize,description:h(y,109,"The height of the horizontal scrollbar.")},"editor.scrollbar.scrollByPage":{type:"boolean",default:e.scrollByPage,description:h(y,110,"Controls whether clicks scroll by page or jump to click position.")},"editor.scrollbar.ignoreHorizontalScrollbarInContentHeight":{type:"boolean",default:e.ignoreHorizontalScrollbarInContentHeight,description:h(y,111,"When set, the horizontal scrollbar will not increase the size of the editor's content.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e,i=Oe.clampedInt(t.horizontalScrollbarSize,this.defaultValue.horizontalScrollbarSize,0,1e3),n=Oe.clampedInt(t.verticalScrollbarSize,this.defaultValue.verticalScrollbarSize,0,1e3);return{arrowSize:Oe.clampedInt(t.arrowSize,this.defaultValue.arrowSize,0,1e3),vertical:f2(t.vertical,this.defaultValue.vertical),horizontal:f2(t.horizontal,this.defaultValue.horizontal),useShadows:Z(t.useShadows,this.defaultValue.useShadows),verticalHasArrows:Z(t.verticalHasArrows,this.defaultValue.verticalHasArrows),horizontalHasArrows:Z(t.horizontalHasArrows,this.defaultValue.horizontalHasArrows),handleMouseWheel:Z(t.handleMouseWheel,this.defaultValue.handleMouseWheel),alwaysConsumeMouseWheel:Z(t.alwaysConsumeMouseWheel,this.defaultValue.alwaysConsumeMouseWheel),horizontalScrollbarSize:i,horizontalSliderSize:Oe.clampedInt(t.horizontalSliderSize,i,0,1e3),verticalScrollbarSize:n,verticalSliderSize:Oe.clampedInt(t.verticalSliderSize,n,0,1e3),scrollByPage:Z(t.scrollByPage,this.defaultValue.scrollByPage),ignoreHorizontalScrollbarInContentHeight:Z(t.ignoreHorizontalScrollbarInContentHeight,this.defaultValue.ignoreHorizontalScrollbarInContentHeight)}}}const Bi="inUntrustedWorkspace",us={allowedCharacters:"editor.unicodeHighlight.allowedCharacters",invisibleCharacters:"editor.unicodeHighlight.invisibleCharacters",nonBasicASCII:"editor.unicodeHighlight.nonBasicASCII",ambiguousCharacters:"editor.unicodeHighlight.ambiguousCharacters",includeComments:"editor.unicodeHighlight.includeComments",includeStrings:"editor.unicodeHighlight.includeStrings",allowedLocales:"editor.unicodeHighlight.allowedLocales"};class W9 extends Ge{constructor(){const e={nonBasicASCII:Bi,invisibleCharacters:!0,ambiguousCharacters:!0,includeComments:Bi,includeStrings:!0,allowedCharacters:{},allowedLocales:{_os:!0,_vscode:!0}};super(125,"unicodeHighlight",e,{[us.nonBasicASCII]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,Bi],default:e.nonBasicASCII,description:h(y,112,"Controls whether all non-basic ASCII characters are highlighted. Only characters between U+0020 and U+007E, tab, line-feed and carriage-return are considered basic ASCII.")},[us.invisibleCharacters]:{restricted:!0,type:"boolean",default:e.invisibleCharacters,description:h(y,113,"Controls whether characters that just reserve space or have no width at all are highlighted.")},[us.ambiguousCharacters]:{restricted:!0,type:"boolean",default:e.ambiguousCharacters,description:h(y,114,"Controls whether characters are highlighted that can be confused with basic ASCII characters, except those that are common in the current user locale.")},[us.includeComments]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,Bi],default:e.includeComments,description:h(y,115,"Controls whether characters in comments should also be subject to Unicode highlighting.")},[us.includeStrings]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,Bi],default:e.includeStrings,description:h(y,116,"Controls whether characters in strings should also be subject to Unicode highlighting.")},[us.allowedCharacters]:{restricted:!0,type:"object",default:e.allowedCharacters,description:h(y,117,"Defines allowed characters that are not being highlighted."),additionalProperties:{type:"boolean"}},[us.allowedLocales]:{restricted:!0,type:"object",additionalProperties:{type:"boolean"},default:e.allowedLocales,description:h(y,118,"Unicode characters that are common in allowed locales are not being highlighted.")}})}applyUpdate(e,t){let i=!1;t.allowedCharacters&&e&&(tn(e.allowedCharacters,t.allowedCharacters)||(e={...e,allowedCharacters:t.allowedCharacters},i=!0)),t.allowedLocales&&e&&(tn(e.allowedLocales,t.allowedLocales)||(e={...e,allowedLocales:t.allowedLocales},i=!0));const n=super.applyUpdate(e,t);return i?new sh(n.newValue,!0):n}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{nonBasicASCII:wa(t.nonBasicASCII,Bi,[!0,!1,Bi]),invisibleCharacters:Z(t.invisibleCharacters,this.defaultValue.invisibleCharacters),ambiguousCharacters:Z(t.ambiguousCharacters,this.defaultValue.ambiguousCharacters),includeComments:wa(t.includeComments,Bi,[!0,!1,Bi]),includeStrings:wa(t.includeStrings,Bi,[!0,!1,Bi]),allowedCharacters:this.validateBooleanMap(e.allowedCharacters,this.defaultValue.allowedCharacters),allowedLocales:this.validateBooleanMap(e.allowedLocales,this.defaultValue.allowedLocales)}}validateBooleanMap(e,t){if(typeof e!="object"||!e)return t;const i={};for(const[n,s]of Object.entries(e))s===!0&&(i[n]=!0);return i}}class z9 extends Ge{constructor(){const e={enabled:!0,mode:"subwordSmart",showToolbar:"onHover",suppressSuggestions:!1,keepOnBlur:!1,fontFamily:"default"};super(62,"inlineSuggest",e,{"editor.inlineSuggest.enabled":{type:"boolean",default:e.enabled,description:h(y,119,"Controls whether to automatically show inline suggestions in the editor.")},"editor.inlineSuggest.showToolbar":{type:"string",default:e.showToolbar,enum:["always","onHover","never"],enumDescriptions:[h(y,120,"Show the inline suggestion toolbar whenever an inline suggestion is shown."),h(y,121,"Show the inline suggestion toolbar when hovering over an inline suggestion."),h(y,122,"Never show the inline suggestion toolbar.")],description:h(y,123,"Controls when to show the inline suggestion toolbar.")},"editor.inlineSuggest.suppressSuggestions":{type:"boolean",default:e.suppressSuggestions,description:h(y,124,"Controls how inline suggestions interact with the suggest widget. If enabled, the suggest widget is not shown automatically when inline suggestions are available.")},"editor.inlineSuggest.fontFamily":{type:"string",default:e.fontFamily,description:h(y,125,"Controls the font family of the inline suggestions.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Z(t.enabled,this.defaultValue.enabled),mode:at(t.mode,this.defaultValue.mode,["prefix","subword","subwordSmart"]),showToolbar:at(t.showToolbar,this.defaultValue.showToolbar,["always","onHover","never"]),suppressSuggestions:Z(t.suppressSuggestions,this.defaultValue.suppressSuggestions),keepOnBlur:Z(t.keepOnBlur,this.defaultValue.keepOnBlur),fontFamily:Ut.string(t.fontFamily,this.defaultValue.fontFamily)}}}class j9 extends Ge{constructor(){const e={enabled:!1,showToolbar:"onHover",fontFamily:"default",keepOnBlur:!1,backgroundColoring:!1};super(63,"experimentalInlineEdit",e,{"editor.experimentalInlineEdit.enabled":{type:"boolean",default:e.enabled,description:h(y,126,"Controls whether to show inline edits in the editor.")},"editor.experimentalInlineEdit.showToolbar":{type:"string",default:e.showToolbar,enum:["always","onHover","never"],enumDescriptions:[h(y,127,"Show the inline edit toolbar whenever an inline suggestion is shown."),h(y,128,"Show the inline edit toolbar when hovering over an inline suggestion."),h(y,129,"Never show the inline edit toolbar.")],description:h(y,130,"Controls when to show the inline edit toolbar.")},"editor.experimentalInlineEdit.fontFamily":{type:"string",default:e.fontFamily,description:h(y,131,"Controls the font family of the inline edit.")},"editor.experimentalInlineEdit.backgroundColoring":{type:"boolean",default:e.backgroundColoring,description:h(y,132,"Controls whether to color the background of inline edits.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Z(t.enabled,this.defaultValue.enabled),showToolbar:at(t.showToolbar,this.defaultValue.showToolbar,["always","onHover","never"]),fontFamily:Ut.string(t.fontFamily,this.defaultValue.fontFamily),keepOnBlur:Z(t.keepOnBlur,this.defaultValue.keepOnBlur),backgroundColoring:Z(t.backgroundColoring,this.defaultValue.backgroundColoring)}}}class q9 extends Ge{constructor(){const e={enabled:h2.bracketPairColorizationOptions.enabled,independentColorPoolPerBracketType:h2.bracketPairColorizationOptions.independentColorPoolPerBracketType};super(15,"bracketPairColorization",e,{"editor.bracketPairColorization.enabled":{type:"boolean",default:e.enabled,markdownDescription:h(y,133,"Controls whether bracket pair colorization is enabled or not. Use {0} to override the bracket highlight colors.","`#workbench.colorCustomizations#`")},"editor.bracketPairColorization.independentColorPoolPerBracketType":{type:"boolean",default:e.independentColorPoolPerBracketType,description:h(y,134,"Controls whether each bracket type has its own independent color pool.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Z(t.enabled,this.defaultValue.enabled),independentColorPoolPerBracketType:Z(t.independentColorPoolPerBracketType,this.defaultValue.independentColorPoolPerBracketType)}}}class G9 extends Ge{constructor(){const e={bracketPairs:!1,bracketPairsHorizontal:"active",highlightActiveBracketPair:!0,indentation:!0,highlightActiveIndentation:!0};super(16,"guides",e,{"editor.guides.bracketPairs":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[h(y,135,"Enables bracket pair guides."),h(y,136,"Enables bracket pair guides only for the active bracket pair."),h(y,137,"Disables bracket pair guides.")],default:e.bracketPairs,description:h(y,138,"Controls whether bracket pair guides are enabled or not.")},"editor.guides.bracketPairsHorizontal":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[h(y,139,"Enables horizontal guides as addition to vertical bracket pair guides."),h(y,140,"Enables horizontal guides only for the active bracket pair."),h(y,141,"Disables horizontal bracket pair guides.")],default:e.bracketPairsHorizontal,description:h(y,142,"Controls whether horizontal bracket pair guides are enabled or not.")},"editor.guides.highlightActiveBracketPair":{type:"boolean",default:e.highlightActiveBracketPair,description:h(y,143,"Controls whether the editor should highlight the active bracket pair.")},"editor.guides.indentation":{type:"boolean",default:e.indentation,description:h(y,144,"Controls whether the editor should render indent guides.")},"editor.guides.highlightActiveIndentation":{type:["boolean","string"],enum:[!0,"always",!1],enumDescriptions:[h(y,145,"Highlights the active indent guide."),h(y,146,"Highlights the active indent guide even if bracket guides are highlighted."),h(y,147,"Do not highlight the active indent guide.")],default:e.highlightActiveIndentation,description:h(y,148,"Controls whether the editor should highlight the active indent guide.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{bracketPairs:wa(t.bracketPairs,this.defaultValue.bracketPairs,[!0,!1,"active"]),bracketPairsHorizontal:wa(t.bracketPairsHorizontal,this.defaultValue.bracketPairsHorizontal,[!0,!1,"active"]),highlightActiveBracketPair:Z(t.highlightActiveBracketPair,this.defaultValue.highlightActiveBracketPair),indentation:Z(t.indentation,this.defaultValue.indentation),highlightActiveIndentation:wa(t.highlightActiveIndentation,this.defaultValue.highlightActiveIndentation,[!0,!1,"always"])}}}function wa(r,e,t){const i=t.indexOf(r);return i===-1?e:t[i]}class Q9 extends Ge{constructor(){const e={insertMode:"insert",filterGraceful:!0,snippetsPreventQuickSuggestions:!1,localityBonus:!1,shareSuggestSelections:!1,selectionMode:"always",showIcons:!0,showStatusBar:!1,preview:!1,previewMode:"subwordSmart",showInlineDetails:!0,showMethods:!0,showFunctions:!0,showConstructors:!0,showDeprecated:!0,matchOnWordStartOnly:!0,showFields:!0,showVariables:!0,showClasses:!0,showStructs:!0,showInterfaces:!0,showModules:!0,showProperties:!0,showEvents:!0,showOperators:!0,showUnits:!0,showValues:!0,showConstants:!0,showEnums:!0,showEnumMembers:!0,showKeywords:!0,showWords:!0,showColors:!0,showFiles:!0,showReferences:!0,showFolders:!0,showTypeParameters:!0,showSnippets:!0,showUsers:!0,showIssues:!0};super(118,"suggest",e,{"editor.suggest.insertMode":{type:"string",enum:["insert","replace"],enumDescriptions:[h(y,149,"Insert suggestion without overwriting text right of the cursor."),h(y,150,"Insert suggestion and overwrite text right of the cursor.")],default:e.insertMode,description:h(y,151,"Controls whether words are overwritten when accepting completions. Note that this depends on extensions opting into this feature.")},"editor.suggest.filterGraceful":{type:"boolean",default:e.filterGraceful,description:h(y,152,"Controls whether filtering and sorting suggestions accounts for small typos.")},"editor.suggest.localityBonus":{type:"boolean",default:e.localityBonus,description:h(y,153,"Controls whether sorting favors words that appear close to the cursor.")},"editor.suggest.shareSuggestSelections":{type:"boolean",default:e.shareSuggestSelections,markdownDescription:h(y,154,"Controls whether remembered suggestion selections are shared between multiple workspaces and windows (needs `#editor.suggestSelection#`).")},"editor.suggest.selectionMode":{type:"string",enum:["always","never","whenTriggerCharacter","whenQuickSuggestion"],enumDescriptions:[h(y,155,"Always select a suggestion when automatically triggering IntelliSense."),h(y,156,"Never select a suggestion when automatically triggering IntelliSense."),h(y,157,"Select a suggestion only when triggering IntelliSense from a trigger character."),h(y,158,"Select a suggestion only when triggering IntelliSense as you type.")],default:e.selectionMode,markdownDescription:h(y,159,"Controls whether a suggestion is selected when the widget shows. Note that this only applies to automatically triggered suggestions (`#editor.quickSuggestions#` and `#editor.suggestOnTriggerCharacters#`) and that a suggestion is always selected when explicitly invoked, e.g via `Ctrl+Space`.")},"editor.suggest.snippetsPreventQuickSuggestions":{type:"boolean",default:e.snippetsPreventQuickSuggestions,description:h(y,160,"Controls whether an active snippet prevents quick suggestions.")},"editor.suggest.showIcons":{type:"boolean",default:e.showIcons,description:h(y,161,"Controls whether to show or hide icons in suggestions.")},"editor.suggest.showStatusBar":{type:"boolean",default:e.showStatusBar,description:h(y,162,"Controls the visibility of the status bar at the bottom of the suggest widget.")},"editor.suggest.preview":{type:"boolean",default:e.preview,description:h(y,163,"Controls whether to preview the suggestion outcome in the editor.")},"editor.suggest.showInlineDetails":{type:"boolean",default:e.showInlineDetails,description:h(y,164,"Controls whether suggest details show inline with the label or only in the details widget.")},"editor.suggest.maxVisibleSuggestions":{type:"number",deprecationMessage:h(y,165,"This setting is deprecated. The suggest widget can now be resized.")},"editor.suggest.filteredTypes":{type:"object",deprecationMessage:h(y,166,"This setting is deprecated, please use separate settings like 'editor.suggest.showKeywords' or 'editor.suggest.showSnippets' instead.")},"editor.suggest.showMethods":{type:"boolean",default:!0,markdownDescription:h(y,167,"When enabled IntelliSense shows `method`-suggestions.")},"editor.suggest.showFunctions":{type:"boolean",default:!0,markdownDescription:h(y,168,"When enabled IntelliSense shows `function`-suggestions.")},"editor.suggest.showConstructors":{type:"boolean",default:!0,markdownDescription:h(y,169,"When enabled IntelliSense shows `constructor`-suggestions.")},"editor.suggest.showDeprecated":{type:"boolean",default:!0,markdownDescription:h(y,170,"When enabled IntelliSense shows `deprecated`-suggestions.")},"editor.suggest.matchOnWordStartOnly":{type:"boolean",default:!0,markdownDescription:h(y,171,"When enabled IntelliSense filtering requires that the first character matches on a word start. For example, `c` on `Console` or `WebContext` but _not_ on `description`. When disabled IntelliSense will show more results but still sorts them by match quality.")},"editor.suggest.showFields":{type:"boolean",default:!0,markdownDescription:h(y,172,"When enabled IntelliSense shows `field`-suggestions.")},"editor.suggest.showVariables":{type:"boolean",default:!0,markdownDescription:h(y,173,"When enabled IntelliSense shows `variable`-suggestions.")},"editor.suggest.showClasses":{type:"boolean",default:!0,markdownDescription:h(y,174,"When enabled IntelliSense shows `class`-suggestions.")},"editor.suggest.showStructs":{type:"boolean",default:!0,markdownDescription:h(y,175,"When enabled IntelliSense shows `struct`-suggestions.")},"editor.suggest.showInterfaces":{type:"boolean",default:!0,markdownDescription:h(y,176,"When enabled IntelliSense shows `interface`-suggestions.")},"editor.suggest.showModules":{type:"boolean",default:!0,markdownDescription:h(y,177,"When enabled IntelliSense shows `module`-suggestions.")},"editor.suggest.showProperties":{type:"boolean",default:!0,markdownDescription:h(y,178,"When enabled IntelliSense shows `property`-suggestions.")},"editor.suggest.showEvents":{type:"boolean",default:!0,markdownDescription:h(y,179,"When enabled IntelliSense shows `event`-suggestions.")},"editor.suggest.showOperators":{type:"boolean",default:!0,markdownDescription:h(y,180,"When enabled IntelliSense shows `operator`-suggestions.")},"editor.suggest.showUnits":{type:"boolean",default:!0,markdownDescription:h(y,181,"When enabled IntelliSense shows `unit`-suggestions.")},"editor.suggest.showValues":{type:"boolean",default:!0,markdownDescription:h(y,182,"When enabled IntelliSense shows `value`-suggestions.")},"editor.suggest.showConstants":{type:"boolean",default:!0,markdownDescription:h(y,183,"When enabled IntelliSense shows `constant`-suggestions.")},"editor.suggest.showEnums":{type:"boolean",default:!0,markdownDescription:h(y,184,"When enabled IntelliSense shows `enum`-suggestions.")},"editor.suggest.showEnumMembers":{type:"boolean",default:!0,markdownDescription:h(y,185,"When enabled IntelliSense shows `enumMember`-suggestions.")},"editor.suggest.showKeywords":{type:"boolean",default:!0,markdownDescription:h(y,186,"When enabled IntelliSense shows `keyword`-suggestions.")},"editor.suggest.showWords":{type:"boolean",default:!0,markdownDescription:h(y,187,"When enabled IntelliSense shows `text`-suggestions.")},"editor.suggest.showColors":{type:"boolean",default:!0,markdownDescription:h(y,188,"When enabled IntelliSense shows `color`-suggestions.")},"editor.suggest.showFiles":{type:"boolean",default:!0,markdownDescription:h(y,189,"When enabled IntelliSense shows `file`-suggestions.")},"editor.suggest.showReferences":{type:"boolean",default:!0,markdownDescription:h(y,190,"When enabled IntelliSense shows `reference`-suggestions.")},"editor.suggest.showCustomcolors":{type:"boolean",default:!0,markdownDescription:h(y,191,"When enabled IntelliSense shows `customcolor`-suggestions.")},"editor.suggest.showFolders":{type:"boolean",default:!0,markdownDescription:h(y,192,"When enabled IntelliSense shows `folder`-suggestions.")},"editor.suggest.showTypeParameters":{type:"boolean",default:!0,markdownDescription:h(y,193,"When enabled IntelliSense shows `typeParameter`-suggestions.")},"editor.suggest.showSnippets":{type:"boolean",default:!0,markdownDescription:h(y,194,"When enabled IntelliSense shows `snippet`-suggestions.")},"editor.suggest.showUsers":{type:"boolean",default:!0,markdownDescription:h(y,195,"When enabled IntelliSense shows `user`-suggestions.")},"editor.suggest.showIssues":{type:"boolean",default:!0,markdownDescription:h(y,196,"When enabled IntelliSense shows `issues`-suggestions.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{insertMode:at(t.insertMode,this.defaultValue.insertMode,["insert","replace"]),filterGraceful:Z(t.filterGraceful,this.defaultValue.filterGraceful),snippetsPreventQuickSuggestions:Z(t.snippetsPreventQuickSuggestions,this.defaultValue.filterGraceful),localityBonus:Z(t.localityBonus,this.defaultValue.localityBonus),shareSuggestSelections:Z(t.shareSuggestSelections,this.defaultValue.shareSuggestSelections),selectionMode:at(t.selectionMode,this.defaultValue.selectionMode,["always","never","whenQuickSuggestion","whenTriggerCharacter"]),showIcons:Z(t.showIcons,this.defaultValue.showIcons),showStatusBar:Z(t.showStatusBar,this.defaultValue.showStatusBar),preview:Z(t.preview,this.defaultValue.preview),previewMode:at(t.previewMode,this.defaultValue.previewMode,["prefix","subword","subwordSmart"]),showInlineDetails:Z(t.showInlineDetails,this.defaultValue.showInlineDetails),showMethods:Z(t.showMethods,this.defaultValue.showMethods),showFunctions:Z(t.showFunctions,this.defaultValue.showFunctions),showConstructors:Z(t.showConstructors,this.defaultValue.showConstructors),showDeprecated:Z(t.showDeprecated,this.defaultValue.showDeprecated),matchOnWordStartOnly:Z(t.matchOnWordStartOnly,this.defaultValue.matchOnWordStartOnly),showFields:Z(t.showFields,this.defaultValue.showFields),showVariables:Z(t.showVariables,this.defaultValue.showVariables),showClasses:Z(t.showClasses,this.defaultValue.showClasses),showStructs:Z(t.showStructs,this.defaultValue.showStructs),showInterfaces:Z(t.showInterfaces,this.defaultValue.showInterfaces),showModules:Z(t.showModules,this.defaultValue.showModules),showProperties:Z(t.showProperties,this.defaultValue.showProperties),showEvents:Z(t.showEvents,this.defaultValue.showEvents),showOperators:Z(t.showOperators,this.defaultValue.showOperators),showUnits:Z(t.showUnits,this.defaultValue.showUnits),showValues:Z(t.showValues,this.defaultValue.showValues),showConstants:Z(t.showConstants,this.defaultValue.showConstants),showEnums:Z(t.showEnums,this.defaultValue.showEnums),showEnumMembers:Z(t.showEnumMembers,this.defaultValue.showEnumMembers),showKeywords:Z(t.showKeywords,this.defaultValue.showKeywords),showWords:Z(t.showWords,this.defaultValue.showWords),showColors:Z(t.showColors,this.defaultValue.showColors),showFiles:Z(t.showFiles,this.defaultValue.showFiles),showReferences:Z(t.showReferences,this.defaultValue.showReferences),showFolders:Z(t.showFolders,this.defaultValue.showFolders),showTypeParameters:Z(t.showTypeParameters,this.defaultValue.showTypeParameters),showSnippets:Z(t.showSnippets,this.defaultValue.showSnippets),showUsers:Z(t.showUsers,this.defaultValue.showUsers),showIssues:Z(t.showIssues,this.defaultValue.showIssues)}}}class J9 extends Ge{constructor(){super(113,"smartSelect",{selectLeadingAndTrailingWhitespace:!0,selectSubwords:!0},{"editor.smartSelect.selectLeadingAndTrailingWhitespace":{description:h(y,197,"Whether leading and trailing whitespace should always be selected."),default:!0,type:"boolean"},"editor.smartSelect.selectSubwords":{description:h(y,198,"Whether subwords (like 'foo' in 'fooBar' or 'foo_bar') should be selected."),default:!0,type:"boolean"}})}validate(e){return!e||typeof e!="object"?this.defaultValue:{selectLeadingAndTrailingWhitespace:Z(e.selectLeadingAndTrailingWhitespace,this.defaultValue.selectLeadingAndTrailingWhitespace),selectSubwords:Z(e.selectSubwords,this.defaultValue.selectSubwords)}}}class K9 extends Ge{constructor(){const e=[];super(130,"wordSegmenterLocales",e,{anyOf:[{description:h(y,199,"Locales to be used for word segmentation when doing word related navigations or operations. Specify the BCP 47 language tag of the word you wish to recognize (e.g., ja, zh-CN, zh-Hant-TW, etc.)."),type:"string"},{description:h(y,199,"Locales to be used for word segmentation when doing word related navigations or operations. Specify the BCP 47 language tag of the word you wish to recognize (e.g., ja, zh-CN, zh-Hant-TW, etc.)."),type:"array",items:{type:"string"}}]})}validate(e){if(typeof e=="string"&&(e=[e]),Array.isArray(e)){const t=[];for(const i of e)if(typeof i=="string")try{Intl.Segmenter.supportedLocalesOf(i).length>0&&t.push(i)}catch{}return t}return this.defaultValue}}class X9 extends Ge{constructor(){super(138,"wrappingIndent",1,{"editor.wrappingIndent":{type:"string",enum:["none","same","indent","deepIndent"],enumDescriptions:[h(y,200,"No indentation. Wrapped lines begin at column 1."),h(y,201,"Wrapped lines get the same indentation as the parent."),h(y,202,"Wrapped lines get +1 indentation toward the parent."),h(y,203,"Wrapped lines get +2 indentation toward the parent.")],description:h(y,204,"Controls the indentation of wrapped lines."),default:"same"}})}validate(e){switch(e){case"none":return 0;case"same":return 1;case"indent":return 2;case"deepIndent":return 3}return 1}compute(e,t,i){return t.get(2)===2?0:i}}class Z9 extends hd{constructor(){super(146)}compute(e,t,i){const n=t.get(145);return{isDominatedByLongLines:e.isDominatedByLongLines,isWordWrapMinified:n.isWordWrapMinified,isViewportWrapping:n.isViewportWrapping,wrappingColumn:n.wrappingColumn}}}class Y9 extends Ge{constructor(){const e={enabled:!0,showDropSelector:"afterDrop"};super(36,"dropIntoEditor",e,{"editor.dropIntoEditor.enabled":{type:"boolean",default:e.enabled,markdownDescription:h(y,205,"Controls whether you can drag and drop a file into a text editor by holding down the `Shift` key (instead of opening the file in an editor).")},"editor.dropIntoEditor.showDropSelector":{type:"string",markdownDescription:h(y,206,"Controls if a widget is shown when dropping files into the editor. This widget lets you control how the file is dropped."),enum:["afterDrop","never"],enumDescriptions:[h(y,207,"Show the drop selector widget after a file is dropped into the editor."),h(y,208,"Never show the drop selector widget. Instead the default drop provider is always used.")],default:"afterDrop"}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Z(t.enabled,this.defaultValue.enabled),showDropSelector:at(t.showDropSelector,this.defaultValue.showDropSelector,["afterDrop","never"])}}}class eP extends Ge{constructor(){const e={enabled:!0,showPasteSelector:"afterPaste"};super(85,"pasteAs",e,{"editor.pasteAs.enabled":{type:"boolean",default:e.enabled,markdownDescription:h(y,209,"Controls whether you can paste content in different ways.")},"editor.pasteAs.showPasteSelector":{type:"string",markdownDescription:h(y,210,"Controls if a widget is shown when pasting content in to the editor. This widget lets you control how the file is pasted."),enum:["afterPaste","never"],enumDescriptions:[h(y,211,"Show the paste selector widget after content is pasted into the editor."),h(y,212,"Never show the paste selector widget. Instead the default pasting behavior is always used.")],default:"afterPaste"}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Z(t.enabled,this.defaultValue.enabled),showPasteSelector:at(t.showPasteSelector,this.defaultValue.showPasteSelector,["afterPaste","never"])}}}const tP="Consolas, 'Courier New', monospace",iP="Menlo, Monaco, 'Courier New', monospace",nP="'Droid Sans Mono', 'monospace', monospace",ir={fontFamily:rn?iP:Qr?nP:tP,fontWeight:"normal",fontSize:rn?12:14,lineHeight:0,letterSpacing:0},rP=[];function $(r){return rP[r.id]=r,r}$(new we(0,"acceptSuggestionOnCommitCharacter",!0,{markdownDescription:h(y,213,"Controls whether suggestions should be accepted on commit characters. For example, in JavaScript, the semi-colon (`;`) can be a commit character that accepts a suggestion and types that character.")})),$(new Ye(1,"acceptSuggestionOnEnter","on",["on","smart","off"],{markdownEnumDescriptions:["",h(y,214,"Only accept a suggestion with `Enter` when it makes a textual change."),""],markdownDescription:h(y,215,"Controls whether suggestions should be accepted on `Enter`, in addition to `Tab`. Helps to avoid ambiguity between inserting new lines or accepting suggestions.")})),$(new m9),$(new Oe(3,"accessibilityPageSize",10,1,1073741824,{description:h(y,216,"Controls the number of lines in the editor that can be read out by a screen reader at once. When we detect a screen reader we automatically set the default to be 500. Warning: this has a performance implication for numbers larger than the default."),tags:["accessibility"]})),$(new Ut(4,"ariaLabel",h(y,217,"Editor content"))),$(new we(5,"ariaRequired",!1,void 0)),$(new we(8,"screenReaderAnnounceInlineSuggestion",!0,{description:h(y,218,"Control whether inline suggestions are announced by a screen reader."),tags:["accessibility"]})),$(new Ye(6,"autoClosingBrackets","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",h(y,219,"Use language configurations to determine when to autoclose brackets."),h(y,220,"Autoclose brackets only when the cursor is to the left of whitespace."),""],description:h(y,221,"Controls whether the editor should automatically close brackets after the user adds an opening bracket.")})),$(new Ye(7,"autoClosingComments","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",h(y,222,"Use language configurations to determine when to autoclose comments."),h(y,223,"Autoclose comments only when the cursor is to the left of whitespace."),""],description:h(y,224,"Controls whether the editor should automatically close comments after the user adds an opening comment.")})),$(new Ye(9,"autoClosingDelete","auto",["always","auto","never"],{enumDescriptions:["",h(y,225,"Remove adjacent closing quotes or brackets only if they were automatically inserted."),""],description:h(y,226,"Controls whether the editor should remove adjacent closing quotes or brackets when deleting.")})),$(new Ye(10,"autoClosingOvertype","auto",["always","auto","never"],{enumDescriptions:["",h(y,227,"Type over closing quotes or brackets only if they were automatically inserted."),""],description:h(y,228,"Controls whether the editor should type over closing quotes or brackets.")})),$(new Ye(11,"autoClosingQuotes","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",h(y,229,"Use language configurations to determine when to autoclose quotes."),h(y,230,"Autoclose quotes only when the cursor is to the left of whitespace."),""],description:h(y,231,"Controls whether the editor should automatically close quotes after the user adds an opening quote.")})),$(new Ld(12,"autoIndent",4,"full",["none","keep","brackets","advanced","full"],g9,{enumDescriptions:[h(y,232,"The editor will not insert indentation automatically."),h(y,233,"The editor will keep the current line's indentation."),h(y,234,"The editor will keep the current line's indentation and honor language defined brackets."),h(y,235,"The editor will keep the current line's indentation, honor language defined brackets and invoke special onEnterRules defined by languages."),h(y,236,"The editor will keep the current line's indentation, honor language defined brackets, invoke special onEnterRules defined by languages, and honor indentationRules defined by languages.")],description:h(y,237,"Controls whether the editor should automatically adjust the indentation when users type, paste, move or indent lines.")})),$(new we(13,"automaticLayout",!1)),$(new Ye(14,"autoSurround","languageDefined",["languageDefined","quotes","brackets","never"],{enumDescriptions:[h(y,238,"Use language configurations to determine when to automatically surround selections."),h(y,239,"Surround with quotes but not brackets."),h(y,240,"Surround with brackets but not quotes."),""],description:h(y,241,"Controls whether the editor should automatically surround selections when typing quotes or brackets.")})),$(new q9),$(new G9),$(new we(116,"stickyTabStops",!1,{description:h(y,242,"Emulate selection behavior of tab characters when using spaces for indentation. Selection will stick to tab stops.")})),$(new we(17,"codeLens",!0,{description:h(y,243,"Controls whether the editor shows CodeLens.")})),$(new Ut(18,"codeLensFontFamily","",{description:h(y,244,"Controls the font family for CodeLens.")})),$(new Oe(19,"codeLensFontSize",0,0,100,{type:"number",default:0,minimum:0,maximum:100,markdownDescription:h(y,245,"Controls the font size in pixels for CodeLens. When set to 0, 90% of `#editor.fontSize#` is used.")})),$(new we(20,"colorDecorators",!0,{description:h(y,246,"Controls whether the editor should render the inline color decorators and color picker.")})),$(new Ye(148,"colorDecoratorsActivatedOn","clickAndHover",["clickAndHover","hover","click"],{enumDescriptions:[h(y,247,"Make the color picker appear both on click and hover of the color decorator"),h(y,248,"Make the color picker appear on hover of the color decorator"),h(y,249,"Make the color picker appear on click of the color decorator")],description:h(y,250,"Controls the condition to make a color picker appear from a color decorator")})),$(new Oe(21,"colorDecoratorsLimit",500,1,1e6,{markdownDescription:h(y,251,"Controls the max number of color decorators that can be rendered in an editor at once.")})),$(new we(22,"columnSelection",!1,{description:h(y,252,"Enable that the selection with the mouse and keys is doing column selection.")})),$(new v9),$(new we(24,"contextmenu",!0)),$(new we(25,"copyWithSyntaxHighlighting",!0,{description:h(y,253,"Controls whether syntax highlighting should be copied into the clipboard.")})),$(new Ld(26,"cursorBlinking",1,"blink",["blink","smooth","phase","expand","solid"],_9,{description:h(y,254,"Control the cursor animation style.")})),$(new Ye(27,"cursorSmoothCaretAnimation","off",["off","explicit","on"],{enumDescriptions:[h(y,255,"Smooth caret animation is disabled."),h(y,256,"Smooth caret animation is enabled only when the user moves the cursor with an explicit gesture."),h(y,257,"Smooth caret animation is always enabled.")],description:h(y,258,"Controls whether the smooth caret animation should be enabled.")})),$(new Ld(28,"cursorStyle",vn.Line,"line",["line","block","underline","line-thin","block-outline","underline-thin"],w9,{description:h(y,259,"Controls the cursor style.")})),$(new Oe(29,"cursorSurroundingLines",0,0,1073741824,{description:h(y,260,"Controls the minimal number of visible leading lines (minimum 0) and trailing lines (minimum 1) surrounding the cursor. Known as 'scrollOff' or 'scrollOffset' in some other editors.")})),$(new Ye(30,"cursorSurroundingLinesStyle","default",["default","all"],{enumDescriptions:[h(y,261,"`cursorSurroundingLines` is enforced only when triggered via the keyboard or API."),h(y,262,"`cursorSurroundingLines` is enforced always.")],markdownDescription:h(y,263,"Controls when `#editor.cursorSurroundingLines#` should be enforced.")})),$(new Oe(31,"cursorWidth",0,0,1073741824,{markdownDescription:h(y,264,"Controls the width of the cursor when `#editor.cursorStyle#` is set to `line`.")})),$(new we(32,"disableLayerHinting",!1)),$(new we(33,"disableMonospaceOptimizations",!1)),$(new we(34,"domReadOnly",!1)),$(new we(35,"dragAndDrop",!0,{description:h(y,265,"Controls whether the editor should allow moving selections via drag and drop.")})),$(new y9),$(new Y9),$(new P9),$(new Ye(38,"experimentalWhitespaceRendering","svg",["svg","font","off"],{enumDescriptions:[h(y,266,"Use a new rendering method with svgs."),h(y,267,"Use a new rendering method with font characters."),h(y,268,"Use the stable rendering method.")],description:h(y,269,"Controls whether whitespace is rendered with a new, experimental method.")})),$(new Ut(39,"extraEditorClassName","")),$(new Yi(40,"fastScrollSensitivity",5,r=>r<=0?5:r,{markdownDescription:h(y,270,"Scrolling speed multiplier when pressing `Alt`.")})),$(new x9),$(new we(42,"fixedOverflowWidgets",!1)),$(new we(43,"folding",!0,{description:h(y,271,"Controls whether the editor has code folding enabled.")})),$(new Ye(44,"foldingStrategy","auto",["auto","indentation"],{enumDescriptions:[h(y,272,"Use a language-specific folding strategy if available, else the indentation-based one."),h(y,273,"Use the indentation-based folding strategy.")],description:h(y,274,"Controls the strategy for computing folding ranges.")})),$(new we(45,"foldingHighlight",!0,{description:h(y,275,"Controls whether the editor should highlight folded ranges.")})),$(new we(46,"foldingImportsByDefault",!1,{description:h(y,276,"Controls whether the editor automatically collapses import ranges.")})),$(new Oe(47,"foldingMaximumRegions",5e3,10,65e3,{description:h(y,277,"The maximum number of foldable regions. Increasing this value may result in the editor becoming less responsive when the current source has a large number of foldable regions.")})),$(new we(48,"unfoldOnClickAfterEndOfLine",!1,{description:h(y,278,"Controls whether clicking on the empty content after a folded line will unfold the line.")})),$(new Ut(49,"fontFamily",ir.fontFamily,{description:h(y,279,"Controls the font family.")})),$(new C9),$(new C_),$(new S9),$(new E_),$(new S_),$(new we(55,"formatOnPaste",!1,{description:h(y,280,"Controls whether the editor should automatically format the pasted content. A formatter must be available and the formatter should be able to format a range in a document.")})),$(new we(56,"formatOnType",!1,{description:h(y,281,"Controls whether the editor should automatically format the line after typing.")})),$(new we(57,"glyphMargin",!0,{description:h(y,282,"Controls whether the editor should render the vertical glyph margin. Glyph margin is mostly used for debugging.")})),$(new E9),$(new we(59,"hideCursorInOverviewRuler",!1,{description:h(y,283,"Controls whether the cursor should be hidden in the overview ruler.")})),$(new k9),$(new we(61,"inDiffEditor",!1)),$(new Yi(64,"letterSpacing",ir.letterSpacing,r=>Yi.clamp(r,-5,20),{description:h(y,284,"Controls the letter spacing in pixels.")})),$(new I9),$(new A9),$(new R9),$(new H9),$(new Oe(69,"lineNumbersMinChars",5,1,300)),$(new we(70,"linkedEditing",!1,{description:h(y,285,"Controls whether the editor has linked editing enabled. Depending on the language, related symbols such as HTML tags, are updated while editing.")})),$(new we(71,"links",!0,{description:h(y,286,"Controls whether the editor should detect links and make them clickable.")})),$(new Ye(72,"matchBrackets","always",["always","near","never"],{description:h(y,287,"Highlight matching brackets.")})),$(new L9),$(new Ye(74,"mouseStyle","text",["text","default","copy"])),$(new Yi(75,"mouseWheelScrollSensitivity",1,r=>r===0?1:r,{markdownDescription:h(y,288,"A multiplier to be used on the `deltaX` and `deltaY` of mouse wheel scroll events.")})),$(new we(76,"mouseWheelZoom",!1,{markdownDescription:rn?h(y,289,"Zoom the font of the editor when using mouse wheel and holding `Cmd`."):h(y,290,"Zoom the font of the editor when using mouse wheel and holding `Ctrl`.")})),$(new we(77,"multiCursorMergeOverlapping",!0,{description:h(y,291,"Merge multiple cursors when they are overlapping.")})),$(new Ld(78,"multiCursorModifier","altKey","alt",["ctrlCmd","alt"],$9,{markdownEnumDescriptions:[h(y,292,"Maps to `Control` on Windows and Linux and to `Command` on macOS."),h(y,293,"Maps to `Alt` on Windows and Linux and to `Option` on macOS.")],markdownDescription:h(y,294,"The modifier to be used to add multiple cursors with the mouse. The Go to Definition and Open Link mouse gestures will adapt such that they do not conflict with the [multicursor modifier](https://code.visualstudio.com/docs/editor/codebasics#_multicursor-modifier).")})),$(new Ye(79,"multiCursorPaste","spread",["spread","full"],{markdownEnumDescriptions:[h(y,295,"Each cursor pastes a single line of the text."),h(y,296,"Each cursor pastes the full text.")],markdownDescription:h(y,297,"Controls pasting when the line count of the pasted text matches the cursor count.")})),$(new Oe(80,"multiCursorLimit",1e4,1,1e5,{markdownDescription:h(y,298,"Controls the max number of cursors that can be in an active editor at once.")})),$(new Ye(81,"occurrencesHighlight","singleFile",["off","singleFile","multiFile"],{markdownEnumDescriptions:[h(y,299,"Does not highlight occurrences."),h(y,300,"Highlights occurrences only in the current file."),h(y,301,"Experimental: Highlights occurrences across all valid open files.")],markdownDescription:h(y,302,"Controls whether occurrences should be highlighted across open files.")})),$(new we(82,"overviewRulerBorder",!0,{description:h(y,303,"Controls whether a border should be drawn around the overview ruler.")})),$(new Oe(83,"overviewRulerLanes",3,0,3)),$(new N9),$(new eP),$(new M9),$(new Ye(87,"peekWidgetDefaultFocus","tree",["tree","editor"],{enumDescriptions:[h(y,304,"Focus the tree when opening peek"),h(y,305,"Focus the editor when opening peek")],description:h(y,306,"Controls whether to focus the inline editor or the tree in the peek widget.")})),$(new we(88,"definitionLinkOpensInPeek",!1,{description:h(y,307,"Controls whether the Go to Definition mouse gesture always opens the peek widget.")})),$(new O9),$(new Oe(90,"quickSuggestionsDelay",10,0,1073741824,{description:h(y,308,"Controls the delay in milliseconds after which quick suggestions will show up.")})),$(new we(91,"readOnly",!1)),$(new B9),$(new we(93,"renameOnType",!1,{description:h(y,309,"Controls whether the editor auto renames on type."),markdownDeprecationMessage:h(y,310,"Deprecated, use `editor.linkedEditing` instead.")})),$(new we(94,"renderControlCharacters",!0,{description:h(y,311,"Controls whether the editor should render control characters."),restricted:!0})),$(new Ye(95,"renderFinalNewline",Qr?"dimmed":"on",["off","on","dimmed"],{description:h(y,312,"Render last line number when the file ends with a newline.")})),$(new Ye(96,"renderLineHighlight","line",["none","gutter","line","all"],{enumDescriptions:["","","",h(y,313,"Highlights both the gutter and the current line.")],description:h(y,314,"Controls how the editor should render the current line highlight.")})),$(new we(97,"renderLineHighlightOnlyWhenFocus",!1,{description:h(y,315,"Controls if the editor should render the current line highlight only when the editor is focused.")})),$(new Ye(98,"renderValidationDecorations","editable",["editable","on","off"])),$(new Ye(99,"renderWhitespace","selection",["none","boundary","selection","trailing","all"],{enumDescriptions:["",h(y,316,"Render whitespace characters except for single spaces between words."),h(y,317,"Render whitespace characters only on selected text."),h(y,318,"Render only trailing whitespace characters."),""],description:h(y,319,"Controls how the editor should render whitespace characters.")})),$(new Oe(100,"revealHorizontalRightPadding",15,0,1e3)),$(new we(101,"roundedSelection",!0,{description:h(y,320,"Controls whether selections should have rounded corners.")})),$(new U9),$(new V9),$(new Oe(104,"scrollBeyondLastColumn",4,0,1073741824,{description:h(y,321,"Controls the number of extra characters beyond which the editor will scroll horizontally.")})),$(new we(105,"scrollBeyondLastLine",!0,{description:h(y,322,"Controls whether the editor will scroll beyond the last line.")})),$(new we(106,"scrollPredominantAxis",!0,{description:h(y,323,"Scroll only along the predominant axis when scrolling both vertically and horizontally at the same time. Prevents horizontal drift when scrolling vertically on a trackpad.")})),$(new we(107,"selectionClipboard",!0,{description:h(y,324,"Controls whether the Linux primary clipboard should be supported."),included:Qr})),$(new we(108,"selectionHighlight",!0,{description:h(y,325,"Controls whether the editor should highlight matches similar to the selection.")})),$(new we(109,"selectOnLineNumbers",!0)),$(new Ye(110,"showFoldingControls","mouseover",["always","never","mouseover"],{enumDescriptions:[h(y,326,"Always show the folding controls."),h(y,327,"Never show the folding controls and reduce the gutter size."),h(y,328,"Only show the folding controls when the mouse is over the gutter.")],description:h(y,329,"Controls when the folding controls on the gutter are shown.")})),$(new we(111,"showUnused",!0,{description:h(y,330,"Controls fading out of unused code.")})),$(new we(140,"showDeprecated",!0,{description:h(y,331,"Controls strikethrough deprecated variables.")})),$(new T9),$(new Ye(112,"snippetSuggestions","inline",["top","bottom","inline","none"],{enumDescriptions:[h(y,332,"Show snippet suggestions on top of other suggestions."),h(y,333,"Show snippet suggestions below other suggestions."),h(y,334,"Show snippets suggestions with other suggestions."),h(y,335,"Do not show snippet suggestions.")],description:h(y,336,"Controls whether snippets are shown with other suggestions and how they are sorted.")})),$(new J9),$(new we(114,"smoothScrolling",!1,{description:h(y,337,"Controls whether the editor will scroll using an animation.")})),$(new Oe(117,"stopRenderingLineAfter",1e4,-1,1073741824)),$(new Q9),$(new z9),$(new j9),$(new we(149,"inlineCompletionsAccessibilityVerbose",!1,{description:h(y,338,"Controls whether the accessibility hint should be provided to screen reader users when an inline completion is shown.")})),$(new Oe(119,"suggestFontSize",0,0,1e3,{markdownDescription:h(y,339,"Font size for the suggest widget. When set to {0}, the value of {1} is used.","`0`","`#editor.fontSize#`")})),$(new Oe(120,"suggestLineHeight",0,0,1e3,{markdownDescription:h(y,340,"Line height for the suggest widget. When set to {0}, the value of {1} is used. The minimum value is 8.","`0`","`#editor.lineHeight#`")})),$(new we(121,"suggestOnTriggerCharacters",!0,{description:h(y,341,"Controls whether suggestions should automatically show up when typing trigger characters.")})),$(new Ye(122,"suggestSelection","first",["first","recentlyUsed","recentlyUsedByPrefix"],{markdownEnumDescriptions:[h(y,342,"Always select the first suggestion."),h(y,343,"Select recent suggestions unless further typing selects one, e.g. `console.| -> console.log` because `log` has been completed recently."),h(y,344,"Select suggestions based on previous prefixes that have completed those suggestions, e.g. `co -> console` and `con -> const`.")],description:h(y,345,"Controls how suggestions are pre-selected when showing the suggest list.")})),$(new Ye(123,"tabCompletion","off",["on","off","onlySnippets"],{enumDescriptions:[h(y,346,"Tab complete will insert the best matching suggestion when pressing tab."),h(y,347,"Disable tab completions."),h(y,348,"Tab complete snippets when their prefix match. Works best when 'quickSuggestions' aren't enabled.")],description:h(y,349,"Enables tab completions.")})),$(new Oe(124,"tabIndex",0,-1,1073741824)),$(new W9),$(new Ye(126,"unusualLineTerminators","prompt",["auto","off","prompt"],{enumDescriptions:[h(y,350,"Unusual line terminators are automatically removed."),h(y,351,"Unusual line terminators are ignored."),h(y,352,"Unusual line terminators prompt to be removed.")],description:h(y,353,"Remove unusual line terminators that might cause problems.")})),$(new we(127,"useShadowDOM",!0)),$(new we(128,"useTabStops",!0,{description:h(y,354,"Spaces and tabs are inserted and deleted in alignment with tab stops.")})),$(new Ye(129,"wordBreak","normal",["normal","keepAll"],{markdownEnumDescriptions:[h(y,355,"Use the default line break rule."),h(y,356,"Word breaks should not be used for Chinese/Japanese/Korean (CJK) text. Non-CJK text behavior is the same as for normal.")],description:h(y,357,"Controls the word break rules used for Chinese/Japanese/Korean (CJK) text.")})),$(new K9),$(new Ut(131,"wordSeparators",hS,{description:h(y,358,"Characters that will be used as word separators when doing word related navigations or operations.")})),$(new Ye(132,"wordWrap","off",["off","on","wordWrapColumn","bounded"],{markdownEnumDescriptions:[h(y,359,"Lines will never wrap."),h(y,360,"Lines will wrap at the viewport width."),h(y,361,"Lines will wrap at `#editor.wordWrapColumn#`."),h(y,362,"Lines will wrap at the minimum of viewport and `#editor.wordWrapColumn#`.")],description:h(y,363,"Controls how lines should wrap.")})),$(new Ut(133,"wordWrapBreakAfterCharacters"," 	})]?|/&.,;¢°′″‰℃、。｡､￠，．：；？！％・･ゝゞヽヾーァィゥェォッャュョヮヵヶぁぃぅぇぉっゃゅょゎゕゖㇰㇱㇲㇳㇴㇵㇶㇷㇸㇹㇺㇻㇼㇽㇾㇿ々〻ｧｨｩｪｫｬｭｮｯｰ”〉》」』】〕）］｝｣")),$(new Ut(134,"wordWrapBreakBeforeCharacters","([{‘“〈《「『【〔（［｛｢£¥＄￡￥+＋")),$(new Oe(135,"wordWrapColumn",80,1,1073741824,{markdownDescription:h(y,364,"Controls the wrapping column of the editor when `#editor.wordWrap#` is `wordWrapColumn` or `bounded`.")})),$(new Ye(136,"wordWrapOverride1","inherit",["off","on","inherit"])),$(new Ye(137,"wordWrapOverride2","inherit",["off","on","inherit"])),$(new b9),$(new we(147,"defaultColorDecorators",!1,{markdownDescription:h(y,365,"Controls whether inline color decorations should be shown using the default document color provider")})),$(new F9),$(new we(144,"tabFocusMode",!1,{markdownDescription:h(y,366,"Controls whether the editor receives tabs or defers them to the workbench for navigation.")})),$(new _l),$(new Z9),$(new X9),$(new D9);function SS(r,e,t,i,n,s){if(Array.isArray(r)){let o=0;for(const a of r){const c=SS(a,e,t,i,n,s);if(c===10)return c;c>o&&(o=c)}return o}else{if(typeof r=="string")return r==="*"?5:r===t?10:0;if(r){const{language:o,pattern:a,scheme:c,hasAccessToAllModels:l,notebookType:u}=r;u&&n&&(e=n);let d=0;if(c)if(c===e.scheme)d=10;else if(c==="*")d=5;else return 0;if(o)if(o===t)d=10;else if(o==="*")d=Math.max(d,5);else return 0;if(u)if(u===s)d=10;else if(u==="*"&&s!==void 0)d=Math.max(d,5);else return 0;if(a){let f;if(typeof a=="string"?f=a:f={...a,base:Ma(a.base)},f===e.fsPath||ll(f,e.fsPath))d=10;else return 0}return d}else return 0}}function ES(r){return typeof r=="string"?!1:Array.isArray(r)?r.some(ES):!!r.notebookType}var k_;(function(r){r[r.None=0]="None",r[r.Indent=1]="Indent",r[r.IndentOutdent=2]="IndentOutdent",r[r.Outdent=3]="Outdent"})(k_||(k_={}));var D_;(function(r){r[r.Complete=100]="Complete",r[r.Partial=50]="Partial",r[r.None=0]="None"})(D_||(D_={}));class sP{constructor(e){this._relatedInformationProviders=new Map,this._nextHandle=0,this._proxy=e.getProxy(J.MainThreadAiRelatedInformation)}async $provideAiRelatedInformation(e,t,i){if(this._relatedInformationProviders.size===0)throw new Error("No related information providers registered");const n=this._relatedInformationProviders.get(e);if(!n)throw new Error("related information provider not found");return await n.provideRelatedInformation(t,i)??[]}getRelatedInformation(e,t,i){return this._proxy.$getAiRelatedInformation(t,i)}registerRelatedInformationProvider(e,t,i){const n=this._nextHandle;return this._nextHandle++,this._relatedInformationProviders.set(n,i),this._proxy.$registerAiRelatedInformationProvider(n,t),new Ne(()=>{this._proxy.$unregisterAiRelatedInformationProvider(n),this._relatedInformationProviders.delete(n)})}}function kS(r){for(let e=0,t=r.length;e<t;e+=4){const i=r[e+0],n=r[e+1],s=r[e+2],o=r[e+3];r[e+0]=o,r[e+1]=s,r[e+2]=n,r[e+3]=i}}function oP(r){const e=new Uint8Array(r.buffer,r.byteOffset,r.length*4);return wx()||kS(e),_e.wrap(e)}function aP(r){const e=r.buffer;if(wx()||kS(e),e.byteOffset%4===0)return new Uint32Array(e.buffer,e.byteOffset,e.length/4);{const t=new Uint8Array(e.byteLength);return t.set(e),new Uint32Array(t.buffer,t.byteOffset,t.length/4)}}function I_(r){const e=new Uint32Array(cP(r));let t=0;if(e[t++]=r.id,r.type==="full")e[t++]=1,e[t++]=r.data.length,e.set(r.data,t),t+=r.data.length;else{e[t++]=2,e[t++]=r.deltas.length;for(const i of r.deltas)e[t++]=i.start,e[t++]=i.deleteCount,i.data?(e[t++]=i.data.length,e.set(i.data,t),t+=i.data.length):e[t++]=0}return oP(e)}function cP(r){let e=0;if(e+=2,r.type==="full")e+=1+r.data.length;else{e+=1,e+=3*r.deltas.length;for(const t of r.deltas)t.data&&(e+=t.data.length)}return e}function p2(r){const e=aP(r);let t=0;const i=e[t++];if(e[t++]===1){const a=e[t++],c=e.subarray(t,t+a);return t+=a,{id:i,type:"full",data:c}}const s=e[t++],o=[];for(let a=0;a<s;a++){const c=e[t++],l=e[t++],u=e[t++];let d;u>0&&(d=e.subarray(t,t+u),t+=u),o[a]={start:c,deleteCount:l,data:d}}return{id:i,type:"delta",deltas:o}}const lP=[new be("vscode.executeDocumentHighlights","_executeDocumentHighlights","Execute document highlight provider.",[z.Uri,z.Position],new ve("A promise that resolves to an array of DocumentHighlight-instances.",Pn(ic.to))),new be("vscode.executeDocumentSymbolProvider","_executeDocumentSymbolProvider","Execute document symbol provider.",[z.Uri],new ve("A promise that resolves to an array of SymbolInformation and DocumentSymbol instances.",(r,e)=>{if(pw(r))return;class t extends Wl{static to(n){const s=new t(n.name,Oi.to(n.kind),n.containerName||"",new Pi(e[0],H.to(n.range)));return s.detail=n.detail,s.range=s.location.range,s.selectionRange=H.to(n.selectionRange),s.children=n.children?n.children.map(t.to):[],s}}return r.map(t.to)})),new be("vscode.executeFormatDocumentProvider","_executeFormatDocumentProvider","Execute document format provider.",[z.Uri,new z("options","Formatting options",r=>!0,r=>r)],new ve("A promise that resolves to an array of TextEdits.",Pn(yt.to))),new be("vscode.executeFormatRangeProvider","_executeFormatRangeProvider","Execute range format provider.",[z.Uri,z.Range,new z("options","Formatting options",r=>!0,r=>r)],new ve("A promise that resolves to an array of TextEdits.",Pn(yt.to))),new be("vscode.executeFormatOnTypeProvider","_executeFormatOnTypeProvider","Execute format on type provider.",[z.Uri,z.Position,new z("ch","Trigger character",r=>typeof r=="string",r=>r),new z("options","Formatting options",r=>!0,r=>r)],new ve("A promise that resolves to an array of TextEdits.",Pn(yt.to))),new be("vscode.executeDefinitionProvider","_executeDefinitionProvider","Execute all definition providers.",[z.Uri,z.Position],new ve("A promise that resolves to an array of Location or LocationLink instances.",$d)),new be("vscode.executeTypeDefinitionProvider","_executeTypeDefinitionProvider","Execute all type definition providers.",[z.Uri,z.Position],new ve("A promise that resolves to an array of Location or LocationLink instances.",$d)),new be("vscode.executeDeclarationProvider","_executeDeclarationProvider","Execute all declaration providers.",[z.Uri,z.Position],new ve("A promise that resolves to an array of Location or LocationLink instances.",$d)),new be("vscode.executeImplementationProvider","_executeImplementationProvider","Execute all implementation providers.",[z.Uri,z.Position],new ve("A promise that resolves to an array of Location or LocationLink instances.",$d)),new be("vscode.executeReferenceProvider","_executeReferenceProvider","Execute all reference providers.",[z.Uri,z.Position],new ve("A promise that resolves to an array of Location-instances.",Pn(Ai.to))),new be("vscode.executeHoverProvider","_executeHoverProvider","Execute all hover providers.",[z.Uri,z.Position],new ve("A promise that resolves to an array of Hover-instances.",Pn(If.to))),new be("vscode.executeSelectionRangeProvider","_executeSelectionRangeProvider","Execute selection range provider.",[z.Uri,new z("position","A position in a text document",r=>Array.isArray(r)&&r.every(e=>ke.isPosition(e)),r=>r.map(qe.from))],new ve("A promise that resolves to an array of ranges.",r=>r.map(e=>{let t;for(const i of e.reverse())t=new ql(H.to(i),t);return t}))),new be("vscode.executeWorkspaceSymbolProvider","_executeWorkspaceSymbolProvider","Execute all workspace symbol providers.",[z.String.with("query","Search string")],new ve("A promise that resolves to an array of SymbolInformation-instances.",r=>r.map(gu.to))),new be("vscode.prepareCallHierarchy","_executePrepareCallHierarchy","Prepare call hierarchy at a position inside a document",[z.Uri,z.Position],new ve("A promise that resolves to an array of CallHierarchyItem-instances",r=>r.map(_o.to))),new be("vscode.provideIncomingCalls","_executeProvideIncomingCalls","Compute incoming calls for an item",[z.CallHierarchyItem],new ve("A promise that resolves to an array of CallHierarchyIncomingCall-instances",r=>r.map(Z1.to))),new be("vscode.provideOutgoingCalls","_executeProvideOutgoingCalls","Compute outgoing calls for an item",[z.CallHierarchyItem],new ve("A promise that resolves to an array of CallHierarchyOutgoingCall-instances",r=>r.map(Y1.to))),new be("vscode.prepareRename","_executePrepareRename","Execute the prepareRename of rename provider.",[z.Uri,z.Position],new ve("A promise that resolves to a range and placeholder text.",r=>{if(r)return{range:H.to(r.range),placeholder:r.text}})),new be("vscode.executeDocumentRenameProvider","_executeDocumentRenameProvider","Execute rename provider.",[z.Uri,z.Position,z.String.with("newName","The new symbol name")],new ve("A promise that resolves to a WorkspaceEdit.",r=>{if(r){if(r.rejectReason)throw new Error(r.rejectReason);return Wt.to(r)}})),new be("vscode.executeLinkProvider","_executeLinkProvider","Execute document link provider.",[z.Uri,z.Number.with("linkResolveCount","Number of links that should be resolved, only when links are unresolved.").optional()],new ve("A promise that resolves to an array of DocumentLink-instances.",r=>r.map(oo.to))),new be("vscode.provideDocumentSemanticTokensLegend","_provideDocumentSemanticTokensLegend","Provide semantic tokens legend for a document",[z.Uri],new ve("A promise that resolves to SemanticTokensLegend.",r=>{if(r)return new R1(r.tokenTypes,r.tokenModifiers)})),new be("vscode.provideDocumentSemanticTokens","_provideDocumentSemanticTokens","Provide semantic tokens for a document",[z.Uri],new ve("A promise that resolves to SemanticTokens.",r=>{if(!r)return;const e=p2(r);if(e.type==="full")return new Ka(e.data,void 0)})),new be("vscode.provideDocumentRangeSemanticTokensLegend","_provideDocumentRangeSemanticTokensLegend","Provide semantic tokens legend for a document range",[z.Uri,z.Range.optional()],new ve("A promise that resolves to SemanticTokensLegend.",r=>{if(r)return new R1(r.tokenTypes,r.tokenModifiers)})),new be("vscode.provideDocumentRangeSemanticTokens","_provideDocumentRangeSemanticTokens","Provide semantic tokens for a document range",[z.Uri,z.Range],new ve("A promise that resolves to SemanticTokens.",r=>{if(!r)return;const e=p2(r);if(e.type==="full")return new Ka(e.data,void 0)})),new be("vscode.executeCompletionItemProvider","_executeCompletionItemProvider","Execute completion item provider.",[z.Uri,z.Position,z.String.with("triggerCharacter","Trigger completion when the user types the character, like `,` or `(`").optional(),z.Number.with("itemResolveCount","Number of completions to resolve (too large numbers slow down completions)").optional()],new ve("A promise that resolves to a CompletionList-instance.",(r,e,t)=>{if(!r)return new Wa([]);const i=r.suggestions.map(n=>rv.to(n,t));return new Wa(i,r.incomplete)})),new be("vscode.executeSignatureHelpProvider","_executeSignatureHelpProvider","Execute signature help provider.",[z.Uri,z.Position,z.String.with("triggerCharacter","Trigger signature help when the user types the character, like `,` or `(`").optional()],new ve("A promise that resolves to SignatureHelp.",r=>{if(r)return vu.to(r)})),new be("vscode.executeCodeLensProvider","_executeCodeLensProvider","Execute code lens provider.",[z.Uri,z.Number.with("itemResolveCount","Number of lenses that should be resolved and returned. Will only return resolved lenses, will impact performance)").optional()],new ve("A promise that resolves to an array of CodeLens-instances.",(r,e,t)=>Pn(i=>new zh(H.to(i.range),i.command&&t.fromInternal(i.command)))(r))),new be("vscode.executeCodeActionProvider","_executeCodeActionProvider","Execute code action provider.",[z.Uri,new z("rangeOrSelection","Range in a text document. Some refactoring provider requires Selection object.",r=>xe.isRange(r),r=>sr.isSelection(r)?Fi.from(r):H.from(r)),z.String.with("kind","Code action kind to return code actions for").optional(),z.Number.with("itemResolveCount","Number of code actions to resolve (too large numbers slow down code actions)").optional()],new ve("A promise that resolves to an array of Command-instances.",(r,e,t)=>Pn(i=>{if(i._isSynthetic){if(!i.command)throw new Error("Synthetic code actions must have a command");return t.fromInternal(i.command)}else{const n=new Wh(i.title,i.kind?new ct(i.kind):void 0);return i.edit&&(n.edit=Wt.to(i.edit)),i.command&&(n.command=t.fromInternal(i.command)),n.isPreferred=i.isPreferred,n}})(r))),new be("vscode.executeDocumentColorProvider","_executeDocumentColorProvider","Execute document color provider.",[z.Uri],new ve("A promise that resolves to an array of ColorInformation objects.",r=>r?r.map(e=>new Kh(H.to(e.range),nc.to(e.color))):[])),new be("vscode.executeColorPresentationProvider","_executeColorPresentationProvider","Execute color presentation provider.",[new z("color","The color to show and insert",r=>r instanceof qa,nc.from),new z("context","Context object with uri and range",r=>!0,r=>({uri:r.uri,range:H.from(r.range)}))],new ve("A promise that resolves to an array of ColorPresentation objects.",r=>r?r.map(Mf.to):[])),new be("vscode.executeInlayHintProvider","_executeInlayHintProvider","Execute inlay hints provider",[z.Uri,z.Range],new ve("A promise that resolves to an array of Inlay objects",(r,e,t)=>r.map(sv.to.bind(void 0,t)))),new be("vscode.executeFoldingRangeProvider","_executeFoldingRangeProvider","Execute folding range provider",[z.Uri],new ve("A promise that resolves to an array of FoldingRange objects",(r,e)=>{if(r)return r.map(Of.to)})),new be("vscode.resolveNotebookContentProviders","_resolveNotebookContentProvider","Resolve Notebook Content Providers",[],new ve("A promise that resolves to an array of NotebookContentProvider static info objects.",Pn(r=>({viewType:r.viewType,displayName:r.displayName,options:{transientOutputs:r.options.transientOutputs,transientCellMetadata:r.options.transientCellMetadata,transientDocumentMetadata:r.options.transientDocumentMetadata},filenamePattern:r.filenamePattern.map(e=>Bf.to(e))})))),new be("vscode.executeInlineValueProvider","_executeInlineValueProvider","Execute inline value provider",[z.Uri,z.Range,new z("context","An InlineValueContext",r=>r&&typeof r.frameId=="number"&&r.stoppedLocation instanceof xe,r=>Tf.from(r))],new ve("A promise that resolves to an array of InlineValue objects",r=>r.map(Pf.to))),new be("vscode.open","_workbench.open","Opens the provided resource in the editor. Can be a text or binary file, or an http(s) URL. If you need more control over the options for opening a text file, use vscode.window.showTextDocument instead.",[new z("uriOrString","Uri-instance or string (only http/https)",r=>x.isUri(r)||typeof r=="string"&&LE(r,ne.http,ne.https),r=>r),new z("columnOrOptions","Either the column in which to open or editor options, see vscode.TextDocumentShowOptions",r=>r===void 0||typeof r=="number"||typeof r=="object",r=>r&&(typeof r=="number"?[Et.from(r),void 0]:[Et.from(r.viewColumn),dl.from(r)])).optional(),z.String.with("label","").optional()],ve.Void),new be("vscode.openWith","_workbench.openWith","Opens the provided resource with a specific editor.",[z.Uri.with("resource","Resource to open"),z.String.with("viewId","Custom editor view id. This should be the viewType string for custom editors or the notebookType string for notebooks. Use 'default' to use VS Code's default text editor"),new z("columnOrOptions","Either the column in which to open or editor options, see vscode.TextDocumentShowOptions",r=>r===void 0||typeof r=="number"||typeof r=="object",r=>r&&(typeof r=="number"?[Et.from(r),void 0]:[Et.from(r.viewColumn),dl.from(r)])).optional()],ve.Void),new be("vscode.diff","_workbench.diff","Opens the provided resources in the diff editor to compare their contents.",[z.Uri.with("left","Left-hand side resource of the diff editor"),z.Uri.with("right","Right-hand side resource of the diff editor"),z.String.with("title","Human readable title for the diff editor").optional(),new z("columnOrOptions","Either the column in which to open or editor options, see vscode.TextDocumentShowOptions",r=>r===void 0||typeof r=="object",r=>r&&[Et.from(r.viewColumn),dl.from(r)]).optional()],ve.Void),new be("vscode.changes","_workbench.changes","Opens a list of resources in the changes editor to compare their contents.",[z.String.with("title","Human readable title for the changes editor"),new z("resourceList","List of resources to compare",r=>{for(const e of r){if(e.length!==3)return!1;const[t,i,n]=e;if(!x.isUri(t)||!x.isUri(i)&&i!==void 0&&i!==null||!x.isUri(n)&&n!==void 0&&n!==null)return!1}return!0},r=>r)],ve.Void),new be("vscode.prepareTypeHierarchy","_executePrepareTypeHierarchy","Prepare type hierarchy at a position inside a document",[z.Uri,z.Position],new ve("A promise that resolves to an array of TypeHierarchyItem-instances",r=>r.map(ao.to))),new be("vscode.provideSupertypes","_executeProvideSupertypes","Compute supertypes for an item",[z.TypeHierarchyItem],new ve("A promise that resolves to an array of TypeHierarchyItem-instances",r=>r.map(ao.to))),new be("vscode.provideSubtypes","_executeProvideSubtypes","Compute subtypes for an item",[z.TypeHierarchyItem],new ve("A promise that resolves to an array of TypeHierarchyItem-instances",r=>r.map(ao.to))),new be("vscode.revealTestInExplorer","_revealTestInExplorer","Reveals a test instance in the explorer",[z.TestItem],ve.Void),new be("vscode.experimental.editSession.continue","_workbench.editSessions.actions.continueEditSession","Continue the current edit session in a different workspace",[z.Uri.with("workspaceUri","The target workspace to continue the current edit session in")],ve.Void),new be("setContext","_setContext","Set a custom context key value that can be used in when clauses.",[z.String.with("name","The context key name"),new z("value","The context key value",()=>!0,r=>r)],ve.Void),new be("vscode.executeMappedEditsProvider","_executeMappedEditsProvider","Execute Mapped Edits Provider",[z.Uri,z.StringArray,new z("MappedEditsContext","Mapped Edits Context",r=>Uf.is(r),r=>Uf.from(r))],new ve("A promise that resolves to a workspace edit or null",r=>r?Wt.to(r):null))];class uP{static register(e){lP.forEach(e.registerApiCommand,e),this._registerValidateWhenClausesCommand(e)}static _registerValidateWhenClausesCommand(e){e.registerCommand(!1,"_validateWhenClauses",hD)}}function Pn(r){return e=>{if(Array.isArray(e))return e.map(r)}}function $d(r){if(!Array.isArray(r))return;const e=[];for(const t of r)x5(t)?e.push(mu.to(t)):e.push(Ai.to(t));return e}let P_=class{constructor(e,t){this._proxy=e.getProxy(J.MainThreadBulkEdits),this._versionInformationProvider={getTextDocumentVersion:i=>{var n;return(n=t.getDocument(i))==null?void 0:n.version},getNotebookDocumentVersion:()=>{}}}applyWorkspaceEdit(e,t,i){const n=new Di(Wt.from(e,this._versionInformationProvider));return this._proxy.$tryApplyWorkspaceEdit(n,void 0,(i==null?void 0:i.isRefactoring)??!1)}};P_=U([M(0,Ve)],P_);var up;(function(r){r[r.Down=0]="Down",r[r.Up=1]="Up"})(up||(up={}));var g2;(function(r){r[r.Action=1]="Action",r[r.Toolbar=2]="Toolbar"})(g2||(g2={}));class dP{constructor(e,t,i,n,s){this._extension=e,this._request=t,this._proxy=i,this._commandsConverter=n,this._sessionDisposables=s,this._stopWatch=rr.create(!1),this._isClosed=!1}close(){this._isClosed=!0}get timings(){return{firstProgress:this._firstProgress,totalElapsed:this._stopWatch.elapsed()}}get apiObject(){if(!this._apiObject){let t=function(n){if(e._isClosed){const s=new Error("Response stream has been closed");throw Error.captureStackTrace(s,n),s}};const e=this;this._stopWatch.reset();const i=n=>{typeof this._firstProgress>"u"&&"content"in n&&(this._firstProgress=this._stopWatch.elapsed()),this._proxy.$handleProgressChunk(this._request.requestId,n)};this._apiObject={markdown(n){t(this.markdown);const s=new rg(n),o=yu.from(s);return i(o),this},markdownWithVulnerabilities(n,s){t(this.markdown),s&&O(e._extension,"chatParticipantAdditions");const o=new du(n,s),a=Gf.from(o);return i(a),this},filetree(n,s){t(this.filetree);const o=new sg(n,s),a=xu.from(o);return i(a),this},anchor(n,s){t(this.anchor);const o=new og(n,s),a=Cu.from(o);return i(a),this},button(n){t(this.anchor);const s=new ag(n),o=Su.from(s,e._commandsConverter,e._sessionDisposables);return i(o),this},progress(n){t(this.progress);const s=new Za(n),o=lc.from(s);return i(o),this},reference(n,s){var o;if(t(this.reference),"variableName"in n&&!n.value){const a=e._request.variables.variables.find(c=>c.name===n.variableName);if(a){let c;if((o=a.references)!=null&&o.length)c=a.references.map(l=>({kind:"reference",reference:{variableName:n.variableName,value:l.reference}}));else{const l=new Wr(n,s);c=[ts.from(l)]}return c.forEach(l=>i(l)),this}}else{const a=new Wr(n,s),c=ts.from(a);i(c)}return this},textEdit(n,s){t(this.textEdit),O(e._extension,"chatParticipantAdditions");const o=new fu(n,s),a=Jf.from(o);return i(a),this},detectedParticipant(n,s){t(this.detectedParticipant),O(e._extension,"chatParticipantAdditions");const o=new hu(n,s),a=Qf.from(o);return i(a),this},push(n){if(t(this.push),(n instanceof fu||n instanceof du||n instanceof hu)&&O(e._extension,"chatParticipantAdditions"),n instanceof Wr)this.reference(n.value,n.iconPath);else{const s=Kf.from(n,e._commandsConverter,e._sessionDisposables);i(s)}return this}}}return this._apiObject}}const kl=class kl extends Fe{constructor(e,t,i){super(),this._logService=t,this.commands=i,this._agents=new Map,this._sessionDisposables=this._register(new fx),this._completionDisposables=this._register(new Te),this._proxy=e.getProxy(J.MainThreadChatAgents2)}transferActiveChat(e){this._proxy.$transferActiveChatSession(e)}createChatAgent(e,t,i){const n=kl._idPool++,s=new m2(e,t,this._proxy,n,i);return this._agents.set(n,s),this._proxy.$registerAgent(n,e.identifier,t,{},void 0),s.apiAgent}createDynamicChatAgent(e,t,i,n,s){const o=kl._idPool++,a=new m2(e,t,this._proxy,o,s);return this._agents.set(o,a),this._proxy.$registerAgent(o,e.identifier,t,{isSticky:!0},{name:i,description:n}),a.apiAgent}async $invokeAgent(e,t,i,n){const s=this._agents.get(e);if(!s)throw new Error(`[CHAT](${e}) CANNOT invoke agent because the agent is not registered`);let o=this._sessionDisposables.get(t.sessionId);o||(o=new Te,this._sessionDisposables.set(t.sessionId,o));const a=new dP(s.extension,t,this._proxy,this.commands.converter,o);try{const c=await this.prepareHistoryTurns(t.agentId,i),l=s.invoke(_v.to(t),{history:c},a.apiObject,n);return await Fm(Promise.resolve(l).then(u=>{if(u!=null&&u.metadata)try{JSON.stringify(u.metadata)}catch(d){const f=`result.metadata MUST be JSON.stringify-able. Got error: ${d.message}`;return this._logService.error(`[${s.extension.identifier.value}] [@${s.id}] ${f}`,s.extension),{errorDetails:{message:f},timings:a.timings}}return{errorDetails:u==null?void 0:u.errorDetails,timings:a.timings,metadata:u==null?void 0:u.metadata}}),n)}catch(c){return this._logService.error(c,s.extension),{errorDetails:{message:Sc(c),responseIsIncomplete:!0}}}finally{a.close()}}async prepareHistoryTurns(e,t){const i=[];for(const n of t.history){const s=va.to(n.result),o=e===n.request.agentId?s:{...s,metadata:void 0};i.push(new UC(n.request.message,n.request.command,n.request.variables.variables.map(Xf.to),n.request.agentId));const a=ci(n.response.map(c=>Kf.toContent(c,this.commands.converter)));i.push(new BC(a,o,n.request.agentId,n.request.command))}return i}$releaseSession(e){this._sessionDisposables.deleteAndDispose(e)}async $provideFollowups(e,t,i,n,s){const o=this._agents.get(t);if(!o)return Promise.resolve([]);const a=await this.prepareHistoryTurns(o.id,n),c=va.to(i);return(await o.provideFollowups(c,{history:a},s)).filter(l=>{const u=!l.participant||nr.some(this._agents.values(),d=>d.id===l.participant&&Xe.equals(d.extension.identifier,o.extension.identifier));return u||this._logService.warn(`[@${o.id}] ChatFollowup refers to an unknown participant: ${l.participant}`),u}).map(l=>bu.from(l,e))}$acceptFeedback(e,t,i,n){const s=this._agents.get(e);if(!s)return;const o=va.to(t);let a;switch(i){case up.Down:a=uu.Unhelpful;break;case up.Up:a=uu.Helpful;break}s.acceptFeedback(Object.freeze(n?{result:o,kind:a,reportIssue:n}:{result:o,kind:a}))}$acceptAction(e,t,i){const n=this._agents.get(e);if(!n||i.action.kind==="vote")return;const s=bv.to(t,i,this.commands.converter);s&&n.acceptAction(Object.freeze(s))}async $invokeCompletionProvider(e,t,i){const n=this._agents.get(e);return n?(await n.invokeCompletionProvider(t,i)).map(o=>wv.from(o,this.commands.converter,this._completionDisposables)):[]}async $provideWelcomeMessage(e,t,i){const n=this._agents.get(e);if(n)return await n.provideWelcomeMessage(Eu.to(t),i)}async $provideSampleQuestions(e,t,i){const n=this._agents.get(e);if(n)return(await n.provideSampleQuestions(Eu.to(t),i)).map(s=>bu.from(s,void 0))}};kl._idPool=0;let T_=kl;class m2{constructor(e,t,i,n,s){this.extension=e,this.id=t,this._proxy=i,this._handle=n,this._requestHandler=s,this._onDidReceiveFeedback=new R,this._onDidPerformAction=new R}acceptFeedback(e){this._onDidReceiveFeedback.fire(e)}acceptAction(e){this._onDidPerformAction.fire(e)}async invokeCompletionProvider(e,t){return this._agentVariableProvider?await this._agentVariableProvider.provider.provideCompletionItems(e,t)??[]:[]}async provideFollowups(e,t,i){if(!this._followupProvider)return[];const n=await this._followupProvider.provideFollowups(e,t,i);return n?n.filter(s=>!(s&&"commandId"in s)).filter(s=>!(s&&"message"in s)):[]}async provideWelcomeMessage(e,t){if(!this._welcomeMessageProvider)return[];const i=await this._welcomeMessageProvider.provideWelcomeMessage(e,t);return i?i.map(n=>typeof n=="string"?n:Le.from(n)):[]}async provideSampleQuestions(e,t){if(!this._welcomeMessageProvider||!this._welcomeMessageProvider.provideSampleQuestions)return[];const i=await this._welcomeMessageProvider.provideSampleQuestions(e,t);return i||[]}get apiAgent(){let e=!1,t=!1;const i=()=>{e||t||(t=!0,queueMicrotask(()=>{this._proxy.$updateAgent(this._handle,{fullName:this._fullName,icon:this._iconPath?this._iconPath instanceof x?this._iconPath:"light"in this._iconPath?this._iconPath.light:void 0:void 0,iconDark:this._iconPath&&"dark"in this._iconPath?this._iconPath.dark:void 0,themeIcon:this._iconPath instanceof Kt?this._iconPath:void 0,hasFollowups:this._followupProvider!==void 0,isSecondary:this._isSecondary,helpTextPrefix:!this._helpTextPrefix||typeof this._helpTextPrefix=="string"?this._helpTextPrefix:Le.from(this._helpTextPrefix),helpTextVariablesPrefix:!this._helpTextVariablesPrefix||typeof this._helpTextVariablesPrefix=="string"?this._helpTextVariablesPrefix:Le.from(this._helpTextVariablesPrefix),helpTextPostfix:!this._helpTextPostfix||typeof this._helpTextPostfix=="string"?this._helpTextPostfix:Le.from(this._helpTextPostfix),sampleRequest:this._sampleRequest,supportIssueReporting:this._supportIssueReporting,requester:this._requester}),t=!1}))},n=this;return{get id(){return n.id},get fullName(){return O(n.extension,"defaultChatParticipant"),n._fullName??n.extension.displayName??n.extension.name},set fullName(s){O(n.extension,"defaultChatParticipant"),n._fullName=s,i()},get iconPath(){return n._iconPath},set iconPath(s){n._iconPath=s,i()},get requestHandler(){return n._requestHandler},set requestHandler(s){$x(typeof s=="function","Invalid request handler"),n._requestHandler=s},get followupProvider(){return n._followupProvider},set followupProvider(s){n._followupProvider=s,i()},get isDefault(){return O(n.extension,"defaultChatParticipant"),n._isDefault},set isDefault(s){O(n.extension,"defaultChatParticipant"),n._isDefault=s,i()},get helpTextPrefix(){return O(n.extension,"defaultChatParticipant"),n._helpTextPrefix},set helpTextPrefix(s){O(n.extension,"defaultChatParticipant"),n._helpTextPrefix=s,i()},get helpTextVariablesPrefix(){return O(n.extension,"defaultChatParticipant"),n._helpTextVariablesPrefix},set helpTextVariablesPrefix(s){O(n.extension,"defaultChatParticipant"),n._helpTextVariablesPrefix=s,i()},get helpTextPostfix(){return O(n.extension,"defaultChatParticipant"),n._helpTextPostfix},set helpTextPostfix(s){O(n.extension,"defaultChatParticipant"),n._helpTextPostfix=s,i()},get isSecondary(){return O(n.extension,"defaultChatParticipant"),n._isSecondary},set isSecondary(s){O(n.extension,"defaultChatParticipant"),n._isSecondary=s,i()},get sampleRequest(){return n._sampleRequest},set sampleRequest(s){n._sampleRequest=s,i()},get supportIssueReporting(){return O(n.extension,"chatParticipantAdditions"),n._supportIssueReporting},set supportIssueReporting(s){O(n.extension,"chatParticipantAdditions"),n._supportIssueReporting=s,i()},get onDidReceiveFeedback(){return n._onDidReceiveFeedback.event},set participantVariableProvider(s){if(O(n.extension,"chatParticipantAdditions"),n._agentVariableProvider=s,s){if(!s.triggerCharacters.length)throw new Error("triggerCharacters are required");n._proxy.$registerAgentCompletionsProvider(n._handle,s.triggerCharacters)}else n._proxy.$unregisterAgentCompletionsProvider(n._handle)},get participantVariableProvider(){return O(n.extension,"chatParticipantAdditions"),n._agentVariableProvider},set welcomeMessageProvider(s){O(n.extension,"defaultChatParticipant"),n._welcomeMessageProvider=s,i()},get welcomeMessageProvider(){return O(n.extension,"defaultChatParticipant"),n._welcomeMessageProvider},onDidPerformAction:Lt(this.extension,"chatParticipantAdditions")?this._onDidPerformAction.event:void 0,set requester(s){n._requester=s,i()},get requester(){return n._requester},dispose(){e=!0,n._followupProvider=void 0,n._onDidReceiveFeedback.dispose(),n._proxy.$unregisterAgent(n._handle)}}}invoke(e,t,i,n){return this._requestHandler(e,t,i,n)}}const Ap=class Ap{constructor(e){this._resolver=new Map,this._proxy=e.getProxy(J.MainThreadChatVariables)}async $resolveVariable(e,t,i,n){const s=this._resolver.get(e);if(s)try{if(s.resolver.resolve2){O(s.extension,"chatParticipantAdditions");const o=new hP(t,this._proxy),a=await s.resolver.resolve2(s.data.name,{prompt:i},o.apiObject,n);if(a)return a.map(cc.from)}else{const o=await s.resolver.resolve(s.data.name,{prompt:i},n);if(o)return o.map(cc.from)}}catch(o){hw(o)}}registerVariableResolver(e,t,i,n){const s=Ap._idPool++;return this._resolver.set(s,{extension:e,data:{name:t,description:i},resolver:n}),this._proxy.$registerVariable(s,{name:t,description:i}),De(()=>{this._resolver.delete(s),this._proxy.$unregisterVariable(s)})}};Ap._idPool=0;let A_=Ap;class hP{constructor(e,t){this._requestId=e,this._proxy=t,this._isClosed=!1}close(){this._isClosed=!0}get apiObject(){if(!this._apiObject){let t=function(n){if(e._isClosed){const s=new Error("Response stream has been closed");throw Error.captureStackTrace(s,n),s}};const e=this,i=n=>{this._proxy.$handleProgressChunk(this._requestId,n)};this._apiObject={progress(n){t(this.progress);const s=new Za(n),o=lc.from(s);return i(o),this},reference(n){t(this.reference);const s=new Wr(n),o=ts.from(s);return i(o),this},push(n){return t(this.push),n instanceof Wr?i(ts.from(n)):n instanceof Za&&i(lc.from(n)),this}}}return this._apiObject}}class fP{constructor(e){const t=e.getProxy(J.MainThreadClipboard);this.value=Object.freeze({readText(){return t.$readText()},writeText(i){return t.$writeText(i)}})}}const DS="vscode-cdn.net",pP=`vscode-resource.${DS}`,R_=`'self' https://*.${DS}`;function wl(r,e){return r.scheme===ne.http||r.scheme===ne.https?r:(e&&e.authority&&e.isRemote&&r.scheme===ne.file&&(r=x.from({scheme:ne.vscodeRemote,authority:e.authority,path:r.path})),x.from({scheme:ne.https,authority:`${r.scheme}+${gP(r.authority)}.${pP}`,path:r.path,fragment:r.fragment,query:r.query}))}function gP(r){return r.replace(/./g,e=>{const t=e.charCodeAt(0);return t>=97&&t<=122||t>=65&&t<=90||t>=48&&t<=57?e:"-"+t.toString(16).padStart(4,"0")})}class mP{constructor(e,t,i){this._proxy=e,this._editors=t,this._remoteInfo=i,this._handlePool=0,this._disposables=new Te,this._insets=new Map,this._disposables.add(t.onDidChangeVisibleTextEditors(()=>{const n=t.getVisibleTextEditors();for(const s of this._insets.values())n.indexOf(s.editor)<0&&s.inset.dispose()}))}dispose(){this._insets.forEach(e=>e.inset.dispose()),this._disposables.dispose()}createWebviewEditorInset(e,t,i,n,s){let o;for(const m of this._editors.getVisibleTextEditors(!0))if(m.value===e){o=m;break}if(!o)throw new Error("not a visible editor");const a=this,c=this._handlePool++,l=new R,u=new R,d=new class{constructor(){this._html="",this._options=Object.create(null)}asWebviewUri(m){return wl(m,a._remoteInfo)}get cspSource(){return R_}set options(m){this._options=m,a._proxy.$setOptions(c,m)}get options(){return this._options}set html(m){this._html=m,a._proxy.$setHtml(c,m)}get html(){return this._html}get onDidReceiveMessage(){return l.event}postMessage(m){return a._proxy.$postMessage(c,m)}},f=new class{constructor(){this.editor=e,this.line=t,this.height=i,this.webview=d,this.onDidDispose=u.event}dispose(){a._insets.has(c)&&(a._insets.delete(c),a._proxy.$disposeEditorInset(c),u.fire(),u.dispose(),l.dispose())}};return this._proxy.$createEditorInset(c,o.id,o.value.document.uri,t+1,i,n||{},s.identifier,s.extensionLocation),this._insets.set(c,{editor:e,inset:f,onDidReceiveMessage:l}),f}$onDidDispose(e){const t=this._insets.get(e);t&&t.inset.dispose()}$onDidReceiveMessage(e,t){const i=this._insets.get(e);i==null||i.onDidReceiveMessage.fire(t)}}function vP(r,e,t){const i=r.getProxy(J.MainThreadComments),m=class m{constructor(){this._commentControllers=new Map,this._commentControllersByExtension=new Kr,e.registerArgumentProcessor({processArgument:v=>{if(v&&v.$mid===6){const k=this._commentControllers.get(v.handle);return k?k.value:v}else if(v&&v.$mid===7){const k=v,D=this._commentControllers.get(k.commentControlHandle);if(!D)return k;const E=D.getCommentThread(k.commentThreadHandle);return E?E.value:k}else if(v&&(v.$mid===9||v.$mid===8)){const k=this._commentControllers.get(v.thread.commentControlHandle);if(!k)return v;const D=k.getCommentThread(v.thread.commentThreadHandle);return D?v.$mid===8?D.value:{thread:D.value,text:v.text}:v}else if(v&&v.$mid===10){const k=this._commentControllers.get(v.thread.commentControlHandle);if(!k)return v;const D=k.getCommentThread(v.thread.commentThreadHandle);if(!D)return v;const E=v.commentUniqueId,N=D.getCommentByUniqueId(E);return N||v}else if(v&&v.$mid===11){const k=this._commentControllers.get(v.thread.commentControlHandle);if(!k)return v;const D=k.getCommentThread(v.thread.commentThreadHandle);if(!D)return v;const E=v.text,N=v.commentUniqueId,A=D.getCommentByUniqueId(N);return A?(typeof A.body=="string"?A.body=E:A.body=new Ti(E),A):v}return v}})}createCommentController(v,k,D){const E=m.handlePool++,N=new o(v,E,k,D);this._commentControllers.set(N.handle,N);const A=this._commentControllersByExtension.get(v.identifier)||[];return A.push(N),this._commentControllersByExtension.set(v.identifier,A),N.value}async $createCommentThreadTemplate(v,k,D){const E=this._commentControllers.get(v);E&&E.$createCommentThreadTemplate(k,D)}async $setActiveComment(v,k){const D=this._commentControllers.get(v);D&&D.$setActiveComment(k??void 0)}async $updateCommentThreadTemplate(v,k,D){const E=this._commentControllers.get(v);E&&E.$updateCommentThreadTemplate(k,D)}$deleteCommentThread(v,k){const D=this._commentControllers.get(v);D==null||D.$deleteCommentThread(k)}async $provideCommentingRanges(v,k,D){const E=this._commentControllers.get(v);if(!E||!E.commentingRangeProvider)return Promise.resolve(void 0);const N=await t.ensureDocumentData(x.revive(k));return Bt(async()=>{const A=await E.commentingRangeProvider.provideCommentingRanges(N.document,D);let j;return Array.isArray(A)?j={ranges:A,fileComments:!1}:A?j={ranges:A.ranges||[],fileComments:A.fileComments||!1}:j=A??void 0,j}).then(A=>{let j;return A&&(j={ranges:A.ranges.map(re=>H.from(re)),fileComments:A.fileComments}),j})}$toggleReaction(v,k,D,E,N){const A=this._commentControllers.get(v);return!A||!A.reactionHandler?Promise.resolve(void 0):Bt(()=>{const j=A.getCommentThread(k);if(j){const re=j.getCommentByUniqueId(E.uniqueIdInThread);if(A!==void 0&&re&&A.reactionHandler)return A.reactionHandler(re,l(N))}return Promise.resolve(void 0)})}};m.handlePool=0;let n=m;const b=class b{set threadId(v){this._id=v}get threadId(){return this._id}get id(){return this._id}get resource(){return this._uri}get uri(){return this._uri}set range(v){(v===void 0!=(this._range===void 0)||!v||!this._range||!v.isEqual(this._range))&&(this._range=v,this.modifications.range=v,this._onDidUpdateCommentThread.fire())}get range(){return this._range}set canReply(v){this._canReply!==v&&(this._canReply=v,this.modifications.canReply=v,this._onDidUpdateCommentThread.fire())}get canReply(){return this._canReply}get label(){return this._label}set label(v){this._label=v,this.modifications.label=v,this._onDidUpdateCommentThread.fire()}get contextValue(){return this._contextValue}set contextValue(v){this._contextValue=v,this.modifications.contextValue=v,this._onDidUpdateCommentThread.fire()}get comments(){return this._comments}set comments(v){this._comments=v,this.modifications.comments=v,this._onDidUpdateCommentThread.fire()}get collapsibleState(){return this._collapseState}set collapsibleState(v){this._collapseState=v,this.modifications.collapsibleState=v,this._onDidUpdateCommentThread.fire()}get state(){return this._state}set state(v){this._state=v,typeof v=="object"?(O(this.extensionDescription,"commentThreadApplicability"),this.modifications.state=v.resolved,this.modifications.applicability=v.applicability):this.modifications.state=v,this._onDidUpdateCommentThread.fire()}get isDisposed(){return this._isDiposed}constructor(v,k,D,E,N,A,j,re){this._commentControllerHandle=k,this._id=D,this._uri=E,this._range=N,this._comments=A,this.extensionDescription=j,this._isTemplate=re,this.handle=b._handlePool++,this.commentHandle=0,this.modifications=Object.create(null),this._onDidUpdateCommentThread=new R,this.onDidUpdateCommentThread=this._onDidUpdateCommentThread.event,this._canReply=!0,this._commentsMap=new Map,this._acceptInputDisposables=new zo,this._acceptInputDisposables.value=new Te,this._id===void 0&&(this._id=`${v}.${this.handle}`),i.$createCommentThread(k,this.handle,this._id,this._uri,H.from(this._range),j.identifier,this._isTemplate),this._localDisposables=[],this._isDiposed=!1,this._localDisposables.push(this.onDidUpdateCommentThread(()=>{this.eventuallyUpdateCommentThread()})),this.comments=A,this._localDisposables.push({dispose:()=>{i.$deleteCommentThread(k,this.handle)}});const te=this;this.value={get uri(){return te.uri},get range(){return te.range},set range(q){te.range=q},get comments(){return te.comments},set comments(q){te.comments=q},get collapsibleState(){return te.collapsibleState},set collapsibleState(q){te.collapsibleState=q},get canReply(){return te.canReply},set canReply(q){te.canReply=q},get contextValue(){return te.contextValue},set contextValue(q){te.contextValue=q},get label(){return te.label},set label(q){te.label=q},get state(){return te.state},set state(q){te.state=q},dispose:()=>{te.dispose()}}}updateIsTemplate(){this._isTemplate&&(this._isTemplate=!1,this.modifications.isTemplate=!1)}eventuallyUpdateCommentThread(){if(this._isDiposed)return;this.updateIsTemplate(),this._acceptInputDisposables.value||(this._acceptInputDisposables.value=new Te);const v=D=>Object.prototype.hasOwnProperty.call(this.modifications,D),k={};v("range")&&(k.range=H.from(this._range)),v("label")&&(k.label=this.label),v("contextValue")&&(k.contextValue=this.contextValue??null),v("comments")&&(k.comments=this._comments.map(D=>a(this,D,this._commentsMap,this.extensionDescription))),v("collapsibleState")&&(k.collapseState=u(this._collapseState)),v("canReply")&&(k.canReply=this.canReply),v("state")&&(k.state=d(this._state)),v("applicability")&&(k.applicability=f(this._state)),v("isTemplate")&&(k.isTemplate=this._isTemplate),this.modifications={},i.$updateCommentThread(this._commentControllerHandle,this.handle,this._id,this._uri,k)}getCommentByUniqueId(v){for(const k of this._commentsMap){const D=k[0],E=k[1];if(v===E)return D}}dispose(){this._isDiposed=!0,this._acceptInputDisposables.dispose(),this._localDisposables.forEach(v=>v.dispose())}};b._handlePool=0;let s=b;class o{get id(){return this._id}get label(){return this._label}get handle(){return this._handle}get commentingRangeProvider(){return this._commentingRangeProvider}set commentingRangeProvider(v){this._commentingRangeProvider=v,v!=null&&v.resourceHints&&O(this._extension,"commentingRangeHint"),i.$updateCommentingRanges(this.handle,v==null?void 0:v.resourceHints)}get reactionHandler(){return this._reactionHandler}set reactionHandler(v){this._reactionHandler=v,i.$updateCommentControllerFeatures(this.handle,{reactionHandler:!!v})}get options(){return this._options}set options(v){this._options=v,i.$updateCommentControllerFeatures(this.handle,{options:this._options})}get activeComment(){return O(this._extension,"activeComment"),this._activeComment}get activeCommentThread(){return O(this._extension,"activeComment"),this._activeThread}constructor(v,k,D,E){this._extension=v,this._handle=k,this._id=D,this._label=E,this._threads=new Map,i.$registerCommentController(this.handle,D,E,this._extension.identifier.value);const N=this;this.value=Object.freeze({id:N.id,label:N.label,get options(){return N.options},set options(A){N.options=A},get commentingRangeProvider(){return N.commentingRangeProvider},set commentingRangeProvider(A){N.commentingRangeProvider=A},get reactionHandler(){return N.reactionHandler},set reactionHandler(A){N.reactionHandler=A},get activeCommentThread(){return N.activeCommentThread},createCommentThread(A,j,re){return N.createCommentThread(A,j,re).value},dispose:()=>{N.dispose()}}),this._localDisposables=[],this._localDisposables.push({dispose:()=>{i.$unregisterCommentController(this.handle)}})}createCommentThread(v,k,D){k===void 0&&O(this._extension,"fileComments");const E=new s(this.id,this.handle,void 0,v,k,D,this._extension,!1);return this._threads.set(E.handle,E),E}$setActiveComment(v){if(!v){this._activeComment=void 0,this._activeThread=void 0;return}const k=this._threads.get(v.commentThreadHandle);k&&(this._activeComment=v.uniqueIdInThread?k.getCommentByUniqueId(v.uniqueIdInThread):void 0,this._activeThread=k)}$createCommentThreadTemplate(v,k){const D=new s(this.id,this.handle,void 0,x.revive(v),H.to(k),[],this._extension,!0);return D.collapsibleState=jo.Expanded,this._threads.set(D.handle,D),D}$updateCommentThreadTemplate(v,k){const D=this._threads.get(v);D&&(D.range=H.to(k))}$deleteCommentThread(v){const k=this._threads.get(v);k==null||k.dispose(),this._threads.delete(v)}getCommentThread(v){return this._threads.get(v)}dispose(){this._threads.forEach(v=>{v.dispose()}),this._localDisposables.forEach(v=>v.dispose())}}function a(_,v,k,D){var N,A;let E=k.get(v);return E||(E=++_.commentHandle,k.set(v,E)),v.state!==void 0&&O(D,"commentsDraftState"),(N=v.reactions)!=null&&N.some(j=>j.reactors!==void 0)&&O(D,"commentReactor"),{mode:v.mode,contextValue:v.contextValue,uniqueIdInThread:E,body:typeof v.body=="string"?v.body:Le.from(v.body),userName:v.author.name,userIconPath:v.author.iconPath,label:v.label,commentReactions:v.reactions?v.reactions.map(j=>c(j)):void 0,state:v.state,timestamp:(A=v.timestamp)==null?void 0:A.toJSON()}}function c(_){return{label:_.label,iconPath:_.iconPath?cg(_.iconPath):void 0,count:_.count,hasReacted:_.authorHasReacted,reactors:_.reactors&&_.reactors.length>0&&typeof _.reactors[0]!="string"?_.reactors.map(v=>v.name):_.reactors}}function l(_){var v;return{label:_.label||"",count:_.count||0,iconPath:_.iconPath?x.revive(_.iconPath):"",authorHasReacted:_.hasReacted||!1,reactors:(v=_.reactors)==null?void 0:v.map(k=>({name:k}))}}function u(_){if(_!==void 0)switch(_){case iu.Expanded:return jo.Expanded;case iu.Collapsed:return jo.Collapsed}return jo.Collapsed}function d(_){let v;if(typeof _=="object"?v=_.resolved:v=_,v!==void 0)switch(v){case nu.Unresolved:return rl.Unresolved;case nu.Resolved:return rl.Resolved}return rl.Unresolved}function f(_){let v;if(typeof _=="object"&&(v=_.applicability),v!==void 0)switch(v){case ru.Current:return sl.Current;case ru.Outdated:return sl.Outdated}return sl.Current}return new n}var v2={exports:{}},om={};(function(r,e){e=r.exports=ze;var t;typeof process=="object"&&om&&om.NODE_DEBUG&&/\bsemver\b/i.test(om.NODE_DEBUG)?t=function(){var S=Array.prototype.slice.call(arguments,0);S.unshift("SEMVER"),console.log.apply(console,S)}:t=function(){},e.SEMVER_SPEC_VERSION="2.0.0";var i=256,n=Number.MAX_SAFE_INTEGER||9007199254740991,s=16,o=e.re=[],a=e.src=[],c=0,l=c++;a[l]="0|[1-9]\\d*";var u=c++;a[u]="[0-9]+";var d=c++;a[d]="\\d*[a-zA-Z-][a-zA-Z0-9-]*";var f=c++;a[f]="("+a[l]+")\\.("+a[l]+")\\.("+a[l]+")";var m=c++;a[m]="("+a[u]+")\\.("+a[u]+")\\.("+a[u]+")";var b=c++;a[b]="(?:"+a[l]+"|"+a[d]+")";var _=c++;a[_]="(?:"+a[u]+"|"+a[d]+")";var v=c++;a[v]="(?:-("+a[b]+"(?:\\."+a[b]+")*))";var k=c++;a[k]="(?:-?("+a[_]+"(?:\\."+a[_]+")*))";var D=c++;a[D]="[0-9A-Za-z-]+";var E=c++;a[E]="(?:\\+("+a[D]+"(?:\\."+a[D]+")*))";var N=c++,A="v?"+a[f]+a[v]+"?"+a[E]+"?";a[N]="^"+A+"$";var j="[v=\\s]*"+a[m]+a[k]+"?"+a[E]+"?",re=c++;a[re]="^"+j+"$";var te=c++;a[te]="((?:<|>)?=?)";var q=c++;a[q]=a[u]+"|x|X|\\*";var We=c++;a[We]=a[l]+"|x|X|\\*";var V=c++;a[V]="[v=\\s]*("+a[We]+")(?:\\.("+a[We]+")(?:\\.("+a[We]+")(?:"+a[v]+")?"+a[E]+"?)?)?";var B=c++;a[B]="[v=\\s]*("+a[q]+")(?:\\.("+a[q]+")(?:\\.("+a[q]+")(?:"+a[k]+")?"+a[E]+"?)?)?";var Q=c++;a[Q]="^"+a[te]+"\\s*"+a[V]+"$";var Y=c++;a[Y]="^"+a[te]+"\\s*"+a[B]+"$";var ie=c++;a[ie]="(?:^|[^\\d])(\\d{1,"+s+"})(?:\\.(\\d{1,"+s+"}))?(?:\\.(\\d{1,"+s+"}))?(?:$|[^\\d])";var me=c++;a[me]="(?:~>?)";var ge=c++;a[ge]="(\\s*)"+a[me]+"\\s+",o[ge]=new RegExp(a[ge],"g");var tt="$1~",nt=c++;a[nt]="^"+a[me]+a[V]+"$";var He=c++;a[He]="^"+a[me]+a[B]+"$";var Ot=c++;a[Ot]="(?:\\^)";var gt=c++;a[gt]="(\\s*)"+a[Ot]+"\\s+",o[gt]=new RegExp(a[gt],"g");var Zt="$1^",_t=c++;a[_t]="^"+a[Ot]+a[V]+"$";var _i=c++;a[_i]="^"+a[Ot]+a[B]+"$";var rt=c++;a[rt]="^"+a[te]+"\\s*("+j+")$|^$";var kn=c++;a[kn]="^"+a[te]+"\\s*("+A+")$|^$";var Dn=c++;a[Dn]="(\\s*)"+a[te]+"\\s*("+j+"|"+a[V]+")",o[Dn]=new RegExp(a[Dn],"g");var Io="$1$2$3",rs=c++;a[rs]="^\\s*("+a[V]+")\\s+-\\s+("+a[V]+")\\s*$";var Ie=c++;a[Ie]="^\\s*("+a[B]+")\\s+-\\s+("+a[B]+")\\s*$";var pd=c++;a[pd]="(<|>)?=?\\s*\\*";for(var Yt=0;Yt<c;Yt++)t(Yt,a[Yt]),o[Yt]||(o[Yt]=new RegExp(a[Yt]));e.parse=wi;function wi(S,T){if(S instanceof ze)return S;if(typeof S!="string"||S.length>i)return null;var L=T?o[re]:o[N];if(!L.test(S))return null;try{return new ze(S,T)}catch{return null}}e.valid=gd;function gd(S,T){var L=wi(S,T);return L?L.version:null}e.clean=_g;function _g(S,T){var L=wi(S.trim().replace(/^[=v]+/,""),T);return L?L.version:null}e.SemVer=ze;function ze(S,T){if(S instanceof ze){if(S.loose===T)return S;S=S.version}else if(typeof S!="string")throw new TypeError("Invalid Version: "+S);if(S.length>i)throw new TypeError("version is longer than "+i+" characters");if(!(this instanceof ze))return new ze(S,T);t("SemVer",S,T),this.loose=T;var L=S.trim().match(T?o[re]:o[N]);if(!L)throw new TypeError("Invalid Version: "+S);if(this.raw=S,this.major=+L[1],this.minor=+L[2],this.patch=+L[3],this.major>n||this.major<0)throw new TypeError("Invalid major version");if(this.minor>n||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>n||this.patch<0)throw new TypeError("Invalid patch version");L[4]?this.prerelease=L[4].split(".").map(function(ee){if(/^[0-9]+$/.test(ee)){var g=+ee;if(g>=0&&g<n)return g}return ee}):this.prerelease=[],this.build=L[5]?L[5].split("."):[],this.format()}ze.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},ze.prototype.toString=function(){return this.version},ze.prototype.compare=function(S){return t("SemVer.compare",this.version,this.loose,S),S instanceof ze||(S=new ze(S,this.loose)),this.compareMain(S)||this.comparePre(S)},ze.prototype.compareMain=function(S){return S instanceof ze||(S=new ze(S,this.loose)),In(this.major,S.major)||In(this.minor,S.minor)||In(this.patch,S.patch)},ze.prototype.comparePre=function(S){if(S instanceof ze||(S=new ze(S,this.loose)),this.prerelease.length&&!S.prerelease.length)return-1;if(!this.prerelease.length&&S.prerelease.length)return 1;if(!this.prerelease.length&&!S.prerelease.length)return 0;var T=0;do{var L=this.prerelease[T],ee=S.prerelease[T];if(t("prerelease compare",T,L,ee),L===void 0&&ee===void 0)return 0;if(ee===void 0)return 1;if(L===void 0)return-1;if(L===ee)continue;return In(L,ee)}while(++T)},ze.prototype.inc=function(S,T){switch(S){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",T);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",T);break;case"prepatch":this.prerelease.length=0,this.inc("patch",T),this.inc("pre",T);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",T),this.inc("pre",T);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{for(var L=this.prerelease.length;--L>=0;)typeof this.prerelease[L]=="number"&&(this.prerelease[L]++,L=-2);L===-1&&this.prerelease.push(0)}T&&(this.prerelease[0]===T?isNaN(this.prerelease[1])&&(this.prerelease=[T,0]):this.prerelease=[T,0]);break;default:throw new Error("invalid increment argument: "+S)}return this.format(),this.raw=this.version,this},e.inc=wg;function wg(S,T,L,ee){typeof L=="string"&&(ee=L,L=void 0);try{return new ze(S,L).inc(T,ee).version}catch{return null}}e.diff=md;function md(S,T){if(To(S,T))return null;var L=wi(S),ee=wi(T);if(L.prerelease.length||ee.prerelease.length){for(var g in L)if((g==="major"||g==="minor"||g==="patch")&&L[g]!==ee[g])return"pre"+g;return"prerelease"}for(var g in L)if((g==="major"||g==="minor"||g==="patch")&&L[g]!==ee[g])return g}e.compareIdentifiers=In;var vd=/^[0-9]+$/;function In(S,T){var L=vd.test(S),ee=vd.test(T);return L&&ee&&(S=+S,T=+T),L&&!ee?-1:ee&&!L?1:S<T?-1:S>T?1:0}e.rcompareIdentifiers=bg;function bg(S,T){return In(T,S)}e.major=Ic;function Ic(S,T){return new ze(S,T).major}e.minor=Pc;function Pc(S,T){return new ze(S,T).minor}e.patch=yg;function yg(S,T){return new ze(S,T).patch}e.compare=Ui;function Ui(S,T,L){return new ze(S,L).compare(new ze(T,L))}e.compareLoose=ss;function ss(S,T){return Ui(S,T,!0)}e.rcompare=xg;function xg(S,T,L){return Ui(T,S,L)}e.sort=Cg;function Cg(S,T){return S.sort(function(L,ee){return e.compare(L,ee,T)})}e.rsort=Sg;function Sg(S,T){return S.sort(function(L,ee){return e.rcompare(L,ee,T)})}e.gt=ur;function ur(S,T,L){return Ui(S,T,L)>0}e.lt=Po;function Po(S,T,L){return Ui(S,T,L)<0}e.eq=To;function To(S,T,L){return Ui(S,T,L)===0}e.neq=_d;function _d(S,T,L){return Ui(S,T,L)!==0}e.gte=Ao;function Ao(S,T,L){return Ui(S,T,L)>=0}e.lte=Tc;function Tc(S,T,L){return Ui(S,T,L)<=0}e.cmp=Ro;function Ro(S,T,L,ee){var g;switch(T){case"===":typeof S=="object"&&(S=S.version),typeof L=="object"&&(L=L.version),g=S===L;break;case"!==":typeof S=="object"&&(S=S.version),typeof L=="object"&&(L=L.version),g=S!==L;break;case"":case"=":case"==":g=To(S,L,ee);break;case"!=":g=_d(S,L,ee);break;case">":g=ur(S,L,ee);break;case">=":g=Ao(S,L,ee);break;case"<":g=Po(S,L,ee);break;case"<=":g=Tc(S,L,ee);break;default:throw new TypeError("Invalid operator: "+T)}return g}e.Comparator=li;function li(S,T){if(S instanceof li){if(S.loose===T)return S;S=S.value}if(!(this instanceof li))return new li(S,T);t("comparator",S,T),this.loose=T,this.parse(S),this.semver===os?this.value="":this.value=this.operator+this.semver.version,t("comp",this)}var os={};li.prototype.parse=function(S){var T=this.loose?o[rt]:o[kn],L=S.match(T);if(!L)throw new TypeError("Invalid comparator: "+S);this.operator=L[1],this.operator==="="&&(this.operator=""),L[2]?this.semver=new ze(L[2],this.loose):this.semver=os},li.prototype.toString=function(){return this.value},li.prototype.test=function(S){return t("Comparator.test",S,this.loose),this.semver===os?!0:(typeof S=="string"&&(S=new ze(S,this.loose)),Ro(S,this.operator,this.semver,this.loose))},li.prototype.intersects=function(S,T){if(!(S instanceof li))throw new TypeError("a Comparator is required");var L;if(this.operator==="")return L=new lt(S.value,T),$o(this.value,L,T);if(S.operator==="")return L=new lt(this.value,T),$o(S.semver,L,T);var ee=(this.operator===">="||this.operator===">")&&(S.operator===">="||S.operator===">"),g=(this.operator==="<="||this.operator==="<")&&(S.operator==="<="||S.operator==="<"),w=this.semver.version===S.semver.version,C=(this.operator===">="||this.operator==="<=")&&(S.operator===">="||S.operator==="<="),W=Ro(this.semver,"<",S.semver,T)&&(this.operator===">="||this.operator===">")&&(S.operator==="<="||S.operator==="<"),ce=Ro(this.semver,">",S.semver,T)&&(this.operator==="<="||this.operator==="<")&&(S.operator===">="||S.operator===">");return ee||g||w&&C||W||ce},e.Range=lt;function lt(S,T){if(S instanceof lt)return S.loose===T?S:new lt(S.raw,T);if(S instanceof li)return new lt(S.value,T);if(!(this instanceof lt))return new lt(S,T);if(this.loose=T,this.raw=S,this.set=S.split(/\s*\|\|\s*/).map(function(L){return this.parseRange(L.trim())},this).filter(function(L){return L.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+S);this.format()}lt.prototype.format=function(){return this.range=this.set.map(function(S){return S.join(" ").trim()}).join("||").trim(),this.range},lt.prototype.toString=function(){return this.range},lt.prototype.parseRange=function(S){var T=this.loose;S=S.trim(),t("range",S,T);var L=T?o[Ie]:o[rs];S=S.replace(L,Lo),t("hyphen replace",S),S=S.replace(o[Dn],Io),t("comparator trim",S,o[Dn]),S=S.replace(o[ge],tt),S=S.replace(o[gt],Zt),S=S.split(/\s+/).join(" ");var ee=T?o[rt]:o[kn],g=S.split(" ").map(function(w){return I(w,T)}).join(" ").split(/\s+/);return this.loose&&(g=g.filter(function(w){return!!w.match(ee)})),g=g.map(function(w){return new li(w,T)}),g},lt.prototype.intersects=function(S,T){if(!(S instanceof lt))throw new TypeError("a Range is required");return this.set.some(function(L){return L.every(function(ee){return S.set.some(function(g){return g.every(function(w){return ee.intersects(w,T)})})})})},e.toComparators=wd;function wd(S,T){return new lt(S,T).set.map(function(L){return L.map(function(ee){return ee.value}).join(" ").trim().split(" ")})}function I(S,T){return t("comp",S),S=je(S,T),t("caret",S),S=bd(S,T),t("tildes",S),S=kg(S,T),t("xrange",S),S=Ig(S,T),t("stars",S),S}function pt(S){return!S||S.toLowerCase()==="x"||S==="*"}function bd(S,T){return S.trim().split(/\s+/).map(function(L){return le(L,T)}).join(" ")}function le(S,T){var L=T?o[He]:o[nt];return S.replace(L,function(ee,g,w,C,W){t("tilde",S,ee,g,w,C,W);var ce;return pt(g)?ce="":pt(w)?ce=">="+g+".0.0 <"+(+g+1)+".0.0":pt(C)?ce=">="+g+"."+w+".0 <"+g+"."+(+w+1)+".0":W?(t("replaceTilde pr",W),W.charAt(0)!=="-"&&(W="-"+W),ce=">="+g+"."+w+"."+C+W+" <"+g+"."+(+w+1)+".0"):ce=">="+g+"."+w+"."+C+" <"+g+"."+(+w+1)+".0",t("tilde return",ce),ce})}function je(S,T){return S.trim().split(/\s+/).map(function(L){return Eg(L,T)}).join(" ")}function Eg(S,T){t("caret",S,T);var L=T?o[_i]:o[_t];return S.replace(L,function(ee,g,w,C,W){t("caret",S,ee,g,w,C,W);var ce;return pt(g)?ce="":pt(w)?ce=">="+g+".0.0 <"+(+g+1)+".0.0":pt(C)?g==="0"?ce=">="+g+"."+w+".0 <"+g+"."+(+w+1)+".0":ce=">="+g+"."+w+".0 <"+(+g+1)+".0.0":W?(t("replaceCaret pr",W),W.charAt(0)!=="-"&&(W="-"+W),g==="0"?w==="0"?ce=">="+g+"."+w+"."+C+W+" <"+g+"."+w+"."+(+C+1):ce=">="+g+"."+w+"."+C+W+" <"+g+"."+(+w+1)+".0":ce=">="+g+"."+w+"."+C+W+" <"+(+g+1)+".0.0"):(t("no pr"),g==="0"?w==="0"?ce=">="+g+"."+w+"."+C+" <"+g+"."+w+"."+(+C+1):ce=">="+g+"."+w+"."+C+" <"+g+"."+(+w+1)+".0":ce=">="+g+"."+w+"."+C+" <"+(+g+1)+".0.0"),t("caret return",ce),ce})}function kg(S,T){return t("replaceXRanges",S,T),S.split(/\s+/).map(function(L){return Dg(L,T)}).join(" ")}function Dg(S,T){S=S.trim();var L=T?o[Y]:o[Q];return S.replace(L,function(ee,g,w,C,W,ce){t("xRange",S,ee,g,w,C,W,ce);var Ze=pt(w),Gt=Ze||pt(C),ui=Gt||pt(W),bi=ui;return g==="="&&bi&&(g=""),Ze?g===">"||g==="<"?ee="<0.0.0":ee="*":g&&bi?(Gt&&(C=0),ui&&(W=0),g===">"?(g=">=",Gt?(w=+w+1,C=0,W=0):ui&&(C=+C+1,W=0)):g==="<="&&(g="<",Gt?w=+w+1:C=+C+1),ee=g+w+"."+C+"."+W):Gt?ee=">="+w+".0.0 <"+(+w+1)+".0.0":ui&&(ee=">="+w+"."+C+".0 <"+w+"."+(+C+1)+".0"),t("xRange return",ee),ee})}function Ig(S,T){return t("replaceStars",S,T),S.trim().replace(o[pd],"")}function Lo(S,T,L,ee,g,w,C,W,ce,Ze,Gt,ui,bi){return pt(L)?T="":pt(ee)?T=">="+L+".0.0":pt(g)?T=">="+L+"."+ee+".0":T=">="+T,pt(ce)?W="":pt(Ze)?W="<"+(+ce+1)+".0.0":pt(Gt)?W="<"+ce+"."+(+Ze+1)+".0":ui?W="<="+ce+"."+Ze+"."+Gt+"-"+ui:W="<="+W,(T+" "+W).trim()}lt.prototype.test=function(S){if(!S)return!1;typeof S=="string"&&(S=new ze(S,this.loose));for(var T=0;T<this.set.length;T++)if(Pg(this.set[T],S))return!0;return!1};function Pg(S,T){for(var L=0;L<S.length;L++)if(!S[L].test(T))return!1;if(T.prerelease.length){for(var L=0;L<S.length;L++)if(t(S[L].semver),S[L].semver!==os&&S[L].semver.prerelease.length>0){var ee=S[L].semver;if(ee.major===T.major&&ee.minor===T.minor&&ee.patch===T.patch)return!0}return!1}return!0}e.satisfies=$o;function $o(S,T,L){try{T=new lt(T,L)}catch{return!1}return T.test(S)}e.maxSatisfying=Tg;function Tg(S,T,L){var ee=null,g=null;try{var w=new lt(T,L)}catch{return null}return S.forEach(function(C){w.test(C)&&(!ee||g.compare(C)===-1)&&(ee=C,g=new ze(ee,L))}),ee}e.minSatisfying=yd;function yd(S,T,L){var ee=null,g=null;try{var w=new lt(T,L)}catch{return null}return S.forEach(function(C){w.test(C)&&(!ee||g.compare(C)===1)&&(ee=C,g=new ze(ee,L))}),ee}e.validRange=Ag;function Ag(S,T){try{return new lt(S,T).range||"*"}catch{return null}}e.ltr=Rg;function Rg(S,T,L){return Ac(S,T,"<",L)}e.gtr=Lg;function Lg(S,T,L){return Ac(S,T,">",L)}e.outside=Ac;function Ac(S,T,L,ee){S=new ze(S,ee),T=new lt(T,ee);var g,w,C,W,ce;switch(L){case">":g=ur,w=Tc,C=Po,W=">",ce=">=";break;case"<":g=Po,w=Ao,C=ur,W="<",ce="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if($o(S,T,ee))return!1;for(var Ze=0;Ze<T.set.length;++Ze){var Gt=T.set[Ze],ui=null,bi=null;if(Gt.forEach(function(dr){dr.semver===os&&(dr=new li(">=0.0.0")),ui=ui||dr,bi=bi||dr,g(dr.semver,ui.semver,ee)?ui=dr:C(dr.semver,bi.semver,ee)&&(bi=dr)}),ui.operator===W||ui.operator===ce||(!bi.operator||bi.operator===W)&&w(S,bi.semver))return!1;if(bi.operator===ce&&C(S,bi.semver))return!1}return!0}e.prerelease=$g;function $g(S,T){var L=wi(S,T);return L&&L.prerelease.length?L.prerelease:null}e.intersects=Ng;function Ng(S,T,L){return S=new lt(S,L),T=new lt(T,L),S.intersects(T)}e.coerce=Mg;function Mg(S){if(S instanceof ze)return S;if(typeof S!="string")return null;var T=S.match(o[ie]);return T==null?null:wi((T[1]||"0")+"."+(T[2]||"0")+"."+(T[3]||"0"))}})(v2,v2.exports);const IS=/^(\^|>=)?((\d+)|x)\.((\d+)|x)\.((\d+)|x)(\-.*)?$/,_P=/^-(\d{4})(\d{2})(\d{2})$/;function wP(r){return r=r.trim(),r==="*"||IS.test(r)}function PS(r){if(!wP(r))return null;if(r=r.trim(),r==="*")return{hasCaret:!1,hasGreaterEquals:!1,majorBase:0,majorMustEqual:!1,minorBase:0,minorMustEqual:!1,patchBase:0,patchMustEqual:!1,preRelease:null};const e=r.match(IS);return e?{hasCaret:e[1]==="^",hasGreaterEquals:e[1]===">=",majorBase:e[2]==="x"?0:parseInt(e[2],10),majorMustEqual:e[2]!=="x",minorBase:e[4]==="x"?0:parseInt(e[4],10),minorMustEqual:e[4]!=="x",patchBase:e[6]==="x"?0:parseInt(e[6],10),patchMustEqual:e[6]!=="x",preRelease:e[8]||null}:null}function TS(r){if(!r)return null;const e=r.majorBase,t=r.majorMustEqual,i=r.minorBase;let n=r.minorMustEqual;const s=r.patchBase;let o=r.patchMustEqual;r.hasCaret&&(e===0||(n=!1),o=!1);let a=0;if(r.preRelease){const c=_P.exec(r.preRelease);if(c){const[,l,u,d]=c;a=Date.UTC(Number(l),Number(u)-1,Number(d))}}return{majorBase:e,majorMustEqual:t,minorBase:i,minorMustEqual:n,patchBase:s,patchMustEqual:o,isMinimum:r.hasGreaterEquals,notBefore:a}}class bP{constructor(){this.buffers=[]}add(e){let t=this.buffers.indexOf(e);return t<0&&(t=this.buffers.length,this.buffers.push(e)),t}}function yP(r,e){if(e.serializeBuffersForPostMessage){const t=new bP,n=JSON.stringify(r,(o,a)=>{if(a instanceof ArrayBuffer)return{$$vscode_array_buffer_reference$$:!0,index:t.add(a)};if(ArrayBuffer.isView(a)){const c=xP(a);if(c)return{$$vscode_array_buffer_reference$$:!0,index:t.add(a.buffer),view:{type:c,byteLength:a.byteLength,byteOffset:a.byteOffset}}}return a}),s=t.buffers.map(o=>{const a=new Uint8Array(o);return _e.wrap(a)});return{message:n,buffers:s}}else return{message:JSON.stringify(r),buffers:[]}}function xP(r){switch(r.constructor.name){case"Int8Array":return 1;case"Uint8Array":return 2;case"Uint8ClampedArray":return 3;case"Int16Array":return 4;case"Uint16Array":return 5;case"Int32Array":return 6;case"Uint32Array":return 7;case"Float32Array":return 8;case"Float64Array":return 9;case"BigInt64Array":return 10;case"BigUint64Array":return 11}}function CP(r,e){const t=e.map(s=>{const o=new ArrayBuffer(s.byteLength);return new Uint8Array(o).set(s.buffer),o}),i=e.length?(s,o)=>{if(o&&typeof o=="object"&&o.$$vscode_array_buffer_reference$$){const a=o,{index:c}=a,l=t[c];if(a.view)switch(a.view.type){case 1:return new Int8Array(l,a.view.byteOffset,a.view.byteLength/Int8Array.BYTES_PER_ELEMENT);case 2:return new Uint8Array(l,a.view.byteOffset,a.view.byteLength/Uint8Array.BYTES_PER_ELEMENT);case 3:return new Uint8ClampedArray(l,a.view.byteOffset,a.view.byteLength/Uint8ClampedArray.BYTES_PER_ELEMENT);case 4:return new Int16Array(l,a.view.byteOffset,a.view.byteLength/Int16Array.BYTES_PER_ELEMENT);case 5:return new Uint16Array(l,a.view.byteOffset,a.view.byteLength/Uint16Array.BYTES_PER_ELEMENT);case 6:return new Int32Array(l,a.view.byteOffset,a.view.byteLength/Int32Array.BYTES_PER_ELEMENT);case 7:return new Uint32Array(l,a.view.byteOffset,a.view.byteLength/Uint32Array.BYTES_PER_ELEMENT);case 8:return new Float32Array(l,a.view.byteOffset,a.view.byteLength/Float32Array.BYTES_PER_ELEMENT);case 9:return new Float64Array(l,a.view.byteOffset,a.view.byteLength/Float64Array.BYTES_PER_ELEMENT);case 10:return new BigInt64Array(l,a.view.byteOffset,a.view.byteLength/BigInt64Array.BYTES_PER_ELEMENT);case 11:return new BigUint64Array(l,a.view.byteOffset,a.view.byteLength/BigUint64Array.BYTES_PER_ELEMENT);default:throw new Error("Unknown array buffer view type")}return l}return o}:void 0;return{message:JSON.parse(r,i),arrayBuffers:t}}var Us,Bs,Bu,Vu,Wu,hn,Vs,Ws,zs,js,zu,ba,qs;class SP{constructor(e,t,i,n,s,o,a){ue(this,Us,void 0);ue(this,Bs,void 0);ue(this,Bu,void 0);ue(this,Vu,void 0);ue(this,Wu,void 0);ue(this,hn,void 0);ue(this,Vs,void 0);ue(this,Ws,void 0);ue(this,zs,void 0);ue(this,js,void 0);ue(this,zu,void 0);ue(this,ba,void 0);ue(this,qs,void 0);K(this,Vs,""),K(this,zs,!1),K(this,js,!1),this._onMessageEmitter=new R,this.onDidReceiveMessage=this._onMessageEmitter.event,K(this,qs,new R),this._onDidDispose=P(this,qs).event,K(this,Us,e),K(this,Bs,t),K(this,Ws,i),K(this,Vu,n),K(this,Wu,s),K(this,hn,o),K(this,zu,dc(o)),K(this,ba,EP(o)),K(this,Bu,a)}dispose(){K(this,zs,!0),P(this,qs).fire(),P(this,qs).dispose(),this._onMessageEmitter.dispose()}asWebviewUri(e){return K(this,js,!0),wl(e,P(this,Vu))}get cspSource(){const e=P(this,hn).extensionLocation;if(e.scheme===ne.https||e.scheme===ne.http){let t=e.toString();return t.endsWith("/")||(t+="/"),t+" "+R_}return R_}get html(){return this.assertNotDisposed(),P(this,Vs)}set html(e){this.assertNotDisposed(),P(this,Vs)!==e&&(K(this,Vs,e),P(this,ba)&&!P(this,js)&&/(["'])vscode-resource:([^\s'"]+?)(["'])/i.test(e)&&(K(this,js,!0),P(this,Bu).report("Webview vscode-resource: uris",P(this,hn),"Please migrate to use the 'webview.asWebviewUri' api instead: https://aka.ms/vscode-webview-use-aswebviewuri")),P(this,Bs).$setHtml(P(this,Us),this.rewriteOldResourceUrlsIfNeeded(e)))}get options(){return this.assertNotDisposed(),P(this,Ws)}set options(e){this.assertNotDisposed(),tn(P(this,Ws),e)||P(this,Bs).$setOptions(P(this,Us),AS(P(this,hn),P(this,Wu),e)),K(this,Ws,e)}async postMessage(e){if(P(this,zs))return!1;const t=yP(e,{serializeBuffersForPostMessage:P(this,zu)});return P(this,Bs).$postMessage(P(this,Us),t.message,...t.buffers)}assertNotDisposed(){if(P(this,zs))throw new Error("Webview is disposed")}rewriteOldResourceUrlsIfNeeded(e){var n;if(!P(this,ba))return e;const t=((n=P(this,hn).extensionLocation)==null?void 0:n.scheme)===ne.vscodeRemote,i=P(this,hn).extensionLocation.scheme===ne.vscodeRemote?P(this,hn).extensionLocation.authority:void 0;return e.replace(/(["'])(?:vscode-resource):(\/\/([^\s\/'"]+?)(?=\/))?([^\s'"]+?)(["'])/gi,(s,o,a,c,l,u)=>{const d=x.from({scheme:c||"file",path:decodeURIComponent(l)}),f=wl(d,{isRemote:t,authority:i}).toString();return`${o}${f}${u}`}).replace(/(["'])(?:vscode-webview-resource):(\/\/[^\s\/'"]+\/([^\s\/'"]+?)(?=\/))?([^\s'"]+?)(["'])/gi,(s,o,a,c,l,u)=>{const d=x.from({scheme:c||"file",path:decodeURIComponent(l)}),f=wl(d,{isRemote:t,authority:i}).toString();return`${o}${f}${u}`})}}Us=new WeakMap,Bs=new WeakMap,Bu=new WeakMap,Vu=new WeakMap,Wu=new WeakMap,hn=new WeakMap,Vs=new WeakMap,Ws=new WeakMap,zs=new WeakMap,js=new WeakMap,zu=new WeakMap,ba=new WeakMap,qs=new WeakMap;function dc(r){try{const e=TS(PS(r.engines.vscode));return!!e&&e.majorBase>=1&&e.minorBase>=57}catch{return!1}}function EP(r){try{const e=TS(PS(r.engines.vscode));return e?e.majorBase<1||e.majorBase===1&&e.minorBase<60:!1}catch{return!1}}class kP extends Fe{constructor(e,t,i,n,s){super(),this.remoteInfo=t,this.workspace=i,this._logService=n,this._deprecationService=s,this._webviews=new Map,this._webviewProxy=e.getProxy(J.MainThreadWebviews)}dispose(){super.dispose();for(const e of this._webviews.values())e.dispose();this._webviews.clear()}$onMessage(e,t,i){const n=this.getWebview(e);if(n){const{message:s}=CP(t,i.value);n._onMessageEmitter.fire(s)}}$onMissingCsp(e,t){this._logService.warn(`${t} created a webview without a content security policy: https://aka.ms/vscode-webview-missing-csp`)}createNewWebview(e,t,i){const n=new SP(e,this._webviewProxy,DP(t),this.remoteInfo,this.workspace,i,this._deprecationService);this._webviews.set(e,n);const s=n._onDidDispose(()=>{s.dispose(),this.deleteWebview(e)});return n}deleteWebview(e){this._webviews.delete(e)}getWebview(e){return this._webviews.get(e)}}function dp(r){return{id:r.identifier,location:r.extensionLocation}}function AS(r,e,t){return{enableCommandUris:t.enableCommandUris,enableScripts:t.enableScripts,enableForms:t.enableForms,portMapping:t.portMapping,localResourceRoots:t.localResourceRoots||IP(r,e)}}function DP(r){var e;return{enableCommandUris:r.enableCommandUris,enableScripts:r.enableScripts,enableForms:r.enableForms,portMapping:r.portMapping,localResourceRoots:(e=r.localResourceRoots)==null?void 0:e.map(t=>x.from(t))}}function IP(r,e){return[...((e==null?void 0:e.getWorkspaceFolders())||[]).map(t=>t.uri),r.extensionLocation]}const Rp=class Rp{constructor(e){this.id=e,this._data=new Map,this._idPool=1}add(e){const t=this._idPool++;return this._data.set(t,e),this.logDebugInfo(),t}get(e,t){return this._data.has(e)?this._data.get(e)[t]:void 0}delete(e){this._data.delete(e),this.logDebugInfo()}logDebugInfo(){Rp.enableDebugLogging&&console.log(`${this.id} cache size - ${this._data.size}`)}};Rp.enableDebugLogging=!1;let Ri=Rp;class PP{constructor(e,t){this.document=e,this._storagePath=t,this._backupCounter=1,this._edits=new Ri("custom documents")}addEdit(e){return this._edits.add([e])}async undo(e,t){await this.getEdit(e).undo(),t||this.disposeBackup()}async redo(e,t){await this.getEdit(e).redo(),t||this.disposeBackup()}disposeEdits(e){for(const t of e)this._edits.delete(t)}getNewBackupUri(){if(!this._storagePath)throw new Error("Backup requires a valid storage path");const e=NP(this.document.uri)+this._backupCounter++;return wc(this._storagePath,e)}updateBackup(e){var t;(t=this._backup)==null||t.delete(),this._backup=e}disposeBackup(){var e;(e=this._backup)==null||e.delete(),this._backup=void 0}getEdit(e){const t=this._edits.get(e,0);if(!t)throw new Error("No edit found");return t}}class TP{constructor(){this._documents=new Map}get(e,t){return this._documents.get(this.key(e,t))}add(e,t,i){const n=this.key(e,t.uri);if(this._documents.has(n))throw new Error(`Document already exists for viewType:${e} resource:${t.uri}`);const s=new PP(t,i);return this._documents.set(n,s),s}delete(e,t){const i=this.key(e,t.uri);this._documents.delete(i)}key(e,t){return`${e}@@@${t}`}}class AP{constructor(){this._providers=new Map}addTextProvider(e,t,i){return this.add(0,e,t,i)}addCustomProvider(e,t,i){return this.add(1,e,t,i)}get(e){return this._providers.get(e)}add(e,t,i,n){if(this._providers.has(t))throw new Error(`Provider for viewType:${t} already registered`);return this._providers.set(t,{type:e,extension:i,provider:n}),new Ne(()=>this._providers.delete(t))}}class RP{constructor(e,t,i,n,s){this._extHostDocuments=t,this._extensionStoragePaths=i,this._extHostWebview=n,this._extHostWebviewPanels=s,this._editorProviders=new AP,this._documents=new TP,this._proxy=e.getProxy(J.MainThreadCustomEditors)}registerCustomEditorProvider(e,t,i,n){const s=new Te;return LP(i)?(s.add(this._editorProviders.addTextProvider(t,e,i)),this._proxy.$registerTextEditorProvider(dp(e),t,n.webviewOptions||{},{supportsMove:!!i.moveCustomTextEditor},dc(e))):(s.add(this._editorProviders.addCustomProvider(t,e,i)),Nd(i)&&s.add(i.onDidChangeCustomDocument(o=>{const a=this.getCustomDocumentEntry(t,o.document.uri);if($P(o)){const c=a.addEdit(o);this._proxy.$onDidEdit(o.document.uri,t,c,o.label)}else this._proxy.$onContentChange(o.document.uri,t)})),this._proxy.$registerCustomEditorProvider(dp(e),t,n.webviewOptions||{},!!n.supportsMultipleEditorsPerDocument,dc(e))),Ne.from(s,new Ne(()=>{this._proxy.$unregisterEditorProvider(t)}))}async $createCustomDocument(e,t,i,n,s){const o=this._editorProviders.get(t);if(!o)throw new Error(`No provider found for '${t}'`);if(o.type!==1)throw new Error(`Invalid provide type for '${t}'`);const a=x.revive(e),c=await o.provider.openCustomDocument(a,{backupId:i,untitledDocumentData:n==null?void 0:n.buffer},s);let l;return Nd(o.provider)&&this._extensionStoragePaths&&(l=this._extensionStoragePaths.workspaceValue(o.extension)??this._extensionStoragePaths.globalValue(o.extension)),this._documents.add(t,c,l),{editable:Nd(o.provider)}}async $disposeCustomDocument(e,t){const i=this._editorProviders.get(t);if(!i)throw new Error(`No provider found for '${t}'`);if(i.type!==1)throw new Error(`Invalid provider type for '${t}'`);const n=x.revive(e),{document:s}=this.getCustomDocumentEntry(t,n);this._documents.delete(t,s),s.dispose()}async $resolveCustomEditor(e,t,i,n,s,o){const a=this._editorProviders.get(i);if(!a)throw new Error(`No provider found for '${i}'`);const c=Et.to(s),l=this._extHostWebview.createNewWebview(t,n.contentOptions,a.extension),u=this._extHostWebviewPanels.createNewWebviewPanel(t,i,n.title,c,n.options,l,n.active),d=x.revive(e);switch(a.type){case 1:{const{document:f}=this.getCustomDocumentEntry(i,d);return a.provider.resolveCustomEditor(f,u,o)}case 0:{const f=this._extHostDocuments.getDocument(d);return a.provider.resolveCustomTextEditor(f,u,o)}default:throw new Error("Unknown webview provider type")}}$disposeEdits(e,t,i){this.getCustomDocumentEntry(t,e).disposeEdits(i)}async $onMoveCustomEditor(e,t,i){const n=this._editorProviders.get(i);if(!n)throw new Error(`No provider found for '${i}'`);if(!n.provider.moveCustomTextEditor)throw new Error(`Provider does not implement move '${i}'`);const s=this._extHostWebviewPanels.getWebviewPanel(e);if(!s)throw new Error("No webview found");const o=x.revive(t),a=this._extHostDocuments.getDocument(o);await n.provider.moveCustomTextEditor(a,s,bt.None)}async $undo(e,t,i,n){return this.getCustomDocumentEntry(t,e).undo(i,n)}async $redo(e,t,i,n){return this.getCustomDocumentEntry(t,e).redo(i,n)}async $revert(e,t,i){const n=this.getCustomDocumentEntry(t,e);await this.getCustomEditorProvider(t).revertCustomDocument(n.document,i),n.disposeBackup()}async $onSave(e,t,i){const n=this.getCustomDocumentEntry(t,e);await this.getCustomEditorProvider(t).saveCustomDocument(n.document,i),n.disposeBackup()}async $onSaveAs(e,t,i,n){const s=this.getCustomDocumentEntry(t,e);return this.getCustomEditorProvider(t).saveCustomDocumentAs(s.document,x.revive(i),n)}async $backup(e,t,i){const n=this.getCustomDocumentEntry(t,e),o=await this.getCustomEditorProvider(t).backupCustomDocument(n.document,{destination:n.getNewBackupUri()},i);return n.updateBackup(o),o.id}getCustomDocumentEntry(e,t){const i=this._documents.get(e,x.revive(t));if(!i)throw new Error("No custom document found");return i}getCustomEditorProvider(e){const t=this._editorProviders.get(e),i=t==null?void 0:t.provider;if(!i||!Nd(i))throw new Error("Custom document is not editable");return i}}function Nd(r){return!!r.onDidChangeCustomDocument}function LP(r){return typeof r.resolveCustomTextEditor=="function"}function $P(r){return typeof r.undo=="function"&&typeof r.redo=="function"}function NP(r){const e=r.scheme===ne.file||r.scheme===ne.untitled?r.fsPath:r.toString();return Rw(e)+""}var wr;const MP="vs/workbench/api/common/extHostDiagnostics";var Wn,Er,At;const g0=class g0{constructor(e,t,i,n,s,o,a,c){ue(this,Wn,void 0);ue(this,Er,void 0);ue(this,At,void 0);this._name=e,this._owner=t,this._maxDiagnosticsTotal=i,this._maxDiagnosticsPerFile=n,this._modelVersionIdProvider=s,this._isDisposed=!1,this._maxDiagnosticsTotal=Math.max(n,i),K(this,At,new Pt(l=>o.getComparisonKey(l))),K(this,Wn,a),K(this,Er,c)}dispose(){var e;this._isDisposed||(P(this,Er).fire([...P(this,At).keys()]),(e=P(this,Wn))==null||e.$clear(this._owner),P(this,At).clear(),this._isDisposed=!0)}get name(){return this._checkDisposed(),this._name}set(e,t){if(!e){this.clear();return}this._checkDisposed();let i=[];if(x.isUri(e)){if(!t){this.delete(e);return}P(this,At).set(e,t.slice()),i=[e]}else if(Array.isArray(e)){i=[];let o;e=[...e].sort(g0._compareIndexedTuplesByUri);for(const a of e){const[c,l]=a;if((!o||c.toString()!==o.toString())&&(o&&P(this,At).get(o).length===0&&P(this,At).delete(o),o=c,i.push(c),P(this,At).set(c,[])),l){const u=P(this,At).get(c);u==null||u.push(...l)}else{const u=P(this,At).get(c);u&&(u.length=0)}}}if(P(this,Er).fire(i),!P(this,Wn))return;const n=[];let s=0;for(const o of i){let a=[];const c=P(this,At).get(o);if(c)if(c.length>this._maxDiagnosticsPerFile){a=[];const l=[Ft.Error,Ft.Warning,Ft.Information,Ft.Hint];e:for(let u=0;u<4;u++)for(const d of c)if(d.severity===l[u]&&a.push({...ec.from(d),modelVersionId:this._modelVersionIdProvider(o)})===this._maxDiagnosticsPerFile)break e;a.push({severity:oi.Info,message:h(MP,0,"Not showing {0} further errors and warnings.",c.length-this._maxDiagnosticsPerFile),startLineNumber:a[a.length-1].startLineNumber,startColumn:a[a.length-1].startColumn,endLineNumber:a[a.length-1].endLineNumber,endColumn:a[a.length-1].endColumn})}else a=c.map(l=>({...ec.from(l),modelVersionId:this._modelVersionIdProvider(o)}));if(n.push([o,a]),s+=a.length,s>this._maxDiagnosticsTotal)break}P(this,Wn).$changeMany(this._owner,n)}delete(e){var t;this._checkDisposed(),P(this,Er).fire([e]),P(this,At).delete(e),(t=P(this,Wn))==null||t.$changeMany(this._owner,[[e,void 0]])}clear(){var e;this._checkDisposed(),P(this,Er).fire([...P(this,At).keys()]),P(this,At).clear(),(e=P(this,Wn))==null||e.$clear(this._owner)}forEach(e,t){this._checkDisposed();for(const[i,n]of this)e.call(t,i,n,this)}*[Symbol.iterator](){this._checkDisposed();for(const e of P(this,At).keys())yield[e,this.get(e)]}get(e){this._checkDisposed();const t=P(this,At).get(e);return Array.isArray(t)?Object.freeze(t.slice(0)):[]}has(e){return this._checkDisposed(),Array.isArray(P(this,At).get(e))}_checkDisposed(){if(this._isDisposed)throw new Error("illegal state - object is disposed")}static _compareIndexedTuplesByUri(e,t){return e[0].toString()<t[0].toString()?-1:e[0].toString()>t[0].toString()?1:0}};Wn=new WeakMap,Er=new WeakMap,At=new WeakMap;let hp=g0;var Hr;let L_=(Hr=class{static _mapper(e){const t=new Pt;for(const i of e)t.set(i,i);return{uris:Object.freeze(Array.from(t.values()))}}constructor(e,t,i,n){this._logService=t,this._fileSystemInfoService=i,this._extHostDocumentsAndEditors=n,this._collections=new Map,this._onDidChangeDiagnostics=new P4({merge:s=>s.flat(),delay:50}),this.onDidChangeDiagnostics=It.map(this._onDidChangeDiagnostics.event,wr._mapper),this._proxy=e.getProxy(J.MainThreadDiagnostics)}createDiagnosticCollection(e,t){const{_collections:i,_proxy:n,_onDidChangeDiagnostics:s,_logService:o,_fileSystemInfoService:a,_extHostDocumentsAndEditors:c}=this,l=new class{$changeMany(f,m){n.$changeMany(f,m),o.trace("[DiagnosticCollection] change many (extension, owner, uris)",e.value,f,m.length===0?"CLEARING":m)}$clear(f){n.$clear(f),o.trace("[DiagnosticCollection] remove all (extension, owner)",e.value,f)}dispose(){n.dispose()}};let u;if(!t)t="_generated_diagnostic_collection_name_#"+wr._idPool++,u=t;else if(!i.has(t))u=t;else{this._logService.warn(`DiagnosticCollection with name '${t}' does already exist.`);do u=t+wr._idPool++;while(i.has(u))}return new class extends hp{constructor(){super(t,u,wr._maxDiagnosticsTotal,wr._maxDiagnosticsPerFile,f=>{var m;return(m=c.getDocument(f))==null?void 0:m.version},a.extUri,l,s),i.set(u,this)}dispose(){super.dispose(),i.delete(u)}}}getDiagnostics(e){if(e)return this._getDiagnostics(e);{const t=new Map,i=[];for(const n of this._collections.values())n.forEach((s,o)=>{let a=t.get(s.toString());typeof a>"u"&&(a=i.length,t.set(s.toString(),a),i.push([s,[]])),i[a][1]=i[a][1].concat(...o)});return i}}_getDiagnostics(e){let t=[];for(const i of this._collections.values())i.has(e)&&(t=t.concat(i.get(e)));return t}$acceptMarkersChange(e){if(!this._mirrorCollection){const t="_generated_mirror",i=new hp(t,t,Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,n=>{},this._fileSystemInfoService.extUri,void 0,this._onDidChangeDiagnostics);this._collections.set(t,i),this._mirrorCollection=i}for(const[t,i]of e)this._mirrorCollection.set(x.revive(t),i.map(ec.to))}},wr=Hr,Hr._idPool=0,Hr._maxDiagnosticsPerFile=1e3,Hr._maxDiagnosticsTotal=1.1*wr._maxDiagnosticsPerFile,Hr);L_=wr=U([M(1,Je),M(2,xc)],L_);class FP{constructor(e){this._proxy=e.getProxy(J.MainThreadDialogs)}showOpenDialog(e,t){return t!=null&&t.allowUIResources&&O(e,"showLocal"),this._proxy.$showOpenDialog(t).then(i=>i?i.map(n=>x.revive(n)):void 0)}showSaveDialog(e){return this._proxy.$showSaveDialog(e).then(t=>t?x.revive(t):void 0)}}const Lp=class Lp{constructor(e,t,i){this._documentsAndEditors=t,this._logService=i,this._documentContentProviders=new Map,this._proxy=e.getProxy(J.MainThreadDocumentContentProviders)}registerTextDocumentContentProvider(e,t){if(Object.keys(ne).indexOf(e)>=0)throw new Error(`scheme '${e}' already registered`);const i=Lp._handlePool++;this._documentContentProviders.set(i,t),this._proxy.$registerTextContentProvider(i,e);let n;if(typeof t.onDidChange=="function"){let s;n=t.onDidChange(async o=>{if(o.scheme!==e){this._logService.warn(`Provider for scheme '${e}' is firing event for schema '${o.scheme}' which will be IGNORED`);return}if(!this._documentsAndEditors.getDocument(o))return;s&&await s;const a=this.$provideTextDocumentContent(i,o).then(async c=>{if(!c&&typeof c!="string")return;const l=this._documentsAndEditors.getDocument(o);if(!l)return;const u=Tx(c);if(!l.equalLines(u))return this._proxy.$onVirtualDocumentChange(o,c)}).catch(nn).finally(()=>{s===a&&(s=void 0)});s=a})}return new Ne(()=>{this._documentContentProviders.delete(i)&&this._proxy.$unregisterTextContentProvider(i),n&&(n.dispose(),n=void 0)})}$provideTextDocumentContent(e,t){const i=this._documentContentProviders.get(e);return i?Promise.resolve(i.provideTextDocumentContent(x.revive(t),bt.None)):Promise.reject(new Error(`unsupported uri-scheme: ${t.scheme}`))}};Lp._handlePool=0;let $_=Lp;class OP{constructor(e,t,i,n={timeout:1500,errors:3}){this._logService=e,this._documents=t,this._mainThreadBulkEdits=i,this._thresholds=n,this._callbacks=new Yu,this._badListeners=new WeakMap}dispose(){this._callbacks.clear()}getOnWillSaveTextDocumentEvent(e){return(t,i,n)=>{const o={dispose:this._callbacks.push([t,i,e])};return Array.isArray(n)&&n.push(o),o}}async $participateInSave(e,t){const i=x.revive(e);let n=!1;const s=setTimeout(()=>n=!0,this._thresholds.timeout),o=[];try{for(const a of[...this._callbacks]){if(n)break;const c=this._documents.getDocument(i),l=await this._deliverEventAsyncAndBlameBadListeners(a,{document:c,reason:Ff.to(t)});o.push(l)}}finally{clearTimeout(s)}return o}_deliverEventAsyncAndBlameBadListeners([e,t,i],n){const s=this._badListeners.get(e);return typeof s=="number"&&s>this._thresholds.errors?Promise.resolve(!1):this._deliverEventAsync(i,e,t,n).then(()=>!0,o=>{if(this._logService.error(`onWillSaveTextDocument-listener from extension '${i.identifier.value}' threw ERROR`),this._logService.error(o),!(o instanceof Error)||o.message!=="concurrent_edits"){const a=this._badListeners.get(e);this._badListeners.set(e,a?a+1:1),typeof a=="number"&&a>this._thresholds.errors&&this._logService.info(`onWillSaveTextDocument-listener from extension '${i.identifier.value}' will now be IGNORED because of timeouts and/or errors`)}return!1})}_deliverEventAsync(e,t,i,n){const s=[],o=Date.now(),{document:a,reason:c}=n,{version:l}=a,u=Object.freeze({document:a,reason:c,waitUntil(d){if(Object.isFrozen(s))throw fw("waitUntil can not be called async");s.push(Promise.resolve(d))}});try{t.apply(i,[u])}catch(d){return Promise.reject(d)}return new Promise((d,f)=>{const m=setTimeout(()=>f(new Error("timeout")),this._thresholds.timeout);return Promise.all(s).then(b=>{this._logService.debug(`onWillSaveTextDocument-listener from extension '${e.identifier.value}' finished after ${Date.now()-o}ms`),clearTimeout(m),d(b)}).catch(b=>{clearTimeout(m),f(b)})}).then(d=>{const f={edits:[]};for(const m of d)if(Array.isArray(m)&&m.every(b=>b instanceof Xr))for(const{newText:b,newEol:_,range:v}of m)f.edits.push({resource:a.uri,versionId:void 0,textEdit:{range:v&&H.from(v),text:b,eol:_&&rc.from(_)}});if(f.edits.length!==0)return l===a.version?this._mainThreadBulkEdits.$tryApplyWorkspaceEdit(new Di(f)):Promise.reject(new Error("concurrent_edits"))})}}class HP{constructor(e,t){this._onDidAddDocument=new R,this._onDidRemoveDocument=new R,this._onDidChangeDocument=new R,this._onDidSaveDocument=new R,this.onDidAddDocument=this._onDidAddDocument.event,this.onDidRemoveDocument=this._onDidRemoveDocument.event,this.onDidChangeDocument=this._onDidChangeDocument.event,this.onDidSaveDocument=this._onDidSaveDocument.event,this._toDispose=new Te,this._documentLoader=new Map,this._proxy=e.getProxy(J.MainThreadDocuments),this._documentsAndEditors=t,this._documentsAndEditors.onDidRemoveDocuments(i=>{for(const n of i)this._onDidRemoveDocument.fire(n.document)},void 0,this._toDispose),this._documentsAndEditors.onDidAddDocuments(i=>{for(const n of i)this._onDidAddDocument.fire(n.document)},void 0,this._toDispose)}dispose(){this._toDispose.dispose()}getAllDocumentData(){return[...this._documentsAndEditors.allDocuments()]}getDocumentData(e){if(!e)return;const t=this._documentsAndEditors.getDocument(e);if(t)return t}getDocument(e){const t=this.getDocumentData(e);if(!(t!=null&&t.document))throw new Error(`Unable to retrieve document from URI '${e}'`);return t.document}ensureDocumentData(e){const t=this._documentsAndEditors.getDocument(e);if(t)return Promise.resolve(t);let i=this._documentLoader.get(e.toString());return i||(i=this._proxy.$tryOpenDocument(e).then(n=>{this._documentLoader.delete(e.toString());const s=x.revive(n);return Oa(this._documentsAndEditors.getDocument(s))},n=>(this._documentLoader.delete(e.toString()),Promise.reject(n))),this._documentLoader.set(e.toString(),i)),i}createDocumentData(e){return this._proxy.$tryCreateDocument(e).then(t=>x.revive(t))}$acceptModelLanguageChanged(e,t){const i=x.revive(e),n=this._documentsAndEditors.getDocument(i);if(!n)throw new Error("unknown document");this._onDidRemoveDocument.fire(n.document),n._acceptLanguageId(t),this._onDidAddDocument.fire(n.document)}$acceptModelSaved(e){const t=x.revive(e),i=this._documentsAndEditors.getDocument(t);if(!i)throw new Error("unknown document");this.$acceptDirtyStateChanged(e,!1),this._onDidSaveDocument.fire(i.document)}$acceptDirtyStateChanged(e,t){const i=x.revive(e),n=this._documentsAndEditors.getDocument(i);if(!n)throw new Error("unknown document");n._acceptIsDirty(t),this._onDidChangeDocument.fire({document:n.document,contentChanges:[],reason:void 0})}$acceptModelChanged(e,t,i){const n=x.revive(e),s=this._documentsAndEditors.getDocument(n);if(!s)throw new Error("unknown document");s._acceptIsDirty(i),s.onEvents(t);let o;t.isUndoing?o=Jl.Undo:t.isRedoing&&(o=Jl.Redo),this._onDidChangeDocument.fire(zx({document:s.document,contentChanges:t.changes.map(a=>({range:H.to(a.range),rangeOffset:a.rangeOffset,rangeLength:a.rangeLength,text:a.text})),reason:o}))}setWordDefinitionFor(e,t){E8(e,t)}}class UP{constructor(e){this._AiEmbeddingVectorProviders=new Map,this._nextHandle=0,this._proxy=e.getProxy(J.MainThreadAiEmbeddingVector)}async $provideAiEmbeddingVector(e,t,i){if(this._AiEmbeddingVectorProviders.size===0)throw new Error("No embedding vector providers registered");const n=this._AiEmbeddingVectorProviders.get(e);if(!n)throw new Error("Embedding vector provider not found");const s=await n.provideEmbeddingVector(t,i);if(!s)throw new Error("Embedding vector provider returned undefined");return s}registerEmbeddingVectorProvider(e,t,i){const n=this._nextHandle;return this._nextHandle++,this._AiEmbeddingVectorProviders.set(n,i),this._proxy.$registerAiEmbeddingVectorProvider(t,n),new Ne(()=>{this._proxy.$unregisterAiEmbeddingVectorProvider(n),this._AiEmbeddingVectorProviders.delete(n)})}}class BP{constructor(e,t,i){const n=new Uint8Array(e*t);for(let s=0,o=e*t;s<o;s++)n[s]=i;this._data=n,this.rows=e,this.cols=t}get(e,t){return this._data[e*this.cols+t]}set(e,t,i){this._data[e*this.cols+t]=i}}class RS{constructor(e){let t=0,i=0;for(let s=0,o=e.length;s<o;s++){const[a,c,l]=e[s];c>t&&(t=c),a>i&&(i=a),l>i&&(i=l)}t++,i++;const n=new BP(i,t,0);for(let s=0,o=e.length;s<o;s++){const[a,c,l]=e[s];n.set(a,c,l)}this._states=n,this._maxCharCode=t}nextState(e,t){return t<0||t>=this._maxCharCode?0:this._states.get(e,t)}}let am=null;function VP(){return am===null&&(am=new RS([[1,104,2],[1,72,2],[1,102,6],[1,70,6],[2,116,3],[2,84,3],[3,116,4],[3,84,4],[4,112,5],[4,80,5],[5,115,9],[5,83,9],[5,58,10],[6,105,7],[6,73,7],[7,108,8],[7,76,8],[8,101,9],[8,69,9],[9,58,10],[10,47,11],[11,47,12]])),am}let Uc=null;function WP(){if(Uc===null){Uc=new hg(0);const r=` 	<>'"、。｡､，．：；‘〈「『〔（［｛｢｣｝］）〕』」〉’｀～…`;for(let t=0;t<r.length;t++)Uc.set(r.charCodeAt(t),1);const e=".,;:";for(let t=0;t<e.length;t++)Uc.set(e.charCodeAt(t),2)}return Uc}class fp{static _createLink(e,t,i,n,s){let o=s-1;do{const a=t.charCodeAt(o);if(e.get(a)!==2)break;o--}while(o>n);if(n>0){const a=t.charCodeAt(n-1),c=t.charCodeAt(o);(a===40&&c===41||a===91&&c===93||a===123&&c===125)&&o--}return{range:{startLineNumber:i,startColumn:n+1,endLineNumber:i,endColumn:o+2},url:t.substring(n,o+1)}}static computeLinks(e,t=VP()){const i=WP(),n=[];for(let s=1,o=e.getLineCount();s<=o;s++){const a=e.getLineContent(s),c=a.length;let l=0,u=0,d=0,f=1,m=!1,b=!1,_=!1,v=!1;for(;l<c;){let k=!1;const D=a.charCodeAt(l);if(f===13){let E;switch(D){case 40:m=!0,E=0;break;case 41:E=m?0:1;break;case 91:_=!0,b=!0,E=0;break;case 93:_=!1,E=b?0:1;break;case 123:v=!0,E=0;break;case 125:E=v?0:1;break;case 39:case 34:case 96:d===D?E=1:d===39||d===34||d===96?E=0:E=1;break;case 42:E=d===42?1:0;break;case 124:E=d===124?1:0;break;case 32:E=_?0:1;break;default:E=i.get(D)}E===1&&(n.push(fp._createLink(i,a,s,u,l)),k=!0)}else if(f===12){let E;D===91?(b=!0,E=0):E=i.get(D),E===1?k=!0:f=13}else f=t.nextState(f,D),f===0&&(k=!0);k&&(f=1,m=!1,b=!1,v=!1,u=l+1,d=D),l++}f===13&&n.push(fp._createLink(i,a,s,u,c))}return n}}class zP{constructor(){this._schemes=[]}add(e){this._stateMachine=void 0,this._schemes.push(e)}delete(e){const t=this._schemes.indexOf(e);t>=0&&(this._schemes.splice(t,1),this._stateMachine=void 0)}_initStateMachine(){if(!this._stateMachine){const e=this._schemes.sort(),t=[];let i,n,s=14,o=14;for(const a of e){let c=i?fE(i,a):0;for(c===0?n=1:n=o;c<a.length;c++)c+1===a.length?(s=o,o=9):o+=1,t.push([n,a.toUpperCase().charCodeAt(c),o]),t.push([n,a.toLowerCase().charCodeAt(c),o]),n=o;i=a,o=s}t.push([9,58,10]),t.push([10,47,12]),this._stateMachine=new RS(t)}}provideDocumentLinks(e){this._initStateMachine();const t=[],i=fp.computeLinks({getLineContent(n){return e.lineAt(n-1).text},getLineCount(){return e.lineCount}},this._stateMachine);for(const n of i){const s=oo.to(n);s.target&&t.push(s)}return t}}class pp{constructor(e,t){this._extHostLanguageFeatures=t,this._linkProvider=new zP,this._fsProvider=new Map,this._registeredSchemes=new Set,this._watches=new Map,this._handlePool=0,this._proxy=e.getProxy(J.MainThreadFileSystem)}dispose(){var e;(e=this._linkProviderRegistration)==null||e.dispose()}registerFileSystemProvider(e,t,i,n={}){if(pp._validateFileSystemProvider(i),this._registeredSchemes.has(t))throw new Error(`a provider for the scheme '${t}' is already registered`);this._linkProviderRegistration||(this._linkProviderRegistration=this._extHostLanguageFeatures.registerDocumentLinkProvider(e,"*",this._linkProvider));const s=this._handlePool++;this._linkProvider.add(t),this._registeredSchemes.add(t),this._fsProvider.set(s,i);let o=2;n.isCaseSensitive&&(o+=1024),n.isReadonly&&(o+=2048),typeof i.copy=="function"&&(o+=8),typeof i.open=="function"&&typeof i.close=="function"&&typeof i.read=="function"&&typeof i.write=="function"&&(O(e,"fsChunks"),o+=4);let a;n.isReadonly&&bo(n.isReadonly)&&n.isReadonly.value!==""&&(a={value:n.isReadonly.value,isTrusted:n.isReadonly.isTrusted,supportThemeIcons:n.isReadonly.supportThemeIcons,supportHtml:n.isReadonly.supportHtml,baseUri:n.isReadonly.baseUri,uris:n.isReadonly.uris}),this._proxy.$registerFileSystemProvider(s,t,o,a).catch(l=>{console.error(`FAILED to register filesystem provider of ${e.identifier.value}-extension for the scheme ${t}`),console.error(l)});const c=i.onDidChangeFile(l=>{const u=[];for(const d of l){const{uri:f,type:m}=d;if(f.scheme!==t)continue;let b;switch(m){case ha.Changed:b=0;break;case ha.Created:b=1;break;case ha.Deleted:b=2;break;default:throw new Error("Unknown FileChangeType")}u.push({resource:f,type:b})}this._proxy.$onFileSystemChange(s,u)});return De(()=>{c.dispose(),this._linkProvider.delete(t),this._registeredSchemes.delete(t),this._fsProvider.delete(s),this._proxy.$unregisterProvider(s)})}static _validateFileSystemProvider(e){if(!e)throw new Error("MISSING provider");if(typeof e.watch!="function")throw new Error("Provider does NOT implement watch");if(typeof e.stat!="function")throw new Error("Provider does NOT implement stat");if(typeof e.readDirectory!="function")throw new Error("Provider does NOT implement readDirectory");if(typeof e.createDirectory!="function")throw new Error("Provider does NOT implement createDirectory");if(typeof e.readFile!="function")throw new Error("Provider does NOT implement readFile");if(typeof e.writeFile!="function")throw new Error("Provider does NOT implement writeFile");if(typeof e.delete!="function")throw new Error("Provider does NOT implement delete");if(typeof e.rename!="function")throw new Error("Provider does NOT implement rename")}static _asIStat(e){const{type:t,ctime:i,mtime:n,size:s,permissions:o}=e;return{type:t,ctime:i,mtime:n,size:s,permissions:o}}$stat(e,t){return Promise.resolve(this._getFsProvider(e).stat(x.revive(t))).then(i=>pp._asIStat(i))}$readdir(e,t){return Promise.resolve(this._getFsProvider(e).readDirectory(x.revive(t)))}$readFile(e,t){return Promise.resolve(this._getFsProvider(e).readFile(x.revive(t))).then(i=>_e.wrap(i))}$writeFile(e,t,i,n){return Promise.resolve(this._getFsProvider(e).writeFile(x.revive(t),i.buffer,n))}$delete(e,t,i){return Promise.resolve(this._getFsProvider(e).delete(x.revive(t),i))}$rename(e,t,i,n){return Promise.resolve(this._getFsProvider(e).rename(x.revive(t),x.revive(i),n))}$copy(e,t,i,n){const s=this._getFsProvider(e);if(!s.copy)throw new Error('FileSystemProvider does not implement "copy"');return Promise.resolve(s.copy(x.revive(t),x.revive(i),n))}$mkdir(e,t){return Promise.resolve(this._getFsProvider(e).createDirectory(x.revive(t)))}$watch(e,t,i,n){const s=this._getFsProvider(e).watch(x.revive(i),n);this._watches.set(t,s)}$unwatch(e,t){const i=this._watches.get(t);i&&(i.dispose(),this._watches.delete(t))}$open(e,t,i){const n=this._getFsProvider(e);if(!n.open)throw new Error('FileSystemProvider does not implement "open"');return Promise.resolve(n.open(x.revive(t),i))}$close(e,t){const i=this._getFsProvider(e);if(!i.close)throw new Error('FileSystemProvider does not implement "close"');return Promise.resolve(i.close(t))}$read(e,t,i,n){const s=this._getFsProvider(e);if(!s.read)throw new Error('FileSystemProvider does not implement "read"');const o=_e.alloc(n);return Promise.resolve(s.read(t,i,o.buffer,0,n)).then(a=>o.slice(0,a))}$write(e,t,i,n){const s=this._getFsProvider(e);if(!s.write)throw new Error('FileSystemProvider does not implement "write"');return Promise.resolve(s.write(t,i,n.buffer,0,n.byteLength))}_getFsProvider(e){const t=this._fsProvider.get(e);if(!t){const i=new Error;throw i.name="ENOPRO",i.message="no provider",i}return t}}class jP{get ignoreCreateEvents(){return!!(this._config&1)}get ignoreChangeEvents(){return!!(this._config&2)}get ignoreDeleteEvents(){return!!(this._config&4)}constructor(e,t,i,n,s,o){this.session=Math.random(),this._onDidCreate=new R,this._onDidChange=new R,this._onDidDelete=new R,this._config=0,o!=null&&o.ignoreCreateEvents&&(this._config+=1),o!=null&&o.ignoreChangeEvents&&(this._config+=2),o!=null&&o.ignoreDeleteEvents&&(this._config+=4);const a=Va(s),c=typeof s=="string",l=o==null?void 0:o.correlate,u=n(d=>{if(!(typeof d.session=="number"&&d.session!==this.session)&&!(l&&typeof d.session>"u")){if(!(o!=null&&o.ignoreCreateEvents))for(const f of d.created){const m=x.revive(f);a(m.fsPath)&&(!c||t.getWorkspaceFolder(m))&&this._onDidCreate.fire(m)}if(!(o!=null&&o.ignoreChangeEvents))for(const f of d.changed){const m=x.revive(f);a(m.fsPath)&&(!c||t.getWorkspaceFolder(m))&&this._onDidChange.fire(m)}if(!(o!=null&&o.ignoreDeleteEvents))for(const f of d.deleted){const m=x.revive(f);a(m.fsPath)&&(!c||t.getWorkspaceFolder(m))&&this._onDidDelete.fire(m)}}});this._disposable=Ne.from(this.ensureWatching(e,i,s,o,o==null?void 0:o.correlate),this._onDidCreate,this._onDidChange,this._onDidDelete,u)}ensureWatching(e,t,i,n,s){const o=Ne.from();if(typeof i=="string"||n!=null&&n.ignoreChangeEvents&&(n!=null&&n.ignoreCreateEvents)&&(n!=null&&n.ignoreDeleteEvents))return o;const a=e.getProxy(J.MainThreadFileSystemEventService);let c=!1;(i.pattern.includes(Gc)||i.pattern.includes(Ym))&&(c=!0);let l;return s&&(n!=null&&n.ignoreChangeEvents||n!=null&&n.ignoreCreateEvents||n!=null&&n.ignoreDeleteEvents)&&(l=14,n!=null&&n.ignoreChangeEvents&&(l&=-3),n!=null&&n.ignoreCreateEvents&&(l&=-5),n!=null&&n.ignoreDeleteEvents&&(l&=-9)),a.$watch(t.identifier.value,this.session,i.baseUri,{recursive:c,excludes:(n==null?void 0:n.excludes)??[],filter:l},!!s),Ne.from({dispose:()=>a.$unwatch(this.session)})}dispose(){this._disposable.dispose()}get onDidCreate(){return this._onDidCreate.event}get onDidChange(){return this._onDidChange.event}get onDidDelete(){return this._onDidDelete.event}}class qP{constructor(e){this._events=e,this.session=this._events.session,this._created=new Xn(()=>this._events.created.map(x.revive)),this._changed=new Xn(()=>this._events.changed.map(x.revive)),this._deleted=new Xn(()=>this._events.deleted.map(x.revive))}get created(){return this._created.value}get changed(){return this._changed.value}get deleted(){return this._deleted.value}}class GP{constructor(e,t,i){this._mainContext=e,this._logService=t,this._extHostDocumentsAndEditors=i,this._onFileSystemEvent=new R,this._onDidRenameFile=new R,this._onDidCreateFile=new R,this._onDidDeleteFile=new R,this._onWillRenameFile=new il,this._onWillCreateFile=new il,this._onWillDeleteFile=new il,this.onDidRenameFile=this._onDidRenameFile.event,this.onDidCreateFile=this._onDidCreateFile.event,this.onDidDeleteFile=this._onDidDeleteFile.event}createFileSystemWatcher(e,t,i,n){return new jP(this._mainContext,e,t,this._onFileSystemEvent.event,mi.from(i),n)}$onFileEvent(e){this._onFileSystemEvent.fire(new qP(e))}$onDidRunFileOperation(e,t){switch(e){case 2:this._onDidRenameFile.fire(Object.freeze({files:t.map(i=>({oldUri:x.revive(i.source),newUri:x.revive(i.target)}))}));break;case 1:this._onDidDeleteFile.fire(Object.freeze({files:t.map(i=>x.revive(i.target))}));break;case 0:case 3:this._onDidCreateFile.fire(Object.freeze({files:t.map(i=>x.revive(i.target))}));break}}getOnWillRenameFileEvent(e){return this._createWillExecuteEvent(e,this._onWillRenameFile)}getOnWillCreateFileEvent(e){return this._createWillExecuteEvent(e,this._onWillCreateFile)}getOnWillDeleteFileEvent(e){return this._createWillExecuteEvent(e,this._onWillDeleteFile)}_createWillExecuteEvent(e,t){return(i,n,s)=>{const o=function(c){i.call(n,c)};return o.extension=e,t.event(o,void 0,s)}}async $onWillRunFileOperation(e,t,i,n){switch(e){case 2:return await this._fireWillEvent(this._onWillRenameFile,{files:t.map(s=>({oldUri:x.revive(s.source),newUri:x.revive(s.target)}))},i,n);case 1:return await this._fireWillEvent(this._onWillDeleteFile,{files:t.map(s=>x.revive(s.target))},i,n);case 0:case 3:return await this._fireWillEvent(this._onWillCreateFile,{files:t.map(s=>x.revive(s.target))},i,n)}}async _fireWillEvent(e,t,i,n){const s=new Set,o=[];if(await e.fireAsync(t,n,async(c,l)=>{const u=Date.now(),d=await Promise.resolve(c);d instanceof Zr&&(o.push([l.extension,d]),s.add(l.extension.displayName??l.extension.identifier.value)),Date.now()-u>i&&this._logService.warn("SLOW file-participant",l.extension.identifier)}),n.isCancellationRequested||o.length===0)return;const a={edits:[]};for(const[,c]of o){const{edits:l}=Wt.from(c,{getTextDocumentVersion:u=>{var d;return(d=this._extHostDocumentsAndEditors.getDocument(u))==null?void 0:d.version},getNotebookDocumentVersion:()=>{}});a.edits=a.edits.concat(l)}return{edit:a,extensionNames:Array.from(s)}}}const $p=class $p{constructor(e,t){this.extension=e,this.provider=t,this.handle=$p._pool++}};$p._pool=0;let N_=$p;class QP{constructor(e){this.session=e,this.responses=[]}}const Dl=class Dl{constructor(e,t,i,n){this._documents=i,this._logService=n,this._inputProvider=new Map,this._inputSessions=new Map,this._proxy=e.getProxy(J.MainThreadInlineChat),t.registerApiCommand(new be("vscode.editorChat.start","inlineChat.start","Invoke a new editor chat session",[new z("Run arguments","",s=>!0,s=>{if(s)return{initialRange:s.initialRange?H.from(s.initialRange):void 0,initialSelection:sr.isSelection(s.initialSelection)?Fi.from(s.initialSelection):void 0,message:s.message,autoSend:s.autoSend,position:s.position?qe.from(s.position):void 0}})],ve.Void))}registerProvider(e,t,i){const n=new N_(e,t);return this._inputProvider.set(n.handle,n),this._proxy.$registerInteractiveEditorProvider(n.handle,(i==null?void 0:i.label)??e.displayName??e.name,e.identifier,typeof t.handleInteractiveEditorResponseFeedback=="function",typeof t.provideFollowups=="function",(i==null?void 0:i.supportReportIssue)??!1),De(()=>{this._proxy.$unregisterInteractiveEditorProvider(n.handle),this._inputProvider.delete(n.handle)})}async $prepareSession(e,t,i,n){var u;const s=this._inputProvider.get(e);if(!s){this._logService.warn("CANNOT prepare session because the PROVIDER IS GONE");return}const o=this._documents.getDocument(x.revive(t)),a=Fi.to(i),c=await s.provider.prepareInteractiveEditorSession({document:o,selection:a},n);if(!c)return;if(c.wholeRange&&!c.wholeRange.contains(a))throw new Error("InteractiveEditorSessionProvider returned a wholeRange that does not contain the selection.");const l=Dl._nextId++;return this._inputSessions.set(l,new QP(c)),{id:l,placeholder:c.placeholder,input:c.input,slashCommands:(u=c.slashCommands)==null?void 0:u.map(d=>({command:d.command,detail:d.detail,refer:d.refer,executeImmediately:d.executeImmediately})),wholeRange:H.from(c.wholeRange),message:c.message}}async $provideResponse(e,t,i,n){const s=this._inputProvider.get(e);if(!s)return;const o=this._inputSessions.get(t.id);if(!o)return;const a={prompt:i.prompt,selection:Fi.to(i.selection),wholeRange:H.to(i.wholeRange),attempt:i.attempt,live:i.live,previewDocument:this._documents.getDocument(x.revive(i.previewDocument)),withIntentDetection:i.withIntentDetection};let c=!1;const l={report:async k=>{var D,E,N;if(!i.live&&((D=k.edits)!=null&&D.length))throw new Error("Progress reporting is only supported for live sessions");c||n.isCancellationRequested||await this._proxy.$handleProgressChunk(i.requestId,{message:k.message,edits:(E=k.edits)==null?void 0:E.map(yt.from),editsShouldBeInstant:k.editsShouldBeInstant,slashCommand:(N=k.slashCommand)==null?void 0:N.command,markdownFragment:Ti.isMarkdownString(k.content)?k.content.value:k.content})}},u=Promise.resolve(s.provider.provideInteractiveEditorResponse(o.session,a,l,n));let d;try{d=await Fm(u,n)}finally{c=!0}if(!d)return;const f=o.responses.push(d)-1,m={wholeRange:H.from(d.wholeRange),placeholder:d.placeholder};if(!Dl._isEditResponse(d))return{...m,id:f,type:"editorEdit",message:Le.from(d.contents),edits:[]};const{edits:b,contents:_}=d,v=_!==void 0?Le.from(_):void 0;return b instanceof Zr?{...m,id:f,type:"bulkEdit",edits:Wt.from(b),message:v}:{...m,id:f,type:"editorEdit",edits:b.map(yt.from),message:v}}async $provideFollowups(e,t,i,n){const s=this._inputProvider.get(e),o=this._inputSessions.get(t),a=o==null?void 0:o.responses[i];if(s&&a&&s.provider.provideFollowups){const c=Promise.resolve(s.provider.provideFollowups(o.session,a,n)),l=await Fm(c,n);return l==null?void 0:l.map(mv.from)}}$handleFeedback(e,t,i,n){var c,l;const s=this._inputProvider.get(e),o=this._inputSessions.get(t),a=o==null?void 0:o.responses[i];if(s&&a){const u=vv.to(n);(l=(c=s.provider).handleInteractiveEditorResponseFeedback)==null||l.call(c,o.session,a,u)}}$releaseSession(e,t){}static _isEditResponse(e){return typeof e=="object"&&typeof e.edits=="object"}};Dl._nextId=0;let M_=Dl;class JP{constructor(e,t,i,n,s){this._extHostNotebooks=t,this._textDocumentsAndEditors=i,this._commands=n;const o=new be("interactive.open","_interactive.open","Open interactive window and return notebook editor and input URI",[new z("showOptions","Show Options",a=>!0,a=>a),new z("resource","Interactive resource Uri",a=>!0,a=>a),new z("controllerId","Notebook controller Id",a=>!0,a=>a),new z("title","Interactive editor title",a=>!0,a=>a)],new ve("Notebook and input URI",a=>{if(s.debug("[ExtHostInteractive] open iw with notebook editor id",a.notebookEditorId),a.notebookEditorId!==void 0){const c=this._extHostNotebooks.getEditorById(a.notebookEditorId);return s.debug("[ExtHostInteractive] notebook editor found",c.id),{notebookUri:x.revive(a.notebookUri),inputUri:x.revive(a.inputUri),notebookEditor:c.apiEditor}}return s.debug("[ExtHostInteractive] notebook editor not found, uris for the interactive document",a.notebookUri,a.inputUri),{notebookUri:x.revive(a.notebookUri),inputUri:x.revive(a.inputUri)}}));this._commands.registerApiCommand(o)}$willAddInteractiveDocument(e,t,i,n){this._textDocumentsAndEditors.acceptDocumentsAndEditorsDelta({addedDocuments:[{EOL:t,lines:[""],languageId:i,uri:e,isDirty:!1,versionId:1}]})}$willRemoveInteractiveDocument(e,t){this._textDocumentsAndEditors.acceptDocumentsAndEditorsDelta({removedDocuments:[e]})}}class KP{constructor(e){this._handlePool=0,this._proxy=e.getProxy(J.MainThreadLabelService)}$registerResourceLabelFormatter(e){const t=this._handlePool++;return this._proxy.$registerResourceLabelFormatter(t,e),De(()=>{this._proxy.$unregisterResourceLabelFormatter(t)})}}class xi extends Qe{constructor(e,t,i,n){super(e,t,i,n),this.selectionStartLineNumber=e,this.selectionStartColumn=t,this.positionLineNumber=i,this.positionColumn=n}toString(){return"["+this.selectionStartLineNumber+","+this.selectionStartColumn+" -> "+this.positionLineNumber+","+this.positionColumn+"]"}equalsSelection(e){return xi.selectionsEqual(this,e)}static selectionsEqual(e,t){return e.selectionStartLineNumber===t.selectionStartLineNumber&&e.selectionStartColumn===t.selectionStartColumn&&e.positionLineNumber===t.positionLineNumber&&e.positionColumn===t.positionColumn}getDirection(){return this.selectionStartLineNumber===this.startLineNumber&&this.selectionStartColumn===this.startColumn?0:1}setEndPosition(e,t){return this.getDirection()===0?new xi(this.startLineNumber,this.startColumn,e,t):new xi(e,t,this.startLineNumber,this.startColumn)}getPosition(){return new Mi(this.positionLineNumber,this.positionColumn)}getSelectionStart(){return new Mi(this.selectionStartLineNumber,this.selectionStartColumn)}setStartPosition(e,t){return this.getDirection()===0?new xi(e,t,this.endLineNumber,this.endColumn):new xi(this.endLineNumber,this.endColumn,e,t)}static fromPositions(e,t=e){return new xi(e.lineNumber,e.column,t.lineNumber,t.column)}static fromRange(e,t){return t===0?new xi(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn):new xi(e.endLineNumber,e.endColumn,e.startLineNumber,e.startColumn)}static liftSelection(e){return new xi(e.selectionStartLineNumber,e.selectionStartColumn,e.positionLineNumber,e.positionColumn)}static selectionsArrEqual(e,t){if(e&&!t||!e&&t)return!1;if(!e&&!t)return!0;if(e.length!==t.length)return!1;for(let i=0,n=e.length;i<n;i++)if(!this.selectionsEqual(e[i],t[i]))return!1;return!0}static isISelection(e){return e&&typeof e.selectionStartLineNumber=="number"&&typeof e.selectionStartColumn=="number"&&typeof e.positionLineNumber=="number"&&typeof e.positionColumn=="number"}static createWithDirection(e,t,i,n,s){return s===0?new xi(e,t,i,n):new xi(i,n,e,t)}}const LS="vs/workbench/api/common/extHostLanguageFeatures";class gp{constructor(e,t){this._documents=e,this._provider=t}async provideDocumentSymbols(e,t){const i=this._documents.getDocument(e),n=await this._provider.provideDocumentSymbols(i,t);if(!pw(n))return n[0]instanceof zl?n.map(X1.from):gp._asDocumentSymbolTree(n)}static _asDocumentSymbolTree(e){var n,s;e=e.slice(0).sort((o,a)=>{let c=o.location.range.start.compareTo(a.location.range.start);return c===0&&(c=a.location.range.end.compareTo(o.location.range.end)),c});const t=[],i=[];for(const o of e){const a={name:o.name||"!!MISSING: name!!",kind:Oi.from(o.kind),tags:((n=o.tags)==null?void 0:n.map(or.from))||[],detail:"",containerName:o.containerName,range:H.from(o.location.range),selectionRange:H.from(o.location.range),children:[]};for(;;){if(i.length===0){i.push(a),t.push(a);break}const c=i[i.length-1];if(Qe.containsRange(c.range,a.range)&&!Qe.equalsRange(c.range,a.range)){(s=c.children)==null||s.push(a),i.push(a);break}i.pop()}}return t}}class Md{constructor(e,t,i,n,s,o){this._documents=e,this._commands=t,this._provider=i,this._extension=n,this._extTelemetry=s,this._logService=o,this._cache=new Ri("CodeLens"),this._disposables=new Map}async provideCodeLenses(e,t){const i=this._documents.getDocument(e),n=await this._provider.provideCodeLenses(i,t);if(!n||t.isCancellationRequested)return;const s=this._cache.add(n),o=new Te;this._disposables.set(s,o);const a={cacheId:s,lenses:[]};for(let c=0;c<n.length;c++)a.lenses.push({cacheId:[s,c],range:H.from(n[c].range),command:this._commands.toInternal(n[c].command,o)});return a}async resolveCodeLens(e,t){const i=e.cacheId&&this._cache.get(...e.cacheId);if(!i)return;let n;if(typeof this._provider.resolveCodeLens!="function"||i.isResolved?n=i:n=await this._provider.resolveCodeLens(i,t),n||(n=i),t.isCancellationRequested)return;const s=e.cacheId&&this._disposables.get(e.cacheId[0]);if(s){if(!n.command){const o=new Error("INVALID code lens resolved, lacks command: "+this._extension.identifier.value);this._extTelemetry.onExtensionError(this._extension.identifier,o),this._logService.error(o);return}return e.command=this._commands.toInternal(n.command,s),e}}releaseCodeLenses(e){var t;(t=this._disposables.get(e))==null||t.dispose(),this._disposables.delete(e),this._cache.delete(e)}}function gg(r){return Array.isArray(r)?r.map(mu.from):r?[mu.from(r)]:[]}class _2{constructor(e,t){this._documents=e,this._provider=t}async provideDefinition(e,t,i){const n=this._documents.getDocument(e),s=qe.to(t),o=await this._provider.provideDefinition(n,s,i);return gg(o)}}class w2{constructor(e,t){this._documents=e,this._provider=t}async provideDeclaration(e,t,i){const n=this._documents.getDocument(e),s=qe.to(t),o=await this._provider.provideDeclaration(n,s,i);return gg(o)}}class b2{constructor(e,t){this._documents=e,this._provider=t}async provideImplementation(e,t,i){const n=this._documents.getDocument(e),s=qe.to(t),o=await this._provider.provideImplementation(n,s,i);return gg(o)}}class y2{constructor(e,t){this._documents=e,this._provider=t}async provideTypeDefinition(e,t,i){const n=this._documents.getDocument(e),s=qe.to(t),o=await this._provider.provideTypeDefinition(n,s,i);return gg(o)}}const Np=class Np{constructor(e,t){this._documents=e,this._provider=t,this._hoverCounter=0,this._hoverMap=new Map}async provideHover(e,t,i,n){const s=this._documents.getDocument(e),o=qe.to(t);let a;if(i&&i.verbosityRequest){const d=i.verbosityRequest.previousHover.id,f=this._hoverMap.get(d);if(!f)throw new Error(`Hover with id ${d} not found`);const m={action:i.verbosityRequest.action,previousHover:f};a=await this._provider.provideHover(s,o,n,m)}else a=await this._provider.provideHover(s,o,n);if(!a||pw(a.contents))return;a.range||(a.range=s.getWordRangeAtPosition(o)),a.range||(a.range=new xe(o,o));const c=If.from(a),l=this._hoverCounter;if(this._hoverMap.size===Np.HOVER_MAP_MAX_SIZE){const d=Math.min(...this._hoverMap.keys());this._hoverMap.delete(d)}return this._hoverMap.set(l,a),this._hoverCounter+=1,{...c,id:l}}releaseHover(e){this._hoverMap.delete(e)}};Np.HOVER_MAP_MAX_SIZE=10;let bl=Np;class x2{constructor(e,t){this._documents=e,this._provider=t}async provideEvaluatableExpression(e,t,i){const n=this._documents.getDocument(e),s=qe.to(t),o=await this._provider.provideEvaluatableExpression(n,s,i);if(o)return ev.from(o)}}class C2{constructor(e,t){this._documents=e,this._provider=t}async provideInlineValues(e,t,i,n){const s=this._documents.getDocument(e),o=await this._provider.provideInlineValues(s,H.to(t),Tf.to(i),n);if(Array.isArray(o))return o.map(a=>Pf.from(a))}}class S2{constructor(e,t){this._documents=e,this._provider=t}async provideDocumentHighlights(e,t,i){const n=this._documents.getDocument(e),s=qe.to(t),o=await this._provider.provideDocumentHighlights(n,s,i);if(Array.isArray(o))return o.map(ic.from)}}class E2{constructor(e,t){this._documents=e,this._provider=t}async provideMultiDocumentHighlights(e,t,i,n){const s=this._documents.getDocument(e),o=i.map(l=>this._documents.getDocument(l)),a=qe.to(t),c=await this._provider.provideMultiDocumentHighlights(s,a,o,n);if(Array.isArray(c))return c.map(tv.from)}}class k2{constructor(e,t){this._documents=e,this._provider=t}async provideLinkedEditingRanges(e,t,i){const n=this._documents.getDocument(e),s=qe.to(t),o=await this._provider.provideLinkedEditingRanges(n,s,i);if(o&&Array.isArray(o.ranges))return{ranges:ci(o.ranges.map(H.from)),wordPattern:o.wordPattern}}}class D2{constructor(e,t){this._documents=e,this._provider=t}async provideReferences(e,t,i,n){const s=this._documents.getDocument(e),o=qe.to(t),a=await this._provider.provideReferences(s,o,i,n);if(Array.isArray(a))return a.map(Ai.from)}}const na=class na{constructor(e,t,i,n,s,o,a){this._documents=e,this._commands=t,this._diagnostics=i,this._provider=n,this._logService=s,this._extension=o,this._apiDeprecation=a,this._cache=new Ri("CodeAction"),this._disposables=new Map}async provideCodeActions(e,t,i,n){var m;const s=this._documents.getDocument(e),o=xi.isISelection(t)?Fi.to(t):H.to(t),a=[];for(const b of this._diagnostics.getDiagnostics(e))if(o.intersection(b.range)&&a.push(b)>na._maxCodeActionsPerFile)break;const c={diagnostics:a,only:i.only?new ct(i.only):void 0,triggerKind:gv.to(i.trigger)},l=await this._provider.provideCodeActions(s,o,c,n);if(!Zu(l)||n.isCancellationRequested)return;const u=this._cache.add(l),d=new Te;this._disposables.set(u,d);const f=[];for(let b=0;b<l.length;b++){const _=l[b];if(_)if(na._isCommand(_))this._apiDeprecation.report("CodeActionProvider.provideCodeActions - return commands",this._extension,"Return 'CodeAction' instances instead."),f.push({_isSynthetic:!0,title:_.title,command:this._commands.toInternal(_,d)});else{c.only&&(_.kind?c.only.contains(_.kind)||this._logService.warn(`${this._extension.identifier.value} - Code actions of kind '${c.only.value} 'requested but returned code action is of kind '${_.kind.value}'. Code action will be dropped. Please check 'CodeActionContext.only' to only return requested code actions.`):this._logService.warn(`${this._extension.identifier.value} - Code actions of kind '${c.only.value} 'requested but returned code action does not have a 'kind'. Code action will be dropped. Please set 'CodeAction.kind'.`));const v=_.ranges??[];f.push({cacheId:[u,b],title:_.title,command:_.command&&this._commands.toInternal(_.command,d),diagnostics:_.diagnostics&&_.diagnostics.map(ec.from),edit:_.edit&&Wt.from(_.edit,void 0),kind:_.kind&&_.kind.value,isPreferred:_.isPreferred,isAI:Lt(this._extension,"codeActionAI")?_.isAI:!1,ranges:Lt(this._extension,"codeActionRanges")?ci(v.map(H.from)):void 0,disabled:(m=_.disabled)==null?void 0:m.reason})}}return{cacheId:u,actions:f}}async resolveCodeAction(e,t){const[i,n]=e,s=this._cache.get(i,n);if(!s||na._isCommand(s))return{};if(!this._provider.resolveCodeAction)return{};const o=await this._provider.resolveCodeAction(s,t)??s;let a;o.edit&&(a=Wt.from(o.edit,void 0));let c;if(o.command){const l=this._disposables.get(i);l&&(c=this._commands.toInternal(o.command,l))}return{edit:a,command:c}}releaseCodeActions(e){var t;(t=this._disposables.get(e))==null||t.dispose(),this._disposables.delete(e),this._cache.delete(e)}static _isCommand(e){return typeof e.command=="string"&&typeof e.title=="string"}};na._maxCodeActionsPerFile=1e3;let Go=na;class Bc{constructor(e,t,i,n,s){this._proxy=e,this._documents=t,this._provider=i,this._handle=n,this._extension=s,this._cache=new Ri("DocumentPasteEdit")}async prepareDocumentPaste(e,t,i,n){if(!this._provider.prepareDocumentPaste)return;const s=this._documents.getDocument(e),o=t.map(l=>H.to(l)),a=zr.toDataTransfer(i,()=>{throw new QS});if(await this._provider.prepareDocumentPaste(s,o,a,n),n.isCancellationRequested)return;const c=Array.from(a).filter(([,l])=>!(l instanceof nf));return zr.from(c)}async providePasteEdits(e,t,i,n,s,o){if(!this._provider.provideDocumentPasteEdits)return[];const a=this._documents.getDocument(t),c=i.map(f=>H.to(f)),l=zr.toDataTransfer(n,async f=>(await this._proxy.$resolvePasteFileData(this._handle,e,f)).buffer),u=await this._provider.provideDocumentPasteEdits(a,c,l,{only:s.only?new Qa(s.only):void 0,triggerKind:s.triggerKind},o);if(!u||o.isCancellationRequested)return[];const d=this._cache.add(u);return u.map((f,m)=>{var b;return{_cacheId:[d,m],title:f.title??h(LS,0,"Paste using '{0}' extension",this._extension.displayName||this._extension.name),kind:f.kind,yieldTo:(b=f.yieldTo)==null?void 0:b.map(_=>_.value),insertText:typeof f.insertText=="string"?f.insertText:{snippet:f.insertText.value},additionalEdit:f.additionalEdit?Wt.from(f.additionalEdit,void 0):void 0}})}async resolvePasteEdit(e,t){const[i,n]=e,s=this._cache.get(i,n);if(!s||!this._provider.resolveDocumentPasteEdit)return{};const o=await this._provider.resolveDocumentPasteEdit(s,t)??s;return{additionalEdit:o.additionalEdit?Wt.from(o.additionalEdit,void 0):void 0}}releasePasteEdits(e){this._cache.delete(e)}}class I2{constructor(e,t){this._documents=e,this._provider=t}async provideDocumentFormattingEdits(e,t,i){const n=this._documents.getDocument(e),s=await this._provider.provideDocumentFormattingEdits(n,t,i);if(Array.isArray(s))return s.map(yt.from)}}class cm{constructor(e,t){this._documents=e,this._provider=t}async provideDocumentRangeFormattingEdits(e,t,i,n){const s=this._documents.getDocument(e),o=H.to(t),a=await this._provider.provideDocumentRangeFormattingEdits(s,o,i,n);if(Array.isArray(a))return a.map(yt.from)}async provideDocumentRangesFormattingEdits(e,t,i,n){$x(typeof this._provider.provideDocumentRangesFormattingEdits=="function","INVALID invocation of `provideDocumentRangesFormattingEdits`");const s=this._documents.getDocument(e),o=t.map(H.to),a=await this._provider.provideDocumentRangesFormattingEdits(s,o,i,n);if(Array.isArray(a))return a.map(yt.from)}}class P2{constructor(e,t){this._documents=e,this._provider=t,this.autoFormatTriggerCharacters=[]}async provideOnTypeFormattingEdits(e,t,i,n,s){const o=this._documents.getDocument(e),a=qe.to(t),c=await this._provider.provideOnTypeFormattingEdits(o,a,i,n,s);if(Array.isArray(c))return c.map(yt.from)}}class Fd{constructor(e,t){this._provider=e,this._logService=t,this._cache=new Ri("WorkspaceSymbols")}async provideWorkspaceSymbols(e,t){const i=await this._provider.provideWorkspaceSymbols(e,t);if(!Zu(i))return{symbols:[]};const n=this._cache.add(i),s={cacheId:n,symbols:[]};for(let o=0;o<i.length;o++){const a=i[o];if(!a||!a.name){this._logService.warn("INVALID SymbolInformation",a);continue}s.symbols.push({...gu.from(a),cacheId:[n,o]})}return s}async resolveWorkspaceSymbol(e,t){if(typeof this._provider.resolveWorkspaceSymbol!="function"||!e.cacheId)return e;const i=this._cache.get(...e.cacheId);if(i){const n=await this._provider.resolveWorkspaceSymbol(i,t);return n&&po(e,gu.from(n),!0)}}releaseWorkspaceSymbols(e){this._cache.delete(e)}}class Ns{static supportsResolving(e){return typeof e.prepareRename=="function"}constructor(e,t,i){this._documents=e,this._provider=t,this._logService=i}async provideRenameEdits(e,t,i,n){const s=this._documents.getDocument(e),o=qe.to(t);try{const a=await this._provider.provideRenameEdits(s,o,i,n);return a?Wt.from(a):void 0}catch(a){const c=Ns._asMessage(a);return c?{rejectReason:c,edits:void 0}:Promise.reject(a)}}async resolveRenameLocation(e,t,i){if(typeof this._provider.prepareRename!="function")return Promise.resolve(void 0);const n=this._documents.getDocument(e),s=qe.to(t);try{const o=await this._provider.prepareRename(n,s,i);let a,c;if(xe.isRange(o)?(a=o,c=n.getText(o)):Vt(o)&&(a=o.range,c=o.placeholder),!a||!c)return;if(a.start.line>s.line||a.end.line<s.line){this._logService.warn("INVALID rename location: position line must be within range start/end lines");return}return{range:H.from(a),text:c}}catch(o){const a=Ns._asMessage(o);return a?{rejectReason:a,range:void 0,text:void 0}:Promise.reject(o)}}static _asMessage(e){return typeof e=="string"?e:e instanceof Error&&typeof e.message=="string"?e.message:void 0}}const Il=class Il{constructor(e,t,i){this._documents=e,this._provider=t,this._logService=i}async supportsAutomaticNewSymbolNamesTriggerKind(){return this._provider.supportsAutomaticTriggerKind}async provideNewSymbolNames(e,t,i,n){const s=this._documents.getDocument(e),o=H.to(t);try{const a=Il.languageTriggerKindToVSCodeTriggerKind[i],c=await this._provider.provideNewSymbolNames(s,o,a,n);return c?c.map(l=>typeof l=="string"?{newSymbolName:l}:{newSymbolName:l.newSymbolName,tags:l.tags}):void 0}catch(a){this._logService.error(Il._asMessage(a)??JSON.stringify(a,null,"	"));return}}static _asMessage(e){return typeof e=="string"?e:e instanceof Error&&typeof e.message=="string"?e.message:void 0}};Il.languageTriggerKindToVSCodeTriggerKind={[Ch.Invoke]:tu.Invoke,[Ch.Automatic]:tu.Automatic};let yl=Il;class lm{constructor(e,t){this.resultId=e,this.tokens=t}}class fi{constructor(e,t){this._documents=e,this._provider=t,this._nextResultId=1,this._previousResults=new Map}async provideDocumentSemanticTokens(e,t,i){const n=this._documents.getDocument(e),s=t!==0?this._previousResults.get(t):null;let o=typeof(s==null?void 0:s.resultId)=="string"&&typeof this._provider.provideDocumentSemanticTokensEdits=="function"?await this._provider.provideDocumentSemanticTokensEdits(n,s.resultId,i):await this._provider.provideDocumentSemanticTokens(n,i);return s&&this._previousResults.delete(t),o?(o=fi._fixProvidedSemanticTokens(o),this._send(fi._convertToEdits(s,o),o)):null}async releaseDocumentSemanticColoring(e){this._previousResults.delete(e)}static _fixProvidedSemanticTokens(e){return fi._isSemanticTokens(e)?fi._isCorrectSemanticTokens(e)?e:new Ka(new Uint32Array(e.data),e.resultId):fi._isSemanticTokensEdits(e)?fi._isCorrectSemanticTokensEdits(e)?e:new th(e.edits.map(t=>new TC(t.start,t.deleteCount,t.data?new Uint32Array(t.data):t.data)),e.resultId):e}static _isSemanticTokens(e){return e&&!!e.data}static _isCorrectSemanticTokens(e){return e.data instanceof Uint32Array}static _isSemanticTokensEdits(e){return e&&Array.isArray(e.edits)}static _isCorrectSemanticTokensEdits(e){for(const t of e.edits)if(!(t.data instanceof Uint32Array))return!1;return!0}static _convertToEdits(e,t){if(!fi._isSemanticTokens(t)||!e||!e.tokens)return t;const i=e.tokens,n=i.length,s=t.data,o=s.length;let a=0;const c=Math.min(n,o);for(;a<c&&i[a]===s[a];)a++;if(a===n&&a===o)return new th([],t.resultId);let l=0;const u=c-a;for(;l<u&&i[n-l-1]===s[o-l-1];)l++;return new th([{start:a,deleteCount:n-a-l,data:s.subarray(a,o-l)}],t.resultId)}_send(e,t){if(fi._isSemanticTokens(e)){const i=this._nextResultId++;return this._previousResults.set(i,new lm(e.resultId,e.data)),I_({id:i,type:"full",data:e.data})}if(fi._isSemanticTokensEdits(e)){const i=this._nextResultId++;return fi._isSemanticTokens(t)?this._previousResults.set(i,new lm(t.resultId,t.data)):this._previousResults.set(i,new lm(e.resultId)),I_({id:i,type:"delta",deltas:(e.edits||[]).map(n=>({start:n.start,deleteCount:n.deleteCount,data:n.data}))})}return null}}class T2{constructor(e,t){this._documents=e,this._provider=t}async provideDocumentRangeSemanticTokens(e,t,i){const n=this._documents.getDocument(e),s=await this._provider.provideDocumentRangeSemanticTokens(n,H.to(t),i);return s?this._send(s):null}_send(e){return I_({id:0,type:"full",data:e.data})}}class ms{static supportsResolving(e){return typeof e.resolveCompletionItem=="function"}constructor(e,t,i,n,s){this._documents=e,this._commands=t,this._provider=i,this._apiDeprecation=n,this._extension=s,this._cache=new Ri("CompletionItem"),this._disposables=new Map}async provideCompletionItems(e,t,i,n){const s=this._documents.getDocument(e),o=qe.to(t),a=s.getWordRangeAtPosition(o)||new xe(o,o),c=a.with({end:o}),l=new rr,u=await this._provider.provideCompletionItems(s,o,n,nv.to(i));if(!u||n.isCancellationRequested)return;const d=Array.isArray(u)?new Wa(u):u,f=ms.supportsResolving(this._provider)?this._cache.add(d.items):this._cache.add([]),m=new Te;this._disposables.set(f,m);const b=[],_={x:f,b,a:{replace:H.from(a),insert:H.from(c)},c:d.isIncomplete||void 0,d:l.elapsed()};for(let v=0;v<d.items.length;v++){const k=d.items[v],D=this._convertCompletionItem(k,[f,v],c,a);b.push(D)}return _}async resolveCompletionItem(e,t){if(typeof this._provider.resolveCompletionItem!="function")return;const i=this._cache.get(...e);if(!i)return;const n=this._convertCompletionItem(i,e),s=await this._provider.resolveCompletionItem(i,t);if(!s)return;const o=this._convertCompletionItem(s,e);return(n.h!==o.h||n.i!==o.i)&&this._apiDeprecation.report("CompletionItem.insertText",this._extension,"extension MAY NOT change 'insertText' of a CompletionItem during resolve"),(n.n!==o.n||n.o!==o.o||!tn(n.p,o.p))&&this._apiDeprecation.report("CompletionItem.command",this._extension,"extension MAY NOT change 'command' of a CompletionItem during resolve"),{...n,d:o.d,c:o.c,l:o.l,h:o.h,i:o.i,n:o.n,o:o.o,p:o.p}}releaseCompletionItems(e){var t;(t=this._disposables.get(e))==null||t.dispose(),this._disposables.delete(e),this._cache.delete(e)}_convertCompletionItem(e,t,i,n){var l;const s=this._disposables.get(t[0]);if(!s)throw Error("DisposableStore is missing...");const o=this._commands.toInternal(e.command,s),a={x:t,a:e.label,b:e.kind!==void 0?Rf.from(e.kind):void 0,m:e.tags&&e.tags.map(Af.from),c:e.detail,d:typeof e.documentation>"u"?void 0:Le.fromStrict(e.documentation),e:e.sortText!==e.label?e.sortText:void 0,f:e.filterText!==e.label?e.filterText:void 0,g:e.preselect||void 0,i:e.keepWhitespace?1:0,k:(l=e.commitCharacters)==null?void 0:l.join(""),l:e.additionalTextEdits&&e.additionalTextEdits.map(yt.from),n:o==null?void 0:o.$ident,o:o==null?void 0:o.id,p:o!=null&&o.$ident||o==null?void 0:o.arguments};e.textEdit?(this._apiDeprecation.report("CompletionItem.textEdit",this._extension,"Use 'CompletionItem.insertText' and 'CompletionItem.range' instead."),a.h=e.textEdit.newText):typeof e.insertText=="string"?a.h=e.insertText:e.insertText instanceof go&&(a.h=e.insertText.value,a.i|=4);let c;return e.textEdit?c=e.textEdit.range:e.range&&(c=e.range),xe.isRange(c)?a.j=H.from(c):c&&(!(i!=null&&i.isEqual(c.inserting))||!(n!=null&&n.isEqual(c.replacing)))&&(a.j={insert:H.from(c.inserting),replace:H.from(c.replacing)}),a}}class el{async provideInlineCompletions(e,t,i,n){}disposeCompletions(e){}handleDidShowCompletionItem(e,t,i){}handlePartialAccept(e,t,i,n){}}class XP extends el{constructor(e,t,i,n){super(),this._extension=e,this._documents=t,this._provider=i,this._commands=n,this._references=new $S,this._isAdditionsProposedApiEnabled=Lt(this._extension,"inlineCompletionsAdditions"),this.languageTriggerKindToVSCodeTriggerKind={[xh.Automatic]:eu.Automatic,[xh.Explicit]:eu.Invoke}}get supportsHandleEvents(){return Lt(this._extension,"inlineCompletionsAdditions")&&(typeof this._provider.handleDidShowCompletionItem=="function"||typeof this._provider.handleDidPartiallyAcceptCompletionItem=="function")}async provideInlineCompletions(e,t,i,n){const s=this._documents.getDocument(e),o=qe.to(t),a=await this._provider.provideInlineCompletionItems(s,o,{selectedCompletionInfo:i.selectedSuggestionInfo?{range:H.to(i.selectedSuggestionInfo.range),text:i.selectedSuggestionInfo.text}:void 0,triggerKind:this.languageTriggerKindToVSCodeTriggerKind[i.triggerKind]},n);if(!a||n.isCancellationRequested)return;const c=Array.isArray(a)?a:a.items,l=this._isAdditionsProposedApiEnabled?Array.isArray(a)?[]:a.commands||[]:[],u=this._isAdditionsProposedApiEnabled&&!Array.isArray(a)?a.enableForwardStability:void 0;let d;return{pid:this._references.createReferenceId({dispose(){d==null||d.dispose()},items:c}),items:c.map((m,b)=>{let _;m.command&&(d||(d=new Te),_=this._commands.toInternal(m.command,d));const v=m.insertText;return{insertText:typeof v=="string"?v:{snippet:v.value},filterText:m.filterText,range:m.range?H.from(m.range):void 0,command:_,idx:b,completeBracketPairs:this._isAdditionsProposedApiEnabled?m.completeBracketPairs:!1}}),commands:l.map(m=>(d||(d=new Te),this._commands.toInternal(m,d))),suppressSuggestions:!1,enableForwardStability:u}}disposeCompletions(e){const t=this._references.disposeReferenceId(e);t==null||t.dispose()}handleDidShowCompletionItem(e,t,i){var s;const n=(s=this._references.get(e))==null?void 0:s.items[t];n&&this._provider.handleDidShowCompletionItem&&this._isAdditionsProposedApiEnabled&&this._provider.handleDidShowCompletionItem(n,i)}handlePartialAccept(e,t,i,n){var o;const s=(o=this._references.get(e))==null?void 0:o.items[t];s&&this._provider.handleDidPartiallyAcceptCompletionItem&&this._isAdditionsProposedApiEnabled&&(this._provider.handleDidPartiallyAcceptCompletionItem(s,i),this._provider.handleDidPartiallyAcceptCompletionItem(s,yv.to(n)))}}class um{async provideInlineEdits(e,t,i){const n=this._documents.getDocument(e),s=await this._provider.provideInlineEdit(n,{triggerKind:this.languageTriggerKindToVSCodeTriggerKind[t.triggerKind]},i);if(!s||i.isCancellationRequested)return;let o;const a=this._references.createReferenceId({dispose(){o==null||o.dispose()},item:s});let c;s.accepted&&(o||(o=new Te),c=this._commands.toInternal(s.accepted,o));let l;return s.rejected&&(o||(o=new Te),l=this._commands.toInternal(s.rejected,o)),{pid:a,text:s.text,range:H.from(s.range),accepted:c,rejected:l}}disposeEdit(e){const t=this._references.disposeReferenceId(e);t==null||t.dispose()}constructor(e,t,i,n){this._documents=t,this._provider=i,this._commands=n,this._references=new $S,this.languageTriggerKindToVSCodeTriggerKind={[Sh.Automatic]:pu.Automatic,[Sh.Invoke]:pu.Invoke}}}class $S{constructor(){this._references=new Map,this._idPool=1}createReferenceId(e){const t=this._idPool++;return this._references.set(t,e),t}disposeReferenceId(e){const t=this._references.get(e);return this._references.delete(e),t}get(e){return this._references.get(e)}}class dm{constructor(e,t){this._documents=e,this._provider=t,this._cache=new Ri("SignatureHelp")}async provideSignatureHelp(e,t,i,n){const s=this._documents.getDocument(e),o=qe.to(t),a=this.reviveContext(i),c=await this._provider.provideSignatureHelp(s,o,n,a);if(c){const l=this._cache.add([c]);return{...vu.from(c),id:l}}}reviveContext(e){let t;if(e.activeSignatureHelp){const i=vu.to(e.activeSignatureHelp),n=this._cache.get(e.activeSignatureHelp.id,0);n?(t=n,t.activeSignature=i.activeSignature,t.activeParameter=i.activeParameter):t=i}return{...e,activeSignatureHelp:t}}releaseSignatureHelp(e){this._cache.delete(e)}}class Od{constructor(e,t,i,n,s){this._documents=e,this._commands=t,this._provider=i,this._logService=n,this._extension=s,this._cache=new Ri("InlayHints"),this._disposables=new Map}async provideInlayHints(e,t,i){const n=this._documents.getDocument(e),s=H.to(t),o=await this._provider.provideInlayHints(n,s,i);if(!Array.isArray(o)||o.length===0){this._logService.trace(`[InlayHints] NO inlay hints from '${this._extension.identifier.value}' for range ${JSON.stringify(t)}`);return}if(i.isCancellationRequested)return;const a=this._cache.add(o);this._disposables.set(a,new Te);const c={hints:[],cacheId:a};for(let l=0;l<o.length;l++)this._isValidInlayHint(o[l],s)&&c.hints.push(this._convertInlayHint(o[l],[a,l]));return this._logService.trace(`[InlayHints] ${c.hints.length} inlay hints from '${this._extension.identifier.value}' for range ${JSON.stringify(t)}`),c}async resolveInlayHint(e,t){if(typeof this._provider.resolveInlayHint!="function")return;const i=this._cache.get(...e);if(!i)return;const n=await this._provider.resolveInlayHint(i,t);if(n&&this._isValidInlayHint(n))return this._convertInlayHint(n,e)}releaseHints(e){var t;(t=this._disposables.get(e))==null||t.dispose(),this._disposables.delete(e),this._cache.delete(e)}_isValidInlayHint(e,t){return e.label.length===0||Array.isArray(e.label)&&e.label.every(i=>i.value.length===0)?(console.log("INVALID inlay hint, empty label",e),!1):!(t&&!t.contains(e.position))}_convertInlayHint(e,t){const i=this._disposables.get(t[0]);if(!i)throw Error("DisposableStore is missing...");const n={label:"",cacheId:t,tooltip:Le.fromStrict(e.tooltip),position:qe.from(e.position),textEdits:e.textEdits&&e.textEdits.map(yt.from),kind:e.kind&&Nf.from(e.kind),paddingLeft:e.paddingLeft,paddingRight:e.paddingRight};if(typeof e.label=="string")n.label=e.label;else{const s=[];n.label=s;for(const o of e.label){if(!o.value){console.warn("INVALID inlay hint, empty label part",this._extension.identifier.value);continue}const a={label:o.value,tooltip:Le.fromStrict(o.tooltip)};Pi.isLocation(o.location)&&(a.location=Ai.from(o.location)),o.command&&(a.command=this._commands.toInternal(o.command,i)),s.push(a)}}return n}}class Fr{constructor(e,t){this._documents=e,this._provider=t,this._cache=new Ri("DocumentLink")}async provideLinks(e,t){const i=this._documents.getDocument(e),n=await this._provider.provideDocumentLinks(i,t);if(!(!Array.isArray(n)||n.length===0)&&!t.isCancellationRequested){if(typeof this._provider.resolveDocumentLink!="function")return{links:n.filter(Fr._validateLink).map(oo.from)};{const s=this._cache.add(n),o={links:[],cacheId:s};for(let a=0;a<n.length;a++){if(!Fr._validateLink(n[a]))continue;const c=oo.from(n[a]);c.cacheId=[s,a],o.links.push(c)}return o}}}static _validateLink(e){return e.target&&e.target.path.length>5e4?(console.warn("DROPPING link because it is too long"),!1):!0}async resolveLink(e,t){if(typeof this._provider.resolveDocumentLink!="function")return;const i=this._cache.get(...e);if(!i)return;const n=await this._provider.resolveDocumentLink(i,t);if(!(!n||!Fr._validateLink(n)))return oo.from(n)}releaseLinks(e){this._cache.delete(e)}}class hm{constructor(e,t){this._documents=e,this._provider=t}async provideColors(e,t){const i=this._documents.getDocument(e),n=await this._provider.provideDocumentColors(i,t);return Array.isArray(n)?n.map(o=>({color:nc.from(o.color),range:H.from(o.range)})):[]}async provideColorPresentations(e,t,i){const n=this._documents.getDocument(e),s=H.to(t.range),o=nc.to(t.color),a=await this._provider.provideColorPresentations(o,{document:n,range:s},i);if(Array.isArray(a))return a.map(Mf.from)}}class A2{constructor(e,t){this._documents=e,this._provider=t}async provideFoldingRanges(e,t,i){const n=this._documents.getDocument(e),s=await this._provider.provideFoldingRanges(n,t,i);if(Array.isArray(s))return s.map(Of.from)}}class R2{constructor(e,t,i){this._documents=e,this._provider=t,this._logService=i}async provideSelectionRanges(e,t,i){const n=this._documents.getDocument(e),s=t.map(qe.to),o=await this._provider.provideSelectionRanges(n,s,i);if(!Zu(o))return[];if(o.length!==s.length)return this._logService.warn("BAD selection ranges, provider must return ranges for each position"),[];const a=[];for(let c=0;c<s.length;c++){const l=[];a.push(l);let u=s[c],d=o[c];for(;;){if(!d.range.contains(u))throw new Error("INVALID selection range, must contain the previous range");if(l.push(av.from(d)),!d.parent)break;u=d.range,d=d.parent}}return a}}class Vc{constructor(e,t){this._documents=e,this._provider=t,this._idPool=new r0(""),this._cache=new Map}async prepareSession(e,t,i){const n=this._documents.getDocument(e),s=qe.to(t),o=await this._provider.prepareCallHierarchy(n,s,i);if(!o)return;const a=this._idPool.nextId();return this._cache.set(a,new Map),Array.isArray(o)?o.map(c=>this._cacheAndConvertItem(a,c)):[this._cacheAndConvertItem(a,o)]}async provideCallsTo(e,t,i){const n=this._itemFromCache(e,t);if(!n)throw new Error("missing call hierarchy item");const s=await this._provider.provideCallHierarchyIncomingCalls(n,i);if(s)return s.map(o=>({from:this._cacheAndConvertItem(e,o.from),fromRanges:o.fromRanges.map(a=>H.from(a))}))}async provideCallsFrom(e,t,i){const n=this._itemFromCache(e,t);if(!n)throw new Error("missing call hierarchy item");const s=await this._provider.provideCallHierarchyOutgoingCalls(n,i);if(s)return s.map(o=>({to:this._cacheAndConvertItem(e,o.to),fromRanges:o.fromRanges.map(a=>H.from(a))}))}releaseSession(e){this._cache.delete(e)}_cacheAndConvertItem(e,t){const i=this._cache.get(e),n=_o.from(t,e,i.size.toString(36));return i.set(n._itemId,t),n}_itemFromCache(e,t){const i=this._cache.get(e);return i==null?void 0:i.get(t)}}class Wc{constructor(e,t){this._documents=e,this._provider=t,this._idPool=new r0(""),this._cache=new Map}async prepareSession(e,t,i){const n=this._documents.getDocument(e),s=qe.to(t),o=await this._provider.prepareTypeHierarchy(n,s,i);if(!o)return;const a=this._idPool.nextId();return this._cache.set(a,new Map),Array.isArray(o)?o.map(c=>this._cacheAndConvertItem(a,c)):[this._cacheAndConvertItem(a,o)]}async provideSupertypes(e,t,i){const n=this._itemFromCache(e,t);if(!n)throw new Error("missing type hierarchy item");const s=await this._provider.provideTypeHierarchySupertypes(n,i);if(s)return s.map(o=>this._cacheAndConvertItem(e,o))}async provideSubtypes(e,t,i){const n=this._itemFromCache(e,t);if(!n)throw new Error("missing type hierarchy item");const s=await this._provider.provideTypeHierarchySubtypes(n,i);if(s)return s.map(o=>this._cacheAndConvertItem(e,o))}releaseSession(e){this._cache.delete(e)}_cacheAndConvertItem(e,t){const i=this._cache.get(e),n=ao.from(t,e,i.size.toString(36));return i.set(n._itemId,t),n}_itemFromCache(e,t){const i=this._cache.get(e);return i==null?void 0:i.get(t)}}class Hd{constructor(e,t,i,n,s){this._proxy=e,this._documents=t,this._provider=i,this._handle=n,this._extension=s,this._cache=new Ri("DocumentDropEdit")}async provideDocumentOnDropEdits(e,t,i,n,s){const o=this._documents.getDocument(t),a=qe.to(i),c=zr.toDataTransfer(n,async f=>(await this._proxy.$resolveDocumentOnDropFileData(this._handle,e,f)).buffer),l=await this._provider.provideDocumentDropEdits(o,a,c,s);if(!l)return;const u=$a(l),d=this._cache.add(u);return u.map((f,m)=>{var b,_;return{_cacheId:[d,m],title:f.title??h(LS,1,"Drop using '{0}' extension",this._extension.displayName||this._extension.name),kind:(b=f.kind)==null?void 0:b.value,yieldTo:(_=f.yieldTo)==null?void 0:_.map(v=>v.value),insertText:typeof f.insertText=="string"?f.insertText:{snippet:f.insertText.value},additionalEdit:f.additionalEdit?Wt.from(f.additionalEdit,void 0):void 0}})}async resolveDropEdit(e,t){const[i,n]=e,s=this._cache.get(i,n);if(!s||!this._provider.resolveDocumentDropEdit)return{};const o=await this._provider.resolveDocumentDropEdit(s,t)??s;return{additionalEdit:o.additionalEdit?Wt.from(o.additionalEdit,void 0):void 0}}releaseDropEdits(e){this._cache.delete(e)}}class L2{constructor(e,t){this._documents=e,this._provider=t}async provideMappedEdits(e,t,i,n){var u,d;const s=x.revive(e),o=this._documents.getDocument(s),a=i.documents.map(f=>f.map(m=>({uri:x.revive(m.uri),version:m.version,ranges:m.ranges.map(b=>H.to(b))}))),c={documents:a,selections:((d=(u=a[0])==null?void 0:u[0])==null?void 0:d.ranges)??[]},l=await this._provider.provideMappedEdits(o,t,c,n);return l?Wt.from(l):null}}class zc{constructor(e,t){this.adapter=e,this.extension=t}}const Ct=class Ct{constructor(e,t,i,n,s,o,a,c){this._uriTransformer=t,this._documents=i,this._commands=n,this._diagnostics=s,this._logService=o,this._apiDeprecation=a,this._extensionTelemetry=c,this._adapter=new Map,this._proxy=e.getProxy(J.MainThreadLanguageFeatures)}_transformDocumentSelector(e,t){return Ya.from(e,this._uriTransformer,t)}_createDisposable(e){return new Ne(()=>{this._adapter.delete(e),this._proxy.$unregister(e)})}_nextHandle(){return Ct._handlePool++}async _withAdapter(e,t,i,n,s,o=!1){const a=this._adapter.get(e);if(!a||!(a.adapter instanceof t))return n;const c=Date.now();o||this._logService.trace(`[${a.extension.identifier.value}] INVOKE provider '${i.toString().replace(/[\r\n]/g,"")}'`);const l=i(a.adapter,a.extension);return Promise.resolve(l).catch(u=>{ho(u)||(this._logService.error(`[${a.extension.identifier.value}] provider FAILED`),this._logService.error(u),this._extensionTelemetry.onExtensionError(a.extension.identifier,u))}).finally(()=>{o||this._logService.trace(`[${a.extension.identifier.value}] provider DONE after ${Date.now()-c}ms`)}),bt.isCancellationToken(s)?WE(l,s):l}_addNewAdapter(e,t){const i=this._nextHandle();return this._adapter.set(i,new zc(e,t)),i}static _extLabel(e){return e.displayName||e.name}registerDocumentSymbolProvider(e,t,i,n){const s=this._addNewAdapter(new gp(this._documents,i),e),o=n&&n.label||Ct._extLabel(e);return this._proxy.$registerDocumentSymbolProvider(s,this._transformDocumentSelector(t,e),o),this._createDisposable(s)}$provideDocumentSymbols(e,t,i){return this._withAdapter(e,gp,n=>n.provideDocumentSymbols(x.revive(t),i),void 0,i)}registerCodeLensProvider(e,t,i){const n=this._nextHandle(),s=typeof i.onDidChangeCodeLenses=="function"?this._nextHandle():void 0;this._adapter.set(n,new zc(new Md(this._documents,this._commands.converter,i,e,this._extensionTelemetry,this._logService),e)),this._proxy.$registerCodeLensSupport(n,this._transformDocumentSelector(t,e),s);let o=this._createDisposable(n);if(s!==void 0){const a=i.onDidChangeCodeLenses(c=>this._proxy.$emitCodeLensEvent(s));o=Ne.from(o,a)}return o}$provideCodeLenses(e,t,i){return this._withAdapter(e,Md,n=>n.provideCodeLenses(x.revive(t),i),void 0,i)}$resolveCodeLens(e,t,i){return this._withAdapter(e,Md,n=>n.resolveCodeLens(t,i),void 0,void 0)}$releaseCodeLenses(e,t){this._withAdapter(e,Md,i=>Promise.resolve(i.releaseCodeLenses(t)),void 0,void 0)}registerDefinitionProvider(e,t,i){const n=this._addNewAdapter(new _2(this._documents,i),e);return this._proxy.$registerDefinitionSupport(n,this._transformDocumentSelector(t,e)),this._createDisposable(n)}$provideDefinition(e,t,i,n){return this._withAdapter(e,_2,s=>s.provideDefinition(x.revive(t),i,n),[],n)}registerDeclarationProvider(e,t,i){const n=this._addNewAdapter(new w2(this._documents,i),e);return this._proxy.$registerDeclarationSupport(n,this._transformDocumentSelector(t,e)),this._createDisposable(n)}$provideDeclaration(e,t,i,n){return this._withAdapter(e,w2,s=>s.provideDeclaration(x.revive(t),i,n),[],n)}registerImplementationProvider(e,t,i){const n=this._addNewAdapter(new b2(this._documents,i),e);return this._proxy.$registerImplementationSupport(n,this._transformDocumentSelector(t,e)),this._createDisposable(n)}$provideImplementation(e,t,i,n){return this._withAdapter(e,b2,s=>s.provideImplementation(x.revive(t),i,n),[],n)}registerTypeDefinitionProvider(e,t,i){const n=this._addNewAdapter(new y2(this._documents,i),e);return this._proxy.$registerTypeDefinitionSupport(n,this._transformDocumentSelector(t,e)),this._createDisposable(n)}$provideTypeDefinition(e,t,i,n){return this._withAdapter(e,y2,s=>s.provideTypeDefinition(x.revive(t),i,n),[],n)}registerHoverProvider(e,t,i,n){const s=this._addNewAdapter(new bl(this._documents,i),e);return this._proxy.$registerHoverProvider(s,this._transformDocumentSelector(t,e)),this._createDisposable(s)}$provideHover(e,t,i,n,s){return this._withAdapter(e,bl,o=>o.provideHover(x.revive(t),i,n,s),void 0,s)}$releaseHover(e,t){this._withAdapter(e,bl,i=>Promise.resolve(i.releaseHover(t)),void 0,void 0)}registerEvaluatableExpressionProvider(e,t,i,n){const s=this._addNewAdapter(new x2(this._documents,i),e);return this._proxy.$registerEvaluatableExpressionProvider(s,this._transformDocumentSelector(t,e)),this._createDisposable(s)}$provideEvaluatableExpression(e,t,i,n){return this._withAdapter(e,x2,s=>s.provideEvaluatableExpression(x.revive(t),i,n),void 0,n)}registerInlineValuesProvider(e,t,i,n){const s=typeof i.onDidChangeInlineValues=="function"?this._nextHandle():void 0,o=this._addNewAdapter(new C2(this._documents,i),e);this._proxy.$registerInlineValuesProvider(o,this._transformDocumentSelector(t,e),s);let a=this._createDisposable(o);if(s!==void 0){const c=i.onDidChangeInlineValues(l=>this._proxy.$emitInlineValuesEvent(s));a=Ne.from(a,c)}return a}$provideInlineValues(e,t,i,n,s){return this._withAdapter(e,C2,o=>o.provideInlineValues(x.revive(t),i,n,s),void 0,s)}registerDocumentHighlightProvider(e,t,i){const n=this._addNewAdapter(new S2(this._documents,i),e);return this._proxy.$registerDocumentHighlightProvider(n,this._transformDocumentSelector(t,e)),this._createDisposable(n)}registerMultiDocumentHighlightProvider(e,t,i){const n=this._addNewAdapter(new E2(this._documents,i),e);return this._proxy.$registerMultiDocumentHighlightProvider(n,this._transformDocumentSelector(t,e)),this._createDisposable(n)}$provideDocumentHighlights(e,t,i,n){return this._withAdapter(e,S2,s=>s.provideDocumentHighlights(x.revive(t),i,n),void 0,n)}$provideMultiDocumentHighlights(e,t,i,n,s){return this._withAdapter(e,E2,o=>o.provideMultiDocumentHighlights(x.revive(t),i,n.map(a=>x.revive(a)),s),void 0,s)}registerLinkedEditingRangeProvider(e,t,i){const n=this._addNewAdapter(new k2(this._documents,i),e);return this._proxy.$registerLinkedEditingRangeProvider(n,this._transformDocumentSelector(t,e)),this._createDisposable(n)}$provideLinkedEditingRanges(e,t,i,n){return this._withAdapter(e,k2,async s=>{const o=await s.provideLinkedEditingRanges(x.revive(t),i,n);if(o)return{ranges:o.ranges,wordPattern:o.wordPattern?Ct._serializeRegExp(o.wordPattern):void 0}},void 0,n)}registerReferenceProvider(e,t,i){const n=this._addNewAdapter(new D2(this._documents,i),e);return this._proxy.$registerReferenceSupport(n,this._transformDocumentSelector(t,e)),this._createDisposable(n)}$provideReferences(e,t,i,n,s){return this._withAdapter(e,D2,o=>o.provideReferences(x.revive(t),i,n,s),void 0,s)}registerCodeActionProvider(e,t,i,n){var a,c;const s=new Te,o=this._addNewAdapter(new Go(this._documents,this._commands.converter,this._diagnostics,i,this._logService,e,this._apiDeprecation),e);return this._proxy.$registerQuickFixSupport(o,this._transformDocumentSelector(t,e),{providedKinds:(a=n==null?void 0:n.providedCodeActionKinds)==null?void 0:a.map(l=>l.value),documentation:(c=n==null?void 0:n.documentation)==null?void 0:c.map(l=>({kind:l.kind.value,command:this._commands.converter.toInternal(l.command,s)}))},Ct._extLabel(e),!!i.resolveCodeAction),s.add(this._createDisposable(o)),s}$provideCodeActions(e,t,i,n,s){return this._withAdapter(e,Go,o=>o.provideCodeActions(x.revive(t),i,n,s),void 0,s)}$resolveCodeAction(e,t,i){return this._withAdapter(e,Go,n=>n.resolveCodeAction(t,i),{},void 0)}$releaseCodeActions(e,t){this._withAdapter(e,Go,i=>Promise.resolve(i.releaseCodeActions(t)),void 0,void 0)}registerDocumentFormattingEditProvider(e,t,i){const n=this._addNewAdapter(new I2(this._documents,i),e);return this._proxy.$registerDocumentFormattingSupport(n,this._transformDocumentSelector(t,e),e.identifier,e.displayName||e.name),this._createDisposable(n)}$provideDocumentFormattingEdits(e,t,i,n){return this._withAdapter(e,I2,s=>s.provideDocumentFormattingEdits(x.revive(t),i,n),void 0,n)}registerDocumentRangeFormattingEditProvider(e,t,i){const n=typeof i.provideDocumentRangesFormattingEdits=="function",s=this._addNewAdapter(new cm(this._documents,i),e);return this._proxy.$registerRangeFormattingSupport(s,this._transformDocumentSelector(t,e),e.identifier,e.displayName||e.name,n),this._createDisposable(s)}$provideDocumentRangeFormattingEdits(e,t,i,n,s){return this._withAdapter(e,cm,o=>o.provideDocumentRangeFormattingEdits(x.revive(t),i,n,s),void 0,s)}$provideDocumentRangesFormattingEdits(e,t,i,n,s){return this._withAdapter(e,cm,o=>o.provideDocumentRangesFormattingEdits(x.revive(t),i,n,s),void 0,s)}registerOnTypeFormattingEditProvider(e,t,i,n){const s=this._addNewAdapter(new P2(this._documents,i),e);return this._proxy.$registerOnTypeFormattingSupport(s,this._transformDocumentSelector(t,e),n,e.identifier),this._createDisposable(s)}$provideOnTypeFormattingEdits(e,t,i,n,s,o){return this._withAdapter(e,P2,a=>a.provideOnTypeFormattingEdits(x.revive(t),i,n,s,o),void 0,o)}registerWorkspaceSymbolProvider(e,t){const i=this._addNewAdapter(new Fd(t,this._logService),e);return this._proxy.$registerNavigateTypeSupport(i,typeof t.resolveWorkspaceSymbol=="function"),this._createDisposable(i)}$provideWorkspaceSymbols(e,t,i){return this._withAdapter(e,Fd,n=>n.provideWorkspaceSymbols(t,i),{symbols:[]},i)}$resolveWorkspaceSymbol(e,t,i){return this._withAdapter(e,Fd,n=>n.resolveWorkspaceSymbol(t,i),void 0,void 0)}$releaseWorkspaceSymbols(e,t){this._withAdapter(e,Fd,i=>i.releaseWorkspaceSymbols(t),void 0,void 0)}registerRenameProvider(e,t,i){const n=this._addNewAdapter(new Ns(this._documents,i,this._logService),e);return this._proxy.$registerRenameSupport(n,this._transformDocumentSelector(t,e),Ns.supportsResolving(i)),this._createDisposable(n)}$provideRenameEdits(e,t,i,n,s){return this._withAdapter(e,Ns,o=>o.provideRenameEdits(x.revive(t),i,n,s),void 0,s)}$resolveRenameLocation(e,t,i,n){return this._withAdapter(e,Ns,s=>s.resolveRenameLocation(x.revive(t),i,n),void 0,n)}registerNewSymbolNamesProvider(e,t,i){const n=this._addNewAdapter(new yl(this._documents,i,this._logService),e);return this._proxy.$registerNewSymbolNamesProvider(n,this._transformDocumentSelector(t,e)),this._createDisposable(n)}$supportsAutomaticNewSymbolNamesTriggerKind(e){return this._withAdapter(e,yl,t=>t.supportsAutomaticNewSymbolNamesTriggerKind(),!1,void 0)}$provideNewSymbolNames(e,t,i,n,s){return this._withAdapter(e,yl,o=>o.provideNewSymbolNames(x.revive(t),i,n,s),void 0,s)}registerDocumentSemanticTokensProvider(e,t,i,n){const s=this._addNewAdapter(new fi(this._documents,i),e),o=typeof i.onDidChangeSemanticTokens=="function"?this._nextHandle():void 0;this._proxy.$registerDocumentSemanticTokensProvider(s,this._transformDocumentSelector(t,e),n,o);let a=this._createDisposable(s);if(o){const c=i.onDidChangeSemanticTokens(l=>this._proxy.$emitDocumentSemanticTokensEvent(o));a=Ne.from(a,c)}return a}$provideDocumentSemanticTokens(e,t,i,n){return this._withAdapter(e,fi,s=>s.provideDocumentSemanticTokens(x.revive(t),i,n),null,n)}$releaseDocumentSemanticTokens(e,t){this._withAdapter(e,fi,i=>i.releaseDocumentSemanticColoring(t),void 0,void 0)}registerDocumentRangeSemanticTokensProvider(e,t,i,n){const s=this._addNewAdapter(new T2(this._documents,i),e);return this._proxy.$registerDocumentRangeSemanticTokensProvider(s,this._transformDocumentSelector(t,e),n),this._createDisposable(s)}$provideDocumentRangeSemanticTokens(e,t,i,n){return this._withAdapter(e,T2,s=>s.provideDocumentRangeSemanticTokens(x.revive(t),i,n),null,n)}registerCompletionItemProvider(e,t,i,n){const s=this._addNewAdapter(new ms(this._documents,this._commands.converter,i,this._apiDeprecation,e),e);return this._proxy.$registerCompletionsProvider(s,this._transformDocumentSelector(t,e),n,ms.supportsResolving(i),e.identifier),this._createDisposable(s)}$provideCompletionItems(e,t,i,n,s){return this._withAdapter(e,ms,o=>o.provideCompletionItems(x.revive(t),i,n,s),void 0,s)}$resolveCompletionItem(e,t,i){return this._withAdapter(e,ms,n=>n.resolveCompletionItem(t,i),void 0,i)}$releaseCompletionItems(e,t){this._withAdapter(e,ms,i=>i.releaseCompletionItems(t),void 0,void 0)}registerInlineCompletionsProvider(e,t,i,n){var a;const s=new XP(e,this._documents,i,this._commands.converter),o=this._addNewAdapter(s,e);return this._proxy.$registerInlineCompletionsSupport(o,this._transformDocumentSelector(t,e),s.supportsHandleEvents,Xe.toKey(e.identifier.value),((a=n==null?void 0:n.yieldTo)==null?void 0:a.map(c=>Xe.toKey(c)))||[]),this._createDisposable(o)}$provideInlineCompletions(e,t,i,n,s){return this._withAdapter(e,el,o=>o.provideInlineCompletions(x.revive(t),i,n,s),void 0,s)}$handleInlineCompletionDidShow(e,t,i,n){this._withAdapter(e,el,async s=>{s.handleDidShowCompletionItem(t,i,n)},void 0,void 0)}$handleInlineCompletionPartialAccept(e,t,i,n,s){this._withAdapter(e,el,async o=>{o.handlePartialAccept(t,i,n,s)},void 0,void 0)}$freeInlineCompletionsList(e,t){this._withAdapter(e,el,async i=>{i.disposeCompletions(t)},void 0,void 0)}registerInlineEditProvider(e,t,i){const n=new um(e,this._documents,i,this._commands.converter),s=this._addNewAdapter(n,e);return this._proxy.$registerInlineEditProvider(s,this._transformDocumentSelector(t,e),e.identifier),this._createDisposable(s)}$provideInlineEdit(e,t,i,n){return this._withAdapter(e,um,s=>s.provideInlineEdits(x.revive(t),i,n),void 0,n)}$freeInlineEdit(e,t){this._withAdapter(e,um,async i=>{i.disposeEdit(t)},void 0,void 0)}registerSignatureHelpProvider(e,t,i,n){const s=Array.isArray(n)?{triggerCharacters:n,retriggerCharacters:[]}:n,o=this._addNewAdapter(new dm(this._documents,i),e);return this._proxy.$registerSignatureHelpProvider(o,this._transformDocumentSelector(t,e),s),this._createDisposable(o)}$provideSignatureHelp(e,t,i,n,s){return this._withAdapter(e,dm,o=>o.provideSignatureHelp(x.revive(t),i,n,s),void 0,s)}$releaseSignatureHelp(e,t){this._withAdapter(e,dm,i=>i.releaseSignatureHelp(t),void 0,void 0)}registerInlayHintsProvider(e,t,i){const n=typeof i.onDidChangeInlayHints=="function"?this._nextHandle():void 0,s=this._addNewAdapter(new Od(this._documents,this._commands.converter,i,this._logService,e),e);this._proxy.$registerInlayHintsProvider(s,this._transformDocumentSelector(t,e),typeof i.resolveInlayHint=="function",n,Ct._extLabel(e));let o=this._createDisposable(s);if(n!==void 0){const a=i.onDidChangeInlayHints(c=>this._proxy.$emitInlayHintsEvent(n));o=Ne.from(o,a)}return o}$provideInlayHints(e,t,i,n){return this._withAdapter(e,Od,s=>s.provideInlayHints(x.revive(t),i,n),void 0,n)}$resolveInlayHint(e,t,i){return this._withAdapter(e,Od,n=>n.resolveInlayHint(t,i),void 0,i)}$releaseInlayHints(e,t){this._withAdapter(e,Od,i=>i.releaseHints(t),void 0,void 0)}registerDocumentLinkProvider(e,t,i){const n=this._addNewAdapter(new Fr(this._documents,i),e);return this._proxy.$registerDocumentLinkProvider(n,this._transformDocumentSelector(t,e),typeof i.resolveDocumentLink=="function"),this._createDisposable(n)}$provideDocumentLinks(e,t,i){return this._withAdapter(e,Fr,n=>n.provideLinks(x.revive(t),i),void 0,i,t.scheme==="output")}$resolveDocumentLink(e,t,i){return this._withAdapter(e,Fr,n=>n.resolveLink(t,i),void 0,void 0,!0)}$releaseDocumentLinks(e,t){this._withAdapter(e,Fr,i=>i.releaseLinks(t),void 0,void 0,!0)}registerColorProvider(e,t,i){const n=this._addNewAdapter(new hm(this._documents,i),e);return this._proxy.$registerDocumentColorProvider(n,this._transformDocumentSelector(t,e)),this._createDisposable(n)}$provideDocumentColors(e,t,i){return this._withAdapter(e,hm,n=>n.provideColors(x.revive(t),i),[],i)}$provideColorPresentations(e,t,i,n){return this._withAdapter(e,hm,s=>s.provideColorPresentations(x.revive(t),i,n),void 0,n)}registerFoldingRangeProvider(e,t,i){const n=this._nextHandle(),s=typeof i.onDidChangeFoldingRanges=="function"?this._nextHandle():void 0;this._adapter.set(n,new zc(new A2(this._documents,i),e)),this._proxy.$registerFoldingRangeProvider(n,this._transformDocumentSelector(t,e),e.identifier,s);let o=this._createDisposable(n);if(s!==void 0){const a=i.onDidChangeFoldingRanges(()=>this._proxy.$emitFoldingRangeEvent(s));o=Ne.from(o,a)}return o}$provideFoldingRanges(e,t,i,n){return this._withAdapter(e,A2,s=>s.provideFoldingRanges(x.revive(t),i,n),void 0,n)}registerSelectionRangeProvider(e,t,i){const n=this._addNewAdapter(new R2(this._documents,i,this._logService),e);return this._proxy.$registerSelectionRangeProvider(n,this._transformDocumentSelector(t,e)),this._createDisposable(n)}$provideSelectionRanges(e,t,i,n){return this._withAdapter(e,R2,s=>s.provideSelectionRanges(x.revive(t),i,n),[],n)}registerCallHierarchyProvider(e,t,i){const n=this._addNewAdapter(new Vc(this._documents,i),e);return this._proxy.$registerCallHierarchyProvider(n,this._transformDocumentSelector(t,e)),this._createDisposable(n)}$prepareCallHierarchy(e,t,i,n){return this._withAdapter(e,Vc,s=>Promise.resolve(s.prepareSession(x.revive(t),i,n)),void 0,n)}$provideCallHierarchyIncomingCalls(e,t,i,n){return this._withAdapter(e,Vc,s=>s.provideCallsTo(t,i,n),void 0,n)}$provideCallHierarchyOutgoingCalls(e,t,i,n){return this._withAdapter(e,Vc,s=>s.provideCallsFrom(t,i,n),void 0,n)}$releaseCallHierarchy(e,t){this._withAdapter(e,Vc,i=>Promise.resolve(i.releaseSession(t)),void 0,void 0)}registerTypeHierarchyProvider(e,t,i){const n=this._addNewAdapter(new Wc(this._documents,i),e);return this._proxy.$registerTypeHierarchyProvider(n,this._transformDocumentSelector(t,e)),this._createDisposable(n)}$prepareTypeHierarchy(e,t,i,n){return this._withAdapter(e,Wc,s=>Promise.resolve(s.prepareSession(x.revive(t),i,n)),void 0,n)}$provideTypeHierarchySupertypes(e,t,i,n){return this._withAdapter(e,Wc,s=>s.provideSupertypes(t,i,n),void 0,n)}$provideTypeHierarchySubtypes(e,t,i,n){return this._withAdapter(e,Wc,s=>s.provideSubtypes(t,i,n),void 0,n)}$releaseTypeHierarchy(e,t){this._withAdapter(e,Wc,i=>Promise.resolve(i.releaseSession(t)),void 0,void 0)}registerDocumentOnDropEditProvider(e,t,i,n){const s=this._nextHandle();return this._adapter.set(s,new zc(new Hd(this._proxy,this._documents,i,s,e),e)),this._proxy.$registerDocumentOnDropEditProvider(s,this._transformDocumentSelector(t,e),Lt(e,"documentPaste")&&n?{supportsResolve:!!i.resolveDocumentDropEdit,dropMimeTypes:n.dropMimeTypes}:void 0),this._createDisposable(s)}$provideDocumentOnDropEdits(e,t,i,n,s,o){return this._withAdapter(e,Hd,a=>Promise.resolve(a.provideDocumentOnDropEdits(t,x.revive(i),n,s,o)),void 0,void 0)}$resolveDropEdit(e,t,i){return this._withAdapter(e,Hd,n=>n.resolveDropEdit(t,i),{},void 0)}$releaseDropEdits(e,t){this._withAdapter(e,Hd,i=>Promise.resolve(i.releaseDropEdits(t)),void 0,void 0)}registerMappedEditsProvider(e,t,i){const n=this._addNewAdapter(new L2(this._documents,i),e);return this._proxy.$registerMappedEditsProvider(n,this._transformDocumentSelector(t,e)),this._createDisposable(n)}$provideMappedEdits(e,t,i,n,s){return this._withAdapter(e,L2,o=>Promise.resolve(o.provideMappedEdits(t,i,n,s)),null,s)}registerDocumentPasteEditProvider(e,t,i,n){var o;const s=this._nextHandle();return this._adapter.set(s,new zc(new Bc(this._proxy,this._documents,i,s,e),e)),this._proxy.$registerPasteEditProvider(s,this._transformDocumentSelector(t,e),{supportsCopy:!!i.prepareDocumentPaste,supportsPaste:!!i.provideDocumentPasteEdits,supportsResolve:!!i.resolveDocumentPasteEdit,providedPasteEditKinds:(o=n.providedPasteEditKinds)==null?void 0:o.map(a=>a.value),copyMimeTypes:n.copyMimeTypes,pasteMimeTypes:n.pasteMimeTypes}),this._createDisposable(s)}$prepareDocumentPaste(e,t,i,n,s){return this._withAdapter(e,Bc,o=>o.prepareDocumentPaste(x.revive(t),i,n,s),void 0,s)}$providePasteEdits(e,t,i,n,s,o,a){return this._withAdapter(e,Bc,c=>c.providePasteEdits(t,x.revive(i),n,s,o,a),void 0,a)}$resolvePasteEdit(e,t,i){return this._withAdapter(e,Bc,n=>n.resolvePasteEdit(t,i),{},void 0)}$releasePasteEdits(e,t){this._withAdapter(e,Bc,i=>Promise.resolve(i.releasePasteEdits(t)),void 0,void 0)}static _serializeRegExp(e){return{pattern:e.source,flags:e.flags}}static _serializeIndentationRule(e){return{decreaseIndentPattern:Ct._serializeRegExp(e.decreaseIndentPattern),increaseIndentPattern:Ct._serializeRegExp(e.increaseIndentPattern),indentNextLinePattern:e.indentNextLinePattern?Ct._serializeRegExp(e.indentNextLinePattern):void 0,unIndentedLinePattern:e.unIndentedLinePattern?Ct._serializeRegExp(e.unIndentedLinePattern):void 0}}static _serializeOnEnterRule(e){return{beforeText:Ct._serializeRegExp(e.beforeText),afterText:e.afterText?Ct._serializeRegExp(e.afterText):void 0,previousLineText:e.previousLineText?Ct._serializeRegExp(e.previousLineText):void 0,action:e.action}}static _serializeOnEnterRules(e){return e.map(Ct._serializeOnEnterRule)}static _serializeAutoClosingPair(e){return{open:e.open,close:e.close,notIn:e.notIn?e.notIn.map(t=>ja.toString(t)):void 0}}static _serializeAutoClosingPairs(e){return e.map(Ct._serializeAutoClosingPair)}setLanguageConfiguration(e,t,i){const{wordPattern:n}=i;if(n&&Px(n))throw new Error(`Invalid language configuration: wordPattern '${n}' is not allowed to match the empty string.`);n?this._documents.setWordDefinitionFor(t,n):this._documents.setWordDefinitionFor(t,void 0),i.__electricCharacterSupport&&this._apiDeprecation.report("LanguageConfiguration.__electricCharacterSupport",e,"Do not use."),i.__characterPairSupport&&this._apiDeprecation.report("LanguageConfiguration.__characterPairSupport",e,"Do not use.");const s=this._nextHandle(),o={comments:i.comments,brackets:i.brackets,wordPattern:i.wordPattern?Ct._serializeRegExp(i.wordPattern):void 0,indentationRules:i.indentationRules?Ct._serializeIndentationRule(i.indentationRules):void 0,onEnterRules:i.onEnterRules?Ct._serializeOnEnterRules(i.onEnterRules):void 0,__electricCharacterSupport:i.__electricCharacterSupport,__characterPairSupport:i.__characterPairSupport,autoClosingPairs:i.autoClosingPairs?Ct._serializeAutoClosingPairs(i.autoClosingPairs):void 0};return this._proxy.$setLanguageConfiguration(s,t,o),this._createDisposable(s)}$setWordDefinitions(e){for(const t of e)this._documents.setWordDefinitionFor(t.languageId,new RegExp(t.regexSource,t.regexFlags))}};Ct._handlePool=0;let F_=Ct;class ZP{constructor(e,t,i,n){this._documents=t,this._commands=i,this._uriTransformer=n,this._languageIds=[],this._handlePool=0,this._ids=new Set,this._proxy=e.getProxy(J.MainThreadLanguages)}$acceptLanguageIds(e){this._languageIds=e}async getLanguages(){return this._languageIds.slice(0)}async changeLanguage(e,t){await this._proxy.$changeLanguage(e,t);const i=this._documents.getDocumentData(e);if(!i)throw new Error(`document '${e.toString()}' NOT found`);return i.document}async tokenAtPosition(e,t){const i=e.version,n=qe.from(t),s=await this._proxy.$tokensAtPosition(e.uri,n),o={type:Nr.Other,range:e.getWordRangeAtPosition(t)??new xe(t.line,t.character,t.line,t.character)};if(!s)return o;const a={range:H.to(s.range),type:Q1.to(s.type)};return!a.range.contains(t)||i!==e.version?o:a}createLanguageStatusItem(e,t,i){const n=this._handlePool++,s=this._proxy,o=this._ids,a=`${e.identifier.value}/${t}`;if(o.has(a))throw new Error(`LanguageStatusItem with id '${t}' ALREADY exists`);o.add(a);const c={selector:i,id:t,name:e.displayName??e.name,severity:aa.Information,command:void 0,text:"",detail:"",busy:!1};let l;const u=new Te,d=()=>{if(l==null||l.dispose(),!o.has(a)){console.warn(`LanguageStatusItem (${t}) from ${e.identifier.value} has been disposed and CANNOT be updated anymore`);return}l=jE(()=>{u.clear(),this._proxy.$setLanguageStatus(n,{id:a,name:c.name??e.displayName??e.name,source:e.displayName??e.name,selector:Ya.from(c.selector,this._uriTransformer),label:c.text,detail:c.detail??"",severity:c.severity===aa.Error?vt.Error:c.severity===aa.Warning?vt.Warning:vt.Info,command:c.command&&this._commands.toInternal(c.command,u),accessibilityInfo:c.accessibilityInformation,busy:c.busy})},0)},f={dispose(){u.dispose(),l==null||l.dispose(),s.$removeLanguageStatus(n),o.delete(a)},get id(){return c.id},get name(){return c.name},set name(m){c.name=m,d()},get selector(){return c.selector},set selector(m){c.selector=m,d()},get text(){return c.text},set text(m){c.text=m,d()},set text2(m){O(e,"languageStatusText"),c.text=m,d()},get text2(){return O(e,"languageStatusText"),c.text},get detail(){return c.detail},set detail(m){c.detail=m,d()},get severity(){return c.severity},set severity(m){c.severity=m,d()},get accessibilityInformation(){return c.accessibilityInformation},set accessibilityInformation(m){c.accessibilityInformation=m,d()},get command(){return c.command},set command(m){c.command=m,d()},get busy(){return c.busy},set busy(m){c.busy=m,d()}};return d(),f}}function YP(r){return r&&r.title}let O_=class{constructor(e,t){this._logService=t,this._proxy=e.getProxy(J.MainThreadMessageService)}showMessage(e,t,i,n,s){const o={source:{identifier:e.identifier,label:e.displayName||e.name}};let a;typeof n=="string"||YP(n)?a=[n,...s]:(o.modal=n==null?void 0:n.modal,o.useCustom=n==null?void 0:n.useCustom,o.detail=n==null?void 0:n.detail,a=s),o.useCustom&&O(e,"resolvers");const c=[];let l=!1;for(let u=0;u<a.length;u++){const d=a[u];if(typeof d=="string")c.push({title:d,handle:u,isCloseAffordance:!1});else if(typeof d=="object"){const{title:f,isCloseAffordance:m}=d;c.push({title:f,isCloseAffordance:!!m,handle:u}),m&&(l?this._logService.warn(`[${e.identifier}] Only one message item can have 'isCloseAffordance':`,d):l=!0)}else this._logService.warn(`[${e.identifier}] Invalid message item:`,d)}return this._proxy.$showMessage(t,i,o,c).then(u=>{if(typeof u=="number")return a[u]})}};O_=U([M(1,Je)],O_);class fm{constructor(e,t,i,n){this.start=e,this.deletedCount=t,this.deletedItems=i,this.items=n}asApiEvent(){return{range:new Kn(this.start,this.start+this.deletedCount),addedCells:this.items.map(e=>e.apiCell),removedCells:this.deletedItems}}}class H_{static asModelAddData(e){return{EOL:e.eol,lines:e.source,languageId:e.language,uri:e.uri,isDirty:!1,versionId:1}}constructor(e,t,i){this.notebook=e,this._extHostDocument=t,this._cellData=i,this.handle=i.handle,this.uri=x.revive(i.uri),this.cellKind=i.cellKind,this._outputs=i.outputs.map(Yr.to),this._internalMetadata=i.internalMetadata??{},this._metadata=Object.freeze(i.metadata??{}),this._previousResult=Object.freeze(sc.to(i.internalMetadata??{}))}get internalMetadata(){return this._internalMetadata}get apiCell(){if(!this._apiCell){const e=this,t=this._extHostDocument.getDocument(this.uri);if(!t)throw new Error(`MISSING extHostDocument for notebook cell: ${this.uri}`);const i={get index(){return e.notebook.getCellIndex(e)},notebook:e.notebook.apiNotebook,kind:_u.to(this._cellData.cellKind),document:t.document,get mime(){return e._mime},set mime(n){e._mime=n},get outputs(){return e._outputs.slice(0)},get metadata(){return e._metadata},get executionSummary(){return e._previousResult}};this._apiCell=Object.freeze(i)}return this._apiCell}setOutputs(e){this._outputs=e.map(Yr.to)}setOutputItems(e,t,i){const n=i.map(oc.to),s=this._outputs.find(o=>o.id===e);if(s&&(t||(s.items.length=0),s.items.push(...n),s.items.length>1&&s.items.every(o=>xC(o.mime)))){const o=new Map,a=[];s.items.forEach(c=>{let l;o.has(c.mime)?l=o.get(c.mime):(l=[],o.set(c.mime,l),a.push(c.mime)),l.push(c.data)}),s.items.length=0,a.forEach(c=>{const l=oI(o.get(c));s.items.push({mime:c,data:l.data.buffer})})}}setMetadata(e){this._metadata=Object.freeze(e)}setInternalMetadata(e){this._internalMetadata=e,this._previousResult=Object.freeze(sc.to(e))}setMime(e){}}const Mp=class Mp{constructor(e,t,i,n,s){this._proxy=e,this._textDocumentsAndEditors=t,this._textDocuments=i,this.uri=n,this.handle=Mp._handlePool++,this._cells=[],this._versionId=0,this._isDirty=!1,this._disposed=!1,this._notebookType=s.viewType,this._metadata=Object.freeze(s.metadata??Object.create(null)),this._spliceNotebookCells([[0,0,s.cells]],!0,void 0),this._versionId=s.versionId}dispose(){this._disposed=!0}get versionId(){return this._versionId}get apiNotebook(){if(!this._notebook){const e=this,t={get uri(){return e.uri},get version(){return e._versionId},get notebookType(){return e._notebookType},get isDirty(){return e._isDirty},get isUntitled(){return e.uri.scheme===ne.untitled},get isClosed(){return e._disposed},get metadata(){return e._metadata},get cellCount(){return e._cells.length},cellAt(i){return i=e._validateIndex(i),e._cells[i].apiCell},getCells(i){return(i?e._getCells(i):e._cells).map(s=>s.apiCell)},save(){return e._save()}};this._notebook=Object.freeze(t)}return this._notebook}acceptDocumentPropertiesChanged(e){e.metadata&&(this._metadata=Object.freeze({...this._metadata,...e.metadata}))}acceptDirty(e){this._isDirty=e}acceptModelChanged(e,t,i){this._versionId=e.versionId,this._isDirty=t,this.acceptDocumentPropertiesChanged({metadata:i});const n={notebook:this.apiNotebook,metadata:i,cellChanges:[],contentChanges:[]},s=[];for(const a of e.rawEvents)a.kind===zi.ModelChange?this._spliceNotebookCells(a.changes,!1,n.contentChanges):a.kind===zi.Move?this._moveCells(a.index,a.length,a.newIdx,n.contentChanges):a.kind===zi.Output?(this._setCellOutputs(a.index,a.outputs),s.push({cell:this._cells[a.index].apiCell,outputs:this._cells[a.index].apiCell.outputs})):a.kind===zi.OutputItem?(this._setCellOutputItems(a.index,a.outputId,a.append,a.outputItems),s.push({cell:this._cells[a.index].apiCell,outputs:this._cells[a.index].apiCell.outputs})):a.kind===zi.ChangeCellLanguage?(this._changeCellLanguage(a.index,a.language),s.push({cell:this._cells[a.index].apiCell,document:this._cells[a.index].apiCell.document})):a.kind===zi.ChangeCellContent?s.push({cell:this._cells[a.index].apiCell,document:this._cells[a.index].apiCell.document}):a.kind===zi.ChangeCellMime?this._changeCellMime(a.index,a.mime):a.kind===zi.ChangeCellMetadata?(this._changeCellMetadata(a.index,a.metadata),s.push({cell:this._cells[a.index].apiCell,metadata:this._cells[a.index].apiCell.metadata})):a.kind===zi.ChangeCellInternalMetadata&&(this._changeCellInternalMetadata(a.index,a.internalMetadata),s.push({cell:this._cells[a.index].apiCell,executionSummary:this._cells[a.index].apiCell.executionSummary}));const o=new Map;for(let a=0;a<s.length;a++){const c=s[a],l=o.get(c.cell);if(l===void 0){const u=n.cellChanges.push({document:void 0,executionSummary:void 0,metadata:void 0,outputs:void 0,...c});o.set(c.cell,u-1)}else n.cellChanges[l]={...n.cellChanges[l],...c}}return n}_validateIndex(e){return e=e|0,e<0?0:e>=this._cells.length?this._cells.length-1:e}_validateRange(e){let t=e.start|0,i=e.end|0;return t<0&&(t=0),i>this._cells.length&&(i=this._cells.length),e.with({start:t,end:i})}_getCells(e){e=this._validateRange(e);const t=[];for(let i=e.start;i<e.end;i++)t.push(this._cells[i]);return t}async _save(){return this._disposed?Promise.reject(new Error("Notebook has been closed")):this._proxy.$trySaveNotebook(this.uri)}_spliceNotebookCells(e,t,i){if(this._disposed)return;const n=[],s=[],o=[];if(e.reverse().forEach(a=>{const l=a[2].map(f=>{const m=new H_(this,this._textDocumentsAndEditors,f);return t||s.push(H_.asModelAddData(f)),m}),u=new fm(a[0],a[1],[],l),d=this._cells.splice(a[0],a[1],...l);for(const f of d)o.push(f.uri),u.deletedItems.push(f.apiCell);n.push(u)}),this._textDocumentsAndEditors.acceptDocumentsAndEditorsDelta({addedDocuments:s,removedDocuments:o}),i)for(const a of n)i.push(a.asApiEvent())}_moveCells(e,t,i,n){const s=this._cells.splice(e,t);this._cells.splice(i,0,...s);const o=[new fm(e,t,s.map(a=>a.apiCell),[]),new fm(i,0,[],s)];for(const a of o)n.push(a.asApiEvent())}_setCellOutputs(e,t){this._cells[e].setOutputs(t)}_setCellOutputItems(e,t,i,n){this._cells[e].setOutputItems(t,i,n)}_changeCellLanguage(e,t){const i=this._cells[e];i.apiCell.document.languageId!==t&&this._textDocuments.$acceptModelLanguageChanged(i.uri,t)}_changeCellMime(e,t){const i=this._cells[e];i.apiCell.mime=t}_changeCellMetadata(e,t){this._cells[e].setMetadata(t)}_changeCellInternalMetadata(e,t){this._cells[e].setInternalMetadata(t)}getCellFromApiCell(e){return this._cells.find(t=>t.apiCell===e)}getCellFromIndex(e){return this._cells[e]}getCell(e){return this._cells.find(t=>t.handle===e)}getCellIndex(e){return this._cells.indexOf(e)}};Mp._handlePool=0;let U_=Mp;const Fp=class Fp{constructor(e,t,i,n,s,o){this.id=e,this._proxy=t,this.notebookData=i,this._selections=[],this._visibleRanges=[],this._visible=!1,this._selections=s,this._visibleRanges=n,this._viewColumn=o}get apiEditor(){if(!this._editor){const e=this;this._editor={get notebook(){return e.notebookData.apiNotebook},get selection(){return e._selections[0]},set selection(t){this.selections=[t]},get selections(){return e._selections},set selections(t){if(!Array.isArray(t)||!t.every(Kn.isNotebookRange))throw Se("selections");e._selections=t,e._trySetSelections(t)},get visibleRanges(){return e._visibleRanges},revealRange(t,i){e._proxy.$tryRevealRange(e.id,Cn.from(t),i??mf.Default)},get viewColumn(){return e._viewColumn}},Fp.apiEditorsToExtHost.set(this._editor,this)}return this._editor}get visible(){return this._visible}_acceptVisibility(e){this._visible=e}_acceptVisibleRanges(e){this._visibleRanges=e}_acceptSelections(e){this._selections=e}_trySetSelections(e){this._proxy.$trySetSelections(this.id,e.map(Cn.from))}_acceptViewColumn(e){this._viewColumn=e}};Fp.apiEditorsToExtHost=new WeakMap;let Tu=Fp;class B_{constructor(e,t){this.piece=e,this.color=t,this.size_left=0,this.lf_left=0,this.parent=this,this.left=this,this.right=this}next(){if(this.right!==oe)return c0(this.right);let e=this;for(;e.parent!==oe&&e.parent.left!==e;)e=e.parent;return e.parent===oe?oe:e.parent}prev(){if(this.left!==oe)return NS(this.left);let e=this;for(;e.parent!==oe&&e.parent.right!==e;)e=e.parent;return e.parent===oe?oe:e.parent}detach(){this.parent=null,this.left=null,this.right=null}}const oe=new B_(null,0);oe.parent=oe;oe.left=oe;oe.right=oe;oe.color=0;function c0(r){for(;r.left!==oe;)r=r.left;return r}function NS(r){for(;r.right!==oe;)r=r.right;return r}function l0(r){return r===oe?0:r.size_left+r.piece.length+l0(r.right)}function u0(r){return r===oe?0:r.lf_left+r.piece.lineFeedCnt+u0(r.right)}function pm(){oe.parent=oe}function xl(r,e){const t=e.right;t.size_left+=e.size_left+(e.piece?e.piece.length:0),t.lf_left+=e.lf_left+(e.piece?e.piece.lineFeedCnt:0),e.right=t.left,t.left!==oe&&(t.left.parent=e),t.parent=e.parent,e.parent===oe?r.root=t:e.parent.left===e?e.parent.left=t:e.parent.right=t,t.left=e,e.parent=t}function Cl(r,e){const t=e.left;e.left=t.right,t.right!==oe&&(t.right.parent=e),t.parent=e.parent,e.size_left-=t.size_left+(t.piece?t.piece.length:0),e.lf_left-=t.lf_left+(t.piece?t.piece.lineFeedCnt:0),e.parent===oe?r.root=t:e===e.parent.right?e.parent.right=t:e.parent.left=t,t.right=e,e.parent=t}function Ud(r,e){let t,i;if(e.left===oe?(i=e,t=i.right):e.right===oe?(i=e,t=i.left):(i=c0(e.right),t=i.right),i===r.root){r.root=t,t.color=0,e.detach(),pm(),r.root.parent=oe;return}const n=i.color===1;if(i===i.parent.left?i.parent.left=t:i.parent.right=t,i===e?(t.parent=i.parent,tl(r,t)):(i.parent===e?t.parent=i:t.parent=i.parent,tl(r,t),i.left=e.left,i.right=e.right,i.parent=e.parent,i.color=e.color,e===r.root?r.root=i:e===e.parent.left?e.parent.left=i:e.parent.right=i,i.left!==oe&&(i.left.parent=i),i.right!==oe&&(i.right.parent=i),i.size_left=e.size_left,i.lf_left=e.lf_left,tl(r,i)),e.detach(),t.parent.left===t){const o=l0(t),a=u0(t);if(o!==t.parent.size_left||a!==t.parent.lf_left){const c=o-t.parent.size_left,l=a-t.parent.lf_left;t.parent.size_left=o,t.parent.lf_left=a,Ln(r,t.parent,c,l)}}if(tl(r,t.parent),n){pm();return}let s;for(;t!==r.root&&t.color===0;)t===t.parent.left?(s=t.parent.right,s.color===1&&(s.color=0,t.parent.color=1,xl(r,t.parent),s=t.parent.right),s.left.color===0&&s.right.color===0?(s.color=1,t=t.parent):(s.right.color===0&&(s.left.color=0,s.color=1,Cl(r,s),s=t.parent.right),s.color=t.parent.color,t.parent.color=0,s.right.color=0,xl(r,t.parent),t=r.root)):(s=t.parent.left,s.color===1&&(s.color=0,t.parent.color=1,Cl(r,t.parent),s=t.parent.left),s.left.color===0&&s.right.color===0?(s.color=1,t=t.parent):(s.left.color===0&&(s.right.color=0,s.color=1,xl(r,s),s=t.parent.left),s.color=t.parent.color,t.parent.color=0,s.left.color=0,Cl(r,t.parent),t=r.root));t.color=0,pm()}function $2(r,e){for(tl(r,e);e!==r.root&&e.parent.color===1;)if(e.parent===e.parent.parent.left){const t=e.parent.parent.right;t.color===1?(e.parent.color=0,t.color=0,e.parent.parent.color=1,e=e.parent.parent):(e===e.parent.right&&(e=e.parent,xl(r,e)),e.parent.color=0,e.parent.parent.color=1,Cl(r,e.parent.parent))}else{const t=e.parent.parent.left;t.color===1?(e.parent.color=0,t.color=0,e.parent.parent.color=1,e=e.parent.parent):(e===e.parent.left&&(e=e.parent,Cl(r,e)),e.parent.color=0,e.parent.parent.color=1,xl(r,e.parent.parent))}r.root.color=0}function Ln(r,e,t,i){for(;e!==r.root&&e!==oe;)e.parent.left===e&&(e.parent.size_left+=t,e.parent.lf_left+=i),e=e.parent}function tl(r,e){let t=0,i=0;if(e!==r.root){for(;e!==r.root&&e===e.parent.right;)e=e.parent;if(e!==r.root)for(e=e.parent,t=l0(e.left)-e.size_left,i=u0(e.left)-e.lf_left,e.size_left+=t,e.lf_left+=i;e!==r.root&&(t!==0||i!==0);)e.parent.left===e&&(e.parent.size_left+=t,e.parent.lf_left+=i),e=e.parent}}const Tn=65535;function MS(r){let e;return r[r.length-1]<65536?e=new Uint16Array(r.length):e=new Uint32Array(r.length),e.set(r,0),e}class eT{constructor(e,t,i,n,s){this.lineStarts=e,this.cr=t,this.lf=i,this.crlf=n,this.isBasicASCII=s}}function Nn(r,e=!0){const t=[0];let i=1;for(let n=0,s=r.length;n<s;n++){const o=r.charCodeAt(n);o===13?n+1<s&&r.charCodeAt(n+1)===10?(t[i++]=n+2,n++):t[i++]=n+1:o===10&&(t[i++]=n+1)}return e?MS(t):t}function tT(r,e){r.length=0,r[0]=0;let t=1,i=0,n=0,s=0,o=!0;for(let c=0,l=e.length;c<l;c++){const u=e.charCodeAt(c);u===13?c+1<l&&e.charCodeAt(c+1)===10?(s++,r[t++]=c+2,c++):(i++,r[t++]=c+1):u===10?(n++,r[t++]=c+1):o&&u!==9&&(u<32||u>126)&&(o=!1)}const a=new eT(MS(r),i,n,s,o);return r.length=0,a}class ii{constructor(e,t,i,n,s){this.bufferIndex=e,this.start=t,this.end=i,this.lineFeedCnt=n,this.length=s}}class vs{constructor(e,t){this.buffer=e,this.lineStarts=t}}class iT{constructor(e,t){this._pieces=[],this._tree=e,this._BOM=t,this._index=0,e.root!==oe&&e.iterate(e.root,i=>(i!==oe&&this._pieces.push(i.piece),!0))}read(){return this._pieces.length===0?this._index===0?(this._index++,this._BOM):null:this._index>this._pieces.length-1?null:this._index===0?this._BOM+this._tree.getPieceContent(this._pieces[this._index++]):this._tree.getPieceContent(this._pieces[this._index++])}}class nT{constructor(e){this._limit=e,this._cache=[]}get(e){for(let t=this._cache.length-1;t>=0;t--){const i=this._cache[t];if(i.nodeStartOffset<=e&&i.nodeStartOffset+i.node.piece.length>=e)return i}return null}get2(e){for(let t=this._cache.length-1;t>=0;t--){const i=this._cache[t];if(i.nodeStartLineNumber&&i.nodeStartLineNumber<e&&i.nodeStartLineNumber+i.node.piece.lineFeedCnt>=e)return i}return null}set(e){this._cache.length>=this._limit&&this._cache.shift(),this._cache.push(e)}validate(e){let t=!1;const i=this._cache;for(let n=0;n<i.length;n++){const s=i[n];if(s.node.parent===null||s.nodeStartOffset>=e){i[n]=null,t=!0;continue}}if(t){const n=[];for(const s of i)s!==null&&n.push(s);this._cache=n}}}class rT{constructor(e,t,i){this.create(e,t,i)}create(e,t,i){this._buffers=[new vs("",[0])],this._lastChangeBufferPos={line:0,column:0},this.root=oe,this._lineCnt=1,this._length=0,this._EOL=t,this._EOLLength=t.length,this._EOLNormalized=i;let n=null;for(let s=0,o=e.length;s<o;s++)if(e[s].buffer.length>0){e[s].lineStarts||(e[s].lineStarts=Nn(e[s].buffer));const a=new ii(s+1,{line:0,column:0},{line:e[s].lineStarts.length-1,column:e[s].buffer.length-e[s].lineStarts[e[s].lineStarts.length-1]},e[s].lineStarts.length-1,e[s].buffer.length);this._buffers.push(e[s]),n=this.rbInsertRight(n,a)}this._searchCache=new nT(1),this._lastVisitedLine={lineNumber:0,value:""},this.computeBufferMetadata()}normalizeEOL(e){const t=Tn,i=t-Math.floor(t/3),n=i*2;let s="",o=0;const a=[];if(this.iterate(this.root,c=>{const l=this.getNodeContent(c),u=l.length;if(o<=i||o+u<n)return s+=l,o+=u,!0;const d=s.replace(/\r\n|\r|\n/g,e);return a.push(new vs(d,Nn(d))),s=l,o=u,!0}),o>0){const c=s.replace(/\r\n|\r|\n/g,e);a.push(new vs(c,Nn(c)))}this.create(a,e,!0)}getEOL(){return this._EOL}setEOL(e){this._EOL=e,this._EOLLength=this._EOL.length,this.normalizeEOL(e)}createSnapshot(e){return new iT(this,e)}equal(e){if(this.getLength()!==e.getLength()||this.getLineCount()!==e.getLineCount())return!1;let t=0;return this.iterate(this.root,n=>{if(n===oe)return!0;const s=this.getNodeContent(n),o=s.length,a=e.nodeAt(t),c=e.nodeAt(t+o),l=e.getValueInRange2(a,c);return t+=o,s===l})}getOffsetAt(e,t){let i=0,n=this.root;for(;n!==oe;)if(n.left!==oe&&n.lf_left+1>=e)n=n.left;else if(n.lf_left+n.piece.lineFeedCnt+1>=e){i+=n.size_left;const s=this.getAccumulatedValue(n,e-n.lf_left-2);return i+=s+t-1}else e-=n.lf_left+n.piece.lineFeedCnt,i+=n.size_left+n.piece.length,n=n.right;return i}getPositionAt(e){e=Math.floor(e),e=Math.max(0,e);let t=this.root,i=0;const n=e;for(;t!==oe;)if(t.size_left!==0&&t.size_left>=e)t=t.left;else if(t.size_left+t.piece.length>=e){const s=this.getIndexOf(t,e-t.size_left);if(i+=t.lf_left+s.index,s.index===0){const o=this.getOffsetAt(i+1,1),a=n-o;return new Mi(i+1,a+1)}return new Mi(i+1,s.remainder+1)}else if(e-=t.size_left+t.piece.length,i+=t.lf_left+t.piece.lineFeedCnt,t.right===oe){const s=this.getOffsetAt(i+1,1),o=n-e-s;return new Mi(i+1,o+1)}else t=t.right;return new Mi(1,1)}getValueInRange(e,t){if(e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn)return"";const i=this.nodeAt2(e.startLineNumber,e.startColumn),n=this.nodeAt2(e.endLineNumber,e.endColumn),s=this.getValueInRange2(i,n);return t?t!==this._EOL||!this._EOLNormalized?s.replace(/\r\n|\r|\n/g,t):t===this.getEOL()&&this._EOLNormalized?s:s.replace(/\r\n|\r|\n/g,t):s}getValueInRange2(e,t){if(e.node===t.node){const a=e.node,c=this._buffers[a.piece.bufferIndex].buffer,l=this.offsetInBuffer(a.piece.bufferIndex,a.piece.start);return c.substring(l+e.remainder,l+t.remainder)}let i=e.node;const n=this._buffers[i.piece.bufferIndex].buffer,s=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);let o=n.substring(s+e.remainder,s+i.piece.length);for(i=i.next();i!==oe;){const a=this._buffers[i.piece.bufferIndex].buffer,c=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);if(i===t.node){o+=a.substring(c,c+t.remainder);break}else o+=a.substr(c,i.piece.length);i=i.next()}return o}getLinesContent(){const e=[];let t=0,i="",n=!1;return this.iterate(this.root,s=>{if(s===oe)return!0;const o=s.piece;let a=o.length;if(a===0)return!0;const c=this._buffers[o.bufferIndex].buffer,l=this._buffers[o.bufferIndex].lineStarts,u=o.start.line,d=o.end.line;let f=l[u]+o.start.column;if(n&&(c.charCodeAt(f)===10&&(f++,a--),e[t++]=i,i="",n=!1,a===0))return!0;if(u===d)return!this._EOLNormalized&&c.charCodeAt(f+a-1)===13?(n=!0,i+=c.substr(f,a-1)):i+=c.substr(f,a),!0;i+=this._EOLNormalized?c.substring(f,Math.max(f,l[u+1]-this._EOLLength)):c.substring(f,l[u+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=i;for(let m=u+1;m<d;m++)i=this._EOLNormalized?c.substring(l[m],l[m+1]-this._EOLLength):c.substring(l[m],l[m+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=i;return!this._EOLNormalized&&c.charCodeAt(l[d]+o.end.column-1)===13?(n=!0,o.end.column===0?t--:i=c.substr(l[d],o.end.column-1)):i=c.substr(l[d],o.end.column),!0}),n&&(e[t++]=i,i=""),e[t++]=i,e}getLength(){return this._length}getLineCount(){return this._lineCnt}getLineContent(e){return this._lastVisitedLine.lineNumber===e?this._lastVisitedLine.value:(this._lastVisitedLine.lineNumber=e,e===this._lineCnt?this._lastVisitedLine.value=this.getLineRawContent(e):this._EOLNormalized?this._lastVisitedLine.value=this.getLineRawContent(e,this._EOLLength):this._lastVisitedLine.value=this.getLineRawContent(e).replace(/(\r\n|\r|\n)$/,""),this._lastVisitedLine.value)}_getCharCode(e){if(e.remainder===e.node.piece.length){const t=e.node.next();if(!t)return 0;const i=this._buffers[t.piece.bufferIndex],n=this.offsetInBuffer(t.piece.bufferIndex,t.piece.start);return i.buffer.charCodeAt(n)}else{const t=this._buffers[e.node.piece.bufferIndex],n=this.offsetInBuffer(e.node.piece.bufferIndex,e.node.piece.start)+e.remainder;return t.buffer.charCodeAt(n)}}getLineCharCode(e,t){const i=this.nodeAt2(e,t+1);return this._getCharCode(i)}getLineLength(e){if(e===this.getLineCount()){const t=this.getOffsetAt(e,1);return this.getLength()-t}return this.getOffsetAt(e+1,1)-this.getOffsetAt(e,1)-this._EOLLength}getCharCode(e){const t=this.nodeAt(e);return this._getCharCode(t)}findMatchesInNode(e,t,i,n,s,o,a,c,l,u,d){const f=this._buffers[e.piece.bufferIndex],m=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start),b=this.offsetInBuffer(e.piece.bufferIndex,s),_=this.offsetInBuffer(e.piece.bufferIndex,o);let v;const k={line:0,column:0};let D,E;t._wordSeparators?(D=f.buffer.substring(b,_),E=N=>N+b,t.reset(0)):(D=f.buffer,E=N=>N,t.reset(b));do if(v=t.next(D),v){if(E(v.index)>=_)return u;this.positionInBuffer(e,E(v.index)-m,k);const N=this.getLineFeedCnt(e.piece.bufferIndex,s,k),A=k.line===s.line?k.column-s.column+n:k.column+1,j=A+v[0].length;if(d[u++]=Ky(new Qe(i+N,A,i+N,j),v,c),E(v.index)+v[0].length>=_||u>=l)return u}while(v);return u}findMatchesLineByLine(e,t,i,n){const s=[];let o=0;const a=new J7(t.wordSeparators,t.regex);let c=this.nodeAt2(e.startLineNumber,e.startColumn);if(c===null)return[];const l=this.nodeAt2(e.endLineNumber,e.endColumn);if(l===null)return[];let u=this.positionInBuffer(c.node,c.remainder);const d=this.positionInBuffer(l.node,l.remainder);if(c.node===l.node)return this.findMatchesInNode(c.node,a,e.startLineNumber,e.startColumn,u,d,t,i,n,o,s),s;let f=e.startLineNumber,m=c.node;for(;m!==l.node;){const _=this.getLineFeedCnt(m.piece.bufferIndex,u,m.piece.end);if(_>=1){const k=this._buffers[m.piece.bufferIndex].lineStarts,D=this.offsetInBuffer(m.piece.bufferIndex,m.piece.start),E=k[u.line+_],N=f===e.startLineNumber?e.startColumn:1;if(o=this.findMatchesInNode(m,a,f,N,u,this.positionInBuffer(m,E-D),t,i,n,o,s),o>=n)return s;f+=_}const v=f===e.startLineNumber?e.startColumn-1:0;if(f===e.endLineNumber){const k=this.getLineContent(f).substring(v,e.endColumn-1);return o=this._findMatchesInLine(t,a,k,e.endLineNumber,v,o,s,i,n),s}if(o=this._findMatchesInLine(t,a,this.getLineContent(f).substr(v),f,v,o,s,i,n),o>=n)return s;f++,c=this.nodeAt2(f,1),m=c.node,u=this.positionInBuffer(c.node,c.remainder)}if(f===e.endLineNumber){const _=f===e.startLineNumber?e.startColumn-1:0,v=this.getLineContent(f).substring(_,e.endColumn-1);return o=this._findMatchesInLine(t,a,v,e.endLineNumber,_,o,s,i,n),s}const b=f===e.startLineNumber?e.startColumn:1;return o=this.findMatchesInNode(l.node,a,f,b,u,d,t,i,n,o,s),s}_findMatchesInLine(e,t,i,n,s,o,a,c,l){const u=e.wordSeparators;if(!c&&e.simpleSearch){const f=e.simpleSearch,m=f.length,b=i.length;let _=-m;for(;(_=i.indexOf(f,_+m))!==-1;)if((!u||rS(u,i,b,_,m))&&(a[o++]=new jv(new Qe(n,_+1+s,n,_+1+m+s),null),o>=l))return o;return o}let d;t.reset(0);do if(d=t.next(i),d&&(a[o++]=Ky(new Qe(n,d.index+1+s,n,d.index+1+d[0].length+s),d,c),o>=l))return o;while(d);return o}insert(e,t,i=!1){if(this._EOLNormalized=this._EOLNormalized&&i,this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",this.root!==oe){const{node:n,remainder:s,nodeStartOffset:o}=this.nodeAt(e),a=n.piece,c=a.bufferIndex,l=this.positionInBuffer(n,s);if(n.piece.bufferIndex===0&&a.end.line===this._lastChangeBufferPos.line&&a.end.column===this._lastChangeBufferPos.column&&o+a.length===e&&t.length<Tn){this.appendToNode(n,t),this.computeBufferMetadata();return}if(o===e)this.insertContentToNodeLeft(t,n),this._searchCache.validate(e);else if(o+n.piece.length>e){const u=[];let d=new ii(a.bufferIndex,l,a.end,this.getLineFeedCnt(a.bufferIndex,l,a.end),this.offsetInBuffer(c,a.end)-this.offsetInBuffer(c,l));if(this.shouldCheckCRLF()&&this.endWithCR(t)&&this.nodeCharCodeAt(n,s)===10){const _={line:d.start.line+1,column:0};d=new ii(d.bufferIndex,_,d.end,this.getLineFeedCnt(d.bufferIndex,_,d.end),d.length-1),t+=`
`}if(this.shouldCheckCRLF()&&this.startWithLF(t))if(this.nodeCharCodeAt(n,s-1)===13){const _=this.positionInBuffer(n,s-1);this.deleteNodeTail(n,_),t="\r"+t,n.piece.length===0&&u.push(n)}else this.deleteNodeTail(n,l);else this.deleteNodeTail(n,l);const f=this.createNewPieces(t);d.length>0&&this.rbInsertRight(n,d);let m=n;for(let b=0;b<f.length;b++)m=this.rbInsertRight(m,f[b]);this.deleteNodes(u)}else this.insertContentToNodeRight(t,n)}else{const n=this.createNewPieces(t);let s=this.rbInsertLeft(null,n[0]);for(let o=1;o<n.length;o++)s=this.rbInsertRight(s,n[o])}this.computeBufferMetadata()}delete(e,t){if(this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",t<=0||this.root===oe)return;const i=this.nodeAt(e),n=this.nodeAt(e+t),s=i.node,o=n.node;if(s===o){const f=this.positionInBuffer(s,i.remainder),m=this.positionInBuffer(s,n.remainder);if(i.nodeStartOffset===e){if(t===s.piece.length){const b=s.next();Ud(this,s),this.validateCRLFWithPrevNode(b),this.computeBufferMetadata();return}this.deleteNodeHead(s,m),this._searchCache.validate(e),this.validateCRLFWithPrevNode(s),this.computeBufferMetadata();return}if(i.nodeStartOffset+s.piece.length===e+t){this.deleteNodeTail(s,f),this.validateCRLFWithNextNode(s),this.computeBufferMetadata();return}this.shrinkNode(s,f,m),this.computeBufferMetadata();return}const a=[],c=this.positionInBuffer(s,i.remainder);this.deleteNodeTail(s,c),this._searchCache.validate(e),s.piece.length===0&&a.push(s);const l=this.positionInBuffer(o,n.remainder);this.deleteNodeHead(o,l),o.piece.length===0&&a.push(o);const u=s.next();for(let f=u;f!==oe&&f!==o;f=f.next())a.push(f);const d=s.piece.length===0?s.prev():s;this.deleteNodes(a),this.validateCRLFWithNextNode(d),this.computeBufferMetadata()}insertContentToNodeLeft(e,t){const i=[];if(this.shouldCheckCRLF()&&this.endWithCR(e)&&this.startWithLF(t)){const o=t.piece,a={line:o.start.line+1,column:0},c=new ii(o.bufferIndex,a,o.end,this.getLineFeedCnt(o.bufferIndex,a,o.end),o.length-1);t.piece=c,e+=`
`,Ln(this,t,-1,-1),t.piece.length===0&&i.push(t)}const n=this.createNewPieces(e);let s=this.rbInsertLeft(t,n[n.length-1]);for(let o=n.length-2;o>=0;o--)s=this.rbInsertLeft(s,n[o]);this.validateCRLFWithPrevNode(s),this.deleteNodes(i)}insertContentToNodeRight(e,t){this.adjustCarriageReturnFromNext(e,t)&&(e+=`
`);const i=this.createNewPieces(e),n=this.rbInsertRight(t,i[0]);let s=n;for(let o=1;o<i.length;o++)s=this.rbInsertRight(s,i[o]);this.validateCRLFWithPrevNode(n)}positionInBuffer(e,t,i){const n=e.piece,s=e.piece.bufferIndex,o=this._buffers[s].lineStarts,c=o[n.start.line]+n.start.column+t;let l=n.start.line,u=n.end.line,d=0,f=0,m=0;for(;l<=u&&(d=l+(u-l)/2|0,m=o[d],d!==u);)if(f=o[d+1],c<m)u=d-1;else if(c>=f)l=d+1;else break;return i?(i.line=d,i.column=c-m,null):{line:d,column:c-m}}getLineFeedCnt(e,t,i){if(i.column===0)return i.line-t.line;const n=this._buffers[e].lineStarts;if(i.line===n.length-1)return i.line-t.line;const s=n[i.line+1],o=n[i.line]+i.column;if(s>o+1)return i.line-t.line;const a=o-1;return this._buffers[e].buffer.charCodeAt(a)===13?i.line-t.line+1:i.line-t.line}offsetInBuffer(e,t){return this._buffers[e].lineStarts[t.line]+t.column}deleteNodes(e){for(let t=0;t<e.length;t++)Ud(this,e[t])}createNewPieces(e){if(e.length>Tn){const u=[];for(;e.length>Tn;){const f=e.charCodeAt(Tn-1);let m;f===13||f>=55296&&f<=56319?(m=e.substring(0,Tn-1),e=e.substring(Tn-1)):(m=e.substring(0,Tn),e=e.substring(Tn));const b=Nn(m);u.push(new ii(this._buffers.length,{line:0,column:0},{line:b.length-1,column:m.length-b[b.length-1]},b.length-1,m.length)),this._buffers.push(new vs(m,b))}const d=Nn(e);return u.push(new ii(this._buffers.length,{line:0,column:0},{line:d.length-1,column:e.length-d[d.length-1]},d.length-1,e.length)),this._buffers.push(new vs(e,d)),u}let t=this._buffers[0].buffer.length;const i=Nn(e,!1);let n=this._lastChangeBufferPos;if(this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-1]===t&&t!==0&&this.startWithLF(e)&&this.endWithCR(this._buffers[0].buffer)){this._lastChangeBufferPos={line:this._lastChangeBufferPos.line,column:this._lastChangeBufferPos.column+1},n=this._lastChangeBufferPos;for(let u=0;u<i.length;u++)i[u]+=t+1;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(i.slice(1)),this._buffers[0].buffer+="_"+e,t+=1}else{if(t!==0)for(let u=0;u<i.length;u++)i[u]+=t;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(i.slice(1)),this._buffers[0].buffer+=e}const s=this._buffers[0].buffer.length,o=this._buffers[0].lineStarts.length-1,a=s-this._buffers[0].lineStarts[o],c={line:o,column:a},l=new ii(0,n,c,this.getLineFeedCnt(0,n,c),s-t);return this._lastChangeBufferPos=c,[l]}getLinesRawContent(){return this.getContentOfSubTree(this.root)}getLineRawContent(e,t=0){let i=this.root,n="";const s=this._searchCache.get2(e);if(s){i=s.node;const o=this.getAccumulatedValue(i,e-s.nodeStartLineNumber-1),a=this._buffers[i.piece.bufferIndex].buffer,c=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);if(s.nodeStartLineNumber+i.piece.lineFeedCnt===e)n=a.substring(c+o,c+i.piece.length);else{const l=this.getAccumulatedValue(i,e-s.nodeStartLineNumber);return a.substring(c+o,c+l-t)}}else{let o=0;const a=e;for(;i!==oe;)if(i.left!==oe&&i.lf_left>=e-1)i=i.left;else if(i.lf_left+i.piece.lineFeedCnt>e-1){const c=this.getAccumulatedValue(i,e-i.lf_left-2),l=this.getAccumulatedValue(i,e-i.lf_left-1),u=this._buffers[i.piece.bufferIndex].buffer,d=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);return o+=i.size_left,this._searchCache.set({node:i,nodeStartOffset:o,nodeStartLineNumber:a-(e-1-i.lf_left)}),u.substring(d+c,d+l-t)}else if(i.lf_left+i.piece.lineFeedCnt===e-1){const c=this.getAccumulatedValue(i,e-i.lf_left-2),l=this._buffers[i.piece.bufferIndex].buffer,u=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);n=l.substring(u+c,u+i.piece.length);break}else e-=i.lf_left+i.piece.lineFeedCnt,o+=i.size_left+i.piece.length,i=i.right}for(i=i.next();i!==oe;){const o=this._buffers[i.piece.bufferIndex].buffer;if(i.piece.lineFeedCnt>0){const a=this.getAccumulatedValue(i,0),c=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);return n+=o.substring(c,c+a-t),n}else{const a=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);n+=o.substr(a,i.piece.length)}i=i.next()}return n}computeBufferMetadata(){let e=this.root,t=1,i=0;for(;e!==oe;)t+=e.lf_left+e.piece.lineFeedCnt,i+=e.size_left+e.piece.length,e=e.right;this._lineCnt=t,this._length=i,this._searchCache.validate(this._length)}getIndexOf(e,t){const i=e.piece,n=this.positionInBuffer(e,t),s=n.line-i.start.line;if(this.offsetInBuffer(i.bufferIndex,i.end)-this.offsetInBuffer(i.bufferIndex,i.start)===t){const o=this.getLineFeedCnt(e.piece.bufferIndex,i.start,n);if(o!==s)return{index:o,remainder:0}}return{index:s,remainder:n.column}}getAccumulatedValue(e,t){if(t<0)return 0;const i=e.piece,n=this._buffers[i.bufferIndex].lineStarts,s=i.start.line+t+1;return s>i.end.line?n[i.end.line]+i.end.column-n[i.start.line]-i.start.column:n[s]-n[i.start.line]-i.start.column}deleteNodeTail(e,t){const i=e.piece,n=i.lineFeedCnt,s=this.offsetInBuffer(i.bufferIndex,i.end),o=t,a=this.offsetInBuffer(i.bufferIndex,o),c=this.getLineFeedCnt(i.bufferIndex,i.start,o),l=c-n,u=a-s,d=i.length+u;e.piece=new ii(i.bufferIndex,i.start,o,c,d),Ln(this,e,u,l)}deleteNodeHead(e,t){const i=e.piece,n=i.lineFeedCnt,s=this.offsetInBuffer(i.bufferIndex,i.start),o=t,a=this.getLineFeedCnt(i.bufferIndex,o,i.end),c=this.offsetInBuffer(i.bufferIndex,o),l=a-n,u=s-c,d=i.length+u;e.piece=new ii(i.bufferIndex,o,i.end,a,d),Ln(this,e,u,l)}shrinkNode(e,t,i){const n=e.piece,s=n.start,o=n.end,a=n.length,c=n.lineFeedCnt,l=t,u=this.getLineFeedCnt(n.bufferIndex,n.start,l),d=this.offsetInBuffer(n.bufferIndex,t)-this.offsetInBuffer(n.bufferIndex,s);e.piece=new ii(n.bufferIndex,n.start,l,u,d),Ln(this,e,d-a,u-c);const f=new ii(n.bufferIndex,i,o,this.getLineFeedCnt(n.bufferIndex,i,o),this.offsetInBuffer(n.bufferIndex,o)-this.offsetInBuffer(n.bufferIndex,i)),m=this.rbInsertRight(e,f);this.validateCRLFWithPrevNode(m)}appendToNode(e,t){this.adjustCarriageReturnFromNext(t,e)&&(t+=`
`);const i=this.shouldCheckCRLF()&&this.startWithLF(t)&&this.endWithCR(e),n=this._buffers[0].buffer.length;this._buffers[0].buffer+=t;const s=Nn(t,!1);for(let m=0;m<s.length;m++)s[m]+=n;if(i){const m=this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-2];this._buffers[0].lineStarts.pop(),this._lastChangeBufferPos={line:this._lastChangeBufferPos.line-1,column:n-m}}this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(s.slice(1));const o=this._buffers[0].lineStarts.length-1,a=this._buffers[0].buffer.length-this._buffers[0].lineStarts[o],c={line:o,column:a},l=e.piece.length+t.length,u=e.piece.lineFeedCnt,d=this.getLineFeedCnt(0,e.piece.start,c),f=d-u;e.piece=new ii(e.piece.bufferIndex,e.piece.start,c,d,l),this._lastChangeBufferPos=c,Ln(this,e,t.length,f)}nodeAt(e){let t=this.root;const i=this._searchCache.get(e);if(i)return{node:i.node,nodeStartOffset:i.nodeStartOffset,remainder:e-i.nodeStartOffset};let n=0;for(;t!==oe;)if(t.size_left>e)t=t.left;else if(t.size_left+t.piece.length>=e){n+=t.size_left;const s={node:t,remainder:e-t.size_left,nodeStartOffset:n};return this._searchCache.set(s),s}else e-=t.size_left+t.piece.length,n+=t.size_left+t.piece.length,t=t.right;return null}nodeAt2(e,t){let i=this.root,n=0;for(;i!==oe;)if(i.left!==oe&&i.lf_left>=e-1)i=i.left;else if(i.lf_left+i.piece.lineFeedCnt>e-1){const s=this.getAccumulatedValue(i,e-i.lf_left-2),o=this.getAccumulatedValue(i,e-i.lf_left-1);return n+=i.size_left,{node:i,remainder:Math.min(s+t-1,o),nodeStartOffset:n}}else if(i.lf_left+i.piece.lineFeedCnt===e-1){const s=this.getAccumulatedValue(i,e-i.lf_left-2);if(s+t-1<=i.piece.length)return{node:i,remainder:s+t-1,nodeStartOffset:n};t-=i.piece.length-s;break}else e-=i.lf_left+i.piece.lineFeedCnt,n+=i.size_left+i.piece.length,i=i.right;for(i=i.next();i!==oe;){if(i.piece.lineFeedCnt>0){const s=this.getAccumulatedValue(i,0),o=this.offsetOfNode(i);return{node:i,remainder:Math.min(t-1,s),nodeStartOffset:o}}else if(i.piece.length>=t-1){const s=this.offsetOfNode(i);return{node:i,remainder:t-1,nodeStartOffset:s}}else t-=i.piece.length;i=i.next()}return null}nodeCharCodeAt(e,t){if(e.piece.lineFeedCnt<1)return-1;const i=this._buffers[e.piece.bufferIndex],n=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start)+t;return i.buffer.charCodeAt(n)}offsetOfNode(e){if(!e)return 0;let t=e.size_left;for(;e!==this.root;)e.parent.right===e&&(t+=e.parent.size_left+e.parent.piece.length),e=e.parent;return t}shouldCheckCRLF(){return!(this._EOLNormalized&&this._EOL===`
`)}startWithLF(e){if(typeof e=="string")return e.charCodeAt(0)===10;if(e===oe||e.piece.lineFeedCnt===0)return!1;const t=e.piece,i=this._buffers[t.bufferIndex].lineStarts,n=t.start.line,s=i[n]+t.start.column;return n===i.length-1||i[n+1]>s+1?!1:this._buffers[t.bufferIndex].buffer.charCodeAt(s)===10}endWithCR(e){return typeof e=="string"?e.charCodeAt(e.length-1)===13:e===oe||e.piece.lineFeedCnt===0?!1:this.nodeCharCodeAt(e,e.piece.length-1)===13}validateCRLFWithPrevNode(e){if(this.shouldCheckCRLF()&&this.startWithLF(e)){const t=e.prev();this.endWithCR(t)&&this.fixCRLF(t,e)}}validateCRLFWithNextNode(e){if(this.shouldCheckCRLF()&&this.endWithCR(e)){const t=e.next();this.startWithLF(t)&&this.fixCRLF(e,t)}}fixCRLF(e,t){const i=[],n=this._buffers[e.piece.bufferIndex].lineStarts;let s;e.piece.end.column===0?s={line:e.piece.end.line-1,column:n[e.piece.end.line]-n[e.piece.end.line-1]-1}:s={line:e.piece.end.line,column:e.piece.end.column-1};const o=e.piece.length-1,a=e.piece.lineFeedCnt-1;e.piece=new ii(e.piece.bufferIndex,e.piece.start,s,a,o),Ln(this,e,-1,-1),e.piece.length===0&&i.push(e);const c={line:t.piece.start.line+1,column:0},l=t.piece.length-1,u=this.getLineFeedCnt(t.piece.bufferIndex,c,t.piece.end);t.piece=new ii(t.piece.bufferIndex,c,t.piece.end,u,l),Ln(this,t,-1,-1),t.piece.length===0&&i.push(t);const d=this.createNewPieces(`\r
`);this.rbInsertRight(e,d[0]);for(let f=0;f<i.length;f++)Ud(this,i[f])}adjustCarriageReturnFromNext(e,t){if(this.shouldCheckCRLF()&&this.endWithCR(e)){const i=t.next();if(this.startWithLF(i)){if(e+=`
`,i.piece.length===1)Ud(this,i);else{const n=i.piece,s={line:n.start.line+1,column:0},o=n.length-1,a=this.getLineFeedCnt(n.bufferIndex,s,n.end);i.piece=new ii(n.bufferIndex,s,n.end,a,o),Ln(this,i,-1,-1)}return!0}}return!1}iterate(e,t){if(e===oe)return t(oe);const i=this.iterate(e.left,t);return i&&t(e)&&this.iterate(e.right,t)}getNodeContent(e){if(e===oe)return"";const t=this._buffers[e.piece.bufferIndex],i=e.piece,n=this.offsetInBuffer(i.bufferIndex,i.start),s=this.offsetInBuffer(i.bufferIndex,i.end);return t.buffer.substring(n,s)}getPieceContent(e){const t=this._buffers[e.bufferIndex],i=this.offsetInBuffer(e.bufferIndex,e.start),n=this.offsetInBuffer(e.bufferIndex,e.end);return t.buffer.substring(i,n)}rbInsertRight(e,t){const i=new B_(t,1);if(i.left=oe,i.right=oe,i.parent=oe,i.size_left=0,i.lf_left=0,this.root===oe)this.root=i,i.color=0;else if(e.right===oe)e.right=i,i.parent=e;else{const s=c0(e.right);s.left=i,i.parent=s}return $2(this,i),i}rbInsertLeft(e,t){const i=new B_(t,1);if(i.left=oe,i.right=oe,i.parent=oe,i.size_left=0,i.lf_left=0,this.root===oe)this.root=i,i.color=0;else if(e.left===oe)e.left=i,i.parent=e;else{const n=NS(e.left);n.right=i,i.parent=n}return $2(this,i),i}getContentOfSubTree(e){let t="";return this.iterate(e,i=>(t+=this.getNodeContent(i),!0)),t}}function gm(r){let e=0,t=0,i=0,n=0;for(let s=0,o=r.length;s<o;s++){const a=r.charCodeAt(s);a===13?(e===0&&(t=s),e++,s+1<o&&r.charCodeAt(s+1)===10?(n|=2,s++):n|=3,i=s+1):a===10&&(n|=1,e===0&&(t=s),e++,i=s+1)}return e===0&&(t=r.length),[e,t,r.length-i,n]}let mm;function sT(){return mm||(mm=new TextDecoder("UTF-16LE")),mm}function oT(r,e,t){const i=new Uint16Array(r.buffer,e,t);return t>0&&(i[0]===65279||i[0]===65534)?aT(r,e,t):sT().decode(i)}function aT(r,e,t){const i=[];let n=0;for(let s=0;s<t;s++){const o=d4(r,e);e+=2,i[n++]=String.fromCharCode(o)}return i.join("")}function Bd(r){return r.replace(/\n/g,"\\n").replace(/\r/g,"\\r")}class ji{get oldLength(){return this.oldText.length}get oldEnd(){return this.oldPosition+this.oldText.length}get newLength(){return this.newText.length}get newEnd(){return this.newPosition+this.newText.length}constructor(e,t,i,n){this.oldPosition=e,this.oldText=t,this.newPosition=i,this.newText=n}toString(){return this.oldText.length===0?`(insert@${this.oldPosition} "${Bd(this.newText)}")`:this.newText.length===0?`(delete@${this.oldPosition} "${Bd(this.oldText)}")`:`(replace@${this.oldPosition} "${Bd(this.oldText)}" with "${Bd(this.newText)}")`}static _writeStringSize(e){return 4+2*e.length}static _writeString(e,t,i){const n=t.length;zd(e,n,i),i+=4;for(let s=0;s<n;s++)h4(e,t.charCodeAt(s),i),i+=2;return i}static _readString(e,t){const i=Wd(e,t);return t+=4,oT(e,t,i)}writeSize(){return 8+ji._writeStringSize(this.oldText)+ji._writeStringSize(this.newText)}write(e,t){return zd(e,this.oldPosition,t),t+=4,zd(e,this.newPosition,t),t+=4,t=ji._writeString(e,this.oldText,t),t=ji._writeString(e,this.newText,t),t}static read(e,t,i){const n=Wd(e,t);t+=4;const s=Wd(e,t);t+=4;const o=ji._readString(e,t);t+=ji._writeStringSize(o);const a=ji._readString(e,t);return t+=ji._writeStringSize(a),i.push(new ji(n,o,s,a)),t}}class Qo extends Fe{constructor(e,t,i,n,s,o,a){super(),this._onDidChangeContent=this._register(new R),this.onDidChangeContent=this._onDidChangeContent.event,this._BOM=t,this._mightContainNonBasicASCII=!o,this._mightContainRTL=n,this._mightContainUnusualLineTerminators=s,this._pieceTree=new rT(e,i,a)}equals(e){return!(e instanceof Qo)||this._BOM!==e._BOM||this.getEOL()!==e.getEOL()?!1:this._pieceTree.equal(e._pieceTree)}mightContainRTL(){return this._mightContainRTL}mightContainUnusualLineTerminators(){return this._mightContainUnusualLineTerminators}resetMightContainUnusualLineTerminators(){this._mightContainUnusualLineTerminators=!1}mightContainNonBasicASCII(){return this._mightContainNonBasicASCII}getBOM(){return this._BOM}getEOL(){return this._pieceTree.getEOL()}createSnapshot(e){return this._pieceTree.createSnapshot(e?this._BOM:"")}getOffsetAt(e,t){return this._pieceTree.getOffsetAt(e,t)}getPositionAt(e){return this._pieceTree.getPositionAt(e)}getRangeAt(e,t){const i=e+t,n=this.getPositionAt(e),s=this.getPositionAt(i);return new Qe(n.lineNumber,n.column,s.lineNumber,s.column)}getValueInRange(e,t=0){if(e.isEmpty())return"";const i=this._getEndOfLine(t);return this._pieceTree.getValueInRange(e,i)}getValueLengthInRange(e,t=0){if(e.isEmpty())return 0;if(e.startLineNumber===e.endLineNumber)return e.endColumn-e.startColumn;const i=this.getOffsetAt(e.startLineNumber,e.startColumn),n=this.getOffsetAt(e.endLineNumber,e.endColumn);let s=0;const o=this._getEndOfLine(t),a=this.getEOL();if(o.length!==a.length){const c=o.length-a.length,l=e.endLineNumber-e.startLineNumber;s=c*l}return n-i+s}getCharacterCountInRange(e,t=0){if(this._mightContainNonBasicASCII){let i=0;const n=e.startLineNumber,s=e.endLineNumber;for(let o=n;o<=s;o++){const a=this.getLineContent(o),c=o===n?e.startColumn-1:0,l=o===s?e.endColumn-1:a.length;for(let u=c;u<l;u++)Gp(a.charCodeAt(u))?(i=i+1,u=u+1):i=i+1}return i+=this._getEndOfLine(t).length*(s-n),i}return this.getValueLengthInRange(e,t)}getLength(){return this._pieceTree.getLength()}getLineCount(){return this._pieceTree.getLineCount()}getLinesContent(){return this._pieceTree.getLinesContent()}getLineContent(e){return this._pieceTree.getLineContent(e)}getLineCharCode(e,t){return this._pieceTree.getLineCharCode(e,t)}getCharCode(e){return this._pieceTree.getCharCode(e)}getLineLength(e){return this._pieceTree.getLineLength(e)}getLineMinColumn(e){return 1}getLineMaxColumn(e){return this.getLineLength(e)+1}getLineFirstNonWhitespaceColumn(e){const t=Bg(this.getLineContent(e));return t===-1?0:t+1}getLineLastNonWhitespaceColumn(e){const t=dE(this.getLineContent(e));return t===-1?0:t+2}_getEndOfLine(e){switch(e){case 1:return`
`;case 2:return`\r
`;case 0:return this.getEOL();default:throw new Error("Unknown EOL preference")}}setEOL(e){this._pieceTree.setEOL(e)}applyEdits(e,t,i){let n=this._mightContainRTL,s=this._mightContainUnusualLineTerminators,o=this._mightContainNonBasicASCII,a=!0,c=[];for(let _=0;_<e.length;_++){const v=e[_];a&&v._isTracked&&(a=!1);const k=v.range;if(v.text){let j=!0;o||(j=!wE(v.text),o=j),!n&&j&&(n=Rx(v.text)),!s&&j&&(s=Lx(v.text))}let D="",E=0,N=0,A=0;if(v.text){let j;[E,N,A,j]=gm(v.text);const re=this.getEOL();j===0||j===(re===`\r
`?2:1)?D=v.text:D=v.text.replace(/\r\n|\r|\n/g,re)}c[_]={sortIndex:_,identifier:v.identifier||null,range:k,rangeOffset:this.getOffsetAt(k.startLineNumber,k.startColumn),rangeLength:this.getValueLengthInRange(k),text:D,eolCount:E,firstLineLength:N,lastLineLength:A,forceMoveMarkers:!!v.forceMoveMarkers,isAutoWhitespaceEdit:v.isAutoWhitespaceEdit||!1}}c.sort(Qo._sortOpsAscending);let l=!1;for(let _=0,v=c.length-1;_<v;_++){const k=c[_].range.getEndPosition(),D=c[_+1].range.getStartPosition();if(D.isBeforeOrEqual(k)){if(D.isBefore(k))throw new Error("Overlapping ranges are not allowed!");l=!0}}a&&(c=this._reduceOperations(c));const u=i||t?Qo._getInverseEditRanges(c):[],d=[];if(t)for(let _=0;_<c.length;_++){const v=c[_],k=u[_];if(v.isAutoWhitespaceEdit&&v.range.isEmpty())for(let D=k.startLineNumber;D<=k.endLineNumber;D++){let E="";D===k.startLineNumber&&(E=this.getLineContent(v.range.startLineNumber),Bg(E)!==-1)||d.push({lineNumber:D,oldContent:E})}}let f=null;if(i){let _=0;f=[];for(let v=0;v<c.length;v++){const k=c[v],D=u[v],E=this.getValueInRange(k.range),N=k.rangeOffset+_;_+=k.text.length-E.length,f[v]={sortIndex:k.sortIndex,identifier:k.identifier,range:D,text:E,textChange:new ji(k.rangeOffset,E,N,k.text)}}l||f.sort((v,k)=>v.sortIndex-k.sortIndex)}this._mightContainRTL=n,this._mightContainUnusualLineTerminators=s,this._mightContainNonBasicASCII=o;const m=this._doApplyEdits(c);let b=null;if(t&&d.length>0){d.sort((_,v)=>v.lineNumber-_.lineNumber),b=[];for(let _=0,v=d.length;_<v;_++){const k=d[_].lineNumber;if(_>0&&d[_-1].lineNumber===k)continue;const D=d[_].oldContent,E=this.getLineContent(k);E.length===0||E===D||Bg(E)!==-1||b.push(k)}}return this._onDidChangeContent.fire(),new q7(f,m,b)}_reduceOperations(e){return e.length<1e3?e:[this._toSingleEditOperation(e)]}_toSingleEditOperation(e){let t=!1;const i=e[0].range,n=e[e.length-1].range,s=new Qe(i.startLineNumber,i.startColumn,n.endLineNumber,n.endColumn);let o=i.startLineNumber,a=i.startColumn;const c=[];for(let m=0,b=e.length;m<b;m++){const _=e[m],v=_.range;t=t||_.forceMoveMarkers,c.push(this.getValueInRange(new Qe(o,a,v.startLineNumber,v.startColumn))),_.text.length>0&&c.push(_.text),o=v.endLineNumber,a=v.endColumn}const l=c.join(""),[u,d,f]=gm(l);return{sortIndex:0,identifier:e[0].identifier,range:s,rangeOffset:this.getOffsetAt(s.startLineNumber,s.startColumn),rangeLength:this.getValueLengthInRange(s,0),text:l,eolCount:u,firstLineLength:d,lastLineLength:f,forceMoveMarkers:t,isAutoWhitespaceEdit:!1}}_doApplyEdits(e){e.sort(Qo._sortOpsDescending);const t=[];for(let i=0;i<e.length;i++){const n=e[i],s=n.range.startLineNumber,o=n.range.startColumn,a=n.range.endLineNumber,c=n.range.endColumn;if(s===a&&o===c&&n.text.length===0)continue;n.text?(this._pieceTree.delete(n.rangeOffset,n.rangeLength),this._pieceTree.insert(n.rangeOffset,n.text,!0)):this._pieceTree.delete(n.rangeOffset,n.rangeLength);const l=new Qe(s,o,a,c);t.push({range:l,rangeLength:n.rangeLength,text:n.text,rangeOffset:n.rangeOffset,forceMoveMarkers:n.forceMoveMarkers})}return t}findMatchesLineByLine(e,t,i,n){return this._pieceTree.findMatchesLineByLine(e,t,i,n)}getPieceTree(){return this._pieceTree}static _getInverseEditRange(e,t){const i=e.startLineNumber,n=e.startColumn,[s,o,a]=gm(t);let c;if(t.length>0){const l=s+1;l===1?c=new Qe(i,n,i,n+o):c=new Qe(i,n,i+l-1,a+1)}else c=new Qe(i,n,i,n);return c}static _getInverseEditRanges(e){const t=[];let i=0,n=0,s=null;for(let o=0,a=e.length;o<a;o++){const c=e[o];let l,u;s?s.range.endLineNumber===c.range.startLineNumber?(l=i,u=n+(c.range.startColumn-s.range.endColumn)):(l=i+(c.range.startLineNumber-s.range.endLineNumber),u=c.range.startColumn):(l=c.range.startLineNumber,u=c.range.startColumn);let d;if(c.text.length>0){const f=c.eolCount+1;f===1?d=new Qe(l,u,l,u+c.firstLineLength):d=new Qe(l,u,l+f-1,c.lastLineLength+1)}else d=new Qe(l,u,l,u);i=d.endLineNumber,n=d.endColumn,t.push(d),s=c}return t}static _sortOpsAscending(e,t){const i=Qe.compareRangesUsingEnds(e.range,t.range);return i===0?e.sortIndex-t.sortIndex:i}static _sortOpsDescending(e,t){const i=Qe.compareRangesUsingEnds(e.range,t.range);return i===0?t.sortIndex-e.sortIndex:-i}}class cT{constructor(e,t,i,n,s,o,a,c,l){this._chunks=e,this._bom=t,this._cr=i,this._lf=n,this._crlf=s,this._containsRTL=o,this._containsUnusualLineTerminators=a,this._isBasicASCII=c,this._normalizeEOL=l}_getEOL(e){const t=this._cr+this._lf+this._crlf,i=this._cr+this._crlf;return t===0?e===1?`
`:`\r
`:i>t/2?`\r
`:`
`}create(e){const t=this._getEOL(e),i=this._chunks;if(this._normalizeEOL&&(t===`\r
`&&(this._cr>0||this._lf>0)||t===`
`&&(this._cr>0||this._crlf>0)))for(let s=0,o=i.length;s<o;s++){const a=i[s].buffer.replace(/\r\n|\r|\n/g,t),c=Nn(a);i[s]=new vs(a,c)}const n=new Qo(i,this._bom,t,this._containsRTL,this._containsUnusualLineTerminators,this._isBasicASCII,this._normalizeEOL);return{textBuffer:n,disposable:n}}getFirstLineText(e){return this._chunks[0].buffer.substr(0,e).split(/\r\n|\r|\n/)[0]}}class N2{constructor(){this.chunks=[],this.BOM="",this._hasPreviousChar=!1,this._previousChar=0,this._tmpLineStarts=[],this.cr=0,this.lf=0,this.crlf=0,this.containsRTL=!1,this.containsUnusualLineTerminators=!1,this.isBasicASCII=!0}acceptChunk(e){if(e.length===0)return;this.chunks.length===0&&xE(e)&&(this.BOM=yE,e=e.substr(1));const t=e.charCodeAt(e.length-1);t===13||t>=55296&&t<=56319?(this._acceptChunk1(e.substr(0,e.length-1),!1),this._hasPreviousChar=!0,this._previousChar=t):(this._acceptChunk1(e,!1),this._hasPreviousChar=!1,this._previousChar=t)}_acceptChunk1(e,t){!t&&e.length===0||(this._hasPreviousChar?this._acceptChunk2(String.fromCharCode(this._previousChar)+e):this._acceptChunk2(e))}_acceptChunk2(e){const t=tT(this._tmpLineStarts,e);this.chunks.push(new vs(e,t.lineStarts)),this.cr+=t.cr,this.lf+=t.lf,this.crlf+=t.crlf,t.isBasicASCII||(this.isBasicASCII=!1,this.containsRTL||(this.containsRTL=Rx(e)),this.containsUnusualLineTerminators||(this.containsUnusualLineTerminators=Lx(e)))}finish(e=!0){return this._finish(),new cT(this.chunks,this.BOM,this.cr,this.lf,this.crlf,this.containsRTL,this.containsUnusualLineTerminators,this.isBasicASCII,e)}_finish(){if(this.chunks.length===0&&this._acceptChunk1("",!0),this._hasPreviousChar){this._hasPreviousChar=!1;const e=this.chunks[this.chunks.length-1];e.buffer+=String.fromCharCode(this._previousChar);const t=Nn(e.buffer);e.lineStarts=t,this._previousChar===13&&this.cr++}}}class lT extends Fe{constructor(e,t,i){super(),this._source=e,this._inputTextBuffer=t,this._outputs=i,this._outputTextBuffers=void 0}_getFullModelRange(e){const t=e.getLineCount();return new Qe(1,1,t,this._getLineMaxColumn(e,t))}_getLineMaxColumn(e,t){if(t<1||t>e.getLineCount())throw new Error("Illegal value for lineNumber");return e.getLineLength(t)+1}get inputTextBuffer(){if(!this._inputTextBuffer){const e=new N2;e.acceptChunk(this._source);const t=e.finish(!0),{textBuffer:i,disposable:n}=t.create(1);this._inputTextBuffer=i,this._register(n)}return this._inputTextBuffer}get outputTextBuffers(){return this._outputTextBuffers||(this._outputTextBuffers=this._outputs.map(e=>{const t=new N2;t.acceptChunk(e);const i=t.finish(!0),{textBuffer:n,disposable:s}=i.create(1);return this._register(s),n})),this._outputTextBuffers}findInInputs(e){const i=new Jy(e,!1,!1,null).parseSearchRequest();if(!i)return[];const n=this._getFullModelRange(this.inputTextBuffer);return this.inputTextBuffer.findMatchesLineByLine(n,i,!0,5e3)}findInOutputs(e){const i=new Jy(e,!1,!1,null).parseSearchRequest();return i?this.outputTextBuffers.map(n=>{const s=n.findMatchesLineByLine(this._getFullModelRange(n),i,!0,5e3);if(s.length!==0)return{textBuffer:n,matches:s}}).filter(n=>!!n):[]}}function M2(r,e){let t=-1;const i=[];let n=[];return r.forEach(o=>{o.range.startLineNumber!==t&&n.length>0&&(i.push([...n]),n=[]),n.push(o),t=o.range.endLineNumber}),n.length>0&&i.push([...n]),i.map(o=>{const a=[],c=o[0].range.startLineNumber,l=o[o.length-1].range.endLineNumber;for(let u=c;u<=l;u++)a.push(e.getLineContent(u));return new jI(a.join(`
`)+`
`,o.map(u=>new Qe(u.range.startLineNumber-1,u.range.startColumn-1,u.range.endLineNumber-1,u.range.endColumn-1)))})}const uT=Ce("remoteAgentService"),lo="vs/workbench/common/configuration";Object.freeze({id:"application",order:100,title:h(lo,0,"Application"),type:"object"});const dT=Object.freeze({id:"workbench",order:7,title:h(lo,1,"Workbench"),type:"object"}),hT=Object.freeze({id:"security",scope:1,title:h(lo,2,"Security"),type:"object",order:7});Object.freeze({id:"problems",title:h(lo,3,"Problems"),type:"object",order:101});const fT={ConfigurationMigration:"base.contributions.configuration.migration"};class pT{constructor(){this.migrations=[],this._onDidRegisterConfigurationMigrations=new R,this.onDidRegisterConfigurationMigration=this._onDidRegisterConfigurationMigrations.event}registerConfigurationMigrations(e){this.migrations.push(...e)}}const oh=new pT;qt.add(fT.ConfigurationMigration,oh);var ju;let F2=(ju=class extends Fe{constructor(e,t){super(),this.configurationService=e,this.workspaceService=t,this._register(this.workspaceService.onDidChangeWorkspaceFolders(async i=>{for(const n of i.added)await this.migrateConfigurationsForFolder(n,oh.migrations)})),this.migrateConfigurations(oh.migrations),this._register(oh.onDidRegisterConfigurationMigration(i=>this.migrateConfigurations(i)))}async migrateConfigurations(e){await this.migrateConfigurationsForFolder(void 0,e);for(const t of this.workspaceService.getWorkspace().folders)await this.migrateConfigurationsForFolder(t,e)}async migrateConfigurationsForFolder(e,t){await Promise.all([t.map(i=>this.migrateConfigurationsForFolderAndOverride(i,e==null?void 0:e.uri))])}async migrateConfigurationsForFolderAndOverride(e,t){const i=this.configurationService.inspect(e.key,{resource:t}),n=this.workspaceService.getWorkbenchState()===3?[["user",2],["userLocal",3],["userRemote",4],["workspace",5],["workspaceFolder",6]]:[["user",2],["userLocal",3],["userRemote",4],["workspace",5]];for(const[s,o]of n){const a=i[s];if(!a)continue;const c=[];if(a.value!==void 0){const l=await this.runMigration(e,s,a.value,t,void 0);for(const u of l??[])c.push([u,[]])}for(const{identifiers:l,value:u}of a.overrides??[])if(u!==void 0){const d=await this.runMigration(e,s,u,t,l);for(const f of d??[])c.push([f,l])}c.length&&await Promise.allSettled(c.map(async([[l,u],d])=>this.configurationService.updateValue(l,u.value,{resource:t,overrideIdentifiers:d},o)))}}async runMigration(e,t,i,n,s){const o=c=>{var d,f;const u=this.configurationService.inspect(c,{resource:n})[t];if(u)return s?(f=(d=u.overrides)==null?void 0:d.find(({identifiers:m})=>tn(m,s)))==null?void 0:f.value:u.value},a=await e.migrateFn(i,o);return Array.isArray(a)?a:[[e.key,a]]}},ju.ID="workbench.contrib.configurationMigration",ju);F2=U([M(0,Jw),M(1,sS)],F2);var qu;let O2=(qu=class extends Fe{constructor(e){super(),this.remoteAgentService=e,this._ready=new bc,this.ready=this._ready.p,this.create()}async create(){try{await this.doCreate()}finally{this._ready.complete()}}async doCreate(){if(!Ii){const t=await this.remoteAgentService.getEnvironment();if((t==null?void 0:t.os)!==1)return}qt.as(ld.Configuration).registerConfiguration({...hT,properties:{"security.allowedUNCHosts":{type:"array",items:{type:"string",pattern:"^[^\\\\]+$",patternErrorMessage:h(lo,4,"UNC host names must not contain backslashes.")},default:[],markdownDescription:h(lo,5,"A set of UNC host names (without leading or trailing backslash, for example `192.168.0.1` or `my-server`) to allow without user confirmation. If a UNC host is being accessed that is not allowed via this setting or has not been acknowledged via user confirmation, an error will occur and the operation stopped. A restart is required when changing this setting. Find out more about this setting at https://aka.ms/vscode-windows-unc."),scope:2},"security.restrictUNCAccess":{type:"boolean",default:!0,markdownDescription:h(lo,6,"If enabled, only allows access to UNC host names that are allowed by the `#security.allowedUNCHosts#` setting or after user confirmation. Find out more about this setting at https://aka.ms/vscode-windows-unc."),scope:2}}})}},qu.ID="workbench.contrib.dynamicWorkbenchSecurityConfiguration",qu);O2=U([M(0,uT)],O2);const gT="vs/workbench/services/editor/common/editorResolverService",mT=qt.as(ld.Configuration),vT={...dT,properties:{"workbench.editorAssociations":{type:"object",markdownDescription:h(gT,0,'Configure [glob patterns](https://aka.ms/vscode-glob-patterns) to editors (for example `"*.hex": "hexEditor.hexedit"`). These have precedence over the default behavior.'),additionalProperties:{type:"string"}}}};mT.registerConfiguration(vT);var H2;(function(r){r.builtin="builtin",r.option="option",r.exclusive="exclusive",r.default="default"})(H2||(H2={}));function _T(r,e){if(new Set([ne.extension,ne.webviewPanel,ne.vscodeWorkspaceTrust,ne.vscodeSettings]).has(e.scheme))return!1;const n=typeof r=="string"&&r.indexOf(Be.sep)>=0?`${e.scheme}:${e.path}`:_c(e);return ll(typeof r=="string"?r.toLowerCase():r,n.toLowerCase())}const U2="vs/workbench/api/common/extHostNotebook",xs=class xs{get activeNotebookEditor(){var e;return(e=this._activeNotebookEditor)==null?void 0:e.apiEditor}get visibleNotebookEditors(){return this._visibleNotebookEditors.map(e=>e.apiEditor)}constructor(e,t,i,n,s,o){this._textDocumentsAndEditors=i,this._textDocuments=n,this._extHostFileSystem=s,this._extHostSearch=o,this._notebookStatusBarItemProviders=new Map,this._documents=new Pt,this._editors=new Map,this._onDidChangeActiveNotebookEditor=new R,this.onDidChangeActiveNotebookEditor=this._onDidChangeActiveNotebookEditor.event,this._visibleNotebookEditors=[],this._onDidOpenNotebookDocument=new R,this.onDidOpenNotebookDocument=this._onDidOpenNotebookDocument.event,this._onDidCloseNotebookDocument=new R,this.onDidCloseNotebookDocument=this._onDidCloseNotebookDocument.event,this._onDidChangeVisibleNotebookEditors=new R,this.onDidChangeVisibleNotebookEditors=this._onDidChangeVisibleNotebookEditors.event,this._statusBarCache=new Ri("NotebookCellStatusBarCache"),this._handlePool=0,this._notebookSerializer=new Map,this._notebookProxy=e.getProxy(J.MainThreadNotebook),this._notebookDocumentsProxy=e.getProxy(J.MainThreadNotebookDocuments),this._notebookEditorsProxy=e.getProxy(J.MainThreadNotebookEditors),this._commandsConverter=t.converter,t.registerArgumentProcessor({processArgument:a=>{var c;if(a&&a.$mid===13){const l=(c=a.notebookEditor)==null?void 0:c.notebookUri,u=a.cell.handle,d=this._documents.get(l),f=d==null?void 0:d.getCell(u);if(f)return f.apiCell}if(a&&a.$mid===14){const l=a.uri,u=this._documents.get(l);if(u)return u.apiNotebook}return a}}),xs._registerApiCommands(t)}getEditorById(e){const t=this._editors.get(e);if(!t)throw new Error(`unknown text editor: ${e}. known editors: ${[...this._editors.keys()]} `);return t}getIdByEditor(e){for(const[t,i]of this._editors)if(i.apiEditor===e)return t}get notebookDocuments(){return[...this._documents.values()]}getNotebookDocument(e,t){const i=this._documents.get(e);if(!i&&!t)throw new Error(`NO notebook document for '${e}'`);return i}static _convertNotebookRegistrationData(e,t){if(!t)return;const i=t.filenamePattern.map(n=>Bf.from(n)).filter(n=>n!==void 0);if(t.filenamePattern&&!i){console.warn(`Notebook content provider view options file name pattern is invalid ${t.filenamePattern}`);return}return{extension:e.identifier,providerDisplayName:e.displayName||e.name,displayName:t.displayName,filenamePattern:i,exclusive:t.exclusive||!1}}registerNotebookCellStatusBarItemProvider(e,t,i){const n=xs._notebookStatusBarItemProviderHandlePool++,s=typeof i.onDidChangeCellStatusBarItems=="function"?xs._notebookStatusBarItemProviderHandlePool++:void 0;this._notebookStatusBarItemProviders.set(n,i),this._notebookProxy.$registerNotebookCellStatusBarItemProvider(n,s,t);let o;return s!==void 0&&(o=i.onDidChangeCellStatusBarItems(a=>this._notebookProxy.$emitCellStatusBarEvent(s))),new Ne(()=>{this._notebookStatusBarItemProviders.delete(n),this._notebookProxy.$unregisterNotebookCellStatusBarItemProvider(n,s),o==null||o.dispose()})}async createNotebookDocument(e){const t=await this._notebookDocumentsProxy.$tryCreateNotebook({viewType:e.viewType,content:e.content&&br.from(e.content)});return x.revive(t)}async openNotebookDocument(e){const t=this._documents.get(e);if(t)return t.apiNotebook;const i=await this._notebookDocumentsProxy.$tryOpenNotebook(e),n=this._documents.get(x.revive(i));return Oa(n==null?void 0:n.apiNotebook)}async showNotebookDocument(e,t){var o;x.isUri(e)&&(e=await this.openNotebookDocument(e));let i;typeof t=="object"?i={position:Et.from(t.viewColumn),preserveFocus:t.preserveFocus,selections:t.selections&&t.selections.map(Cn.from),pinned:typeof t.preview=="boolean"?!t.preview:void 0}:i={preserveFocus:!1};const n=await this._notebookEditorsProxy.$tryShowNotebookDocument(e.uri,e.notebookType,i),s=n&&((o=this._editors.get(n))==null?void 0:o.apiEditor);if(s)return s;throw n?new Error(`Could NOT open editor for "${e.uri.toString()}" because another editor opened in the meantime.`):new Error(`Could NOT open editor for "${e.uri.toString()}".`)}async $provideNotebookCellStatusBarItems(e,t,i,n){const s=this._notebookStatusBarItemProviders.get(e),o=x.revive(t),a=this._documents.get(o);if(!a||!s)return;const c=a.getCellFromIndex(i);if(!c)return;const l=await s.provideCellStatusBarItems(c.apiCell,n);if(!l)return;const u=new Te,d=this._statusBarCache.add([u]),m=(Array.isArray(l)?l:[l]).map(b=>dv.from(b,this._commandsConverter,u));return{cacheId:d,items:m}}$releaseNotebookCellStatusBarItems(e){this._statusBarCache.delete(e)}registerNotebookSerializer(e,t,i,n,s){if(gh(t))throw new Error("viewType cannot be empty or just whitespace");const o=this._handlePool++;return this._notebookSerializer.set(o,{viewType:t,serializer:i,options:n}),this._notebookProxy.$registerNotebookSerializer(o,{id:e.identifier,location:e.extensionLocation},t,fv.from(n),xs._convertNotebookRegistrationData(e,s)),De(()=>{this._notebookProxy.$unregisterNotebookSerializer(o)})}async $dataToNotebook(e,t,i){const n=this._notebookSerializer.get(e);if(!n)throw new Error("NO serializer found");const s=await n.serializer.deserializeNotebook(t.buffer,i);return new Di(br.from(s))}async $notebookToData(e,t,i){const n=this._notebookSerializer.get(e);if(!n)throw new Error("NO serializer found");const s=await n.serializer.serializeNotebook(br.to(t.value),i);return _e.wrap(s)}async $saveNotebook(e,t,i,n,s){var b;const o=x.revive(t),a=this._notebookSerializer.get(e);if(!a)throw new Error("NO serializer found");const c=this._documents.get(o);if(!c)throw new Error("Document NOT found");if(c.versionId!==i)throw new Error("Document version mismatch");if(!this._extHostFileSystem.value.isWritableFileSystem(o.scheme))throw new Tb(h(U2,0,"Unable to modify read-only file '{0}'",this._resourceForError(o)),6);await this._validateWriteFile(o,n);const l={metadata:Z0(c.apiNotebook.metadata,_=>{var v;return!(((v=a.options)==null?void 0:v.transientDocumentMetadata)??{})[_]}),cells:[]};for(const _ of c.apiNotebook.getCells()){const v=new ng(_.kind,_.document.getText(),_.document.languageId,_.mime,(b=a.options)!=null&&b.transientOutputs?[]:[..._.outputs],_.metadata,_.executionSummary);v.metadata=Z0(_.metadata,k=>{var D;return!(((D=a.options)==null?void 0:D.transientCellMetadata)??{})[k]}),l.cells.push(v)}const u=await a.serializer.serializeNotebook(l,s);await this._extHostFileSystem.value.writeFile(o,u);const d=this._extHostFileSystem.getFileSystemProviderExtUri(o.scheme),f=await this._extHostFileSystem.value.stat(o);return{name:d.basename(o),isFile:(f.type&eo.File)!==0,isDirectory:(f.type&eo.Directory)!==0,isSymbolicLink:(f.type&eo.SymbolicLink)!==0,mtime:f.mtime,ctime:f.ctime,size:f.size,readonly:!!((f.permissions??0)&Ba.Readonly)||!this._extHostFileSystem.value.isWritableFileSystem(o.scheme),locked:!!((f.permissions??0)&Ba.Locked),etag:Rb({mtime:f.mtime,size:f.size}),children:void 0}}async $searchInNotebooks(e,t,i,n,s){var f;const o=(f=this._notebookSerializer.get(e))==null?void 0:f.serializer;if(!o)return{limitHit:!1,results:[]};const a=new ux;await(async(m,b,_)=>{await Promise.all(m.map(async v=>await Promise.all(v.filenamePatterns.map(k=>{const D={_reason:_._reason,folderQueries:_.folderQueries,includePattern:_.includePattern,excludePattern:_.excludePattern,maxResults:_.maxResults,type:1,filePattern:k};return this._extHostSearch.doInternalFileSearchWithCustomCallback(D,b,E=>{E.forEach(N=>{a.has(N)||n.some(j=>v.isFromSettings&&!j.isFromSettings?!1:j.filenamePatterns.some(re=>_T(re,N)))||a.add(N)})}).catch(E=>{if(E.code==="ENOENT")return console.warn("Could not find notebook search results, ignoring notebook results."),{limitHit:!1,messages:[]};throw E})}))))})(i,s,t);const l=new Pt;let u=!1;const d=Array.from(a).map(async m=>{const b=[];try{if(s.isCancellationRequested)return;if(t.maxResults&&[...l.values()].reduce((D,E)=>D+E.cellResults.length,0)>t.maxResults){u=!0;return}const _=[],v=this._documents.get(m);if(v)v.apiNotebook.getCells().forEach(E=>_.push({input:E.document.getText(),outputs:E.outputs.flatMap(N=>N.items.map(A=>A.data.toString()))}));else{const D=await this._extHostFileSystem.value.readFile(m),E=_e.fromString(D.toString()),N=await o.deserializeNotebook(E.buffer,s);if(s.isCancellationRequested)return;br.from(N).cells.forEach(j=>_.push({input:j.source,outputs:j.outputs.flatMap(re=>re.items.map(te=>te.valueBytes.toString()))}))}if(s.isCancellationRequested)return;_.forEach((D,E)=>{const N=t.contentPattern.pattern,A=new lT(D.input,void 0,D.outputs),j=A.findInInputs(N),re=A.findInOutputs(N),te=re.flatMap(q=>M2(q.matches,q.textBuffer)).map((q,We)=>(q.webviewIndex=We,q));if(j.length>0||re.length>0){const q={index:E,contentResults:M2(j,A.inputTextBuffer),webviewResults:te};b.push(q)}});const k={resource:m,cellResults:b};l.set(m,k);return}catch{return}});return await Promise.all(d),{limitHit:u,results:[...l.values()]}}async _validateWriteFile(e,t){const i=await this._extHostFileSystem.value.stat(e);if(typeof(t==null?void 0:t.mtime)=="number"&&typeof t.etag=="string"&&t.etag!==N5&&typeof i.mtime=="number"&&typeof i.size=="number"&&t.mtime<i.mtime&&t.etag!==Rb({mtime:t.mtime,size:i.size}))throw new Tb(h(U2,1,"File Modified Since"),3,t)}_resourceForError(e){return e.scheme===ne.file?e.fsPath:e.toString()}_createExtHostEditor(e,t,i){if(this._editors.has(t))throw new Error(`editor with id ALREADY EXSIST: ${t}`);const n=new Tu(t,this._notebookEditorsProxy,e,i.visibleRanges.map(Cn.to),i.selections.map(Cn.to),typeof i.viewColumn=="number"?Et.to(i.viewColumn):void 0);this._editors.set(t,n)}$acceptDocumentAndEditorsDelta(e){var t,i,n;if(e.value.removedDocuments)for(const s of e.value.removedDocuments){const o=x.revive(s),a=this._documents.get(o);a&&(a.dispose(),this._documents.delete(o),this._textDocumentsAndEditors.$acceptDocumentsAndEditorsDelta({removedDocuments:a.apiNotebook.getCells().map(c=>c.document.uri)}),this._onDidCloseNotebookDocument.fire(a.apiNotebook));for(const c of this._editors.values())c.notebookData.uri.toString()===o.toString()&&this._editors.delete(c.id)}if(e.value.addedDocuments){const s=[];for(const o of e.value.addedDocuments){const a=x.revive(o.uri);if(this._documents.has(a))throw new Error(`adding EXISTING notebook ${a} `);const c=new U_(this._notebookDocumentsProxy,this._textDocumentsAndEditors,this._textDocuments,a,o);s.push(...o.cells.map(l=>H_.asModelAddData(l))),(t=this._documents.get(a))==null||t.dispose(),this._documents.set(a,c),this._textDocumentsAndEditors.$acceptDocumentsAndEditorsDelta({addedDocuments:s}),this._onDidOpenNotebookDocument.fire(c.apiNotebook)}}if(e.value.addedEditors)for(const s of e.value.addedEditors){if(this._editors.has(s.id))return;const o=x.revive(s.documentUri),a=this._documents.get(o);a&&this._createExtHostEditor(a,s.id,s)}if(e.value.removedEditors)for(const s of e.value.removedEditors){const o=this._editors.get(s);o&&(this._editors.delete(s),((i=this._activeNotebookEditor)==null?void 0:i.id)===o.id&&(this._activeNotebookEditor=void 0))}if(e.value.visibleEditors){this._visibleNotebookEditors=e.value.visibleEditors.map(o=>this._editors.get(o)).filter(o=>!!o);const s=new Set;this._visibleNotebookEditors.forEach(o=>s.add(o.id));for(const o of this._editors.values()){const a=s.has(o.id);o._acceptVisibility(a)}this._visibleNotebookEditors=[...this._editors.values()].map(o=>o).filter(o=>o.visible),this._onDidChangeVisibleNotebookEditors.fire(this.visibleNotebookEditors)}e.value.newActiveEditor===null?this._activeNotebookEditor=void 0:e.value.newActiveEditor&&(this._editors.get(e.value.newActiveEditor)||console.error(`FAILED to find active notebook editor ${e.value.newActiveEditor}`),this._activeNotebookEditor=this._editors.get(e.value.newActiveEditor)),e.value.newActiveEditor!==void 0&&this._onDidChangeActiveNotebookEditor.fire((n=this._activeNotebookEditor)==null?void 0:n.apiEditor)}static _registerApiCommands(e){const t=z.String.with("notebookType","A notebook type"),i=new be("vscode.executeDataToNotebook","_executeDataToNotebook","Invoke notebook serializer",[t,new z("data","Bytes to convert to data",s=>s instanceof Uint8Array,s=>_e.wrap(s))],new ve("Notebook Data",s=>br.to(s.value))),n=new be("vscode.executeNotebookToData","_executeNotebookToData","Invoke notebook serializer",[t,new z("NotebookData","Notebook data to convert to bytes",s=>!0,s=>new Di(br.from(s)))],new ve("Bytes",s=>s.buffer));e.registerApiCommand(i),e.registerApiCommand(n)}};xs._notebookStatusBarItemProviderHandlePool=0;let V_=xs;class wT{constructor(e,t,i,n={timeout:1500,errors:3}){this._logService=e,this._notebooksAndEditors=t,this._mainThreadBulkEdits=i,this._thresholds=n,this._onWillSaveNotebookDocumentEvent=new il}dispose(){}getOnWillSaveNotebookDocumentEvent(e){return(t,i,n)=>{const s=function(a){t.call(i,a)};return s.extension=e,this._onWillSaveNotebookDocumentEvent.event(s,void 0,n)}}async $participateInSave(e,t,i){const n=x.revive(e),s=this._notebooksAndEditors.getNotebookDocument(n);if(!s)throw new Error("Unable to resolve notebook document");const o=[];if(await this._onWillSaveNotebookDocumentEvent.fireAsync({notebook:s.apiNotebook,reason:Ff.to(t)},i,async(c,l)=>{const u=Date.now(),d=await await Promise.resolve(c);Date.now()-u>this._thresholds.timeout&&this._logService.warn("onWillSaveNotebookDocument-listener from extension",l.extension.identifier),!i.isCancellationRequested&&d&&(d instanceof Zr?o.push(d):this._logService.warn("onWillSaveNotebookDocument-listener from extension",l.extension.identifier,"ignored due to invalid data"))}),i.isCancellationRequested)return!1;if(o.length===0)return!0;const a={edits:[]};for(const c of o){const{edits:l}=Wt.from(c);a.edits=a.edits.concat(l)}return this._mainThreadBulkEdits.$tryApplyWorkspaceEdit(new Di(a))}}class bT{constructor(e){this._notebooksAndEditors=e,this._onDidSaveNotebookDocument=new R,this.onDidSaveNotebookDocument=this._onDidSaveNotebookDocument.event,this._onDidChangeNotebookDocument=new R,this.onDidChangeNotebookDocument=this._onDidChangeNotebookDocument.event}$acceptModelChanged(e,t,i,n){const o=this._notebooksAndEditors.getNotebookDocument(x.revive(e)).acceptModelChanged(t.value,i,n);this._onDidChangeNotebookDocument.fire(o)}$acceptDirtyStateChanged(e,t){this._notebooksAndEditors.getNotebookDocument(x.revive(e)).acceptDirty(t)}$acceptModelSaved(e){const t=this._notebooksAndEditors.getNotebookDocument(x.revive(e));this._onDidSaveNotebookDocument.fire(t.apiNotebook)}}let W_=class{constructor(e,t){this._logService=e,this._notebooksAndEditors=t,this._onDidChangeNotebookEditorSelection=new R,this._onDidChangeNotebookEditorVisibleRanges=new R,this.onDidChangeNotebookEditorSelection=this._onDidChangeNotebookEditorSelection.event,this.onDidChangeNotebookEditorVisibleRanges=this._onDidChangeNotebookEditorVisibleRanges.event}$acceptEditorPropertiesChanged(e,t){this._logService.debug("ExtHostNotebook#$acceptEditorPropertiesChanged",e,t);const i=this._notebooksAndEditors.getEditorById(e);t.visibleRanges&&i._acceptVisibleRanges(t.visibleRanges.ranges.map(Cn.to)),t.selections&&i._acceptSelections(t.selections.selections.map(Cn.to)),t.visibleRanges&&this._onDidChangeNotebookEditorVisibleRanges.fire({notebookEditor:i.apiEditor,visibleRanges:i.apiEditor.visibleRanges}),t.selections&&this._onDidChangeNotebookEditorSelection.fire(Object.freeze({notebookEditor:i.apiEditor,selections:i.apiEditor.selections}))}$acceptEditorViewColumns(e){for(const t in e)this._notebooksAndEditors.getEditorById(t)._acceptViewColumn(Et.to(e[t]))}};W_=U([M(0,Je)],W_);var Jo;(function(r){r[r.Output=1]="Output",r[r.OutputItems=2]="OutputItems",r[r.ExecutionState=3]="ExecutionState"})(Jo||(Jo={}));const yT=100;let z_=class{constructor(e,t,i,n,s){this._initData=t,this._extHostNotebook=i,this._commands=n,this._logService=s,this._activeExecutions=new Pt,this._activeNotebookExecutions=new Pt,this._kernelDetectionTask=new Map,this._kernelDetectionTaskHandlePool=0,this._kernelSourceActionProviders=new Map,this._kernelSourceActionProviderHandlePool=0,this._kernelData=new Map,this._handlePool=0,this._onDidChangeCellExecutionState=new R,this.onDidChangeNotebookCellExecutionState=this._onDidChangeCellExecutionState.event,this.id=0,this.variableStore={},this._proxy=e.getProxy(J.MainThreadNotebookKernels);const o=new be("notebook.selectKernel","_notebook.selectKernel","Trigger kernel picker for specified notebook editor widget",[new z("options","Select kernel options",c=>!0,c=>{if(c&&"notebookEditor"in c&&"id"in c){const l=this._extHostNotebook.getIdByEditor(c.notebookEditor);return{id:c.id,extension:c.extension,notebookEditorId:l}}else if(c&&"notebookEditor"in c){const l=this._extHostNotebook.getIdByEditor(c.notebookEditor);if(l===void 0)throw new Error(`Cannot invoke 'notebook.selectKernel' for unrecognized notebook editor ${c.notebookEditor.notebook.uri.toString()}`);return{notebookEditorId:l}}return c})],ve.Void),a=new be("vscode.executeNotebookVariableProvider","_executeNotebookVariableProvider","Execute notebook variable provider",[z.Uri],new ve("A promise that resolves to an array of variables",(c,l)=>c.map(u=>({variable:{name:u.name,value:u.value,expression:u.expression,type:u.type,language:u.language},hasNamedChildren:u.hasNamedChildren,indexedChildrenCount:u.indexedChildrenCount}))));this._commands.registerApiCommand(o),this._commands.registerApiCommand(a)}createNotebookController(e,t,i,n,s,o){for(const A of this._kernelData.values())if(A.controller.id===t&&Xe.equals(e.identifier,A.extensionId))throw new Error(`notebook controller with id '${t}' ALREADY exist`);const a=this._handlePool++,c=this;this._logService.trace(`NotebookController[${a}], CREATED by ${e.identifier.value}, ${t}`);const l=()=>console.warn(`NO execute handler from notebook controller '${m.id}' of extension: '${e.identifier}'`);let u=!1;const d=new R,f=new R,m={id:Vd(e.identifier,t),notebookType:i,extensionId:e.identifier,extensionLocation:e.extensionLocation,label:n||e.identifier.value,preloads:o?o.map(Vf.from):[]};let b=s??l,_,v;this._proxy.$addKernel(a,m).catch(A=>{console.log(A),u=!0});let k=0;const D=()=>{if(u)return;const A=++k;Promise.resolve().then(()=>{A===k&&this._proxy.$updateKernel(a,m)})},E=new Pt,N={get id(){return t},get notebookType(){return m.notebookType},onDidChangeSelectedNotebooks:d.event,get label(){return m.label},set label(A){m.label=A??e.displayName??e.name,D()},get detail(){return m.detail??""},set detail(A){m.detail=A,D()},get description(){return m.description??""},set description(A){m.description=A,D()},get supportedLanguages(){return m.supportedLanguages},set supportedLanguages(A){m.supportedLanguages=A,D()},get supportsExecutionOrder(){return m.supportsExecutionOrder??!1},set supportsExecutionOrder(A){m.supportsExecutionOrder=A,D()},get rendererScripts(){return m.preloads?m.preloads.map(Vf.to):[]},get executeHandler(){return b},set executeHandler(A){b=A??l},get interruptHandler(){return _},set interruptHandler(A){_=A,m.supportsInterrupt=!!A,D()},set variableProvider(A){O(e,"notebookVariableProvider"),v=A,m.hasVariableProvider=!!A,A==null||A.onDidChangeVariables(j=>c._proxy.$variablesUpdated(j.uri)),D()},get variableProvider(){return v},createNotebookCellExecution(A){if(u)throw new Error("notebook controller is DISPOSED");if(!E.has(A.notebook.uri))throw c._logService.trace(`NotebookController[${a}] NOT associated to notebook, associated to THESE notebooks:`,Array.from(E.keys()).map(j=>j.toString())),new Error(`notebook controller is NOT associated to notebook: ${A.notebook.uri.toString()}`);return c._createNotebookCellExecution(A,Vd(e.identifier,this.id))},createNotebookExecution(A){if(O(e,"notebookExecution"),u)throw new Error("notebook controller is DISPOSED");if(!E.has(A.uri))throw c._logService.trace(`NotebookController[${a}] NOT associated to notebook, associated to THESE notebooks:`,Array.from(E.keys()).map(j=>j.toString())),new Error(`notebook controller is NOT associated to notebook: ${A.uri.toString()}`);return c._createNotebookExecution(A,Vd(e.identifier,this.id))},dispose:()=>{u||(this._logService.trace(`NotebookController[${a}], DISPOSED`),u=!0,this._kernelData.delete(a),d.dispose(),f.dispose(),this._proxy.$removeKernel(a))},updateNotebookAffinity(A,j){j===vf.Hidden&&O(e,"notebookControllerAffinityHidden"),c._proxy.$updateNotebookPriority(a,A.uri,j)},onDidReceiveMessage:f.event,postMessage(A,j){return O(e,"notebookMessaging"),c._proxy.$postMessage(a,j&&c._extHostNotebook.getIdByEditor(j),A)},asWebviewUri(A){return O(e,"notebookMessaging"),wl(A,c._initData.remote)}};return this._kernelData.set(a,{extensionId:e.identifier,controller:N,onDidReceiveMessage:f,onDidChangeSelection:d,associatedNotebooks:E}),N}getIdByController(e){for(const[t,i]of this._kernelData)if(i.controller===e)return Vd(i.extensionId,e.id);return null}createNotebookControllerDetectionTask(e,t){const i=this._kernelDetectionTaskHandlePool++,n=this;this._logService.trace(`NotebookControllerDetectionTask[${i}], CREATED by ${e.identifier.value}`),this._proxy.$addKernelDetectionTask(i,t);const s={dispose:()=>{this._kernelDetectionTask.delete(i),n._proxy.$removeKernelDetectionTask(i)}};return this._kernelDetectionTask.set(i,s),s}registerKernelSourceActionProvider(e,t,i){const n=this._kernelSourceActionProviderHandlePool++,s=typeof i.onDidChangeNotebookKernelSourceActions=="function"?n:void 0,o=this;this._kernelSourceActionProviders.set(n,i),this._logService.trace(`NotebookKernelSourceActionProvider[${n}], CREATED by ${e.identifier.value}`),this._proxy.$addKernelSourceActionProvider(n,n,t);let a;return s!==void 0&&(a=i.onDidChangeNotebookKernelSourceActions(c=>this._proxy.$emitNotebookKernelSourceActionsChangeEvent(s))),{dispose:()=>{this._kernelSourceActionProviders.delete(n),o._proxy.$removeKernelSourceActionProvider(n,n),a==null||a.dispose()}}}async $provideKernelSourceActions(e,t){const i=this._kernelSourceActionProviders.get(e);if(i){const n=new Te;return(await i.provideNotebookKernelSourceActions(t)??[]).map(o=>hv.from(o,this._commands.converter,n))}return[]}$acceptNotebookAssociation(e,t,i){const n=this._kernelData.get(e);if(n){const s=this._extHostNotebook.getNotebookDocument(x.revive(t));i?n.associatedNotebooks.set(s.uri,!0):n.associatedNotebooks.delete(s.uri),this._logService.trace(`NotebookController[${e}] ASSOCIATE notebook`,s.uri.toString(),i),n.onDidChangeSelection.fire({selected:i,notebook:s.apiNotebook})}}async $executeCells(e,t,i){const n=this._kernelData.get(e);if(!n)return;const s=this._extHostNotebook.getNotebookDocument(x.revive(t)),o=[];for(const a of i){const c=s.getCell(a);c&&o.push(c.apiCell)}try{this._logService.trace(`NotebookController[${e}] EXECUTE cells`,s.uri.toString(),o.length),await n.controller.executeHandler.call(n.controller,o,s.apiNotebook,n.controller)}catch(a){this._logService.error(`NotebookController[${e}] execute cells FAILED`,a),console.error(a)}}async $cancelCells(e,t,i){var o;const n=this._kernelData.get(e);if(!n)return;const s=this._extHostNotebook.getNotebookDocument(x.revive(t));if(n.controller.interruptHandler)await n.controller.interruptHandler.call(n.controller,s.apiNotebook);else for(const a of i){const c=s.getCell(a);c&&((o=this._activeExecutions.get(c.uri))==null||o.cancel())}if(n.controller.interruptHandler){const a=this._activeNotebookExecutions.get(s.uri);i.length&&Array.isArray(a)&&a.length&&a.forEach(c=>c.dispose())}}async $provideVariables(e,t,i,n,s,o,a){const c=this._kernelData.get(e);if(!c)return;const l=this._extHostNotebook.getNotebookDocument(x.revive(i)),u=c.controller.variableProvider;if(!u)return;let d;if(n!==void 0){if(d=this.variableStore[n],!d)return}else this.variableStore={};const f=s==="named"?au.Named:au.Indexed,m=u.provideVariables(l.apiNotebook,d,f,o,a);let b=0;for await(const _ of m){if(a.isCancellationRequested)return;const v={id:this.id++,name:_.variable.name,value:_.variable.value,type:_.variable.type,interfaces:_.variable.interfaces,language:_.variable.language,expression:_.variable.expression,hasNamedChildren:_.hasNamedChildren,indexedChildrenCount:_.indexedChildrenCount,extensionId:c.extensionId.value};if(this.variableStore[v.id]=_.variable,this._proxy.$receiveVariable(t,v),b++>=yT)return}}$acceptKernelMessageFromRenderer(e,t,i){const n=this._kernelData.get(e);if(!n)return;const s=this._extHostNotebook.getEditorById(t);n.onDidReceiveMessage.fire(Object.freeze({editor:s.apiEditor,message:i}))}$cellExecutionChanged(e,t,i){const s=this._extHostNotebook.getNotebookDocument(x.revive(e)).getCell(t);if(s){const o=i?uv.to(i):Xa.Idle;o!==void 0&&this._onDidChangeCellExecutionState.fire({cell:s.apiCell,state:o})}}_createNotebookCellExecution(e,t){if(e.index<0)throw new Error("CANNOT execute cell that has been REMOVED from notebook");const n=this._extHostNotebook.getNotebookDocument(e.notebook.uri).getCellFromApiCell(e);if(!n)throw new Error("invalid cell");if(this._activeExecutions.has(n.uri))throw new Error(`duplicate execution for ${n.uri}`);const s=new j_(t,n,this._proxy);this._activeExecutions.set(n.uri,s);const o=s.onDidChangeState(()=>{s.state===Gi.Resolved&&(s.dispose(),o.dispose(),this._activeExecutions.delete(n.uri))});return s.asApiObject()}_createNotebookExecution(e,t){const i=this._extHostNotebook.getNotebookDocument(e.uri),n=e.getCells().find(a=>{const c=i.getCellFromApiCell(a);return c&&this._activeExecutions.has(c.uri)});if(n)throw new Error(`duplicate cell execution for ${n.document.uri}`);if(this._activeNotebookExecutions.has(i.uri))throw new Error(`duplicate notebook execution for ${i.uri}`);const s=new q_(t,i,this._proxy),o=s.onDidChangeState(()=>{s.state===Un.Resolved&&(s.dispose(),o.dispose(),this._activeNotebookExecutions.delete(i.uri))});return this._activeNotebookExecutions.set(i.uri,[s,o]),s.asApiObject()}};z_=U([M(4,Je)],z_);var Gi;(function(r){r[r.Init=0]="Init",r[r.Started=1]="Started",r[r.Resolved=2]="Resolved"})(Gi||(Gi={}));const Op=class Op extends Fe{get state(){return this._state}constructor(e,t,i){super(),this._cell=t,this._proxy=i,this._handle=Op.HANDLE++,this._onDidChangeState=new R,this.onDidChangeState=this._onDidChangeState.event,this._state=Gi.Init,this._tokenSource=this._register(new Tt),this._collector=new xT(10,n=>this.update(n)),this._executionOrder=t.internalMetadata.executionOrder,this._proxy.$createExecution(this._handle,e,this._cell.notebook.uri,this._cell.handle)}cancel(){this._tokenSource.cancel()}async updateSoon(e){await this._collector.addItem(e)}async update(e){const t=Array.isArray(e)?e:[e];return this._proxy.$updateExecution(this._handle,new Di(t))}verifyStateForOutput(){if(this._state===Gi.Init)throw new Error("Must call start before modifying cell output");if(this._state===Gi.Resolved)throw new Error("Cannot modify cell output after calling resolve")}cellIndexToHandle(e){let t=this._cell;if(e&&(t=this._cell.notebook.getCellFromApiCell(e)),!t)throw new Error("INVALID cell");return t.handle}validateAndConvertOutputs(e){return e.map(t=>{const i=pf.ensureUniqueMimeTypes(t.items,!0);return i===t.items?Yr.from(t):Yr.from({items:i,id:t.id,metadata:t.metadata})})}async updateOutputs(e,t,i){const n=this.cellIndexToHandle(t),s=this.validateAndConvertOutputs($a(e));return this.updateSoon({editType:Jo.Output,cellHandle:n,append:i,outputs:s})}async updateOutputItems(e,t,i){return e=pf.ensureUniqueMimeTypes($a(e),!0),this.updateSoon({editType:Jo.OutputItems,items:e.map(oc.from),outputId:t.id,append:i})}asApiObject(){const e=this;return Object.freeze({get token(){return e._tokenSource.token},get cell(){return e._cell.apiCell},get executionOrder(){return e._executionOrder},set executionOrder(i){e._executionOrder=i,e.update([{editType:Jo.ExecutionState,executionOrder:e._executionOrder}])},start(i){if(e._state===Gi.Resolved||e._state===Gi.Started)throw new Error("Cannot call start again");e._state=Gi.Started,e._onDidChangeState.fire(),e.update({editType:Jo.ExecutionState,runStartTime:i})},end(i,n,s){if(e._state===Gi.Resolved)throw new Error("Cannot call resolve twice");e._state=Gi.Resolved,e._onDidChangeState.fire(),e._collector.flush();const o=s?{message:s.message,stack:s.stack,location:s!=null&&s.location?{startLineNumber:s.location.start.line,startColumn:s.location.start.character,endLineNumber:s.location.end.line,endColumn:s.location.end.character}:void 0,uri:s.uri}:void 0;e._proxy.$completeExecution(e._handle,new Di({runEndTime:n,lastRunSuccess:i,error:o}))},clearOutput(i){return e.verifyStateForOutput(),e.updateOutputs([],i,!1)},appendOutput(i,n){return e.verifyStateForOutput(),e.updateOutputs(i,n,!0)},replaceOutput(i,n){return e.verifyStateForOutput(),e.updateOutputs(i,n,!1)},appendOutputItems(i,n){return e.verifyStateForOutput(),e.updateOutputItems(i,n,!0)},replaceOutputItems(i,n){return e.verifyStateForOutput(),e.updateOutputItems(i,n,!1)}})}};Op.HANDLE=0;let j_=Op;var Un;(function(r){r[r.Init=0]="Init",r[r.Started=1]="Started",r[r.Resolved=2]="Resolved"})(Un||(Un={}));const Hp=class Hp extends Fe{get state(){return this._state}constructor(e,t,i){super(),this._notebook=t,this._proxy=i,this._handle=Hp.HANDLE++,this._onDidChangeState=new R,this.onDidChangeState=this._onDidChangeState.event,this._state=Un.Init,this._tokenSource=this._register(new Tt),this._proxy.$createNotebookExecution(this._handle,e,this._notebook.uri)}cancel(){this._tokenSource.cancel()}asApiObject(){return Object.freeze({start:()=>{if(this._state===Un.Resolved||this._state===Un.Started)throw new Error("Cannot call start again");this._state=Un.Started,this._onDidChangeState.fire(),this._proxy.$beginNotebookExecution(this._handle)},end:()=>{if(this._state===Un.Resolved)throw new Error("Cannot call resolve twice");this._state=Un.Resolved,this._onDidChangeState.fire(),this._proxy.$completeNotebookExecution(this._handle)}})}};Hp.HANDLE=0;let q_=Hp;class xT{constructor(e,t){this.delay=e,this.callback=t,this.batch=[],this.startedTimer=Date.now()}addItem(e){return this.batch.push(e),this.currentDeferred||(this.currentDeferred=new bc,this.startedTimer=Date.now(),Yn(this.delay).then(()=>this.flush())),Date.now()-this.startedTimer>this.delay?this.flush():this.currentDeferred.p}flush(){if(this.batch.length===0||!this.currentDeferred)return Promise.resolve();const e=this.currentDeferred;this.currentDeferred=void 0;const t=this.batch;return this.batch=[],this.callback(t).finally(()=>e.complete())}}function Vd(r,e){return`${r.value}/${e}`}class CT{constructor(e,t){this._extHostNotebook=t,this._rendererMessageEmitters=new Map,this.proxy=e.getProxy(J.MainThreadNotebookRenderers)}$postRendererMessage(e,t,i){var s;const n=this._extHostNotebook.getEditorById(e);(s=this._rendererMessageEmitters.get(t))==null||s.fire({editor:n.apiEditor,message:i})}createRendererMessaging(e,t){var n,s;if(!((s=(n=e.contributes)==null?void 0:n.notebookRenderer)!=null&&s.some(o=>o.id===t)))throw new Error(`Extensions may only call createRendererMessaging() for renderers they contribute (got ${t})`);return{onDidReceiveMessage:(o,a,c)=>this.getOrCreateEmitterFor(t).event(o,a,c),postMessage:(o,a)=>{Tu.apiEditorsToExtHost.has(o)&&([o,a]=[a,o]);const c=a&&Tu.apiEditorsToExtHost.get(a);return this.proxy.$postMessage(c==null?void 0:c.id,t,o)}}}getOrCreateEmitterFor(e){let t=this._rendererMessageEmitters.get(e);return t||(t=new R({onDidRemoveLastListener:()=>{t==null||t.dispose(),this._rendererMessageEmitters.delete(e)}}),this._rendererMessageEmitters.set(e,t),t)}}class ST{constructor(e){this.handlers=new Map,this.proxy=e.getProxy(J.MainThreadProfileContentHandlers)}registerProfileContentHandler(e,t,i){if(O(e,"profileContentHandlers"),this.handlers.has(t))throw new Error(`Handler with id '${t}' already registered`);return this.handlers.set(t,i),this.proxy.$registerProfileContentHandler(t,i.name,i.description,e.identifier.value),De(()=>{this.handlers.delete(t),this.proxy.$unregisterProfileContentHandler(t)})}async $saveProfile(e,t,i,n){const s=this.handlers.get(e);if(!s)throw new Error(`Unknown handler with id: ${e}`);return s.saveProfile(t,i,n)}async $readProfile(e,t,i){const n=this.handlers.get(e);if(!n)throw new Error(`Unknown handler with id: ${e}`);return n.readProfile($e(t)?t:x.revive(t),i)}}function FS(r){return(e,t,i)=>{let n=null,s=null;if(typeof i.value=="function"?(n="value",s=i.value):typeof i.get=="function"&&(n="get",s=i.get),!s)throw new Error("not supported");i[n]=r(s,t)}}function OS(r,e,t){return FS((i,n)=>{const s=`$debounce$${n}`,o=`$debounce$result$${n}`;return function(...a){this[o]||(this[o]=void 0),clearTimeout(this[s]),this[s]=setTimeout(()=>{i.apply(this,a),this[o]=void 0},r)}})}function ET(r,e,t){return FS((i,n)=>{const s=`$throttle$timer$${n}`,o=`$throttle$result$${n}`,a=`$throttle$lastRun$${n}`,c=`$throttle$pending$${n}`;return function(...l){if(this[o]||(this[o]=t?t():void 0),(this[a]===null||this[a]===void 0)&&(this[a]=-Number.MAX_VALUE),e&&(this[o]=e(this[o],...l)),this[c])return;const u=this[a]+r;u<=Date.now()?(this[a]=Date.now(),i.apply(this,[this[o]]),this[o]=t?t():void 0):(this[c]=!0,this[s]=setTimeout(()=>{this[c]=!1,this[a]=Date.now(),i.apply(this,[this[o]]),this[o]=t?t():void 0},u-Date.now()))}})}class kT{constructor(e){this._handles=0,this._mapHandleToCancellationSource=new Map,this._proxy=e}async withProgress(e,t,i){const n=this._handles++,{title:s,location:o,cancellable:a}=t,c={label:e.displayName||e.name,id:e.identifier.value};return this._proxy.$startProgress(n,{location:cv.from(o),title:s,source:c,cancellable:a},e.isUnderDevelopment?void 0:e.identifier.value).catch(hw),this._withProgress(n,i,!!a)}_withProgress(e,t,i){let n;i&&(n=new Tt,this._mapHandleToCancellationSource.set(e,n));const s=a=>{this._proxy.$progressEnd(a),this._mapHandleToCancellationSource.delete(a),n==null||n.dispose()};let o;try{o=t(new G_(this._proxy,e),i&&n?n.token:bt.None)}catch(a){throw s(e),a}return o.then(a=>s(e),a=>s(e)),o}$acceptProgressCanceled(e){const t=this._mapHandleToCancellationSource.get(e);t&&(t.cancel(),this._mapHandleToCancellationSource.delete(e))}}function DT(r,e){return r.message=e.message,typeof e.increment=="number"&&(typeof r.increment=="number"?r.increment+=e.increment:r.increment=e.increment),r}class G_ extends tp{constructor(e,t){super(i=>this.throttledReport(i)),this._proxy=e,this._handle=t}throttledReport(e){this._proxy.$progressReport(this._handle,e)}}G_.__decorator=U([ET(100,(r,e)=>DT(r,e),()=>Object.create(null))],G_.prototype,"throttledReport",null);const Up=class Up{constructor(e,t){this.uriTransformer=t,this.providers=new Map,this.proxy=e.getProxy(J.MainThreadQuickDiff)}$provideOriginalResource(e,t,i){const n=x.revive(t),s=this.providers.get(e);return s?Bt(()=>s.provideOriginalResource(n,i)).then(o=>o||null):Promise.resolve(null)}registerQuickDiffProvider(e,t,i,n){const s=Up.handlePool++;return this.providers.set(s,t),this.proxy.$registerQuickDiffProvider(s,Ya.from(e,this.uriTransformer),i,n),{dispose:()=>{this.proxy.$unregisterQuickDiffProvider(s),this.providers.delete(s)}}}};Up.handlePool=0;let Q_=Up;function IT(r,e,t){const i=r.getProxy(J.MainThreadQuickOpen);class n{constructor(b,_){this._sessions=new Map,this._instances=0,this._workspace=b,this._commands=_}showQuickPick(b,_,v,k=bt.None){this._onDidSelectItem=void 0;const D=Promise.resolve(_),E=++this._instances,N=i.$show(E,{title:v==null?void 0:v.title,placeHolder:v==null?void 0:v.placeHolder,matchOnDescription:v==null?void 0:v.matchOnDescription,matchOnDetail:v==null?void 0:v.matchOnDetail,ignoreFocusLost:v==null?void 0:v.ignoreFocusOut,canPickMany:v==null?void 0:v.canPickMany},k),A={},j=N.then(()=>A);return Promise.race([j,D]).then(re=>{if(re===A)return;const te=Lt(b,"quickPickItemTooltip");return D.then(q=>{const We=[];for(let V=0;V<q.length;V++){const B=q[V];if(typeof B=="string")We.push({label:B,handle:V});else if(B.kind===ou.Separator)We.push({type:"separator",label:B.label});else{B.tooltip&&!te&&console.warn(`Extension '${b.identifier.value}' uses a tooltip which is proposed API that is only available when running out of dev or with the following command line switch: --enable-proposed-api ${b.identifier.value}`);const Q=B.iconPath?l(B.iconPath):void 0;We.push({label:B.label,iconPath:Q==null?void 0:Q.iconPath,iconClass:Q==null?void 0:Q.iconClass,description:B.description,detail:B.detail,picked:B.picked,alwaysShow:B.alwaysShow,tooltip:te?Le.fromStrict(B.tooltip):void 0,handle:V})}}return v&&typeof v.onDidSelectItem=="function"&&(this._onDidSelectItem=V=>{v.onDidSelectItem(q[V])}),i.$setItems(E,We),N.then(V=>{if(typeof V=="number")return q[V];if(Array.isArray(V))return V.map(B=>q[B])})})}).then(void 0,re=>{if(!ho(re))return i.$setError(E,re),Promise.reject(re)})}$onItemSelected(b){var _;(_=this._onDidSelectItem)==null||_.call(this,b)}showInput(b,_=bt.None){return this._validateInput=b==null?void 0:b.validateInput,i.$input(b,typeof this._validateInput=="function",_).then(void 0,v=>{if(!ho(v))return Promise.reject(v)})}async $validateInput(b){if(!this._validateInput)return;const _=await this._validateInput(b);if(!_||typeof _=="string")return _;let v;switch(_.severity){case fa.Info:v=vt.Info;break;case fa.Warning:v=vt.Warning;break;case fa.Error:v=vt.Error;break;default:v=_.message?vt.Error:vt.Ignore;break}return{content:_.message,severity:v}}async showWorkspaceFolderPick(b,_=bt.None){const v=await this._commands.executeCommand("_workbench.pickWorkspaceFolder",[b]);if(!v)return;const k=await this._workspace.getWorkspaceFolders2();if(k)return k.find(D=>D.uri.toString()===v.uri.toString())}createQuickPick(b){const _=new u(b,()=>this._sessions.delete(_._id));return this._sessions.set(_._id,_),_}createInputBox(b){const _=new d(b,()=>this._sessions.delete(_._id));return this._sessions.set(_._id,_),_}$onDidChangeValue(b,_){const v=this._sessions.get(b);v==null||v._fireDidChangeValue(_)}$onDidAccept(b){const _=this._sessions.get(b);_==null||_._fireDidAccept()}$onDidChangeActive(b,_){const v=this._sessions.get(b);v instanceof u&&v._fireDidChangeActive(_)}$onDidChangeSelection(b,_){const v=this._sessions.get(b);v instanceof u&&v._fireDidChangeSelection(_)}$onDidTriggerButton(b,_){const v=this._sessions.get(b);v==null||v._fireDidTriggerButton(_)}$onDidTriggerItemButton(b,_,v){const k=this._sessions.get(b);k instanceof u&&k._fireDidTriggerItemButton(_,v)}$onDidHide(b){const _=this._sessions.get(b);_==null||_._fireDidHide()}}const f=class f{constructor(b,_){this._extensionId=b,this._onDidDispose=_,this._id=u._nextId++,this._visible=!1,this._expectingHide=!1,this._enabled=!0,this._busy=!1,this._ignoreFocusOut=!0,this._value="",this._buttons=[],this._handlesToButtons=new Map,this._onDidAcceptEmitter=new R,this._onDidChangeValueEmitter=new R,this._onDidTriggerButtonEmitter=new R,this._onDidHideEmitter=new R,this._pendingUpdate={id:this._id},this._disposed=!1,this._disposables=[this._onDidTriggerButtonEmitter,this._onDidHideEmitter,this._onDidAcceptEmitter,this._onDidChangeValueEmitter],this.onDidChangeValue=this._onDidChangeValueEmitter.event,this.onDidAccept=this._onDidAcceptEmitter.event,this.onDidTriggerButton=this._onDidTriggerButtonEmitter.event,this.onDidHide=this._onDidHideEmitter.event}get title(){return this._title}set title(b){this._title=b,this.update({title:b})}get step(){return this._steps}set step(b){this._steps=b,this.update({step:b})}get totalSteps(){return this._totalSteps}set totalSteps(b){this._totalSteps=b,this.update({totalSteps:b})}get enabled(){return this._enabled}set enabled(b){this._enabled=b,this.update({enabled:b})}get busy(){return this._busy}set busy(b){this._busy=b,this.update({busy:b})}get ignoreFocusOut(){return this._ignoreFocusOut}set ignoreFocusOut(b){this._ignoreFocusOut=b,this.update({ignoreFocusOut:b})}get value(){return this._value}set value(b){this._value=b,this.update({value:b})}get placeholder(){return this._placeholder}set placeholder(b){this._placeholder=b,this.update({placeholder:b})}get buttons(){return this._buttons}set buttons(b){this._buttons=b.slice(),this._handlesToButtons.clear(),b.forEach((_,v)=>{const k=_===su.Back?-1:v;this._handlesToButtons.set(k,_)}),this.update({buttons:b.map((_,v)=>({...l(_.iconPath),tooltip:_.tooltip,handle:_===su.Back?-1:v}))})}show(){this._visible=!0,this._expectingHide=!0,this.update({visible:!0})}hide(){this._visible=!1,this.update({visible:!1})}_fireDidAccept(){this._onDidAcceptEmitter.fire()}_fireDidChangeValue(b){this._value=b,this._onDidChangeValueEmitter.fire(b)}_fireDidTriggerButton(b){const _=this._handlesToButtons.get(b);_&&this._onDidTriggerButtonEmitter.fire(_)}_fireDidHide(){this._expectingHide&&(this._expectingHide=this._visible,this._onDidHideEmitter.fire())}dispose(){this._disposed||(this._disposed=!0,this._fireDidHide(),this._disposables=Gr(this._disposables),this._updateTimeout&&(clearTimeout(this._updateTimeout),this._updateTimeout=void 0),this._onDidDispose(),i.$dispose(this._id))}update(b){if(!this._disposed){for(const _ of Object.keys(b)){const v=b[_];this._pendingUpdate[_]=v===void 0?null:v}"visible"in this._pendingUpdate?(this._updateTimeout&&(clearTimeout(this._updateTimeout),this._updateTimeout=void 0),this.dispatchUpdate()):this._visible&&!this._updateTimeout&&(this._updateTimeout=setTimeout(()=>{this._updateTimeout=void 0,this.dispatchUpdate()},0))}}dispatchUpdate(){i.$createOrUpdate(this._pendingUpdate),this._pendingUpdate={id:this._id}}};f._nextId=1;let s=f;function o(m){if(m instanceof Kt)return{id:m.id};const b=c(m),_=a(m);return{dark:typeof b=="string"?x.file(b):b,light:typeof _=="string"?x.file(_):_}}function a(m){return typeof m=="object"&&"light"in m?m.light:m}function c(m){return typeof m=="object"&&"dark"in m?m.dark:m}function l(m){const b=o(m);let _,v;return"id"in b?v=Jt.asClassName(b):_=b,{iconPath:_,iconClass:v}}class u extends s{constructor(b,_){super(b.identifier,_),this.extension=b,this._items=[],this._handlesToItems=new Map,this._itemsToHandles=new Map,this._canSelectMany=!1,this._matchOnDescription=!0,this._matchOnDetail=!0,this._sortByLabel=!0,this._keepScrollPosition=!1,this._activeItems=[],this._onDidChangeActiveEmitter=new R,this._selectedItems=[],this._onDidChangeSelectionEmitter=new R,this._onDidTriggerItemButtonEmitter=new R,this.onDidChangeActive=this._onDidChangeActiveEmitter.event,this.onDidChangeSelection=this._onDidChangeSelectionEmitter.event,this.onDidTriggerItemButton=this._onDidTriggerItemButtonEmitter.event,this._disposables.push(this._onDidChangeActiveEmitter,this._onDidChangeSelectionEmitter,this._onDidTriggerItemButtonEmitter),this.update({type:"quickPick"})}get items(){return this._items}set items(b){var k;this._items=b.slice(),this._handlesToItems.clear(),this._itemsToHandles.clear(),b.forEach((D,E)=>{this._handlesToItems.set(E,D),this._itemsToHandles.set(D,E)});const _=Lt(this.extension,"quickPickItemTooltip"),v=[];for(let D=0;D<b.length;D++){const E=b[D];if(E.kind===ou.Separator)v.push({type:"separator",label:E.label});else{E.tooltip&&!_&&console.warn(`Extension '${this.extension.identifier.value}' uses a tooltip which is proposed API that is only available when running out of dev or with the following command line switch: --enable-proposed-api ${this.extension.identifier.value}`);const N=E.iconPath?l(E.iconPath):void 0;v.push({handle:D,label:E.label,iconPath:N==null?void 0:N.iconPath,iconClass:N==null?void 0:N.iconClass,description:E.description,detail:E.detail,picked:E.picked,alwaysShow:E.alwaysShow,tooltip:_?Le.fromStrict(E.tooltip):void 0,buttons:(k=E.buttons)==null?void 0:k.map((A,j)=>({...l(A.iconPath),tooltip:A.tooltip,handle:j}))})}}this.update({items:v})}get canSelectMany(){return this._canSelectMany}set canSelectMany(b){this._canSelectMany=b,this.update({canSelectMany:b})}get matchOnDescription(){return this._matchOnDescription}set matchOnDescription(b){this._matchOnDescription=b,this.update({matchOnDescription:b})}get matchOnDetail(){return this._matchOnDetail}set matchOnDetail(b){this._matchOnDetail=b,this.update({matchOnDetail:b})}get sortByLabel(){return this._sortByLabel}set sortByLabel(b){this._sortByLabel=b,this.update({sortByLabel:b})}get keepScrollPosition(){return this._keepScrollPosition}set keepScrollPosition(b){this._keepScrollPosition=b,this.update({keepScrollPosition:b})}get activeItems(){return this._activeItems}set activeItems(b){this._activeItems=b.filter(_=>this._itemsToHandles.has(_)),this.update({activeItems:this._activeItems.map(_=>this._itemsToHandles.get(_))})}get selectedItems(){return this._selectedItems}set selectedItems(b){this._selectedItems=b.filter(_=>this._itemsToHandles.has(_)),this.update({selectedItems:this._selectedItems.map(_=>this._itemsToHandles.get(_))})}_fireDidChangeActive(b){const _=ci(b.map(v=>this._handlesToItems.get(v)));this._activeItems=_,this._onDidChangeActiveEmitter.fire(_)}_fireDidChangeSelection(b){const _=ci(b.map(v=>this._handlesToItems.get(v)));this._selectedItems=_,this._onDidChangeSelectionEmitter.fire(_)}_fireDidTriggerItemButton(b,_){const v=this._handlesToItems.get(b);if(!v||!v.buttons||!v.buttons.length)return;const k=v.buttons[_];k&&this._onDidTriggerItemButtonEmitter.fire({button:k,item:v})}}class d extends s{constructor(b,_){super(b.identifier,_),this._password=!1,this.update({type:"inputBox"})}get password(){return this._password}set password(b){this._password=b,this.update({password:b})}get prompt(){return this._prompt}set prompt(b){this._prompt=b,this.update({prompt:b})}get valueSelection(){return this._valueSelection}set valueSelection(b){this._valueSelection=b,this.update({valueSelection:b})}get validationMessage(){return this._validationMessage}set validationMessage(b){this._validationMessage=b,b?typeof b=="string"?this.update({validationMessage:b,severity:vt.Error}):this.update({validationMessage:b.message,severity:b.severity??vt.Error}):this.update({validationMessage:void 0,severity:vt.Ignore})}}return new n(e,t)}const B2=new Xn(()=>{const r=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"});return{collator:r,collatorIsNumeric:r.resolvedOptions().numeric}});function PT(r,e,t=!1){const i=r||"",n=e||"",s=B2.value.collator.compare(i,n);return B2.value.collatorIsNumeric&&s===0&&i!==n?i<n?-1:1:s}function TT(r,e,t=!1){return t||(r=r&&r.toLowerCase(),e=e&&e.toLowerCase()),r===e?0:r<e?-1:1}function ah(r,e,t=!1){const i=r.split(en),n=e.split(en),s=i.length-1,o=n.length-1;let a,c;for(let l=0;;l++){if(a=s===l,c=o===l,a&&c)return PT(i[l],n[l],t);if(a)return-1;if(c)return 1;const u=TT(i[l],n[l],t);if(u!==0)return u}}var J_;function V2(r){return r instanceof x}function AT(r,e){return r.scheme===ne.file&&e.scheme===ne.file&&Qr?r.toString()===e.toString():r.toString().toLowerCase()===e.toString().toLowerCase()}function vm(r){if(r)return typeof r.iconPath=="string"?x.file(r.iconPath):x.isUri(r.iconPath)||Jt.isThemeIcon(r.iconPath)?r.iconPath:void 0}function W2(r){if(r.icon){if(x.isUri(r.icon))return r.icon;if(Jt.isThemeIcon(r.icon))return r.icon;{const e=r.icon;return{light:e.light,dark:e.dark}}}else return}function _m(r,e){if(!r.iconPath&&!e.iconPath)return 0;if(r.iconPath){if(!e.iconPath)return 1}else return-1;const t=typeof r.iconPath=="string"?r.iconPath:x.isUri(r.iconPath)?r.iconPath.fsPath:r.iconPath.id,i=typeof e.iconPath=="string"?e.iconPath:x.isUri(e.iconPath)?e.iconPath.fsPath:e.iconPath.id;return ah(t,i)}function RT(r,e){let t=0;if(r.strikeThrough!==e.strikeThrough)return r.strikeThrough?1:-1;if(r.faded!==e.faded)return r.faded?1:-1;if(r.tooltip!==e.tooltip)return(r.tooltip||"").localeCompare(e.tooltip||"");if(t=_m(r,e),t!==0)return t;if(r.light&&e.light)t=_m(r.light,e.light);else{if(r.light)return 1;if(e.light)return-1}if(t!==0)return t;if(r.dark&&e.dark)t=_m(r.dark,e.dark);else{if(r.dark)return 1;if(e.dark)return-1}return t}function LT(r,e){if(r.command!==e.command)return r.command<e.command?-1:1;if(r.title!==e.title)return r.title<e.title?-1:1;if(r.tooltip!==e.tooltip){if(r.tooltip!==void 0&&e.tooltip!==void 0)return r.tooltip<e.tooltip?-1:1;if(r.tooltip!==void 0)return 1;if(e.tooltip!==void 0)return-1}if(r.arguments===e.arguments)return 0;if(r.arguments)if(e.arguments){if(r.arguments.length!==e.arguments.length)return r.arguments.length-e.arguments.length}else return 1;else return-1;for(let t=0;t<r.arguments.length;t++){const i=r.arguments[t],n=e.arguments[t];if(i!==n&&!(V2(i)&&V2(n)&&AT(i,n)))return i<n?-1:1}return 0}function z2(r,e){let t=ah(r.resourceUri.fsPath,e.resourceUri.fsPath,!0);if(t!==0)return t;if(r.command&&e.command)t=LT(r.command,e.command);else{if(r.command)return 1;if(e.command)return-1}if(t!==0)return t;if(r.decorations&&e.decorations)t=RT(r.decorations,e.decorations);else{if(r.decorations)return 1;if(e.decorations)return-1}if(r.multiFileDiffEditorModifiedUri&&e.multiFileDiffEditorModifiedUri)t=ah(r.multiFileDiffEditorModifiedUri.fsPath,e.multiFileDiffEditorModifiedUri.fsPath,!0);else{if(r.multiFileDiffEditorModifiedUri)return 1;if(e.multiFileDiffEditorModifiedUri)return-1}if(r.multiDiffEditorOriginalUri&&e.multiDiffEditorOriginalUri)t=ah(r.multiDiffEditorOriginalUri.fsPath,e.multiDiffEditorOriginalUri.fsPath,!0);else{if(r.multiDiffEditorOriginalUri)return 1;if(e.multiDiffEditorOriginalUri)return-1}return t}function $T(r,e){for(let t=0;t<r.length;t++)if(r[t]!==e[t])return!1;return!0}function NT(r,e){return r.command===e.command&&r.title===e.title&&r.tooltip===e.tooltip&&(r.arguments&&e.arguments?$T(r.arguments,e.arguments):r.arguments===e.arguments)}function MT(r,e){return qr(r,e,NT)}var fn,Gu;class FT{constructor(e,t,i,n,s){ue(this,fn,void 0);ue(this,Gu,void 0);this._extension=e,this._sourceControlHandle=n,this._documentUri=s,this._value="",this._onDidChange=new R,this._placeholder="",this._enabled=!0,this._visible=!0,K(this,Gu,t),K(this,fn,i)}get value(){return this._value}set value(e){e=e??"",P(this,fn).$setInputBoxValue(this._sourceControlHandle,e),this.updateValue(e)}get onDidChange(){return this._onDidChange.event}get placeholder(){return this._placeholder}set placeholder(e){P(this,fn).$setInputBoxPlaceholder(this._sourceControlHandle,e),this._placeholder=e}get validateInput(){return O(this._extension,"scmValidation"),this._validateInput}set validateInput(e){if(O(this._extension,"scmValidation"),e&&typeof e!="function")throw new Error(`[${this._extension.identifier.value}]: Invalid SCM input box validation function`);this._validateInput=e,P(this,fn).$setValidationProviderIsEnabled(this._sourceControlHandle,!!e)}get enabled(){return this._enabled}set enabled(e){e=!!e,this._enabled!==e&&(this._enabled=e,P(this,fn).$setInputBoxEnablement(this._sourceControlHandle,e))}get visible(){return this._visible}set visible(e){e=!!e,this._visible!==e&&(this._visible=e,P(this,fn).$setInputBoxVisibility(this._sourceControlHandle,e))}get document(){return O(this._extension,"scmTextDocument"),P(this,Gu).getDocument(this._documentUri)}showValidationMessage(e,t){O(this._extension,"scmValidation"),P(this,fn).$showValidationMessage(this._sourceControlHandle,e,t)}$onInputBoxValueChange(e){this.updateValue(e)}updateValue(e){this._value=e,this._onDidChange.fire(e)}}fn=new WeakMap,Gu=new WeakMap;const Bp=class Bp{get disposed(){return this._disposed}get id(){return this._id}get label(){return this._label}set label(e){this._label=e,this._proxy.$updateGroupLabel(this._sourceControlHandle,this.handle,e)}get hideWhenEmpty(){return this._hideWhenEmpty}set hideWhenEmpty(e){this._hideWhenEmpty=e,this._proxy.$updateGroup(this._sourceControlHandle,this.handle,this.features)}get features(){return{hideWhenEmpty:this.hideWhenEmpty}}get resourceStates(){return[...this._resourceStates]}set resourceStates(e){this._resourceStates=[...e],this._onDidUpdateResourceStates.fire()}constructor(e,t,i,n,s,o,a){this._proxy=e,this._commands=t,this._sourceControlHandle=i,this._id=n,this._label=s,this.multiDiffEditorEnableViewChanges=o,this._extension=a,this._resourceHandlePool=0,this._resourceStates=[],this._resourceStatesMap=new Map,this._resourceStatesCommandsMap=new Map,this._resourceStatesDisposablesMap=new Map,this._onDidUpdateResourceStates=new R,this.onDidUpdateResourceStates=this._onDidUpdateResourceStates.event,this._disposed=!1,this._onDidDispose=new R,this.onDidDispose=this._onDidDispose.event,this._handlesSnapshot=[],this._resourceSnapshot=[],this._hideWhenEmpty=void 0,this.handle=Bp._handlePool++}getResourceState(e){return this._resourceStatesMap.get(e)}$executeResourceCommand(e,t){const i=this._resourceStatesCommandsMap.get(e);return i?Bt(()=>this._commands.executeCommand(i.command,...i.arguments||[],t)):Promise.resolve(void 0)}_takeResourceStateSnapshot(){var o;const e=[...this._resourceStates].sort(z2),i=cx(this._resourceSnapshot,e,z2).map(a=>{const c=a.toInsert.map(l=>{const u=this._resourceHandlePool++;this._resourceStatesMap.set(u,l);const d=l.resourceUri;let f;if(l.command)if(l.command.command==="vscode.open"||l.command.command==="vscode.diff"||l.command.command==="vscode.changes"){const q=new Te;f=this._commands.converter.toInternal(l.command,q),this._resourceStatesDisposablesMap.set(u,q)}else this._resourceStatesCommandsMap.set(u,l.command);const m=Lt(this._extension,"scmMultiDiffEditor"),b=m?l.multiDiffEditorOriginalUri:void 0,_=m?l.multiFileDiffEditorModifiedUri:void 0,v=vm(l.decorations),k=l.decorations&&vm(l.decorations.light)||v,D=l.decorations&&vm(l.decorations.dark)||v,E=[k,D],N=l.decorations&&l.decorations.tooltip||"",A=l.decorations&&!!l.decorations.strikeThrough,j=l.decorations&&!!l.decorations.faded,re=l.contextValue||"";return{rawResource:[u,d,E,N,A,j,re,f,b,_],handle:u}});return{start:a.start,deleteCount:a.deleteCount,toInsert:c}}),n=i.map(({start:a,deleteCount:c,toInsert:l})=>[a,c,l.map(u=>u.rawResource)]),s=i.reverse();for(const{start:a,deleteCount:c,toInsert:l}of s){const u=l.map(f=>f.handle),d=this._handlesSnapshot.splice(a,c,...u);for(const f of d)this._resourceStatesMap.delete(f),this._resourceStatesCommandsMap.delete(f),(o=this._resourceStatesDisposablesMap.get(f))==null||o.dispose(),this._resourceStatesDisposablesMap.delete(f)}return this._resourceSnapshot=e,n}dispose(){this._disposed=!0,this._onDidDispose.fire()}};Bp._handlePool=0;let K_=Bp;var Rt;const Vp=class Vp{constructor(e,t,i,n,s,o,a){ue(this,Rt,void 0);this._extension=e,this._commands=n,this._id=s,this._label=o,this._rootUri=a,this._groups=new Map,this._count=void 0,this._quickDiffProvider=void 0,this._historyProviderDisposable=new zo,this._commitTemplate=void 0,this._acceptInputDisposables=new zo,this._acceptInputCommand=void 0,this._actionButtonDisposables=new zo,this._statusBarDisposables=new zo,this._statusBarCommands=void 0,this._selected=!1,this._onDidChangeSelection=new R,this.onDidChangeSelection=this._onDidChangeSelection.event,this.handle=Vp._handlePool++,this.createdResourceGroups=new Map,this.updatedResourceGroups=new Set,K(this,Rt,i);const c=x.from({scheme:ne.vscodeSourceControl,path:`${s}/scm${this.handle}/input`,query:a?`rootUri=${encodeURIComponent(a.toString())}`:void 0});this._inputBox=new FT(e,t,P(this,Rt),this.handle,c),P(this,Rt).$registerSourceControl(this.handle,s,o,a,c)}get id(){return this._id}get label(){return this._label}get rootUri(){return this._rootUri}get inputBox(){return this._inputBox}get count(){return this._count}set count(e){this._count!==e&&(this._count=e,P(this,Rt).$updateSourceControl(this.handle,{count:e}))}get quickDiffProvider(){return this._quickDiffProvider}set quickDiffProvider(e){this._quickDiffProvider=e;let t;Lt(this._extension,"quickDiffProvider")&&(t=e==null?void 0:e.label),P(this,Rt).$updateSourceControl(this.handle,{hasQuickDiffProvider:!!e,quickDiffLabel:t})}get historyProvider(){return O(this._extension,"scmHistoryProvider"),this._historyProvider}set historyProvider(e){O(this._extension,"scmHistoryProvider"),this._historyProvider=e,this._historyProviderDisposable.value=new Te,P(this,Rt).$updateSourceControl(this.handle,{hasHistoryProvider:!!e}),e&&this._historyProviderDisposable.value.add(e.onDidChangeCurrentHistoryItemGroup(()=>{this._historyProviderCurrentHistoryItemGroup=e==null?void 0:e.currentHistoryItemGroup,P(this,Rt).$onDidChangeHistoryProviderCurrentHistoryItemGroup(this.handle,this._historyProviderCurrentHistoryItemGroup)}))}get commitTemplate(){return this._commitTemplate}set commitTemplate(e){e!==this._commitTemplate&&(this._commitTemplate=e,P(this,Rt).$updateSourceControl(this.handle,{commitTemplate:e}))}get acceptInputCommand(){return this._acceptInputCommand}set acceptInputCommand(e){this._acceptInputDisposables.value=new Te,this._acceptInputCommand=e;const t=this._commands.converter.toInternal(e,this._acceptInputDisposables.value);P(this,Rt).$updateSourceControl(this.handle,{acceptInputCommand:t})}get actionButton(){return O(this._extension,"scmActionButton"),this._actionButton}set actionButton(e){var i;O(this._extension,"scmActionButton"),this._actionButtonDisposables.value=new Te,this._actionButton=e;const t=e!==void 0?{command:this._commands.converter.toInternal(e.command,this._actionButtonDisposables.value),secondaryCommands:(i=e.secondaryCommands)==null?void 0:i.map(n=>n.map(s=>this._commands.converter.toInternal(s,this._actionButtonDisposables.value))),description:e.description,enabled:e.enabled}:void 0;P(this,Rt).$updateSourceControl(this.handle,{actionButton:t??null})}get statusBarCommands(){return this._statusBarCommands}set statusBarCommands(e){if(this._statusBarCommands&&e&&MT(this._statusBarCommands,e))return;this._statusBarDisposables.value=new Te,this._statusBarCommands=e;const t=(e||[]).map(i=>this._commands.converter.toInternal(i,this._statusBarDisposables.value));P(this,Rt).$updateSourceControl(this.handle,{statusBarCommands:t})}get selected(){return this._selected}createResourceGroup(e,t,i){const n=Lt(this._extension,"scmMultiDiffEditor")&&(i==null?void 0:i.multiDiffEditorEnableViewChanges)===!0,s=new K_(P(this,Rt),this._commands,this.handle,e,t,n,this._extension),o=It.once(s.onDidDispose)(()=>this.createdResourceGroups.delete(s));return this.createdResourceGroups.set(s,o),this.eventuallyAddResourceGroups(),s}eventuallyAddResourceGroups(){const e=[],t=[];for(const[i,n]of this.createdResourceGroups){n.dispose();const s=i.onDidUpdateResourceStates(()=>{this.updatedResourceGroups.add(i),this.eventuallyUpdateResourceStates()});It.once(i.onDidDispose)(()=>{this.updatedResourceGroups.delete(i),s.dispose(),this._groups.delete(i.handle),P(this,Rt).$unregisterGroup(this.handle,i.handle)}),e.push([i.handle,i.id,i.label,i.features,i.multiDiffEditorEnableViewChanges]);const o=i._takeResourceStateSnapshot();o.length>0&&t.push([i.handle,o]),this._groups.set(i.handle,i)}P(this,Rt).$registerGroups(this.handle,e,t),this.createdResourceGroups.clear()}eventuallyUpdateResourceStates(){const e=[];this.updatedResourceGroups.forEach(t=>{const i=t._takeResourceStateSnapshot();i.length!==0&&e.push([t.handle,i])}),e.length>0&&P(this,Rt).$spliceResourceStates(this.handle,e),this.updatedResourceGroups.clear()}getResourceGroup(e){return this._groups.get(e)}setSelectionState(e){this._selected=e,this._onDidChangeSelection.fire(e)}dispose(){this._acceptInputDisposables.dispose(),this._actionButtonDisposables.dispose(),this._statusBarDisposables.dispose(),this._groups.forEach(e=>e.dispose()),P(this,Rt).$unregisterSourceControl(this.handle)}};Rt=new WeakMap,Vp._handlePool=0;let wo=Vp;wo.__decorator=U([OS(100)],wo.prototype,"eventuallyAddResourceGroups",null);wo.__decorator=U([OS(100)],wo.prototype,"eventuallyUpdateResourceStates",null);var mc;let X_=(mc=class{get onDidChangeActiveProvider(){return this._onDidChangeActiveProvider.event}constructor(e,t,i,n){this._commands=t,this._extHostDocuments=i,this.logService=n,this._sourceControls=new Map,this._sourceControlsByExtension=new Kr,this._onDidChangeActiveProvider=new R,this._proxy=e.getProxy(J.MainThreadSCM),this._telemetry=e.getProxy(J.MainThreadTelemetry),t.registerArgumentProcessor({processArgument:s=>{if(s&&s.$mid===3){const o=this._sourceControls.get(s.sourceControlHandle);if(!o)return s;const a=o.getResourceGroup(s.groupHandle);return a?a.getResourceState(s.handle):s}else if(s&&s.$mid===4){const o=this._sourceControls.get(s.sourceControlHandle);return o?o.getResourceGroup(s.groupHandle):s}else if(s&&s.$mid===5){const o=this._sourceControls.get(s.handle);return o||s}return s}})}createSourceControl(e,t,i,n){this.logService.trace("ExtHostSCM#createSourceControl",e.identifier.value,t,i,n),this._telemetry.$publicLog2("api/scm/createSourceControl",{extensionId:e.identifier.value});const s=J_._handlePool++,o=new wo(e,this._extHostDocuments,this._proxy,this._commands,t,i,n);this._sourceControls.set(s,o);const a=this._sourceControlsByExtension.get(e.identifier)||[];return a.push(o),this._sourceControlsByExtension.set(e.identifier,a),o}getLastInputBox(e){this.logService.trace("ExtHostSCM#getLastInputBox",e.identifier.value);const t=this._sourceControlsByExtension.get(e.identifier),i=t&&t[t.length-1];return i&&i.inputBox}$provideOriginalResource(e,t,i){const n=x.revive(t);this.logService.trace("ExtHostSCM#$provideOriginalResource",e,n.toString());const s=this._sourceControls.get(e);return!s||!s.quickDiffProvider||!s.quickDiffProvider.provideOriginalResource?Promise.resolve(null):Bt(()=>s.quickDiffProvider.provideOriginalResource(n,i)).then(o=>o||null)}$onInputBoxValueChange(e,t){this.logService.trace("ExtHostSCM#$onInputBoxValueChange",e);const i=this._sourceControls.get(e);return i&&i.inputBox.$onInputBoxValueChange(t),Promise.resolve(void 0)}$executeResourceCommand(e,t,i,n){this.logService.trace("ExtHostSCM#$executeResourceCommand",e,t,i);const s=this._sourceControls.get(e);if(!s)return Promise.resolve(void 0);const o=s.getResourceGroup(t);return o?o.$executeResourceCommand(i,n):Promise.resolve(void 0)}$validateInput(e,t,i){this.logService.trace("ExtHostSCM#$validateInput",e);const n=this._sourceControls.get(e);return!n||!n.inputBox.validateInput?Promise.resolve(void 0):Bt(()=>n.inputBox.validateInput(t,i)).then(s=>{if(!s)return Promise.resolve(void 0);const o=Le.fromStrict(s.message);return o?Promise.resolve([o,s.type]):Promise.resolve(void 0)})}$setSelectedSourceControl(e){var t,i;return this.logService.trace("ExtHostSCM#$setSelectedSourceControl",e),e!==void 0&&((t=this._sourceControls.get(e))==null||t.setSelectionState(!0)),this._selectedSourceControlHandle!==void 0&&((i=this._sourceControls.get(this._selectedSourceControlHandle))==null||i.setSelectionState(!1)),this._selectedSourceControlHandle=e,Promise.resolve(void 0)}async $resolveHistoryItemGroupCommonAncestor(e,t,i,n){var o;const s=(o=this._sourceControls.get(e))==null?void 0:o.historyProvider;return await(s==null?void 0:s.resolveHistoryItemGroupCommonAncestor(t,i,n))??void 0}async $provideHistoryItems(e,t,i,n){var a;const s=(a=this._sourceControls.get(e))==null?void 0:a.historyProvider,o=await(s==null?void 0:s.provideHistoryItems(t,i,n));return(o==null?void 0:o.map(c=>({...c,icon:W2(c)})))??void 0}async $provideHistoryItemSummary(e,t,i,n){var a;const s=(a=this._sourceControls.get(e))==null?void 0:a.historyProvider;if(typeof(s==null?void 0:s.provideHistoryItemSummary)!="function")return;const o=await s.provideHistoryItemSummary(t,i,n);return o?{...o,icon:W2(o)}:void 0}async $provideHistoryItemChanges(e,t,i,n){var o;const s=(o=this._sourceControls.get(e))==null?void 0:o.historyProvider;return await(s==null?void 0:s.provideHistoryItemChanges(t,i,n))??void 0}},J_=mc,mc._handlePool=0,mc);X_=J_=U([M(3,Je)],X_);const Wp=class Wp{constructor(e,t){this.uriTransformer=t,this.providers=new Map,this.proxy=e.getProxy(J.MainThreadShare)}async $provideShare(e,t,i){const n=this.providers.get(e);return await(n==null?void 0:n.provideShare({selection:H.to(t.selection),resourceUri:x.revive(t.resourceUri)},i))??void 0}registerShareProvider(e,t){const i=Wp.handlePool++;return this.providers.set(i,t),this.proxy.$registerShareProvider(i,Ya.from(e,this.uriTransformer),t.id,t.label,t.priority),{dispose:()=>{this.proxy.$unregisterShareProvider(i),this.providers.delete(i)}}}};Wp.handlePool=0;let Z_=Wp;const zp=class zp{constructor(e){this.providers=new Map,this.sessions=new Map,this.proxy=e.getProxy(J.MainThreadSpeech)}async $createSpeechToTextSession(e,t,i){const n=this.providers.get(e);if(!n)return;const s=new Te,o=new Tt;this.sessions.set(t,o);const a=s.add(n.provideSpeechToTextSession(o.token,i?{language:i}:void 0));s.add(a.onDidChange(c=>{o.token.isCancellationRequested||this.proxy.$emitSpeechToTextEvent(t,c)})),s.add(o.token.onCancellationRequested(()=>s.dispose()))}async $cancelSpeechToTextSession(e){var t;(t=this.sessions.get(e))==null||t.dispose(!0),this.sessions.delete(e)}async $createKeywordRecognitionSession(e,t){const i=this.providers.get(e);if(!i)return;const n=new Te,s=new Tt;this.sessions.set(t,s);const o=n.add(i.provideKeywordRecognitionSession(s.token));n.add(o.onDidChange(a=>{s.token.isCancellationRequested||this.proxy.$emitKeywordRecognitionEvent(t,a)})),n.add(s.token.onCancellationRequested(()=>n.dispose()))}async $cancelKeywordRecognitionSession(e){var t;(t=this.sessions.get(e))==null||t.dispose(!0),this.sessions.delete(e)}registerProvider(e,t,i){const n=zp.ID_POOL++;return this.providers.set(n,i),this.proxy.$registerProvider(n,t,{extension:e,displayName:e.value}),De(()=>{this.proxy.$unregisterProvider(n),this.providers.delete(n)})}};zp.ID_POOL=1;let Y_=zp;const HS="vs/workbench/api/common/extHostStatusBar";var ya,xa;const Cs=class Cs{constructor(e,t,i,n,s,o=$r.Left,a){ue(this,ya,void 0);ue(this,xa,void 0);if(this._disposed=!1,this._text="",this._staleCommandRegistrations=new Te,K(this,ya,e),K(this,xa,t),s&&n){this._entryId=bI(n.identifier,s);const c=i.get(this._entryId);c&&(o=c.alignLeft?$r.Left:$r.Right,a=c.priority,this._visible=!0,this.name=c.name,this.text=c.text,this.tooltip=c.tooltip,this.command=c.command,this.accessibilityInformation=c.accessibilityInformation)}else this._entryId=String(Cs.ID_GEN++);this._extension=n,this._id=s,this._alignment=o,this._priority=this.validatePriority(a)}validatePriority(e){if(Br(e))return e===Number.POSITIVE_INFINITY?Number.MAX_VALUE:e===Number.NEGATIVE_INFINITY?-Number.MAX_VALUE:e}get id(){return this._id??this._extension.identifier.value}get alignment(){return this._alignment}get priority(){return this._priority}get text(){return this._text}get name(){return this._name}get tooltip(){return this._tooltip}get color(){return this._color}get backgroundColor(){return this._backgroundColor}get command(){var e;return(e=this._command)==null?void 0:e.fromApi}get accessibilityInformation(){return this._accessibilityInformation}set text(e){this._text=e,this.update()}set name(e){this._name=e,this.update()}set tooltip(e){this._tooltip=e,this.update()}set color(e){this._color=e,this.update()}set backgroundColor(e){e&&!Cs.ALLOWED_BACKGROUND_COLORS.has(e.id)&&(e=void 0),this._backgroundColor=e,this.update()}set command(e){var t;((t=this._command)==null?void 0:t.fromApi)!==e&&(this._latestCommandRegistration&&this._staleCommandRegistrations.add(this._latestCommandRegistration),this._latestCommandRegistration=new Te,typeof e=="string"?this._command={fromApi:e,internal:P(this,xa).toInternal({title:"",command:e},this._latestCommandRegistration)}:e?this._command={fromApi:e,internal:P(this,xa).toInternal(e,this._latestCommandRegistration)}:this._command=void 0,this.update())}set accessibilityInformation(e){this._accessibilityInformation=e,this.update()}show(){this._visible=!0,this.update()}hide(){clearTimeout(this._timeoutHandle),this._visible=!1,P(this,ya).$disposeEntry(this._entryId)}update(){this._disposed||!this._visible||(clearTimeout(this._timeoutHandle),this._timeoutHandle=setTimeout(()=>{var s,o;this._timeoutHandle=void 0;let e;this._extension?this._id?e=`${this._extension.identifier.value}.${this._id}`:e=this._extension.identifier.value:e=this._id;let t;this._name?t=this._name:t=h(HS,0,"{0} (Extension)",this._extension.displayName||this._extension.name);let i=this._color;this._backgroundColor&&(i=Cs.ALLOWED_BACKGROUND_COLORS.get(this._backgroundColor.id));const n=Le.fromStrict(this._tooltip);P(this,ya).$setEntry(this._entryId,e,(s=this._extension)==null?void 0:s.identifier.value,t,this._text,n,(o=this._command)==null?void 0:o.internal,i,this._backgroundColor,this._alignment===$r.Left,this._priority,this._accessibilityInformation),this._staleCommandRegistrations.clear()},0))}dispose(){this.hide(),this._disposed=!0}};ya=new WeakMap,xa=new WeakMap,Cs.ID_GEN=0,Cs.ALLOWED_BACKGROUND_COLORS=new Map([["statusBarItem.errorBackground",new Zl("statusBarItem.errorForeground")],["statusBarItem.warningBackground",new Zl("statusBarItem.warningForeground")]]);let ew=Cs;class OT{constructor(e){this._messages=[],this._item=e.createStatusBarEntry(void 0,"status.extensionMessage",$r.Left,Number.MIN_VALUE),this._item.name=h(HS,1,"Extension Status")}dispose(){this._messages.length=0,this._item.dispose()}setMessage(e){const t={message:e};return this._messages.unshift(t),this._update(),new Ne(()=>{const i=this._messages.indexOf(t);i>=0&&(this._messages.splice(i,1),this._update())})}_update(){this._messages.length>0?(this._item.text=this._messages[0].message,this._item.show()):this._item.hide()}}class HT{constructor(e,t){this._existingItems=new Map,this._proxy=e.getProxy(J.MainThreadStatusBar),this._commands=t,this._statusMessage=new OT(this)}$acceptStaticEntries(e){for(const t of e)this._existingItems.set(t.entryId,t)}createStatusBarEntry(e,t,i,n){return new ew(this._proxy,this._commands,this._existingItems,e,t,i,n)}setStatusBarMessage(e,t){const i=this._statusMessage.setMessage(e);let n;return typeof t=="number"?n=setTimeout(()=>i.dispose(),t):typeof t<"u"&&t.then(()=>i.dispose(),()=>i.dispose()),new Ne(()=>{i.dispose(),clearTimeout(n)})}}let tw=class extends Fe{constructor(e,t,i,n){super(),this.editors=n,this.resultsChangedEmitter=this._register(new R),this.controllers=new Map,this.defaultProfilesChangedEmitter=this._register(new R),this.onResultsChanged=this.resultsChangedEmitter.event,this.results=[],this.proxy=e.getProxy(J.MainThreadTesting),this.observer=new jT(this.proxy),this.runTracker=new VT(this.proxy,t),i.registerArgumentProcessor({processArgument:s=>{var o,a,c;switch(s==null?void 0:s.$mid){case 16:{const l=s,u=l.tests[l.tests.length-1].item.extId,d=this.controllers.get(ye.root(u));return((o=d==null?void 0:d.collection.tree.get(u))==null?void 0:o.actual)??My(s)}case 18:{const{test:l,message:u}=s,d=l.item.extId;return{test:((c=(a=this.controllers.get(ye.root(d)))==null?void 0:a.collection.tree.get(d))==null?void 0:c.actual)??My({$mid:16,tests:[l]}),message:ac.to(u)}}default:return s}}}),i.registerCommand(!1,"testing.getExplorerSelection",async()=>{const s=await i.executeCommand("_testing.getExplorerSelection"),o=a=>{var l;const c=this.controllers.get(ye.root(a));if(c)return ye.isRoot(a)?c.controller:(l=c.collection.tree.get(a))==null?void 0:l.actual};return{include:(s==null?void 0:s.include.map(o).filter(ks))||[],exclude:(s==null?void 0:s.exclude.map(o).filter(ks))||[]}})}createTestController(e,t,i,n){if(this.controllers.has(t))throw new Error(`Attempt to insert a duplicate controller with ID "${t}"`);const s=new Te,o=s.add(new L7(t,i,this.editors));o.root.label=i;const a=new Map,c=new Set,l=this.proxy,u={items:o.root.children,get label(){return i},set label(f){i=f,o.root.label=f,l.$updateController(t,{label:i})},get refreshHandler(){return n},set refreshHandler(f){n=f,l.$updateController(t,{canRefresh:!!f})},get id(){return t},createRunProfile:(f,m,b,_,v,k)=>{let D=Rw(f);for(;a.has(D);)D++;return new BS(this.proxy,a,c,this.defaultProfilesChangedEmitter.event,t,D,f,m,b,_,v,k)},createTestItem(f,m,b){return new Do(t,f,m,b)},createTestRun:(f,m,b=!0)=>this.runTracker.createTestRun(t,o,f,m,b),invalidateTestResults:f=>{if(f===void 0)this.proxy.$markTestRetired(void 0);else{const m=f instanceof Array?f:[f];this.proxy.$markTestRetired(m.map(b=>ye.fromExtHostTestItem(b,t).toString()))}},set resolveHandler(f){o.resolveHandler=f},get resolveHandler(){return o.resolveHandler},dispose:()=>{s.dispose()}};l.$registerTestController(t,i,!!n),s.add(De(()=>l.$unregisterTestController(t)));const d={controller:u,collection:o,profiles:a,extension:e,activeProfiles:c};return this.controllers.set(t,d),s.add(De(()=>this.controllers.delete(t))),s.add(o.onDidGenerateDiff(f=>l.$publishDiff(t,f.map(Rh.serialize)))),u}createTestObserver(){return this.observer.checkout()}async runTests(e,t=bt.None){var s,o;const i=US(e);if(!i)throw new Error("The request passed to `vscode.test.runTests` must include a profile");const n=this.controllers.get(i.controllerId);if(!n)throw new Error("Controller not found");await this.proxy.$runTests({preserveFocus:e.preserveFocus??!0,targets:[{testIds:((s=e.include)==null?void 0:s.map(a=>ye.fromExtHostTestItem(a,n.collection.root.id).toString()))??[n.collection.root.id],profileGroup:d0[i.kind],profileId:i.profileId,controllerId:i.controllerId}],exclude:(o=e.exclude)==null?void 0:o.map(a=>a.id)},t)}$syncTests(){for(const{collection:e}of this.controllers.values())e.flushDiff();return Promise.resolve()}async $getCoverageDetails(e,t){const i=await this.runTracker.getCoverageDetails(e,t);return i==null?void 0:i.map(Wf.fromDetails)}async $disposeRun(e){this.runTracker.disposeTestRun(e)}$configureRunProfile(e,t){var i,n,s;(s=(n=(i=this.controllers.get(e))==null?void 0:i.profiles.get(t))==null?void 0:n.configureHandler)==null||s.call(n)}$setDefaultRunProfiles(e){const t=new Map;for(const[i,n]of Object.entries(e)){const s=this.controllers.get(i);if(!s)continue;const o=new Map,a=n.filter(l=>!s.activeProfiles.has(l)),c=[...s.activeProfiles].filter(l=>!n.includes(l));for(const l of a)o.set(l,!0),s.activeProfiles.add(l);for(const l of c)o.set(l,!1),s.activeProfiles.delete(l);o.size&&t.set(i,o)}this.defaultProfilesChangedEmitter.fire(t)}async $refreshTests(e,t){var i,n,s;await((s=(i=this.controllers.get(e))==null?void 0:(n=i.controller).refreshHandler)==null?void 0:s.call(n,t))}$publishTestResults(e){this.results=Object.freeze(e.map(pv.to).concat(this.results).sort((t,i)=>i.completedAt-t.completedAt).slice(0,32)),this.resultsChangedEmitter.fire()}async $expandTest(e,t){var n;const i=(n=this.controllers.get(ye.fromString(e).controllerId))==null?void 0:n.collection;i&&(await i.expand(e,t<0?1/0:t),i.flushDiff())}$acceptDiff(e){this.observer.applyDiff(e.map(t=>Rh.deserialize({asCanonicalUri:i=>i},t)))}async $runControllerTests(e,t){return Promise.all(e.map(i=>this.runControllerTestRequest(i,!1,t)))}async $startContinuousRun(e,t){const i=new Tt(t),n=await Promise.all(e.map(s=>this.runControllerTestRequest(s,!0,i.token)));return!t.isCancellationRequested&&!n.some(s=>s.error)&&await new Promise(s=>t.onCancellationRequested(s)),i.dispose(!0),n}async runControllerTestRequest(e,t,i){const n=this.controllers.get(e.controllerId);if(!n)return{};const{collection:s,profiles:o}=n,a=o.get(e.profileId);if(!a)return{};const c=e.testIds.map(f=>s.tree.get(f)).filter(ks),l=e.excludeExtIds.map(f=>n.collection.tree.get(f)).filter(ks).filter(f=>c.some(m=>m.fullId.compare(f.fullId)===2));if(!c.length)return{};const u=new cu(c.some(f=>f.actual instanceof Xw)?void 0:c.map(f=>f.actual),l.map(f=>f.actual),a,t),d=S5(e)&&this.runTracker.prepareForMainThreadTestRun(u,Au.fromInternal(e,n.collection),a,i);try{return await a.runHandler(u,i),{}}catch(f){return{error:String(f)}}finally{d&&d.hasRunningTasks&&!i.isCancellationRequested&&await It.toPromise(d.onEnd)}}$cancelExtensionTestRun(e){e===void 0?this.runTracker.cancelAllRuns():this.runTracker.cancelRunById(e)}};tw=U([M(0,Ve),M(1,Je)],tw);const UT=1e4;class BT extends Fe{get hasRunningTasks(){return this.running>0}get id(){return this.dto.id}constructor(e,t,i,n,s){super(),this.dto=e,this.proxy=t,this.logService=i,this.profile=n,this.state=0,this.running=0,this.tasks=new Map,this.sharedTestIds=new Set,this.endEmitter=this._register(new R),this.publishedCoverage=new Map,this.onEnd=this.endEmitter.event,this.cts=this._register(new Tt(s));const o=this._register(new id(()=>this.forciblyEndTasks(),UT));this._register(this.cts.token.onCancellationRequested(()=>o.schedule()));const a=new R;this.onDidDispose=a.event,this._register(De(()=>{a.fire(),a.dispose()}))}cancel(){this.state===0?(this.cts.cancel(),this.state=1):this.state===1&&this.forciblyEndTasks()}getCoverageDetails(e,t){var a,c;const[,i,n]=ye.fromString(e).path,s=this.publishedCoverage.get(n);if(!s)return[];const o=this.tasks.get(i);if(!o)throw new Error("unreachable: run task was not found");return((c=(a=this.profile)==null?void 0:a.loadDetailedCoverage)==null?void 0:c.call(a,o.run,s,t))??[]}createRun(e){const t=this.dto.id,i=this.dto.controllerId,n=ar(),s=l=>(u,...d)=>{if(a){this.logService.warn(`Setting the state of test "${u.id}" is a no-op after the run ends.`);return}this.dto.isIncluded(u)&&(this.ensureTestIsKnown(u),l(u,...d))},o=(l,u)=>{const d=u instanceof Array?u.map(ac.from):[ac.from(u)];if(l.uri&&l.range){const f={range:H.from(l.range),uri:l.uri};for(const m of d)m.location=m.location||f}this.proxy.$appendTestMessagesInRun(t,n,ye.fromExtHostTestItem(l,i).toString(),d)};let a=!1;const c={isPersisted:this.dto.isPersisted,token:this.cts.token,name:e,onDidDispose:this.onDidDispose,addCoverage:l=>{const u=l.uri.toString(),d=new ye([t,n,u]).toString();this.publishedCoverage.set(u,l),this.proxy.$appendCoverage(t,n,Wf.fromFile(d,l))},enqueued:s(l=>{this.proxy.$updateTestStateInRun(t,n,ye.fromExtHostTestItem(l,i).toString(),1)}),skipped:s(l=>{this.proxy.$updateTestStateInRun(t,n,ye.fromExtHostTestItem(l,i).toString(),5)}),started:s(l=>{this.proxy.$updateTestStateInRun(t,n,ye.fromExtHostTestItem(l,i).toString(),2)}),errored:s((l,u,d)=>{o(l,u),this.proxy.$updateTestStateInRun(t,n,ye.fromExtHostTestItem(l,i).toString(),6,d)}),failed:s((l,u,d)=>{o(l,u),this.proxy.$updateTestStateInRun(t,n,ye.fromExtHostTestItem(l,i).toString(),4,d)}),passed:s((l,u)=>{this.proxy.$updateTestStateInRun(t,n,ye.fromExtHostTestItem(l,this.dto.controllerId).toString(),3,u)}),appendOutput:(l,u,d)=>{a||(d&&(this.dto.isIncluded(d)?this.ensureTestIsKnown(d):d=void 0),this.proxy.$appendOutputToRun(t,n,_e.fromString(l),u&&Ai.from(u),d&&ye.fromExtHostTestItem(d,i).toString()))},end:()=>{a||(a=!0,this.proxy.$finishedTestRunTask(t,n),--this.running||this.markEnded())}};return this.running++,this.tasks.set(n,{run:c}),this.proxy.$startedTestRunTask(t,{id:n,name:e,running:!0}),c}forciblyEndTasks(){for(const{run:e}of this.tasks.values())e.end()}markEnded(){this.state!==2&&(this.state=2,this.endEmitter.fire())}ensureTestIsKnown(e){if(!(e instanceof Do))throw new Lh(e.id);if(this.sharedTestIds.has(ye.fromExtHostTestItem(e,this.dto.controllerId).toString()))return;const t=[],i=this.dto.colllection.root;for(;;){const n=es.from(e);if(t.unshift(n),this.sharedTestIds.has(n.extId)||(this.sharedTestIds.add(n.extId),e===i))break;e=e.parent||i}this.proxy.$addTestsToRun(this.dto.controllerId,this.dto.id,t)}dispose(){this.markEnded(),super.dispose()}}class VT{get trackers(){return this.tracked.values()}constructor(e,t){this.proxy=e,this.logService=t,this.tracked=new Map,this.trackedById=new Map}getCoverageDetails(e,t){var n;const i=ye.root(e);return((n=this.trackedById.get(i))==null?void 0:n.getCoverageDetails(e,t))||[]}disposeTestRun(e){var t;(t=this.trackedById.get(e))==null||t.dispose(),this.trackedById.delete(e);for(const[i,{id:n}]of this.tracked)n===e&&this.tracked.delete(i)}prepareForMainThreadTestRun(e,t,i,n){return this.getTracker(e,t,i,n)}cancelRunById(e){var t;(t=this.trackedById.get(e))==null||t.cancel()}cancelAllRuns(){for(const e of this.tracked.values())e.cancel()}createTestRun(e,t,i,n,s){var u,d;const o=this.tracked.get(i);if(o)return o.createRun(n);const a=Au.fromPublic(e,t,i,s),c=US(i);this.proxy.$startedExtensionTestRun({controllerId:e,continuous:!!i.continuous,profile:c&&{group:d0[c.kind],id:c.profileId},exclude:((u=i.exclude)==null?void 0:u.map(f=>ye.fromExtHostTestItem(f,t.root.id).toString()))??[],id:a.id,include:((d=i.include)==null?void 0:d.map(f=>ye.fromExtHostTestItem(f,t.root.id).toString()))??[t.root.id],preserveFocus:i.preserveFocus??!0,persist:s});const l=this.getTracker(i,a,i.profile);return It.once(l.onEnd)(()=>{this.proxy.$finishedExtensionTestRun(a.id)}),l.createRun(n)}getTracker(e,t,i,n){const s=new BT(t,this.proxy,this.logService,i,n);return this.tracked.set(e,s),this.trackedById.set(s.id,s),s}}const US=r=>{if(r.profile){if(!(r.profile instanceof BS))throw new Error("TestRunRequest.profile is not an instance created from TestController.createRunProfile");return r.profile}};class Au{static fromPublic(e,t,i,n){var s,o;return new Au(e,ar(),((s=i.include)==null?void 0:s.map(a=>ye.fromExtHostTestItem(a,e).toString()))??[e],((o=i.exclude)==null?void 0:o.map(a=>ye.fromExtHostTestItem(a,e).toString()))??[],n,t)}static fromInternal(e,t){return new Au(e.controllerId,e.runId,e.testIds,e.excludeExtIds,!0,t)}constructor(e,t,i,n,s,o){this.controllerId=e,this.id=t,this.isPersisted=s,this.colllection=o,this.includePrefix=i.map(a=>a+"\0"),this.excludePrefix=n.map(a=>a+"\0")}isIncluded(e){const t=ye.fromExtHostTestItem(e,this.controllerId).toString()+"\0";for(const i of this.excludePrefix)if(t===i||t.startsWith(i))return!1;for(const i of this.includePrefix)if(t===i||t.startsWith(i))return!0;return!1}}class WT{get isEmpty(){return this.added.size===0&&this.removed.size===0&&this.updated.size===0}constructor(e){this.emitter=e,this.added=new Set,this.updated=new Set,this.removed=new Set,this.alreadyRemoved=new Set}add(e){this.added.add(e)}update(e){Object.assign(e.revived,es.toPlain(e.item)),this.added.has(e)||this.updated.add(e)}remove(e){if(this.added.has(e)){this.added.delete(e);return}this.updated.delete(e);const t=ye.parentId(e.item.extId);if(t&&this.alreadyRemoved.has(t.toString())){this.alreadyRemoved.add(e.item.extId);return}this.removed.add(e)}getChangeEvent(){const{added:e,updated:t,removed:i}=this;return{get added(){return[...e].map(n=>n.revived)},get updated(){return[...t].map(n=>n.revived)},get removed(){return[...i].map(n=>n.revived)}}}complete(){this.isEmpty||this.emitter.fire(this.getChangeEvent())}}class zT extends E5{constructor(){super(...arguments),this.changeEmitter=new R,this.onDidChangeTests=this.changeEmitter.event}get rootTests(){return this.roots}getMirroredTestDataById(e){return this.items.get(e)}getMirroredTestDataByReference(e){return this.items.get(e.id)}createItem(e,t){return{...e,revived:es.toPlain(e.item),depth:t?t.depth+1:0,children:new Set}}createChangeCollector(){return new WT(this.changeEmitter)}}class jT{constructor(e){this.proxy=e}checkout(){this.current||(this.current=this.createObserverData());const e=this.current;return e.observers++,{onDidChangeTest:e.tests.onDidChangeTests,get tests(){return[...e.tests.rootTests].map(t=>t.revived)},dispose:mw(()=>{--e.observers===0&&(this.proxy.$unsubscribeFromDiffs(),this.current=void 0)})}}getMirroredTestDataByReference(e){var t;return(t=this.current)==null?void 0:t.tests.getMirroredTestDataByReference(e)}applyDiff(e){var t;(t=this.current)==null||t.tests.apply(e)}createObserverData(){const e=new zT({asCanonicalUri:t=>t});return this.proxy.$subscribeToDiffs(),{observers:0,tests:e}}}const jc=(r,e,t,i)=>{t?Object.assign(t,i):e.$updateTestRunConfig(r.controllerId,r.profileId,i)};var Qi,Gs,Qu,Ci,Ca;class BS{constructor(e,t,i,n,s,o,a,c,l,u=!1,d=void 0,f=!1){ue(this,Qi,void 0);ue(this,Gs,void 0);ue(this,Qu,void 0);ue(this,Ci,void 0);ue(this,Ca,void 0);this.controllerId=s,this.profileId=o,this._label=a,this.kind=c,this.runHandler=l,this._tag=d,this._supportsContinuousRun=f,K(this,Qi,e),K(this,Ca,t),K(this,Gs,i),K(this,Qu,n),t.set(o,this);const m=d0[c];if(typeof m!="number")throw new Error(`Unknown TestRunProfile.group ${c}`);u&&i.add(o),K(this,Ci,{profileId:o,controllerId:s,tag:d?on.namespace(this.controllerId,d.id):null,label:a,group:m,isDefault:u,hasConfigurationHandler:!1,supportsContinuousRun:f}),queueMicrotask(()=>{P(this,Ci)&&(P(this,Qi).$publishTestRunProfile(P(this,Ci)),K(this,Ci,void 0))})}get label(){return this._label}set label(e){e!==this._label&&(this._label=e,jc(this,P(this,Qi),P(this,Ci),{label:e}))}get supportsContinuousRun(){return this._supportsContinuousRun}set supportsContinuousRun(e){e!==this._supportsContinuousRun&&(this._supportsContinuousRun=e,jc(this,P(this,Qi),P(this,Ci),{supportsContinuousRun:e}))}get isDefault(){return P(this,Gs).has(this.profileId)}set isDefault(e){e!==this.isDefault&&(e?P(this,Gs).add(this.profileId):P(this,Gs).delete(this.profileId),jc(this,P(this,Qi),P(this,Ci),{isDefault:e}))}get tag(){return this._tag}set tag(e){var t;(e==null?void 0:e.id)!==((t=this._tag)==null?void 0:t.id)&&(this._tag=e,jc(this,P(this,Qi),P(this,Ci),{tag:e?on.namespace(this.controllerId,e.id):null}))}get configureHandler(){return this._configureHandler}set configureHandler(e){e!==this._configureHandler&&(this._configureHandler=e,jc(this,P(this,Qi),P(this,Ci),{hasConfigurationHandler:!!e}))}get onDidChangeDefault(){return It.chain(P(this,Qu),e=>e.map(t=>{var i;return(i=t.get(this.controllerId))==null?void 0:i.get(this.profileId)}).filter(ks))}dispose(){var e;(e=P(this,Ca))!=null&&e.delete(this.profileId)&&(K(this,Ca,void 0),P(this,Qi).$removeTestProfile(this.controllerId,this.profileId)),K(this,Ci,void 0)}}Qi=new WeakMap,Gs=new WeakMap,Qu=new WeakMap,Ci=new WeakMap,Ca=new WeakMap;const d0={[ga.Coverage]:8,[ga.Debug]:4,[ga.Run]:2};class qT{constructor(e,t){this._extHostDocumentsAndEditors=t,this._onDidChangeTextEditorSelection=new R,this._onDidChangeTextEditorOptions=new R,this._onDidChangeTextEditorVisibleRanges=new R,this._onDidChangeTextEditorViewColumn=new R,this._onDidChangeActiveTextEditor=new R,this._onDidChangeVisibleTextEditors=new R,this.onDidChangeTextEditorSelection=this._onDidChangeTextEditorSelection.event,this.onDidChangeTextEditorOptions=this._onDidChangeTextEditorOptions.event,this.onDidChangeTextEditorVisibleRanges=this._onDidChangeTextEditorVisibleRanges.event,this.onDidChangeTextEditorViewColumn=this._onDidChangeTextEditorViewColumn.event,this.onDidChangeActiveTextEditor=this._onDidChangeActiveTextEditor.event,this.onDidChangeVisibleTextEditors=this._onDidChangeVisibleTextEditors.event,this._proxy=e.getProxy(J.MainThreadTextEditors),this._extHostDocumentsAndEditors.onDidChangeVisibleTextEditors(i=>this._onDidChangeVisibleTextEditors.fire(i)),this._extHostDocumentsAndEditors.onDidChangeActiveTextEditor(i=>this._onDidChangeActiveTextEditor.fire(i))}getActiveTextEditor(){return this._extHostDocumentsAndEditors.activeEditor()}getVisibleTextEditors(e){const t=this._extHostDocumentsAndEditors.allEditors();return e?t:t.map(i=>i.value)}async showTextDocument(e,t,i){let n;typeof t=="number"?n={position:Et.from(t),preserveFocus:i}:typeof t=="object"?n={position:Et.from(t.viewColumn),preserveFocus:t.preserveFocus,selection:typeof t.selection=="object"?H.from(t.selection):void 0,pinned:typeof t.preview=="boolean"?!t.preview:void 0}:n={preserveFocus:!1};const s=await this._proxy.$tryShowTextDocument(e.uri,n),o=s&&this._extHostDocumentsAndEditors.getEditor(s);if(o)return o.value;throw s?new Error(`Could NOT open editor for "${e.uri.toString()}" because another editor opened in the meantime.`):new Error(`Could NOT open editor for "${e.uri.toString()}".`)}createTextEditorDecorationType(e,t){return new e_(this._proxy,e,t).value}$acceptEditorPropertiesChanged(e,t){const i=this._extHostDocumentsAndEditors.getEditor(e);if(!i)throw new Error("unknown text editor");if(t.options&&i._acceptOptions(t.options),t.selections){const n=t.selections.selections.map(Fi.to);i._acceptSelections(n)}if(t.visibleRanges){const n=ci(t.visibleRanges.map(H.to));i._acceptVisibleRanges(n)}if(t.options&&this._onDidChangeTextEditorOptions.fire({textEditor:i.value,options:{...t.options,lineNumbers:ma.to(t.options.lineNumbers)}}),t.selections){const n=za.fromValue(t.selections.source),s=t.selections.selections.map(Fi.to);this._onDidChangeTextEditorSelection.fire({textEditor:i.value,selections:s,kind:n})}if(t.visibleRanges){const n=ci(t.visibleRanges.map(H.to));this._onDidChangeTextEditorVisibleRanges.fire({textEditor:i.value,visibleRanges:n})}}$acceptEditorPositionData(e){for(const t in e){const i=this._extHostDocumentsAndEditors.getEditor(t);if(!i)throw new Error("Unknown text editor");const n=Et.to(e[t]);i.value.viewColumn!==n&&(i._acceptViewColumn(n),this._onDidChangeTextEditorViewColumn.fire({textEditor:i.value,viewColumn:n}))}}getDiffInformation(e){return Promise.resolve(this._proxy.$getDiffInformation(e))}}let iw=class{constructor(e){this._actual=new ff(xr.Dark),this._onDidChangeActiveColorTheme=new R}get activeColorTheme(){return this._actual}$onColorThemeChange(e){let t;switch(e){case"light":t=xr.Light;break;case"hcDark":t=xr.HighContrast;break;case"hcLight":t=xr.HighContrastLight;break;default:t=xr.Dark}this._actual=new ff(t),this._onDidChangeActiveColorTheme.fire(this._actual)}get onDidChangeActiveColorTheme(){return this._onDidChangeActiveColorTheme.event}};iw=U([M(0,Ve)],iw);class GT{constructor(e,t){this._providers=new Map,this._itemsBySourceAndUriMap=new Map,this._proxy=e.getProxy(J.MainThreadTimeline),t.registerArgumentProcessor({processArgument:(i,n)=>{var s,o,a;if(i&&i.$mid===12)if(this._providers.get(i.source)&&Xe.equals(n,(s=this._providers.get(i.source))==null?void 0:s.extension)){const c=i.uri===void 0?void 0:x.revive(i.uri);return(a=(o=this._itemsBySourceAndUriMap.get(i.source))==null?void 0:o.get(j2(c)))==null?void 0:a.get(i.handle)}else return;return i}})}async $getTimeline(e,t,i,n){const s=this._providers.get(e);return s==null?void 0:s.provider.provideTimeline(x.revive(t),i,n)}registerTimelineProvider(e,t,i,n){const s=new Te,o=this.convertTimelineItem(t.id,n,s).bind(this);let a;t.onDidChange&&(a=t.onDidChange(l=>this._proxy.$emitTimelineChangeEvent({uri:void 0,reset:!0,...l,id:t.id}),this));const c=this._itemsBySourceAndUriMap;return this.registerTimelineProviderCore({...t,scheme:e,onDidChange:void 0,async provideTimeline(l,u,d){var b;u!=null&&u.resetCache&&(s.clear(),(b=c.get(t.id))==null||b.clear());const f=await t.provideTimeline(l,u,d);if(f==null)return;const m=o(l,u);return{...f,source:t.id,items:f.items.map(m)}},dispose(){var l;for(const u of c.values())(l=u.get(t.id))==null||l.clear();a==null||a.dispose(),s.dispose()}},i)}convertTimelineItem(e,t,i){return(n,s)=>{let o;if(s!=null&&s.cacheResults){let a=this._itemsBySourceAndUriMap.get(e);a===void 0&&(a=new Map,this._itemsBySourceAndUriMap.set(e,a));const c=j2(n);o=a.get(c),o===void 0&&(o=new Map,a.set(c,o))}return a=>{const{iconPath:c,...l}=a,u=`${e}|${a.id??a.timestamp}`;o==null||o.set(u,a);let d,f,m;a.iconPath&&(c instanceof Kt?m={id:c.id,color:c.color}:x.isUri(c)?(d=c,f=c):{light:d,dark:f}=c);let b;return Ti.isMarkdownString(l.tooltip)?b=Le.from(l.tooltip):$e(l.tooltip)?b=l.tooltip:Ti.isMarkdownString(l.detail)?(console.warn("Using deprecated TimelineItem.detail, migrate to TimelineItem.tooltip"),b=Le.from(l.detail)):$e(l.detail)&&(console.warn("Using deprecated TimelineItem.detail, migrate to TimelineItem.tooltip"),b=l.detail),{...l,id:l.id??void 0,handle:u,source:e,command:a.command?t.toInternal(a.command,i):void 0,icon:d,iconDark:f,themeIcon:m,tooltip:b,accessibilityInformation:a.accessibilityInformation}}}}registerTimelineProviderCore(e,t){if(this._providers.get(e.id))throw new Error(`Timeline Provider ${e.id} already exists.`);return this._proxy.$registerTimelineProvider({id:e.id,label:e.label,scheme:e.scheme}),this._providers.set(e.id,{provider:e,extension:t}),De(()=>{var n;for(const s of this._itemsBySourceAndUriMap.values())(n=s.get(e.id))==null||n.clear();this._providers.delete(e.id),this._proxy.$unregisterTimelineProvider(e.id),e.dispose()})}}function j2(r){return r==null?void 0:r.toString()}const Ru="vs/platform/theme/common/iconRegistry",QT={IconContribution:"base.contributions.icons"};var q2;(function(r){function e(i){return{weight:i.weight,style:i.style,src:i.src.map(n=>({format:n.format,location:n.location.toString()}))}}r.toJSONObject=e;function t(i){const n=s=>$e(s)?s:void 0;if(i&&Array.isArray(i.src)&&i.src.every(s=>$e(s.format)&&$e(s.location)))return{weight:n(i.weight),style:n(i.style),src:i.src.map(s=>({format:s.format,location:x.parse(s.location)}))}}r.fromJSONObject=t})(q2||(q2={}));class JT{constructor(){this._onDidChange=new R,this.onDidChange=this._onDidChange.event,this.iconSchema={definitions:{icons:{type:"object",properties:{fontId:{type:"string",description:h(Ru,0,"The id of the font to use. If not set, the font that is defined first is used.")},fontCharacter:{type:"string",description:h(Ru,1,"The font character associated with the icon definition.")}},additionalProperties:!1,defaultSnippets:[{body:{fontCharacter:"\\\\e030"}}]}},type:"object",properties:{}},this.iconReferenceSchema={type:"string",pattern:`^${Jt.iconNameExpression}$`,enum:[],enumDescriptions:[]},this.iconsById={},this.iconFontsById={}}registerIcon(e,t,i,n){const s=this.iconsById[e];if(s){if(i&&!s.description){s.description=i,this.iconSchema.properties[e].markdownDescription=`${i} $(${e})`;const c=this.iconReferenceSchema.enum.indexOf(e);c!==-1&&(this.iconReferenceSchema.enumDescriptions[c]=i),this._onDidChange.fire()}return s}const o={id:e,description:i,defaults:t,deprecationMessage:n};this.iconsById[e]=o;const a={$ref:"#/definitions/icons"};return n&&(a.deprecationMessage=n),i&&(a.markdownDescription=`${i}: $(${e})`),this.iconSchema.properties[e]=a,this.iconReferenceSchema.enum.push(e),this.iconReferenceSchema.enumDescriptions.push(i||""),this._onDidChange.fire(),{id:e}}deregisterIcon(e){delete this.iconsById[e],delete this.iconSchema.properties[e];const t=this.iconReferenceSchema.enum.indexOf(e);t!==-1&&(this.iconReferenceSchema.enum.splice(t,1),this.iconReferenceSchema.enumDescriptions.splice(t,1)),this._onDidChange.fire()}getIcons(){return Object.keys(this.iconsById).map(e=>this.iconsById[e])}getIcon(e){return this.iconsById[e]}getIconSchema(){return this.iconSchema}getIconReferenceSchema(){return this.iconReferenceSchema}registerIconFont(e,t){const i=this.iconFontsById[e];return i||(this.iconFontsById[e]=t,this._onDidChange.fire(),t)}deregisterIconFont(e){delete this.iconFontsById[e]}getIconFont(e){return this.iconFontsById[e]}toString(){const e=(s,o)=>s.id.localeCompare(o.id),t=s=>{for(;Jt.isThemeIcon(s.defaults);)s=this.iconsById[s.defaults.id];return`codicon codicon-${s?s.id:""}`},i=[];i.push("| preview     | identifier                        | default codicon ID                | description"),i.push("| ----------- | --------------------------------- | --------------------------------- | --------------------------------- |");const n=Object.keys(this.iconsById).map(s=>this.iconsById[s]);for(const s of n.filter(o=>!!o.description).sort(e))i.push(`|<i class="${t(s)}"></i>|${s.id}|${Jt.isThemeIcon(s.defaults)?s.defaults.id:s.id}|${s.description||""}|`);i.push("| preview     | identifier                        "),i.push("| ----------- | --------------------------------- |");for(const s of n.filter(o=>!Jt.isThemeIcon(o.defaults)).sort(e))i.push(`|<i class="${t(s)}"></i>|${s.id}|`);return i.join(`
`)}}const fd=new JT;qt.add(QT.IconContribution,fd);function mg(r,e,t,i){return fd.registerIcon(r,e,t,i)}function KT(){const r=yk();for(const e in r){const t="\\"+r[e].toString(16);fd.registerIcon(e,{fontCharacter:t})}}KT();const VS="vscode://schemas/icons",WS=qt.as(ig.JSONContribution);WS.registerSchema(VS,fd.getIconSchema());const G2=new id(()=>WS.notifySchemaChanged(VS),200);fd.onDidChange(()=>{G2.isScheduled()||G2.schedule()});mg("widget-close",de.close,h(Ru,2,"Icon for the close action in widgets."));mg("goto-previous-location",de.arrowUp,h(Ru,3,"Icon for goto previous editor location."));mg("goto-next-location",de.arrowDown,h(Ru,4,"Icon for goto next editor location."));Jt.modify(de.sync,"spin");Jt.modify(de.loading,"spin");const vg="vs/workbench/common/views";h(vg,0,"Views");mg("default-view-icon",de.window,h(vg,1,"Default view icon."));var mp;(function(r){r.ViewContainersRegistry="workbench.registry.view.containers",r.ViewsRegistry="workbench.registry.view"})(mp||(mp={}));var Q2;(function(r){r[r.Sidebar=0]="Sidebar",r[r.Panel=1]="Panel",r[r.AuxiliaryBar=2]="AuxiliaryBar"})(Q2||(Q2={}));class XT extends Fe{constructor(){super(...arguments),this._onDidRegister=this._register(new R),this.onDidRegister=this._onDidRegister.event,this._onDidDeregister=this._register(new R),this.onDidDeregister=this._onDidDeregister.event,this.viewContainers=new Map,this.defaultViewContainers=[]}get all(){return dh([...this.viewContainers.values()])}registerViewContainer(e,t,i){const n=this.get(e.id);if(n)return n;const s=e;return s.openCommandActionDescriptor=i!=null&&i.doNotRegisterOpenCommand?void 0:s.openCommandActionDescriptor??{id:s.id},t4(this.viewContainers,t,[]).push(s),i!=null&&i.isDefault&&this.defaultViewContainers.push(s),this._onDidRegister.fire({viewContainer:s,viewContainerLocation:t}),s}deregisterViewContainer(e){for(const t of this.viewContainers.keys()){const i=this.viewContainers.get(t),n=i==null?void 0:i.indexOf(e);if(n!==-1){i==null||i.splice(n,1),i.length===0&&this.viewContainers.delete(t),this._onDidDeregister.fire({viewContainer:e,viewContainerLocation:t});return}}}get(e){return this.all.filter(t=>t.id===e)[0]}getViewContainers(e){return[...this.viewContainers.get(e)||[]]}getViewContainerLocation(e){return[...this.viewContainers.keys()].filter(t=>this.getViewContainers(t).filter(i=>(i==null?void 0:i.id)===e.id).length>0)[0]}getDefaultViewContainer(e){return this.defaultViewContainers.find(t=>this.getViewContainerLocation(t)===e)}}qt.add(mp.ViewContainersRegistry,new XT);var vp;(function(r){r.Open="2_open",r.Debug="4_debug",r.SCM="5_scm",r.More="9_more"})(vp||(vp={}));function ZT(r,e){const t=r.group??vp.More,i=e.group??vp.More;return t!==i?t.localeCompare(i):(r.order??5)-(e.order??5)}class YT extends Fe{constructor(){super(...arguments),this._onViewsRegistered=this._register(new R),this.onViewsRegistered=this._onViewsRegistered.event,this._onViewsDeregistered=this._register(new R),this.onViewsDeregistered=this._onViewsDeregistered.event,this._onDidChangeContainer=this._register(new R),this.onDidChangeContainer=this._onDidChangeContainer.event,this._onDidChangeViewWelcomeContent=this._register(new R),this.onDidChangeViewWelcomeContent=this._onDidChangeViewWelcomeContent.event,this._viewContainers=[],this._views=new Map,this._viewWelcomeContents=new dx}registerViews(e,t){this.registerViews2([{views:e,viewContainer:t}])}registerViews2(e){e.forEach(({views:t,viewContainer:i})=>this.addViews(t,i)),this._onViewsRegistered.fire(e)}deregisterViews(e,t){const i=this.removeViews(e,t);i.length&&this._onViewsDeregistered.fire({views:i,viewContainer:t})}moveViews(e,t){for(const i of this._views.keys())if(i!==t){const n=this.removeViews(e,i);n.length&&(this.addViews(n,t),this._onDidChangeContainer.fire({views:n,from:i,to:t}))}}getViews(e){return this._views.get(e)||[]}getView(e){for(const t of this._viewContainers){const i=(this._views.get(t)||[]).filter(n=>n.id===e)[0];if(i)return i}return null}getViewContainer(e){for(const t of this._viewContainers)if((this._views.get(t)||[]).filter(n=>n.id===e)[0])return t;return null}registerViewWelcomeContent(e,t){return this._viewWelcomeContents.add(e,t),this._onDidChangeViewWelcomeContent.fire(e),De(()=>{this._viewWelcomeContents.delete(e,t),this._onDidChangeViewWelcomeContent.fire(e)})}registerViewWelcomeContent2(e,t){const i=new Map;for(const[n,s]of t)this._viewWelcomeContents.add(e,s),i.set(n,De(()=>{this._viewWelcomeContents.delete(e,s),this._onDidChangeViewWelcomeContent.fire(e)}));return this._onDidChangeViewWelcomeContent.fire(e),i}getViewWelcomeContent(e){const t=[];return this._viewWelcomeContents.forEach(e,i=>t.push(i)),t.sort(ZT)}addViews(e,t){let i=this._views.get(t);i||(i=[],this._views.set(t,i),this._viewContainers.push(t));for(const n of e){if(this.getView(n.id)!==null)throw new Error(h(vg,2,"A view with id '{0}' is already registered",n.id));i.push(n)}}removeViews(e,t){const i=this._views.get(t);if(!i)return[];const n=[],s=[];for(const o of i)e.includes(o)?n.push(o):s.push(o);return n.length&&(s.length?this._views.set(t,s):(this._views.delete(t),this._viewContainers.splice(this._viewContainers.indexOf(t),1))),n}}qt.add(mp.ViewsRegistry,new YT);var J2;(function(r){r[r.Default=0]="Default",r[r.Expand=1]="Expand"})(J2||(J2={}));var K2;(function(r){r[r.None=0]="None",r[r.Collapsed=1]="Collapsed",r[r.Expanded=2]="Expanded"})(K2||(K2={}));class An extends Error{constructor(e){super(h(vg,3,"No tree view with id '{0}' registered.",e)),this.name="NoTreeViewError"}static is(e){return e.name==="NoTreeViewError"}}class e3{constructor(){this._dragOperations=new Map}removeDragOperationTransfer(e){if(e&&this._dragOperations.has(e)){const t=this._dragOperations.get(e);return this._dragOperations.delete(e),t}}addDragOperationTransfer(e,t){this._dragOperations.set(e,t)}}const t3="vs/workbench/api/common/extHostTreeViews";function X2(r,e){if($e(r))return{label:r};if(r&&typeof r=="object"&&typeof r.label=="string"){let t;return Array.isArray(r.highlights)&&(t=r.highlights.filter(i=>i.length===2&&typeof i[0]=="number"&&typeof i[1]=="number"),t=t.length?t:void 0),{label:r.label,highlights:t}}}class i3 extends Fe{constructor(e,t,i){super(),this._proxy=e,this.commands=t,this.logService=i,this.treeViews=new Map,this.treeDragAndDropService=new e3;function n(s){return s&&s.$treeViewId&&(s.$treeItemHandle||s.$selectedTreeItems||s.$focusedTreeItem)}t.registerArgumentProcessor({processArgument:s=>n(s)?this.convertArgument(s):Array.isArray(s)&&s.length>0?s.map(o=>n(o)?this.convertArgument(o):o):s})}registerTreeDataProvider(e,t,i){const n=this.createTreeView(e,{treeDataProvider:t},i);return{dispose:()=>n.dispose()}}createTreeView(e,t,i){var f,m,b,_;if(!t||!t.treeDataProvider)throw new Error("Options with treeDataProvider is mandatory");const n=((f=t.dragAndDropController)==null?void 0:f.dropMimeTypes)??[],s=((m=t.dragAndDropController)==null?void 0:m.dragMimeTypes)??[],o=!!((b=t.dragAndDropController)!=null&&b.handleDrag),a=!!((_=t.dragAndDropController)!=null&&_.handleDrop),c=this.createExtHostTreeView(e,t,i),l={showCollapseAll:!!t.showCollapseAll,canSelectMany:!!t.canSelectMany,dropMimeTypes:n,dragMimeTypes:s,hasHandleDrag:o,hasHandleDrop:a,manuallyManageCheckboxes:!!t.manageCheckboxStateManually},u=this._proxy.$registerTreeViewDataProvider(e,l),d={get onDidCollapseElement(){return c.onDidCollapseElement},get onDidExpandElement(){return c.onDidExpandElement},get selection(){return c.selectedElements},get onDidChangeSelection(){return c.onDidChangeSelection},get activeItem(){return O(i,"treeViewActiveItem"),c.focusedElement},get onDidChangeActiveItem(){return O(i,"treeViewActiveItem"),c.onDidChangeActiveItem},get visible(){return c.visible},get onDidChangeVisibility(){return c.onDidChangeVisibility},get onDidChangeCheckboxState(){return c.onDidChangeCheckboxState},get message(){return c.message},set message(v){bo(v)&&O(i,"treeViewMarkdownMessage"),c.message=v},get title(){return c.title},set title(v){c.title=v},get description(){return c.description},set description(v){c.description=v},get badge(){return c.badge},set badge(v){v!==void 0&&S1.isViewBadge(v)?c.badge={value:Math.floor(Math.abs(v.value)),tooltip:v.tooltip}:v===void 0&&(c.badge=void 0)},reveal:(v,k)=>c.reveal(v,k),dispose:async()=>{await u,this.treeViews.delete(e),c.dispose()}};return this._register(d),d}$getChildren(e,t){const i=this.treeViews.get(e);return i?i.getChildren(t):Promise.reject(new An(e))}async $handleDrop(e,t,i,n,s,o,a,c){const l=this.treeViews.get(e);if(!l)return Promise.reject(new An(e));const u=zr.toDataTransfer(i,async d=>(await this._proxy.$resolveDropFileData(e,t,d)).buffer);return a===e&&c&&await this.addAdditionalTransferItems(u,l,c,s,o),l.onDrop(u,n,s)}async addAdditionalTransferItems(e,t,i,n,s){var a;const o=this.treeDragAndDropService.removeDragOperationTransfer(s);if(o)(a=await o)==null||a.forEach((c,l)=>{c&&e.set(l,c)});else if(s&&t.handleDrag){const c=t.handleDrag(i,e,n);this.treeDragAndDropService.addDragOperationTransfer(s,c),await c}return e}async $handleDrag(e,t,i,n){const s=this.treeViews.get(e);if(!s)return Promise.reject(new An(e));const o=await this.addAdditionalTransferItems(new Xl,s,t,n,i);if(!(!o||n.isCancellationRequested))return zr.from(o)}async $hasResolve(e){const t=this.treeViews.get(e);if(!t)throw new An(e);return t.hasResolve}$resolve(e,t,i){const n=this.treeViews.get(e);if(!n)throw new An(e);return n.resolveTreeItem(t,i)}$setExpanded(e,t,i){const n=this.treeViews.get(e);if(!n)throw new An(e);n.setExpanded(t,i)}$setSelectionAndFocus(e,t,i){const n=this.treeViews.get(e);if(!n)throw new An(e);n.setSelectionAndFocus(t,i)}$setVisible(e,t){const i=this.treeViews.get(e);if(!i){if(!t)return;throw new An(e)}i.setVisible(t)}$changeCheckboxState(e,t){const i=this.treeViews.get(e);if(!i)throw new An(e);i.setCheckboxState(t)}createExtHostTreeView(e,t,i){const n=this._register(new nw(e,t,this._proxy,this.commands.converter,this.logService,i));return this.treeViews.set(e,n),n}convertArgument(e){const t=this.treeViews.get(e.$treeViewId);return t&&"$treeItemHandle"in e?t.getExtensionElement(e.$treeItemHandle):t&&"$focusedTreeItem"in e&&e.$focusedTreeItem?t.focusedElement:null}}const ra=class ra extends Fe{get visible(){return this._visible}get selectedElements(){return this._selectedHandles.map(e=>this.getExtensionElement(e)).filter(e=>!Qt(e))}get focusedElement(){return this._focusedHandle?this.getExtensionElement(this._focusedHandle):void 0}constructor(e,t,i,n,s,o){if(super(),this.viewId=e,this.proxy=i,this.commands=n,this.logService=s,this.extension=o,this.roots=void 0,this.elements=new Map,this.nodes=new Map,this._visible=!1,this._selectedHandles=[],this._focusedHandle=void 0,this._onDidExpandElement=this._register(new R),this.onDidExpandElement=this._onDidExpandElement.event,this._onDidCollapseElement=this._register(new R),this.onDidCollapseElement=this._onDidCollapseElement.event,this._onDidChangeSelection=this._register(new R),this.onDidChangeSelection=this._onDidChangeSelection.event,this._onDidChangeActiveItem=this._register(new R),this.onDidChangeActiveItem=this._onDidChangeActiveItem.event,this._onDidChangeVisibility=this._register(new R),this.onDidChangeVisibility=this._onDidChangeVisibility.event,this._onDidChangeCheckboxState=this._register(new R),this.onDidChangeCheckboxState=this._onDidChangeCheckboxState.event,this._onDidChangeData=this._register(new R),this.refreshPromise=Promise.resolve(),this.refreshQueue=Promise.resolve(),this._message="",this._title="",this._refreshCancellationSource=new Tt,o.contributes&&o.contributes.views)for(const u in o.contributes.views)for(const d of o.contributes.views[u])d.id===e&&(this._title=d.name);this.dataProvider=t.treeDataProvider,this.dndController=t.dragAndDropController,this.dataProvider.onDidChangeTreeData&&this._register(this.dataProvider.onDidChangeTreeData(u=>{Array.isArray(u)&&u.length===0||this._onDidChangeData.fire({message:!1,element:u})}));let a,c;const l=It.debounce(this._onDidChangeData.event,(u,d)=>(u||(u={message:!1,elements:[]}),d.element!==!1&&(a||(a=new Promise(f=>c=f),this.refreshPromise=this.refreshPromise.then(()=>a)),Array.isArray(d.element)?u.elements.push(...d.element):u.elements.push(d.element)),d.message&&(u.message=!0),u),200,!0);this._register(l(({message:u,elements:d})=>{d.length&&(this.refreshQueue=this.refreshQueue.then(()=>{const f=c;return a=null,this.refresh(d).then(()=>f())})),u&&this.proxy.$setMessage(this.viewId,Le.fromStrict(this._message)??"")}))}async getChildren(e){const t=e?this.getExtensionElement(e):void 0;if(e&&!t)return this.logService.error(`No tree item with id '${e}' found.`),Promise.resolve([]);let i=this.getChildrenNodes(e);return i||(i=await this.fetchChildrenNodes(t)),i?i.map(n=>n.item):void 0}getExtensionElement(e){return this.elements.get(e)}reveal(e,t){t=t||{select:!0,focus:!1};const i=Qt(t.select)?!0:t.select,n=Qt(t.focus)?!1:t.focus,s=Qt(t.expand)?!1:t.expand;return typeof this.dataProvider.getParent!="function"?Promise.reject(new Error("Required registered TreeDataProvider to implement 'getParent' method to access 'reveal' method")):e?this.refreshPromise.then(()=>this.resolveUnknownParentChain(e)).then(o=>this.resolveTreeNode(e,o[o.length-1]).then(a=>this.proxy.$reveal(this.viewId,{item:a.item,parentChain:o.map(c=>c.item)},{select:i,focus:n,expand:s})),o=>this.logService.error(o)):this.proxy.$reveal(this.viewId,void 0,{select:i,focus:n,expand:s})}get message(){return this._message}set message(e){this._message=e,this._onDidChangeData.fire({message:!0,element:!1})}get title(){return this._title}set title(e){this._title=e,this.proxy.$setTitle(this.viewId,e,this._description)}get description(){return this._description}set description(e){this._description=e,this.proxy.$setTitle(this.viewId,this._title,e)}get badge(){return this._badge}set badge(e){var t,i;((t=this._badge)==null?void 0:t.value)===(e==null?void 0:e.value)&&((i=this._badge)==null?void 0:i.tooltip)===(e==null?void 0:e.tooltip)||(this._badge=zf.from(e),this.proxy.$setBadge(this.viewId,e))}setExpanded(e,t){const i=this.getExtensionElement(e);i&&(t?this._onDidExpandElement.fire(Object.freeze({element:i})):this._onDidCollapseElement.fire(Object.freeze({element:i})))}setSelectionAndFocus(e,t){const i=!qr(this._selectedHandles,e);this._selectedHandles=e;const n=this._focusedHandle!==t;this._focusedHandle=t,i&&this._onDidChangeSelection.fire(Object.freeze({selection:this.selectedElements})),n&&this._onDidChangeActiveItem.fire(Object.freeze({activeItem:this.focusedElement}))}setVisible(e){e!==this._visible&&(this._visible=e,this._onDidChangeVisibility.fire(Object.freeze({visible:this._visible})))}async setCheckboxState(e){const t=(await Promise.all(e.map(async i=>{const n=this.getExtensionElement(i.treeItemHandle);return n?{extensionItem:n,treeItem:await this.dataProvider.getTreeItem(n),newState:i.newState?wn.Checked:wn.Unchecked}:Promise.resolve(void 0)}))).filter(i=>i!==void 0);t.forEach(i=>{i.treeItem.checkboxState=i.newState?wn.Checked:wn.Unchecked}),this._onDidChangeCheckboxState.fire({items:t.map(i=>[i.extensionItem,i.newState])})}async handleDrag(e,t,i){var s;const n=[];for(const o of e){const a=this.getExtensionElement(o);a&&n.push(a)}if(!(!((s=this.dndController)!=null&&s.handleDrag)||n.length===0))return await this.dndController.handleDrag(n,t,i),t}get hasHandleDrag(){var e;return!!((e=this.dndController)!=null&&e.handleDrag)}async onDrop(e,t,i){var s;const n=t?this.getExtensionElement(t):void 0;if(!(!n&&t||!((s=this.dndController)!=null&&s.handleDrop)))return Bt(()=>{var o;return(o=this.dndController)!=null&&o.handleDrop?this.dndController.handleDrop(n,e,i):void 0})}get hasResolve(){return!!this.dataProvider.resolveTreeItem}async resolveTreeItem(e,t){if(!this.dataProvider.resolveTreeItem)return;const i=this.elements.get(e);if(i){const n=this.nodes.get(i);if(n){const s=await this.dataProvider.resolveTreeItem(n.extensionItem,i,t)??n.extensionItem;return this.validateTreeItem(s),n.item.tooltip=this.getTooltip(s.tooltip),n.item.command=this.getCommand(n.disposableStore,s.command),n.item}}}resolveUnknownParentChain(e){return this.resolveParent(e).then(t=>t?this.resolveUnknownParentChain(t).then(i=>this.resolveTreeNode(t,i[i.length-1]).then(n=>(i.push(n),i))):Promise.resolve([]))}resolveParent(e){const t=this.nodes.get(e);return t?Promise.resolve(t.parent?this.elements.get(t.parent.item.handle):void 0):Bt(()=>this.dataProvider.getParent(e))}resolveTreeNode(e,t){const i=this.nodes.get(e);return i?Promise.resolve(i):Bt(()=>this.dataProvider.getTreeItem(e)).then(n=>this.createHandle(e,n,t,!0)).then(n=>this.getChildren(t?t.item.handle:void 0).then(()=>{const s=this.getExtensionElement(n);if(s){const o=this.nodes.get(s);if(o)return Promise.resolve(o)}throw new Error(`Cannot resolve tree item for element ${n} from extension ${this.extension.identifier.value}`)}))}getChildrenNodes(e){if(e){let t;if(typeof e=="string"){const i=this.getExtensionElement(e);t=i?this.nodes.get(i):void 0}else t=e;return t&&t.children||void 0}return this.roots}async fetchChildrenNodes(e){this.clearChildren(e);const t=new Tt(this._refreshCancellationSource.token);try{const i=e?this.nodes.get(e):void 0,n=await this.dataProvider.getChildren(e);if(t.token.isCancellationRequested)return;const s=ci(n||[]),o=await Promise.all(ci(s).map(c=>this.dataProvider.getTreeItem(c)));if(t.token.isCancellationRequested)return;const a=o.map((c,l)=>c?this.createAndRegisterTreeNode(s[l],c,i):null);return ci(a)}finally{t.dispose()}}refresh(e){if(e.some(i=>!i))return this._refreshCancellationSource.dispose(!0),this._refreshCancellationSource=new Tt,this.clearAll(),this.proxy.$refresh(this.viewId);{const i=this.getHandlesToRefresh(e);if(i.length)return this.refreshHandles(i)}return Promise.resolve(void 0)}getHandlesToRefresh(e){const t=new Set,i=e.map(s=>this.nodes.get(s));for(const s of i)if(s&&!t.has(s.item.handle)){let o=s;for(;o&&o.parent&&i.findIndex(a=>o&&o.parent&&a&&a.item.handle===o.parent.item.handle)===-1;){const a=this.elements.get(o.parent.item.handle);o=a?this.nodes.get(a):void 0}o&&!o.parent&&t.add(s.item.handle)}const n=[];return t.forEach(s=>{const o=this.elements.get(s);if(o){const a=this.nodes.get(o);a&&(!a.parent||!t.has(a.parent.item.handle))&&n.push(s)}}),n}refreshHandles(e){const t={};return Promise.all(e.map(i=>this.refreshNode(i).then(n=>{n&&(t[i]=n.item)}))).then(()=>Object.keys(t).length?this.proxy.$refresh(this.viewId,t):void 0)}refreshNode(e){const t=this.getExtensionElement(e);if(t){const i=this.nodes.get(t);if(i)return this.clearChildren(t),Bt(()=>this.dataProvider.getTreeItem(t)).then(n=>{if(n){const s=this.createTreeNode(t,n,i.parent);return this.updateNodeCache(t,s,i,i.parent),i.dispose(),s}return null})}return Promise.resolve(null)}createAndRegisterTreeNode(e,t,i){const n=this.createTreeNode(e,t,i);if(t.id&&this.elements.has(n.item.handle))throw new Error(h(t3,0,"Element with id {0} is already registered",t.id));return this.addNodeToCache(e,n),this.addNodeToParentCache(n,i),n}getTooltip(e){return Ti.isMarkdownString(e)?Le.from(e):e}getCommand(e,t){return t?{...this.commands.toInternal(t,e),originalId:t.command}:void 0}getCheckbox(e){if(e.checkboxState===void 0)return;let t,i,n;return typeof e.checkboxState=="number"?t=e.checkboxState:(t=e.checkboxState.state,i=e.checkboxState.tooltip,n=e.checkboxState.accessibilityInformation),{isChecked:t===wn.Checked,tooltip:i,accessibilityInformation:n}}validateTreeItem(e){if(!ef.isTreeItem(e,this.extension))throw new Error(`Extension ${this.extension.identifier.value} has provided an invalid tree item.`)}createTreeNode(e,t,i){this.validateTreeItem(t);const n=this._register(new Te),s=this.createHandle(e,t,i),o=this.getLightIconPath(t);return{item:{handle:s,parentHandle:i?i.item.handle:void 0,label:X2(t.label),description:t.description,resourceUri:t.resourceUri,tooltip:this.getTooltip(t.tooltip),command:this.getCommand(n,t.command),contextValue:t.contextValue,icon:o,iconDark:this.getDarkIconPath(t)||o,themeIcon:this.getThemeIcon(t),collapsibleState:Qt(t.collapsibleState)?no.None:t.collapsibleState,accessibilityInformation:t.accessibilityInformation,checkbox:this.getCheckbox(t)},extensionItem:t,parent:i,children:void 0,disposableStore:n,dispose(){n.dispose()}}}getThemeIcon(e){return e.iconPath instanceof Kt?e.iconPath:void 0}createHandle(e,{id:t,label:i,resourceUri:n},s,o){if(t)return`${ra.ID_HANDLE_PREFIX}/${t}`;const a=X2(i),c=s?s.item.handle:ra.LABEL_HANDLE_PREFIX;let l=a?a.label:n?_c(n):"";l=l.indexOf("/")!==-1?l.replace("/","//"):l;const u=this.nodes.has(e)?this.nodes.get(e).item.handle:void 0,d=this.getChildrenNodes(s)||[];let f,m=0;do{if(f=`${c}/${m}:${l}`,o||!this.elements.has(f)||u===f)break;m++}while(m<=d.length);return f}getLightIconPath(e){if(e.iconPath&&!(e.iconPath instanceof Kt))return typeof e.iconPath=="string"||x.isUri(e.iconPath)?this.getIconPath(e.iconPath):this.getIconPath(e.iconPath.light)}getDarkIconPath(e){if(e.iconPath&&!(e.iconPath instanceof Kt)&&e.iconPath.dark)return this.getIconPath(e.iconPath.dark)}getIconPath(e){return x.isUri(e)?e:x.file(e)}addNodeToCache(e,t){this.elements.set(t.item.handle,e),this.nodes.set(e,t)}updateNodeCache(e,t,i,n){this.elements.delete(t.item.handle),this.nodes.delete(e),t.item.handle!==i.item.handle&&this.elements.delete(i.item.handle),this.addNodeToCache(e,t);const s=this.getChildrenNodes(n)||[],o=s.filter(a=>a.item.handle===i.item.handle)[0];o&&s.splice(s.indexOf(o),1,t)}addNodeToParentCache(e,t){t?(t.children||(t.children=[]),t.children.push(e)):(this.roots||(this.roots=[]),this.roots.push(e))}clearChildren(e){if(e){const t=this.nodes.get(e);if(t){if(t.children)for(const i of t.children){const n=this.elements.get(i.item.handle);n&&this.clear(n)}t.children=void 0}}else this.clearAll()}clear(e){const t=this.nodes.get(e);if(t){if(t.children)for(const i of t.children){const n=this.elements.get(i.item.handle);n&&this.clear(n)}this.nodes.delete(e),this.elements.delete(t.item.handle),t.dispose()}}clearAll(){this.roots=void 0,this.elements.clear(),this.nodes.forEach(e=>e.dispose()),this.nodes.clear()}dispose(){super.dispose(),this._refreshCancellationSource.dispose(),this.clearAll(),this.proxy.$disposeTree(this.viewId)}};ra.LABEL_HANDLE_PREFIX="0",ra.ID_HANDLE_PREFIX="1";let nw=ra;const jp=class jp{constructor(e){this._openers=new Map,this._proxy=e.getProxy(J.MainThreadUriOpeners)}registerExternalUriOpener(e,t,i,n){if(this._openers.has(t))throw new Error(`Opener with id '${t}' already registered`);const s=n.schemes.find(o=>!jp.supportedSchemes.has(o));if(s)throw new Error(`Scheme '${s}' is not supported. Only http and https are currently supported.`);return this._openers.set(t,i),this._proxy.$registerUriOpener(t,n.schemes,e,n.label),De(()=>{this._openers.delete(t),this._proxy.$unregisterUriOpener(t)})}async $canOpenUri(e,t,i){const n=this._openers.get(e);if(!n)throw new Error(`Unknown opener with id: ${e}`);const s=x.revive(t);return n.canOpenExternalUri(s,i)}async $openUri(e,t,i){const n=this._openers.get(e);if(!n)throw new Error(`Unknown opener id: '${e}'`);return n.openExternalUri(x.revive(t.resolvedUri),{sourceUri:x.revive(t.sourceUri)},i)}};jp.supportedSchemes=new Set([ne.http,ne.https]);let rw=jp;const qp=class qp{constructor(e){this.handles=new ko,this.handlers=new Map,this._proxy=e.getProxy(J.MainThreadUrls)}registerUriHandler(e,t){const i=e.identifier;if(this.handles.has(i))throw new Error(`Protocol handler already registered for extension ${i}`);const n=qp.HandlePool++;return this.handles.add(i),this.handlers.set(n,t),this._proxy.$registerUriHandler(n,i,e.displayName||e.name),De(()=>{this.handles.delete(i),this.handlers.delete(n),this._proxy.$unregisterUriHandler(n)})}$handleExternalUri(e,t){const i=this.handlers.get(e);if(!i)return Promise.resolve(void 0);try{i.handleUri(x.revive(t))}catch(n){nn(n)}return Promise.resolve(void 0)}async createAppUri(e){return x.revive(await this._proxy.$createAppUri(e))}};qp.HandlePool=0;let sw=qp;var kr,Dr,Ju,Sa,Ku,Qs,Ea,zn,ka,Da,Ir,Ia,Pa;class n3 extends Fe{constructor(t,i,n,s){super();ue(this,kr,void 0);ue(this,Dr,void 0);ue(this,Ju,void 0);ue(this,Sa,void 0);ue(this,Ku,void 0);ue(this,Qs,void 0);ue(this,Ea,void 0);ue(this,zn,void 0);ue(this,ka,void 0);ue(this,Da,void 0);ue(this,Ir,void 0);ue(this,Ia,void 0);ue(this,Pa,void 0);K(this,zn,void 0),K(this,ka,!0),K(this,Ir,!1),K(this,Ia,this._register(new R)),this.onDidDispose=P(this,Ia).event,K(this,Pa,this._register(new R)),this.onDidChangeViewState=P(this,Pa).event,K(this,kr,t),K(this,Dr,i),K(this,Sa,n),K(this,Ju,s.viewType),K(this,Ku,s.panelOptions),K(this,zn,s.viewColumn),K(this,Qs,s.title),K(this,Da,s.active)}dispose(){P(this,Ir)||(K(this,Ir,!0),P(this,Ia).fire(),P(this,Dr).$disposeWebview(P(this,kr)),P(this,Sa).dispose(),super.dispose())}get webview(){return this.assertNotDisposed(),P(this,Sa)}get viewType(){return this.assertNotDisposed(),P(this,Ju)}get title(){return this.assertNotDisposed(),P(this,Qs)}set title(t){this.assertNotDisposed(),P(this,Qs)!==t&&(K(this,Qs,t),P(this,Dr).$setTitle(P(this,kr),t))}get iconPath(){return this.assertNotDisposed(),P(this,Ea)}set iconPath(t){this.assertNotDisposed(),P(this,Ea)!==t&&(K(this,Ea,t),P(this,Dr).$setIconPath(P(this,kr),x.isUri(t)?{light:t,dark:t}:t))}get options(){return P(this,Ku)}get viewColumn(){if(this.assertNotDisposed(),!(typeof P(this,zn)=="number"&&P(this,zn)<0))return P(this,zn)}get active(){return this.assertNotDisposed(),P(this,Da)}get visible(){return this.assertNotDisposed(),P(this,ka)}_updateViewState(t){P(this,Ir)||(this.active!==t.active||this.visible!==t.visible||this.viewColumn!==t.viewColumn)&&(K(this,Da,t.active),K(this,ka,t.visible),K(this,zn,t.viewColumn),P(this,Pa).fire({webviewPanel:this}))}reveal(t,i){this.assertNotDisposed(),P(this,Dr).$reveal(P(this,kr),{viewColumn:typeof t>"u"?void 0:Et.from(t),preserveFocus:!!i})}assertNotDisposed(){if(P(this,Ir))throw new Error("Webview is disposed")}}kr=new WeakMap,Dr=new WeakMap,Ju=new WeakMap,Sa=new WeakMap,Ku=new WeakMap,Qs=new WeakMap,Ea=new WeakMap,zn=new WeakMap,ka=new WeakMap,Da=new WeakMap,Ir=new WeakMap,Ia=new WeakMap,Pa=new WeakMap;class h0 extends Fe{static newHandle(){return ar()}constructor(e,t,i){super(),this.webviews=t,this.workspace=i,this._webviewPanels=new Map,this._serializers=new Map,this._proxy=e.getProxy(J.MainThreadWebviewPanels)}dispose(){super.dispose(),this._webviewPanels.forEach(e=>e.dispose()),this._webviewPanels.clear()}createWebviewPanel(e,t,i,n,s={}){const o=typeof n=="object"?n.viewColumn:n,a={viewColumn:Et.from(o),preserveFocus:typeof n=="object"&&!!n.preserveFocus},c=dc(e),l=h0.newHandle();this._proxy.$createWebviewPanel(dp(e),l,t,{title:i,panelOptions:r3(s),webviewOptions:AS(e,this.workspace,s),serializeBuffersForPostMessage:c},a);const u=this.webviews.createNewWebview(l,s,e);return this.createNewWebviewPanel(l,t,i,o,s,u,!0)}$onDidChangeWebviewPanelViewStates(e){const t=Object.keys(e);t.sort((i,n)=>{const s=e[i],o=e[n];return s.active?1:o.active?-1:+s.visible-+o.visible});for(const i of t){const n=this.getWebviewPanel(i);if(!n)continue;const s=e[i];n._updateViewState({active:s.active,visible:s.visible,viewColumn:Et.to(s.position)})}}async $onDidDisposeWebviewPanel(e){const t=this.getWebviewPanel(e);t==null||t.dispose(),this._webviewPanels.delete(e),this.webviews.deleteWebview(e)}registerWebviewPanelSerializer(e,t,i){if(this._serializers.has(t))throw new Error(`Serializer for '${t}' already registered`);return this._serializers.set(t,{serializer:i,extension:e}),this._proxy.$registerSerializer(t,{serializeBuffersForPostMessage:dc(e)}),new Ne(()=>{this._serializers.delete(t),this._proxy.$unregisterSerializer(t)})}async $deserializeWebviewPanel(e,t,i,n){const s=this._serializers.get(t);if(!s)throw new Error(`No serializer found for '${t}'`);const{serializer:o,extension:a}=s,c=this.webviews.createNewWebview(e,i.webviewOptions,a),l=this.createNewWebviewPanel(e,t,i.title,n,i.panelOptions,c,i.active);await o.deserializeWebviewPanel(l,i.state)}createNewWebviewPanel(e,t,i,n,s,o,a){const c=new n3(e,this._proxy,o,{viewType:t,title:i,viewColumn:n,panelOptions:s,active:a});return this._webviewPanels.set(e,c),c}getWebviewPanel(e){return this._webviewPanels.get(e)}}function r3(r){return{enableFindWidget:r.enableFindWidget,retainContextWhenHidden:r.retainContextWhenHidden}}var Pr,Tr,Xu,Ta,Ar,Js,Ks,Aa,Xs,Ra,La;class s3 extends Fe{constructor(t,i,n,s,o,a){super();ue(this,Pr,void 0);ue(this,Tr,void 0);ue(this,Xu,void 0);ue(this,Ta,void 0);ue(this,Ar,void 0);ue(this,Js,void 0);ue(this,Ks,void 0);ue(this,Aa,void 0);ue(this,Xs,void 0);ue(this,Ra,void 0);ue(this,La,void 0);K(this,Ar,!1),K(this,Ra,this._register(new R)),this.onDidChangeVisibility=P(this,Ra).event,K(this,La,this._register(new R)),this.onDidDispose=P(this,La).event,K(this,Xu,n),K(this,Ks,s),K(this,Pr,t),K(this,Tr,i),K(this,Ta,o),K(this,Js,a)}dispose(){P(this,Ar)||(K(this,Ar,!0),P(this,La).fire(),P(this,Ta).dispose(),super.dispose())}get title(){return this.assertNotDisposed(),P(this,Ks)}set title(t){this.assertNotDisposed(),P(this,Ks)!==t&&(K(this,Ks,t),P(this,Tr).$setWebviewViewTitle(P(this,Pr),t))}get description(){return this.assertNotDisposed(),P(this,Aa)}set description(t){this.assertNotDisposed(),P(this,Aa)!==t&&(K(this,Aa,t),P(this,Tr).$setWebviewViewDescription(P(this,Pr),t))}get visible(){return P(this,Js)}get webview(){return P(this,Ta)}get viewType(){return P(this,Xu)}_setVisible(t){t===P(this,Js)||P(this,Ar)||(K(this,Js,t),P(this,Ra).fire())}get badge(){return this.assertNotDisposed(),P(this,Xs)}set badge(t){var i,n;this.assertNotDisposed(),!((t==null?void 0:t.value)===((i=P(this,Xs))==null?void 0:i.value)&&(t==null?void 0:t.tooltip)===((n=P(this,Xs))==null?void 0:n.tooltip))&&(K(this,Xs,zf.from(t)),P(this,Tr).$setWebviewViewBadge(P(this,Pr),t))}show(t){this.assertNotDisposed(),P(this,Tr).$show(P(this,Pr),!!t)}assertNotDisposed(){if(P(this,Ar))throw new Error("Webview is disposed")}}Pr=new WeakMap,Tr=new WeakMap,Xu=new WeakMap,Ta=new WeakMap,Ar=new WeakMap,Js=new WeakMap,Ks=new WeakMap,Aa=new WeakMap,Xs=new WeakMap,Ra=new WeakMap,La=new WeakMap;class o3{constructor(e,t){this._extHostWebview=t,this._viewProviders=new Map,this._webviewViews=new Map,this._proxy=e.getProxy(J.MainThreadWebviewViews)}registerWebviewViewProvider(e,t,i,n){if(this._viewProviders.has(t))throw new Error(`View provider for '${t}' already registered`);return this._viewProviders.set(t,{provider:i,extension:e}),this._proxy.$registerWebviewViewProvider(dp(e),t,{retainContextWhenHidden:n==null?void 0:n.retainContextWhenHidden,serializeBuffersForPostMessage:dc(e)}),new Ne(()=>{this._viewProviders.delete(t),this._proxy.$unregisterWebviewViewProvider(t)})}async $resolveWebviewView(e,t,i,n,s){const o=this._viewProviders.get(t);if(!o)throw new Error(`No view provider found for '${t}'`);const{provider:a,extension:c}=o,l=this._extHostWebview.createNewWebview(e,{},c),u=new s3(e,this._proxy,t,i,l,!0);this._webviewViews.set(e,u),await a.resolveWebviewView(u,{state:n},s)}async $onDidChangeWebviewViewVisibility(e,t){this.getWebviewView(e)._setVisible(t)}async $disposeWebviewView(e){const t=this.getWebviewView(e);this._webviewViews.delete(e),t.dispose(),this._extHostWebview.deleteWebview(e)}getWebviewView(e){const t=this._webviewViews.get(e);if(!t)throw new Error("No webview found");return t}}const he="vs/workbench/contrib/debug/common/debug";new G("debugType",void 0,{type:"string",description:h(he,0,"Debug type of the active debug session. For example 'python'.")});new G("debugConfigurationType",void 0,{type:"string",description:h(he,1,"Debug type of the selected launch configuration. For example 'python'.")});new G("debugState","inactive",{type:"string",description:h(he,2,"State that the focused debug session is in. One of the following: 'inactive', 'initializing', 'stopped' or 'running'.")});const a3="debugUx";new G(a3,"default",{type:"string",description:h(he,3,"Debug UX state. When there are no debug configurations it is 'simple', otherwise 'default'. Used to decide when to show welcome views in the debug viewlet.")});new G("hasDebugged",!1,{type:"boolean",description:h(he,4,"True when a debug session has been started at least once, false otherwise.")});new G("inDebugMode",!1,{type:"boolean",description:h(he,5,"True when debugging, false otherwise.")});new G("inDebugRepl",!1,{type:"boolean",description:h(he,6,"True when focus is in the debug console, false otherwise.")});new G("breakpointWidgetVisible",!1,{type:"boolean",description:h(he,7,"True when breakpoint editor zone widget is visible, false otherwise.")});new G("inBreakpointWidget",!1,{type:"boolean",description:h(he,8,"True when focus is in the breakpoint editor zone widget, false otherwise.")});new G("breakpointsFocused",!0,{type:"boolean",description:h(he,9,"True when the BREAKPOINTS view is focused, false otherwise.")});new G("watchExpressionsFocused",!0,{type:"boolean",description:h(he,10,"True when the WATCH view is focused, false otherwsie.")});new G("watchExpressionsExist",!1,{type:"boolean",description:h(he,11,"True when at least one watch expression exists, false otherwise.")});new G("variablesFocused",!0,{type:"boolean",description:h(he,12,"True when the VARIABLES views is focused, false otherwsie")});new G("expressionSelected",!1,{type:"boolean",description:h(he,13,"True when an expression input box is open in either the WATCH or the VARIABLES view, false otherwise.")});new G("breakpointInputFocused",!1,{type:"boolean",description:h(he,14,"True when the input box has focus in the BREAKPOINTS view.")});new G("callStackItemType",void 0,{type:"string",description:h(he,15,"Represents the item type of the focused element in the CALL STACK view. For example: 'session', 'thread', 'stackFrame'")});new G("callStackSessionIsAttach",!1,{type:"boolean",description:h(he,16,"True when the session in the CALL STACK view is attach, false otherwise. Used internally for inline menus in the CALL STACK view.")});new G("callStackItemStopped",!1,{type:"boolean",description:h(he,17,"True when the focused item in the CALL STACK is stopped. Used internaly for inline menus in the CALL STACK view.")});new G("callStackSessionHasOneThread",!1,{type:"boolean",description:h(he,18,"True when the focused session in the CALL STACK view has exactly one thread. Used internally for inline menus in the CALL STACK view.")});new G("watchItemType",void 0,{type:"string",description:h(he,19,"Represents the item type of the focused element in the WATCH view. For example: 'expression', 'variable'")});new G("canViewMemory",void 0,{type:"boolean",description:h(he,20,"Indicates whether the item in the view has an associated memory refrence.")});new G("breakpointItemType",void 0,{type:"string",description:h(he,21,"Represents the item type of the focused element in the BREAKPOINTS view. For example: 'breakpoint', 'exceptionBreakppint', 'functionBreakpoint', 'dataBreakpoint'")});new G("breakpointItemBytes",void 0,{type:"boolean",description:h(he,22,"Whether the breakpoint item is a data breakpoint on a byte range.")});new G("breakpointHasModes",!1,{type:"boolean",description:h(he,23,"Whether the breakpoint has multiple modes it can switch to.")});new G("breakpointSupportsCondition",!1,{type:"boolean",description:h(he,24,"True when the focused breakpoint supports conditions.")});new G("loadedScriptsSupported",!1,{type:"boolean",description:h(he,25,"True when the focused sessions supports the LOADED SCRIPTS view")});new G("loadedScriptsItemType",void 0,{type:"string",description:h(he,26,"Represents the item type of the focused element in the LOADED SCRIPTS view.")});new G("focusedSessionIsAttach",!1,{type:"boolean",description:h(he,27,"True when the focused session is 'attach'.")});new G("focusedSessionIsNoDebug",!1,{type:"boolean",description:h(he,28,"True when the focused session is run without debugging.")});new G("stepBackSupported",!1,{type:"boolean",description:h(he,29,"True when the focused session supports 'stepBack' requests.")});new G("restartFrameSupported",!1,{type:"boolean",description:h(he,30,"True when the focused session supports 'restartFrame' requests.")});new G("stackFrameSupportsRestart",!1,{type:"boolean",description:h(he,31,"True when the focused stack frame suppots 'restartFrame'.")});new G("jumpToCursorSupported",!1,{type:"boolean",description:h(he,32,"True when the focused session supports 'jumpToCursor' request.")});new G("stepIntoTargetsSupported",!1,{type:"boolean",description:h(he,33,"True when the focused session supports 'stepIntoTargets' request.")});new G("breakpointsExist",!1,{type:"boolean",description:h(he,34,"True when at least one breakpoint exists.")});new G("debuggersAvailable",!1,{type:"boolean",description:h(he,35,"True when there is at least one debug extensions active.")});new G("debugExtensionAvailable",!0,{type:"boolean",description:h(he,36,"True when there is at least one debug extension installed and enabled.")});new G("debugProtocolVariableMenuContext",void 0,{type:"string",description:h(he,37,"Represents the context the debug adapter sets on the focused variable in the VARIABLES view.")});new G("debugSetVariableSupported",!1,{type:"boolean",description:h(he,38,"True when the focused session supports 'setVariable' request.")});new G("debugSetDataBreakpointAddressSupported",!1,{type:"boolean",description:h(he,39,"True when the focused session supports 'getBreakpointInfo' request on an address.")});new G("debugSetExpressionSupported",!1,{type:"boolean",description:h(he,40,"True when the focused session supports 'setExpression' request.")});new G("breakWhenValueChangesSupported",!1,{type:"boolean",description:h(he,41,"True when the focused session supports to break when value changes.")});new G("breakWhenValueIsAccessedSupported",!1,{type:"boolean",description:h(he,42,"True when the focused breakpoint supports to break when value is accessed.")});new G("breakWhenValueIsReadSupported",!1,{type:"boolean",description:h(he,43,"True when the focused breakpoint supports to break when value is read.")});new G("terminateDebuggeeSupported",!1,{type:"boolean",description:h(he,44,"True when the focused session supports the terminate debuggee capability.")});new G("suspendDebuggeeSupported",!1,{type:"boolean",description:h(he,45,"True when the focused session supports the suspend debuggee capability.")});new G("variableEvaluateNamePresent",!1,{type:"boolean",description:h(he,46,"True when the focused variable has an 'evalauteName' field set.")});new G("variableIsReadonly",!1,{type:"boolean",description:h(he,47,"True when the focused variable is read-only.")});new G("variableValue",!1,{type:"string",description:h(he,48,"Value of the variable, present for debug visualization clauses.")});new G("variableType",!1,{type:"string",description:h(he,49,"Type of the variable, present for debug visualization clauses.")});new G("variableInterfaces",!1,{type:"array",description:h(he,50,"Any interfaces or contracts that the variable satisfies, present for debug visualization clauses.")});new G("variableName",!1,{type:"string",description:h(he,51,"Name of the variable, present for debug visualization clauses.")});new G("variableLanguage",!1,{type:"string",description:h(he,52,"Language of the variable source, present for debug visualization clauses.")});new G("variableExtensionId",!1,{type:"string",description:h(he,53,"Extension ID of the variable source, present for debug visualization clauses.")});new G("exceptionWidgetVisible",!1,{type:"boolean",description:h(he,54,"True when the exception widget is visible.")});new G("multiSessionRepl",!1,{type:"boolean",description:h(he,55,"True when there is more than 1 debug console.")});new G("multiSessionDebug",!1,{type:"boolean",description:h(he,56,"True when there is more than 1 active debug session.")});new G("disassembleRequestSupported",!1,{type:"boolean",description:h(he,57,"True when the focused sessions supports disassemble request.")});new G("disassemblyViewFocus",!1,{type:"boolean",description:h(he,58,"True when the Disassembly View is focused.")});new G("languageSupportsDisassembleRequest",!1,{type:"boolean",description:h(he,59,"True when the language in the current editor supports disassemble request.")});new G("focusedStackFrameHasInstructionReference",!1,{type:"boolean",description:h(he,60,"True when the focused stack frame has instruction pointer reference.")});h(he,62,"Controls when the internal Debug Console should open.");var _p;(function(r){r[r.Initial=1]="Initial",r[r.Dynamic=2]="Dynamic"})(_p||(_p={}));var Z2;(function(r){r.UnverifiedBreakpoints="unverifiedBreakpoints"})(Z2||(Z2={}));var Y2;(function(r){r.deserialize=e=>({id:e.id,name:e.name,iconPath:e.iconPath&&{light:x.revive(e.iconPath.light),dark:x.revive(e.iconPath.dark)},iconClass:e.iconClass,visualization:e.visualization}),r.serialize=e=>e})(Y2||(Y2={}));function c3(r){const e=r.get(jt),t=r.get(xc),i=r.get(ug),n=r.get(ns),s=r.get(cr),o=r.get(dg),a=r.get(lr),c=r.get(Jp),l=r.get(Ve),u=r.get(Gw),d=r.get(Qw),f=r.get(yc),m=r.get(Je),b=r.get(Kw),_=r.get(fg),v=r.get(xS),k=r.get(e0),D=r.get(dd),E=r.get(i0),N=r.get(Zw),A=r.get(Yw);l.set(se.ExtHostFileSystemInfo,t),l.set(se.ExtHostLogLevelServiceShape,f),l.set(se.ExtHostWorkspace,s),l.set(se.ExtHostConfiguration,a),l.set(se.ExtHostExtensionService,n),l.set(se.ExtHostStorage,u),l.set(se.ExtHostTunnelService,b),l.set(se.ExtHostWindow,v),l.set(se.ExtHostSecretState,k),l.set(se.ExtHostTelemetry,o),l.set(se.ExtHostEditorTabs,D),l.set(se.ExtHostManagedSockets,E),l.set(se.ExtHostAuthentication,N),l.set(se.ExtHostChatProvider,A);const j=l.set(se.ExtHostDecorations,r.get(dS)),re=l.set(se.ExtHostDocumentsAndEditors,r.get(ud)),te=l.set(se.ExtHostCommands,r.get(Ec)),q=l.set(se.ExtHostTerminalService,r.get(kc)),We=l.set(se.ExtHostTerminalShellIntegration,r.get(CS)),V=l.set(se.ExtHostDebugService,r.get(bS)),B=l.set(se.ExtHostSearch,r.get(yS)),Q=l.set(se.ExtHostTask,r.get(_S)),Y=l.set(se.ExtHostOutputService,r.get(uS)),ie=l.set(se.ExtHostLocalization,r.get(t0)),me=l.set(se.ExtHostUrls,new sw(l)),ge=l.set(se.ExtHostDocuments,new HP(l,re)),tt=l.set(se.ExtHostDocumentContentProviders,new $_(l,re,m)),nt=l.set(se.ExtHostDocumentSaveParticipant,new OP(m,ge,l.getProxy(J.MainThreadBulkEdits))),He=l.set(se.ExtHostNotebook,new V_(l,te,re,ge,i,B)),Ot=l.set(se.ExtHostNotebookDocuments,new bT(He)),gt=l.set(se.ExtHostNotebookEditors,new W_(m,He)),Zt=l.set(se.ExtHostNotebookKernels,new z_(l,e,He,te,m)),_t=l.set(se.ExtHostNotebookRenderers,new CT(l,He)),_i=l.set(se.ExtHostNotebookDocumentSaveParticipant,new wT(m,He,l.getProxy(J.MainThreadBulkEdits))),rt=l.set(se.ExtHostEditors,new qT(l,re)),kn=l.set(se.ExtHostTreeViews,new i3(l.getProxy(J.MainThreadTreeViews),te,m)),Dn=l.set(se.ExtHostEditorInsets,new mP(l.getProxy(J.MainThreadEditorInsets),rt,e.remote)),Io=l.set(se.ExtHostDiagnostics,new L_(l,m,t,re)),rs=l.set(se.ExtHostLanguages,new ZP(l,ge,te.converter,c)),Ie=l.set(se.ExtHostLanguageFeatures,new F_(l,c,ge,te,Io,m,_,o)),pd=l.set(se.ExtHostFileSystem,new pp(l,Ie)),Yt=l.set(se.ExtHostFileSystemEventService,new GP(l,m,re)),wi=l.set(se.ExtHostQuickOpen,IT(l,s,te)),gd=l.set(se.ExtHostSCM,new X_(l,te,ge,m)),_g=l.set(se.ExtHostQuickDiff,new Q_(l,c)),ze=l.set(se.ExtHostShare,new Z_(l,c)),wg=l.set(se.ExtHostComments,vP(l,te,ge)),md=l.set(se.ExtHostProgress,new kT(l.getProxy(J.MainThreadProgress))),vd=l.set(se.ExtHostLabelService,new KP(l)),In=l.set(se.ExtHostTheming,new iw(l)),bg=l.set(se.ExtHostTimeline,new GT(l,te)),Ic=l.set(se.ExtHostWebviews,new kP(l,e.remote,s,m,_)),Pc=l.set(se.ExtHostWebviewPanels,new h0(l,Ic,s)),yg=l.set(se.ExtHostCustomEditors,new RP(l,ge,d,Ic,Pc)),Ui=l.set(se.ExtHostWebviewViews,new o3(l,Ic)),ss=l.set(se.ExtHostTesting,new tw(l,m,te,re)),xg=l.set(se.ExtHostUriOpeners,new rw(l)),Cg=l.set(se.ExtHostProfileContentHandlers,new ST(l));l.set(se.ExtHostInteractive,new JP(l,He,re,te,m));const Sg=l.set(se.ExtHostInlineChat,new M_(l,te,ge,m)),ur=l.set(se.ExtHostChatAgents2,new T_(l,m,te)),Po=l.set(se.ExtHostChatVariables,new A_(l)),To=l.set(se.ExtHostAiRelatedInformation,new sP(l)),_d=l.set(se.ExtHostAiEmbeddingVector,new UP(l)),Ao=l.set(se.ExtHostStatusBar,new HT(l,te.converter)),Tc=l.set(se.ExtHostSpeech,new Y_(l)),Ro=Object.values(se);l.assertRegistered(Ro);const li=new P_(l,re),os=new fP(l),lt=new O_(l,m),wd=new FP(l);return uP.register(te),function(I,pt,bd){function le(g){return(w,C,W)=>{const ce=g(Ze=>{try{w.call(C,Ze)}catch(Gt){hw(new Error(`[ExtensionListenerError] Extension '${I.identifier.value}' FAILED to handle event: ${Gt.toString()}`,{cause:Gt})),o.onExtensionError(I.identifier,Gt)}});return W==null||W.push(ce),ce}}const je=function(){let g=!I.isUnderDevelopment;function w(){g||(m.info(`Extension '${I.identifier.value}' uses a document selector without scheme. Learn more about this: https://go.microsoft.com/fwlink/?linkid=872305`),g=!0)}return function C(W){if(Array.isArray(W))W.forEach(C);else if(typeof W=="string")w();else{const ce=W;typeof ce.scheme>"u"&&w(),typeof ce.exclusive=="boolean"&&O(I,"documentFiltersExclusive")}return W}}(),Eg={getSession(g,w,C){return typeof(C==null?void 0:C.forceNewSession)=="object"&&C.forceNewSession.learnMore&&O(I,"authLearnMore"),N.getSession(I,g,w,C)},getSessions(g,w){return O(I,"authGetSessions"),N.getSessions(I,g,w)},async hasSession(g,w){return O(I,"authSession"),!!await N.getSession(I,g,w,{silent:!0})},get onDidChangeSessions(){return le(N.onDidChangeSessions)},registerAuthenticationProvider(g,w,C,W){return N.registerAuthenticationProvider(g,w,C,W)}},kg={registerCommand(g,w,C){return te.registerCommand(!0,g,w,C,void 0,I)},registerTextEditorCommand(g,w,C){return te.registerCommand(!0,g,(...W)=>{const ce=rt.getActiveTextEditor();if(!ce){m.warn("Cannot execute "+g+" because there is no active text editor.");return}return ce.edit(Ze=>{w.apply(C,[ce,Ze,...W])}).then(Ze=>{Ze||m.warn("Edits from command "+g+" were not applied.")},Ze=>{m.warn("An error occurred while running command "+g,Ze)})},void 0,void 0,I)},registerDiffInformationCommand:(g,w,C)=>(O(I,"diffCommand"),te.registerCommand(!0,g,async(...W)=>{const ce=re.activeEditor(!0);if(!ce){m.warn("Cannot execute "+g+" because there is no active text editor.");return}const Ze=await rt.getDiffInformation(ce.id);w.apply(C,[Ze,...W])},void 0,void 0,I)),executeCommand(g,...w){return te.executeCommand(g,...w)},getCommands(g=!1){return te.getCommands(g)}},Dg={get machineId(){return e.telemetryInfo.machineId},get sessionId(){return e.telemetryInfo.sessionId},get language(){return e.environment.appLanguage},get appName(){return e.environment.appName},get appRoot(){var g;return((g=e.environment.appRoot)==null?void 0:g.fsPath)??""},get appHost(){return e.environment.appHost},get uriScheme(){return e.environment.appUriScheme},get clipboard(){return os.value},get shell(){return q.getDefaultShell(!1)},get onDidChangeShell(){return le(q.onDidChangeShell)},get isTelemetryEnabled(){return o.getTelemetryConfiguration()},get onDidChangeTelemetryEnabled(){return le(o.onDidChangeTelemetryEnabled)},get telemetryConfiguration(){return O(I,"telemetry"),o.getTelemetryDetails()},get onDidChangeTelemetryConfiguration(){return O(I,"telemetry"),le(o.onDidChangeTelemetryConfiguration)},get isNewAppInstall(){return eS(e.telemetryInfo.firstSessionDate)},createTelemetryLogger(g,w){return YC.validateSender(g),o.instantiateLogger(I,g,w)},openExternal(g,w){return v.openUri(g,{allowTunneling:!!e.remote.authority,allowContributedOpeners:w==null?void 0:w.allowContributedOpeners})},async asExternalUri(g){if(g.scheme===e.environment.appUriScheme)return me.createAppUri(g);try{return await v.asExternalUri(g,{allowTunneling:!!e.remote.authority})}catch(w){if($m(g,ne.http)||$m(g,ne.https))return g;throw w}},get remoteName(){return Nw(e.remote.authority)},get remoteAuthority(){return O(I,"resolvers"),e.remote.authority},get uiKind(){return e.uiKind},get logLevel(){return m.getLevel()},get onDidChangeLogLevel(){return le(m.onDidChangeLogLevel)},get appQuality(){return O(I,"resolvers"),e.quality},get appCommit(){return O(I,"resolvers"),e.commit}},Ig={createTestController(g,w,C){return ss.createTestController(I,g,w,C)},createTestObserver(){return O(I,"testObserver"),ss.createTestObserver()},runTests(g){return O(I,"testObserver"),ss.runTests(g)},get onDidChangeTestResults(){return O(I,"testObserver"),le(ss.onResultsChanged)},get testResults(){return O(I,"testObserver"),ss.results}},Lo=e.remote.isRemote?ro.Workspace:ro.UI,Pg={getExtension(g,w){Lt(I,"extensionsAny")||(w=!1);const C=pt.mine.getExtensionDescription(g);if(C)return new Xc(n,I.identifier,C,Lo,!1);if(w){const W=pt.all.getExtensionDescription(g);if(W)return new Xc(n,I.identifier,W,Lo,!0)}},get all(){const g=[];for(const w of pt.mine.getAllExtensionDescriptions())g.push(new Xc(n,I.identifier,w,Lo,!1));return g},get allAcrossExtensionHosts(){O(I,"extensionsAny");const g=new ko(pt.mine.getAllExtensionDescriptions().map(C=>C.identifier)),w=[];for(const C of pt.all.getAllExtensionDescriptions()){const W=!g.has(C.identifier);w.push(new Xc(n,I.identifier,C,Lo,W))}return w},get onDidChange(){return Lt(I,"extensionsAny")?le(It.any(pt.mine.onDidChange,pt.all.onDidChange)):le(pt.mine.onDidChange)}},$o={createDiagnosticCollection(g){return Io.createDiagnosticCollection(I.identifier,g)},get onDidChangeDiagnostics(){return le(Io.onDidChangeDiagnostics)},getDiagnostics:g=>Io.getDiagnostics(g),getLanguages(){return rs.getLanguages()},setTextDocumentLanguage(g,w){return rs.changeLanguage(g.uri,w)},match(g,w){var ce;const C=lv.from(g);let W;return ES(C)&&(W=(ce=He.notebookDocuments.find(Ze=>Ze.apiNotebook.getCells().find(Gt=>Gt.document===w)))==null?void 0:ce.apiNotebook),SS(C,w.uri,w.languageId,!0,W==null?void 0:W.uri,W==null?void 0:W.notebookType)},registerCodeActionsProvider(g,w,C){return Ie.registerCodeActionProvider(I,je(g),w,C)},registerDocumentPasteEditProvider(g,w,C){return O(I,"documentPaste"),Ie.registerDocumentPasteEditProvider(I,je(g),w,C)},registerCodeLensProvider(g,w){return Ie.registerCodeLensProvider(I,je(g),w)},registerDefinitionProvider(g,w){return Ie.registerDefinitionProvider(I,je(g),w)},registerDeclarationProvider(g,w){return Ie.registerDeclarationProvider(I,je(g),w)},registerImplementationProvider(g,w){return Ie.registerImplementationProvider(I,je(g),w)},registerTypeDefinitionProvider(g,w){return Ie.registerTypeDefinitionProvider(I,je(g),w)},registerHoverProvider(g,w){return Ie.registerHoverProvider(I,je(g),w,I.identifier)},registerEvaluatableExpressionProvider(g,w){return Ie.registerEvaluatableExpressionProvider(I,je(g),w,I.identifier)},registerInlineValuesProvider(g,w){return Ie.registerInlineValuesProvider(I,je(g),w,I.identifier)},registerDocumentHighlightProvider(g,w){return Ie.registerDocumentHighlightProvider(I,je(g),w)},registerMultiDocumentHighlightProvider(g,w){return Ie.registerMultiDocumentHighlightProvider(I,je(g),w)},registerLinkedEditingRangeProvider(g,w){return Ie.registerLinkedEditingRangeProvider(I,je(g),w)},registerReferenceProvider(g,w){return Ie.registerReferenceProvider(I,je(g),w)},registerRenameProvider(g,w){return Ie.registerRenameProvider(I,je(g),w)},registerNewSymbolNamesProvider(g,w){return O(I,"newSymbolNamesProvider"),Ie.registerNewSymbolNamesProvider(I,je(g),w)},registerDocumentSymbolProvider(g,w,C){return Ie.registerDocumentSymbolProvider(I,je(g),w,C)},registerWorkspaceSymbolProvider(g){return Ie.registerWorkspaceSymbolProvider(I,g)},registerDocumentFormattingEditProvider(g,w){return Ie.registerDocumentFormattingEditProvider(I,je(g),w)},registerDocumentRangeFormattingEditProvider(g,w){return Ie.registerDocumentRangeFormattingEditProvider(I,je(g),w)},registerOnTypeFormattingEditProvider(g,w,C,...W){return Ie.registerOnTypeFormattingEditProvider(I,je(g),w,[C].concat(W))},registerDocumentSemanticTokensProvider(g,w,C){return Ie.registerDocumentSemanticTokensProvider(I,je(g),w,C)},registerDocumentRangeSemanticTokensProvider(g,w,C){return Ie.registerDocumentRangeSemanticTokensProvider(I,je(g),w,C)},registerSignatureHelpProvider(g,w,C,...W){return typeof C=="object"?Ie.registerSignatureHelpProvider(I,je(g),w,C):Ie.registerSignatureHelpProvider(I,je(g),w,typeof C>"u"?[]:[C,...W])},registerCompletionItemProvider(g,w,...C){return Ie.registerCompletionItemProvider(I,je(g),w,C)},registerInlineCompletionItemProvider(g,w,C){return w.handleDidShowCompletionItem&&O(I,"inlineCompletionsAdditions"),w.handleDidPartiallyAcceptCompletionItem&&O(I,"inlineCompletionsAdditions"),C&&O(I,"inlineCompletionsAdditions"),Ie.registerInlineCompletionsProvider(I,je(g),w,C)},registerInlineEditProvider(g,w){return O(I,"inlineEdit"),Ie.registerInlineEditProvider(I,je(g),w)},registerDocumentLinkProvider(g,w){return Ie.registerDocumentLinkProvider(I,je(g),w)},registerColorProvider(g,w){return Ie.registerColorProvider(I,je(g),w)},registerFoldingRangeProvider(g,w){return Ie.registerFoldingRangeProvider(I,je(g),w)},registerSelectionRangeProvider(g,w){return Ie.registerSelectionRangeProvider(I,g,w)},registerCallHierarchyProvider(g,w){return Ie.registerCallHierarchyProvider(I,g,w)},registerTypeHierarchyProvider(g,w){return Ie.registerTypeHierarchyProvider(I,g,w)},setLanguageConfiguration:(g,w)=>Ie.setLanguageConfiguration(I,g,w),getTokenInformationAtPosition(g,w){return O(I,"tokenInformation"),rs.tokenAtPosition(g,w)},registerInlayHintsProvider(g,w){return Ie.registerInlayHintsProvider(I,g,w)},createLanguageStatusItem(g,w){return rs.createLanguageStatusItem(I,g,w)},registerDocumentDropEditProvider(g,w,C){return Ie.registerDocumentOnDropEditProvider(I,g,w,Lt(I,"documentPaste")?C:void 0)}},Tg={get activeTextEditor(){return rt.getActiveTextEditor()},get visibleTextEditors(){return rt.getVisibleTextEditors()},get activeTerminal(){return q.activeTerminal},get terminals(){return q.terminals},async showTextDocument(g,w,C){x.isUri(g)&&g.scheme===ne.vscodeRemote&&!g.authority&&_.report("workspace.showTextDocument",I,"A URI of 'vscode-remote' scheme requires an authority.");const W=await(x.isUri(g)?Promise.resolve(yd.openTextDocument(g)):Promise.resolve(g));return rt.showTextDocument(W,w,C)},createTextEditorDecorationType(g){return rt.createTextEditorDecorationType(I,g)},onDidChangeActiveTextEditor(g,w,C){return le(rt.onDidChangeActiveTextEditor)(g,w,C)},onDidChangeVisibleTextEditors(g,w,C){return le(rt.onDidChangeVisibleTextEditors)(g,w,C)},onDidChangeTextEditorSelection(g,w,C){return le(rt.onDidChangeTextEditorSelection)(g,w,C)},onDidChangeTextEditorOptions(g,w,C){return le(rt.onDidChangeTextEditorOptions)(g,w,C)},onDidChangeTextEditorVisibleRanges(g,w,C){return le(rt.onDidChangeTextEditorVisibleRanges)(g,w,C)},onDidChangeTextEditorViewColumn(g,w,C){return le(rt.onDidChangeTextEditorViewColumn)(g,w,C)},onDidCloseTerminal(g,w,C){return le(q.onDidCloseTerminal)(g,w,C)},onDidOpenTerminal(g,w,C){return le(q.onDidOpenTerminal)(g,w,C)},onDidChangeActiveTerminal(g,w,C){return le(q.onDidChangeActiveTerminal)(g,w,C)},onDidChangeTerminalDimensions(g,w,C){return O(I,"terminalDimensions"),le(q.onDidChangeTerminalDimensions)(g,w,C)},onDidChangeTerminalState(g,w,C){return le(q.onDidChangeTerminalState)(g,w,C)},onDidWriteTerminalData(g,w,C){return O(I,"terminalDataWriteEvent"),le(q.onDidWriteTerminalData)(g,w,C)},onDidExecuteTerminalCommand(g,w,C){return O(I,"terminalExecuteCommandEvent"),le(q.onDidExecuteTerminalCommand)(g,w,C)},onDidChangeTerminalShellIntegration(g,w,C){return O(I,"terminalShellIntegration"),le(We.onDidChangeTerminalShellIntegration)(g,w,C)},onDidStartTerminalShellExecution(g,w,C){return O(I,"terminalShellIntegration"),le(We.onDidStartTerminalShellExecution)(g,w,C)},onDidEndTerminalShellExecution(g,w,C){return O(I,"terminalShellIntegration"),le(We.onDidEndTerminalShellExecution)(g,w,C)},get state(){return v.getState()},onDidChangeWindowState(g,w,C){return le(v.onDidChangeWindowState)(g,w,C)},showInformationMessage(g,...w){return lt.showMessage(I,vt.Info,g,w[0],w.slice(1))},showWarningMessage(g,...w){return lt.showMessage(I,vt.Warning,g,w[0],w.slice(1))},showErrorMessage(g,...w){return lt.showMessage(I,vt.Error,g,w[0],w.slice(1))},showQuickPick(g,w,C){return wi.showQuickPick(I,g,w,C)},showWorkspaceFolderPick(g){return wi.showWorkspaceFolderPick(g)},showInputBox(g,w){return wi.showInput(g,w)},showOpenDialog(g){return wd.showOpenDialog(I,g)},showSaveDialog(g){return wd.showSaveDialog(g)},createStatusBarItem(g,w,C){let W,ce,Ze;return typeof g=="string"?(W=g,ce=w,Ze=C):(ce=g,Ze=w),Ao.createStatusBarEntry(I,W,ce,Ze)},setStatusBarMessage(g,w){return Ao.setStatusBarMessage(g,w)},withScmProgress(g){return _.report("window.withScmProgress",I,"Use 'withProgress' instead."),md.withProgress(I,{location:io.SourceControl},(w,C)=>g({report(W){}}))},withProgress(g,w){return md.withProgress(I,g,w)},createOutputChannel(g,w){return Y.createOutputChannel(g,w,I)},createWebviewPanel(g,w,C,W){return Pc.createWebviewPanel(I,g,w,C,W)},createWebviewTextEditorInset(g,w,C,W){return O(I,"editorInsets"),Dn.createWebviewEditorInset(g,w,C,W,I)},createTerminal(g,w,C){return typeof g=="object"?"pty"in g?q.createExtensionTerminal(g):q.createTerminalFromOptions(g):q.createTerminal(g,w,C)},registerTerminalLinkProvider(g){return q.registerLinkProvider(g)},registerTerminalProfileProvider(g,w){return q.registerProfileProvider(I,g,w)},registerTerminalQuickFixProvider(g,w){return O(I,"terminalQuickFixProvider"),q.registerTerminalQuickFixProvider(g,I.identifier.value,w)},registerTreeDataProvider(g,w){return kn.registerTreeDataProvider(g,w,I)},createTreeView(g,w){return kn.createTreeView(g,w,I)},registerWebviewPanelSerializer:(g,w)=>Pc.registerWebviewPanelSerializer(I,g,w),registerCustomEditorProvider:(g,w,C={})=>yg.registerCustomEditorProvider(I,g,w,C),registerFileDecorationProvider(g){return j.registerFileDecorationProvider(g,I)},registerUriHandler(g){return me.registerUriHandler(I,g)},createQuickPick(){return wi.createQuickPick(I)},createInputBox(){return wi.createInputBox(I)},get activeColorTheme(){return In.activeColorTheme},onDidChangeActiveColorTheme(g,w,C){return le(In.onDidChangeActiveColorTheme)(g,w,C)},registerWebviewViewProvider(g,w,C){return Ui.registerWebviewViewProvider(I,g,w,C==null?void 0:C.webviewOptions)},get activeNotebookEditor(){return He.activeNotebookEditor},onDidChangeActiveNotebookEditor(g,w,C){return le(He.onDidChangeActiveNotebookEditor)(g,w,C)},get visibleNotebookEditors(){return He.visibleNotebookEditors},get onDidChangeVisibleNotebookEditors(){return le(He.onDidChangeVisibleNotebookEditors)},onDidChangeNotebookEditorSelection(g,w,C){return le(gt.onDidChangeNotebookEditorSelection)(g,w,C)},onDidChangeNotebookEditorVisibleRanges(g,w,C){return le(gt.onDidChangeNotebookEditorVisibleRanges)(g,w,C)},showNotebookDocument(g,w){return He.showNotebookDocument(g,w)},registerExternalUriOpener(g,w,C){return O(I,"externalUriOpener"),xg.registerExternalUriOpener(I.identifier,g,w,C)},registerProfileContentHandler(g,w){return O(I,"profileContentHandlers"),Cg.registerProfileContentHandler(I,g,w)},registerQuickDiffProvider(g,w,C,W){return O(I,"quickDiffProvider"),_g.registerQuickDiffProvider(je(g),w,C,W)},get tabGroups(){return D.tabGroups},registerShareProvider(g,w){return O(I,"shareProvider"),ze.registerShareProvider(je(g),w)}},yd={get rootPath(){return _.report("workspace.rootPath",I,"Please use 'workspace.workspaceFolders' instead. More details: https://aka.ms/vscode-eliminating-rootpath"),s.getPath()},set rootPath(g){throw new Ss("rootPath")},getWorkspaceFolder(g){return s.getWorkspaceFolder(g)},get workspaceFolders(){return s.getWorkspaceFolders()},get name(){return s.name},set name(g){throw new Ss("name")},get workspaceFile(){return s.workspaceFile},set workspaceFile(g){throw new Ss("workspaceFile")},updateWorkspaceFolders:(g,w,...C)=>s.updateWorkspaceFolders(I,g,w||0,...C),onDidChangeWorkspaceFolders:function(g,w,C){return le(s.onDidChangeWorkspace)(g,w,C)},asRelativePath:(g,w)=>s.getRelativePath(g,w),findFiles:(g,w,C,W)=>s.findFiles(g,w,C,I.identifier,W),findFiles2:(g,w,C)=>(O(I,"findFiles2"),s.findFiles2(g,w,I.identifier,C)),findTextInFiles:(g,w,C,W)=>{O(I,"findTextInFiles");let ce,Ze;return typeof w=="object"?(ce=w,Ze=C):(ce={},Ze=w,W=C),s.findTextInFiles(g,ce||{},Ze,I.identifier,W)},save:g=>s.save(g),saveAs:g=>s.saveAs(g),saveAll:g=>s.saveAll(g),applyEdit(g,w){return li.applyWorkspaceEdit(g,I,w)},createFileSystemWatcher:(g,w,C,W)=>{let ce;return typeof w=="boolean"?ce={ignoreCreateEvents:!!w,ignoreChangeEvents:!!C,ignoreDeleteEvents:!!W,correlate:!1}:w&&(O(I,"createFileSystemWatcher"),ce={...w,correlate:!0}),Yt.createFileSystemWatcher(s,I,g,ce)},get textDocuments(){return ge.getAllDocumentData().map(g=>g.document)},set textDocuments(g){throw new Ss("textDocuments")},openTextDocument(g){let w;const C=g;if(typeof g=="string")w=Promise.resolve(x.file(g));else if(x.isUri(g))w=Promise.resolve(g);else if(!C||typeof C=="object")w=ge.createDocumentData(C);else throw new Error("illegal argument - uriOrFileNameOrOptions");return w.then(W=>(W.scheme===ne.vscodeRemote&&!W.authority&&_.report("workspace.openTextDocument",I,"A URI of 'vscode-remote' scheme requires an authority."),ge.ensureDocumentData(W).then(ce=>ce.document)))},onDidOpenTextDocument:(g,w,C)=>le(ge.onDidAddDocument)(g,w,C),onDidCloseTextDocument:(g,w,C)=>le(ge.onDidRemoveDocument)(g,w,C),onDidChangeTextDocument:(g,w,C)=>le(ge.onDidChangeDocument)(g,w,C),onDidSaveTextDocument:(g,w,C)=>le(ge.onDidSaveDocument)(g,w,C),onWillSaveTextDocument:(g,w,C)=>le(nt.getOnWillSaveTextDocumentEvent(I))(g,w,C),get notebookDocuments(){return He.notebookDocuments.map(g=>g.apiNotebook)},async openNotebookDocument(g,w){let C;if(x.isUri(g))C=g,await He.openNotebookDocument(g);else if(typeof g=="string")C=x.revive(await He.createNotebookDocument({viewType:g,content:w}));else throw new Error("Invalid arguments");return He.getNotebookDocument(C).apiNotebook},onDidSaveNotebookDocument(g,w,C){return le(Ot.onDidSaveNotebookDocument)(g,w,C)},onDidChangeNotebookDocument(g,w,C){return le(Ot.onDidChangeNotebookDocument)(g,w,C)},onWillSaveNotebookDocument(g,w,C){return le(_i.getOnWillSaveNotebookDocumentEvent(I))(g,w,C)},get onDidOpenNotebookDocument(){return le(He.onDidOpenNotebookDocument)},get onDidCloseNotebookDocument(){return le(He.onDidCloseNotebookDocument)},registerNotebookSerializer(g,w,C,W){return He.registerNotebookSerializer(I,g,w,C,Lt(I,"notebookLiveShare")?W:void 0)},onDidChangeConfiguration:(g,w,C)=>le(bd.onDidChangeConfiguration)(g,w,C),getConfiguration(g,w){return w=arguments.length===1?void 0:w,bd.getConfiguration(g,w,I)},registerTextDocumentContentProvider(g,w){return tt.registerTextDocumentContentProvider(g,w)},registerTaskProvider:(g,w)=>(_.report("window.registerTaskProvider",I,"Use the corresponding function on the 'tasks' namespace instead"),Q.registerTaskProvider(I,g,w)),registerFileSystemProvider(g,w,C){return hx(pd.registerFileSystemProvider(I,g,w,C),i.addFileSystemProvider(g,w,C))},get fs(){return i.value},registerFileSearchProvider:(g,w)=>(O(I,"fileSearchProvider"),B.registerFileSearchProvider(g,w)),registerTextSearchProvider:(g,w)=>(O(I,"textSearchProvider"),B.registerTextSearchProvider(g,w)),registerAITextSearchProvider:(g,w)=>(O(I,"aiTextSearchProvider"),O(I,"textSearchProvider"),B.registerAITextSearchProvider(g,w)),registerRemoteAuthorityResolver:(g,w)=>(O(I,"resolvers"),n.registerRemoteAuthorityResolver(g,w)),registerResourceLabelFormatter:g=>(O(I,"resolvers"),vd.$registerResourceLabelFormatter(g)),getRemoteExecServer:g=>(O(I,"resolvers"),n.getRemoteExecServer(g)),onDidCreateFiles:(g,w,C)=>le(Yt.onDidCreateFile)(g,w,C),onDidDeleteFiles:(g,w,C)=>le(Yt.onDidDeleteFile)(g,w,C),onDidRenameFiles:(g,w,C)=>le(Yt.onDidRenameFile)(g,w,C),onWillCreateFiles:(g,w,C)=>le(Yt.getOnWillCreateFileEvent(I))(g,w,C),onWillDeleteFiles:(g,w,C)=>le(Yt.getOnWillDeleteFileEvent(I))(g,w,C),onWillRenameFiles:(g,w,C)=>le(Yt.getOnWillRenameFileEvent(I))(g,w,C),openTunnel:g=>(O(I,"tunnels"),b.openTunnel(I,g).then(w=>{if(!w)throw new Error("cannot open tunnel");return w})),get tunnels(){return O(I,"tunnels"),b.getTunnels()},onDidChangeTunnels:(g,w,C)=>(O(I,"tunnels"),le(b.onDidChangeTunnels)(g,w,C)),registerPortAttributesProvider:(g,w)=>(O(I,"portsAttributes"),b.registerPortsAttributesProvider(g,w)),registerTunnelProvider:(g,w)=>(O(I,"tunnelFactory"),b.registerTunnelProvider(g,w)),registerTimelineProvider:(g,w)=>(O(I,"timeline"),bg.registerTimelineProvider(g,w,I.identifier,te.converter)),get isTrusted(){return s.trusted},requestWorkspaceTrust:g=>(O(I,"workspaceTrust"),s.requestWorkspaceTrust(g)),onDidGrantWorkspaceTrust:(g,w,C)=>le(s.onDidGrantWorkspaceTrust)(g,w,C),registerEditSessionIdentityProvider:(g,w)=>(O(I,"editSessionIdentityProvider"),s.registerEditSessionIdentityProvider(g,w)),onWillCreateEditSessionIdentity:(g,w,C)=>(O(I,"editSessionIdentityProvider"),le(s.getOnWillCreateEditSessionIdentityEvent(I))(g,w,C)),registerCanonicalUriProvider:(g,w)=>(O(I,"canonicalUriProvider"),s.registerCanonicalUriProvider(g,w)),getCanonicalUri:(g,w,C)=>(O(I,"canonicalUriProvider"),s.provideCanonicalUri(g,w,C))},Ag={get inputBox(){return _.report("scm.inputBox",I,"Use 'SourceControl.inputBox' instead"),gd.getLastInputBox(I)},createSourceControl(g,w,C){return gd.createSourceControl(I,g,w,C)}},Rg={createCommentController(g,w){return wg.createCommentController(I,g,w)}},Lg={get activeDebugSession(){return V.activeDebugSession},get activeDebugConsole(){return V.activeDebugConsole},get breakpoints(){return V.breakpoints},get activeStackItem(){if(Lt(I,"debugFocus"))return V.activeStackItem},registerDebugVisualizationProvider(g,w){return O(I,"debugVisualization"),V.registerDebugVisualizationProvider(I,g,w)},registerDebugVisualizationTreeProvider(g,w){return O(I,"debugVisualization"),V.registerDebugVisualizationTree(I,g,w)},onDidStartDebugSession(g,w,C){return le(V.onDidStartDebugSession)(g,w,C)},onDidTerminateDebugSession(g,w,C){return le(V.onDidTerminateDebugSession)(g,w,C)},onDidChangeActiveDebugSession(g,w,C){return le(V.onDidChangeActiveDebugSession)(g,w,C)},onDidReceiveDebugSessionCustomEvent(g,w,C){return le(V.onDidReceiveDebugSessionCustomEvent)(g,w,C)},onDidChangeBreakpoints(g,w,C){return le(V.onDidChangeBreakpoints)(g,w,C)},onDidChangeActiveStackItem(g,w,C){return O(I,"debugFocus"),le(V.onDidChangeActiveStackItem)(g,w,C)},registerDebugConfigurationProvider(g,w,C){return V.registerDebugConfigurationProvider(g,w,C||_p.Initial)},registerDebugAdapterDescriptorFactory(g,w){return V.registerDebugAdapterDescriptorFactory(I,g,w)},registerDebugAdapterTrackerFactory(g,w){return V.registerDebugAdapterTrackerFactory(g,w)},startDebugging(g,w,C){return!C||typeof C=="object"&&"configuration"in C?V.startDebugging(g,w,{parentSession:C}):V.startDebugging(g,w,C||{})},stopDebugging(g){return V.stopDebugging(g)},addBreakpoints(g){return V.addBreakpoints(g)},removeBreakpoints(g){return V.removeBreakpoints(g)},asDebugSourceUri(g,w){return V.asDebugSourceUri(g,w)}},Ac={registerTaskProvider:(g,w)=>Q.registerTaskProvider(I,g,w),fetchTasks:g=>Q.fetchTasks(g),executeTask:g=>Q.executeTask(I,g),get taskExecutions(){return Q.taskExecutions},onDidStartTask:(g,w,C)=>le(Q.onDidStartTask)(g,w,C),onDidEndTask:(g,w,C)=>le(Q.onDidEndTask)(g,w,C),onDidStartTaskProcess:(g,w,C)=>le(Q.onDidStartTaskProcess)(g,w,C),onDidEndTaskProcess:(g,w,C)=>le(Q.onDidEndTaskProcess)(g,w,C)},$g={createNotebookController(g,w,C,W,ce){return Zt.createNotebookController(I,g,w,C,W,Lt(I,"notebookMessaging")?ce:void 0)},registerNotebookCellStatusBarItemProvider:(g,w)=>He.registerNotebookCellStatusBarItemProvider(I,g,w),createRendererMessaging(g){return _t.createRendererMessaging(I,g)},createNotebookControllerDetectionTask(g){return O(I,"notebookKernelSource"),Zt.createNotebookControllerDetectionTask(I,g)},registerKernelSourceActionProvider(g,w){return O(I,"notebookKernelSource"),Zt.registerKernelSourceActionProvider(I,g,w)},onDidChangeNotebookCellExecutionState(g,w,C){return O(I,"notebookCellExecutionState"),le(Zt.onDidChangeNotebookCellExecutionState)(g,w,C)}},Ng={t(...g){if(typeof g[0]=="string"){const w=g.shift(),C=!g||typeof g[0]!="object"?g:g[0];return ie.getMessage(I.identifier.value,{message:w,args:C})}return ie.getMessage(I.identifier.value,g[0])},get bundle(){return ie.getBundle(I.identifier.value)},get uri(){return ie.getBundleUri(I.identifier.value)}},Mg={_version:1,registerInteractiveEditorSessionProvider(g,w){return O(I,"interactive"),Sg.registerProvider(I,g,w)},transferActiveChat(g){return O(I,"interactive"),ur.transferActiveChat(g)}},S={getRelatedInformation(g,w){return O(I,"aiRelatedInformation"),To.getRelatedInformation(I,g,w)},registerRelatedInformationProvider(g,w){return O(I,"aiRelatedInformation"),To.registerRelatedInformationProvider(I,g,w)},registerEmbeddingVectorProvider(g,w){return O(I,"aiRelatedInformation"),_d.registerEmbeddingVectorProvider(I,g,w)}},T={registerChatResponseProvider(g,w,C){return O(I,"chatProvider"),A.registerLanguageModel(I,g,w,C)},registerChatVariableResolver(g,w,C){return O(I,"chatVariableResolver"),Po.registerVariableResolver(I,g,w,C)},registerMappedEditsProvider(g,w){return O(I,"mappedEditsProvider"),Ie.registerMappedEditsProvider(I,g,w)},createChatParticipant(g,w){return O(I,"chatParticipant"),ur.createChatAgent(I,g,w)},createDynamicChatParticipant(g,w,C,W){return O(I,"chatParticipantAdditions"),ur.createDynamicChatAgent(I,g,w,C,W)}},L={get languageModels(){return O(I,"languageModels"),A.getLanguageModelIds()},onDidChangeLanguageModels:(g,w,C)=>(O(I,"languageModels"),A.onDidChangeProviders(g,w,C)),sendChatRequest(g,w,C,W){return O(I,"languageModels"),A.sendChatRequest(I,g,w,C,W)},computeTokenLength(g,w,C){return O(I,"languageModels"),C??(C=bt.None),A.computeTokenLength(g,w,C)},getLanguageModelInformation(g){return O(I,"languageModels"),A.getLanguageModelInfo(g)}},ee={registerSpeechProvider(g,w){return O(I,"speech"),Tc.registerProvider(I.identifier,g,w)}};return{version:e.version,ai:S,authentication:Eg,commands:kg,comments:Rg,chat:T,debug:Lg,env:Dg,extensions:Pg,interactive:Mg,l10n:Ng,languages:$o,lm:L,notebooks:$g,scm:Ag,speech:ee,tasks:Ac,tests:Ig,window:Tg,workspace:yd,Breakpoint:Ja,TerminalOutputAnchor:l1,ChatResultFeedbackKind:uu,ChatVariableLevel:Hn,ChatCompletionItem:HI,CallHierarchyIncomingCall:SC,CallHierarchyItem:Mw,CallHierarchyOutgoingCall:EC,CancellationError:is,CancellationTokenSource:Tt,CandidatePortSource:Rm,CodeAction:Wh,CodeActionKind:ct,CodeActionTriggerKind:jl,CodeLens:zh,Color:qa,ColorInformation:Kh,ColorPresentation:Xh,ColorThemeKind:xr,CommentMode:T1,CommentState:A1,CommentThreadCollapsibleState:iu,CommentThreadState:nu,CommentThreadApplicability:ru,CompletionItem:Gh,CompletionItemKind:pe,CompletionItemTag:Gl,CompletionList:Wa,CompletionTriggerKind:ca,ConfigurationTarget:ua,CustomExecution:Fw,DebugAdapterExecutable:sf,DebugAdapterInlineImplementation:af,DebugAdapterNamedPipeServer:of,DebugAdapterServer:Yl,DebugConfigurationProviderTriggerKind:_p,DebugConsoleMode:hf,DebugVisualization:AI,DecorationRangeBehavior:Ps,Diagnostic:Oh,DiagnosticRelatedInformation:Ul,DiagnosticSeverity:Ft,DiagnosticTag:Ds,Disposable:Ne,DocumentHighlight:Bh,DocumentHighlightKind:Bl,MultiDocumentHighlight:Vh,DocumentLink:Jh,DocumentSymbol:zl,EndOfLine:Zi,EnvironmentVariableMutatorType:oa,EvaluatableExpression:cf,InlineValueText:lf,InlineValueVariableLookup:uf,InlineValueEvaluatableExpression:df,InlineCompletionTriggerKind:eu,EventEmitter:R,ExtensionKind:ro,ExtensionMode:pa,ExternalUriOpenerPriority:U1,FileChangeType:ha,FileDecoration:L1,FileDecoration2:L1,FileSystemError:St,FileType:eo,FilePermission:Ba,FoldingRange:P1,FoldingRangeKind:On,FunctionBreakpoint:As,InlineCompletionItem:m1,InlineCompletionList:v1,Hover:Hh,VerboseHover:Uh,HoverVerbosityAction:u1,IndentAction:k_,Location:Pi,MarkdownString:Ti,OverviewRulerLane:zv,ParameterInformation:d1,PortAutoForwardAction:V1,Position:ke,ProcessExecution:Ga,ProgressLocation:io,QuickInputButtons:su,Range:xe,RelativePattern:da,Selection:sr,SelectionRange:ql,SemanticTokens:Ka,SemanticTokensBuilder:Ow,SemanticTokensEdit:TC,SemanticTokensEdits:th,SemanticTokensLegend:R1,ShellExecution:mo,ShellQuoting:C1,SignatureHelp:f1,SignatureHelpTriggerKind:p1,SignatureInformation:h1,SnippetString:go,SourceBreakpoint:Ts,StandardTokenType:Nr,StatusBarAlignment:$r,SymbolInformation:Wl,SymbolKind:Ke,SymbolTag:Vl,Task:Yh,TaskGroup:Kl,TaskPanelKind:x1,TaskRevealKind:y1,TaskScope:vo,TerminalLink:yI,TerminalQuickFixTerminalCommand:CI,TerminalQuickFixOpener:xI,TerminalLocation:b1,TerminalProfile:SI,TerminalExitReason:w1,TerminalShellExecutionCommandLineConfidence:Zh,TextDocumentSaveReason:la,TextEdit:Xr,SnippetTextEdit:to,TextEditorCursorStyle:vn,TextEditorLineNumbersStyle:qi,TextEditorRevealType:Qh,TextEditorSelectionChangeKind:za,SyntaxTokenType:ja,TextDocumentChangeReason:Jl,ThemeColor:Zl,ThemeIcon:Kt,TreeItem:ef,TreeItemCheckboxState:wn,TreeItemCollapsibleState:no,TypeHierarchyItem:Uw,UIKind:Tl,Uri:x,ViewColumn:Ql,WorkspaceEdit:Zr,DocumentPasteTriggerKind:k1,DocumentDropEdit:E1,DocumentDropOrPasteEditKind:Qa,DocumentPasteEdit:DI,InlayHint:qh,InlayHintLabelPart:jh,InlayHintKind:g1,RemoteAuthorityResolverError:_n,ResolvedAuthority:wI,ManagedResolvedAuthority:eh,SourceControlInputBoxValidationType:_1,ExtensionRuntime:_f,TimelineItem:O1,NotebookRange:Kn,NotebookCellKind:Rs,NotebookCellExecutionState:Xa,NotebookCellData:ng,NotebookData:AC,NotebookRendererScript:LC,NotebookCellStatusBarAlignment:gf,NotebookEditorRevealType:mf,NotebookCellOutput:pf,NotebookCellOutputItem:RC,NotebookCellStatusBarItem:RI,NotebookControllerAffinity:F1,NotebookControllerAffinity2:vf,NotebookEdit:Fh,NotebookKernelSourceAction:LI,NotebookVariablesRequestKind:au,PortAttributes:NI,LinkedEditingRanges:$I,TestResultState:H1,TestRunRequest:cu,TestRunRequest2:cu,TestMessage:wf,TestTag:lu,TestRunProfileKind:ga,TextSearchCompleteMessageType:Sv,DataTransfer:Xl,DataTransferItem:tf,TestCoverageCount:ih,FileCoverage:Hw,StatementCoverage:MI,BranchCoverage:FI,DeclarationCoverage:OI,WorkspaceTrustState:B1,LanguageStatusSeverity:aa,QuickPickItemKind:ou,InputBoxValidationSeverity:fa,TabInputText:Bw,TabInputTextDiff:bf,TabInputTextMerge:$C,TabInputCustom:Vw,TabInputNotebook:Ww,TabInputNotebookDiff:zw,TabInputWebview:NC,TabInputTerminal:MC,TabInputInteractiveWindow:FC,TabInputChat:OC,TabInputTextMultiDiff:HC,TelemetryTrustedValue:qw,LogLevel:Me,EditSessionIdentityMatch:D_,InteractiveSessionVoteDirection:W1,ChatCopyKind:z1,InteractiveEditorResponseFeedbackKind:Cr,DebugStackFrame:IC,DebugThread:PC,RelatedInformationType:j1,SpeechToTextStatus:q1,PartialAcceptTriggerKind:Is,KeywordRecognitionStatus:G1,ChatResponseMarkdownPart:rg,ChatResponseFileTreePart:sg,ChatResponseAnchorPart:og,ChatResponseProgressPart:Za,ChatResponseReferencePart:Wr,ChatResponseTextEditPart:fu,ChatResponseMarkdownWithVulnerabilitiesPart:du,ChatResponseCommandButtonPart:ag,ChatResponseDetectedParticipantPart:hu,ChatRequestTurn:UC,ChatResponseTurn:BC,ChatLocation:Ls,LanguageModelChatSystemMessage:yf,LanguageModelChatUserMessage:xf,LanguageModelChatAssistantMessage:Cf,LanguageModelSystemMessage:yf,LanguageModelUserMessage:xf,LanguageModelAssistantMessage:Cf,LanguageModelError:bn,NewSymbolName:PI,NewSymbolNameTag:I1,NewSymbolNameTriggerKind:tu,InlineEdit:UI,InlineEditTriggerKind:pu}}}var ch;let ow=class{constructor(e,t,i,n,s,o,a){this._apiFactory=e,this._extensionRegistry=t,this._instaService=i,this._extHostConfiguration=n,this._extHostExtensionService=s,this._initData=o,this._logService=a,this._factories=new Map,this._alternatives=[]}async install(){this._installInterceptor(),Si("code/extHost/willWaitForConfig");const e=await this._extHostConfiguration.getConfigProvider();Si("code/extHost/didWaitForConfig");const t=await this._extHostExtensionService.getExtensionPathIndex();this.register(new l3(this._apiFactory,t,this._extensionRegistry,e,this._logService)),this.register(this._instaService.createInstance(aw)),this._initData.remote.isRemote&&this.register(this._instaService.createInstance(cw,t,this._initData.environment.appUriScheme))}register(e){if("nodeModuleName"in e)if(Array.isArray(e.nodeModuleName))for(const t of e.nodeModuleName)this._factories.set(t,e);else this._factories.set(e.nodeModuleName,e);typeof e.alternativeModuleName=="function"&&this._alternatives.push(t=>e.alternativeModuleName(t))}};ow=U([M(2,Qp),M(3,lr),M(4,ns),M(5,jt),M(6,Je)],ow);var vc;let aw=(vc=class{constructor(e){if(e.environment.appRoot&&ch.aliased.size){const t=Fa(this.forceForwardSlashes(e.environment.appRoot.fsPath)),i="[a-z0-9_.-]",n=`@${i}+\\/${i}+|${i}+`,s="node_modules|node_modules\\.asar(?:\\.unpacked)?";this.re=new RegExp(`^(${t}/${s}\\/)(${n})(.*)$`,"i")}}alternativeModuleName(e){if(!this.re)return;const t=this.re.exec(this.forceForwardSlashes(e));if(!t)return;const[,i,n,s]=t,o=ch.aliased.get(n);if(o!==void 0)return console.warn(`${n} as been renamed to ${o}, please update your imports`),i+o+s}forceForwardSlashes(e){return e.replace(/\\/g,"/")}},ch=vc,vc.aliased=new Map([["vscode-ripgrep","@vscode/ripgrep"],["vscode-windows-registry","@vscode/windows-registry"]]),vc);aw=ch=U([M(0,jt)],aw);class l3{constructor(e,t,i,n,s){this._apiFactory=e,this._extensionPaths=t,this._extensionRegistry=i,this._configProvider=n,this._logService=s,this.nodeModuleName="vscode",this._extApiImpl=new Kr}load(e,t){const i=this._extensionPaths.findSubstr(t);if(i){let n=this._extApiImpl.get(i.identifier);return n||(n=this._apiFactory(i,this._extensionRegistry,this._configProvider),this._extApiImpl.set(i.identifier,n)),n}if(!this._defaultApiImpl){let n="";this._extensionPaths.forEach((s,o)=>n+=`	${o} -> ${s.identifier.value}
`),this._logService.warn(`Could not identify extension for 'vscode' require call from ${t}. These are the extension path mappings: 
${n}`),this._defaultApiImpl=this._apiFactory(y7,this._extensionRegistry,this._configProvider)}return this._defaultApiImpl}}let cw=class{constructor(e,t,i){this._extensionPaths=e,this._appUriScheme=t,this.nodeModuleName=["open","opn"],this._mainThreadTelemetry=i.getProxy(J.MainThreadTelemetry);const n=i.getProxy(J.MainThreadWindow);this._impl=(s,o)=>{const a=x.parse(s);return o?this.callOriginal(s,o):a.scheme==="http"||a.scheme==="https"?n.$openUri(a,s,{allowTunneling:!0}):a.scheme==="mailto"||a.scheme===this._appUriScheme?n.$openUri(a,s,{}):this.callOriginal(s,o)}}load(e,t,i){const n=this._extensionPaths.findSubstr(t);return n&&(this._extensionId=n.identifier.value,this.sendShimmingTelemetry()),this._original=i(e),this._impl}callOriginal(e,t){return this.sendNoForwardTelemetry(),this._original(e,t)}sendShimmingTelemetry(){this._extensionId&&this._mainThreadTelemetry.$publicLog2("shimming.open",{extension:this._extensionId})}sendNoForwardTelemetry(){this._extensionId&&this._mainThreadTelemetry.$publicLog2("shimming.open.call.noForward",{extension:this._extensionId})}};cw=U([M(2,Ve)],cw);let lw=class{constructor(e,t){this._mainThreadConsole=e.getProxy(J.MainThreadConsole),this._includeStack=t.consoleForward.includeStack,this._logNative=t.consoleForward.logNative,this._wrapConsoleMethod("info","log"),this._wrapConsoleMethod("log","log"),this._wrapConsoleMethod("warn","warn"),this._wrapConsoleMethod("debug","debug"),this._wrapConsoleMethod("error","error")}_wrapConsoleMethod(e,t){const i=this,n=console[e];Object.defineProperty(console,e,{set:()=>{},get:()=>function(){i._handleConsoleCall(e,t,n,arguments)}})}_handleConsoleCall(e,t,i,n){this._mainThreadConsole.$logExtensionHostMessage({type:"__$console",severity:t,arguments:d3(n,this._includeStack)}),this._logNative&&this._nativeConsoleLogMessage(e,i,n)}};lw=U([M(0,Ve),M(1,jt)],lw);const u3=1e5;function d3(r,e){const t=[];if(r.length)for(let i=0;i<r.length;i++){let n=r[i];if(typeof n>"u")n="undefined";else if(n instanceof Error){const s=n;s.stack?n=s.stack:n=s.toString()}t.push(n)}if(e){const i=new Error().stack;i&&t.push({__$stack:i.split(`
`).slice(3).join(`
`)})}try{const i=pk(t);return i.length>u3?"Output omitted for a large object that exceeds the limits":i}catch(i){return`Output omitted for an object that cannot be inspected ('${i.toString()}')`}}let uw=class extends lw{constructor(e,t){super(e,t)}_nativeConsoleLogMessage(e,t,i){t.apply(console,i)}};uw=U([M(0,Ve),M(1,jt)],uw);class h3 extends ow{_installInterceptor(){}getModule(e,t){for(const i of this._alternatives){const n=i(e);if(n){e=n;break}}if(this._factories.has(e))return this._factories.get(e).load(e,t,()=>{throw new Error("CANNOT LOAD MODULE from here.")})}}class f3 extends Jv{constructor(){super(...arguments),this.extensionRuntime=_f.Webworker}async _beforeAlmostReadyToRunExtensions(){Al&&this._instaService.createInstance(uw),this._apiFactory=this._instaService.invokeFunction(c3),this._fakeModules=this._instaService.createInstance(h3,this._apiFactory,{mine:this._myRegistry,all:this._globalRegistry}),await this._fakeModules.install(),performance.mark("code/extHost/didInitAPI"),await this._waitForDebuggerAttachment()}_getEntryPoint(e){return e.browser}async _loadCommonJSModule(e,t,i){t=t.with({path:p3(t.path,".js")});const n=e==null?void 0:e.identifier.value;n&&performance.mark(`code/extHost/willFetchExtensionCode/${n}`);const s=x.revive(await this._mainThreadExtensionsProxy.$asBrowserUri(t)),o=await fetch(s.toString(!0));if(n&&performance.mark(`code/extHost/didFetchExtensionCode/${n}`),o.status!==200)throw new Error(o.statusText);const a=await o.text(),c=`${t.toString(!0)}#vscode-extension`,l=`${a}
//# sourceURL=${c}`;let u;try{u=new Function("module","exports","require",l)}catch(b){throw console.error(n?`Loading code for extension ${n} failed: ${b.message}`:`Loading code failed: ${b.message}`),console.error(`${t.toString(!0)}${typeof b.line=="number"?` line ${b.line}`:""}${typeof b.column=="number"?` column ${b.column}`:""}`),console.error(b),b}e&&await this._extHostLocalizationService.initializeLocalizedMessages(e);const d={},f={exports:d},m=b=>{const _=this._fakeModules.getModule(b,t);if(_===void 0)throw new Error(`Cannot load module '${b}'`);return _};try{return i.codeLoadingStart(),n&&performance.mark(`code/extHost/willLoadExtensionCode/${n}`),u(f,d,m),f.exports!==d?f.exports:d}finally{n&&performance.mark(`code/extHost/didLoadExtensionCode/${n}`),i.codeLoadingStop()}}async $setRemoteEnvironment(e){}async _waitForDebuggerAttachment(e=5e3){if(!this._initData.environment.isExtensionDevelopmentDebug)return;const t=Date.now()+e;for(;Date.now()<t&&!("__jsDebugIsReady"in globalThis);)await Yn(10)}}function p3(r,e){return r.endsWith(e)?r:r+e}it(ns,f3,0);it(Qw,Rv,0);const zS=self.close.bind(self);self.close=()=>console.trace("'close' has been blocked");const jS=postMessage.bind(self);self.postMessage=()=>console.trace("'postMessage' has been blocked");function ex(r){return/^(file|extension-file|vscode-remote):/i.test(r)}const tx=fetch.bind(self);function g3(r){self.fetch=async function(e,t){return e instanceof Request||ex(String(e))&&(e=(await r(x.parse(String(e)))).toString(!0)),tx(e,t)},self.XMLHttpRequest=class extends XMLHttpRequest{open(e,t,i,n,s){(async()=>(ex(t.toString())&&(t=(await r(x.parse(t.toString()))).toString(!0)),super.open(e,t,i??!0,n,s)))()}}}self.importScripts=()=>{throw new Error("'importScripts' has been blocked")};self.addEventListener=()=>console.trace("'addEventListener' has been blocked");self.AMDLoader=void 0;self.NLSLoaderPlugin=void 0;self.define=void 0;self.require=void 0;self.webkitRequestFileSystem=void 0;self.webkitRequestFileSystemSync=void 0;self.webkitResolveLocalFileSystemSyncURL=void 0;self.webkitResolveLocalFileSystemURL=void 0;function m3(r,e){if(self.Worker){const t=self.Worker;Worker=function(i,n){if(/^vscode-remote:/i.test(i.toString()))throw new Error("Creating workers from remote extensions is currently not supported.");async function s(a){const[c,l]=await Promise.all([r(a).then(m=>m.toString(!0)),e().then(m=>Object.fromEntries(m.map(([b,_])=>[b.toString(!0),_.toString(!0)])))]),d=`(${(function(b,_){function v(E){return typeof E=="string"||E instanceof URL?(E=String(E).replace(/^file:\/\//i,"vscode-file://vscode-app"),_[E]??E):E}const k=fetch.bind(self);self.fetch=function(E,N){return E instanceof Request?k(E,N):k(v(E),N)},self.XMLHttpRequest=class extends XMLHttpRequest{constructor(){super(...arguments),this.notFound=!1}open(E,N,A,j,re){const te=v(N);return this.notFound=te.startsWith("extension-file:"),super.open(E,te,A??!0,j,re)}send(E){this.notFound||super.send(E)}get status(){return this.notFound?404:super.status}};const D=importScripts.bind(self);self.importScripts=(...E)=>{D(...E.map(v))},self.importExt=E=>new Function("url","return import(url)")(v(E)),D(b)}).toString()}('${c}', ${JSON.stringify(l)}))`,f=new Blob([d],{type:"application/javascript"});return URL.createObjectURL(f)}n=n||{},n.name=`${name} -> ${n.name||gi(i.toString())}`;class o{constructor(c,l){this._onmessage=null,this._onmessageerror=null,this._onerror=null,this.workerPromise=s(x.parse(c instanceof URL?c.toString():c)).then(u=>new t(u,l))}set onmessage(c){this._onmessage=c,this.workerPromise.then(l=>{l.onmessage=c},console.error)}get onmessage(){return this._onmessage}set onmessageerror(c){this._onmessageerror=c,this.workerPromise.then(l=>{l.onmessageerror=c},console.error)}get onmessageerror(){return this._onmessageerror}set onerror(c){this._onerror=c,this.workerPromise.then(l=>{l.onerror=c},console.error)}get onerror(){return this._onerror}postMessage(c,l){this.workerPromise.then(u=>{u.postMessage(c,l)},console.error)}terminate(){this.workerPromise.then(c=>{c.terminate()},console.error)}addEventListener(c,l,u){this.workerPromise.then(d=>{d.addEventListener(c,l,u)},console.error)}removeEventListener(c,l,u){this.workerPromise.then(d=>{d.removeEventListener(c,l,u)},console.error)}dispatchEvent(c){return this.workerPromise.then(l=>{l.dispatchEvent(c)},console.error),!1}}return new o(i,n)}}else self.Worker=class extends p8{constructor(t,i){super(jS,t,{name:gi(t.toString()),...i})}}}const v3=new class{constructor(){this.pid=void 0}exit(r){zS()}};class _3{constructor(){const e=new MessageChannel,t=new R;let i=!1;jS(e.port2,[e.port2]),e.port1.onmessage=n=>{const{data:s}=n;if(!(s instanceof ArrayBuffer)){console.warn("UNKNOWN data received",s);return}const o=_e.wrap(new Uint8Array(s,0,s.byteLength));if(T4(o,2)){i=!0,qS("received terminate message from renderer");return}t.fire(o)},this.protocol={onMessage:t.event,send:n=>{if(!i){const s=n.buffer.buffer.slice(n.buffer.byteOffset,n.buffer.byteOffset+n.buffer.byteLength);e.port1.postMessage(s,[s])}}}}}function w3(r){return new Promise(e=>{const t=r.onMessage(i=>{t.dispose();const n=JSON.parse(i.toString());r.send(C0(0)),e({protocol:r,initData:n})});r.send(C0(1))})}let qS=r=>zS();function b3(r){return!!r&&typeof r=="object"&&r.type==="vscode.init"&&r.data instanceof Map}function y3(){Si("code/extHost/willConnectToRenderer");const r=new _3;return{onmessage(e){b3(e)&&w3(r.protocol).then(t=>{Si("code/extHost/didWaitForInitData");const i=new n0(t.protocol,t.initData,v3,null,e.data);g3(n=>i.asBrowserUri(n)),m3(n=>i.asBrowserUri(n),()=>i.getAllStaticBrowserUris()),qS=n=>i.terminate(n)})}}}const x3=y3();globalThis.onmessage=r=>x3.onmessage(r.data);
//# sourceMappingURL=extensionHost.worker-B_tGA6q2.js.map
